const _0x32759a=_0x50e8;(function(_0x550a93,_0x46602c){const _0x135e61=_0x50e8,_0x3bdcab=_0x550a93();while(!![]){try{const _0x4f154f=parseInt(_0x135e61(0x198))/0x1+parseInt(_0x135e61(0x397))/0x2+parseInt(_0x135e61(0x310))/0x3+parseInt(_0x135e61(0x3a8))/0x4+parseInt(_0x135e61(0x219))/0x5+-parseInt(_0x135e61(0x30b))/0x6+parseInt(_0x135e61(0x327))/0x7*(-parseInt(_0x135e61(0x325))/0x8);if(_0x4f154f===_0x46602c)break;else _0x3bdcab['push'](_0x3bdcab['shift']());}catch(_0x1f0cb0){_0x3bdcab['push'](_0x3bdcab['shift']());}}}(_0x548a,0x4b124));const _0x3bd9cd=function(){let _0x30edb3=!![];return function(_0x1f7d7e,_0x282640){const _0x5e0612=_0x30edb3?function(){const _0x5ae78e=_0x50e8;if(_0x282640){const _0x4911a3=_0x282640[_0x5ae78e(0x3a0)](_0x1f7d7e,arguments);return _0x282640=null,_0x4911a3;}}:function(){};return _0x30edb3=![],_0x5e0612;};}(),_0x32ede5=_0x3bd9cd(this,function(){const _0x5ebae4=_0x50e8;return _0x32ede5[_0x5ebae4(0x2a0)]()[_0x5ebae4(0x1f2)](_0x5ebae4(0x335))[_0x5ebae4(0x2a0)]()[_0x5ebae4(0x251)](_0x32ede5)[_0x5ebae4(0x1f2)](_0x5ebae4(0x335));});_0x32ede5();'use strict';process['env'][_0x32759a(0x2c3)]=0x1;const childProcess=require(_0x32759a(0x1e4)),fs=require('fs'),fns=require(_0x32759a(0x2cf)),low=require(_0x32759a(0x27e)),FileSync=require(_0x32759a(0x23c)),path=require(_0x32759a(0x33d)),crypto=require(_0x32759a(0x32e)),forge=require(_0x32759a(0x2f4)),bcrypt=require('bcryptjs'),jwt=require(_0x32759a(0x24a)),ipaddr=require('ipaddr.js'),argv=require(_0x32759a(0x19f))(process[_0x32759a(0x35c)][_0x32759a(0x3a6)](0x2))['argv'],uuidRandom=require(_0x32759a(0x34f)),{Telegraf,Markup}=require(_0x32759a(0x320)),Mixpanel=require(_0x32759a(0x286)),axios=require(_0x32759a(0x308)),{GraphQLClient,gql}=require(_0x32759a(0x2b6)),util=require(_0x32759a(0x281)),fileUpload=require(_0x32759a(0x1bd)),{networkInterfaces}=require('os'),JSZip=require(_0x32759a(0x315)),PORT=argv['port']||_0x32759a(0x1cc),pattern=/^[0-9]{2,4}$/;!pattern[_0x32759a(0x227)](PORT)&&(console[_0x32759a(0x1e9)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x32759a(0x348)](0x1));const HOST=argv[_0x32759a(0x384)]||null,userID=argv[_0x32759a(0x1a8)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process['versions'][_0x32759a(0x1c9)];let bbpath=_0x32759a(0x319),bbpath2='';const botfile='bot.js',configfile=_0x32759a(0x1c4),settingsfile=_0x32759a(0x2fa),securefile=_0x32759a(0x344),environment=require('./'+bbpath2+_0x32759a(0x3a3))[_0x32759a(0x19c)]||_0x32759a(0x2b9),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x32759a(0x258)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x32759a(0x1d0)),configpath=userID?bbpath+_0x32759a(0x1cd)+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x32759a(0x33c),zippath=userID?bbpath+_0x32759a(0x352)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x32759a(0x231)](logspath+_0x32759a(0x208),{'flags':'a'}),temppath=userID?bbpath+_0x32759a(0x2ef)+userID+'/':bbpath+_0x32759a(0x2ef);!fs[_0x32759a(0x258)](configpath)&&fs[_0x32759a(0x20d)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x32759a(0x20d)](configbackuppath);!fs[_0x32759a(0x258)](logspath)&&fs[_0x32759a(0x20d)](logspath);!fs['existsSync'](zippath)&&fs[_0x32759a(0x20d)](zippath);!fs['existsSync'](temppath)&&fs[_0x32759a(0x20d)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x32759a(0x21f)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x32759a(0x21f)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x32759a(0x31b),'onepagemode':![],'marketcapApi':''}})[_0x32759a(0x294)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x32759a(0x21f)]({'secure':{},'blacklist':[]})['write']();const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x32759a(0x2fc),{'host':_0x32759a(0x1f9)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x32759a(0x1c5)]&&(settings['telegramToken']!=''&&settings[_0x32759a(0x1c5)]!=_0x32759a(0x309))&&settings[_0x32759a(0x1f1)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x4165a6,_0x40c7fc)=>{const _0x175f2b=_0x32759a,_0x5b6d2a=/#[A-Z]{3}#/g;if(typeof _0x4165a6=='string'){!_0x40c7fc?_0x4165a6=_0x4165a6[_0x175f2b(0x1e0)](_0x5b6d2a,''):(_0x4165a6=_0x4165a6[_0x175f2b(0x1e0)](/#BLU#/g,'\x1b[34m'),_0x4165a6=_0x4165a6[_0x175f2b(0x1e0)](/#RED#/g,'\x1b[31m'),_0x4165a6=_0x4165a6[_0x175f2b(0x1e0)](/#YEL#/g,_0x175f2b(0x218)),_0x4165a6=_0x4165a6[_0x175f2b(0x1e0)](/#MAG#/g,_0x175f2b(0x276)),_0x4165a6=_0x4165a6[_0x175f2b(0x1e0)](/#CYA#/g,_0x175f2b(0x1bf)),_0x4165a6=_0x4165a6[_0x175f2b(0x1e0)](/#RES#/g,_0x175f2b(0x252)));;}return _0x4165a6;},logger={'screen':_0x374d3c=>{const _0x15f0b9=_0x32759a;console[_0x15f0b9(0x1e9)](parseColor(_0x374d3c,!![]));},'simple':_0x5385a2=>{const _0x46cdde=_0x32759a;console[_0x46cdde(0x1e9)](parseColor(_0x5385a2,!![])),loggerfile['write'](util[_0x46cdde(0x1b2)](parseColor(_0x5385a2,![]))+'\x0a');},'full':async _0x2e6e17=>{const _0x40065e=_0x32759a,_0x17ae0a=getTimeStamp()+_0x40065e(0x1aa)+_0x2e6e17;console['log'](parseColor(_0x17ae0a,!![])),loggerfile[_0x40065e(0x294)](util[_0x40065e(0x1b2)](parseColor(_0x17ae0a,![]))+'\x0a');if(tgBot&&settings[_0x40065e(0x206)]&&settings[_0x40065e(0x235)]!=_0x40065e(0x39f))await sendTelegram(settings[_0x40065e(0x206)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x2e6e17,![]));},'debug':async(_0x13dd17,_0x474ac3='')=>{const _0x1b7fcf=_0x32759a,_0x1ba043=getTimeStamp()+_0x1b7fcf(0x277)+_0x13dd17;if(debugging)console[_0x1b7fcf(0x1e9)](parseColor(_0x1ba043,!![]));loggerfile[_0x1b7fcf(0x294)](util['format'](parseColor(_0x1ba043,![]))+'\x0a');if(_0x474ac3){if(debugging)console[_0x1b7fcf(0x1e9)](_0x474ac3);loggerfile[_0x1b7fcf(0x294)](util[_0x1b7fcf(0x1b2)](_0x474ac3)+'\x0a');}}};let terminating=![];process['on'](_0x32759a(0x2c8),function(_0x590e12){const _0x327064=_0x32759a;_0x590e12[_0x327064(0x2a0)]()['includes'](_0x327064(0x1b4))?(logger[_0x327064(0x368)](_0x327064(0x20c)+_0x590e12[_0x327064(0x359)]+_0x327064(0x358)),process[_0x327064(0x1a4)]({'terminate':!![]},_0x25e33a=>{})):logger['simple'](_0x590e12);}),process['on'](_0x32759a(0x348),()=>{const _0x37fa46=_0x32759a;stopAllBots(),process[_0x37fa46(0x348)](0x0);}),process['on'](_0x32759a(0x1b8),()=>{const _0x2e1c5f=_0x32759a;stopAllBots(),process[_0x2e1c5f(0x348)](0x0);}),process['on'](_0x32759a(0x239),()=>{const _0x22d9b5=_0x32759a;stopAllBots(),process[_0x22d9b5(0x348)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x32759a(0x3a3))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x32759a(0x37b)),app=express(),http=require(_0x32759a(0x2af))[_0x32759a(0x2b0)](app);app[_0x32759a(0x32b)](fileUpload({'useTempFiles':!![]})),app[_0x32759a(0x36e)](_0x32759a(0x2b1),async(_0x2dca15,_0x51e4e7)=>{const _0x498f7c=_0x32759a,_0x528327=_0x2dca15[_0x498f7c(0x2c7)][_0x498f7c(0x1d6)],_0x420db5=getClientsWithBotID(_0x498f7c(0x1fc)),_0x4fabe0=_0x2dca15['headers'][_0x498f7c(0x217)],_0xd9fd05=timelyDecrypt(_0x4fabe0,![]),_0x3affaa=_0x420db5[_0x498f7c(0x376)](_0x1c08c4=>_0x1c08c4[_0x498f7c(0x217)]==_0xd9fd05);if(_0x3affaa){const _0x700485=normalizeIP(_0x2dca15[_0x498f7c(0x232)][_0x498f7c(0x2f3)])[_0x498f7c(0x201)],_0x162ddc=_0x2dca15[_0x498f7c(0x386)][_0x498f7c(0x2ba)];if(validateAccess(_0x162ddc,_0xd9fd05,_0x700485)[_0x498f7c(0x228)])_0x528327==_0x498f7c(0x287)&&await backupConfigFiles(),await zipFiles(_0x528327),_0x51e4e7[_0x498f7c(0x2dc)](zippath+(_0x528327+_0x498f7c(0x1fd)),_0x236529=>{const _0x57c797=_0x498f7c;_0x236529&&(logger[_0x57c797(0x37f)](_0x57c797(0x1ae)+_0x528327),logger[_0x57c797(0x368)](_0x236529));});else logger['full'](_0x498f7c(0x216)+_0x528327+_0x498f7c(0x399));}else logger[_0x498f7c(0x37f)](_0x498f7c(0x216)+_0x528327+'\x20(2)');}),app['post'](_0x32759a(0x338),async(_0x371f58,_0x3278e7)=>{const _0x5c24d5=_0x32759a,_0x2ddfe6=getClientsWithBotID(_0x5c24d5(0x1fc)),_0x4ff9ef=_0x371f58[_0x5c24d5(0x386)][_0x5c24d5(0x217)],_0x54edbb=timelyDecrypt(_0x4ff9ef,![]),_0x3b9a2a=_0x2ddfe6[_0x5c24d5(0x376)](_0xb425b4=>_0xb425b4['uuid']==_0x54edbb);logger[_0x5c24d5(0x1a5)](_0x5c24d5(0x22b));if(_0x3b9a2a){const _0x163b0f=normalizeIP(_0x371f58[_0x5c24d5(0x232)][_0x5c24d5(0x2f3)])[_0x5c24d5(0x201)],_0x54c55e=_0x371f58[_0x5c24d5(0x386)][_0x5c24d5(0x2ba)];if(validateAccess(_0x54c55e,_0x54edbb,_0x163b0f)[_0x5c24d5(0x228)]){if(_0x371f58['files']){const _0x52bf7b=_0x371f58[_0x5c24d5(0x2fd)][_0x5c24d5(0x35f)];await _0x52bf7b['mv'](temppath+_0x52bf7b['name']),_0x3278e7[_0x5c24d5(0x1a4)]({'status':!![],'message':'File\x20uploaded'});const _0x4e61e2=getBotsWithMode();_0x4e61e2[_0x5c24d5(0x268)]>0x0?confirmRestore(temppath,_0x52bf7b[_0x5c24d5(0x345)]):unzipFile(temppath,_0x52bf7b[_0x5c24d5(0x345)]);}}else logger[_0x5c24d5(0x37f)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x5c24d5(0x37f)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x32759a(0x32b)](express[_0x32759a(0x222)](path[_0x32759a(0x36a)](__dirname,bbpath2,_0x32759a(0x236)))),app['use'](express['static'](path[_0x32759a(0x36a)](__dirname,bbpath2,_0x32759a(0x1f5)))),app[_0x32759a(0x36e)]('/',function(_0x4f6b9a,_0x5798b0){const _0x3c6885=_0x32759a;_0x5798b0[_0x3c6885(0x2a9)](path[_0x3c6885(0x36a)](__dirname,bbpath2,_0x3c6885(0x236),_0x3c6885(0x33a)));}),app[_0x32759a(0x36e)](_0x32759a(0x214),function(_0x5674af,_0x18eb4b){const _0x3d0391=_0x32759a;_0x18eb4b['sendFile'](path['join'](__dirname,bbpath2,_0x3d0391(0x1f5),'index.html'));}),app['get'](_0x32759a(0x1a0),(_0x1a8423,_0x28f5e6)=>{const _0x53b153=_0x32759a;_0x28f5e6[_0x53b153(0x2a9)](path[_0x53b153(0x36a)](__dirname,bbpath2,'build',_0x53b153(0x33a)));}),app[_0x32759a(0x36e)]('/:bot/performance',(_0x29fea4,_0x40e6cd)=>{const _0x160b70=_0x32759a;_0x40e6cd[_0x160b70(0x2a9)](path[_0x160b70(0x36a)](__dirname,bbpath2,'build',_0x160b70(0x33a)));}),app[_0x32759a(0x36e)](_0x32759a(0x241),(_0x4a6e02,_0x16d35b)=>{const _0x22fe1d=_0x32759a;_0x16d35b[_0x22fe1d(0x2a9)](path['join'](__dirname,bbpath2,_0x22fe1d(0x1f5),_0x22fe1d(0x33a)));}),app[_0x32759a(0x36e)]('/:bot/history',(_0x39cee8,_0x5bb503)=>{const _0x55c934=_0x32759a;_0x5bb503[_0x55c934(0x2a9)](path['join'](__dirname,bbpath2,_0x55c934(0x1f5),_0x55c934(0x33a)));}),app[_0x32759a(0x36e)](_0x32759a(0x2b2),(_0x20b59c,_0x33fb97)=>{const _0x261536=_0x32759a;_0x33fb97[_0x261536(0x2a9)](path[_0x261536(0x36a)](__dirname,bbpath2,'build',_0x261536(0x33a)));}),app[_0x32759a(0x36e)](_0x32759a(0x2d4),(_0x39df42,_0x36d75c)=>{const _0x160155=_0x32759a;_0x36d75c[_0x160155(0x2a9)](path[_0x160155(0x36a)](__dirname,bbpath2,_0x160155(0x1f5),'index.html'));});if(HOST)http[_0x32759a(0x33f)](PORT,HOST);else http['listen'](PORT);const io=require(_0x32759a(0x357))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5543c4=_0x32759a;let _0xa4d491='[ip-address]';const _0x53ac64=networkInterfaces(),_0x577a64={};for(const _0x4ca93d of Object[_0x5543c4(0x30f)](_0x53ac64)){for(const _0xbc7c5 of _0x53ac64[_0x4ca93d]){if((_0xbc7c5[_0x5543c4(0x2e6)]==_0x5543c4(0x2d7)||_0xbc7c5[_0x5543c4(0x2e6)]==0x4)&&!_0xbc7c5[_0x5543c4(0x3a4)]){const _0x292434=ipaddr['parse'](_0xbc7c5[_0x5543c4(0x2be)])[_0x5543c4(0x25f)]();_0x292434!=_0x5543c4(0x391)&&(!_0x577a64[_0x4ca93d]&&(_0x577a64[_0x4ca93d]=[]),_0x577a64[_0x4ca93d][_0x5543c4(0x1f3)](_0xbc7c5[_0x5543c4(0x2be)]),_0xa4d491=_0xbc7c5['address']);}}}return{'serverip':_0xa4d491,'netinterfaces':_0x577a64};}async function startServer(){const _0xd435d9=_0x32759a,{serverip:_0x59d23e,netinterfaces:_0x5144b0}=getServerIP();logger[_0xd435d9(0x368)](''),logger[_0xd435d9(0x368)](_0xd435d9(0x1c8)),await logger[_0xd435d9(0x37f)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0xd435d9(0x2ff)?_0xd435d9(0x250):'')+'\x0a'+(_0xd435d9(0x220)+PORT+_0xd435d9(0x1ba))+(_0xd435d9(0x263)+_0x59d23e+':'+PORT+_0xd435d9(0x36b))),logger['simple'](_0xd435d9(0x1c8));if(config[_0xd435d9(0x268)]!=0x0)for(const _0x4dcc01 of config){const _0x58090a=_0x4dcc01['mode']=='auto'?'a':'m';if(_0x4dcc01[_0xd435d9(0x19b)]==_0xd435d9(0x2bc)||_0x4dcc01[_0xd435d9(0x19b)]==_0xd435d9(0x2ea))await logger[_0xd435d9(0x37f)](_0xd435d9(0x331)+_0x58090a+_0xd435d9(0x2cc)+_0x4dcc01['botID']+_0xd435d9(0x213)+_0x4dcc01[_0xd435d9(0x2ce)]),startBot([_0x4dcc01[_0xd435d9(0x261)],userID],{'cwd':bbpath},function(_0x511198){const _0x31c1d2=_0xd435d9;if(_0x511198)logger[_0x31c1d2(0x37f)](_0x511198);});else(_0x4dcc01[_0xd435d9(0x19b)]==_0xd435d9(0x25a)||_0x4dcc01[_0xd435d9(0x19b)]=='new-disabled')&&await logger[_0xd435d9(0x37f)](_0xd435d9(0x2a8)+_0x58090a+_0xd435d9(0x307)+_0x4dcc01['botID']+'\x20|\x20'+_0x4dcc01['botname']);}else!newBot&&logger['simple'](_0xd435d9(0x38b));if(newBot)addBot();logger[_0xd435d9(0x368)](_0xd435d9(0x1c8)),logger['simple'](''),await logger[_0xd435d9(0x1a5)](_0xd435d9(0x240)+nodeversion),await logger[_0xd435d9(0x1a5)](_0xd435d9(0x1ef),_0x5144b0);}function startSocket(){const _0x393e8c=_0x32759a;io['on'](_0x393e8c(0x27a),_0x4ceab2=>{const _0x31cd37=_0x393e8c;let _0x2ac1b0,_0x5be39b,_0xe96c8e,_0x398424,_0x30865b;const _0x629ccf=_0x4ceab2[_0x31cd37(0x361)][_0x31cd37(0x386)][_0x31cd37(0x375)];_0x5be39b=_0x629ccf[_0x31cd37(0x1ee)](/bot[0-9]{3}/);if(_0x5be39b)_0xe96c8e=_0x5be39b[0x0][_0x31cd37(0x1ee)](/[0-9]{3}/);if(_0xe96c8e)_0x2ac1b0=_0xe96c8e[0x0];else _0x2ac1b0='botmanager';const _0x462686=_0x4ceab2[_0x31cd37(0x361)]['auth'][_0x31cd37(0x1ec)];if(!_0x462686)_0x4ceab2[_0x31cd37(0x196)](_0x31cd37(0x19b),{'publicKey':secure[_0x31cd37(0x245)]});else{_0x398424=timelyDecrypt(_0x462686,![]);if(!_0x398424)_0x4ceab2['emit']('status',{'publicKey':secure[_0x31cd37(0x245)]});else{_0x30865b=normalizeIP(_0x4ceab2['conn'][_0x31cd37(0x2f3)])[_0x31cd37(0x201)];if(!devices[_0x398424])devices[_0x398424]={'uuid':_0x398424,'access':{'token':null}};devices[_0x398424]['ip']=_0x30865b;const _0x3298eb=addClient(_0x4ceab2['id'],_0x398424,_0x2ac1b0);setAccess(_0x3298eb),emitMessages(),_0x4ceab2['on']('login',_0x4355b6=>{const _0x8b4c1c=_0x31cd37,_0x10ef50=timelyDecrypt(_0x4355b6['password'],!![],'|@|');if(_0x10ef50){_0x4355b6={'username':_0x4355b6[_0x8b4c1c(0x1e1)],'password':_0x10ef50},devices[_0x398424][_0x8b4c1c(0x291)]=validateCredentials(_0x4355b6,_0x398424);if(devices[_0x398424][_0x8b4c1c(0x291)]['allow']==![]&&devices[_0x398424][_0x8b4c1c(0x291)][_0x8b4c1c(0x1bc)]=='2FA\x20login\x20required')_0x4ceab2[_0x8b4c1c(0x196)](_0x8b4c1c(0x19b),{'access':devices[_0x398424][_0x8b4c1c(0x291)]}),loginAccess2FA(_0x398424,_0x30865b);else{if(devices[_0x398424][_0x8b4c1c(0x291)][_0x8b4c1c(0x228)]==![]&&devices[_0x398424][_0x8b4c1c(0x291)][_0x8b4c1c(0x1bc)]==_0x8b4c1c(0x21c))_0x4ceab2[_0x8b4c1c(0x196)](_0x8b4c1c(0x19b),{'access':devices[_0x398424]['access']});else devices[_0x398424]['access'][_0x8b4c1c(0x228)]&&devices[_0x398424][_0x8b4c1c(0x291)][_0x8b4c1c(0x1bc)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x398424)[_0x8b4c1c(0x1c0)](_0x536a59=>{setAccess(_0x536a59);}),logger[_0x8b4c1c(0x1a5)]('Logged\x20in\x20user\x20...'+_0x398424[_0x8b4c1c(0x3a6)](-0x8)),setTokenRefresh(_0x398424),setSessionTimeout(_0x8b4c1c(0x372),_0x398424));}}else logger['full'](_0x8b4c1c(0x29b));}),_0x4ceab2['on'](_0x31cd37(0x340),()=>{resetPassword();}),_0x4ceab2['on']('disconnect',_0x49e17b=>{removeClient(_0x4ceab2['id']);}),_0x2ac1b0=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xbd5ea2){const _0x3ad662=_0x32759a;if(_0xbd5ea2!=_0x3ad662(0x1fc)&&config[_0x3ad662(0x314)]!=''){if(pid[_0xbd5ea2])pid[_0xbd5ea2][_0x3ad662(0x1a4)]({'function':'initclient','args':null});}_0xbd5ea2!=_0x3ad662(0x1fc)&&broadcastToBots(_0x3ad662(0x1f8),JSON[_0x3ad662(0x253)](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0x4a2324=>{const _0x8ce9bc=_0x50e8;getSocket(_0x4a2324['id'])[_0x8ce9bc(0x196)](_0x8ce9bc(0x19b),{'access':{'allow':![],'reason':_0x8ce9bc(0x36f),'token':null}});});}function getSocket(_0x164d82){const _0x2b3343=_0x32759a,_0xad5356=io[_0x2b3343(0x33b)][_0x2b3343(0x36e)]('/');return _0xad5356['sockets'][_0x2b3343(0x36e)](_0x164d82);}function setAccess(_0x4a8b08){const _0x422a18=_0x32759a,_0x5e594d=getSocket(_0x4a8b08['id']),_0x3aa6d8=_0x4a8b08[_0x422a18(0x217)],_0x19dedf=_0x4a8b08[_0x422a18(0x20e)];devices[_0x3aa6d8]['access']=validateAccess(devices[_0x3aa6d8][_0x422a18(0x291)][_0x422a18(0x31e)],_0x3aa6d8),logger['debug'](_0x422a18(0x2f8)+devices[_0x3aa6d8][_0x422a18(0x291)]['reason']+_0x422a18(0x292)+_0x4a8b08['id']['slice'](-0x8)+_0x422a18(0x1e3)+_0x3aa6d8[_0x422a18(0x3a6)](-0x8)),_0x5e594d[_0x422a18(0x36a)](_0x3aa6d8);if(devices[_0x3aa6d8][_0x422a18(0x291)][_0x422a18(0x228)]){_0x5e594d['join'](_0x19dedf);if(_0x19dedf==_0x422a18(0x1fc))initializeSocketBotManager(_0x5e594d);else initializeSocketBot(_0x5e594d);initClient(_0x19dedf);}devices[_0x3aa6d8]['access'][_0x422a18(0x31e)]&&devices[_0x3aa6d8][_0x422a18(0x291)][_0x422a18(0x1bc)]==_0x422a18(0x341)&&setSessionTimeout(_0x422a18(0x387),_0x3aa6d8),devices[_0x3aa6d8][_0x422a18(0x291)][_0x422a18(0x31e)]&&devices[_0x3aa6d8][_0x422a18(0x291)][_0x422a18(0x1bc)]==_0x422a18(0x304)&&setSessionTimeout(_0x422a18(0x372),_0x3aa6d8),_0x5e594d[_0x422a18(0x196)](_0x422a18(0x19b),{'status':_0x4a8b08['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3aa6d8][_0x422a18(0x291)],'externalip':devices[_0x3aa6d8]['ip'],'publicKey':secure[_0x422a18(0x245)],'userid':settings[_0x422a18(0x1d9)],'validInstallation':validInstallation}),devices[_0x3aa6d8][_0x422a18(0x291)]['allow']==![]&&devices[_0x3aa6d8][_0x422a18(0x291)][_0x422a18(0x1bc)]==_0x422a18(0x34d)&&temporaryAccess2FA(_0x3aa6d8,devices[_0x3aa6d8]['ip']);}function setSessionTimeout(_0x20607b,_0x133078){const _0x599f0a=_0x32759a;let _0x3121f6;if(_0x20607b==_0x599f0a(0x372))_0x3121f6=loginExpiry*0x3c*0x3e8;else _0x3121f6=devices[_0x133078][_0x599f0a(0x2cd)][_0x599f0a(0x2db)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x133078][_0x599f0a(0x2cd)][_0x599f0a(0x395)]);if(devices[_0x133078][_0x599f0a(0x265)])clearTimeout(devices[_0x133078][_0x599f0a(0x265)]);devices[_0x133078][_0x599f0a(0x265)]=setTimeout(()=>{const _0x47d19c=_0x599f0a;if(devices[_0x133078]['pidRefreshToken'])clearTimeout(devices[_0x133078][_0x47d19c(0x1ff)]);removeSocketListeners(_0x133078),addBlacklist(_0x133078),devices[_0x133078][_0x47d19c(0x2cd)]=null,devices[_0x133078][_0x47d19c(0x238)]=null,devices[_0x133078]['access'][_0x47d19c(0x31e)]=null,logger['debug'](_0x47d19c(0x1ce)+_0x133078[_0x47d19c(0x3a6)](-0x8)),devices[_0x133078][_0x47d19c(0x291)]=validateAccess(devices[_0x133078]['access'][_0x47d19c(0x31e)],_0x133078),!(devices[_0x133078]['access'][_0x47d19c(0x228)]&&devices[_0x133078][_0x47d19c(0x291)]['reason']==_0x47d19c(0x221))&&(_0x20607b==_0x47d19c(0x372)?io['to'](_0x133078)['emit'](_0x47d19c(0x19b),{'access':{'allow':![],'reason':_0x47d19c(0x383),'token':null}}):io['to'](_0x133078)[_0x47d19c(0x196)](_0x47d19c(0x19b),{'access':{'allow':![],'reason':_0x47d19c(0x22c),'token':null}})),devices[_0x133078]['access'][_0x47d19c(0x31e)]=null;},_0x3121f6);}function setTokenRefresh(_0x1cd016){const _0x11ce82=_0x32759a;if(devices[_0x1cd016]['pidRefreshToken'])clearTimeout(devices[_0x1cd016][_0x11ce82(0x1ff)]);devices[_0x1cd016][_0x11ce82(0x1ff)]=setTimeout(()=>{const _0x5ad9f2=_0x11ce82;getClientsWithUuid(_0x1cd016)[_0x5ad9f2(0x268)]!=0x0?(devices[_0x1cd016][_0x5ad9f2(0x291)]=refreshToken(_0x1cd016),io['to'](_0x1cd016)[_0x5ad9f2(0x196)](_0x5ad9f2(0x19b),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1cd016]['access'],'externalip':devices[_0x1cd016]['ip'],'publicKey':secure[_0x5ad9f2(0x245)],'validInstallation':validInstallation}),setTokenRefresh(_0x1cd016)):clearTimeout(devices[_0x1cd016]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4c5537){const _0x547280=_0x32759a,_0x1f9b28=getClient(_0x4c5537['id'])[_0x547280(0x217)];_0x4c5537[_0x547280(0x196)]('bots',config),_0x4c5537[_0x547280(0x196)](_0x547280(0x1b9),cleanSettings()),_0x4c5537['on'](_0x547280(0x255),_0x337b4d=>{const _0x40c310=_0x547280;if(validateAccess(_0x337b4d,_0x1f9b28)['allow'])addBot();else logger[_0x40c310(0x37f)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x4c5537['on'](_0x547280(0x2ac),(_0x2c01d0,_0x31200a)=>{const _0x5b9823=_0x547280;if(validateAccess(_0x31200a,_0x1f9b28)[_0x5b9823(0x228)])toggleBot(_0x2c01d0[_0x5b9823(0x261)],_0x2c01d0[_0x5b9823(0x19b)],_0x2c01d0['live']);else logger[_0x5b9823(0x37f)](_0x5b9823(0x26c));}),_0x4c5537['on'](_0x547280(0x2b4),(_0xd503,_0x2e41ee)=>{const _0x58ccc4=_0x547280;if(validateAccess(_0x2e41ee,_0x1f9b28)[_0x58ccc4(0x228)])toggleBotMode(_0xd503);else logger[_0x58ccc4(0x37f)](_0x58ccc4(0x26c));}),_0x4c5537['on'](_0x547280(0x24d),(_0x4602b2,_0x42e481)=>{const _0x220859=_0x547280;if(validateAccess(_0x42e481,_0x1f9b28)[_0x220859(0x228)])deleteBot(_0x4602b2);else logger[_0x220859(0x37f)](_0x220859(0x32a));}),_0x4c5537['on']('store-settings',(_0x370448,_0x2eee5c)=>{if(validateAccess(_0x2eee5c,_0x1f9b28)['allow'])storeSettings(_0x370448,!![]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x4c5537['on'](_0x547280(0x224),_0x1d442d=>{const _0x376001=_0x547280;if(validateAccess(_0x1d442d,_0x1f9b28)[_0x376001(0x228)])updateBB(_0x376001(0x360));else logger[_0x376001(0x37f)](_0x376001(0x37c));}),_0x4c5537['on'](_0x547280(0x32f),_0x254f2c=>{const _0x4269f9=_0x547280;if(validateAccess(_0x254f2c,_0x1f9b28)['allow'])updateBB('reinstall');else logger['full'](_0x4269f9(0x24f));}),_0x4c5537['on'](_0x547280(0x311),_0x45ae20=>{const _0xc946=_0x547280;if(validateAccess(_0x45ae20,_0x1f9b28)['allow']){const _0x17cd57=getClient(_0x4c5537['id']);if(_0x17cd57)getBackupFiles(_0x17cd57[_0xc946(0x217)]);else logger['full']('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0xc946(0x37f)](_0xc946(0x28d));}),_0x4c5537['on'](_0x547280(0x2e2),(_0x34810e,_0x39efea)=>{const _0x180181=_0x547280;if(validateAccess(_0x39efea,_0x1f9b28)[_0x180181(0x228)])restoreBackupFile(_0x34810e);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x4c5537['on'](_0x547280(0x1d8),_0x1d371f=>{const _0x36ab27=_0x547280;if(validateAccess(_0x1d371f,_0x1f9b28)[_0x36ab27(0x228)])getMessages();else logger[_0x36ab27(0x37f)](_0x36ab27(0x27d));}),_0x4c5537['on'](_0x547280(0x200),(_0x897030,_0x1a1d9c)=>{const _0x15805d=_0x547280;if(validateAccess(_0x1a1d9c,_0x1f9b28)[_0x15805d(0x228)])confirmMessage(_0x897030);else logger[_0x15805d(0x37f)](_0x15805d(0x3a7));}),_0x4c5537['on'](_0x547280(0x367),_0x1c21b6=>{const _0x3ec578=_0x547280;if(validateAccess(_0x1c21b6,_0x1f9b28)['allow']){if(devices[_0x1f9b28][_0x3ec578(0x1ff)])clearTimeout(devices[_0x1f9b28]['pidRefreshToken']);if(devices[_0x1f9b28][_0x3ec578(0x265)])clearTimeout(devices[_0x1f9b28][_0x3ec578(0x265)]);removeSocketListeners(getClient(_0x4c5537['id'])[_0x3ec578(0x217)]),addBlacklist(_0x1f9b28),devices[_0x1f9b28][_0x3ec578(0x2cd)]=null,devices[_0x1f9b28][_0x3ec578(0x238)]=null,devices[_0x1f9b28][_0x3ec578(0x291)][_0x3ec578(0x31e)]=null,logger[_0x3ec578(0x1a5)](_0x3ec578(0x283)+_0x1f9b28[_0x3ec578(0x3a6)](-0x8)),io['to'](getClient(_0x4c5537['id'])[_0x3ec578(0x217)])[_0x3ec578(0x196)](_0x3ec578(0x19b),{'access':{'allow':![],'reason':_0x3ec578(0x2a2),'token':null}});}else logger[_0x3ec578(0x37f)](_0x3ec578(0x21d));});}function initializeSocketBot(_0x1df585){const _0x244ca0=_0x32759a,_0x276f67=getClient(_0x1df585['id'])[_0x244ca0(0x20e)],_0x43492d=getClient(_0x1df585['id'])['uuid'];_0x1df585['on'](_0x244ca0(0x1b6),(_0x1d00da,_0x155a5a)=>{const _0x35435e=_0x244ca0;if(validateAccess(_0x155a5a,_0x43492d)['allow']){if(pid[_0x276f67])pid[_0x276f67][_0x35435e(0x1a4)]({'function':_0x35435e(0x1bb),'args':_0x1d00da});}else logger[_0x35435e(0x37f)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x1df585['on'](_0x244ca0(0x300),(_0x4adfe5,_0x1ad1fc)=>{const _0x28830f=_0x244ca0;if(validateAccess(_0x1ad1fc,_0x43492d)['allow']){if(pid[_0x276f67])pid[_0x276f67]['send']({'function':_0x28830f(0x21a),'args':_0x4adfe5});}else logger[_0x28830f(0x37f)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x1df585['on'](_0x244ca0(0x23e),(_0xd2123a,_0x2bba58)=>{const _0x6114ae=_0x244ca0;if(validateAccess(_0x2bba58,_0x43492d)[_0x6114ae(0x228)]){if(pid[_0x276f67])pid[_0x276f67][_0x6114ae(0x1a4)]({'function':'getPortfolio','args':_0xd2123a});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x1df585['on']('store-configuration',(_0xc12a5e,_0x5edd44)=>{const _0x26694b=_0x244ca0;if(validateAccess(_0x5edd44,_0x43492d)['allow']){if(pid[_0x276f67])pid[_0x276f67][_0x26694b(0x1a4)]({'function':_0x26694b(0x25e),'args':_0xc12a5e});}else logger[_0x26694b(0x37f)](_0x26694b(0x30c));}),_0x1df585['on'](_0x244ca0(0x346),(_0x31e938,_0x406306)=>{const _0x1df4b2=_0x244ca0;if(validateAccess(_0x406306,_0x43492d)[_0x1df4b2(0x228)]){if(pid[_0x276f67])pid[_0x276f67]['send']({'function':_0x1df4b2(0x2f2),'args':_0x31e938});}else logger['full'](_0x1df4b2(0x380));}),_0x1df585['on'](_0x244ca0(0x246),(_0x2b6a97,_0x94d979)=>{const _0x15b6e1=_0x244ca0;if(validateAccess(_0x94d979,_0x43492d)[_0x15b6e1(0x228)]){if(pid[_0x276f67])pid[_0x276f67][_0x15b6e1(0x1a4)]({'function':'storeFiat','args':_0x2b6a97});}else logger['full'](_0x15b6e1(0x233));}),_0x1df585['on']('reset-history',_0x55e697=>{const _0x4cb3c1=_0x244ca0;if(validateAccess(_0x55e697,_0x43492d)[_0x4cb3c1(0x228)]){if(pid[_0x276f67])pid[_0x276f67][_0x4cb3c1(0x1a4)]({'function':'resetHistory','args':null});}else logger[_0x4cb3c1(0x37f)](_0x4cb3c1(0x279));}),_0x1df585['on'](_0x244ca0(0x254),_0x4f52b2=>{const _0x1a205f=_0x244ca0;if(validateAccess(_0x4f52b2,_0x43492d)[_0x1a205f(0x228)]){if(pid[_0x276f67])pid[_0x276f67][_0x1a205f(0x1a4)]({'function':_0x1a205f(0x26e),'args':null});}else logger['full'](_0x1a205f(0x1f4));}),_0x1df585['on'](_0x244ca0(0x1ab),(_0xf7807b,_0x13a5fe)=>{const _0x4450ac=_0x244ca0;if(validateAccess(_0x13a5fe,_0x43492d)[_0x4450ac(0x228)]){if(pid[_0x276f67])pid[_0x276f67]['send']({'function':_0x4450ac(0x249),'args':_0xf7807b});}else logger[_0x4450ac(0x37f)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x1df585['on'](_0x244ca0(0x2e4),_0x176d05=>{const _0x211d01=_0x244ca0;if(validateAccess(_0x176d05,_0x43492d)[_0x211d01(0x228)]){if(pid[_0x276f67])pid[_0x276f67][_0x211d01(0x1a4)]({'function':_0x211d01(0x350),'args':null});}else logger[_0x211d01(0x37f)](_0x211d01(0x328));}),_0x1df585['on']('show-config',_0x7e4369=>{const _0x46b2e5=_0x244ca0;if(validateAccess(_0x7e4369,_0x43492d)[_0x46b2e5(0x228)]){if(pid[_0x276f67])pid[_0x276f67][_0x46b2e5(0x1a4)]({'function':_0x46b2e5(0x1a6),'args':null});}else logger[_0x46b2e5(0x37f)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x1df585['on'](_0x244ca0(0x224),_0x4bd606=>{const _0x4f7af5=_0x244ca0;if(validateAccess(_0x4bd606,_0x43492d)[_0x4f7af5(0x228)])updateBB('update');else logger[_0x4f7af5(0x37f)](_0x4f7af5(0x37c));}),_0x1df585['on'](_0x244ca0(0x1d8),_0xa8502d=>{const _0x464799=_0x244ca0;if(validateAccess(_0xa8502d,_0x43492d)['allow'])getMessages();else logger[_0x464799(0x37f)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1df585['on'](_0x244ca0(0x200),(_0x5d2d5c,_0x23eb82)=>{const _0x4b8932=_0x244ca0;if(validateAccess(_0x23eb82,_0x43492d)[_0x4b8932(0x228)])confirmMessage(_0x5d2d5c);else logger[_0x4b8932(0x37f)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x1df585['on'](_0x244ca0(0x367),_0x595f4a=>{const _0x5952b5=_0x244ca0;if(validateAccess(_0x595f4a,_0x43492d)[_0x5952b5(0x228)]){if(devices[_0x43492d]['pidRefreshToken'])clearTimeout(devices[_0x43492d][_0x5952b5(0x1ff)]);if(devices[_0x43492d][_0x5952b5(0x265)])clearTimeout(devices[_0x43492d][_0x5952b5(0x265)]);removeSocketListeners(getClient(_0x1df585['id'])['uuid']),addBlacklist(_0x43492d),devices[_0x43492d]['telegramIpApproval']=null,devices[_0x43492d][_0x5952b5(0x238)]=null,devices[_0x43492d][_0x5952b5(0x291)][_0x5952b5(0x31e)]=null,logger['debug'](_0x5952b5(0x283)+_0x43492d['slice'](-0x8)),io['to'](getClient(_0x1df585['id'])[_0x5952b5(0x217)])[_0x5952b5(0x196)](_0x5952b5(0x19b),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x5952b5(0x37f)](_0x5952b5(0x21d));});}function removeSocketListeners(_0x1c04c8){const _0x45f762=_0x32759a;getClientsWithUuid(_0x1c04c8)[_0x45f762(0x1c0)](_0x7e60ce=>{const _0x41cf80=_0x45f762;getSocket(_0x7e60ce['id'])[_0x41cf80(0x2a6)]();});}function cleanSettings(){const _0x1027a0=_0x32759a;let _0x461f80=settings;return settings[_0x1027a0(0x1c5)]&&settings[_0x1027a0(0x1c5)]!=''&&(_0x461f80={..._0x461f80,'telegramToken':'************'}),settings[_0x1027a0(0x274)]&&settings[_0x1027a0(0x274)]!=''&&(_0x461f80={..._0x461f80,'bbPassword':_0x1027a0(0x323)}),settings[_0x1027a0(0x28a)]&&settings['marketcapApi']!=''&&(_0x461f80={..._0x461f80,'marketcapApi':_0x1027a0(0x323)}),(settings[_0x1027a0(0x274)]&&settings['bbPassword']==_0x1027a0(0x309)||settings[_0x1027a0(0x1c5)]&&settings[_0x1027a0(0x1c5)]==_0x1027a0(0x309)||settings[_0x1027a0(0x28a)]&&settings[_0x1027a0(0x28a)]==_0x1027a0(0x309))&&(_0x461f80={..._0x461f80,'restored':{'password':settings[_0x1027a0(0x274)]==_0x1027a0(0x309),'telegram':settings[_0x1027a0(0x1c5)]=='***','marketcap':settings['marketcapApi']==_0x1027a0(0x309)}}),_0x461f80;}async function updateBB(_0x31b5a6){const _0xec55c8=_0x32759a;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x5d2ced=>{const _0x21b7bc=_0x50e8;restartBot(_0x5d2ced[_0x21b7bc(0x261)]);});if(_0x31b5a6==_0xec55c8(0x360))process[_0xec55c8(0x1a4)]({'update':!![],'environment':environment},_0x31f7db=>{});else _0x31b5a6=='reinstall'&&process[_0xec55c8(0x1a4)]({'reinstall':!![],'environment':environment},_0x324e01=>{});}function startBot(_0x2d801c,_0x37214f,_0x41ef37){const _0x10e9a6=_0x32759a;if(debugging)_0x2d801c[_0x10e9a6(0x1f3)]('-d');if(recreate)_0x2d801c[_0x10e9a6(0x1f3)]('-r');let _0x385a51=![];const _0x122a0a=_0x2d801c[0x0];_0x37214f={..._0x37214f,'stdio':[_0x10e9a6(0x32d),_0x10e9a6(0x32d),_0x10e9a6(0x32d),_0x10e9a6(0x39c)]},pid[_0x122a0a]=childProcess[_0x10e9a6(0x2f0)](botfile,_0x2d801c,_0x37214f),pid[_0x122a0a]['on'](_0x10e9a6(0x318),_0x45e67d=>{const _0x3faf71=_0x10e9a6;switch(Object[_0x3faf71(0x30f)](_0x45e67d)[0x0]){case'botname':updateBotName(_0x122a0a,_0x45e67d['botname']);break;case _0x3faf71(0x356):updateBotManager();break;case _0x3faf71(0x19b):updateStatus(_0x122a0a,_0x45e67d['status']);break;case _0x3faf71(0x20a):updateLive(_0x122a0a,_0x45e67d['live']);break;case'started':updateLive(_0x122a0a,_0x45e67d[_0x3faf71(0x2a5)]),io['to'](_0x122a0a)[_0x3faf71(0x196)]('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x3faf71(0x1b7):_0x45e67d['stop']=='restart'&&restartBot(_0x122a0a);_0x45e67d[_0x3faf71(0x1b7)]==_0x3faf71(0x28c)&&toggleBot(_0x122a0a,_0x3faf71(0x25a),_0x3faf71(0x247));break;case _0x3faf71(0x1dd):sendTelegramBot(_0x122a0a,_0x45e67d[_0x3faf71(0x1dd)]);break;case _0x3faf71(0x2da):sendTelegramMsg(_0x45e67d[_0x3faf71(0x2da)]);break;case'function':io['to'](_0x122a0a)[_0x3faf71(0x196)](_0x45e67d[_0x3faf71(0x38e)],_0x45e67d[_0x3faf71(0x30e)]);break;}}),pid[_0x122a0a]['on'](_0x10e9a6(0x2e0),function(_0x177e18){if(_0x385a51)return;_0x385a51=!![],_0x41ef37(_0x177e18);}),pid[_0x122a0a]['on'](_0x10e9a6(0x348),async function(_0x5ee4a7){const _0x3af4c5=_0x10e9a6;if(terminating)return;if(installingUpdate){io[_0x3af4c5(0x212)]();return;}if(_0x385a51)return;_0x385a51=!![],_0x41ef37(null);const _0x5d4d3a=dbConfig['get'](_0x3af4c5(0x1f8))['find']({'botID':_0x122a0a})[_0x3af4c5(0x2f6)]();_0x5d4d3a&&(_0x5d4d3a['status']==_0x3af4c5(0x2bc)||_0x5d4d3a[_0x3af4c5(0x19b)]==_0x3af4c5(0x2ea))&&(await sleep(0x3e8),updateLive(_0x122a0a,_0x3af4c5(0x247)),logger['full']('Restarting\x20'+botRef(_0x122a0a)),startBot([_0x122a0a,userID],{'cwd':bbpath},function(_0x526cc8){const _0x51ada9=_0x3af4c5;if(_0x526cc8)logger[_0x51ada9(0x37f)](_0x526cc8);}));});}function stopBot(_0x42cff9){const _0x40684e=_0x32759a;getClientsWithBotID(_0x42cff9)[_0x40684e(0x1c0)](_0x2fc1d5=>{const _0x30d4a2=_0x40684e;getSocket(_0x2fc1d5['id'])[_0x30d4a2(0x389)](!![]),removeClient(_0x2fc1d5['id']);}),pid[_0x42cff9]&&(pid[_0x42cff9]['kill'](),pid[_0x42cff9]=null);}function stopAllBots(){const _0x1e677f=_0x32759a;terminating=!![];const _0x4baf24=getEnabledBots();_0x4baf24[_0x1e677f(0x1c0)](_0x589f88=>{stopBot(_0x589f88['botID']);});}function restartBot(_0x44df6e){if(pid[_0x44df6e])pid[_0x44df6e]['kill']();}function addBot(){const _0x44acc6=_0x32759a;let _0x139060;for(let _0x29a3a8=0x1;_0x29a3a8<0x3e9;_0x29a3a8++){_0x139060=_0x29a3a8['toString']()[_0x44acc6(0x1d2)](0x3,'0');let _0x48a5d2=config[_0x44acc6(0x376)](_0x103eaf=>_0x103eaf[_0x44acc6(0x261)]==_0x139060);if(!_0x48a5d2)break;}if(_0x139060===_0x44acc6(0x270)){logger['full'](_0x44acc6(0x260));return;}logger[_0x44acc6(0x37f)](_0x44acc6(0x299)+_0x139060),dbConfig['get']('bots')[_0x44acc6(0x1f3)]({'botID':_0x139060,'botname':_0x44acc6(0x2c9)+_0x139060,'status':_0x44acc6(0x2ea),'live':''})['write'](),startBot([_0x139060,userID],{'cwd':bbpath},function(_0x3f66b2){const _0x399429=_0x44acc6;if(_0x3f66b2)logger[_0x399429(0x37f)](_0x3f66b2);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0x44acc6(0x1f8),config),broadcastToBots('bots',JSON[_0x44acc6(0x253)](config));}function deleteBot(_0xb2947d){const _0x3d9aca=_0x32759a;getClientsWithBotID(_0xb2947d)[_0x3d9aca(0x1c0)](_0x13e008=>{const _0x3d5416=_0x3d9aca;getSocket(_0x13e008['id'])[_0x3d5416(0x389)](!![]),removeClient(_0x13e008['id']);}),dbConfig[_0x3d9aca(0x36e)](_0x3d9aca(0x1f8))['remove']({'botID':_0xb2947d})['write'](),logger[_0x3d9aca(0x37f)](_0x3d9aca(0x3a1)+_0xb2947d),stopBot(_0xb2947d);try{if(fs[_0x3d9aca(0x258)](path['join'](configpath,_0x3d9aca(0x24c)+_0xb2947d+_0x3d9aca(0x2aa))))fs['unlinkSync'](path[_0x3d9aca(0x36a)](configpath,_0x3d9aca(0x24c)+_0xb2947d+_0x3d9aca(0x2aa)));if(fs['existsSync'](path[_0x3d9aca(0x36a)](configpath,_0x3d9aca(0x24c)+_0xb2947d+_0x3d9aca(0x30a))))fs['unlinkSync'](path[_0x3d9aca(0x36a)](configpath,'bot-'+_0xb2947d+_0x3d9aca(0x30a)));if(fs[_0x3d9aca(0x258)](path[_0x3d9aca(0x36a)](configpath,_0x3d9aca(0x24c)+_0xb2947d+_0x3d9aca(0x355))))fs[_0x3d9aca(0x2dd)](path[_0x3d9aca(0x36a)](configpath,_0x3d9aca(0x24c)+_0xb2947d+_0x3d9aca(0x355)));if(fs[_0x3d9aca(0x258)](path[_0x3d9aca(0x36a)](configpath,_0x3d9aca(0x24c)+_0xb2947d+_0x3d9aca(0x23b))))fs[_0x3d9aca(0x2dd)](path[_0x3d9aca(0x36a)](configpath,'bot-'+_0xb2947d+_0x3d9aca(0x23b)));}catch(_0x235201){if(_0x235201)logger[_0x3d9aca(0x37f)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x235201);}config=getConfiguration(),io['to'](_0x3d9aca(0x1fc))['emit'](_0x3d9aca(0x1f8),config),broadcastToBots('bots',JSON[_0x3d9aca(0x253)](config));}function toggleBot(_0x35d94c,_0x11c268,_0xa90f1b){const _0x566ca8=_0x32759a;dbConfig[_0x566ca8(0x36e)](_0x566ca8(0x1f8))[_0x566ca8(0x376)]({'botID':_0x35d94c})[_0x566ca8(0x1e6)]({'status':_0x11c268})['assign']({'live':_0xa90f1b})[_0x566ca8(0x294)]();const _0x2bfce6=botRef(_0x35d94c);if(_0x11c268==_0x566ca8(0x2bc)||_0x11c268=='new')logger[_0x566ca8(0x37f)]('Enabled\x20'+_0x2bfce6),startBot([_0x35d94c,userID],{'cwd':bbpath},function(_0x4c0459){const _0x59c84c=_0x566ca8;if(_0x4c0459)logger[_0x59c84c(0x37f)](_0x4c0459);});else(_0x11c268==_0x566ca8(0x25a)||_0x11c268==_0x566ca8(0x2f7))&&(logger[_0x566ca8(0x37f)](_0x566ca8(0x303)+_0x2bfce6),stopBot(_0x35d94c));config=getConfiguration(),io['to'](_0x566ca8(0x1fc))['emit'](_0x566ca8(0x1f8),config),broadcastToBots(_0x566ca8(0x1f8),JSON[_0x566ca8(0x253)](config));}function toggleStatus(_0x278ce2){const _0x21812e=_0x32759a;let _0x42d944=dbConfig[_0x21812e(0x36e)](_0x21812e(0x1f8))[_0x21812e(0x376)]({'botID':_0x278ce2})[_0x21812e(0x2f6)](),_0x2410f4;if(_0x42d944[_0x21812e(0x19b)]===_0x21812e(0x2bc))_0x2410f4=_0x21812e(0x25a);else{if(_0x42d944[_0x21812e(0x19b)]===_0x21812e(0x2ea))_0x2410f4=_0x21812e(0x2f7);else{if(_0x42d944[_0x21812e(0x19b)]===_0x21812e(0x2f7))_0x2410f4='new';else{if(_0x42d944[_0x21812e(0x19b)]==='disabled')_0x2410f4=_0x21812e(0x2bc);}}}return _0x2410f4;}function updateStatus(_0x493903,_0x3117e1){const _0x5ae8b5=_0x32759a;dbConfig[_0x5ae8b5(0x36e)](_0x5ae8b5(0x1f8))[_0x5ae8b5(0x376)]({'botID':_0x493903})[_0x5ae8b5(0x1e6)]({'status':_0x3117e1})[_0x5ae8b5(0x294)](),config=getConfiguration(),io['to'](_0x5ae8b5(0x1fc))[_0x5ae8b5(0x196)](_0x5ae8b5(0x1f8),config),broadcastToBots(_0x5ae8b5(0x1f8),JSON[_0x5ae8b5(0x253)](config));}function updateLive(_0x5ce8d8,_0x2843e2){const _0x4f42d8=_0x32759a;dbConfig[_0x4f42d8(0x36e)]('bots')[_0x4f42d8(0x376)]({'botID':_0x5ce8d8})[_0x4f42d8(0x1e6)]({'live':_0x2843e2})[_0x4f42d8(0x294)](),config=getConfiguration(),io['to'](_0x4f42d8(0x1fc))['emit'](_0x4f42d8(0x1f8),config),broadcastToBots(_0x4f42d8(0x1f8),JSON[_0x4f42d8(0x253)](config));}function updateBotName(_0x4b1947,_0x4a9517){const _0x4e3f75=_0x32759a;dbConfig[_0x4e3f75(0x36e)](_0x4e3f75(0x1f8))[_0x4e3f75(0x376)]({'botID':_0x4b1947})[_0x4e3f75(0x1e6)]({'botname':_0x4a9517})[_0x4e3f75(0x294)](),config=getConfiguration(),io['to'](_0x4e3f75(0x1fc))[_0x4e3f75(0x196)]('bots',config),broadcastToBots(_0x4e3f75(0x1f8),JSON['stringify'](config));}function updateBotManager(){const _0x2cc41b=_0x32759a;config=getConfiguration(),io['to'](_0x2cc41b(0x1fc))[_0x2cc41b(0x196)](_0x2cc41b(0x1f8),config),broadcastToBots(_0x2cc41b(0x1f8),JSON['stringify'](config));}function toggleBotMode(_0x1ab2db){const _0x3ca808=_0x32759a;if(pid[_0x1ab2db])pid[_0x1ab2db][_0x3ca808(0x1a4)]({'function':_0x3ca808(0x2d0),'args':null});else{const _0x225bbd=configpath+_0x3ca808(0x24c)+_0x1ab2db+_0x3ca808(0x2aa),_0x43ed5b=fs[_0x3ca808(0x39d)](_0x225bbd),_0x2013e6=JSON[_0x3ca808(0x266)](_0x43ed5b),_0x55df09=_0x2013e6[_0x3ca808(0x20e)][0x0][_0x3ca808(0x2a3)];_0x2013e6[_0x3ca808(0x20e)][0x0][_0x3ca808(0x2a3)]=!_0x55df09;const _0x2bf44f=JSON[_0x3ca808(0x253)](_0x2013e6,null,0x2);fs[_0x3ca808(0x28f)](_0x225bbd,_0x2bf44f),config=getConfiguration(),io['to'](_0x3ca808(0x1fc))[_0x3ca808(0x196)](_0x3ca808(0x1f8),config),broadcastToBots(_0x3ca808(0x1f8),JSON[_0x3ca808(0x253)](config));}}function validateTelegram(_0x2908b1){const _0x2b491c=_0x32759a;if(_0x2908b1['from']['username']!=settings[_0x2b491c(0x1f1)]&&'@'+_0x2908b1[_0x2b491c(0x210)]['username']!=settings[_0x2b491c(0x1f1)]||_0x2908b1[_0x2b491c(0x194)]['id']!=settings[_0x2b491c(0x206)])return sendTelegram(_0x2908b1[_0x2b491c(0x194)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x2b491c(0x378)}),![];return!![];}function botRef(_0x2ae0a7){const _0x3f58a9=_0x32759a,_0x419ed9=getBotAttributes(_0x2ae0a7),_0xb07b89=_0x419ed9[_0x3f58a9(0x366)]?_0x419ed9[_0x3f58a9(0x2ce)]:_0x3f58a9(0x2c9)+_0x2ae0a7;return _0xb07b89;}async function initTelegram(){const _0xfed877=_0x32759a;tgBot&&(await tgBot[_0xfed877(0x1b7)](),await sleep(0x7d0));tgBot=new Telegraf(settings['telegramToken']);let _0x139bae=_0xfed877(0x234);_0x139bae+='\x0a',_0x139bae+=_0xfed877(0x336),_0x139bae+=_0xfed877(0x2de),_0x139bae+=_0xfed877(0x365),_0x139bae+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x139bae+=_0xfed877(0x35a),_0x139bae+=_0xfed877(0x388),_0x139bae+=_0xfed877(0x329),_0x139bae+=_0xfed877(0x306),_0x139bae+=_0xfed877(0x1d1),_0x139bae+=_0xfed877(0x289),_0x139bae+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x139bae+=_0xfed877(0x337),_0x139bae+=_0xfed877(0x197),_0x139bae+=_0xfed877(0x2ee),_0x139bae+=_0xfed877(0x2c4),_0x139bae+=_0xfed877(0x1de);let _0x2ddea0='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x2ddea0+='\x0a',_0x2ddea0+=_0x139bae,tgBot[_0xfed877(0x381)]((_0x4d3879,_0x5afa0f)=>{const _0x38d3fc=_0xfed877;logger['simple'](getTimeStamp()+_0x38d3fc(0x2df)),logger[_0x38d3fc(0x1a5)](_0x38d3fc(0x24e),_0x4d3879);}),tgBot['use'](async(_0x46416d,_0x295ddc)=>{const _0x49ede6=_0xfed877;if(settings[_0x49ede6(0x206)]||_0x46416d[_0x49ede6(0x360)]['message'][_0x49ede6(0x1e5)]!=_0x49ede6(0x2e3)){if(!validateTelegram(_0x46416d))return;}_0x295ddc();}),tgBot['command'](_0xfed877(0x1db),async _0x2bee17=>{const _0x455d06=_0xfed877;if(_0x2bee17[_0x455d06(0x210)][_0x455d06(0x1e1)]==settings[_0x455d06(0x1f1)]||'@'+_0x2bee17['from'][_0x455d06(0x1e1)]==settings[_0x455d06(0x1f1)]){if(!settings[_0x455d06(0x206)])updateSetting('telegramChatId',_0x2bee17[_0x455d06(0x194)]['id']);else{if(!validateTelegram(_0x2bee17))return;}}else{if(!validateTelegram(_0x2bee17))return;}updateSetting(_0x455d06(0x243),!![]),await sendTelegram(_0x2bee17[_0x455d06(0x194)]['id'],_0x2ddea0);}),tgBot[_0xfed877(0x2c5)](_0xfed877(0x24b),async _0x3804d0=>{const _0x5776d7=_0xfed877;updateSetting(_0x5776d7(0x243),!![]),await sendTelegram(_0x3804d0['chat']['id'],_0x5776d7(0x2eb));}),tgBot[_0xfed877(0x2c5)]('disable',async _0x8c7474=>{const _0x5dae1f=_0xfed877;await sendTelegram(_0x8c7474[_0x5dae1f(0x194)]['id'],'Notifications\x20disabled'),updateSetting(_0x5dae1f(0x243),![]);}),tgBot[_0xfed877(0x2c5)](_0xfed877(0x39a),async _0x39017d=>{const _0x4291c8=_0xfed877,_0x2394f7=Markup[_0x4291c8(0x2d8)]([Markup[_0x4291c8(0x2a4)][_0x4291c8(0x19a)](_0x4291c8(0x32c),_0x4291c8(0x230)),Markup['button'][_0x4291c8(0x19a)](_0x4291c8(0x22d),_0x4291c8(0x390)),Markup[_0x4291c8(0x2a4)][_0x4291c8(0x19a)](_0x4291c8(0x1df),_0x4291c8(0x330))]);_0x39017d['reply'](_0x4291c8(0x37a),_0x2394f7);}),tgBot[_0xfed877(0x347)]('config_orders',async _0xf7a455=>{const _0x352315=_0xfed877;_0xf7a455[_0x352315(0x22e)](),updateSetting('telegramEvents','orders'),updateSetting(_0x352315(0x243),!![]),await sendTelegram(_0xf7a455[_0x352315(0x194)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot['action']('config_alerts',async _0x222378=>{const _0x23e3a2=_0xfed877;_0x222378[_0x23e3a2(0x22e)](),updateSetting(_0x23e3a2(0x235),'alerts'),updateSetting(_0x23e3a2(0x243),!![]),await sendTelegram(_0x222378[_0x23e3a2(0x194)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0xfed877(0x347)](_0xfed877(0x330),async _0xe80455=>{const _0x18d29f=_0xfed877;_0xe80455[_0x18d29f(0x22e)](),updateSetting('telegramEvents',_0x18d29f(0x21e)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0xe80455[_0x18d29f(0x194)]['id'],_0x18d29f(0x35d));}),tgBot[_0xfed877(0x2c5)]('status',async _0x531790=>{const _0x636d53=_0xfed877,_0x112fd4=getBotsWithMode();let _0x177974='<b>Balance\x20Bot\x20Status:</b>\x0a';config['forEach'](_0x134bc4=>{const _0x16651b=_0x50e8,_0xa1ee0d=_0x112fd4[_0x16651b(0x376)](_0x186e50=>_0x186e50[_0x16651b(0x261)]==_0x134bc4[_0x16651b(0x261)])['mode'];_0x177974+=_0x16651b(0x2c9)+_0x134bc4[_0x16651b(0x261)]+':\x20'+_0x134bc4[_0x16651b(0x19b)]+'\x20|\x20'+_0xa1ee0d+_0x16651b(0x213)+_0x134bc4['live']+'\x0a';}),_0x177974+='\x0a',_0x177974+=_0x636d53(0x333),_0x177974+=!settings[_0x636d53(0x243)]?_0x636d53(0x1e7):_0x636d53(0x269),_0x177974+=settings['telegramEnabled']?settings[_0x636d53(0x235)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x636d53(0x362)+settings[_0x636d53(0x235)]+_0x636d53(0x35b):'',await sendTelegram(_0x531790[_0x636d53(0x194)]['id'],_0x177974,{'parse_mode':_0x636d53(0x378)});}),tgBot['command'](_0xfed877(0x20b),async _0x155e3d=>{const _0x4b95a6=_0xfed877,_0x38ead4=getEnabledBots();if(_0x38ead4[_0x4b95a6(0x268)]==0x0)await sendTelegram(_0x155e3d[_0x4b95a6(0x194)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x38ead4[_0x4b95a6(0x268)]>0x1)_0x38ead4[_0x4b95a6(0x1f3)]({'botID':'all'});let _0x30c45a=[],_0x34a600=[];const _0x556680=_0x38ead4['length']%0x4==0x0||_0x38ead4[_0x4b95a6(0x268)]%0x4==0x3||_0x38ead4[_0x4b95a6(0x268)]%0x3==0x1?0x4:0x3;let _0x4f3983=0x0;_0x38ead4[_0x4b95a6(0x1c0)]((_0x2a3265,_0x202f06)=>{const _0x40c430=_0x4b95a6;if(_0x202f06%_0x556680==0x0)_0x34a600=[];_0x34a600[_0x40c430(0x1f3)](Markup['button'][_0x40c430(0x19a)](_0x2a3265[_0x40c430(0x261)]==_0x40c430(0x21e)?_0x40c430(0x1af):botRef(_0x2a3265[_0x40c430(0x261)]),'restart_'+_0x2a3265[_0x40c430(0x261)])),_0x202f06%_0x556680==0x0&&(_0x30c45a[_0x4f3983]=_0x34a600,_0x4f3983++);});const _0x3160ee=Markup[_0x4b95a6(0x2d8)](_0x30c45a);_0x155e3d[_0x4b95a6(0x271)](_0x4b95a6(0x34b),_0x3160ee);}}),tgBot[_0xfed877(0x347)](/restart_(.+)/,async _0x392c3d=>{const _0x5561f2=_0xfed877,_0x206ad1=_0x392c3d[_0x5561f2(0x1ee)][0x1];_0x392c3d[_0x5561f2(0x22e)](),_0x206ad1=='all'?config[_0x5561f2(0x1c0)](_0x297f43=>{const _0x12ee7e=_0x5561f2;restartBot(_0x297f43[_0x12ee7e(0x261)]);}):restartBot(_0x206ad1);}),tgBot[_0xfed877(0x2c5)]('on',async _0x3f7bc1=>{const _0x3005f0=_0xfed877,_0x397cbe=getDisabledBots();if(_0x397cbe[_0x3005f0(0x268)]==0x0)await sendTelegram(_0x3f7bc1[_0x3005f0(0x194)]['id'],_0x3005f0(0x248));else{if(_0x397cbe[_0x3005f0(0x268)]>0x1)_0x397cbe[_0x3005f0(0x1f3)]({'botID':_0x3005f0(0x21e)});let _0x1fbb52=[],_0x4609d6=[];const _0x2a361c=_0x397cbe[_0x3005f0(0x268)]%0x4==0x0||_0x397cbe[_0x3005f0(0x268)]%0x4==0x3||_0x397cbe[_0x3005f0(0x268)]%0x3==0x1?0x4:0x3;let _0x3a5442=0x0;_0x397cbe[_0x3005f0(0x1c0)]((_0x434d5a,_0x2a71a9)=>{const _0x3f71fe=_0x3005f0;if(_0x2a71a9%_0x2a361c==0x0)_0x4609d6=[];_0x4609d6[_0x3f71fe(0x1f3)](Markup[_0x3f71fe(0x2a4)][_0x3f71fe(0x19a)](_0x434d5a[_0x3f71fe(0x261)]==_0x3f71fe(0x21e)?'All\x20bots':botRef(_0x434d5a['botID']),_0x3f71fe(0x302)+_0x434d5a['botID'])),_0x2a71a9%_0x2a361c==0x0&&(_0x1fbb52[_0x3a5442]=_0x4609d6,_0x3a5442++);});const _0x4fd9f6=Markup[_0x3005f0(0x2d8)](_0x1fbb52);_0x3f7bc1['reply'](_0x3005f0(0x1a2),_0x4fd9f6);}}),tgBot[_0xfed877(0x347)](/on_(.+)/,async _0x51d705=>{const _0x3b3759=_0xfed877,_0x37d612=_0x51d705['match'][0x1];_0x51d705[_0x3b3759(0x22e)]();if(_0x37d612==_0x3b3759(0x21e)){const _0x38ece5=getDisabledBots();await sendTelegram(_0x51d705[_0x3b3759(0x194)]['id'],'Bot\x20Mgr\x20>\x20Starting\x20all\x20bots'),_0x38ece5[_0x3b3759(0x1c0)](_0x5d4532=>{const _0x54e0c6=_0x3b3759;if(_0x5d4532[_0x54e0c6(0x261)]!='all')toggleBot(_0x5d4532[_0x54e0c6(0x261)],toggleStatus(_0x5d4532[_0x54e0c6(0x261)]),_0x54e0c6(0x247));});}else await sendTelegram(_0x51d705[_0x3b3759(0x194)]['id'],'Bot\x20Mgr\x20>\x20Starting\x20'+botRef(_0x37d612)),toggleBot(_0x37d612,toggleStatus(_0x37d612),'stopped');}),tgBot[_0xfed877(0x2c5)]('off',async _0x1ad810=>{const _0x552f8b=_0xfed877,_0x18f67e=getEnabledBots();if(_0x18f67e[_0x552f8b(0x268)]==0x0)await sendTelegram(_0x1ad810['chat']['id'],_0x552f8b(0x199));else{if(_0x18f67e[_0x552f8b(0x268)]>0x1)_0x18f67e[_0x552f8b(0x1f3)]({'botID':_0x552f8b(0x21e)});let _0x4302f6=[],_0x371185=[];const _0xf0eb62=_0x18f67e[_0x552f8b(0x268)]%0x4==0x0||_0x18f67e['length']%0x4==0x3||_0x18f67e[_0x552f8b(0x268)]%0x3==0x1?0x4:0x3;let _0x3a5223=0x0;_0x18f67e[_0x552f8b(0x1c0)]((_0x4b632d,_0x5c5de1)=>{const _0x6dd0d8=_0x552f8b;if(_0x5c5de1%_0xf0eb62==0x0)_0x371185=[];_0x371185[_0x6dd0d8(0x1f3)](Markup['button']['callback'](_0x4b632d['botID']==_0x6dd0d8(0x21e)?_0x6dd0d8(0x1af):botRef(_0x4b632d[_0x6dd0d8(0x261)]),_0x6dd0d8(0x1d5)+_0x4b632d[_0x6dd0d8(0x261)])),_0x5c5de1%_0xf0eb62==0x0&&(_0x4302f6[_0x3a5223]=_0x371185,_0x3a5223++);});const _0xc3d3b3=Markup[_0x552f8b(0x2d8)](_0x4302f6);_0x1ad810[_0x552f8b(0x271)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0xc3d3b3);}}),tgBot[_0xfed877(0x347)](/off_(.+)/,async _0x5cc9ee=>{const _0x2f8a05=_0xfed877,_0x16e836=_0x5cc9ee[_0x2f8a05(0x1ee)][0x1];_0x5cc9ee[_0x2f8a05(0x22e)]();if(_0x16e836==_0x2f8a05(0x21e)){const _0x2259c1=getEnabledBots();await sendTelegram(_0x5cc9ee[_0x2f8a05(0x194)]['id'],_0x2f8a05(0x1c3)),_0x2259c1[_0x2f8a05(0x1c0)](_0x537961=>{const _0x4a2601=_0x2f8a05;if(_0x537961[_0x4a2601(0x261)]!='all')toggleBot(_0x537961[_0x4a2601(0x261)],toggleStatus(_0x537961[_0x4a2601(0x261)]),'stopped');});}else await sendTelegram(_0x5cc9ee[_0x2f8a05(0x194)]['id'],'Bot\x20Mgr\x20>\x20Stopping\x20'+botRef(_0x16e836)),toggleBot(_0x16e836,toggleStatus(_0x16e836),_0x2f8a05(0x247));}),tgBot['command']('metrics',async _0x241513=>{const _0x37b405=_0xfed877,_0x478914=getEnabledBots();if(_0x478914[_0x37b405(0x268)]==0x0)await sendTelegram(_0x241513[_0x37b405(0x194)]['id'],_0x37b405(0x199));else{if(_0x478914[_0x37b405(0x268)]>0x1){let _0x3518b6=[],_0x18574d=[];const _0x2f57e4=_0x478914[_0x37b405(0x268)]%0x4==0x0||_0x478914[_0x37b405(0x268)]%0x4==0x3||_0x478914[_0x37b405(0x268)]%0x3==0x1?0x4:0x3;let _0x2aa5f6=0x0;_0x478914[_0x37b405(0x1c0)]((_0x307a51,_0x53de05)=>{const _0x15b8d6=_0x37b405;if(_0x53de05%_0x2f57e4==0x0)_0x18574d=[];_0x18574d[_0x15b8d6(0x1f3)](Markup[_0x15b8d6(0x2a4)][_0x15b8d6(0x19a)](botRef(_0x307a51['botID']),_0x15b8d6(0x2fe)+_0x307a51[_0x15b8d6(0x261)])),_0x53de05%_0x2f57e4==0x0&&(_0x3518b6[_0x2aa5f6]=_0x18574d,_0x2aa5f6++);});const _0x116f35=Markup[_0x37b405(0x2d8)](_0x3518b6);_0x241513['reply'](_0x37b405(0x1a7),_0x116f35);}else{const _0x3ded8a=_0x478914[0x0][_0x37b405(0x261)];if(pid[_0x3ded8a])pid[_0x3ded8a][_0x37b405(0x1a4)]({'function':_0x37b405(0x295),'args':null});}}}),tgBot[_0xfed877(0x347)](/metrics_(.+)/,async _0x36a7ff=>{const _0x3f5191=_0xfed877,_0x418b9b=_0x36a7ff[_0x3f5191(0x1ee)][0x1];_0x36a7ff[_0x3f5191(0x22e)]();if(pid[_0x418b9b])pid[_0x418b9b][_0x3f5191(0x1a4)]({'function':_0x3f5191(0x295),'args':null});}),tgBot[_0xfed877(0x2c5)](_0xfed877(0x1a9),async _0x424274=>{const _0x3078c8=_0xfed877,_0x112935=getEnabledBots();if(_0x112935[_0x3078c8(0x268)]==0x0)await sendTelegram(_0x424274[_0x3078c8(0x194)]['id'],_0x3078c8(0x199));else{if(_0x112935[_0x3078c8(0x268)]>0x1){let _0xd6e4bb=[],_0x17b706=[];const _0x58be9d=_0x112935[_0x3078c8(0x268)]%0x4==0x0||_0x112935['length']%0x4==0x3||_0x112935['length']%0x3==0x1?0x4:0x3;let _0x1fcd54=0x0;_0x112935['forEach']((_0x58566a,_0x31f451)=>{const _0x418868=_0x3078c8;if(_0x31f451%_0x58be9d==0x0)_0x17b706=[];_0x17b706[_0x418868(0x1f3)](Markup['button'][_0x418868(0x19a)](botRef(_0x58566a['botID']),_0x418868(0x23a)+_0x58566a[_0x418868(0x261)])),_0x31f451%_0x58be9d==0x0&&(_0xd6e4bb[_0x1fcd54]=_0x17b706,_0x1fcd54++);});const _0xa8e512=Markup['inlineKeyboard'](_0xd6e4bb);_0x424274['reply'](_0x3078c8(0x1da),_0xa8e512);}else{const _0x233331=_0x112935[0x0][_0x3078c8(0x261)];if(pid[_0x233331])pid[_0x233331]['send']({'function':_0x3078c8(0x204),'args':null});}}}),tgBot[_0xfed877(0x347)](/portfolio_(.+)/,async _0x1f9398=>{const _0x1e10fb=_0xfed877,_0x281d7b=_0x1f9398['match'][0x1];_0x1f9398[_0x1e10fb(0x22e)]();if(pid[_0x281d7b])pid[_0x281d7b][_0x1e10fb(0x1a4)]({'function':_0x1e10fb(0x204),'args':null});}),tgBot[_0xfed877(0x2c5)]('logs',async _0x1523e4=>{const _0x2cb488=_0xfed877,_0x2ec33b='logs';await zipFiles(_0x2ec33b);const _0x319efb=zippath+(_0x2ec33b+_0x2cb488(0x1fd));_0x1523e4[_0x2cb488(0x2e5)]({'source':_0x319efb})[_0x2cb488(0x38c)](()=>{})[_0x2cb488(0x381)](_0x2d33ea=>logger[_0x2cb488(0x1a5)](_0x2cb488(0x1ad)+_0x2ec33b+_0x2cb488(0x349),_0x2d33ea));}),tgBot[_0xfed877(0x2c5)](_0xfed877(0x287),async _0x2104fa=>{const _0x2dac1c=_0xfed877,_0x5dc1f1=_0x2dac1c(0x287);await backupConfigFiles(),await zipFiles(_0x5dc1f1);const _0x20a2ed=zippath+(_0x5dc1f1+_0x2dac1c(0x1fd));_0x2104fa[_0x2dac1c(0x2e5)]({'source':_0x20a2ed})['then'](()=>{})[_0x2dac1c(0x381)](_0x3af1b5=>logger[_0x2dac1c(0x1a5)](_0x2dac1c(0x1ad)+_0x5dc1f1+'\x20files\x20over\x20Telegram:',_0x3af1b5));}),tgBot['command'](_0xfed877(0x360),async _0x3c8895=>{const _0x234b8e=_0xfed877;await getMessages();if(!updateAvailable)await sendTelegram(_0x3c8895[_0x234b8e(0x194)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x3c8895['chat']['id'],_0x234b8e(0x1c6));else{const _0x39566a=Markup[_0x234b8e(0x2d8)]([Markup['button'][_0x234b8e(0x19a)](_0x234b8e(0x369),_0x234b8e(0x3a2)),Markup['button'][_0x234b8e(0x19a)]('No',_0x234b8e(0x2d6))]);_0x3c8895[_0x234b8e(0x271)](_0x234b8e(0x35e),_0x39566a);}}}),tgBot[_0xfed877(0x347)](/update_(.+)/,async _0x582a9e=>{const _0x5dd984=_0xfed877,_0x40a7a5=_0x582a9e['match'][0x1];_0x582a9e[_0x5dd984(0x22e)](),_0x40a7a5==_0x5dd984(0x23f)&&(await sendTelegram(_0x582a9e['chat']['id'],_0x5dd984(0x379)),updateBB('update')),_0x40a7a5=='no'&&await sendTelegram(_0x582a9e[_0x5dd984(0x194)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0xfed877(0x2c5)](_0xfed877(0x2c1),async _0x50c572=>{const _0x1e2d8f=_0xfed877;if(!validInstallation)await sendTelegram(_0x50c572['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x589416=Markup['inlineKeyboard']([Markup['button']['callback'](_0x1e2d8f(0x369),_0x1e2d8f(0x2a7)),Markup[_0x1e2d8f(0x2a4)]['callback']('No',_0x1e2d8f(0x326))]);_0x50c572[_0x1e2d8f(0x271)](_0x1e2d8f(0x226),_0x589416);}}),tgBot['action'](/reinstall_(.+)/,async _0x3a117b=>{const _0x35e905=_0xfed877,_0x1f7be2=_0x3a117b[_0x35e905(0x1ee)][0x1];_0x3a117b[_0x35e905(0x22e)](),_0x1f7be2=='yes'&&(await sendTelegram(_0x3a117b['chat']['id'],_0x35e905(0x354)),updateBB(_0x35e905(0x2c1))),_0x1f7be2=='no'&&await sendTelegram(_0x3a117b[_0x35e905(0x194)]['id'],_0x35e905(0x1c1));}),tgBot[_0xfed877(0x2c5)](_0xfed877(0x3a5),async _0x6aa323=>{const _0x4c6990=_0xfed877,_0x4b2fc7=getBotsWithMode();if(_0x4b2fc7[_0x4c6990(0x268)]==0x0)await sendTelegram(_0x6aa323[_0x4c6990(0x194)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x51a9ee=[],_0x2cba8c=[];const _0xb642a9=0x2;let _0x38d160=0x0;_0x4b2fc7[_0x4c6990(0x1c0)]((_0x48e699,_0x4bb03f)=>{const _0x527944=_0x4c6990;if(_0x4bb03f%_0xb642a9==0x0)_0x2cba8c=[];_0x2cba8c[_0x527944(0x1f3)](Markup[_0x527944(0x2a4)]['callback'](botRef(_0x48e699[_0x527944(0x261)])+'\x20('+_0x48e699[_0x527944(0x1a1)]+')',_0x527944(0x1be)+_0x48e699[_0x527944(0x261)])),_0x4bb03f%_0xb642a9==0x0&&(_0x51a9ee[_0x38d160]=_0x2cba8c,_0x38d160++);});const _0x1335dc=Markup[_0x4c6990(0x2d8)](_0x51a9ee);_0x6aa323[_0x4c6990(0x271)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x1335dc);}}),tgBot['action'](/toggle_(.+)/,async _0x4e19f3=>{const _0x386f22=_0xfed877,_0x2df808=_0x4e19f3[_0x386f22(0x1ee)][0x1];_0x4e19f3['editMessageReplyMarkup']();const _0xbb5082=getBotsWithMode(),_0x562f5a=_0xbb5082[_0x386f22(0x376)](_0xc2ecf6=>_0xc2ecf6[_0x386f22(0x261)]==_0x2df808),_0xb2228=_0x562f5a[_0x386f22(0x1a1)]=='auto'?_0x386f22(0x195):_0x386f22(0x37d);await sendTelegram(_0x4e19f3[_0x386f22(0x194)]['id'],_0x386f22(0x1eb)+botRef(_0x562f5a[_0x386f22(0x261)])+_0x386f22(0x1cb)+_0xb2228+_0x386f22(0x316)),toggleBotMode(_0x2df808);}),tgBot[_0xfed877(0x2c5)](_0xfed877(0x351),async _0x5459f0=>{const _0x532dff=_0xfed877;let _0x699718='';config[_0x532dff(0x1c0)](_0x1c3478=>{const _0xc42366=_0x532dff;_0x699718+=_0xc42366(0x2c9)+_0x1c3478['botID']+':\x20'+_0x1c3478['botname']+'\x0a';}),await sendTelegram(_0x5459f0[_0x532dff(0x194)]['id'],_0x699718,{'parse_mode':'HTML'});}),tgBot['command'](_0xfed877(0x373),async _0x422462=>{const _0xb89d3e=_0xfed877;await sendTelegram(_0x422462[_0xb89d3e(0x194)]['id'],_0x139bae);}),process[_0xfed877(0x28e)](_0xfed877(0x239),()=>tgBot[_0xfed877(0x1b7)]('SIGINT')),process['once'](_0xfed877(0x1b8),()=>tgBot[_0xfed877(0x1b7)](_0xfed877(0x1b8))),tgBot['launch']();}function disableTelegram(){const _0x55b613=_0x32759a;tgBot&&tgBot[_0x55b613(0x1b7)]();}async function sendTelegram(_0x5b191c,_0x44b8cb,_0x5b15a6){const _0x332d62=_0x32759a;_0x5b15a6={..._0x5b15a6,'disable_web_page_preview':!![]};try{await tgBot[_0x332d62(0x1dd)][_0x332d62(0x2ad)](_0x5b191c,_0x44b8cb,_0x5b15a6);}catch(_0xc9968){logger[_0x332d62(0x1a5)](_0x332d62(0x203),_0xc9968);}}async function sendTelegramBot(_0x5ea829,_0x4a457c){const _0x240ca8=_0x32759a;if(settings[_0x240ca8(0x243)]){if(settings['telegramEvents']==_0x240ca8(0x21e)||(_0x4a457c[_0x240ca8(0x1d6)]==_0x240ca8(0x2e0)||_0x4a457c[_0x240ca8(0x1d6)]==_0x240ca8(0x25b)||_0x4a457c[_0x240ca8(0x1d6)]==_0x240ca8(0x2d2))&&settings[_0x240ca8(0x235)]=='alerts'||_0x4a457c[_0x240ca8(0x1d6)]=='order'&&settings[_0x240ca8(0x235)]==_0x240ca8(0x39f)){if(tgBot&&settings[_0x240ca8(0x206)]){if(_0x4a457c[_0x240ca8(0x366)])await sendTelegram(settings[_0x240ca8(0x206)],_0x4a457c[_0x240ca8(0x2ce)]+_0x240ca8(0x374)+_0x4a457c['event']);else await sendTelegram(settings[_0x240ca8(0x206)],_0x240ca8(0x2c9)+_0x5ea829+'\x20>\x20'+_0x4a457c[_0x240ca8(0x377)]);}}}}async function sendTelegramMsg(_0x4c52d7,_0x27637d='HTML'){const _0x1ca294=_0x32759a;return tgBot&&settings[_0x1ca294(0x206)]?(await sendTelegram(settings[_0x1ca294(0x206)],_0x4c52d7,{'parse_mode':_0x27637d}),!![]):![];}function getDeviceWithIp(_0x2750e4){const _0x3074ec=_0x32759a;return devices[_0x3074ec(0x376)](_0x3b5fe5=>_0x3b5fe5['ip']===_0x2750e4);}async function temporaryAccess2FA(_0x41f3a1,_0x445913){const _0x62e28=_0x32759a;let _0x2ae6e8=new Date(),_0x237e74=![];if(lastIpApproval){if(_0x2ae6e8-lastIpApproval<0x1388)_0x237e74=!![];}lastIpApproval=new Date();if(_0x237e74)return;if(tgBot&&settings[_0x62e28(0x206)]){const _0x5041fc=uuidRandom();tmpStorage[_0x5041fc]={'uuid':_0x41f3a1,'externalip':_0x445913};const _0x35ff81=Markup['inlineKeyboard']([Markup['button'][_0x62e28(0x19a)]('5\x20min',_0x62e28(0x1c7)+_0x5041fc),Markup[_0x62e28(0x2a4)]['callback']('15\x20min','tempaccess_15_'+_0x5041fc),Markup[_0x62e28(0x2a4)][_0x62e28(0x19a)]('30\x20min',_0x62e28(0x2b7)+_0x5041fc),Markup[_0x62e28(0x2a4)][_0x62e28(0x19a)](_0x62e28(0x31f),_0x62e28(0x25d)+_0x5041fc)]);await sendTelegram(settings['telegramChatId'],_0x62e28(0x334)+normalizeIP(_0x445913)['show']+'\x20?',_0x35ff81),tgBot[_0x62e28(0x347)](/tempaccess_(.+)_(.+)/,async _0x9472db=>{const _0x1ced8e=_0x62e28,_0x53c7d4=_0x9472db[_0x1ced8e(0x1ee)][0x1],_0x21ce9a=_0x9472db[_0x1ced8e(0x1ee)][0x2],{uuid:_0x236bf3,externalip:_0x5beb91}=tmpStorage[_0x21ce9a];delete tmpStorage[_0x21ce9a],_0x9472db[_0x1ced8e(0x22e)](),devices[_0x236bf3][_0x1ced8e(0x2cd)]={'clientip':_0x5beb91,'timestamp':new Date()[_0x1ced8e(0x2d5)](),'expiry':_0x53c7d4},_0x53c7d4!=_0x1ced8e(0x31f)?(await sendTelegram(_0x9472db[_0x1ced8e(0x194)]['id'],_0x1ced8e(0x298)+_0x53c7d4+'\x20minutes',{'parse_mode':_0x1ced8e(0x378)}),io['to'](_0x236bf3)[_0x1ced8e(0x196)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x9472db[_0x1ced8e(0x194)]['id'],_0x1ced8e(0x1ca)),io['to'](_0x236bf3)[_0x1ced8e(0x196)](_0x1ced8e(0x19b),{'access':{'allow':![],'reason':_0x1ced8e(0x2ec),'token':null}}));});}}async function loginAccess2FA(_0x4967fd,_0x230de8){const _0x1bded2=_0x32759a;if(tgBot&&settings[_0x1bded2(0x206)]){const _0x4fea45=uuidRandom();tmpStorage[_0x4fea45]={'uuid':_0x4967fd,'externalip':_0x230de8};const _0x2d15ea=Markup[_0x1bded2(0x2d8)]([Markup['button'][_0x1bded2(0x19a)](_0x1bded2(0x209),_0x1bded2(0x343)+loginExpiry+'_'+_0x4fea45),Markup['button'][_0x1bded2(0x19a)](_0x1bded2(0x31f),_0x1bded2(0x322)+_0x4fea45)]);await sendTelegram(settings[_0x1bded2(0x206)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x230de8)[_0x1bded2(0x342)]+'\x20?',_0x2d15ea),tgBot[_0x1bded2(0x347)](/login2fa_(.+)_(.+)/,async _0x1bc530=>{const _0x5e8fb7=_0x1bded2,_0x490613=_0x1bc530[_0x5e8fb7(0x1ee)][0x1],_0x15bfa7=_0x1bc530['match'][0x2],{uuid:_0x2c6906,externalip:_0x2ac58e}=tmpStorage[_0x15bfa7];delete tmpStorage[_0x15bfa7],_0x1bc530[_0x5e8fb7(0x22e)](),devices[_0x2c6906][_0x5e8fb7(0x238)]={'clientip':_0x2ac58e,'timestamp':new Date()[_0x5e8fb7(0x2d5)](),'expiry':_0x490613},_0x490613!=_0x5e8fb7(0x31f)?(await sendTelegram(_0x1bc530[_0x5e8fb7(0x194)]['id'],'Login\x20accepted',{'parse_mode':_0x5e8fb7(0x378)}),io['to'](_0x2c6906)['emit'](_0x5e8fb7(0x19b),{'access':{'allow':![],'reason':_0x5e8fb7(0x36f),'token':null}})):(await sendTelegram(_0x1bc530[_0x5e8fb7(0x194)]['id'],_0x5e8fb7(0x38d)),io['to'](_0x2c6906)['emit']('status',{'access':{'allow':![],'reason':_0x5e8fb7(0x34e),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5031f2=_0x32759a;return dbConfig[_0x5031f2(0x36e)](_0x5031f2(0x1f8))['sortBy'](_0x5031f2(0x261))[_0x5031f2(0x2ab)]({'status':_0x5031f2(0x2bc)})['value']()||[];}function getDisabledBots(){const _0x2e3b17=_0x32759a;return dbConfig[_0x2e3b17(0x36e)](_0x2e3b17(0x1f8))[_0x2e3b17(0x1b1)](_0x2e3b17(0x261))[_0x2e3b17(0x2ab)]({'status':_0x2e3b17(0x25a)})[_0x2e3b17(0x2f6)]()||[];}function getBotAttributes(_0x3a273f){const _0x37be08=_0x32759a;let _0x584eda={};const _0x1df83b=configpath+_0x37be08(0x24c)+_0x3a273f+_0x37be08(0x2aa),_0xd57851=fs['existsSync'](_0x1df83b);if(_0xd57851){const _0x487027=fs['readFileSync'](_0x1df83b);try{const _0x5edb00=JSON[_0x37be08(0x266)](_0x487027),_0x170468=_0x5edb00?_0x5edb00['bot'][0x0][_0x37be08(0x2a3)]:![];_0x584eda[_0x37be08(0x1a1)]=_0x170468?'auto':_0x37be08(0x195),_0x584eda['botname']=_0x5edb00?_0x5edb00['bot'][0x0][_0x37be08(0x2ce)]:_0x37be08(0x2c9)+_0x3a273f,_0x584eda['showname']=_0x5edb00?_0x5edb00[_0x37be08(0x20e)][0x0][_0x37be08(0x366)]:![];}catch(_0x29af8e){_0x584eda[_0x37be08(0x1a1)]=_0x37be08(0x195),_0x584eda['botname']=_0x37be08(0x2c9)+_0x3a273f,_0x584eda[_0x37be08(0x366)]=![];}}else _0x584eda[_0x37be08(0x1a1)]=_0x37be08(0x195),_0x584eda['botname']=_0x37be08(0x2c9)+_0x3a273f,_0x584eda[_0x37be08(0x366)]=![];return _0x584eda;}function getBotsWithMode(){const _0x3ab513=_0x32759a,_0x5645f3=dbConfig[_0x3ab513(0x36e)]('bots')[_0x3ab513(0x1b1)](_0x3ab513(0x261))['value']()||[];return _0x5645f3[_0x3ab513(0x1c0)](_0x50a89f=>{const _0x386672=_0x3ab513;let _0x3ac65f=getBotAttributes(_0x50a89f[_0x386672(0x261)]);_0x50a89f[_0x386672(0x1a1)]=_0x3ac65f[_0x386672(0x1a1)];}),_0x5645f3;}function getBotExchanges(){const _0xc4ff6=_0x32759a;let _0x28be18=[];const _0x1bd0ad=dbConfig['get'](_0xc4ff6(0x1f8))[_0xc4ff6(0x1b1)](_0xc4ff6(0x261))[_0xc4ff6(0x2f6)]()||[];_0x1bd0ad[_0xc4ff6(0x1c0)](_0x2c7451=>{const _0x1df89e=_0xc4ff6;if(_0x2c7451[_0x1df89e(0x19b)]==_0x1df89e(0x2bc)){const _0x2732f1=configpath+'bot-'+_0x2c7451[_0x1df89e(0x261)]+_0x1df89e(0x2aa),_0xc031b6=fs[_0x1df89e(0x258)](_0x2732f1);let _0x72feb4;if(_0xc031b6){const _0x2a645e=fs[_0x1df89e(0x39d)](_0x2732f1);try{const _0x106e59=JSON[_0x1df89e(0x266)](_0x2a645e);_0x72feb4=_0x106e59?_0x106e59['bot'][0x0][_0x1df89e(0x396)]:null;}catch(_0x3f0f23){}}if(_0x72feb4)_0x28be18['push'](_0x72feb4);}});const _0x3b1430=[...new Set(_0x28be18)][_0xc4ff6(0x313)]();return _0x3b1430;}async function initUser(){const _0x3d0f9a=_0x32759a;if(!settings[_0x3d0f9a(0x1d9)]){const _0x566e9b=uuidRandom();mixpanel[_0x3d0f9a(0x2b8)](_0x566e9b),updateSetting('userid',_0x566e9b);}}function _0x50e8(_0x5bfbdd,_0x2d418c){const _0x46099d=_0x548a();return _0x50e8=function(_0x32ede5,_0x3bd9cd){_0x32ede5=_0x32ede5-0x194;let _0x548a26=_0x46099d[_0x32ede5];return _0x548a26;},_0x50e8(_0x5bfbdd,_0x2d418c);}async function initSecure(){const _0x512507=_0x32759a;let _0x524cfd=getSecure();if(!_0x524cfd['hasOwnProperty'](_0x512507(0x27c))){let _0x13efb6=await generateKeys();_0x524cfd[_0x512507(0x245)]=_0x13efb6[_0x512507(0x245)],_0x524cfd[_0x512507(0x2bd)]=_0x13efb6['privateKey'],_0x524cfd[_0x512507(0x27c)]=crypto[_0x512507(0x385)](0x20)['toString'](_0x512507(0x280));;storeSecure(_0x524cfd);}}function getSettings(){const _0x197577=_0x32759a;return dbSettings[_0x197577(0x36e)](_0x197577(0x1b9))[_0x197577(0x2f6)]()||{};}function getSecure(){const _0x505eb6=_0x32759a;return dbSecure[_0x505eb6(0x36e)]('secure')[_0x505eb6(0x2f6)]()||{};}function getBlacklist(){const _0x4f0e7e=_0x32759a;return dbSecure[_0x4f0e7e(0x36e)](_0x4f0e7e(0x1b0))[_0x4f0e7e(0x2f6)]()||[];}function broadcastToBots(_0x3b1d27,_0x12584c){const _0x3734f8=_0x32759a;config[_0x3734f8(0x1c0)](_0x125d7b=>{const _0x4ecf4f=_0x3734f8;if(_0x125d7b[_0x4ecf4f(0x19b)]=='enabled'&&_0x125d7b[_0x4ecf4f(0x20a)]==_0x4ecf4f(0x1d3)||_0x125d7b[_0x4ecf4f(0x19b)]==_0x4ecf4f(0x2ea)&&_0x125d7b[_0x4ecf4f(0x20a)]==_0x4ecf4f(0x1d3)){if(pid[_0x125d7b[_0x4ecf4f(0x261)]])pid[_0x125d7b['botID']][_0x4ecf4f(0x1a4)]({[_0x3b1d27]:_0x12584c});}});}async function storeSettings(_0xf2b252,_0x43d400=![]){const _0x209818=_0x32759a;_0xf2b252={...settings,..._0xf2b252};if(_0x43d400&&_0xf2b252[_0x209818(0x274)]!=_0x209818(0x323)&&_0xf2b252['bbPassword']!='***'&&_0xf2b252['bbPassword']!=''){const _0x46cec5=decryptRSA(secure[_0x209818(0x2bd)],_0xf2b252[_0x209818(0x274)])[_0x209818(0x363)](_0x209818(0x275))[0x0],_0x40f12e=bcrypt[_0x209818(0x2d3)](_0x46cec5,saltRounds);_0xf2b252={..._0xf2b252,'bbPassword':_0x40f12e};}if(_0x43d400&&_0xf2b252[_0x209818(0x1c5)]!=_0x209818(0x323)&&_0xf2b252[_0x209818(0x1c5)]!=_0x209818(0x309)&&_0xf2b252[_0x209818(0x1c5)]!=''){const _0x10cff3=decryptRSA(secure[_0x209818(0x2bd)],_0xf2b252[_0x209818(0x1c5)])[_0x209818(0x363)](_0x209818(0x275))[0x0];_0xf2b252={..._0xf2b252,'telegramToken':_0x10cff3};}if(_0x43d400&&_0xf2b252[_0x209818(0x28a)]!='************'&&_0xf2b252[_0x209818(0x28a)]!='***'&&_0xf2b252[_0x209818(0x28a)]!=''){const _0x14c656=decryptRSA(secure['privateKey'],_0xf2b252[_0x209818(0x28a)])[_0x209818(0x363)](_0x209818(0x275))[0x0];_0xf2b252={..._0xf2b252,'marketcapApi':_0x14c656};}const _0x276aa7=_0xf2b252[_0x209818(0x1c5)]!=_0x209818(0x323)&&_0xf2b252[_0x209818(0x1c5)]!=settings[_0x209818(0x1c5)]||_0xf2b252[_0x209818(0x1f1)]!=settings[_0x209818(0x1f1)],_0x1f648d=_0xf2b252['telegramToken']==''||_0xf2b252[_0x209818(0x1f1)]=='',_0x4ce991=_0xf2b252[_0x209818(0x28a)]&&_0xf2b252[_0x209818(0x28a)]!='************'&&_0xf2b252[_0x209818(0x28a)]!=settings[_0x209818(0x28a)];_0x276aa7&&(_0xf2b252[_0x209818(0x206)]=null,_0xf2b252['telegramEvents']=_0x209818(0x21e));for(const [_0x4e2e9d,_0x5d320c]of Object[_0x209818(0x26f)](_0xf2b252)){if(_0x4e2e9d=='telegramToken'&&_0x5d320c==_0x209818(0x323)){_0xf2b252['telegramToken']=settings['telegramToken'];continue;};if(_0x4e2e9d==_0x209818(0x274)&&_0x5d320c=='************'){_0xf2b252[_0x209818(0x274)]=settings[_0x209818(0x274)];continue;};if(_0x4e2e9d=='marketcapApi'&&_0x5d320c==_0x209818(0x323)){_0xf2b252[_0x209818(0x28a)]=settings[_0x209818(0x28a)];continue;};dbSettings['set'](_0x209818(0x29c)+_0x4e2e9d,_0x5d320c)['write']();}settings=_0xf2b252,io['to']('botmanager')[_0x209818(0x196)]('settings',cleanSettings()),broadcastToBots(_0x209818(0x225),settings[_0x209818(0x225)]),broadcastToBots(_0x209818(0x382),settings[_0x209818(0x382)]),broadcastToBots(_0x209818(0x28a),settings[_0x209818(0x28a)]);if(_0x276aa7&&!_0x1f648d)initTelegram();_0x276aa7&&_0x1f648d&&(updateSetting(_0x209818(0x206),null),disableTelegram()),getAllClients()['forEach'](_0x4e74d6=>{const _0x15c525=_0x209818;getSocket(_0x4e74d6['id'])['emit'](_0x15c525(0x19b),{'access':{'allow':![],'reason':_0x15c525(0x36f),'token':null}});}),_0x4ce991&&(await sleep(0xbb8),testMarketcapApi(_0xf2b252[_0x209818(0x28a)]));}async function testMarketcapApi(_0x4d7c6a){const _0x414603=_0x32759a,_0x2a5de1=[_0x414603(0x2b3),_0x414603(0x202)];try{await axios[_0x414603(0x36e)](_0x414603(0x1b3),{'headers':{'X-CMC_PRO_API_KEY':_0x4d7c6a},'params':{'symbol':_0x2a5de1[_0x414603(0x2a0)]()}});}catch(_0x239047){_0x239047[_0x414603(0x2a0)]()[_0x414603(0x223)](_0x414603(0x2ae))?(io['to']('botmanager')['emit'](_0x414603(0x282),_0x414603(0x19e)),logger[_0x414603(0x37f)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x414603(0x1fc))[_0x414603(0x196)]('notification',_0x414603(0x31d)),logger[_0x414603(0x37f)](_0x414603(0x31d)),logger[_0x414603(0x1a5)](_0x414603(0x2f9),_0x239047[_0x414603(0x2a0)]()+'\x20-\x20'+_0x239047[_0x414603(0x26a)]));return;}logger['debug'](_0x414603(0x392));}function updateSetting(_0x1b1f48,_0xdafdf){const _0x8dc75c=_0x32759a;dbSettings[_0x8dc75c(0x398)](_0x8dc75c(0x29c)+_0x1b1f48,_0xdafdf)[_0x8dc75c(0x294)](),settings=getSettings(),io['to'](_0x8dc75c(0x1fc))[_0x8dc75c(0x196)](_0x8dc75c(0x1b9),cleanSettings());}function storeSecure(_0x21c219){const _0x8ef6f4=_0x32759a;dbSecure[_0x8ef6f4(0x36e)]('secure')[_0x8ef6f4(0x1f3)](_0x21c219)[_0x8ef6f4(0x294)](),secure=_0x21c219;}function addBlacklist(_0x4f38a1){const _0x25a8bf=_0x32759a;cleanBlacklist();let _0xe695d6;devices[_0x4f38a1][_0x25a8bf(0x2cd)]?_0xe695d6=Math[_0x25a8bf(0x2d9)](devices[_0x4f38a1][_0x25a8bf(0x2cd)][_0x25a8bf(0x2db)],loginExpiry):_0xe695d6=loginExpiry,dbSecure[_0x25a8bf(0x36e)]('blacklist')[_0x25a8bf(0x1f3)]({'expiry':new Date()[_0x25a8bf(0x2d5)]()+_0xe695d6*0x3c*0x3e8,'token':devices[_0x4f38a1][_0x25a8bf(0x291)]['token']})[_0x25a8bf(0x294)](),blacklist=dbSecure[_0x25a8bf(0x36e)]('blacklist')[_0x25a8bf(0x2f6)]();}function cleanBlacklist(){const _0x2b8fec=_0x32759a;let _0x2843b5=dbSecure[_0x2b8fec(0x36e)](_0x2b8fec(0x1b0))['cloneDeep']()['value'](),_0x30527b=new Date()['getTime']();_0x2843b5[_0x2b8fec(0x1c0)](_0x10fdc3=>{const _0x4b1c99=_0x2b8fec;_0x10fdc3[_0x4b1c99(0x2db)]<_0x30527b&&dbSecure[_0x4b1c99(0x36e)](_0x4b1c99(0x1b0))[_0x4b1c99(0x2ca)]({'expiry':_0x10fdc3['expiry']})[_0x4b1c99(0x294)]();});}function initStates(){let _0x2f54f2=getConfiguration();_0x2f54f2['forEach'](_0x5ce3bf=>{_0x5ce3bf['live']='stopped';}),storeConfiguration(_0x2f54f2);}async function generateKeys(){const _0x272e60=_0x32759a,_0x2f683c=forge['pki']['rsa']['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x212d7a=forge[_0x272e60(0x36d)][_0x272e60(0x29d)](_0x2f683c[_0x272e60(0x2bd)]),_0x2c7e91=forge[_0x272e60(0x36d)][_0x272e60(0x257)](_0x2f683c[_0x272e60(0x245)]);return{'privateKey':_0x212d7a,'publicKey':_0x2c7e91};}async function oneTimeMigration(){const _0x5a4939=_0x32759a;let _0x411d87=getSettings(),_0x4ccf6c=![];!_0x411d87[_0x5a4939(0x38a)]('lastmsgtelegram')&&(_0x411d87[_0x5a4939(0x2c6)]=0x0,_0x4ccf6c=!![]);!_0x411d87[_0x5a4939(0x38a)]('lastmsgemitted')&&(_0x411d87[_0x5a4939(0x30d)]=0x0,_0x4ccf6c=!![]);!_0x411d87[_0x5a4939(0x38a)](_0x5a4939(0x2e8))&&(_0x411d87['latestversion']=_0x5a4939(0x31b),_0x4ccf6c=!![]);!_0x411d87[_0x5a4939(0x38a)](_0x5a4939(0x382))&&(_0x411d87[_0x5a4939(0x382)]=![],_0x4ccf6c=!![]);!_0x411d87[_0x5a4939(0x38a)](_0x5a4939(0x28a))&&(_0x411d87[_0x5a4939(0x28a)]='',_0x4ccf6c=!![]);if(_0x4ccf6c)storeSettings(_0x411d87);try{fs[_0x5a4939(0x332)](configbackuppath,{'withFileTypes':!![]})[_0x5a4939(0x1c0)](_0x4e69ca=>{const _0x15718c=_0x5a4939;if(!_0x4e69ca[_0x15718c(0x26d)]()){if(!_0x4e69ca[_0x15718c(0x345)][_0x15718c(0x23d)]('backup-full@'))fs[_0x15718c(0x2dd)](configbackuppath+_0x4e69ca['name']);}else fs[_0x15718c(0x324)](configbackuppath+_0x4e69ca[_0x15718c(0x345)],{'recursive':!![]});});}catch(_0x463255){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x463255);}}function storeConfiguration(_0x4603db){const _0x7d36f3=_0x32759a;dbConfig['get']('bots')['remove']()['write'](),dbConfig[_0x7d36f3(0x36e)](_0x7d36f3(0x1f8))['push'](..._0x4603db)['write'](),config=_0x4603db;}async function resetPassword(){const _0x259a65=_0x32759a;if(tgBot&&settings[_0x259a65(0x206)]){const _0x24ffb=Markup[_0x259a65(0x2d8)]([Markup[_0x259a65(0x2a4)]['callback'](_0x259a65(0x23f),_0x259a65(0x2e9)),Markup[_0x259a65(0x2a4)][_0x259a65(0x19a)]('no',_0x259a65(0x1a3))]);await sendTelegram(settings[_0x259a65(0x206)],_0x259a65(0x272),_0x24ffb),tgBot[_0x259a65(0x347)](/resetpw_(.+)/,async _0x12f496=>{const _0x253167=_0x259a65,_0x25b4a4=_0x12f496['match'][0x1];_0x12f496[_0x253167(0x22e)]();if(_0x25b4a4!='no'){const _0x415c16=0xf,_0x250981='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x10f759=Array['from'](crypto[_0x253167(0x2d1)](new Uint32Array(_0x415c16)))['map'](_0x2a53b9=>_0x250981[_0x2a53b9%_0x250981['length']])[_0x253167(0x36a)](''),_0x29c357=bcrypt[_0x253167(0x2d3)](_0x10f759,saltRounds);storeSettings({'bbPassword':_0x29c357}),await sendTelegram(_0x12f496[_0x253167(0x194)]['id'],_0x253167(0x2f5)+_0x10f759,{'parse_mode':_0x253167(0x378)});}else await sendTelegram(_0x12f496['chat']['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x5e74cb,_0x546a83){const _0x2b2b85=_0x32759a;io['to'](_0x2b2b85(0x1fc))[_0x2b2b85(0x196)](_0x2b2b85(0x282),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x2b2b85(0x2d2));if(tgBot&&settings[_0x2b2b85(0x206)]){const _0x36c68b=uuidRandom();tmpStorage[_0x36c68b]={'path':_0x5e74cb,'filename':_0x546a83};const _0x515718=Markup[_0x2b2b85(0x2d8)]([Markup[_0x2b2b85(0x2a4)][_0x2b2b85(0x19a)](_0x2b2b85(0x23f),_0x2b2b85(0x29e)+_0x36c68b),Markup[_0x2b2b85(0x2a4)][_0x2b2b85(0x19a)]('no','restore_no_'+_0x36c68b)]);await sendTelegram(settings[_0x2b2b85(0x206)],_0x2b2b85(0x278),_0x515718),tgBot[_0x2b2b85(0x347)](/restore_(.+)_(.+)/,async _0xaf1ee7=>{const _0x1142c7=_0x2b2b85,_0x4e45b9=_0xaf1ee7['match'][0x1],_0x79ce0c=_0xaf1ee7[_0x1142c7(0x1ee)][0x2],{path:_0x3852e8,filename:_0x3a0e34}=tmpStorage[_0x79ce0c];delete tmpStorage[_0x79ce0c],_0xaf1ee7[_0x1142c7(0x22e)](),_0x4e45b9==_0x1142c7(0x23f)?(logger[_0x1142c7(0x1a5)](_0x1142c7(0x273)),await sendTelegram(_0xaf1ee7[_0x1142c7(0x194)]['id'],_0x1142c7(0x242),{'parse_mode':_0x1142c7(0x378)}),unzipFile(_0x3852e8,_0x3a0e34)):(logger[_0x1142c7(0x1a5)](_0x1142c7(0x370)),await sendTelegram(_0xaf1ee7[_0x1142c7(0x194)]['id'],_0x1142c7(0x370)));});}}function getServerTime(){const _0x58dfef=_0x32759a,_0x15c851=new Date();return _0x15c851[_0x58dfef(0x371)]()+'/'+(_0x15c851[_0x58dfef(0x36c)]()+0x1)[_0x58dfef(0x2a0)]()[_0x58dfef(0x1d2)](0x2,'0')+'/'+_0x15c851[_0x58dfef(0x25c)]()[_0x58dfef(0x2a0)]()[_0x58dfef(0x1d2)](0x2,'0')+'\x20'+_0x15c851[_0x58dfef(0x34a)]()[_0x58dfef(0x2a0)]()['padStart'](0x2,'0')+':'+_0x15c851[_0x58dfef(0x22f)]()['toString']()['padStart'](0x2,'0')+':'+_0x15c851[_0x58dfef(0x2b5)]()[_0x58dfef(0x2a0)]()[_0x58dfef(0x1d2)](0x2,'0');}function getTimeStamp(){const _0x12e702=_0x32759a,_0x4fb2d4=shiftedTime();return _0x4fb2d4['getFullYear']()+'/'+(_0x4fb2d4[_0x12e702(0x36c)]()+0x1)[_0x12e702(0x2a0)]()[_0x12e702(0x1d2)](0x2,'0')+'/'+_0x4fb2d4[_0x12e702(0x25c)]()[_0x12e702(0x2a0)]()['padStart'](0x2,'0')+'\x20'+_0x4fb2d4[_0x12e702(0x34a)]()[_0x12e702(0x2a0)]()[_0x12e702(0x1d2)](0x2,'0')+':'+_0x4fb2d4['getMinutes']()[_0x12e702(0x2a0)]()[_0x12e702(0x1d2)](0x2,'0')+':'+_0x4fb2d4[_0x12e702(0x2b5)]()[_0x12e702(0x2a0)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x4be028=_0x32759a,_0x39ab78=shiftedTime();return _0x39ab78[_0x4be028(0x371)]()+(_0x39ab78[_0x4be028(0x36c)]()+0x1)['toString']()[_0x4be028(0x1d2)](0x2,'0')+_0x39ab78[_0x4be028(0x25c)]()[_0x4be028(0x2a0)]()[_0x4be028(0x1d2)](0x2,'0')+'-'+_0x39ab78[_0x4be028(0x34a)]()['toString']()[_0x4be028(0x1d2)](0x2,'0')+_0x39ab78[_0x4be028(0x22f)]()[_0x4be028(0x2a0)]()['padStart'](0x2,'0')+_0x39ab78['getSeconds']()[_0x4be028(0x2a0)]()[_0x4be028(0x1d2)](0x2,'0');}function shiftedTime(){const _0x21310b=_0x32759a,_0x457a2f=new Date();let _0x55daac=_0x457a2f;if(settings[_0x21310b(0x225)]&&settings[_0x21310b(0x225)]!==0x0)_0x55daac=fns['add'](_0x457a2f,{'hours':settings[_0x21310b(0x225)]});return _0x55daac;}async function startScheduler(){const _0x109f8a=_0x32759a,_0x23a834=new Date()[_0x109f8a(0x297)](),_0x24a5e1=shiftedTime()[_0x109f8a(0x34a)]();_0x24a5e1==0x4&&backupConfigFiles(),_0x24a5e1==0x0&&(rotateLogFiles(),logger[_0x109f8a(0x1a5)]('--------------------------------------'),logger[_0x109f8a(0x1a5)](_0x109f8a(0x2bf)+serverversion+_0x109f8a(0x1d7)+(environment==_0x109f8a(0x2ff)?_0x109f8a(0x250):'')),logger[_0x109f8a(0x1a5)](_0x109f8a(0x364))),_0x23a834%0x6==0x0&&triggerAnalytics(),_0x23a834%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x4ecf2d){const _0x29f0c2=_0x32759a;logger[_0x29f0c2(0x1a5)](_0x29f0c2(0x39b)+_0x4ecf2d);const _0x5475dd=getBotsWithMode();_0x5475dd[_0x29f0c2(0x268)]>0x0?confirmRestore(configbackuppath,_0x4ecf2d):unzipFile(configbackuppath,_0x4ecf2d);}async function getBackupFiles(_0x774b9a=null){const _0xc2d5db=_0x32759a;let _0x2f3280=[],_0xde9b0c=fs[_0xc2d5db(0x332)](configbackuppath,{'withFileTypes':!![]});_0xde9b0c[_0xc2d5db(0x313)]((_0x4940a2,_0x53b79b)=>_0x4940a2['name']<_0x53b79b[_0xc2d5db(0x345)]?0x1:_0x53b79b[_0xc2d5db(0x345)]<_0x4940a2[_0xc2d5db(0x345)]?-0x1:0x0),_0xde9b0c['forEach'](_0x956e48=>{const _0x440a0e=_0xc2d5db;if(!_0x956e48[_0x440a0e(0x26d)]()&&_0x956e48['name'][_0x440a0e(0x23d)](_0x440a0e(0x1f0))&&_0x956e48[_0x440a0e(0x345)][_0x440a0e(0x1b5)]('.zip')){const _0x517044=formatDate(fs['statSync'](configbackuppath+_0x956e48[_0x440a0e(0x345)])[_0x440a0e(0x2c2)]);_0x2f3280[_0x440a0e(0x1f3)]({'name':_0x956e48[_0x440a0e(0x345)],'mtime':_0x517044});}});if(_0x774b9a)io['to'](_0x774b9a)[_0xc2d5db(0x196)](_0xc2d5db(0x2c0),_0x2f3280);else return _0x2f3280;}async function backupConfigFiles(){const _0x1bee3f=_0x32759a;await zipFiles(_0x1bee3f(0x293));const _0x22d70d=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x1bee3f(0x1dc),configbackuppath+(_0x1bee3f(0x1f0)+_0x22d70d+_0x1bee3f(0x1fd)));let _0x4202d2=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x4202d2[_0x1bee3f(0x313)]((_0x394cd4,_0x4eb19f)=>_0x394cd4['name']<_0x4eb19f['name']?0x1:_0x4eb19f[_0x1bee3f(0x345)]<_0x394cd4[_0x1bee3f(0x345)]?-0x1:0x0),_0x4202d2[_0x1bee3f(0x268)]>maxBackups&&fs[_0x1bee3f(0x2dd)](configbackuppath+_0x4202d2[_0x4202d2[_0x1bee3f(0x268)]-0x1][_0x1bee3f(0x345)]);}function rotateLogFiles(){const _0x1fdffb=_0x32759a,_0x19eb38=fs['statSync'](logspath+'output-000.log'),_0x20cee0=_0x19eb38[_0x1fdffb(0x317)]/0x400;if(_0x20cee0>0x64){let _0x2ec2e0=fs[_0x1fdffb(0x332)](logspath,{'withFileTypes':!![]});_0x2ec2e0['sort']((_0x449ae2,_0x4a4cc0)=>_0x449ae2[_0x1fdffb(0x345)]<_0x4a4cc0[_0x1fdffb(0x345)]?0x1:_0x4a4cc0[_0x1fdffb(0x345)]<_0x449ae2[_0x1fdffb(0x345)]?-0x1:0x0),_0x2ec2e0[_0x1fdffb(0x1c0)](_0x2e794e=>{const _0x566d80=_0x1fdffb;if(_0x2e794e[_0x566d80(0x345)]==_0x566d80(0x339))fs[_0x566d80(0x38f)](logspath+_0x2e794e['name'],logspath+_0x566d80(0x284));if(_0x2e794e[_0x566d80(0x345)]==_0x566d80(0x21b))fs[_0x566d80(0x38f)](logspath+_0x2e794e[_0x566d80(0x345)],logspath+_0x566d80(0x339));_0x2e794e['name']==_0x566d80(0x288)&&(fs[_0x566d80(0x38f)](logspath+_0x2e794e[_0x566d80(0x345)],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x2e794e['name'],''));});}}async function zipFiles(_0x7dba5d){const _0x18d779=_0x32759a;let _0x16927b;if(_0x7dba5d=='logs')_0x16927b=logspath;if(_0x7dba5d==_0x18d779(0x287))_0x16927b=configpath;if(_0x7dba5d==_0x18d779(0x293))_0x16927b=configpath;let _0x24704c=fs[_0x18d779(0x332)](_0x16927b,{'withFileTypes':!![]});const _0x47f838=new JSZip();_0x24704c[_0x18d779(0x1c0)](_0x3799b1=>{const _0x17e69f=_0x18d779;if(!_0x3799b1[_0x17e69f(0x26d)]()){let _0x184875=fs['readFileSync'](_0x16927b+_0x3799b1[_0x17e69f(0x345)]);if(_0x7dba5d==_0x17e69f(0x287)){const _0x5a778c=/^bot-[0-9]{3}-config.json$/,_0x2dafa0=_0x5a778c[_0x17e69f(0x227)](_0x3799b1['name']);if(_0x2dafa0){const _0x5b9cd9=JSON['parse'](_0x184875);if(_0x5b9cd9[_0x17e69f(0x20e)][0x0]){_0x5b9cd9[_0x17e69f(0x20e)][0x0][_0x17e69f(0x314)]=_0x17e69f(0x309),_0x5b9cd9[_0x17e69f(0x20e)][0x0][_0x17e69f(0x353)]=_0x17e69f(0x309);if(_0x5b9cd9[_0x17e69f(0x20e)][0x0][_0x17e69f(0x1e2)])_0x5b9cd9[_0x17e69f(0x20e)][0x0]['apiPassword']='***';}_0x184875=JSON[_0x17e69f(0x253)](_0x5b9cd9,null,0x2);}if(_0x3799b1[_0x17e69f(0x345)]==_0x17e69f(0x2fa)){const _0x19fe75=JSON[_0x17e69f(0x266)](_0x184875);if(_0x19fe75[_0x17e69f(0x1b9)][_0x17e69f(0x37e)])_0x19fe75[_0x17e69f(0x1b9)][_0x17e69f(0x37e)]=![];if(_0x19fe75[_0x17e69f(0x1b9)][_0x17e69f(0x274)])_0x19fe75[_0x17e69f(0x1b9)][_0x17e69f(0x274)]=_0x17e69f(0x309);if(_0x19fe75['settings'][_0x17e69f(0x1c5)])_0x19fe75['settings'][_0x17e69f(0x1c5)]=_0x17e69f(0x309);if(_0x19fe75[_0x17e69f(0x1b9)][_0x17e69f(0x206)])_0x19fe75['settings'][_0x17e69f(0x206)]=null;if(_0x19fe75['settings'][_0x17e69f(0x28a)])_0x19fe75[_0x17e69f(0x1b9)][_0x17e69f(0x28a)]=_0x17e69f(0x309);_0x184875=JSON[_0x17e69f(0x253)](_0x19fe75,null,0x2);}if(_0x3799b1[_0x17e69f(0x345)]!='bb-secure.json')_0x47f838[_0x17e69f(0x1fb)](_0x3799b1[_0x17e69f(0x345)],_0x184875);}else _0x47f838[_0x17e69f(0x1fb)](_0x3799b1[_0x17e69f(0x345)],_0x184875);}});const _0x68f7e6=await _0x47f838[_0x18d779(0x2bb)]({'type':_0x18d779(0x2fb),'base64':![],'compression':_0x18d779(0x20f)});fs['writeFileSync'](zippath+(_0x7dba5d+_0x18d779(0x1fd)),_0x68f7e6,_0x18d779(0x237));}async function unzipFile(_0x450e6a,_0x6829ad){const _0x1c762e=_0x32759a;fs[_0x1c762e(0x332)](configpath,{'withFileTypes':!![]})[_0x1c762e(0x1c0)](_0x55a1a7=>{const _0x28cfb6=_0x1c762e;if(!_0x55a1a7[_0x28cfb6(0x26d)]())fs[_0x28cfb6(0x324)](configpath+_0x55a1a7['name']);});const _0x5c216a=fs[_0x1c762e(0x39d)](_0x450e6a+_0x6829ad,_0x1c762e(0x237)),_0x4d7adc=await JSZip[_0x1c762e(0x305)](_0x5c216a,{'base64':![],'checkCRC32':!![]});for(const _0x4f225a of Object[_0x1c762e(0x30f)](_0x4d7adc[_0x1c762e(0x2fd)])){const _0x1f2c84=_0x4d7adc[_0x1c762e(0x2fd)][_0x4f225a],_0x4a46b9=await _0x1f2c84[_0x1c762e(0x31a)](_0x1c762e(0x2fb));fs[_0x1c762e(0x28f)](configpath+_0x1f2c84[_0x1c762e(0x345)],_0x4a46b9);}fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x1c762e(0x1c0)](_0x1ab6c5=>{const _0x4d38d2=_0x1c762e;if(!_0x1ab6c5[_0x4d38d2(0x26d)]())fs[_0x4d38d2(0x324)](temppath+_0x1ab6c5[_0x4d38d2(0x345)]);}),logger['debug'](_0x1c762e(0x312)),process[_0x1c762e(0x1a4)]({'restore':!![]},_0x27b192=>{});}async function getPublicIp(){const _0x54a21a=_0x32759a;try{const _0xdeafe4=await axios[_0x54a21a(0x36e)](_0x54a21a(0x1c2));publicip=_0xdeafe4[_0x54a21a(0x31c)]['ip'];}catch(_0x13c1c9){}}async function triggerAnalytics(){const _0xe730ca=_0x32759a;if(!publicip)await getPublicIp();const _0x15ea4f=getBotsWithMode();let _0x32852b=0x0;_0x15ea4f['forEach'](_0x13dcc6=>{const _0x57f33a=_0x50e8;if(_0x13dcc6[_0x57f33a(0x19b)]===_0x57f33a(0x2bc))_0x32852b++;});const _0x398b97=getBotExchanges();mixpanel['track'](_0xe730ca(0x1ac),{'distinct_id':settings[_0xe730ca(0x1d9)],'ip':publicip,'version':serverversion,'numbots':_0x15ea4f[_0xe730ca(0x268)],'numbotsenabled':_0x32852b,'exchanges':_0x398b97,'environment':environment});}async function getMessages(){const _0x320a52=_0x32759a,_0x7e76b4=_0x320a52(0x28b),_0x1422c2=new GraphQLClient(_0x7e76b4),_0x9476d8={'authorization':_0x320a52(0x26b)},_0x10925c=serverversion[_0x320a52(0x363)]('.'),_0x1637fc=_0x10925c[0x0]+'.'+_0x10925c[0x1],_0x110c79=Math[_0x320a52(0x33e)](settings[_0x320a52(0x2c6)],settings[_0x320a52(0x30d)]),_0x13630b={'last':parseInt(_0x110c79),'bbm':_0x1637fc},_0x521e12=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x15f952;try{_0x15f952=await _0x1422c2[_0x320a52(0x215)](_0x521e12,_0x13630b,_0x9476d8);}catch(_0x525166){}if(_0x15f952&&_0x15f952[_0x320a52(0x207)]){let _0x3dc821=settings[_0x320a52(0x2c6)],_0x2cccb7=settings[_0x320a52(0x2c6)];newMessages=[];for(const _0x3d4469 of _0x15f952['messages']){newMessages[_0x320a52(0x1f3)](_0x3d4469);let _0x57b908=![];_0x3d4469['bbvNew']&&(updateSetting(_0x320a52(0x2e8),_0x3d4469['bbvNew']),_0x57b908=isNewerVersion(serverversion,_0x3d4469[_0x320a52(0x1cf)])||serverversion==_0x3d4469[_0x320a52(0x1cf)]);if(!_0x57b908&&_0x3d4469[_0x320a52(0x244)]>_0x3dc821){if(_0x3d4469[_0x320a52(0x2e7)]==='any'||serverversion[_0x320a52(0x23d)](_0x3d4469[_0x320a52(0x2e7)])){let _0x350de2=''+_0x3d4469['title']+'\x0a\x0a'+_0x3d4469[_0x320a52(0x318)];const _0x57f378=await sendTelegramMsg(toTelegramMarkdown(_0x350de2),_0x320a52(0x211));_0x3dc821=_0x3d4469['number'];}}_0x2cccb7=_0x3d4469[_0x320a52(0x244)];}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x320a52(0x2c6),_0x2cccb7),emitMessages();}}function emitMessages(){const _0xd340aa=_0x32759a,_0x33a236=settings[_0xd340aa(0x30d)];let _0x16fabc=[];newMessages['forEach'](_0x4675ed=>{const _0x305479=_0xd340aa;_0x4675ed[_0x305479(0x244)]>_0x33a236&&_0x16fabc[_0x305479(0x1f3)](_0x4675ed);}),_0x16fabc['length']>0x0&&getAllClients()[_0xd340aa(0x1c0)](_0x4df0f8=>{const _0x43fd34=_0xd340aa;getSocket(_0x4df0f8['id'])['emit'](_0x43fd34(0x318),_0x16fabc);});}function _0x548a(){const _0x10244d=['Network\x20Interfaces:','backup-full@','telegramUsername','search','push','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','build','isValid','f2aRequired','bots','api-eu.mixpanel.com','create','file','botmanager','.zip','login\x20token\x20generated','pidRefreshToken','confirm-message','store','ETH','Telegram\x20error:','sendPortfolioTelegram','isIPv4MappedAddress','telegramChatId','messages','/output-000.log','accept','live','restart','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','mkdirSync','bot','DEFLATE','from','Markdown','close','\x20|\x20','/:bot','request','Unauthorized\x20attempt\x20to\x20download\x20','uuid','\x1b[33m','1016740afLPwT','deleteHistoryAlerts','output-001.log','invalid\x20credentials','Unauthorized\x20attempt\x20to\x20log\x20out','all','defaults','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','login\x20not\x20required','static','includes','update-bb','timeshift','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','test','allow','login\x20token\x20valid','::ffff:127.0.0.1','Backup\x20file\x20uploaded','temporary\x20access\x20timeout','Alerts','editMessageReplyMarkup','getMinutes','config_orders','createWriteStream','socket','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','You\x20can\x20use\x20the\x20following\x20commands:\x0a','telegramEvents','build2','binary','telegram2FaApproval','SIGINT','portfolio_','-results.json','lowdb/adapters/FileSync','startsWith','get-portfolio','yes','Node.js\x20v','/:bot/coins','Restoring\x20bot(s)\x20from\x20backup','telegramEnabled','number','publicKey','store-fiat','stopped','All\x20bots\x20running\x20right\x20now','placeOrder','jsonwebtoken','enable','bot-','delete-bot','Telegraf\x20error:','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','(staging)','constructor','\x1b[0m','stringify','get-starting-balances','add-bot','password','publicKeyToPem','existsSync','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','disabled','warning','getDate','tempaccess_reject_','storeConfiguration','range','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','botID','Token\x20blacklisted','=>\x20Go\x20to\x20#CYA#http://','Invalid\x20authentication\x20token\x20(2)','pidExpireLogin','parse','127.0.0.1','length','Notifications\x20enabled\x0a','code','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Unauthorized\x20attempt\x20to\x20update\x20bot','isDirectory','getStartingBalances','entries','1000','reply','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Restore\x20process\x20confirmed','bbPassword','|@|','\x1b[35m',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','connection','sha256','secret','Unauthorized\x20attempt\x20to\x20get\x20messages','lowdb','bbUsername','hex','util','notification','Logged\x20out\x20user\x20...','output-003.log','Bot\x20Mgr\x20>\x20','mixpanel','backup','output-000.log','/metrics\x20-\x20show\x20bot\x20performance\x0a','marketcapApi','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','kill','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','once','writeFileSync','toIPv4MappedAddress','access','\x20|\x20client:\x20...','backup-full','write','sendMetricsTelegram','clientip','getUTCHours','Access\x20enabled\x20for\x20','Starting\x20new\x20bot\x20|\x20Bot\x20','sign','Unauthorized\x20login\x20attempt\x20(timeout)','settings.','privateKeyToPem','restore_yes_','ipv6','toString','No\x20authentication\x20token','logged\x20out','headless','button','started','removeAllListeners','reinstall_yes','Idling\x20(','sendFile','-config.json','filter','update-bot','sendMessage','status\x20code\x20401','http','createServer','/download/:type','/:bot/configuration','BCT','toggle-bot-mode','getSeconds','graphql-request','tempaccess_30_','alias','production','tkn','generateAsync','enabled','privateKey','address','Running\x20#RED#Balance\x20Bot\x20v','backup-files','reinstall','mtime','NTBA_FIX_319','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','command','lastmsgtelegram','params','uncaughtException','Bot\x20','remove','verify',')\x20|\x20Bot\x20','telegramIpApproval','botname','date-fns','toggleBotMode','randomFillSync','success','hashSync','/:bot/support','getTime','update_no','IPv4','inlineKeyboard','max','telegrammsg','expiry','download','unlinkSync','/disable\x20-\x20disable\x20notifications\x0a',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','error','exec','restore-backup-file','/start','cancel-loading','replyWithDocument','family','bbvReceive','latestversion','resetpw_yes','new','Notifications\x20enabled','temporary\x20access\x20rejected','Invalid\x20username\x20or\x20IP\x20address','/update\x20-\x20update\x20Balance\x20Bot\x0a','temp/','fork','exp','storeHeadless','remoteAddress','node-forge','Password\x20has\x20been\x20reset\x20to:\x20','value','new-disabled','Setting\x20access:\x20','Error\x20details:','bb-settings.json','string','6b67f3d61ee94b8f5c80b4affef4c4d9','files','metrics_','staging','delete-alerts','User\x20has\x20been\x20validated','on_','Disabled\x20','2FA\x20login\x20token\x20generated','loadAsync','/names\x20-\x20show\x20bot\x20names\x0a',')\x20\x20\x20|\x20Bot\x20','axios','***','-events.json','1568592TMUcvi','Unauthorized\x20attempt\x20to\x20store\x20configuration','lastmsgemitted','args','keys','1744227ePhzVC','get-backup-files','Backup\x20file\x20unzipped\x20and\x20stored','sort','apiKey','jszip','\x20mode','size','message','bb/','async','0.0.0','data','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','token','reject','telegraf','login\x20required','login2fa_reject_','************','rmSync','3336bZZMXq','reinstall_no','9961yZtLRt','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Unauthorized\x20attempt\x20to\x20delete\x20bot','use','Orders','inherit','crypto','reinstall-bb','config_all','Starting\x20(','readdirSync','<b>Telegram\x20Bot\x20Status:</b>\x0a','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','(((.+)+)+)+$','/enable\x20-\x20enable\x20notifications\x0a','/logs\x20-\x20receive\x20log\x20files\x0a','/upload-backup','output-002.log','index.html','_nsps','logs/','path','min','listen','reset-password','temporary\x20token\x20generated','show','login2fa_','bb-secure.json','name','store-headless','action','exit','\x20files\x20over\x20Telegram:','getHours','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','toIPv4Address','2FA\x20required','2FA\x20login\x20rejected','uuid-random','cancelLoading','names','zip/','apiSecret','Starting\x20Balance\x20Bot\x20reinstallation','-performance.json','updatebotmanager','socket.io','#RES#','port','/on\x20-\x20start\x20bot(s)\x0a','\x20only\x0a','argv','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','backupfile','update','handshake','Notifications\x20types:\x20','split','--------------------------------------','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','showname','logout','simple','Yes','join','#RES#\x20if\x20running\x20on\x20server','getMonth','pki','get','reload','Restore\x20process\x20aborted','getFullYear','login','help','\x20>\x20','referer','find','event','HTML','Starting\x20Balance\x20Bot\x20update','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','express','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','auto','loginRequired','full','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','catch','onepagemode','access\x20timeout','host','randomBytes','headers','2FA','/off\x20-\x20stop\x20bot(s)\x0a','disconnect','hasOwnProperty','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','then','Login\x20rejected','function','copyFileSync','config_alerts','private','CoinMarketCap\x20API\x20key\x20validated','temporaryAccessAllowed','*$1*','timestamp','exchange','504006pYXVjA','set','\x20(1)','config','Restore\x20backup\x20file\x20','ipc','readFileSync','Invalid\x20IP\x20address','orders','apply','Deleted\x20Bot\x20','update_yes','version.json','internal','toggle','slice','Unauthorized\x20attempt\x20to\x20confirm\x20message','489232XiYBfj','chat','manual','emit','/backup\x20-\x20receive\x20backup\x20files\x0a','3247VwWMoj','No\x20bots\x20running\x20right\x20now','callback','status','environment','decrypt','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','yargs/yargs','/:bot/portfolio','mode','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','resetpw_no','send','debug','showConfig','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','user','portfolio',':\x20Bot\x20Mgr\x20>\x20','place-order','Server','Error\x20sending\x20','Failed\x20to\x20download\x20','All\x20bots','blacklist','sortBy','format','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','address\x20already\x20in\x20use','endsWith','get-logs','stop','SIGTERM','settings','#RES#\x20if\x20running\x20locally\x0a','emitHistory','reason','express-fileupload','toggle_','\x1b[36m','forEach','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','https://api.ipify.org?format=json','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','bb-config.json','telegramToken','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','tempaccess_5_','-----------------------------------------------------------------------------------','node','Temporary\x20access\x20rejected','\x20to\x20','3000','config/','Session\x20expired\x20for\x20user\x20...','bbvNew','clients','/status\x20-\x20show\x20bot(s)\x20status\x0a','padStart','running','Invalid\x20authentication\x20token\x20(1)','off_','type','#RES#\x20','get-messages','userid','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','start','backup-full.zip','telegram','/help\x20-\x20show\x20available\x20commands\x0a','All','replace','username','apiPassword','\x20|\x20user:\x20...','child_process','text','assign','Notifications\x20disabled\x0a','temporary\x20access\x20not\x20allowed','log','$1_$2_$3','Bot\x20Mgr\x20>\x20Toggling\x20','encryptedUuid','whitelistEnabled','match'];_0x548a=function(){return _0x10244d;};return _0x548a();}function confirmMessage(_0x1a032e){const _0x1079e4=_0x32759a;updateSetting(_0x1079e4(0x30d),Number(_0x1a032e));}function isNewerVersion(_0x1418ad,_0x5740cd){const _0x3b5848=_0x32759a,_0x37710d=_0x5740cd[_0x3b5848(0x363)]('.'),_0x3ab967=_0x1418ad['split']('.');for(var _0x4816f6=0x0;_0x4816f6<_0x3ab967[_0x3b5848(0x268)];_0x4816f6++){const _0x3b13c7=~~_0x3ab967[_0x4816f6],_0x4e258c=~~_0x37710d[_0x4816f6];if(_0x3b13c7>_0x4e258c)return!![];if(_0x3b13c7<_0x4e258c)return![];}return![];}function toTelegramMarkdown(_0x4e9bda){const _0x1a7148=_0x32759a,_0x572054=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x329567=/\*{2}(.+?)\*{2}/gim;return _0x4e9bda=_0x4e9bda[_0x1a7148(0x1e0)](_0x572054,_0x1a7148(0x1ea))['replace'](_0x329567,_0x1a7148(0x394)),_0x4e9bda;}async function validateConfigFile(){const _0x4c8365=_0x32759a,_0xa1233e=dbConfig[_0x4c8365(0x36e)](_0x4c8365(0x1f8))[_0x4c8365(0x1b1)](_0x4c8365(0x261))[_0x4c8365(0x2f6)]()||[];if(_0xa1233e['length']==0x0){let _0x4af7f8=0x0,_0x209ba3=[];const _0x7744d7=/^bot-([0-9]{3})-config.json$/,_0x1be1bd=fs[_0x4c8365(0x332)](configpath);_0x1be1bd[_0x4c8365(0x1c0)](_0x402053=>{const _0x8115ca=_0x4c8365,_0x22823c=_0x7744d7[_0x8115ca(0x2e1)](_0x402053);if(_0x22823c){const _0x1dd265=_0x22823c[0x1];let _0x42e250=getBotAttributes(_0x1dd265);_0x209ba3['push']({'botID':_0x1dd265,'botname':_0x42e250[_0x8115ca(0x2ce)],'status':_0x8115ca(0x25a),'live':'stopped'}),_0x4af7f8++;}}),_0x4af7f8!=0x0&&(dbConfig[_0x4c8365(0x36e)](_0x4c8365(0x1f8))['assign'](_0x209ba3)[_0x4c8365(0x294)](),config=_0x209ba3,restoredConfigFile=_0x4af7f8);}}async function restoreConfigNotify(_0x1c2e9b){const _0x4e62c6=_0x32759a;let _0x2f8f56;if(restoredConfigFile==0x1)_0x2f8f56='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x2f8f56=_0x4e62c6(0x259);if(_0x1c2e9b)io['to'](_0x4e62c6(0x1fc))[_0x4e62c6(0x196)](_0x4e62c6(0x282),_0x2f8f56);else{logger[_0x4e62c6(0x368)](_0x4e62c6(0x1c8)),logger[_0x4e62c6(0x368)](_0x2f8f56),logger['simple'](_0x4e62c6(0x1c8)),logger[_0x4e62c6(0x368)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x4e62c6(0x235)]!='orders')await sendTelegram(settings[_0x4e62c6(0x206)],_0x4e62c6(0x285)+_0x2f8f56);}}function decryptRSA(_0x498677,_0xe430fa){const _0x145691=_0x32759a,_0x4328a4=forge[_0x145691(0x36d)]['privateKeyFromPem'](_0x498677),_0x462e29=_0x4328a4[_0x145691(0x19d)](forge['util']['decode64'](_0xe430fa),'RSA-OAEP',{'md':forge['md']['sha256'][_0x145691(0x1fa)](),'mgf1':{'md':forge['md'][_0x145691(0x27b)]['create']()}});return _0x462e29;}function validateCredentials(_0x443013,_0x315649){const _0x2db033=_0x32759a;if(_0x443013[_0x2db033(0x1e1)]==settings['bbUsername']&&bcrypt['compareSync'](_0x443013[_0x2db033(0x256)],settings[_0x2db033(0x274)])){if(settings[_0x2db033(0x1f7)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x20cedb=generateLoginToken(_0x315649);return{'allow':!![],'reason':_0x2db033(0x1fe),'token':_0x20cedb};}}else return{'allow':![],'reason':_0x2db033(0x21c),'token':null};}function refreshToken(_0x183579){const _0x5a2d62=_0x32759a,_0x5c8a10=generateLoginToken(_0x183579);return{'allow':!![],'reason':_0x5a2d62(0x1fe),'token':_0x5c8a10};}function validateAccess(_0x503434,_0x17e2c8,_0x5741c0){const _0x1dce8a=_0x32759a,_0x3d28a0=_0x5741c0?_0x5741c0:devices[_0x17e2c8]['ip'];let _0x5035bf;const _0x5a6060=_0xfa6e1d=>{const _0x252517=_0x50e8;if(settings[_0x252517(0x37e)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x17e2c8)){const _0x3eaf3f=generateLoginToken(_0x17e2c8);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x3eaf3f};}else return{'allow':![],'reason':_0x252517(0x321),'token':null};}else return _0x5035bf=validToken(_0xfa6e1d,_0x17e2c8),_0x5035bf[_0x252517(0x38a)](_0x252517(0x2d2))?{'allow':!![],'reason':_0x252517(0x229),'token':_0xfa6e1d}:{'allow':![],'reason':_0x252517(0x321),'token':null};}else return{'allow':!![],'reason':_0x252517(0x221),'token':null};};if(settings[_0x1dce8a(0x1ed)]){let _0x3fae8b=[...settings['whitelist'],'::1',_0x1dce8a(0x22a),_0x1dce8a(0x267)];if(_0x3fae8b[_0x1dce8a(0x223)](_0x3d28a0))return _0x5a6060(_0x503434);else{_0x5035bf=validToken(_0x503434,_0x17e2c8);if(_0x5035bf[_0x1dce8a(0x38a)](_0x1dce8a(0x2d2)))return _0x5a6060(_0x503434);else{if(telegramIpApproved(_0x17e2c8)){const _0x575d02=generateToken(_0x17e2c8);return _0x5035bf=_0x5a6060(_0x503434),_0x5035bf[_0x1dce8a(0x228)]?{'allow':!![],'reason':_0x1dce8a(0x341),'token':_0x575d02}:_0x5035bf;}else return settings[_0x1dce8a(0x393)]?{'allow':![],'reason':_0x1dce8a(0x34d),'token':null}:{'allow':![],'reason':_0x1dce8a(0x1e8),'token':null};}}}else return _0x5a6060(_0x503434);}function timelyDecrypt(_0x25212d,_0x1dd433,_0x56f55b='@'){const _0x5804dd=_0x32759a;if(_0x25212d)try{const _0x2d06b3=decryptRSA(secure['privateKey'],_0x25212d),_0x2cb155=_0x2d06b3[_0x5804dd(0x363)](_0x56f55b)[0x0],_0x18a451=_0x2d06b3[_0x5804dd(0x363)](_0x56f55b)[0x1],_0x54179f=new Date()['getTime']();if(_0x1dd433){if(_0x54179f-_0x18a451<maxSecretAge*0x3e8)return _0x2cb155;else return![];}else return _0x2cb155;}catch(_0x51636a){return![];}else return![];}const validToken=(_0x58679e,_0x158b13)=>{const _0x24f9eb=_0x32759a,_0x4d728a=devices[_0x158b13]['ip'];if(!_0x58679e)return{'error':_0x24f9eb(0x2a1)};for(let _0x3e5f44 of blacklist){if(_0x3e5f44[_0x24f9eb(0x31e)]==_0x58679e)return{'error':_0x24f9eb(0x262)};}let _0x28fde7;try{_0x28fde7=jwt[_0x24f9eb(0x2cb)](_0x58679e,secure[_0x24f9eb(0x27c)]+_0x158b13);}catch{return{'error':_0x24f9eb(0x1d4)};}if(!_0x28fde7['hasOwnProperty'](_0x24f9eb(0x296))&&!_0x28fde7[_0x24f9eb(0x38a)]('username')||!_0x28fde7[_0x24f9eb(0x38a)](_0x24f9eb(0x2f1)))return{'error':_0x24f9eb(0x264)};if(!_0x28fde7[_0x24f9eb(0x38a)](_0x24f9eb(0x1e1))&&_0x28fde7['hasOwnProperty'](_0x24f9eb(0x296))){const {clientip:_0x2467d2}=_0x28fde7;return _0x4d728a==_0x2467d2?{'success':_0x24f9eb(0x301)}:{'error':_0x24f9eb(0x39e)};}else{if(_0x28fde7['hasOwnProperty'](_0x24f9eb(0x1e1))&&_0x28fde7[_0x24f9eb(0x38a)](_0x24f9eb(0x296))){const {username:_0x35dbe0,clientip:_0x409721}=_0x28fde7;return settings[_0x24f9eb(0x27f)]==_0x35dbe0&&_0x4d728a==_0x409721?{'success':_0x24f9eb(0x301)}:{'error':_0x24f9eb(0x2ed)};}}},generateLoginToken=_0x359bef=>{const _0xff9e07=_0x32759a;if(_0x359bef){const _0x3f1634=devices[_0x359bef]['ip'];return jwt[_0xff9e07(0x29a)]({'username':settings[_0xff9e07(0x27f)],'clientip':_0x3f1634},secure[_0xff9e07(0x27c)]+_0x359bef,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x3e183e=>{const _0x5142d7=_0x32759a;if(_0x3e183e){const _0x14bdf6=devices[_0x3e183e]['ip'];return jwt['sign']({'clientip':_0x14bdf6},secure['secret']+_0x3e183e,{'expiresIn':devices[_0x3e183e][_0x5142d7(0x2cd)][_0x5142d7(0x2db)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x38633a=>{const _0x569ec2=_0x32759a;let _0x738ba4=![];return devices[_0x38633a][_0x569ec2(0x2cd)]&&devices[_0x38633a][_0x569ec2(0x2cd)][_0x569ec2(0x2db)]!=_0x569ec2(0x31f)&&(_0x738ba4=devices[_0x38633a][_0x569ec2(0x2cd)][_0x569ec2(0x296)]==devices[_0x38633a]['ip']&&new Date()[_0x569ec2(0x2d5)]()-devices[_0x38633a]['telegramIpApproval'][_0x569ec2(0x395)]<devices[_0x38633a][_0x569ec2(0x2cd)][_0x569ec2(0x2db)]*0x3c*0x3e8),_0x738ba4;},telegram2FaApproved=_0x1a01f4=>{const _0x3df1c3=_0x32759a;let _0x423e57=![];return devices[_0x1a01f4]['telegram2FaApproval']&&devices[_0x1a01f4][_0x3df1c3(0x238)][_0x3df1c3(0x2db)]!=_0x3df1c3(0x31f)&&(_0x423e57=devices[_0x1a01f4][_0x3df1c3(0x238)][_0x3df1c3(0x296)]==devices[_0x1a01f4]['ip']&&new Date()[_0x3df1c3(0x2d5)]()-devices[_0x1a01f4]['telegram2FaApproval'][_0x3df1c3(0x395)]<devices[_0x1a01f4][_0x3df1c3(0x238)][_0x3df1c3(0x2db)]*0x3c*0x3e8),_0x423e57;},normalizeIP=_0x986ba9=>{const _0x51c079=_0x32759a;let _0x11c0d2=null,_0x3a2e34=null;if(ipaddr[_0x51c079(0x1f6)](_0x986ba9)){const _0x4a6e62=ipaddr[_0x51c079(0x266)](_0x986ba9);_0x4a6e62['kind']()===_0x51c079(0x29f)?(_0x4a6e62[_0x51c079(0x205)]()&&(_0x11c0d2=_0x4a6e62[_0x51c079(0x34c)]()['toString']()),_0x3a2e34=_0x4a6e62[_0x51c079(0x2a0)]()):(_0x11c0d2=_0x4a6e62['toString'](),_0x3a2e34=_0x4a6e62[_0x51c079(0x290)]()[_0x51c079(0x2a0)]());}return{'show':_0x11c0d2?_0x11c0d2:_0x3a2e34,'store':_0x3a2e34};};function formatDate(_0x772986){const _0x233261=_0x32759a;return _0x772986[_0x233261(0x371)]()+'/'+(_0x772986[_0x233261(0x36c)]()+0x1)[_0x233261(0x2a0)]()['padStart'](0x2,'0')+'/'+_0x772986[_0x233261(0x25c)]()[_0x233261(0x2a0)]()[_0x233261(0x1d2)](0x2,'0')+'\x20'+_0x772986['getHours']()['toString']()[_0x233261(0x1d2)](0x2,'0')+':'+_0x772986[_0x233261(0x22f)]()['toString']()[_0x233261(0x1d2)](0x2,'0')+':'+_0x772986[_0x233261(0x2b5)]()['toString']()[_0x233261(0x1d2)](0x2,'0');}function sleep(_0x1738ac){return new Promise(_0x235668=>setTimeout(_0x235668,_0x1738ac));}