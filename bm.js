const _0x5eea46=_0x6052;(function(_0x714beb,_0x246222){const _0x5816ce=_0x6052,_0x3e13ac=_0x714beb();while(!![]){try{const _0x423f3c=parseInt(_0x5816ce(0x2c0))/0x1*(-parseInt(_0x5816ce(0x331))/0x2)+-parseInt(_0x5816ce(0x1fe))/0x3*(parseInt(_0x5816ce(0x1a0))/0x4)+-parseInt(_0x5816ce(0x1b3))/0x5+parseInt(_0x5816ce(0x18e))/0x6+-parseInt(_0x5816ce(0x2b6))/0x7+parseInt(_0x5816ce(0x326))/0x8*(-parseInt(_0x5816ce(0x1d5))/0x9)+parseInt(_0x5816ce(0x28b))/0xa*(parseInt(_0x5816ce(0x1a9))/0xb);if(_0x423f3c===_0x246222)break;else _0x3e13ac['push'](_0x3e13ac['shift']());}catch(_0x5199f6){_0x3e13ac['push'](_0x3e13ac['shift']());}}}(_0x35b4,0x4676e));const _0x2d09a3=function(){let _0x260b5c=!![];return function(_0x2f5fdc,_0x4e49ab){const _0x299589=_0x260b5c?function(){if(_0x4e49ab){const _0x4e9e67=_0x4e49ab['apply'](_0x2f5fdc,arguments);return _0x4e49ab=null,_0x4e9e67;}}:function(){};return _0x260b5c=![],_0x299589;};}(),_0x2c5d75=_0x2d09a3(this,function(){const _0x4134f3=_0x6052;return _0x2c5d75[_0x4134f3(0x3a0)]()['search'](_0x4134f3(0x386))[_0x4134f3(0x3a0)]()[_0x4134f3(0x300)](_0x2c5d75)[_0x4134f3(0x243)]('(((.+)+)+)+$');});function _0x35b4(){const _0x508878=['Restore\x20process\x20confirmed','padStart','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','bbvReceive','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','keys','-----------------------------------------------------------------------------------','catch','from','Notifications\x20enabled\x0a','auto','telegramEvents','logged\x20out','/enable\x20-\x20enable\x20notifications\x0a','\x1b[34m','off','rmSync','help','constructor','verify','Ok,\x20will\x20send\x20alert\x20notifications\x20only','User\x20has\x20been\x20validated','publicKeyToPem','.zip','backup-full.zip',':\x20Bot\x20Mgr\x20>\x20','login\x20not\x20required','place-order','telegramChatId','Token\x20blacklisted','Login\x20rejected','yargs/yargs','createServer','(staging)','\x20only\x0a','init','includes','env','\x20|\x20client:\x20...','defaults','store-headless','static','express-fileupload','login','restore-backup-file','filter','start','editMessageReplyMarkup','reinstall_no','Unauthorized\x20attempt\x20to\x20confirm\x20message','Error\x20while\x20deleting\x20config\x20files:\x20','hashSync','resetHistory','expiry','isValid','clientip','1927576uZHFhT','|@|','Node.js\x20v','error','6b67f3d61ee94b8f5c80b4affef4c4d9','showConfig','ipaddr.js','resetpw_no','notification','command','login2fa_reject_','6080pIfqnQ','All\x20bots','storeFiat','emitHistory','message','\x20>\x20','reset-history','getUTCHours','split','argv','************','tempaccess_30_','build','listen','stopped','/off\x20-\x20stop\x20bot(s)\x0a','/:bot/coins','/metrics\x20-\x20show\x20bot\x20performance\x0a','getMinutes','port','socket.io','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','2FA\x20required','push','sort','/:bot/history','all','Idling\x20(','timestamp','Starting\x20Balance\x20Bot\x20reinstallation','Unauthorized\x20attempt\x20to\x20delete\x20alerts','kind','loadAsync','\x1b[35m','disabled',',\x20must\x20be\x20a\x204\x20digit\x20number',')\x20\x20\x20|\x20Bot\x20','string','cloneDeep','socket','toIPv4MappedAddress','sign','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Unauthorized\x20attempt\x20to\x20update\x20settings','mtime','Ok,\x20will\x20send\x20order\x20notifications\x20only','RSA-OAEP','marketcapApi','output-001.log','\x1b[36m','portfolio_','bb-config.json','delete-bot','Restarting\x20Bot\x20','Login\x20accepted','logs','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','logout','sortBy','bot.js','telegramUsername','getTime','#RES#','stringify','lastmsgemitted','2FA\x20login\x20token\x20generated','portfolio','toggle-bot-mode','close','Error\x20details:','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','getMonth','restore_yes_','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','exit','args','getPortfolio','Unauthorized\x20attempt\x20to\x20get\x20messages','5\x20min','Unauthorized\x20attempt\x20to\x20download\x20','then','randomBytes','sendFile','(((.+)+)+)+$','Starting\x20(','Telegram\x20error:','Unauthorized\x20attempt\x20to\x20log\x20out','/status\x20-\x20show\x20bot(s)\x20status\x0a','Bot\x20Mgr\x20>\x20','send','pki','telegram','lowdb','config/','#RES#\x20if\x20running\x20on\x20server','replace','min','botID','sha256','temporary\x20access\x20timeout','apiKey','crypto','HTML','resetpw_yes','Deleted\x20Bot\x20','confirm-message','create','logs/','private','toString','Notifications\x20disabled','decode64','enable','version','compareSync','length','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','allow','reinstall-bb','telegram2FaApproval','lastmsgtelegram','onepagemode','timeshift','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','range','restart_','698706QbZNww','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Error\x20removing\x20old\x20backup\x20files:','restart','use','emit','pidExpireLogin','publicKey','decrypt','post','telegraf','success','Yes','ETH','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','add','replyWithDocument','/:bot','4gdeHqV','access','once','botmanager','track','warning','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Error\x20sending\x20','0.0.0','7571861cvxefg','write','toggle','Running\x20#RED#Balance\x20Bot\x20v','metrics','Access\x20enabled\x20for\x20','code','-config.json','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','getDate','877990sFyZoR','title','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','request','f2aRequired','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','/on\x20-\x20start\x20bot(s)\x0a','copyFileSync','get-backup-files','--------------------------------------','Restore\x20process\x20aborted','disable','::ffff:127.0.0.1','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','update_no','username','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Invalid\x20IP\x20address','hasOwnProperty','auth','startsWith','exp','staging','map','Unauthorized\x20attempt\x20to\x20show\x20configuration','Invalid\x20authentication\x20token\x20(2)','getHours','family','whitelist','exchange','update-bb','Backup\x20file\x20uploaded','mkdirSync','18yiiNbU','index.html','type','build2','file','new-disabled','remoteAddress','=>\x20Go\x20to\x20#CYA#http://','/help\x20-\x20show\x20available\x20commands\x0a','value','set','cancel-loading','headless','uuid','tempaccess_reject_','-performance.json','existsSync','Setting\x20access:\x20','any','text','Unauthorized\x20attempt\x20to\x20update\x20bot','action','Notifications\x20disabled\x0a','mode','button','versions','\x20files\x20over\x20Telegram:','enabled','Invalid\x20authentication\x20token\x20(1)','Starting\x20new\x20bot\x20|\x20Bot\x20','telegramToken','removeAllListeners','started','hex','isIPv4MappedAddress','\x20|\x20','readFileSync','config_orders','reply','temporary\x20access\x20not\x20allowed','Password\x20has\x20been\x20reset\x20to:\x20','314913HhpyeI','match','alerts','metrics_','output-003.log','No\x20bots\x20running\x20right\x20now',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','token','mixpanel','reinstall','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','ipc','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','accept','settings.','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','bot','bot-','new','connected','telegramEnabled','deleteHistoryAlerts','getStartingBalances','SIGINT','latestversion','api-eu.mixpanel.com','Failed\x20to\x20download\x20','show-config','toggle_','/backup\x20-\x20receive\x20backup\x20files\x0a','generateKeyPair','secret','invalid\x20credentials','isDirectory','output-000.log','store-configuration','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','telegramIpApproval','2FA\x20login\x20rejected','password','30\x20min','uuid-random','slice','format','15\x20min','\x20-\x20','Unauthorized\x20attempt\x20to\x20delete\x20bot','log','function','find','restore_no_','sendPortfolioTelegram','/update\x20-\x20update\x20Balance\x20Bot\x0a','bbUsername','showname','All\x20bots\x20running\x20right\x20now','assign','whitelistEnabled','bb-settings.json','File\x20uploaded','rsa','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','config','userid','conn','child_process','secure','names','messages','search','tkn','reinstall_yes','unlinkSync','Password\x20reset\x20rejected','callback','inlineKeyboard','bcryptjs','kill','privateKey','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','environment','get-logs','on_','zip/','status\x20code\x20401','placeOrder','getSeconds','loginRequired','number','jszip','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','apiPassword','full','/restart\x20-\x20restart\x20bot(s)\x0a','express','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','internal','\x20(2)','files','#RES#\x20','Bot\x20','backup-files','backup-full@','temp/','event','handshake','All','forEach','version.json','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','No\x20authentication\x20token','Unauthorized\x20attempt\x20to\x20get\x20portfolio','_nsps','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','status','chat','ipv6','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','reason','bbPassword','util','host','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Unauthorized\x20attempt\x20to\x20add\x20bot','Backup\x20file\x20unzipped\x20and\x20stored','update','storeHeadless','launch','sendMessage','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','settings','headers','reject','manual','botname','parse','exec','cancelLoading','readdirSync','tempaccess_5_','address','20viwTGK','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','/download/:type','updatebotmanager','Enabled\x20Bot\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','config_all','getFullYear','binary','\x20(1)','store-settings','2FA\x20login\x20required','-results.json','join','bb-secure.json','[ip-address]','/:bot/performance','***','get','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','name','SIGTERM','blacklist','order','get-messages','lowdb/adapters/FileSync','encryptedUuid','simple',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','writeFileSync','1000','store','test','disconnect','DEFLATE','remove','127.0.0.1','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','debug','Invalid\x20username\x20or\x20IP\x20address','inherit','address\x20already\x20in\x20use','backup-full','1434636OgvfRQ','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','apiSecret','generateAsync','bbvNew','You\x20can\x20use\x20the\x20following\x20commands:\x0a','referer','pidRefreshToken','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','/disable\x20-\x20disable\x20notifications\x0a','78fmwKxk','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','running','temporaryAccessAllowed','Alerts','/:bot/configuration','date-fns','$1_$2_$3','bots','/start','/output-000.log','sendMetricsTelegram','async','yes','statSync','backup/','node','backup','Server','initclient','production','Notifications\x20types:\x20','Error:\x20Invalid\x20argument\x20','entries','login\x20token\x20generated','Temporary\x20access\x20rejected','reload','orders','live','Disabled\x20Bot\x20','Session\x20expired\x20for\x20user\x20...','/names\x20-\x20show\x20bot\x20names\x0a','stop','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','<b>Balance\x20Bot\x20Status:</b>\x0a','fork','temporary\x20token\x20generated','server','BCT','Orders','login\x20required',')\x20|\x20Bot\x20','Markdown','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','axios','Allow\x20login\x20from\x20IP\x20address\x20'];_0x35b4=function(){return _0x508878;};return _0x35b4();}_0x2c5d75();'use strict';process[_0x5eea46(0x313)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x5eea46(0x23f)),fs=require('fs'),fns=require(_0x5eea46(0x2c6)),low=require(_0x5eea46(0x38f)),FileSync=require(_0x5eea46(0x2a4)),path=require('path'),crypto=require(_0x5eea46(0x398)),forge=require('node-forge'),bcrypt=require(_0x5eea46(0x24a)),jwt=require('jsonwebtoken'),ipaddr=require(_0x5eea46(0x32c)),argv=require(_0x5eea46(0x30d))(process[_0x5eea46(0x33a)][_0x5eea46(0x228)](0x2))[_0x5eea46(0x33a)],uuidRandom=require(_0x5eea46(0x227)),{Telegraf,Markup}=require(_0x5eea46(0x198)),Mixpanel=require(_0x5eea46(0x206)),axios=require(_0x5eea46(0x2ec)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require(_0x5eea46(0x318)),{networkInterfaces}=require('os'),JSZip=require(_0x5eea46(0x257)),PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x5eea46(0x2ab)](PORT)&&(console[_0x5eea46(0x22d)](_0x5eea46(0x2d6)+PORT+_0x5eea46(0x354)),process[_0x5eea46(0x37d)](0x1));const HOST=argv[_0x5eea46(0x277)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x5eea46(0x1ee)][_0x5eea46(0x2d0)];let bbpath='bb/',bbpath2='';const botfile=_0x5eea46(0x36d),configfile=_0x5eea46(0x365),settingsfile=_0x5eea46(0x238),securefile=_0x5eea46(0x299),environment=require('./'+bbpath2+_0x5eea46(0x26a))[_0x5eea46(0x24e)]||_0x5eea46(0x2d4),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x5eea46(0x390)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x5eea46(0x2cf),logspath=userID?bbpath+_0x5eea46(0x39e)+userID+'/':bbpath+_0x5eea46(0x39e),zippath=userID?bbpath+_0x5eea46(0x251)+userID+'/':bbpath+'zip/',loggerfile=fs['createWriteStream'](logspath+_0x5eea46(0x2ca),{'flags':'a'}),temppath=userID?bbpath+_0x5eea46(0x265)+userID+'/':bbpath+'temp/';!fs[_0x5eea46(0x1e5)](configpath)&&fs[_0x5eea46(0x1d4)](configpath);!fs[_0x5eea46(0x1e5)](configbackuppath)&&fs[_0x5eea46(0x1d4)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x5eea46(0x1d4)](logspath);!fs[_0x5eea46(0x1e5)](zippath)&&fs[_0x5eea46(0x1d4)](zippath);!fs[_0x5eea46(0x1e5)](temppath)&&fs[_0x5eea46(0x1d4)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x5eea46(0x315)]({'bots':[]})[_0x5eea46(0x1aa)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x5eea46(0x1a8),'onepagemode':![],'marketcapApi':''}})[_0x5eea46(0x1aa)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5eea46(0x315)]({'secure':{},'blacklist':[]})[_0x5eea46(0x1aa)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x5eea46(0x311)](_0x5eea46(0x32a),{'host':_0x5eea46(0x217)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x5eea46(0x1f3)]&&(settings[_0x5eea46(0x1f3)]!=''&&settings[_0x5eea46(0x1f3)]!=_0x5eea46(0x29c))&&settings['telegramUsername']&&settings[_0x5eea46(0x36e)]!='')initTelegram();const parseColor=(_0x31a152,_0x2bf357)=>{const _0x55f4e9=_0x5eea46,_0x3bf2c7=/#[A-Z]{3}#/g;if(typeof _0x31a152=='string'){!_0x2bf357?_0x31a152=_0x31a152[_0x55f4e9(0x392)](_0x3bf2c7,''):(_0x31a152=_0x31a152[_0x55f4e9(0x392)](/#BLU#/g,_0x55f4e9(0x2fc)),_0x31a152=_0x31a152['replace'](/#RED#/g,'\x1b[31m'),_0x31a152=_0x31a152[_0x55f4e9(0x392)](/#YEL#/g,'\x1b[33m'),_0x31a152=_0x31a152[_0x55f4e9(0x392)](/#MAG#/g,_0x55f4e9(0x352)),_0x31a152=_0x31a152['replace'](/#CYA#/g,_0x55f4e9(0x363)),_0x31a152=_0x31a152[_0x55f4e9(0x392)](/#RES#/g,'\x1b[0m'));;}return _0x31a152;},logger={'screen':_0x228e0c=>{const _0x22912a=_0x5eea46;console[_0x22912a(0x22d)](parseColor(_0x228e0c,!![]));},'simple':_0x5e7c84=>{const _0x46ca0b=_0x5eea46;console[_0x46ca0b(0x22d)](parseColor(_0x5e7c84,!![])),loggerfile[_0x46ca0b(0x1aa)](util['format'](parseColor(_0x5e7c84,![]))+'\x0a');},'full':async _0x331a7f=>{const _0x49bf82=_0x5eea46,_0xf4458c=getTimeStamp()+_0x49bf82(0x307)+_0x331a7f;console[_0x49bf82(0x22d)](parseColor(_0xf4458c,!![])),loggerfile[_0x49bf82(0x1aa)](util['format'](parseColor(_0xf4458c,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x49bf82(0x2f9)]!='orders')await sendTelegram(settings['telegramChatId'],_0x49bf82(0x38b)+parseColor(_0x331a7f,![]));},'debug':async(_0x1d5c76,_0x325a29='')=>{const _0x271fb9=_0x5eea46,_0x5ca33b=getTimeStamp()+_0x271fb9(0x204)+_0x1d5c76;if(debugging)console[_0x271fb9(0x22d)](parseColor(_0x5ca33b,!![]));loggerfile['write'](util[_0x271fb9(0x229)](parseColor(_0x5ca33b,![]))+'\x0a');if(_0x325a29){if(debugging)console[_0x271fb9(0x22d)](_0x325a29);loggerfile[_0x271fb9(0x1aa)](util[_0x271fb9(0x229)](_0x325a29)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x19cf33){const _0xaa2c00=_0x5eea46;_0x19cf33[_0xaa2c00(0x3a0)]()[_0xaa2c00(0x312)](_0xaa2c00(0x2b4))?(logger[_0xaa2c00(0x2a6)]('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x19cf33[_0xaa2c00(0x344)]+_0xaa2c00(0x370)),process['send']({'terminate':!![]},_0x372728=>{})):logger[_0xaa2c00(0x2a6)](_0x19cf33);}),process['on']('exit',()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGTERM',()=>{const _0x3a3634=_0x5eea46;stopAllBots(),process[_0x3a3634(0x37d)](0x0);}),process['on']('SIGINT',()=>{const _0x4348f8=_0x5eea46;stopAllBots(),process[_0x4348f8(0x37d)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x5eea46(0x26a))[_0x5eea46(0x3a4)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x5eea46(0x25c)),app=express(),http=require('http')[_0x5eea46(0x30e)](app);app[_0x5eea46(0x192)](fileUpload({'useTempFiles':!![]})),app[_0x5eea46(0x29d)](_0x5eea46(0x28d),async(_0x5d72fb,_0x3ea560)=>{const _0x1fc65d=_0x5eea46,_0x318dd3=_0x5d72fb['params'][_0x1fc65d(0x1d7)],_0x198909=getClientsWithBotID(_0x1fc65d(0x1a3)),_0x1e9388=_0x5d72fb[_0x1fc65d(0x281)][_0x1fc65d(0x1e2)],_0x279edc=timelyDecrypt(_0x1e9388,![]),_0x32a51c=_0x198909[_0x1fc65d(0x22f)](_0x23773d=>_0x23773d['uuid']==_0x279edc);if(_0x32a51c){const _0x55b57e=normalizeIP(_0x5d72fb['socket'][_0x1fc65d(0x1db)])[_0x1fc65d(0x2aa)],_0x27b0e8=_0x5d72fb['headers'][_0x1fc65d(0x244)];if(validateAccess(_0x27b0e8,_0x279edc,_0x55b57e)[_0x1fc65d(0x3a8)])_0x318dd3=='backup'&&await backupConfigFiles(),await zipFiles(_0x318dd3),_0x3ea560['download'](zippath+(_0x318dd3+'.zip'),_0x121008=>{const _0x5dd15e=_0x1fc65d;_0x121008&&(logger[_0x5dd15e(0x25a)](_0x5dd15e(0x218)+_0x318dd3),logger[_0x5dd15e(0x2a6)](_0x121008));});else logger[_0x1fc65d(0x25a)](_0x1fc65d(0x382)+_0x318dd3+_0x1fc65d(0x294));}else logger['full'](_0x1fc65d(0x382)+_0x318dd3+_0x1fc65d(0x25f));}),app[_0x5eea46(0x197)]('/upload-backup',async(_0x1dee18,_0x40243b)=>{const _0x3288d0=_0x5eea46,_0x4e7757=getClientsWithBotID(_0x3288d0(0x1a3)),_0x5e8ba3=_0x1dee18['headers']['uuid'],_0x4d8408=timelyDecrypt(_0x5e8ba3,![]),_0x1e7d48=_0x4e7757['find'](_0x56c2ae=>_0x56c2ae[_0x3288d0(0x1e2)]==_0x4d8408);logger[_0x3288d0(0x2b1)](_0x3288d0(0x1d3));if(_0x1e7d48){const _0x1a68e7=normalizeIP(_0x1dee18[_0x3288d0(0x358)][_0x3288d0(0x1db)])[_0x3288d0(0x2aa)],_0x181409=_0x1dee18[_0x3288d0(0x281)]['tkn'];if(validateAccess(_0x181409,_0x4d8408,_0x1a68e7)[_0x3288d0(0x3a8)]){if(_0x1dee18['files']){const _0x35f9af=_0x1dee18[_0x3288d0(0x260)]['backupfile'];await _0x35f9af['mv'](temppath+_0x35f9af[_0x3288d0(0x29f)]),_0x40243b[_0x3288d0(0x38c)]({'status':!![],'message':_0x3288d0(0x239)});const _0x53fa76=getBotsWithMode();_0x53fa76['length']>0x0?confirmRestore(temppath,_0x35f9af[_0x3288d0(0x29f)]):unzipFile(temppath,_0x35f9af['name']);}}else logger[_0x3288d0(0x25a)](_0x3288d0(0x1c4));}else logger[_0x3288d0(0x25a)](_0x3288d0(0x1c3));}),app[_0x5eea46(0x192)](express[_0x5eea46(0x317)](path[_0x5eea46(0x298)](__dirname,bbpath2,_0x5eea46(0x1d8)))),app[_0x5eea46(0x192)](express[_0x5eea46(0x317)](path['join'](__dirname,bbpath2,_0x5eea46(0x33d)))),app[_0x5eea46(0x29d)]('/',function(_0x39af43,_0x3a934d){const _0x237302=_0x5eea46;_0x3a934d[_0x237302(0x385)](path['join'](__dirname,bbpath2,'build2',_0x237302(0x1d6)));}),app[_0x5eea46(0x29d)](_0x5eea46(0x19f),function(_0x567980,_0x23a8e3){const _0x207ba2=_0x5eea46;_0x23a8e3['sendFile'](path[_0x207ba2(0x298)](__dirname,bbpath2,_0x207ba2(0x33d),_0x207ba2(0x1d6)));}),app[_0x5eea46(0x29d)]('/:bot/portfolio',(_0x32b09e,_0x460a70)=>{const _0x32980b=_0x5eea46;_0x460a70[_0x32980b(0x385)](path[_0x32980b(0x298)](__dirname,bbpath2,'build',_0x32980b(0x1d6)));}),app[_0x5eea46(0x29d)](_0x5eea46(0x29b),(_0x1cc791,_0x540588)=>{const _0x3ec721=_0x5eea46;_0x540588[_0x3ec721(0x385)](path[_0x3ec721(0x298)](__dirname,bbpath2,_0x3ec721(0x33d),_0x3ec721(0x1d6)));}),app[_0x5eea46(0x29d)](_0x5eea46(0x341),(_0x514194,_0x266544)=>{const _0x41e09d=_0x5eea46;_0x266544[_0x41e09d(0x385)](path[_0x41e09d(0x298)](__dirname,bbpath2,'build','index.html'));}),app[_0x5eea46(0x29d)](_0x5eea46(0x34a),(_0x392a10,_0x8a62ef)=>{const _0x136923=_0x5eea46;_0x8a62ef['sendFile'](path[_0x136923(0x298)](__dirname,bbpath2,'build',_0x136923(0x1d6)));}),app[_0x5eea46(0x29d)](_0x5eea46(0x2c5),(_0x3c9875,_0x4be4fc)=>{const _0x178771=_0x5eea46;_0x4be4fc[_0x178771(0x385)](path[_0x178771(0x298)](__dirname,bbpath2,_0x178771(0x33d),_0x178771(0x1d6)));}),app[_0x5eea46(0x29d)]('/:bot/support',(_0x1a5369,_0x72fa12)=>{const _0x3ddf44=_0x5eea46;_0x72fa12[_0x3ddf44(0x385)](path['join'](__dirname,bbpath2,_0x3ddf44(0x33d),_0x3ddf44(0x1d6)));});if(HOST)http[_0x5eea46(0x33e)](PORT,HOST);else http['listen'](PORT);const io=require(_0x5eea46(0x345))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0xfe1e8f=_0x5eea46;let _0x4d4d09=_0xfe1e8f(0x29a);const _0x3e453b=networkInterfaces(),_0xe8fe2c={};for(const _0x1a1506 of Object[_0xfe1e8f(0x2f3)](_0x3e453b)){for(const _0x14cdca of _0x3e453b[_0x1a1506]){if((_0x14cdca[_0xfe1e8f(0x1cf)]=='IPv4'||_0x14cdca['family']==0x4)&&!_0x14cdca[_0xfe1e8f(0x25e)]){const _0x5ab071=ipaddr[_0xfe1e8f(0x285)](_0x14cdca[_0xfe1e8f(0x28a)])[_0xfe1e8f(0x18c)]();_0x5ab071!=_0xfe1e8f(0x39f)&&(!_0xe8fe2c[_0x1a1506]&&(_0xe8fe2c[_0x1a1506]=[]),_0xe8fe2c[_0x1a1506][_0xfe1e8f(0x348)](_0x14cdca[_0xfe1e8f(0x28a)]),_0x4d4d09=_0x14cdca['address']);}}}return{'serverip':_0x4d4d09,'netinterfaces':_0xe8fe2c};}async function startServer(){const _0x124c25=_0x5eea46,{serverip:_0x188eaa,netinterfaces:_0x143bee}=getServerIP();logger[_0x124c25(0x2a6)](''),logger[_0x124c25(0x2a6)](_0x124c25(0x2f4)),await logger[_0x124c25(0x25a)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x124c25(0x261)+(environment==_0x124c25(0x1ca)?_0x124c25(0x30f):'')+'\x0a'+(_0x124c25(0x2eb)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x124c25(0x1dc)+_0x188eaa+':'+PORT+_0x124c25(0x391))),logger[_0x124c25(0x2a6)](_0x124c25(0x2f4));if(config['length']!=0x0)for(const _0xf6c9d1 of config){const _0x12459c=_0xf6c9d1[_0x124c25(0x1ec)]==_0x124c25(0x2f8)?'a':'m';if(_0xf6c9d1[_0x124c25(0x270)]==_0x124c25(0x1f0)||_0xf6c9d1['status']=='new')await logger['full'](_0x124c25(0x387)+_0x12459c+_0x124c25(0x2e9)+_0xf6c9d1[_0x124c25(0x394)]+_0x124c25(0x1f8)+_0xf6c9d1[_0x124c25(0x284)]),startBot([_0xf6c9d1[_0x124c25(0x394)],userID],{'cwd':bbpath},function(_0x5b3ae2){const _0x5e1126=_0x124c25;if(_0x5b3ae2)logger[_0x5e1126(0x25a)](_0x5b3ae2);});else(_0xf6c9d1['status']==_0x124c25(0x353)||_0xf6c9d1['status']==_0x124c25(0x1da))&&await logger['full'](_0x124c25(0x34c)+_0x12459c+_0x124c25(0x355)+_0xf6c9d1['botID']+_0x124c25(0x1f8)+_0xf6c9d1[_0x124c25(0x284)]);}else!newBot&&logger[_0x124c25(0x2a6)](_0x124c25(0x26b));if(newBot)addBot();logger['simple'](_0x124c25(0x2f4)),logger[_0x124c25(0x2a6)](''),await logger[_0x124c25(0x2b1)](_0x124c25(0x328)+nodeversion),await logger['debug']('Network\x20Interfaces:',_0x143bee);}function startSocket(){io['on']('connection',_0x2ea886=>{const _0x42452c=_0x6052;let _0x2fab2f,_0x3a236,_0x40b684,_0x139bcd,_0x38406f;const _0x356885=_0x2ea886[_0x42452c(0x267)]['headers'][_0x42452c(0x2bc)];_0x3a236=_0x356885[_0x42452c(0x1ff)](/bot[0-9]{3}/);if(_0x3a236)_0x40b684=_0x3a236[0x0][_0x42452c(0x1ff)](/[0-9]{3}/);if(_0x40b684)_0x2fab2f=_0x40b684[0x0];else _0x2fab2f=_0x42452c(0x1a3);const _0xe15999=_0x2ea886[_0x42452c(0x267)][_0x42452c(0x1c7)][_0x42452c(0x2a5)];if(!_0xe15999)_0x2ea886[_0x42452c(0x193)](_0x42452c(0x270),{'publicKey':secure[_0x42452c(0x195)]});else{_0x139bcd=timelyDecrypt(_0xe15999,![]);if(!_0x139bcd)_0x2ea886['emit'](_0x42452c(0x270),{'publicKey':secure[_0x42452c(0x195)]});else{_0x38406f=normalizeIP(_0x2ea886[_0x42452c(0x23e)]['remoteAddress'])[_0x42452c(0x2aa)];if(!devices[_0x139bcd])devices[_0x139bcd]={'uuid':_0x139bcd,'access':{'token':null}};devices[_0x139bcd]['ip']=_0x38406f;const _0x199812=addClient(_0x2ea886['id'],_0x139bcd,_0x2fab2f);setAccess(_0x199812),emitMessages(),_0x2ea886['on'](_0x42452c(0x319),_0x4db4e6=>{const _0x5f28b4=_0x42452c,_0x9a4f1e=timelyDecrypt(_0x4db4e6[_0x5f28b4(0x225)],!![],_0x5f28b4(0x327));if(_0x9a4f1e){_0x4db4e6={'username':_0x4db4e6[_0x5f28b4(0x1c2)],'password':_0x9a4f1e},devices[_0x139bcd][_0x5f28b4(0x1a1)]=validateCredentials(_0x4db4e6,_0x139bcd);if(devices[_0x139bcd]['access']['allow']==![]&&devices[_0x139bcd]['access'][_0x5f28b4(0x274)]==_0x5f28b4(0x296))_0x2ea886['emit'](_0x5f28b4(0x270),{'access':devices[_0x139bcd][_0x5f28b4(0x1a1)]}),loginAccess2FA(_0x139bcd,_0x38406f);else{if(devices[_0x139bcd][_0x5f28b4(0x1a1)][_0x5f28b4(0x3a8)]==![]&&devices[_0x139bcd][_0x5f28b4(0x1a1)][_0x5f28b4(0x274)]==_0x5f28b4(0x21e))_0x2ea886[_0x5f28b4(0x193)](_0x5f28b4(0x270),{'access':devices[_0x139bcd]['access']});else devices[_0x139bcd][_0x5f28b4(0x1a1)][_0x5f28b4(0x3a8)]&&devices[_0x139bcd][_0x5f28b4(0x1a1)][_0x5f28b4(0x274)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x139bcd)[_0x5f28b4(0x269)](_0x5e9f91=>{setAccess(_0x5e9f91);}),logger[_0x5f28b4(0x2b1)]('Logged\x20in\x20user\x20...'+_0x139bcd[_0x5f28b4(0x228)](-0x8)),setTokenRefresh(_0x139bcd),setSessionTimeout(_0x5f28b4(0x319),_0x139bcd));}}else logger[_0x5f28b4(0x25a)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x2ea886['on']('reset-password',()=>{resetPassword();}),_0x2ea886['on'](_0x42452c(0x2ac),_0x23f7b3=>{removeClient(_0x2ea886['id']);}),_0x2fab2f==_0x42452c(0x1a3)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x11111c){const _0x46d8bb=_0x5eea46;if(_0x11111c!='botmanager'&&config[_0x46d8bb(0x397)]!=''){if(pid[_0x11111c])pid[_0x11111c]['send']({'function':_0x46d8bb(0x2d3),'args':null});}_0x11111c!=_0x46d8bb(0x1a3)&&broadcastToBots(_0x46d8bb(0x2c8),JSON[_0x46d8bb(0x371)](config));}function reloadBotManager(){const _0x2a153e=_0x5eea46;getClientsWithBotID('botmanager')[_0x2a153e(0x269)](_0x4c8972=>{const _0x33ffad=_0x2a153e;getSocket(_0x4c8972['id'])[_0x33ffad(0x193)](_0x33ffad(0x270),{'access':{'allow':![],'reason':_0x33ffad(0x2da),'token':null}});});}function getSocket(_0x3d1fef){const _0x401d90=_0x5eea46,_0x1d0629=io[_0x401d90(0x26e)][_0x401d90(0x29d)]('/');return _0x1d0629['sockets'][_0x401d90(0x29d)](_0x3d1fef);}function setAccess(_0x41ac0a){const _0x15f73c=_0x5eea46,_0x3d8cd8=getSocket(_0x41ac0a['id']),_0x41c0a0=_0x41ac0a[_0x15f73c(0x1e2)],_0x3891ad=_0x41ac0a['bot'];devices[_0x41c0a0][_0x15f73c(0x1a1)]=validateAccess(devices[_0x41c0a0]['access'][_0x15f73c(0x205)],_0x41c0a0),logger[_0x15f73c(0x2b1)](_0x15f73c(0x1e6)+devices[_0x41c0a0]['access'][_0x15f73c(0x274)]+_0x15f73c(0x314)+_0x41ac0a['id'][_0x15f73c(0x228)](-0x8)+'\x20|\x20user:\x20...'+_0x41c0a0['slice'](-0x8)),_0x3d8cd8[_0x15f73c(0x298)](_0x41c0a0);if(devices[_0x41c0a0][_0x15f73c(0x1a1)][_0x15f73c(0x3a8)]){_0x3d8cd8[_0x15f73c(0x298)](_0x3891ad);if(_0x3891ad==_0x15f73c(0x1a3))initializeSocketBotManager(_0x3d8cd8);else initializeSocketBot(_0x3d8cd8);initClient(_0x3891ad);}devices[_0x41c0a0][_0x15f73c(0x1a1)][_0x15f73c(0x205)]&&devices[_0x41c0a0][_0x15f73c(0x1a1)][_0x15f73c(0x274)]==_0x15f73c(0x2e4)&&setSessionTimeout('2FA',_0x41c0a0),devices[_0x41c0a0][_0x15f73c(0x1a1)]['token']&&devices[_0x41c0a0][_0x15f73c(0x1a1)][_0x15f73c(0x274)]==_0x15f73c(0x373)&&setSessionTimeout(_0x15f73c(0x319),_0x41c0a0),_0x3d8cd8[_0x15f73c(0x193)](_0x15f73c(0x270),{'status':_0x41ac0a[_0x15f73c(0x2e5)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x41c0a0][_0x15f73c(0x1a1)],'externalip':devices[_0x41c0a0]['ip'],'publicKey':secure[_0x15f73c(0x195)],'userid':settings[_0x15f73c(0x23d)],'validInstallation':validInstallation}),devices[_0x41c0a0]['access']['allow']==![]&&devices[_0x41c0a0][_0x15f73c(0x1a1)][_0x15f73c(0x274)]==_0x15f73c(0x347)&&temporaryAccess2FA(_0x41c0a0,devices[_0x41c0a0]['ip']);}function setSessionTimeout(_0x3ea8e5,_0xdcd655){const _0x38d76c=_0x5eea46;let _0x168b99;if(_0x3ea8e5==_0x38d76c(0x319))_0x168b99=loginExpiry*0x3c*0x3e8;else _0x168b99=devices[_0xdcd655]['telegramIpApproval'][_0x38d76c(0x323)]*0x3c*0x3e8-(new Date()[_0x38d76c(0x36f)]()-devices[_0xdcd655][_0x38d76c(0x223)][_0x38d76c(0x34d)]);if(devices[_0xdcd655]['pidExpireLogin'])clearTimeout(devices[_0xdcd655]['pidExpireLogin']);devices[_0xdcd655][_0x38d76c(0x194)]=setTimeout(()=>{const _0xf5653d=_0x38d76c;if(devices[_0xdcd655][_0xf5653d(0x2bd)])clearTimeout(devices[_0xdcd655][_0xf5653d(0x2bd)]);removeSocketListeners(_0xdcd655),addBlacklist(_0xdcd655),devices[_0xdcd655][_0xf5653d(0x223)]=null,devices[_0xdcd655][_0xf5653d(0x187)]=null,devices[_0xdcd655][_0xf5653d(0x1a1)][_0xf5653d(0x205)]=null,logger[_0xf5653d(0x2b1)](_0xf5653d(0x2de)+_0xdcd655[_0xf5653d(0x228)](-0x8)),devices[_0xdcd655][_0xf5653d(0x1a1)]=validateAccess(devices[_0xdcd655][_0xf5653d(0x1a1)][_0xf5653d(0x205)],_0xdcd655),!(devices[_0xdcd655]['access'][_0xf5653d(0x3a8)]&&devices[_0xdcd655][_0xf5653d(0x1a1)][_0xf5653d(0x274)]==_0xf5653d(0x308))&&(_0x3ea8e5==_0xf5653d(0x319)?io['to'](_0xdcd655)[_0xf5653d(0x193)](_0xf5653d(0x270),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0xdcd655)[_0xf5653d(0x193)](_0xf5653d(0x270),{'access':{'allow':![],'reason':_0xf5653d(0x396),'token':null}})),devices[_0xdcd655][_0xf5653d(0x1a1)][_0xf5653d(0x205)]=null;},_0x168b99);}function setTokenRefresh(_0x28f843){const _0x39156e=_0x5eea46;if(devices[_0x28f843][_0x39156e(0x2bd)])clearTimeout(devices[_0x28f843]['pidRefreshToken']);devices[_0x28f843][_0x39156e(0x2bd)]=setTimeout(()=>{const _0x68725f=_0x39156e;getClientsWithUuid(_0x28f843)['length']!=0x0?(devices[_0x28f843][_0x68725f(0x1a1)]=refreshToken(_0x28f843),io['to'](_0x28f843)[_0x68725f(0x193)](_0x68725f(0x270),{'status':_0x68725f(0x211),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x28f843][_0x68725f(0x1a1)],'externalip':devices[_0x28f843]['ip'],'publicKey':secure[_0x68725f(0x195)],'validInstallation':validInstallation}),setTokenRefresh(_0x28f843)):clearTimeout(devices[_0x28f843][_0x68725f(0x2bd)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3b860e){const _0xf2d264=_0x5eea46,_0x444f5d=getClient(_0x3b860e['id'])[_0xf2d264(0x1e2)];_0x3b860e[_0xf2d264(0x193)](_0xf2d264(0x2c8),config),_0x3b860e[_0xf2d264(0x193)](_0xf2d264(0x280),cleanSettings()),_0x3b860e['on']('add-bot',_0x1f55c7=>{const _0x475b5b=_0xf2d264;if(validateAccess(_0x1f55c7,_0x444f5d)[_0x475b5b(0x3a8)])addBot();else logger[_0x475b5b(0x25a)](_0x475b5b(0x279));}),_0x3b860e['on']('update-bot',(_0x27470e,_0x20b7d3)=>{const _0x54f706=_0xf2d264;if(validateAccess(_0x20b7d3,_0x444f5d)[_0x54f706(0x3a8)])toggleBot(_0x27470e[_0x54f706(0x394)],_0x27470e['status'],_0x27470e[_0x54f706(0x2dc)]);else logger[_0x54f706(0x25a)](_0x54f706(0x1e9));}),_0x3b860e['on'](_0xf2d264(0x375),(_0x4776b0,_0x3bd24a)=>{const _0x209bff=_0xf2d264;if(validateAccess(_0x3bd24a,_0x444f5d)[_0x209bff(0x3a8)])toggleBotMode(_0x4776b0);else logger['full'](_0x209bff(0x1e9));}),_0x3b860e['on'](_0xf2d264(0x366),(_0x2a035d,_0x2d2ad3)=>{const _0x2fa03e=_0xf2d264;if(validateAccess(_0x2d2ad3,_0x444f5d)[_0x2fa03e(0x3a8)])deleteBot(_0x2a035d);else logger[_0x2fa03e(0x25a)](_0x2fa03e(0x22c));}),_0x3b860e['on'](_0xf2d264(0x295),(_0x256abe,_0x4decff)=>{const _0x368022=_0xf2d264;if(validateAccess(_0x4decff,_0x444f5d)['allow'])storeSettings(_0x256abe,!![]);else logger[_0x368022(0x25a)](_0x368022(0x35d));}),_0x3b860e['on'](_0xf2d264(0x1d2),_0x5173d7=>{const _0x5311a9=_0xf2d264;if(validateAccess(_0x5173d7,_0x444f5d)[_0x5311a9(0x3a8)])updateBB(_0x5311a9(0x27b));else logger[_0x5311a9(0x25a)](_0x5311a9(0x2f2));}),_0x3b860e['on'](_0xf2d264(0x3a9),_0x4ece7f=>{const _0x227d8c=_0xf2d264;if(validateAccess(_0x4ece7f,_0x444f5d)[_0x227d8c(0x3a8)])updateBB(_0x227d8c(0x207));else logger[_0x227d8c(0x25a)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x3b860e['on'](_0xf2d264(0x1bb),_0x2bfdd6=>{const _0x1bbb2f=_0xf2d264;if(validateAccess(_0x2bfdd6,_0x444f5d)['allow']){const _0x572d18=getClient(_0x3b860e['id']);if(_0x572d18)getBackupFiles(_0x572d18[_0x1bbb2f(0x1e2)]);else logger[_0x1bbb2f(0x25a)](_0x1bbb2f(0x2b7));}else logger[_0x1bbb2f(0x25a)](_0x1bbb2f(0x37c));}),_0x3b860e['on'](_0xf2d264(0x31a),(_0x5bb26f,_0x4a1668)=>{const _0x5967ad=_0xf2d264;if(validateAccess(_0x4a1668,_0x444f5d)['allow'])restoreBackupFile(_0x5bb26f);else logger[_0x5967ad(0x25a)](_0x5967ad(0x3a7));}),_0x3b860e['on'](_0xf2d264(0x2a3),_0x1abba0=>{const _0x502a31=_0xf2d264;if(validateAccess(_0x1abba0,_0x444f5d)[_0x502a31(0x3a8)])getMessages();else logger[_0x502a31(0x25a)](_0x502a31(0x380));}),_0x3b860e['on'](_0xf2d264(0x39c),(_0x242e5f,_0x25e222)=>{const _0x4c1f29=_0xf2d264;if(validateAccess(_0x25e222,_0x444f5d)[_0x4c1f29(0x3a8)])confirmMessage(_0x242e5f);else logger[_0x4c1f29(0x25a)](_0x4c1f29(0x31f));}),_0x3b860e['on']('logout',_0x1cfc7f=>{const _0x2c0c12=_0xf2d264;if(validateAccess(_0x1cfc7f,_0x444f5d)[_0x2c0c12(0x3a8)]){if(devices[_0x444f5d][_0x2c0c12(0x2bd)])clearTimeout(devices[_0x444f5d][_0x2c0c12(0x2bd)]);if(devices[_0x444f5d]['pidExpireLogin'])clearTimeout(devices[_0x444f5d][_0x2c0c12(0x194)]);removeSocketListeners(getClient(_0x3b860e['id'])[_0x2c0c12(0x1e2)]),addBlacklist(_0x444f5d),devices[_0x444f5d][_0x2c0c12(0x223)]=null,devices[_0x444f5d][_0x2c0c12(0x187)]=null,devices[_0x444f5d][_0x2c0c12(0x1a1)][_0x2c0c12(0x205)]=null,logger[_0x2c0c12(0x2b1)]('Logged\x20out\x20user\x20...'+_0x444f5d[_0x2c0c12(0x228)](-0x8)),io['to'](getClient(_0x3b860e['id'])[_0x2c0c12(0x1e2)])[_0x2c0c12(0x193)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x2c0c12(0x25a)](_0x2c0c12(0x389));});}function initializeSocketBot(_0x1d7467){const _0x4e9b51=_0x5eea46,_0x25fe93=getClient(_0x1d7467['id'])[_0x4e9b51(0x20e)],_0x2fc7a1=getClient(_0x1d7467['id'])[_0x4e9b51(0x1e2)];_0x1d7467['on'](_0x4e9b51(0x24f),(_0x434b0b,_0x2bda3a)=>{const _0x8f97d6=_0x4e9b51;if(validateAccess(_0x2bda3a,_0x2fc7a1)[_0x8f97d6(0x3a8)]){if(pid[_0x25fe93])pid[_0x25fe93][_0x8f97d6(0x38c)]({'function':_0x8f97d6(0x334),'args':_0x434b0b});}else logger[_0x8f97d6(0x25a)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x1d7467['on']('delete-alerts',(_0x563057,_0x52d6f4)=>{const _0x58bb2f=_0x4e9b51;if(validateAccess(_0x52d6f4,_0x2fc7a1)[_0x58bb2f(0x3a8)]){if(pid[_0x25fe93])pid[_0x25fe93]['send']({'function':_0x58bb2f(0x213),'args':_0x563057});}else logger[_0x58bb2f(0x25a)](_0x58bb2f(0x34f));}),_0x1d7467['on']('get-portfolio',(_0x461c6b,_0x2ed61c)=>{const _0x499876=_0x4e9b51;if(validateAccess(_0x2ed61c,_0x2fc7a1)['allow']){if(pid[_0x25fe93])pid[_0x25fe93][_0x499876(0x38c)]({'function':_0x499876(0x37f),'args':_0x461c6b});}else logger[_0x499876(0x25a)](_0x499876(0x26d));}),_0x1d7467['on'](_0x4e9b51(0x221),(_0x4f3491,_0x3f7d18)=>{const _0x305c1f=_0x4e9b51;if(validateAccess(_0x3f7d18,_0x2fc7a1)[_0x305c1f(0x3a8)]){if(pid[_0x25fe93])pid[_0x25fe93]['send']({'function':'storeConfiguration','args':_0x4f3491});}else logger[_0x305c1f(0x25a)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x1d7467['on'](_0x4e9b51(0x316),(_0x3fcb42,_0x16cee8)=>{const _0x425d83=_0x4e9b51;if(validateAccess(_0x16cee8,_0x2fc7a1)['allow']){if(pid[_0x25fe93])pid[_0x25fe93][_0x425d83(0x38c)]({'function':_0x425d83(0x27c),'args':_0x3fcb42});}else logger[_0x425d83(0x25a)](_0x425d83(0x24d));}),_0x1d7467['on']('store-fiat',(_0x7bd4bc,_0x2847c0)=>{const _0xfffa6d=_0x4e9b51;if(validateAccess(_0x2847c0,_0x2fc7a1)[_0xfffa6d(0x3a8)]){if(pid[_0x25fe93])pid[_0x25fe93]['send']({'function':_0xfffa6d(0x333),'args':_0x7bd4bc});}else logger['full'](_0xfffa6d(0x1b1));}),_0x1d7467['on'](_0x4e9b51(0x337),_0xd69d47=>{const _0x5e1fbf=_0x4e9b51;if(validateAccess(_0xd69d47,_0x2fc7a1)[_0x5e1fbf(0x3a8)]){if(pid[_0x25fe93])pid[_0x25fe93][_0x5e1fbf(0x38c)]({'function':_0x5e1fbf(0x322),'args':null});}else logger[_0x5e1fbf(0x25a)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x1d7467['on']('get-starting-balances',_0x28328d=>{const _0x48aae8=_0x4e9b51;if(validateAccess(_0x28328d,_0x2fc7a1)[_0x48aae8(0x3a8)]){if(pid[_0x25fe93])pid[_0x25fe93]['send']({'function':_0x48aae8(0x214),'args':null});}else logger[_0x48aae8(0x25a)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x1d7467['on'](_0x4e9b51(0x309),(_0x5733d0,_0x5cd7c2)=>{const _0x4eb47f=_0x4e9b51;if(validateAccess(_0x5cd7c2,_0x2fc7a1)['allow']){if(pid[_0x25fe93])pid[_0x25fe93][_0x4eb47f(0x38c)]({'function':_0x4eb47f(0x253),'args':_0x5733d0});}else logger[_0x4eb47f(0x25a)](_0x4eb47f(0x1b5));}),_0x1d7467['on'](_0x4e9b51(0x1e0),_0x195f44=>{const _0x57ddfd=_0x4e9b51;if(validateAccess(_0x195f44,_0x2fc7a1)[_0x57ddfd(0x3a8)]){if(pid[_0x25fe93])pid[_0x25fe93][_0x57ddfd(0x38c)]({'function':_0x57ddfd(0x287),'args':null});}else logger[_0x57ddfd(0x25a)](_0x57ddfd(0x379));}),_0x1d7467['on'](_0x4e9b51(0x219),_0x52f7f1=>{const _0x2f44f1=_0x4e9b51;if(validateAccess(_0x52f7f1,_0x2fc7a1)['allow']){if(pid[_0x25fe93])pid[_0x25fe93][_0x2f44f1(0x38c)]({'function':_0x2f44f1(0x32b),'args':null});}else logger['full'](_0x2f44f1(0x1cc));}),_0x1d7467['on'](_0x4e9b51(0x1d2),_0x4d5cbd=>{const _0x1aeb51=_0x4e9b51;if(validateAccess(_0x4d5cbd,_0x2fc7a1)[_0x1aeb51(0x3a8)])updateBB(_0x1aeb51(0x27b));else logger[_0x1aeb51(0x25a)](_0x1aeb51(0x2f2));}),_0x1d7467['on']('get-messages',_0x125afc=>{const _0x2cbcdf=_0x4e9b51;if(validateAccess(_0x125afc,_0x2fc7a1)[_0x2cbcdf(0x3a8)])getMessages();else logger[_0x2cbcdf(0x25a)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1d7467['on'](_0x4e9b51(0x39c),(_0x3f3519,_0x5a4179)=>{const _0xfb1c55=_0x4e9b51;if(validateAccess(_0x5a4179,_0x2fc7a1)['allow'])confirmMessage(_0x3f3519);else logger['full'](_0xfb1c55(0x31f));}),_0x1d7467['on'](_0x4e9b51(0x36b),_0x57aa2e=>{const _0x18b2b4=_0x4e9b51;if(validateAccess(_0x57aa2e,_0x2fc7a1)[_0x18b2b4(0x3a8)]){if(devices[_0x2fc7a1][_0x18b2b4(0x2bd)])clearTimeout(devices[_0x2fc7a1][_0x18b2b4(0x2bd)]);if(devices[_0x2fc7a1][_0x18b2b4(0x194)])clearTimeout(devices[_0x2fc7a1][_0x18b2b4(0x194)]);removeSocketListeners(getClient(_0x1d7467['id'])[_0x18b2b4(0x1e2)]),addBlacklist(_0x2fc7a1),devices[_0x2fc7a1][_0x18b2b4(0x223)]=null,devices[_0x2fc7a1][_0x18b2b4(0x187)]=null,devices[_0x2fc7a1][_0x18b2b4(0x1a1)][_0x18b2b4(0x205)]=null,logger[_0x18b2b4(0x2b1)]('Logged\x20out\x20user\x20...'+_0x2fc7a1[_0x18b2b4(0x228)](-0x8)),io['to'](getClient(_0x1d7467['id'])[_0x18b2b4(0x1e2)])['emit'](_0x18b2b4(0x270),{'access':{'allow':![],'reason':_0x18b2b4(0x2fa),'token':null}});}else logger[_0x18b2b4(0x25a)](_0x18b2b4(0x389));});}function removeSocketListeners(_0x3ee6c8){const _0x158ef3=_0x5eea46;getClientsWithUuid(_0x3ee6c8)[_0x158ef3(0x269)](_0x3e3a96=>{const _0x407922=_0x158ef3;getSocket(_0x3e3a96['id'])[_0x407922(0x1f4)]();});}function cleanSettings(){const _0x7f577c=_0x5eea46;let _0x1a9f89=settings;return settings[_0x7f577c(0x1f3)]&&settings[_0x7f577c(0x1f3)]!=''&&(_0x1a9f89={..._0x1a9f89,'telegramToken':_0x7f577c(0x33b)}),settings[_0x7f577c(0x275)]&&settings[_0x7f577c(0x275)]!=''&&(_0x1a9f89={..._0x1a9f89,'bbPassword':_0x7f577c(0x33b)}),settings['marketcapApi']&&settings[_0x7f577c(0x361)]!=''&&(_0x1a9f89={..._0x1a9f89,'marketcapApi':'************'}),(settings[_0x7f577c(0x275)]&&settings[_0x7f577c(0x275)]==_0x7f577c(0x29c)||settings[_0x7f577c(0x1f3)]&&settings[_0x7f577c(0x1f3)]==_0x7f577c(0x29c)||settings['marketcapApi']&&settings[_0x7f577c(0x361)]==_0x7f577c(0x29c))&&(_0x1a9f89={..._0x1a9f89,'restored':{'password':settings[_0x7f577c(0x275)]=='***','telegram':settings['telegramToken']=='***','marketcap':settings['marketcapApi']==_0x7f577c(0x29c)}}),_0x1a9f89;}async function updateBB(_0x129954){const _0x45499d=_0x5eea46;await backupConfigFiles(),installingUpdate=!![],config[_0x45499d(0x269)](_0x34d80f=>{restartBot(_0x34d80f['botID']);});if(_0x129954==_0x45499d(0x27b))process[_0x45499d(0x38c)]({'update':!![],'environment':environment},_0x4d2184=>{});else _0x129954==_0x45499d(0x207)&&process[_0x45499d(0x38c)]({'reinstall':!![],'environment':environment},_0x3cef19=>{});}function startBot(_0x418b4b,_0x20eaf8,_0xe4d5ef){const _0x3588be=_0x5eea46;if(debugging)_0x418b4b[_0x3588be(0x348)]('-d');let _0x188a8d=![];const _0xede512=_0x418b4b[0x0];_0x20eaf8={..._0x20eaf8,'stdio':[_0x3588be(0x2b3),_0x3588be(0x2b3),_0x3588be(0x2b3),_0x3588be(0x209)]},pid[_0xede512]=childProcess[_0x3588be(0x2e3)](botfile,_0x418b4b,_0x20eaf8),pid[_0xede512]['on'](_0x3588be(0x335),_0x2e9519=>{const _0x1d17b0=_0x3588be;switch(Object[_0x1d17b0(0x2f3)](_0x2e9519)[0x0]){case _0x1d17b0(0x284):updateBotName(_0xede512,_0x2e9519['botname']);break;case _0x1d17b0(0x28e):updateBotManager();break;case _0x1d17b0(0x270):updateStatus(_0xede512,_0x2e9519['status']);break;case _0x1d17b0(0x2dc):updateLive(_0xede512,_0x2e9519[_0x1d17b0(0x2dc)]);break;case _0x1d17b0(0x1f5):updateLive(_0xede512,_0x2e9519['started']),io['to'](_0xede512)[_0x1d17b0(0x193)](_0x1d17b0(0x270),{'access':{'allow':![],'reason':_0x1d17b0(0x2da),'token':null}});break;case _0x1d17b0(0x2e0):_0x2e9519[_0x1d17b0(0x2e0)]==_0x1d17b0(0x191)&&restartBot(_0xede512);_0x2e9519[_0x1d17b0(0x2e0)]==_0x1d17b0(0x24b)&&toggleBot(_0xede512,_0x1d17b0(0x353),_0x1d17b0(0x33f));break;case'telegram':sendTelegramBot(_0xede512,_0x2e9519[_0x1d17b0(0x38e)]);break;case'telegrammsg':sendTelegramMsg(_0x2e9519['telegrammsg']);break;case _0x1d17b0(0x22e):io['to'](_0xede512)[_0x1d17b0(0x193)](_0x2e9519[_0x1d17b0(0x22e)],_0x2e9519[_0x1d17b0(0x37e)]);break;}}),pid[_0xede512]['on']('error',function(_0x12f851){if(_0x188a8d)return;_0x188a8d=!![],_0xe4d5ef(_0x12f851);}),pid[_0xede512]['on']('exit',async function(_0x590f98){const _0x41880d=_0x3588be;if(terminating)return;if(installingUpdate){io[_0x41880d(0x376)]();return;}if(_0x188a8d)return;_0x188a8d=!![],_0xe4d5ef(null);const _0x5ccd7c=dbConfig[_0x41880d(0x29d)](_0x41880d(0x2c8))[_0x41880d(0x22f)]({'botID':_0xede512})[_0x41880d(0x1de)]();_0x5ccd7c&&(_0x5ccd7c[_0x41880d(0x270)]==_0x41880d(0x1f0)||_0x5ccd7c[_0x41880d(0x270)]==_0x41880d(0x210))&&(await sleep(0x3e8),updateLive(_0xede512,_0x41880d(0x33f)),logger[_0x41880d(0x25a)](_0x41880d(0x367)+_0xede512),startBot([_0xede512,userID],{'cwd':bbpath},function(_0x4249ae){const _0x3836a1=_0x41880d;if(_0x4249ae)logger[_0x3836a1(0x25a)](_0x4249ae);}));});}function stopBot(_0x211845){const _0x2e56e6=_0x5eea46;getClientsWithBotID(_0x211845)[_0x2e56e6(0x269)](_0x4cd5dc=>{getSocket(_0x4cd5dc['id'])['disconnect'](!![]),removeClient(_0x4cd5dc['id']);}),pid[_0x211845]&&(pid[_0x211845][_0x2e56e6(0x24b)](),pid[_0x211845]=null);}function stopAllBots(){const _0x23673c=_0x5eea46;terminating=!![];const _0x369a48=getEnabledBots();_0x369a48[_0x23673c(0x269)](_0x3006cf=>{stopBot(_0x3006cf['botID']);});}function restartBot(_0x4a4757){if(pid[_0x4a4757])pid[_0x4a4757]['kill']();}function addBot(){const _0x5db0d8=_0x5eea46;let _0x5be403;for(let _0x264763=0x1;_0x264763<0x3e9;_0x264763++){_0x5be403=_0x264763[_0x5db0d8(0x3a0)]()[_0x5db0d8(0x2ef)](0x3,'0');let _0x337b48=config['find'](_0x30b41a=>_0x30b41a[_0x5db0d8(0x394)]==_0x5be403);if(!_0x337b48)break;}if(_0x5be403===_0x5db0d8(0x2a9)){logger[_0x5db0d8(0x25a)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x5db0d8(0x25a)](_0x5db0d8(0x1f2)+_0x5be403),dbConfig[_0x5db0d8(0x29d)](_0x5db0d8(0x2c8))['push']({'botID':_0x5be403,'botname':_0x5db0d8(0x262)+_0x5be403,'status':'new','live':''})['write'](),startBot([_0x5be403,userID],{'cwd':bbpath},function(_0x3ffe63){const _0x44109b=_0x5db0d8;if(_0x3ffe63)logger[_0x44109b(0x25a)](_0x3ffe63);}),config=getConfiguration(),io['to'](_0x5db0d8(0x1a3))[_0x5db0d8(0x193)](_0x5db0d8(0x2c8),config),broadcastToBots(_0x5db0d8(0x2c8),JSON[_0x5db0d8(0x371)](config));}function deleteBot(_0x45fb2b){const _0x5ef1ea=_0x5eea46;getClientsWithBotID(_0x45fb2b)['forEach'](_0x430ee0=>{const _0x4f91e9=_0x6052;getSocket(_0x430ee0['id'])[_0x4f91e9(0x2ac)](!![]),removeClient(_0x430ee0['id']);}),dbConfig['get'](_0x5ef1ea(0x2c8))['remove']({'botID':_0x45fb2b})[_0x5ef1ea(0x1aa)](),logger[_0x5ef1ea(0x25a)](_0x5ef1ea(0x39b)+_0x45fb2b),stopBot(_0x45fb2b);try{if(fs[_0x5ef1ea(0x1e5)](path[_0x5ef1ea(0x298)](configpath,_0x5ef1ea(0x20f)+_0x45fb2b+'-config.json')))fs[_0x5ef1ea(0x246)](path['join'](configpath,_0x5ef1ea(0x20f)+_0x45fb2b+_0x5ef1ea(0x1b0)));if(fs[_0x5ef1ea(0x1e5)](path[_0x5ef1ea(0x298)](configpath,_0x5ef1ea(0x20f)+_0x45fb2b+'-events.json')))fs[_0x5ef1ea(0x246)](path[_0x5ef1ea(0x298)](configpath,_0x5ef1ea(0x20f)+_0x45fb2b+'-events.json'));if(fs['existsSync'](path['join'](configpath,_0x5ef1ea(0x20f)+_0x45fb2b+_0x5ef1ea(0x1e4))))fs[_0x5ef1ea(0x246)](path[_0x5ef1ea(0x298)](configpath,_0x5ef1ea(0x20f)+_0x45fb2b+_0x5ef1ea(0x1e4)));if(fs[_0x5ef1ea(0x1e5)](path[_0x5ef1ea(0x298)](configpath,'bot-'+_0x45fb2b+_0x5ef1ea(0x297))))fs['unlinkSync'](path[_0x5ef1ea(0x298)](configpath,_0x5ef1ea(0x20f)+_0x45fb2b+_0x5ef1ea(0x297)));}catch(_0x211fbd){if(_0x211fbd)logger[_0x5ef1ea(0x25a)](_0x5ef1ea(0x320),_0x211fbd);}config=getConfiguration(),io['to'](_0x5ef1ea(0x1a3))[_0x5ef1ea(0x193)]('bots',config),broadcastToBots(_0x5ef1ea(0x2c8),JSON[_0x5ef1ea(0x371)](config));}function toggleBot(_0x395c77,_0x1d971f,_0xee9ada){const _0x5152f0=_0x5eea46;dbConfig[_0x5152f0(0x29d)](_0x5152f0(0x2c8))[_0x5152f0(0x22f)]({'botID':_0x395c77})[_0x5152f0(0x236)]({'status':_0x1d971f})[_0x5152f0(0x236)]({'live':_0xee9ada})[_0x5152f0(0x1aa)]();if(_0x1d971f==_0x5152f0(0x1f0)||_0x1d971f==_0x5152f0(0x210))logger['full'](_0x5152f0(0x28f)+_0x395c77),startBot([_0x395c77,userID],{'cwd':bbpath},function(_0xd193ce){if(_0xd193ce)logger['full'](_0xd193ce);});else(_0x1d971f==_0x5152f0(0x353)||_0x1d971f==_0x5152f0(0x1da))&&(logger[_0x5152f0(0x25a)](_0x5152f0(0x2dd)+_0x395c77),stopBot(_0x395c77));config=getConfiguration(),io['to']('botmanager')['emit'](_0x5152f0(0x2c8),config),broadcastToBots(_0x5152f0(0x2c8),JSON[_0x5152f0(0x371)](config));}function toggleStatus(_0x1f2054){const _0x1198ab=_0x5eea46;let _0x5c4f03=dbConfig['get'](_0x1198ab(0x2c8))[_0x1198ab(0x22f)]({'botID':_0x1f2054})[_0x1198ab(0x1de)](),_0x32ca70;if(_0x5c4f03[_0x1198ab(0x270)]===_0x1198ab(0x1f0))_0x32ca70=_0x1198ab(0x353);else{if(_0x5c4f03['status']==='new')_0x32ca70=_0x1198ab(0x1da);else{if(_0x5c4f03[_0x1198ab(0x270)]===_0x1198ab(0x1da))_0x32ca70=_0x1198ab(0x210);else{if(_0x5c4f03[_0x1198ab(0x270)]===_0x1198ab(0x353))_0x32ca70='enabled';}}}return _0x32ca70;}function updateStatus(_0x49e41f,_0x3116a2){const _0x250aef=_0x5eea46;dbConfig[_0x250aef(0x29d)](_0x250aef(0x2c8))[_0x250aef(0x22f)]({'botID':_0x49e41f})[_0x250aef(0x236)]({'status':_0x3116a2})[_0x250aef(0x1aa)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x250aef(0x2c8),config),broadcastToBots(_0x250aef(0x2c8),JSON[_0x250aef(0x371)](config));}function updateLive(_0x20bb9f,_0x3038e1){const _0x287e3c=_0x5eea46;dbConfig[_0x287e3c(0x29d)](_0x287e3c(0x2c8))['find']({'botID':_0x20bb9f})[_0x287e3c(0x236)]({'live':_0x3038e1})['write'](),config=getConfiguration(),io['to'](_0x287e3c(0x1a3))[_0x287e3c(0x193)](_0x287e3c(0x2c8),config),broadcastToBots(_0x287e3c(0x2c8),JSON[_0x287e3c(0x371)](config));}function updateBotName(_0x55c792,_0x3f69e6){const _0x52a7ae=_0x5eea46;dbConfig[_0x52a7ae(0x29d)](_0x52a7ae(0x2c8))['find']({'botID':_0x55c792})[_0x52a7ae(0x236)]({'botname':_0x3f69e6})[_0x52a7ae(0x1aa)](),config=getConfiguration(),io['to'](_0x52a7ae(0x1a3))['emit']('bots',config),broadcastToBots(_0x52a7ae(0x2c8),JSON['stringify'](config));}function updateBotManager(){const _0x1261eb=_0x5eea46;config=getConfiguration(),io['to']('botmanager')[_0x1261eb(0x193)](_0x1261eb(0x2c8),config),broadcastToBots(_0x1261eb(0x2c8),JSON[_0x1261eb(0x371)](config));}function toggleBotMode(_0x1c2e78){const _0x132bf2=_0x5eea46;if(pid[_0x1c2e78])pid[_0x1c2e78][_0x132bf2(0x38c)]({'function':'toggleBotMode','args':null});else{const _0x442b1d=configpath+_0x132bf2(0x20f)+_0x1c2e78+_0x132bf2(0x1b0),_0x5c9686=fs[_0x132bf2(0x1f9)](_0x442b1d),_0x1cef1f=JSON[_0x132bf2(0x285)](_0x5c9686),_0x47a670=_0x1cef1f['bot'][0x0][_0x132bf2(0x1e1)];_0x1cef1f[_0x132bf2(0x20e)][0x0]['headless']=!_0x47a670;const _0x553860=JSON[_0x132bf2(0x371)](_0x1cef1f,null,0x2);fs[_0x132bf2(0x2a8)](_0x442b1d,_0x553860),config=getConfiguration(),io['to'](_0x132bf2(0x1a3))[_0x132bf2(0x193)](_0x132bf2(0x2c8),config),broadcastToBots(_0x132bf2(0x2c8),JSON[_0x132bf2(0x371)](config));}}function validateTelegram(_0x55e7a8){const _0x5e1af2=_0x5eea46;if(_0x55e7a8[_0x5e1af2(0x2f6)][_0x5e1af2(0x1c2)]!=settings['telegramUsername']&&'@'+_0x55e7a8[_0x5e1af2(0x2f6)][_0x5e1af2(0x1c2)]!=settings['telegramUsername']||_0x55e7a8[_0x5e1af2(0x271)]['id']!=settings['telegramChatId'])return sendTelegram(_0x55e7a8['chat']['id'],_0x5e1af2(0x27f),{'parse_mode':_0x5e1af2(0x399)}),![];return!![];}async function initTelegram(){const _0x2698c8=_0x5eea46;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x2698c8(0x1f3)]);let _0x2c0305=_0x2698c8(0x2bb);_0x2c0305+='\x0a',_0x2c0305+=_0x2698c8(0x2fb),_0x2c0305+=_0x2698c8(0x2bf),_0x2c0305+=_0x2698c8(0x1b8),_0x2c0305+=_0x2698c8(0x25b),_0x2c0305+=_0x2698c8(0x1b9),_0x2c0305+=_0x2698c8(0x340),_0x2c0305+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x2c0305+=_0x2698c8(0x2df),_0x2c0305+=_0x2698c8(0x38a),_0x2c0305+=_0x2698c8(0x342),_0x2c0305+=_0x2698c8(0x25d),_0x2c0305+='/logs\x20-\x20receive\x20log\x20files\x0a',_0x2c0305+=_0x2698c8(0x21b),_0x2c0305+=_0x2698c8(0x232),_0x2c0305+=_0x2698c8(0x1a6),_0x2c0305+=_0x2698c8(0x1dd);let _0x41000a=_0x2698c8(0x2e1);_0x41000a+='\x0a',_0x41000a+=_0x2c0305,tgBot['catch']((_0x42ae9a,_0x24780f)=>{const _0x1c8ffc=_0x2698c8;logger['simple'](getTimeStamp()+_0x1c8ffc(0x2a7)),logger[_0x1c8ffc(0x2b1)]('Telegraf\x20error:',_0x42ae9a);}),tgBot[_0x2698c8(0x192)](async(_0xa492e4,_0x535a15)=>{const _0x3a9ad6=_0x2698c8;if(!(!settings[_0x3a9ad6(0x30a)]&&_0xa492e4[_0x3a9ad6(0x27b)]['message'][_0x3a9ad6(0x1e8)]==_0x3a9ad6(0x2c9))){if(!validateTelegram(_0xa492e4))return;}_0x535a15();}),tgBot[_0x2698c8(0x32f)](_0x2698c8(0x31c),async _0x286ec2=>{const _0x5a22ce=_0x2698c8;if(_0x286ec2[_0x5a22ce(0x2f6)][_0x5a22ce(0x1c2)]==settings[_0x5a22ce(0x36e)]||'@'+_0x286ec2['from'][_0x5a22ce(0x1c2)]==settings[_0x5a22ce(0x36e)]){if(!settings[_0x5a22ce(0x30a)])updateSetting('telegramChatId',_0x286ec2[_0x5a22ce(0x271)]['id']);}if(!validateTelegram(_0x286ec2))return;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x286ec2['chat']['id'],_0x41000a);}),tgBot[_0x2698c8(0x32f)](_0x2698c8(0x3a3),async _0x427c15=>{const _0x374ab8=_0x2698c8;updateSetting(_0x374ab8(0x212),!![]),await sendTelegram(_0x427c15[_0x374ab8(0x271)]['id'],'Notifications\x20enabled');}),tgBot['command'](_0x2698c8(0x1be),async _0x20fcd5=>{const _0x43a27d=_0x2698c8;await sendTelegram(_0x20fcd5[_0x43a27d(0x271)]['id'],_0x43a27d(0x3a1)),updateSetting(_0x43a27d(0x212),![]);}),tgBot['command'](_0x2698c8(0x23c),async _0x10c8c6=>{const _0x3dd799=_0x2698c8,_0x992dc5=Markup[_0x3dd799(0x249)]([Markup[_0x3dd799(0x1ed)][_0x3dd799(0x248)](_0x3dd799(0x2e7),_0x3dd799(0x1fa)),Markup[_0x3dd799(0x1ed)][_0x3dd799(0x248)](_0x3dd799(0x2c4),'config_alerts'),Markup[_0x3dd799(0x1ed)][_0x3dd799(0x248)](_0x3dd799(0x268),_0x3dd799(0x291))]);_0x10c8c6[_0x3dd799(0x1fb)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x992dc5);}),tgBot['action'](_0x2698c8(0x1fa),async _0x84873a=>{const _0x41b1a8=_0x2698c8;_0x84873a['editMessageReplyMarkup'](),updateSetting(_0x41b1a8(0x2f9),_0x41b1a8(0x2db)),updateSetting(_0x41b1a8(0x212),!![]),await sendTelegram(_0x84873a[_0x41b1a8(0x271)]['id'],_0x41b1a8(0x35f));}),tgBot['action']('config_alerts',async _0x574c13=>{const _0x4d6e65=_0x2698c8;_0x574c13[_0x4d6e65(0x31d)](),updateSetting('telegramEvents',_0x4d6e65(0x200)),updateSetting(_0x4d6e65(0x212),!![]),await sendTelegram(_0x574c13[_0x4d6e65(0x271)]['id'],_0x4d6e65(0x302));}),tgBot[_0x2698c8(0x1ea)](_0x2698c8(0x291),async _0x238393=>{const _0x2724db=_0x2698c8;_0x238393[_0x2724db(0x31d)](),updateSetting('telegramEvents',_0x2724db(0x34b)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x238393[_0x2724db(0x271)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x2698c8(0x32f)](_0x2698c8(0x270),async _0x3b71e1=>{const _0x1ab0bb=_0x2698c8,_0x38cd5d=getBotsWithMode();let _0x5ee25d=_0x1ab0bb(0x2e2);config[_0x1ab0bb(0x269)](_0xbac09d=>{const _0x8274d4=_0x1ab0bb,_0x1878a7=_0x38cd5d[_0x8274d4(0x22f)](_0x1cb9a0=>_0x1cb9a0[_0x8274d4(0x394)]==_0xbac09d[_0x8274d4(0x394)])[_0x8274d4(0x1ec)];_0x5ee25d+='Bot\x20'+_0xbac09d['botID']+':\x20'+_0xbac09d[_0x8274d4(0x270)]+_0x8274d4(0x1f8)+_0x1878a7+_0x8274d4(0x1f8)+_0xbac09d[_0x8274d4(0x2dc)]+'\x0a';}),_0x5ee25d+='\x0a',_0x5ee25d+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x5ee25d+=!settings[_0x1ab0bb(0x212)]?_0x1ab0bb(0x1eb):_0x1ab0bb(0x2f7),_0x5ee25d+=settings['telegramEnabled']?settings[_0x1ab0bb(0x2f9)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x1ab0bb(0x2d5)+settings['telegramEvents']+_0x1ab0bb(0x310):'',await sendTelegram(_0x3b71e1[_0x1ab0bb(0x271)]['id'],_0x5ee25d,{'parse_mode':_0x1ab0bb(0x399)});}),tgBot['command'](_0x2698c8(0x191),async _0x1d70e1=>{const _0x11e660=_0x2698c8,_0x209d97=getEnabledBots();if(_0x209d97[_0x11e660(0x3a6)]==0x0)await sendTelegram(_0x1d70e1['chat']['id'],_0x11e660(0x203));else{if(_0x209d97[_0x11e660(0x3a6)]>0x1)_0x209d97[_0x11e660(0x348)]({'botID':'all'});let _0x39d1f1=[],_0x1b7975=[];const _0x36ff62=_0x209d97[_0x11e660(0x3a6)]%0x4==0x0||_0x209d97[_0x11e660(0x3a6)]%0x4==0x3||_0x209d97[_0x11e660(0x3a6)]%0x3==0x1?0x4:0x3;let _0x128599=0x0;_0x209d97[_0x11e660(0x269)]((_0x3d15c8,_0x30fec6)=>{const _0x203740=_0x11e660;if(_0x30fec6%_0x36ff62==0x0)_0x1b7975=[];_0x1b7975[_0x203740(0x348)](Markup[_0x203740(0x1ed)][_0x203740(0x248)](_0x3d15c8['botID']=='all'?_0x203740(0x332):_0x203740(0x262)+_0x3d15c8['botID'],_0x203740(0x18d)+_0x3d15c8[_0x203740(0x394)])),_0x30fec6%_0x36ff62==0x0&&(_0x39d1f1[_0x128599]=_0x1b7975,_0x128599++);});const _0x4a9c8c=Markup[_0x11e660(0x249)](_0x39d1f1);_0x1d70e1[_0x11e660(0x1fb)](_0x11e660(0x2c1),_0x4a9c8c);}}),tgBot[_0x2698c8(0x1ea)](/restart_(.+)/,async _0x491242=>{const _0x2a934d=_0x2698c8,_0x4a5f22=_0x491242[_0x2a934d(0x1ff)][0x1];_0x491242[_0x2a934d(0x31d)](),_0x4a5f22==_0x2a934d(0x34b)?config[_0x2a934d(0x269)](_0x3de29b=>{const _0x572a78=_0x2a934d;restartBot(_0x3de29b[_0x572a78(0x394)]);}):restartBot(_0x4a5f22);}),tgBot['command']('on',async _0x522659=>{const _0x4285b6=_0x2698c8,_0x1a0dfe=getDisabledBots();if(_0x1a0dfe[_0x4285b6(0x3a6)]==0x0)await sendTelegram(_0x522659[_0x4285b6(0x271)]['id'],_0x4285b6(0x235));else{if(_0x1a0dfe[_0x4285b6(0x3a6)]>0x1)_0x1a0dfe[_0x4285b6(0x348)]({'botID':_0x4285b6(0x34b)});let _0x2b474a=[],_0x433872=[];const _0x41d030=_0x1a0dfe[_0x4285b6(0x3a6)]%0x4==0x0||_0x1a0dfe[_0x4285b6(0x3a6)]%0x4==0x3||_0x1a0dfe[_0x4285b6(0x3a6)]%0x3==0x1?0x4:0x3;let _0x4e0452=0x0;_0x1a0dfe[_0x4285b6(0x269)]((_0x8b2dcd,_0x4a4497)=>{const _0x1866b1=_0x4285b6;if(_0x4a4497%_0x41d030==0x0)_0x433872=[];_0x433872[_0x1866b1(0x348)](Markup[_0x1866b1(0x1ed)]['callback'](_0x8b2dcd[_0x1866b1(0x394)]==_0x1866b1(0x34b)?'All\x20bots':_0x1866b1(0x262)+_0x8b2dcd[_0x1866b1(0x394)],_0x1866b1(0x250)+_0x8b2dcd[_0x1866b1(0x394)])),_0x4a4497%_0x41d030==0x0&&(_0x2b474a[_0x4e0452]=_0x433872,_0x4e0452++);});const _0x3bae95=Markup[_0x4285b6(0x249)](_0x2b474a);_0x522659[_0x4285b6(0x1fb)](_0x4285b6(0x18f),_0x3bae95);}}),tgBot[_0x2698c8(0x1ea)](/on_(.+)/,async _0x164cb0=>{const _0x3f8412=_0x2698c8,_0x35f444=_0x164cb0[_0x3f8412(0x1ff)][0x1];_0x164cb0[_0x3f8412(0x31d)]();if(_0x35f444==_0x3f8412(0x34b)){const _0x59f2eb=getDisabledBots();await sendTelegram(_0x164cb0[_0x3f8412(0x271)]['id'],_0x3f8412(0x2f0)),_0x59f2eb['forEach'](_0x29d427=>{const _0x16c2c1=_0x3f8412;if(_0x29d427[_0x16c2c1(0x394)]!=_0x16c2c1(0x34b))toggleBot(_0x29d427[_0x16c2c1(0x394)],toggleStatus(_0x29d427[_0x16c2c1(0x394)]),_0x16c2c1(0x33f));});}else await sendTelegram(_0x164cb0['chat']['id'],_0x3f8412(0x20d)+_0x35f444),toggleBot(_0x35f444,toggleStatus(_0x35f444),_0x3f8412(0x33f));}),tgBot[_0x2698c8(0x32f)](_0x2698c8(0x2fd),async _0xf183ce=>{const _0x1ac349=_0x2698c8,_0x58c723=getEnabledBots();if(_0x58c723[_0x1ac349(0x3a6)]==0x0)await sendTelegram(_0xf183ce[_0x1ac349(0x271)]['id'],_0x1ac349(0x203));else{if(_0x58c723['length']>0x1)_0x58c723[_0x1ac349(0x348)]({'botID':'all'});let _0x2a10ec=[],_0x812d52=[];const _0x3de807=_0x58c723['length']%0x4==0x0||_0x58c723['length']%0x4==0x3||_0x58c723[_0x1ac349(0x3a6)]%0x3==0x1?0x4:0x3;let _0x5d0201=0x0;_0x58c723[_0x1ac349(0x269)]((_0x5c5c79,_0x3d5b93)=>{const _0x150a67=_0x1ac349;if(_0x3d5b93%_0x3de807==0x0)_0x812d52=[];_0x812d52['push'](Markup[_0x150a67(0x1ed)][_0x150a67(0x248)](_0x5c5c79[_0x150a67(0x394)]==_0x150a67(0x34b)?_0x150a67(0x332):_0x150a67(0x262)+_0x5c5c79[_0x150a67(0x394)],'off_'+_0x5c5c79['botID'])),_0x3d5b93%_0x3de807==0x0&&(_0x2a10ec[_0x5d0201]=_0x812d52,_0x5d0201++);});const _0x3a4ae7=Markup[_0x1ac349(0x249)](_0x2a10ec);_0xf183ce[_0x1ac349(0x1fb)](_0x1ac349(0x19c),_0x3a4ae7);}}),tgBot[_0x2698c8(0x1ea)](/off_(.+)/,async _0x5a66e2=>{const _0x1c0106=_0x2698c8,_0x5f51e9=_0x5a66e2[_0x1c0106(0x1ff)][0x1];_0x5a66e2[_0x1c0106(0x31d)]();if(_0x5f51e9==_0x1c0106(0x34b)){const _0x3cd65d=getEnabledBots();await sendTelegram(_0x5a66e2[_0x1c0106(0x271)]['id'],_0x1c0106(0x346)),_0x3cd65d[_0x1c0106(0x269)](_0x9d3a05=>{const _0x278d4b=_0x1c0106;if(_0x9d3a05[_0x278d4b(0x394)]!=_0x278d4b(0x34b))toggleBot(_0x9d3a05[_0x278d4b(0x394)],toggleStatus(_0x9d3a05[_0x278d4b(0x394)]),_0x278d4b(0x33f));});}else await sendTelegram(_0x5a66e2['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x5f51e9),toggleBot(_0x5f51e9,toggleStatus(_0x5f51e9),'stopped');}),tgBot['command'](_0x2698c8(0x1ad),async _0x7693f=>{const _0x1e73cf=_0x2698c8,_0x4c9df2=getEnabledBots();if(_0x4c9df2[_0x1e73cf(0x3a6)]==0x0)await sendTelegram(_0x7693f['chat']['id'],_0x1e73cf(0x203));else{if(_0x4c9df2['length']>0x1){let _0x374a57=[],_0x440444=[];const _0x564a35=_0x4c9df2[_0x1e73cf(0x3a6)]%0x4==0x0||_0x4c9df2[_0x1e73cf(0x3a6)]%0x4==0x3||_0x4c9df2[_0x1e73cf(0x3a6)]%0x3==0x1?0x4:0x3;let _0x2a9359=0x0;_0x4c9df2[_0x1e73cf(0x269)]((_0x38a0d4,_0x522772)=>{const _0x484347=_0x1e73cf;if(_0x522772%_0x564a35==0x0)_0x440444=[];_0x440444[_0x484347(0x348)](Markup[_0x484347(0x1ed)]['callback'](_0x484347(0x262)+_0x38a0d4[_0x484347(0x394)],_0x484347(0x201)+_0x38a0d4[_0x484347(0x394)])),_0x522772%_0x564a35==0x0&&(_0x374a57[_0x2a9359]=_0x440444,_0x2a9359++);});const _0x1dc709=Markup[_0x1e73cf(0x249)](_0x374a57);_0x7693f[_0x1e73cf(0x1fb)](_0x1e73cf(0x278),_0x1dc709);}else{const _0x455715=_0x4c9df2[0x0][_0x1e73cf(0x394)];if(pid[_0x455715])pid[_0x455715]['send']({'function':_0x1e73cf(0x2cb),'args':null});}}}),tgBot[_0x2698c8(0x1ea)](/metrics_(.+)/,async _0x1ee9ad=>{const _0x4f18dd=_0x2698c8,_0x152dbd=_0x1ee9ad[_0x4f18dd(0x1ff)][0x1];_0x1ee9ad['editMessageReplyMarkup']();if(pid[_0x152dbd])pid[_0x152dbd][_0x4f18dd(0x38c)]({'function':_0x4f18dd(0x2cb),'args':null});}),tgBot[_0x2698c8(0x32f)](_0x2698c8(0x374),async _0x4a3314=>{const _0x4d24d7=_0x2698c8,_0x12408a=getEnabledBots();if(_0x12408a[_0x4d24d7(0x3a6)]==0x0)await sendTelegram(_0x4a3314[_0x4d24d7(0x271)]['id'],_0x4d24d7(0x203));else{if(_0x12408a[_0x4d24d7(0x3a6)]>0x1){let _0xb56897=[],_0x463497=[];const _0xc4f578=_0x12408a['length']%0x4==0x0||_0x12408a[_0x4d24d7(0x3a6)]%0x4==0x3||_0x12408a[_0x4d24d7(0x3a6)]%0x3==0x1?0x4:0x3;let _0x84d4e3=0x0;_0x12408a[_0x4d24d7(0x269)]((_0x459c89,_0x1cc91b)=>{const _0x39f680=_0x4d24d7;if(_0x1cc91b%_0xc4f578==0x0)_0x463497=[];_0x463497[_0x39f680(0x348)](Markup[_0x39f680(0x1ed)]['callback']('Bot\x20'+_0x459c89['botID'],_0x39f680(0x364)+_0x459c89[_0x39f680(0x394)])),_0x1cc91b%_0xc4f578==0x0&&(_0xb56897[_0x84d4e3]=_0x463497,_0x84d4e3++);});const _0x3cf385=Markup['inlineKeyboard'](_0xb56897);_0x4a3314[_0x4d24d7(0x1fb)](_0x4d24d7(0x290),_0x3cf385);}else{const _0x9779f6=_0x12408a[0x0][_0x4d24d7(0x394)];if(pid[_0x9779f6])pid[_0x9779f6]['send']({'function':_0x4d24d7(0x231),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x3c65bd=>{const _0x46f514=_0x2698c8,_0x364d6a=_0x3c65bd[_0x46f514(0x1ff)][0x1];_0x3c65bd[_0x46f514(0x31d)]();if(pid[_0x364d6a])pid[_0x364d6a][_0x46f514(0x38c)]({'function':_0x46f514(0x231),'args':null});}),tgBot[_0x2698c8(0x32f)](_0x2698c8(0x369),async _0x278f66=>{const _0x1b5c98=_0x2698c8,_0x3a439b='logs';await zipFiles(_0x3a439b);const _0x51f38d=zippath+(_0x3a439b+_0x1b5c98(0x305));_0x278f66[_0x1b5c98(0x19e)]({'source':_0x51f38d})[_0x1b5c98(0x383)](()=>{})[_0x1b5c98(0x2f5)](_0x2f9f97=>logger[_0x1b5c98(0x2b1)](_0x1b5c98(0x1a7)+_0x3a439b+_0x1b5c98(0x1ef),_0x2f9f97));}),tgBot['command'](_0x2698c8(0x2d1),async _0x1c5f30=>{const _0x181d43=_0x2698c8,_0x2b75ba=_0x181d43(0x2d1);await backupConfigFiles(),await zipFiles(_0x2b75ba);const _0x21e4e4=zippath+(_0x2b75ba+_0x181d43(0x305));_0x1c5f30['replyWithDocument']({'source':_0x21e4e4})[_0x181d43(0x383)](()=>{})[_0x181d43(0x2f5)](_0x55cdd6=>logger[_0x181d43(0x2b1)](_0x181d43(0x1a7)+_0x2b75ba+_0x181d43(0x1ef),_0x55cdd6));}),tgBot[_0x2698c8(0x32f)](_0x2698c8(0x27b),async _0x4fd0f3=>{const _0xf7b59f=_0x2698c8;await getMessages();if(!updateAvailable)await sendTelegram(_0x4fd0f3[_0xf7b59f(0x271)]['id'],_0xf7b59f(0x35c));else{if(!validInstallation)await sendTelegram(_0x4fd0f3['chat']['id'],_0xf7b59f(0x20a));else{const _0x34f8d3=Markup[_0xf7b59f(0x249)]([Markup[_0xf7b59f(0x1ed)][_0xf7b59f(0x248)](_0xf7b59f(0x19a),'update_yes'),Markup['button'][_0xf7b59f(0x248)]('No',_0xf7b59f(0x1c1))]);_0x4fd0f3[_0xf7b59f(0x1fb)](_0xf7b59f(0x29e),_0x34f8d3);}}}),tgBot[_0x2698c8(0x1ea)](/update_(.+)/,async _0x54bbcb=>{const _0xd2fd6=_0x2698c8,_0x4dfbff=_0x54bbcb[_0xd2fd6(0x1ff)][0x1];_0x54bbcb['editMessageReplyMarkup'](),_0x4dfbff==_0xd2fd6(0x2cd)&&(await sendTelegram(_0x54bbcb[_0xd2fd6(0x271)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0xd2fd6(0x27b))),_0x4dfbff=='no'&&await sendTelegram(_0x54bbcb['chat']['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x2698c8(0x32f)](_0x2698c8(0x207),async _0x5b06be=>{const _0x5ef298=_0x2698c8;if(!validInstallation)await sendTelegram(_0x5b06be[_0x5ef298(0x271)]['id'],_0x5ef298(0x18b));else{const _0x16b466=Markup[_0x5ef298(0x249)]([Markup[_0x5ef298(0x1ed)][_0x5ef298(0x248)]('Yes',_0x5ef298(0x245)),Markup[_0x5ef298(0x1ed)][_0x5ef298(0x248)]('No',_0x5ef298(0x31e))]);_0x5b06be[_0x5ef298(0x1fb)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x16b466);}}),tgBot[_0x2698c8(0x1ea)](/reinstall_(.+)/,async _0x185008=>{const _0x2fbdc7=_0x2698c8,_0x3d7bde=_0x185008[_0x2fbdc7(0x1ff)][0x1];_0x185008[_0x2fbdc7(0x31d)](),_0x3d7bde==_0x2fbdc7(0x2cd)&&(await sendTelegram(_0x185008[_0x2fbdc7(0x271)]['id'],_0x2fbdc7(0x34e)),updateBB(_0x2fbdc7(0x207))),_0x3d7bde=='no'&&await sendTelegram(_0x185008[_0x2fbdc7(0x271)]['id'],_0x2fbdc7(0x208));}),tgBot[_0x2698c8(0x32f)](_0x2698c8(0x1ab),async _0x3698d7=>{const _0x59e0ae=_0x2698c8,_0x1be9fa=getBotsWithMode();if(_0x1be9fa[_0x59e0ae(0x3a6)]==0x0)await sendTelegram(_0x3698d7[_0x59e0ae(0x271)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x2e8dea=[],_0x176205=[];const _0xc33fb1=0x2;let _0x443cd9=0x0;_0x1be9fa['forEach']((_0xcbc6fd,_0x163f47)=>{const _0x536997=_0x59e0ae;if(_0x163f47%_0xc33fb1==0x0)_0x176205=[];_0x176205[_0x536997(0x348)](Markup[_0x536997(0x1ed)][_0x536997(0x248)](_0x536997(0x262)+_0xcbc6fd['botID']+'\x20('+_0xcbc6fd[_0x536997(0x1ec)]+')',_0x536997(0x21a)+_0xcbc6fd[_0x536997(0x394)])),_0x163f47%_0xc33fb1==0x0&&(_0x2e8dea[_0x443cd9]=_0x176205,_0x443cd9++);});const _0x2bfe72=Markup[_0x59e0ae(0x249)](_0x2e8dea);_0x3698d7[_0x59e0ae(0x1fb)](_0x59e0ae(0x258),_0x2bfe72);}}),tgBot['action'](/toggle_(.+)/,async _0x1c123f=>{const _0x493894=_0x2698c8,_0x436a83=_0x1c123f['match'][0x1];_0x1c123f[_0x493894(0x31d)]();const _0x31752a=getBotsWithMode(),_0x10da79=_0x31752a[_0x493894(0x22f)](_0x33e290=>_0x33e290[_0x493894(0x394)]==_0x436a83),_0x35211e=_0x10da79[_0x493894(0x1ec)]==_0x493894(0x2f8)?_0x493894(0x283):_0x493894(0x2f8);await sendTelegram(_0x1c123f[_0x493894(0x271)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x436a83+'\x20to\x20'+_0x35211e+'\x20mode'),toggleBotMode(_0x436a83);}),tgBot[_0x2698c8(0x32f)](_0x2698c8(0x241),async _0x4809c1=>{const _0x3d2cac=_0x2698c8;let _0x38770a='';config[_0x3d2cac(0x269)](_0x5492d7=>{const _0x435d83=_0x3d2cac;_0x38770a+=_0x435d83(0x262)+_0x5492d7['botID']+':\x20'+_0x5492d7[_0x435d83(0x284)]+'\x0a';}),await sendTelegram(_0x4809c1['chat']['id'],_0x38770a,{'parse_mode':'HTML'});}),tgBot[_0x2698c8(0x32f)](_0x2698c8(0x2ff),async _0x30784c=>{const _0x47ac45=_0x2698c8;await sendTelegram(_0x30784c[_0x47ac45(0x271)]['id'],_0x2c0305);}),process[_0x2698c8(0x1a2)](_0x2698c8(0x215),()=>tgBot['stop'](_0x2698c8(0x215))),process[_0x2698c8(0x1a2)](_0x2698c8(0x2a0),()=>tgBot[_0x2698c8(0x2e0)](_0x2698c8(0x2a0))),tgBot[_0x2698c8(0x27d)]();}function disableTelegram(){const _0x49afa5=_0x5eea46;tgBot&&tgBot[_0x49afa5(0x2e0)]();}async function sendTelegram(_0x5cfe02,_0x1bd77e,_0x1444ab){const _0xbd8f07=_0x5eea46;_0x1444ab={..._0x1444ab,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0xbd8f07(0x27e)](_0x5cfe02,_0x1bd77e,_0x1444ab);}catch(_0x4c13a8){logger[_0xbd8f07(0x2b1)](_0xbd8f07(0x388),_0x4c13a8);}}async function sendTelegramBot(_0x358ba3,_0x4b1905){const _0x400373=_0x5eea46;if(settings[_0x400373(0x212)]){if(settings[_0x400373(0x2f9)]==_0x400373(0x34b)||(_0x4b1905[_0x400373(0x1d7)]==_0x400373(0x329)||_0x4b1905[_0x400373(0x1d7)]==_0x400373(0x1a5)||_0x4b1905[_0x400373(0x1d7)]==_0x400373(0x199))&&settings[_0x400373(0x2f9)]=='alerts'||_0x4b1905['type']==_0x400373(0x2a2)&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x400373(0x30a)]){if(_0x4b1905[_0x400373(0x234)])await sendTelegram(settings[_0x400373(0x30a)],_0x4b1905[_0x400373(0x284)]+_0x400373(0x336)+_0x4b1905[_0x400373(0x266)]);else await sendTelegram(settings[_0x400373(0x30a)],_0x400373(0x262)+_0x358ba3+_0x400373(0x336)+_0x4b1905[_0x400373(0x266)]);}}}}async function sendTelegramMsg(_0x2ed8fb,_0x509aa3=_0x5eea46(0x399)){const _0x4faaed=_0x5eea46;return settings[_0x4faaed(0x212)]&&tgBot&&settings[_0x4faaed(0x30a)]?(await sendTelegram(settings[_0x4faaed(0x30a)],_0x2ed8fb,{'parse_mode':_0x509aa3}),!![]):![];}function getDeviceWithIp(_0x402af4){return devices['find'](_0x40ea0b=>_0x40ea0b['ip']===_0x402af4);}async function temporaryAccess2FA(_0x2166b5,_0xdc90d3){const _0x1e0f6f=_0x5eea46;let _0x467ea4=new Date(),_0x212133=![];if(lastIpApproval){if(_0x467ea4-lastIpApproval<0x1388)_0x212133=!![];}lastIpApproval=new Date();if(_0x212133)return;if(tgBot&&settings['telegramChatId']){const _0x403953=uuidRandom();tmpStorage[_0x403953]={'uuid':_0x2166b5,'externalip':_0xdc90d3};const _0x3b9ef0=Markup[_0x1e0f6f(0x249)]([Markup[_0x1e0f6f(0x1ed)]['callback'](_0x1e0f6f(0x381),_0x1e0f6f(0x289)+_0x403953),Markup[_0x1e0f6f(0x1ed)][_0x1e0f6f(0x248)](_0x1e0f6f(0x22a),'tempaccess_15_'+_0x403953),Markup['button']['callback'](_0x1e0f6f(0x226),_0x1e0f6f(0x33c)+_0x403953),Markup[_0x1e0f6f(0x1ed)][_0x1e0f6f(0x248)](_0x1e0f6f(0x282),_0x1e0f6f(0x1e3)+_0x403953)]);await sendTelegram(settings['telegramChatId'],_0x1e0f6f(0x28c)+normalizeIP(_0xdc90d3)['show']+'\x20?',_0x3b9ef0),tgBot[_0x1e0f6f(0x1ea)](/tempaccess_(.+)_(.+)/,async _0xc00bcb=>{const _0x3ed5e1=_0x1e0f6f,_0x2c3962=_0xc00bcb[_0x3ed5e1(0x1ff)][0x1],_0x8766ba=_0xc00bcb['match'][0x2],{uuid:_0x2729bf,externalip:_0x2e4341}=tmpStorage[_0x8766ba];delete tmpStorage[_0x8766ba],_0xc00bcb[_0x3ed5e1(0x31d)](),devices[_0x2729bf]['telegramIpApproval']={'clientip':_0x2e4341,'timestamp':new Date()[_0x3ed5e1(0x36f)](),'expiry':_0x2c3962},_0x2c3962!='reject'?(await sendTelegram(_0xc00bcb[_0x3ed5e1(0x271)]['id'],_0x3ed5e1(0x1ae)+_0x2c3962+'\x20minutes',{'parse_mode':_0x3ed5e1(0x399)}),io['to'](_0x2729bf)[_0x3ed5e1(0x193)](_0x3ed5e1(0x270),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0xc00bcb[_0x3ed5e1(0x271)]['id'],_0x3ed5e1(0x2d9)),io['to'](_0x2729bf)['emit'](_0x3ed5e1(0x270),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x876f64,_0x4493b4){const _0x480fb9=_0x5eea46;if(tgBot&&settings[_0x480fb9(0x30a)]){const _0x1dbb16=uuidRandom();tmpStorage[_0x1dbb16]={'uuid':_0x876f64,'externalip':_0x4493b4};const _0xf7d22e=Markup[_0x480fb9(0x249)]([Markup['button'][_0x480fb9(0x248)](_0x480fb9(0x20b),'login2fa_'+loginExpiry+'_'+_0x1dbb16),Markup['button']['callback'](_0x480fb9(0x282),_0x480fb9(0x330)+_0x1dbb16)]);await sendTelegram(settings[_0x480fb9(0x30a)],_0x480fb9(0x2ed)+normalizeIP(_0x4493b4)['show']+'\x20?',_0xf7d22e),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x54c5d8=>{const _0x152650=_0x480fb9,_0x2f2af6=_0x54c5d8[_0x152650(0x1ff)][0x1],_0x290181=_0x54c5d8[_0x152650(0x1ff)][0x2],{uuid:_0x177d76,externalip:_0x12869b}=tmpStorage[_0x290181];delete tmpStorage[_0x290181],_0x54c5d8['editMessageReplyMarkup'](),devices[_0x177d76][_0x152650(0x187)]={'clientip':_0x12869b,'timestamp':new Date()[_0x152650(0x36f)](),'expiry':_0x2f2af6},_0x2f2af6!=_0x152650(0x282)?(await sendTelegram(_0x54c5d8[_0x152650(0x271)]['id'],_0x152650(0x368),{'parse_mode':_0x152650(0x399)}),io['to'](_0x177d76)[_0x152650(0x193)](_0x152650(0x270),{'access':{'allow':![],'reason':_0x152650(0x2da),'token':null}})):(await sendTelegram(_0x54c5d8['chat']['id'],_0x152650(0x30c)),io['to'](_0x177d76)[_0x152650(0x193)](_0x152650(0x270),{'access':{'allow':![],'reason':_0x152650(0x224),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x18effd=_0x5eea46;return dbConfig['get']('bots')[_0x18effd(0x36c)](_0x18effd(0x394))[_0x18effd(0x31b)]({'status':_0x18effd(0x1f0)})[_0x18effd(0x1de)]()||[];}function getDisabledBots(){const _0x2b1426=_0x5eea46;return dbConfig['get'](_0x2b1426(0x2c8))[_0x2b1426(0x36c)](_0x2b1426(0x394))[_0x2b1426(0x31b)]({'status':_0x2b1426(0x353)})[_0x2b1426(0x1de)]()||[];}function getBotAttributes(_0x244aab){const _0x57ae66=_0x5eea46;let _0x336140={};const _0x7d6098=configpath+_0x57ae66(0x20f)+_0x244aab+_0x57ae66(0x1b0),_0x31a3f2=fs[_0x57ae66(0x1e5)](_0x7d6098);if(_0x31a3f2){const _0x4570b0=fs[_0x57ae66(0x1f9)](_0x7d6098);try{const _0x13fb2f=JSON[_0x57ae66(0x285)](_0x4570b0),_0xf9cc7c=_0x13fb2f?_0x13fb2f[_0x57ae66(0x20e)][0x0][_0x57ae66(0x1e1)]:![];_0x336140[_0x57ae66(0x1ec)]=_0xf9cc7c?'auto':_0x57ae66(0x283),_0x336140[_0x57ae66(0x284)]=_0x13fb2f?_0x13fb2f[_0x57ae66(0x20e)][0x0][_0x57ae66(0x284)]:_0x57ae66(0x262)+_0x244aab;}catch(_0x39a425){_0x336140['mode']=_0x57ae66(0x283),_0x336140[_0x57ae66(0x284)]=_0x57ae66(0x262)+_0x244aab;}}else _0x336140[_0x57ae66(0x1ec)]=_0x57ae66(0x283),_0x336140['botname']=_0x57ae66(0x262)+_0x244aab;return _0x336140;}function getBotsWithMode(){const _0x2c3cf2=_0x5eea46,_0xe3ab19=dbConfig['get'](_0x2c3cf2(0x2c8))['sortBy'](_0x2c3cf2(0x394))[_0x2c3cf2(0x1de)]()||[];return _0xe3ab19[_0x2c3cf2(0x269)](_0x1c12fa=>{const _0x50c8b3=_0x2c3cf2;let _0x7a3fb9=getBotAttributes(_0x1c12fa[_0x50c8b3(0x394)]);_0x1c12fa[_0x50c8b3(0x1ec)]=_0x7a3fb9[_0x50c8b3(0x1ec)];}),_0xe3ab19;}function getBotExchanges(){const _0x484010=_0x5eea46;let _0x441c5e=[];const _0x12f0c1=dbConfig[_0x484010(0x29d)](_0x484010(0x2c8))[_0x484010(0x36c)]('botID')[_0x484010(0x1de)]()||[];_0x12f0c1[_0x484010(0x269)](_0x582b6f=>{const _0x12ea2f=_0x484010;if(_0x582b6f[_0x12ea2f(0x270)]=='enabled'){const _0xe48b86=configpath+_0x12ea2f(0x20f)+_0x582b6f['botID']+_0x12ea2f(0x1b0),_0x311906=fs[_0x12ea2f(0x1e5)](_0xe48b86);let _0xe9e275;if(_0x311906){const _0x4cffd8=fs[_0x12ea2f(0x1f9)](_0xe48b86);try{const _0xb5750f=JSON[_0x12ea2f(0x285)](_0x4cffd8);_0xe9e275=_0xb5750f?_0xb5750f[_0x12ea2f(0x20e)][0x0][_0x12ea2f(0x1d1)]:null;}catch(_0x43a1c5){}}if(_0xe9e275)_0x441c5e['push'](_0xe9e275);}});const _0x21a536=[...new Set(_0x441c5e)][_0x484010(0x349)]();return _0x21a536;}async function initUser(){const _0x334949=_0x5eea46;if(!settings[_0x334949(0x23d)]){const _0x33cf96=uuidRandom();mixpanel['alias'](_0x33cf96),updateSetting(_0x334949(0x23d),_0x33cf96);}}async function initSecure(){const _0x143619=_0x5eea46;let _0x27dba6=getSecure();if(!_0x27dba6['hasOwnProperty']('secret')){let _0x55b559=await generateKeys();_0x27dba6[_0x143619(0x195)]=_0x55b559[_0x143619(0x195)],_0x27dba6[_0x143619(0x24c)]=_0x55b559[_0x143619(0x24c)],_0x27dba6[_0x143619(0x21d)]=crypto[_0x143619(0x384)](0x20)[_0x143619(0x3a0)](_0x143619(0x1f6));;storeSecure(_0x27dba6);}}function getSettings(){const _0x44dbd9=_0x5eea46;return dbSettings[_0x44dbd9(0x29d)](_0x44dbd9(0x280))[_0x44dbd9(0x1de)]()||{};}function getSecure(){const _0xc92f15=_0x5eea46;return dbSecure[_0xc92f15(0x29d)]('secure')[_0xc92f15(0x1de)]()||{};}function getBlacklist(){const _0x19e326=_0x5eea46;return dbSecure[_0x19e326(0x29d)](_0x19e326(0x2a1))[_0x19e326(0x1de)]()||[];}function broadcastToBots(_0x1bf8dd,_0x25bde0){config['forEach'](_0x538a0e=>{const _0x2bf8a9=_0x6052;if(_0x538a0e[_0x2bf8a9(0x270)]=='enabled'&&_0x538a0e['live']==_0x2bf8a9(0x2c2)||_0x538a0e['status']==_0x2bf8a9(0x210)&&_0x538a0e[_0x2bf8a9(0x2dc)]=='running'){if(pid[_0x538a0e[_0x2bf8a9(0x394)]])pid[_0x538a0e['botID']][_0x2bf8a9(0x38c)]({[_0x1bf8dd]:_0x25bde0});}});}async function storeSettings(_0x2ea326,_0x53971a=![]){const _0x4ff1ae=_0x5eea46;_0x2ea326={...settings,..._0x2ea326};if(_0x53971a&&_0x2ea326['bbPassword']!='************'&&_0x2ea326['bbPassword']!=_0x4ff1ae(0x29c)&&_0x2ea326[_0x4ff1ae(0x275)]!=''){const _0x666dd1=decryptRSA(secure['privateKey'],_0x2ea326[_0x4ff1ae(0x275)])[_0x4ff1ae(0x339)](_0x4ff1ae(0x327))[0x0],_0x1430e7=bcrypt[_0x4ff1ae(0x321)](_0x666dd1,saltRounds);_0x2ea326={..._0x2ea326,'bbPassword':_0x1430e7};}if(_0x53971a&&_0x2ea326[_0x4ff1ae(0x1f3)]!=_0x4ff1ae(0x33b)&&_0x2ea326[_0x4ff1ae(0x1f3)]!='***'&&_0x2ea326[_0x4ff1ae(0x1f3)]!=''){const _0x5ce529=decryptRSA(secure[_0x4ff1ae(0x24c)],_0x2ea326[_0x4ff1ae(0x1f3)])['split'](_0x4ff1ae(0x327))[0x0];_0x2ea326={..._0x2ea326,'telegramToken':_0x5ce529};}if(_0x53971a&&_0x2ea326['marketcapApi']!='************'&&_0x2ea326[_0x4ff1ae(0x361)]!='***'&&_0x2ea326[_0x4ff1ae(0x361)]!=''){const _0x202ac5=decryptRSA(secure[_0x4ff1ae(0x24c)],_0x2ea326[_0x4ff1ae(0x361)])[_0x4ff1ae(0x339)](_0x4ff1ae(0x327))[0x0];_0x2ea326={..._0x2ea326,'marketcapApi':_0x202ac5};}const _0x2ce7c7=_0x2ea326[_0x4ff1ae(0x1f3)]!='************'&&_0x2ea326[_0x4ff1ae(0x1f3)]!=settings[_0x4ff1ae(0x1f3)]||_0x2ea326[_0x4ff1ae(0x36e)]!=settings['telegramUsername'],_0x7a4dea=_0x2ea326['telegramToken']==''||_0x2ea326[_0x4ff1ae(0x36e)]=='',_0x95c1f4=_0x2ea326[_0x4ff1ae(0x361)]&&_0x2ea326[_0x4ff1ae(0x361)]!=_0x4ff1ae(0x33b)&&_0x2ea326[_0x4ff1ae(0x361)]!=settings[_0x4ff1ae(0x1f3)];_0x2ce7c7&&(_0x2ea326[_0x4ff1ae(0x30a)]=null,_0x2ea326['telegramEvents']=_0x4ff1ae(0x34b));for(const [_0x136ce5,_0x577b80]of Object[_0x4ff1ae(0x2d7)](_0x2ea326)){if(_0x136ce5==_0x4ff1ae(0x1f3)&&_0x577b80==_0x4ff1ae(0x33b)){_0x2ea326[_0x4ff1ae(0x1f3)]=settings[_0x4ff1ae(0x1f3)];continue;};if(_0x136ce5==_0x4ff1ae(0x275)&&_0x577b80==_0x4ff1ae(0x33b)){_0x2ea326[_0x4ff1ae(0x275)]=settings[_0x4ff1ae(0x275)];continue;};if(_0x136ce5==_0x4ff1ae(0x361)&&_0x577b80==_0x4ff1ae(0x33b)){_0x2ea326['marketcapApi']=settings['marketcapApi'];continue;};dbSettings['set'](_0x4ff1ae(0x20c)+_0x136ce5,_0x577b80)['write']();}settings=_0x2ea326,io['to'](_0x4ff1ae(0x1a3))['emit'](_0x4ff1ae(0x280),cleanSettings()),broadcastToBots(_0x4ff1ae(0x18a),settings[_0x4ff1ae(0x18a)]),broadcastToBots(_0x4ff1ae(0x189),settings[_0x4ff1ae(0x189)]),broadcastToBots(_0x4ff1ae(0x361),settings[_0x4ff1ae(0x361)]);if(_0x2ce7c7&&!_0x7a4dea)initTelegram();if(_0x2ce7c7&&_0x7a4dea)disableTelegram();getAllClients()[_0x4ff1ae(0x269)](_0x14e859=>{const _0x20b18d=_0x4ff1ae;getSocket(_0x14e859['id'])[_0x20b18d(0x193)](_0x20b18d(0x270),{'access':{'allow':![],'reason':_0x20b18d(0x2da),'token':null}});}),_0x95c1f4&&(await sleep(0xbb8),testMarketcapApi(_0x2ea326[_0x4ff1ae(0x361)]));}async function testMarketcapApi(_0x439c03){const _0x4b91f6=_0x5eea46,_0x1af391=[_0x4b91f6(0x2e6),_0x4b91f6(0x19b)];try{await axios[_0x4b91f6(0x29d)](_0x4b91f6(0x1c0),{'headers':{'X-CMC_PRO_API_KEY':_0x439c03},'params':{'symbol':_0x1af391[_0x4b91f6(0x3a0)]()}});}catch(_0x199bd6){_0x199bd6['toString']()[_0x4b91f6(0x312)](_0x4b91f6(0x252))?(io['to']('botmanager')['emit'](_0x4b91f6(0x32e),_0x4b91f6(0x378)),logger[_0x4b91f6(0x25a)](_0x4b91f6(0x378))):(io['to'](_0x4b91f6(0x1a3))[_0x4b91f6(0x193)](_0x4b91f6(0x32e),_0x4b91f6(0x222)),logger[_0x4b91f6(0x25a)](_0x4b91f6(0x222)),logger[_0x4b91f6(0x2b1)](_0x4b91f6(0x377),_0x199bd6[_0x4b91f6(0x3a0)]()+_0x4b91f6(0x22b)+_0x199bd6[_0x4b91f6(0x1af)]));return;}logger[_0x4b91f6(0x2b1)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x55eb5b,_0x677623){const _0x14d32a=_0x5eea46;dbSettings[_0x14d32a(0x1df)]('settings.'+_0x55eb5b,_0x677623)[_0x14d32a(0x1aa)](),settings=getSettings(),io['to'](_0x14d32a(0x1a3))[_0x14d32a(0x193)]('settings',cleanSettings());}function storeSecure(_0x4d139b){const _0x562257=_0x5eea46;dbSecure[_0x562257(0x29d)](_0x562257(0x240))['push'](_0x4d139b)[_0x562257(0x1aa)](),secure=_0x4d139b;}function addBlacklist(_0x491dad){const _0x55d940=_0x5eea46;cleanBlacklist();let _0x20d83d;devices[_0x491dad][_0x55d940(0x223)]?_0x20d83d=Math['max'](devices[_0x491dad][_0x55d940(0x223)][_0x55d940(0x323)],loginExpiry):_0x20d83d=loginExpiry,dbSecure[_0x55d940(0x29d)]('blacklist')[_0x55d940(0x348)]({'expiry':new Date()[_0x55d940(0x36f)]()+_0x20d83d*0x3c*0x3e8,'token':devices[_0x491dad][_0x55d940(0x1a1)][_0x55d940(0x205)]})[_0x55d940(0x1aa)](),blacklist=dbSecure[_0x55d940(0x29d)](_0x55d940(0x2a1))[_0x55d940(0x1de)]();}function cleanBlacklist(){const _0x4472cc=_0x5eea46;let _0x337ff8=dbSecure['get'](_0x4472cc(0x2a1))[_0x4472cc(0x357)]()['value'](),_0x340f5c=new Date()[_0x4472cc(0x36f)]();_0x337ff8[_0x4472cc(0x269)](_0x345c9a=>{const _0x570262=_0x4472cc;_0x345c9a['expiry']<_0x340f5c&&dbSecure[_0x570262(0x29d)]('blacklist')['remove']({'expiry':_0x345c9a[_0x570262(0x323)]})[_0x570262(0x1aa)]();});}function initStates(){let _0x2f8c92=getConfiguration();_0x2f8c92['forEach'](_0x4d9e41=>{_0x4d9e41['live']='stopped';}),storeConfiguration(_0x2f8c92);}async function generateKeys(){const _0x4de9fb=_0x5eea46,_0x54a4bc=forge[_0x4de9fb(0x38d)][_0x4de9fb(0x23a)][_0x4de9fb(0x21c)]({'bits':0x1000,'e':0x10001}),_0x21c1b6=forge[_0x4de9fb(0x38d)]['privateKeyToPem'](_0x54a4bc[_0x4de9fb(0x24c)]),_0x5235cd=forge[_0x4de9fb(0x38d)][_0x4de9fb(0x304)](_0x54a4bc[_0x4de9fb(0x195)]);return{'privateKey':_0x21c1b6,'publicKey':_0x5235cd};}async function oneTimeMigration(){const _0x5458d2=_0x5eea46;let _0x178ab6=getSettings(),_0x36e98a=![];!_0x178ab6['hasOwnProperty'](_0x5458d2(0x188))&&(_0x178ab6[_0x5458d2(0x188)]=0x0,_0x36e98a=!![]);!_0x178ab6[_0x5458d2(0x1c6)]('lastmsgemitted')&&(_0x178ab6['lastmsgemitted']=0x0,_0x36e98a=!![]);!_0x178ab6[_0x5458d2(0x1c6)]('latestversion')&&(_0x178ab6[_0x5458d2(0x216)]=_0x5458d2(0x1a8),_0x36e98a=!![]);!_0x178ab6[_0x5458d2(0x1c6)]('onepagemode')&&(_0x178ab6[_0x5458d2(0x189)]=![],_0x36e98a=!![]);!_0x178ab6[_0x5458d2(0x1c6)]('marketcapApi')&&(_0x178ab6[_0x5458d2(0x361)]='',_0x36e98a=!![]);if(_0x36e98a)storeSettings(_0x178ab6);try{fs[_0x5458d2(0x288)](configbackuppath,{'withFileTypes':!![]})[_0x5458d2(0x269)](_0x484de4=>{const _0x35a365=_0x5458d2;if(!_0x484de4['isDirectory']()){if(!_0x484de4[_0x35a365(0x29f)]['startsWith'](_0x35a365(0x264)))fs[_0x35a365(0x246)](configbackuppath+_0x484de4[_0x35a365(0x29f)]);}else fs[_0x35a365(0x2fe)](configbackuppath+_0x484de4['name'],{'recursive':!![]});});}catch(_0x4c977f){logger[_0x5458d2(0x2b1)](_0x5458d2(0x190),_0x4c977f);}}function storeConfiguration(_0x1c9879){const _0x14c082=_0x5eea46;dbConfig[_0x14c082(0x29d)](_0x14c082(0x2c8))[_0x14c082(0x2ae)]()[_0x14c082(0x1aa)](),dbConfig[_0x14c082(0x29d)]('bots')[_0x14c082(0x348)](..._0x1c9879)['write'](),config=_0x1c9879;}async function resetPassword(){const _0x3bc969=_0x5eea46;if(tgBot&&settings[_0x3bc969(0x30a)]){const _0x4a59cf=Markup[_0x3bc969(0x249)]([Markup['button'][_0x3bc969(0x248)](_0x3bc969(0x2cd),_0x3bc969(0x39a)),Markup[_0x3bc969(0x1ed)][_0x3bc969(0x248)]('no',_0x3bc969(0x32d))]);await sendTelegram(settings[_0x3bc969(0x30a)],_0x3bc969(0x2be),_0x4a59cf),tgBot[_0x3bc969(0x1ea)](/resetpw_(.+)/,async _0x3c18cf=>{const _0x716414=_0x3bc969,_0x5a8d08=_0x3c18cf[_0x716414(0x1ff)][0x1];_0x3c18cf[_0x716414(0x31d)]();if(_0x5a8d08!='no'){const _0x33f762=0xf,_0x3d832e=_0x716414(0x2b0),_0xf32c7b=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x33f762)))[_0x716414(0x1cb)](_0x57fda0=>_0x3d832e[_0x57fda0%_0x3d832e['length']])[_0x716414(0x298)](''),_0x5a4f5b=bcrypt[_0x716414(0x321)](_0xf32c7b,saltRounds);storeSettings({'bbPassword':_0x5a4f5b}),await sendTelegram(_0x3c18cf['chat']['id'],_0x716414(0x1fd)+_0xf32c7b,{'parse_mode':_0x716414(0x399)});}else await sendTelegram(_0x3c18cf[_0x716414(0x271)]['id'],_0x716414(0x247));});}}async function confirmRestore(_0x92b70a,_0x16b6f6){const _0x2ed256=_0x5eea46;io['to'](_0x2ed256(0x1a3))['emit'](_0x2ed256(0x32e),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','success');if(tgBot&&settings[_0x2ed256(0x30a)]){const _0x4785e5=uuidRandom();tmpStorage[_0x4785e5]={'path':_0x92b70a,'filename':_0x16b6f6};const _0x5bf4c1=Markup[_0x2ed256(0x249)]([Markup[_0x2ed256(0x1ed)][_0x2ed256(0x248)](_0x2ed256(0x2cd),_0x2ed256(0x37b)+_0x4785e5),Markup[_0x2ed256(0x1ed)]['callback']('no',_0x2ed256(0x230)+_0x4785e5)]);await sendTelegram(settings[_0x2ed256(0x30a)],_0x2ed256(0x36a),_0x5bf4c1),tgBot[_0x2ed256(0x1ea)](/restore_(.+)_(.+)/,async _0x201898=>{const _0xa5d521=_0x2ed256,_0x3ba182=_0x201898[_0xa5d521(0x1ff)][0x1],_0x46585c=_0x201898[_0xa5d521(0x1ff)][0x2],{path:_0x333055,filename:_0x53dfc0}=tmpStorage[_0x46585c];delete tmpStorage[_0x46585c],_0x201898[_0xa5d521(0x31d)](),_0x3ba182==_0xa5d521(0x2cd)?(logger[_0xa5d521(0x2b1)](_0xa5d521(0x2ee)),await sendTelegram(_0x201898[_0xa5d521(0x271)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':'HTML'}),unzipFile(_0x333055,_0x53dfc0)):(logger[_0xa5d521(0x2b1)](_0xa5d521(0x1bd)),await sendTelegram(_0x201898[_0xa5d521(0x271)]['id'],_0xa5d521(0x1bd)));});}}function getServerTime(){const _0x165f9d=_0x5eea46,_0x42b1da=new Date();return _0x42b1da[_0x165f9d(0x292)]()+'/'+(_0x42b1da[_0x165f9d(0x37a)]()+0x1)[_0x165f9d(0x3a0)]()[_0x165f9d(0x2ef)](0x2,'0')+'/'+_0x42b1da['getDate']()[_0x165f9d(0x3a0)]()['padStart'](0x2,'0')+'\x20'+_0x42b1da[_0x165f9d(0x1ce)]()['toString']()[_0x165f9d(0x2ef)](0x2,'0')+':'+_0x42b1da[_0x165f9d(0x343)]()[_0x165f9d(0x3a0)]()[_0x165f9d(0x2ef)](0x2,'0')+':'+_0x42b1da[_0x165f9d(0x254)]()[_0x165f9d(0x3a0)]()[_0x165f9d(0x2ef)](0x2,'0');}function getTimeStamp(){const _0x2e10ee=_0x5eea46,_0x50fa77=shiftedTime();return _0x50fa77['getFullYear']()+'/'+(_0x50fa77['getMonth']()+0x1)['toString']()[_0x2e10ee(0x2ef)](0x2,'0')+'/'+_0x50fa77[_0x2e10ee(0x1b2)]()[_0x2e10ee(0x3a0)]()['padStart'](0x2,'0')+'\x20'+_0x50fa77[_0x2e10ee(0x1ce)]()[_0x2e10ee(0x3a0)]()[_0x2e10ee(0x2ef)](0x2,'0')+':'+_0x50fa77[_0x2e10ee(0x343)]()[_0x2e10ee(0x3a0)]()[_0x2e10ee(0x2ef)](0x2,'0')+':'+_0x50fa77[_0x2e10ee(0x254)]()[_0x2e10ee(0x3a0)]()[_0x2e10ee(0x2ef)](0x2,'0');}function getCleanTimeStamp(){const _0xaf7f97=_0x5eea46,_0xcb80fd=shiftedTime();return _0xcb80fd[_0xaf7f97(0x292)]()+(_0xcb80fd[_0xaf7f97(0x37a)]()+0x1)['toString']()[_0xaf7f97(0x2ef)](0x2,'0')+_0xcb80fd['getDate']()[_0xaf7f97(0x3a0)]()[_0xaf7f97(0x2ef)](0x2,'0')+'-'+_0xcb80fd['getHours']()[_0xaf7f97(0x3a0)]()['padStart'](0x2,'0')+_0xcb80fd['getMinutes']()[_0xaf7f97(0x3a0)]()['padStart'](0x2,'0')+_0xcb80fd[_0xaf7f97(0x254)]()[_0xaf7f97(0x3a0)]()[_0xaf7f97(0x2ef)](0x2,'0');}function shiftedTime(){const _0x149147=_0x5eea46,_0x10ad86=new Date();let _0x95c6af=_0x10ad86;if(settings[_0x149147(0x18a)]&&settings['timeshift']!==0x0)_0x95c6af=fns[_0x149147(0x19d)](_0x10ad86,{'hours':settings['timeshift']});return _0x95c6af;}async function startScheduler(){const _0x23cf51=_0x5eea46,_0x417aeb=new Date()[_0x23cf51(0x338)](),_0x4fd2dc=shiftedTime()[_0x23cf51(0x1ce)]();_0x4fd2dc==0x4&&backupConfigFiles(),_0x4fd2dc==0x0&&(rotateLogFiles(),logger[_0x23cf51(0x2b1)](_0x23cf51(0x1bc)),logger[_0x23cf51(0x2b1)](_0x23cf51(0x1ac)+serverversion+_0x23cf51(0x261)+(environment=='staging'?_0x23cf51(0x30f):'')),logger[_0x23cf51(0x2b1)](_0x23cf51(0x1bc))),_0x417aeb%0x6==0x0&&triggerAnalytics(),_0x417aeb%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x5dc157){const _0xff5711=_0x5eea46;logger[_0xff5711(0x2b1)]('Restore\x20backup\x20file\x20'+_0x5dc157);const _0x216d02=getBotsWithMode();_0x216d02[_0xff5711(0x3a6)]>0x0?confirmRestore(configbackuppath,_0x5dc157):unzipFile(configbackuppath,_0x5dc157);}async function getBackupFiles(_0x5680c5=null){const _0x4a4a93=_0x5eea46;let _0x467d2b=[],_0x43175e=fs[_0x4a4a93(0x288)](configbackuppath,{'withFileTypes':!![]});_0x43175e['sort']((_0x38997d,_0x4f57bd)=>_0x38997d[_0x4a4a93(0x29f)]<_0x4f57bd['name']?0x1:_0x4f57bd[_0x4a4a93(0x29f)]<_0x38997d[_0x4a4a93(0x29f)]?-0x1:0x0),_0x43175e[_0x4a4a93(0x269)](_0x29d4ab=>{const _0x2f10e7=_0x4a4a93;if(!_0x29d4ab[_0x2f10e7(0x21f)]()&&_0x29d4ab[_0x2f10e7(0x29f)][_0x2f10e7(0x1c8)](_0x2f10e7(0x264))&&_0x29d4ab[_0x2f10e7(0x29f)]['endsWith'](_0x2f10e7(0x305))){const _0x14806b=formatDate(fs[_0x2f10e7(0x2ce)](configbackuppath+_0x29d4ab[_0x2f10e7(0x29f)])[_0x2f10e7(0x35e)]);_0x467d2b[_0x2f10e7(0x348)]({'name':_0x29d4ab[_0x2f10e7(0x29f)],'mtime':_0x14806b});}});if(_0x5680c5)io['to'](_0x5680c5)['emit'](_0x4a4a93(0x263),_0x467d2b);else return _0x467d2b;}async function backupConfigFiles(){const _0x5adc47=_0x5eea46;await zipFiles('backup-full');const _0x3ddb9d=getCleanTimeStamp();fs[_0x5adc47(0x1ba)](zippath+_0x5adc47(0x306),configbackuppath+(_0x5adc47(0x264)+_0x3ddb9d+_0x5adc47(0x305)));let _0x1d0bba=fs[_0x5adc47(0x288)](configbackuppath,{'withFileTypes':!![]});_0x1d0bba[_0x5adc47(0x349)]((_0x341860,_0x22ae8b)=>_0x341860[_0x5adc47(0x29f)]<_0x22ae8b[_0x5adc47(0x29f)]?0x1:_0x22ae8b['name']<_0x341860[_0x5adc47(0x29f)]?-0x1:0x0),_0x1d0bba[_0x5adc47(0x3a6)]>maxBackups&&fs[_0x5adc47(0x246)](configbackuppath+_0x1d0bba[_0x1d0bba[_0x5adc47(0x3a6)]-0x1][_0x5adc47(0x29f)]);}function rotateLogFiles(){const _0x407613=_0x5eea46,_0x133829=fs[_0x407613(0x2ce)](logspath+'output-000.log'),_0x4de93a=_0x133829['size']/0x400;if(_0x4de93a>0x64){let _0x1a94c=fs[_0x407613(0x288)](logspath,{'withFileTypes':!![]});_0x1a94c[_0x407613(0x349)]((_0x45c5c7,_0xb1f461)=>_0x45c5c7['name']<_0xb1f461[_0x407613(0x29f)]?0x1:_0xb1f461[_0x407613(0x29f)]<_0x45c5c7[_0x407613(0x29f)]?-0x1:0x0),_0x1a94c[_0x407613(0x269)](_0xc4fbb7=>{const _0x3c0708=_0x407613;if(_0xc4fbb7['name']=='output-002.log')fs[_0x3c0708(0x1ba)](logspath+_0xc4fbb7[_0x3c0708(0x29f)],logspath+_0x3c0708(0x202));if(_0xc4fbb7['name']==_0x3c0708(0x362))fs[_0x3c0708(0x1ba)](logspath+_0xc4fbb7['name'],logspath+'output-002.log');_0xc4fbb7[_0x3c0708(0x29f)]==_0x3c0708(0x220)&&(fs['copyFileSync'](logspath+_0xc4fbb7['name'],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0xc4fbb7[_0x3c0708(0x29f)],''));});}}async function zipFiles(_0x8296cc){const _0x4c7683=_0x5eea46;let _0x1f49b3;if(_0x8296cc==_0x4c7683(0x369))_0x1f49b3=logspath;if(_0x8296cc==_0x4c7683(0x2d1))_0x1f49b3=configpath;if(_0x8296cc==_0x4c7683(0x2b5))_0x1f49b3=configpath;let _0x25f1e7=fs[_0x4c7683(0x288)](_0x1f49b3,{'withFileTypes':!![]});const _0x12af99=new JSZip();_0x25f1e7['forEach'](_0x366312=>{const _0x5bf8e5=_0x4c7683;if(!_0x366312[_0x5bf8e5(0x21f)]()){let _0x5dfbff=fs[_0x5bf8e5(0x1f9)](_0x1f49b3+_0x366312['name']);if(_0x8296cc==_0x5bf8e5(0x2d1)){const _0x48d72e=/^bot-[0-9]{3}-config.json$/,_0x3708b5=_0x48d72e[_0x5bf8e5(0x2ab)](_0x366312[_0x5bf8e5(0x29f)]);if(_0x3708b5){const _0x57f142=JSON[_0x5bf8e5(0x285)](_0x5dfbff);if(_0x57f142[_0x5bf8e5(0x20e)][0x0]){_0x57f142['bot'][0x0][_0x5bf8e5(0x397)]=_0x5bf8e5(0x29c),_0x57f142[_0x5bf8e5(0x20e)][0x0][_0x5bf8e5(0x2b8)]='***';if(_0x57f142['bot'][0x0][_0x5bf8e5(0x259)])_0x57f142[_0x5bf8e5(0x20e)][0x0]['apiPassword']=_0x5bf8e5(0x29c);}_0x5dfbff=JSON['stringify'](_0x57f142,null,0x2);}if(_0x366312[_0x5bf8e5(0x29f)]==_0x5bf8e5(0x238)){const _0x588596=JSON[_0x5bf8e5(0x285)](_0x5dfbff);if(_0x588596[_0x5bf8e5(0x280)][_0x5bf8e5(0x255)])_0x588596[_0x5bf8e5(0x280)][_0x5bf8e5(0x255)]=![];if(_0x588596[_0x5bf8e5(0x280)][_0x5bf8e5(0x275)])_0x588596[_0x5bf8e5(0x280)]['bbPassword']=_0x5bf8e5(0x29c);if(_0x588596[_0x5bf8e5(0x280)][_0x5bf8e5(0x1f3)])_0x588596[_0x5bf8e5(0x280)][_0x5bf8e5(0x1f3)]=_0x5bf8e5(0x29c);if(_0x588596[_0x5bf8e5(0x280)]['telegramChatId'])_0x588596[_0x5bf8e5(0x280)][_0x5bf8e5(0x30a)]=null;if(_0x588596['settings']['marketcapApi'])_0x588596['settings'][_0x5bf8e5(0x361)]=_0x5bf8e5(0x29c);_0x5dfbff=JSON['stringify'](_0x588596,null,0x2);}if(_0x366312['name']!=_0x5bf8e5(0x299))_0x12af99[_0x5bf8e5(0x1d9)](_0x366312[_0x5bf8e5(0x29f)],_0x5dfbff);}else _0x12af99[_0x5bf8e5(0x1d9)](_0x366312[_0x5bf8e5(0x29f)],_0x5dfbff);}});const _0x42bd28=await _0x12af99[_0x4c7683(0x2b9)]({'type':_0x4c7683(0x356),'base64':![],'compression':_0x4c7683(0x2ad)});fs[_0x4c7683(0x2a8)](zippath+(_0x8296cc+_0x4c7683(0x305)),_0x42bd28,'binary');}async function unzipFile(_0x19b5e7,_0x1266d8){const _0x5c6dab=_0x5eea46;fs[_0x5c6dab(0x288)](configpath,{'withFileTypes':!![]})[_0x5c6dab(0x269)](_0x462841=>{const _0x2b6992=_0x5c6dab;if(!_0x462841[_0x2b6992(0x21f)]())fs[_0x2b6992(0x2fe)](configpath+_0x462841[_0x2b6992(0x29f)]);});const _0x480114=fs['readFileSync'](_0x19b5e7+_0x1266d8,_0x5c6dab(0x293)),_0x1b2a67=await JSZip[_0x5c6dab(0x351)](_0x480114,{'base64':![],'checkCRC32':!![]});for(const _0x577c5c of Object[_0x5c6dab(0x2f3)](_0x1b2a67[_0x5c6dab(0x260)])){const _0x1ec68d=_0x1b2a67[_0x5c6dab(0x260)][_0x577c5c],_0x2129a5=await _0x1ec68d[_0x5c6dab(0x2cc)](_0x5c6dab(0x356));fs['writeFileSync'](configpath+_0x1ec68d[_0x5c6dab(0x29f)],_0x2129a5);}fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x5c6dab(0x269)](_0x42086b=>{const _0x3f6fe8=_0x5c6dab;if(!_0x42086b['isDirectory']())fs[_0x3f6fe8(0x2fe)](temppath+_0x42086b[_0x3f6fe8(0x29f)]);}),logger[_0x5c6dab(0x2b1)](_0x5c6dab(0x27a)),process[_0x5c6dab(0x38c)]({'restore':!![]},_0x389405=>{});}async function getPublicIp(){const _0x196603=_0x5eea46;try{const _0x226905=await axios[_0x196603(0x29d)]('https://api.ipify.org?format=json');publicip=_0x226905['data']['ip'];}catch(_0x3ed753){}}async function triggerAnalytics(){const _0x954acd=_0x5eea46;if(!publicip)await getPublicIp();const _0x17dae2=getBotsWithMode();let _0x4bc242=0x0;_0x17dae2[_0x954acd(0x269)](_0x57343c=>{const _0x576df2=_0x954acd;if(_0x57343c['status']===_0x576df2(0x1f0))_0x4bc242++;});const _0x2c6d43=getBotExchanges();mixpanel[_0x954acd(0x1a4)](_0x954acd(0x2d2),{'distinct_id':settings[_0x954acd(0x23d)],'ip':publicip,'version':serverversion,'numbots':_0x17dae2[_0x954acd(0x3a6)],'numbotsenabled':_0x4bc242,'exchanges':_0x2c6d43,'environment':environment});}async function getMessages(){const _0xdf9686=_0x5eea46,_0xc4e730=_0xdf9686(0x273),_0x244bf5=new GraphQLClient(_0xc4e730),_0x37fea0={'authorization':_0xdf9686(0x35b)},_0x3b3df1=serverversion[_0xdf9686(0x339)]('.'),_0x30cfa4=_0x3b3df1[0x0]+'.'+_0x3b3df1[0x1],_0x132955=Math[_0xdf9686(0x393)](settings[_0xdf9686(0x188)],settings[_0xdf9686(0x372)]),_0x202744={'last':parseInt(_0x132955),'bbm':_0x30cfa4},_0x110db2=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x580101;try{_0x580101=await _0x244bf5[_0xdf9686(0x1b6)](_0x110db2,_0x202744,_0x37fea0);}catch(_0x319f76){}if(_0x580101&&_0x580101[_0xdf9686(0x242)]){let _0x3a8386=settings[_0xdf9686(0x188)];newMessages=[];for(const _0x3d8ddc of _0x580101[_0xdf9686(0x242)]){newMessages[_0xdf9686(0x348)](_0x3d8ddc);let _0x2dbf4d=![];_0x3d8ddc[_0xdf9686(0x2ba)]&&(updateSetting('latestversion',_0x3d8ddc[_0xdf9686(0x2ba)]),_0x2dbf4d=isNewerVersion(serverversion,_0x3d8ddc[_0xdf9686(0x2ba)])||serverversion==_0x3d8ddc[_0xdf9686(0x2ba)]);if(!_0x2dbf4d&&_0x3d8ddc[_0xdf9686(0x256)]>_0x3a8386){if(_0x3d8ddc[_0xdf9686(0x2f1)]===_0xdf9686(0x1e7)||serverversion['startsWith'](_0x3d8ddc[_0xdf9686(0x2f1)])){let _0x2d7af8=''+_0x3d8ddc[_0xdf9686(0x1b4)]+'\x0a\x0a'+_0x3d8ddc[_0xdf9686(0x335)];const _0x3c8409=await sendTelegramMsg(toTelegramMarkdown(_0x2d7af8),_0xdf9686(0x2ea));if(_0x3c8409)_0x3a8386=_0x3d8ddc['number'];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0xdf9686(0x188),_0x3a8386),emitMessages();}}function emitMessages(){const _0x30b06d=_0x5eea46,_0x34777e=settings[_0x30b06d(0x372)];let _0x8c0de0=[];newMessages[_0x30b06d(0x269)](_0x3d2731=>{const _0x323315=_0x30b06d;_0x3d2731[_0x323315(0x256)]>_0x34777e&&_0x8c0de0[_0x323315(0x348)](_0x3d2731);}),_0x8c0de0[_0x30b06d(0x3a6)]>0x0&&getAllClients()[_0x30b06d(0x269)](_0x50d8e6=>{const _0x48d6bf=_0x30b06d;getSocket(_0x50d8e6['id'])['emit'](_0x48d6bf(0x335),_0x8c0de0);});}function confirmMessage(_0x2d178f){updateSetting('lastmsgemitted',Number(_0x2d178f));}function isNewerVersion(_0x4c5651,_0x103c82){const _0x531f5e=_0x5eea46,_0x423a69=_0x103c82['split']('.'),_0x8e6b5b=_0x4c5651[_0x531f5e(0x339)]('.');for(var _0xf774c0=0x0;_0xf774c0<_0x8e6b5b[_0x531f5e(0x3a6)];_0xf774c0++){const _0x35e3c1=~~_0x8e6b5b[_0xf774c0],_0x1a2ebc=~~_0x423a69[_0xf774c0];if(_0x35e3c1>_0x1a2ebc)return!![];if(_0x35e3c1<_0x1a2ebc)return![];}return![];}function toTelegramMarkdown(_0x3d4437){const _0x4fd142=_0x5eea46,_0x46f6d2=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3af744=/\*{2}(.+?)\*{2}/gim;return _0x3d4437=_0x3d4437[_0x4fd142(0x392)](_0x46f6d2,_0x4fd142(0x2c7))[_0x4fd142(0x392)](_0x3af744,'*$1*'),_0x3d4437;}async function validateConfigFile(){const _0x54747b=_0x5eea46,_0x1f188a=dbConfig[_0x54747b(0x29d)](_0x54747b(0x2c8))[_0x54747b(0x36c)]('botID')[_0x54747b(0x1de)]()||[];if(_0x1f188a[_0x54747b(0x3a6)]==0x0){let _0x308d0c=0x0,_0x39e721=[];const _0x1aec35=/^bot-([0-9]{3})-config.json$/,_0x143145=fs[_0x54747b(0x288)](configpath);_0x143145[_0x54747b(0x269)](_0x2e9922=>{const _0x3ca4b3=_0x54747b,_0x37d08e=_0x1aec35[_0x3ca4b3(0x286)](_0x2e9922);if(_0x37d08e){const _0x21aed7=_0x37d08e[0x1];let _0x19e8d0=getBotAttributes(_0x21aed7);_0x39e721[_0x3ca4b3(0x348)]({'botID':_0x21aed7,'botname':_0x19e8d0[_0x3ca4b3(0x284)],'status':_0x3ca4b3(0x353),'live':_0x3ca4b3(0x33f)}),_0x308d0c++;}}),_0x308d0c!=0x0&&(dbConfig[_0x54747b(0x29d)](_0x54747b(0x2c8))[_0x54747b(0x236)](_0x39e721)[_0x54747b(0x1aa)](),config=_0x39e721,restoredConfigFile=_0x308d0c);}}async function restoreConfigNotify(_0x4e799c){const _0x5c0ec0=_0x5eea46;let _0x198344;if(restoredConfigFile==0x1)_0x198344=_0x5c0ec0(0x23b);else _0x198344=_0x5c0ec0(0x26f);if(_0x4e799c)io['to'](_0x5c0ec0(0x1a3))[_0x5c0ec0(0x193)](_0x5c0ec0(0x32e),_0x198344);else{logger['simple'](_0x5c0ec0(0x2f4)),logger[_0x5c0ec0(0x2a6)](_0x198344),logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x5c0ec0(0x2a6)]('');if(tgBot&&settings[_0x5c0ec0(0x30a)]&&settings['telegramEvents']!=_0x5c0ec0(0x2db))await sendTelegram(settings[_0x5c0ec0(0x30a)],'Bot\x20Mgr\x20>\x20'+_0x198344);}}function _0x6052(_0x2822ec,_0x1b9e15){const _0x2caddf=_0x35b4();return _0x6052=function(_0x2c5d75,_0x2d09a3){_0x2c5d75=_0x2c5d75-0x187;let _0x35b456=_0x2caddf[_0x2c5d75];return _0x35b456;},_0x6052(_0x2822ec,_0x1b9e15);}function decryptRSA(_0x22d0ed,_0x59cb5c){const _0xcbfa3f=_0x5eea46,_0xc421f5=forge[_0xcbfa3f(0x38d)]['privateKeyFromPem'](_0x22d0ed),_0x4bd8cd=_0xc421f5[_0xcbfa3f(0x196)](forge[_0xcbfa3f(0x276)][_0xcbfa3f(0x3a2)](_0x59cb5c),_0xcbfa3f(0x360),{'md':forge['md'][_0xcbfa3f(0x395)][_0xcbfa3f(0x39d)](),'mgf1':{'md':forge['md']['sha256']['create']()}});return _0x4bd8cd;}function validateCredentials(_0x1d1a2b,_0x339960){const _0x3332c2=_0x5eea46;if(_0x1d1a2b[_0x3332c2(0x1c2)]==settings[_0x3332c2(0x233)]&&bcrypt[_0x3332c2(0x3a5)](_0x1d1a2b[_0x3332c2(0x225)],settings[_0x3332c2(0x275)])){if(settings[_0x3332c2(0x1b7)])return{'allow':![],'reason':_0x3332c2(0x296),'token':null};else{const _0x14da24=generateLoginToken(_0x339960);return{'allow':!![],'reason':_0x3332c2(0x2d8),'token':_0x14da24};}}else return{'allow':![],'reason':_0x3332c2(0x21e),'token':null};}function refreshToken(_0xd220c3){const _0x2b53e4=_0x5eea46,_0x47e389=generateLoginToken(_0xd220c3);return{'allow':!![],'reason':_0x2b53e4(0x2d8),'token':_0x47e389};}function validateAccess(_0x447729,_0x545063,_0x51b128){const _0x4cacc4=_0x5eea46,_0x516f18=_0x51b128?_0x51b128:devices[_0x545063]['ip'];let _0x381f77;const _0x436a17=_0x2b8878=>{const _0xaab2af=_0x6052;if(settings[_0xaab2af(0x255)]){if(settings[_0xaab2af(0x1b7)]){if(telegram2FaApproved(_0x545063)){const _0xc1b88=generateLoginToken(_0x545063);return{'allow':!![],'reason':_0xaab2af(0x373),'token':_0xc1b88};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x381f77=validToken(_0x2b8878,_0x545063),_0x381f77[_0xaab2af(0x1c6)]('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x2b8878}:{'allow':![],'reason':_0xaab2af(0x2e8),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x4cacc4(0x237)]){let _0x1270d5=[...settings[_0x4cacc4(0x1d0)],'::1',_0x4cacc4(0x1bf),_0x4cacc4(0x2af)];if(_0x1270d5['includes'](_0x516f18))return _0x436a17(_0x447729);else{_0x381f77=validToken(_0x447729,_0x545063);if(_0x381f77[_0x4cacc4(0x1c6)](_0x4cacc4(0x199)))return _0x436a17(_0x447729);else{if(telegramIpApproved(_0x545063)){const _0x167fbc=generateToken(_0x545063);return _0x381f77=_0x436a17(_0x447729),_0x381f77[_0x4cacc4(0x3a8)]?{'allow':!![],'reason':_0x4cacc4(0x2e4),'token':_0x167fbc}:_0x381f77;}else return settings[_0x4cacc4(0x2c3)]?{'allow':![],'reason':_0x4cacc4(0x347),'token':null}:{'allow':![],'reason':_0x4cacc4(0x1fc),'token':null};}}}else return _0x436a17(_0x447729);}function timelyDecrypt(_0x386fab,_0x333141,_0x5b8827='@'){const _0x168594=_0x5eea46;if(_0x386fab)try{const _0x37773c=decryptRSA(secure['privateKey'],_0x386fab),_0x7e0590=_0x37773c['split'](_0x5b8827)[0x0],_0x41599=_0x37773c[_0x168594(0x339)](_0x5b8827)[0x1],_0x25d761=new Date()[_0x168594(0x36f)]();if(_0x333141){if(_0x25d761-_0x41599<maxSecretAge*0x3e8)return _0x7e0590;else return![];}else return _0x7e0590;}catch(_0x45443c){return![];}else return![];}const validToken=(_0x5789a4,_0x343342)=>{const _0x136ea0=_0x5eea46,_0x1ce3d0=devices[_0x343342]['ip'];if(!_0x5789a4)return{'error':_0x136ea0(0x26c)};for(let _0x4c5b20 of blacklist){if(_0x4c5b20[_0x136ea0(0x205)]==_0x5789a4)return{'error':_0x136ea0(0x30b)};}let _0x1740f4;try{_0x1740f4=jwt[_0x136ea0(0x301)](_0x5789a4,secure[_0x136ea0(0x21d)]+_0x343342);}catch{return{'error':_0x136ea0(0x1f1)};}if(!_0x1740f4['hasOwnProperty']('clientip')&&!_0x1740f4[_0x136ea0(0x1c6)](_0x136ea0(0x1c2))||!_0x1740f4['hasOwnProperty'](_0x136ea0(0x1c9)))return{'error':_0x136ea0(0x1cd)};if(!_0x1740f4['hasOwnProperty'](_0x136ea0(0x1c2))&&_0x1740f4[_0x136ea0(0x1c6)](_0x136ea0(0x325))){const {clientip:_0x2d2507}=_0x1740f4;return _0x1ce3d0==_0x2d2507?{'success':_0x136ea0(0x303)}:{'error':_0x136ea0(0x1c5)};}else{if(_0x1740f4[_0x136ea0(0x1c6)](_0x136ea0(0x1c2))&&_0x1740f4['hasOwnProperty'](_0x136ea0(0x325))){const {username:_0x41aa05,clientip:_0x4a0961}=_0x1740f4;return settings[_0x136ea0(0x233)]==_0x41aa05&&_0x1ce3d0==_0x4a0961?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x136ea0(0x2b2)};}}},generateLoginToken=_0x3d958c=>{const _0x1b4e24=_0x5eea46;if(_0x3d958c){const _0x381a60=devices[_0x3d958c]['ip'];return jwt[_0x1b4e24(0x35a)]({'username':settings[_0x1b4e24(0x233)],'clientip':_0x381a60},secure['secret']+_0x3d958c,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x22879d=>{const _0x2a09d9=_0x5eea46;if(_0x22879d){const _0x1f3f3b=devices[_0x22879d]['ip'];return jwt['sign']({'clientip':_0x1f3f3b},secure[_0x2a09d9(0x21d)]+_0x22879d,{'expiresIn':devices[_0x22879d]['telegramIpApproval'][_0x2a09d9(0x323)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x44dc7f=>{const _0x4de8dc=_0x5eea46;let _0x1e4782=![];return devices[_0x44dc7f][_0x4de8dc(0x223)]&&devices[_0x44dc7f][_0x4de8dc(0x223)][_0x4de8dc(0x323)]!=_0x4de8dc(0x282)&&(_0x1e4782=devices[_0x44dc7f][_0x4de8dc(0x223)][_0x4de8dc(0x325)]==devices[_0x44dc7f]['ip']&&new Date()['getTime']()-devices[_0x44dc7f]['telegramIpApproval'][_0x4de8dc(0x34d)]<devices[_0x44dc7f][_0x4de8dc(0x223)][_0x4de8dc(0x323)]*0x3c*0x3e8),_0x1e4782;},telegram2FaApproved=_0x57d02b=>{const _0x298325=_0x5eea46;let _0x3dbad5=![];return devices[_0x57d02b]['telegram2FaApproval']&&devices[_0x57d02b][_0x298325(0x187)][_0x298325(0x323)]!=_0x298325(0x282)&&(_0x3dbad5=devices[_0x57d02b][_0x298325(0x187)][_0x298325(0x325)]==devices[_0x57d02b]['ip']&&new Date()[_0x298325(0x36f)]()-devices[_0x57d02b][_0x298325(0x187)]['timestamp']<devices[_0x57d02b][_0x298325(0x187)][_0x298325(0x323)]*0x3c*0x3e8),_0x3dbad5;},normalizeIP=_0x2bfc9b=>{const _0x35a108=_0x5eea46;let _0x1fd1e4=null,_0x4b72f6=null;if(ipaddr[_0x35a108(0x324)](_0x2bfc9b)){const _0x39f476=ipaddr['parse'](_0x2bfc9b);_0x39f476[_0x35a108(0x350)]()===_0x35a108(0x272)?(_0x39f476[_0x35a108(0x1f7)]()&&(_0x1fd1e4=_0x39f476['toIPv4Address']()[_0x35a108(0x3a0)]()),_0x4b72f6=_0x39f476[_0x35a108(0x3a0)]()):(_0x1fd1e4=_0x39f476['toString'](),_0x4b72f6=_0x39f476[_0x35a108(0x359)]()['toString']());}return{'show':_0x1fd1e4?_0x1fd1e4:_0x4b72f6,'store':_0x4b72f6};};function formatDate(_0x412aba){const _0x4b6f5f=_0x5eea46;return _0x412aba[_0x4b6f5f(0x292)]()+'/'+(_0x412aba[_0x4b6f5f(0x37a)]()+0x1)[_0x4b6f5f(0x3a0)]()[_0x4b6f5f(0x2ef)](0x2,'0')+'/'+_0x412aba[_0x4b6f5f(0x1b2)]()[_0x4b6f5f(0x3a0)]()[_0x4b6f5f(0x2ef)](0x2,'0')+'\x20'+_0x412aba['getHours']()[_0x4b6f5f(0x3a0)]()[_0x4b6f5f(0x2ef)](0x2,'0')+':'+_0x412aba['getMinutes']()[_0x4b6f5f(0x3a0)]()[_0x4b6f5f(0x2ef)](0x2,'0')+':'+_0x412aba[_0x4b6f5f(0x254)]()[_0x4b6f5f(0x3a0)]()[_0x4b6f5f(0x2ef)](0x2,'0');}function sleep(_0x1736b0){return new Promise(_0x3b7a46=>setTimeout(_0x3b7a46,_0x1736b0));}