const _0x49797c=_0x3612;(function(_0x5313d9,_0x15fdbc){const _0x972929=_0x3612,_0xa05b92=_0x5313d9();while(!![]){try{const _0x109ebd=parseInt(_0x972929(0x227))/0x1+parseInt(_0x972929(0x1a0))/0x2*(-parseInt(_0x972929(0x141))/0x3)+parseInt(_0x972929(0x2cd))/0x4+-parseInt(_0x972929(0x105))/0x5+-parseInt(_0x972929(0x12b))/0x6*(-parseInt(_0x972929(0x274))/0x7)+-parseInt(_0x972929(0x1e0))/0x8*(-parseInt(_0x972929(0x19d))/0x9)+-parseInt(_0x972929(0x116))/0xa*(parseInt(_0x972929(0x27e))/0xb);if(_0x109ebd===_0x15fdbc)break;else _0xa05b92['push'](_0xa05b92['shift']());}catch(_0x31bcde){_0xa05b92['push'](_0xa05b92['shift']());}}}(_0x2b5a,0x7cdb8));const _0x38dba9=function(){let _0x1406af=!![];return function(_0x3c6c8e,_0x5aa90b){const _0x4d490e=_0x1406af?function(){const _0x32b72e=_0x3612;if(_0x5aa90b){const _0x484419=_0x5aa90b[_0x32b72e(0x12d)](_0x3c6c8e,arguments);return _0x5aa90b=null,_0x484419;}}:function(){};return _0x1406af=![],_0x4d490e;};}(),_0x23d4eb=_0x38dba9(this,function(){const _0x399583=_0x3612;return _0x23d4eb[_0x399583(0x22b)]()[_0x399583(0x294)](_0x399583(0x139))[_0x399583(0x22b)]()[_0x399583(0xf6)](_0x23d4eb)[_0x399583(0x294)](_0x399583(0x139));});_0x23d4eb();'use strict';process[_0x49797c(0x162)][_0x49797c(0x15d)]=0x1;const childProcess=require(_0x49797c(0x263)),fs=require('fs'),fns=require(_0x49797c(0x13d)),low=require(_0x49797c(0x2c2)),FileSync=require(_0x49797c(0x1d0)),path=require(_0x49797c(0x2e4)),crypto=require(_0x49797c(0x1a4)),forge=require(_0x49797c(0x18b)),bcrypt=require('bcryptjs'),jwt=require(_0x49797c(0x2cf)),ipaddr=require(_0x49797c(0x217)),yargs=require(_0x49797c(0x16f)),uuidRandom=require(_0x49797c(0x24d)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require('mixpanel'),axios=require(_0x49797c(0x2a9)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x49797c(0xf1)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x49797c(0x221)),argv=yargs(process[_0x49797c(0x253)][_0x49797c(0x2ae)](0x2))[_0x49797c(0x253)],PORT=argv[_0x49797c(0x1ac)]||_0x49797c(0x1c5),pattern=/^[0-9]{2,4}$/;!pattern[_0x49797c(0x14e)](PORT)&&(console[_0x49797c(0x134)](_0x49797c(0x2a4)+PORT+_0x49797c(0xe5)),process[_0x49797c(0x27c)](0x1));const HOST=argv[_0x49797c(0x110)]||null,userID=argv[_0x49797c(0x22e)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process['versions'][_0x49797c(0x208)];let bbpath='bb/',bbpath2='';const botfile=_0x49797c(0x2a7),configfile=_0x49797c(0x2ac),settingsfile='bb-settings.json',securefile=_0x49797c(0x1cc),environment=require('./'+bbpath2+'version.json')[_0x49797c(0x130)]||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x49797c(0x1d3)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x49797c(0x16d)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x49797c(0x2d8),configbackuppath=configpath+_0x49797c(0xd5),logspath=userID?bbpath+_0x49797c(0x15f)+userID+'/':bbpath+_0x49797c(0x15f),zippath=userID?bbpath+_0x49797c(0x23e)+userID+'/':bbpath+_0x49797c(0x23e),loggerfile=fs[_0x49797c(0x248)](logspath+_0x49797c(0x1e4),{'flags':'a'}),temppath=userID?bbpath+_0x49797c(0x123)+userID+'/':bbpath+_0x49797c(0x123);!fs[_0x49797c(0x1d3)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x49797c(0x1d3)](configbackuppath)&&fs[_0x49797c(0xf2)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x49797c(0xf2)](logspath);!fs[_0x49797c(0x1d3)](zippath)&&fs[_0x49797c(0xf2)](zippath);!fs[_0x49797c(0x1d3)](temppath)&&fs[_0x49797c(0xf2)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x49797c(0x287)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x49797c(0x148),'onepagemode':![],'marketcapApi':''}})[_0x49797c(0x2bb)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x49797c(0x287)]({'secure':{},'blacklist':[]})[_0x49797c(0x2bb)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x49797c(0x224)](_0x49797c(0x261),{'host':_0x49797c(0x255)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x49797c(0x142)]&&(settings[_0x49797c(0x142)]!=''&&settings[_0x49797c(0x142)]!=_0x49797c(0x244))&&settings['telegramUsername']&&settings[_0x49797c(0x1c2)]!='')initTelegram();const parseColor=(_0x4b3e81,_0x3bc5ab)=>{const _0x246ae2=_0x49797c,_0x49e3fa=/#[A-Z]{3}#/g;if(typeof _0x4b3e81==_0x246ae2(0x234)){!_0x3bc5ab?_0x4b3e81=_0x4b3e81[_0x246ae2(0x1e7)](_0x49e3fa,''):(_0x4b3e81=_0x4b3e81[_0x246ae2(0x1e7)](/#BLU#/g,_0x246ae2(0x100)),_0x4b3e81=_0x4b3e81[_0x246ae2(0x1e7)](/#RED#/g,_0x246ae2(0x235)),_0x4b3e81=_0x4b3e81[_0x246ae2(0x1e7)](/#YEL#/g,'\x1b[33m'),_0x4b3e81=_0x4b3e81[_0x246ae2(0x1e7)](/#MAG#/g,_0x246ae2(0x122)),_0x4b3e81=_0x4b3e81['replace'](/#CYA#/g,_0x246ae2(0xd2)),_0x4b3e81=_0x4b3e81[_0x246ae2(0x1e7)](/#RES#/g,'\x1b[0m'));;}return _0x4b3e81;},logger={'screen':_0x284e6d=>{console['log'](parseColor(_0x284e6d,!![]));},'simple':_0x487de6=>{const _0x4fcf3b=_0x49797c;console[_0x4fcf3b(0x134)](parseColor(_0x487de6,!![])),loggerfile[_0x4fcf3b(0x2bb)](util[_0x4fcf3b(0x11e)](parseColor(_0x487de6,![]))+'\x0a');},'full':async _0x52cb6a=>{const _0x54c5f2=_0x49797c,_0x1d525f=getTimeStamp()+_0x54c5f2(0x126)+_0x52cb6a;console[_0x54c5f2(0x134)](parseColor(_0x1d525f,!![])),loggerfile[_0x54c5f2(0x2bb)](util[_0x54c5f2(0x11e)](parseColor(_0x1d525f,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x54c5f2(0x2a3))await sendTelegram(settings['telegramChatId'],_0x54c5f2(0x2b3)+parseColor(_0x52cb6a,![]));},'debug':async(_0x2d5b69,_0x38c071='')=>{const _0x453f22=_0x49797c,_0x43b73c=getTimeStamp()+_0x453f22(0x163)+_0x2d5b69;if(debugging)console['log'](parseColor(_0x43b73c,!![]));loggerfile['write'](util[_0x453f22(0x11e)](parseColor(_0x43b73c,![]))+'\x0a');if(_0x38c071){if(debugging)console[_0x453f22(0x134)](_0x38c071);loggerfile[_0x453f22(0x2bb)](util[_0x453f22(0x11e)](_0x38c071)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0xfbaa3b){const _0x18bdf7=_0x49797c;_0xfbaa3b[_0x18bdf7(0x22b)]()[_0x18bdf7(0x11f)](_0x18bdf7(0x14a))?(logger[_0x18bdf7(0x2be)](_0x18bdf7(0x2da)+_0xfbaa3b[_0x18bdf7(0x1ac)]+'#RES#'),process['send']({'terminate':!![]},_0x52a50c=>{})):logger[_0x18bdf7(0x2be)](_0xfbaa3b);}),process['on'](_0x49797c(0x27c),()=>{const _0x4170ff=_0x49797c;stopAllBots(),process[_0x4170ff(0x27c)](0x0);}),process['on'](_0x49797c(0x195),()=>{const _0x5088ad=_0x49797c;stopAllBots(),process[_0x5088ad(0x27c)](0x0);}),process['on'](_0x49797c(0x16a),()=>{const _0x579584=_0x49797c;stopAllBots(),process[_0x579584(0x27c)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x49797c(0x179)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x49797c(0x2c7)),app=express(),http=require(_0x49797c(0x23c))[_0x49797c(0x135)](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get'](_0x49797c(0x24e),async(_0x2f1c8c,_0x510e31)=>{const _0x1c8cde=_0x49797c,_0x2db5b3=_0x2f1c8c[_0x1c8cde(0x205)][_0x1c8cde(0x1c9)],_0x4b5f04=getClientsWithBotID(_0x1c8cde(0x2ca)),_0x301ce7=_0x2f1c8c[_0x1c8cde(0x20c)][_0x1c8cde(0x2b8)],_0x170c54=timelyDecrypt(_0x301ce7,![]),_0x5329db=_0x4b5f04[_0x1c8cde(0x17a)](_0x4b39fb=>_0x4b39fb[_0x1c8cde(0x2b8)]==_0x170c54);if(_0x5329db){const _0x396ed4=normalizeIP(_0x2f1c8c[_0x1c8cde(0x160)]['remoteAddress'])[_0x1c8cde(0x291)],_0x63cd4c=_0x2f1c8c[_0x1c8cde(0x20c)][_0x1c8cde(0x2b4)];if(validateAccess(_0x63cd4c,_0x170c54,_0x396ed4)[_0x1c8cde(0x28a)])_0x2db5b3=='backup'&&await backupConfigFiles(),await zipFiles(_0x2db5b3),_0x510e31[_0x1c8cde(0x265)](zippath+(_0x2db5b3+'.zip'),_0x50d0b7=>{const _0x28e361=_0x1c8cde;_0x50d0b7&&(logger[_0x28e361(0x2cc)](_0x28e361(0x254)+_0x2db5b3),logger[_0x28e361(0x2be)](_0x50d0b7));});else logger[_0x1c8cde(0x2cc)](_0x1c8cde(0xcc)+_0x2db5b3+_0x1c8cde(0xf9));}else logger[_0x1c8cde(0x2cc)](_0x1c8cde(0xcc)+_0x2db5b3+_0x1c8cde(0x252));}),app[_0x49797c(0x22a)](_0x49797c(0x1b6),async(_0x197699,_0x2e2a37)=>{const _0x8bed1c=_0x49797c,_0x10a450=getClientsWithBotID(_0x8bed1c(0x2ca)),_0x22eb57=_0x197699[_0x8bed1c(0x20c)][_0x8bed1c(0x2b8)],_0x599c4f=timelyDecrypt(_0x22eb57,![]),_0x4feb71=_0x10a450[_0x8bed1c(0x17a)](_0x335b4d=>_0x335b4d[_0x8bed1c(0x2b8)]==_0x599c4f);logger[_0x8bed1c(0xfa)](_0x8bed1c(0x13e));if(_0x4feb71){const _0x20a7d7=normalizeIP(_0x197699[_0x8bed1c(0x160)][_0x8bed1c(0x20f)])[_0x8bed1c(0x291)],_0x413267=_0x197699['headers'][_0x8bed1c(0x2b4)];if(validateAccess(_0x413267,_0x599c4f,_0x20a7d7)[_0x8bed1c(0x28a)]){if(_0x197699[_0x8bed1c(0x26a)]){const _0x332e89=_0x197699[_0x8bed1c(0x26a)][_0x8bed1c(0x1fc)];await _0x332e89['mv'](temppath+_0x332e89[_0x8bed1c(0x238)]),_0x2e2a37[_0x8bed1c(0x15b)]({'status':!![],'message':_0x8bed1c(0x297)});const _0x53171f=getBotsWithMode();_0x53171f['length']>0x0?confirmRestore(temppath,_0x332e89[_0x8bed1c(0x238)]):unzipFile(temppath,_0x332e89[_0x8bed1c(0x238)]);}}else logger['full'](_0x8bed1c(0x176));}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x49797c(0x215)](express[_0x49797c(0x21e)](path[_0x49797c(0x2e7)](__dirname,bbpath2,_0x49797c(0x151)))),app[_0x49797c(0x215)](express[_0x49797c(0x21e)](path['join'](__dirname,bbpath2,_0x49797c(0x2de)))),app['get']('/',function(_0x644056,_0x117d26){const _0x56a02f=_0x49797c;_0x117d26[_0x56a02f(0x1ae)](path[_0x56a02f(0x2e7)](__dirname,bbpath2,_0x56a02f(0x151),'index.html'));}),app[_0x49797c(0x246)](_0x49797c(0x178),function(_0x1ff3d2,_0x375c90){const _0x4ef40d=_0x49797c;_0x375c90[_0x4ef40d(0x1ae)](path[_0x4ef40d(0x2e7)](__dirname,bbpath2,_0x4ef40d(0x2de),'index.html'));}),app[_0x49797c(0x246)](_0x49797c(0x1e3),(_0x12b6fe,_0x492ad6)=>{const _0x84a8f3=_0x49797c;_0x492ad6[_0x84a8f3(0x1ae)](path['join'](__dirname,bbpath2,_0x84a8f3(0x2de),_0x84a8f3(0x236)));}),app[_0x49797c(0x246)]('/:bot/performance',(_0x3052b2,_0x4d3d22)=>{const _0x15d8a8=_0x49797c;_0x4d3d22[_0x15d8a8(0x1ae)](path[_0x15d8a8(0x2e7)](__dirname,bbpath2,_0x15d8a8(0x2de),'index.html'));}),app[_0x49797c(0x246)](_0x49797c(0x1ec),(_0x19414a,_0x5c98e4)=>{const _0x17794b=_0x49797c;_0x5c98e4['sendFile'](path[_0x17794b(0x2e7)](__dirname,bbpath2,_0x17794b(0x2de),_0x17794b(0x236)));}),app[_0x49797c(0x246)](_0x49797c(0xcf),(_0x556634,_0x35655f)=>{const _0x46a03a=_0x49797c;_0x35655f[_0x46a03a(0x1ae)](path[_0x46a03a(0x2e7)](__dirname,bbpath2,_0x46a03a(0x2de),_0x46a03a(0x236)));}),app[_0x49797c(0x246)](_0x49797c(0x22f),(_0x57266d,_0x53bbb9)=>{const _0x44ec69=_0x49797c;_0x53bbb9['sendFile'](path['join'](__dirname,bbpath2,_0x44ec69(0x2de),_0x44ec69(0x236)));}),app[_0x49797c(0x246)](_0x49797c(0x21c),(_0x565813,_0x5809e3)=>{const _0x660769=_0x49797c;_0x5809e3[_0x660769(0x1ae)](path['join'](__dirname,bbpath2,'build',_0x660769(0x236)));});if(HOST)http['listen'](PORT,HOST);else http[_0x49797c(0x1f8)](PORT);const io=require(_0x49797c(0x272))(http,{});openBrowser&&(async()=>{const _0x4c548b=_0x49797c,{default:_0x1e791f}=await import(_0x4c548b(0xe6));await _0x1e791f(_0x4c548b(0x1e6)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5eeedf=_0x49797c;let _0x5c48ab='[ip-address]';const _0x12e4e9=networkInterfaces(),_0xf91f10={};for(const _0x161ad3 of Object[_0x5eeedf(0x113)](_0x12e4e9)){for(const _0x1960f9 of _0x12e4e9[_0x161ad3]){if((_0x1960f9[_0x5eeedf(0x19f)]==_0x5eeedf(0xe8)||_0x1960f9[_0x5eeedf(0x19f)]==0x4)&&!_0x1960f9[_0x5eeedf(0x19a)]){const _0x426516=ipaddr['parse'](_0x1960f9[_0x5eeedf(0x200)])[_0x5eeedf(0x2e2)]();_0x426516!=_0x5eeedf(0x29b)&&(!_0xf91f10[_0x161ad3]&&(_0xf91f10[_0x161ad3]=[]),_0xf91f10[_0x161ad3][_0x5eeedf(0x2ba)](_0x1960f9[_0x5eeedf(0x200)]),_0x5c48ab=_0x1960f9['address']);}}}return{'serverip':_0x5c48ab,'netinterfaces':_0xf91f10};}async function startServer(){const _0x1ec607=_0x49797c,{serverip:_0x491f77,netinterfaces:_0x502548}=getServerIP();logger[_0x1ec607(0x2be)](''),logger['simple'](_0x1ec607(0x119)),await logger[_0x1ec607(0x2cc)](_0x1ec607(0x165)+serverversion+_0x1ec607(0x12f)+(environment==_0x1ec607(0x1f6)?_0x1ec607(0x23f):'')+'\x0a'+(_0x1ec607(0x264)+PORT+_0x1ec607(0x1b3))+('=>\x20Go\x20to\x20#CYA#http://'+_0x491f77+':'+PORT+_0x1ec607(0x2ad))),logger[_0x1ec607(0x2be)](_0x1ec607(0x119));if(config['length']!=0x0)for(const _0x2a7238 of config){const _0x3517df=_0x2a7238[_0x1ec607(0x25d)]=='auto'?'a':'m';if(_0x2a7238[_0x1ec607(0x1fb)]=='enabled'||_0x2a7238[_0x1ec607(0x1fb)]==_0x1ec607(0xeb))await logger[_0x1ec607(0x2cc)]('Starting\x20('+_0x3517df+_0x1ec607(0x24a)+_0x2a7238[_0x1ec607(0x225)]+_0x1ec607(0x161)+_0x2a7238[_0x1ec607(0x218)]),startBot([_0x2a7238[_0x1ec607(0x225)],userID],{'cwd':bbpath},function(_0x584cd7){const _0x9ec2a=_0x1ec607;if(_0x584cd7)logger[_0x9ec2a(0x2cc)](_0x584cd7);});else(_0x2a7238[_0x1ec607(0x1fb)]=='disabled'||_0x2a7238[_0x1ec607(0x1fb)]==_0x1ec607(0x256))&&await logger[_0x1ec607(0x2cc)](_0x1ec607(0x180)+_0x3517df+_0x1ec607(0xd3)+_0x2a7238[_0x1ec607(0x225)]+'\x20|\x20'+_0x2a7238[_0x1ec607(0x218)]);}else!newBot&&logger[_0x1ec607(0x2be)](_0x1ec607(0x2cb));if(newBot)addBot();logger[_0x1ec607(0x2be)](_0x1ec607(0x119)),logger[_0x1ec607(0x2be)](''),await logger[_0x1ec607(0xfa)](_0x1ec607(0x1de)+nodeversion),await logger[_0x1ec607(0xfa)]('Network\x20Interfaces:',_0x502548);}function startSocket(){const _0x254299=_0x49797c;io['on'](_0x254299(0x1d5),_0x19fbdc=>{const _0x46f180=_0x254299;let _0x9e4cc0,_0x3d6123,_0xdde234,_0x2cf6fc,_0x3e498f;const _0xee392e=_0x19fbdc['handshake'][_0x46f180(0x20c)][_0x46f180(0x10d)];_0x3d6123=_0xee392e[_0x46f180(0x243)](/bot[0-9]{3}/);if(_0x3d6123)_0xdde234=_0x3d6123[0x0][_0x46f180(0x243)](/[0-9]{3}/);if(_0xdde234)_0x9e4cc0=_0xdde234[0x0];else _0x9e4cc0='botmanager';const _0x3c7a56=_0x19fbdc[_0x46f180(0x185)][_0x46f180(0x2d9)][_0x46f180(0x27a)];if(!_0x3c7a56)_0x19fbdc['emit'](_0x46f180(0x1fb),{'publicKey':secure[_0x46f180(0x197)]});else{_0x2cf6fc=timelyDecrypt(_0x3c7a56,![]);if(!_0x2cf6fc)_0x19fbdc['emit'](_0x46f180(0x1fb),{'publicKey':secure[_0x46f180(0x197)]});else{_0x3e498f=normalizeIP(_0x19fbdc[_0x46f180(0x137)][_0x46f180(0x20f)])[_0x46f180(0x291)];if(!devices[_0x2cf6fc])devices[_0x2cf6fc]={'uuid':_0x2cf6fc,'access':{'token':null}};devices[_0x2cf6fc]['ip']=_0x3e498f;const _0x328ede=addClient(_0x19fbdc['id'],_0x2cf6fc,_0x9e4cc0);setAccess(_0x328ede),emitMessages(),_0x19fbdc['on']('login',_0x10e60c=>{const _0x49fe16=_0x46f180,_0x341f34=timelyDecrypt(_0x10e60c[_0x49fe16(0x228)],!![],_0x49fe16(0x245));if(_0x341f34){_0x10e60c={'username':_0x10e60c[_0x49fe16(0x11c)],'password':_0x341f34},devices[_0x2cf6fc][_0x49fe16(0x17b)]=validateCredentials(_0x10e60c,_0x2cf6fc);if(devices[_0x2cf6fc][_0x49fe16(0x17b)]['allow']==![]&&devices[_0x2cf6fc][_0x49fe16(0x17b)][_0x49fe16(0x1be)]==_0x49fe16(0x115))_0x19fbdc['emit'](_0x49fe16(0x1fb),{'access':devices[_0x2cf6fc][_0x49fe16(0x17b)]}),loginAccess2FA(_0x2cf6fc,_0x3e498f);else{if(devices[_0x2cf6fc][_0x49fe16(0x17b)]['allow']==![]&&devices[_0x2cf6fc][_0x49fe16(0x17b)]['reason']==_0x49fe16(0x174))_0x19fbdc[_0x49fe16(0x1a6)](_0x49fe16(0x1fb),{'access':devices[_0x2cf6fc][_0x49fe16(0x17b)]});else devices[_0x2cf6fc]['access']['allow']&&devices[_0x2cf6fc]['access'][_0x49fe16(0x1be)]==_0x49fe16(0x24f)&&(getClientsWithUuid(_0x2cf6fc)[_0x49fe16(0x114)](_0x36eaa5=>{setAccess(_0x36eaa5);}),logger[_0x49fe16(0xfa)](_0x49fe16(0x1ff)+_0x2cf6fc[_0x49fe16(0x2ae)](-0x8)),setTokenRefresh(_0x2cf6fc),setSessionTimeout(_0x49fe16(0x27b),_0x2cf6fc));}}else logger[_0x49fe16(0x2cc)](_0x49fe16(0x23d));}),_0x19fbdc['on']('reset-password',()=>{resetPassword();}),_0x19fbdc['on'](_0x46f180(0x2e5),_0x2e8700=>{removeClient(_0x19fbdc['id']);}),_0x9e4cc0==_0x46f180(0x2ca)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xd33e89){const _0x4b0083=_0x49797c;if(_0xd33e89!=_0x4b0083(0x2ca)&&config['apiKey']!=''){if(pid[_0xd33e89])pid[_0xd33e89][_0x4b0083(0x15b)]({'function':_0x4b0083(0x29e),'args':null});}_0xd33e89!='botmanager'&&broadcastToBots('bots',JSON['stringify'](config));}function reloadBotManager(){const _0x92dfb4=_0x49797c;getClientsWithBotID(_0x92dfb4(0x2ca))[_0x92dfb4(0x114)](_0x42c70d=>{const _0x420da6=_0x92dfb4;getSocket(_0x42c70d['id'])[_0x420da6(0x1a6)](_0x420da6(0x1fb),{'access':{'allow':![],'reason':_0x420da6(0x1f9),'token':null}});});}function getSocket(_0x3879d5){const _0x4c4c22=_0x49797c,_0x1819b0=io[_0x4c4c22(0xd1)][_0x4c4c22(0x246)]('/');return _0x1819b0[_0x4c4c22(0x15c)]['get'](_0x3879d5);}function setAccess(_0x39b27d){const _0x255524=_0x49797c,_0x33613d=getSocket(_0x39b27d['id']),_0x334174=_0x39b27d[_0x255524(0x2b8)],_0x15107c=_0x39b27d[_0x255524(0x182)];devices[_0x334174][_0x255524(0x17b)]=validateAccess(devices[_0x334174][_0x255524(0x17b)]['token'],_0x334174),logger[_0x255524(0xfa)](_0x255524(0x284)+devices[_0x334174][_0x255524(0x17b)][_0x255524(0x1be)]+_0x255524(0x15a)+_0x39b27d['id'][_0x255524(0x2ae)](-0x8)+_0x255524(0x10c)+_0x334174[_0x255524(0x2ae)](-0x8)),_0x33613d[_0x255524(0x2e7)](_0x334174);if(devices[_0x334174]['access'][_0x255524(0x28a)]){_0x33613d[_0x255524(0x2e7)](_0x15107c);if(_0x15107c=='botmanager')initializeSocketBotManager(_0x33613d);else initializeSocketBot(_0x33613d);initClient(_0x15107c);}devices[_0x334174]['access'][_0x255524(0x1fa)]&&devices[_0x334174][_0x255524(0x17b)][_0x255524(0x1be)]==_0x255524(0x277)&&setSessionTimeout('2FA',_0x334174),devices[_0x334174]['access']['token']&&devices[_0x334174]['access'][_0x255524(0x1be)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0x334174),_0x33613d[_0x255524(0x1a6)]('status',{'status':_0x39b27d[_0x255524(0x131)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x334174][_0x255524(0x17b)],'externalip':devices[_0x334174]['ip'],'publicKey':secure[_0x255524(0x197)],'userid':settings[_0x255524(0x11d)],'validInstallation':validInstallation}),devices[_0x334174][_0x255524(0x17b)][_0x255524(0x28a)]==![]&&devices[_0x334174]['access'][_0x255524(0x1be)]=='2FA\x20required'&&temporaryAccess2FA(_0x334174,devices[_0x334174]['ip']);}function setSessionTimeout(_0x3db19f,_0x5b0742){const _0x1896f0=_0x49797c;let _0x4dca0f;if(_0x3db19f=='login')_0x4dca0f=loginExpiry*0x3c*0x3e8;else _0x4dca0f=devices[_0x5b0742]['telegramIpApproval'][_0x1896f0(0x104)]*0x3c*0x3e8-(new Date()[_0x1896f0(0x2bc)]()-devices[_0x5b0742]['telegramIpApproval'][_0x1896f0(0x198)]);if(devices[_0x5b0742][_0x1896f0(0x117)])clearTimeout(devices[_0x5b0742][_0x1896f0(0x117)]);devices[_0x5b0742][_0x1896f0(0x117)]=setTimeout(()=>{const _0x5a4eda=_0x1896f0;if(devices[_0x5b0742][_0x5a4eda(0x296)])clearTimeout(devices[_0x5b0742][_0x5a4eda(0x296)]);removeSocketListeners(_0x5b0742),addBlacklist(_0x5b0742),devices[_0x5b0742][_0x5a4eda(0xd6)]=null,devices[_0x5b0742][_0x5a4eda(0x158)]=null,devices[_0x5b0742][_0x5a4eda(0x17b)][_0x5a4eda(0x1fa)]=null,logger['debug'](_0x5a4eda(0x204)+_0x5b0742['slice'](-0x8)),devices[_0x5b0742][_0x5a4eda(0x17b)]=validateAccess(devices[_0x5b0742]['access'][_0x5a4eda(0x1fa)],_0x5b0742),!(devices[_0x5b0742][_0x5a4eda(0x17b)][_0x5a4eda(0x28a)]&&devices[_0x5b0742][_0x5a4eda(0x17b)][_0x5a4eda(0x1be)]=='login\x20not\x20required')&&(_0x3db19f=='login'?io['to'](_0x5b0742)['emit']('status',{'access':{'allow':![],'reason':_0x5a4eda(0x2c8),'token':null}}):io['to'](_0x5b0742)[_0x5a4eda(0x1a6)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x5b0742][_0x5a4eda(0x17b)]['token']=null;},_0x4dca0f);}function setTokenRefresh(_0x6cc786){const _0x204382=_0x49797c;if(devices[_0x6cc786]['pidRefreshToken'])clearTimeout(devices[_0x6cc786][_0x204382(0x296)]);devices[_0x6cc786][_0x204382(0x296)]=setTimeout(()=>{const _0x57ef99=_0x204382;getClientsWithUuid(_0x6cc786)[_0x57ef99(0xee)]!=0x0?(devices[_0x6cc786][_0x57ef99(0x17b)]=refreshToken(_0x6cc786),io['to'](_0x6cc786)['emit']('status',{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x6cc786][_0x57ef99(0x17b)],'externalip':devices[_0x6cc786]['ip'],'publicKey':secure[_0x57ef99(0x197)],'validInstallation':validInstallation}),setTokenRefresh(_0x6cc786)):clearTimeout(devices[_0x6cc786][_0x57ef99(0x296)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3eb3b2){const _0x523ca9=_0x49797c,_0x2b5f6d=getClient(_0x3eb3b2['id'])['uuid'];_0x3eb3b2[_0x523ca9(0x1a6)](_0x523ca9(0x27f),config),_0x3eb3b2[_0x523ca9(0x1a6)](_0x523ca9(0x156),cleanSettings()),_0x3eb3b2['on'](_0x523ca9(0x2ce),_0x53b995=>{const _0x5bfd77=_0x523ca9;if(validateAccess(_0x53b995,_0x2b5f6d)['allow'])addBot();else logger['full'](_0x5bfd77(0x132));}),_0x3eb3b2['on']('update-bot',(_0xff1775,_0x28487f)=>{const _0x397497=_0x523ca9;if(validateAccess(_0x28487f,_0x2b5f6d)[_0x397497(0x28a)])toggleBot(_0xff1775[_0x397497(0x225)],_0xff1775[_0x397497(0x1fb)],_0xff1775[_0x397497(0x2d0)]);else logger[_0x397497(0x2cc)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3eb3b2['on'](_0x523ca9(0x1b0),(_0x4d8a8b,_0x5add31)=>{const _0x3efe80=_0x523ca9;if(validateAccess(_0x5add31,_0x2b5f6d)[_0x3efe80(0x28a)])toggleBotMode(_0x4d8a8b);else logger[_0x3efe80(0x2cc)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3eb3b2['on'](_0x523ca9(0x136),(_0x4ed4d8,_0x2c82dc)=>{const _0x517c68=_0x523ca9;if(validateAccess(_0x2c82dc,_0x2b5f6d)[_0x517c68(0x28a)])deleteBot(_0x4ed4d8);else logger[_0x517c68(0x2cc)](_0x517c68(0xf3));}),_0x3eb3b2['on'](_0x523ca9(0x171),(_0x74147d,_0x1ea1e3)=>{const _0x5d57cb=_0x523ca9;if(validateAccess(_0x1ea1e3,_0x2b5f6d)[_0x5d57cb(0x28a)])storeSettings(_0x74147d,!![]);else logger[_0x5d57cb(0x2cc)](_0x5d57cb(0xda));}),_0x3eb3b2['on'](_0x523ca9(0x219),_0x258a5d=>{const _0x1d5951=_0x523ca9;if(validateAccess(_0x258a5d,_0x2b5f6d)['allow'])updateBB(_0x1d5951(0x1ba));else logger[_0x1d5951(0x2cc)](_0x1d5951(0x193));}),_0x3eb3b2['on'](_0x523ca9(0x11a),_0x52318b=>{const _0x578814=_0x523ca9;if(validateAccess(_0x52318b,_0x2b5f6d)[_0x578814(0x28a)])updateBB(_0x578814(0x29c));else logger[_0x578814(0x2cc)](_0x578814(0x1f0));}),_0x3eb3b2['on'](_0x523ca9(0x206),_0x5a8bac=>{const _0x166da9=_0x523ca9;if(validateAccess(_0x5a8bac,_0x2b5f6d)[_0x166da9(0x28a)]){const _0x904494=getClient(_0x3eb3b2['id']);if(_0x904494)getBackupFiles(_0x904494[_0x166da9(0x2b8)]);else logger[_0x166da9(0x2cc)](_0x166da9(0x1dd));}else logger[_0x166da9(0x2cc)](_0x166da9(0x2b7));}),_0x3eb3b2['on']('restore-backup-file',(_0x14791a,_0x2c93b2)=>{const _0x5d7d61=_0x523ca9;if(validateAccess(_0x2c93b2,_0x2b5f6d)[_0x5d7d61(0x28a)])restoreBackupFile(_0x14791a);else logger[_0x5d7d61(0x2cc)](_0x5d7d61(0xe9));}),_0x3eb3b2['on']('get-messages',_0x3725d1=>{const _0x55f98b=_0x523ca9;if(validateAccess(_0x3725d1,_0x2b5f6d)[_0x55f98b(0x28a)])getMessages();else logger[_0x55f98b(0x2cc)](_0x55f98b(0x1ad));}),_0x3eb3b2['on'](_0x523ca9(0x16c),(_0x3939a2,_0x3a79f2)=>{const _0xd895af=_0x523ca9;if(validateAccess(_0x3a79f2,_0x2b5f6d)[_0xd895af(0x28a)])confirmMessage(_0x3939a2);else logger[_0xd895af(0x2cc)](_0xd895af(0x1f7));}),_0x3eb3b2['on'](_0x523ca9(0x159),_0x1472ab=>{const _0x56640a=_0x523ca9;if(validateAccess(_0x1472ab,_0x2b5f6d)[_0x56640a(0x28a)]){if(devices[_0x2b5f6d]['pidRefreshToken'])clearTimeout(devices[_0x2b5f6d][_0x56640a(0x296)]);if(devices[_0x2b5f6d][_0x56640a(0x117)])clearTimeout(devices[_0x2b5f6d][_0x56640a(0x117)]);removeSocketListeners(getClient(_0x3eb3b2['id'])[_0x56640a(0x2b8)]),addBlacklist(_0x2b5f6d),devices[_0x2b5f6d][_0x56640a(0xd6)]=null,devices[_0x2b5f6d][_0x56640a(0x158)]=null,devices[_0x2b5f6d][_0x56640a(0x17b)][_0x56640a(0x1fa)]=null,logger[_0x56640a(0xfa)]('Logged\x20out\x20user\x20...'+_0x2b5f6d['slice'](-0x8)),io['to'](getClient(_0x3eb3b2['id'])['uuid'])[_0x56640a(0x1a6)](_0x56640a(0x1fb),{'access':{'allow':![],'reason':_0x56640a(0x2ec),'token':null}});}else logger[_0x56640a(0x2cc)](_0x56640a(0x124));});}function initializeSocketBot(_0x26d937){const _0x443621=_0x49797c,_0x1a65ec=getClient(_0x26d937['id'])[_0x443621(0x182)],_0x204c76=getClient(_0x26d937['id'])['uuid'];_0x26d937['on'](_0x443621(0x17d),(_0x4f5329,_0x472a0b)=>{const _0x46f774=_0x443621;if(validateAccess(_0x472a0b,_0x204c76)[_0x46f774(0x28a)]){if(pid[_0x1a65ec])pid[_0x1a65ec]['send']({'function':_0x46f774(0x102),'args':_0x4f5329});}else logger['full'](_0x46f774(0x153));}),_0x26d937['on'](_0x443621(0x2e1),(_0x2ba768,_0x306709)=>{const _0x3d261f=_0x443621;if(validateAccess(_0x306709,_0x204c76)[_0x3d261f(0x28a)]){if(pid[_0x1a65ec])pid[_0x1a65ec]['send']({'function':'deleteHistoryAlerts','args':_0x2ba768});}else logger['full'](_0x3d261f(0x103));}),_0x26d937['on'](_0x443621(0x270),(_0x55ba3e,_0x4d71f5)=>{const _0x50cc32=_0x443621;if(validateAccess(_0x4d71f5,_0x204c76)[_0x50cc32(0x28a)]){if(pid[_0x1a65ec])pid[_0x1a65ec]['send']({'function':_0x50cc32(0x128),'args':_0x55ba3e});}else logger[_0x50cc32(0x2cc)](_0x50cc32(0xea));}),_0x26d937['on'](_0x443621(0xfb),(_0x401cd3,_0x1d71cd)=>{const _0x5064fc=_0x443621;if(validateAccess(_0x1d71cd,_0x204c76)['allow']){if(pid[_0x1a65ec])pid[_0x1a65ec]['send']({'function':_0x5064fc(0xcb),'args':_0x401cd3});}else logger['full'](_0x5064fc(0x269));}),_0x26d937['on'](_0x443621(0xce),(_0x30bcda,_0x4efddc)=>{const _0x12177d=_0x443621;if(validateAccess(_0x4efddc,_0x204c76)[_0x12177d(0x28a)]){if(pid[_0x1a65ec])pid[_0x1a65ec]['send']({'function':'storeHeadless','args':_0x30bcda});}else logger[_0x12177d(0x2cc)](_0x12177d(0x226));}),_0x26d937['on']('store-fiat',(_0x63e028,_0x273773)=>{const _0xcd62be=_0x443621;if(validateAccess(_0x273773,_0x204c76)['allow']){if(pid[_0x1a65ec])pid[_0x1a65ec][_0xcd62be(0x15b)]({'function':_0xcd62be(0x1a9),'args':_0x63e028});}else logger['full'](_0xcd62be(0x1e8));}),_0x26d937['on'](_0x443621(0x2d7),_0x7de120=>{const _0x5b8d7d=_0x443621;if(validateAccess(_0x7de120,_0x204c76)[_0x5b8d7d(0x28a)]){if(pid[_0x1a65ec])pid[_0x1a65ec][_0x5b8d7d(0x15b)]({'function':'resetHistory','args':null});}else logger[_0x5b8d7d(0x2cc)](_0x5b8d7d(0x28c));}),_0x26d937['on'](_0x443621(0x19c),_0xd6f07d=>{const _0x23e084=_0x443621;if(validateAccess(_0xd6f07d,_0x204c76)['allow']){if(pid[_0x1a65ec])pid[_0x1a65ec][_0x23e084(0x15b)]({'function':_0x23e084(0x2c0),'args':null});}else logger['full'](_0x23e084(0x1da));}),_0x26d937['on'](_0x443621(0x2db),(_0x17a203,_0x3c499a)=>{const _0x218b26=_0x443621;if(validateAccess(_0x3c499a,_0x204c76)[_0x218b26(0x28a)]){if(pid[_0x1a65ec])pid[_0x1a65ec]['send']({'function':_0x218b26(0x25b),'args':_0x17a203});}else logger[_0x218b26(0x2cc)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x26d937['on'](_0x443621(0x213),_0x4b8a70=>{const _0x14062b=_0x443621;if(validateAccess(_0x4b8a70,_0x204c76)['allow']){if(pid[_0x1a65ec])pid[_0x1a65ec][_0x14062b(0x15b)]({'function':_0x14062b(0x25e),'args':null});}else logger[_0x14062b(0x2cc)](_0x14062b(0x27d));}),_0x26d937['on'](_0x443621(0x112),_0x27994b=>{const _0x499d62=_0x443621;if(validateAccess(_0x27994b,_0x204c76)[_0x499d62(0x28a)]){if(pid[_0x1a65ec])pid[_0x1a65ec][_0x499d62(0x15b)]({'function':_0x499d62(0x1d1),'args':null});}else logger['full'](_0x499d62(0x1df));}),_0x26d937['on'](_0x443621(0x219),_0x2dc9f5=>{const _0x48ab58=_0x443621;if(validateAccess(_0x2dc9f5,_0x204c76)[_0x48ab58(0x28a)])updateBB(_0x48ab58(0x1ba));else logger[_0x48ab58(0x2cc)](_0x48ab58(0x193));}),_0x26d937['on'](_0x443621(0x2c4),_0x5a546b=>{const _0x50d41a=_0x443621;if(validateAccess(_0x5a546b,_0x204c76)[_0x50d41a(0x28a)])getMessages();else logger['full'](_0x50d41a(0x1ad));}),_0x26d937['on'](_0x443621(0x16c),(_0x36608c,_0x209241)=>{const _0x15d281=_0x443621;if(validateAccess(_0x209241,_0x204c76)['allow'])confirmMessage(_0x36608c);else logger[_0x15d281(0x2cc)](_0x15d281(0x1f7));}),_0x26d937['on'](_0x443621(0x159),_0x193032=>{const _0x4fd9c5=_0x443621;if(validateAccess(_0x193032,_0x204c76)[_0x4fd9c5(0x28a)]){if(devices[_0x204c76][_0x4fd9c5(0x296)])clearTimeout(devices[_0x204c76][_0x4fd9c5(0x296)]);if(devices[_0x204c76][_0x4fd9c5(0x117)])clearTimeout(devices[_0x204c76][_0x4fd9c5(0x117)]);removeSocketListeners(getClient(_0x26d937['id'])[_0x4fd9c5(0x2b8)]),addBlacklist(_0x204c76),devices[_0x204c76][_0x4fd9c5(0xd6)]=null,devices[_0x204c76][_0x4fd9c5(0x158)]=null,devices[_0x204c76][_0x4fd9c5(0x17b)][_0x4fd9c5(0x1fa)]=null,logger[_0x4fd9c5(0xfa)](_0x4fd9c5(0x21d)+_0x204c76['slice'](-0x8)),io['to'](getClient(_0x26d937['id'])['uuid'])['emit'](_0x4fd9c5(0x1fb),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x4fd9c5(0x2cc)](_0x4fd9c5(0x124));});}function removeSocketListeners(_0x3df541){const _0x51139c=_0x49797c;getClientsWithUuid(_0x3df541)[_0x51139c(0x114)](_0x1449d1=>{getSocket(_0x1449d1['id'])['removeAllListeners']();});}function cleanSettings(){const _0x17df9e=_0x49797c;let _0x4c2be3=settings;return settings[_0x17df9e(0x142)]&&settings[_0x17df9e(0x142)]!=''&&(_0x4c2be3={..._0x4c2be3,'telegramToken':_0x17df9e(0x262)}),settings[_0x17df9e(0x1d9)]&&settings[_0x17df9e(0x1d9)]!=''&&(_0x4c2be3={..._0x4c2be3,'bbPassword':_0x17df9e(0x262)}),settings[_0x17df9e(0x28e)]&&settings[_0x17df9e(0x28e)]!=''&&(_0x4c2be3={..._0x4c2be3,'marketcapApi':_0x17df9e(0x262)}),(settings['bbPassword']&&settings['bbPassword']==_0x17df9e(0x244)||settings[_0x17df9e(0x142)]&&settings[_0x17df9e(0x142)]==_0x17df9e(0x244)||settings[_0x17df9e(0x28e)]&&settings['marketcapApi']==_0x17df9e(0x244))&&(_0x4c2be3={..._0x4c2be3,'restored':{'password':settings['bbPassword']==_0x17df9e(0x244),'telegram':settings[_0x17df9e(0x142)]==_0x17df9e(0x244),'marketcap':settings[_0x17df9e(0x28e)]==_0x17df9e(0x244)}}),_0x4c2be3;}async function updateBB(_0x1138f1){const _0xf0534f=_0x49797c;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x441171=>{const _0x18bbb6=_0x3612;restartBot(_0x441171[_0x18bbb6(0x225)]);});if(_0x1138f1=='update')process[_0xf0534f(0x15b)]({'update':!![],'environment':environment},_0x33383e=>{});else _0x1138f1==_0xf0534f(0x29c)&&process['send']({'reinstall':!![],'environment':environment},_0x46f9a5=>{});}function startBot(_0x4422fe,_0x990a4b,_0xeb7b8c){const _0x13db1a=_0x49797c;if(debugging)_0x4422fe[_0x13db1a(0x2ba)]('-d');if(recreate)_0x4422fe[_0x13db1a(0x2ba)]('-r');let _0x5e9469=![];const _0x560b93=_0x4422fe[0x0];_0x990a4b={..._0x990a4b,'stdio':[_0x13db1a(0xf8),'inherit',_0x13db1a(0xf8),_0x13db1a(0x145)]},pid[_0x560b93]=childProcess['fork'](botfile,_0x4422fe,_0x990a4b),pid[_0x560b93]['on'](_0x13db1a(0x15e),_0x4a1700=>{const _0x476ceb=_0x13db1a;switch(Object[_0x476ceb(0x113)](_0x4a1700)[0x0]){case'botname':updateBotName(_0x560b93,_0x4a1700[_0x476ceb(0x218)]);break;case _0x476ceb(0x214):updateBotManager();break;case _0x476ceb(0x1fb):updateStatus(_0x560b93,_0x4a1700[_0x476ceb(0x1fb)]);break;case'live':updateLive(_0x560b93,_0x4a1700[_0x476ceb(0x2d0)]);break;case _0x476ceb(0x14d):updateLive(_0x560b93,_0x4a1700[_0x476ceb(0x14d)]),io['to'](_0x560b93)[_0x476ceb(0x1a6)](_0x476ceb(0x1fb),{'access':{'allow':![],'reason':_0x476ceb(0x1f9),'token':null}});break;case'stop':_0x4a1700['stop']=='restart'&&restartBot(_0x560b93);_0x4a1700[_0x476ceb(0x2e9)]=='kill'&&toggleBot(_0x560b93,_0x476ceb(0x232),_0x476ceb(0x207));break;case _0x476ceb(0x249):sendTelegramBot(_0x560b93,_0x4a1700[_0x476ceb(0x249)]);break;case _0x476ceb(0x155):sendTelegramMsg(_0x4a1700[_0x476ceb(0x155)]);break;case _0x476ceb(0x286):io['to'](_0x560b93)['emit'](_0x4a1700['function'],_0x4a1700[_0x476ceb(0x201)]);break;}}),pid[_0x560b93]['on'](_0x13db1a(0x16e),function(_0x1f6be5){if(_0x5e9469)return;_0x5e9469=!![],_0xeb7b8c(_0x1f6be5);}),pid[_0x560b93]['on']('exit',async function(_0xd0c53f){const _0x18f730=_0x13db1a;if(terminating)return;if(installingUpdate){io[_0x18f730(0x1f4)]();return;}if(_0x5e9469)return;_0x5e9469=!![],_0xeb7b8c(null);const _0x3b88bd=dbConfig[_0x18f730(0x246)]('bots')[_0x18f730(0x17a)]({'botID':_0x560b93})[_0x18f730(0x247)]();_0x3b88bd&&(_0x3b88bd['status']==_0x18f730(0x13c)||_0x3b88bd[_0x18f730(0x1fb)]==_0x18f730(0xeb))&&(await sleep(0x3e8),updateLive(_0x560b93,'stopped'),logger[_0x18f730(0x2cc)](_0x18f730(0x183)+botRef(_0x560b93)),startBot([_0x560b93,userID],{'cwd':bbpath},function(_0x308091){const _0x5a2b43=_0x18f730;if(_0x308091)logger[_0x5a2b43(0x2cc)](_0x308091);}));});}function stopBot(_0x54d5e6){const _0x542c7d=_0x49797c;getClientsWithBotID(_0x54d5e6)[_0x542c7d(0x114)](_0x3ec9a4=>{const _0x45a51e=_0x542c7d;getSocket(_0x3ec9a4['id'])[_0x45a51e(0x2e5)](!![]),removeClient(_0x3ec9a4['id']);}),pid[_0x54d5e6]&&(pid[_0x54d5e6][_0x542c7d(0x2b9)](),pid[_0x54d5e6]=null);}function stopAllBots(){const _0xe81e27=_0x49797c;terminating=!![];const _0x11ac42=getEnabledBots();_0x11ac42[_0xe81e27(0x114)](_0x39555f=>{stopBot(_0x39555f['botID']);});}function restartBot(_0x5196db){const _0x2e1de4=_0x49797c;if(pid[_0x5196db])pid[_0x5196db][_0x2e1de4(0x2b9)]();}function addBot(){const _0x306b41=_0x49797c;let _0x31b876;for(let _0x4f14b1=0x1;_0x4f14b1<0x3e9;_0x4f14b1++){_0x31b876=_0x4f14b1[_0x306b41(0x22b)]()['padStart'](0x3,'0');let _0x46c41=config[_0x306b41(0x17a)](_0x1dcd91=>_0x1dcd91[_0x306b41(0x225)]==_0x31b876);if(!_0x46c41)break;}if(_0x31b876==='1000'){logger[_0x306b41(0x2cc)](_0x306b41(0x1f1));return;}logger[_0x306b41(0x2cc)](_0x306b41(0x11b)+_0x31b876),dbConfig['get'](_0x306b41(0x27f))[_0x306b41(0x2ba)]({'botID':_0x31b876,'botname':_0x306b41(0xe2)+_0x31b876,'status':'new','live':''})['write'](),startBot([_0x31b876,userID],{'cwd':bbpath},function(_0xdd3d72){const _0x4d2151=_0x306b41;if(_0xdd3d72)logger[_0x4d2151(0x2cc)](_0xdd3d72);}),config=getConfiguration(),io['to']('botmanager')[_0x306b41(0x1a6)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x11cb55){const _0x4096b5=_0x49797c;getClientsWithBotID(_0x11cb55)[_0x4096b5(0x114)](_0x572e89=>{getSocket(_0x572e89['id'])['disconnect'](!![]),removeClient(_0x572e89['id']);}),dbConfig[_0x4096b5(0x246)](_0x4096b5(0x27f))['remove']({'botID':_0x11cb55})[_0x4096b5(0x2bb)](),logger[_0x4096b5(0x2cc)](_0x4096b5(0x1f3)+_0x11cb55),stopBot(_0x11cb55);try{if(fs[_0x4096b5(0x1d3)](path['join'](configpath,_0x4096b5(0x2e3)+_0x11cb55+'-config.json')))fs[_0x4096b5(0x22d)](path[_0x4096b5(0x2e7)](configpath,_0x4096b5(0x2e3)+_0x11cb55+_0x4096b5(0x1d2)));if(fs[_0x4096b5(0x1d3)](path[_0x4096b5(0x2e7)](configpath,_0x4096b5(0x2e3)+_0x11cb55+_0x4096b5(0x2d2))))fs['unlinkSync'](path[_0x4096b5(0x2e7)](configpath,_0x4096b5(0x2e3)+_0x11cb55+'-events.json'));if(fs['existsSync'](path[_0x4096b5(0x2e7)](configpath,_0x4096b5(0x2e3)+_0x11cb55+_0x4096b5(0x29a))))fs[_0x4096b5(0x22d)](path[_0x4096b5(0x2e7)](configpath,'bot-'+_0x11cb55+_0x4096b5(0x29a)));if(fs[_0x4096b5(0x1d3)](path['join'](configpath,'bot-'+_0x11cb55+_0x4096b5(0x167))))fs[_0x4096b5(0x22d)](path[_0x4096b5(0x2e7)](configpath,'bot-'+_0x11cb55+_0x4096b5(0x167)));}catch(_0x1511c1){if(_0x1511c1)logger[_0x4096b5(0x2cc)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x1511c1);}config=getConfiguration(),io['to'](_0x4096b5(0x2ca))[_0x4096b5(0x1a6)](_0x4096b5(0x27f),config),broadcastToBots(_0x4096b5(0x27f),JSON[_0x4096b5(0x1bc)](config));}function toggleBot(_0x5d612f,_0x44a46a,_0x252b56){const _0x19742c=_0x49797c;dbConfig['get'](_0x19742c(0x27f))[_0x19742c(0x17a)]({'botID':_0x5d612f})[_0x19742c(0x267)]({'status':_0x44a46a})['assign']({'live':_0x252b56})[_0x19742c(0x2bb)]();const _0x2598a5=botRef(_0x5d612f);if(_0x44a46a==_0x19742c(0x13c)||_0x44a46a=='new')logger[_0x19742c(0x2cc)](_0x19742c(0x2af)+_0x2598a5),startBot([_0x5d612f,userID],{'cwd':bbpath},function(_0xdcfa04){if(_0xdcfa04)logger['full'](_0xdcfa04);});else(_0x44a46a=='disabled'||_0x44a46a==_0x19742c(0x256))&&(logger['full'](_0x19742c(0x25a)+_0x2598a5),stopBot(_0x5d612f));config=getConfiguration(),io['to'](_0x19742c(0x2ca))[_0x19742c(0x1a6)](_0x19742c(0x27f),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleStatus(_0x4c86a5){const _0xbd52db=_0x49797c;let _0x44f0eb=dbConfig[_0xbd52db(0x246)](_0xbd52db(0x27f))[_0xbd52db(0x17a)]({'botID':_0x4c86a5})[_0xbd52db(0x247)](),_0x6e8d7;if(_0x44f0eb[_0xbd52db(0x1fb)]===_0xbd52db(0x13c))_0x6e8d7=_0xbd52db(0x232);else{if(_0x44f0eb['status']===_0xbd52db(0xeb))_0x6e8d7=_0xbd52db(0x256);else{if(_0x44f0eb[_0xbd52db(0x1fb)]==='new-disabled')_0x6e8d7=_0xbd52db(0xeb);else{if(_0x44f0eb['status']===_0xbd52db(0x232))_0x6e8d7=_0xbd52db(0x13c);}}}return _0x6e8d7;}function updateStatus(_0x7f5bbd,_0x5173ea){const _0x48b1b9=_0x49797c;dbConfig['get'](_0x48b1b9(0x27f))[_0x48b1b9(0x17a)]({'botID':_0x7f5bbd})[_0x48b1b9(0x267)]({'status':_0x5173ea})[_0x48b1b9(0x2bb)](),config=getConfiguration(),io['to'](_0x48b1b9(0x2ca))['emit']('bots',config),broadcastToBots(_0x48b1b9(0x27f),JSON[_0x48b1b9(0x1bc)](config));}function updateLive(_0x191d03,_0x70ff46){const _0x4f6a7e=_0x49797c;dbConfig[_0x4f6a7e(0x246)](_0x4f6a7e(0x27f))['find']({'botID':_0x191d03})['assign']({'live':_0x70ff46})['write'](),config=getConfiguration(),io['to'](_0x4f6a7e(0x2ca))[_0x4f6a7e(0x1a6)](_0x4f6a7e(0x27f),config),broadcastToBots(_0x4f6a7e(0x27f),JSON[_0x4f6a7e(0x1bc)](config));}function updateBotName(_0x3cd608,_0x4ecf17){const _0x3dfcf5=_0x49797c;dbConfig[_0x3dfcf5(0x246)](_0x3dfcf5(0x27f))[_0x3dfcf5(0x17a)]({'botID':_0x3cd608})[_0x3dfcf5(0x267)]({'botname':_0x4ecf17})['write'](),config=getConfiguration(),io['to'](_0x3dfcf5(0x2ca))[_0x3dfcf5(0x1a6)](_0x3dfcf5(0x27f),config),broadcastToBots('bots',JSON[_0x3dfcf5(0x1bc)](config));}function updateBotManager(){const _0x39d618=_0x49797c;config=getConfiguration(),io['to'](_0x39d618(0x2ca))[_0x39d618(0x1a6)](_0x39d618(0x27f),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBotMode(_0x279a79){const _0x10fd82=_0x49797c;if(pid[_0x279a79])pid[_0x279a79]['send']({'function':_0x10fd82(0x164),'args':null});else{const _0x52d091=configpath+_0x10fd82(0x2e3)+_0x279a79+_0x10fd82(0x1d2),_0x1f2723=fs[_0x10fd82(0x1dc)](_0x52d091),_0xb21541=JSON[_0x10fd82(0x186)](_0x1f2723),_0x3b6735=_0xb21541[_0x10fd82(0x182)][0x0][_0x10fd82(0x293)];_0xb21541[_0x10fd82(0x182)][0x0][_0x10fd82(0x293)]=!_0x3b6735;const _0x4708a7=JSON['stringify'](_0xb21541,null,0x2);fs[_0x10fd82(0x29d)](_0x52d091,_0x4708a7),config=getConfiguration(),io['to']('botmanager')[_0x10fd82(0x1a6)](_0x10fd82(0x27f),config),broadcastToBots(_0x10fd82(0x27f),JSON[_0x10fd82(0x1bc)](config));}}function validateTelegram(_0x5a558a){const _0x3aa727=_0x49797c;if(_0x5a558a[_0x3aa727(0x239)][_0x3aa727(0x11c)]!=settings[_0x3aa727(0x1c2)]&&'@'+_0x5a558a[_0x3aa727(0x239)][_0x3aa727(0x11c)]!=settings[_0x3aa727(0x1c2)]||_0x5a558a[_0x3aa727(0xfc)]['id']!=settings[_0x3aa727(0x2ab)])return sendTelegram(_0x5a558a[_0x3aa727(0xfc)]['id'],_0x3aa727(0x18f),{'parse_mode':'HTML'}),![];return!![];}function botRef(_0x733c18){const _0x2dc297=_0x49797c,_0x38f001=getBotAttributes(_0x733c18),_0x568567=_0x38f001[_0x2dc297(0xec)]?_0x38f001[_0x2dc297(0x218)]:'Bot\x20'+_0x733c18;return _0x568567;}async function initTelegram(){const _0x406d4c=_0x49797c;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings['telegramToken']);let _0x10abcd=_0x406d4c(0x19e);_0x10abcd+='\x0a',_0x10abcd+='/enable\x20-\x20enable\x20notifications\x0a',_0x10abcd+='/disable\x20-\x20disable\x20notifications\x0a',_0x10abcd+=_0x406d4c(0x1fd),_0x10abcd+=_0x406d4c(0x271),_0x10abcd+=_0x406d4c(0x172),_0x10abcd+=_0x406d4c(0x157),_0x10abcd+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x10abcd+=_0x406d4c(0xdd),_0x10abcd+=_0x406d4c(0x1cf),_0x10abcd+=_0x406d4c(0x216),_0x10abcd+=_0x406d4c(0x2b6),_0x10abcd+='/logs\x20-\x20receive\x20log\x20files\x0a',_0x10abcd+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0x10abcd+=_0x406d4c(0x12a),_0x10abcd+=_0x406d4c(0x16b),_0x10abcd+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x5b3d74=_0x406d4c(0x14b);_0x5b3d74+='\x0a',_0x5b3d74+=_0x10abcd,tgBot[_0x406d4c(0x169)]((_0x220494,_0x1962db)=>{const _0x2ef501=_0x406d4c;logger[_0x2ef501(0x2be)](getTimeStamp()+_0x2ef501(0x2c5)),logger['debug'](_0x2ef501(0x21b),_0x220494);}),tgBot[_0x406d4c(0x215)](async(_0x5d0de6,_0x3c82a1)=>{const _0x44f0c3=_0x406d4c;if(settings[_0x44f0c3(0x2ab)]||_0x5d0de6[_0x44f0c3(0x1ba)][_0x44f0c3(0x15e)][_0x44f0c3(0x260)]!=_0x44f0c3(0x1a7)){if(!validateTelegram(_0x5d0de6))return;}_0x3c82a1();}),tgBot[_0x406d4c(0x242)]('start',async _0x5590ff=>{const _0x25d74e=_0x406d4c;if(_0x5590ff[_0x25d74e(0x239)][_0x25d74e(0x11c)]==settings[_0x25d74e(0x1c2)]||'@'+_0x5590ff[_0x25d74e(0x239)][_0x25d74e(0x11c)]==settings[_0x25d74e(0x1c2)]){if(!settings[_0x25d74e(0x2ab)])updateSetting(_0x25d74e(0x2ab),_0x5590ff[_0x25d74e(0xfc)]['id']);else{if(!validateTelegram(_0x5590ff))return;}}else{if(!validateTelegram(_0x5590ff))return;}updateSetting('telegramEnabled',!![]),await sendTelegram(_0x5590ff[_0x25d74e(0xfc)]['id'],_0x5b3d74);}),tgBot[_0x406d4c(0x242)](_0x406d4c(0x23b),async _0x28d3b3=>{const _0x507a2a=_0x406d4c;updateSetting(_0x507a2a(0x279),!![]),await sendTelegram(_0x28d3b3[_0x507a2a(0xfc)]['id'],_0x507a2a(0x1e5));}),tgBot[_0x406d4c(0x242)](_0x406d4c(0x26f),async _0x406ab7=>{const _0x180505=_0x406d4c;await sendTelegram(_0x406ab7[_0x180505(0xfc)]['id'],_0x180505(0x2a5)),updateSetting(_0x180505(0x279),![]);}),tgBot[_0x406d4c(0x242)]('config',async _0x43ebf6=>{const _0x4315a7=_0x406d4c,_0x26391b=Markup[_0x4315a7(0x175)]([Markup[_0x4315a7(0x2ea)][_0x4315a7(0x20e)](_0x4315a7(0x2d5),_0x4315a7(0x143)),Markup[_0x4315a7(0x2ea)]['callback'](_0x4315a7(0x276),_0x4315a7(0x1e9)),Markup[_0x4315a7(0x2ea)][_0x4315a7(0x20e)](_0x4315a7(0x125),_0x4315a7(0x1d8))]);_0x43ebf6['reply'](_0x4315a7(0xcd),_0x26391b);}),tgBot['action'](_0x406d4c(0x143),async _0x13f19a=>{const _0x2462b9=_0x406d4c;_0x13f19a[_0x2462b9(0x222)](),updateSetting(_0x2462b9(0x1ef),_0x2462b9(0x2a3)),updateSetting(_0x2462b9(0x279),!![]),await sendTelegram(_0x13f19a['chat']['id'],_0x2462b9(0xfd));}),tgBot[_0x406d4c(0x21f)](_0x406d4c(0x1e9),async _0x30515c=>{const _0x523b60=_0x406d4c;_0x30515c[_0x523b60(0x222)](),updateSetting(_0x523b60(0x1ef),_0x523b60(0x13f)),updateSetting(_0x523b60(0x279),!![]),await sendTelegram(_0x30515c['chat']['id'],_0x523b60(0x24c));}),tgBot['action'](_0x406d4c(0x1d8),async _0x45bb28=>{const _0x4c2349=_0x406d4c;_0x45bb28[_0x4c2349(0x222)](),updateSetting('telegramEvents','all'),updateSetting(_0x4c2349(0x279),!![]),await sendTelegram(_0x45bb28[_0x4c2349(0xfc)]['id'],_0x4c2349(0x1d6));}),tgBot[_0x406d4c(0x242)](_0x406d4c(0x1fb),async _0x26e8db=>{const _0x4b9e40=_0x406d4c,_0x34494d=getBotsWithMode();let _0x2a207e=_0x4b9e40(0x2a1);config[_0x4b9e40(0x114)](_0x5a8adb=>{const _0x1df4c5=_0x4b9e40,_0x2dc93c=_0x34494d[_0x1df4c5(0x17a)](_0x5675d1=>_0x5675d1['botID']==_0x5a8adb[_0x1df4c5(0x225)])[_0x1df4c5(0x25d)];_0x2a207e+=_0x1df4c5(0xe2)+_0x5a8adb[_0x1df4c5(0x225)]+':\x20'+_0x5a8adb[_0x1df4c5(0x1fb)]+_0x1df4c5(0x161)+_0x2dc93c+_0x1df4c5(0x161)+_0x5a8adb[_0x1df4c5(0x2d0)]+'\x0a';}),_0x2a207e+='\x0a',_0x2a207e+=_0x4b9e40(0x21a),_0x2a207e+=!settings[_0x4b9e40(0x279)]?'Notifications\x20disabled\x0a':'Notifications\x20enabled\x0a',_0x2a207e+=settings['telegramEnabled']?settings['telegramEvents']==_0x4b9e40(0x258)?_0x4b9e40(0x278):_0x4b9e40(0x2d6)+settings[_0x4b9e40(0x1ef)]+_0x4b9e40(0x230):'',await sendTelegram(_0x26e8db[_0x4b9e40(0xfc)]['id'],_0x2a207e,{'parse_mode':_0x4b9e40(0x154)});}),tgBot['command'](_0x406d4c(0x2e8),async _0x526bbd=>{const _0x3e4588=_0x406d4c,_0x399d05=getEnabledBots();if(_0x399d05[_0x3e4588(0xee)]==0x0)await sendTelegram(_0x526bbd[_0x3e4588(0xfc)]['id'],_0x3e4588(0x184));else{if(_0x399d05['length']>0x1)_0x399d05[_0x3e4588(0x2ba)]({'botID':'all'});let _0x5c0159=[],_0x46f135=[];const _0x295098=_0x399d05['length']%0x4==0x0||_0x399d05['length']%0x4==0x3||_0x399d05[_0x3e4588(0xee)]%0x3==0x1?0x4:0x3;let _0x3d4a4b=0x0;_0x399d05['forEach']((_0x149c65,_0x5ab804)=>{const _0x360081=_0x3e4588;if(_0x5ab804%_0x295098==0x0)_0x46f135=[];_0x46f135[_0x360081(0x2ba)](Markup[_0x360081(0x2ea)][_0x360081(0x20e)](_0x149c65['botID']==_0x360081(0x258)?_0x360081(0x2bd):botRef(_0x149c65[_0x360081(0x225)]),_0x360081(0xef)+_0x149c65[_0x360081(0x225)])),_0x5ab804%_0x295098==0x0&&(_0x5c0159[_0x3d4a4b]=_0x46f135,_0x3d4a4b++);});const _0x577e0f=Markup[_0x3e4588(0x175)](_0x5c0159);_0x526bbd[_0x3e4588(0x18d)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x577e0f);}}),tgBot[_0x406d4c(0x21f)](/restart_(.+)/,async _0x3eb5ec=>{const _0x518fda=_0x406d4c,_0x1ba4ad=_0x3eb5ec[_0x518fda(0x243)][0x1];_0x3eb5ec[_0x518fda(0x222)](),_0x1ba4ad==_0x518fda(0x258)?config[_0x518fda(0x114)](_0x5926a1=>{const _0x165265=_0x518fda;restartBot(_0x5926a1[_0x165265(0x225)]);}):restartBot(_0x1ba4ad);}),tgBot[_0x406d4c(0x242)]('on',async _0x8d0c89=>{const _0x10e21f=_0x406d4c,_0x363193=getDisabledBots();if(_0x363193[_0x10e21f(0xee)]==0x0)await sendTelegram(_0x8d0c89['chat']['id'],_0x10e21f(0x292));else{if(_0x363193['length']>0x1)_0x363193['push']({'botID':_0x10e21f(0x258)});let _0x5d20a2=[],_0x5065e7=[];const _0x11c75e=_0x363193[_0x10e21f(0xee)]%0x4==0x0||_0x363193[_0x10e21f(0xee)]%0x4==0x3||_0x363193[_0x10e21f(0xee)]%0x3==0x1?0x4:0x3;let _0x5ef1ff=0x0;_0x363193[_0x10e21f(0x114)]((_0x17e071,_0x2a33d6)=>{const _0x461e36=_0x10e21f;if(_0x2a33d6%_0x11c75e==0x0)_0x5065e7=[];_0x5065e7[_0x461e36(0x2ba)](Markup[_0x461e36(0x2ea)][_0x461e36(0x20e)](_0x17e071[_0x461e36(0x225)]==_0x461e36(0x258)?_0x461e36(0x2bd):botRef(_0x17e071[_0x461e36(0x225)]),_0x461e36(0x211)+_0x17e071[_0x461e36(0x225)])),_0x2a33d6%_0x11c75e==0x0&&(_0x5d20a2[_0x5ef1ff]=_0x5065e7,_0x5ef1ff++);});const _0x403dcf=Markup[_0x10e21f(0x175)](_0x5d20a2);_0x8d0c89[_0x10e21f(0x18d)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x403dcf);}}),tgBot['action'](/on_(.+)/,async _0x4d1a1a=>{const _0xf19b2=_0x406d4c,_0x56effb=_0x4d1a1a[_0xf19b2(0x243)][0x1];_0x4d1a1a['editMessageReplyMarkup']();if(_0x56effb==_0xf19b2(0x258)){const _0x301a43=getDisabledBots();await sendTelegram(_0x4d1a1a[_0xf19b2(0xfc)]['id'],'Bot\x20Mgr\x20>\x20Starting\x20all\x20bots'),_0x301a43['forEach'](_0x1bf87d=>{const _0x112e18=_0xf19b2;if(_0x1bf87d[_0x112e18(0x225)]!=_0x112e18(0x258))toggleBot(_0x1bf87d['botID'],toggleStatus(_0x1bf87d[_0x112e18(0x225)]),_0x112e18(0x207));});}else await sendTelegram(_0x4d1a1a['chat']['id'],_0xf19b2(0x2dc)+botRef(_0x56effb)),toggleBot(_0x56effb,toggleStatus(_0x56effb),_0xf19b2(0x207));}),tgBot['command'](_0x406d4c(0xf4),async _0x503aa1=>{const _0x2e1ac9=_0x406d4c,_0x2a85c2=getEnabledBots();if(_0x2a85c2[_0x2e1ac9(0xee)]==0x0)await sendTelegram(_0x503aa1['chat']['id'],_0x2e1ac9(0x184));else{if(_0x2a85c2[_0x2e1ac9(0xee)]>0x1)_0x2a85c2[_0x2e1ac9(0x2ba)]({'botID':_0x2e1ac9(0x258)});let _0x14110f=[],_0x4cc2ca=[];const _0x28ead7=_0x2a85c2['length']%0x4==0x0||_0x2a85c2[_0x2e1ac9(0xee)]%0x4==0x3||_0x2a85c2['length']%0x3==0x1?0x4:0x3;let _0x3bfad2=0x0;_0x2a85c2[_0x2e1ac9(0x114)]((_0x3a1d94,_0x5cf98c)=>{const _0xb0519a=_0x2e1ac9;if(_0x5cf98c%_0x28ead7==0x0)_0x4cc2ca=[];_0x4cc2ca[_0xb0519a(0x2ba)](Markup['button']['callback'](_0x3a1d94[_0xb0519a(0x225)]==_0xb0519a(0x258)?'All\x20bots':botRef(_0x3a1d94[_0xb0519a(0x225)]),'off_'+_0x3a1d94[_0xb0519a(0x225)])),_0x5cf98c%_0x28ead7==0x0&&(_0x14110f[_0x3bfad2]=_0x4cc2ca,_0x3bfad2++);});const _0x25616c=Markup[_0x2e1ac9(0x175)](_0x14110f);_0x503aa1[_0x2e1ac9(0x18d)](_0x2e1ac9(0x1ce),_0x25616c);}}),tgBot[_0x406d4c(0x21f)](/off_(.+)/,async _0x57cb13=>{const _0x40587d=_0x406d4c,_0x1ceafb=_0x57cb13[_0x40587d(0x243)][0x1];_0x57cb13[_0x40587d(0x222)]();if(_0x1ceafb==_0x40587d(0x258)){const _0x2dd2ac=getEnabledBots();await sendTelegram(_0x57cb13[_0x40587d(0xfc)]['id'],_0x40587d(0xde)),_0x2dd2ac[_0x40587d(0x114)](_0x31cef2=>{const _0x4ddb90=_0x40587d;if(_0x31cef2[_0x4ddb90(0x225)]!=_0x4ddb90(0x258))toggleBot(_0x31cef2['botID'],toggleStatus(_0x31cef2[_0x4ddb90(0x225)]),_0x4ddb90(0x207));});}else await sendTelegram(_0x57cb13['chat']['id'],'Bot\x20Mgr\x20>\x20Stopping\x20'+botRef(_0x1ceafb)),toggleBot(_0x1ceafb,toggleStatus(_0x1ceafb),_0x40587d(0x207));}),tgBot[_0x406d4c(0x242)](_0x406d4c(0x129),async _0x44a1c2=>{const _0x5731aa=_0x406d4c,_0x21cea6=getEnabledBots();if(_0x21cea6[_0x5731aa(0xee)]==0x0)await sendTelegram(_0x44a1c2[_0x5731aa(0xfc)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x21cea6[_0x5731aa(0xee)]>0x1){let _0x149bba=[],_0x593c0a=[];const _0x4a976f=_0x21cea6[_0x5731aa(0xee)]%0x4==0x0||_0x21cea6[_0x5731aa(0xee)]%0x4==0x3||_0x21cea6[_0x5731aa(0xee)]%0x3==0x1?0x4:0x3;let _0x462410=0x0;_0x21cea6['forEach']((_0x49babf,_0x9233b8)=>{const _0x4aaeb5=_0x5731aa;if(_0x9233b8%_0x4a976f==0x0)_0x593c0a=[];_0x593c0a['push'](Markup[_0x4aaeb5(0x2ea)][_0x4aaeb5(0x20e)](botRef(_0x49babf['botID']),_0x4aaeb5(0x26b)+_0x49babf[_0x4aaeb5(0x225)])),_0x9233b8%_0x4a976f==0x0&&(_0x149bba[_0x462410]=_0x593c0a,_0x462410++);});const _0x3187b9=Markup['inlineKeyboard'](_0x149bba);_0x44a1c2[_0x5731aa(0x18d)](_0x5731aa(0x2b0),_0x3187b9);}else{const _0x56a606=_0x21cea6[0x0][_0x5731aa(0x225)];if(pid[_0x56a606])pid[_0x56a606][_0x5731aa(0x15b)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x406d4c(0x21f)](/metrics_(.+)/,async _0x1e0f6b=>{const _0x4c95c7=_0x406d4c,_0x27bee4=_0x1e0f6b['match'][0x1];_0x1e0f6b['editMessageReplyMarkup']();if(pid[_0x27bee4])pid[_0x27bee4][_0x4c95c7(0x15b)]({'function':'sendMetricsTelegram','args':null});}),tgBot['command']('portfolio',async _0x28633e=>{const _0xaec457=_0x406d4c,_0x2faec6=getEnabledBots();if(_0x2faec6[_0xaec457(0xee)]==0x0)await sendTelegram(_0x28633e['chat']['id'],_0xaec457(0x184));else{if(_0x2faec6[_0xaec457(0xee)]>0x1){let _0x4e2e28=[],_0x155537=[];const _0x50e6c1=_0x2faec6['length']%0x4==0x0||_0x2faec6[_0xaec457(0xee)]%0x4==0x3||_0x2faec6['length']%0x3==0x1?0x4:0x3;let _0x10e010=0x0;_0x2faec6['forEach']((_0x3457d7,_0x4a29f5)=>{const _0x3aab03=_0xaec457;if(_0x4a29f5%_0x50e6c1==0x0)_0x155537=[];_0x155537[_0x3aab03(0x2ba)](Markup[_0x3aab03(0x2ea)]['callback'](botRef(_0x3457d7[_0x3aab03(0x225)]),_0x3aab03(0x187)+_0x3457d7[_0x3aab03(0x225)])),_0x4a29f5%_0x50e6c1==0x0&&(_0x4e2e28[_0x10e010]=_0x155537,_0x10e010++);});const _0x38e3b3=Markup[_0xaec457(0x175)](_0x4e2e28);_0x28633e[_0xaec457(0x18d)](_0xaec457(0x109),_0x38e3b3);}else{const _0x5cc671=_0x2faec6[0x0][_0xaec457(0x225)];if(pid[_0x5cc671])pid[_0x5cc671][_0xaec457(0x15b)]({'function':_0xaec457(0x209),'args':null});}}}),tgBot[_0x406d4c(0x21f)](/portfolio_(.+)/,async _0x47f420=>{const _0x46f2c7=_0x406d4c,_0x4fb533=_0x47f420[_0x46f2c7(0x243)][0x1];_0x47f420[_0x46f2c7(0x222)]();if(pid[_0x4fb533])pid[_0x4fb533][_0x46f2c7(0x15b)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x406d4c(0x242)]('logs',async _0x2a06be=>{const _0x316aa9=_0x406d4c,_0x199332=_0x316aa9(0x220);await zipFiles(_0x199332);const _0x141ba8=zippath+(_0x199332+_0x316aa9(0x118));_0x2a06be[_0x316aa9(0xf7)]({'source':_0x141ba8})[_0x316aa9(0x1b4)](()=>{})['catch'](_0x5714ca=>logger[_0x316aa9(0xfa)]('Error\x20sending\x20'+_0x199332+_0x316aa9(0x2b1),_0x5714ca));}),tgBot[_0x406d4c(0x242)](_0x406d4c(0x2e6),async _0x447ae8=>{const _0x5de7d0=_0x406d4c,_0x33f03f=_0x5de7d0(0x2e6);await backupConfigFiles(),await zipFiles(_0x33f03f);const _0x3e8812=zippath+(_0x33f03f+_0x5de7d0(0x118));_0x447ae8['replyWithDocument']({'source':_0x3e8812})[_0x5de7d0(0x1b4)](()=>{})[_0x5de7d0(0x169)](_0xe85714=>logger[_0x5de7d0(0xfa)](_0x5de7d0(0x20d)+_0x33f03f+_0x5de7d0(0x2b1),_0xe85714));}),tgBot['command'](_0x406d4c(0x1ba),async _0x3ad520=>{const _0x3be4e3=_0x406d4c;await getMessages();if(!updateAvailable)await sendTelegram(_0x3ad520[_0x3be4e3(0xfc)]['id'],_0x3be4e3(0x14f));else{if(!validInstallation)await sendTelegram(_0x3ad520['chat']['id'],_0x3be4e3(0x231));else{const _0x3db71d=Markup[_0x3be4e3(0x175)]([Markup[_0x3be4e3(0x2ea)][_0x3be4e3(0x20e)](_0x3be4e3(0x1b9),'update_yes'),Markup[_0x3be4e3(0x2ea)]['callback']('No','update_no')]);_0x3ad520[_0x3be4e3(0x18d)](_0x3be4e3(0x28b),_0x3db71d);}}}),tgBot[_0x406d4c(0x21f)](/update_(.+)/,async _0x138e31=>{const _0x41c278=_0x406d4c,_0x1c1a4f=_0x138e31[_0x41c278(0x243)][0x1];_0x138e31['editMessageReplyMarkup'](),_0x1c1a4f=='yes'&&(await sendTelegram(_0x138e31[_0x41c278(0xfc)]['id'],_0x41c278(0x1c3)),updateBB(_0x41c278(0x1ba))),_0x1c1a4f=='no'&&await sendTelegram(_0x138e31[_0x41c278(0xfc)]['id'],_0x41c278(0x20b));}),tgBot[_0x406d4c(0x242)]('reinstall',async _0x1af933=>{const _0x49571c=_0x406d4c;if(!validInstallation)await sendTelegram(_0x1af933[_0x49571c(0xfc)]['id'],_0x49571c(0x268));else{const _0x5f5540=Markup[_0x49571c(0x175)]([Markup[_0x49571c(0x2ea)][_0x49571c(0x20e)](_0x49571c(0x1b9),_0x49571c(0xdb)),Markup[_0x49571c(0x2ea)][_0x49571c(0x20e)]('No',_0x49571c(0x196))]);_0x1af933[_0x49571c(0x18d)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x5f5540);}}),tgBot[_0x406d4c(0x21f)](/reinstall_(.+)/,async _0x935f01=>{const _0x1b621f=_0x406d4c,_0x147fa9=_0x935f01[_0x1b621f(0x243)][0x1];_0x935f01[_0x1b621f(0x222)](),_0x147fa9==_0x1b621f(0x223)&&(await sendTelegram(_0x935f01[_0x1b621f(0xfc)]['id'],_0x1b621f(0x2c1)),updateBB(_0x1b621f(0x29c))),_0x147fa9=='no'&&await sendTelegram(_0x935f01['chat']['id'],_0x1b621f(0x2df));}),tgBot['command'](_0x406d4c(0x10a),async _0x5d654f=>{const _0x358c01=_0x406d4c,_0x3bff8d=getBotsWithMode();if(_0x3bff8d[_0x358c01(0xee)]==0x0)await sendTelegram(_0x5d654f[_0x358c01(0xfc)]['id'],_0x358c01(0x184));else{let _0x4815dc=[],_0x597565=[];const _0x783964=0x2;let _0x36b0b1=0x0;_0x3bff8d[_0x358c01(0x114)]((_0x2b7bf6,_0x16c822)=>{const _0x2ce0cb=_0x358c01;if(_0x16c822%_0x783964==0x0)_0x597565=[];_0x597565[_0x2ce0cb(0x2ba)](Markup['button'][_0x2ce0cb(0x20e)](botRef(_0x2b7bf6[_0x2ce0cb(0x225)])+'\x20('+_0x2b7bf6[_0x2ce0cb(0x25d)]+')',_0x2ce0cb(0x2c9)+_0x2b7bf6['botID'])),_0x16c822%_0x783964==0x0&&(_0x4815dc[_0x36b0b1]=_0x597565,_0x36b0b1++);});const _0x140f36=Markup[_0x358c01(0x175)](_0x4815dc);_0x5d654f[_0x358c01(0x18d)](_0x358c01(0xe4),_0x140f36);}}),tgBot[_0x406d4c(0x21f)](/toggle_(.+)/,async _0x10b5bb=>{const _0x4e0fad=_0x406d4c,_0x39acd5=_0x10b5bb[_0x4e0fad(0x243)][0x1];_0x10b5bb[_0x4e0fad(0x222)]();const _0x27c0a5=getBotsWithMode(),_0x406e45=_0x27c0a5['find'](_0x8b5013=>_0x8b5013[_0x4e0fad(0x225)]==_0x39acd5),_0x1a5664=_0x406e45['mode']==_0x4e0fad(0x1b7)?'manual':'auto';await sendTelegram(_0x10b5bb[_0x4e0fad(0xfc)]['id'],_0x4e0fad(0x1bf)+botRef(_0x406e45[_0x4e0fad(0x225)])+_0x4e0fad(0x191)+_0x1a5664+_0x4e0fad(0x28d)),toggleBotMode(_0x39acd5);}),tgBot['command'](_0x406d4c(0x17e),async _0x13a901=>{const _0x27da53=_0x406d4c;let _0x3ecce7='';config['forEach'](_0x36c76c=>{const _0xa37c0f=_0x3612;_0x3ecce7+=_0xa37c0f(0xe2)+_0x36c76c[_0xa37c0f(0x225)]+':\x20'+_0x36c76c[_0xa37c0f(0x218)]+'\x0a';}),await sendTelegram(_0x13a901[_0x27da53(0xfc)]['id'],_0x3ecce7,{'parse_mode':_0x27da53(0x154)});}),tgBot[_0x406d4c(0x242)]('help',async _0x13baeb=>{await sendTelegram(_0x13baeb['chat']['id'],_0x10abcd);}),process[_0x406d4c(0x18c)](_0x406d4c(0x16a),()=>tgBot['stop'](_0x406d4c(0x16a))),process['once'](_0x406d4c(0x195),()=>tgBot[_0x406d4c(0x2e9)](_0x406d4c(0x195))),tgBot[_0x406d4c(0x18e)]();}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x46c051,_0x44ea60,_0x8d2b29){const _0xded121=_0x49797c;_0x8d2b29={..._0x8d2b29,'disable_web_page_preview':!![]};try{await tgBot[_0xded121(0x249)][_0xded121(0xd9)](_0x46c051,_0x44ea60,_0x8d2b29);}catch(_0x5ade8b){logger[_0xded121(0xfa)]('Telegram\x20error:',_0x5ade8b);}}async function sendTelegramBot(_0x9c7f97,_0x48c36c){const _0x5be127=_0x49797c;if(settings['telegramEnabled']){if(settings[_0x5be127(0x1ef)]==_0x5be127(0x258)||(_0x48c36c[_0x5be127(0x1c9)]=='error'||_0x48c36c[_0x5be127(0x1c9)]==_0x5be127(0x26d)||_0x48c36c[_0x5be127(0x1c9)]==_0x5be127(0x150))&&settings[_0x5be127(0x1ef)]==_0x5be127(0x13f)||_0x48c36c[_0x5be127(0x1c9)]==_0x5be127(0x166)&&settings[_0x5be127(0x1ef)]=='orders'){if(tgBot&&settings[_0x5be127(0x2ab)]){if(_0x48c36c[_0x5be127(0xec)])await sendTelegram(settings[_0x5be127(0x2ab)],_0x48c36c[_0x5be127(0x218)]+_0x5be127(0x2a6)+_0x48c36c[_0x5be127(0x1a3)]);else await sendTelegram(settings[_0x5be127(0x2ab)],'Bot\x20'+_0x9c7f97+_0x5be127(0x2a6)+_0x48c36c[_0x5be127(0x1a3)]);}}}}async function sendTelegramMsg(_0x40842a,_0x3866b2=_0x49797c(0x154)){return tgBot&&settings['telegramChatId']?(await sendTelegram(settings['telegramChatId'],_0x40842a,{'parse_mode':_0x3866b2}),!![]):![];}function getDeviceWithIp(_0x9501d7){const _0x4d4f66=_0x49797c;return devices[_0x4d4f66(0x17a)](_0x38d540=>_0x38d540['ip']===_0x9501d7);}async function temporaryAccess2FA(_0xc93885,_0x4223fa){const _0x4e74b2=_0x49797c;let _0x443678=new Date(),_0x474b2a=![];if(lastIpApproval){if(_0x443678-lastIpApproval<0x1388)_0x474b2a=!![];}lastIpApproval=new Date();if(_0x474b2a)return;if(tgBot&&settings[_0x4e74b2(0x2ab)]){const _0x13d743=uuidRandom();tmpStorage[_0x13d743]={'uuid':_0xc93885,'externalip':_0x4223fa};const _0x1a609c=Markup[_0x4e74b2(0x175)]([Markup['button'][_0x4e74b2(0x20e)]('5\x20min','tempaccess_5_'+_0x13d743),Markup[_0x4e74b2(0x2ea)][_0x4e74b2(0x20e)](_0x4e74b2(0x290),_0x4e74b2(0x181)+_0x13d743),Markup[_0x4e74b2(0x2ea)][_0x4e74b2(0x20e)](_0x4e74b2(0x1bd),'tempaccess_30_'+_0x13d743),Markup[_0x4e74b2(0x2ea)][_0x4e74b2(0x20e)]('reject','tempaccess_reject_'+_0x13d743)]);await sendTelegram(settings[_0x4e74b2(0x2ab)],_0x4e74b2(0x101)+normalizeIP(_0x4223fa)[_0x4e74b2(0x168)]+'\x20?',_0x1a609c),tgBot[_0x4e74b2(0x21f)](/tempaccess_(.+)_(.+)/,async _0x4b62a6=>{const _0x3461cc=_0x4e74b2,_0x5746aa=_0x4b62a6[_0x3461cc(0x243)][0x1],_0x27d1f6=_0x4b62a6[_0x3461cc(0x243)][0x2],{uuid:_0x526521,externalip:_0x4713ea}=tmpStorage[_0x27d1f6];delete tmpStorage[_0x27d1f6],_0x4b62a6['editMessageReplyMarkup'](),devices[_0x526521][_0x3461cc(0xd6)]={'clientip':_0x4713ea,'timestamp':new Date()[_0x3461cc(0x2bc)](),'expiry':_0x5746aa},_0x5746aa!=_0x3461cc(0x237)?(await sendTelegram(_0x4b62a6[_0x3461cc(0xfc)]['id'],_0x3461cc(0xdf)+_0x5746aa+_0x3461cc(0x10b),{'parse_mode':_0x3461cc(0x154)}),io['to'](_0x526521)['emit'](_0x3461cc(0x1fb),{'access':{'allow':![],'reason':_0x3461cc(0x1f9),'token':null}})):(await sendTelegram(_0x4b62a6[_0x3461cc(0xfc)]['id'],_0x3461cc(0x173)),io['to'](_0x526521)[_0x3461cc(0x1a6)](_0x3461cc(0x1fb),{'access':{'allow':![],'reason':_0x3461cc(0x17f),'token':null}}));});}}async function loginAccess2FA(_0x39734a,_0x3fbe1b){const _0x1e0ade=_0x49797c;if(tgBot&&settings['telegramChatId']){const _0x3e079a=uuidRandom();tmpStorage[_0x3e079a]={'uuid':_0x39734a,'externalip':_0x3fbe1b};const _0x45ae90=Markup[_0x1e0ade(0x175)]([Markup['button']['callback'](_0x1e0ade(0x210),'login2fa_'+loginExpiry+'_'+_0x3e079a),Markup[_0x1e0ade(0x2ea)][_0x1e0ade(0x20e)](_0x1e0ade(0x237),_0x1e0ade(0x266)+_0x3e079a)]);await sendTelegram(settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x3fbe1b)[_0x1e0ade(0x168)]+'\x20?',_0x45ae90),tgBot[_0x1e0ade(0x21f)](/login2fa_(.+)_(.+)/,async _0x4bc442=>{const _0x562a20=_0x1e0ade,_0x4266a3=_0x4bc442[_0x562a20(0x243)][0x1],_0x411eef=_0x4bc442[_0x562a20(0x243)][0x2],{uuid:_0x32fce6,externalip:_0x35ac0e}=tmpStorage[_0x411eef];delete tmpStorage[_0x411eef],_0x4bc442[_0x562a20(0x222)](),devices[_0x32fce6][_0x562a20(0x158)]={'clientip':_0x35ac0e,'timestamp':new Date()[_0x562a20(0x2bc)](),'expiry':_0x4266a3},_0x4266a3!=_0x562a20(0x237)?(await sendTelegram(_0x4bc442[_0x562a20(0xfc)]['id'],'Login\x20accepted',{'parse_mode':_0x562a20(0x154)}),io['to'](_0x32fce6)[_0x562a20(0x1a6)](_0x562a20(0x1fb),{'access':{'allow':![],'reason':_0x562a20(0x1f9),'token':null}})):(await sendTelegram(_0x4bc442['chat']['id'],_0x562a20(0x2c6)),io['to'](_0x32fce6)[_0x562a20(0x1a6)](_0x562a20(0x1fb),{'access':{'allow':![],'reason':_0x562a20(0x1ca),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x42e0d4=_0x49797c;return dbConfig[_0x42e0d4(0x246)](_0x42e0d4(0x27f))[_0x42e0d4(0x120)]('botID')[_0x42e0d4(0xe7)]({'status':_0x42e0d4(0x13c)})[_0x42e0d4(0x247)]()||[];}function getDisabledBots(){const _0x385d72=_0x49797c;return dbConfig[_0x385d72(0x246)](_0x385d72(0x27f))[_0x385d72(0x120)](_0x385d72(0x225))[_0x385d72(0xe7)]({'status':'disabled'})[_0x385d72(0x247)]()||[];}function _0x2b5a(){const _0x38198b=['crypto','remove','emit','/start','hashSync','storeFiat','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','User\x20has\x20been\x20validated','port','Unauthorized\x20attempt\x20to\x20get\x20messages','sendFile','onepagemode','toggle-bot-mode','apiPassword','temporary\x20access\x20not\x20allowed','#RES#\x20if\x20running\x20locally\x0a','then','https://api.ipify.org?format=json','/upload-backup','auto','backup-full','Yes','update','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','stringify','30\x20min','reason','Bot\x20Mgr\x20>\x20Toggling\x20','generateKeyPair','BCT','telegramUsername','Starting\x20Balance\x20Bot\x20update','sign','3000','whitelistEnabled','backup-full@','ETH','type','2FA\x20login\x20rejected','restore_yes_','bb-secure.json','resetpw_yes','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','/status\x20-\x20show\x20bot(s)\x20status\x0a','lowdb/adapters/FileSync','showConfig','-config.json','existsSync','rmSync','connection','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','readdirSync','config_all','bbPassword','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','readFileSync','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Node.js\x20v','Unauthorized\x20attempt\x20to\x20show\x20configuration','48296DxigTl','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','output-003.log','/:bot/portfolio','/output-000.log','Notifications\x20enabled','http://localhost:','replace','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','config_alerts','lastmsgtelegram','exchange','/:bot/coins','lastmsgemitted','data','telegramEvents','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Invalid\x20authentication\x20token\x20(1)','Deleted\x20Bot\x20','close','statSync','staging','Unauthorized\x20attempt\x20to\x20confirm\x20message','listen','reload','token','status','backupfile','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','secure','Logged\x20in\x20user\x20...','address','args','hex','getDate','Session\x20expired\x20for\x20user\x20...','params','get-backup-files','stopped','node','sendPortfolioTelegram','max','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','headers','Error\x20sending\x20','callback','remoteAddress','accept','on_','entries','cancel-loading','updatebotmanager','use','/metrics\x20-\x20show\x20bot\x20performance\x0a','ipaddr.js','botname','update-bb','<b>Telegram\x20Bot\x20Status:</b>\x0a','Telegraf\x20error:','/:bot/support','Logged\x20out\x20user\x20...','static','action','logs','jszip','editMessageReplyMarkup','yes','init','botID','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','532925GnOUTL','password','isIPv4MappedAddress','post','toString','hasOwnProperty','unlinkSync','user','/:bot/configuration','\x20only\x0a','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','disabled','ipv6','string','\x1b[31m','index.html','reject','name','from','decrypt','enable','http','Unauthorized\x20login\x20attempt\x20(timeout)','zip/','(staging)','manual','title','command','match','***','|@|','get','value','createWriteStream','telegram',')\x20|\x20Bot\x20','2FA\x20required','Ok,\x20will\x20send\x20alert\x20notifications\x20only','uuid-random','/download/:type','login\x20token\x20generated','bbvNew','copyFileSync','\x20(2)','argv','Failed\x20to\x20download\x20','api-eu.mixpanel.com','new-disabled','bbUsername','all','privateKey','Disabled\x20','placeOrder','Error\x20details:','mode','cancelLoading','DEFLATE','text','6b67f3d61ee94b8f5c80b4affef4c4d9','************','child_process','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','download','login2fa_reject_','assign','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Unauthorized\x20attempt\x20to\x20store\x20configuration','files','metrics_','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','warning','cloneDeep','disable','get-portfolio','/restart\x20-\x20restart\x20bot(s)\x0a','socket.io','add','7qWISqo','secret','Alerts','temporary\x20token\x20generated','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','telegramEnabled','encryptedUuid','login','exit','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','66xfQLrC','bots','decode64','output-000.log','127.0.0.1','padStart','Setting\x20access:\x20','::ffff:7f00:1','function','defaults','Restore\x20process\x20confirmed','latestversion','allow','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','\x20mode','marketcapApi','Restore\x20process\x20aborted','15\x20min','store','All\x20bots\x20running\x20right\x20now','headless','search','getSeconds','pidRefreshToken','File\x20uploaded','publicKeyToPem','create','-performance.json','private','reinstall','writeFileSync','initclient','status\x20code\x20401','toIPv4Address','<b>Balance\x20Bot\x20Status:</b>\x0a','set','orders','Error:\x20Invalid\x20argument\x20','Notifications\x20disabled','\x20>\x20','bot.js','min','axios','running','telegramChatId','bb-config.json','#RES#\x20if\x20running\x20on\x20server','slice','Enabled\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','\x20files\x20over\x20Telegram:','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','Bot\x20Mgr\x20>\x20','tkn','number','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','uuid','kill','push','write','getTime','All\x20bots','simple','Markdown','getStartingBalances','Starting\x20Balance\x20Bot\x20reinstallation','lowdb','Invalid\x20username\x20or\x20IP\x20address','get-messages',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','Login\x20rejected','express','access\x20timeout','toggle_','botmanager','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','full','1542924bcTnPo','add-bot','jsonwebtoken','live','track','-events.json','settings.','exec','Orders','Notifications\x20types:\x20','reset-history','config/','auth','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','place-order','Bot\x20Mgr\x20>\x20Starting\x20','kind','build','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','blacklist','delete-alerts','range','bot-','path','disconnect','backup','join','restart','stop','button','messages','logged\x20out','storeConfiguration','Unauthorized\x20attempt\x20to\x20download\x20','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','store-headless','/:bot/history','Restore\x20backup\x20file\x20','_nsps','\x1b[36m',')\x20\x20\x20|\x20Bot\x20','getHours','backup/','telegramIpApproval','timeshift','Error\x20removing\x20old\x20backup\x20files:','sendMessage','Unauthorized\x20attempt\x20to\x20update\x20settings','reinstall_yes','privateKeyToPem','/names\x20-\x20show\x20bot\x20names\x0a','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','Access\x20enabled\x20for\x20','temporaryAccessAllowed','output-001.log','Bot\x20','privateKeyFromPem','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',',\x20must\x20be\x20a\x204\x20digit\x20number','open','filter','IPv4','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Unauthorized\x20attempt\x20to\x20get\x20portfolio','new','showname','any','length','restart_','notification','util','mkdirSync','Unauthorized\x20attempt\x20to\x20delete\x20bot','off','getFullYear','constructor','replyWithDocument','inherit','\x20(1)','debug','store-configuration','chat','Ok,\x20will\x20send\x20order\x20notifications\x20only','Server','*$1*','\x1b[34m','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','emitHistory','Unauthorized\x20attempt\x20to\x20delete\x20alerts','expiry','1797815KTDtyQ','rsa','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','alias','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','toggle','\x20minutes','\x20|\x20user:\x20...','referer','bb-settings.json','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','host','sha256','show-config','keys','forEach','2FA\x20login\x20required','979430EMvGQv','pidExpireLogin','.zip','-----------------------------------------------------------------------------------','reinstall-bb','Starting\x20new\x20bot\x20|\x20Bot\x20','username','userid','format','includes','sortBy','split','\x1b[35m','temp/','Unauthorized\x20attempt\x20to\x20log\x20out','All',':\x20Bot\x20Mgr\x20>\x20','$1_$2_$3','getPortfolio','metrics','/update\x20-\x20update\x20Balance\x20Bot\x0a','3920082GWeclZ','randomBytes','apply','Token\x20blacklisted','#RES#\x20','environment','server','Unauthorized\x20attempt\x20to\x20add\x20bot','sort','log','createServer','delete-bot','conn','apiKey','(((.+)+)+)+$','startsWith','file','enabled','date-fns','Backup\x20file\x20uploaded','alerts','f2aRequired','2169309oaOPMN','telegramToken','config_orders','compareSync','ipc','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','clientip','0.0.0','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','address\x20already\x20in\x20use','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','::ffff:127.0.0.1','started','test','Your\x20installation\x20is\x20already\x20up\x20to\x20date','success','build2','login\x20required','Unauthorized\x20attempt\x20to\x20get\x20events','HTML','telegrammsg','settings','/off\x20-\x20stop\x20bot(s)\x0a','telegram2FaApproval','logout','\x20|\x20client:\x20...','send','sockets','NTBA_FIX_319','message','logs/','socket','\x20|\x20','env',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','toggleBotMode','Starting\x20#RED#Balance\x20Bot\x20v','order','-results.json','show','catch','SIGINT','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','confirm-message','clients','error','yargs','isValid','store-settings','/on\x20-\x20start\x20bot(s)\x0a','Temporary\x20access\x20rejected','invalid\x20credentials','inlineKeyboard','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','randomFillSync','/:bot','version','find','access','loginRequired','get-logs','names','temporary\x20access\x20rejected','Idling\x20(','tempaccess_15_','bot','Restarting\x20','No\x20bots\x20running\x20right\x20now','handshake','parse','portfolio_','getMonth','binary','--------------------------------------','node-forge','once','reply','launch','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','getUTCHours','\x20to\x20','restore_no_','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','output-002.log','SIGTERM','reinstall_no','publicKey','timestamp','bbvReceive','internal','pki','get-starting-balances','909mReegw','You\x20can\x20use\x20the\x20following\x20commands:\x0a','family','2nWsnmf','isDirectory','getMinutes','event'];_0x2b5a=function(){return _0x38198b;};return _0x2b5a();}function getBotAttributes(_0x7c6584){const _0x2c4c4f=_0x49797c;let _0x532793={};const _0x315267=configpath+_0x2c4c4f(0x2e3)+_0x7c6584+_0x2c4c4f(0x1d2),_0x30b416=fs['existsSync'](_0x315267);if(_0x30b416){const _0x444286=fs[_0x2c4c4f(0x1dc)](_0x315267);try{const _0x53025a=JSON['parse'](_0x444286),_0x2f4bfc=_0x53025a?_0x53025a[_0x2c4c4f(0x182)][0x0][_0x2c4c4f(0x293)]:![];_0x532793['mode']=_0x2f4bfc?'auto':_0x2c4c4f(0x240),_0x532793[_0x2c4c4f(0x218)]=_0x53025a?_0x53025a[_0x2c4c4f(0x182)][0x0]['botname']:'Bot\x20'+_0x7c6584,_0x532793[_0x2c4c4f(0xec)]=_0x53025a?_0x53025a['bot'][0x0][_0x2c4c4f(0xec)]:![];}catch(_0xb17bb4){_0x532793['mode']=_0x2c4c4f(0x240),_0x532793[_0x2c4c4f(0x218)]=_0x2c4c4f(0xe2)+_0x7c6584,_0x532793['showname']=![];}}else _0x532793[_0x2c4c4f(0x25d)]=_0x2c4c4f(0x240),_0x532793['botname']='Bot\x20'+_0x7c6584,_0x532793[_0x2c4c4f(0xec)]=![];return _0x532793;}function getBotsWithMode(){const _0x24f8d3=_0x49797c,_0x1778c4=dbConfig[_0x24f8d3(0x246)](_0x24f8d3(0x27f))[_0x24f8d3(0x120)](_0x24f8d3(0x225))['value']()||[];return _0x1778c4['forEach'](_0x93c1ef=>{const _0x6a867f=_0x24f8d3;let _0x4865e7=getBotAttributes(_0x93c1ef[_0x6a867f(0x225)]);_0x93c1ef['mode']=_0x4865e7[_0x6a867f(0x25d)];}),_0x1778c4;}function getBotExchanges(){const _0x5e1bfd=_0x49797c;let _0x38e728=[];const _0x43e039=dbConfig[_0x5e1bfd(0x246)](_0x5e1bfd(0x27f))[_0x5e1bfd(0x120)](_0x5e1bfd(0x225))[_0x5e1bfd(0x247)]()||[];_0x43e039['forEach'](_0x5b5115=>{const _0x14dafe=_0x5e1bfd;if(_0x5b5115[_0x14dafe(0x1fb)]=='enabled'){const _0x4ec1f1=configpath+_0x14dafe(0x2e3)+_0x5b5115[_0x14dafe(0x225)]+_0x14dafe(0x1d2),_0xcb07c1=fs[_0x14dafe(0x1d3)](_0x4ec1f1);let _0x288e22;if(_0xcb07c1){const _0x30bd33=fs[_0x14dafe(0x1dc)](_0x4ec1f1);try{const _0x4e9af8=JSON[_0x14dafe(0x186)](_0x30bd33);_0x288e22=_0x4e9af8?_0x4e9af8[_0x14dafe(0x182)][0x0][_0x14dafe(0x1eb)]:null;}catch(_0x5428c0){}}if(_0x288e22)_0x38e728[_0x14dafe(0x2ba)](_0x288e22);}});const _0x13bd35=[...new Set(_0x38e728)][_0x5e1bfd(0x133)]();return _0x13bd35;}async function initUser(){const _0x5d5dc9=_0x49797c;if(!settings[_0x5d5dc9(0x11d)]){const _0x15f1f9=uuidRandom();mixpanel[_0x5d5dc9(0x108)](_0x15f1f9),updateSetting('userid',_0x15f1f9);}}async function initSecure(){const _0x574e24=_0x49797c;let _0x39dc9e=getSecure();if(!_0x39dc9e[_0x574e24(0x22c)](_0x574e24(0x275))){let _0x82481d=await generateKeys();_0x39dc9e['publicKey']=_0x82481d['publicKey'],_0x39dc9e[_0x574e24(0x259)]=_0x82481d[_0x574e24(0x259)],_0x39dc9e[_0x574e24(0x275)]=crypto[_0x574e24(0x12c)](0x20)[_0x574e24(0x22b)](_0x574e24(0x202));;storeSecure(_0x39dc9e);}}function getSettings(){const _0x11e74c=_0x49797c;return dbSettings[_0x11e74c(0x246)](_0x11e74c(0x156))[_0x11e74c(0x247)]()||{};}function getSecure(){const _0x3f8d6d=_0x49797c;return dbSecure[_0x3f8d6d(0x246)](_0x3f8d6d(0x1fe))[_0x3f8d6d(0x247)]()||{};}function getBlacklist(){const _0x5d21ee=_0x49797c;return dbSecure[_0x5d21ee(0x246)]('blacklist')[_0x5d21ee(0x247)]()||[];}function broadcastToBots(_0x5bfecc,_0x5ec2ca){const _0xbcc38b=_0x49797c;config[_0xbcc38b(0x114)](_0x574018=>{const _0x372e56=_0xbcc38b;if(_0x574018[_0x372e56(0x1fb)]=='enabled'&&_0x574018[_0x372e56(0x2d0)]=='running'||_0x574018[_0x372e56(0x1fb)]==_0x372e56(0xeb)&&_0x574018[_0x372e56(0x2d0)]==_0x372e56(0x2aa)){if(pid[_0x574018[_0x372e56(0x225)]])pid[_0x574018[_0x372e56(0x225)]]['send']({[_0x5bfecc]:_0x5ec2ca});}});}async function storeSettings(_0xcc6ace,_0x5a1451=![]){const _0x1cdbdc=_0x49797c;_0xcc6ace={...settings,..._0xcc6ace};if(_0x5a1451&&_0xcc6ace[_0x1cdbdc(0x1d9)]!=_0x1cdbdc(0x262)&&_0xcc6ace[_0x1cdbdc(0x1d9)]!=_0x1cdbdc(0x244)&&_0xcc6ace['bbPassword']!=''){const _0x11e83e=decryptRSA(secure[_0x1cdbdc(0x259)],_0xcc6ace[_0x1cdbdc(0x1d9)])[_0x1cdbdc(0x121)](_0x1cdbdc(0x245))[0x0],_0x188d18=bcrypt[_0x1cdbdc(0x1a8)](_0x11e83e,saltRounds);_0xcc6ace={..._0xcc6ace,'bbPassword':_0x188d18};}if(_0x5a1451&&_0xcc6ace[_0x1cdbdc(0x142)]!=_0x1cdbdc(0x262)&&_0xcc6ace[_0x1cdbdc(0x142)]!=_0x1cdbdc(0x244)&&_0xcc6ace['telegramToken']!=''){const _0x4f96d6=decryptRSA(secure['privateKey'],_0xcc6ace[_0x1cdbdc(0x142)])[_0x1cdbdc(0x121)](_0x1cdbdc(0x245))[0x0];_0xcc6ace={..._0xcc6ace,'telegramToken':_0x4f96d6};}if(_0x5a1451&&_0xcc6ace['marketcapApi']!=_0x1cdbdc(0x262)&&_0xcc6ace[_0x1cdbdc(0x28e)]!=_0x1cdbdc(0x244)&&_0xcc6ace[_0x1cdbdc(0x28e)]!=''){const _0x4ee2cf=decryptRSA(secure[_0x1cdbdc(0x259)],_0xcc6ace[_0x1cdbdc(0x28e)])['split'](_0x1cdbdc(0x245))[0x0];_0xcc6ace={..._0xcc6ace,'marketcapApi':_0x4ee2cf};}const _0x1666c6=_0xcc6ace['telegramToken']!='************'&&_0xcc6ace[_0x1cdbdc(0x142)]!=settings[_0x1cdbdc(0x142)]||_0xcc6ace[_0x1cdbdc(0x1c2)]!=settings[_0x1cdbdc(0x1c2)],_0x563081=_0xcc6ace[_0x1cdbdc(0x142)]==''||_0xcc6ace[_0x1cdbdc(0x1c2)]=='',_0x21338d=_0xcc6ace[_0x1cdbdc(0x28e)]&&_0xcc6ace[_0x1cdbdc(0x28e)]!=_0x1cdbdc(0x262)&&_0xcc6ace[_0x1cdbdc(0x28e)]!=settings[_0x1cdbdc(0x28e)];_0x1666c6&&(_0xcc6ace[_0x1cdbdc(0x2ab)]=null,_0xcc6ace[_0x1cdbdc(0x1ef)]='all');for(const [_0x345db4,_0x556af5]of Object[_0x1cdbdc(0x212)](_0xcc6ace)){if(_0x345db4==_0x1cdbdc(0x142)&&_0x556af5==_0x1cdbdc(0x262)){_0xcc6ace[_0x1cdbdc(0x142)]=settings[_0x1cdbdc(0x142)];continue;};if(_0x345db4=='bbPassword'&&_0x556af5=='************'){_0xcc6ace['bbPassword']=settings[_0x1cdbdc(0x1d9)];continue;};if(_0x345db4==_0x1cdbdc(0x28e)&&_0x556af5==_0x1cdbdc(0x262)){_0xcc6ace[_0x1cdbdc(0x28e)]=settings['marketcapApi'];continue;};dbSettings[_0x1cdbdc(0x2a2)](_0x1cdbdc(0x2d3)+_0x345db4,_0x556af5)[_0x1cdbdc(0x2bb)]();}settings=_0xcc6ace,io['to'](_0x1cdbdc(0x2ca))[_0x1cdbdc(0x1a6)](_0x1cdbdc(0x156),cleanSettings()),broadcastToBots('timeshift',settings[_0x1cdbdc(0xd7)]),broadcastToBots(_0x1cdbdc(0x1af),settings[_0x1cdbdc(0x1af)]),broadcastToBots(_0x1cdbdc(0x28e),settings[_0x1cdbdc(0x28e)]);if(_0x1666c6&&!_0x563081)initTelegram();_0x1666c6&&_0x563081&&(updateSetting(_0x1cdbdc(0x2ab),null),disableTelegram()),getAllClients()[_0x1cdbdc(0x114)](_0x2b633e=>{const _0x5ae860=_0x1cdbdc;getSocket(_0x2b633e['id'])[_0x5ae860(0x1a6)](_0x5ae860(0x1fb),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x21338d&&(await sleep(0xbb8),testMarketcapApi(_0xcc6ace[_0x1cdbdc(0x28e)]));}async function testMarketcapApi(_0x4c618c){const _0x4b296d=_0x49797c,_0x3ad3c8=[_0x4b296d(0x1c1),_0x4b296d(0x1c8)];try{await axios[_0x4b296d(0x246)](_0x4b296d(0x1bb),{'headers':{'X-CMC_PRO_API_KEY':_0x4c618c},'params':{'symbol':_0x3ad3c8['toString']()}});}catch(_0x29e40d){_0x29e40d[_0x4b296d(0x22b)]()[_0x4b296d(0x11f)](_0x4b296d(0x29f))?(io['to'](_0x4b296d(0x2ca))[_0x4b296d(0x1a6)](_0x4b296d(0xf0),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x4b296d(0x2cc)](_0x4b296d(0x2b2))):(io['to'](_0x4b296d(0x2ca))['emit'](_0x4b296d(0xf0),_0x4b296d(0x1db)),logger['full'](_0x4b296d(0x1db)),logger[_0x4b296d(0xfa)](_0x4b296d(0x25c),_0x29e40d[_0x4b296d(0x22b)]()+'\x20-\x20'+_0x29e40d['code']));return;}logger[_0x4b296d(0xfa)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x106c43,_0x1056cf){const _0x53d614=_0x49797c;dbSettings[_0x53d614(0x2a2)]('settings.'+_0x106c43,_0x1056cf)[_0x53d614(0x2bb)](),settings=getSettings(),io['to']('botmanager')[_0x53d614(0x1a6)](_0x53d614(0x156),cleanSettings());}function storeSecure(_0xd00248){const _0xdb967e=_0x49797c;dbSecure['get']('secure')[_0xdb967e(0x2ba)](_0xd00248)[_0xdb967e(0x2bb)](),secure=_0xd00248;}function addBlacklist(_0x335b1a){const _0x35b19d=_0x49797c;cleanBlacklist();let _0x37d532;devices[_0x335b1a][_0x35b19d(0xd6)]?_0x37d532=Math[_0x35b19d(0x20a)](devices[_0x335b1a][_0x35b19d(0xd6)][_0x35b19d(0x104)],loginExpiry):_0x37d532=loginExpiry,dbSecure[_0x35b19d(0x246)]('blacklist')['push']({'expiry':new Date()[_0x35b19d(0x2bc)]()+_0x37d532*0x3c*0x3e8,'token':devices[_0x335b1a]['access'][_0x35b19d(0x1fa)]})[_0x35b19d(0x2bb)](),blacklist=dbSecure[_0x35b19d(0x246)]('blacklist')['value']();}function cleanBlacklist(){const _0x1215f9=_0x49797c;let _0x1efe17=dbSecure[_0x1215f9(0x246)](_0x1215f9(0x2e0))[_0x1215f9(0x26e)]()[_0x1215f9(0x247)](),_0x933fd6=new Date()['getTime']();_0x1efe17[_0x1215f9(0x114)](_0x345364=>{const _0x30dde2=_0x1215f9;_0x345364[_0x30dde2(0x104)]<_0x933fd6&&dbSecure[_0x30dde2(0x246)]('blacklist')[_0x30dde2(0x1a5)]({'expiry':_0x345364['expiry']})['write']();});}function initStates(){const _0x587078=_0x49797c;let _0x4132e4=getConfiguration();_0x4132e4[_0x587078(0x114)](_0x44996b=>{const _0x3b56e9=_0x587078;_0x44996b['live']=_0x3b56e9(0x207);}),storeConfiguration(_0x4132e4);}async function generateKeys(){const _0x4fa40b=_0x49797c,_0x2c369e=forge['pki'][_0x4fa40b(0x106)][_0x4fa40b(0x1c0)]({'bits':0x1000,'e':0x10001}),_0x453b42=forge[_0x4fa40b(0x19b)][_0x4fa40b(0xdc)](_0x2c369e['privateKey']),_0xde7609=forge[_0x4fa40b(0x19b)][_0x4fa40b(0x298)](_0x2c369e['publicKey']);return{'privateKey':_0x453b42,'publicKey':_0xde7609};}async function oneTimeMigration(){const _0x4a5d8e=_0x49797c;let _0x5527f0=getSettings(),_0x7d3b86=![];!_0x5527f0[_0x4a5d8e(0x22c)]('lastmsgtelegram')&&(_0x5527f0[_0x4a5d8e(0x1ea)]=0x0,_0x7d3b86=!![]);!_0x5527f0['hasOwnProperty'](_0x4a5d8e(0x1ed))&&(_0x5527f0['lastmsgemitted']=0x0,_0x7d3b86=!![]);!_0x5527f0[_0x4a5d8e(0x22c)](_0x4a5d8e(0x289))&&(_0x5527f0['latestversion']=_0x4a5d8e(0x148),_0x7d3b86=!![]);!_0x5527f0[_0x4a5d8e(0x22c)](_0x4a5d8e(0x1af))&&(_0x5527f0[_0x4a5d8e(0x1af)]=![],_0x7d3b86=!![]);!_0x5527f0[_0x4a5d8e(0x22c)](_0x4a5d8e(0x28e))&&(_0x5527f0[_0x4a5d8e(0x28e)]='',_0x7d3b86=!![]);if(_0x7d3b86)storeSettings(_0x5527f0);try{fs[_0x4a5d8e(0x1d7)](configbackuppath,{'withFileTypes':!![]})[_0x4a5d8e(0x114)](_0x1d98a2=>{const _0xf5c7d0=_0x4a5d8e;if(!_0x1d98a2[_0xf5c7d0(0x1a1)]()){if(!_0x1d98a2[_0xf5c7d0(0x238)][_0xf5c7d0(0x13a)](_0xf5c7d0(0x1c7)))fs['unlinkSync'](configbackuppath+_0x1d98a2['name']);}else fs[_0xf5c7d0(0x1d4)](configbackuppath+_0x1d98a2['name'],{'recursive':!![]});});}catch(_0x589f8e){logger[_0x4a5d8e(0xfa)](_0x4a5d8e(0xd8),_0x589f8e);}}function storeConfiguration(_0x225259){const _0x38426c=_0x49797c;dbConfig[_0x38426c(0x246)](_0x38426c(0x27f))[_0x38426c(0x1a5)]()[_0x38426c(0x2bb)](),dbConfig[_0x38426c(0x246)](_0x38426c(0x27f))[_0x38426c(0x2ba)](..._0x225259)[_0x38426c(0x2bb)](),config=_0x225259;}async function resetPassword(){const _0x45f7c7=_0x49797c;if(tgBot&&settings[_0x45f7c7(0x2ab)]){const _0x207e8e=Markup['inlineKeyboard']([Markup[_0x45f7c7(0x2ea)][_0x45f7c7(0x20e)]('yes',_0x45f7c7(0x1cd)),Markup[_0x45f7c7(0x2ea)][_0x45f7c7(0x20e)]('no','resetpw_no')]);await sendTelegram(settings[_0x45f7c7(0x2ab)],_0x45f7c7(0x146),_0x207e8e),tgBot[_0x45f7c7(0x21f)](/resetpw_(.+)/,async _0x140b84=>{const _0x240569=_0x45f7c7,_0xf35642=_0x140b84[_0x240569(0x243)][0x1];_0x140b84[_0x240569(0x222)]();if(_0xf35642!='no'){const _0x47fbdd=0xf,_0x16c6a2=_0x240569(0x149),_0x6439a3=Array[_0x240569(0x239)](crypto[_0x240569(0x177)](new Uint32Array(_0x47fbdd)))['map'](_0x26d126=>_0x16c6a2[_0x26d126%_0x16c6a2[_0x240569(0xee)]])[_0x240569(0x2e7)](''),_0x51b0cf=bcrypt['hashSync'](_0x6439a3,saltRounds);storeSettings({'bbPassword':_0x51b0cf}),await sendTelegram(_0x140b84[_0x240569(0xfc)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x6439a3,{'parse_mode':_0x240569(0x154)});}else await sendTelegram(_0x140b84[_0x240569(0xfc)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x2ae611,_0x3f899f){const _0x4c76dc=_0x49797c;io['to'](_0x4c76dc(0x2ca))[_0x4c76dc(0x1a6)](_0x4c76dc(0xf0),_0x4c76dc(0x107),_0x4c76dc(0x150));if(tgBot&&settings['telegramChatId']){const _0x5c3f4e=uuidRandom();tmpStorage[_0x5c3f4e]={'path':_0x2ae611,'filename':_0x3f899f};const _0x4678b2=Markup[_0x4c76dc(0x175)]([Markup[_0x4c76dc(0x2ea)][_0x4c76dc(0x20e)](_0x4c76dc(0x223),_0x4c76dc(0x1cb)+_0x5c3f4e),Markup[_0x4c76dc(0x2ea)]['callback']('no',_0x4c76dc(0x192)+_0x5c3f4e)]);await sendTelegram(settings[_0x4c76dc(0x2ab)],_0x4c76dc(0x10f),_0x4678b2),tgBot[_0x4c76dc(0x21f)](/restore_(.+)_(.+)/,async _0x57fb1c=>{const _0x5206fe=_0x4c76dc,_0x42b8b0=_0x57fb1c[_0x5206fe(0x243)][0x1],_0x2c1216=_0x57fb1c[_0x5206fe(0x243)][0x2],{path:_0x1e3db1,filename:_0x4d3d6a}=tmpStorage[_0x2c1216];delete tmpStorage[_0x2c1216],_0x57fb1c[_0x5206fe(0x222)](),_0x42b8b0==_0x5206fe(0x223)?(logger[_0x5206fe(0xfa)](_0x5206fe(0x288)),await sendTelegram(_0x57fb1c[_0x5206fe(0xfc)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x5206fe(0x154)}),unzipFile(_0x1e3db1,_0x4d3d6a)):(logger[_0x5206fe(0xfa)](_0x5206fe(0x28f)),await sendTelegram(_0x57fb1c[_0x5206fe(0xfc)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x5412b5=_0x49797c,_0x304e85=new Date();return _0x304e85[_0x5412b5(0xf5)]()+'/'+(_0x304e85['getMonth']()+0x1)[_0x5412b5(0x22b)]()[_0x5412b5(0x283)](0x2,'0')+'/'+_0x304e85['getDate']()[_0x5412b5(0x22b)]()[_0x5412b5(0x283)](0x2,'0')+'\x20'+_0x304e85[_0x5412b5(0xd4)]()[_0x5412b5(0x22b)]()[_0x5412b5(0x283)](0x2,'0')+':'+_0x304e85[_0x5412b5(0x1a2)]()[_0x5412b5(0x22b)]()[_0x5412b5(0x283)](0x2,'0')+':'+_0x304e85[_0x5412b5(0x295)]()[_0x5412b5(0x22b)]()[_0x5412b5(0x283)](0x2,'0');}function getTimeStamp(){const _0x2c456c=_0x49797c,_0x1d11eb=shiftedTime();return _0x1d11eb['getFullYear']()+'/'+(_0x1d11eb[_0x2c456c(0x188)]()+0x1)[_0x2c456c(0x22b)]()[_0x2c456c(0x283)](0x2,'0')+'/'+_0x1d11eb[_0x2c456c(0x203)]()[_0x2c456c(0x22b)]()[_0x2c456c(0x283)](0x2,'0')+'\x20'+_0x1d11eb['getHours']()[_0x2c456c(0x22b)]()[_0x2c456c(0x283)](0x2,'0')+':'+_0x1d11eb['getMinutes']()['toString']()[_0x2c456c(0x283)](0x2,'0')+':'+_0x1d11eb[_0x2c456c(0x295)]()[_0x2c456c(0x22b)]()[_0x2c456c(0x283)](0x2,'0');}function getCleanTimeStamp(){const _0x13e7ce=_0x49797c,_0x22c435=shiftedTime();return _0x22c435['getFullYear']()+(_0x22c435['getMonth']()+0x1)[_0x13e7ce(0x22b)]()[_0x13e7ce(0x283)](0x2,'0')+_0x22c435[_0x13e7ce(0x203)]()[_0x13e7ce(0x22b)]()[_0x13e7ce(0x283)](0x2,'0')+'-'+_0x22c435[_0x13e7ce(0xd4)]()[_0x13e7ce(0x22b)]()[_0x13e7ce(0x283)](0x2,'0')+_0x22c435[_0x13e7ce(0x1a2)]()[_0x13e7ce(0x22b)]()[_0x13e7ce(0x283)](0x2,'0')+_0x22c435[_0x13e7ce(0x295)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x3bfd74=_0x49797c,_0x5ca1ee=new Date();let _0x196bd8=_0x5ca1ee;if(settings[_0x3bfd74(0xd7)]&&settings['timeshift']!==0x0)_0x196bd8=fns[_0x3bfd74(0x273)](_0x5ca1ee,{'hours':settings[_0x3bfd74(0xd7)]});return _0x196bd8;}async function startScheduler(){const _0x5013c7=_0x49797c,_0x4b4038=new Date()[_0x5013c7(0x190)](),_0x52db22=shiftedTime()[_0x5013c7(0xd4)]();_0x52db22==0x4&&backupConfigFiles(),_0x52db22==0x0&&(rotateLogFiles(),logger[_0x5013c7(0xfa)](_0x5013c7(0x18a)),logger['debug']('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x5013c7(0x12f)+(environment==_0x5013c7(0x1f6)?_0x5013c7(0x23f):'')),logger[_0x5013c7(0xfa)]('--------------------------------------')),_0x4b4038%0x6==0x0&&triggerAnalytics(),_0x4b4038%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x56e69c){const _0x267afc=_0x49797c;logger[_0x267afc(0xfa)](_0x267afc(0xd0)+_0x56e69c);const _0x55a914=getBotsWithMode();_0x55a914[_0x267afc(0xee)]>0x0?confirmRestore(configbackuppath,_0x56e69c):unzipFile(configbackuppath,_0x56e69c);}function _0x3612(_0xf79d5,_0x17f0b5){const _0x4fc528=_0x2b5a();return _0x3612=function(_0x23d4eb,_0x38dba9){_0x23d4eb=_0x23d4eb-0xcb;let _0x2b5a09=_0x4fc528[_0x23d4eb];return _0x2b5a09;},_0x3612(_0xf79d5,_0x17f0b5);}async function getBackupFiles(_0xa043b3=null){const _0x417359=_0x49797c;let _0x5c1ddb=[],_0x4ecb84=fs[_0x417359(0x1d7)](configbackuppath,{'withFileTypes':!![]});_0x4ecb84[_0x417359(0x133)]((_0x3cacdb,_0x6fa588)=>_0x3cacdb['name']<_0x6fa588[_0x417359(0x238)]?0x1:_0x6fa588[_0x417359(0x238)]<_0x3cacdb['name']?-0x1:0x0),_0x4ecb84[_0x417359(0x114)](_0x4cab97=>{const _0xa710ab=_0x417359;if(!_0x4cab97[_0xa710ab(0x1a1)]()&&_0x4cab97[_0xa710ab(0x238)][_0xa710ab(0x13a)](_0xa710ab(0x1c7))&&_0x4cab97['name']['endsWith'](_0xa710ab(0x118))){const _0x2c8c1c=formatDate(fs[_0xa710ab(0x1f5)](configbackuppath+_0x4cab97[_0xa710ab(0x238)])['mtime']);_0x5c1ddb[_0xa710ab(0x2ba)]({'name':_0x4cab97[_0xa710ab(0x238)],'mtime':_0x2c8c1c});}});if(_0xa043b3)io['to'](_0xa043b3)[_0x417359(0x1a6)]('backup-files',_0x5c1ddb);else return _0x5c1ddb;}async function backupConfigFiles(){const _0x3d9394=_0x49797c;await zipFiles(_0x3d9394(0x1b8));const _0x284075=getCleanTimeStamp();fs['copyFileSync'](zippath+'backup-full.zip',configbackuppath+(_0x3d9394(0x1c7)+_0x284075+_0x3d9394(0x118)));let _0x53358c=fs[_0x3d9394(0x1d7)](configbackuppath,{'withFileTypes':!![]});_0x53358c[_0x3d9394(0x133)]((_0x6f0f20,_0x1c4e58)=>_0x6f0f20[_0x3d9394(0x238)]<_0x1c4e58['name']?0x1:_0x1c4e58[_0x3d9394(0x238)]<_0x6f0f20[_0x3d9394(0x238)]?-0x1:0x0),_0x53358c['length']>maxBackups&&fs[_0x3d9394(0x22d)](configbackuppath+_0x53358c[_0x53358c[_0x3d9394(0xee)]-0x1][_0x3d9394(0x238)]);}function rotateLogFiles(){const _0x53de7c=_0x49797c,_0x56b639=fs[_0x53de7c(0x1f5)](logspath+_0x53de7c(0x281)),_0x4eed62=_0x56b639['size']/0x400;if(_0x4eed62>0x64){let _0x38b417=fs[_0x53de7c(0x1d7)](logspath,{'withFileTypes':!![]});_0x38b417[_0x53de7c(0x133)]((_0x18105d,_0x57ce6f)=>_0x18105d[_0x53de7c(0x238)]<_0x57ce6f[_0x53de7c(0x238)]?0x1:_0x57ce6f[_0x53de7c(0x238)]<_0x18105d['name']?-0x1:0x0),_0x38b417[_0x53de7c(0x114)](_0x110496=>{const _0x4b878d=_0x53de7c;if(_0x110496[_0x4b878d(0x238)]==_0x4b878d(0x194))fs[_0x4b878d(0x251)](logspath+_0x110496[_0x4b878d(0x238)],logspath+_0x4b878d(0x1e2));if(_0x110496[_0x4b878d(0x238)]==_0x4b878d(0xe1))fs[_0x4b878d(0x251)](logspath+_0x110496[_0x4b878d(0x238)],logspath+_0x4b878d(0x194));_0x110496[_0x4b878d(0x238)]==_0x4b878d(0x281)&&(fs[_0x4b878d(0x251)](logspath+_0x110496['name'],logspath+'output-001.log'),fs[_0x4b878d(0x29d)](logspath+_0x110496[_0x4b878d(0x238)],''));});}}async function zipFiles(_0xfe65da){const _0x53b050=_0x49797c;let _0x2ec6b2;if(_0xfe65da==_0x53b050(0x220))_0x2ec6b2=logspath;if(_0xfe65da==_0x53b050(0x2e6))_0x2ec6b2=configpath;if(_0xfe65da==_0x53b050(0x1b8))_0x2ec6b2=configpath;let _0x5562c4=fs[_0x53b050(0x1d7)](_0x2ec6b2,{'withFileTypes':!![]});const _0x47f243=new JSZip();_0x5562c4[_0x53b050(0x114)](_0x304833=>{const _0x3c4afb=_0x53b050;if(!_0x304833[_0x3c4afb(0x1a1)]()){let _0x3ddb77=fs['readFileSync'](_0x2ec6b2+_0x304833[_0x3c4afb(0x238)]);if(_0xfe65da==_0x3c4afb(0x2e6)){const _0x2f77a0=/^bot-[0-9]{3}-config.json$/,_0x51b722=_0x2f77a0[_0x3c4afb(0x14e)](_0x304833['name']);if(_0x51b722){const _0x1682e5=JSON[_0x3c4afb(0x186)](_0x3ddb77);if(_0x1682e5[_0x3c4afb(0x182)][0x0]){_0x1682e5[_0x3c4afb(0x182)][0x0][_0x3c4afb(0x138)]=_0x3c4afb(0x244),_0x1682e5[_0x3c4afb(0x182)][0x0]['apiSecret']=_0x3c4afb(0x244);if(_0x1682e5[_0x3c4afb(0x182)][0x0]['apiPassword'])_0x1682e5[_0x3c4afb(0x182)][0x0][_0x3c4afb(0x1b1)]=_0x3c4afb(0x244);}_0x3ddb77=JSON['stringify'](_0x1682e5,null,0x2);}if(_0x304833[_0x3c4afb(0x238)]==_0x3c4afb(0x10e)){const _0x5816f1=JSON['parse'](_0x3ddb77);if(_0x5816f1[_0x3c4afb(0x156)][_0x3c4afb(0x17c)])_0x5816f1[_0x3c4afb(0x156)][_0x3c4afb(0x17c)]=![];if(_0x5816f1[_0x3c4afb(0x156)][_0x3c4afb(0x1d9)])_0x5816f1[_0x3c4afb(0x156)][_0x3c4afb(0x1d9)]='***';if(_0x5816f1[_0x3c4afb(0x156)][_0x3c4afb(0x142)])_0x5816f1[_0x3c4afb(0x156)][_0x3c4afb(0x142)]=_0x3c4afb(0x244);if(_0x5816f1['settings'][_0x3c4afb(0x2ab)])_0x5816f1['settings'][_0x3c4afb(0x2ab)]=null;if(_0x5816f1[_0x3c4afb(0x156)][_0x3c4afb(0x28e)])_0x5816f1[_0x3c4afb(0x156)][_0x3c4afb(0x28e)]=_0x3c4afb(0x244);_0x3ddb77=JSON[_0x3c4afb(0x1bc)](_0x5816f1,null,0x2);}if(_0x304833[_0x3c4afb(0x238)]!=_0x3c4afb(0x1cc))_0x47f243[_0x3c4afb(0x13b)](_0x304833[_0x3c4afb(0x238)],_0x3ddb77);}else _0x47f243['file'](_0x304833[_0x3c4afb(0x238)],_0x3ddb77);}});const _0x691e5=await _0x47f243['generateAsync']({'type':'string','base64':![],'compression':_0x53b050(0x25f)});fs['writeFileSync'](zippath+(_0xfe65da+'.zip'),_0x691e5,_0x53b050(0x189));}async function unzipFile(_0x1fa9ae,_0x3fc47a){const _0x5f4386=_0x49797c;fs['readdirSync'](configpath,{'withFileTypes':!![]})['forEach'](_0x51ea25=>{const _0x4f0a4f=_0x3612;if(!_0x51ea25['isDirectory']())fs[_0x4f0a4f(0x1d4)](configpath+_0x51ea25[_0x4f0a4f(0x238)]);});const _0x4a2fb5=fs['readFileSync'](_0x1fa9ae+_0x3fc47a,'binary'),_0x2938e2=await JSZip['loadAsync'](_0x4a2fb5,{'base64':![],'checkCRC32':!![]});for(const _0x99ca10 of Object[_0x5f4386(0x113)](_0x2938e2[_0x5f4386(0x26a)])){const _0x250b4b=_0x2938e2[_0x5f4386(0x26a)][_0x99ca10],_0x3a506e=await _0x250b4b['async'](_0x5f4386(0x234));fs['writeFileSync'](configpath+_0x250b4b[_0x5f4386(0x238)],_0x3a506e);}fs[_0x5f4386(0x1d7)](temppath,{'withFileTypes':!![]})[_0x5f4386(0x114)](_0x5b8f87=>{const _0x573a7a=_0x5f4386;if(!_0x5b8f87[_0x573a7a(0x1a1)]())fs[_0x573a7a(0x1d4)](temppath+_0x5b8f87[_0x573a7a(0x238)]);}),logger['debug']('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x5f4386(0x15b)]({'restore':!![]},_0x4dc703=>{});}async function getPublicIp(){const _0x20ca77=_0x49797c;try{const _0x49fd8f=await axios[_0x20ca77(0x246)](_0x20ca77(0x1b5));publicip=_0x49fd8f[_0x20ca77(0x1ee)]['ip'];}catch(_0xb01900){}}async function triggerAnalytics(){const _0x1bcb8d=_0x49797c;if(!publicip)await getPublicIp();const _0x4223a0=getBotsWithMode();let _0x1e4b8d=0x0;_0x4223a0[_0x1bcb8d(0x114)](_0x5b95a2=>{const _0x456326=_0x1bcb8d;if(_0x5b95a2[_0x456326(0x1fb)]==='enabled')_0x1e4b8d++;});const _0x64a3dc=getBotExchanges();mixpanel[_0x1bcb8d(0x2d1)](_0x1bcb8d(0xfe),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x4223a0['length'],'numbotsenabled':_0x1e4b8d,'exchanges':_0x64a3dc,'environment':environment});}async function getMessages(){const _0x48b290=_0x49797c,_0x29b1de='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x3c34d4=new GraphQLClient(_0x29b1de),_0x237a26={'authorization':_0x48b290(0x1aa)},_0x279e1a=serverversion['split']('.'),_0x5d9b2a=_0x279e1a[0x0]+'.'+_0x279e1a[0x1],_0x552239=Math[_0x48b290(0x2a8)](settings['lastmsgtelegram'],settings['lastmsgemitted']),_0x2d3b7d={'last':parseInt(_0x552239),'bbm':_0x5d9b2a},_0x456bc3=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x56ed75;try{_0x56ed75=await _0x3c34d4['request'](_0x456bc3,_0x2d3b7d,_0x237a26);}catch(_0x333f04){}if(_0x56ed75&&_0x56ed75['messages']){let _0x5e1810=settings[_0x48b290(0x1ea)],_0x657f3e=settings[_0x48b290(0x1ea)];newMessages=[];for(const _0x93387e of _0x56ed75[_0x48b290(0x2eb)]){newMessages[_0x48b290(0x2ba)](_0x93387e);let _0x3bb7b2=![];_0x93387e[_0x48b290(0x250)]&&(updateSetting(_0x48b290(0x289),_0x93387e[_0x48b290(0x250)]),_0x3bb7b2=isNewerVersion(serverversion,_0x93387e[_0x48b290(0x250)])||serverversion==_0x93387e[_0x48b290(0x250)]);if(!_0x3bb7b2&&_0x93387e['number']>_0x5e1810){if(_0x93387e[_0x48b290(0x199)]===_0x48b290(0xed)||serverversion[_0x48b290(0x13a)](_0x93387e['bbvReceive'])){let _0x5f091e=''+_0x93387e[_0x48b290(0x241)]+'\x0a\x0a'+_0x93387e[_0x48b290(0x15e)];const _0x57d361=await sendTelegramMsg(toTelegramMarkdown(_0x5f091e),_0x48b290(0x2bf));_0x5e1810=_0x93387e[_0x48b290(0x2b5)];}}_0x657f3e=_0x93387e[_0x48b290(0x2b5)];}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x48b290(0x1ea),_0x657f3e),emitMessages();}}function emitMessages(){const _0x9c8341=_0x49797c,_0x4e0ec3=settings['lastmsgemitted'];let _0x2680df=[];newMessages[_0x9c8341(0x114)](_0x332c7c=>{const _0x163384=_0x9c8341;_0x332c7c[_0x163384(0x2b5)]>_0x4e0ec3&&_0x2680df[_0x163384(0x2ba)](_0x332c7c);}),_0x2680df[_0x9c8341(0xee)]>0x0&&getAllClients()[_0x9c8341(0x114)](_0x53b16a=>{const _0x3b9e57=_0x9c8341;getSocket(_0x53b16a['id'])[_0x3b9e57(0x1a6)](_0x3b9e57(0x15e),_0x2680df);});}function confirmMessage(_0x3a224a){const _0x507b1b=_0x49797c;updateSetting(_0x507b1b(0x1ed),Number(_0x3a224a));}function isNewerVersion(_0x1b3545,_0x515be2){const _0xa04a2d=_0x49797c,_0xd7b2e=_0x515be2[_0xa04a2d(0x121)]('.'),_0x3b6288=_0x1b3545['split']('.');for(var _0x1d2a82=0x0;_0x1d2a82<_0x3b6288[_0xa04a2d(0xee)];_0x1d2a82++){const _0x128e7f=~~_0x3b6288[_0x1d2a82],_0x34c61b=~~_0xd7b2e[_0x1d2a82];if(_0x128e7f>_0x34c61b)return!![];if(_0x128e7f<_0x34c61b)return![];}return![];}function toTelegramMarkdown(_0x2efb1a){const _0x309e06=_0x49797c,_0x38dfa1=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xedfdde=/\*{2}(.+?)\*{2}/gim;return _0x2efb1a=_0x2efb1a[_0x309e06(0x1e7)](_0x38dfa1,_0x309e06(0x127))[_0x309e06(0x1e7)](_0xedfdde,_0x309e06(0xff)),_0x2efb1a;}async function validateConfigFile(){const _0x144737=_0x49797c,_0x4bec39=dbConfig['get']('bots')['sortBy'](_0x144737(0x225))['value']()||[];if(_0x4bec39[_0x144737(0xee)]==0x0){let _0x57b5d4=0x0,_0x2fa169=[];const _0x103600=/^bot-([0-9]{3})-config.json$/,_0x52e279=fs[_0x144737(0x1d7)](configpath);_0x52e279[_0x144737(0x114)](_0xc70fa=>{const _0x88bc3e=_0x144737,_0x1480e5=_0x103600[_0x88bc3e(0x2d4)](_0xc70fa);if(_0x1480e5){const _0x683384=_0x1480e5[0x1];let _0x46fdcd=getBotAttributes(_0x683384);_0x2fa169[_0x88bc3e(0x2ba)]({'botID':_0x683384,'botname':_0x46fdcd[_0x88bc3e(0x218)],'status':_0x88bc3e(0x232),'live':'stopped'}),_0x57b5d4++;}}),_0x57b5d4!=0x0&&(dbConfig[_0x144737(0x246)](_0x144737(0x27f))[_0x144737(0x267)](_0x2fa169)[_0x144737(0x2bb)](),config=_0x2fa169,restoredConfigFile=_0x57b5d4);}}async function restoreConfigNotify(_0x15ecb5){const _0x149050=_0x49797c;let _0x317776;if(restoredConfigFile==0x1)_0x317776=_0x149050(0x1e1);else _0x317776=_0x149050(0x26c);if(_0x15ecb5)io['to'](_0x149050(0x2ca))[_0x149050(0x1a6)](_0x149050(0xf0),_0x317776);else{logger['simple'](_0x149050(0x119)),logger[_0x149050(0x2be)](_0x317776),logger[_0x149050(0x2be)]('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings[_0x149050(0x2ab)]&&settings[_0x149050(0x1ef)]!=_0x149050(0x2a3))await sendTelegram(settings['telegramChatId'],_0x149050(0x2b3)+_0x317776);}}function decryptRSA(_0x38fdaa,_0x41ebcd){const _0x405671=_0x49797c,_0x140be2=forge['pki'][_0x405671(0xe3)](_0x38fdaa),_0x12b6dd=_0x140be2[_0x405671(0x23a)](forge['util'][_0x405671(0x280)](_0x41ebcd),'RSA-OAEP',{'md':forge['md'][_0x405671(0x111)][_0x405671(0x299)](),'mgf1':{'md':forge['md']['sha256']['create']()}});return _0x12b6dd;}function validateCredentials(_0x55fe8b,_0x102be4){const _0x1e2b41=_0x49797c;if(_0x55fe8b[_0x1e2b41(0x11c)]==settings['bbUsername']&&bcrypt[_0x1e2b41(0x144)](_0x55fe8b['password'],settings['bbPassword'])){if(settings[_0x1e2b41(0x140)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x531426=generateLoginToken(_0x102be4);return{'allow':!![],'reason':_0x1e2b41(0x24f),'token':_0x531426};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x2a6550){const _0xe1bd14=generateLoginToken(_0x2a6550);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0xe1bd14};}function validateAccess(_0x555722,_0x6f213e,_0x1ff777){const _0x2c063d=_0x49797c,_0x3a71a0=_0x1ff777?_0x1ff777:devices[_0x6f213e]['ip'];let _0x1e53ae;const _0x2e645c=_0x4a282c=>{const _0x44510d=_0x3612;if(settings[_0x44510d(0x17c)]){if(settings[_0x44510d(0x140)]){if(telegram2FaApproved(_0x6f213e)){const _0x5b8615=generateLoginToken(_0x6f213e);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x5b8615};}else return{'allow':![],'reason':_0x44510d(0x152),'token':null};}else return _0x1e53ae=validToken(_0x4a282c,_0x6f213e),_0x1e53ae[_0x44510d(0x22c)](_0x44510d(0x150))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x4a282c}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x2c063d(0x1c6)]){let _0xc79cd5=[...settings['whitelist'],'::1',_0x2c063d(0x14c),_0x2c063d(0x282),_0x2c063d(0x285)];if(_0xc79cd5['includes'](_0x3a71a0))return _0x2e645c(_0x555722);else{_0x1e53ae=validToken(_0x555722,_0x6f213e);if(_0x1e53ae[_0x2c063d(0x22c)](_0x2c063d(0x150)))return _0x2e645c(_0x555722);else{if(telegramIpApproved(_0x6f213e)){const _0x274e34=generateToken(_0x6f213e);return _0x1e53ae=_0x2e645c(_0x555722),_0x1e53ae[_0x2c063d(0x28a)]?{'allow':!![],'reason':_0x2c063d(0x277),'token':_0x274e34}:_0x1e53ae;}else return settings[_0x2c063d(0xe0)]?{'allow':![],'reason':_0x2c063d(0x24b),'token':null}:{'allow':![],'reason':_0x2c063d(0x1b2),'token':null};}}}else return _0x2e645c(_0x555722);}function timelyDecrypt(_0x980605,_0x1dc138,_0x40ee90='@'){const _0x5d6504=_0x49797c;if(_0x980605)try{const _0x526215=decryptRSA(secure['privateKey'],_0x980605),_0x38bac0=_0x526215[_0x5d6504(0x121)](_0x40ee90)[0x0],_0x560a75=_0x526215[_0x5d6504(0x121)](_0x40ee90)[0x1],_0x2ffd3e=new Date()[_0x5d6504(0x2bc)]();if(_0x1dc138){if(_0x2ffd3e-_0x560a75<maxSecretAge*0x3e8)return _0x38bac0;else return![];}else return _0x38bac0;}catch(_0x14ee45){return![];}else return![];}const validToken=(_0x140669,_0x5cd9b8)=>{const _0x263feb=_0x49797c,_0x4c8f1d=devices[_0x5cd9b8]['ip'];if(!_0x140669)return{'error':'No\x20authentication\x20token'};for(let _0x27a559 of blacklist){if(_0x27a559[_0x263feb(0x1fa)]==_0x140669)return{'error':_0x263feb(0x12e)};}let _0x439f45;try{_0x439f45=jwt['verify'](_0x140669,secure['secret']+_0x5cd9b8);}catch{return{'error':_0x263feb(0x1f2)};}if(!_0x439f45['hasOwnProperty'](_0x263feb(0x147))&&!_0x439f45['hasOwnProperty'](_0x263feb(0x11c))||!_0x439f45[_0x263feb(0x22c)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x439f45[_0x263feb(0x22c)](_0x263feb(0x11c))&&_0x439f45['hasOwnProperty'](_0x263feb(0x147))){const {clientip:_0x52cb4}=_0x439f45;return _0x4c8f1d==_0x52cb4?{'success':_0x263feb(0x1ab)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x439f45[_0x263feb(0x22c)](_0x263feb(0x11c))&&_0x439f45['hasOwnProperty'](_0x263feb(0x147))){const {username:_0x47f641,clientip:_0x31d85f}=_0x439f45;return settings[_0x263feb(0x257)]==_0x47f641&&_0x4c8f1d==_0x31d85f?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x263feb(0x2c3)};}}},generateLoginToken=_0x3064f5=>{const _0x174266=_0x49797c;if(_0x3064f5){const _0x37b9aa=devices[_0x3064f5]['ip'];return jwt[_0x174266(0x1c4)]({'username':settings[_0x174266(0x257)],'clientip':_0x37b9aa},secure[_0x174266(0x275)]+_0x3064f5,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0xf914d4=>{const _0x4d6424=_0x49797c;if(_0xf914d4){const _0x51f436=devices[_0xf914d4]['ip'];return jwt[_0x4d6424(0x1c4)]({'clientip':_0x51f436},secure[_0x4d6424(0x275)]+_0xf914d4,{'expiresIn':devices[_0xf914d4]['telegramIpApproval'][_0x4d6424(0x104)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x59c784=>{const _0x52dbe9=_0x49797c;let _0x54af2c=![];return devices[_0x59c784][_0x52dbe9(0xd6)]&&devices[_0x59c784][_0x52dbe9(0xd6)]['expiry']!=_0x52dbe9(0x237)&&(_0x54af2c=devices[_0x59c784]['telegramIpApproval'][_0x52dbe9(0x147)]==devices[_0x59c784]['ip']&&new Date()[_0x52dbe9(0x2bc)]()-devices[_0x59c784]['telegramIpApproval'][_0x52dbe9(0x198)]<devices[_0x59c784][_0x52dbe9(0xd6)]['expiry']*0x3c*0x3e8),_0x54af2c;},telegram2FaApproved=_0x14f84a=>{const _0x5c8865=_0x49797c;let _0x541bc7=![];return devices[_0x14f84a][_0x5c8865(0x158)]&&devices[_0x14f84a][_0x5c8865(0x158)][_0x5c8865(0x104)]!='reject'&&(_0x541bc7=devices[_0x14f84a][_0x5c8865(0x158)]['clientip']==devices[_0x14f84a]['ip']&&new Date()['getTime']()-devices[_0x14f84a][_0x5c8865(0x158)]['timestamp']<devices[_0x14f84a]['telegram2FaApproval'][_0x5c8865(0x104)]*0x3c*0x3e8),_0x541bc7;},normalizeIP=_0x51c041=>{const _0x33be63=_0x49797c;let _0x9516b4=null,_0x1bc144=null;if(ipaddr[_0x33be63(0x170)](_0x51c041)){const _0x170409=ipaddr[_0x33be63(0x186)](_0x51c041);_0x170409[_0x33be63(0x2dd)]()===_0x33be63(0x233)?(_0x170409[_0x33be63(0x229)]()&&(_0x9516b4=_0x170409[_0x33be63(0x2a0)]()['toString']()),_0x1bc144=_0x170409[_0x33be63(0x22b)]()):(_0x9516b4=_0x170409[_0x33be63(0x22b)](),_0x1bc144=_0x170409['toIPv4MappedAddress']()['toString']());}return{'show':_0x9516b4?_0x9516b4:_0x1bc144,'store':_0x1bc144};};function formatDate(_0x54e405){const _0x1fdc1a=_0x49797c;return _0x54e405[_0x1fdc1a(0xf5)]()+'/'+(_0x54e405['getMonth']()+0x1)['toString']()[_0x1fdc1a(0x283)](0x2,'0')+'/'+_0x54e405[_0x1fdc1a(0x203)]()[_0x1fdc1a(0x22b)]()['padStart'](0x2,'0')+'\x20'+_0x54e405['getHours']()[_0x1fdc1a(0x22b)]()[_0x1fdc1a(0x283)](0x2,'0')+':'+_0x54e405[_0x1fdc1a(0x1a2)]()[_0x1fdc1a(0x22b)]()[_0x1fdc1a(0x283)](0x2,'0')+':'+_0x54e405[_0x1fdc1a(0x295)]()[_0x1fdc1a(0x22b)]()['padStart'](0x2,'0');}function sleep(_0x5ee9ab){return new Promise(_0x539ab5=>setTimeout(_0x539ab5,_0x5ee9ab));}