const _0x49ad5f=_0x496f;(function(_0x1f4aab,_0x2c70f0){const _0x1d40f8=_0x496f,_0xf1b122=_0x1f4aab();while(!![]){try{const _0x14579d=-parseInt(_0x1d40f8(0xce))/0x1+parseInt(_0x1d40f8(0x15f))/0x2+-parseInt(_0x1d40f8(0x117))/0x3+-parseInt(_0x1d40f8(0x24d))/0x4+parseInt(_0x1d40f8(0x1af))/0x5*(parseInt(_0x1d40f8(0xc8))/0x6)+parseInt(_0x1d40f8(0x2b4))/0x7*(-parseInt(_0x1d40f8(0x211))/0x8)+parseInt(_0x1d40f8(0x1c8))/0x9;if(_0x14579d===_0x2c70f0)break;else _0xf1b122['push'](_0xf1b122['shift']());}catch(_0x13b216){_0xf1b122['push'](_0xf1b122['shift']());}}}(_0x4e06,0xb8bae));const _0x3fa114=function(){let _0x1e0e20=!![];return function(_0x427bfb,_0x4897a0){const _0x254713=_0x1e0e20?function(){const _0xf61cf8=_0x496f;if(_0x4897a0){const _0x4fe319=_0x4897a0[_0xf61cf8(0x1b9)](_0x427bfb,arguments);return _0x4897a0=null,_0x4fe319;}}:function(){};return _0x1e0e20=![],_0x254713;};}(),_0x30e105=_0x3fa114(this,function(){const _0x44e5f8=_0x496f;return _0x30e105[_0x44e5f8(0x164)]()[_0x44e5f8(0x2b3)](_0x44e5f8(0x1cd))['toString']()['constructor'](_0x30e105)[_0x44e5f8(0x2b3)](_0x44e5f8(0x1cd));});_0x30e105();'use strict';process[_0x49ad5f(0x285)][_0x49ad5f(0x18e)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x49ad5f(0xd4)),low=require(_0x49ad5f(0xbc)),FileSync=require(_0x49ad5f(0x159)),path=require(_0x49ad5f(0x2ca)),crypto=require('crypto'),forge=require(_0x49ad5f(0x145)),bcrypt=require('bcryptjs'),jwt=require(_0x49ad5f(0x219)),ipaddr=require(_0x49ad5f(0x23e)),yargs=require(_0x49ad5f(0x19a)),uuidRandom=require(_0x49ad5f(0x191)),{Telegraf,Markup}=require(_0x49ad5f(0x1d9)),Mixpanel=require('mixpanel'),axios=require(_0x49ad5f(0x240)),{GraphQLClient,gql}=require(_0x49ad5f(0x17f)),util=require('util'),fileUpload=require(_0x49ad5f(0x157)),{networkInterfaces}=require('os'),JSZip=require(_0x49ad5f(0x284)),argv=yargs(process['argv']['slice'](0x2))[_0x49ad5f(0x175)],PORT=argv[_0x49ad5f(0x21e)]||_0x49ad5f(0xbd),pattern=/^[0-9]{2,4}$/;!pattern[_0x49ad5f(0x1fe)](PORT)&&(console[_0x49ad5f(0xf6)](_0x49ad5f(0x1f1)+PORT+_0x49ad5f(0x15a)),process[_0x49ad5f(0x269)](0x1));const HOST=argv[_0x49ad5f(0x1a4)]||null,userID=argv[_0x49ad5f(0x194)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process[_0x49ad5f(0xc6)]['node'];let bbpath=_0x49ad5f(0x181),bbpath2='';const botfile=_0x49ad5f(0x109),configfile=_0x49ad5f(0x234),settingsfile=_0x49ad5f(0x2cc),securefile=_0x49ad5f(0xbe),environment=require('./'+bbpath2+_0x49ad5f(0x16d))['environment']||_0x49ad5f(0x19f),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x49ad5f(0xcb)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x49ad5f(0xf7)),configpath=userID?bbpath+_0x49ad5f(0xf2)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x49ad5f(0x2a0),logspath=userID?bbpath+_0x49ad5f(0x119)+userID+'/':bbpath+_0x49ad5f(0x119),zippath=userID?bbpath+_0x49ad5f(0x25c)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x49ad5f(0x1c7)](logspath+_0x49ad5f(0x152),{'flags':'a'}),temppath=userID?bbpath+_0x49ad5f(0xda)+userID+'/':bbpath+_0x49ad5f(0xda);!fs[_0x49ad5f(0xcb)](configpath)&&fs[_0x49ad5f(0x1d2)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x49ad5f(0x1d2)](configbackuppath);!fs[_0x49ad5f(0xcb)](logspath)&&fs[_0x49ad5f(0x1d2)](logspath);!fs[_0x49ad5f(0xcb)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x49ad5f(0xcb)](temppath)&&fs[_0x49ad5f(0x1d2)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x49ad5f(0x2a9)]({'bots':[]})[_0x49ad5f(0xf4)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x49ad5f(0x229),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x49ad5f(0x2a9)]({'secure':{},'blacklist':[]})[_0x49ad5f(0xf4)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x49ad5f(0x1c3)](_0x49ad5f(0x2a7),{'host':_0x49ad5f(0x25f)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x49ad5f(0x263)]&&(settings[_0x49ad5f(0x263)]!=''&&settings[_0x49ad5f(0x263)]!='***')&&settings[_0x49ad5f(0x105)]&&settings[_0x49ad5f(0x105)]!='')initTelegram();const parseColor=(_0x1a3094,_0x265a28)=>{const _0x268b90=_0x49ad5f,_0x221909=/#[A-Z]{3}#/g;if(typeof _0x1a3094==_0x268b90(0x1ed)){!_0x265a28?_0x1a3094=_0x1a3094[_0x268b90(0x297)](_0x221909,''):(_0x1a3094=_0x1a3094[_0x268b90(0x297)](/#BLU#/g,_0x268b90(0x226)),_0x1a3094=_0x1a3094[_0x268b90(0x297)](/#RED#/g,_0x268b90(0x24a)),_0x1a3094=_0x1a3094['replace'](/#YEL#/g,'\x1b[33m'),_0x1a3094=_0x1a3094[_0x268b90(0x297)](/#MAG#/g,'\x1b[35m'),_0x1a3094=_0x1a3094[_0x268b90(0x297)](/#CYA#/g,_0x268b90(0x10a)),_0x1a3094=_0x1a3094[_0x268b90(0x297)](/#RES#/g,_0x268b90(0xb9)));;}return _0x1a3094;},logger={'screen':_0x2b7cc7=>{const _0x4b91e3=_0x49ad5f;console[_0x4b91e3(0xf6)](parseColor(_0x2b7cc7,!![]));},'simple':_0x53f39e=>{const _0x83acab=_0x49ad5f;console['log'](parseColor(_0x53f39e,!![])),loggerfile['write'](util[_0x83acab(0xd5)](parseColor(_0x53f39e,![]))+'\x0a');},'full':async _0x3ae9cb=>{const _0x5386da=_0x49ad5f,_0x5736c4=getTimeStamp()+_0x5386da(0x153)+_0x3ae9cb;console['log'](parseColor(_0x5736c4,!![])),loggerfile[_0x5386da(0xf4)](util[_0x5386da(0xd5)](parseColor(_0x5736c4,![]))+'\x0a');if(tgBot&&settings[_0x5386da(0x26c)]&&settings[_0x5386da(0x14c)]!=_0x5386da(0x221))await sendTelegram(settings[_0x5386da(0x26c)],_0x5386da(0xd1)+parseColor(_0x3ae9cb,![]));},'debug':async(_0x872316,_0x4619ab='')=>{const _0x201801=_0x49ad5f,_0x58d2c1=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x872316;if(debugging)console[_0x201801(0xf6)](parseColor(_0x58d2c1,!![]));loggerfile[_0x201801(0xf4)](util[_0x201801(0xd5)](parseColor(_0x58d2c1,![]))+'\x0a');if(_0x4619ab){if(debugging)console['log'](_0x4619ab);loggerfile['write'](util[_0x201801(0xd5)](_0x4619ab)+'\x0a');}}};let terminating=![];process['on'](_0x49ad5f(0x199),function(_0x59e9de){const _0x696e95=_0x49ad5f;_0x59e9de[_0x696e95(0x164)]()['includes'](_0x696e95(0x197))?(logger[_0x696e95(0x2a4)](_0x696e95(0x1ec)+_0x59e9de[_0x696e95(0x21e)]+_0x696e95(0x1d4)),process['send']({'terminate':!![]},_0x5cbcd2=>{})):logger['simple'](_0x59e9de);}),process['on'](_0x49ad5f(0x269),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x49ad5f(0x143),()=>{const _0x5e791c=_0x49ad5f;stopAllBots(),process[_0x5e791c(0x269)](0x0);}),process['on']('SIGINT',()=>{const _0x3bf1e5=_0x49ad5f;stopAllBots(),process[_0x3bf1e5(0x269)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x49ad5f(0x16d))[_0x49ad5f(0x209)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x49ad5f(0xfe)),app=express(),http=require(_0x49ad5f(0x188))[_0x49ad5f(0x29b)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x49ad5f(0x198)](_0x49ad5f(0x293),async(_0x21cd87,_0x19a796)=>{const _0x313a8c=_0x49ad5f,_0x5388f6=_0x21cd87[_0x313a8c(0x21a)][_0x313a8c(0x1d7)],_0x27d146=getClientsWithBotID(_0x313a8c(0x28c)),_0x50fc04=_0x21cd87['headers']['uuid'],_0x5ae59e=timelyDecrypt(_0x50fc04,![]),_0x4cdeab=_0x27d146[_0x313a8c(0x1d1)](_0x5d94b5=>_0x5d94b5[_0x313a8c(0x206)]==_0x5ae59e);if(_0x4cdeab){const _0x5357f7=normalizeIP(_0x21cd87[_0x313a8c(0x20c)][_0x313a8c(0x166)])['store'],_0x28cf33=_0x21cd87[_0x313a8c(0x273)][_0x313a8c(0x288)];if(validateAccess(_0x28cf33,_0x5ae59e,_0x5357f7)[_0x313a8c(0x107)])_0x5388f6==_0x313a8c(0x10d)&&await backupConfigFiles(),await zipFiles(_0x5388f6),_0x19a796[_0x313a8c(0x165)](zippath+(_0x5388f6+_0x313a8c(0x1a3)),_0x4be593=>{const _0x319b20=_0x313a8c;_0x4be593&&(logger[_0x319b20(0x220)](_0x319b20(0xfa)+_0x5388f6),logger['simple'](_0x4be593));});else logger[_0x313a8c(0x220)](_0x313a8c(0x1d5)+_0x5388f6+'\x20(1)');}else logger[_0x313a8c(0x220)](_0x313a8c(0x1d5)+_0x5388f6+_0x313a8c(0x236));}),app[_0x49ad5f(0x244)](_0x49ad5f(0x22b),async(_0x4c056b,_0xbd11cc)=>{const _0xe24a7c=_0x49ad5f,_0x50bcb4=getClientsWithBotID(_0xe24a7c(0x28c)),_0x4f0d40=_0x4c056b[_0xe24a7c(0x273)][_0xe24a7c(0x206)],_0x2fc247=timelyDecrypt(_0x4f0d40,![]),_0x138698=_0x50bcb4[_0xe24a7c(0x1d1)](_0x298f80=>_0x298f80['uuid']==_0x2fc247);logger[_0xe24a7c(0x291)](_0xe24a7c(0x232));if(_0x138698){const _0xc0663a=normalizeIP(_0x4c056b[_0xe24a7c(0x20c)][_0xe24a7c(0x166)])['store'],_0x243022=_0x4c056b['headers']['tkn'];if(validateAccess(_0x243022,_0x2fc247,_0xc0663a)[_0xe24a7c(0x107)]){if(_0x4c056b[_0xe24a7c(0x103)]){const _0x14a1df=_0x4c056b[_0xe24a7c(0x103)][_0xe24a7c(0xf8)];await _0x14a1df['mv'](temppath+_0x14a1df['name']),_0xbd11cc[_0xe24a7c(0x1b0)]({'status':!![],'message':_0xe24a7c(0x14d)});const _0x13b621=getBotsWithMode();_0x13b621[_0xe24a7c(0x2bd)]>0x0?confirmRestore(temppath,_0x14a1df['name']):unzipFile(temppath,_0x14a1df[_0xe24a7c(0x1fd)]);}}else logger[_0xe24a7c(0x220)](_0xe24a7c(0x1ba));}else logger[_0xe24a7c(0x220)](_0xe24a7c(0x178));}),app['use'](express[_0x49ad5f(0xdb)](path[_0x49ad5f(0x15b)](__dirname,bbpath2,'build2'))),app[_0x49ad5f(0x114)](express[_0x49ad5f(0xdb)](path[_0x49ad5f(0x15b)](__dirname,bbpath2,_0x49ad5f(0x1ef)))),app[_0x49ad5f(0x198)]('/',function(_0x5cb42f,_0xe54316){const _0x3ce716=_0x49ad5f;_0xe54316['sendFile'](path[_0x3ce716(0x15b)](__dirname,bbpath2,'build2',_0x3ce716(0xd8)));}),app['get'](_0x49ad5f(0x21f),function(_0x21b75b,_0x45adff){const _0x3d5a61=_0x49ad5f;_0x45adff[_0x3d5a61(0x147)](path[_0x3d5a61(0x15b)](__dirname,bbpath2,_0x3d5a61(0x1ef),_0x3d5a61(0xd8)));}),app['get'](_0x49ad5f(0x200),(_0x5e6b2e,_0xf96663)=>{const _0x553d35=_0x49ad5f;_0xf96663[_0x553d35(0x147)](path[_0x553d35(0x15b)](__dirname,bbpath2,_0x553d35(0x1ef),_0x553d35(0xd8)));}),app[_0x49ad5f(0x198)](_0x49ad5f(0xf0),(_0x539607,_0x20d0e1)=>{const _0x2ffa3=_0x49ad5f;_0x20d0e1[_0x2ffa3(0x147)](path[_0x2ffa3(0x15b)](__dirname,bbpath2,'build',_0x2ffa3(0xd8)));}),app[_0x49ad5f(0x198)]('/:bot/coins',(_0x3b180a,_0x1499b5)=>{const _0x17acce=_0x49ad5f;_0x1499b5[_0x17acce(0x147)](path[_0x17acce(0x15b)](__dirname,bbpath2,_0x17acce(0x1ef),_0x17acce(0xd8)));}),app[_0x49ad5f(0x198)](_0x49ad5f(0x237),(_0x5ec5f0,_0x34c070)=>{const _0x2b7a5c=_0x49ad5f;_0x34c070[_0x2b7a5c(0x147)](path[_0x2b7a5c(0x15b)](__dirname,bbpath2,'build',_0x2b7a5c(0xd8)));}),app[_0x49ad5f(0x198)](_0x49ad5f(0x121),(_0x229d28,_0x4beade)=>{const _0x1e6009=_0x49ad5f;_0x4beade[_0x1e6009(0x147)](path[_0x1e6009(0x15b)](__dirname,bbpath2,'build',_0x1e6009(0xd8)));}),app[_0x49ad5f(0x198)]('/:bot/support',(_0x124874,_0x56da2c)=>{const _0x106728=_0x49ad5f;_0x56da2c[_0x106728(0x147)](path['join'](__dirname,bbpath2,_0x106728(0x1ef),_0x106728(0xd8)));});if(HOST)http[_0x49ad5f(0x16f)](PORT,HOST);else http['listen'](PORT);const io=require(_0x49ad5f(0x28a))(http,{});openBrowser&&(async()=>{const _0x139f77=_0x49ad5f,{default:_0x2e680d}=await import(_0x139f77(0x25a));await _0x2e680d(_0x139f77(0x130)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0xb52432=_0x49ad5f;let _0x28bc12='[ip-address]';const _0x5d2645=networkInterfaces(),_0x50ffef={};for(const _0x47abcc of Object['keys'](_0x5d2645)){for(const _0x120b67 of _0x5d2645[_0x47abcc]){if((_0x120b67[_0xb52432(0x2a6)]==_0xb52432(0x1ee)||_0x120b67[_0xb52432(0x2a6)]==0x4)&&!_0x120b67[_0xb52432(0x115)]){const _0x527179=ipaddr[_0xb52432(0x1f2)](_0x120b67[_0xb52432(0x233)])[_0xb52432(0x2a1)]();_0x527179!=_0xb52432(0x29f)&&(!_0x50ffef[_0x47abcc]&&(_0x50ffef[_0x47abcc]=[]),_0x50ffef[_0x47abcc]['push'](_0x120b67[_0xb52432(0x233)]),_0x28bc12=_0x120b67[_0xb52432(0x233)]);}}}return{'serverip':_0x28bc12,'netinterfaces':_0x50ffef};}async function startServer(){const _0x3a24cb=_0x49ad5f,{serverip:_0x218a0d,netinterfaces:_0x547de6}=getServerIP();logger['simple'](''),logger['simple'](_0x3a24cb(0x18c)),await logger[_0x3a24cb(0x220)](_0x3a24cb(0xc3)+serverversion+_0x3a24cb(0x2b7)+(environment==_0x3a24cb(0x1df)?'(staging)':'')+'\x0a'+(_0x3a24cb(0x16a)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x3a24cb(0x149)+_0x218a0d+':'+PORT+_0x3a24cb(0x23b))),logger[_0x3a24cb(0x2a4)](_0x3a24cb(0x18c));if(config[_0x3a24cb(0x2bd)]!=0x0)for(const _0x110926 of config){const _0x984b3e=_0x110926[_0x3a24cb(0x171)]==_0x3a24cb(0x24c)?'a':'m';if(_0x110926[_0x3a24cb(0x2ac)]==_0x3a24cb(0x1de)||_0x110926['status']=='new')await logger[_0x3a24cb(0x220)](_0x3a24cb(0x193)+_0x984b3e+')\x20|\x20Bot\x20'+_0x110926[_0x3a24cb(0x27e)]+'\x20|\x20'+_0x110926[_0x3a24cb(0x135)]),startBot([_0x110926['botID'],userID],{'cwd':bbpath},function(_0x2ae870){if(_0x2ae870)logger['full'](_0x2ae870);});else(_0x110926[_0x3a24cb(0x2ac)]==_0x3a24cb(0x239)||_0x110926['status']==_0x3a24cb(0xe4))&&await logger[_0x3a24cb(0x220)](_0x3a24cb(0x2c8)+_0x984b3e+_0x3a24cb(0x277)+_0x110926[_0x3a24cb(0x27e)]+_0x3a24cb(0x11c)+_0x110926[_0x3a24cb(0x135)]);}else!newBot&&logger[_0x3a24cb(0x2a4)](_0x3a24cb(0xeb));if(newBot)addBot();logger[_0x3a24cb(0x2a4)](_0x3a24cb(0x18c)),logger[_0x3a24cb(0x2a4)](''),await logger['debug'](_0x3a24cb(0x12c)+nodeversion),await logger[_0x3a24cb(0x291)](_0x3a24cb(0x18b),_0x547de6);}function startSocket(){io['on']('connection',_0x389e2f=>{const _0x3e8e45=_0x496f;let _0x3b68d4,_0x398b4f,_0x528b96,_0x206d0b,_0x140a71;const _0x415780=_0x389e2f[_0x3e8e45(0x12b)][_0x3e8e45(0x273)][_0x3e8e45(0x241)];_0x398b4f=_0x415780[_0x3e8e45(0x205)](/bot[0-9]{3}/);if(_0x398b4f)_0x528b96=_0x398b4f[0x0][_0x3e8e45(0x205)](/[0-9]{3}/);if(_0x528b96)_0x3b68d4=_0x528b96[0x0];else _0x3b68d4=_0x3e8e45(0x28c);const _0x3514c1=_0x389e2f[_0x3e8e45(0x12b)][_0x3e8e45(0x1a2)][_0x3e8e45(0x238)];if(!_0x3514c1)_0x389e2f['emit'](_0x3e8e45(0x2ac),{'publicKey':secure['publicKey']});else{_0x206d0b=timelyDecrypt(_0x3514c1,![]);if(!_0x206d0b)_0x389e2f[_0x3e8e45(0x1b2)]('status',{'publicKey':secure['publicKey']});else{_0x140a71=normalizeIP(_0x389e2f[_0x3e8e45(0x111)]['remoteAddress'])[_0x3e8e45(0x146)];if(!devices[_0x206d0b])devices[_0x206d0b]={'uuid':_0x206d0b,'access':{'token':null}};devices[_0x206d0b]['ip']=_0x140a71;const _0x220df7=addClient(_0x389e2f['id'],_0x206d0b,_0x3b68d4);setAccess(_0x220df7),emitMessages(),_0x389e2f['on'](_0x3e8e45(0x2ba),_0x5a00ec=>{const _0x3442a5=_0x3e8e45,_0x4c46e4=timelyDecrypt(_0x5a00ec[_0x3442a5(0x110)],!![],_0x3442a5(0x161));if(_0x4c46e4){_0x5a00ec={'username':_0x5a00ec[_0x3442a5(0x184)],'password':_0x4c46e4},devices[_0x206d0b][_0x3442a5(0x252)]=validateCredentials(_0x5a00ec,_0x206d0b);if(devices[_0x206d0b][_0x3442a5(0x252)][_0x3442a5(0x107)]==![]&&devices[_0x206d0b][_0x3442a5(0x252)][_0x3442a5(0x14f)]==_0x3442a5(0x2bc))_0x389e2f[_0x3442a5(0x1b2)](_0x3442a5(0x2ac),{'access':devices[_0x206d0b][_0x3442a5(0x252)]}),loginAccess2FA(_0x206d0b,_0x140a71);else{if(devices[_0x206d0b][_0x3442a5(0x252)][_0x3442a5(0x107)]==![]&&devices[_0x206d0b]['access'][_0x3442a5(0x14f)]==_0x3442a5(0x126))_0x389e2f['emit']('status',{'access':devices[_0x206d0b][_0x3442a5(0x252)]});else devices[_0x206d0b][_0x3442a5(0x252)][_0x3442a5(0x107)]&&devices[_0x206d0b][_0x3442a5(0x252)][_0x3442a5(0x14f)]==_0x3442a5(0x2b1)&&(getClientsWithUuid(_0x206d0b)[_0x3442a5(0x192)](_0x4f2044=>{setAccess(_0x4f2044);}),logger[_0x3442a5(0x291)]('Logged\x20in\x20user\x20...'+_0x206d0b[_0x3442a5(0x13d)](-0x8)),setTokenRefresh(_0x206d0b),setSessionTimeout('login',_0x206d0b));}}else logger[_0x3442a5(0x220)](_0x3442a5(0x26b));}),_0x389e2f['on'](_0x3e8e45(0x125),()=>{resetPassword();}),_0x389e2f['on'](_0x3e8e45(0x1f7),_0x5cca0f=>{removeClient(_0x389e2f['id']);}),_0x3b68d4=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5aa9dc){const _0x19e959=_0x49ad5f;if(_0x5aa9dc!=_0x19e959(0x28c)&&config[_0x19e959(0x22c)]!=''){if(pid[_0x5aa9dc])pid[_0x5aa9dc][_0x19e959(0x1b0)]({'function':_0x19e959(0x1b3),'args':null});}_0x5aa9dc!=_0x19e959(0x28c)&&broadcastToBots(_0x19e959(0x265),JSON[_0x19e959(0x17c)](config));}function reloadBotManager(){const _0x473f4e=_0x49ad5f;getClientsWithBotID(_0x473f4e(0x28c))['forEach'](_0x4e1b84=>{const _0x66769b=_0x473f4e;getSocket(_0x4e1b84['id'])['emit']('status',{'access':{'allow':![],'reason':_0x66769b(0xdd),'token':null}});});}function getSocket(_0xffd938){const _0x9522db=_0x49ad5f,_0x27fd85=io[_0x9522db(0x24b)][_0x9522db(0x198)]('/');return _0x27fd85[_0x9522db(0x222)][_0x9522db(0x198)](_0xffd938);}function setAccess(_0x15ceb9){const _0x4b61b8=_0x49ad5f,_0x173cd3=getSocket(_0x15ceb9['id']),_0x223c0b=_0x15ceb9[_0x4b61b8(0x206)],_0x48ac78=_0x15ceb9[_0x4b61b8(0x1bf)];devices[_0x223c0b][_0x4b61b8(0x252)]=validateAccess(devices[_0x223c0b][_0x4b61b8(0x252)][_0x4b61b8(0x2a3)],_0x223c0b),logger['debug'](_0x4b61b8(0x104)+devices[_0x223c0b][_0x4b61b8(0x252)]['reason']+_0x4b61b8(0x1c1)+_0x15ceb9['id'][_0x4b61b8(0x13d)](-0x8)+_0x4b61b8(0x183)+_0x223c0b[_0x4b61b8(0x13d)](-0x8)),_0x173cd3[_0x4b61b8(0x15b)](_0x223c0b);if(devices[_0x223c0b][_0x4b61b8(0x252)][_0x4b61b8(0x107)]){_0x173cd3[_0x4b61b8(0x15b)](_0x48ac78);if(_0x48ac78==_0x4b61b8(0x28c))initializeSocketBotManager(_0x173cd3);else initializeSocketBot(_0x173cd3);initClient(_0x48ac78);}devices[_0x223c0b]['access'][_0x4b61b8(0x2a3)]&&devices[_0x223c0b][_0x4b61b8(0x252)][_0x4b61b8(0x14f)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x4b61b8(0x1ae),_0x223c0b),devices[_0x223c0b][_0x4b61b8(0x252)][_0x4b61b8(0x2a3)]&&devices[_0x223c0b]['access'][_0x4b61b8(0x14f)]==_0x4b61b8(0x1be)&&setSessionTimeout('login',_0x223c0b),_0x173cd3[_0x4b61b8(0x1b2)](_0x4b61b8(0x2ac),{'status':_0x15ceb9[_0x4b61b8(0xcc)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x223c0b][_0x4b61b8(0x252)],'externalip':devices[_0x223c0b]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x4b61b8(0x163)],'validInstallation':validInstallation}),devices[_0x223c0b]['access'][_0x4b61b8(0x107)]==![]&&devices[_0x223c0b][_0x4b61b8(0x252)][_0x4b61b8(0x14f)]==_0x4b61b8(0x16b)&&temporaryAccess2FA(_0x223c0b,devices[_0x223c0b]['ip']);}function setSessionTimeout(_0x6a52dc,_0x3de422){const _0x3d22c5=_0x49ad5f;let _0x2f4600;if(_0x6a52dc==_0x3d22c5(0x2ba))_0x2f4600=loginExpiry*0x3c*0x3e8;else _0x2f4600=devices[_0x3de422]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()[_0x3d22c5(0x2ad)]()-devices[_0x3de422][_0x3d22c5(0x1e8)][_0x3d22c5(0x203)]);if(devices[_0x3de422][_0x3d22c5(0x133)])clearTimeout(devices[_0x3de422][_0x3d22c5(0x133)]);devices[_0x3de422][_0x3d22c5(0x133)]=setTimeout(()=>{const _0x4bd80f=_0x3d22c5;if(devices[_0x3de422]['pidRefreshToken'])clearTimeout(devices[_0x3de422][_0x4bd80f(0x1db)]);removeSocketListeners(_0x3de422),addBlacklist(_0x3de422),devices[_0x3de422]['telegramIpApproval']=null,devices[_0x3de422][_0x4bd80f(0x245)]=null,devices[_0x3de422][_0x4bd80f(0x252)][_0x4bd80f(0x2a3)]=null,logger[_0x4bd80f(0x291)]('Session\x20expired\x20for\x20user\x20...'+_0x3de422[_0x4bd80f(0x13d)](-0x8)),devices[_0x3de422][_0x4bd80f(0x252)]=validateAccess(devices[_0x3de422][_0x4bd80f(0x252)][_0x4bd80f(0x2a3)],_0x3de422),!(devices[_0x3de422][_0x4bd80f(0x252)][_0x4bd80f(0x107)]&&devices[_0x3de422][_0x4bd80f(0x252)]['reason']==_0x4bd80f(0x207))&&(_0x6a52dc=='login'?io['to'](_0x3de422)[_0x4bd80f(0x1b2)](_0x4bd80f(0x2ac),{'access':{'allow':![],'reason':_0x4bd80f(0x10b),'token':null}}):io['to'](_0x3de422)['emit'](_0x4bd80f(0x2ac),{'access':{'allow':![],'reason':_0x4bd80f(0x276),'token':null}})),devices[_0x3de422][_0x4bd80f(0x252)][_0x4bd80f(0x2a3)]=null;},_0x2f4600);}function setTokenRefresh(_0x32964d){const _0x268c70=_0x49ad5f;if(devices[_0x32964d][_0x268c70(0x1db)])clearTimeout(devices[_0x32964d]['pidRefreshToken']);devices[_0x32964d][_0x268c70(0x1db)]=setTimeout(()=>{const _0x4dad8b=_0x268c70;getClientsWithUuid(_0x32964d)[_0x4dad8b(0x2bd)]!=0x0?(devices[_0x32964d][_0x4dad8b(0x252)]=refreshToken(_0x32964d),io['to'](_0x32964d)[_0x4dad8b(0x1b2)](_0x4dad8b(0x2ac),{'status':_0x4dad8b(0x101),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x32964d]['access'],'externalip':devices[_0x32964d]['ip'],'publicKey':secure[_0x4dad8b(0xd3)],'validInstallation':validInstallation}),setTokenRefresh(_0x32964d)):clearTimeout(devices[_0x32964d][_0x4dad8b(0x1db)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x335ba4){const _0x4d9c6b=_0x49ad5f,_0x32ee36=getClient(_0x335ba4['id'])[_0x4d9c6b(0x206)];_0x335ba4[_0x4d9c6b(0x1b2)](_0x4d9c6b(0x265),config),_0x335ba4[_0x4d9c6b(0x1b2)](_0x4d9c6b(0x15d),cleanSettings()),_0x335ba4['on'](_0x4d9c6b(0xf5),_0xa06751=>{const _0x4fd3bb=_0x4d9c6b;if(validateAccess(_0xa06751,_0x32ee36)[_0x4fd3bb(0x107)])addBot();else logger['full'](_0x4fd3bb(0x22f));}),_0x335ba4['on']('update-bot',(_0x5a3808,_0x17590d)=>{const _0x111080=_0x4d9c6b;if(validateAccess(_0x17590d,_0x32ee36)['allow'])toggleBot(_0x5a3808[_0x111080(0x27e)],_0x5a3808['status'],_0x5a3808['live']);else logger[_0x111080(0x220)](_0x111080(0xde));}),_0x335ba4['on'](_0x4d9c6b(0xd0),(_0xadce6f,_0x205ec5)=>{const _0x4687ac=_0x4d9c6b;if(validateAccess(_0x205ec5,_0x32ee36)[_0x4687ac(0x107)])toggleBotMode(_0xadce6f);else logger[_0x4687ac(0x220)](_0x4687ac(0xde));}),_0x335ba4['on'](_0x4d9c6b(0x187),(_0xfd4f35,_0x1368f9)=>{const _0x294fc2=_0x4d9c6b;if(validateAccess(_0x1368f9,_0x32ee36)[_0x294fc2(0x107)])deleteBot(_0xfd4f35);else logger[_0x294fc2(0x220)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x335ba4['on']('store-settings',(_0x4a4520,_0x45b13b)=>{const _0x566023=_0x4d9c6b;if(validateAccess(_0x45b13b,_0x32ee36)[_0x566023(0x107)])storeSettings(_0x4a4520,!![]);else logger[_0x566023(0x220)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x335ba4['on']('update-bb',_0x503bb4=>{const _0x1b3d17=_0x4d9c6b;if(validateAccess(_0x503bb4,_0x32ee36)[_0x1b3d17(0x107)])updateBB(_0x1b3d17(0x248));else logger['full'](_0x1b3d17(0x1e6));}),_0x335ba4['on'](_0x4d9c6b(0x298),_0xcc2bfe=>{const _0x10ec53=_0x4d9c6b;if(validateAccess(_0xcc2bfe,_0x32ee36)['allow'])updateBB(_0x10ec53(0x26d));else logger[_0x10ec53(0x220)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x335ba4['on'](_0x4d9c6b(0x1c9),_0x3a0c8e=>{const _0x2a61bf=_0x4d9c6b;if(validateAccess(_0x3a0c8e,_0x32ee36)['allow']){const _0x39f891=getClient(_0x335ba4['id']);if(_0x39f891)getBackupFiles(_0x39f891[_0x2a61bf(0x206)]);else logger[_0x2a61bf(0x220)](_0x2a61bf(0x25e));}else logger['full'](_0x2a61bf(0x257));}),_0x335ba4['on'](_0x4d9c6b(0x23f),(_0x2149c7,_0x4273d1)=>{const _0x346519=_0x4d9c6b;if(validateAccess(_0x4273d1,_0x32ee36)[_0x346519(0x107)])restoreBackupFile(_0x2149c7);else logger[_0x346519(0x220)](_0x346519(0x12e));}),_0x335ba4['on']('get-messages',_0x497b77=>{const _0x4c5705=_0x4d9c6b;if(validateAccess(_0x497b77,_0x32ee36)[_0x4c5705(0x107)])getMessages();else logger['full'](_0x4c5705(0xec));}),_0x335ba4['on']('confirm-message',(_0x5594d1,_0x513047)=>{const _0x1b6d2a=_0x4d9c6b;if(validateAccess(_0x513047,_0x32ee36)[_0x1b6d2a(0x107)])confirmMessage(_0x5594d1);else logger[_0x1b6d2a(0x220)](_0x1b6d2a(0x2c6));}),_0x335ba4['on'](_0x4d9c6b(0x254),_0x2c3ddf=>{const _0x43161f=_0x4d9c6b;if(validateAccess(_0x2c3ddf,_0x32ee36)['allow']){if(devices[_0x32ee36]['pidRefreshToken'])clearTimeout(devices[_0x32ee36]['pidRefreshToken']);if(devices[_0x32ee36][_0x43161f(0x133)])clearTimeout(devices[_0x32ee36][_0x43161f(0x133)]);removeSocketListeners(getClient(_0x335ba4['id'])[_0x43161f(0x206)]),addBlacklist(_0x32ee36),devices[_0x32ee36][_0x43161f(0x1e8)]=null,devices[_0x32ee36]['telegram2FaApproval']=null,devices[_0x32ee36][_0x43161f(0x252)][_0x43161f(0x2a3)]=null,logger[_0x43161f(0x291)](_0x43161f(0x1c5)+_0x32ee36[_0x43161f(0x13d)](-0x8)),io['to'](getClient(_0x335ba4['id'])[_0x43161f(0x206)])[_0x43161f(0x1b2)](_0x43161f(0x2ac),{'access':{'allow':![],'reason':_0x43161f(0x296),'token':null}});}else logger[_0x43161f(0x220)](_0x43161f(0x1dd));});}function initializeSocketBot(_0x116ddf){const _0x5e09fc=_0x49ad5f,_0x2f4689=getClient(_0x116ddf['id'])['bot'],_0x18d262=getClient(_0x116ddf['id'])[_0x5e09fc(0x206)];_0x116ddf['on']('get-logs',(_0x3dd649,_0x40609f)=>{const _0x554bba=_0x5e09fc;if(validateAccess(_0x40609f,_0x18d262)['allow']){if(pid[_0x2f4689])pid[_0x2f4689][_0x554bba(0x1b0)]({'function':'emitHistory','args':_0x3dd649});}else logger['full'](_0x554bba(0x176));}),_0x116ddf['on']('delete-alerts',(_0x7c267c,_0xea4a30)=>{const _0xe19b2b=_0x5e09fc;if(validateAccess(_0xea4a30,_0x18d262)[_0xe19b2b(0x107)]){if(pid[_0x2f4689])pid[_0x2f4689][_0xe19b2b(0x1b0)]({'function':_0xe19b2b(0x1fa),'args':_0x7c267c});}else logger[_0xe19b2b(0x220)](_0xe19b2b(0x242));}),_0x116ddf['on']('get-portfolio',(_0x4c3c65,_0x1ce209)=>{const _0x290920=_0x5e09fc;if(validateAccess(_0x1ce209,_0x18d262)[_0x290920(0x107)]){if(pid[_0x2f4689])pid[_0x2f4689][_0x290920(0x1b0)]({'function':_0x290920(0x23c),'args':_0x4c3c65});}else logger[_0x290920(0x220)](_0x290920(0x106));}),_0x116ddf['on'](_0x5e09fc(0x228),(_0x31017c,_0x140dd7)=>{const _0x5aebb5=_0x5e09fc;if(validateAccess(_0x140dd7,_0x18d262)[_0x5aebb5(0x107)]){if(pid[_0x2f4689])pid[_0x2f4689][_0x5aebb5(0x1b0)]({'function':'storeConfiguration','args':_0x31017c});}else logger[_0x5aebb5(0x220)](_0x5aebb5(0x224));}),_0x116ddf['on'](_0x5e09fc(0xb5),(_0x459674,_0x398808)=>{const _0x2b72c9=_0x5e09fc;if(validateAccess(_0x398808,_0x18d262)[_0x2b72c9(0x107)]){if(pid[_0x2f4689])pid[_0x2f4689][_0x2b72c9(0x1b0)]({'function':_0x2b72c9(0xe9),'args':_0x459674});}else logger[_0x2b72c9(0x220)](_0x2b72c9(0x1a8));}),_0x116ddf['on'](_0x5e09fc(0xef),(_0x6ecc94,_0x430918)=>{const _0x5e72de=_0x5e09fc;if(validateAccess(_0x430918,_0x18d262)[_0x5e72de(0x107)]){if(pid[_0x2f4689])pid[_0x2f4689]['send']({'function':_0x5e72de(0x1f4),'args':_0x6ecc94});}else logger[_0x5e72de(0x220)](_0x5e72de(0x201));}),_0x116ddf['on']('reset-history',_0x46b6ac=>{const _0x2033e3=_0x5e09fc;if(validateAccess(_0x46b6ac,_0x18d262)['allow']){if(pid[_0x2f4689])pid[_0x2f4689][_0x2033e3(0x1b0)]({'function':_0x2033e3(0x281),'args':null});}else logger[_0x2033e3(0x220)](_0x2033e3(0xe7));}),_0x116ddf['on'](_0x5e09fc(0x1cc),_0x4744b5=>{const _0x4d7169=_0x5e09fc;if(validateAccess(_0x4744b5,_0x18d262)['allow']){if(pid[_0x2f4689])pid[_0x2f4689][_0x4d7169(0x1b0)]({'function':_0x4d7169(0x251),'args':null});}else logger[_0x4d7169(0x220)](_0x4d7169(0x13b));}),_0x116ddf['on'](_0x5e09fc(0x172),(_0x46f6f8,_0x301b7a)=>{const _0x2a2cd1=_0x5e09fc;if(validateAccess(_0x301b7a,_0x18d262)[_0x2a2cd1(0x107)]){if(pid[_0x2f4689])pid[_0x2f4689]['send']({'function':_0x2a2cd1(0xd2),'args':_0x46f6f8});}else logger['full'](_0x2a2cd1(0x208));}),_0x116ddf['on']('cancel-loading',_0x4e6bb8=>{const _0x234581=_0x5e09fc;if(validateAccess(_0x4e6bb8,_0x18d262)[_0x234581(0x107)]){if(pid[_0x2f4689])pid[_0x2f4689][_0x234581(0x1b0)]({'function':_0x234581(0x29a),'args':null});}else logger[_0x234581(0x220)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x116ddf['on'](_0x5e09fc(0x129),_0x5c29dd=>{const _0x59f74d=_0x5e09fc;if(validateAccess(_0x5c29dd,_0x18d262)['allow']){if(pid[_0x2f4689])pid[_0x2f4689]['send']({'function':_0x59f74d(0x255),'args':null});}else logger[_0x59f74d(0x220)](_0x59f74d(0x1f6));}),_0x116ddf['on']('update-bb',_0x3cd724=>{const _0x395c5b=_0x5e09fc;if(validateAccess(_0x3cd724,_0x18d262)['allow'])updateBB(_0x395c5b(0x248));else logger[_0x395c5b(0x220)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x116ddf['on'](_0x5e09fc(0x1ca),_0x3129e1=>{const _0x15a01a=_0x5e09fc;if(validateAccess(_0x3129e1,_0x18d262)['allow'])getMessages();else logger[_0x15a01a(0x220)](_0x15a01a(0xec));}),_0x116ddf['on']('confirm-message',(_0x4f5dba,_0x5142c1)=>{const _0x19b28a=_0x5e09fc;if(validateAccess(_0x5142c1,_0x18d262)[_0x19b28a(0x107)])confirmMessage(_0x4f5dba);else logger[_0x19b28a(0x220)](_0x19b28a(0x2c6));}),_0x116ddf['on'](_0x5e09fc(0x254),_0x405c8d=>{const _0x3658ea=_0x5e09fc;if(validateAccess(_0x405c8d,_0x18d262)[_0x3658ea(0x107)]){if(devices[_0x18d262][_0x3658ea(0x1db)])clearTimeout(devices[_0x18d262][_0x3658ea(0x1db)]);if(devices[_0x18d262][_0x3658ea(0x133)])clearTimeout(devices[_0x18d262][_0x3658ea(0x133)]);removeSocketListeners(getClient(_0x116ddf['id'])[_0x3658ea(0x206)]),addBlacklist(_0x18d262),devices[_0x18d262]['telegramIpApproval']=null,devices[_0x18d262][_0x3658ea(0x245)]=null,devices[_0x18d262][_0x3658ea(0x252)]['token']=null,logger[_0x3658ea(0x291)]('Logged\x20out\x20user\x20...'+_0x18d262[_0x3658ea(0x13d)](-0x8)),io['to'](getClient(_0x116ddf['id'])['uuid'])['emit']('status',{'access':{'allow':![],'reason':_0x3658ea(0x296),'token':null}});}else logger[_0x3658ea(0x220)](_0x3658ea(0x1dd));});}function removeSocketListeners(_0x405155){getClientsWithUuid(_0x405155)['forEach'](_0x516616=>{getSocket(_0x516616['id'])['removeAllListeners']();});}function cleanSettings(){const _0x36b4d2=_0x49ad5f;let _0x4a4a40=settings;return settings[_0x36b4d2(0x263)]&&settings['telegramToken']!=''&&(_0x4a4a40={..._0x4a4a40,'telegramToken':_0x36b4d2(0x20f)}),settings['bbPassword']&&settings[_0x36b4d2(0x1bb)]!=''&&(_0x4a4a40={..._0x4a4a40,'bbPassword':_0x36b4d2(0x20f)}),settings[_0x36b4d2(0x1eb)]&&settings['marketcapApi']!=''&&(_0x4a4a40={..._0x4a4a40,'marketcapApi':_0x36b4d2(0x20f)}),(settings[_0x36b4d2(0x1bb)]&&settings[_0x36b4d2(0x1bb)]=='***'||settings[_0x36b4d2(0x263)]&&settings[_0x36b4d2(0x263)]==_0x36b4d2(0x190)||settings['marketcapApi']&&settings[_0x36b4d2(0x1eb)]=='***')&&(_0x4a4a40={..._0x4a4a40,'restored':{'password':settings[_0x36b4d2(0x1bb)]==_0x36b4d2(0x190),'telegram':settings['telegramToken']==_0x36b4d2(0x190),'marketcap':settings[_0x36b4d2(0x1eb)]==_0x36b4d2(0x190)}}),_0x4a4a40;}async function updateBB(_0x31dd6b){const _0x1182c3=_0x49ad5f;await backupConfigFiles(),installingUpdate=!![],config[_0x1182c3(0x192)](_0xa6c57e=>{const _0xa5eb62=_0x1182c3;restartBot(_0xa6c57e[_0xa5eb62(0x27e)]);});if(_0x31dd6b=='update')process[_0x1182c3(0x1b0)]({'update':!![],'environment':environment},_0x76270=>{});else _0x31dd6b=='reinstall'&&process['send']({'reinstall':!![],'environment':environment},_0x1f8644=>{});}function startBot(_0x9dafe2,_0x2eb22e,_0x106302){const _0xb19fbf=_0x49ad5f;if(debugging)_0x9dafe2['push']('-d');if(recreate)_0x9dafe2[_0xb19fbf(0x1bc)]('-r');let _0x3326e8=![];const _0x1e6563=_0x9dafe2[0x0];_0x2eb22e={..._0x2eb22e,'stdio':[_0xb19fbf(0xdf),_0xb19fbf(0xdf),_0xb19fbf(0xdf),_0xb19fbf(0x214)]},pid[_0x1e6563]=childProcess[_0xb19fbf(0x23d)](botfile,_0x9dafe2,_0x2eb22e),pid[_0x1e6563]['on'](_0xb19fbf(0x11e),_0x231cc8=>{const _0xb87e3e=_0xb19fbf;switch(Object['keys'](_0x231cc8)[0x0]){case _0xb87e3e(0x135):updateBotName(_0x1e6563,_0x231cc8[_0xb87e3e(0x135)]);break;case _0xb87e3e(0x1f9):updateBotManager();break;case _0xb87e3e(0x2ac):updateStatus(_0x1e6563,_0x231cc8[_0xb87e3e(0x2ac)]);break;case'live':updateLive(_0x1e6563,_0x231cc8[_0xb87e3e(0x262)]);break;case _0xb87e3e(0x1b4):updateLive(_0x1e6563,_0x231cc8[_0xb87e3e(0x1b4)]),io['to'](_0x1e6563)[_0xb87e3e(0x1b2)](_0xb87e3e(0x2ac),{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0x231cc8[_0xb87e3e(0x180)]==_0xb87e3e(0x27f)&&restartBot(_0x1e6563);_0x231cc8[_0xb87e3e(0x180)]=='kill'&&toggleBot(_0x1e6563,'disabled',_0xb87e3e(0x12f));break;case _0xb87e3e(0x2cf):sendTelegramBot(_0x1e6563,_0x231cc8[_0xb87e3e(0x2cf)]);break;case _0xb87e3e(0x1a1):sendTelegramMsg(_0x231cc8['telegrammsg']);break;case _0xb87e3e(0x142):io['to'](_0x1e6563)[_0xb87e3e(0x1b2)](_0x231cc8[_0xb87e3e(0x142)],_0x231cc8['args']);break;}}),pid[_0x1e6563]['on'](_0xb19fbf(0x253),function(_0xaecc68){if(_0x3326e8)return;_0x3326e8=!![],_0x106302(_0xaecc68);}),pid[_0x1e6563]['on'](_0xb19fbf(0x269),async function(_0x6d59fa){const _0x47ae43=_0xb19fbf;if(terminating)return;if(installingUpdate){io[_0x47ae43(0x139)]();return;}if(_0x3326e8)return;_0x3326e8=!![],_0x106302(null);const _0x53a56c=dbConfig[_0x47ae43(0x198)]('bots')[_0x47ae43(0x1d1)]({'botID':_0x1e6563})[_0x47ae43(0x170)]();_0x53a56c&&(_0x53a56c[_0x47ae43(0x2ac)]==_0x47ae43(0x1de)||_0x53a56c[_0x47ae43(0x2ac)]==_0x47ae43(0x1e9))&&(await sleep(0x3e8),updateLive(_0x1e6563,'stopped'),logger[_0x47ae43(0x220)](_0x47ae43(0xc2)+botRef(_0x1e6563)),startBot([_0x1e6563,userID],{'cwd':bbpath},function(_0x43bcf7){const _0x3ab918=_0x47ae43;if(_0x43bcf7)logger[_0x3ab918(0x220)](_0x43bcf7);}));});}function stopBot(_0x5dfc11){getClientsWithBotID(_0x5dfc11)['forEach'](_0x4afba9=>{const _0x441087=_0x496f;getSocket(_0x4afba9['id'])[_0x441087(0x1f7)](!![]),removeClient(_0x4afba9['id']);}),pid[_0x5dfc11]&&(pid[_0x5dfc11]['kill'](),pid[_0x5dfc11]=null);}function stopAllBots(){terminating=!![];const _0x25ea62=getEnabledBots();_0x25ea62['forEach'](_0x281c65=>{stopBot(_0x281c65['botID']);});}function restartBot(_0x98e958){const _0x5e0161=_0x49ad5f;if(pid[_0x98e958])pid[_0x98e958][_0x5e0161(0x2ae)]();}function addBot(){const _0x261b10=_0x49ad5f;let _0x3b6913;for(let _0x4dc0e1=0x1;_0x4dc0e1<0x3e9;_0x4dc0e1++){_0x3b6913=_0x4dc0e1[_0x261b10(0x164)]()['padStart'](0x3,'0');let _0x35cd1a=config[_0x261b10(0x1d1)](_0x197d91=>_0x197d91['botID']==_0x3b6913);if(!_0x35cd1a)break;}if(_0x3b6913===_0x261b10(0x25b)){logger[_0x261b10(0x220)](_0x261b10(0xed));return;}logger[_0x261b10(0x220)](_0x261b10(0x1e3)+_0x3b6913),dbConfig['get']('bots')['push']({'botID':_0x3b6913,'botname':_0x261b10(0x258)+_0x3b6913,'status':_0x261b10(0x1e9),'live':''})[_0x261b10(0xf4)](),startBot([_0x3b6913,userID],{'cwd':bbpath},function(_0x3e4106){if(_0x3e4106)logger['full'](_0x3e4106);}),config=getConfiguration(),io['to'](_0x261b10(0x28c))['emit'](_0x261b10(0x265),config),broadcastToBots('bots',JSON[_0x261b10(0x17c)](config));}function _0x4e06(){const _0x4d81d4=['use','internal','tempaccess_15_','1568328irgrwv','remove','logs/','Notifications\x20enabled\x0a','output-003.log','\x20|\x20','Restore\x20process\x20aborted','message','/update\x20-\x20update\x20Balance\x20Bot\x0a','then','/:bot/configuration','compareSync',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','Notifications\x20enabled','reset-password','invalid\x20credentials','add','config_orders','show-config','30\x20min','handshake','Node.js\x20v','backup-files','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','stopped','http://localhost:','\x20files\x20over\x20Telegram:','All','pidExpireLogin','padStart','botname','kind','getMonth','manual','close','backup-full.zip','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','slice','getHours','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','secret','Yes','function','SIGTERM','readFileSync','node-forge','store','sendFile','temporary\x20access\x20not\x20allowed','=>\x20Go\x20to\x20#CYA#http://','keys','All\x20bots','telegramEvents','File\x20uploaded','Notifications\x20disabled\x0a','reason','sign','getMinutes','/output-000.log',':\x20Bot\x20Mgr\x20>\x20','expiry','User\x20has\x20been\x20validated','callback','express-fileupload','includes','lowdb/adapters/FileSync',',\x20must\x20be\x20a\x204\x20digit\x20number','join','output-001.log','settings','You\x20can\x20use\x20the\x20following\x20commands:\x0a','68034AuwPLi','from','|@|','latestversion','userid','toString','download','remoteAddress','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','request','unlinkSync','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','2FA\x20required','bbvReceive','version.json','metrics_','listen','value','mode','place-order','Telegraf\x20error:','start','argv','Unauthorized\x20attempt\x20to\x20get\x20events','title','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','off','/restart\x20-\x20restart\x20bot(s)\x0a','5\x20min','stringify','Bot\x20Mgr\x20>\x20Starting\x20','privateKeyToPem','graphql-request','stop','bb/','show','\x20|\x20user:\x20...','username','backup-full@','isValid','delete-bot','http','assign','reply','Network\x20Interfaces:','-----------------------------------------------------------------------------------','Deleted\x20Bot\x20','NTBA_FIX_319','loginRequired','***','uuid-random','forEach','Starting\x20(','user','getSeconds','bbvNew','address\x20already\x20in\x20use','get','uncaughtException','yargs','sendPortfolioTelegram','BCT','copyFileSync','messages','production','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','telegrammsg','auth','.zip','host','loadAsync','RSA-OAEP','editMessageReplyMarkup','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','getDate','apiPassword','$1_$2_$3','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','2FA','10aGZDCa','send','Invalid\x20authentication\x20token\x20(2)','emit','initclient','started','max','inlineKeyboard','output-002.log','output-000.log','apply','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','bbPassword','push','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','2FA\x20login\x20token\x20generated','bot','Error\x20while\x20deleting\x20config\x20files:\x20','\x20|\x20client:\x20...','--------------------------------------','init','Notifications\x20disabled','Logged\x20out\x20user\x20...','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','createWriteStream','31125402RtdaTQ','get-backup-files','get-messages','/help\x20-\x20show\x20available\x20commands\x0a','get-starting-balances','(((.+)+)+)+$','once','disable','set','find','mkdirSync','command','#RES#','Unauthorized\x20attempt\x20to\x20download\x20','on_','type','/enable\x20-\x20enable\x20notifications\x0a','telegraf','lastmsgemitted','pidRefreshToken','logs','Unauthorized\x20attempt\x20to\x20log\x20out','enabled','staging','Running\x20#RED#Balance\x20Bot\x20v','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','decode64','Starting\x20new\x20bot\x20|\x20Bot\x20','yes','sort','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','names','telegramIpApproval','new','create','marketcapApi','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','string','IPv4','build','-performance.json','Error:\x20Invalid\x20argument\x20','parse','Password\x20has\x20been\x20reset\x20to:\x20','storeFiat','toIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20show\x20configuration','disconnect','Backup\x20file\x20unzipped\x20and\x20stored','updatebotmanager','deleteHistoryAlerts','Notifications\x20types:\x20','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','name','test','sha256','/:bot/portfolio','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','config_alerts','timestamp','resetpw_yes','match','uuid','login\x20not\x20required','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','version','/on\x20-\x20start\x20bot(s)\x0a','text','socket','Allow\x20login\x20from\x20IP\x20address\x20','clientip','************','statSync','88Amxnmb','off_','track','ipc','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','exp','restore_yes_','showname','jsonwebtoken','params','alias','-config.json','-events.json','port','/:bot','full','orders','sockets','util','Unauthorized\x20attempt\x20to\x20store\x20configuration','blacklist','\x1b[34m','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','store-configuration','0.0.0','getFullYear','/upload-backup','apiKey','toggle','mtime','Unauthorized\x20attempt\x20to\x20add\x20bot','whitelist','ETH','Backup\x20file\x20uploaded','address','bb-config.json','HTML','\x20(2)','/:bot/history','encryptedUuid','disabled','decrypt','#RES#\x20if\x20running\x20on\x20server','getPortfolio','fork','ipaddr.js','restore-backup-file','axios','referer','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','post','telegram2FaApproval','randomFillSync','f2aRequired','update','publicKeyToPem','\x1b[31m','_nsps','auto','4426456pIVmKl','\x20-\x20','onepagemode','No\x20bots\x20running\x20right\x20now','getStartingBalances','access','error','logout','showConfig','resetpw_no','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Bot\x20','/off\x20-\x20stop\x20bot(s)\x0a','open','1000','zip/','Token\x20blacklisted','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','api-eu.mixpanel.com','/names\x20-\x20show\x20bot\x20names\x0a','isIPv4MappedAddress','live','telegramToken','cloneDeep','bots','button','<b>Balance\x20Bot\x20Status:</b>\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','exit','Access\x20enabled\x20for\x20','Unauthorized\x20login\x20attempt\x20(timeout)','telegramChatId','reinstall','<b>Telegram\x20Bot\x20Status:</b>\x0a','all','timeshift','Restore\x20process\x20confirmed','chat','headers','Enabled\x20','::ffff:127.0.0.1','temporary\x20access\x20timeout',')\x20\x20\x20|\x20Bot\x20','update_no','status\x20code\x20401','SIGINT','metrics','toggle_','login2fa_reject_','botID','restart','Starting\x20Balance\x20Bot\x20reinstallation','resetHistory','hasOwnProperty','number','jszip','env','privateKey','rmSync','tkn','size','socket.io','async','botmanager','/backup\x20-\x20receive\x20backup\x20files\x0a','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','startsWith','Disabled\x20','debug','bot-','/download/:type','generateAsync','split','logged\x20out','replace','reinstall-bb','\x20mode','cancelLoading','createServer','launch','data','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','private','backup/','range','enable','token','simple','headless','family','6b67f3d61ee94b8f5c80b4affef4c4d9','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','defaults','\x20only\x0a','Password\x20reset\x20rejected','status','getTime','kill','Markdown','-results.json','login\x20token\x20generated','/metrics\x20-\x20show\x20bot\x20performance\x0a','search','704018TxWnJs','\x20minutes','file','#RES#\x20','DEFLATE','success','login','hashSync','2FA\x20login\x20required','length','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','telegramEnabled','toggleBotMode','Invalid\x20authentication\x20token\x20(1)','Invalid\x20IP\x20address','reinstall_no','Temporary\x20access\x20rejected','secure','Unauthorized\x20attempt\x20to\x20confirm\x20message','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Idling\x20(','backup-full','path','reject','bb-settings.json','login\x20token\x20valid','any','telegram','notification','*$1*','store-headless','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','Starting\x20Balance\x20Bot\x20update','alerts','\x1b[0m','map','lastmsgtelegram','lowdb','3000','bb-secure.json','bbUsername','(staging)','binary','Restarting\x20','Starting\x20#RED#Balance\x20Bot\x20v','https://api.ipify.org?format=json','action','versions','readdirSync','450480aEkgPE','filter','\x20to\x20','existsSync','server','/logs\x20-\x20receive\x20log\x20files\x0a','150197BxKWPO','code','toggle-bot-mode','Bot\x20Mgr\x20>\x20','placeOrder','publicKey','date-fns','format','login2fa_','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','index.html','tempaccess_5_','temp/','static','randomBytes','reload','Unauthorized\x20attempt\x20to\x20update\x20bot','inherit','isDirectory','sortBy','Invalid\x20username\x20or\x20IP\x20address','catch','new-disabled','accept','writeFileSync','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','storeHeadless','running','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Unauthorized\x20attempt\x20to\x20get\x20messages','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','restore_no_','store-fiat','/:bot/performance','restart_','config/','pki','write','add-bot','log','clients','backupfile','15\x20min','Failed\x20to\x20download\x20','\x20>\x20','temporaryAccessAllowed','Bot\x20Mgr\x20>\x20Toggling\x20','express','reinstall_yes','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','connected','tempaccess_reject_','files','Setting\x20access:\x20','telegramUsername','Unauthorized\x20attempt\x20to\x20get\x20portfolio','allow','whitelistEnabled','bot.js','\x1b[36m','access\x20timeout','CoinMarketCap\x20API\x20key\x20validated','backup','settings.','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','password','conn','sendMetricsTelegram','config_all'];_0x4e06=function(){return _0x4d81d4;};return _0x4e06();}function deleteBot(_0x2b07c3){const _0xa0100b=_0x49ad5f;getClientsWithBotID(_0x2b07c3)[_0xa0100b(0x192)](_0x174f59=>{const _0x191baa=_0xa0100b;getSocket(_0x174f59['id'])[_0x191baa(0x1f7)](!![]),removeClient(_0x174f59['id']);}),dbConfig['get'](_0xa0100b(0x265))[_0xa0100b(0x118)]({'botID':_0x2b07c3})['write'](),logger['full'](_0xa0100b(0x18d)+_0x2b07c3),stopBot(_0x2b07c3);try{if(fs['existsSync'](path['join'](configpath,_0xa0100b(0x292)+_0x2b07c3+_0xa0100b(0x21c))))fs[_0xa0100b(0x169)](path[_0xa0100b(0x15b)](configpath,_0xa0100b(0x292)+_0x2b07c3+'-config.json'));if(fs[_0xa0100b(0xcb)](path[_0xa0100b(0x15b)](configpath,_0xa0100b(0x292)+_0x2b07c3+_0xa0100b(0x21d))))fs[_0xa0100b(0x169)](path[_0xa0100b(0x15b)](configpath,_0xa0100b(0x292)+_0x2b07c3+_0xa0100b(0x21d)));if(fs['existsSync'](path[_0xa0100b(0x15b)](configpath,'bot-'+_0x2b07c3+_0xa0100b(0x1f0))))fs[_0xa0100b(0x169)](path['join'](configpath,_0xa0100b(0x292)+_0x2b07c3+_0xa0100b(0x1f0)));if(fs['existsSync'](path[_0xa0100b(0x15b)](configpath,_0xa0100b(0x292)+_0x2b07c3+_0xa0100b(0x2b0))))fs['unlinkSync'](path[_0xa0100b(0x15b)](configpath,_0xa0100b(0x292)+_0x2b07c3+'-results.json'));}catch(_0x3bccb4){if(_0x3bccb4)logger[_0xa0100b(0x220)](_0xa0100b(0x1c0),_0x3bccb4);}config=getConfiguration(),io['to']('botmanager')[_0xa0100b(0x1b2)](_0xa0100b(0x265),config),broadcastToBots('bots',JSON[_0xa0100b(0x17c)](config));}function toggleBot(_0x55c363,_0xb0b80f,_0x25ce0f){const _0x5c70d2=_0x49ad5f;dbConfig['get']('bots')[_0x5c70d2(0x1d1)]({'botID':_0x55c363})[_0x5c70d2(0x189)]({'status':_0xb0b80f})[_0x5c70d2(0x189)]({'live':_0x25ce0f})[_0x5c70d2(0xf4)]();const _0x1e17c8=botRef(_0x55c363);if(_0xb0b80f==_0x5c70d2(0x1de)||_0xb0b80f==_0x5c70d2(0x1e9))logger[_0x5c70d2(0x220)](_0x5c70d2(0x274)+_0x1e17c8),startBot([_0x55c363,userID],{'cwd':bbpath},function(_0xb6b65d){const _0x2c3a03=_0x5c70d2;if(_0xb6b65d)logger[_0x2c3a03(0x220)](_0xb6b65d);});else(_0xb0b80f==_0x5c70d2(0x239)||_0xb0b80f==_0x5c70d2(0xe4))&&(logger['full'](_0x5c70d2(0x290)+_0x1e17c8),stopBot(_0x55c363));config=getConfiguration(),io['to'](_0x5c70d2(0x28c))[_0x5c70d2(0x1b2)]('bots',config),broadcastToBots('bots',JSON[_0x5c70d2(0x17c)](config));}function toggleStatus(_0x520801){const _0x429dbf=_0x49ad5f;let _0x2a8d56=dbConfig[_0x429dbf(0x198)](_0x429dbf(0x265))[_0x429dbf(0x1d1)]({'botID':_0x520801})['value'](),_0x15e52a;if(_0x2a8d56['status']==='enabled')_0x15e52a=_0x429dbf(0x239);else{if(_0x2a8d56[_0x429dbf(0x2ac)]===_0x429dbf(0x1e9))_0x15e52a=_0x429dbf(0xe4);else{if(_0x2a8d56[_0x429dbf(0x2ac)]===_0x429dbf(0xe4))_0x15e52a=_0x429dbf(0x1e9);else{if(_0x2a8d56[_0x429dbf(0x2ac)]==='disabled')_0x15e52a=_0x429dbf(0x1de);}}}return _0x15e52a;}function updateStatus(_0x1bdc14,_0x2646d2){const _0x38eff5=_0x49ad5f;dbConfig[_0x38eff5(0x198)](_0x38eff5(0x265))[_0x38eff5(0x1d1)]({'botID':_0x1bdc14})[_0x38eff5(0x189)]({'status':_0x2646d2})[_0x38eff5(0xf4)](),config=getConfiguration(),io['to']('botmanager')[_0x38eff5(0x1b2)](_0x38eff5(0x265),config),broadcastToBots(_0x38eff5(0x265),JSON[_0x38eff5(0x17c)](config));}function updateLive(_0x3f253c,_0x22b251){const _0x4d8126=_0x49ad5f;dbConfig[_0x4d8126(0x198)](_0x4d8126(0x265))[_0x4d8126(0x1d1)]({'botID':_0x3f253c})[_0x4d8126(0x189)]({'live':_0x22b251})[_0x4d8126(0xf4)](),config=getConfiguration(),io['to'](_0x4d8126(0x28c))['emit'](_0x4d8126(0x265),config),broadcastToBots(_0x4d8126(0x265),JSON[_0x4d8126(0x17c)](config));}function updateBotName(_0x48775a,_0xc07749){const _0x958ac8=_0x49ad5f;dbConfig[_0x958ac8(0x198)](_0x958ac8(0x265))[_0x958ac8(0x1d1)]({'botID':_0x48775a})['assign']({'botname':_0xc07749})[_0x958ac8(0xf4)](),config=getConfiguration(),io['to']('botmanager')[_0x958ac8(0x1b2)](_0x958ac8(0x265),config),broadcastToBots(_0x958ac8(0x265),JSON[_0x958ac8(0x17c)](config));}function updateBotManager(){const _0x3d9f7f=_0x49ad5f;config=getConfiguration(),io['to']('botmanager')[_0x3d9f7f(0x1b2)](_0x3d9f7f(0x265),config),broadcastToBots(_0x3d9f7f(0x265),JSON[_0x3d9f7f(0x17c)](config));}function toggleBotMode(_0x2ea19b){const _0x57d134=_0x49ad5f;if(pid[_0x2ea19b])pid[_0x2ea19b][_0x57d134(0x1b0)]({'function':_0x57d134(0x2c0),'args':null});else{const _0x8a5352=configpath+_0x57d134(0x292)+_0x2ea19b+'-config.json',_0x2d11ef=fs[_0x57d134(0x144)](_0x8a5352),_0xa4102a=JSON[_0x57d134(0x1f2)](_0x2d11ef),_0x4c6dfa=_0xa4102a['bot'][0x0][_0x57d134(0x2a5)];_0xa4102a[_0x57d134(0x1bf)][0x0]['headless']=!_0x4c6dfa;const _0x42c1b4=JSON[_0x57d134(0x17c)](_0xa4102a,null,0x2);fs[_0x57d134(0xe6)](_0x8a5352,_0x42c1b4),config=getConfiguration(),io['to'](_0x57d134(0x28c))[_0x57d134(0x1b2)](_0x57d134(0x265),config),broadcastToBots('bots',JSON['stringify'](config));}}function validateTelegram(_0x1326a1){const _0xeec1dc=_0x49ad5f;if(_0x1326a1['from']['username']!=settings['telegramUsername']&&'@'+_0x1326a1[_0xeec1dc(0x160)][_0xeec1dc(0x184)]!=settings[_0xeec1dc(0x105)]||_0x1326a1[_0xeec1dc(0x272)]['id']!=settings['telegramChatId'])return sendTelegram(_0x1326a1[_0xeec1dc(0x272)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':'HTML'}),![];return!![];}function botRef(_0x1e5054){const _0x16247c=_0x49ad5f,_0x2aeeb7=getBotAttributes(_0x1e5054),_0x8e7bbd=_0x2aeeb7[_0x16247c(0x218)]?_0x2aeeb7[_0x16247c(0x135)]:_0x16247c(0x258)+_0x1e5054;return _0x8e7bbd;}async function initTelegram(){const _0x1cd773=_0x49ad5f;tgBot&&(await tgBot[_0x1cd773(0x180)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x1cd773(0x263)]);let _0x1e4e82=_0x1cd773(0x15e);_0x1e4e82+='\x0a',_0x1e4e82+=_0x1cd773(0x1d8),_0x1e4e82+='/disable\x20-\x20disable\x20notifications\x0a',_0x1e4e82+=_0x1cd773(0x28e),_0x1e4e82+=_0x1cd773(0x17a),_0x1e4e82+=_0x1cd773(0x20a),_0x1e4e82+=_0x1cd773(0x259),_0x1e4e82+=_0x1cd773(0x2a8),_0x1e4e82+=_0x1cd773(0x260),_0x1e4e82+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x1e4e82+=_0x1cd773(0x2b2),_0x1e4e82+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x1e4e82+=_0x1cd773(0xcd),_0x1e4e82+=_0x1cd773(0x28d),_0x1e4e82+=_0x1cd773(0x11f),_0x1e4e82+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x1e4e82+=_0x1cd773(0x1cb);let _0x5f0939=_0x1cd773(0x13c);_0x5f0939+='\x0a',_0x5f0939+=_0x1e4e82,tgBot[_0x1cd773(0xe3)]((_0x307078,_0x5da709)=>{const _0x18ca5d=_0x1cd773;logger[_0x18ca5d(0x2a4)](getTimeStamp()+_0x18ca5d(0x123)),logger[_0x18ca5d(0x291)](_0x18ca5d(0x173),_0x307078);}),tgBot[_0x1cd773(0x114)](async(_0x31bd93,_0x40aff5)=>{const _0xafa2=_0x1cd773;if(settings[_0xafa2(0x26c)]||_0x31bd93[_0xafa2(0x248)][_0xafa2(0x11e)][_0xafa2(0x20b)]!='/start'){if(!validateTelegram(_0x31bd93))return;}_0x40aff5();}),tgBot[_0x1cd773(0x1d3)](_0x1cd773(0x174),async _0x3db8e7=>{const _0x464544=_0x1cd773;if(_0x3db8e7[_0x464544(0x160)][_0x464544(0x184)]==settings[_0x464544(0x105)]||'@'+_0x3db8e7[_0x464544(0x160)][_0x464544(0x184)]==settings[_0x464544(0x105)]){if(!settings[_0x464544(0x26c)])updateSetting(_0x464544(0x26c),_0x3db8e7[_0x464544(0x272)]['id']);else{if(!validateTelegram(_0x3db8e7))return;}}else{if(!validateTelegram(_0x3db8e7))return;}updateSetting(_0x464544(0x2bf),!![]),await sendTelegram(_0x3db8e7[_0x464544(0x272)]['id'],_0x5f0939);}),tgBot[_0x1cd773(0x1d3)](_0x1cd773(0x2a2),async _0x28dca8=>{const _0x4bbb4a=_0x1cd773;updateSetting(_0x4bbb4a(0x2bf),!![]),await sendTelegram(_0x28dca8[_0x4bbb4a(0x272)]['id'],_0x4bbb4a(0x124));}),tgBot[_0x1cd773(0x1d3)](_0x1cd773(0x1cf),async _0x22dd20=>{const _0x2c3e89=_0x1cd773;await sendTelegram(_0x22dd20[_0x2c3e89(0x272)]['id'],_0x2c3e89(0x1c4)),updateSetting(_0x2c3e89(0x2bf),![]);}),tgBot[_0x1cd773(0x1d3)]('config',async _0x48b0fd=>{const _0x29e755=_0x1cd773,_0x22ad02=Markup[_0x29e755(0x1b6)]([Markup[_0x29e755(0x266)][_0x29e755(0x156)]('Orders','config_orders'),Markup[_0x29e755(0x266)][_0x29e755(0x156)]('Alerts',_0x29e755(0x202)),Markup[_0x29e755(0x266)][_0x29e755(0x156)](_0x29e755(0x132),_0x29e755(0x113))]);_0x48b0fd[_0x29e755(0x18a)](_0x29e755(0xe8),_0x22ad02);}),tgBot[_0x1cd773(0xc5)](_0x1cd773(0x128),async _0x4f73ed=>{const _0x27edd3=_0x1cd773;_0x4f73ed[_0x27edd3(0x1a7)](),updateSetting(_0x27edd3(0x14c),'orders'),updateSetting(_0x27edd3(0x2bf),!![]),await sendTelegram(_0x4f73ed[_0x27edd3(0x272)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x1cd773(0xc5)]('config_alerts',async _0x3c60e4=>{const _0x4c651d=_0x1cd773;_0x3c60e4[_0x4c651d(0x1a7)](),updateSetting(_0x4c651d(0x14c),_0x4c651d(0xb8)),updateSetting(_0x4c651d(0x2bf),!![]),await sendTelegram(_0x3c60e4[_0x4c651d(0x272)]['id'],_0x4c651d(0x2c7));}),tgBot[_0x1cd773(0xc5)](_0x1cd773(0x113),async _0x3d848e=>{const _0x32a8e0=_0x1cd773;_0x3d848e['editMessageReplyMarkup'](),updateSetting(_0x32a8e0(0x14c),'all'),updateSetting(_0x32a8e0(0x2bf),!![]),await sendTelegram(_0x3d848e['chat']['id'],_0x32a8e0(0x215));}),tgBot[_0x1cd773(0x1d3)](_0x1cd773(0x2ac),async _0x499ee1=>{const _0x1bdfe7=_0x1cd773,_0x5ad5b2=getBotsWithMode();let _0x14a5d6=_0x1bdfe7(0x267);config['forEach'](_0x25214d=>{const _0x4e8834=_0x1bdfe7,_0x134b79=_0x5ad5b2[_0x4e8834(0x1d1)](_0x1b2057=>_0x1b2057[_0x4e8834(0x27e)]==_0x25214d['botID'])[_0x4e8834(0x171)];_0x14a5d6+='Bot\x20'+_0x25214d[_0x4e8834(0x27e)]+':\x20'+_0x25214d['status']+_0x4e8834(0x11c)+_0x134b79+'\x20|\x20'+_0x25214d[_0x4e8834(0x262)]+'\x0a';}),_0x14a5d6+='\x0a',_0x14a5d6+=_0x1bdfe7(0x26e),_0x14a5d6+=!settings[_0x1bdfe7(0x2bf)]?_0x1bdfe7(0x14e):_0x1bdfe7(0x11a),_0x14a5d6+=settings[_0x1bdfe7(0x2bf)]?settings[_0x1bdfe7(0x14c)]==_0x1bdfe7(0x26f)?_0x1bdfe7(0x227):_0x1bdfe7(0x1fb)+settings['telegramEvents']+_0x1bdfe7(0x2aa):'',await sendTelegram(_0x499ee1[_0x1bdfe7(0x272)]['id'],_0x14a5d6,{'parse_mode':_0x1bdfe7(0x235)});}),tgBot[_0x1cd773(0x1d3)](_0x1cd773(0x27f),async _0x20df20=>{const _0x293a0e=_0x1cd773,_0x51ffd1=getEnabledBots();if(_0x51ffd1[_0x293a0e(0x2bd)]==0x0)await sendTelegram(_0x20df20[_0x293a0e(0x272)]['id'],_0x293a0e(0x250));else{if(_0x51ffd1[_0x293a0e(0x2bd)]>0x1)_0x51ffd1[_0x293a0e(0x1bc)]({'botID':_0x293a0e(0x26f)});let _0x196536=[],_0x34b65f=[];const _0x4a37dc=_0x51ffd1['length']%0x4==0x0||_0x51ffd1[_0x293a0e(0x2bd)]%0x4==0x3||_0x51ffd1[_0x293a0e(0x2bd)]%0x3==0x1?0x4:0x3;let _0x1904cc=0x0;_0x51ffd1['forEach']((_0x2d0949,_0x5ea0ce)=>{const _0x3e791f=_0x293a0e;if(_0x5ea0ce%_0x4a37dc==0x0)_0x34b65f=[];_0x34b65f[_0x3e791f(0x1bc)](Markup[_0x3e791f(0x266)][_0x3e791f(0x156)](_0x2d0949[_0x3e791f(0x27e)]==_0x3e791f(0x26f)?_0x3e791f(0x14b):botRef(_0x2d0949[_0x3e791f(0x27e)]),_0x3e791f(0xf1)+_0x2d0949[_0x3e791f(0x27e)])),_0x5ea0ce%_0x4a37dc==0x0&&(_0x196536[_0x1904cc]=_0x34b65f,_0x1904cc++);});const _0x26f9cc=Markup['inlineKeyboard'](_0x196536);_0x20df20[_0x293a0e(0x18a)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x26f9cc);}}),tgBot[_0x1cd773(0xc5)](/restart_(.+)/,async _0xff12dc=>{const _0x5b16f3=_0x1cd773,_0xe20586=_0xff12dc[_0x5b16f3(0x205)][0x1];_0xff12dc['editMessageReplyMarkup'](),_0xe20586==_0x5b16f3(0x26f)?config['forEach'](_0x63aa97=>{const _0x120be3=_0x5b16f3;restartBot(_0x63aa97[_0x120be3(0x27e)]);}):restartBot(_0xe20586);}),tgBot[_0x1cd773(0x1d3)]('on',async _0x54551b=>{const _0x336b7a=_0x1cd773,_0x40670e=getDisabledBots();if(_0x40670e[_0x336b7a(0x2bd)]==0x0)await sendTelegram(_0x54551b['chat']['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x40670e[_0x336b7a(0x2bd)]>0x1)_0x40670e['push']({'botID':'all'});let _0x82bd27=[],_0x670100=[];const _0x3b0a3b=_0x40670e['length']%0x4==0x0||_0x40670e[_0x336b7a(0x2bd)]%0x4==0x3||_0x40670e[_0x336b7a(0x2bd)]%0x3==0x1?0x4:0x3;let _0x214a8a=0x0;_0x40670e[_0x336b7a(0x192)]((_0x474168,_0x4654d0)=>{const _0x595c64=_0x336b7a;if(_0x4654d0%_0x3b0a3b==0x0)_0x670100=[];_0x670100['push'](Markup['button'][_0x595c64(0x156)](_0x474168[_0x595c64(0x27e)]=='all'?'All\x20bots':botRef(_0x474168[_0x595c64(0x27e)]),_0x595c64(0x1d6)+_0x474168[_0x595c64(0x27e)])),_0x4654d0%_0x3b0a3b==0x0&&(_0x82bd27[_0x214a8a]=_0x670100,_0x214a8a++);});const _0x1f4346=Markup[_0x336b7a(0x1b6)](_0x82bd27);_0x54551b['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x1f4346);}}),tgBot[_0x1cd773(0xc5)](/on_(.+)/,async _0x124a0e=>{const _0x4baa99=_0x1cd773,_0x285aba=_0x124a0e[_0x4baa99(0x205)][0x1];_0x124a0e[_0x4baa99(0x1a7)]();if(_0x285aba==_0x4baa99(0x26f)){const _0xbd1315=getDisabledBots();await sendTelegram(_0x124a0e[_0x4baa99(0x272)]['id'],_0x4baa99(0x2be)),_0xbd1315[_0x4baa99(0x192)](_0x10038e=>{const _0x312d67=_0x4baa99;if(_0x10038e[_0x312d67(0x27e)]!=_0x312d67(0x26f))toggleBot(_0x10038e[_0x312d67(0x27e)],toggleStatus(_0x10038e['botID']),_0x312d67(0x12f));});}else await sendTelegram(_0x124a0e['chat']['id'],_0x4baa99(0x17d)+botRef(_0x285aba)),toggleBot(_0x285aba,toggleStatus(_0x285aba),_0x4baa99(0x12f));}),tgBot['command'](_0x1cd773(0x179),async _0x221199=>{const _0x13adbb=_0x1cd773,_0x3d2916=getEnabledBots();if(_0x3d2916[_0x13adbb(0x2bd)]==0x0)await sendTelegram(_0x221199[_0x13adbb(0x272)]['id'],_0x13adbb(0x250));else{if(_0x3d2916['length']>0x1)_0x3d2916[_0x13adbb(0x1bc)]({'botID':_0x13adbb(0x26f)});let _0x1d36b5=[],_0x4a1b9d=[];const _0x4576b1=_0x3d2916[_0x13adbb(0x2bd)]%0x4==0x0||_0x3d2916['length']%0x4==0x3||_0x3d2916[_0x13adbb(0x2bd)]%0x3==0x1?0x4:0x3;let _0x2ca1bb=0x0;_0x3d2916[_0x13adbb(0x192)]((_0x49b78e,_0x5ad990)=>{const _0x424977=_0x13adbb;if(_0x5ad990%_0x4576b1==0x0)_0x4a1b9d=[];_0x4a1b9d[_0x424977(0x1bc)](Markup['button']['callback'](_0x49b78e[_0x424977(0x27e)]==_0x424977(0x26f)?_0x424977(0x14b):botRef(_0x49b78e[_0x424977(0x27e)]),_0x424977(0x212)+_0x49b78e['botID'])),_0x5ad990%_0x4576b1==0x0&&(_0x1d36b5[_0x2ca1bb]=_0x4a1b9d,_0x2ca1bb++);});const _0x2833e6=Markup[_0x13adbb(0x1b6)](_0x1d36b5);_0x221199[_0x13adbb(0x18a)](_0x13adbb(0x268),_0x2833e6);}}),tgBot[_0x1cd773(0xc5)](/off_(.+)/,async _0x48c2dd=>{const _0x47d3cf=_0x1cd773,_0x1e3ffc=_0x48c2dd[_0x47d3cf(0x205)][0x1];_0x48c2dd[_0x47d3cf(0x1a7)]();if(_0x1e3ffc==_0x47d3cf(0x26f)){const _0x46f9e8=getEnabledBots();await sendTelegram(_0x48c2dd[_0x47d3cf(0x272)]['id'],_0x47d3cf(0x243)),_0x46f9e8['forEach'](_0xcc8481=>{const _0x3f9bf8=_0x47d3cf;if(_0xcc8481[_0x3f9bf8(0x27e)]!=_0x3f9bf8(0x26f))toggleBot(_0xcc8481[_0x3f9bf8(0x27e)],toggleStatus(_0xcc8481[_0x3f9bf8(0x27e)]),'stopped');});}else await sendTelegram(_0x48c2dd['chat']['id'],'Bot\x20Mgr\x20>\x20Stopping\x20'+botRef(_0x1e3ffc)),toggleBot(_0x1e3ffc,toggleStatus(_0x1e3ffc),_0x47d3cf(0x12f));}),tgBot[_0x1cd773(0x1d3)](_0x1cd773(0x27b),async _0x5dae60=>{const _0x2c8dca=_0x1cd773,_0x846357=getEnabledBots();if(_0x846357[_0x2c8dca(0x2bd)]==0x0)await sendTelegram(_0x5dae60['chat']['id'],_0x2c8dca(0x250));else{if(_0x846357['length']>0x1){let _0x248b9b=[],_0x5acb02=[];const _0x1bda4d=_0x846357['length']%0x4==0x0||_0x846357[_0x2c8dca(0x2bd)]%0x4==0x3||_0x846357[_0x2c8dca(0x2bd)]%0x3==0x1?0x4:0x3;let _0x46ed4f=0x0;_0x846357['forEach']((_0x5029ad,_0x1960c2)=>{const _0x367a9b=_0x2c8dca;if(_0x1960c2%_0x1bda4d==0x0)_0x5acb02=[];_0x5acb02[_0x367a9b(0x1bc)](Markup[_0x367a9b(0x266)][_0x367a9b(0x156)](botRef(_0x5029ad[_0x367a9b(0x27e)]),_0x367a9b(0x16e)+_0x5029ad[_0x367a9b(0x27e)])),_0x1960c2%_0x1bda4d==0x0&&(_0x248b9b[_0x46ed4f]=_0x5acb02,_0x46ed4f++);});const _0x2a8584=Markup[_0x2c8dca(0x1b6)](_0x248b9b);_0x5dae60[_0x2c8dca(0x18a)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x2a8584);}else{const _0x2fffc1=_0x846357[0x0][_0x2c8dca(0x27e)];if(pid[_0x2fffc1])pid[_0x2fffc1][_0x2c8dca(0x1b0)]({'function':_0x2c8dca(0x112),'args':null});}}}),tgBot[_0x1cd773(0xc5)](/metrics_(.+)/,async _0x35eaeb=>{const _0x1d1981=_0x1cd773,_0xa55b03=_0x35eaeb[_0x1d1981(0x205)][0x1];_0x35eaeb[_0x1d1981(0x1a7)]();if(pid[_0xa55b03])pid[_0xa55b03][_0x1d1981(0x1b0)]({'function':_0x1d1981(0x112),'args':null});}),tgBot[_0x1cd773(0x1d3)]('portfolio',async _0x5a32dd=>{const _0x322889=_0x1cd773,_0xd77677=getEnabledBots();if(_0xd77677[_0x322889(0x2bd)]==0x0)await sendTelegram(_0x5a32dd[_0x322889(0x272)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0xd77677[_0x322889(0x2bd)]>0x1){let _0x3688fd=[],_0x264d8a=[];const _0x4d1a07=_0xd77677['length']%0x4==0x0||_0xd77677[_0x322889(0x2bd)]%0x4==0x3||_0xd77677[_0x322889(0x2bd)]%0x3==0x1?0x4:0x3;let _0x489100=0x0;_0xd77677['forEach']((_0x448d59,_0x4961ee)=>{const _0x474f37=_0x322889;if(_0x4961ee%_0x4d1a07==0x0)_0x264d8a=[];_0x264d8a['push'](Markup['button']['callback'](botRef(_0x448d59[_0x474f37(0x27e)]),'portfolio_'+_0x448d59['botID'])),_0x4961ee%_0x4d1a07==0x0&&(_0x3688fd[_0x489100]=_0x264d8a,_0x489100++);});const _0x3dbea5=Markup[_0x322889(0x1b6)](_0x3688fd);_0x5a32dd['reply'](_0x322889(0x1ad),_0x3dbea5);}else{const _0x39208b=_0xd77677[0x0][_0x322889(0x27e)];if(pid[_0x39208b])pid[_0x39208b][_0x322889(0x1b0)]({'function':_0x322889(0x19b),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x46661b=>{const _0x5c0b44=_0x1cd773,_0x2b7a75=_0x46661b['match'][0x1];_0x46661b[_0x5c0b44(0x1a7)]();if(pid[_0x2b7a75])pid[_0x2b7a75][_0x5c0b44(0x1b0)]({'function':_0x5c0b44(0x19b),'args':null});}),tgBot[_0x1cd773(0x1d3)]('logs',async _0x42a442=>{const _0x5d29fd=_0x1cd773,_0x40bcd9=_0x5d29fd(0x1dc);await zipFiles(_0x40bcd9);const _0x1ab143=zippath+(_0x40bcd9+_0x5d29fd(0x1a3));_0x42a442['replyWithDocument']({'source':_0x1ab143})[_0x5d29fd(0x120)](()=>{})[_0x5d29fd(0xe3)](_0x4958a0=>logger[_0x5d29fd(0x291)]('Error\x20sending\x20'+_0x40bcd9+_0x5d29fd(0x131),_0x4958a0));}),tgBot[_0x1cd773(0x1d3)](_0x1cd773(0x10d),async _0x1008bd=>{const _0x544c4b=_0x1cd773,_0x58b27c='backup';await backupConfigFiles(),await zipFiles(_0x58b27c);const _0x11219d=zippath+(_0x58b27c+_0x544c4b(0x1a3));_0x1008bd['replyWithDocument']({'source':_0x11219d})[_0x544c4b(0x120)](()=>{})[_0x544c4b(0xe3)](_0x138668=>logger[_0x544c4b(0x291)]('Error\x20sending\x20'+_0x58b27c+_0x544c4b(0x131),_0x138668));}),tgBot[_0x1cd773(0x1d3)](_0x1cd773(0x248),async _0x2d8369=>{const _0x7561b9=_0x1cd773;await getMessages();if(!updateAvailable)await sendTelegram(_0x2d8369[_0x7561b9(0x272)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x2d8369[_0x7561b9(0x272)]['id'],_0x7561b9(0x1e1));else{const _0x26aed0=Markup[_0x7561b9(0x1b6)]([Markup[_0x7561b9(0x266)][_0x7561b9(0x156)](_0x7561b9(0x141),'update_yes'),Markup[_0x7561b9(0x266)][_0x7561b9(0x156)]('No',_0x7561b9(0x278))]);_0x2d8369[_0x7561b9(0x18a)](_0x7561b9(0xd7),_0x26aed0);}}}),tgBot[_0x1cd773(0xc5)](/update_(.+)/,async _0x2d9887=>{const _0xa5da22=_0x1cd773,_0x4bb8d1=_0x2d9887[_0xa5da22(0x205)][0x1];_0x2d9887[_0xa5da22(0x1a7)](),_0x4bb8d1==_0xa5da22(0x1e4)&&(await sendTelegram(_0x2d9887[_0xa5da22(0x272)]['id'],_0xa5da22(0xb7)),updateBB(_0xa5da22(0x248))),_0x4bb8d1=='no'&&await sendTelegram(_0x2d9887[_0xa5da22(0x272)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x1cd773(0x1d3)]('reinstall',async _0x3a85bb=>{const _0x4a4adb=_0x1cd773;if(!validInstallation)await sendTelegram(_0x3a85bb[_0x4a4adb(0x272)]['id'],_0x4a4adb(0x13f));else{const _0x13bb2d=Markup[_0x4a4adb(0x1b6)]([Markup[_0x4a4adb(0x266)][_0x4a4adb(0x156)](_0x4a4adb(0x141),_0x4a4adb(0xff)),Markup[_0x4a4adb(0x266)]['callback']('No',_0x4a4adb(0x2c3))]);_0x3a85bb[_0x4a4adb(0x18a)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x13bb2d);}}),tgBot[_0x1cd773(0xc5)](/reinstall_(.+)/,async _0xf91865=>{const _0xbd50b2=_0x1cd773,_0x12c093=_0xf91865[_0xbd50b2(0x205)][0x1];_0xf91865[_0xbd50b2(0x1a7)](),_0x12c093==_0xbd50b2(0x1e4)&&(await sendTelegram(_0xf91865['chat']['id'],_0xbd50b2(0x280)),updateBB(_0xbd50b2(0x26d))),_0x12c093=='no'&&await sendTelegram(_0xf91865[_0xbd50b2(0x272)]['id'],_0xbd50b2(0x1bd));}),tgBot[_0x1cd773(0x1d3)](_0x1cd773(0x22d),async _0x3b41db=>{const _0x26c757=_0x1cd773,_0x4bd4fa=getBotsWithMode();if(_0x4bd4fa[_0x26c757(0x2bd)]==0x0)await sendTelegram(_0x3b41db[_0x26c757(0x272)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x4adf20=[],_0x55898f=[];const _0x26e29f=0x2;let _0x2f230b=0x0;_0x4bd4fa['forEach']((_0x3fc58a,_0x17eeeb)=>{const _0x5eda0a=_0x26c757;if(_0x17eeeb%_0x26e29f==0x0)_0x55898f=[];_0x55898f[_0x5eda0a(0x1bc)](Markup[_0x5eda0a(0x266)][_0x5eda0a(0x156)](botRef(_0x3fc58a['botID'])+'\x20('+_0x3fc58a['mode']+')',_0x5eda0a(0x27c)+_0x3fc58a[_0x5eda0a(0x27e)])),_0x17eeeb%_0x26e29f==0x0&&(_0x4adf20[_0x2f230b]=_0x55898f,_0x2f230b++);});const _0x3218be=Markup['inlineKeyboard'](_0x4adf20);_0x3b41db['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x3218be);}}),tgBot[_0x1cd773(0xc5)](/toggle_(.+)/,async _0x5b018d=>{const _0x36433c=_0x1cd773,_0x232a49=_0x5b018d[_0x36433c(0x205)][0x1];_0x5b018d[_0x36433c(0x1a7)]();const _0xe25743=getBotsWithMode(),_0x32af62=_0xe25743[_0x36433c(0x1d1)](_0x2cf1b2=>_0x2cf1b2['botID']==_0x232a49),_0x1a4867=_0x32af62[_0x36433c(0x171)]==_0x36433c(0x24c)?_0x36433c(0x138):'auto';await sendTelegram(_0x5b018d[_0x36433c(0x272)]['id'],_0x36433c(0xfd)+botRef(_0x32af62[_0x36433c(0x27e)])+_0x36433c(0xca)+_0x1a4867+_0x36433c(0x299)),toggleBotMode(_0x232a49);}),tgBot[_0x1cd773(0x1d3)](_0x1cd773(0x1e7),async _0x109b0a=>{const _0x2cc090=_0x1cd773;let _0x55232a='';config[_0x2cc090(0x192)](_0x42ad5e=>{const _0x5f4d07=_0x2cc090;_0x55232a+=_0x5f4d07(0x258)+_0x42ad5e[_0x5f4d07(0x27e)]+':\x20'+_0x42ad5e[_0x5f4d07(0x135)]+'\x0a';}),await sendTelegram(_0x109b0a[_0x2cc090(0x272)]['id'],_0x55232a,{'parse_mode':_0x2cc090(0x235)});}),tgBot['command']('help',async _0x177639=>{const _0x3be00e=_0x1cd773;await sendTelegram(_0x177639[_0x3be00e(0x272)]['id'],_0x1e4e82);}),process[_0x1cd773(0x1ce)](_0x1cd773(0x27a),()=>tgBot[_0x1cd773(0x180)](_0x1cd773(0x27a))),process[_0x1cd773(0x1ce)](_0x1cd773(0x143),()=>tgBot[_0x1cd773(0x180)](_0x1cd773(0x143))),tgBot[_0x1cd773(0x29c)]();}function disableTelegram(){const _0x489555=_0x49ad5f;tgBot&&tgBot[_0x489555(0x180)]();}async function sendTelegram(_0x3f04d1,_0x155f4f,_0x296d19){_0x296d19={..._0x296d19,'disable_web_page_preview':!![]};try{await tgBot['telegram']['sendMessage'](_0x3f04d1,_0x155f4f,_0x296d19);}catch(_0x418a86){logger['debug']('Telegram\x20error:',_0x418a86);}}async function sendTelegramBot(_0x2f55a3,_0xbc72b0){const _0x326f69=_0x49ad5f;if(settings[_0x326f69(0x2bf)]){if(settings[_0x326f69(0x14c)]==_0x326f69(0x26f)||(_0xbc72b0[_0x326f69(0x1d7)]==_0x326f69(0x253)||_0xbc72b0[_0x326f69(0x1d7)]=='warning'||_0xbc72b0[_0x326f69(0x1d7)]=='success')&&settings[_0x326f69(0x14c)]=='alerts'||_0xbc72b0['type']=='order'&&settings['telegramEvents']==_0x326f69(0x221)){if(tgBot&&settings[_0x326f69(0x26c)]){if(_0xbc72b0[_0x326f69(0x218)])await sendTelegram(settings[_0x326f69(0x26c)],_0xbc72b0['botname']+_0x326f69(0xfb)+_0xbc72b0['event']);else await sendTelegram(settings['telegramChatId'],_0x326f69(0x258)+_0x2f55a3+'\x20>\x20'+_0xbc72b0['event']);}}}}async function sendTelegramMsg(_0x210567,_0x1aa468='HTML'){const _0x16aafd=_0x49ad5f;return tgBot&&settings[_0x16aafd(0x26c)]?(await sendTelegram(settings[_0x16aafd(0x26c)],_0x210567,{'parse_mode':_0x1aa468}),!![]):![];}function getDeviceWithIp(_0x241d7f){const _0x51f307=_0x49ad5f;return devices[_0x51f307(0x1d1)](_0x4c791b=>_0x4c791b['ip']===_0x241d7f);}async function temporaryAccess2FA(_0x427381,_0x10f3ac){const _0x56de9c=_0x49ad5f;let _0x4d6205=new Date(),_0x1eb001=![];if(lastIpApproval){if(_0x4d6205-lastIpApproval<0x1388)_0x1eb001=!![];}lastIpApproval=new Date();if(_0x1eb001)return;if(tgBot&&settings[_0x56de9c(0x26c)]){const _0x46f323=uuidRandom();tmpStorage[_0x46f323]={'uuid':_0x427381,'externalip':_0x10f3ac};const _0x3d258f=Markup[_0x56de9c(0x1b6)]([Markup['button'][_0x56de9c(0x156)](_0x56de9c(0x17b),_0x56de9c(0xd9)+_0x46f323),Markup[_0x56de9c(0x266)][_0x56de9c(0x156)](_0x56de9c(0xf9),_0x56de9c(0x116)+_0x46f323),Markup[_0x56de9c(0x266)][_0x56de9c(0x156)](_0x56de9c(0x12a),'tempaccess_30_'+_0x46f323),Markup[_0x56de9c(0x266)][_0x56de9c(0x156)](_0x56de9c(0x2cb),_0x56de9c(0x102)+_0x46f323)]);await sendTelegram(settings[_0x56de9c(0x26c)],_0x56de9c(0x167)+normalizeIP(_0x10f3ac)['show']+'\x20?',_0x3d258f),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x38c07c=>{const _0x35ef30=_0x56de9c,_0x32832d=_0x38c07c[_0x35ef30(0x205)][0x1],_0x124096=_0x38c07c[_0x35ef30(0x205)][0x2],{uuid:_0x593768,externalip:_0x239882}=tmpStorage[_0x124096];delete tmpStorage[_0x124096],_0x38c07c[_0x35ef30(0x1a7)](),devices[_0x593768][_0x35ef30(0x1e8)]={'clientip':_0x239882,'timestamp':new Date()[_0x35ef30(0x2ad)](),'expiry':_0x32832d},_0x32832d!=_0x35ef30(0x2cb)?(await sendTelegram(_0x38c07c[_0x35ef30(0x272)]['id'],_0x35ef30(0x26a)+_0x32832d+_0x35ef30(0x2b5),{'parse_mode':_0x35ef30(0x235)}),io['to'](_0x593768)[_0x35ef30(0x1b2)]('status',{'access':{'allow':![],'reason':_0x35ef30(0xdd),'token':null}})):(await sendTelegram(_0x38c07c[_0x35ef30(0x272)]['id'],_0x35ef30(0x2c4)),io['to'](_0x593768)[_0x35ef30(0x1b2)](_0x35ef30(0x2ac),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x522869,_0xf72730){const _0x53fef6=_0x49ad5f;if(tgBot&&settings[_0x53fef6(0x26c)]){const _0xbb63ed=uuidRandom();tmpStorage[_0xbb63ed]={'uuid':_0x522869,'externalip':_0xf72730};const _0x488d3f=Markup[_0x53fef6(0x1b6)]([Markup['button'][_0x53fef6(0x156)](_0x53fef6(0xe5),_0x53fef6(0xd6)+loginExpiry+'_'+_0xbb63ed),Markup['button'][_0x53fef6(0x156)]('reject',_0x53fef6(0x27d)+_0xbb63ed)]);await sendTelegram(settings[_0x53fef6(0x26c)],_0x53fef6(0x20d)+normalizeIP(_0xf72730)[_0x53fef6(0x182)]+'\x20?',_0x488d3f),tgBot[_0x53fef6(0xc5)](/login2fa_(.+)_(.+)/,async _0x37cc8d=>{const _0x4e5524=_0x53fef6,_0x2377e5=_0x37cc8d[_0x4e5524(0x205)][0x1],_0xe474b3=_0x37cc8d[_0x4e5524(0x205)][0x2],{uuid:_0x1023be,externalip:_0x302189}=tmpStorage[_0xe474b3];delete tmpStorage[_0xe474b3],_0x37cc8d[_0x4e5524(0x1a7)](),devices[_0x1023be][_0x4e5524(0x245)]={'clientip':_0x302189,'timestamp':new Date()[_0x4e5524(0x2ad)](),'expiry':_0x2377e5},_0x2377e5!=_0x4e5524(0x2cb)?(await sendTelegram(_0x37cc8d[_0x4e5524(0x272)]['id'],'Login\x20accepted',{'parse_mode':_0x4e5524(0x235)}),io['to'](_0x1023be)['emit'](_0x4e5524(0x2ac),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x37cc8d[_0x4e5524(0x272)]['id'],'Login\x20rejected'),io['to'](_0x1023be)[_0x4e5524(0x1b2)](_0x4e5524(0x2ac),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x35a8bc=_0x49ad5f;return dbConfig[_0x35a8bc(0x198)](_0x35a8bc(0x265))[_0x35a8bc(0xe1)](_0x35a8bc(0x27e))['filter']({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x3dd152=_0x49ad5f;return dbConfig[_0x3dd152(0x198)](_0x3dd152(0x265))['sortBy']('botID')[_0x3dd152(0xc9)]({'status':_0x3dd152(0x239)})[_0x3dd152(0x170)]()||[];}function getBotAttributes(_0xfc8afa){const _0x32da81=_0x49ad5f;let _0x1d6b49={};const _0x3a28b5=configpath+_0x32da81(0x292)+_0xfc8afa+_0x32da81(0x21c),_0x14dfdf=fs[_0x32da81(0xcb)](_0x3a28b5);if(_0x14dfdf){const _0x30b49a=fs[_0x32da81(0x144)](_0x3a28b5);try{const _0x3ad27d=JSON['parse'](_0x30b49a),_0x14b32b=_0x3ad27d?_0x3ad27d['bot'][0x0][_0x32da81(0x2a5)]:![];_0x1d6b49['mode']=_0x14b32b?_0x32da81(0x24c):_0x32da81(0x138),_0x1d6b49[_0x32da81(0x135)]=_0x3ad27d?_0x3ad27d[_0x32da81(0x1bf)][0x0][_0x32da81(0x135)]:_0x32da81(0x258)+_0xfc8afa,_0x1d6b49[_0x32da81(0x218)]=_0x3ad27d?_0x3ad27d[_0x32da81(0x1bf)][0x0][_0x32da81(0x218)]:![];}catch(_0x446e28){_0x1d6b49[_0x32da81(0x171)]=_0x32da81(0x138),_0x1d6b49[_0x32da81(0x135)]='Bot\x20'+_0xfc8afa,_0x1d6b49['showname']=![];}}else _0x1d6b49[_0x32da81(0x171)]=_0x32da81(0x138),_0x1d6b49[_0x32da81(0x135)]=_0x32da81(0x258)+_0xfc8afa,_0x1d6b49[_0x32da81(0x218)]=![];return _0x1d6b49;}function getBotsWithMode(){const _0x114de4=_0x49ad5f,_0x5bdeab=dbConfig[_0x114de4(0x198)](_0x114de4(0x265))[_0x114de4(0xe1)](_0x114de4(0x27e))[_0x114de4(0x170)]()||[];return _0x5bdeab[_0x114de4(0x192)](_0x283990=>{const _0x52a0ad=_0x114de4;let _0x44fd59=getBotAttributes(_0x283990['botID']);_0x283990['mode']=_0x44fd59[_0x52a0ad(0x171)];}),_0x5bdeab;}function getBotExchanges(){const _0x20c0e9=_0x49ad5f;let _0x3474d7=[];const _0x1e98dc=dbConfig[_0x20c0e9(0x198)](_0x20c0e9(0x265))[_0x20c0e9(0xe1)](_0x20c0e9(0x27e))[_0x20c0e9(0x170)]()||[];_0x1e98dc[_0x20c0e9(0x192)](_0x5e55d4=>{const _0x5ae643=_0x20c0e9;if(_0x5e55d4[_0x5ae643(0x2ac)]=='enabled'){const _0x4de153=configpath+'bot-'+_0x5e55d4['botID']+_0x5ae643(0x21c),_0x55fab2=fs['existsSync'](_0x4de153);let _0x365fbd;if(_0x55fab2){const _0x4cb94b=fs[_0x5ae643(0x144)](_0x4de153);try{const _0xc6e447=JSON[_0x5ae643(0x1f2)](_0x4cb94b);_0x365fbd=_0xc6e447?_0xc6e447['bot'][0x0]['exchange']:null;}catch(_0x4c4ba6){}}if(_0x365fbd)_0x3474d7[_0x5ae643(0x1bc)](_0x365fbd);}});const _0x540856=[...new Set(_0x3474d7)][_0x20c0e9(0x1e5)]();return _0x540856;}async function initUser(){const _0x2b3e16=_0x49ad5f;if(!settings[_0x2b3e16(0x163)]){const _0x3fa2a5=uuidRandom();mixpanel[_0x2b3e16(0x21b)](_0x3fa2a5),updateSetting(_0x2b3e16(0x163),_0x3fa2a5);}}async function initSecure(){const _0x373949=_0x49ad5f;let _0x2f2137=getSecure();if(!_0x2f2137[_0x373949(0x282)]('secret')){let _0x4ee55e=await generateKeys();_0x2f2137[_0x373949(0xd3)]=_0x4ee55e['publicKey'],_0x2f2137[_0x373949(0x286)]=_0x4ee55e[_0x373949(0x286)],_0x2f2137[_0x373949(0x140)]=crypto[_0x373949(0xdc)](0x20)[_0x373949(0x164)]('hex');;storeSecure(_0x2f2137);}}function getSettings(){const _0xfee5d8=_0x49ad5f;return dbSettings['get'](_0xfee5d8(0x15d))[_0xfee5d8(0x170)]()||{};}function getSecure(){const _0x1c9242=_0x49ad5f;return dbSecure[_0x1c9242(0x198)](_0x1c9242(0x2c5))[_0x1c9242(0x170)]()||{};}function getBlacklist(){const _0x369b47=_0x49ad5f;return dbSecure[_0x369b47(0x198)](_0x369b47(0x225))[_0x369b47(0x170)]()||[];}function _0x496f(_0x3c50c2,_0x2e3a95){const _0x130257=_0x4e06();return _0x496f=function(_0x30e105,_0x3fa114){_0x30e105=_0x30e105-0xb5;let _0x4e06f9=_0x130257[_0x30e105];return _0x4e06f9;},_0x496f(_0x3c50c2,_0x2e3a95);}function broadcastToBots(_0x16b38f,_0x225905){const _0x330cc2=_0x49ad5f;config[_0x330cc2(0x192)](_0x41a2e5=>{const _0x5d96b9=_0x330cc2;if(_0x41a2e5['status']==_0x5d96b9(0x1de)&&_0x41a2e5['live']==_0x5d96b9(0xea)||_0x41a2e5[_0x5d96b9(0x2ac)]==_0x5d96b9(0x1e9)&&_0x41a2e5['live']==_0x5d96b9(0xea)){if(pid[_0x41a2e5[_0x5d96b9(0x27e)]])pid[_0x41a2e5[_0x5d96b9(0x27e)]]['send']({[_0x16b38f]:_0x225905});}});}async function storeSettings(_0x485974,_0xe1cf17=![]){const _0x11dc48=_0x49ad5f;_0x485974={...settings,..._0x485974};if(_0xe1cf17&&_0x485974['bbPassword']!=_0x11dc48(0x20f)&&_0x485974[_0x11dc48(0x1bb)]!=_0x11dc48(0x190)&&_0x485974[_0x11dc48(0x1bb)]!=''){const _0x336347=decryptRSA(secure['privateKey'],_0x485974[_0x11dc48(0x1bb)])['split']('|@|')[0x0],_0x2322a6=bcrypt[_0x11dc48(0x2bb)](_0x336347,saltRounds);_0x485974={..._0x485974,'bbPassword':_0x2322a6};}if(_0xe1cf17&&_0x485974[_0x11dc48(0x263)]!=_0x11dc48(0x20f)&&_0x485974[_0x11dc48(0x263)]!='***'&&_0x485974[_0x11dc48(0x263)]!=''){const _0x38bbdf=decryptRSA(secure['privateKey'],_0x485974[_0x11dc48(0x263)])[_0x11dc48(0x295)](_0x11dc48(0x161))[0x0];_0x485974={..._0x485974,'telegramToken':_0x38bbdf};}if(_0xe1cf17&&_0x485974['marketcapApi']!=_0x11dc48(0x20f)&&_0x485974['marketcapApi']!=_0x11dc48(0x190)&&_0x485974[_0x11dc48(0x1eb)]!=''){const _0x58cdde=decryptRSA(secure[_0x11dc48(0x286)],_0x485974[_0x11dc48(0x1eb)])[_0x11dc48(0x295)]('|@|')[0x0];_0x485974={..._0x485974,'marketcapApi':_0x58cdde};}const _0xab8213=_0x485974[_0x11dc48(0x263)]!=_0x11dc48(0x20f)&&_0x485974[_0x11dc48(0x263)]!=settings[_0x11dc48(0x263)]||_0x485974['telegramUsername']!=settings['telegramUsername'],_0x22f4ab=_0x485974['telegramToken']==''||_0x485974[_0x11dc48(0x105)]=='',_0x40e2e6=_0x485974['marketcapApi']&&_0x485974[_0x11dc48(0x1eb)]!=_0x11dc48(0x20f)&&_0x485974['marketcapApi']!=settings[_0x11dc48(0x1eb)];_0xab8213&&(_0x485974[_0x11dc48(0x26c)]=null,_0x485974['telegramEvents']=_0x11dc48(0x26f));for(const [_0x6e9319,_0xd20f42]of Object['entries'](_0x485974)){if(_0x6e9319==_0x11dc48(0x263)&&_0xd20f42==_0x11dc48(0x20f)){_0x485974['telegramToken']=settings[_0x11dc48(0x263)];continue;};if(_0x6e9319==_0x11dc48(0x1bb)&&_0xd20f42==_0x11dc48(0x20f)){_0x485974[_0x11dc48(0x1bb)]=settings['bbPassword'];continue;};if(_0x6e9319==_0x11dc48(0x1eb)&&_0xd20f42==_0x11dc48(0x20f)){_0x485974[_0x11dc48(0x1eb)]=settings['marketcapApi'];continue;};dbSettings[_0x11dc48(0x1d0)](_0x11dc48(0x10e)+_0x6e9319,_0xd20f42)['write']();}settings=_0x485974,io['to'](_0x11dc48(0x28c))[_0x11dc48(0x1b2)](_0x11dc48(0x15d),cleanSettings()),broadcastToBots('timeshift',settings[_0x11dc48(0x270)]),broadcastToBots('onepagemode',settings[_0x11dc48(0x24f)]),broadcastToBots(_0x11dc48(0x1eb),settings[_0x11dc48(0x1eb)]);if(_0xab8213&&!_0x22f4ab)initTelegram();_0xab8213&&_0x22f4ab&&(updateSetting(_0x11dc48(0x26c),null),disableTelegram()),getAllClients()['forEach'](_0x555482=>{const _0x440443=_0x11dc48;getSocket(_0x555482['id'])[_0x440443(0x1b2)](_0x440443(0x2ac),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x40e2e6&&(await sleep(0xbb8),testMarketcapApi(_0x485974[_0x11dc48(0x1eb)]));}async function testMarketcapApi(_0x238553){const _0x2334fa=_0x49ad5f,_0x16b5d6=[_0x2334fa(0x19c),_0x2334fa(0x231)];try{await axios[_0x2334fa(0x198)](_0x2334fa(0x29e),{'headers':{'X-CMC_PRO_API_KEY':_0x238553},'params':{'symbol':_0x16b5d6[_0x2334fa(0x164)]()}});}catch(_0x2b071b){_0x2b071b[_0x2334fa(0x164)]()[_0x2334fa(0x158)](_0x2334fa(0x279))?(io['to'](_0x2334fa(0x28c))[_0x2334fa(0x1b2)](_0x2334fa(0x2d0),_0x2334fa(0xb6)),logger[_0x2334fa(0x220)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to']('botmanager')[_0x2334fa(0x1b2)](_0x2334fa(0x2d0),_0x2334fa(0x1c6)),logger['full'](_0x2334fa(0x1c6)),logger[_0x2334fa(0x291)]('Error\x20details:',_0x2b071b[_0x2334fa(0x164)]()+_0x2334fa(0x24e)+_0x2b071b[_0x2334fa(0xcf)]));return;}logger[_0x2334fa(0x291)](_0x2334fa(0x10c));}function updateSetting(_0x21af52,_0x5d4345){const _0x3ef941=_0x49ad5f;dbSettings[_0x3ef941(0x1d0)](_0x3ef941(0x10e)+_0x21af52,_0x5d4345)[_0x3ef941(0xf4)](),settings=getSettings(),io['to'](_0x3ef941(0x28c))['emit'](_0x3ef941(0x15d),cleanSettings());}function storeSecure(_0x53f8fd){const _0x363527=_0x49ad5f;dbSecure[_0x363527(0x198)](_0x363527(0x2c5))[_0x363527(0x1bc)](_0x53f8fd)[_0x363527(0xf4)](),secure=_0x53f8fd;}function addBlacklist(_0x580e90){const _0xf8335e=_0x49ad5f;cleanBlacklist();let _0x12b1e4;devices[_0x580e90][_0xf8335e(0x1e8)]?_0x12b1e4=Math[_0xf8335e(0x1b5)](devices[_0x580e90][_0xf8335e(0x1e8)][_0xf8335e(0x154)],loginExpiry):_0x12b1e4=loginExpiry,dbSecure['get'](_0xf8335e(0x225))[_0xf8335e(0x1bc)]({'expiry':new Date()[_0xf8335e(0x2ad)]()+_0x12b1e4*0x3c*0x3e8,'token':devices[_0x580e90]['access']['token']})[_0xf8335e(0xf4)](),blacklist=dbSecure[_0xf8335e(0x198)](_0xf8335e(0x225))[_0xf8335e(0x170)]();}function cleanBlacklist(){const _0x2a7afd=_0x49ad5f;let _0x91d167=dbSecure[_0x2a7afd(0x198)](_0x2a7afd(0x225))[_0x2a7afd(0x264)]()[_0x2a7afd(0x170)](),_0x2c9ce4=new Date()['getTime']();_0x91d167['forEach'](_0x4fd371=>{const _0x2e655c=_0x2a7afd;_0x4fd371[_0x2e655c(0x154)]<_0x2c9ce4&&dbSecure[_0x2e655c(0x198)]('blacklist')[_0x2e655c(0x118)]({'expiry':_0x4fd371['expiry']})[_0x2e655c(0xf4)]();});}function initStates(){let _0x95ce25=getConfiguration();_0x95ce25['forEach'](_0x3e0e83=>{const _0x2e412c=_0x496f;_0x3e0e83[_0x2e412c(0x262)]='stopped';}),storeConfiguration(_0x95ce25);}async function generateKeys(){const _0x54ae3b=_0x49ad5f,_0x4595b3=forge[_0x54ae3b(0xf3)]['rsa']['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x505590=forge[_0x54ae3b(0xf3)][_0x54ae3b(0x17e)](_0x4595b3[_0x54ae3b(0x286)]),_0x29717f=forge[_0x54ae3b(0xf3)][_0x54ae3b(0x249)](_0x4595b3[_0x54ae3b(0xd3)]);return{'privateKey':_0x505590,'publicKey':_0x29717f};}async function oneTimeMigration(){const _0x4025e1=_0x49ad5f;let _0x5255ae=getSettings(),_0xc4503c=![];!_0x5255ae['hasOwnProperty'](_0x4025e1(0xbb))&&(_0x5255ae[_0x4025e1(0xbb)]=0x0,_0xc4503c=!![]);!_0x5255ae[_0x4025e1(0x282)]('lastmsgemitted')&&(_0x5255ae[_0x4025e1(0x1da)]=0x0,_0xc4503c=!![]);!_0x5255ae[_0x4025e1(0x282)](_0x4025e1(0x162))&&(_0x5255ae[_0x4025e1(0x162)]=_0x4025e1(0x229),_0xc4503c=!![]);!_0x5255ae[_0x4025e1(0x282)](_0x4025e1(0x24f))&&(_0x5255ae['onepagemode']=![],_0xc4503c=!![]);!_0x5255ae[_0x4025e1(0x282)](_0x4025e1(0x1eb))&&(_0x5255ae[_0x4025e1(0x1eb)]='',_0xc4503c=!![]);if(_0xc4503c)storeSettings(_0x5255ae);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x4025e1(0x192)](_0x4b60bf=>{const _0x2337ee=_0x4025e1;if(!_0x4b60bf['isDirectory']()){if(!_0x4b60bf[_0x2337ee(0x1fd)]['startsWith']('backup-full@'))fs['unlinkSync'](configbackuppath+_0x4b60bf['name']);}else fs[_0x2337ee(0x287)](configbackuppath+_0x4b60bf[_0x2337ee(0x1fd)],{'recursive':!![]});});}catch(_0x2424a2){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x2424a2);}}function storeConfiguration(_0x4e050c){const _0x57ebdd=_0x49ad5f;dbConfig[_0x57ebdd(0x198)](_0x57ebdd(0x265))[_0x57ebdd(0x118)]()[_0x57ebdd(0xf4)](),dbConfig[_0x57ebdd(0x198)](_0x57ebdd(0x265))[_0x57ebdd(0x1bc)](..._0x4e050c)['write'](),config=_0x4e050c;}async function resetPassword(){const _0x34de4f=_0x49ad5f;if(tgBot&&settings[_0x34de4f(0x26c)]){const _0x33d32c=Markup[_0x34de4f(0x1b6)]([Markup[_0x34de4f(0x266)][_0x34de4f(0x156)](_0x34de4f(0x1e4),_0x34de4f(0x204)),Markup[_0x34de4f(0x266)][_0x34de4f(0x156)]('no',_0x34de4f(0x256))]);await sendTelegram(settings[_0x34de4f(0x26c)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x33d32c),tgBot[_0x34de4f(0xc5)](/resetpw_(.+)/,async _0x38cb57=>{const _0x3b8899=_0x34de4f,_0x2717ed=_0x38cb57[_0x3b8899(0x205)][0x1];_0x38cb57[_0x3b8899(0x1a7)]();if(_0x2717ed!='no'){const _0x52a996=0xf,_0x3187ae='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x549dff=Array['from'](crypto[_0x3b8899(0x246)](new Uint32Array(_0x52a996)))[_0x3b8899(0xba)](_0x51137f=>_0x3187ae[_0x51137f%_0x3187ae[_0x3b8899(0x2bd)]])['join'](''),_0x4e8f92=bcrypt[_0x3b8899(0x2bb)](_0x549dff,saltRounds);storeSettings({'bbPassword':_0x4e8f92}),await sendTelegram(_0x38cb57[_0x3b8899(0x272)]['id'],_0x3b8899(0x1f3)+_0x549dff,{'parse_mode':_0x3b8899(0x235)});}else await sendTelegram(_0x38cb57[_0x3b8899(0x272)]['id'],_0x3b8899(0x2ab));});}}async function confirmRestore(_0x1329ba,_0x277476){const _0x174970=_0x49ad5f;io['to'](_0x174970(0x28c))[_0x174970(0x1b2)]('notification',_0x174970(0x10f),_0x174970(0x2b9));if(tgBot&&settings[_0x174970(0x26c)]){const _0x26e92a=uuidRandom();tmpStorage[_0x26e92a]={'path':_0x1329ba,'filename':_0x277476};const _0x1966d1=Markup[_0x174970(0x1b6)]([Markup[_0x174970(0x266)]['callback']('yes',_0x174970(0x217)+_0x26e92a),Markup[_0x174970(0x266)][_0x174970(0x156)]('no',_0x174970(0xee)+_0x26e92a)]);await sendTelegram(settings['telegramChatId'],_0x174970(0x100),_0x1966d1),tgBot[_0x174970(0xc5)](/restore_(.+)_(.+)/,async _0x35bc5c=>{const _0x4edaac=_0x174970,_0x4c52c5=_0x35bc5c['match'][0x1],_0x30365a=_0x35bc5c[_0x4edaac(0x205)][0x2],{path:_0x20b34e,filename:_0x3b7775}=tmpStorage[_0x30365a];delete tmpStorage[_0x30365a],_0x35bc5c['editMessageReplyMarkup'](),_0x4c52c5==_0x4edaac(0x1e4)?(logger['debug'](_0x4edaac(0x271)),await sendTelegram(_0x35bc5c[_0x4edaac(0x272)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x4edaac(0x235)}),unzipFile(_0x20b34e,_0x3b7775)):(logger['debug'](_0x4edaac(0x11d)),await sendTelegram(_0x35bc5c[_0x4edaac(0x272)]['id'],_0x4edaac(0x11d)));});}}function getServerTime(){const _0x2da3ce=_0x49ad5f,_0x205daa=new Date();return _0x205daa[_0x2da3ce(0x22a)]()+'/'+(_0x205daa[_0x2da3ce(0x137)]()+0x1)[_0x2da3ce(0x164)]()[_0x2da3ce(0x134)](0x2,'0')+'/'+_0x205daa[_0x2da3ce(0x1a9)]()[_0x2da3ce(0x164)]()['padStart'](0x2,'0')+'\x20'+_0x205daa[_0x2da3ce(0x13e)]()['toString']()[_0x2da3ce(0x134)](0x2,'0')+':'+_0x205daa[_0x2da3ce(0x151)]()[_0x2da3ce(0x164)]()[_0x2da3ce(0x134)](0x2,'0')+':'+_0x205daa['getSeconds']()[_0x2da3ce(0x164)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x3f104c=_0x49ad5f,_0x2ec92c=shiftedTime();return _0x2ec92c[_0x3f104c(0x22a)]()+'/'+(_0x2ec92c[_0x3f104c(0x137)]()+0x1)[_0x3f104c(0x164)]()[_0x3f104c(0x134)](0x2,'0')+'/'+_0x2ec92c[_0x3f104c(0x1a9)]()[_0x3f104c(0x164)]()[_0x3f104c(0x134)](0x2,'0')+'\x20'+_0x2ec92c[_0x3f104c(0x13e)]()[_0x3f104c(0x164)]()[_0x3f104c(0x134)](0x2,'0')+':'+_0x2ec92c['getMinutes']()[_0x3f104c(0x164)]()[_0x3f104c(0x134)](0x2,'0')+':'+_0x2ec92c[_0x3f104c(0x195)]()[_0x3f104c(0x164)]()[_0x3f104c(0x134)](0x2,'0');}function getCleanTimeStamp(){const _0x203930=_0x49ad5f,_0x359a52=shiftedTime();return _0x359a52['getFullYear']()+(_0x359a52['getMonth']()+0x1)['toString']()[_0x203930(0x134)](0x2,'0')+_0x359a52[_0x203930(0x1a9)]()[_0x203930(0x164)]()[_0x203930(0x134)](0x2,'0')+'-'+_0x359a52[_0x203930(0x13e)]()[_0x203930(0x164)]()[_0x203930(0x134)](0x2,'0')+_0x359a52[_0x203930(0x151)]()[_0x203930(0x164)]()[_0x203930(0x134)](0x2,'0')+_0x359a52[_0x203930(0x195)]()['toString']()[_0x203930(0x134)](0x2,'0');}function shiftedTime(){const _0x33b227=_0x49ad5f,_0x2e1cdc=new Date();let _0x25e020=_0x2e1cdc;if(settings[_0x33b227(0x270)]&&settings[_0x33b227(0x270)]!==0x0)_0x25e020=fns[_0x33b227(0x127)](_0x2e1cdc,{'hours':settings[_0x33b227(0x270)]});return _0x25e020;}async function startScheduler(){const _0x4f5a6e=_0x49ad5f,_0x48614f=new Date()['getUTCHours'](),_0x8517ae=shiftedTime()[_0x4f5a6e(0x13e)]();_0x8517ae==0x4&&backupConfigFiles(),_0x8517ae==0x0&&(rotateLogFiles(),logger[_0x4f5a6e(0x291)]('--------------------------------------'),logger[_0x4f5a6e(0x291)](_0x4f5a6e(0x1e0)+serverversion+_0x4f5a6e(0x2b7)+(environment==_0x4f5a6e(0x1df)?_0x4f5a6e(0xc0):'')),logger[_0x4f5a6e(0x291)](_0x4f5a6e(0x1c2))),_0x48614f%0x6==0x0&&triggerAnalytics(),_0x48614f%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x15c81d){const _0x530880=_0x49ad5f;logger[_0x530880(0x291)]('Restore\x20backup\x20file\x20'+_0x15c81d);const _0x327c52=getBotsWithMode();_0x327c52[_0x530880(0x2bd)]>0x0?confirmRestore(configbackuppath,_0x15c81d):unzipFile(configbackuppath,_0x15c81d);}async function getBackupFiles(_0x1fc6f5=null){const _0x35ecc2=_0x49ad5f;let _0x23241b=[],_0x3cf46b=fs[_0x35ecc2(0xc7)](configbackuppath,{'withFileTypes':!![]});_0x3cf46b[_0x35ecc2(0x1e5)]((_0x4fdfd8,_0x1383e6)=>_0x4fdfd8[_0x35ecc2(0x1fd)]<_0x1383e6[_0x35ecc2(0x1fd)]?0x1:_0x1383e6[_0x35ecc2(0x1fd)]<_0x4fdfd8[_0x35ecc2(0x1fd)]?-0x1:0x0),_0x3cf46b[_0x35ecc2(0x192)](_0x379294=>{const _0x7da9a3=_0x35ecc2;if(!_0x379294[_0x7da9a3(0xe0)]()&&_0x379294[_0x7da9a3(0x1fd)][_0x7da9a3(0x28f)](_0x7da9a3(0x185))&&_0x379294[_0x7da9a3(0x1fd)]['endsWith'](_0x7da9a3(0x1a3))){const _0x5a57c6=formatDate(fs[_0x7da9a3(0x210)](configbackuppath+_0x379294['name'])[_0x7da9a3(0x22e)]);_0x23241b[_0x7da9a3(0x1bc)]({'name':_0x379294['name'],'mtime':_0x5a57c6});}});if(_0x1fc6f5)io['to'](_0x1fc6f5)[_0x35ecc2(0x1b2)](_0x35ecc2(0x12d),_0x23241b);else return _0x23241b;}async function backupConfigFiles(){const _0x52c9c0=_0x49ad5f;await zipFiles(_0x52c9c0(0x2c9));const _0x5a4a40=getCleanTimeStamp();fs[_0x52c9c0(0x19d)](zippath+_0x52c9c0(0x13a),configbackuppath+(_0x52c9c0(0x185)+_0x5a4a40+_0x52c9c0(0x1a3)));let _0x261e11=fs[_0x52c9c0(0xc7)](configbackuppath,{'withFileTypes':!![]});_0x261e11[_0x52c9c0(0x1e5)]((_0x2b8524,_0x37761e)=>_0x2b8524['name']<_0x37761e[_0x52c9c0(0x1fd)]?0x1:_0x37761e[_0x52c9c0(0x1fd)]<_0x2b8524[_0x52c9c0(0x1fd)]?-0x1:0x0),_0x261e11['length']>maxBackups&&fs[_0x52c9c0(0x169)](configbackuppath+_0x261e11[_0x261e11[_0x52c9c0(0x2bd)]-0x1][_0x52c9c0(0x1fd)]);}function rotateLogFiles(){const _0x1dba15=_0x49ad5f,_0x446161=fs[_0x1dba15(0x210)](logspath+'output-000.log'),_0x5edc9f=_0x446161[_0x1dba15(0x289)]/0x400;if(_0x5edc9f>0x64){let _0x414855=fs[_0x1dba15(0xc7)](logspath,{'withFileTypes':!![]});_0x414855[_0x1dba15(0x1e5)]((_0x511569,_0x535716)=>_0x511569[_0x1dba15(0x1fd)]<_0x535716[_0x1dba15(0x1fd)]?0x1:_0x535716[_0x1dba15(0x1fd)]<_0x511569['name']?-0x1:0x0),_0x414855[_0x1dba15(0x192)](_0x459d67=>{const _0x142d7c=_0x1dba15;if(_0x459d67['name']=='output-002.log')fs[_0x142d7c(0x19d)](logspath+_0x459d67[_0x142d7c(0x1fd)],logspath+_0x142d7c(0x11b));if(_0x459d67['name']==_0x142d7c(0x15c))fs[_0x142d7c(0x19d)](logspath+_0x459d67[_0x142d7c(0x1fd)],logspath+_0x142d7c(0x1b7));_0x459d67[_0x142d7c(0x1fd)]==_0x142d7c(0x1b8)&&(fs[_0x142d7c(0x19d)](logspath+_0x459d67['name'],logspath+_0x142d7c(0x15c)),fs[_0x142d7c(0xe6)](logspath+_0x459d67['name'],''));});}}async function zipFiles(_0x278d55){const _0x1ffe76=_0x49ad5f;let _0x23a7af;if(_0x278d55==_0x1ffe76(0x1dc))_0x23a7af=logspath;if(_0x278d55==_0x1ffe76(0x10d))_0x23a7af=configpath;if(_0x278d55==_0x1ffe76(0x2c9))_0x23a7af=configpath;let _0x2a58f3=fs[_0x1ffe76(0xc7)](_0x23a7af,{'withFileTypes':!![]});const _0xf65951=new JSZip();_0x2a58f3[_0x1ffe76(0x192)](_0x1769d2=>{const _0x11ccad=_0x1ffe76;if(!_0x1769d2[_0x11ccad(0xe0)]()){let _0x22b8f2=fs[_0x11ccad(0x144)](_0x23a7af+_0x1769d2[_0x11ccad(0x1fd)]);if(_0x278d55=='backup'){const _0x2f932b=/^bot-[0-9]{3}-config.json$/,_0x5e9bac=_0x2f932b[_0x11ccad(0x1fe)](_0x1769d2[_0x11ccad(0x1fd)]);if(_0x5e9bac){const _0x22352f=JSON['parse'](_0x22b8f2);if(_0x22352f['bot'][0x0]){_0x22352f[_0x11ccad(0x1bf)][0x0][_0x11ccad(0x22c)]='***',_0x22352f[_0x11ccad(0x1bf)][0x0]['apiSecret']=_0x11ccad(0x190);if(_0x22352f[_0x11ccad(0x1bf)][0x0][_0x11ccad(0x1aa)])_0x22352f[_0x11ccad(0x1bf)][0x0][_0x11ccad(0x1aa)]=_0x11ccad(0x190);}_0x22b8f2=JSON[_0x11ccad(0x17c)](_0x22352f,null,0x2);}if(_0x1769d2[_0x11ccad(0x1fd)]=='bb-settings.json'){const _0x38b14e=JSON[_0x11ccad(0x1f2)](_0x22b8f2);if(_0x38b14e[_0x11ccad(0x15d)]['loginRequired'])_0x38b14e['settings'][_0x11ccad(0x18f)]=![];if(_0x38b14e[_0x11ccad(0x15d)][_0x11ccad(0x1bb)])_0x38b14e['settings'][_0x11ccad(0x1bb)]=_0x11ccad(0x190);if(_0x38b14e[_0x11ccad(0x15d)]['telegramToken'])_0x38b14e[_0x11ccad(0x15d)][_0x11ccad(0x263)]=_0x11ccad(0x190);if(_0x38b14e['settings'][_0x11ccad(0x26c)])_0x38b14e[_0x11ccad(0x15d)][_0x11ccad(0x26c)]=null;if(_0x38b14e['settings'][_0x11ccad(0x1eb)])_0x38b14e[_0x11ccad(0x15d)]['marketcapApi']=_0x11ccad(0x190);_0x22b8f2=JSON[_0x11ccad(0x17c)](_0x38b14e,null,0x2);}if(_0x1769d2[_0x11ccad(0x1fd)]!=_0x11ccad(0xbe))_0xf65951[_0x11ccad(0x2b6)](_0x1769d2[_0x11ccad(0x1fd)],_0x22b8f2);}else _0xf65951[_0x11ccad(0x2b6)](_0x1769d2['name'],_0x22b8f2);}});const _0x93a4a7=await _0xf65951[_0x1ffe76(0x294)]({'type':_0x1ffe76(0x1ed),'base64':![],'compression':_0x1ffe76(0x2b8)});fs['writeFileSync'](zippath+(_0x278d55+'.zip'),_0x93a4a7,_0x1ffe76(0xc1));}async function unzipFile(_0x6ed792,_0x2f977f){const _0x1ce404=_0x49ad5f;fs[_0x1ce404(0xc7)](configpath,{'withFileTypes':!![]})['forEach'](_0x4607ff=>{const _0x38ee2a=_0x1ce404;if(!_0x4607ff[_0x38ee2a(0xe0)]())fs[_0x38ee2a(0x287)](configpath+_0x4607ff[_0x38ee2a(0x1fd)]);});const _0x5a1a4d=fs[_0x1ce404(0x144)](_0x6ed792+_0x2f977f,_0x1ce404(0xc1)),_0x130555=await JSZip[_0x1ce404(0x1a5)](_0x5a1a4d,{'base64':![],'checkCRC32':!![]});for(const _0x553075 of Object[_0x1ce404(0x14a)](_0x130555[_0x1ce404(0x103)])){const _0x25e32c=_0x130555[_0x1ce404(0x103)][_0x553075],_0x170573=await _0x25e32c[_0x1ce404(0x28b)](_0x1ce404(0x1ed));fs['writeFileSync'](configpath+_0x25e32c[_0x1ce404(0x1fd)],_0x170573);}fs[_0x1ce404(0xc7)](temppath,{'withFileTypes':!![]})['forEach'](_0x1deeb6=>{const _0xd15895=_0x1ce404;if(!_0x1deeb6[_0xd15895(0xe0)]())fs[_0xd15895(0x287)](temppath+_0x1deeb6[_0xd15895(0x1fd)]);}),logger[_0x1ce404(0x291)](_0x1ce404(0x1f8)),process[_0x1ce404(0x1b0)]({'restore':!![]},_0x219821=>{});}async function getPublicIp(){const _0x9505bb=_0x49ad5f;try{const _0x5943c0=await axios[_0x9505bb(0x198)](_0x9505bb(0xc4));publicip=_0x5943c0[_0x9505bb(0x29d)]['ip'];}catch(_0x1cb3c1){}}async function triggerAnalytics(){const _0x369879=_0x49ad5f;if(!publicip)await getPublicIp();const _0x20d417=getBotsWithMode();let _0x5d9614=0x0;_0x20d417[_0x369879(0x192)](_0x4bb1fa=>{const _0x81a729=_0x369879;if(_0x4bb1fa[_0x81a729(0x2ac)]===_0x81a729(0x1de))_0x5d9614++;});const _0xf3fb92=getBotExchanges();mixpanel[_0x369879(0x213)]('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x20d417[_0x369879(0x2bd)],'numbotsenabled':_0x5d9614,'exchanges':_0xf3fb92,'environment':environment});}async function getMessages(){const _0x42f804=_0x49ad5f,_0x10e234=_0x42f804(0x1fc),_0xdaf10=new GraphQLClient(_0x10e234),_0x27e828={'authorization':_0x42f804(0x1a0)},_0x591dff=serverversion['split']('.'),_0x544c60=_0x591dff[0x0]+'.'+_0x591dff[0x1],_0x36505f=Math['min'](settings[_0x42f804(0xbb)],settings['lastmsgemitted']),_0x49ab64={'last':parseInt(_0x36505f),'bbm':_0x544c60},_0x96741a=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x8f7db0;try{_0x8f7db0=await _0xdaf10[_0x42f804(0x168)](_0x96741a,_0x49ab64,_0x27e828);}catch(_0x45ea49){}if(_0x8f7db0&&_0x8f7db0['messages']){let _0x5ef8de=settings['lastmsgtelegram'],_0x2af8b7=settings[_0x42f804(0xbb)];newMessages=[];for(const _0x2be7fd of _0x8f7db0[_0x42f804(0x19e)]){newMessages[_0x42f804(0x1bc)](_0x2be7fd);let _0x222d55=![];_0x2be7fd[_0x42f804(0x196)]&&(updateSetting(_0x42f804(0x162),_0x2be7fd['bbvNew']),_0x222d55=isNewerVersion(serverversion,_0x2be7fd[_0x42f804(0x196)])||serverversion==_0x2be7fd[_0x42f804(0x196)]);if(!_0x222d55&&_0x2be7fd[_0x42f804(0x283)]>_0x5ef8de){if(_0x2be7fd[_0x42f804(0x16c)]===_0x42f804(0x2ce)||serverversion[_0x42f804(0x28f)](_0x2be7fd[_0x42f804(0x16c)])){let _0xfe2c67=''+_0x2be7fd[_0x42f804(0x177)]+'\x0a\x0a'+_0x2be7fd[_0x42f804(0x11e)];const _0x1e5a04=await sendTelegramMsg(toTelegramMarkdown(_0xfe2c67),_0x42f804(0x2af));_0x5ef8de=_0x2be7fd['number'];}}_0x2af8b7=_0x2be7fd[_0x42f804(0x283)];}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x42f804(0xbb),_0x2af8b7),emitMessages();}}function emitMessages(){const _0x425aff=_0x49ad5f,_0x2e2c6b=settings['lastmsgemitted'];let _0xf8e69a=[];newMessages['forEach'](_0x4d25be=>{const _0x4016b7=_0x496f;_0x4d25be[_0x4016b7(0x283)]>_0x2e2c6b&&_0xf8e69a[_0x4016b7(0x1bc)](_0x4d25be);}),_0xf8e69a['length']>0x0&&getAllClients()[_0x425aff(0x192)](_0x455d92=>{const _0x36d6a1=_0x425aff;getSocket(_0x455d92['id'])[_0x36d6a1(0x1b2)]('message',_0xf8e69a);});}function confirmMessage(_0x369885){const _0x5027d6=_0x49ad5f;updateSetting(_0x5027d6(0x1da),Number(_0x369885));}function isNewerVersion(_0x18c1d5,_0x3a1d86){const _0xe8a289=_0x49ad5f,_0x1d1269=_0x3a1d86['split']('.'),_0x5c4a99=_0x18c1d5['split']('.');for(var _0x4dee62=0x0;_0x4dee62<_0x5c4a99[_0xe8a289(0x2bd)];_0x4dee62++){const _0x19e925=~~_0x5c4a99[_0x4dee62],_0x14bb25=~~_0x1d1269[_0x4dee62];if(_0x19e925>_0x14bb25)return!![];if(_0x19e925<_0x14bb25)return![];}return![];}function toTelegramMarkdown(_0x13132e){const _0x178bbb=_0x49ad5f,_0x4ea32d=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x5ec07f=/\*{2}(.+?)\*{2}/gim;return _0x13132e=_0x13132e[_0x178bbb(0x297)](_0x4ea32d,_0x178bbb(0x1ab))['replace'](_0x5ec07f,_0x178bbb(0x2d1)),_0x13132e;}async function validateConfigFile(){const _0x1a7fea=_0x49ad5f,_0x1e6241=dbConfig[_0x1a7fea(0x198)](_0x1a7fea(0x265))[_0x1a7fea(0xe1)](_0x1a7fea(0x27e))[_0x1a7fea(0x170)]()||[];if(_0x1e6241[_0x1a7fea(0x2bd)]==0x0){let _0x3191e2=0x0,_0x119853=[];const _0x292ce3=/^bot-([0-9]{3})-config.json$/,_0x145e22=fs['readdirSync'](configpath);_0x145e22[_0x1a7fea(0x192)](_0x16eccb=>{const _0x272779=_0x1a7fea,_0x196275=_0x292ce3['exec'](_0x16eccb);if(_0x196275){const _0x1b00b4=_0x196275[0x1];let _0x3c12fd=getBotAttributes(_0x1b00b4);_0x119853[_0x272779(0x1bc)]({'botID':_0x1b00b4,'botname':_0x3c12fd['botname'],'status':'disabled','live':'stopped'}),_0x3191e2++;}}),_0x3191e2!=0x0&&(dbConfig[_0x1a7fea(0x198)](_0x1a7fea(0x265))[_0x1a7fea(0x189)](_0x119853)['write'](),config=_0x119853,restoredConfigFile=_0x3191e2);}}async function restoreConfigNotify(_0x44bef7){const _0x3679fb=_0x49ad5f;let _0x56f177;if(restoredConfigFile==0x1)_0x56f177=_0x3679fb(0x1ac);else _0x56f177='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x44bef7)io['to'](_0x3679fb(0x28c))[_0x3679fb(0x1b2)](_0x3679fb(0x2d0),_0x56f177);else{logger[_0x3679fb(0x2a4)]('-----------------------------------------------------------------------------------'),logger[_0x3679fb(0x2a4)](_0x56f177),logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x3679fb(0x2a4)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x3679fb(0x14c)]!=_0x3679fb(0x221))await sendTelegram(settings[_0x3679fb(0x26c)],_0x3679fb(0xd1)+_0x56f177);}}function decryptRSA(_0x270017,_0x45426a){const _0x3d4d58=_0x49ad5f,_0x19c236=forge[_0x3d4d58(0xf3)]['privateKeyFromPem'](_0x270017),_0x1cfb86=_0x19c236[_0x3d4d58(0x23a)](forge[_0x3d4d58(0x223)][_0x3d4d58(0x1e2)](_0x45426a),_0x3d4d58(0x1a6),{'md':forge['md'][_0x3d4d58(0x1ff)]['create'](),'mgf1':{'md':forge['md'][_0x3d4d58(0x1ff)][_0x3d4d58(0x1ea)]()}});return _0x1cfb86;}function validateCredentials(_0x4d494d,_0x55ad1c){const _0xdc4211=_0x49ad5f;if(_0x4d494d[_0xdc4211(0x184)]==settings[_0xdc4211(0xbf)]&&bcrypt[_0xdc4211(0x122)](_0x4d494d['password'],settings[_0xdc4211(0x1bb)])){if(settings[_0xdc4211(0x247)])return{'allow':![],'reason':_0xdc4211(0x2bc),'token':null};else{const _0x44c97a=generateLoginToken(_0x55ad1c);return{'allow':!![],'reason':_0xdc4211(0x2b1),'token':_0x44c97a};}}else return{'allow':![],'reason':_0xdc4211(0x126),'token':null};}function refreshToken(_0x38dbd6){const _0x1aa314=generateLoginToken(_0x38dbd6);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x1aa314};}function validateAccess(_0x18fb85,_0x5b7b9a,_0x4bcb80){const _0x5b5dc6=_0x49ad5f,_0x1bb584=_0x4bcb80?_0x4bcb80:devices[_0x5b7b9a]['ip'];let _0x4f68a5;const _0x1f07bc=_0x17c6a7=>{const _0x240669=_0x496f;if(settings[_0x240669(0x18f)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x5b7b9a)){const _0x1503ef=generateLoginToken(_0x5b7b9a);return{'allow':!![],'reason':_0x240669(0x1be),'token':_0x1503ef};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x4f68a5=validToken(_0x17c6a7,_0x5b7b9a),_0x4f68a5['hasOwnProperty'](_0x240669(0x2b9))?{'allow':!![],'reason':_0x240669(0x2cd),'token':_0x17c6a7}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x240669(0x207),'token':null};};if(settings[_0x5b5dc6(0x108)]){let _0x122db2=[...settings[_0x5b5dc6(0x230)],'::1',_0x5b5dc6(0x275),'127.0.0.1','::ffff:7f00:1'];if(_0x122db2[_0x5b5dc6(0x158)](_0x1bb584))return _0x1f07bc(_0x18fb85);else{_0x4f68a5=validToken(_0x18fb85,_0x5b7b9a);if(_0x4f68a5['hasOwnProperty'](_0x5b5dc6(0x2b9)))return _0x1f07bc(_0x18fb85);else{if(telegramIpApproved(_0x5b7b9a)){const _0x50b630=generateToken(_0x5b7b9a);return _0x4f68a5=_0x1f07bc(_0x18fb85),_0x4f68a5[_0x5b5dc6(0x107)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x50b630}:_0x4f68a5;}else return settings[_0x5b5dc6(0xfc)]?{'allow':![],'reason':_0x5b5dc6(0x16b),'token':null}:{'allow':![],'reason':_0x5b5dc6(0x148),'token':null};}}}else return _0x1f07bc(_0x18fb85);}function timelyDecrypt(_0x444e5c,_0x41610f,_0x20eec6='@'){const _0x588b9b=_0x49ad5f;if(_0x444e5c)try{const _0x1e12db=decryptRSA(secure[_0x588b9b(0x286)],_0x444e5c),_0x5f59aa=_0x1e12db[_0x588b9b(0x295)](_0x20eec6)[0x0],_0x4c1ade=_0x1e12db[_0x588b9b(0x295)](_0x20eec6)[0x1],_0x1005cf=new Date()[_0x588b9b(0x2ad)]();if(_0x41610f){if(_0x1005cf-_0x4c1ade<maxSecretAge*0x3e8)return _0x5f59aa;else return![];}else return _0x5f59aa;}catch(_0x525070){return![];}else return![];}const validToken=(_0x400746,_0x95afe)=>{const _0x25ff61=_0x49ad5f,_0x4b46ed=devices[_0x95afe]['ip'];if(!_0x400746)return{'error':'No\x20authentication\x20token'};for(let _0x4074ea of blacklist){if(_0x4074ea[_0x25ff61(0x2a3)]==_0x400746)return{'error':_0x25ff61(0x25d)};}let _0x333a3b;try{_0x333a3b=jwt['verify'](_0x400746,secure['secret']+_0x95afe);}catch{return{'error':_0x25ff61(0x2c1)};}if(!_0x333a3b[_0x25ff61(0x282)](_0x25ff61(0x20e))&&!_0x333a3b[_0x25ff61(0x282)](_0x25ff61(0x184))||!_0x333a3b[_0x25ff61(0x282)](_0x25ff61(0x216)))return{'error':_0x25ff61(0x1b1)};if(!_0x333a3b[_0x25ff61(0x282)](_0x25ff61(0x184))&&_0x333a3b[_0x25ff61(0x282)](_0x25ff61(0x20e))){const {clientip:_0x43beae}=_0x333a3b;return _0x4b46ed==_0x43beae?{'success':_0x25ff61(0x155)}:{'error':_0x25ff61(0x2c2)};}else{if(_0x333a3b[_0x25ff61(0x282)](_0x25ff61(0x184))&&_0x333a3b[_0x25ff61(0x282)](_0x25ff61(0x20e))){const {username:_0x13b1bc,clientip:_0x2e6592}=_0x333a3b;return settings[_0x25ff61(0xbf)]==_0x13b1bc&&_0x4b46ed==_0x2e6592?{'success':_0x25ff61(0x155)}:{'error':_0x25ff61(0xe2)};}}},generateLoginToken=_0x4c2101=>{const _0x1b4a81=_0x49ad5f;if(_0x4c2101){const _0x3db601=devices[_0x4c2101]['ip'];return jwt[_0x1b4a81(0x150)]({'username':settings[_0x1b4a81(0xbf)],'clientip':_0x3db601},secure[_0x1b4a81(0x140)]+_0x4c2101,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x1b2861=>{const _0x2f580b=_0x49ad5f;if(_0x1b2861){const _0x2ade20=devices[_0x1b2861]['ip'];return jwt['sign']({'clientip':_0x2ade20},secure[_0x2f580b(0x140)]+_0x1b2861,{'expiresIn':devices[_0x1b2861][_0x2f580b(0x1e8)][_0x2f580b(0x154)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x6a1182=>{const _0x374a28=_0x49ad5f;let _0x33d538=![];return devices[_0x6a1182]['telegramIpApproval']&&devices[_0x6a1182][_0x374a28(0x1e8)][_0x374a28(0x154)]!=_0x374a28(0x2cb)&&(_0x33d538=devices[_0x6a1182][_0x374a28(0x1e8)][_0x374a28(0x20e)]==devices[_0x6a1182]['ip']&&new Date()[_0x374a28(0x2ad)]()-devices[_0x6a1182][_0x374a28(0x1e8)][_0x374a28(0x203)]<devices[_0x6a1182][_0x374a28(0x1e8)][_0x374a28(0x154)]*0x3c*0x3e8),_0x33d538;},telegram2FaApproved=_0x45646c=>{const _0x57948c=_0x49ad5f;let _0x19e707=![];return devices[_0x45646c][_0x57948c(0x245)]&&devices[_0x45646c][_0x57948c(0x245)]['expiry']!='reject'&&(_0x19e707=devices[_0x45646c][_0x57948c(0x245)]['clientip']==devices[_0x45646c]['ip']&&new Date()[_0x57948c(0x2ad)]()-devices[_0x45646c]['telegram2FaApproval'][_0x57948c(0x203)]<devices[_0x45646c][_0x57948c(0x245)][_0x57948c(0x154)]*0x3c*0x3e8),_0x19e707;},normalizeIP=_0x3bd22b=>{const _0x45ed53=_0x49ad5f;let _0xf43852=null,_0x4d5cbb=null;if(ipaddr[_0x45ed53(0x186)](_0x3bd22b)){const _0x396b5a=ipaddr[_0x45ed53(0x1f2)](_0x3bd22b);_0x396b5a[_0x45ed53(0x136)]()==='ipv6'?(_0x396b5a[_0x45ed53(0x261)]()&&(_0xf43852=_0x396b5a['toIPv4Address']()['toString']()),_0x4d5cbb=_0x396b5a['toString']()):(_0xf43852=_0x396b5a[_0x45ed53(0x164)](),_0x4d5cbb=_0x396b5a[_0x45ed53(0x1f5)]()['toString']());}return{'show':_0xf43852?_0xf43852:_0x4d5cbb,'store':_0x4d5cbb};};function formatDate(_0x15ddea){const _0x12e8a0=_0x49ad5f;return _0x15ddea[_0x12e8a0(0x22a)]()+'/'+(_0x15ddea[_0x12e8a0(0x137)]()+0x1)['toString']()[_0x12e8a0(0x134)](0x2,'0')+'/'+_0x15ddea[_0x12e8a0(0x1a9)]()[_0x12e8a0(0x164)]()[_0x12e8a0(0x134)](0x2,'0')+'\x20'+_0x15ddea['getHours']()[_0x12e8a0(0x164)]()[_0x12e8a0(0x134)](0x2,'0')+':'+_0x15ddea['getMinutes']()['toString']()[_0x12e8a0(0x134)](0x2,'0')+':'+_0x15ddea[_0x12e8a0(0x195)]()[_0x12e8a0(0x164)]()[_0x12e8a0(0x134)](0x2,'0');}function sleep(_0x5cce59){return new Promise(_0x120dcc=>setTimeout(_0x120dcc,_0x5cce59));}