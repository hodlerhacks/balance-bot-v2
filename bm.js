const _0x4ef0d1=_0x5cae;(function(_0x1fa06d,_0x161b78){const _0x4c0fb8=_0x5cae,_0x119dc9=_0x1fa06d();while(!![]){try{const _0x31ba59=-parseInt(_0x4c0fb8(0x293))/0x1*(parseInt(_0x4c0fb8(0x2bb))/0x2)+-parseInt(_0x4c0fb8(0x172))/0x3*(-parseInt(_0x4c0fb8(0x296))/0x4)+-parseInt(_0x4c0fb8(0x204))/0x5+parseInt(_0x4c0fb8(0x1ec))/0x6*(-parseInt(_0x4c0fb8(0x23e))/0x7)+-parseInt(_0x4c0fb8(0x2de))/0x8+-parseInt(_0x4c0fb8(0x1cb))/0x9+parseInt(_0x4c0fb8(0x215))/0xa;if(_0x31ba59===_0x161b78)break;else _0x119dc9['push'](_0x119dc9['shift']());}catch(_0x484cbd){_0x119dc9['push'](_0x119dc9['shift']());}}}(_0x3829,0x3dc65));const _0x2a7805=function(){let _0x1b40fb=!![];return function(_0x796cc2,_0x2fcc13){const _0x2f3f58=_0x1b40fb?function(){const _0x1ae760=_0x5cae;if(_0x2fcc13){const _0x2f4808=_0x2fcc13[_0x1ae760(0x2e1)](_0x796cc2,arguments);return _0x2fcc13=null,_0x2f4808;}}:function(){};return _0x1b40fb=![],_0x2f3f58;};}(),_0x4f0715=_0x2a7805(this,function(){const _0x5cb0e9=_0x5cae;return _0x4f0715['toString']()[_0x5cb0e9(0x154)](_0x5cb0e9(0x2bf))['toString']()[_0x5cb0e9(0x16e)](_0x4f0715)[_0x5cb0e9(0x154)](_0x5cb0e9(0x2bf));});_0x4f0715();'use strict';process[_0x4ef0d1(0x21d)][_0x4ef0d1(0x26e)]=0x1;const childProcess=require(_0x4ef0d1(0x19a)),fs=require('fs'),fns=require(_0x4ef0d1(0x2b5)),low=require(_0x4ef0d1(0x124)),FileSync=require(_0x4ef0d1(0x137)),path=require(_0x4ef0d1(0xe7)),crypto=require(_0x4ef0d1(0x25c)),forge=require(_0x4ef0d1(0x2da)),bcrypt=require(_0x4ef0d1(0x250)),jwt=require('jsonwebtoken'),ipaddr=require(_0x4ef0d1(0x116)),argv=require(_0x4ef0d1(0x1c0))(process[_0x4ef0d1(0x25f)][_0x4ef0d1(0x1f9)](0x2))[_0x4ef0d1(0x25f)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x4ef0d1(0x2d7)),Mixpanel=require(_0x4ef0d1(0xd1)),axios=require(_0x4ef0d1(0xe8)),{GraphQLClient,gql}=require(_0x4ef0d1(0x1d0)),util=require(_0x4ef0d1(0x101)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x4ef0d1(0x170)),PORT=argv['port']||_0x4ef0d1(0x2df),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x4ef0d1(0x20c)](_0x4ef0d1(0x145)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x4ef0d1(0xf6)](0x1));const HOST=argv['host']||null,userID=argv['user']||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x4ef0d1(0x1af)][_0x4ef0d1(0x103)];let bbpath=_0x4ef0d1(0x106),bbpath2='';const botfile=_0x4ef0d1(0x211),configfile=_0x4ef0d1(0xd3),settingsfile='bb-settings.json',securefile=_0x4ef0d1(0x1f6),environment=require('./'+bbpath2+_0x4ef0d1(0x151))[_0x4ef0d1(0x29f)]||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x4ef0d1(0xf0)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4ef0d1(0x20d)),configpath=userID?bbpath+_0x4ef0d1(0x1f4)+userID+'/':bbpath+_0x4ef0d1(0x1f4),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x4ef0d1(0x22d)+userID+'/':bbpath+_0x4ef0d1(0x22d),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+'zip/',loggerfile=fs[_0x4ef0d1(0x196)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x4ef0d1(0x17f)+userID+'/':bbpath+'temp/';!fs[_0x4ef0d1(0xf0)](configpath)&&fs[_0x4ef0d1(0x27f)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x4ef0d1(0x27f)](configbackuppath);!fs[_0x4ef0d1(0xf0)](logspath)&&fs[_0x4ef0d1(0x27f)](logspath);!fs[_0x4ef0d1(0xf0)](zippath)&&fs[_0x4ef0d1(0x27f)](zippath);!fs[_0x4ef0d1(0xf0)](temppath)&&fs[_0x4ef0d1(0x27f)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x4ef0d1(0xdb)]({'bots':[]})[_0x4ef0d1(0x299)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);function _0x3829(){const _0x4e4246=['createServer','botname','function','off_','params','compareSync','\x20mode','/disable\x20-\x20disable\x20notifications\x0a','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','reason','cancelLoading','lowdb/adapters/FileSync','resetpw_yes','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','lastmsgtelegram','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','#RES#\x20','username','secret','\x1b[35m','Allow\x20login\x20from\x20IP\x20address\x20','Unauthorized\x20attempt\x20to\x20store\x20configuration','auto','Error:\x20Invalid\x20argument\x20','build','output-000.log','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','removeAllListeners','No\x20bots\x20running\x20right\x20now','reset-password','editMessageReplyMarkup','reply','get-portfolio','/start','/:bot/performance','version.json','Unauthorized\x20attempt\x20to\x20get\x20portfolio','uuid','search','stop','event','/download/:type','Unauthorized\x20attempt\x20to\x20log\x20out','DEFLATE','file','code','remove','headers','listen','version','telegramIpApproval','launch','then','f2aRequired','Alerts','1000','apiKey','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Disabled\x20Bot\x20','replace','showConfig','send','cancel-loading',':\x20Bot\x20Mgr\x20>\x20','constructor','HTML','jszip','backup-full','9WyrmzL','store-settings','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','startsWith','length','init','/:bot','Starting\x20#RED#Balance\x20Bot\x20v','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','disabled','order','parse','Unauthorized\x20attempt\x20to\x20show\x20configuration','temp/','privateKeyFromPem','from','\x1b[0m','Deleted\x20Bot\x20','apiSecret','handshake','************','api-eu.mixpanel.com','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','remoteAddress','reinstall_yes','new','[ip-address]','/status\x20-\x20show\x20bot(s)\x20status\x0a','IPv4','pidExpireLogin','Notifications\x20disabled\x0a','Starting\x20Balance\x20Bot\x20reinstallation','binary','***','disconnect','catch','createWriteStream','login\x20token\x20generated','tempaccess_5_','token','child_process','reinstall-bb','access',')\x20\x20\x20|\x20Bot\x20','rmSync','\x20-\x20','reject','\x20minutes','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','telegramUsername','\x20(2)','push','\x20(1)','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','portfolio','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','new-disabled','sortBy','/:bot/portfolio','versions','generateKeyPair','temporary\x20token\x20generated','SIGTERM','Idling\x20(','Error\x20sending\x20','randomBytes','live','Logged\x20out\x20user\x20...','invalid\x20credentials','expiry','ipv6','6b67f3d61ee94b8f5c80b4affef4c4d9','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','set','debug','Telegram\x20error:','yargs/yargs','/off\x20-\x20stop\x20bot(s)\x0a','match','Restore\x20process\x20aborted','RSA-OAEP','hashSync','success','yes','port','Notifications\x20enabled\x0a','/names\x20-\x20show\x20bot\x20names\x0a','3124809HxVgWd','resetpw_no','reload','update','store-headless','graphql-request','toIPv4MappedAddress','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','2FA\x20login\x20rejected','mtime','sign','settings','update_no','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','show-config','_nsps','emit','backup','metrics','portfolio_','padStart','data','add-bot','notification','Unauthorized\x20attempt\x20to\x20add\x20bot','Telegraf\x20error:','show','Logged\x20in\x20user\x20...','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','getSeconds','config_all','Login\x20accepted','readFileSync','1179006fRVhLR','\x1b[34m','Network\x20Interfaces:','bot','Running\x20#RED#Balance\x20Bot\x20v','sha256','add','readdirSync','config/','storeConfiguration','bb-secure.json','Unauthorized\x20attempt\x20to\x20confirm\x20message','loginRequired','slice','update_yes','Error\x20while\x20deleting\x20config\x20files:\x20','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','\x20only\x0a','Bot\x20','BCT',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','args','getFullYear','CoinMarketCap\x20API\x20key\x20validated','1296055JaDuNx','forEach','toggle','telegrammsg','command','/logs\x20-\x20receive\x20log\x20files\x0a','started','publicKey','log','clients','login\x20token\x20valid','telegramEnabled','Unauthorized\x20attempt\x20to\x20download\x20','bot.js','All\x20bots','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','.zip','10325300dVtbUi','Ok,\x20will\x20send\x20order\x20notifications\x20only','find','|@|','-performance.json','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','string','whitelistEnabled','env','bot-','login2fa_reject_','Unauthorized\x20attempt\x20to\x20delete\x20bot','login\x20required','family','password','reinstall_no','temporary\x20access\x20not\x20allowed','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','/on\x20-\x20start\x20bot(s)\x0a','tempaccess_reject_','min','restore-backup-file','join','enabled','logs/','getUTCHours','number','/restart\x20-\x20restart\x20bot(s)\x0a','https://api.ipify.org?format=json','build2','botID','2FA\x20required','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','cloneDeep','start','Temporary\x20access\x20rejected','Invalid\x20authentication\x20token\x20(1)','bots','getPortfolio','Ok,\x20will\x20send\x20alert\x20notifications\x20only','-----------------------------------------------------------------------------------','14StDJkP','User\x20has\x20been\x20validated','timeshift','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','chat','SIGINT','get-backup-files',')\x20|\x20Bot\x20','bbvNew','isDirectory','clientip','status\x20code\x20401','Backup\x20file\x20uploaded','kill','sendMetricsTelegram','Unauthorized\x20attempt\x20to\x20get\x20messages','inlineKeyboard','apiPassword','bcryptjs','output-001.log','store-configuration','address','statSync','entries','-config.json','lastmsgemitted','restart','::ffff:127.0.0.1','\x20|\x20','temporaryAccessAllowed','crypto','Notifications\x20disabled','files','argv','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','isIPv4MappedAddress','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','backup-full.zip','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','backup-files','alias','Orders','Yes','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','size','allow','--------------------------------------','NTBA_FIX_319','Login\x20rejected','auth','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','15\x20min','sendPortfolioTelegram','telegramToken','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','output-003.log','orders','request','assign','title','message','headless','/upload-backup','telegramEvents','mkdirSync','toString','encryptedUuid','\x1b[31m','Invalid\x20IP\x20address','bbPassword','action','address\x20already\x20in\x20use','showname','rsa','callback','telegramChatId','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','getMinutes','status','getHours','restore_no_','close','stopped','static','1XPfHQm','/update\x20-\x20update\x20Balance\x20Bot\x0a','temporary\x20access\x20timeout','440796eNDggR','text','conn','write','isValid','alerts','decrypt','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','split','environment','update-bot','get','/:bot/coins','range','simple','\x20to\x20','telegram','backup-full@','5\x20min','tkn','verify','temporary\x20access\x20rejected','create','inherit','#RES#\x20if\x20running\x20on\x20server','Enabled\x20Bot\x20','onepagemode','=>\x20Go\x20to\x20#CYA#http://','secure','Invalid\x20username\x20or\x20IP\x20address','get-messages','date-fns','getTime','Restarting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20update\x20bot','::1','Password\x20reset\x20rejected','78514uMdJXP','store','value','/:bot/history','(((.+)+)+)+$','placeOrder','File\x20uploaded','logout','privateKeyToPem','Markdown','staging','getDate','logged\x20out','/enable\x20-\x20enable\x20notifications\x0a','sendFile','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','telegram2FaApproval','/metrics\x20-\x20show\x20bot\x20performance\x0a','\x20|\x20client:\x20...','marketcapApi','enable','\x1b[36m','metrics_','bbvReceive','replyWithDocument','once','2FA\x20login\x20token\x20generated','settings.','telegraf','config_orders','express','node-forge','delete-bot','disable','0.0.0','571416YTZCHe','3000','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','apply','get-logs','stringify','ipc','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','off','Token\x20blacklisted','mixpanel','socket','bb-config.json','latestversion','pidRefreshToken','<b>Balance\x20Bot\x20Status:</b>\x0a','Starting\x20(','Restoring\x20bot(s)\x20from\x20backup','map','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','defaults','error','\x20files\x20over\x20Telegram:','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','/:bot/support','Node.js\x20v','get-starting-balances','copyFileSync','login\x20not\x20required','full','$1_$2_$3','unlinkSync','path','axios','-events.json','logs','-results.json','includes','exec','timestamp','ETH','existsSync','format','(staging)','generateAsync','internal','toggle_','exit','confirm-message','writeFileSync','name','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','running','getMonth','\x20>\x20','exchange','All','place-order','util','Password\x20has\x20been\x20reset\x20to:\x20','node','delete-alerts','keys','bb/','reinstall','pki','bb-settings.json','endsWith','Restore\x20process\x20confirmed','connection','#RES#\x20if\x20running\x20locally\x0a','button','toIPv4Address','login','on_','sort','config_alerts','output-002.log','botmanager','ipaddr.js','index.html','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','*$1*','blacklist',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','/:bot/configuration','Unauthorized\x20attempt\x20to\x20delete\x20alerts','filter','storeHeadless','type','Notifications\x20types:\x20','randomFillSync','manual','lowdb','privateKey','bbUsername','all','use','userid','hasOwnProperty','mode'];_0x3829=function(){return _0x4e4246;};return _0x3829();}dbSettings[_0x4ef0d1(0xdb)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x4ef0d1(0x2dd),'onepagemode':![],'marketcapApi':''}})[_0x4ef0d1(0x299)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();const saltRounds=0xa,mixpanel=Mixpanel[_0x4ef0d1(0x177)](_0x4ef0d1(0x1bb),{'host':_0x4ef0d1(0x187)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x4ef0d1(0x274)]&&(settings[_0x4ef0d1(0x274)]!=''&&settings[_0x4ef0d1(0x274)]!=_0x4ef0d1(0x193))&&settings[_0x4ef0d1(0x1a5)]&&settings[_0x4ef0d1(0x1a5)]!='')initTelegram();const parseColor=(_0x504094,_0x5931f8)=>{const _0x57d2b6=_0x4ef0d1,_0x18e4b2=/#[A-Z]{3}#/g;if(typeof _0x504094==_0x57d2b6(0x21b)){!_0x5931f8?_0x504094=_0x504094[_0x57d2b6(0x169)](_0x18e4b2,''):(_0x504094=_0x504094['replace'](/#BLU#/g,_0x57d2b6(0x1ed)),_0x504094=_0x504094[_0x57d2b6(0x169)](/#RED#/g,_0x57d2b6(0x282)),_0x504094=_0x504094[_0x57d2b6(0x169)](/#YEL#/g,'\x1b[33m'),_0x504094=_0x504094['replace'](/#MAG#/g,_0x57d2b6(0x141)),_0x504094=_0x504094[_0x57d2b6(0x169)](/#CYA#/g,_0x57d2b6(0x2d0)),_0x504094=_0x504094['replace'](/#RES#/g,_0x57d2b6(0x182)));;}return _0x504094;},logger={'screen':_0x525891=>{const _0x452e82=_0x4ef0d1;console[_0x452e82(0x20c)](parseColor(_0x525891,!![]));},'simple':_0x1abbfd=>{const _0x386374=_0x4ef0d1;console['log'](parseColor(_0x1abbfd,!![])),loggerfile[_0x386374(0x299)](util[_0x386374(0xf1)](parseColor(_0x1abbfd,![]))+'\x0a');},'full':async _0x245fe1=>{const _0x2cadfa=_0x4ef0d1,_0x1118f0=getTimeStamp()+_0x2cadfa(0x16d)+_0x245fe1;console[_0x2cadfa(0x20c)](parseColor(_0x1118f0,!![])),loggerfile[_0x2cadfa(0x299)](util[_0x2cadfa(0xf1)](parseColor(_0x1118f0,![]))+'\x0a');if(tgBot&&settings[_0x2cadfa(0x28a)]&&settings[_0x2cadfa(0x27e)]!=_0x2cadfa(0x277))await sendTelegram(settings[_0x2cadfa(0x28a)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x245fe1,![]));},'debug':async(_0x56ac14,_0x325050='')=>{const _0x3f23a2=_0x4ef0d1,_0x25e5f8=getTimeStamp()+_0x3f23a2(0x200)+_0x56ac14;if(debugging)console['log'](parseColor(_0x25e5f8,!![]));loggerfile[_0x3f23a2(0x299)](util[_0x3f23a2(0xf1)](parseColor(_0x25e5f8,![]))+'\x0a');if(_0x325050){if(debugging)console['log'](_0x325050);loggerfile[_0x3f23a2(0x299)](util[_0x3f23a2(0xf1)](_0x325050)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x17191a){const _0x556eca=_0x4ef0d1;_0x17191a[_0x556eca(0x280)]()['includes'](_0x556eca(0x286))?(logger[_0x556eca(0x2a4)](_0x556eca(0x1a4)+_0x17191a[_0x556eca(0x1c8)]+'#RES#'),process[_0x556eca(0x16b)]({'terminate':!![]},_0x40b406=>{})):logger[_0x556eca(0x2a4)](_0x17191a);}),process['on'](_0x4ef0d1(0xf6),()=>{const _0x477e33=_0x4ef0d1;stopAllBots(),process[_0x477e33(0xf6)](0x0);}),process['on'](_0x4ef0d1(0x1b2),()=>{const _0x53a8d9=_0x4ef0d1;stopAllBots(),process[_0x53a8d9(0xf6)](0x0);}),process['on'](_0x4ef0d1(0x243),()=>{const _0x5543bc=_0x4ef0d1;stopAllBots(),process[_0x5543bc(0xf6)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4ef0d1(0x151))[_0x4ef0d1(0x15f)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x4ef0d1(0x2d9)),app=express(),http=require('http')[_0x4ef0d1(0x12c)](app);app[_0x4ef0d1(0x128)](fileUpload({'useTempFiles':!![]})),app[_0x4ef0d1(0x2a1)](_0x4ef0d1(0x157),async(_0x24be07,_0xae327d)=>{const _0x44d6a2=_0x4ef0d1,_0x2bbeb6=_0x24be07[_0x44d6a2(0x130)][_0x44d6a2(0x120)],_0x46c427=getClientsWithBotID('botmanager'),_0x32f6f4=_0x24be07[_0x44d6a2(0x15d)][_0x44d6a2(0x153)],_0x29aa3a=timelyDecrypt(_0x32f6f4,![]),_0x589ac7=_0x46c427[_0x44d6a2(0x217)](_0x560ca5=>_0x560ca5['uuid']==_0x29aa3a);if(_0x589ac7){const _0x54093b=normalizeIP(_0x24be07[_0x44d6a2(0xd2)]['remoteAddress'])[_0x44d6a2(0x2bc)],_0x59c8a4=_0x24be07['headers'][_0x44d6a2(0x2a9)];if(validateAccess(_0x59c8a4,_0x29aa3a,_0x54093b)[_0x44d6a2(0x26c)])_0x2bbeb6==_0x44d6a2(0x1dc)&&await backupConfigFiles(),await zipFiles(_0x2bbeb6),_0xae327d['download'](zippath+(_0x2bbeb6+_0x44d6a2(0x214)),_0x4af79f=>{const _0x204c92=_0x44d6a2;_0x4af79f&&(logger[_0x204c92(0xe4)]('Failed\x20to\x20download\x20'+_0x2bbeb6),logger['simple'](_0x4af79f));});else logger[_0x44d6a2(0xe4)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x2bbeb6+_0x44d6a2(0x1a8));}else logger[_0x44d6a2(0xe4)](_0x44d6a2(0x210)+_0x2bbeb6+_0x44d6a2(0x1a6));}),app['post'](_0x4ef0d1(0x27d),async(_0x3205b8,_0x3769d)=>{const _0x2cd1bb=_0x4ef0d1,_0x500e28=getClientsWithBotID(_0x2cd1bb(0x115)),_0x283d86=_0x3205b8[_0x2cd1bb(0x15d)][_0x2cd1bb(0x153)],_0x3cad7b=timelyDecrypt(_0x283d86,![]),_0x40e603=_0x500e28['find'](_0x30cfb0=>_0x30cfb0[_0x2cd1bb(0x153)]==_0x3cad7b);logger[_0x2cd1bb(0x1be)](_0x2cd1bb(0x24a));if(_0x40e603){const _0x236921=normalizeIP(_0x3205b8[_0x2cd1bb(0xd2)][_0x2cd1bb(0x189)])[_0x2cd1bb(0x2bc)],_0x127eb5=_0x3205b8[_0x2cd1bb(0x15d)][_0x2cd1bb(0x2a9)];if(validateAccess(_0x127eb5,_0x3cad7b,_0x236921)['allow']){if(_0x3205b8[_0x2cd1bb(0x25e)]){const _0x4b9bc4=_0x3205b8['files']['backupfile'];await _0x4b9bc4['mv'](temppath+_0x4b9bc4[_0x2cd1bb(0xf9)]),_0x3769d['send']({'status':!![],'message':_0x2cd1bb(0x2c1)});const _0x37b41d=getBotsWithMode();_0x37b41d[_0x2cd1bb(0x176)]>0x0?confirmRestore(temppath,_0x4b9bc4['name']):unzipFile(temppath,_0x4b9bc4[_0x2cd1bb(0xf9)]);}}else logger[_0x2cd1bb(0xe4)](_0x2cd1bb(0x17a));}else logger[_0x2cd1bb(0xe4)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x4ef0d1(0x128)](express['static'](path['join'](__dirname,bbpath2,_0x4ef0d1(0x232)))),app[_0x4ef0d1(0x128)](express[_0x4ef0d1(0x292)](path['join'](__dirname,bbpath2,_0x4ef0d1(0x146)))),app[_0x4ef0d1(0x2a1)]('/',function(_0x3a501d,_0x821494){const _0x1b8a60=_0x4ef0d1;_0x821494['sendFile'](path['join'](__dirname,bbpath2,_0x1b8a60(0x232),_0x1b8a60(0x117)));}),app[_0x4ef0d1(0x2a1)](_0x4ef0d1(0x178),function(_0x2dd842,_0x1e8baa){const _0x2fe921=_0x4ef0d1;_0x1e8baa['sendFile'](path['join'](__dirname,bbpath2,'build',_0x2fe921(0x117)));}),app[_0x4ef0d1(0x2a1)](_0x4ef0d1(0x1ae),(_0x153e2e,_0x273cab)=>{const _0x285976=_0x4ef0d1;_0x273cab['sendFile'](path[_0x285976(0x22b)](__dirname,bbpath2,'build',_0x285976(0x117)));}),app[_0x4ef0d1(0x2a1)](_0x4ef0d1(0x150),(_0xd04ec2,_0x1cce03)=>{const _0x37e3d6=_0x4ef0d1;_0x1cce03[_0x37e3d6(0x2c9)](path[_0x37e3d6(0x22b)](__dirname,bbpath2,_0x37e3d6(0x146),_0x37e3d6(0x117)));}),app[_0x4ef0d1(0x2a1)](_0x4ef0d1(0x2a2),(_0x38b858,_0x774e7c)=>{const _0x144069=_0x4ef0d1;_0x774e7c[_0x144069(0x2c9)](path[_0x144069(0x22b)](__dirname,bbpath2,_0x144069(0x146),'index.html'));}),app[_0x4ef0d1(0x2a1)](_0x4ef0d1(0x2be),(_0x443c5d,_0x1329ac)=>{const _0x17565d=_0x4ef0d1;_0x1329ac[_0x17565d(0x2c9)](path['join'](__dirname,bbpath2,_0x17565d(0x146),_0x17565d(0x117)));}),app[_0x4ef0d1(0x2a1)](_0x4ef0d1(0x11c),(_0x146c45,_0x37d32c)=>{const _0x5de8ed=_0x4ef0d1;_0x37d32c[_0x5de8ed(0x2c9)](path[_0x5de8ed(0x22b)](__dirname,bbpath2,_0x5de8ed(0x146),_0x5de8ed(0x117)));}),app[_0x4ef0d1(0x2a1)](_0x4ef0d1(0xdf),(_0x5c1e14,_0x154852)=>{const _0x467aa4=_0x4ef0d1;_0x154852[_0x467aa4(0x2c9)](path[_0x467aa4(0x22b)](__dirname,bbpath2,_0x467aa4(0x146),_0x467aa4(0x117)));});if(HOST)http[_0x4ef0d1(0x15e)](PORT,HOST);else http[_0x4ef0d1(0x15e)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x545513=_0x4ef0d1;let _0x5ceed8=_0x545513(0x18c);const _0x562062=networkInterfaces(),_0x34ea8e={};for(const _0x54ca9b of Object[_0x545513(0x105)](_0x562062)){for(const _0x551e50 of _0x562062[_0x54ca9b]){if((_0x551e50[_0x545513(0x222)]==_0x545513(0x18e)||_0x551e50[_0x545513(0x222)]==0x4)&&!_0x551e50[_0x545513(0xf4)]){const _0x3e1584=ipaddr[_0x545513(0x17d)](_0x551e50[_0x545513(0x253)])[_0x545513(0x2a3)]();_0x3e1584!='private'&&(!_0x34ea8e[_0x54ca9b]&&(_0x34ea8e[_0x54ca9b]=[]),_0x34ea8e[_0x54ca9b][_0x545513(0x1a7)](_0x551e50[_0x545513(0x253)]),_0x5ceed8=_0x551e50['address']);}}}return{'serverip':_0x5ceed8,'netinterfaces':_0x34ea8e};}async function startServer(){const _0x2aee5c=_0x4ef0d1,{serverip:_0x14affa,netinterfaces:_0x48fbca}=getServerIP();logger[_0x2aee5c(0x2a4)](''),logger[_0x2aee5c(0x2a4)](_0x2aee5c(0x23d)),await logger['full'](_0x2aee5c(0x179)+serverversion+_0x2aee5c(0x13e)+(environment==_0x2aee5c(0x2c5)?_0x2aee5c(0xf2):'')+'\x0a'+(_0x2aee5c(0x226)+PORT+_0x2aee5c(0x10d))+(_0x2aee5c(0x2b1)+_0x14affa+':'+PORT+_0x2aee5c(0x2ae))),logger[_0x2aee5c(0x2a4)]('-----------------------------------------------------------------------------------');if(config[_0x2aee5c(0x176)]!=0x0)for(const _0x4ccfac of config){const _0x2a69d7=_0x4ccfac[_0x2aee5c(0x12b)]==_0x2aee5c(0x144)?'a':'m';if(_0x4ccfac[_0x2aee5c(0x28d)]==_0x2aee5c(0x22c)||_0x4ccfac[_0x2aee5c(0x28d)]==_0x2aee5c(0x18b))await logger['full'](_0x2aee5c(0xd7)+_0x2a69d7+_0x2aee5c(0x245)+_0x4ccfac[_0x2aee5c(0x233)]+'\x20|\x20'+_0x4ccfac[_0x2aee5c(0x12d)]),startBot([_0x4ccfac[_0x2aee5c(0x233)],userID],{'cwd':bbpath},function(_0x2de2d2){if(_0x2de2d2)logger['full'](_0x2de2d2);});else(_0x4ccfac[_0x2aee5c(0x28d)]==_0x2aee5c(0x17b)||_0x4ccfac[_0x2aee5c(0x28d)]=='new-disabled')&&await logger[_0x2aee5c(0xe4)](_0x2aee5c(0x1b3)+_0x2a69d7+_0x2aee5c(0x19d)+_0x4ccfac[_0x2aee5c(0x233)]+_0x2aee5c(0x25a)+_0x4ccfac[_0x2aee5c(0x12d)]);}else!newBot&&logger['simple'](_0x2aee5c(0x13a));if(newBot)addBot();logger[_0x2aee5c(0x2a4)]('-----------------------------------------------------------------------------------'),logger[_0x2aee5c(0x2a4)](''),await logger[_0x2aee5c(0x1be)](_0x2aee5c(0xe0)+nodeversion),await logger[_0x2aee5c(0x1be)](_0x2aee5c(0x1ee),_0x48fbca);}function startSocket(){const _0x1d9719=_0x4ef0d1;io['on'](_0x1d9719(0x10c),_0x201b0b=>{const _0x5657ab=_0x1d9719;let _0xbbf3ac,_0x249c48,_0x255841,_0x41ebe7,_0x2bffc4;const _0x5711ef=_0x201b0b['handshake'][_0x5657ab(0x15d)]['referer'];_0x249c48=_0x5711ef['match'](/bot[0-9]{3}/);if(_0x249c48)_0x255841=_0x249c48[0x0][_0x5657ab(0x1c2)](/[0-9]{3}/);if(_0x255841)_0xbbf3ac=_0x255841[0x0];else _0xbbf3ac=_0x5657ab(0x115);const _0x237eb2=_0x201b0b[_0x5657ab(0x185)][_0x5657ab(0x270)][_0x5657ab(0x281)];if(!_0x237eb2)_0x201b0b['emit'](_0x5657ab(0x28d),{'publicKey':secure[_0x5657ab(0x20b)]});else{_0x41ebe7=timelyDecrypt(_0x237eb2,![]);if(!_0x41ebe7)_0x201b0b[_0x5657ab(0x1db)](_0x5657ab(0x28d),{'publicKey':secure[_0x5657ab(0x20b)]});else{_0x2bffc4=normalizeIP(_0x201b0b[_0x5657ab(0x298)][_0x5657ab(0x189)])[_0x5657ab(0x2bc)];if(!devices[_0x41ebe7])devices[_0x41ebe7]={'uuid':_0x41ebe7,'access':{'token':null}};devices[_0x41ebe7]['ip']=_0x2bffc4;const _0x5997f6=addClient(_0x201b0b['id'],_0x41ebe7,_0xbbf3ac);setAccess(_0x5997f6),emitMessages(),_0x201b0b['on']('login',_0x151380=>{const _0x341f3a=_0x5657ab,_0x3f83f6=timelyDecrypt(_0x151380[_0x341f3a(0x223)],!![],_0x341f3a(0x218));if(_0x3f83f6){_0x151380={'username':_0x151380[_0x341f3a(0x13f)],'password':_0x3f83f6},devices[_0x41ebe7][_0x341f3a(0x19c)]=validateCredentials(_0x151380,_0x41ebe7);if(devices[_0x41ebe7][_0x341f3a(0x19c)][_0x341f3a(0x26c)]==![]&&devices[_0x41ebe7][_0x341f3a(0x19c)][_0x341f3a(0x135)]=='2FA\x20login\x20required')_0x201b0b[_0x341f3a(0x1db)](_0x341f3a(0x28d),{'access':devices[_0x41ebe7][_0x341f3a(0x19c)]}),loginAccess2FA(_0x41ebe7,_0x2bffc4);else{if(devices[_0x41ebe7][_0x341f3a(0x19c)][_0x341f3a(0x26c)]==![]&&devices[_0x41ebe7][_0x341f3a(0x19c)][_0x341f3a(0x135)]==_0x341f3a(0x1b8))_0x201b0b[_0x341f3a(0x1db)](_0x341f3a(0x28d),{'access':devices[_0x41ebe7][_0x341f3a(0x19c)]});else devices[_0x41ebe7][_0x341f3a(0x19c)]['allow']&&devices[_0x41ebe7][_0x341f3a(0x19c)][_0x341f3a(0x135)]==_0x341f3a(0x197)&&(getClientsWithUuid(_0x41ebe7)[_0x341f3a(0x205)](_0x1cf51f=>{setAccess(_0x1cf51f);}),logger['debug'](_0x341f3a(0x1e6)+_0x41ebe7[_0x341f3a(0x1f9)](-0x8)),setTokenRefresh(_0x41ebe7),setSessionTimeout('login',_0x41ebe7));}}else logger['full']('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x201b0b['on'](_0x5657ab(0x14b),()=>{resetPassword();}),_0x201b0b['on']('disconnect',_0x2c23d9=>{removeClient(_0x201b0b['id']);}),_0xbbf3ac==_0x5657ab(0x115)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x23c4da){const _0x2f2159=_0x4ef0d1;if(_0x23c4da!=_0x2f2159(0x115)&&config[_0x2f2159(0x166)]!=''){if(pid[_0x23c4da])pid[_0x23c4da][_0x2f2159(0x16b)]({'function':'initclient','args':null});}_0x23c4da!=_0x2f2159(0x115)&&broadcastToBots(_0x2f2159(0x23a),JSON['stringify'](config));}function reloadBotManager(){const _0x931c6d=_0x4ef0d1;getClientsWithBotID(_0x931c6d(0x115))['forEach'](_0x8d6398=>{const _0x5315d1=_0x931c6d;getSocket(_0x8d6398['id'])[_0x5315d1(0x1db)](_0x5315d1(0x28d),{'access':{'allow':![],'reason':_0x5315d1(0x1cd),'token':null}});});}function getSocket(_0x16ddcc){const _0x2944c0=_0x4ef0d1,_0x878033=io[_0x2944c0(0x1da)][_0x2944c0(0x2a1)]('/');return _0x878033['sockets'][_0x2944c0(0x2a1)](_0x16ddcc);}function setAccess(_0x9b1743){const _0x4f1172=_0x4ef0d1,_0xfc9732=getSocket(_0x9b1743['id']),_0x2c3660=_0x9b1743['uuid'],_0x15325b=_0x9b1743[_0x4f1172(0x1ef)];devices[_0x2c3660][_0x4f1172(0x19c)]=validateAccess(devices[_0x2c3660][_0x4f1172(0x19c)][_0x4f1172(0x199)],_0x2c3660),logger['debug']('Setting\x20access:\x20'+devices[_0x2c3660][_0x4f1172(0x19c)][_0x4f1172(0x135)]+_0x4f1172(0x2cd)+_0x9b1743['id'][_0x4f1172(0x1f9)](-0x8)+'\x20|\x20user:\x20...'+_0x2c3660[_0x4f1172(0x1f9)](-0x8)),_0xfc9732[_0x4f1172(0x22b)](_0x2c3660);if(devices[_0x2c3660][_0x4f1172(0x19c)][_0x4f1172(0x26c)]){_0xfc9732['join'](_0x15325b);if(_0x15325b=='botmanager')initializeSocketBotManager(_0xfc9732);else initializeSocketBot(_0xfc9732);initClient(_0x15325b);}devices[_0x2c3660][_0x4f1172(0x19c)][_0x4f1172(0x199)]&&devices[_0x2c3660][_0x4f1172(0x19c)][_0x4f1172(0x135)]==_0x4f1172(0x1b1)&&setSessionTimeout('2FA',_0x2c3660),devices[_0x2c3660][_0x4f1172(0x19c)][_0x4f1172(0x199)]&&devices[_0x2c3660]['access']['reason']==_0x4f1172(0x2d5)&&setSessionTimeout(_0x4f1172(0x110),_0x2c3660),_0xfc9732[_0x4f1172(0x1db)](_0x4f1172(0x28d),{'status':_0x9b1743['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2c3660][_0x4f1172(0x19c)],'externalip':devices[_0x2c3660]['ip'],'publicKey':secure[_0x4f1172(0x20b)],'userid':settings[_0x4f1172(0x129)],'validInstallation':validInstallation}),devices[_0x2c3660]['access'][_0x4f1172(0x26c)]==![]&&devices[_0x2c3660]['access'][_0x4f1172(0x135)]==_0x4f1172(0x234)&&temporaryAccess2FA(_0x2c3660,devices[_0x2c3660]['ip']);}function setSessionTimeout(_0x35beef,_0x30c7fa){const _0x48c876=_0x4ef0d1;let _0x4d9936;if(_0x35beef==_0x48c876(0x110))_0x4d9936=loginExpiry*0x3c*0x3e8;else _0x4d9936=devices[_0x30c7fa]['telegramIpApproval'][_0x48c876(0x1b9)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x30c7fa][_0x48c876(0x160)]['timestamp']);if(devices[_0x30c7fa]['pidExpireLogin'])clearTimeout(devices[_0x30c7fa][_0x48c876(0x18f)]);devices[_0x30c7fa]['pidExpireLogin']=setTimeout(()=>{const _0x205422=_0x48c876;if(devices[_0x30c7fa]['pidRefreshToken'])clearTimeout(devices[_0x30c7fa][_0x205422(0xd5)]);removeSocketListeners(_0x30c7fa),addBlacklist(_0x30c7fa),devices[_0x30c7fa][_0x205422(0x160)]=null,devices[_0x30c7fa][_0x205422(0x2cb)]=null,devices[_0x30c7fa]['access'][_0x205422(0x199)]=null,logger[_0x205422(0x1be)]('Session\x20expired\x20for\x20user\x20...'+_0x30c7fa[_0x205422(0x1f9)](-0x8)),devices[_0x30c7fa][_0x205422(0x19c)]=validateAccess(devices[_0x30c7fa][_0x205422(0x19c)][_0x205422(0x199)],_0x30c7fa),!(devices[_0x30c7fa][_0x205422(0x19c)][_0x205422(0x26c)]&&devices[_0x30c7fa]['access'][_0x205422(0x135)]==_0x205422(0xe3))&&(_0x35beef==_0x205422(0x110)?io['to'](_0x30c7fa)[_0x205422(0x1db)](_0x205422(0x28d),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x30c7fa)[_0x205422(0x1db)](_0x205422(0x28d),{'access':{'allow':![],'reason':_0x205422(0x295),'token':null}})),devices[_0x30c7fa]['access'][_0x205422(0x199)]=null;},_0x4d9936);}function setTokenRefresh(_0x5611e9){const _0x2e73c7=_0x4ef0d1;if(devices[_0x5611e9]['pidRefreshToken'])clearTimeout(devices[_0x5611e9][_0x2e73c7(0xd5)]);devices[_0x5611e9][_0x2e73c7(0xd5)]=setTimeout(()=>{const _0x16b5f9=_0x2e73c7;getClientsWithUuid(_0x5611e9)[_0x16b5f9(0x176)]!=0x0?(devices[_0x5611e9][_0x16b5f9(0x19c)]=refreshToken(_0x5611e9),io['to'](_0x5611e9)[_0x16b5f9(0x1db)]('status',{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5611e9]['access'],'externalip':devices[_0x5611e9]['ip'],'publicKey':secure[_0x16b5f9(0x20b)],'validInstallation':validInstallation}),setTokenRefresh(_0x5611e9)):clearTimeout(devices[_0x5611e9][_0x16b5f9(0xd5)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3500e0){const _0x9a71b1=_0x4ef0d1,_0xc6a4de=getClient(_0x3500e0['id'])[_0x9a71b1(0x153)];_0x3500e0[_0x9a71b1(0x1db)](_0x9a71b1(0x23a),config),_0x3500e0[_0x9a71b1(0x1db)](_0x9a71b1(0x1d6),cleanSettings()),_0x3500e0['on'](_0x9a71b1(0x1e1),_0x400d71=>{const _0x3bad22=_0x9a71b1;if(validateAccess(_0x400d71,_0xc6a4de)[_0x3bad22(0x26c)])addBot();else logger['full'](_0x3bad22(0x1e3));}),_0x3500e0['on'](_0x9a71b1(0x2a0),(_0x356e93,_0xa74217)=>{const _0x3480de=_0x9a71b1;if(validateAccess(_0xa74217,_0xc6a4de)[_0x3480de(0x26c)])toggleBot(_0x356e93[_0x3480de(0x233)],_0x356e93[_0x3480de(0x28d)],_0x356e93[_0x3480de(0x1b6)]);else logger[_0x3480de(0xe4)](_0x3480de(0x2b8));}),_0x3500e0['on']('toggle-bot-mode',(_0x34a70d,_0x1a2b3f)=>{const _0x395ab0=_0x9a71b1;if(validateAccess(_0x1a2b3f,_0xc6a4de)['allow'])toggleBotMode(_0x34a70d);else logger[_0x395ab0(0xe4)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3500e0['on'](_0x9a71b1(0x2db),(_0x21ac9d,_0x22c562)=>{const _0x275d90=_0x9a71b1;if(validateAccess(_0x22c562,_0xc6a4de)[_0x275d90(0x26c)])deleteBot(_0x21ac9d);else logger['full'](_0x275d90(0x220));}),_0x3500e0['on'](_0x9a71b1(0x173),(_0x489241,_0x23656e)=>{const _0x4b15de=_0x9a71b1;if(validateAccess(_0x23656e,_0xc6a4de)[_0x4b15de(0x26c)])storeSettings(_0x489241,!![]);else logger[_0x4b15de(0xe4)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x3500e0['on']('update-bb',_0x5281fb=>{const _0x71d786=_0x9a71b1;if(validateAccess(_0x5281fb,_0xc6a4de)[_0x71d786(0x26c)])updateBB('update');else logger[_0x71d786(0xe4)](_0x71d786(0x21a));}),_0x3500e0['on'](_0x9a71b1(0x19b),_0x1416d8=>{const _0x4e777e=_0x9a71b1;if(validateAccess(_0x1416d8,_0xc6a4de)['allow'])updateBB(_0x4e777e(0x107));else logger[_0x4e777e(0xe4)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x3500e0['on'](_0x9a71b1(0x244),_0x53613e=>{const _0x483d38=_0x9a71b1;if(validateAccess(_0x53613e,_0xc6a4de)[_0x483d38(0x26c)]){const _0x5ae056=getClient(_0x3500e0['id']);if(_0x5ae056)getBackupFiles(_0x5ae056[_0x483d38(0x153)]);else logger['full']('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x483d38(0xe4)](_0x483d38(0x275));}),_0x3500e0['on'](_0x9a71b1(0x22a),(_0x4d1fac,_0x4a826c)=>{const _0x46f254=_0x9a71b1;if(validateAccess(_0x4a826c,_0xc6a4de)[_0x46f254(0x26c)])restoreBackupFile(_0x4d1fac);else logger['full'](_0x46f254(0x2e0));}),_0x3500e0['on'](_0x9a71b1(0x2b4),_0x3fde75=>{const _0x1d67c5=_0x9a71b1;if(validateAccess(_0x3fde75,_0xc6a4de)[_0x1d67c5(0x26c)])getMessages();else logger[_0x1d67c5(0xe4)](_0x1d67c5(0x24d));}),_0x3500e0['on'](_0x9a71b1(0xf7),(_0x17f5af,_0x2e38f5)=>{const _0x1dff29=_0x9a71b1;if(validateAccess(_0x2e38f5,_0xc6a4de)[_0x1dff29(0x26c)])confirmMessage(_0x17f5af);else logger['full'](_0x1dff29(0x1f7));}),_0x3500e0['on'](_0x9a71b1(0x2c2),_0x183ed7=>{const _0x57f736=_0x9a71b1;if(validateAccess(_0x183ed7,_0xc6a4de)['allow']){if(devices[_0xc6a4de][_0x57f736(0xd5)])clearTimeout(devices[_0xc6a4de][_0x57f736(0xd5)]);if(devices[_0xc6a4de][_0x57f736(0x18f)])clearTimeout(devices[_0xc6a4de][_0x57f736(0x18f)]);removeSocketListeners(getClient(_0x3500e0['id'])[_0x57f736(0x153)]),addBlacklist(_0xc6a4de),devices[_0xc6a4de][_0x57f736(0x160)]=null,devices[_0xc6a4de][_0x57f736(0x2cb)]=null,devices[_0xc6a4de][_0x57f736(0x19c)][_0x57f736(0x199)]=null,logger['debug'](_0x57f736(0x1b7)+_0xc6a4de[_0x57f736(0x1f9)](-0x8)),io['to'](getClient(_0x3500e0['id'])[_0x57f736(0x153)])[_0x57f736(0x1db)](_0x57f736(0x28d),{'access':{'allow':![],'reason':_0x57f736(0x2c7),'token':null}});}else logger['full'](_0x57f736(0x158));});}function initializeSocketBot(_0x237af9){const _0x426e97=_0x4ef0d1,_0x45a1eb=getClient(_0x237af9['id'])[_0x426e97(0x1ef)],_0x2dff3e=getClient(_0x237af9['id'])[_0x426e97(0x153)];_0x237af9['on'](_0x426e97(0x2e2),(_0x2d5fc1,_0x413ccb)=>{const _0x4115d3=_0x426e97;if(validateAccess(_0x413ccb,_0x2dff3e)[_0x4115d3(0x26c)]){if(pid[_0x45a1eb])pid[_0x45a1eb]['send']({'function':'emitHistory','args':_0x2d5fc1});}else logger[_0x4115d3(0xe4)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x237af9['on'](_0x426e97(0x104),(_0x4c2016,_0xff722e)=>{const _0x28cb39=_0x426e97;if(validateAccess(_0xff722e,_0x2dff3e)[_0x28cb39(0x26c)]){if(pid[_0x45a1eb])pid[_0x45a1eb]['send']({'function':'deleteHistoryAlerts','args':_0x4c2016});}else logger[_0x28cb39(0xe4)](_0x28cb39(0x11d));}),_0x237af9['on'](_0x426e97(0x14e),(_0x2f96e8,_0x10f4f7)=>{const _0x34033c=_0x426e97;if(validateAccess(_0x10f4f7,_0x2dff3e)[_0x34033c(0x26c)]){if(pid[_0x45a1eb])pid[_0x45a1eb][_0x34033c(0x16b)]({'function':_0x34033c(0x23b),'args':_0x2f96e8});}else logger['full'](_0x34033c(0x152));}),_0x237af9['on'](_0x426e97(0x252),(_0x30c829,_0x32f71d)=>{const _0x14539d=_0x426e97;if(validateAccess(_0x32f71d,_0x2dff3e)[_0x14539d(0x26c)]){if(pid[_0x45a1eb])pid[_0x45a1eb][_0x14539d(0x16b)]({'function':_0x14539d(0x1f5),'args':_0x30c829});}else logger[_0x14539d(0xe4)](_0x14539d(0x143));}),_0x237af9['on'](_0x426e97(0x1cf),(_0x181ebc,_0x5b4337)=>{const _0xd17047=_0x426e97;if(validateAccess(_0x5b4337,_0x2dff3e)[_0xd17047(0x26c)]){if(pid[_0x45a1eb])pid[_0x45a1eb][_0xd17047(0x16b)]({'function':_0xd17047(0x11f),'args':_0x181ebc});}else logger[_0xd17047(0xe4)](_0xd17047(0x264));}),_0x237af9['on']('store-fiat',(_0x117f22,_0x35f7c2)=>{const _0x406496=_0x426e97;if(validateAccess(_0x35f7c2,_0x2dff3e)[_0x406496(0x26c)]){if(pid[_0x45a1eb])pid[_0x45a1eb]['send']({'function':'storeFiat','args':_0x117f22});}else logger['full'](_0x406496(0x29d));}),_0x237af9['on']('reset-history',_0x3544ae=>{const _0x4f8a71=_0x426e97;if(validateAccess(_0x3544ae,_0x2dff3e)['allow']){if(pid[_0x45a1eb])pid[_0x45a1eb][_0x4f8a71(0x16b)]({'function':'resetHistory','args':null});}else logger[_0x4f8a71(0xe4)](_0x4f8a71(0xda));}),_0x237af9['on'](_0x426e97(0xe1),_0x10886b=>{const _0x397b2b=_0x426e97;if(validateAccess(_0x10886b,_0x2dff3e)[_0x397b2b(0x26c)]){if(pid[_0x45a1eb])pid[_0x45a1eb]['send']({'function':'getStartingBalances','args':null});}else logger[_0x397b2b(0xe4)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x237af9['on'](_0x426e97(0x100),(_0x1e6ed0,_0x5ef4cc)=>{const _0x2a1ad3=_0x426e97;if(validateAccess(_0x5ef4cc,_0x2dff3e)[_0x2a1ad3(0x26c)]){if(pid[_0x45a1eb])pid[_0x45a1eb]['send']({'function':_0x2a1ad3(0x2c0),'args':_0x1e6ed0});}else logger['full'](_0x2a1ad3(0x188));}),_0x237af9['on'](_0x426e97(0x16c),_0x44a95d=>{const _0x5d3acc=_0x426e97;if(validateAccess(_0x44a95d,_0x2dff3e)[_0x5d3acc(0x26c)]){if(pid[_0x45a1eb])pid[_0x45a1eb][_0x5d3acc(0x16b)]({'function':_0x5d3acc(0x136),'args':null});}else logger[_0x5d3acc(0xe4)](_0x5d3acc(0x1bc));}),_0x237af9['on'](_0x426e97(0x1d9),_0xd88dae=>{const _0x55069d=_0x426e97;if(validateAccess(_0xd88dae,_0x2dff3e)[_0x55069d(0x26c)]){if(pid[_0x45a1eb])pid[_0x45a1eb][_0x55069d(0x16b)]({'function':_0x55069d(0x16a),'args':null});}else logger[_0x55069d(0xe4)](_0x55069d(0x17e));}),_0x237af9['on']('update-bb',_0x461df7=>{const _0x88198b=_0x426e97;if(validateAccess(_0x461df7,_0x2dff3e)['allow'])updateBB(_0x88198b(0x1ce));else logger[_0x88198b(0xe4)](_0x88198b(0x21a));}),_0x237af9['on']('get-messages',_0xdec7f0=>{const _0x189549=_0x426e97;if(validateAccess(_0xdec7f0,_0x2dff3e)['allow'])getMessages();else logger[_0x189549(0xe4)](_0x189549(0x24d));}),_0x237af9['on'](_0x426e97(0xf7),(_0xc906a1,_0x5e4f68)=>{const _0xb86a5a=_0x426e97;if(validateAccess(_0x5e4f68,_0x2dff3e)[_0xb86a5a(0x26c)])confirmMessage(_0xc906a1);else logger['full'](_0xb86a5a(0x1f7));}),_0x237af9['on'](_0x426e97(0x2c2),_0x4d8040=>{const _0x1f624f=_0x426e97;if(validateAccess(_0x4d8040,_0x2dff3e)[_0x1f624f(0x26c)]){if(devices[_0x2dff3e][_0x1f624f(0xd5)])clearTimeout(devices[_0x2dff3e][_0x1f624f(0xd5)]);if(devices[_0x2dff3e][_0x1f624f(0x18f)])clearTimeout(devices[_0x2dff3e][_0x1f624f(0x18f)]);removeSocketListeners(getClient(_0x237af9['id'])[_0x1f624f(0x153)]),addBlacklist(_0x2dff3e),devices[_0x2dff3e][_0x1f624f(0x160)]=null,devices[_0x2dff3e]['telegram2FaApproval']=null,devices[_0x2dff3e][_0x1f624f(0x19c)][_0x1f624f(0x199)]=null,logger[_0x1f624f(0x1be)]('Logged\x20out\x20user\x20...'+_0x2dff3e['slice'](-0x8)),io['to'](getClient(_0x237af9['id'])[_0x1f624f(0x153)])['emit']('status',{'access':{'allow':![],'reason':_0x1f624f(0x2c7),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x4a8f95){const _0x170925=_0x4ef0d1;getClientsWithUuid(_0x4a8f95)[_0x170925(0x205)](_0x51f01b=>{const _0x35d753=_0x170925;getSocket(_0x51f01b['id'])[_0x35d753(0x149)]();});}function cleanSettings(){const _0x301357=_0x4ef0d1;let _0x2ccc7f=settings;return settings[_0x301357(0x274)]&&settings[_0x301357(0x274)]!=''&&(_0x2ccc7f={..._0x2ccc7f,'telegramToken':'************'}),settings[_0x301357(0x284)]&&settings[_0x301357(0x284)]!=''&&(_0x2ccc7f={..._0x2ccc7f,'bbPassword':_0x301357(0x186)}),settings[_0x301357(0x2ce)]&&settings['marketcapApi']!=''&&(_0x2ccc7f={..._0x2ccc7f,'marketcapApi':'************'}),(settings[_0x301357(0x284)]&&settings['bbPassword']==_0x301357(0x193)||settings[_0x301357(0x274)]&&settings[_0x301357(0x274)]==_0x301357(0x193)||settings['marketcapApi']&&settings[_0x301357(0x2ce)]=='***')&&(_0x2ccc7f={..._0x2ccc7f,'restored':{'password':settings[_0x301357(0x284)]==_0x301357(0x193),'telegram':settings[_0x301357(0x274)]=='***','marketcap':settings[_0x301357(0x2ce)]=='***'}}),_0x2ccc7f;}async function updateBB(_0x44e01e){const _0x47d05f=_0x4ef0d1;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0xb7d9d3=>{const _0x27e0ba=_0x5cae;restartBot(_0xb7d9d3[_0x27e0ba(0x233)]);});if(_0x44e01e==_0x47d05f(0x1ce))process['send']({'update':!![],'environment':environment},_0x4f7664=>{});else _0x44e01e==_0x47d05f(0x107)&&process[_0x47d05f(0x16b)]({'reinstall':!![],'environment':environment},_0x642162=>{});}function startBot(_0x50073f,_0x5088d2,_0x5085cb){const _0x26f7f8=_0x4ef0d1;if(debugging)_0x50073f[_0x26f7f8(0x1a7)]('-d');if(recreate)_0x50073f[_0x26f7f8(0x1a7)]('-r');let _0x19e12b=![];const _0x5e7225=_0x50073f[0x0];_0x5088d2={..._0x5088d2,'stdio':[_0x26f7f8(0x2ad),_0x26f7f8(0x2ad),'inherit',_0x26f7f8(0x2e4)]},pid[_0x5e7225]=childProcess['fork'](botfile,_0x50073f,_0x5088d2),pid[_0x5e7225]['on'](_0x26f7f8(0x27b),_0x3c7285=>{const _0x4487e9=_0x26f7f8;switch(Object[_0x4487e9(0x105)](_0x3c7285)[0x0]){case _0x4487e9(0x12d):updateBotName(_0x5e7225,_0x3c7285[_0x4487e9(0x12d)]);break;case'updatebotmanager':updateBotManager();break;case _0x4487e9(0x28d):updateStatus(_0x5e7225,_0x3c7285[_0x4487e9(0x28d)]);break;case _0x4487e9(0x1b6):updateLive(_0x5e7225,_0x3c7285[_0x4487e9(0x1b6)]);break;case'started':updateLive(_0x5e7225,_0x3c7285[_0x4487e9(0x20a)]),io['to'](_0x5e7225)['emit']('status',{'access':{'allow':![],'reason':_0x4487e9(0x1cd),'token':null}});break;case'stop':_0x3c7285[_0x4487e9(0x155)]==_0x4487e9(0x258)&&restartBot(_0x5e7225);_0x3c7285['stop']==_0x4487e9(0x24b)&&toggleBot(_0x5e7225,_0x4487e9(0x17b),_0x4487e9(0x291));break;case'telegram':sendTelegramBot(_0x5e7225,_0x3c7285[_0x4487e9(0x2a6)]);break;case'telegrammsg':sendTelegramMsg(_0x3c7285[_0x4487e9(0x207)]);break;case _0x4487e9(0x12e):io['to'](_0x5e7225)[_0x4487e9(0x1db)](_0x3c7285[_0x4487e9(0x12e)],_0x3c7285[_0x4487e9(0x201)]);break;}}),pid[_0x5e7225]['on'](_0x26f7f8(0xdc),function(_0xff44dd){if(_0x19e12b)return;_0x19e12b=!![],_0x5085cb(_0xff44dd);}),pid[_0x5e7225]['on'](_0x26f7f8(0xf6),async function(_0x273064){const _0x422cb1=_0x26f7f8;if(terminating)return;if(installingUpdate){io[_0x422cb1(0x290)]();return;}if(_0x19e12b)return;_0x19e12b=!![],_0x5085cb(null);const _0x27b109=dbConfig[_0x422cb1(0x2a1)](_0x422cb1(0x23a))[_0x422cb1(0x217)]({'botID':_0x5e7225})[_0x422cb1(0x2bd)]();_0x27b109&&(_0x27b109[_0x422cb1(0x28d)]==_0x422cb1(0x22c)||_0x27b109[_0x422cb1(0x28d)]==_0x422cb1(0x18b))&&(await sleep(0x3e8),updateLive(_0x5e7225,_0x422cb1(0x291)),logger[_0x422cb1(0xe4)](_0x422cb1(0x2b7)+_0x5e7225),startBot([_0x5e7225,userID],{'cwd':bbpath},function(_0x333509){const _0x4989c9=_0x422cb1;if(_0x333509)logger[_0x4989c9(0xe4)](_0x333509);}));});}function stopBot(_0x3d3b0d){const _0x431158=_0x4ef0d1;getClientsWithBotID(_0x3d3b0d)[_0x431158(0x205)](_0xea0268=>{const _0x58d28a=_0x431158;getSocket(_0xea0268['id'])[_0x58d28a(0x194)](!![]),removeClient(_0xea0268['id']);}),pid[_0x3d3b0d]&&(pid[_0x3d3b0d]['kill'](),pid[_0x3d3b0d]=null);}function stopAllBots(){const _0x3a6e94=_0x4ef0d1;terminating=!![];const _0x5191ee=getEnabledBots();_0x5191ee[_0x3a6e94(0x205)](_0x5b74fc=>{const _0x54c03c=_0x3a6e94;stopBot(_0x5b74fc[_0x54c03c(0x233)]);});}function restartBot(_0x542a31){if(pid[_0x542a31])pid[_0x542a31]['kill']();}function addBot(){const _0x93ec7b=_0x4ef0d1;let _0x228bef;for(let _0x44eae7=0x1;_0x44eae7<0x3e9;_0x44eae7++){_0x228bef=_0x44eae7[_0x93ec7b(0x280)]()[_0x93ec7b(0x1df)](0x3,'0');let _0x4acbe6=config[_0x93ec7b(0x217)](_0x4b6139=>_0x4b6139[_0x93ec7b(0x233)]==_0x228bef);if(!_0x4acbe6)break;}if(_0x228bef===_0x93ec7b(0x165)){logger[_0x93ec7b(0xe4)](_0x93ec7b(0x1e7));return;}logger[_0x93ec7b(0xe4)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x228bef),dbConfig[_0x93ec7b(0x2a1)](_0x93ec7b(0x23a))['push']({'botID':_0x228bef,'botname':_0x93ec7b(0x1fe)+_0x228bef,'status':_0x93ec7b(0x18b),'live':''})[_0x93ec7b(0x299)](),startBot([_0x228bef,userID],{'cwd':bbpath},function(_0x59c8f6){const _0x4fb0d=_0x93ec7b;if(_0x59c8f6)logger[_0x4fb0d(0xe4)](_0x59c8f6);}),config=getConfiguration(),io['to'](_0x93ec7b(0x115))[_0x93ec7b(0x1db)](_0x93ec7b(0x23a),config),broadcastToBots(_0x93ec7b(0x23a),JSON[_0x93ec7b(0x2e3)](config));}function deleteBot(_0x45b7e7){const _0x11b0f4=_0x4ef0d1;getClientsWithBotID(_0x45b7e7)['forEach'](_0x175996=>{getSocket(_0x175996['id'])['disconnect'](!![]),removeClient(_0x175996['id']);}),dbConfig[_0x11b0f4(0x2a1)](_0x11b0f4(0x23a))[_0x11b0f4(0x15c)]({'botID':_0x45b7e7})[_0x11b0f4(0x299)](),logger[_0x11b0f4(0xe4)](_0x11b0f4(0x183)+_0x45b7e7),stopBot(_0x45b7e7);try{if(fs[_0x11b0f4(0xf0)](path['join'](configpath,_0x11b0f4(0x21e)+_0x45b7e7+'-config.json')))fs[_0x11b0f4(0xe6)](path[_0x11b0f4(0x22b)](configpath,_0x11b0f4(0x21e)+_0x45b7e7+_0x11b0f4(0x256)));if(fs[_0x11b0f4(0xf0)](path[_0x11b0f4(0x22b)](configpath,_0x11b0f4(0x21e)+_0x45b7e7+_0x11b0f4(0xe9))))fs[_0x11b0f4(0xe6)](path[_0x11b0f4(0x22b)](configpath,_0x11b0f4(0x21e)+_0x45b7e7+_0x11b0f4(0xe9)));if(fs['existsSync'](path[_0x11b0f4(0x22b)](configpath,_0x11b0f4(0x21e)+_0x45b7e7+_0x11b0f4(0x219))))fs['unlinkSync'](path[_0x11b0f4(0x22b)](configpath,'bot-'+_0x45b7e7+_0x11b0f4(0x219)));if(fs[_0x11b0f4(0xf0)](path[_0x11b0f4(0x22b)](configpath,'bot-'+_0x45b7e7+'-results.json')))fs[_0x11b0f4(0xe6)](path[_0x11b0f4(0x22b)](configpath,_0x11b0f4(0x21e)+_0x45b7e7+_0x11b0f4(0xeb)));}catch(_0x3763b8){if(_0x3763b8)logger[_0x11b0f4(0xe4)](_0x11b0f4(0x1fb),_0x3763b8);}config=getConfiguration(),io['to'](_0x11b0f4(0x115))[_0x11b0f4(0x1db)]('bots',config),broadcastToBots(_0x11b0f4(0x23a),JSON[_0x11b0f4(0x2e3)](config));}function toggleBot(_0x1c4094,_0x54f959,_0x2dabdf){const _0x24be47=_0x4ef0d1;dbConfig[_0x24be47(0x2a1)](_0x24be47(0x23a))[_0x24be47(0x217)]({'botID':_0x1c4094})['assign']({'status':_0x54f959})[_0x24be47(0x279)]({'live':_0x2dabdf})[_0x24be47(0x299)]();if(_0x54f959==_0x24be47(0x22c)||_0x54f959==_0x24be47(0x18b))logger['full'](_0x24be47(0x2af)+_0x1c4094),startBot([_0x1c4094,userID],{'cwd':bbpath},function(_0x126c1c){const _0x29911e=_0x24be47;if(_0x126c1c)logger[_0x29911e(0xe4)](_0x126c1c);});else(_0x54f959==_0x24be47(0x17b)||_0x54f959==_0x24be47(0x1ac))&&(logger[_0x24be47(0xe4)](_0x24be47(0x168)+_0x1c4094),stopBot(_0x1c4094));config=getConfiguration(),io['to'](_0x24be47(0x115))[_0x24be47(0x1db)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function toggleStatus(_0x2f8251){const _0x5de0d3=_0x4ef0d1;let _0x1b5ed6=dbConfig[_0x5de0d3(0x2a1)](_0x5de0d3(0x23a))[_0x5de0d3(0x217)]({'botID':_0x2f8251})[_0x5de0d3(0x2bd)](),_0x12fbae;if(_0x1b5ed6[_0x5de0d3(0x28d)]===_0x5de0d3(0x22c))_0x12fbae=_0x5de0d3(0x17b);else{if(_0x1b5ed6[_0x5de0d3(0x28d)]===_0x5de0d3(0x18b))_0x12fbae=_0x5de0d3(0x1ac);else{if(_0x1b5ed6['status']===_0x5de0d3(0x1ac))_0x12fbae='new';else{if(_0x1b5ed6[_0x5de0d3(0x28d)]==='disabled')_0x12fbae='enabled';}}}return _0x12fbae;}function updateStatus(_0x3d8451,_0x3239ff){const _0x415d93=_0x4ef0d1;dbConfig['get']('bots')['find']({'botID':_0x3d8451})[_0x415d93(0x279)]({'status':_0x3239ff})[_0x415d93(0x299)](),config=getConfiguration(),io['to'](_0x415d93(0x115))[_0x415d93(0x1db)]('bots',config),broadcastToBots('bots',JSON[_0x415d93(0x2e3)](config));}function updateLive(_0x479c7a,_0x3bc9c3){const _0x2afcac=_0x4ef0d1;dbConfig['get'](_0x2afcac(0x23a))[_0x2afcac(0x217)]({'botID':_0x479c7a})[_0x2afcac(0x279)]({'live':_0x3bc9c3})[_0x2afcac(0x299)](),config=getConfiguration(),io['to']('botmanager')[_0x2afcac(0x1db)](_0x2afcac(0x23a),config),broadcastToBots('bots',JSON[_0x2afcac(0x2e3)](config));}function _0x5cae(_0x23acda,_0x2feac2){const _0x7f41b0=_0x3829();return _0x5cae=function(_0x4f0715,_0x2a7805){_0x4f0715=_0x4f0715-0xce;let _0x382964=_0x7f41b0[_0x4f0715];return _0x382964;},_0x5cae(_0x23acda,_0x2feac2);}function updateBotName(_0x1fdb58,_0x3669a6){const _0x41df21=_0x4ef0d1;dbConfig[_0x41df21(0x2a1)](_0x41df21(0x23a))['find']({'botID':_0x1fdb58})['assign']({'botname':_0x3669a6})[_0x41df21(0x299)](),config=getConfiguration(),io['to'](_0x41df21(0x115))[_0x41df21(0x1db)]('bots',config),broadcastToBots('bots',JSON[_0x41df21(0x2e3)](config));}function updateBotManager(){const _0x434dc8=_0x4ef0d1;config=getConfiguration(),io['to'](_0x434dc8(0x115))['emit'](_0x434dc8(0x23a),config),broadcastToBots(_0x434dc8(0x23a),JSON[_0x434dc8(0x2e3)](config));}function toggleBotMode(_0x5853dd){const _0x3a4b94=_0x4ef0d1;if(pid[_0x5853dd])pid[_0x5853dd][_0x3a4b94(0x16b)]({'function':'toggleBotMode','args':null});else{const _0x4131b7=configpath+_0x3a4b94(0x21e)+_0x5853dd+'-config.json',_0x58ea85=fs[_0x3a4b94(0x1eb)](_0x4131b7),_0x18e609=JSON[_0x3a4b94(0x17d)](_0x58ea85),_0x18f3d7=_0x18e609[_0x3a4b94(0x1ef)][0x0][_0x3a4b94(0x27c)];_0x18e609[_0x3a4b94(0x1ef)][0x0][_0x3a4b94(0x27c)]=!_0x18f3d7;const _0x15a216=JSON[_0x3a4b94(0x2e3)](_0x18e609,null,0x2);fs['writeFileSync'](_0x4131b7,_0x15a216),config=getConfiguration(),io['to'](_0x3a4b94(0x115))['emit'](_0x3a4b94(0x23a),config),broadcastToBots('bots',JSON[_0x3a4b94(0x2e3)](config));}}function validateTelegram(_0x37f3ed){const _0x5bfa03=_0x4ef0d1;if(_0x37f3ed[_0x5bfa03(0x181)][_0x5bfa03(0x13f)]!=settings[_0x5bfa03(0x1a5)]&&'@'+_0x37f3ed[_0x5bfa03(0x181)]['username']!=settings[_0x5bfa03(0x1a5)]||_0x37f3ed[_0x5bfa03(0x242)]['id']!=settings[_0x5bfa03(0x28a)])return sendTelegram(_0x37f3ed[_0x5bfa03(0x242)]['id'],_0x5bfa03(0x118),{'parse_mode':_0x5bfa03(0x16f)}),![];return!![];}async function initTelegram(){const _0x446c85=_0x4ef0d1;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x446c85(0x274)]);let _0xc4f060='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0xc4f060+='\x0a',_0xc4f060+=_0x446c85(0x2c8),_0xc4f060+=_0x446c85(0x133),_0xc4f060+=_0x446c85(0x213),_0xc4f060+=_0x446c85(0x230),_0xc4f060+=_0x446c85(0x227),_0xc4f060+=_0x446c85(0x1c1),_0xc4f060+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0xc4f060+=_0x446c85(0x1ca),_0xc4f060+=_0x446c85(0x18d),_0xc4f060+=_0x446c85(0x2cc),_0xc4f060+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0xc4f060+=_0x446c85(0x209),_0xc4f060+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0xc4f060+=_0x446c85(0x294),_0xc4f060+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0xc4f060+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x591576=_0x446c85(0x1fc);_0x591576+='\x0a',_0x591576+=_0xc4f060,tgBot['catch']((_0x1eb67a,_0x224378)=>{const _0x5ec7f0=_0x446c85;logger[_0x5ec7f0(0x2a4)](getTimeStamp()+_0x5ec7f0(0x11b)),logger[_0x5ec7f0(0x1be)](_0x5ec7f0(0x1e4),_0x1eb67a);}),tgBot['use'](async(_0x54640c,_0x4fbd1d)=>{const _0x472305=_0x446c85;if(settings[_0x472305(0x28a)]||_0x54640c[_0x472305(0x1ce)]['message'][_0x472305(0x297)]!=_0x472305(0x14f)){if(!validateTelegram(_0x54640c))return;}_0x4fbd1d();}),tgBot[_0x446c85(0x208)](_0x446c85(0x237),async _0xfac50a=>{const _0x54241a=_0x446c85;if(_0xfac50a[_0x54241a(0x181)]['username']==settings[_0x54241a(0x1a5)]||'@'+_0xfac50a['from'][_0x54241a(0x13f)]==settings['telegramUsername']){if(!settings[_0x54241a(0x28a)])updateSetting(_0x54241a(0x28a),_0xfac50a[_0x54241a(0x242)]['id']);else{if(!validateTelegram(_0xfac50a))return;}}else{if(!validateTelegram(_0xfac50a))return;}updateSetting('telegramEnabled',!![]),await sendTelegram(_0xfac50a[_0x54241a(0x242)]['id'],_0x591576);}),tgBot[_0x446c85(0x208)](_0x446c85(0x2cf),async _0x4c8fca=>{const _0x2a02f7=_0x446c85;updateSetting(_0x2a02f7(0x20f),!![]),await sendTelegram(_0x4c8fca[_0x2a02f7(0x242)]['id'],'Notifications\x20enabled');}),tgBot[_0x446c85(0x208)](_0x446c85(0x2dc),async _0x3efc19=>{const _0x1ba189=_0x446c85;await sendTelegram(_0x3efc19['chat']['id'],_0x1ba189(0x25d)),updateSetting('telegramEnabled',![]);}),tgBot[_0x446c85(0x208)]('config',async _0x475cad=>{const _0x3270f3=_0x446c85,_0x130a09=Markup[_0x3270f3(0x24e)]([Markup['button'][_0x3270f3(0x289)](_0x3270f3(0x268),_0x3270f3(0x2d8)),Markup[_0x3270f3(0x10e)][_0x3270f3(0x289)](_0x3270f3(0x164),_0x3270f3(0x113)),Markup[_0x3270f3(0x10e)]['callback'](_0x3270f3(0xff),_0x3270f3(0x1e9))]);_0x475cad['reply'](_0x3270f3(0x148),_0x130a09);}),tgBot[_0x446c85(0x285)](_0x446c85(0x2d8),async _0x20fb54=>{const _0x3c43e1=_0x446c85;_0x20fb54[_0x3c43e1(0x14c)](),updateSetting(_0x3c43e1(0x27e),_0x3c43e1(0x277)),updateSetting(_0x3c43e1(0x20f),!![]),await sendTelegram(_0x20fb54[_0x3c43e1(0x242)]['id'],_0x3c43e1(0x216));}),tgBot[_0x446c85(0x285)](_0x446c85(0x113),async _0x47fec9=>{const _0x4053bf=_0x446c85;_0x47fec9[_0x4053bf(0x14c)](),updateSetting(_0x4053bf(0x27e),_0x4053bf(0x29b)),updateSetting(_0x4053bf(0x20f),!![]),await sendTelegram(_0x47fec9[_0x4053bf(0x242)]['id'],_0x4053bf(0x23c));}),tgBot[_0x446c85(0x285)](_0x446c85(0x1e9),async _0x1e5b55=>{const _0x5e987f=_0x446c85;_0x1e5b55[_0x5e987f(0x14c)](),updateSetting(_0x5e987f(0x27e),_0x5e987f(0x127)),updateSetting(_0x5e987f(0x20f),!![]),await sendTelegram(_0x1e5b55['chat']['id'],_0x5e987f(0x26a));}),tgBot[_0x446c85(0x208)](_0x446c85(0x28d),async _0x191d8c=>{const _0x43281f=_0x446c85,_0x1d6a0d=getBotsWithMode();let _0x20cc33=_0x43281f(0xd6);config[_0x43281f(0x205)](_0x34479b=>{const _0x171b85=_0x43281f,_0x5d7226=_0x1d6a0d[_0x171b85(0x217)](_0x16022c=>_0x16022c[_0x171b85(0x233)]==_0x34479b[_0x171b85(0x233)])['mode'];_0x20cc33+=_0x171b85(0x1fe)+_0x34479b[_0x171b85(0x233)]+':\x20'+_0x34479b['status']+'\x20|\x20'+_0x5d7226+_0x171b85(0x25a)+_0x34479b[_0x171b85(0x1b6)]+'\x0a';}),_0x20cc33+='\x0a',_0x20cc33+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x20cc33+=!settings[_0x43281f(0x20f)]?_0x43281f(0x190):_0x43281f(0x1c9),_0x20cc33+=settings['telegramEnabled']?settings[_0x43281f(0x27e)]==_0x43281f(0x127)?_0x43281f(0x1a9):_0x43281f(0x121)+settings['telegramEvents']+_0x43281f(0x1fd):'',await sendTelegram(_0x191d8c['chat']['id'],_0x20cc33,{'parse_mode':'HTML'});}),tgBot['command'](_0x446c85(0x258),async _0x1dd9ca=>{const _0x2ba4fc=_0x446c85,_0x4ccda2=getEnabledBots();if(_0x4ccda2[_0x2ba4fc(0x176)]==0x0)await sendTelegram(_0x1dd9ca[_0x2ba4fc(0x242)]['id'],_0x2ba4fc(0x14a));else{if(_0x4ccda2[_0x2ba4fc(0x176)]>0x1)_0x4ccda2['push']({'botID':_0x2ba4fc(0x127)});let _0x34e2b8=[],_0x55ee15=[];const _0x23503b=_0x4ccda2[_0x2ba4fc(0x176)]%0x4==0x0||_0x4ccda2['length']%0x4==0x3||_0x4ccda2['length']%0x3==0x1?0x4:0x3;let _0x60ae5e=0x0;_0x4ccda2['forEach']((_0x4620c8,_0x12189f)=>{const _0xb11fe0=_0x2ba4fc;if(_0x12189f%_0x23503b==0x0)_0x55ee15=[];_0x55ee15['push'](Markup[_0xb11fe0(0x10e)][_0xb11fe0(0x289)](_0x4620c8[_0xb11fe0(0x233)]==_0xb11fe0(0x127)?'All\x20bots':_0xb11fe0(0x1fe)+_0x4620c8[_0xb11fe0(0x233)],'restart_'+_0x4620c8[_0xb11fe0(0x233)])),_0x12189f%_0x23503b==0x0&&(_0x34e2b8[_0x60ae5e]=_0x55ee15,_0x60ae5e++);});const _0x2459a1=Markup[_0x2ba4fc(0x24e)](_0x34e2b8);_0x1dd9ca[_0x2ba4fc(0x14d)](_0x2ba4fc(0x1ab),_0x2459a1);}}),tgBot['action'](/restart_(.+)/,async _0x34640f=>{const _0x2952e4=_0x446c85,_0x3f11e=_0x34640f[_0x2952e4(0x1c2)][0x1];_0x34640f[_0x2952e4(0x14c)](),_0x3f11e==_0x2952e4(0x127)?config[_0x2952e4(0x205)](_0x30e8f7=>{const _0x4c3ac0=_0x2952e4;restartBot(_0x30e8f7[_0x4c3ac0(0x233)]);}):restartBot(_0x3f11e);}),tgBot['command']('on',async _0x4c7b51=>{const _0x5f3e6f=_0x446c85,_0x6efae4=getDisabledBots();if(_0x6efae4[_0x5f3e6f(0x176)]==0x0)await sendTelegram(_0x4c7b51[_0x5f3e6f(0x242)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x6efae4[_0x5f3e6f(0x176)]>0x1)_0x6efae4[_0x5f3e6f(0x1a7)]({'botID':'all'});let _0x1da1f8=[],_0x2d5a52=[];const _0x66cab2=_0x6efae4[_0x5f3e6f(0x176)]%0x4==0x0||_0x6efae4['length']%0x4==0x3||_0x6efae4[_0x5f3e6f(0x176)]%0x3==0x1?0x4:0x3;let _0x2327a9=0x0;_0x6efae4['forEach']((_0x22c514,_0x43b8fb)=>{const _0x75751a=_0x5f3e6f;if(_0x43b8fb%_0x66cab2==0x0)_0x2d5a52=[];_0x2d5a52['push'](Markup[_0x75751a(0x10e)]['callback'](_0x22c514['botID']==_0x75751a(0x127)?_0x75751a(0x212):'Bot\x20'+_0x22c514[_0x75751a(0x233)],_0x75751a(0x111)+_0x22c514[_0x75751a(0x233)])),_0x43b8fb%_0x66cab2==0x0&&(_0x1da1f8[_0x2327a9]=_0x2d5a52,_0x2327a9++);});const _0x37180a=Markup[_0x5f3e6f(0x24e)](_0x1da1f8);_0x4c7b51[_0x5f3e6f(0x14d)](_0x5f3e6f(0xde),_0x37180a);}}),tgBot[_0x446c85(0x285)](/on_(.+)/,async _0x29ebe4=>{const _0x4e5480=_0x446c85,_0x28935c=_0x29ebe4['match'][0x1];_0x29ebe4[_0x4e5480(0x14c)]();if(_0x28935c==_0x4e5480(0x127)){const _0x3af8c5=getDisabledBots();await sendTelegram(_0x29ebe4[_0x4e5480(0x242)]['id'],_0x4e5480(0x271)),_0x3af8c5[_0x4e5480(0x205)](_0x41fe96=>{const _0x5df8d9=_0x4e5480;if(_0x41fe96['botID']!=_0x5df8d9(0x127))toggleBot(_0x41fe96[_0x5df8d9(0x233)],toggleStatus(_0x41fe96[_0x5df8d9(0x233)]),_0x5df8d9(0x291));});}else await sendTelegram(_0x29ebe4[_0x4e5480(0x242)]['id'],_0x4e5480(0x241)+_0x28935c),toggleBot(_0x28935c,toggleStatus(_0x28935c),_0x4e5480(0x291));}),tgBot[_0x446c85(0x208)](_0x446c85(0xcf),async _0x51cc83=>{const _0x440704=_0x446c85,_0x3a0255=getEnabledBots();if(_0x3a0255['length']==0x0)await sendTelegram(_0x51cc83[_0x440704(0x242)]['id'],_0x440704(0x14a));else{if(_0x3a0255[_0x440704(0x176)]>0x1)_0x3a0255[_0x440704(0x1a7)]({'botID':_0x440704(0x127)});let _0x217196=[],_0x1b7032=[];const _0x204ea4=_0x3a0255['length']%0x4==0x0||_0x3a0255[_0x440704(0x176)]%0x4==0x3||_0x3a0255[_0x440704(0x176)]%0x3==0x1?0x4:0x3;let _0x5c0f50=0x0;_0x3a0255[_0x440704(0x205)]((_0x44695a,_0x531da9)=>{const _0x5fca61=_0x440704;if(_0x531da9%_0x204ea4==0x0)_0x1b7032=[];_0x1b7032[_0x5fca61(0x1a7)](Markup['button'][_0x5fca61(0x289)](_0x44695a['botID']==_0x5fca61(0x127)?'All\x20bots':_0x5fca61(0x1fe)+_0x44695a[_0x5fca61(0x233)],_0x5fca61(0x12f)+_0x44695a['botID'])),_0x531da9%_0x204ea4==0x0&&(_0x217196[_0x5c0f50]=_0x1b7032,_0x5c0f50++);});const _0x314e9a=Markup[_0x440704(0x24e)](_0x217196);_0x51cc83[_0x440704(0x14d)](_0x440704(0x139),_0x314e9a);}}),tgBot['action'](/off_(.+)/,async _0x6eaa1c=>{const _0x3674d3=_0x446c85,_0x6b95cb=_0x6eaa1c[_0x3674d3(0x1c2)][0x1];_0x6eaa1c[_0x3674d3(0x14c)]();if(_0x6b95cb==_0x3674d3(0x127)){const _0x5c4e2f=getEnabledBots();await sendTelegram(_0x6eaa1c['chat']['id'],_0x3674d3(0x2ca)),_0x5c4e2f[_0x3674d3(0x205)](_0x1094bf=>{const _0xd42226=_0x3674d3;if(_0x1094bf['botID']!='all')toggleBot(_0x1094bf['botID'],toggleStatus(_0x1094bf[_0xd42226(0x233)]),'stopped');});}else await sendTelegram(_0x6eaa1c['chat']['id'],_0x3674d3(0x260)+_0x6b95cb),toggleBot(_0x6b95cb,toggleStatus(_0x6b95cb),'stopped');}),tgBot['command'](_0x446c85(0x1dd),async _0x11a5c6=>{const _0x3d0b36=_0x446c85,_0x157f1f=getEnabledBots();if(_0x157f1f[_0x3d0b36(0x176)]==0x0)await sendTelegram(_0x11a5c6[_0x3d0b36(0x242)]['id'],_0x3d0b36(0x14a));else{if(_0x157f1f['length']>0x1){let _0x22d1a9=[],_0xcf26cb=[];const _0x1480c5=_0x157f1f[_0x3d0b36(0x176)]%0x4==0x0||_0x157f1f[_0x3d0b36(0x176)]%0x4==0x3||_0x157f1f[_0x3d0b36(0x176)]%0x3==0x1?0x4:0x3;let _0x48daf0=0x0;_0x157f1f[_0x3d0b36(0x205)]((_0x2c59e7,_0x561186)=>{const _0x2e0c9c=_0x3d0b36;if(_0x561186%_0x1480c5==0x0)_0xcf26cb=[];_0xcf26cb[_0x2e0c9c(0x1a7)](Markup[_0x2e0c9c(0x10e)][_0x2e0c9c(0x289)](_0x2e0c9c(0x1fe)+_0x2c59e7['botID'],_0x2e0c9c(0x2d1)+_0x2c59e7['botID'])),_0x561186%_0x1480c5==0x0&&(_0x22d1a9[_0x48daf0]=_0xcf26cb,_0x48daf0++);});const _0x151242=Markup[_0x3d0b36(0x24e)](_0x22d1a9);_0x11a5c6['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x151242);}else{const _0x4aaa45=_0x157f1f[0x0][_0x3d0b36(0x233)];if(pid[_0x4aaa45])pid[_0x4aaa45]['send']({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x446c85(0x285)](/metrics_(.+)/,async _0x37f942=>{const _0x3ecf25=_0x446c85,_0x1874e0=_0x37f942[_0x3ecf25(0x1c2)][0x1];_0x37f942[_0x3ecf25(0x14c)]();if(pid[_0x1874e0])pid[_0x1874e0][_0x3ecf25(0x16b)]({'function':_0x3ecf25(0x24c),'args':null});}),tgBot[_0x446c85(0x208)](_0x446c85(0x1aa),async _0x3de1b3=>{const _0x18ee05=_0x446c85,_0x21e4d6=getEnabledBots();if(_0x21e4d6['length']==0x0)await sendTelegram(_0x3de1b3[_0x18ee05(0x242)]['id'],_0x18ee05(0x14a));else{if(_0x21e4d6[_0x18ee05(0x176)]>0x1){let _0x24c768=[],_0x4f592d=[];const _0x6209d9=_0x21e4d6[_0x18ee05(0x176)]%0x4==0x0||_0x21e4d6[_0x18ee05(0x176)]%0x4==0x3||_0x21e4d6[_0x18ee05(0x176)]%0x3==0x1?0x4:0x3;let _0x3ecd21=0x0;_0x21e4d6[_0x18ee05(0x205)]((_0x5a4685,_0x4ff94c)=>{const _0x37a245=_0x18ee05;if(_0x4ff94c%_0x6209d9==0x0)_0x4f592d=[];_0x4f592d[_0x37a245(0x1a7)](Markup[_0x37a245(0x10e)][_0x37a245(0x289)](_0x37a245(0x1fe)+_0x5a4685[_0x37a245(0x233)],_0x37a245(0x1de)+_0x5a4685[_0x37a245(0x233)])),_0x4ff94c%_0x6209d9==0x0&&(_0x24c768[_0x3ecd21]=_0x4f592d,_0x3ecd21++);});const _0x2ffdb3=Markup[_0x18ee05(0x24e)](_0x24c768);_0x3de1b3[_0x18ee05(0x14d)](_0x18ee05(0x174),_0x2ffdb3);}else{const _0x415c8d=_0x21e4d6[0x0][_0x18ee05(0x233)];if(pid[_0x415c8d])pid[_0x415c8d][_0x18ee05(0x16b)]({'function':_0x18ee05(0x273),'args':null});}}}),tgBot[_0x446c85(0x285)](/portfolio_(.+)/,async _0x507a21=>{const _0x49ea9a=_0x446c85,_0x5574b2=_0x507a21['match'][0x1];_0x507a21[_0x49ea9a(0x14c)]();if(pid[_0x5574b2])pid[_0x5574b2][_0x49ea9a(0x16b)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x446c85(0x208)]('logs',async _0x21990a=>{const _0x498bd9=_0x446c85,_0x21169e=_0x498bd9(0xea);await zipFiles(_0x21169e);const _0xf9f66=zippath+(_0x21169e+'.zip');_0x21990a[_0x498bd9(0x2d3)]({'source':_0xf9f66})[_0x498bd9(0x162)](()=>{})['catch'](_0x5ab92c=>logger[_0x498bd9(0x1be)](_0x498bd9(0x1b4)+_0x21169e+_0x498bd9(0xdd),_0x5ab92c));}),tgBot['command'](_0x446c85(0x1dc),async _0x2272b1=>{const _0x2acb5b=_0x446c85,_0x58b413=_0x2acb5b(0x1dc);await backupConfigFiles(),await zipFiles(_0x58b413);const _0x314bc9=zippath+(_0x58b413+'.zip');_0x2272b1[_0x2acb5b(0x2d3)]({'source':_0x314bc9})['then'](()=>{})[_0x2acb5b(0x195)](_0x5b9f56=>logger[_0x2acb5b(0x1be)]('Error\x20sending\x20'+_0x58b413+_0x2acb5b(0xdd),_0x5b9f56));}),tgBot['command'](_0x446c85(0x1ce),async _0x290d89=>{const _0x1ba445=_0x446c85;await getMessages();if(!updateAvailable)await sendTelegram(_0x290d89[_0x1ba445(0x242)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x290d89['chat']['id'],_0x1ba445(0x1a2));else{const _0x340931=Markup[_0x1ba445(0x24e)]([Markup[_0x1ba445(0x10e)][_0x1ba445(0x289)](_0x1ba445(0x269),_0x1ba445(0x1fa)),Markup[_0x1ba445(0x10e)][_0x1ba445(0x289)]('No',_0x1ba445(0x1d7))]);_0x290d89[_0x1ba445(0x14d)](_0x1ba445(0x235),_0x340931);}}}),tgBot[_0x446c85(0x285)](/update_(.+)/,async _0x130780=>{const _0xc8e857=_0x446c85,_0x49db0d=_0x130780['match'][0x1];_0x130780[_0xc8e857(0x14c)](),_0x49db0d=='yes'&&(await sendTelegram(_0x130780[_0xc8e857(0x242)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0xc8e857(0x1ce))),_0x49db0d=='no'&&await sendTelegram(_0x130780['chat']['id'],_0xc8e857(0x28b));}),tgBot['command'](_0x446c85(0x107),async _0x14ce8e=>{const _0x48d2fa=_0x446c85;if(!validInstallation)await sendTelegram(_0x14ce8e[_0x48d2fa(0x242)]['id'],_0x48d2fa(0xce));else{const _0x36ec15=Markup[_0x48d2fa(0x24e)]([Markup[_0x48d2fa(0x10e)]['callback'](_0x48d2fa(0x269),_0x48d2fa(0x18a)),Markup[_0x48d2fa(0x10e)][_0x48d2fa(0x289)]('No',_0x48d2fa(0x224))]);_0x14ce8e[_0x48d2fa(0x14d)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x36ec15);}}),tgBot[_0x446c85(0x285)](/reinstall_(.+)/,async _0x5181a2=>{const _0x2bdef9=_0x446c85,_0xdd0906=_0x5181a2[_0x2bdef9(0x1c2)][0x1];_0x5181a2[_0x2bdef9(0x14c)](),_0xdd0906==_0x2bdef9(0x1c7)&&(await sendTelegram(_0x5181a2[_0x2bdef9(0x242)]['id'],_0x2bdef9(0x191)),updateBB('reinstall')),_0xdd0906=='no'&&await sendTelegram(_0x5181a2[_0x2bdef9(0x242)]['id'],_0x2bdef9(0x13c));}),tgBot[_0x446c85(0x208)](_0x446c85(0x206),async _0x3eeffd=>{const _0x429c41=_0x446c85,_0x1ba69e=getBotsWithMode();if(_0x1ba69e[_0x429c41(0x176)]==0x0)await sendTelegram(_0x3eeffd[_0x429c41(0x242)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x656d3c=[],_0x1a1525=[];const _0x549353=0x2;let _0x53a0e7=0x0;_0x1ba69e[_0x429c41(0x205)]((_0xafa5d7,_0x2b4545)=>{const _0x403215=_0x429c41;if(_0x2b4545%_0x549353==0x0)_0x1a1525=[];_0x1a1525[_0x403215(0x1a7)](Markup[_0x403215(0x10e)][_0x403215(0x289)](_0x403215(0x1fe)+_0xafa5d7[_0x403215(0x233)]+'\x20('+_0xafa5d7[_0x403215(0x12b)]+')',_0x403215(0xf5)+_0xafa5d7[_0x403215(0x233)])),_0x2b4545%_0x549353==0x0&&(_0x656d3c[_0x53a0e7]=_0x1a1525,_0x53a0e7++);});const _0x120ce2=Markup[_0x429c41(0x24e)](_0x656d3c);_0x3eeffd['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x120ce2);}}),tgBot['action'](/toggle_(.+)/,async _0x12a5d5=>{const _0x36bcf2=_0x446c85,_0x5c789c=_0x12a5d5['match'][0x1];_0x12a5d5['editMessageReplyMarkup']();const _0x2ad25b=getBotsWithMode(),_0x172a0e=_0x2ad25b[_0x36bcf2(0x217)](_0x2bc1db=>_0x2bc1db[_0x36bcf2(0x233)]==_0x5c789c),_0xd89921=_0x172a0e[_0x36bcf2(0x12b)]==_0x36bcf2(0x144)?_0x36bcf2(0x123):'auto';await sendTelegram(_0x12a5d5[_0x36bcf2(0x242)]['id'],_0x36bcf2(0x1d8)+_0x5c789c+_0x36bcf2(0x2a5)+_0xd89921+_0x36bcf2(0x132)),toggleBotMode(_0x5c789c);}),tgBot['command']('names',async _0x3133b3=>{const _0x5c8bfc=_0x446c85;let _0x54df7b='';config[_0x5c8bfc(0x205)](_0x403884=>{const _0xd7a7b6=_0x5c8bfc;_0x54df7b+='Bot\x20'+_0x403884[_0xd7a7b6(0x233)]+':\x20'+_0x403884['botname']+'\x0a';}),await sendTelegram(_0x3133b3[_0x5c8bfc(0x242)]['id'],_0x54df7b,{'parse_mode':_0x5c8bfc(0x16f)});}),tgBot[_0x446c85(0x208)]('help',async _0x59c0cc=>{const _0x3fec5f=_0x446c85;await sendTelegram(_0x59c0cc[_0x3fec5f(0x242)]['id'],_0xc4f060);}),process['once'](_0x446c85(0x243),()=>tgBot['stop'](_0x446c85(0x243))),process[_0x446c85(0x2d4)](_0x446c85(0x1b2),()=>tgBot[_0x446c85(0x155)](_0x446c85(0x1b2))),tgBot[_0x446c85(0x161)]();}function disableTelegram(){const _0x1a4dad=_0x4ef0d1;tgBot&&tgBot[_0x1a4dad(0x155)]();}async function sendTelegram(_0x1ce9cf,_0x4d1342,_0x2d046f){const _0x51cabe=_0x4ef0d1;_0x2d046f={..._0x2d046f,'disable_web_page_preview':!![]};try{await tgBot[_0x51cabe(0x2a6)]['sendMessage'](_0x1ce9cf,_0x4d1342,_0x2d046f);}catch(_0x2bce8a){logger['debug'](_0x51cabe(0x1bf),_0x2bce8a);}}async function sendTelegramBot(_0x132208,_0x38cfab){const _0x38a560=_0x4ef0d1;if(settings[_0x38a560(0x20f)]){if(settings[_0x38a560(0x27e)]==_0x38a560(0x127)||(_0x38cfab[_0x38a560(0x120)]==_0x38a560(0xdc)||_0x38cfab[_0x38a560(0x120)]=='warning'||_0x38cfab[_0x38a560(0x120)]==_0x38a560(0x1c6))&&settings[_0x38a560(0x27e)]==_0x38a560(0x29b)||_0x38cfab[_0x38a560(0x120)]==_0x38a560(0x17c)&&settings[_0x38a560(0x27e)]==_0x38a560(0x277)){if(tgBot&&settings[_0x38a560(0x28a)]){if(_0x38cfab[_0x38a560(0x287)])await sendTelegram(settings[_0x38a560(0x28a)],_0x38cfab[_0x38a560(0x12d)]+_0x38a560(0xfd)+_0x38cfab[_0x38a560(0x156)]);else await sendTelegram(settings['telegramChatId'],_0x38a560(0x1fe)+_0x132208+_0x38a560(0xfd)+_0x38cfab[_0x38a560(0x156)]);}}}}async function sendTelegramMsg(_0xa71654,_0x157f3a=_0x4ef0d1(0x16f)){const _0x56c725=_0x4ef0d1;return settings[_0x56c725(0x20f)]&&tgBot&&settings[_0x56c725(0x28a)]?(await sendTelegram(settings['telegramChatId'],_0xa71654,{'parse_mode':_0x157f3a}),!![]):![];}function getDeviceWithIp(_0x321956){const _0x15f580=_0x4ef0d1;return devices[_0x15f580(0x217)](_0x3c843a=>_0x3c843a['ip']===_0x321956);}async function temporaryAccess2FA(_0x59d6b5,_0x73ac77){const _0x38bfc6=_0x4ef0d1;let _0x584799=new Date(),_0x14f34e=![];if(lastIpApproval){if(_0x584799-lastIpApproval<0x1388)_0x14f34e=!![];}lastIpApproval=new Date();if(_0x14f34e)return;if(tgBot&&settings[_0x38bfc6(0x28a)]){const _0x3ce02e=uuidRandom();tmpStorage[_0x3ce02e]={'uuid':_0x59d6b5,'externalip':_0x73ac77};const _0x5c4fe9=Markup[_0x38bfc6(0x24e)]([Markup[_0x38bfc6(0x10e)][_0x38bfc6(0x289)](_0x38bfc6(0x2a8),_0x38bfc6(0x198)+_0x3ce02e),Markup['button'][_0x38bfc6(0x289)](_0x38bfc6(0x272),'tempaccess_15_'+_0x3ce02e),Markup[_0x38bfc6(0x10e)]['callback']('30\x20min','tempaccess_30_'+_0x3ce02e),Markup['button'][_0x38bfc6(0x289)](_0x38bfc6(0x1a0),_0x38bfc6(0x228)+_0x3ce02e)]);await sendTelegram(settings[_0x38bfc6(0x28a)],_0x38bfc6(0x265)+normalizeIP(_0x73ac77)[_0x38bfc6(0x1e5)]+'\x20?',_0x5c4fe9),tgBot[_0x38bfc6(0x285)](/tempaccess_(.+)_(.+)/,async _0x3e7995=>{const _0x57c876=_0x38bfc6,_0xecebd1=_0x3e7995[_0x57c876(0x1c2)][0x1],_0x4e8d1e=_0x3e7995['match'][0x2],{uuid:_0x1ad73f,externalip:_0x51e5ba}=tmpStorage[_0x4e8d1e];delete tmpStorage[_0x4e8d1e],_0x3e7995[_0x57c876(0x14c)](),devices[_0x1ad73f]['telegramIpApproval']={'clientip':_0x51e5ba,'timestamp':new Date()[_0x57c876(0x2b6)](),'expiry':_0xecebd1},_0xecebd1!='reject'?(await sendTelegram(_0x3e7995['chat']['id'],'Access\x20enabled\x20for\x20'+_0xecebd1+_0x57c876(0x1a1),{'parse_mode':_0x57c876(0x16f)}),io['to'](_0x1ad73f)[_0x57c876(0x1db)](_0x57c876(0x28d),{'access':{'allow':![],'reason':_0x57c876(0x1cd),'token':null}})):(await sendTelegram(_0x3e7995[_0x57c876(0x242)]['id'],_0x57c876(0x238)),io['to'](_0x1ad73f)[_0x57c876(0x1db)](_0x57c876(0x28d),{'access':{'allow':![],'reason':_0x57c876(0x2ab),'token':null}}));});}}async function loginAccess2FA(_0x1337d7,_0x338551){const _0x1ec0a5=_0x4ef0d1;if(tgBot&&settings[_0x1ec0a5(0x28a)]){const _0x462c1b=uuidRandom();tmpStorage[_0x462c1b]={'uuid':_0x1337d7,'externalip':_0x338551};const _0x26d7cf=Markup[_0x1ec0a5(0x24e)]([Markup[_0x1ec0a5(0x10e)][_0x1ec0a5(0x289)]('accept','login2fa_'+loginExpiry+'_'+_0x462c1b),Markup[_0x1ec0a5(0x10e)]['callback']('reject',_0x1ec0a5(0x21f)+_0x462c1b)]);await sendTelegram(settings['telegramChatId'],_0x1ec0a5(0x142)+normalizeIP(_0x338551)[_0x1ec0a5(0x1e5)]+'\x20?',_0x26d7cf),tgBot[_0x1ec0a5(0x285)](/login2fa_(.+)_(.+)/,async _0x984711=>{const _0x5ccbca=_0x1ec0a5,_0x3aa011=_0x984711['match'][0x1],_0x2a4443=_0x984711[_0x5ccbca(0x1c2)][0x2],{uuid:_0x9eaf08,externalip:_0xdae94c}=tmpStorage[_0x2a4443];delete tmpStorage[_0x2a4443],_0x984711['editMessageReplyMarkup'](),devices[_0x9eaf08][_0x5ccbca(0x2cb)]={'clientip':_0xdae94c,'timestamp':new Date()[_0x5ccbca(0x2b6)](),'expiry':_0x3aa011},_0x3aa011!='reject'?(await sendTelegram(_0x984711['chat']['id'],_0x5ccbca(0x1ea),{'parse_mode':'HTML'}),io['to'](_0x9eaf08)['emit'](_0x5ccbca(0x28d),{'access':{'allow':![],'reason':_0x5ccbca(0x1cd),'token':null}})):(await sendTelegram(_0x984711[_0x5ccbca(0x242)]['id'],_0x5ccbca(0x26f)),io['to'](_0x9eaf08)[_0x5ccbca(0x1db)](_0x5ccbca(0x28d),{'access':{'allow':![],'reason':_0x5ccbca(0x1d3),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x731de6=_0x4ef0d1;return dbConfig[_0x731de6(0x2a1)](_0x731de6(0x23a))[_0x731de6(0x1ad)](_0x731de6(0x233))['filter']({'status':_0x731de6(0x22c)})[_0x731de6(0x2bd)]()||[];}function getDisabledBots(){const _0x246832=_0x4ef0d1;return dbConfig['get'](_0x246832(0x23a))[_0x246832(0x1ad)](_0x246832(0x233))[_0x246832(0x11e)]({'status':_0x246832(0x17b)})[_0x246832(0x2bd)]()||[];}function getBotAttributes(_0x5f4ae1){const _0x54db9e=_0x4ef0d1;let _0x297c8d={};const _0xf63bc7=configpath+_0x54db9e(0x21e)+_0x5f4ae1+_0x54db9e(0x256),_0x4b8a14=fs['existsSync'](_0xf63bc7);if(_0x4b8a14){const _0x37833c=fs[_0x54db9e(0x1eb)](_0xf63bc7);try{const _0x1507e1=JSON[_0x54db9e(0x17d)](_0x37833c),_0x26b60f=_0x1507e1?_0x1507e1['bot'][0x0][_0x54db9e(0x27c)]:![];_0x297c8d['mode']=_0x26b60f?_0x54db9e(0x144):_0x54db9e(0x123),_0x297c8d[_0x54db9e(0x12d)]=_0x1507e1?_0x1507e1[_0x54db9e(0x1ef)][0x0][_0x54db9e(0x12d)]:_0x54db9e(0x1fe)+_0x5f4ae1;}catch(_0x2c96fb){_0x297c8d['mode']=_0x54db9e(0x123),_0x297c8d[_0x54db9e(0x12d)]=_0x54db9e(0x1fe)+_0x5f4ae1;}}else _0x297c8d[_0x54db9e(0x12b)]=_0x54db9e(0x123),_0x297c8d[_0x54db9e(0x12d)]=_0x54db9e(0x1fe)+_0x5f4ae1;return _0x297c8d;}function getBotsWithMode(){const _0x46099c=_0x4ef0d1,_0x576a75=dbConfig[_0x46099c(0x2a1)](_0x46099c(0x23a))[_0x46099c(0x1ad)](_0x46099c(0x233))[_0x46099c(0x2bd)]()||[];return _0x576a75['forEach'](_0x34cc30=>{const _0x3948e2=_0x46099c;let _0x54cee0=getBotAttributes(_0x34cc30[_0x3948e2(0x233)]);_0x34cc30[_0x3948e2(0x12b)]=_0x54cee0[_0x3948e2(0x12b)];}),_0x576a75;}function getBotExchanges(){const _0x4f2094=_0x4ef0d1;let _0x1c3236=[];const _0x45babb=dbConfig[_0x4f2094(0x2a1)](_0x4f2094(0x23a))['sortBy']('botID')[_0x4f2094(0x2bd)]()||[];_0x45babb[_0x4f2094(0x205)](_0x4c7c4c=>{const _0x104d90=_0x4f2094;if(_0x4c7c4c[_0x104d90(0x28d)]==_0x104d90(0x22c)){const _0x199b49=configpath+_0x104d90(0x21e)+_0x4c7c4c[_0x104d90(0x233)]+_0x104d90(0x256),_0x523dc1=fs[_0x104d90(0xf0)](_0x199b49);let _0x3c8236;if(_0x523dc1){const _0x36ef5a=fs[_0x104d90(0x1eb)](_0x199b49);try{const _0x3c71cc=JSON[_0x104d90(0x17d)](_0x36ef5a);_0x3c8236=_0x3c71cc?_0x3c71cc['bot'][0x0][_0x104d90(0xfe)]:null;}catch(_0xa2b4e0){}}if(_0x3c8236)_0x1c3236['push'](_0x3c8236);}});const _0xb698ce=[...new Set(_0x1c3236)][_0x4f2094(0x112)]();return _0xb698ce;}async function initUser(){const _0x28a269=_0x4ef0d1;if(!settings[_0x28a269(0x129)]){const _0x23f6f0=uuidRandom();mixpanel[_0x28a269(0x267)](_0x23f6f0),updateSetting(_0x28a269(0x129),_0x23f6f0);}}async function initSecure(){const _0x22c148=_0x4ef0d1;let _0x3e547b=getSecure();if(!_0x3e547b[_0x22c148(0x12a)]('secret')){let _0x17fda0=await generateKeys();_0x3e547b['publicKey']=_0x17fda0[_0x22c148(0x20b)],_0x3e547b['privateKey']=_0x17fda0[_0x22c148(0x125)],_0x3e547b[_0x22c148(0x140)]=crypto[_0x22c148(0x1b5)](0x20)[_0x22c148(0x280)]('hex');;storeSecure(_0x3e547b);}}function getSettings(){const _0x3acc6f=_0x4ef0d1;return dbSettings['get'](_0x3acc6f(0x1d6))[_0x3acc6f(0x2bd)]()||{};}function getSecure(){const _0xe79408=_0x4ef0d1;return dbSecure[_0xe79408(0x2a1)](_0xe79408(0x2b2))[_0xe79408(0x2bd)]()||{};}function getBlacklist(){const _0x2b06d0=_0x4ef0d1;return dbSecure['get'](_0x2b06d0(0x11a))[_0x2b06d0(0x2bd)]()||[];}function broadcastToBots(_0x2a150b,_0x4eb60f){config['forEach'](_0x2546fc=>{const _0x5175c4=_0x5cae;if(_0x2546fc[_0x5175c4(0x28d)]==_0x5175c4(0x22c)&&_0x2546fc[_0x5175c4(0x1b6)]==_0x5175c4(0xfb)||_0x2546fc['status']==_0x5175c4(0x18b)&&_0x2546fc['live']==_0x5175c4(0xfb)){if(pid[_0x2546fc['botID']])pid[_0x2546fc[_0x5175c4(0x233)]]['send']({[_0x2a150b]:_0x4eb60f});}});}async function storeSettings(_0xde71eb,_0x341a22=![]){const _0x4c185a=_0x4ef0d1;_0xde71eb={...settings,..._0xde71eb};if(_0x341a22&&_0xde71eb[_0x4c185a(0x284)]!='************'&&_0xde71eb[_0x4c185a(0x284)]!=_0x4c185a(0x193)&&_0xde71eb[_0x4c185a(0x284)]!=''){const _0xea1df0=decryptRSA(secure[_0x4c185a(0x125)],_0xde71eb[_0x4c185a(0x284)])[_0x4c185a(0x29e)]('|@|')[0x0],_0x4c7c59=bcrypt['hashSync'](_0xea1df0,saltRounds);_0xde71eb={..._0xde71eb,'bbPassword':_0x4c7c59};}if(_0x341a22&&_0xde71eb[_0x4c185a(0x274)]!='************'&&_0xde71eb['telegramToken']!=_0x4c185a(0x193)&&_0xde71eb[_0x4c185a(0x274)]!=''){const _0x422680=decryptRSA(secure[_0x4c185a(0x125)],_0xde71eb[_0x4c185a(0x274)])['split'](_0x4c185a(0x218))[0x0];_0xde71eb={..._0xde71eb,'telegramToken':_0x422680};}if(_0x341a22&&_0xde71eb[_0x4c185a(0x2ce)]!='************'&&_0xde71eb['marketcapApi']!=_0x4c185a(0x193)&&_0xde71eb[_0x4c185a(0x2ce)]!=''){const _0x39f5b7=decryptRSA(secure[_0x4c185a(0x125)],_0xde71eb['marketcapApi'])[_0x4c185a(0x29e)](_0x4c185a(0x218))[0x0];_0xde71eb={..._0xde71eb,'marketcapApi':_0x39f5b7};}const _0x1106b2=_0xde71eb['telegramToken']!=_0x4c185a(0x186)&&_0xde71eb[_0x4c185a(0x274)]!=settings[_0x4c185a(0x274)]||_0xde71eb['telegramUsername']!=settings[_0x4c185a(0x1a5)],_0x119c7c=_0xde71eb[_0x4c185a(0x274)]==''||_0xde71eb[_0x4c185a(0x1a5)]=='',_0x4604c2=_0xde71eb['marketcapApi']&&_0xde71eb[_0x4c185a(0x2ce)]!=_0x4c185a(0x186)&&_0xde71eb[_0x4c185a(0x2ce)]!=settings[_0x4c185a(0x2ce)];_0x1106b2&&(_0xde71eb['telegramChatId']=null,_0xde71eb[_0x4c185a(0x27e)]='all');for(const [_0x4d6c80,_0x373c76]of Object[_0x4c185a(0x255)](_0xde71eb)){if(_0x4d6c80=='telegramToken'&&_0x373c76==_0x4c185a(0x186)){_0xde71eb[_0x4c185a(0x274)]=settings[_0x4c185a(0x274)];continue;};if(_0x4d6c80=='bbPassword'&&_0x373c76==_0x4c185a(0x186)){_0xde71eb[_0x4c185a(0x284)]=settings[_0x4c185a(0x284)];continue;};if(_0x4d6c80==_0x4c185a(0x2ce)&&_0x373c76==_0x4c185a(0x186)){_0xde71eb['marketcapApi']=settings[_0x4c185a(0x2ce)];continue;};dbSettings['set'](_0x4c185a(0x2d6)+_0x4d6c80,_0x373c76)['write']();}settings=_0xde71eb,io['to'](_0x4c185a(0x115))[_0x4c185a(0x1db)](_0x4c185a(0x1d6),cleanSettings()),broadcastToBots('timeshift',settings[_0x4c185a(0x240)]),broadcastToBots(_0x4c185a(0x2b0),settings[_0x4c185a(0x2b0)]),broadcastToBots('marketcapApi',settings['marketcapApi']);if(_0x1106b2&&!_0x119c7c)initTelegram();_0x1106b2&&_0x119c7c&&(updateSetting(_0x4c185a(0x28a),null),disableTelegram()),getAllClients()['forEach'](_0x52d200=>{const _0x1bb322=_0x4c185a;getSocket(_0x52d200['id'])['emit']('status',{'access':{'allow':![],'reason':_0x1bb322(0x1cd),'token':null}});}),_0x4604c2&&(await sleep(0xbb8),testMarketcapApi(_0xde71eb[_0x4c185a(0x2ce)]));}async function testMarketcapApi(_0xb7d918){const _0x2d8dd7=_0x4ef0d1,_0x187581=[_0x2d8dd7(0x1ff),_0x2d8dd7(0xef)];try{await axios[_0x2d8dd7(0x2a1)](_0x2d8dd7(0x1d2),{'headers':{'X-CMC_PRO_API_KEY':_0xb7d918},'params':{'symbol':_0x187581[_0x2d8dd7(0x280)]()}});}catch(_0x2d6413){_0x2d6413[_0x2d8dd7(0x280)]()[_0x2d8dd7(0xec)](_0x2d8dd7(0x249))?(io['to'](_0x2d8dd7(0x115))[_0x2d8dd7(0x1db)](_0x2d8dd7(0x1e2),_0x2d8dd7(0x134)),logger[_0x2d8dd7(0xe4)](_0x2d8dd7(0x134))):(io['to']('botmanager')[_0x2d8dd7(0x1db)](_0x2d8dd7(0x1e2),_0x2d8dd7(0xfa)),logger[_0x2d8dd7(0xe4)](_0x2d8dd7(0xfa)),logger[_0x2d8dd7(0x1be)]('Error\x20details:',_0x2d6413[_0x2d8dd7(0x280)]()+_0x2d8dd7(0x19f)+_0x2d6413[_0x2d8dd7(0x15b)]));return;}logger['debug'](_0x2d8dd7(0x203));}function updateSetting(_0x2ac46f,_0x427284){const _0x5a03b4=_0x4ef0d1;dbSettings[_0x5a03b4(0x1bd)](_0x5a03b4(0x2d6)+_0x2ac46f,_0x427284)[_0x5a03b4(0x299)](),settings=getSettings(),io['to'](_0x5a03b4(0x115))['emit'](_0x5a03b4(0x1d6),cleanSettings());}function storeSecure(_0x576ba1){const _0x123bef=_0x4ef0d1;dbSecure[_0x123bef(0x2a1)]('secure')['push'](_0x576ba1)[_0x123bef(0x299)](),secure=_0x576ba1;}function addBlacklist(_0x16388d){const _0x35ffd1=_0x4ef0d1;cleanBlacklist();let _0x567f3a;devices[_0x16388d][_0x35ffd1(0x160)]?_0x567f3a=Math['max'](devices[_0x16388d][_0x35ffd1(0x160)]['expiry'],loginExpiry):_0x567f3a=loginExpiry,dbSecure[_0x35ffd1(0x2a1)](_0x35ffd1(0x11a))['push']({'expiry':new Date()[_0x35ffd1(0x2b6)]()+_0x567f3a*0x3c*0x3e8,'token':devices[_0x16388d][_0x35ffd1(0x19c)][_0x35ffd1(0x199)]})['write'](),blacklist=dbSecure[_0x35ffd1(0x2a1)](_0x35ffd1(0x11a))[_0x35ffd1(0x2bd)]();}function cleanBlacklist(){const _0x1e7b4e=_0x4ef0d1;let _0x3149ce=dbSecure[_0x1e7b4e(0x2a1)](_0x1e7b4e(0x11a))[_0x1e7b4e(0x236)]()['value'](),_0x339823=new Date()[_0x1e7b4e(0x2b6)]();_0x3149ce[_0x1e7b4e(0x205)](_0x463a03=>{const _0x2f43ac=_0x1e7b4e;_0x463a03[_0x2f43ac(0x1b9)]<_0x339823&&dbSecure[_0x2f43ac(0x2a1)](_0x2f43ac(0x11a))[_0x2f43ac(0x15c)]({'expiry':_0x463a03[_0x2f43ac(0x1b9)]})['write']();});}function initStates(){const _0x556d16=_0x4ef0d1;let _0x83417=getConfiguration();_0x83417[_0x556d16(0x205)](_0x1b116a=>{const _0xe07553=_0x556d16;_0x1b116a[_0xe07553(0x1b6)]=_0xe07553(0x291);}),storeConfiguration(_0x83417);}async function generateKeys(){const _0x395bd0=_0x4ef0d1,_0x10a2ef=forge[_0x395bd0(0x108)][_0x395bd0(0x288)][_0x395bd0(0x1b0)]({'bits':0x1000,'e':0x10001}),_0x378c14=forge[_0x395bd0(0x108)][_0x395bd0(0x2c3)](_0x10a2ef[_0x395bd0(0x125)]),_0x21fb02=forge[_0x395bd0(0x108)]['publicKeyToPem'](_0x10a2ef[_0x395bd0(0x20b)]);return{'privateKey':_0x378c14,'publicKey':_0x21fb02};}async function oneTimeMigration(){const _0x3a57f4=_0x4ef0d1;let _0x1b4227=getSettings(),_0x3fe4ba=![];!_0x1b4227[_0x3a57f4(0x12a)](_0x3a57f4(0x13b))&&(_0x1b4227['lastmsgtelegram']=0x0,_0x3fe4ba=!![]);!_0x1b4227['hasOwnProperty'](_0x3a57f4(0x257))&&(_0x1b4227[_0x3a57f4(0x257)]=0x0,_0x3fe4ba=!![]);!_0x1b4227[_0x3a57f4(0x12a)]('latestversion')&&(_0x1b4227[_0x3a57f4(0xd4)]=_0x3a57f4(0x2dd),_0x3fe4ba=!![]);!_0x1b4227[_0x3a57f4(0x12a)]('onepagemode')&&(_0x1b4227['onepagemode']=![],_0x3fe4ba=!![]);!_0x1b4227[_0x3a57f4(0x12a)](_0x3a57f4(0x2ce))&&(_0x1b4227[_0x3a57f4(0x2ce)]='',_0x3fe4ba=!![]);if(_0x3fe4ba)storeSettings(_0x1b4227);try{fs[_0x3a57f4(0x1f3)](configbackuppath,{'withFileTypes':!![]})[_0x3a57f4(0x205)](_0x26d389=>{const _0x5e21e5=_0x3a57f4;if(!_0x26d389[_0x5e21e5(0x247)]()){if(!_0x26d389[_0x5e21e5(0xf9)][_0x5e21e5(0x175)](_0x5e21e5(0x2a7)))fs['unlinkSync'](configbackuppath+_0x26d389[_0x5e21e5(0xf9)]);}else fs[_0x5e21e5(0x19e)](configbackuppath+_0x26d389[_0x5e21e5(0xf9)],{'recursive':!![]});});}catch(_0x20b532){logger[_0x3a57f4(0x1be)]('Error\x20removing\x20old\x20backup\x20files:',_0x20b532);}}function storeConfiguration(_0x19a31f){const _0x1f2d0a=_0x4ef0d1;dbConfig[_0x1f2d0a(0x2a1)](_0x1f2d0a(0x23a))[_0x1f2d0a(0x15c)]()[_0x1f2d0a(0x299)](),dbConfig['get'](_0x1f2d0a(0x23a))[_0x1f2d0a(0x1a7)](..._0x19a31f)[_0x1f2d0a(0x299)](),config=_0x19a31f;}async function resetPassword(){const _0x10fe91=_0x4ef0d1;if(tgBot&&settings[_0x10fe91(0x28a)]){const _0x25b61a=Markup[_0x10fe91(0x24e)]([Markup[_0x10fe91(0x10e)][_0x10fe91(0x289)]('yes',_0x10fe91(0x138)),Markup['button'][_0x10fe91(0x289)]('no',_0x10fe91(0x1cc))]);await sendTelegram(settings[_0x10fe91(0x28a)],_0x10fe91(0x1a3),_0x25b61a),tgBot['action'](/resetpw_(.+)/,async _0x1375df=>{const _0x3bddf1=_0x10fe91,_0x1e63c3=_0x1375df['match'][0x1];_0x1375df[_0x3bddf1(0x14c)]();if(_0x1e63c3!='no'){const _0x478206=0xf,_0x39b4f9=_0x3bddf1(0x167),_0x527a06=Array[_0x3bddf1(0x181)](crypto[_0x3bddf1(0x122)](new Uint32Array(_0x478206)))[_0x3bddf1(0xd9)](_0xe0aed7=>_0x39b4f9[_0xe0aed7%_0x39b4f9[_0x3bddf1(0x176)]])[_0x3bddf1(0x22b)](''),_0x20a51b=bcrypt[_0x3bddf1(0x1c5)](_0x527a06,saltRounds);storeSettings({'bbPassword':_0x20a51b}),await sendTelegram(_0x1375df[_0x3bddf1(0x242)]['id'],_0x3bddf1(0x102)+_0x527a06,{'parse_mode':_0x3bddf1(0x16f)});}else await sendTelegram(_0x1375df['chat']['id'],_0x3bddf1(0x2ba));});}}async function confirmRestore(_0x225411,_0x9e6252){const _0x48c0fe=_0x4ef0d1;io['to']('botmanager')[_0x48c0fe(0x1db)](_0x48c0fe(0x1e2),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','success');if(tgBot&&settings[_0x48c0fe(0x28a)]){const _0x3c7ead=uuidRandom();tmpStorage[_0x3c7ead]={'path':_0x225411,'filename':_0x9e6252};const _0x1bbb1d=Markup[_0x48c0fe(0x24e)]([Markup[_0x48c0fe(0x10e)][_0x48c0fe(0x289)](_0x48c0fe(0x1c7),'restore_yes_'+_0x3c7ead),Markup['button'][_0x48c0fe(0x289)]('no',_0x48c0fe(0x28f)+_0x3c7ead)]);await sendTelegram(settings[_0x48c0fe(0x28a)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x1bbb1d),tgBot[_0x48c0fe(0x285)](/restore_(.+)_(.+)/,async _0x271b48=>{const _0x28afb2=_0x48c0fe,_0x448001=_0x271b48[_0x28afb2(0x1c2)][0x1],_0x4554c0=_0x271b48[_0x28afb2(0x1c2)][0x2],{path:_0x5c0ec5,filename:_0x11bb27}=tmpStorage[_0x4554c0];delete tmpStorage[_0x4554c0],_0x271b48[_0x28afb2(0x14c)](),_0x448001=='yes'?(logger[_0x28afb2(0x1be)](_0x28afb2(0x10b)),await sendTelegram(_0x271b48[_0x28afb2(0x242)]['id'],_0x28afb2(0xd8),{'parse_mode':_0x28afb2(0x16f)}),unzipFile(_0x5c0ec5,_0x11bb27)):(logger[_0x28afb2(0x1be)](_0x28afb2(0x1c3)),await sendTelegram(_0x271b48['chat']['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x5588fd=_0x4ef0d1,_0x18aeff=new Date();return _0x18aeff[_0x5588fd(0x202)]()+'/'+(_0x18aeff[_0x5588fd(0xfc)]()+0x1)['toString']()[_0x5588fd(0x1df)](0x2,'0')+'/'+_0x18aeff[_0x5588fd(0x2c6)]()[_0x5588fd(0x280)]()[_0x5588fd(0x1df)](0x2,'0')+'\x20'+_0x18aeff[_0x5588fd(0x28e)]()[_0x5588fd(0x280)]()[_0x5588fd(0x1df)](0x2,'0')+':'+_0x18aeff['getMinutes']()[_0x5588fd(0x280)]()['padStart'](0x2,'0')+':'+_0x18aeff['getSeconds']()[_0x5588fd(0x280)]()[_0x5588fd(0x1df)](0x2,'0');}function getTimeStamp(){const _0x464173=_0x4ef0d1,_0x3dee13=shiftedTime();return _0x3dee13[_0x464173(0x202)]()+'/'+(_0x3dee13['getMonth']()+0x1)[_0x464173(0x280)]()[_0x464173(0x1df)](0x2,'0')+'/'+_0x3dee13[_0x464173(0x2c6)]()[_0x464173(0x280)]()[_0x464173(0x1df)](0x2,'0')+'\x20'+_0x3dee13[_0x464173(0x28e)]()[_0x464173(0x280)]()[_0x464173(0x1df)](0x2,'0')+':'+_0x3dee13[_0x464173(0x28c)]()['toString']()[_0x464173(0x1df)](0x2,'0')+':'+_0x3dee13[_0x464173(0x1e8)]()[_0x464173(0x280)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x3950df=_0x4ef0d1,_0x3fc51c=shiftedTime();return _0x3fc51c[_0x3950df(0x202)]()+(_0x3fc51c[_0x3950df(0xfc)]()+0x1)[_0x3950df(0x280)]()[_0x3950df(0x1df)](0x2,'0')+_0x3fc51c[_0x3950df(0x2c6)]()[_0x3950df(0x280)]()[_0x3950df(0x1df)](0x2,'0')+'-'+_0x3fc51c[_0x3950df(0x28e)]()['toString']()[_0x3950df(0x1df)](0x2,'0')+_0x3fc51c['getMinutes']()[_0x3950df(0x280)]()[_0x3950df(0x1df)](0x2,'0')+_0x3fc51c['getSeconds']()[_0x3950df(0x280)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x3785b4=_0x4ef0d1,_0x41b767=new Date();let _0x54d8fc=_0x41b767;if(settings['timeshift']&&settings[_0x3785b4(0x240)]!==0x0)_0x54d8fc=fns[_0x3785b4(0x1f2)](_0x41b767,{'hours':settings[_0x3785b4(0x240)]});return _0x54d8fc;}async function startScheduler(){const _0x5335bf=_0x4ef0d1,_0x1cfc6f=new Date()[_0x5335bf(0x22e)](),_0x9a655c=shiftedTime()['getHours']();_0x9a655c==0x4&&backupConfigFiles(),_0x9a655c==0x0&&(rotateLogFiles(),logger[_0x5335bf(0x1be)](_0x5335bf(0x26d)),logger[_0x5335bf(0x1be)](_0x5335bf(0x1f0)+serverversion+_0x5335bf(0x13e)+(environment=='staging'?_0x5335bf(0xf2):'')),logger['debug'](_0x5335bf(0x26d))),_0x1cfc6f%0x6==0x0&&triggerAnalytics(),_0x1cfc6f%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x4ffc49){const _0x4a89ab=_0x4ef0d1;logger[_0x4a89ab(0x1be)]('Restore\x20backup\x20file\x20'+_0x4ffc49);const _0x234449=getBotsWithMode();_0x234449[_0x4a89ab(0x176)]>0x0?confirmRestore(configbackuppath,_0x4ffc49):unzipFile(configbackuppath,_0x4ffc49);}async function getBackupFiles(_0xe49277=null){const _0x50d3e3=_0x4ef0d1;let _0x1ba56c=[],_0x4e034f=fs[_0x50d3e3(0x1f3)](configbackuppath,{'withFileTypes':!![]});_0x4e034f[_0x50d3e3(0x112)]((_0x2c21e2,_0x2e8f07)=>_0x2c21e2[_0x50d3e3(0xf9)]<_0x2e8f07[_0x50d3e3(0xf9)]?0x1:_0x2e8f07[_0x50d3e3(0xf9)]<_0x2c21e2[_0x50d3e3(0xf9)]?-0x1:0x0),_0x4e034f[_0x50d3e3(0x205)](_0xbd9202=>{const _0x1d11fd=_0x50d3e3;if(!_0xbd9202['isDirectory']()&&_0xbd9202[_0x1d11fd(0xf9)]['startsWith'](_0x1d11fd(0x2a7))&&_0xbd9202[_0x1d11fd(0xf9)][_0x1d11fd(0x10a)](_0x1d11fd(0x214))){const _0x15316f=formatDate(fs[_0x1d11fd(0x254)](configbackuppath+_0xbd9202['name'])[_0x1d11fd(0x1d4)]);_0x1ba56c[_0x1d11fd(0x1a7)]({'name':_0xbd9202[_0x1d11fd(0xf9)],'mtime':_0x15316f});}});if(_0xe49277)io['to'](_0xe49277)['emit'](_0x50d3e3(0x266),_0x1ba56c);else return _0x1ba56c;}async function backupConfigFiles(){const _0x260bf1=_0x4ef0d1;await zipFiles(_0x260bf1(0x171));const _0x231e01=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x260bf1(0x263),configbackuppath+(_0x260bf1(0x2a7)+_0x231e01+_0x260bf1(0x214)));let _0xe5dc3b=fs[_0x260bf1(0x1f3)](configbackuppath,{'withFileTypes':!![]});_0xe5dc3b[_0x260bf1(0x112)]((_0x483baa,_0x4568f8)=>_0x483baa[_0x260bf1(0xf9)]<_0x4568f8[_0x260bf1(0xf9)]?0x1:_0x4568f8['name']<_0x483baa[_0x260bf1(0xf9)]?-0x1:0x0),_0xe5dc3b[_0x260bf1(0x176)]>maxBackups&&fs[_0x260bf1(0xe6)](configbackuppath+_0xe5dc3b[_0xe5dc3b[_0x260bf1(0x176)]-0x1][_0x260bf1(0xf9)]);}function rotateLogFiles(){const _0x435c6f=_0x4ef0d1,_0x154c26=fs['statSync'](logspath+_0x435c6f(0x147)),_0x2ba528=_0x154c26[_0x435c6f(0x26b)]/0x400;if(_0x2ba528>0x64){let _0x188271=fs[_0x435c6f(0x1f3)](logspath,{'withFileTypes':!![]});_0x188271['sort']((_0xe8b8fb,_0x9c3d3d)=>_0xe8b8fb[_0x435c6f(0xf9)]<_0x9c3d3d[_0x435c6f(0xf9)]?0x1:_0x9c3d3d['name']<_0xe8b8fb[_0x435c6f(0xf9)]?-0x1:0x0),_0x188271['forEach'](_0x467890=>{const _0x536a13=_0x435c6f;if(_0x467890[_0x536a13(0xf9)]==_0x536a13(0x114))fs[_0x536a13(0xe2)](logspath+_0x467890['name'],logspath+_0x536a13(0x276));if(_0x467890['name']==_0x536a13(0x251))fs['copyFileSync'](logspath+_0x467890[_0x536a13(0xf9)],logspath+_0x536a13(0x114));_0x467890['name']==_0x536a13(0x147)&&(fs[_0x536a13(0xe2)](logspath+_0x467890[_0x536a13(0xf9)],logspath+'output-001.log'),fs[_0x536a13(0xf8)](logspath+_0x467890[_0x536a13(0xf9)],''));});}}async function zipFiles(_0x2996b3){const _0x7a2439=_0x4ef0d1;let _0x2834f4;if(_0x2996b3==_0x7a2439(0xea))_0x2834f4=logspath;if(_0x2996b3==_0x7a2439(0x1dc))_0x2834f4=configpath;if(_0x2996b3=='backup-full')_0x2834f4=configpath;let _0xc260a9=fs[_0x7a2439(0x1f3)](_0x2834f4,{'withFileTypes':!![]});const _0x293c4e=new JSZip();_0xc260a9[_0x7a2439(0x205)](_0x598052=>{const _0x18683e=_0x7a2439;if(!_0x598052[_0x18683e(0x247)]()){let _0x896377=fs['readFileSync'](_0x2834f4+_0x598052[_0x18683e(0xf9)]);if(_0x2996b3==_0x18683e(0x1dc)){const _0xa2f5b9=/^bot-[0-9]{3}-config.json$/,_0x22a3be=_0xa2f5b9['test'](_0x598052[_0x18683e(0xf9)]);if(_0x22a3be){const _0x8d88ad=JSON['parse'](_0x896377);if(_0x8d88ad[_0x18683e(0x1ef)][0x0]){_0x8d88ad[_0x18683e(0x1ef)][0x0]['apiKey']=_0x18683e(0x193),_0x8d88ad['bot'][0x0][_0x18683e(0x184)]=_0x18683e(0x193);if(_0x8d88ad['bot'][0x0][_0x18683e(0x24f)])_0x8d88ad['bot'][0x0][_0x18683e(0x24f)]=_0x18683e(0x193);}_0x896377=JSON['stringify'](_0x8d88ad,null,0x2);}if(_0x598052['name']==_0x18683e(0x109)){const _0x45d42a=JSON['parse'](_0x896377);if(_0x45d42a['settings'][_0x18683e(0x1f8)])_0x45d42a[_0x18683e(0x1d6)][_0x18683e(0x1f8)]=![];if(_0x45d42a[_0x18683e(0x1d6)][_0x18683e(0x284)])_0x45d42a[_0x18683e(0x1d6)]['bbPassword']=_0x18683e(0x193);if(_0x45d42a['settings'][_0x18683e(0x274)])_0x45d42a['settings'][_0x18683e(0x274)]=_0x18683e(0x193);if(_0x45d42a[_0x18683e(0x1d6)][_0x18683e(0x28a)])_0x45d42a[_0x18683e(0x1d6)][_0x18683e(0x28a)]=null;if(_0x45d42a[_0x18683e(0x1d6)]['marketcapApi'])_0x45d42a[_0x18683e(0x1d6)][_0x18683e(0x2ce)]='***';_0x896377=JSON['stringify'](_0x45d42a,null,0x2);}if(_0x598052[_0x18683e(0xf9)]!=_0x18683e(0x1f6))_0x293c4e[_0x18683e(0x15a)](_0x598052['name'],_0x896377);}else _0x293c4e[_0x18683e(0x15a)](_0x598052[_0x18683e(0xf9)],_0x896377);}});const _0x10f59f=await _0x293c4e[_0x7a2439(0xf3)]({'type':_0x7a2439(0x21b),'base64':![],'compression':_0x7a2439(0x159)});fs['writeFileSync'](zippath+(_0x2996b3+'.zip'),_0x10f59f,_0x7a2439(0x192));}async function unzipFile(_0x4b6400,_0x265257){const _0x91fda0=_0x4ef0d1;fs[_0x91fda0(0x1f3)](configpath,{'withFileTypes':!![]})[_0x91fda0(0x205)](_0x110244=>{const _0x3c1b3e=_0x91fda0;if(!_0x110244['isDirectory']())fs[_0x3c1b3e(0x19e)](configpath+_0x110244[_0x3c1b3e(0xf9)]);});const _0xb3f907=fs[_0x91fda0(0x1eb)](_0x4b6400+_0x265257,_0x91fda0(0x192)),_0x1ea940=await JSZip['loadAsync'](_0xb3f907,{'base64':![],'checkCRC32':!![]});for(const _0x3470a1 of Object[_0x91fda0(0x105)](_0x1ea940[_0x91fda0(0x25e)])){const _0x543cfd=_0x1ea940[_0x91fda0(0x25e)][_0x3470a1],_0x37ffd5=await _0x543cfd['async'](_0x91fda0(0x21b));fs[_0x91fda0(0xf8)](configpath+_0x543cfd['name'],_0x37ffd5);}fs[_0x91fda0(0x1f3)](temppath,{'withFileTypes':!![]})[_0x91fda0(0x205)](_0x112fec=>{if(!_0x112fec['isDirectory']())fs['rmSync'](temppath+_0x112fec['name']);}),logger['debug']('Backup\x20file\x20unzipped\x20and\x20stored'),process['send']({'restore':!![]},_0x38b1df=>{});}async function getPublicIp(){const _0x551cf6=_0x4ef0d1;try{const _0x2f2025=await axios[_0x551cf6(0x2a1)](_0x551cf6(0x231));publicip=_0x2f2025[_0x551cf6(0x1e0)]['ip'];}catch(_0x2e00e6){}}async function triggerAnalytics(){const _0x753f50=_0x4ef0d1;if(!publicip)await getPublicIp();const _0x16d732=getBotsWithMode();let _0x10dcd9=0x0;_0x16d732['forEach'](_0x5d5520=>{const _0x1b2056=_0x5cae;if(_0x5d5520[_0x1b2056(0x28d)]==='enabled')_0x10dcd9++;});const _0x577843=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings[_0x753f50(0x129)],'ip':publicip,'version':serverversion,'numbots':_0x16d732['length'],'numbotsenabled':_0x10dcd9,'exchanges':_0x577843,'environment':environment});}async function getMessages(){const _0x2474a2=_0x4ef0d1,_0x1a648f='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x1f427d=new GraphQLClient(_0x1a648f),_0x38201a={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x5481c1=serverversion[_0x2474a2(0x29e)]('.'),_0x292365=_0x5481c1[0x0]+'.'+_0x5481c1[0x1],_0xc6ec23=Math[_0x2474a2(0x229)](settings['lastmsgtelegram'],settings[_0x2474a2(0x257)]),_0x4a85a8={'last':parseInt(_0xc6ec23),'bbm':_0x292365},_0x3ad61d=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x33a249;try{_0x33a249=await _0x1f427d[_0x2474a2(0x278)](_0x3ad61d,_0x4a85a8,_0x38201a);}catch(_0x447bcc){}if(_0x33a249&&_0x33a249['messages']){let _0x92a037=settings[_0x2474a2(0x13b)],_0x539709=settings['lastmsgtelegram'];newMessages=[];for(const _0x33b875 of _0x33a249['messages']){newMessages['push'](_0x33b875);let _0x1e5699=![];_0x33b875[_0x2474a2(0x246)]&&(updateSetting(_0x2474a2(0xd4),_0x33b875[_0x2474a2(0x246)]),_0x1e5699=isNewerVersion(serverversion,_0x33b875[_0x2474a2(0x246)])||serverversion==_0x33b875[_0x2474a2(0x246)]);if(!_0x1e5699&&_0x33b875[_0x2474a2(0x22f)]>_0x92a037){if(_0x33b875[_0x2474a2(0x2d2)]==='any'||serverversion[_0x2474a2(0x175)](_0x33b875[_0x2474a2(0x2d2)])){let _0x3e668b=''+_0x33b875[_0x2474a2(0x27a)]+'\x0a\x0a'+_0x33b875[_0x2474a2(0x27b)];const _0x30a19a=await sendTelegramMsg(toTelegramMarkdown(_0x3e668b),_0x2474a2(0x2c4));_0x92a037=_0x33b875[_0x2474a2(0x22f)];}}_0x539709=_0x33b875[_0x2474a2(0x22f)];}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x2474a2(0x13b),_0x539709),emitMessages();}}function emitMessages(){const _0x3e3fde=_0x4ef0d1,_0xb8bea4=settings[_0x3e3fde(0x257)];let _0xa87135=[];newMessages[_0x3e3fde(0x205)](_0x26a644=>{const _0x4e9bc3=_0x3e3fde;_0x26a644[_0x4e9bc3(0x22f)]>_0xb8bea4&&_0xa87135[_0x4e9bc3(0x1a7)](_0x26a644);}),_0xa87135[_0x3e3fde(0x176)]>0x0&&getAllClients()['forEach'](_0x310872=>{const _0x5db18d=_0x3e3fde;getSocket(_0x310872['id'])[_0x5db18d(0x1db)](_0x5db18d(0x27b),_0xa87135);});}function confirmMessage(_0x35d412){const _0x9787fd=_0x4ef0d1;updateSetting(_0x9787fd(0x257),Number(_0x35d412));}function isNewerVersion(_0x4ac8fb,_0x3299b7){const _0x144d72=_0x4ef0d1,_0x535be9=_0x3299b7[_0x144d72(0x29e)]('.'),_0x431f7=_0x4ac8fb[_0x144d72(0x29e)]('.');for(var _0x211824=0x0;_0x211824<_0x431f7['length'];_0x211824++){const _0x1b6e7c=~~_0x431f7[_0x211824],_0x5459e0=~~_0x535be9[_0x211824];if(_0x1b6e7c>_0x5459e0)return!![];if(_0x1b6e7c<_0x5459e0)return![];}return![];}function toTelegramMarkdown(_0x449faa){const _0x34d47c=_0x4ef0d1,_0x5af859=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x25d28d=/\*{2}(.+?)\*{2}/gim;return _0x449faa=_0x449faa[_0x34d47c(0x169)](_0x5af859,_0x34d47c(0xe5))['replace'](_0x25d28d,_0x34d47c(0x119)),_0x449faa;}async function validateConfigFile(){const _0x44272b=_0x4ef0d1,_0x494d99=dbConfig['get'](_0x44272b(0x23a))[_0x44272b(0x1ad)](_0x44272b(0x233))[_0x44272b(0x2bd)]()||[];if(_0x494d99[_0x44272b(0x176)]==0x0){let _0x22be0a=0x0,_0x1f5185=[];const _0x4fff9b=/^bot-([0-9]{3})-config.json$/,_0x2f3191=fs[_0x44272b(0x1f3)](configpath);_0x2f3191[_0x44272b(0x205)](_0x1e1fbe=>{const _0x17178c=_0x44272b,_0x6c962f=_0x4fff9b[_0x17178c(0xed)](_0x1e1fbe);if(_0x6c962f){const _0x51781f=_0x6c962f[0x1];let _0x15010f=getBotAttributes(_0x51781f);_0x1f5185['push']({'botID':_0x51781f,'botname':_0x15010f[_0x17178c(0x12d)],'status':'disabled','live':_0x17178c(0x291)}),_0x22be0a++;}}),_0x22be0a!=0x0&&(dbConfig['get'](_0x44272b(0x23a))[_0x44272b(0x279)](_0x1f5185)[_0x44272b(0x299)](),config=_0x1f5185,restoredConfigFile=_0x22be0a);}}async function restoreConfigNotify(_0x56fa4a){const _0x577d75=_0x4ef0d1;let _0x286efb;if(restoredConfigFile==0x1)_0x286efb=_0x577d75(0x262);else _0x286efb=_0x577d75(0x13d);if(_0x56fa4a)io['to'](_0x577d75(0x115))['emit']('notification',_0x286efb);else{logger[_0x577d75(0x2a4)](_0x577d75(0x23d)),logger[_0x577d75(0x2a4)](_0x286efb),logger[_0x577d75(0x2a4)](_0x577d75(0x23d)),logger[_0x577d75(0x2a4)]('');if(tgBot&&settings[_0x577d75(0x28a)]&&settings['telegramEvents']!=_0x577d75(0x277))await sendTelegram(settings[_0x577d75(0x28a)],'Bot\x20Mgr\x20>\x20'+_0x286efb);}}function decryptRSA(_0x1e9a3e,_0x5047e3){const _0x44e419=_0x4ef0d1,_0x3770a2=forge['pki'][_0x44e419(0x180)](_0x1e9a3e),_0xf48eed=_0x3770a2[_0x44e419(0x29c)](forge[_0x44e419(0x101)]['decode64'](_0x5047e3),_0x44e419(0x1c4),{'md':forge['md'][_0x44e419(0x1f1)]['create'](),'mgf1':{'md':forge['md'][_0x44e419(0x1f1)][_0x44e419(0x2ac)]()}});return _0xf48eed;}function validateCredentials(_0x4a576f,_0x512025){const _0x4b4a42=_0x4ef0d1;if(_0x4a576f['username']==settings[_0x4b4a42(0x126)]&&bcrypt[_0x4b4a42(0x131)](_0x4a576f[_0x4b4a42(0x223)],settings[_0x4b4a42(0x284)])){if(settings[_0x4b4a42(0x163)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x28982d=generateLoginToken(_0x512025);return{'allow':!![],'reason':_0x4b4a42(0x197),'token':_0x28982d};}}else return{'allow':![],'reason':_0x4b4a42(0x1b8),'token':null};}function refreshToken(_0x4370d8){const _0x260632=_0x4ef0d1,_0x4fea6c=generateLoginToken(_0x4370d8);return{'allow':!![],'reason':_0x260632(0x197),'token':_0x4fea6c};}function validateAccess(_0x4fce64,_0x38ae04,_0x2fc932){const _0x3d4a62=_0x4ef0d1,_0x3d200a=_0x2fc932?_0x2fc932:devices[_0x38ae04]['ip'];let _0x1b1c13;const _0x15421b=_0x254d5f=>{const _0x1baf28=_0x5cae;if(settings['loginRequired']){if(settings[_0x1baf28(0x163)]){if(telegram2FaApproved(_0x38ae04)){const _0x852e04=generateLoginToken(_0x38ae04);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x852e04};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x1b1c13=validToken(_0x254d5f,_0x38ae04),_0x1b1c13[_0x1baf28(0x12a)](_0x1baf28(0x1c6))?{'allow':!![],'reason':_0x1baf28(0x20e),'token':_0x254d5f}:{'allow':![],'reason':_0x1baf28(0x221),'token':null};}else return{'allow':!![],'reason':_0x1baf28(0xe3),'token':null};};if(settings[_0x3d4a62(0x21c)]){let _0x3e8258=[...settings['whitelist'],_0x3d4a62(0x2b9),_0x3d4a62(0x259),'127.0.0.1'];if(_0x3e8258[_0x3d4a62(0xec)](_0x3d200a))return _0x15421b(_0x4fce64);else{_0x1b1c13=validToken(_0x4fce64,_0x38ae04);if(_0x1b1c13['hasOwnProperty'](_0x3d4a62(0x1c6)))return _0x15421b(_0x4fce64);else{if(telegramIpApproved(_0x38ae04)){const _0x5ad940=generateToken(_0x38ae04);return _0x1b1c13=_0x15421b(_0x4fce64),_0x1b1c13[_0x3d4a62(0x26c)]?{'allow':!![],'reason':_0x3d4a62(0x1b1),'token':_0x5ad940}:_0x1b1c13;}else return settings[_0x3d4a62(0x25b)]?{'allow':![],'reason':_0x3d4a62(0x234),'token':null}:{'allow':![],'reason':_0x3d4a62(0x225),'token':null};}}}else return _0x15421b(_0x4fce64);}function timelyDecrypt(_0x4e1bee,_0x344bc5,_0x5da469='@'){const _0x1b8394=_0x4ef0d1;if(_0x4e1bee)try{const _0x12e02a=decryptRSA(secure[_0x1b8394(0x125)],_0x4e1bee),_0x34a3a9=_0x12e02a[_0x1b8394(0x29e)](_0x5da469)[0x0],_0x275634=_0x12e02a[_0x1b8394(0x29e)](_0x5da469)[0x1],_0x2c052d=new Date()[_0x1b8394(0x2b6)]();if(_0x344bc5){if(_0x2c052d-_0x275634<maxSecretAge*0x3e8)return _0x34a3a9;else return![];}else return _0x34a3a9;}catch(_0x346ce7){return![];}else return![];}const validToken=(_0x13a167,_0x1aba2d)=>{const _0x4c0db1=_0x4ef0d1,_0x2b68a9=devices[_0x1aba2d]['ip'];if(!_0x13a167)return{'error':'No\x20authentication\x20token'};for(let _0x505f36 of blacklist){if(_0x505f36[_0x4c0db1(0x199)]==_0x13a167)return{'error':_0x4c0db1(0xd0)};}let _0x1157ed;try{_0x1157ed=jwt[_0x4c0db1(0x2aa)](_0x13a167,secure[_0x4c0db1(0x140)]+_0x1aba2d);}catch{return{'error':_0x4c0db1(0x239)};}if(!_0x1157ed['hasOwnProperty'](_0x4c0db1(0x248))&&!_0x1157ed[_0x4c0db1(0x12a)](_0x4c0db1(0x13f))||!_0x1157ed[_0x4c0db1(0x12a)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x1157ed[_0x4c0db1(0x12a)](_0x4c0db1(0x13f))&&_0x1157ed[_0x4c0db1(0x12a)](_0x4c0db1(0x248))){const {clientip:_0xf42f52}=_0x1157ed;return _0x2b68a9==_0xf42f52?{'success':_0x4c0db1(0x23f)}:{'error':_0x4c0db1(0x283)};}else{if(_0x1157ed[_0x4c0db1(0x12a)]('username')&&_0x1157ed['hasOwnProperty'](_0x4c0db1(0x248))){const {username:_0x5036c2,clientip:_0x4e6380}=_0x1157ed;return settings['bbUsername']==_0x5036c2&&_0x2b68a9==_0x4e6380?{'success':_0x4c0db1(0x23f)}:{'error':_0x4c0db1(0x2b3)};}}},generateLoginToken=_0x268512=>{const _0x257c7f=_0x4ef0d1;if(_0x268512){const _0x41744e=devices[_0x268512]['ip'];return jwt['sign']({'username':settings['bbUsername'],'clientip':_0x41744e},secure[_0x257c7f(0x140)]+_0x268512,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x5e48ab=>{const _0x2626a3=_0x4ef0d1;if(_0x5e48ab){const _0x4b74e8=devices[_0x5e48ab]['ip'];return jwt[_0x2626a3(0x1d5)]({'clientip':_0x4b74e8},secure[_0x2626a3(0x140)]+_0x5e48ab,{'expiresIn':devices[_0x5e48ab][_0x2626a3(0x160)][_0x2626a3(0x1b9)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x534d81=>{const _0x528f39=_0x4ef0d1;let _0x1637ff=![];return devices[_0x534d81]['telegramIpApproval']&&devices[_0x534d81][_0x528f39(0x160)][_0x528f39(0x1b9)]!=_0x528f39(0x1a0)&&(_0x1637ff=devices[_0x534d81][_0x528f39(0x160)][_0x528f39(0x248)]==devices[_0x534d81]['ip']&&new Date()[_0x528f39(0x2b6)]()-devices[_0x534d81][_0x528f39(0x160)]['timestamp']<devices[_0x534d81]['telegramIpApproval'][_0x528f39(0x1b9)]*0x3c*0x3e8),_0x1637ff;},telegram2FaApproved=_0xe766c0=>{const _0x2cb3f6=_0x4ef0d1;let _0x528039=![];return devices[_0xe766c0][_0x2cb3f6(0x2cb)]&&devices[_0xe766c0][_0x2cb3f6(0x2cb)][_0x2cb3f6(0x1b9)]!='reject'&&(_0x528039=devices[_0xe766c0][_0x2cb3f6(0x2cb)]['clientip']==devices[_0xe766c0]['ip']&&new Date()[_0x2cb3f6(0x2b6)]()-devices[_0xe766c0]['telegram2FaApproval'][_0x2cb3f6(0xee)]<devices[_0xe766c0]['telegram2FaApproval'][_0x2cb3f6(0x1b9)]*0x3c*0x3e8),_0x528039;},normalizeIP=_0x21d508=>{const _0x5d7400=_0x4ef0d1;let _0x382706=null,_0x561fba=null;if(ipaddr[_0x5d7400(0x29a)](_0x21d508)){const _0x260739=ipaddr[_0x5d7400(0x17d)](_0x21d508);_0x260739['kind']()===_0x5d7400(0x1ba)?(_0x260739[_0x5d7400(0x261)]()&&(_0x382706=_0x260739[_0x5d7400(0x10f)]()[_0x5d7400(0x280)]()),_0x561fba=_0x260739['toString']()):(_0x382706=_0x260739[_0x5d7400(0x280)](),_0x561fba=_0x260739[_0x5d7400(0x1d1)]()[_0x5d7400(0x280)]());}return{'show':_0x382706?_0x382706:_0x561fba,'store':_0x561fba};};function formatDate(_0x2eac20){const _0x30a826=_0x4ef0d1;return _0x2eac20[_0x30a826(0x202)]()+'/'+(_0x2eac20[_0x30a826(0xfc)]()+0x1)['toString']()[_0x30a826(0x1df)](0x2,'0')+'/'+_0x2eac20[_0x30a826(0x2c6)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x2eac20['getHours']()['toString']()[_0x30a826(0x1df)](0x2,'0')+':'+_0x2eac20[_0x30a826(0x28c)]()['toString']()[_0x30a826(0x1df)](0x2,'0')+':'+_0x2eac20['getSeconds']()[_0x30a826(0x280)]()[_0x30a826(0x1df)](0x2,'0');}function sleep(_0x377a36){return new Promise(_0x2ca22b=>setTimeout(_0x2ca22b,_0x377a36));}