const _0x237392=_0x3402;(function(_0x2799e7,_0x494424){const _0x3fd4df=_0x3402,_0x4c126e=_0x2799e7();while(!![]){try{const _0x26af87=parseInt(_0x3fd4df(0x1de))/0x1+parseInt(_0x3fd4df(0x2ab))/0x2+-parseInt(_0x3fd4df(0x266))/0x3*(parseInt(_0x3fd4df(0x274))/0x4)+parseInt(_0x3fd4df(0x1c5))/0x5+parseInt(_0x3fd4df(0x273))/0x6+parseInt(_0x3fd4df(0x28e))/0x7+-parseInt(_0x3fd4df(0x219))/0x8*(parseInt(_0x3fd4df(0xee))/0x9);if(_0x26af87===_0x494424)break;else _0x4c126e['push'](_0x4c126e['shift']());}catch(_0xf0b03e){_0x4c126e['push'](_0x4c126e['shift']());}}}(_0x2b21,0xacef2));const _0x4df56d=function(){let _0x246405=!![];return function(_0x2f896a,_0x55f9fa){const _0xbed47d=_0x246405?function(){if(_0x55f9fa){const _0x3c4978=_0x55f9fa['apply'](_0x2f896a,arguments);return _0x55f9fa=null,_0x3c4978;}}:function(){};return _0x246405=![],_0xbed47d;};}(),_0xb49294=_0x4df56d(this,function(){const _0xf410=_0x3402;return _0xb49294[_0xf410(0x1f1)]()[_0xf410(0xe6)](_0xf410(0x29d))[_0xf410(0x1f1)]()[_0xf410(0x1d8)](_0xb49294)[_0xf410(0xe6)](_0xf410(0x29d));});_0xb49294();'use strict';process['env'][_0x237392(0x27e)]=0x1;const childProcess=require(_0x237392(0x182)),fs=require('fs'),fns=require(_0x237392(0x17b)),low=require('lowdb'),FileSync=require(_0x237392(0x203)),path=require('path'),crypto=require(_0x237392(0x208)),forge=require(_0x237392(0xdd)),bcrypt=require('bcryptjs'),jwt=require(_0x237392(0xf5)),ipaddr=require(_0x237392(0x2e0)),yargs=require(_0x237392(0x15f)),uuidRandom=require(_0x237392(0x216)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x237392(0x2ac)),axios=require(_0x237392(0x205)),{GraphQLClient,gql}=require(_0x237392(0x1ab)),util=require('util'),fileUpload=require(_0x237392(0x130)),{networkInterfaces}=require('os'),JSZip=require(_0x237392(0xde)),argv=yargs(process[_0x237392(0x143)]['slice'](0x2))['argv'],PORT=argv[_0x237392(0x289)]||_0x237392(0x198),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x237392(0x213)](_0x237392(0x10f)+PORT+_0x237392(0x167)),process[_0x237392(0x1d1)](0x1));const HOST=argv[_0x237392(0x1cf)]||null,userID=argv[_0x237392(0x122)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process['versions'][_0x237392(0x27f)];let bbpath=_0x237392(0x1f7),bbpath2='';const botfile=_0x237392(0x12d),configfile=_0x237392(0x2a0),settingsfile=_0x237392(0x1e7),securefile=_0x237392(0x2a5),environment=require('./'+bbpath2+_0x237392(0x2bf))[_0x237392(0x171)]||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x237392(0x105)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x237392(0x106)),configpath=userID?bbpath+_0x237392(0x2ea)+userID+'/':bbpath+_0x237392(0x2ea),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x237392(0x19d)+userID+'/':bbpath+_0x237392(0x19d),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x237392(0x1e5),loggerfile=fs[_0x237392(0x1ce)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+'temp/';!fs['existsSync'](configpath)&&fs[_0x237392(0x12e)](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x237392(0x105)](logspath)&&fs[_0x237392(0x12e)](logspath);!fs['existsSync'](zippath)&&fs[_0x237392(0x12e)](zippath);!fs[_0x237392(0x105)](temppath)&&fs[_0x237392(0x12e)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x237392(0x270)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x237392(0x2d8),'onepagemode':![],'marketcapApi':''}})[_0x237392(0x2d5)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x237392(0x270)]({'secure':{},'blacklist':[]})['write']();const saltRounds=0xa,mixpanel=Mixpanel[_0x237392(0x2b2)](_0x237392(0x10a),{'host':_0x237392(0x1fc)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x237392(0x16b)]&&(settings[_0x237392(0x16b)]!=''&&settings[_0x237392(0x16b)]!=_0x237392(0x255))&&settings['telegramUsername']&&settings[_0x237392(0x1ed)]!='')initTelegram();const parseColor=(_0x1aed3e,_0x23c1d6)=>{const _0x1b382d=_0x237392,_0x1cc6bc=/#[A-Z]{3}#/g;if(typeof _0x1aed3e=='string'){!_0x23c1d6?_0x1aed3e=_0x1aed3e[_0x1b382d(0x146)](_0x1cc6bc,''):(_0x1aed3e=_0x1aed3e['replace'](/#BLU#/g,_0x1b382d(0x23e)),_0x1aed3e=_0x1aed3e[_0x1b382d(0x146)](/#RED#/g,_0x1b382d(0x2a3)),_0x1aed3e=_0x1aed3e['replace'](/#YEL#/g,_0x1b382d(0x169)),_0x1aed3e=_0x1aed3e[_0x1b382d(0x146)](/#MAG#/g,_0x1b382d(0x2a8)),_0x1aed3e=_0x1aed3e[_0x1b382d(0x146)](/#CYA#/g,'\x1b[36m'),_0x1aed3e=_0x1aed3e[_0x1b382d(0x146)](/#RES#/g,_0x1b382d(0x294)));;}return _0x1aed3e;},logger={'screen':_0x2293a8=>{const _0x4d21b1=_0x237392;console[_0x4d21b1(0x213)](parseColor(_0x2293a8,!![]));},'simple':_0x314341=>{const _0x2969d7=_0x237392;console[_0x2969d7(0x213)](parseColor(_0x314341,!![])),loggerfile[_0x2969d7(0x2d5)](util[_0x2969d7(0x158)](parseColor(_0x314341,![]))+'\x0a');},'full':async _0x9aefb8=>{const _0x5d5ba3=_0x237392,_0x5ace22=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x9aefb8;console['log'](parseColor(_0x5ace22,!![])),loggerfile[_0x5d5ba3(0x2d5)](util[_0x5d5ba3(0x158)](parseColor(_0x5ace22,![]))+'\x0a');if(tgBot&&settings[_0x5d5ba3(0x109)]&&settings['telegramEvents']!=_0x5d5ba3(0x1b6))await sendTelegram(settings[_0x5d5ba3(0x109)],_0x5d5ba3(0x26e)+parseColor(_0x9aefb8,![]));},'debug':async(_0x2d74ad,_0x8d4625='')=>{const _0x3a9796=_0x237392,_0x8fbc31=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x2d74ad;if(debugging)console['log'](parseColor(_0x8fbc31,!![]));loggerfile[_0x3a9796(0x2d5)](util['format'](parseColor(_0x8fbc31,![]))+'\x0a');if(_0x8d4625){if(debugging)console['log'](_0x8d4625);loggerfile[_0x3a9796(0x2d5)](util['format'](_0x8d4625)+'\x0a');}}};let terminating=![];process['on'](_0x237392(0x1bc),function(_0x2a82cb){const _0x14c3d4=_0x237392;_0x2a82cb['toString']()['includes'](_0x14c3d4(0xd8))?(logger[_0x14c3d4(0x25d)](_0x14c3d4(0x253)+_0x2a82cb['port']+_0x14c3d4(0x186)),process[_0x14c3d4(0x19e)]({'terminate':!![]},_0x239782=>{})):logger[_0x14c3d4(0x25d)](_0x2a82cb);}),process['on'](_0x237392(0x1d1),()=>{const _0x11d1de=_0x237392;stopAllBots(),process[_0x11d1de(0x1d1)](0x0);}),process['on']('SIGTERM',()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x237392(0x1a2),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x237392(0x2bf))[_0x237392(0xe0)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x237392(0x159)),app=express(),http=require(_0x237392(0x13a))[_0x237392(0x19f)](app);app[_0x237392(0x120)](fileUpload({'useTempFiles':!![]})),app[_0x237392(0x2aa)](_0x237392(0x112),async(_0x5bde75,_0x4bcaae)=>{const _0x2ca72a=_0x237392,_0x1044e0=_0x5bde75[_0x2ca72a(0x249)][_0x2ca72a(0xeb)],_0x1b7116=getClientsWithBotID(_0x2ca72a(0x194)),_0x32cdca=_0x5bde75[_0x2ca72a(0x132)]['uuid'],_0x32e763=timelyDecrypt(_0x32cdca,![]),_0x11a3fe=_0x1b7116[_0x2ca72a(0xf1)](_0x3ac4d2=>_0x3ac4d2['uuid']==_0x32e763);if(_0x11a3fe){const _0x28752d=normalizeIP(_0x5bde75[_0x2ca72a(0x1b0)][_0x2ca72a(0x1fa)])['store'],_0x2e332a=_0x5bde75[_0x2ca72a(0x132)][_0x2ca72a(0x209)];if(validateAccess(_0x2e332a,_0x32e763,_0x28752d)[_0x2ca72a(0x230)])_0x1044e0=='backup'&&await backupConfigFiles(),await zipFiles(_0x1044e0),_0x4bcaae[_0x2ca72a(0x121)](zippath+(_0x1044e0+_0x2ca72a(0x1bd)),_0x46115d=>{const _0x48cc29=_0x2ca72a;_0x46115d&&(logger['full'](_0x48cc29(0x177)+_0x1044e0),logger[_0x48cc29(0x25d)](_0x46115d));});else logger[_0x2ca72a(0x154)](_0x2ca72a(0x291)+_0x1044e0+_0x2ca72a(0x2c4));}else logger[_0x2ca72a(0x154)](_0x2ca72a(0x291)+_0x1044e0+_0x2ca72a(0x103));}),app[_0x237392(0x1d6)](_0x237392(0x2ba),async(_0x414571,_0xa8d818)=>{const _0x3d2ed0=_0x237392,_0x58a0d2=getClientsWithBotID(_0x3d2ed0(0x194)),_0x484934=_0x414571['headers'][_0x3d2ed0(0x2d1)],_0x1254d9=timelyDecrypt(_0x484934,![]),_0x17ffbc=_0x58a0d2[_0x3d2ed0(0xf1)](_0x58f6b7=>_0x58f6b7[_0x3d2ed0(0x2d1)]==_0x1254d9);logger[_0x3d2ed0(0x223)](_0x3d2ed0(0x1a1));if(_0x17ffbc){const _0x3de2ce=normalizeIP(_0x414571[_0x3d2ed0(0x1b0)][_0x3d2ed0(0x1fa)])[_0x3d2ed0(0x1b3)],_0x4d5999=_0x414571[_0x3d2ed0(0x132)]['tkn'];if(validateAccess(_0x4d5999,_0x1254d9,_0x3de2ce)[_0x3d2ed0(0x230)]){if(_0x414571['files']){const _0x2e7ce2=_0x414571['files'][_0x3d2ed0(0x2c5)];await _0x2e7ce2['mv'](temppath+_0x2e7ce2['name']),_0xa8d818[_0x3d2ed0(0x19e)]({'status':!![],'message':'File\x20uploaded'});const _0x28ec70=getBotsWithMode();_0x28ec70[_0x3d2ed0(0x21b)]>0x0?confirmRestore(temppath,_0x2e7ce2[_0x3d2ed0(0x1b7)]):unzipFile(temppath,_0x2e7ce2['name']);}}else logger[_0x3d2ed0(0x154)](_0x3d2ed0(0x241));}else logger[_0x3d2ed0(0x154)](_0x3d2ed0(0xd7));}),app[_0x237392(0x120)](express['static'](path[_0x237392(0x14c)](__dirname,bbpath2,_0x237392(0x2c9)))),app[_0x237392(0x120)](express[_0x237392(0x18b)](path[_0x237392(0x14c)](__dirname,bbpath2,_0x237392(0x2c3)))),app['get']('/',function(_0x319d50,_0x4c9ac4){const _0x23406f=_0x237392;_0x4c9ac4['sendFile'](path['join'](__dirname,bbpath2,'build2',_0x23406f(0x125)));}),app['get'](_0x237392(0x1d9),function(_0x572480,_0xbdea0c){const _0x373450=_0x237392;_0xbdea0c[_0x373450(0x162)](path[_0x373450(0x14c)](__dirname,bbpath2,_0x373450(0x2c3),_0x373450(0x125)));}),app[_0x237392(0x2aa)]('/:bot/portfolio',(_0x4dad5e,_0x2622c9)=>{const _0xd55ece=_0x237392;_0x2622c9[_0xd55ece(0x162)](path[_0xd55ece(0x14c)](__dirname,bbpath2,_0xd55ece(0x2c3),'index.html'));}),app[_0x237392(0x2aa)]('/:bot/performance',(_0x4c66d8,_0x2611e0)=>{const _0x2b9a0c=_0x237392;_0x2611e0[_0x2b9a0c(0x162)](path[_0x2b9a0c(0x14c)](__dirname,bbpath2,_0x2b9a0c(0x2c3),_0x2b9a0c(0x125)));}),app[_0x237392(0x2aa)](_0x237392(0xdb),(_0x3df18c,_0x25d0de)=>{const _0x1fda80=_0x237392;_0x25d0de[_0x1fda80(0x162)](path[_0x1fda80(0x14c)](__dirname,bbpath2,'build',_0x1fda80(0x125)));}),app[_0x237392(0x2aa)](_0x237392(0x24b),(_0x187630,_0x15df6c)=>{const _0x498957=_0x237392;_0x15df6c['sendFile'](path['join'](__dirname,bbpath2,_0x498957(0x2c3),'index.html'));}),app[_0x237392(0x2aa)](_0x237392(0x1ac),(_0x174616,_0x2acbb1)=>{const _0x4783a8=_0x237392;_0x2acbb1[_0x4783a8(0x162)](path[_0x4783a8(0x14c)](__dirname,bbpath2,_0x4783a8(0x2c3),_0x4783a8(0x125)));}),app[_0x237392(0x2aa)](_0x237392(0x260),(_0x4a3025,_0x4cba25)=>{const _0x556bf9=_0x237392;_0x4cba25[_0x556bf9(0x162)](path[_0x556bf9(0x14c)](__dirname,bbpath2,_0x556bf9(0x2c3),_0x556bf9(0x125)));});if(HOST)http['listen'](PORT,HOST);else http[_0x237392(0x185)](PORT);const io=require(_0x237392(0x108))(http,{});openBrowser&&(async()=>{const _0x1161c0=_0x237392,{default:_0x218421}=await import(_0x1161c0(0x24a));await _0x218421(_0x1161c0(0x1a6)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1632c3=_0x237392;let _0x171245=_0x1632c3(0x24c);const _0x20c2cf=networkInterfaces(),_0x50ff65={};for(const _0xfdf01e of Object[_0x1632c3(0x1e4)](_0x20c2cf)){for(const _0xb06f3a of _0x20c2cf[_0xfdf01e]){if((_0xb06f3a[_0x1632c3(0x16f)]=='IPv4'||_0xb06f3a[_0x1632c3(0x16f)]==0x4)&&!_0xb06f3a[_0x1632c3(0x13d)]){const _0x3c3d04=ipaddr[_0x1632c3(0x26b)](_0xb06f3a[_0x1632c3(0x243)])[_0x1632c3(0x2b4)]();_0x3c3d04!=_0x1632c3(0x15d)&&(!_0x50ff65[_0xfdf01e]&&(_0x50ff65[_0xfdf01e]=[]),_0x50ff65[_0xfdf01e]['push'](_0xb06f3a['address']),_0x171245=_0xb06f3a[_0x1632c3(0x243)]);}}}return{'serverip':_0x171245,'netinterfaces':_0x50ff65};}async function startServer(){const _0x105939=_0x237392,{serverip:_0x31205d,netinterfaces:_0x340baa}=getServerIP();logger[_0x105939(0x25d)](''),logger['simple'](_0x105939(0x1e2)),await logger[_0x105939(0x154)](_0x105939(0x1f4)+serverversion+_0x105939(0x16d)+(environment=='staging'?_0x105939(0x110):'')+'\x0a'+(_0x105939(0x2cb)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x105939(0x21c)+_0x31205d+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger['simple'](_0x105939(0x1e2));if(config['length']!=0x0)for(const _0x14ce6b of config){const _0x33af6d=_0x14ce6b['mode']=='auto'?'a':'m';if(_0x14ce6b[_0x105939(0x2e7)]==_0x105939(0x20c)||_0x14ce6b[_0x105939(0x2e7)]=='new')await logger['full'](_0x105939(0x1ff)+_0x33af6d+_0x105939(0x142)+_0x14ce6b[_0x105939(0x1aa)]+'\x20|\x20'+_0x14ce6b[_0x105939(0x10b)]),startBot([_0x14ce6b[_0x105939(0x1aa)],userID],{'cwd':bbpath},function(_0x17dd66){if(_0x17dd66)logger['full'](_0x17dd66);});else(_0x14ce6b['status']==_0x105939(0x2bb)||_0x14ce6b['status']=='new-disabled')&&await logger[_0x105939(0x154)](_0x105939(0x168)+_0x33af6d+_0x105939(0x118)+_0x14ce6b[_0x105939(0x1aa)]+_0x105939(0x1f8)+_0x14ce6b[_0x105939(0x10b)]);}else!newBot&&logger[_0x105939(0x25d)](_0x105939(0x19a));if(newBot)addBot();logger[_0x105939(0x25d)](_0x105939(0x1e2)),logger['simple'](''),await logger['debug']('Node.js\x20v'+nodeversion),await logger[_0x105939(0x223)](_0x105939(0x190),_0x340baa);}function startSocket(){io['on']('connection',_0x5d6089=>{const _0x22593d=_0x3402;let _0x1650b3,_0x5e7a1b,_0x242ac0,_0xb4e0ed,_0x1fe123;const _0x1015f9=_0x5d6089['handshake'][_0x22593d(0x132)][_0x22593d(0x25c)];_0x5e7a1b=_0x1015f9['match'](/bot[0-9]{3}/);if(_0x5e7a1b)_0x242ac0=_0x5e7a1b[0x0][_0x22593d(0x139)](/[0-9]{3}/);if(_0x242ac0)_0x1650b3=_0x242ac0[0x0];else _0x1650b3=_0x22593d(0x194);const _0x4239ec=_0x5d6089[_0x22593d(0x232)][_0x22593d(0x13b)]['encryptedUuid'];if(!_0x4239ec)_0x5d6089[_0x22593d(0x101)](_0x22593d(0x2e7),{'publicKey':secure[_0x22593d(0x20e)]});else{_0xb4e0ed=timelyDecrypt(_0x4239ec,![]);if(!_0xb4e0ed)_0x5d6089[_0x22593d(0x101)](_0x22593d(0x2e7),{'publicKey':secure[_0x22593d(0x20e)]});else{_0x1fe123=normalizeIP(_0x5d6089[_0x22593d(0x12f)][_0x22593d(0x1fa)])[_0x22593d(0x1b3)];if(!devices[_0xb4e0ed])devices[_0xb4e0ed]={'uuid':_0xb4e0ed,'access':{'token':null}};devices[_0xb4e0ed]['ip']=_0x1fe123;const _0x2cab88=addClient(_0x5d6089['id'],_0xb4e0ed,_0x1650b3);setAccess(_0x2cab88),emitMessages(),_0x5d6089['on'](_0x22593d(0x280),_0x212861=>{const _0x73c442=_0x22593d,_0x140fdb=timelyDecrypt(_0x212861['password'],!![],_0x73c442(0xe7));if(_0x140fdb){_0x212861={'username':_0x212861[_0x73c442(0x2cf)],'password':_0x140fdb},devices[_0xb4e0ed]['access']=validateCredentials(_0x212861,_0xb4e0ed);if(devices[_0xb4e0ed][_0x73c442(0x111)][_0x73c442(0x230)]==![]&&devices[_0xb4e0ed][_0x73c442(0x111)][_0x73c442(0x28d)]==_0x73c442(0x235))_0x5d6089[_0x73c442(0x101)]('status',{'access':devices[_0xb4e0ed][_0x73c442(0x111)]}),loginAccess2FA(_0xb4e0ed,_0x1fe123);else{if(devices[_0xb4e0ed]['access']['allow']==![]&&devices[_0xb4e0ed][_0x73c442(0x111)]['reason']==_0x73c442(0x1f3))_0x5d6089[_0x73c442(0x101)](_0x73c442(0x2e7),{'access':devices[_0xb4e0ed][_0x73c442(0x111)]});else devices[_0xb4e0ed]['access'][_0x73c442(0x230)]&&devices[_0xb4e0ed][_0x73c442(0x111)]['reason']=='login\x20token\x20generated'&&(getClientsWithUuid(_0xb4e0ed)['forEach'](_0x3dc38d=>{setAccess(_0x3dc38d);}),logger['debug']('Logged\x20in\x20user\x20...'+_0xb4e0ed['slice'](-0x8)),setTokenRefresh(_0xb4e0ed),setSessionTimeout(_0x73c442(0x280),_0xb4e0ed));}}else logger['full']('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x5d6089['on'](_0x22593d(0x27a),()=>{resetPassword();}),_0x5d6089['on'](_0x22593d(0x282),_0x481b9e=>{removeClient(_0x5d6089['id']);}),_0x1650b3=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x42ba73){const _0x3cb734=_0x237392;if(_0x42ba73!=_0x3cb734(0x194)&&config[_0x3cb734(0x1d2)]!=''){if(pid[_0x42ba73])pid[_0x42ba73][_0x3cb734(0x19e)]({'function':_0x3cb734(0x288),'args':null});}_0x42ba73!='botmanager'&&broadcastToBots('bots',JSON[_0x3cb734(0x2e6)](config));}function _0x3402(_0x285303,_0x16e67d){const _0x1528f6=_0x2b21();return _0x3402=function(_0xb49294,_0x4df56d){_0xb49294=_0xb49294-0xcf;let _0x2b2156=_0x1528f6[_0xb49294];return _0x2b2156;},_0x3402(_0x285303,_0x16e67d);}function reloadBotManager(){const _0x5bbcf2=_0x237392;getClientsWithBotID(_0x5bbcf2(0x194))[_0x5bbcf2(0xf0)](_0x51d46f=>{const _0x14643e=_0x5bbcf2;getSocket(_0x51d46f['id'])[_0x14643e(0x101)]('status',{'access':{'allow':![],'reason':_0x14643e(0x28c),'token':null}});});}function getSocket(_0x348df3){const _0x4c839a=_0x237392,_0x2d33a4=io[_0x4c839a(0x2de)]['get']('/');return _0x2d33a4[_0x4c839a(0x1ca)][_0x4c839a(0x2aa)](_0x348df3);}function setAccess(_0x5b23f1){const _0x14d932=_0x237392,_0x31fb79=getSocket(_0x5b23f1['id']),_0x3fc58a=_0x5b23f1[_0x14d932(0x2d1)],_0x23a73d=_0x5b23f1[_0x14d932(0x124)];devices[_0x3fc58a][_0x14d932(0x111)]=validateAccess(devices[_0x3fc58a][_0x14d932(0x111)][_0x14d932(0x247)],_0x3fc58a),logger[_0x14d932(0x223)](_0x14d932(0x26c)+devices[_0x3fc58a][_0x14d932(0x111)][_0x14d932(0x28d)]+'\x20|\x20client:\x20...'+_0x5b23f1['id'][_0x14d932(0x1fd)](-0x8)+_0x14d932(0x1c4)+_0x3fc58a[_0x14d932(0x1fd)](-0x8)),_0x31fb79[_0x14d932(0x14c)](_0x3fc58a);if(devices[_0x3fc58a][_0x14d932(0x111)][_0x14d932(0x230)]){_0x31fb79[_0x14d932(0x14c)](_0x23a73d);if(_0x23a73d==_0x14d932(0x194))initializeSocketBotManager(_0x31fb79);else initializeSocketBot(_0x31fb79);initClient(_0x23a73d);}devices[_0x3fc58a][_0x14d932(0x111)][_0x14d932(0x247)]&&devices[_0x3fc58a][_0x14d932(0x111)][_0x14d932(0x28d)]==_0x14d932(0x1d7)&&setSessionTimeout('2FA',_0x3fc58a),devices[_0x3fc58a][_0x14d932(0x111)][_0x14d932(0x247)]&&devices[_0x3fc58a][_0x14d932(0x111)][_0x14d932(0x28d)]==_0x14d932(0x1b9)&&setSessionTimeout(_0x14d932(0x280),_0x3fc58a),_0x31fb79[_0x14d932(0x101)](_0x14d932(0x2e7),{'status':_0x5b23f1[_0x14d932(0xfa)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3fc58a]['access'],'externalip':devices[_0x3fc58a]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x14d932(0x1a0)],'validInstallation':validInstallation}),devices[_0x3fc58a][_0x14d932(0x111)][_0x14d932(0x230)]==![]&&devices[_0x3fc58a][_0x14d932(0x111)]['reason']==_0x14d932(0x261)&&temporaryAccess2FA(_0x3fc58a,devices[_0x3fc58a]['ip']);}function setSessionTimeout(_0xee29ba,_0x516766){const _0x53669f=_0x237392;let _0x57e982;if(_0xee29ba==_0x53669f(0x280))_0x57e982=loginExpiry*0x3c*0x3e8;else _0x57e982=devices[_0x516766][_0x53669f(0x1cd)][_0x53669f(0xf9)]*0x3c*0x3e8-(new Date()[_0x53669f(0x16a)]()-devices[_0x516766]['telegramIpApproval'][_0x53669f(0x19c)]);if(devices[_0x516766][_0x53669f(0x2df)])clearTimeout(devices[_0x516766]['pidExpireLogin']);devices[_0x516766][_0x53669f(0x2df)]=setTimeout(()=>{const _0x1a0f49=_0x53669f;if(devices[_0x516766][_0x1a0f49(0x277)])clearTimeout(devices[_0x516766][_0x1a0f49(0x277)]);removeSocketListeners(_0x516766),addBlacklist(_0x516766),devices[_0x516766][_0x1a0f49(0x1cd)]=null,devices[_0x516766][_0x1a0f49(0x12c)]=null,devices[_0x516766]['access']['token']=null,logger[_0x1a0f49(0x223)](_0x1a0f49(0x137)+_0x516766[_0x1a0f49(0x1fd)](-0x8)),devices[_0x516766][_0x1a0f49(0x111)]=validateAccess(devices[_0x516766]['access']['token'],_0x516766),!(devices[_0x516766][_0x1a0f49(0x111)][_0x1a0f49(0x230)]&&devices[_0x516766][_0x1a0f49(0x111)][_0x1a0f49(0x28d)]==_0x1a0f49(0x153))&&(_0xee29ba==_0x1a0f49(0x280)?io['to'](_0x516766)[_0x1a0f49(0x101)](_0x1a0f49(0x2e7),{'access':{'allow':![],'reason':_0x1a0f49(0x2b3),'token':null}}):io['to'](_0x516766)['emit'](_0x1a0f49(0x2e7),{'access':{'allow':![],'reason':_0x1a0f49(0xfe),'token':null}})),devices[_0x516766]['access'][_0x1a0f49(0x247)]=null;},_0x57e982);}function setTokenRefresh(_0x38906d){const _0x48136c=_0x237392;if(devices[_0x38906d][_0x48136c(0x277)])clearTimeout(devices[_0x38906d][_0x48136c(0x277)]);devices[_0x38906d]['pidRefreshToken']=setTimeout(()=>{const _0x2f6a9f=_0x48136c;getClientsWithUuid(_0x38906d)[_0x2f6a9f(0x21b)]!=0x0?(devices[_0x38906d][_0x2f6a9f(0x111)]=refreshToken(_0x38906d),io['to'](_0x38906d)[_0x2f6a9f(0x101)](_0x2f6a9f(0x2e7),{'status':_0x2f6a9f(0x214),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x38906d]['access'],'externalip':devices[_0x38906d]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x38906d)):clearTimeout(devices[_0x38906d][_0x2f6a9f(0x277)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x15bffe){const _0x221bc3=_0x237392,_0x257199=getClient(_0x15bffe['id'])['uuid'];_0x15bffe[_0x221bc3(0x101)](_0x221bc3(0x2d3),config),_0x15bffe[_0x221bc3(0x101)](_0x221bc3(0x1ec),cleanSettings()),_0x15bffe['on'](_0x221bc3(0x15e),_0x55c3bf=>{const _0x594757=_0x221bc3;if(validateAccess(_0x55c3bf,_0x257199)['allow'])addBot();else logger['full'](_0x594757(0x100));}),_0x15bffe['on'](_0x221bc3(0x141),(_0x2290bb,_0x9a439a)=>{const _0x4534da=_0x221bc3;if(validateAccess(_0x9a439a,_0x257199)[_0x4534da(0x230)])toggleBot(_0x2290bb['botID'],_0x2290bb[_0x4534da(0x2e7)],_0x2290bb[_0x4534da(0xd5)]);else logger[_0x4534da(0x154)](_0x4534da(0x13c));}),_0x15bffe['on']('toggle-bot-mode',(_0x2043a9,_0x21a323)=>{const _0x4a0a12=_0x221bc3;if(validateAccess(_0x21a323,_0x257199)[_0x4a0a12(0x230)])toggleBotMode(_0x2043a9);else logger[_0x4a0a12(0x154)](_0x4a0a12(0x13c));}),_0x15bffe['on'](_0x221bc3(0x2bc),(_0x24e68e,_0x49d4ba)=>{const _0x596228=_0x221bc3;if(validateAccess(_0x49d4ba,_0x257199)['allow'])deleteBot(_0x24e68e);else logger[_0x596228(0x154)](_0x596228(0x2eb));}),_0x15bffe['on'](_0x221bc3(0x26f),(_0xb4c9bc,_0x520186)=>{const _0x55b74e=_0x221bc3;if(validateAccess(_0x520186,_0x257199)[_0x55b74e(0x230)])storeSettings(_0xb4c9bc,!![]);else logger[_0x55b74e(0x154)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x15bffe['on'](_0x221bc3(0x150),_0x15854=>{const _0x44655f=_0x221bc3;if(validateAccess(_0x15854,_0x257199)[_0x44655f(0x230)])updateBB(_0x44655f(0x1e0));else logger[_0x44655f(0x154)](_0x44655f(0x1ea));}),_0x15bffe['on'](_0x221bc3(0x29b),_0xa59707=>{const _0x38ea2a=_0x221bc3;if(validateAccess(_0xa59707,_0x257199)[_0x38ea2a(0x230)])updateBB(_0x38ea2a(0x231));else logger[_0x38ea2a(0x154)](_0x38ea2a(0x21f));}),_0x15bffe['on'](_0x221bc3(0x25a),_0x57acd0=>{const _0xdf2d8e=_0x221bc3;if(validateAccess(_0x57acd0,_0x257199)[_0xdf2d8e(0x230)]){const _0x38a016=getClient(_0x15bffe['id']);if(_0x38a016)getBackupFiles(_0x38a016[_0xdf2d8e(0x2d1)]);else logger['full'](_0xdf2d8e(0x233));}else logger['full'](_0xdf2d8e(0x123));}),_0x15bffe['on'](_0x221bc3(0xd2),(_0x3a7472,_0xcdffdc)=>{const _0x1c3f78=_0x221bc3;if(validateAccess(_0xcdffdc,_0x257199)[_0x1c3f78(0x230)])restoreBackupFile(_0x3a7472);else logger[_0x1c3f78(0x154)](_0x1c3f78(0x2d2));}),_0x15bffe['on'](_0x221bc3(0x222),_0x362861=>{const _0x56b41a=_0x221bc3;if(validateAccess(_0x362861,_0x257199)['allow'])getMessages();else logger['full'](_0x56b41a(0x1a4));}),_0x15bffe['on'](_0x221bc3(0x13f),(_0x1d73cf,_0x35d6fa)=>{const _0x325947=_0x221bc3;if(validateAccess(_0x35d6fa,_0x257199)[_0x325947(0x230)])confirmMessage(_0x1d73cf);else logger['full'](_0x325947(0x263));}),_0x15bffe['on']('logout',_0x4fa6f7=>{const _0x306755=_0x221bc3;if(validateAccess(_0x4fa6f7,_0x257199)[_0x306755(0x230)]){if(devices[_0x257199][_0x306755(0x277)])clearTimeout(devices[_0x257199][_0x306755(0x277)]);if(devices[_0x257199][_0x306755(0x2df)])clearTimeout(devices[_0x257199][_0x306755(0x2df)]);removeSocketListeners(getClient(_0x15bffe['id'])[_0x306755(0x2d1)]),addBlacklist(_0x257199),devices[_0x257199][_0x306755(0x1cd)]=null,devices[_0x257199]['telegram2FaApproval']=null,devices[_0x257199][_0x306755(0x111)][_0x306755(0x247)]=null,logger['debug'](_0x306755(0x149)+_0x257199['slice'](-0x8)),io['to'](getClient(_0x15bffe['id'])[_0x306755(0x2d1)])[_0x306755(0x101)](_0x306755(0x2e7),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x306755(0x1f0));});}function initializeSocketBot(_0x41dd2f){const _0x2272c1=_0x237392,_0xa906a=getClient(_0x41dd2f['id'])[_0x2272c1(0x124)],_0x3ea91a=getClient(_0x41dd2f['id'])[_0x2272c1(0x2d1)];_0x41dd2f['on'](_0x2272c1(0x156),(_0x2cce99,_0x94375)=>{const _0x976b58=_0x2272c1;if(validateAccess(_0x94375,_0x3ea91a)[_0x976b58(0x230)]){if(pid[_0xa906a])pid[_0xa906a][_0x976b58(0x19e)]({'function':_0x976b58(0x20a),'args':_0x2cce99});}else logger[_0x976b58(0x154)](_0x976b58(0x21e));}),_0x41dd2f['on'](_0x2272c1(0x1d4),(_0x437d85,_0x480cca)=>{const _0x4cd43c=_0x2272c1;if(validateAccess(_0x480cca,_0x3ea91a)[_0x4cd43c(0x230)]){if(pid[_0xa906a])pid[_0xa906a]['send']({'function':_0x4cd43c(0x2ad),'args':_0x437d85});}else logger[_0x4cd43c(0x154)](_0x4cd43c(0x147));}),_0x41dd2f['on'](_0x2272c1(0x1cc),(_0x2f1741,_0x4f065b)=>{const _0x139349=_0x2272c1;if(validateAccess(_0x4f065b,_0x3ea91a)[_0x139349(0x230)]){if(pid[_0xa906a])pid[_0xa906a][_0x139349(0x19e)]({'function':'getPortfolio','args':_0x2f1741});}else logger[_0x139349(0x154)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x41dd2f['on'](_0x2272c1(0x15c),(_0x346d72,_0x1bafc2)=>{const _0x42c8e5=_0x2272c1;if(validateAccess(_0x1bafc2,_0x3ea91a)['allow']){if(pid[_0xa906a])pid[_0xa906a][_0x42c8e5(0x19e)]({'function':_0x42c8e5(0x1ae),'args':_0x346d72});}else logger[_0x42c8e5(0x154)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x41dd2f['on']('store-headless',(_0x33898d,_0x58bdd9)=>{const _0x4be94d=_0x2272c1;if(validateAccess(_0x58bdd9,_0x3ea91a)[_0x4be94d(0x230)]){if(pid[_0xa906a])pid[_0xa906a][_0x4be94d(0x19e)]({'function':_0x4be94d(0x1c7),'args':_0x33898d});}else logger[_0x4be94d(0x154)](_0x4be94d(0x1dc));}),_0x41dd2f['on'](_0x2272c1(0x170),(_0x153bde,_0x3e5401)=>{const _0x20296a=_0x2272c1;if(validateAccess(_0x3e5401,_0x3ea91a)['allow']){if(pid[_0xa906a])pid[_0xa906a][_0x20296a(0x19e)]({'function':_0x20296a(0xe2),'args':_0x153bde});}else logger[_0x20296a(0x154)](_0x20296a(0x2e2));}),_0x41dd2f['on'](_0x2272c1(0x17e),_0x32ef73=>{const _0x49033d=_0x2272c1;if(validateAccess(_0x32ef73,_0x3ea91a)['allow']){if(pid[_0xa906a])pid[_0xa906a][_0x49033d(0x19e)]({'function':'resetHistory','args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x41dd2f['on'](_0x2272c1(0x1c9),_0x44ec63=>{const _0x2259e4=_0x2272c1;if(validateAccess(_0x44ec63,_0x3ea91a)[_0x2259e4(0x230)]){if(pid[_0xa906a])pid[_0xa906a][_0x2259e4(0x19e)]({'function':_0x2259e4(0x1fe),'args':null});}else logger[_0x2259e4(0x154)](_0x2259e4(0x2a7));}),_0x41dd2f['on']('place-order',(_0x5b3344,_0xc11a3a)=>{const _0x2caafa=_0x2272c1;if(validateAccess(_0xc11a3a,_0x3ea91a)[_0x2caafa(0x230)]){if(pid[_0xa906a])pid[_0xa906a][_0x2caafa(0x19e)]({'function':_0x2caafa(0x2cd),'args':_0x5b3344});}else logger[_0x2caafa(0x154)](_0x2caafa(0x269));}),_0x41dd2f['on']('cancel-loading',_0x8b8fc0=>{const _0xe2050e=_0x2272c1;if(validateAccess(_0x8b8fc0,_0x3ea91a)[_0xe2050e(0x230)]){if(pid[_0xa906a])pid[_0xa906a]['send']({'function':'cancelLoading','args':null});}else logger[_0xe2050e(0x154)](_0xe2050e(0x2c8));}),_0x41dd2f['on'](_0x2272c1(0x2b0),_0x2740b2=>{const _0x3c6bba=_0x2272c1;if(validateAccess(_0x2740b2,_0x3ea91a)[_0x3c6bba(0x230)]){if(pid[_0xa906a])pid[_0xa906a][_0x3c6bba(0x19e)]({'function':_0x3c6bba(0x248),'args':null});}else logger[_0x3c6bba(0x154)](_0x3c6bba(0x135));}),_0x41dd2f['on']('update-bb',_0x1c538c=>{const _0x1a79d4=_0x2272c1;if(validateAccess(_0x1c538c,_0x3ea91a)[_0x1a79d4(0x230)])updateBB('update');else logger[_0x1a79d4(0x154)](_0x1a79d4(0x1ea));}),_0x41dd2f['on'](_0x2272c1(0x222),_0x5643d5=>{const _0x2068e2=_0x2272c1;if(validateAccess(_0x5643d5,_0x3ea91a)[_0x2068e2(0x230)])getMessages();else logger['full'](_0x2068e2(0x1a4));}),_0x41dd2f['on'](_0x2272c1(0x13f),(_0x39a4cc,_0x1bddb5)=>{const _0x89127=_0x2272c1;if(validateAccess(_0x1bddb5,_0x3ea91a)[_0x89127(0x230)])confirmMessage(_0x39a4cc);else logger['full'](_0x89127(0x263));}),_0x41dd2f['on'](_0x2272c1(0x246),_0x4eaf85=>{const _0x412794=_0x2272c1;if(validateAccess(_0x4eaf85,_0x3ea91a)[_0x412794(0x230)]){if(devices[_0x3ea91a][_0x412794(0x277)])clearTimeout(devices[_0x3ea91a]['pidRefreshToken']);if(devices[_0x3ea91a][_0x412794(0x2df)])clearTimeout(devices[_0x3ea91a][_0x412794(0x2df)]);removeSocketListeners(getClient(_0x41dd2f['id'])[_0x412794(0x2d1)]),addBlacklist(_0x3ea91a),devices[_0x3ea91a][_0x412794(0x1cd)]=null,devices[_0x3ea91a][_0x412794(0x12c)]=null,devices[_0x3ea91a][_0x412794(0x111)]['token']=null,logger[_0x412794(0x223)](_0x412794(0x149)+_0x3ea91a[_0x412794(0x1fd)](-0x8)),io['to'](getClient(_0x41dd2f['id'])[_0x412794(0x2d1)])['emit'](_0x412794(0x2e7),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x412794(0x154)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x5e5ff1){const _0x3b6183=_0x237392;getClientsWithUuid(_0x5e5ff1)[_0x3b6183(0xf0)](_0x27d1fd=>{const _0x480f27=_0x3b6183;getSocket(_0x27d1fd['id'])[_0x480f27(0x286)]();});}function cleanSettings(){const _0x344d28=_0x237392;let _0x22a5ac=settings;return settings[_0x344d28(0x16b)]&&settings[_0x344d28(0x16b)]!=''&&(_0x22a5ac={..._0x22a5ac,'telegramToken':_0x344d28(0x217)}),settings[_0x344d28(0xf3)]&&settings[_0x344d28(0xf3)]!=''&&(_0x22a5ac={..._0x22a5ac,'bbPassword':'************'}),settings['marketcapApi']&&settings[_0x344d28(0x242)]!=''&&(_0x22a5ac={..._0x22a5ac,'marketcapApi':'************'}),(settings[_0x344d28(0xf3)]&&settings[_0x344d28(0xf3)]==_0x344d28(0x255)||settings[_0x344d28(0x16b)]&&settings[_0x344d28(0x16b)]==_0x344d28(0x255)||settings[_0x344d28(0x242)]&&settings['marketcapApi']==_0x344d28(0x255))&&(_0x22a5ac={..._0x22a5ac,'restored':{'password':settings[_0x344d28(0xf3)]==_0x344d28(0x255),'telegram':settings['telegramToken']==_0x344d28(0x255),'marketcap':settings[_0x344d28(0x242)]==_0x344d28(0x255)}}),_0x22a5ac;}async function updateBB(_0x3ddc4){const _0xa8d65e=_0x237392;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0xf6e9fb=>{const _0x4b9a89=_0x3402;restartBot(_0xf6e9fb[_0x4b9a89(0x1aa)]);});if(_0x3ddc4==_0xa8d65e(0x1e0))process['send']({'update':!![],'environment':environment},_0x512579=>{});else _0x3ddc4==_0xa8d65e(0x231)&&process['send']({'reinstall':!![],'environment':environment},_0x3e3522=>{});}function startBot(_0x2ca705,_0x2aa1e7,_0x1e891f){const _0xbc99b5=_0x237392;if(debugging)_0x2ca705[_0xbc99b5(0x278)]('-d');if(recreate)_0x2ca705[_0xbc99b5(0x278)]('-r');let _0x3972c3=![];const _0xa2e0a9=_0x2ca705[0x0];_0x2aa1e7={..._0x2aa1e7,'stdio':[_0xbc99b5(0x1cb),_0xbc99b5(0x1cb),'inherit',_0xbc99b5(0x201)]},pid[_0xa2e0a9]=childProcess[_0xbc99b5(0x22b)](botfile,_0x2ca705,_0x2aa1e7),pid[_0xa2e0a9]['on']('message',_0x5207ac=>{const _0x376469=_0xbc99b5;switch(Object[_0x376469(0x1e4)](_0x5207ac)[0x0]){case'botname':updateBotName(_0xa2e0a9,_0x5207ac[_0x376469(0x10b)]);break;case'updatebotmanager':updateBotManager();break;case _0x376469(0x2e7):updateStatus(_0xa2e0a9,_0x5207ac[_0x376469(0x2e7)]);break;case _0x376469(0xd5):updateLive(_0xa2e0a9,_0x5207ac[_0x376469(0xd5)]);break;case'started':updateLive(_0xa2e0a9,_0x5207ac[_0x376469(0x2d6)]),io['to'](_0xa2e0a9)[_0x376469(0x101)](_0x376469(0x2e7),{'access':{'allow':![],'reason':_0x376469(0x28c),'token':null}});break;case _0x376469(0x265):_0x5207ac[_0x376469(0x265)]==_0x376469(0x1e9)&&restartBot(_0xa2e0a9);_0x5207ac['stop']==_0x376469(0x200)&&toggleBot(_0xa2e0a9,_0x376469(0x2bb),_0x376469(0x296));break;case _0x376469(0x151):sendTelegramBot(_0xa2e0a9,_0x5207ac[_0x376469(0x151)]);break;case'telegrammsg':sendTelegramMsg(_0x5207ac['telegrammsg']);break;case _0x376469(0x2cc):io['to'](_0xa2e0a9)[_0x376469(0x101)](_0x5207ac[_0x376469(0x2cc)],_0x5207ac['args']);break;}}),pid[_0xa2e0a9]['on'](_0xbc99b5(0x134),function(_0x1589ee){if(_0x3972c3)return;_0x3972c3=!![],_0x1e891f(_0x1589ee);}),pid[_0xa2e0a9]['on'](_0xbc99b5(0x1d1),async function(_0x22c985){const _0x1aaa7d=_0xbc99b5;if(terminating)return;if(installingUpdate){io[_0x1aaa7d(0x18d)]();return;}if(_0x3972c3)return;_0x3972c3=!![],_0x1e891f(null);const _0x137fd5=dbConfig[_0x1aaa7d(0x2aa)]('bots')[_0x1aaa7d(0xf1)]({'botID':_0xa2e0a9})[_0x1aaa7d(0xfc)]();_0x137fd5&&(_0x137fd5[_0x1aaa7d(0x2e7)]==_0x1aaa7d(0x20c)||_0x137fd5[_0x1aaa7d(0x2e7)]==_0x1aaa7d(0x21a))&&(await sleep(0x3e8),updateLive(_0xa2e0a9,'stopped'),logger[_0x1aaa7d(0x154)]('Restarting\x20'+botRef(_0xa2e0a9)),startBot([_0xa2e0a9,userID],{'cwd':bbpath},function(_0x20df6a){const _0x907e27=_0x1aaa7d;if(_0x20df6a)logger[_0x907e27(0x154)](_0x20df6a);}));});}function stopBot(_0x155741){const _0x21ffb7=_0x237392;getClientsWithBotID(_0x155741)[_0x21ffb7(0xf0)](_0x5f28aa=>{const _0x1cbe1a=_0x21ffb7;getSocket(_0x5f28aa['id'])[_0x1cbe1a(0x282)](!![]),removeClient(_0x5f28aa['id']);}),pid[_0x155741]&&(pid[_0x155741]['kill'](),pid[_0x155741]=null);}function stopAllBots(){terminating=!![];const _0x461e4a=getEnabledBots();_0x461e4a['forEach'](_0x43b4c3=>{const _0x40fd60=_0x3402;stopBot(_0x43b4c3[_0x40fd60(0x1aa)]);});}function restartBot(_0x286d14){const _0x300244=_0x237392;if(pid[_0x286d14])pid[_0x286d14][_0x300244(0x200)]();}function addBot(){const _0x2452b7=_0x237392;let _0x59aca9;for(let _0x385091=0x1;_0x385091<0x3e9;_0x385091++){_0x59aca9=_0x385091[_0x2452b7(0x1f1)]()['padStart'](0x3,'0');let _0x5eeda3=config[_0x2452b7(0xf1)](_0x5790f7=>_0x5790f7['botID']==_0x59aca9);if(!_0x5eeda3)break;}if(_0x59aca9===_0x2452b7(0x133)){logger[_0x2452b7(0x154)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x2452b7(0x154)](_0x2452b7(0x127)+_0x59aca9),dbConfig[_0x2452b7(0x2aa)](_0x2452b7(0x2d3))[_0x2452b7(0x278)]({'botID':_0x59aca9,'botname':_0x2452b7(0x14d)+_0x59aca9,'status':_0x2452b7(0x21a),'live':''})[_0x2452b7(0x2d5)](),startBot([_0x59aca9,userID],{'cwd':bbpath},function(_0x1162fe){if(_0x1162fe)logger['full'](_0x1162fe);}),config=getConfiguration(),io['to'](_0x2452b7(0x194))[_0x2452b7(0x101)]('bots',config),broadcastToBots(_0x2452b7(0x2d3),JSON['stringify'](config));}function deleteBot(_0x133269){const _0x17a366=_0x237392;getClientsWithBotID(_0x133269)[_0x17a366(0xf0)](_0x26aec2=>{const _0x136026=_0x17a366;getSocket(_0x26aec2['id'])[_0x136026(0x282)](!![]),removeClient(_0x26aec2['id']);}),dbConfig[_0x17a366(0x2aa)](_0x17a366(0x2d3))[_0x17a366(0x191)]({'botID':_0x133269})[_0x17a366(0x2d5)](),logger[_0x17a366(0x154)](_0x17a366(0x2b5)+_0x133269),stopBot(_0x133269);try{if(fs[_0x17a366(0x105)](path['join'](configpath,_0x17a366(0x225)+_0x133269+_0x17a366(0x2a2))))fs['unlinkSync'](path[_0x17a366(0x14c)](configpath,'bot-'+_0x133269+_0x17a366(0x2a2)));if(fs['existsSync'](path[_0x17a366(0x14c)](configpath,'bot-'+_0x133269+_0x17a366(0x299))))fs[_0x17a366(0x1ad)](path['join'](configpath,_0x17a366(0x225)+_0x133269+_0x17a366(0x299)));if(fs[_0x17a366(0x105)](path[_0x17a366(0x14c)](configpath,_0x17a366(0x225)+_0x133269+'-performance.json')))fs['unlinkSync'](path['join'](configpath,_0x17a366(0x225)+_0x133269+_0x17a366(0x239)));if(fs[_0x17a366(0x105)](path[_0x17a366(0x14c)](configpath,_0x17a366(0x225)+_0x133269+_0x17a366(0x10d))))fs['unlinkSync'](path[_0x17a366(0x14c)](configpath,_0x17a366(0x225)+_0x133269+'-results.json'));}catch(_0x4f9a9f){if(_0x4f9a9f)logger[_0x17a366(0x154)](_0x17a366(0xd1),_0x4f9a9f);}config=getConfiguration(),io['to'](_0x17a366(0x194))[_0x17a366(0x101)]('bots',config),broadcastToBots(_0x17a366(0x2d3),JSON[_0x17a366(0x2e6)](config));}function toggleBot(_0xdc5d61,_0x1fb1de,_0x7766fb){const _0x82a3f8=_0x237392;dbConfig[_0x82a3f8(0x2aa)](_0x82a3f8(0x2d3))[_0x82a3f8(0xf1)]({'botID':_0xdc5d61})['assign']({'status':_0x1fb1de})[_0x82a3f8(0x14f)]({'live':_0x7766fb})['write']();const _0x5be512=botRef(_0xdc5d61);if(_0x1fb1de==_0x82a3f8(0x20c)||_0x1fb1de==_0x82a3f8(0x21a))logger['full'](_0x82a3f8(0x13e)+_0x5be512),startBot([_0xdc5d61,userID],{'cwd':bbpath},function(_0x3e4275){if(_0x3e4275)logger['full'](_0x3e4275);});else(_0x1fb1de==_0x82a3f8(0x2bb)||_0x1fb1de==_0x82a3f8(0x1c1))&&(logger['full']('Disabled\x20'+_0x5be512),stopBot(_0xdc5d61));config=getConfiguration(),io['to'](_0x82a3f8(0x194))[_0x82a3f8(0x101)](_0x82a3f8(0x2d3),config),broadcastToBots('bots',JSON[_0x82a3f8(0x2e6)](config));}function toggleStatus(_0x36943d){const _0x594f67=_0x237392;let _0x99a52e=dbConfig[_0x594f67(0x2aa)](_0x594f67(0x2d3))[_0x594f67(0xf1)]({'botID':_0x36943d})[_0x594f67(0xfc)](),_0x1f52d7;if(_0x99a52e['status']===_0x594f67(0x20c))_0x1f52d7=_0x594f67(0x2bb);else{if(_0x99a52e['status']===_0x594f67(0x21a))_0x1f52d7=_0x594f67(0x1c1);else{if(_0x99a52e[_0x594f67(0x2e7)]===_0x594f67(0x1c1))_0x1f52d7='new';else{if(_0x99a52e[_0x594f67(0x2e7)]===_0x594f67(0x2bb))_0x1f52d7=_0x594f67(0x20c);}}}return _0x1f52d7;}function updateStatus(_0xb3280a,_0x35ea17){const _0x5850e3=_0x237392;dbConfig[_0x5850e3(0x2aa)](_0x5850e3(0x2d3))['find']({'botID':_0xb3280a})['assign']({'status':_0x35ea17})[_0x5850e3(0x2d5)](),config=getConfiguration(),io['to'](_0x5850e3(0x194))[_0x5850e3(0x101)]('bots',config),broadcastToBots(_0x5850e3(0x2d3),JSON[_0x5850e3(0x2e6)](config));}function updateLive(_0x41cbd7,_0x2d1e84){const _0x511735=_0x237392;dbConfig[_0x511735(0x2aa)](_0x511735(0x2d3))[_0x511735(0xf1)]({'botID':_0x41cbd7})['assign']({'live':_0x2d1e84})[_0x511735(0x2d5)](),config=getConfiguration(),io['to'](_0x511735(0x194))[_0x511735(0x101)](_0x511735(0x2d3),config),broadcastToBots(_0x511735(0x2d3),JSON[_0x511735(0x2e6)](config));}function updateBotName(_0x215c3e,_0x385e02){const _0x3ff7ce=_0x237392;dbConfig[_0x3ff7ce(0x2aa)]('bots')[_0x3ff7ce(0xf1)]({'botID':_0x215c3e})[_0x3ff7ce(0x14f)]({'botname':_0x385e02})[_0x3ff7ce(0x2d5)](),config=getConfiguration(),io['to'](_0x3ff7ce(0x194))[_0x3ff7ce(0x101)](_0x3ff7ce(0x2d3),config),broadcastToBots(_0x3ff7ce(0x2d3),JSON[_0x3ff7ce(0x2e6)](config));}function updateBotManager(){const _0xcc314d=_0x237392;config=getConfiguration(),io['to']('botmanager')[_0xcc314d(0x101)](_0xcc314d(0x2d3),config),broadcastToBots(_0xcc314d(0x2d3),JSON['stringify'](config));}function toggleBotMode(_0x42a358){const _0xb9c752=_0x237392;if(pid[_0x42a358])pid[_0x42a358][_0xb9c752(0x19e)]({'function':_0xb9c752(0x23f),'args':null});else{const _0x11fe04=configpath+_0xb9c752(0x225)+_0x42a358+_0xb9c752(0x2a2),_0x3a900b=fs[_0xb9c752(0x18c)](_0x11fe04),_0x121e85=JSON[_0xb9c752(0x26b)](_0x3a900b),_0x306865=_0x121e85[_0xb9c752(0x124)][0x0][_0xb9c752(0x196)];_0x121e85['bot'][0x0]['headless']=!_0x306865;const _0x225443=JSON[_0xb9c752(0x2e6)](_0x121e85,null,0x2);fs[_0xb9c752(0x16c)](_0x11fe04,_0x225443),config=getConfiguration(),io['to'](_0xb9c752(0x194))['emit'](_0xb9c752(0x2d3),config),broadcastToBots(_0xb9c752(0x2d3),JSON[_0xb9c752(0x2e6)](config));}}function validateTelegram(_0x13287f){const _0x380cc9=_0x237392;if(_0x13287f[_0x380cc9(0xcf)]['username']!=settings[_0x380cc9(0x1ed)]&&'@'+_0x13287f[_0x380cc9(0xcf)][_0x380cc9(0x2cf)]!=settings[_0x380cc9(0x1ed)]||_0x13287f[_0x380cc9(0x119)]['id']!=settings[_0x380cc9(0x109)])return sendTelegram(_0x13287f[_0x380cc9(0x119)]['id'],_0x380cc9(0x2a9),{'parse_mode':'HTML'}),![];return!![];}function botRef(_0x43367f){const _0x2c4433=_0x237392,_0x410604=getBotAttributes(_0x43367f),_0x4f8ea8=_0x410604[_0x2c4433(0x1d3)]?_0x410604[_0x2c4433(0x10b)]:'Bot\x20'+_0x43367f;return _0x4f8ea8;}async function initTelegram(){const _0x2f74ff=_0x237392;tgBot&&(await tgBot[_0x2f74ff(0x265)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x2f74ff(0x16b)]);let _0x44fbfc='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x44fbfc+='\x0a',_0x44fbfc+='/enable\x20-\x20enable\x20notifications\x0a',_0x44fbfc+=_0x2f74ff(0x1d0),_0x44fbfc+=_0x2f74ff(0x1c8),_0x44fbfc+=_0x2f74ff(0x2c1),_0x44fbfc+=_0x2f74ff(0x104),_0x44fbfc+=_0x2f74ff(0x192),_0x44fbfc+=_0x2f74ff(0x10e),_0x44fbfc+='/names\x20-\x20show\x20bot\x20names\x0a',_0x44fbfc+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x44fbfc+=_0x2f74ff(0x17a),_0x44fbfc+=_0x2f74ff(0x1e1),_0x44fbfc+='/logs\x20-\x20receive\x20log\x20files\x0a',_0x44fbfc+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0x44fbfc+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x44fbfc+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x44fbfc+=_0x2f74ff(0x18f);let _0x4a1a0d=_0x2f74ff(0x221);_0x4a1a0d+='\x0a',_0x4a1a0d+=_0x44fbfc,tgBot[_0x2f74ff(0x11a)]((_0x4ac3d0,_0x5ec789)=>{const _0x235e94=_0x2f74ff;logger[_0x235e94(0x25d)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x235e94(0x223)](_0x235e94(0x17f),_0x4ac3d0);}),tgBot['use'](async(_0x40a4cb,_0x5183fd)=>{const _0x1ef9f5=_0x2f74ff;if(settings['telegramChatId']||_0x40a4cb[_0x1ef9f5(0x1e0)][_0x1ef9f5(0x117)]['text']!=_0x1ef9f5(0x275)){if(!validateTelegram(_0x40a4cb))return;}_0x5183fd();}),tgBot[_0x2f74ff(0x195)](_0x2f74ff(0x1c0),async _0x3ee6ad=>{const _0xfb06ba=_0x2f74ff;if(_0x3ee6ad[_0xfb06ba(0xcf)][_0xfb06ba(0x2cf)]==settings[_0xfb06ba(0x1ed)]||'@'+_0x3ee6ad[_0xfb06ba(0xcf)][_0xfb06ba(0x2cf)]==settings['telegramUsername']){if(!settings[_0xfb06ba(0x109)])updateSetting(_0xfb06ba(0x109),_0x3ee6ad[_0xfb06ba(0x119)]['id']);else{if(!validateTelegram(_0x3ee6ad))return;}}else{if(!validateTelegram(_0x3ee6ad))return;}updateSetting(_0xfb06ba(0x1e6),!![]),await sendTelegram(_0x3ee6ad['chat']['id'],_0x4a1a0d);}),tgBot['command'](_0x2f74ff(0x128),async _0x49118c=>{const _0x2a100f=_0x2f74ff;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x49118c['chat']['id'],_0x2a100f(0x138));}),tgBot[_0x2f74ff(0x195)](_0x2f74ff(0x10c),async _0x170f0d=>{const _0x392302=_0x2f74ff;await sendTelegram(_0x170f0d[_0x392302(0x119)]['id'],_0x392302(0x140)),updateSetting(_0x392302(0x1e6),![]);}),tgBot[_0x2f74ff(0x195)](_0x2f74ff(0x2a6),async _0x5c8e29=>{const _0x15334a=_0x2f74ff,_0x313b9b=Markup[_0x15334a(0x287)]([Markup[_0x15334a(0x136)][_0x15334a(0x19b)](_0x15334a(0x267),_0x15334a(0x178)),Markup['button'][_0x15334a(0x19b)](_0x15334a(0x22a),_0x15334a(0x176)),Markup[_0x15334a(0x136)][_0x15334a(0x19b)](_0x15334a(0xdc),'config_all')]);_0x5c8e29[_0x15334a(0x262)](_0x15334a(0x22e),_0x313b9b);}),tgBot['action'](_0x2f74ff(0x178),async _0x43037c=>{const _0x57a883=_0x2f74ff;_0x43037c[_0x57a883(0x1a8)](),updateSetting(_0x57a883(0x202),_0x57a883(0x1b6)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x43037c['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot['action'](_0x2f74ff(0x176),async _0x26db65=>{const _0x469822=_0x2f74ff;_0x26db65[_0x469822(0x1a8)](),updateSetting(_0x469822(0x202),_0x469822(0x2dc)),updateSetting(_0x469822(0x1e6),!![]),await sendTelegram(_0x26db65[_0x469822(0x119)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot['action'](_0x2f74ff(0xe9),async _0x1f9446=>{const _0x41ad5c=_0x2f74ff;_0x1f9446['editMessageReplyMarkup'](),updateSetting(_0x41ad5c(0x202),'all'),updateSetting(_0x41ad5c(0x1e6),!![]),await sendTelegram(_0x1f9446[_0x41ad5c(0x119)]['id'],_0x41ad5c(0x1c3));}),tgBot[_0x2f74ff(0x195)](_0x2f74ff(0x2e7),async _0x154597=>{const _0x15f097=_0x2f74ff,_0xa3f9c4=getBotsWithMode();let _0x320fb2='<b>Balance\x20Bot\x20Status:</b>\x0a';config['forEach'](_0x1c0dff=>{const _0x188659=_0x3402,_0x29aca1=_0xa3f9c4[_0x188659(0xf1)](_0x1b3013=>_0x1b3013[_0x188659(0x1aa)]==_0x1c0dff[_0x188659(0x1aa)])[_0x188659(0xef)];_0x320fb2+=_0x188659(0x14d)+_0x1c0dff[_0x188659(0x1aa)]+':\x20'+_0x1c0dff['status']+_0x188659(0x1f8)+_0x29aca1+'\x20|\x20'+_0x1c0dff[_0x188659(0xd5)]+'\x0a';}),_0x320fb2+='\x0a',_0x320fb2+=_0x15f097(0x257),_0x320fb2+=!settings['telegramEnabled']?'Notifications\x20disabled\x0a':_0x15f097(0x28a),_0x320fb2+=settings[_0x15f097(0x1e6)]?settings[_0x15f097(0x202)]=='all'?_0x15f097(0xf6):_0x15f097(0x240)+settings[_0x15f097(0x202)]+_0x15f097(0x2e9):'',await sendTelegram(_0x154597['chat']['id'],_0x320fb2,{'parse_mode':_0x15f097(0x2c0)});}),tgBot[_0x2f74ff(0x195)](_0x2f74ff(0x1e9),async _0x2e56d6=>{const _0x2c5b41=_0x2f74ff,_0x100cc4=getEnabledBots();if(_0x100cc4[_0x2c5b41(0x21b)]==0x0)await sendTelegram(_0x2e56d6[_0x2c5b41(0x119)]['id'],_0x2c5b41(0x254));else{if(_0x100cc4[_0x2c5b41(0x21b)]>0x1)_0x100cc4[_0x2c5b41(0x278)]({'botID':'all'});let _0x3d9e75=[],_0x42f1bc=[];const _0x5780b2=_0x100cc4[_0x2c5b41(0x21b)]%0x4==0x0||_0x100cc4['length']%0x4==0x3||_0x100cc4[_0x2c5b41(0x21b)]%0x3==0x1?0x4:0x3;let _0x427a34=0x0;_0x100cc4['forEach']((_0x549ef3,_0x19f876)=>{const _0x1c5087=_0x2c5b41;if(_0x19f876%_0x5780b2==0x0)_0x42f1bc=[];_0x42f1bc['push'](Markup[_0x1c5087(0x136)][_0x1c5087(0x19b)](_0x549ef3[_0x1c5087(0x1aa)]==_0x1c5087(0x2da)?_0x1c5087(0x181):botRef(_0x549ef3['botID']),'restart_'+_0x549ef3[_0x1c5087(0x1aa)])),_0x19f876%_0x5780b2==0x0&&(_0x3d9e75[_0x427a34]=_0x42f1bc,_0x427a34++);});const _0x4a7aee=Markup[_0x2c5b41(0x287)](_0x3d9e75);_0x2e56d6[_0x2c5b41(0x262)](_0x2c5b41(0x2d4),_0x4a7aee);}}),tgBot[_0x2f74ff(0x276)](/restart_(.+)/,async _0x2a98a1=>{const _0xac3e98=_0x2f74ff,_0x364f07=_0x2a98a1[_0xac3e98(0x139)][0x1];_0x2a98a1['editMessageReplyMarkup'](),_0x364f07=='all'?config['forEach'](_0x254c5b=>{restartBot(_0x254c5b['botID']);}):restartBot(_0x364f07);}),tgBot['command']('on',async _0x45fbd0=>{const _0x4eea85=_0x2f74ff,_0x17b9f0=getDisabledBots();if(_0x17b9f0[_0x4eea85(0x21b)]==0x0)await sendTelegram(_0x45fbd0[_0x4eea85(0x119)]['id'],_0x4eea85(0x1f5));else{if(_0x17b9f0[_0x4eea85(0x21b)]>0x1)_0x17b9f0[_0x4eea85(0x278)]({'botID':_0x4eea85(0x2da)});let _0xea6349=[],_0x54f5a8=[];const _0x25ea47=_0x17b9f0[_0x4eea85(0x21b)]%0x4==0x0||_0x17b9f0[_0x4eea85(0x21b)]%0x4==0x3||_0x17b9f0[_0x4eea85(0x21b)]%0x3==0x1?0x4:0x3;let _0x52dd9d=0x0;_0x17b9f0['forEach']((_0x1e9277,_0x19d8be)=>{const _0x56f8b9=_0x4eea85;if(_0x19d8be%_0x25ea47==0x0)_0x54f5a8=[];_0x54f5a8[_0x56f8b9(0x278)](Markup[_0x56f8b9(0x136)][_0x56f8b9(0x19b)](_0x1e9277['botID']=='all'?'All\x20bots':botRef(_0x1e9277[_0x56f8b9(0x1aa)]),_0x56f8b9(0x20b)+_0x1e9277[_0x56f8b9(0x1aa)])),_0x19d8be%_0x25ea47==0x0&&(_0xea6349[_0x52dd9d]=_0x54f5a8,_0x52dd9d++);});const _0x2b0cf5=Markup[_0x4eea85(0x287)](_0xea6349);_0x45fbd0[_0x4eea85(0x262)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x2b0cf5);}}),tgBot[_0x2f74ff(0x276)](/on_(.+)/,async _0x2a7de7=>{const _0x442cb5=_0x2f74ff,_0x19a1bc=_0x2a7de7['match'][0x1];_0x2a7de7[_0x442cb5(0x1a8)]();if(_0x19a1bc=='all'){const _0x127c28=getDisabledBots();await sendTelegram(_0x2a7de7['chat']['id'],'Bot\x20Mgr\x20>\x20Starting\x20all\x20bots'),_0x127c28[_0x442cb5(0xf0)](_0x4ac367=>{const _0x13c93c=_0x442cb5;if(_0x4ac367[_0x13c93c(0x1aa)]!=_0x13c93c(0x2da))toggleBot(_0x4ac367[_0x13c93c(0x1aa)],toggleStatus(_0x4ac367['botID']),_0x13c93c(0x296));});}else await sendTelegram(_0x2a7de7['chat']['id'],'Bot\x20Mgr\x20>\x20Starting\x20'+botRef(_0x19a1bc)),toggleBot(_0x19a1bc,toggleStatus(_0x19a1bc),_0x442cb5(0x296));}),tgBot[_0x2f74ff(0x195)](_0x2f74ff(0x11e),async _0x461dc0=>{const _0x55dfbf=_0x2f74ff,_0x5c42cb=getEnabledBots();if(_0x5c42cb[_0x55dfbf(0x21b)]==0x0)await sendTelegram(_0x461dc0[_0x55dfbf(0x119)]['id'],_0x55dfbf(0x254));else{if(_0x5c42cb[_0x55dfbf(0x21b)]>0x1)_0x5c42cb[_0x55dfbf(0x278)]({'botID':_0x55dfbf(0x2da)});let _0x379602=[],_0x48021e=[];const _0x3f032f=_0x5c42cb['length']%0x4==0x0||_0x5c42cb[_0x55dfbf(0x21b)]%0x4==0x3||_0x5c42cb['length']%0x3==0x1?0x4:0x3;let _0x53d5ae=0x0;_0x5c42cb[_0x55dfbf(0xf0)]((_0x4019ac,_0x463add)=>{const _0x5bce50=_0x55dfbf;if(_0x463add%_0x3f032f==0x0)_0x48021e=[];_0x48021e[_0x5bce50(0x278)](Markup[_0x5bce50(0x136)][_0x5bce50(0x19b)](_0x4019ac[_0x5bce50(0x1aa)]==_0x5bce50(0x2da)?'All\x20bots':botRef(_0x4019ac['botID']),_0x5bce50(0x1eb)+_0x4019ac['botID'])),_0x463add%_0x3f032f==0x0&&(_0x379602[_0x53d5ae]=_0x48021e,_0x53d5ae++);});const _0x1e7886=Markup[_0x55dfbf(0x287)](_0x379602);_0x461dc0['reply'](_0x55dfbf(0x187),_0x1e7886);}}),tgBot['action'](/off_(.+)/,async _0xb837d5=>{const _0x423256=_0x2f74ff,_0x4463e5=_0xb837d5['match'][0x1];_0xb837d5[_0x423256(0x1a8)]();if(_0x4463e5==_0x423256(0x2da)){const _0x37b26c=getEnabledBots();await sendTelegram(_0xb837d5[_0x423256(0x119)]['id'],_0x423256(0xdf)),_0x37b26c[_0x423256(0xf0)](_0x5884b4=>{const _0x2a2c3a=_0x423256;if(_0x5884b4[_0x2a2c3a(0x1aa)]!=_0x2a2c3a(0x2da))toggleBot(_0x5884b4[_0x2a2c3a(0x1aa)],toggleStatus(_0x5884b4['botID']),'stopped');});}else await sendTelegram(_0xb837d5[_0x423256(0x119)]['id'],'Bot\x20Mgr\x20>\x20Stopping\x20'+botRef(_0x4463e5)),toggleBot(_0x4463e5,toggleStatus(_0x4463e5),_0x423256(0x296));}),tgBot[_0x2f74ff(0x195)](_0x2f74ff(0x2e8),async _0xd68c68=>{const _0x258d58=_0x2f74ff,_0x5cf5ea=getEnabledBots();if(_0x5cf5ea[_0x258d58(0x21b)]==0x0)await sendTelegram(_0xd68c68['chat']['id'],_0x258d58(0x254));else{if(_0x5cf5ea[_0x258d58(0x21b)]>0x1){let _0xb14017=[],_0x2bc3da=[];const _0x57c481=_0x5cf5ea[_0x258d58(0x21b)]%0x4==0x0||_0x5cf5ea['length']%0x4==0x3||_0x5cf5ea['length']%0x3==0x1?0x4:0x3;let _0x3b5fd6=0x0;_0x5cf5ea[_0x258d58(0xf0)]((_0x17b2f3,_0x1954f9)=>{const _0x2bab38=_0x258d58;if(_0x1954f9%_0x57c481==0x0)_0x2bc3da=[];_0x2bc3da[_0x2bab38(0x278)](Markup[_0x2bab38(0x136)][_0x2bab38(0x19b)](botRef(_0x17b2f3[_0x2bab38(0x1aa)]),_0x2bab38(0x17c)+_0x17b2f3['botID'])),_0x1954f9%_0x57c481==0x0&&(_0xb14017[_0x3b5fd6]=_0x2bc3da,_0x3b5fd6++);});const _0x12efe1=Markup[_0x258d58(0x287)](_0xb14017);_0xd68c68[_0x258d58(0x262)](_0x258d58(0x2d0),_0x12efe1);}else{const _0x48e04a=_0x5cf5ea[0x0][_0x258d58(0x1aa)];if(pid[_0x48e04a])pid[_0x48e04a][_0x258d58(0x19e)]({'function':_0x258d58(0x189),'args':null});}}}),tgBot[_0x2f74ff(0x276)](/metrics_(.+)/,async _0x13e00c=>{const _0xb4b190=_0x2f74ff,_0x40a7b1=_0x13e00c[_0xb4b190(0x139)][0x1];_0x13e00c[_0xb4b190(0x1a8)]();if(pid[_0x40a7b1])pid[_0x40a7b1][_0xb4b190(0x19e)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x2f74ff(0x195)](_0x2f74ff(0x183),async _0x565b96=>{const _0x138b99=_0x2f74ff,_0x121f23=getEnabledBots();if(_0x121f23[_0x138b99(0x21b)]==0x0)await sendTelegram(_0x565b96['chat']['id'],_0x138b99(0x254));else{if(_0x121f23[_0x138b99(0x21b)]>0x1){let _0x509802=[],_0x4266e8=[];const _0x20c1d1=_0x121f23[_0x138b99(0x21b)]%0x4==0x0||_0x121f23['length']%0x4==0x3||_0x121f23[_0x138b99(0x21b)]%0x3==0x1?0x4:0x3;let _0x85d775=0x0;_0x121f23[_0x138b99(0xf0)]((_0xbeb95c,_0x172265)=>{const _0x56e3b3=_0x138b99;if(_0x172265%_0x20c1d1==0x0)_0x4266e8=[];_0x4266e8['push'](Markup[_0x56e3b3(0x136)][_0x56e3b3(0x19b)](botRef(_0xbeb95c['botID']),'portfolio_'+_0xbeb95c['botID'])),_0x172265%_0x20c1d1==0x0&&(_0x509802[_0x85d775]=_0x4266e8,_0x85d775++);});const _0x3b1a72=Markup[_0x138b99(0x287)](_0x509802);_0x565b96[_0x138b99(0x262)](_0x138b99(0x193),_0x3b1a72);}else{const _0x4d3f75=_0x121f23[0x0][_0x138b99(0x1aa)];if(pid[_0x4d3f75])pid[_0x4d3f75][_0x138b99(0x19e)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x2f74ff(0x276)](/portfolio_(.+)/,async _0x5ee23e=>{const _0x4c1248=_0x2f74ff,_0x57d9c8=_0x5ee23e[_0x4c1248(0x139)][0x1];_0x5ee23e[_0x4c1248(0x1a8)]();if(pid[_0x57d9c8])pid[_0x57d9c8][_0x4c1248(0x19e)]({'function':_0x4c1248(0xda),'args':null});}),tgBot[_0x2f74ff(0x195)]('logs',async _0x594790=>{const _0x3de237=_0x2f74ff,_0x22f192=_0x3de237(0x29f);await zipFiles(_0x22f192);const _0x36c76d=zippath+(_0x22f192+_0x3de237(0x1bd));_0x594790[_0x3de237(0x180)]({'source':_0x36c76d})[_0x3de237(0xe4)](()=>{})['catch'](_0x1f8b2c=>logger[_0x3de237(0x223)](_0x3de237(0xd3)+_0x22f192+'\x20files\x20over\x20Telegram:',_0x1f8b2c));}),tgBot[_0x2f74ff(0x195)](_0x2f74ff(0x24d),async _0x374cde=>{const _0x60278d=_0x2f74ff,_0x14010b=_0x60278d(0x24d);await backupConfigFiles(),await zipFiles(_0x14010b);const _0x3db74e=zippath+(_0x14010b+_0x60278d(0x1bd));_0x374cde[_0x60278d(0x180)]({'source':_0x3db74e})[_0x60278d(0xe4)](()=>{})[_0x60278d(0x11a)](_0x2cd541=>logger['debug'](_0x60278d(0xd3)+_0x14010b+_0x60278d(0x24e),_0x2cd541));}),tgBot[_0x2f74ff(0x195)](_0x2f74ff(0x1e0),async _0x38e28f=>{const _0x3b1f65=_0x2f74ff;await getMessages();if(!updateAvailable)await sendTelegram(_0x38e28f[_0x3b1f65(0x119)]['id'],_0x3b1f65(0x271));else{if(!validInstallation)await sendTelegram(_0x38e28f['chat']['id'],_0x3b1f65(0x250));else{const _0x182e53=Markup[_0x3b1f65(0x287)]([Markup[_0x3b1f65(0x136)]['callback'](_0x3b1f65(0x23b),_0x3b1f65(0x152)),Markup['button']['callback']('No',_0x3b1f65(0x1ba))]);_0x38e28f[_0x3b1f65(0x262)](_0x3b1f65(0x12a),_0x182e53);}}}),tgBot[_0x2f74ff(0x276)](/update_(.+)/,async _0x1ddc77=>{const _0x1d9f02=_0x2f74ff,_0x397110=_0x1ddc77[_0x1d9f02(0x139)][0x1];_0x1ddc77[_0x1d9f02(0x1a8)](),_0x397110==_0x1d9f02(0xf7)&&(await sendTelegram(_0x1ddc77['chat']['id'],_0x1d9f02(0x12b)),updateBB(_0x1d9f02(0x1e0))),_0x397110=='no'&&await sendTelegram(_0x1ddc77[_0x1d9f02(0x119)]['id'],_0x1d9f02(0x188));}),tgBot[_0x2f74ff(0x195)](_0x2f74ff(0x231),async _0x54fbd5=>{const _0x55726c=_0x2f74ff;if(!validInstallation)await sendTelegram(_0x54fbd5[_0x55726c(0x119)]['id'],_0x55726c(0x2dd));else{const _0x5dc23b=Markup['inlineKeyboard']([Markup[_0x55726c(0x136)][_0x55726c(0x19b)](_0x55726c(0x23b),'reinstall_yes'),Markup[_0x55726c(0x136)][_0x55726c(0x19b)]('No',_0x55726c(0x25f))]);_0x54fbd5['reply']('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x5dc23b);}}),tgBot['action'](/reinstall_(.+)/,async _0x14bcc1=>{const _0x43c8e9=_0x2f74ff,_0x87ed62=_0x14bcc1[_0x43c8e9(0x139)][0x1];_0x14bcc1[_0x43c8e9(0x1a8)](),_0x87ed62=='yes'&&(await sendTelegram(_0x14bcc1[_0x43c8e9(0x119)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x43c8e9(0x231))),_0x87ed62=='no'&&await sendTelegram(_0x14bcc1[_0x43c8e9(0x119)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x2f74ff(0x195)]('toggle',async _0x55263a=>{const _0x39166a=_0x2f74ff,_0x257897=getBotsWithMode();if(_0x257897[_0x39166a(0x21b)]==0x0)await sendTelegram(_0x55263a[_0x39166a(0x119)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x3c2e23=[],_0x6ed86a=[];const _0x49781b=0x2;let _0x1c3469=0x0;_0x257897[_0x39166a(0xf0)]((_0xc0e02a,_0x4a3eca)=>{const _0x2adaee=_0x39166a;if(_0x4a3eca%_0x49781b==0x0)_0x6ed86a=[];_0x6ed86a['push'](Markup['button'][_0x2adaee(0x19b)](botRef(_0xc0e02a['botID'])+'\x20('+_0xc0e02a[_0x2adaee(0xef)]+')',_0x2adaee(0x22f)+_0xc0e02a[_0x2adaee(0x1aa)])),_0x4a3eca%_0x49781b==0x0&&(_0x3c2e23[_0x1c3469]=_0x6ed86a,_0x1c3469++);});const _0x1e73a8=Markup[_0x39166a(0x287)](_0x3c2e23);_0x55263a[_0x39166a(0x262)](_0x39166a(0x14b),_0x1e73a8);}}),tgBot['action'](/toggle_(.+)/,async _0x477894=>{const _0x1c747d=_0x2f74ff,_0x207d18=_0x477894[_0x1c747d(0x139)][0x1];_0x477894['editMessageReplyMarkup']();const _0x2049ae=getBotsWithMode(),_0x5b0d94=_0x2049ae[_0x1c747d(0xf1)](_0x351034=>_0x351034['botID']==_0x207d18),_0x1f27f4=_0x5b0d94[_0x1c747d(0xef)]=='auto'?_0x1c747d(0x157):_0x1c747d(0x1da);await sendTelegram(_0x477894[_0x1c747d(0x119)]['id'],_0x1c747d(0x252)+botRef(_0x5b0d94[_0x1c747d(0x1aa)])+_0x1c747d(0x1b8)+_0x1f27f4+_0x1c747d(0x163)),toggleBotMode(_0x207d18);}),tgBot[_0x2f74ff(0x195)](_0x2f74ff(0x25e),async _0x443669=>{const _0xec73a9=_0x2f74ff;let _0x55b559='';config['forEach'](_0x35c218=>{const _0x41dd0d=_0x3402;_0x55b559+=_0x41dd0d(0x14d)+_0x35c218[_0x41dd0d(0x1aa)]+':\x20'+_0x35c218[_0x41dd0d(0x10b)]+'\x0a';}),await sendTelegram(_0x443669[_0xec73a9(0x119)]['id'],_0x55b559,{'parse_mode':_0xec73a9(0x2c0)});}),tgBot['command']('help',async _0x4eb546=>{const _0x1bbc87=_0x2f74ff;await sendTelegram(_0x4eb546[_0x1bbc87(0x119)]['id'],_0x44fbfc);}),process[_0x2f74ff(0x26d)](_0x2f74ff(0x1a2),()=>tgBot[_0x2f74ff(0x265)](_0x2f74ff(0x1a2))),process[_0x2f74ff(0x26d)](_0x2f74ff(0x211),()=>tgBot[_0x2f74ff(0x265)](_0x2f74ff(0x211))),tgBot[_0x2f74ff(0x29a)]();}function disableTelegram(){const _0x32f1e3=_0x237392;tgBot&&tgBot[_0x32f1e3(0x265)]();}async function sendTelegram(_0x3fc4e2,_0xc868a,_0x1928d6){const _0x4870e1=_0x237392;_0x1928d6={..._0x1928d6,'disable_web_page_preview':!![]};try{await tgBot[_0x4870e1(0x151)][_0x4870e1(0x131)](_0x3fc4e2,_0xc868a,_0x1928d6);}catch(_0x292eeb){logger[_0x4870e1(0x223)](_0x4870e1(0x2ca),_0x292eeb);}}async function sendTelegramBot(_0x4f433f,_0x54f2e0){const _0x373c8f=_0x237392;if(settings['telegramEnabled']){if(settings['telegramEvents']==_0x373c8f(0x2da)||(_0x54f2e0[_0x373c8f(0xeb)]==_0x373c8f(0x134)||_0x54f2e0[_0x373c8f(0xeb)]==_0x373c8f(0x155)||_0x54f2e0[_0x373c8f(0xeb)]==_0x373c8f(0x1be))&&settings[_0x373c8f(0x202)]==_0x373c8f(0x2dc)||_0x54f2e0['type']==_0x373c8f(0x129)&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x373c8f(0x109)]){if(_0x54f2e0[_0x373c8f(0x1d3)])await sendTelegram(settings[_0x373c8f(0x109)],_0x54f2e0[_0x373c8f(0x10b)]+_0x373c8f(0x281)+_0x54f2e0[_0x373c8f(0xd9)]);else await sendTelegram(settings['telegramChatId'],_0x373c8f(0x14d)+_0x4f433f+'\x20>\x20'+_0x54f2e0[_0x373c8f(0xd9)]);}}}}async function sendTelegramMsg(_0x571ef8,_0x4cb776=_0x237392(0x2c0)){return tgBot&&settings['telegramChatId']?(await sendTelegram(settings['telegramChatId'],_0x571ef8,{'parse_mode':_0x4cb776}),!![]):![];}function getDeviceWithIp(_0x5205f9){const _0xc1574=_0x237392;return devices[_0xc1574(0xf1)](_0x3fc675=>_0x3fc675['ip']===_0x5205f9);}async function temporaryAccess2FA(_0x41e8c2,_0x4afd40){const _0x386ce6=_0x237392;let _0x4412ae=new Date(),_0x4d81f7=![];if(lastIpApproval){if(_0x4412ae-lastIpApproval<0x1388)_0x4d81f7=!![];}lastIpApproval=new Date();if(_0x4d81f7)return;if(tgBot&&settings[_0x386ce6(0x109)]){const _0x22af1a=uuidRandom();tmpStorage[_0x22af1a]={'uuid':_0x41e8c2,'externalip':_0x4afd40};const _0x5e9f6d=Markup[_0x386ce6(0x287)]([Markup['button'][_0x386ce6(0x19b)](_0x386ce6(0x17d),'tempaccess_5_'+_0x22af1a),Markup[_0x386ce6(0x136)][_0x386ce6(0x19b)](_0x386ce6(0x1a7),_0x386ce6(0xe5)+_0x22af1a),Markup[_0x386ce6(0x136)][_0x386ce6(0x19b)](_0x386ce6(0x215),_0x386ce6(0x224)+_0x22af1a),Markup[_0x386ce6(0x136)][_0x386ce6(0x19b)](_0x386ce6(0x284),_0x386ce6(0x199)+_0x22af1a)]);await sendTelegram(settings[_0x386ce6(0x109)],_0x386ce6(0x29c)+normalizeIP(_0x4afd40)['show']+'\x20?',_0x5e9f6d),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x2fb1e8=>{const _0x7189a3=_0x386ce6,_0x16d3c7=_0x2fb1e8[_0x7189a3(0x139)][0x1],_0x4fb68c=_0x2fb1e8[_0x7189a3(0x139)][0x2],{uuid:_0x281bc2,externalip:_0x562f2c}=tmpStorage[_0x4fb68c];delete tmpStorage[_0x4fb68c],_0x2fb1e8['editMessageReplyMarkup'](),devices[_0x281bc2][_0x7189a3(0x1cd)]={'clientip':_0x562f2c,'timestamp':new Date()['getTime'](),'expiry':_0x16d3c7},_0x16d3c7!=_0x7189a3(0x284)?(await sendTelegram(_0x2fb1e8[_0x7189a3(0x119)]['id'],'Access\x20enabled\x20for\x20'+_0x16d3c7+_0x7189a3(0x297),{'parse_mode':_0x7189a3(0x2c0)}),io['to'](_0x281bc2)[_0x7189a3(0x101)]('status',{'access':{'allow':![],'reason':_0x7189a3(0x28c),'token':null}})):(await sendTelegram(_0x2fb1e8[_0x7189a3(0x119)]['id'],_0x7189a3(0x15b)),io['to'](_0x281bc2)[_0x7189a3(0x101)](_0x7189a3(0x2e7),{'access':{'allow':![],'reason':_0x7189a3(0x20d),'token':null}}));});}}async function loginAccess2FA(_0x3f96e4,_0x57fd59){const _0x279b81=_0x237392;if(tgBot&&settings[_0x279b81(0x109)]){const _0x533650=uuidRandom();tmpStorage[_0x533650]={'uuid':_0x3f96e4,'externalip':_0x57fd59};const _0xbbbaae=Markup[_0x279b81(0x287)]([Markup[_0x279b81(0x136)][_0x279b81(0x19b)](_0x279b81(0x283),_0x279b81(0x27c)+loginExpiry+'_'+_0x533650),Markup['button'][_0x279b81(0x19b)]('reject',_0x279b81(0xe3)+_0x533650)]);await sendTelegram(settings['telegramChatId'],_0x279b81(0x2e4)+normalizeIP(_0x57fd59)[_0x279b81(0xec)]+'\x20?',_0xbbbaae),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x5e3800=>{const _0x15b3de=_0x279b81,_0x21ea56=_0x5e3800[_0x15b3de(0x139)][0x1],_0x480589=_0x5e3800[_0x15b3de(0x139)][0x2],{uuid:_0x12aa67,externalip:_0x300154}=tmpStorage[_0x480589];delete tmpStorage[_0x480589],_0x5e3800[_0x15b3de(0x1a8)](),devices[_0x12aa67][_0x15b3de(0x12c)]={'clientip':_0x300154,'timestamp':new Date()[_0x15b3de(0x16a)](),'expiry':_0x21ea56},_0x21ea56!=_0x15b3de(0x284)?(await sendTelegram(_0x5e3800[_0x15b3de(0x119)]['id'],_0x15b3de(0x16e),{'parse_mode':'HTML'}),io['to'](_0x12aa67)['emit'](_0x15b3de(0x2e7),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x5e3800[_0x15b3de(0x119)]['id'],_0x15b3de(0xe8)),io['to'](_0x12aa67)['emit']('status',{'access':{'allow':![],'reason':_0x15b3de(0x2a4),'token':null}}));});}}function _0x2b21(){const _0x19e16d=['User\x20has\x20been\x20validated','assign','update-bb','telegram','update_yes','login\x20not\x20required','full','warning','get-logs','manual','format','express','cloneDeep','Temporary\x20access\x20rejected','store-configuration','private','add-bot','yargs','backup-full@','timeshift','sendFile','\x20mode','login\x20required','lastmsgtelegram','secure',',\x20must\x20be\x20a\x204\x20digit\x20number','Idling\x20(','\x1b[33m','getTime','telegramToken','writeFileSync','#RES#\x20','Login\x20accepted','family','store-fiat','environment','isValid','sign','verify','output-000.log','config_alerts','Failed\x20to\x20download\x20','config_orders','loadAsync','/metrics\x20-\x20show\x20bot\x20performance\x0a','date-fns','metrics_','5\x20min','reset-history','Telegraf\x20error:','replyWithDocument','All\x20bots','child_process','portfolio','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','listen','#RES#','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','sendMetricsTelegram','getDate','static','readFileSync','close','getSeconds','/help\x20-\x20show\x20available\x20commands\x0a','Network\x20Interfaces:','remove','/off\x20-\x20stop\x20bot(s)\x0a','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','botmanager','command','headless','bbvNew','3000','tempaccess_reject_','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','callback','timestamp','logs/','send','createServer','userid','Backup\x20file\x20uploaded','SIGINT','code','Unauthorized\x20attempt\x20to\x20get\x20messages','onepagemode','http://localhost:','15\x20min','editMessageReplyMarkup','split','botID','graphql-request','/:bot/configuration','unlinkSync','storeConfiguration','privateKeyToPem','socket','ETH','\x20-\x20','store','Markdown','login\x20token\x20generated','orders','name','\x20to\x20','2FA\x20login\x20token\x20generated','update_no','bbUsername','uncaughtException','.zip','success','No\x20authentication\x20token','start','new-disabled','::ffff:127.0.0.1','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','\x20|\x20user:\x20...','5006210AMwiPi','sha256','storeHeadless','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','get-starting-balances','sockets','inherit','get-portfolio','telegramIpApproval','createWriteStream','host','/disable\x20-\x20disable\x20notifications\x0a','exit','apiKey','showname','delete-alerts','decode64','post','temporary\x20token\x20generated','constructor','/:bot','auto','isDirectory','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','password','594162oMzRGn','Running\x20#RED#Balance\x20Bot\x20v','update','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','-----------------------------------------------------------------------------------','Invalid\x20IP\x20address','keys','zip/','telegramEnabled','bb-settings.json','Password\x20reset\x20rejected','restart','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','off_','settings','telegramUsername','messages','entries','Unauthorized\x20attempt\x20to\x20log\x20out','toString','randomFillSync','invalid\x20credentials','Starting\x20#RED#Balance\x20Bot\x20v','All\x20bots\x20running\x20right\x20now','privateKeyFromPem','bb/','\x20|\x20','hasOwnProperty','remoteAddress','privateKey','api-eu.mixpanel.com','slice','getStartingBalances','Starting\x20(','kill','ipc','telegramEvents','lowdb/adapters/FileSync','whitelistEnabled','axios','Restore\x20process\x20aborted','127.0.0.1','crypto','tkn','emitHistory','on_','enabled','temporary\x20access\x20rejected','publicKey','title','output-002.log','SIGTERM','number','log','connected','30\x20min','uuid-random','************','$1_$2_$3','8vPXplY','new','length','=>\x20Go\x20to\x20#CYA#http://','*$1*','Unauthorized\x20attempt\x20to\x20get\x20events','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','async','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','get-messages','debug','tempaccess_30_','bot-','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','backup-full.zip','string','lastmsgemitted','Alerts','fork','temporary\x20access\x20not\x20allowed','toIPv4MappedAddress','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','toggle_','allow','reinstall','handshake','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','create','2FA\x20login\x20required','rsa','output-001.log','copyFileSync','-performance.json','includes','Yes','alias','running','\x1b[34m','toggleBotMode','Notifications\x20types:\x20','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','marketcapApi','address','settings.','bbvReceive','logout','token','showConfig','params','open','/:bot/history','[ip-address]','backup','\x20files\x20over\x20Telegram:','files','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','generateAsync','Bot\x20Mgr\x20>\x20Toggling\x20','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','No\x20bots\x20running\x20right\x20now','***','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','<b>Telegram\x20Bot\x20Status:</b>\x0a','output-003.log','data','get-backup-files','resetpw_yes','referer','simple','names','reinstall_no','/:bot/support','2FA\x20required','reply','Unauthorized\x20attempt\x20to\x20confirm\x20message','Backup\x20file\x20unzipped\x20and\x20stored','stop','3GJTjHA','Orders','filter','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','status\x20code\x20401','parse','Setting\x20access:\x20','once','Bot\x20Mgr\x20>\x20','store-settings','defaults','Your\x20installation\x20is\x20already\x20up\x20to\x20date','test','2808594RYTqdL','5027092shhQhy','/start','action','pidRefreshToken','push','exec','reset-password','Error\x20details:','login2fa_','readdirSync','NTBA_FIX_319','node','login','\x20>\x20','disconnect','accept','reject','compareSync','removeAllListeners','inlineKeyboard','initclient','port','Notifications\x20enabled\x0a','kind','reload','reason','4596732QUugsa','max','publicKeyToPem','Unauthorized\x20attempt\x20to\x20download\x20','restore_yes_','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','\x1b[0m','secret','stopped','\x20minutes','toIPv4Address','-events.json','launch','reinstall-bb','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','(((.+)+)+)+$','util','logs','bb-config.json','latestversion','-config.json','\x1b[31m','2FA\x20login\x20rejected','bb-secure.json','config','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','\x1b[35m','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','get','638730WzvlfD','mixpanel','deleteHistoryAlerts','https://api.ipify.org?format=json','Restore\x20process\x20confirmed','show-config','getMonth','init','access\x20timeout','range','Deleted\x20Bot\x20','file','request','notification','Password\x20has\x20been\x20reset\x20to:\x20','/upload-backup','disabled','delete-bot','getFullYear','exp','version.json','HTML','/restart\x20-\x20restart\x20bot(s)\x0a','generateKeyPair','build','\x20(1)','backupfile','resetpw_no','apiSecret','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','build2','Telegram\x20error:','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','function','placeOrder','size','username','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','uuid','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','bots','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','write','started','getMinutes','0.0.0','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','all','loginRequired','alerts','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','_nsps','pidExpireLogin','ipaddr.js','decrypt','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','pki','Allow\x20login\x20from\x20IP\x20address\x20','statSync','stringify','status','metrics','\x20only\x0a','config/','Unauthorized\x20attempt\x20to\x20delete\x20bot','from','clientip','Error\x20while\x20deleting\x20config\x20files:\x20','restore-backup-file','Error\x20sending\x20','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','live','any','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','address\x20already\x20in\x20use','event','sendPortfolioTelegram','/:bot/coins','All','node-forge','jszip','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','version','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','storeFiat','login2fa_reject_','then','tempaccess_15_','search','|@|','Login\x20rejected','config_all','hex','type','show','Server','9669897kLOOvr','mode','forEach','find','startsWith','bbPassword','exchange','jsonwebtoken','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','yes','getUTCHours','expiry','server','ipv6','value','Invalid\x20username\x20or\x20IP\x20address','temporary\x20access\x20timeout','randomBytes','Unauthorized\x20attempt\x20to\x20add\x20bot','emit','rmSync','\x20(2)','/on\x20-\x20start\x20bot(s)\x0a','existsSync','clients','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','socket.io','telegramChatId','6b67f3d61ee94b8f5c80b4affef4c4d9','botname','disable','-results.json','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Error:\x20Invalid\x20argument\x20','(staging)','access','/download/:type','apiPassword','blacklist','backup-files','f2aRequired','message',')\x20\x20\x20|\x20Bot\x20','chat','catch','binary','isIPv4MappedAddress','padStart','off','sortBy','use','download','user','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','bot','index.html','Invalid\x20authentication\x20token\x20(2)','Starting\x20new\x20bot\x20|\x20Bot\x20','enable','order','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Starting\x20Balance\x20Bot\x20update','telegram2FaApproval','bot.js','mkdirSync','conn','express-fileupload','sendMessage','headers','1000','error','Unauthorized\x20attempt\x20to\x20show\x20configuration','button','Session\x20expired\x20for\x20user\x20...','Notifications\x20enabled','match','http','auth','Unauthorized\x20attempt\x20to\x20update\x20bot','internal','Enabled\x20','confirm-message','Notifications\x20disabled','update-bot',')\x20|\x20Bot\x20','argv','Restore\x20backup\x20file\x20','--------------------------------------','replace','Unauthorized\x20attempt\x20to\x20delete\x20alerts','getHours','Logged\x20out\x20user\x20...','sort','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','join','Bot\x20'];_0x2b21=function(){return _0x19e16d;};return _0x2b21();}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x521302=_0x237392;return dbConfig[_0x521302(0x2aa)](_0x521302(0x2d3))[_0x521302(0x11f)](_0x521302(0x1aa))[_0x521302(0x268)]({'status':_0x521302(0x20c)})[_0x521302(0xfc)]()||[];}function getDisabledBots(){const _0x3bf35f=_0x237392;return dbConfig['get'](_0x3bf35f(0x2d3))[_0x3bf35f(0x11f)](_0x3bf35f(0x1aa))[_0x3bf35f(0x268)]({'status':'disabled'})['value']()||[];}function getBotAttributes(_0x386be8){const _0x15e7fd=_0x237392;let _0x1c85d5={};const _0x1f4311=configpath+'bot-'+_0x386be8+_0x15e7fd(0x2a2),_0x112dcb=fs['existsSync'](_0x1f4311);if(_0x112dcb){const _0x47b5d6=fs[_0x15e7fd(0x18c)](_0x1f4311);try{const _0x3c73ec=JSON[_0x15e7fd(0x26b)](_0x47b5d6),_0x2c0975=_0x3c73ec?_0x3c73ec['bot'][0x0][_0x15e7fd(0x196)]:![];_0x1c85d5[_0x15e7fd(0xef)]=_0x2c0975?_0x15e7fd(0x1da):_0x15e7fd(0x157),_0x1c85d5[_0x15e7fd(0x10b)]=_0x3c73ec?_0x3c73ec[_0x15e7fd(0x124)][0x0][_0x15e7fd(0x10b)]:_0x15e7fd(0x14d)+_0x386be8,_0x1c85d5[_0x15e7fd(0x1d3)]=_0x3c73ec?_0x3c73ec['bot'][0x0][_0x15e7fd(0x1d3)]:![];}catch(_0x184b6d){_0x1c85d5[_0x15e7fd(0xef)]=_0x15e7fd(0x157),_0x1c85d5[_0x15e7fd(0x10b)]=_0x15e7fd(0x14d)+_0x386be8,_0x1c85d5[_0x15e7fd(0x1d3)]=![];}}else _0x1c85d5['mode']=_0x15e7fd(0x157),_0x1c85d5[_0x15e7fd(0x10b)]=_0x15e7fd(0x14d)+_0x386be8,_0x1c85d5[_0x15e7fd(0x1d3)]=![];return _0x1c85d5;}function getBotsWithMode(){const _0x2523e2=_0x237392,_0x338585=dbConfig[_0x2523e2(0x2aa)](_0x2523e2(0x2d3))[_0x2523e2(0x11f)](_0x2523e2(0x1aa))[_0x2523e2(0xfc)]()||[];return _0x338585['forEach'](_0x2f33a4=>{const _0x284879=_0x2523e2;let _0x36b19b=getBotAttributes(_0x2f33a4['botID']);_0x2f33a4[_0x284879(0xef)]=_0x36b19b[_0x284879(0xef)];}),_0x338585;}function getBotExchanges(){const _0x2ca0b4=_0x237392;let _0x4ba45b=[];const _0xc04501=dbConfig[_0x2ca0b4(0x2aa)](_0x2ca0b4(0x2d3))[_0x2ca0b4(0x11f)](_0x2ca0b4(0x1aa))[_0x2ca0b4(0xfc)]()||[];_0xc04501[_0x2ca0b4(0xf0)](_0x47d89e=>{const _0xc1c00d=_0x2ca0b4;if(_0x47d89e[_0xc1c00d(0x2e7)]=='enabled'){const _0x386b88=configpath+'bot-'+_0x47d89e[_0xc1c00d(0x1aa)]+_0xc1c00d(0x2a2),_0x568816=fs[_0xc1c00d(0x105)](_0x386b88);let _0x54f43b;if(_0x568816){const _0x73ab8d=fs[_0xc1c00d(0x18c)](_0x386b88);try{const _0x5a9221=JSON['parse'](_0x73ab8d);_0x54f43b=_0x5a9221?_0x5a9221['bot'][0x0][_0xc1c00d(0xf4)]:null;}catch(_0x2f6e2b){}}if(_0x54f43b)_0x4ba45b[_0xc1c00d(0x278)](_0x54f43b);}});const _0x2d9395=[...new Set(_0x4ba45b)]['sort']();return _0x2d9395;}async function initUser(){const _0x3729f3=_0x237392;if(!settings[_0x3729f3(0x1a0)]){const _0x13d3c9=uuidRandom();mixpanel[_0x3729f3(0x23c)](_0x13d3c9),updateSetting('userid',_0x13d3c9);}}async function initSecure(){const _0x321c5e=_0x237392;let _0x2e3fd0=getSecure();if(!_0x2e3fd0[_0x321c5e(0x1f9)]('secret')){let _0x14e5f6=await generateKeys();_0x2e3fd0[_0x321c5e(0x20e)]=_0x14e5f6[_0x321c5e(0x20e)],_0x2e3fd0[_0x321c5e(0x1fb)]=_0x14e5f6[_0x321c5e(0x1fb)],_0x2e3fd0['secret']=crypto[_0x321c5e(0xff)](0x20)[_0x321c5e(0x1f1)](_0x321c5e(0xea));;storeSecure(_0x2e3fd0);}}function getSettings(){const _0x101c46=_0x237392;return dbSettings[_0x101c46(0x2aa)](_0x101c46(0x1ec))['value']()||{};}function getSecure(){const _0x29893b=_0x237392;return dbSecure[_0x29893b(0x2aa)]('secure')[_0x29893b(0xfc)]()||{};}function getBlacklist(){const _0x32c185=_0x237392;return dbSecure[_0x32c185(0x2aa)](_0x32c185(0x114))[_0x32c185(0xfc)]()||[];}function broadcastToBots(_0x5c7172,_0x448aac){const _0xcd1624=_0x237392;config[_0xcd1624(0xf0)](_0x439091=>{const _0x2e542e=_0xcd1624;if(_0x439091['status']==_0x2e542e(0x20c)&&_0x439091[_0x2e542e(0xd5)]=='running'||_0x439091[_0x2e542e(0x2e7)]==_0x2e542e(0x21a)&&_0x439091[_0x2e542e(0xd5)]==_0x2e542e(0x23d)){if(pid[_0x439091[_0x2e542e(0x1aa)]])pid[_0x439091[_0x2e542e(0x1aa)]]['send']({[_0x5c7172]:_0x448aac});}});}async function storeSettings(_0x2afc6a,_0x57b012=![]){const _0x473123=_0x237392;_0x2afc6a={...settings,..._0x2afc6a};if(_0x57b012&&_0x2afc6a[_0x473123(0xf3)]!=_0x473123(0x217)&&_0x2afc6a['bbPassword']!=_0x473123(0x255)&&_0x2afc6a[_0x473123(0xf3)]!=''){const _0x5dfd6f=decryptRSA(secure[_0x473123(0x1fb)],_0x2afc6a[_0x473123(0xf3)])['split'](_0x473123(0xe7))[0x0],_0x3409a2=bcrypt['hashSync'](_0x5dfd6f,saltRounds);_0x2afc6a={..._0x2afc6a,'bbPassword':_0x3409a2};}if(_0x57b012&&_0x2afc6a[_0x473123(0x16b)]!='************'&&_0x2afc6a[_0x473123(0x16b)]!=_0x473123(0x255)&&_0x2afc6a[_0x473123(0x16b)]!=''){const _0x1b4cbc=decryptRSA(secure[_0x473123(0x1fb)],_0x2afc6a[_0x473123(0x16b)])[_0x473123(0x1a9)]('|@|')[0x0];_0x2afc6a={..._0x2afc6a,'telegramToken':_0x1b4cbc};}if(_0x57b012&&_0x2afc6a['marketcapApi']!=_0x473123(0x217)&&_0x2afc6a['marketcapApi']!='***'&&_0x2afc6a[_0x473123(0x242)]!=''){const _0xbea436=decryptRSA(secure[_0x473123(0x1fb)],_0x2afc6a['marketcapApi'])['split'](_0x473123(0xe7))[0x0];_0x2afc6a={..._0x2afc6a,'marketcapApi':_0xbea436};}const _0x2ae49c=_0x2afc6a[_0x473123(0x16b)]!=_0x473123(0x217)&&_0x2afc6a[_0x473123(0x16b)]!=settings['telegramToken']||_0x2afc6a[_0x473123(0x1ed)]!=settings[_0x473123(0x1ed)],_0x1041e=_0x2afc6a[_0x473123(0x16b)]==''||_0x2afc6a['telegramUsername']=='',_0x1868d1=_0x2afc6a[_0x473123(0x242)]&&_0x2afc6a[_0x473123(0x242)]!='************'&&_0x2afc6a[_0x473123(0x242)]!=settings[_0x473123(0x242)];_0x2ae49c&&(_0x2afc6a['telegramChatId']=null,_0x2afc6a[_0x473123(0x202)]=_0x473123(0x2da));for(const [_0x3f7a29,_0x3a5959]of Object[_0x473123(0x1ef)](_0x2afc6a)){if(_0x3f7a29==_0x473123(0x16b)&&_0x3a5959==_0x473123(0x217)){_0x2afc6a[_0x473123(0x16b)]=settings[_0x473123(0x16b)];continue;};if(_0x3f7a29=='bbPassword'&&_0x3a5959==_0x473123(0x217)){_0x2afc6a['bbPassword']=settings[_0x473123(0xf3)];continue;};if(_0x3f7a29==_0x473123(0x242)&&_0x3a5959==_0x473123(0x217)){_0x2afc6a[_0x473123(0x242)]=settings[_0x473123(0x242)];continue;};dbSettings['set'](_0x473123(0x244)+_0x3f7a29,_0x3a5959)[_0x473123(0x2d5)]();}settings=_0x2afc6a,io['to']('botmanager')['emit'](_0x473123(0x1ec),cleanSettings()),broadcastToBots(_0x473123(0x161),settings[_0x473123(0x161)]),broadcastToBots('onepagemode',settings[_0x473123(0x1a5)]),broadcastToBots(_0x473123(0x242),settings['marketcapApi']);if(_0x2ae49c&&!_0x1041e)initTelegram();_0x2ae49c&&_0x1041e&&(updateSetting(_0x473123(0x109),null),disableTelegram()),getAllClients()[_0x473123(0xf0)](_0x4c1d7e=>{const _0x457e49=_0x473123;getSocket(_0x4c1d7e['id'])['emit'](_0x457e49(0x2e7),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x1868d1&&(await sleep(0xbb8),testMarketcapApi(_0x2afc6a[_0x473123(0x242)]));}async function testMarketcapApi(_0x408bbe){const _0x14f8cf=_0x237392,_0x495a08=['BCT',_0x14f8cf(0x1b1)];try{await axios[_0x14f8cf(0x2aa)](_0x14f8cf(0x256),{'headers':{'X-CMC_PRO_API_KEY':_0x408bbe},'params':{'symbol':_0x495a08[_0x14f8cf(0x1f1)]()}});}catch(_0x98acfb){_0x98acfb[_0x14f8cf(0x1f1)]()['includes'](_0x14f8cf(0x26a))?(io['to']('botmanager')['emit'](_0x14f8cf(0x2b8),_0x14f8cf(0x107)),logger[_0x14f8cf(0x154)](_0x14f8cf(0x107))):(io['to'](_0x14f8cf(0x194))[_0x14f8cf(0x101)]('notification',_0x14f8cf(0x226)),logger[_0x14f8cf(0x154)](_0x14f8cf(0x226)),logger['debug'](_0x14f8cf(0x27b),_0x98acfb[_0x14f8cf(0x1f1)]()+_0x14f8cf(0x1b2)+_0x98acfb[_0x14f8cf(0x1a3)]));return;}logger[_0x14f8cf(0x223)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x48e945,_0x6710f1){const _0x5eeaff=_0x237392;dbSettings['set'](_0x5eeaff(0x244)+_0x48e945,_0x6710f1)['write'](),settings=getSettings(),io['to'](_0x5eeaff(0x194))['emit'](_0x5eeaff(0x1ec),cleanSettings());}function storeSecure(_0x325f5c){const _0x595fb7=_0x237392;dbSecure['get'](_0x595fb7(0x166))[_0x595fb7(0x278)](_0x325f5c)[_0x595fb7(0x2d5)](),secure=_0x325f5c;}function addBlacklist(_0x35300e){const _0x55ecdb=_0x237392;cleanBlacklist();let _0x52d826;devices[_0x35300e]['telegramIpApproval']?_0x52d826=Math[_0x55ecdb(0x28f)](devices[_0x35300e][_0x55ecdb(0x1cd)][_0x55ecdb(0xf9)],loginExpiry):_0x52d826=loginExpiry,dbSecure[_0x55ecdb(0x2aa)](_0x55ecdb(0x114))['push']({'expiry':new Date()[_0x55ecdb(0x16a)]()+_0x52d826*0x3c*0x3e8,'token':devices[_0x35300e][_0x55ecdb(0x111)]['token']})[_0x55ecdb(0x2d5)](),blacklist=dbSecure[_0x55ecdb(0x2aa)](_0x55ecdb(0x114))[_0x55ecdb(0xfc)]();}function cleanBlacklist(){const _0x143115=_0x237392;let _0x798836=dbSecure[_0x143115(0x2aa)](_0x143115(0x114))[_0x143115(0x15a)]()['value'](),_0x1d2726=new Date()[_0x143115(0x16a)]();_0x798836['forEach'](_0x1dceeb=>{const _0x433a21=_0x143115;_0x1dceeb[_0x433a21(0xf9)]<_0x1d2726&&dbSecure[_0x433a21(0x2aa)](_0x433a21(0x114))[_0x433a21(0x191)]({'expiry':_0x1dceeb[_0x433a21(0xf9)]})[_0x433a21(0x2d5)]();});}function initStates(){const _0x1ae58a=_0x237392;let _0x2a187b=getConfiguration();_0x2a187b[_0x1ae58a(0xf0)](_0x1e90d4=>{const _0x5b6f51=_0x1ae58a;_0x1e90d4[_0x5b6f51(0xd5)]='stopped';}),storeConfiguration(_0x2a187b);}async function generateKeys(){const _0x3be2dc=_0x237392,_0x2eef5a=forge[_0x3be2dc(0x2e3)][_0x3be2dc(0x236)][_0x3be2dc(0x2c2)]({'bits':0x1000,'e':0x10001}),_0x5daf38=forge[_0x3be2dc(0x2e3)][_0x3be2dc(0x1af)](_0x2eef5a[_0x3be2dc(0x1fb)]),_0x375087=forge['pki'][_0x3be2dc(0x290)](_0x2eef5a['publicKey']);return{'privateKey':_0x5daf38,'publicKey':_0x375087};}async function oneTimeMigration(){const _0x46c892=_0x237392;let _0x58229d=getSettings(),_0x3352f2=![];!_0x58229d[_0x46c892(0x1f9)](_0x46c892(0x165))&&(_0x58229d[_0x46c892(0x165)]=0x0,_0x3352f2=!![]);!_0x58229d['hasOwnProperty'](_0x46c892(0x229))&&(_0x58229d['lastmsgemitted']=0x0,_0x3352f2=!![]);!_0x58229d['hasOwnProperty'](_0x46c892(0x2a1))&&(_0x58229d[_0x46c892(0x2a1)]=_0x46c892(0x2d8),_0x3352f2=!![]);!_0x58229d[_0x46c892(0x1f9)](_0x46c892(0x1a5))&&(_0x58229d['onepagemode']=![],_0x3352f2=!![]);!_0x58229d[_0x46c892(0x1f9)](_0x46c892(0x242))&&(_0x58229d[_0x46c892(0x242)]='',_0x3352f2=!![]);if(_0x3352f2)storeSettings(_0x58229d);try{fs[_0x46c892(0x27d)](configbackuppath,{'withFileTypes':!![]})[_0x46c892(0xf0)](_0x48b319=>{const _0x188664=_0x46c892;if(!_0x48b319[_0x188664(0x1db)]()){if(!_0x48b319['name'][_0x188664(0xf2)]('backup-full@'))fs[_0x188664(0x1ad)](configbackuppath+_0x48b319['name']);}else fs[_0x188664(0x102)](configbackuppath+_0x48b319['name'],{'recursive':!![]});});}catch(_0x2f91e0){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x2f91e0);}}function storeConfiguration(_0x4d4c5c){const _0x232ab9=_0x237392;dbConfig[_0x232ab9(0x2aa)]('bots')[_0x232ab9(0x191)]()[_0x232ab9(0x2d5)](),dbConfig[_0x232ab9(0x2aa)](_0x232ab9(0x2d3))[_0x232ab9(0x278)](..._0x4d4c5c)[_0x232ab9(0x2d5)](),config=_0x4d4c5c;}async function resetPassword(){const _0x3d4250=_0x237392;if(tgBot&&settings[_0x3d4250(0x109)]){const _0x49905c=Markup[_0x3d4250(0x287)]([Markup['button']['callback']('yes',_0x3d4250(0x25b)),Markup[_0x3d4250(0x136)][_0x3d4250(0x19b)]('no',_0x3d4250(0x2c6))]);await sendTelegram(settings[_0x3d4250(0x109)],_0x3d4250(0xd4),_0x49905c),tgBot[_0x3d4250(0x276)](/resetpw_(.+)/,async _0x1dbeec=>{const _0x2461c5=_0x3d4250,_0x58141e=_0x1dbeec[_0x2461c5(0x139)][0x1];_0x1dbeec[_0x2461c5(0x1a8)]();if(_0x58141e!='no'){const _0xb2bae0=0xf,_0x1683d4=_0x2461c5(0x2d9),_0xf2de36=Array[_0x2461c5(0xcf)](crypto[_0x2461c5(0x1f2)](new Uint32Array(_0xb2bae0)))['map'](_0xf9e0da=>_0x1683d4[_0xf9e0da%_0x1683d4[_0x2461c5(0x21b)]])[_0x2461c5(0x14c)](''),_0x3c3b2d=bcrypt['hashSync'](_0xf2de36,saltRounds);storeSettings({'bbPassword':_0x3c3b2d}),await sendTelegram(_0x1dbeec[_0x2461c5(0x119)]['id'],_0x2461c5(0x2b9)+_0xf2de36,{'parse_mode':_0x2461c5(0x2c0)});}else await sendTelegram(_0x1dbeec['chat']['id'],_0x2461c5(0x1e8));});}}async function confirmRestore(_0x26d6fa,_0xed093a){const _0x45f49f=_0x237392;io['to'](_0x45f49f(0x194))[_0x45f49f(0x101)]('notification',_0x45f49f(0x293),_0x45f49f(0x1be));if(tgBot&&settings[_0x45f49f(0x109)]){const _0x186d75=uuidRandom();tmpStorage[_0x186d75]={'path':_0x26d6fa,'filename':_0xed093a};const _0x10001e=Markup[_0x45f49f(0x287)]([Markup['button']['callback'](_0x45f49f(0xf7),_0x45f49f(0x292)+_0x186d75),Markup['button']['callback']('no','restore_no_'+_0x186d75)]);await sendTelegram(settings[_0x45f49f(0x109)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x10001e),tgBot[_0x45f49f(0x276)](/restore_(.+)_(.+)/,async _0x4cb28a=>{const _0x2f7067=_0x45f49f,_0x5eb062=_0x4cb28a[_0x2f7067(0x139)][0x1],_0x2fe241=_0x4cb28a[_0x2f7067(0x139)][0x2],{path:_0x5513cd,filename:_0x32dc0e}=tmpStorage[_0x2fe241];delete tmpStorage[_0x2fe241],_0x4cb28a[_0x2f7067(0x1a8)](),_0x5eb062==_0x2f7067(0xf7)?(logger[_0x2f7067(0x223)](_0x2f7067(0x2af)),await sendTelegram(_0x4cb28a[_0x2f7067(0x119)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x2f7067(0x2c0)}),unzipFile(_0x5513cd,_0x32dc0e)):(logger[_0x2f7067(0x223)](_0x2f7067(0x206)),await sendTelegram(_0x4cb28a['chat']['id'],_0x2f7067(0x206)));});}}function getServerTime(){const _0x36a665=_0x237392,_0x5e3dfb=new Date();return _0x5e3dfb[_0x36a665(0x2bd)]()+'/'+(_0x5e3dfb['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x5e3dfb['getDate']()[_0x36a665(0x1f1)]()[_0x36a665(0x11d)](0x2,'0')+'\x20'+_0x5e3dfb[_0x36a665(0x148)]()['toString']()[_0x36a665(0x11d)](0x2,'0')+':'+_0x5e3dfb[_0x36a665(0x2d7)]()[_0x36a665(0x1f1)]()['padStart'](0x2,'0')+':'+_0x5e3dfb[_0x36a665(0x18e)]()[_0x36a665(0x1f1)]()[_0x36a665(0x11d)](0x2,'0');}function getTimeStamp(){const _0x29c0ea=_0x237392,_0xb634c7=shiftedTime();return _0xb634c7[_0x29c0ea(0x2bd)]()+'/'+(_0xb634c7[_0x29c0ea(0x2b1)]()+0x1)['toString']()[_0x29c0ea(0x11d)](0x2,'0')+'/'+_0xb634c7[_0x29c0ea(0x18a)]()[_0x29c0ea(0x1f1)]()[_0x29c0ea(0x11d)](0x2,'0')+'\x20'+_0xb634c7[_0x29c0ea(0x148)]()[_0x29c0ea(0x1f1)]()['padStart'](0x2,'0')+':'+_0xb634c7[_0x29c0ea(0x2d7)]()[_0x29c0ea(0x1f1)]()[_0x29c0ea(0x11d)](0x2,'0')+':'+_0xb634c7[_0x29c0ea(0x18e)]()['toString']()[_0x29c0ea(0x11d)](0x2,'0');}function getCleanTimeStamp(){const _0x2718b1=_0x237392,_0x5886ff=shiftedTime();return _0x5886ff['getFullYear']()+(_0x5886ff['getMonth']()+0x1)[_0x2718b1(0x1f1)]()[_0x2718b1(0x11d)](0x2,'0')+_0x5886ff['getDate']()['toString']()[_0x2718b1(0x11d)](0x2,'0')+'-'+_0x5886ff[_0x2718b1(0x148)]()[_0x2718b1(0x1f1)]()['padStart'](0x2,'0')+_0x5886ff[_0x2718b1(0x2d7)]()[_0x2718b1(0x1f1)]()[_0x2718b1(0x11d)](0x2,'0')+_0x5886ff[_0x2718b1(0x18e)]()[_0x2718b1(0x1f1)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x696bcb=_0x237392,_0x123f41=new Date();let _0x15fa2e=_0x123f41;if(settings['timeshift']&&settings[_0x696bcb(0x161)]!==0x0)_0x15fa2e=fns['add'](_0x123f41,{'hours':settings[_0x696bcb(0x161)]});return _0x15fa2e;}async function startScheduler(){const _0x1896c3=_0x237392,_0x4f3e46=new Date()[_0x1896c3(0xf8)](),_0x24fec5=shiftedTime()[_0x1896c3(0x148)]();_0x24fec5==0x4&&backupConfigFiles(),_0x24fec5==0x0&&(rotateLogFiles(),logger[_0x1896c3(0x223)]('--------------------------------------'),logger[_0x1896c3(0x223)](_0x1896c3(0x1df)+serverversion+_0x1896c3(0x16d)+(environment=='staging'?_0x1896c3(0x110):'')),logger['debug'](_0x1896c3(0x145))),_0x4f3e46%0x6==0x0&&triggerAnalytics(),_0x4f3e46%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0xc30d7c){const _0x32ee45=_0x237392;logger[_0x32ee45(0x223)](_0x32ee45(0x144)+_0xc30d7c);const _0xaa2a31=getBotsWithMode();_0xaa2a31[_0x32ee45(0x21b)]>0x0?confirmRestore(configbackuppath,_0xc30d7c):unzipFile(configbackuppath,_0xc30d7c);}async function getBackupFiles(_0x4d4f91=null){const _0x136193=_0x237392;let _0x15306e=[],_0x8b3338=fs[_0x136193(0x27d)](configbackuppath,{'withFileTypes':!![]});_0x8b3338[_0x136193(0x14a)]((_0x55f209,_0xd3a6cc)=>_0x55f209[_0x136193(0x1b7)]<_0xd3a6cc[_0x136193(0x1b7)]?0x1:_0xd3a6cc[_0x136193(0x1b7)]<_0x55f209['name']?-0x1:0x0),_0x8b3338[_0x136193(0xf0)](_0x5b75ca=>{const _0x3099a2=_0x136193;if(!_0x5b75ca['isDirectory']()&&_0x5b75ca[_0x3099a2(0x1b7)]['startsWith'](_0x3099a2(0x160))&&_0x5b75ca[_0x3099a2(0x1b7)]['endsWith'](_0x3099a2(0x1bd))){const _0xdc2fc0=formatDate(fs['statSync'](configbackuppath+_0x5b75ca[_0x3099a2(0x1b7)])['mtime']);_0x15306e[_0x3099a2(0x278)]({'name':_0x5b75ca[_0x3099a2(0x1b7)],'mtime':_0xdc2fc0});}});if(_0x4d4f91)io['to'](_0x4d4f91)[_0x136193(0x101)](_0x136193(0x115),_0x15306e);else return _0x15306e;}async function backupConfigFiles(){const _0x1ae876=_0x237392;await zipFiles('backup-full');const _0x38a2fc=getCleanTimeStamp();fs[_0x1ae876(0x238)](zippath+_0x1ae876(0x227),configbackuppath+(_0x1ae876(0x160)+_0x38a2fc+'.zip'));let _0x394db1=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x394db1[_0x1ae876(0x14a)]((_0x4c45bd,_0x4ad96e)=>_0x4c45bd[_0x1ae876(0x1b7)]<_0x4ad96e[_0x1ae876(0x1b7)]?0x1:_0x4ad96e[_0x1ae876(0x1b7)]<_0x4c45bd[_0x1ae876(0x1b7)]?-0x1:0x0),_0x394db1[_0x1ae876(0x21b)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x394db1[_0x394db1[_0x1ae876(0x21b)]-0x1][_0x1ae876(0x1b7)]);}function rotateLogFiles(){const _0x2cfe4c=_0x237392,_0x27b7b9=fs[_0x2cfe4c(0x2e5)](logspath+_0x2cfe4c(0x175)),_0x3bd70d=_0x27b7b9[_0x2cfe4c(0x2ce)]/0x400;if(_0x3bd70d>0x64){let _0x400344=fs[_0x2cfe4c(0x27d)](logspath,{'withFileTypes':!![]});_0x400344[_0x2cfe4c(0x14a)]((_0x4ae1e4,_0x54c9e9)=>_0x4ae1e4[_0x2cfe4c(0x1b7)]<_0x54c9e9['name']?0x1:_0x54c9e9[_0x2cfe4c(0x1b7)]<_0x4ae1e4[_0x2cfe4c(0x1b7)]?-0x1:0x0),_0x400344[_0x2cfe4c(0xf0)](_0x5eeb9e=>{const _0x46e079=_0x2cfe4c;if(_0x5eeb9e[_0x46e079(0x1b7)]==_0x46e079(0x210))fs[_0x46e079(0x238)](logspath+_0x5eeb9e[_0x46e079(0x1b7)],logspath+_0x46e079(0x258));if(_0x5eeb9e[_0x46e079(0x1b7)]==_0x46e079(0x237))fs['copyFileSync'](logspath+_0x5eeb9e[_0x46e079(0x1b7)],logspath+_0x46e079(0x210));_0x5eeb9e['name']==_0x46e079(0x175)&&(fs[_0x46e079(0x238)](logspath+_0x5eeb9e[_0x46e079(0x1b7)],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x5eeb9e['name'],''));});}}async function zipFiles(_0x2db63f){const _0x382cbe=_0x237392;let _0x3861ee;if(_0x2db63f=='logs')_0x3861ee=logspath;if(_0x2db63f==_0x382cbe(0x24d))_0x3861ee=configpath;if(_0x2db63f=='backup-full')_0x3861ee=configpath;let _0x467a35=fs[_0x382cbe(0x27d)](_0x3861ee,{'withFileTypes':!![]});const _0x1c9e02=new JSZip();_0x467a35['forEach'](_0x270da9=>{const _0x36b11e=_0x382cbe;if(!_0x270da9[_0x36b11e(0x1db)]()){let _0x37d686=fs[_0x36b11e(0x18c)](_0x3861ee+_0x270da9['name']);if(_0x2db63f==_0x36b11e(0x24d)){const _0x5ef327=/^bot-[0-9]{3}-config.json$/,_0x317794=_0x5ef327[_0x36b11e(0x272)](_0x270da9[_0x36b11e(0x1b7)]);if(_0x317794){const _0x22a7d0=JSON[_0x36b11e(0x26b)](_0x37d686);if(_0x22a7d0[_0x36b11e(0x124)][0x0]){_0x22a7d0[_0x36b11e(0x124)][0x0]['apiKey']=_0x36b11e(0x255),_0x22a7d0[_0x36b11e(0x124)][0x0][_0x36b11e(0x2c7)]=_0x36b11e(0x255);if(_0x22a7d0[_0x36b11e(0x124)][0x0][_0x36b11e(0x113)])_0x22a7d0[_0x36b11e(0x124)][0x0][_0x36b11e(0x113)]=_0x36b11e(0x255);}_0x37d686=JSON[_0x36b11e(0x2e6)](_0x22a7d0,null,0x2);}if(_0x270da9['name']==_0x36b11e(0x1e7)){const _0x459a5f=JSON[_0x36b11e(0x26b)](_0x37d686);if(_0x459a5f[_0x36b11e(0x1ec)]['loginRequired'])_0x459a5f[_0x36b11e(0x1ec)][_0x36b11e(0x2db)]=![];if(_0x459a5f[_0x36b11e(0x1ec)][_0x36b11e(0xf3)])_0x459a5f['settings']['bbPassword']=_0x36b11e(0x255);if(_0x459a5f[_0x36b11e(0x1ec)][_0x36b11e(0x16b)])_0x459a5f[_0x36b11e(0x1ec)][_0x36b11e(0x16b)]=_0x36b11e(0x255);if(_0x459a5f[_0x36b11e(0x1ec)][_0x36b11e(0x109)])_0x459a5f['settings']['telegramChatId']=null;if(_0x459a5f['settings'][_0x36b11e(0x242)])_0x459a5f['settings']['marketcapApi']=_0x36b11e(0x255);_0x37d686=JSON['stringify'](_0x459a5f,null,0x2);}if(_0x270da9[_0x36b11e(0x1b7)]!='bb-secure.json')_0x1c9e02[_0x36b11e(0x2b6)](_0x270da9[_0x36b11e(0x1b7)],_0x37d686);}else _0x1c9e02[_0x36b11e(0x2b6)](_0x270da9[_0x36b11e(0x1b7)],_0x37d686);}});const _0x53d719=await _0x1c9e02[_0x382cbe(0x251)]({'type':_0x382cbe(0x228),'base64':![],'compression':'DEFLATE'});fs[_0x382cbe(0x16c)](zippath+(_0x2db63f+_0x382cbe(0x1bd)),_0x53d719,_0x382cbe(0x11b));}async function unzipFile(_0x108112,_0x36a027){const _0x4ecc77=_0x237392;fs[_0x4ecc77(0x27d)](configpath,{'withFileTypes':!![]})[_0x4ecc77(0xf0)](_0x1b75aa=>{const _0x30af28=_0x4ecc77;if(!_0x1b75aa[_0x30af28(0x1db)]())fs[_0x30af28(0x102)](configpath+_0x1b75aa[_0x30af28(0x1b7)]);});const _0x4af2d3=fs[_0x4ecc77(0x18c)](_0x108112+_0x36a027,'binary'),_0x4af99b=await JSZip[_0x4ecc77(0x179)](_0x4af2d3,{'base64':![],'checkCRC32':!![]});for(const _0xf93a41 of Object[_0x4ecc77(0x1e4)](_0x4af99b[_0x4ecc77(0x24f)])){const _0x2a9862=_0x4af99b[_0x4ecc77(0x24f)][_0xf93a41],_0x519361=await _0x2a9862[_0x4ecc77(0x220)](_0x4ecc77(0x228));fs[_0x4ecc77(0x16c)](configpath+_0x2a9862[_0x4ecc77(0x1b7)],_0x519361);}fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x4ecc77(0xf0)](_0x47bb43=>{const _0x815b34=_0x4ecc77;if(!_0x47bb43[_0x815b34(0x1db)]())fs[_0x815b34(0x102)](temppath+_0x47bb43['name']);}),logger['debug'](_0x4ecc77(0x264)),process['send']({'restore':!![]},_0x27030e=>{});}async function getPublicIp(){const _0x586e09=_0x237392;try{const _0x56bc07=await axios['get'](_0x586e09(0x2ae));publicip=_0x56bc07[_0x586e09(0x259)]['ip'];}catch(_0x2405ce){}}async function triggerAnalytics(){const _0xd327d2=_0x237392;if(!publicip)await getPublicIp();const _0x5ee243=getBotsWithMode();let _0x1cba30=0x0;_0x5ee243[_0xd327d2(0xf0)](_0x2d2af8=>{const _0x1d6971=_0xd327d2;if(_0x2d2af8[_0x1d6971(0x2e7)]===_0x1d6971(0x20c))_0x1cba30++;});const _0x5be8ab=getBotExchanges();mixpanel['track'](_0xd327d2(0xed),{'distinct_id':settings[_0xd327d2(0x1a0)],'ip':publicip,'version':serverversion,'numbots':_0x5ee243['length'],'numbotsenabled':_0x1cba30,'exchanges':_0x5be8ab,'environment':environment});}async function getMessages(){const _0x529ea0=_0x237392,_0x2e1716='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x485d72=new GraphQLClient(_0x2e1716),_0x293780={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x37f0d1=serverversion[_0x529ea0(0x1a9)]('.'),_0xb39b06=_0x37f0d1[0x0]+'.'+_0x37f0d1[0x1],_0xfdd7b=Math['min'](settings[_0x529ea0(0x165)],settings[_0x529ea0(0x229)]),_0x39add0={'last':parseInt(_0xfdd7b),'bbm':_0xb39b06},_0x5567df=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3ada38;try{_0x3ada38=await _0x485d72[_0x529ea0(0x2b7)](_0x5567df,_0x39add0,_0x293780);}catch(_0x5d2ea8){}if(_0x3ada38&&_0x3ada38[_0x529ea0(0x1ee)]){let _0x380f81=settings[_0x529ea0(0x165)],_0x3daf0f=settings['lastmsgtelegram'];newMessages=[];for(const _0xce5462 of _0x3ada38['messages']){newMessages[_0x529ea0(0x278)](_0xce5462);let _0x333b26=![];_0xce5462[_0x529ea0(0x197)]&&(updateSetting(_0x529ea0(0x2a1),_0xce5462[_0x529ea0(0x197)]),_0x333b26=isNewerVersion(serverversion,_0xce5462[_0x529ea0(0x197)])||serverversion==_0xce5462[_0x529ea0(0x197)]);if(!_0x333b26&&_0xce5462[_0x529ea0(0x212)]>_0x380f81){if(_0xce5462['bbvReceive']===_0x529ea0(0xd6)||serverversion[_0x529ea0(0xf2)](_0xce5462[_0x529ea0(0x245)])){let _0x617eeb=''+_0xce5462[_0x529ea0(0x20f)]+'\x0a\x0a'+_0xce5462[_0x529ea0(0x117)];const _0x280771=await sendTelegramMsg(toTelegramMarkdown(_0x617eeb),_0x529ea0(0x1b4));_0x380f81=_0xce5462[_0x529ea0(0x212)];}}_0x3daf0f=_0xce5462[_0x529ea0(0x212)];}updateAvailable=isNewerVersion(settings[_0x529ea0(0x2a1)],serverversion),updateSetting(_0x529ea0(0x165),_0x3daf0f),emitMessages();}}function emitMessages(){const _0x3173a9=_0x237392,_0x5800c5=settings[_0x3173a9(0x229)];let _0x44cceb=[];newMessages['forEach'](_0x5abd71=>{const _0x24912f=_0x3173a9;_0x5abd71[_0x24912f(0x212)]>_0x5800c5&&_0x44cceb[_0x24912f(0x278)](_0x5abd71);}),_0x44cceb['length']>0x0&&getAllClients()[_0x3173a9(0xf0)](_0x39f15=>{getSocket(_0x39f15['id'])['emit']('message',_0x44cceb);});}function confirmMessage(_0x493504){updateSetting('lastmsgemitted',Number(_0x493504));}function isNewerVersion(_0x35e103,_0x440edd){const _0x5374cf=_0x237392,_0x4b22c7=_0x440edd[_0x5374cf(0x1a9)]('.'),_0x5a66d4=_0x35e103[_0x5374cf(0x1a9)]('.');for(var _0x9f2109=0x0;_0x9f2109<_0x5a66d4[_0x5374cf(0x21b)];_0x9f2109++){const _0x25b6eb=~~_0x5a66d4[_0x9f2109],_0x525f65=~~_0x4b22c7[_0x9f2109];if(_0x25b6eb>_0x525f65)return!![];if(_0x25b6eb<_0x525f65)return![];}return![];}function toTelegramMarkdown(_0x1c1fd8){const _0x297c43=_0x237392,_0x386ca9=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x20f2fb=/\*{2}(.+?)\*{2}/gim;return _0x1c1fd8=_0x1c1fd8[_0x297c43(0x146)](_0x386ca9,_0x297c43(0x218))[_0x297c43(0x146)](_0x20f2fb,_0x297c43(0x21d)),_0x1c1fd8;}async function validateConfigFile(){const _0x1de218=_0x237392,_0x275fe8=dbConfig['get'](_0x1de218(0x2d3))[_0x1de218(0x11f)](_0x1de218(0x1aa))[_0x1de218(0xfc)]()||[];if(_0x275fe8[_0x1de218(0x21b)]==0x0){let _0x110a70=0x0,_0x2cf74d=[];const _0x27c894=/^bot-([0-9]{3})-config.json$/,_0x53eb91=fs[_0x1de218(0x27d)](configpath);_0x53eb91[_0x1de218(0xf0)](_0x5e5436=>{const _0x26f17d=_0x1de218,_0x50c352=_0x27c894[_0x26f17d(0x279)](_0x5e5436);if(_0x50c352){const _0x4247fe=_0x50c352[0x1];let _0x9f3594=getBotAttributes(_0x4247fe);_0x2cf74d[_0x26f17d(0x278)]({'botID':_0x4247fe,'botname':_0x9f3594[_0x26f17d(0x10b)],'status':'disabled','live':'stopped'}),_0x110a70++;}}),_0x110a70!=0x0&&(dbConfig['get'](_0x1de218(0x2d3))[_0x1de218(0x14f)](_0x2cf74d)['write'](),config=_0x2cf74d,restoredConfigFile=_0x110a70);}}async function restoreConfigNotify(_0x29a75d){const _0x1ce1cb=_0x237392;let _0x45737f;if(restoredConfigFile==0x1)_0x45737f=_0x1ce1cb(0xe1);else _0x45737f=_0x1ce1cb(0x184);if(_0x29a75d)io['to']('botmanager')['emit'](_0x1ce1cb(0x2b8),_0x45737f);else{logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x1ce1cb(0x25d)](_0x45737f),logger[_0x1ce1cb(0x25d)]('-----------------------------------------------------------------------------------'),logger[_0x1ce1cb(0x25d)]('');if(tgBot&&settings[_0x1ce1cb(0x109)]&&settings[_0x1ce1cb(0x202)]!=_0x1ce1cb(0x1b6))await sendTelegram(settings[_0x1ce1cb(0x109)],'Bot\x20Mgr\x20>\x20'+_0x45737f);}}function decryptRSA(_0x30bf7a,_0x5f3bb7){const _0x3b1e36=_0x237392,_0x4fed36=forge[_0x3b1e36(0x2e3)][_0x3b1e36(0x1f6)](_0x30bf7a),_0x47c908=_0x4fed36[_0x3b1e36(0x2e1)](forge[_0x3b1e36(0x29e)][_0x3b1e36(0x1d5)](_0x5f3bb7),'RSA-OAEP',{'md':forge['md'][_0x3b1e36(0x1c6)][_0x3b1e36(0x234)](),'mgf1':{'md':forge['md']['sha256'][_0x3b1e36(0x234)]()}});return _0x47c908;}function validateCredentials(_0x3cf488,_0x5c7f40){const _0x24ea58=_0x237392;if(_0x3cf488['username']==settings['bbUsername']&&bcrypt[_0x24ea58(0x285)](_0x3cf488[_0x24ea58(0x1dd)],settings[_0x24ea58(0xf3)])){if(settings[_0x24ea58(0x116)])return{'allow':![],'reason':_0x24ea58(0x235),'token':null};else{const _0x30e7a5=generateLoginToken(_0x5c7f40);return{'allow':!![],'reason':_0x24ea58(0x1b5),'token':_0x30e7a5};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x5f14f9){const _0x49b65a=_0x237392,_0x225185=generateLoginToken(_0x5f14f9);return{'allow':!![],'reason':_0x49b65a(0x1b5),'token':_0x225185};}function validateAccess(_0x1102a8,_0x3a2a62,_0x1c0180){const _0x1b23a3=_0x237392,_0xb29611=_0x1c0180?_0x1c0180:devices[_0x3a2a62]['ip'];let _0x264347;const _0x46bcc2=_0x54c679=>{const _0x3804bb=_0x3402;if(settings[_0x3804bb(0x2db)]){if(settings[_0x3804bb(0x116)]){if(telegram2FaApproved(_0x3a2a62)){const _0x4ffbac=generateLoginToken(_0x3a2a62);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x4ffbac};}else return{'allow':![],'reason':_0x3804bb(0x164),'token':null};}else return _0x264347=validToken(_0x54c679,_0x3a2a62),_0x264347[_0x3804bb(0x1f9)]('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x54c679}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x1b23a3(0x204)]){let _0x430dbb=[...settings['whitelist'],'::1',_0x1b23a3(0x1c2),_0x1b23a3(0x207),'::ffff:7f00:1'];if(_0x430dbb[_0x1b23a3(0x23a)](_0xb29611))return _0x46bcc2(_0x1102a8);else{_0x264347=validToken(_0x1102a8,_0x3a2a62);if(_0x264347[_0x1b23a3(0x1f9)](_0x1b23a3(0x1be)))return _0x46bcc2(_0x1102a8);else{if(telegramIpApproved(_0x3a2a62)){const _0x5e5e29=generateToken(_0x3a2a62);return _0x264347=_0x46bcc2(_0x1102a8),_0x264347[_0x1b23a3(0x230)]?{'allow':!![],'reason':_0x1b23a3(0x1d7),'token':_0x5e5e29}:_0x264347;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x1b23a3(0x261),'token':null}:{'allow':![],'reason':_0x1b23a3(0x22c),'token':null};}}}else return _0x46bcc2(_0x1102a8);}function timelyDecrypt(_0xb3fae7,_0x452992,_0x5bfacd='@'){const _0x41d702=_0x237392;if(_0xb3fae7)try{const _0x222303=decryptRSA(secure[_0x41d702(0x1fb)],_0xb3fae7),_0x2d3792=_0x222303[_0x41d702(0x1a9)](_0x5bfacd)[0x0],_0x48048b=_0x222303['split'](_0x5bfacd)[0x1],_0x40a7ec=new Date()[_0x41d702(0x16a)]();if(_0x452992){if(_0x40a7ec-_0x48048b<maxSecretAge*0x3e8)return _0x2d3792;else return![];}else return _0x2d3792;}catch(_0xa055e0){return![];}else return![];}const validToken=(_0x29a387,_0x381f08)=>{const _0x2fb40e=_0x237392,_0x2186b4=devices[_0x381f08]['ip'];if(!_0x29a387)return{'error':_0x2fb40e(0x1bf)};for(let _0x3a5fe3 of blacklist){if(_0x3a5fe3[_0x2fb40e(0x247)]==_0x29a387)return{'error':'Token\x20blacklisted'};}let _0x661bac;try{_0x661bac=jwt[_0x2fb40e(0x174)](_0x29a387,secure['secret']+_0x381f08);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x661bac[_0x2fb40e(0x1f9)](_0x2fb40e(0xd0))&&!_0x661bac['hasOwnProperty'](_0x2fb40e(0x2cf))||!_0x661bac[_0x2fb40e(0x1f9)](_0x2fb40e(0x2be)))return{'error':_0x2fb40e(0x126)};if(!_0x661bac[_0x2fb40e(0x1f9)]('username')&&_0x661bac['hasOwnProperty'](_0x2fb40e(0xd0))){const {clientip:_0x34a0e1}=_0x661bac;return _0x2186b4==_0x34a0e1?{'success':_0x2fb40e(0x14e)}:{'error':_0x2fb40e(0x1e3)};}else{if(_0x661bac[_0x2fb40e(0x1f9)](_0x2fb40e(0x2cf))&&_0x661bac[_0x2fb40e(0x1f9)]('clientip')){const {username:_0x5edde7,clientip:_0x48eaaa}=_0x661bac;return settings['bbUsername']==_0x5edde7&&_0x2186b4==_0x48eaaa?{'success':_0x2fb40e(0x14e)}:{'error':_0x2fb40e(0xfd)};}}},generateLoginToken=_0x2655f1=>{const _0x56c95b=_0x237392;if(_0x2655f1){const _0x1dcaf1=devices[_0x2655f1]['ip'];return jwt[_0x56c95b(0x173)]({'username':settings[_0x56c95b(0x1bb)],'clientip':_0x1dcaf1},secure[_0x56c95b(0x295)]+_0x2655f1,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0xc4bc31=>{const _0x2e4d95=_0x237392;if(_0xc4bc31){const _0x379f42=devices[_0xc4bc31]['ip'];return jwt[_0x2e4d95(0x173)]({'clientip':_0x379f42},secure['secret']+_0xc4bc31,{'expiresIn':devices[_0xc4bc31]['telegramIpApproval'][_0x2e4d95(0xf9)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0xa9ecc1=>{const _0x8e96c3=_0x237392;let _0x34463f=![];return devices[_0xa9ecc1][_0x8e96c3(0x1cd)]&&devices[_0xa9ecc1][_0x8e96c3(0x1cd)][_0x8e96c3(0xf9)]!=_0x8e96c3(0x284)&&(_0x34463f=devices[_0xa9ecc1][_0x8e96c3(0x1cd)][_0x8e96c3(0xd0)]==devices[_0xa9ecc1]['ip']&&new Date()['getTime']()-devices[_0xa9ecc1][_0x8e96c3(0x1cd)]['timestamp']<devices[_0xa9ecc1][_0x8e96c3(0x1cd)][_0x8e96c3(0xf9)]*0x3c*0x3e8),_0x34463f;},telegram2FaApproved=_0x2381b7=>{const _0x10e851=_0x237392;let _0x4527d4=![];return devices[_0x2381b7][_0x10e851(0x12c)]&&devices[_0x2381b7][_0x10e851(0x12c)][_0x10e851(0xf9)]!='reject'&&(_0x4527d4=devices[_0x2381b7]['telegram2FaApproval'][_0x10e851(0xd0)]==devices[_0x2381b7]['ip']&&new Date()[_0x10e851(0x16a)]()-devices[_0x2381b7]['telegram2FaApproval'][_0x10e851(0x19c)]<devices[_0x2381b7]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x4527d4;},normalizeIP=_0x4153dc=>{const _0x23dce7=_0x237392;let _0x2f4ce7=null,_0xecc9e8=null;if(ipaddr[_0x23dce7(0x172)](_0x4153dc)){const _0x41294b=ipaddr[_0x23dce7(0x26b)](_0x4153dc);_0x41294b[_0x23dce7(0x28b)]()===_0x23dce7(0xfb)?(_0x41294b[_0x23dce7(0x11c)]()&&(_0x2f4ce7=_0x41294b[_0x23dce7(0x298)]()['toString']()),_0xecc9e8=_0x41294b[_0x23dce7(0x1f1)]()):(_0x2f4ce7=_0x41294b[_0x23dce7(0x1f1)](),_0xecc9e8=_0x41294b[_0x23dce7(0x22d)]()[_0x23dce7(0x1f1)]());}return{'show':_0x2f4ce7?_0x2f4ce7:_0xecc9e8,'store':_0xecc9e8};};function formatDate(_0x37e8da){const _0x146887=_0x237392;return _0x37e8da[_0x146887(0x2bd)]()+'/'+(_0x37e8da[_0x146887(0x2b1)]()+0x1)[_0x146887(0x1f1)]()[_0x146887(0x11d)](0x2,'0')+'/'+_0x37e8da['getDate']()['toString']()[_0x146887(0x11d)](0x2,'0')+'\x20'+_0x37e8da[_0x146887(0x148)]()[_0x146887(0x1f1)]()[_0x146887(0x11d)](0x2,'0')+':'+_0x37e8da[_0x146887(0x2d7)]()[_0x146887(0x1f1)]()[_0x146887(0x11d)](0x2,'0')+':'+_0x37e8da['getSeconds']()[_0x146887(0x1f1)]()[_0x146887(0x11d)](0x2,'0');}function sleep(_0x4993b8){return new Promise(_0x2c6537=>setTimeout(_0x2c6537,_0x4993b8));}