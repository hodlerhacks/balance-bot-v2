const _0x6371da=_0x2e16;(function(_0x55bbe3,_0x102f19){const _0x58972e=_0x2e16,_0x3a0214=_0x55bbe3();while(!![]){try{const _0x5d0f89=parseInt(_0x58972e(0x1ae))/0x1+-parseInt(_0x58972e(0x254))/0x2+-parseInt(_0x58972e(0x345))/0x3+-parseInt(_0x58972e(0x37b))/0x4+parseInt(_0x58972e(0x230))/0x5+-parseInt(_0x58972e(0x1cf))/0x6*(parseInt(_0x58972e(0x2eb))/0x7)+parseInt(_0x58972e(0x316))/0x8;if(_0x5d0f89===_0x102f19)break;else _0x3a0214['push'](_0x3a0214['shift']());}catch(_0x289284){_0x3a0214['push'](_0x3a0214['shift']());}}}(_0x5088,0xe101c));const _0x21c5bb=function(){let _0x120fb3=!![];return function(_0x3c8cf0,_0xcd2467){const _0x214a70=_0x120fb3?function(){const _0x19f14=_0x2e16;if(_0xcd2467){const _0x3cf2d3=_0xcd2467[_0x19f14(0x34c)](_0x3c8cf0,arguments);return _0xcd2467=null,_0x3cf2d3;}}:function(){};return _0x120fb3=![],_0x214a70;};}(),_0x58c767=_0x21c5bb(this,function(){const _0x3bee4e=_0x2e16;return _0x58c767['toString']()['search']('(((.+)+)+)+$')[_0x3bee4e(0x28d)]()[_0x3bee4e(0x3a1)](_0x58c767)[_0x3bee4e(0x2f0)](_0x3bee4e(0x296));});_0x58c767();'use strict';process[_0x6371da(0x1d8)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x6371da(0x273)),fs=require('fs'),fns=require(_0x6371da(0x1d7)),low=require(_0x6371da(0x323)),FileSync=require(_0x6371da(0x31c)),path=require(_0x6371da(0x2de)),crypto=require(_0x6371da(0x23f)),forge=require(_0x6371da(0x1df)),bcrypt=require('bcryptjs'),jwt=require(_0x6371da(0x194)),ipaddr=require(_0x6371da(0x3a0)),yargs=require('yargs'),uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x6371da(0x27c)),Mixpanel=require(_0x6371da(0x2d9)),axios=require('axios'),{GraphQLClient,gql}=require(_0x6371da(0x39a)),util=require(_0x6371da(0x2e3)),fileUpload=require(_0x6371da(0x21b)),{networkInterfaces}=require('os'),JSZip=require(_0x6371da(0x1f8)),argv=yargs(process['argv'][_0x6371da(0x2b4)](0x2))[_0x6371da(0x1e5)],PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x6371da(0x32e)](PORT)&&(console[_0x6371da(0x38d)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x6371da(0x300)),process[_0x6371da(0x294)](0x1));const HOST=argv[_0x6371da(0x2c1)]||null,userID=argv[_0x6371da(0x35d)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process['versions'][_0x6371da(0x3a2)];let bbpath='bb/',bbpath2='';const botfile=_0x6371da(0x3a6),configfile='bb-config.json',settingsfile=_0x6371da(0x1ea),securefile=_0x6371da(0x2ef),environment=require('./'+bbpath2+'version.json')[_0x6371da(0x360)]||_0x6371da(0x346),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x6371da(0x313)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x6371da(0x30c)),configpath=userID?bbpath+_0x6371da(0x354)+userID+'/':bbpath+_0x6371da(0x354),configbackuppath=configpath+_0x6371da(0x279),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x6371da(0x217),zippath=userID?bbpath+_0x6371da(0x299)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x6371da(0x2d6)](logspath+_0x6371da(0x191),{'flags':'a'}),temppath=userID?bbpath+_0x6371da(0x35a)+userID+'/':bbpath+_0x6371da(0x35a);!fs[_0x6371da(0x313)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x6371da(0x313)](configbackuppath)&&fs[_0x6371da(0x190)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x6371da(0x190)](logspath);!fs[_0x6371da(0x313)](zippath)&&fs['mkdirSync'](zippath);!fs['existsSync'](temppath)&&fs[_0x6371da(0x190)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x6371da(0x1a9)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x6371da(0x2c8),'onepagemode':![],'marketcapApi':''}})[_0x6371da(0x2fe)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x6371da(0x1a9)]({'secure':{},'blacklist':[]})[_0x6371da(0x2fe)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x6371da(0x283)](_0x6371da(0x363),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x6371da(0x1f9)]&&(settings[_0x6371da(0x1f9)]!=''&&settings[_0x6371da(0x1f9)]!=_0x6371da(0x237))&&settings[_0x6371da(0x2f4)]&&settings[_0x6371da(0x2f4)]!='')initTelegram();const parseColor=(_0x123fd5,_0x4dfee4)=>{const _0x2c0da1=_0x6371da,_0x432063=/#[A-Z]{3}#/g;if(typeof _0x123fd5==_0x2c0da1(0x1a6)){!_0x4dfee4?_0x123fd5=_0x123fd5[_0x2c0da1(0x27a)](_0x432063,''):(_0x123fd5=_0x123fd5[_0x2c0da1(0x27a)](/#BLU#/g,_0x2c0da1(0x202)),_0x123fd5=_0x123fd5[_0x2c0da1(0x27a)](/#RED#/g,_0x2c0da1(0x337)),_0x123fd5=_0x123fd5['replace'](/#YEL#/g,_0x2c0da1(0x36e)),_0x123fd5=_0x123fd5[_0x2c0da1(0x27a)](/#MAG#/g,_0x2c0da1(0x2c2)),_0x123fd5=_0x123fd5['replace'](/#CYA#/g,_0x2c0da1(0x21a)),_0x123fd5=_0x123fd5[_0x2c0da1(0x27a)](/#RES#/g,_0x2c0da1(0x2fa)));;}return _0x123fd5;},logger={'screen':_0x4816ca=>{console['log'](parseColor(_0x4816ca,!![]));},'simple':_0x274d1b=>{const _0xb44567=_0x6371da;console[_0xb44567(0x38d)](parseColor(_0x274d1b,!![])),loggerfile[_0xb44567(0x2fe)](util[_0xb44567(0x1ce)](parseColor(_0x274d1b,![]))+'\x0a');},'full':async _0x49fbd9=>{const _0x556825=_0x6371da,_0x24ed3c=getTimeStamp()+_0x556825(0x264)+_0x49fbd9;console[_0x556825(0x38d)](parseColor(_0x24ed3c,!![])),loggerfile[_0x556825(0x2fe)](util['format'](parseColor(_0x24ed3c,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x556825(0x245)]!=_0x556825(0x33f))await sendTelegram(settings[_0x556825(0x1f0)],_0x556825(0x31e)+parseColor(_0x49fbd9,![]));},'debug':async(_0x17fb2d,_0x3c2394='')=>{const _0x3d5668=_0x6371da,_0x5e91b7=getTimeStamp()+_0x3d5668(0x301)+_0x17fb2d;if(debugging)console[_0x3d5668(0x38d)](parseColor(_0x5e91b7,!![]));loggerfile[_0x3d5668(0x2fe)](util['format'](parseColor(_0x5e91b7,![]))+'\x0a');if(_0x3c2394){if(debugging)console[_0x3d5668(0x38d)](_0x3c2394);loggerfile['write'](util[_0x3d5668(0x1ce)](_0x3c2394)+'\x0a');}}};let terminating=![];process['on'](_0x6371da(0x331),function(_0x339799){const _0x4e5072=_0x6371da;_0x339799[_0x4e5072(0x28d)]()[_0x4e5072(0x309)]('address\x20already\x20in\x20use')?(logger[_0x4e5072(0x192)](_0x4e5072(0x2ad)+_0x339799[_0x4e5072(0x25e)]+_0x4e5072(0x3a5)),process[_0x4e5072(0x29a)]({'terminate':!![]},_0x3d1e1a=>{})):logger[_0x4e5072(0x192)](_0x339799);}),process['on'](_0x6371da(0x294),()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGTERM',()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGINT',()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x6371da(0x1d2))[_0x6371da(0x34e)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x6371da(0x261)),app=express(),http=require(_0x6371da(0x397))['createServer'](app);app[_0x6371da(0x193)](fileUpload({'useTempFiles':!![]})),app[_0x6371da(0x2f7)]('/download/:type',async(_0x4275fe,_0x51468b)=>{const _0x123230=_0x6371da,_0x4f7565=_0x4275fe['params'][_0x123230(0x390)],_0x55666a=getClientsWithBotID(_0x123230(0x28b)),_0xabf511=_0x4275fe['headers'][_0x123230(0x234)],_0x5465b0=timelyDecrypt(_0xabf511,![]),_0x56302b=_0x55666a[_0x123230(0x322)](_0x7857e7=>_0x7857e7[_0x123230(0x234)]==_0x5465b0);if(_0x56302b){const _0x1ca03f=normalizeIP(_0x4275fe[_0x123230(0x1c6)][_0x123230(0x24f)])[_0x123230(0x2d1)],_0x4dd443=_0x4275fe[_0x123230(0x29f)]['tkn'];if(validateAccess(_0x4dd443,_0x5465b0,_0x1ca03f)[_0x123230(0x358)])_0x4f7565=='backup'&&await backupConfigFiles(),await zipFiles(_0x4f7565),_0x51468b[_0x123230(0x2f9)](zippath+(_0x4f7565+'.zip'),_0x444e63=>{const _0x4536db=_0x123230;_0x444e63&&(logger[_0x4536db(0x2e8)](_0x4536db(0x332)+_0x4f7565),logger['simple'](_0x444e63));});else logger[_0x123230(0x2e8)](_0x123230(0x19b)+_0x4f7565+'\x20(1)');}else logger['full'](_0x123230(0x19b)+_0x4f7565+'\x20(2)');}),app['post']('/upload-backup',async(_0x2f849a,_0x44dda4)=>{const _0x3d7f51=_0x6371da,_0x1b9b47=getClientsWithBotID(_0x3d7f51(0x28b)),_0x949f62=_0x2f849a[_0x3d7f51(0x29f)][_0x3d7f51(0x234)],_0x4480a7=timelyDecrypt(_0x949f62,![]),_0x30362c=_0x1b9b47['find'](_0x5e0354=>_0x5e0354[_0x3d7f51(0x234)]==_0x4480a7);logger[_0x3d7f51(0x1b7)](_0x3d7f51(0x2ff));if(_0x30362c){const _0x2fdcd1=normalizeIP(_0x2f849a[_0x3d7f51(0x1c6)]['remoteAddress'])[_0x3d7f51(0x2d1)],_0x397520=_0x2f849a[_0x3d7f51(0x29f)][_0x3d7f51(0x232)];if(validateAccess(_0x397520,_0x4480a7,_0x2fdcd1)[_0x3d7f51(0x358)]){if(_0x2f849a['files']){const _0x46a920=_0x2f849a[_0x3d7f51(0x2d2)]['backupfile'];await _0x46a920['mv'](temppath+_0x46a920[_0x3d7f51(0x1c5)]),_0x44dda4[_0x3d7f51(0x29a)]({'status':!![],'message':_0x3d7f51(0x2bb)});const _0x586064=getBotsWithMode();_0x586064[_0x3d7f51(0x285)]>0x0?confirmRestore(temppath,_0x46a920[_0x3d7f51(0x1c5)]):unzipFile(temppath,_0x46a920[_0x3d7f51(0x1c5)]);}}else logger['full'](_0x3d7f51(0x382));}else logger[_0x3d7f51(0x2e8)](_0x3d7f51(0x1b9));}),app[_0x6371da(0x193)](express[_0x6371da(0x280)](path[_0x6371da(0x236)](__dirname,bbpath2,_0x6371da(0x2d8)))),app[_0x6371da(0x193)](express[_0x6371da(0x280)](path[_0x6371da(0x236)](__dirname,bbpath2,_0x6371da(0x229)))),app[_0x6371da(0x2f7)]('/',function(_0x42101b,_0x53ce14){const _0x43db88=_0x6371da;_0x53ce14['sendFile'](path[_0x43db88(0x236)](__dirname,bbpath2,_0x43db88(0x2d8),'index.html'));}),app[_0x6371da(0x2f7)]('/:bot',function(_0x54e05b,_0x2db2d8){const _0x2ad634=_0x6371da;_0x2db2d8['sendFile'](path[_0x2ad634(0x236)](__dirname,bbpath2,_0x2ad634(0x229),_0x2ad634(0x1a1)));}),app['get']('/:bot/portfolio',(_0x1f1f84,_0x40d6ab)=>{const _0x1aab99=_0x6371da;_0x40d6ab[_0x1aab99(0x2cb)](path[_0x1aab99(0x236)](__dirname,bbpath2,'build',_0x1aab99(0x1a1)));}),app[_0x6371da(0x2f7)](_0x6371da(0x304),(_0x565052,_0x143cce)=>{const _0x39163c=_0x6371da;_0x143cce[_0x39163c(0x2cb)](path['join'](__dirname,bbpath2,_0x39163c(0x229),'index.html'));}),app[_0x6371da(0x2f7)]('/:bot/coins',(_0x1db33b,_0x504b87)=>{const _0x232fe4=_0x6371da;_0x504b87['sendFile'](path[_0x232fe4(0x236)](__dirname,bbpath2,_0x232fe4(0x229),_0x232fe4(0x1a1)));}),app[_0x6371da(0x2f7)]('/:bot/history',(_0x2fcb9f,_0x3ec6a8)=>{const _0x38cf14=_0x6371da;_0x3ec6a8[_0x38cf14(0x2cb)](path[_0x38cf14(0x236)](__dirname,bbpath2,_0x38cf14(0x229),_0x38cf14(0x1a1)));}),app['get'](_0x6371da(0x35b),(_0x2b1b61,_0x24249b)=>{const _0x551fee=_0x6371da;_0x24249b[_0x551fee(0x2cb)](path['join'](__dirname,bbpath2,'build',_0x551fee(0x1a1)));}),app['get'](_0x6371da(0x20c),(_0x47f01a,_0x29c148)=>{const _0x1791cf=_0x6371da;_0x29c148[_0x1791cf(0x2cb)](path[_0x1791cf(0x236)](__dirname,bbpath2,'build','index.html'));});if(HOST)http[_0x6371da(0x1b6)](PORT,HOST);else http[_0x6371da(0x1b6)](PORT);const io=require('socket.io')(http,{});openBrowser&&(async()=>{const _0xce2f41=_0x6371da,{default:_0x30f030}=await import(_0xce2f41(0x30a));await _0x30f030(_0xce2f41(0x2b9)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0xbf2729=_0x6371da;let _0x3fbe69=_0xbf2729(0x1e1);const _0x27f5c8=networkInterfaces(),_0x31f2a2={};for(const _0x1efa96 of Object[_0xbf2729(0x38e)](_0x27f5c8)){for(const _0x3e099a of _0x27f5c8[_0x1efa96]){if((_0x3e099a[_0xbf2729(0x1ab)]==_0xbf2729(0x21f)||_0x3e099a[_0xbf2729(0x1ab)]==0x4)&&!_0x3e099a[_0xbf2729(0x20e)]){const _0x548917=ipaddr[_0xbf2729(0x1eb)](_0x3e099a[_0xbf2729(0x19c)])[_0xbf2729(0x26c)]();_0x548917!=_0xbf2729(0x359)&&(!_0x31f2a2[_0x1efa96]&&(_0x31f2a2[_0x1efa96]=[]),_0x31f2a2[_0x1efa96][_0xbf2729(0x38b)](_0x3e099a[_0xbf2729(0x19c)]),_0x3fbe69=_0x3e099a[_0xbf2729(0x19c)]);}}}return{'serverip':_0x3fbe69,'netinterfaces':_0x31f2a2};}async function startServer(){const _0x10a3f2=_0x6371da,{serverip:_0x389180,netinterfaces:_0x329299}=getServerIP();logger[_0x10a3f2(0x192)](''),logger[_0x10a3f2(0x192)](_0x10a3f2(0x282)),await logger[_0x10a3f2(0x2e8)](_0x10a3f2(0x216)+serverversion+_0x10a3f2(0x1bd)+(environment=='staging'?_0x10a3f2(0x2c3):'')+'\x0a'+(_0x10a3f2(0x353)+PORT+_0x10a3f2(0x23a))+(_0x10a3f2(0x334)+_0x389180+':'+PORT+_0x10a3f2(0x38c))),logger['simple'](_0x10a3f2(0x282));if(config[_0x10a3f2(0x285)]!=0x0)for(const _0x5a5103 of config){const _0x2ec545=_0x5a5103[_0x10a3f2(0x27e)]==_0x10a3f2(0x367)?'a':'m';if(_0x5a5103['status']==_0x10a3f2(0x2f3)||_0x5a5103['status']==_0x10a3f2(0x2bd))await logger[_0x10a3f2(0x2e8)](_0x10a3f2(0x25f)+_0x2ec545+')\x20|\x20Bot\x20'+_0x5a5103['botID']+_0x10a3f2(0x2f6)+_0x5a5103['botname']),startBot([_0x5a5103[_0x10a3f2(0x350)],userID],{'cwd':bbpath},function(_0x58773f){if(_0x58773f)logger['full'](_0x58773f);});else(_0x5a5103['status']=='disabled'||_0x5a5103[_0x10a3f2(0x348)]=='new-disabled')&&await logger[_0x10a3f2(0x2e8)](_0x10a3f2(0x20d)+_0x2ec545+_0x10a3f2(0x381)+_0x5a5103[_0x10a3f2(0x350)]+_0x10a3f2(0x2f6)+_0x5a5103[_0x10a3f2(0x1e3)]);}else!newBot&&logger['simple'](_0x10a3f2(0x208));if(newBot)addBot();logger[_0x10a3f2(0x192)](_0x10a3f2(0x282)),logger[_0x10a3f2(0x192)](''),await logger[_0x10a3f2(0x1b7)](_0x10a3f2(0x244)+nodeversion),await logger[_0x10a3f2(0x1b7)]('Network\x20Interfaces:',_0x329299);}function startSocket(){const _0x26b58b=_0x6371da;io['on'](_0x26b58b(0x373),_0xd56891=>{const _0x5ed61b=_0x26b58b;let _0x29d8f6,_0x2444ff,_0x5a8e45,_0x543a63,_0x325465;const _0x5ac0c8=_0xd56891[_0x5ed61b(0x1f3)][_0x5ed61b(0x29f)][_0x5ed61b(0x19e)];_0x2444ff=_0x5ac0c8[_0x5ed61b(0x36a)](/bot[0-9]{3}/);if(_0x2444ff)_0x5a8e45=_0x2444ff[0x0][_0x5ed61b(0x36a)](/[0-9]{3}/);if(_0x5a8e45)_0x29d8f6=_0x5a8e45[0x0];else _0x29d8f6='botmanager';const _0x1110c9=_0xd56891[_0x5ed61b(0x1f3)][_0x5ed61b(0x27b)][_0x5ed61b(0x195)];if(!_0x1110c9)_0xd56891[_0x5ed61b(0x287)]('status',{'publicKey':secure[_0x5ed61b(0x200)]});else{_0x543a63=timelyDecrypt(_0x1110c9,![]);if(!_0x543a63)_0xd56891[_0x5ed61b(0x287)](_0x5ed61b(0x348),{'publicKey':secure[_0x5ed61b(0x200)]});else{_0x325465=normalizeIP(_0xd56891[_0x5ed61b(0x225)][_0x5ed61b(0x24f)])[_0x5ed61b(0x2d1)];if(!devices[_0x543a63])devices[_0x543a63]={'uuid':_0x543a63,'access':{'token':null}};devices[_0x543a63]['ip']=_0x325465;const _0x3b1c6a=addClient(_0xd56891['id'],_0x543a63,_0x29d8f6);setAccess(_0x3b1c6a),emitMessages(),_0xd56891['on'](_0x5ed61b(0x39e),_0x3e6e62=>{const _0x4e1a2d=_0x5ed61b,_0x2a9f89=timelyDecrypt(_0x3e6e62[_0x4e1a2d(0x291)],!![],'|@|');if(_0x2a9f89){_0x3e6e62={'username':_0x3e6e62[_0x4e1a2d(0x384)],'password':_0x2a9f89},devices[_0x543a63][_0x4e1a2d(0x2a0)]=validateCredentials(_0x3e6e62,_0x543a63);if(devices[_0x543a63][_0x4e1a2d(0x2a0)][_0x4e1a2d(0x358)]==![]&&devices[_0x543a63]['access'][_0x4e1a2d(0x1a2)]==_0x4e1a2d(0x37a))_0xd56891[_0x4e1a2d(0x287)](_0x4e1a2d(0x348),{'access':devices[_0x543a63][_0x4e1a2d(0x2a0)]}),loginAccess2FA(_0x543a63,_0x325465);else{if(devices[_0x543a63][_0x4e1a2d(0x2a0)]['allow']==![]&&devices[_0x543a63]['access']['reason']==_0x4e1a2d(0x243))_0xd56891['emit']('status',{'access':devices[_0x543a63][_0x4e1a2d(0x2a0)]});else devices[_0x543a63][_0x4e1a2d(0x2a0)]['allow']&&devices[_0x543a63]['access'][_0x4e1a2d(0x1a2)]==_0x4e1a2d(0x21e)&&(getClientsWithUuid(_0x543a63)[_0x4e1a2d(0x1c4)](_0x3b317f=>{setAccess(_0x3b317f);}),logger[_0x4e1a2d(0x1b7)](_0x4e1a2d(0x256)+_0x543a63[_0x4e1a2d(0x2b4)](-0x8)),setTokenRefresh(_0x543a63),setSessionTimeout(_0x4e1a2d(0x39e),_0x543a63));}}else logger[_0x4e1a2d(0x2e8)](_0x4e1a2d(0x1d0));}),_0xd56891['on']('reset-password',()=>{resetPassword();}),_0xd56891['on'](_0x5ed61b(0x1ef),_0x1bf45a=>{removeClient(_0xd56891['id']);}),_0x29d8f6==_0x5ed61b(0x28b)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4a6968){const _0x1e647e=_0x6371da;if(_0x4a6968!='botmanager'&&config[_0x1e647e(0x284)]!=''){if(pid[_0x4a6968])pid[_0x4a6968][_0x1e647e(0x29a)]({'function':'initclient','args':null});}_0x4a6968!=_0x1e647e(0x28b)&&broadcastToBots(_0x1e647e(0x219),JSON[_0x1e647e(0x2d4)](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0x41db26=>{const _0x2f2794=_0x2e16;getSocket(_0x41db26['id'])[_0x2f2794(0x287)](_0x2f2794(0x348),{'access':{'allow':![],'reason':_0x2f2794(0x26b),'token':null}});});}function getSocket(_0x1fba02){const _0x15d8d8=_0x6371da,_0x58c0cf=io['_nsps'][_0x15d8d8(0x2f7)]('/');return _0x58c0cf[_0x15d8d8(0x1c8)][_0x15d8d8(0x2f7)](_0x1fba02);}function setAccess(_0x23d888){const _0x4e8184=_0x6371da,_0xbfdf00=getSocket(_0x23d888['id']),_0x25be75=_0x23d888[_0x4e8184(0x234)],_0x1cef9e=_0x23d888[_0x4e8184(0x215)];devices[_0x25be75]['access']=validateAccess(devices[_0x25be75][_0x4e8184(0x2a0)]['token'],_0x25be75),logger[_0x4e8184(0x1b7)](_0x4e8184(0x391)+devices[_0x25be75]['access'][_0x4e8184(0x1a2)]+_0x4e8184(0x35c)+_0x23d888['id']['slice'](-0x8)+_0x4e8184(0x333)+_0x25be75[_0x4e8184(0x2b4)](-0x8)),_0xbfdf00[_0x4e8184(0x236)](_0x25be75);if(devices[_0x25be75][_0x4e8184(0x2a0)][_0x4e8184(0x358)]){_0xbfdf00['join'](_0x1cef9e);if(_0x1cef9e==_0x4e8184(0x28b))initializeSocketBotManager(_0xbfdf00);else initializeSocketBot(_0xbfdf00);initClient(_0x1cef9e);}devices[_0x25be75]['access']['token']&&devices[_0x25be75][_0x4e8184(0x2a0)]['reason']==_0x4e8184(0x1f5)&&setSessionTimeout(_0x4e8184(0x1a7),_0x25be75),devices[_0x25be75][_0x4e8184(0x2a0)][_0x4e8184(0x39c)]&&devices[_0x25be75][_0x4e8184(0x2a0)][_0x4e8184(0x1a2)]==_0x4e8184(0x240)&&setSessionTimeout('login',_0x25be75),_0xbfdf00[_0x4e8184(0x287)](_0x4e8184(0x348),{'status':_0x23d888[_0x4e8184(0x1a3)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x25be75][_0x4e8184(0x2a0)],'externalip':devices[_0x25be75]['ip'],'publicKey':secure[_0x4e8184(0x200)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x25be75][_0x4e8184(0x2a0)][_0x4e8184(0x358)]==![]&&devices[_0x25be75][_0x4e8184(0x2a0)][_0x4e8184(0x1a2)]==_0x4e8184(0x19f)&&temporaryAccess2FA(_0x25be75,devices[_0x25be75]['ip']);}function setSessionTimeout(_0x5f0c33,_0x71365a){const _0x569c1f=_0x6371da;let _0x1a4462;if(_0x5f0c33==_0x569c1f(0x39e))_0x1a4462=loginExpiry*0x3c*0x3e8;else _0x1a4462=devices[_0x71365a][_0x569c1f(0x1a8)][_0x569c1f(0x37c)]*0x3c*0x3e8-(new Date()[_0x569c1f(0x1f6)]()-devices[_0x71365a][_0x569c1f(0x1a8)][_0x569c1f(0x33e)]);if(devices[_0x71365a][_0x569c1f(0x298)])clearTimeout(devices[_0x71365a][_0x569c1f(0x298)]);devices[_0x71365a][_0x569c1f(0x298)]=setTimeout(()=>{const _0x2581f5=_0x569c1f;if(devices[_0x71365a][_0x2581f5(0x22a)])clearTimeout(devices[_0x71365a][_0x2581f5(0x22a)]);removeSocketListeners(_0x71365a),addBlacklist(_0x71365a),devices[_0x71365a][_0x2581f5(0x1a8)]=null,devices[_0x71365a][_0x2581f5(0x34a)]=null,devices[_0x71365a][_0x2581f5(0x2a0)][_0x2581f5(0x39c)]=null,logger['debug'](_0x2581f5(0x324)+_0x71365a['slice'](-0x8)),devices[_0x71365a][_0x2581f5(0x2a0)]=validateAccess(devices[_0x71365a][_0x2581f5(0x2a0)][_0x2581f5(0x39c)],_0x71365a),!(devices[_0x71365a]['access'][_0x2581f5(0x358)]&&devices[_0x71365a][_0x2581f5(0x2a0)]['reason']==_0x2581f5(0x1cd))&&(_0x5f0c33==_0x2581f5(0x39e)?io['to'](_0x71365a)[_0x2581f5(0x287)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x71365a)[_0x2581f5(0x287)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x71365a][_0x2581f5(0x2a0)][_0x2581f5(0x39c)]=null;},_0x1a4462);}function setTokenRefresh(_0x1d7d3c){const _0x24c3fe=_0x6371da;if(devices[_0x1d7d3c][_0x24c3fe(0x22a)])clearTimeout(devices[_0x1d7d3c][_0x24c3fe(0x22a)]);devices[_0x1d7d3c][_0x24c3fe(0x22a)]=setTimeout(()=>{const _0x385984=_0x24c3fe;getClientsWithUuid(_0x1d7d3c)['length']!=0x0?(devices[_0x1d7d3c][_0x385984(0x2a0)]=refreshToken(_0x1d7d3c),io['to'](_0x1d7d3c)[_0x385984(0x287)](_0x385984(0x348),{'status':_0x385984(0x2b1),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1d7d3c][_0x385984(0x2a0)],'externalip':devices[_0x1d7d3c]['ip'],'publicKey':secure[_0x385984(0x200)],'validInstallation':validInstallation}),setTokenRefresh(_0x1d7d3c)):clearTimeout(devices[_0x1d7d3c][_0x385984(0x22a)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x41c6cc){const _0xb4a0a3=_0x6371da,_0x150f66=getClient(_0x41c6cc['id'])[_0xb4a0a3(0x234)];_0x41c6cc[_0xb4a0a3(0x287)](_0xb4a0a3(0x219),config),_0x41c6cc[_0xb4a0a3(0x287)](_0xb4a0a3(0x347),cleanSettings()),_0x41c6cc['on'](_0xb4a0a3(0x30e),_0x34dee8=>{const _0x48c3fe=_0xb4a0a3;if(validateAccess(_0x34dee8,_0x150f66)[_0x48c3fe(0x358)])addBot();else logger[_0x48c3fe(0x2e8)](_0x48c3fe(0x209));}),_0x41c6cc['on'](_0xb4a0a3(0x2e7),(_0x360669,_0x2bff37)=>{const _0x10a5e3=_0xb4a0a3;if(validateAccess(_0x2bff37,_0x150f66)['allow'])toggleBot(_0x360669[_0x10a5e3(0x350)],_0x360669['status'],_0x360669['live']);else logger[_0x10a5e3(0x2e8)](_0x10a5e3(0x205));}),_0x41c6cc['on']('toggle-bot-mode',(_0x1ad504,_0x52db83)=>{const _0x49e53d=_0xb4a0a3;if(validateAccess(_0x52db83,_0x150f66)['allow'])toggleBotMode(_0x1ad504);else logger[_0x49e53d(0x2e8)](_0x49e53d(0x205));}),_0x41c6cc['on'](_0xb4a0a3(0x228),(_0x5378b5,_0x3c94ba)=>{const _0x37953a=_0xb4a0a3;if(validateAccess(_0x3c94ba,_0x150f66)[_0x37953a(0x358)])deleteBot(_0x5378b5);else logger[_0x37953a(0x2e8)](_0x37953a(0x2ce));}),_0x41c6cc['on'](_0xb4a0a3(0x2ed),(_0x36968a,_0x19c477)=>{const _0x12b7b8=_0xb4a0a3;if(validateAccess(_0x19c477,_0x150f66)[_0x12b7b8(0x358)])storeSettings(_0x36968a,!![]);else logger[_0x12b7b8(0x2e8)](_0x12b7b8(0x1e7));}),_0x41c6cc['on']('update-bb',_0x537982=>{const _0x418554=_0xb4a0a3;if(validateAccess(_0x537982,_0x150f66)[_0x418554(0x358)])updateBB(_0x418554(0x33d));else logger['full'](_0x418554(0x311));}),_0x41c6cc['on']('reinstall-bb',_0x5e52a0=>{const _0x2bf40c=_0xb4a0a3;if(validateAccess(_0x5e52a0,_0x150f66)[_0x2bf40c(0x358)])updateBB(_0x2bf40c(0x233));else logger[_0x2bf40c(0x2e8)](_0x2bf40c(0x25d));}),_0x41c6cc['on'](_0xb4a0a3(0x1fe),_0x294dc6=>{const _0x3a49a8=_0xb4a0a3;if(validateAccess(_0x294dc6,_0x150f66)[_0x3a49a8(0x358)]){const _0x196c5a=getClient(_0x41c6cc['id']);if(_0x196c5a)getBackupFiles(_0x196c5a[_0x3a49a8(0x234)]);else logger[_0x3a49a8(0x2e8)](_0x3a49a8(0x307));}else logger[_0x3a49a8(0x2e8)](_0x3a49a8(0x35e));}),_0x41c6cc['on'](_0xb4a0a3(0x22d),(_0x5adb04,_0x16302e)=>{const _0x4e2219=_0xb4a0a3;if(validateAccess(_0x16302e,_0x150f66)[_0x4e2219(0x358)])restoreBackupFile(_0x5adb04);else logger[_0x4e2219(0x2e8)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x41c6cc['on'](_0xb4a0a3(0x2e1),_0x3a703e=>{const _0x7eccf1=_0xb4a0a3;if(validateAccess(_0x3a703e,_0x150f66)[_0x7eccf1(0x358)])getMessages();else logger[_0x7eccf1(0x2e8)](_0x7eccf1(0x204));}),_0x41c6cc['on'](_0xb4a0a3(0x2ae),(_0x79896,_0x4a3bde)=>{const _0x380efd=_0xb4a0a3;if(validateAccess(_0x4a3bde,_0x150f66)[_0x380efd(0x358)])confirmMessage(_0x79896);else logger[_0x380efd(0x2e8)](_0x380efd(0x31b));}),_0x41c6cc['on'](_0xb4a0a3(0x330),_0x187624=>{const _0x50e8a8=_0xb4a0a3;if(validateAccess(_0x187624,_0x150f66)['allow']){if(devices[_0x150f66][_0x50e8a8(0x22a)])clearTimeout(devices[_0x150f66][_0x50e8a8(0x22a)]);if(devices[_0x150f66][_0x50e8a8(0x298)])clearTimeout(devices[_0x150f66][_0x50e8a8(0x298)]);removeSocketListeners(getClient(_0x41c6cc['id'])['uuid']),addBlacklist(_0x150f66),devices[_0x150f66][_0x50e8a8(0x1a8)]=null,devices[_0x150f66][_0x50e8a8(0x34a)]=null,devices[_0x150f66]['access'][_0x50e8a8(0x39c)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x150f66[_0x50e8a8(0x2b4)](-0x8)),io['to'](getClient(_0x41c6cc['id'])[_0x50e8a8(0x234)])[_0x50e8a8(0x287)](_0x50e8a8(0x348),{'access':{'allow':![],'reason':_0x50e8a8(0x1ee),'token':null}});}else logger[_0x50e8a8(0x2e8)](_0x50e8a8(0x22f));});}function initializeSocketBot(_0xf8434d){const _0x5e9c55=_0x6371da,_0x3bf025=getClient(_0xf8434d['id'])[_0x5e9c55(0x215)],_0x7e9d5c=getClient(_0xf8434d['id'])[_0x5e9c55(0x234)];_0xf8434d['on'](_0x5e9c55(0x314),(_0x38c069,_0x3a5367)=>{const _0x29bb01=_0x5e9c55;if(validateAccess(_0x3a5367,_0x7e9d5c)[_0x29bb01(0x358)]){if(pid[_0x3bf025])pid[_0x3bf025]['send']({'function':_0x29bb01(0x214),'args':_0x38c069});}else logger['full'](_0x29bb01(0x37f));}),_0xf8434d['on'](_0x5e9c55(0x2a4),(_0x560b82,_0x3caa2d)=>{const _0x318054=_0x5e9c55;if(validateAccess(_0x3caa2d,_0x7e9d5c)[_0x318054(0x358)]){if(pid[_0x3bf025])pid[_0x3bf025][_0x318054(0x29a)]({'function':'deleteHistoryAlerts','args':_0x560b82});}else logger['full'](_0x318054(0x29e));}),_0xf8434d['on'](_0x5e9c55(0x2e9),(_0x248bb7,_0x957c3e)=>{const _0x2238f0=_0x5e9c55;if(validateAccess(_0x957c3e,_0x7e9d5c)['allow']){if(pid[_0x3bf025])pid[_0x3bf025]['send']({'function':_0x2238f0(0x1ff),'args':_0x248bb7});}else logger['full'](_0x2238f0(0x26e));}),_0xf8434d['on']('store-configuration',(_0x13e894,_0x4a565f)=>{const _0x5e7cda=_0x5e9c55;if(validateAccess(_0x4a565f,_0x7e9d5c)[_0x5e7cda(0x358)]){if(pid[_0x3bf025])pid[_0x3bf025]['send']({'function':_0x5e7cda(0x276),'args':_0x13e894});}else logger[_0x5e7cda(0x2e8)](_0x5e7cda(0x326));}),_0xf8434d['on'](_0x5e9c55(0x1fc),(_0xcb00a,_0x22e75e)=>{const _0x1fe5d6=_0x5e9c55;if(validateAccess(_0x22e75e,_0x7e9d5c)[_0x1fe5d6(0x358)]){if(pid[_0x3bf025])pid[_0x3bf025][_0x1fe5d6(0x29a)]({'function':_0x1fe5d6(0x2e5),'args':_0xcb00a});}else logger[_0x1fe5d6(0x2e8)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0xf8434d['on'](_0x5e9c55(0x2bf),(_0x79bbe4,_0x20eccf)=>{const _0x4f498e=_0x5e9c55;if(validateAccess(_0x20eccf,_0x7e9d5c)[_0x4f498e(0x358)]){if(pid[_0x3bf025])pid[_0x3bf025][_0x4f498e(0x29a)]({'function':_0x4f498e(0x1ac),'args':_0x79bbe4});}else logger[_0x4f498e(0x2e8)](_0x4f498e(0x2b5));}),_0xf8434d['on']('reset-history',_0x984a12=>{const _0x2b3ce2=_0x5e9c55;if(validateAccess(_0x984a12,_0x7e9d5c)[_0x2b3ce2(0x358)]){if(pid[_0x3bf025])pid[_0x3bf025]['send']({'function':_0x2b3ce2(0x399),'args':null});}else logger[_0x2b3ce2(0x2e8)](_0x2b3ce2(0x1ed));}),_0xf8434d['on'](_0x5e9c55(0x1dc),_0x2bc436=>{const _0x127d72=_0x5e9c55;if(validateAccess(_0x2bc436,_0x7e9d5c)[_0x127d72(0x358)]){if(pid[_0x3bf025])pid[_0x3bf025]['send']({'function':_0x127d72(0x36c),'args':null});}else logger[_0x127d72(0x2e8)](_0x127d72(0x255));}),_0xf8434d['on'](_0x5e9c55(0x2cf),(_0x26b5e7,_0x3b97d5)=>{const _0x4d44b1=_0x5e9c55;if(validateAccess(_0x3b97d5,_0x7e9d5c)['allow']){if(pid[_0x3bf025])pid[_0x3bf025][_0x4d44b1(0x29a)]({'function':_0x4d44b1(0x2f8),'args':_0x26b5e7});}else logger[_0x4d44b1(0x2e8)](_0x4d44b1(0x2e6));}),_0xf8434d['on'](_0x5e9c55(0x231),_0x45eb9e=>{const _0x8fc12c=_0x5e9c55;if(validateAccess(_0x45eb9e,_0x7e9d5c)[_0x8fc12c(0x358)]){if(pid[_0x3bf025])pid[_0x3bf025]['send']({'function':_0x8fc12c(0x383),'args':null});}else logger[_0x8fc12c(0x2e8)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0xf8434d['on'](_0x5e9c55(0x361),_0x68c9f7=>{const _0x306765=_0x5e9c55;if(validateAccess(_0x68c9f7,_0x7e9d5c)[_0x306765(0x358)]){if(pid[_0x3bf025])pid[_0x3bf025][_0x306765(0x29a)]({'function':_0x306765(0x22b),'args':null});}else logger[_0x306765(0x2e8)](_0x306765(0x35f));}),_0xf8434d['on'](_0x5e9c55(0x293),_0x44c63f=>{const _0x3903f4=_0x5e9c55;if(validateAccess(_0x44c63f,_0x7e9d5c)[_0x3903f4(0x358)])updateBB(_0x3903f4(0x33d));else logger[_0x3903f4(0x2e8)](_0x3903f4(0x311));}),_0xf8434d['on'](_0x5e9c55(0x2e1),_0x561ee6=>{const _0x56e2f4=_0x5e9c55;if(validateAccess(_0x561ee6,_0x7e9d5c)[_0x56e2f4(0x358)])getMessages();else logger[_0x56e2f4(0x2e8)](_0x56e2f4(0x204));}),_0xf8434d['on'](_0x5e9c55(0x2ae),(_0x3a689e,_0x5e299f)=>{const _0x178ff0=_0x5e9c55;if(validateAccess(_0x5e299f,_0x7e9d5c)[_0x178ff0(0x358)])confirmMessage(_0x3a689e);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0xf8434d['on'](_0x5e9c55(0x330),_0x569081=>{const _0x47b660=_0x5e9c55;if(validateAccess(_0x569081,_0x7e9d5c)[_0x47b660(0x358)]){if(devices[_0x7e9d5c][_0x47b660(0x22a)])clearTimeout(devices[_0x7e9d5c][_0x47b660(0x22a)]);if(devices[_0x7e9d5c]['pidExpireLogin'])clearTimeout(devices[_0x7e9d5c][_0x47b660(0x298)]);removeSocketListeners(getClient(_0xf8434d['id'])['uuid']),addBlacklist(_0x7e9d5c),devices[_0x7e9d5c][_0x47b660(0x1a8)]=null,devices[_0x7e9d5c][_0x47b660(0x34a)]=null,devices[_0x7e9d5c]['access'][_0x47b660(0x39c)]=null,logger['debug'](_0x47b660(0x1c0)+_0x7e9d5c[_0x47b660(0x2b4)](-0x8)),io['to'](getClient(_0xf8434d['id'])['uuid'])[_0x47b660(0x287)](_0x47b660(0x348),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x47b660(0x2e8)](_0x47b660(0x22f));});}function removeSocketListeners(_0x403b0b){const _0x535f5f=_0x6371da;getClientsWithUuid(_0x403b0b)[_0x535f5f(0x1c4)](_0x270ed4=>{getSocket(_0x270ed4['id'])['removeAllListeners']();});}function cleanSettings(){const _0x43b6b4=_0x6371da;let _0x3ae460=settings;return settings[_0x43b6b4(0x1f9)]&&settings[_0x43b6b4(0x1f9)]!=''&&(_0x3ae460={..._0x3ae460,'telegramToken':_0x43b6b4(0x2a5)}),settings[_0x43b6b4(0x1be)]&&settings['bbPassword']!=''&&(_0x3ae460={..._0x3ae460,'bbPassword':_0x43b6b4(0x2a5)}),settings[_0x43b6b4(0x2d3)]&&settings[_0x43b6b4(0x2d3)]!=''&&(_0x3ae460={..._0x3ae460,'marketcapApi':_0x43b6b4(0x2a5)}),(settings[_0x43b6b4(0x1be)]&&settings[_0x43b6b4(0x1be)]==_0x43b6b4(0x237)||settings[_0x43b6b4(0x1f9)]&&settings['telegramToken']==_0x43b6b4(0x237)||settings[_0x43b6b4(0x2d3)]&&settings['marketcapApi']=='***')&&(_0x3ae460={..._0x3ae460,'restored':{'password':settings[_0x43b6b4(0x1be)]==_0x43b6b4(0x237),'telegram':settings['telegramToken']==_0x43b6b4(0x237),'marketcap':settings[_0x43b6b4(0x2d3)]==_0x43b6b4(0x237)}}),_0x3ae460;}async function updateBB(_0x4ffa70){const _0x3a2d77=_0x6371da;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x498235=>{const _0x5dd975=_0x2e16;restartBot(_0x498235[_0x5dd975(0x350)]);});if(_0x4ffa70==_0x3a2d77(0x33d))process[_0x3a2d77(0x29a)]({'update':!![],'environment':environment},_0x65647=>{});else _0x4ffa70==_0x3a2d77(0x233)&&process['send']({'reinstall':!![],'environment':environment},_0x8cc9d5=>{});}function startBot(_0x4075cf,_0x5604c8,_0x23b314){const _0x41a46b=_0x6371da;if(debugging)_0x4075cf[_0x41a46b(0x38b)]('-d');if(recreate)_0x4075cf['push']('-r');let _0x2e7c8e=![];const _0x3b936a=_0x4075cf[0x0];_0x5604c8={..._0x5604c8,'stdio':[_0x41a46b(0x1fa),'inherit',_0x41a46b(0x1fa),_0x41a46b(0x1cc)]},pid[_0x3b936a]=childProcess['fork'](botfile,_0x4075cf,_0x5604c8),pid[_0x3b936a]['on'](_0x41a46b(0x2dd),_0x57438d=>{const _0x538193=_0x41a46b;switch(Object['keys'](_0x57438d)[0x0]){case _0x538193(0x1e3):updateBotName(_0x3b936a,_0x57438d['botname']);break;case _0x538193(0x251):updateBotManager();break;case _0x538193(0x348):updateStatus(_0x3b936a,_0x57438d[_0x538193(0x348)]);break;case _0x538193(0x362):updateLive(_0x3b936a,_0x57438d['live']);break;case _0x538193(0x1da):updateLive(_0x3b936a,_0x57438d[_0x538193(0x1da)]),io['to'](_0x3b936a)[_0x538193(0x287)](_0x538193(0x348),{'access':{'allow':![],'reason':_0x538193(0x26b),'token':null}});break;case _0x538193(0x392):_0x57438d[_0x538193(0x392)]=='restart'&&restartBot(_0x3b936a);_0x57438d[_0x538193(0x392)]==_0x538193(0x266)&&toggleBot(_0x3b936a,_0x538193(0x2ec),_0x538193(0x30d));break;case _0x538193(0x27f):sendTelegramBot(_0x3b936a,_0x57438d[_0x538193(0x27f)]);break;case _0x538193(0x2e4):sendTelegramMsg(_0x57438d[_0x538193(0x2e4)]);break;case _0x538193(0x1b8):io['to'](_0x3b936a)['emit'](_0x57438d['function'],_0x57438d['args']);break;}}),pid[_0x3b936a]['on'](_0x41a46b(0x267),function(_0x36b246){if(_0x2e7c8e)return;_0x2e7c8e=!![],_0x23b314(_0x36b246);}),pid[_0x3b936a]['on'](_0x41a46b(0x294),async function(_0x34bea7){const _0x4c4245=_0x41a46b;if(terminating)return;if(installingUpdate){io[_0x4c4245(0x227)]();return;}if(_0x2e7c8e)return;_0x2e7c8e=!![],_0x23b314(null);const _0x236654=dbConfig[_0x4c4245(0x2f7)](_0x4c4245(0x219))[_0x4c4245(0x322)]({'botID':_0x3b936a})['value']();_0x236654&&(_0x236654[_0x4c4245(0x348)]==_0x4c4245(0x2f3)||_0x236654[_0x4c4245(0x348)]==_0x4c4245(0x2bd))&&(await sleep(0x3e8),updateLive(_0x3b936a,_0x4c4245(0x30d)),logger['full'](_0x4c4245(0x28a)+botRef(_0x3b936a)),startBot([_0x3b936a,userID],{'cwd':bbpath},function(_0xeee269){const _0x52594d=_0x4c4245;if(_0xeee269)logger[_0x52594d(0x2e8)](_0xeee269);}));});}function stopBot(_0x201643){const _0x50967f=_0x6371da;getClientsWithBotID(_0x201643)['forEach'](_0x26e0e8=>{const _0x434f7a=_0x2e16;getSocket(_0x26e0e8['id'])[_0x434f7a(0x1ef)](!![]),removeClient(_0x26e0e8['id']);}),pid[_0x201643]&&(pid[_0x201643][_0x50967f(0x266)](),pid[_0x201643]=null);}function stopAllBots(){const _0x2ee4ea=_0x6371da;terminating=!![];const _0x4458b4=getEnabledBots();_0x4458b4[_0x2ee4ea(0x1c4)](_0x262930=>{const _0x33d4ce=_0x2ee4ea;stopBot(_0x262930[_0x33d4ce(0x350)]);});}function restartBot(_0x514012){if(pid[_0x514012])pid[_0x514012]['kill']();}function addBot(){const _0x37fd7d=_0x6371da;let _0x52c914;for(let _0x2bc2cd=0x1;_0x2bc2cd<0x3e9;_0x2bc2cd++){_0x52c914=_0x2bc2cd['toString']()[_0x37fd7d(0x1b3)](0x3,'0');let _0x24f921=config[_0x37fd7d(0x322)](_0x56afcb=>_0x56afcb['botID']==_0x52c914);if(!_0x24f921)break;}if(_0x52c914===_0x37fd7d(0x203)){logger[_0x37fd7d(0x2e8)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x37fd7d(0x2e8)](_0x37fd7d(0x24b)+_0x52c914),dbConfig['get'](_0x37fd7d(0x219))[_0x37fd7d(0x38b)]({'botID':_0x52c914,'botname':'Bot\x20'+_0x52c914,'status':_0x37fd7d(0x2bd),'live':''})[_0x37fd7d(0x2fe)](),startBot([_0x52c914,userID],{'cwd':bbpath},function(_0x5349c8){const _0xb6db32=_0x37fd7d;if(_0x5349c8)logger[_0xb6db32(0x2e8)](_0x5349c8);}),config=getConfiguration(),io['to'](_0x37fd7d(0x28b))[_0x37fd7d(0x287)](_0x37fd7d(0x219),config),broadcastToBots(_0x37fd7d(0x219),JSON[_0x37fd7d(0x2d4)](config));}function deleteBot(_0x58a959){const _0x5a8901=_0x6371da;getClientsWithBotID(_0x58a959)[_0x5a8901(0x1c4)](_0x48a4a5=>{const _0x103601=_0x5a8901;getSocket(_0x48a4a5['id'])[_0x103601(0x1ef)](!![]),removeClient(_0x48a4a5['id']);}),dbConfig[_0x5a8901(0x2f7)](_0x5a8901(0x219))[_0x5a8901(0x2a9)]({'botID':_0x58a959})[_0x5a8901(0x2fe)](),logger[_0x5a8901(0x2e8)](_0x5a8901(0x1db)+_0x58a959),stopBot(_0x58a959);try{if(fs[_0x5a8901(0x313)](path[_0x5a8901(0x236)](configpath,'bot-'+_0x58a959+_0x5a8901(0x26f))))fs[_0x5a8901(0x1d4)](path[_0x5a8901(0x236)](configpath,_0x5a8901(0x24d)+_0x58a959+_0x5a8901(0x26f)));if(fs[_0x5a8901(0x313)](path[_0x5a8901(0x236)](configpath,_0x5a8901(0x24d)+_0x58a959+'-events.json')))fs[_0x5a8901(0x1d4)](path[_0x5a8901(0x236)](configpath,_0x5a8901(0x24d)+_0x58a959+_0x5a8901(0x1c2)));if(fs['existsSync'](path[_0x5a8901(0x236)](configpath,_0x5a8901(0x24d)+_0x58a959+'-performance.json')))fs['unlinkSync'](path[_0x5a8901(0x236)](configpath,_0x5a8901(0x24d)+_0x58a959+'-performance.json'));if(fs['existsSync'](path[_0x5a8901(0x236)](configpath,_0x5a8901(0x24d)+_0x58a959+_0x5a8901(0x29b))))fs[_0x5a8901(0x1d4)](path['join'](configpath,_0x5a8901(0x24d)+_0x58a959+_0x5a8901(0x29b)));}catch(_0x2fa8e3){if(_0x2fa8e3)logger[_0x5a8901(0x2e8)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x2fa8e3);}config=getConfiguration(),io['to']('botmanager')[_0x5a8901(0x287)](_0x5a8901(0x219),config),broadcastToBots(_0x5a8901(0x219),JSON['stringify'](config));}function toggleBot(_0x125e70,_0x157cba,_0x478246){const _0x276138=_0x6371da;dbConfig[_0x276138(0x2f7)](_0x276138(0x219))['find']({'botID':_0x125e70})['assign']({'status':_0x157cba})[_0x276138(0x394)]({'live':_0x478246})[_0x276138(0x2fe)]();const _0x3cc780=botRef(_0x125e70);if(_0x157cba==_0x276138(0x2f3)||_0x157cba==_0x276138(0x2bd))logger['full'](_0x276138(0x32c)+_0x3cc780),startBot([_0x125e70,userID],{'cwd':bbpath},function(_0x3beb60){const _0x44f3ee=_0x276138;if(_0x3beb60)logger[_0x44f3ee(0x2e8)](_0x3beb60);});else(_0x157cba==_0x276138(0x2ec)||_0x157cba=='new-disabled')&&(logger[_0x276138(0x2e8)](_0x276138(0x1e9)+_0x3cc780),stopBot(_0x125e70));config=getConfiguration(),io['to']('botmanager')[_0x276138(0x287)](_0x276138(0x219),config),broadcastToBots(_0x276138(0x219),JSON['stringify'](config));}function toggleStatus(_0x103adc){const _0x27ea6=_0x6371da;let _0x38b985=dbConfig[_0x27ea6(0x2f7)](_0x27ea6(0x219))['find']({'botID':_0x103adc})[_0x27ea6(0x2b6)](),_0xdd7987;if(_0x38b985[_0x27ea6(0x348)]==='enabled')_0xdd7987=_0x27ea6(0x2ec);else{if(_0x38b985[_0x27ea6(0x348)]==='new')_0xdd7987=_0x27ea6(0x281);else{if(_0x38b985[_0x27ea6(0x348)]===_0x27ea6(0x281))_0xdd7987=_0x27ea6(0x2bd);else{if(_0x38b985[_0x27ea6(0x348)]===_0x27ea6(0x2ec))_0xdd7987=_0x27ea6(0x2f3);}}}return _0xdd7987;}function updateStatus(_0x14bfce,_0x3b6870){const _0x52cdf5=_0x6371da;dbConfig[_0x52cdf5(0x2f7)](_0x52cdf5(0x219))[_0x52cdf5(0x322)]({'botID':_0x14bfce})[_0x52cdf5(0x394)]({'status':_0x3b6870})[_0x52cdf5(0x2fe)](),config=getConfiguration(),io['to'](_0x52cdf5(0x28b))[_0x52cdf5(0x287)]('bots',config),broadcastToBots('bots',JSON[_0x52cdf5(0x2d4)](config));}function updateLive(_0x2b055e,_0x5361e4){const _0x1022ed=_0x6371da;dbConfig[_0x1022ed(0x2f7)](_0x1022ed(0x219))[_0x1022ed(0x322)]({'botID':_0x2b055e})['assign']({'live':_0x5361e4})[_0x1022ed(0x2fe)](),config=getConfiguration(),io['to'](_0x1022ed(0x28b))[_0x1022ed(0x287)]('bots',config),broadcastToBots(_0x1022ed(0x219),JSON[_0x1022ed(0x2d4)](config));}function updateBotName(_0x52943b,_0x41e623){const _0x20da64=_0x6371da;dbConfig['get'](_0x20da64(0x219))[_0x20da64(0x322)]({'botID':_0x52943b})['assign']({'botname':_0x41e623})[_0x20da64(0x2fe)](),config=getConfiguration(),io['to'](_0x20da64(0x28b))[_0x20da64(0x287)](_0x20da64(0x219),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x3b59c9=_0x6371da;config=getConfiguration(),io['to'](_0x3b59c9(0x28b))[_0x3b59c9(0x287)]('bots',config),broadcastToBots(_0x3b59c9(0x219),JSON[_0x3b59c9(0x2d4)](config));}function toggleBotMode(_0x3c6e4a){const _0x4868a5=_0x6371da;if(pid[_0x3c6e4a])pid[_0x3c6e4a][_0x4868a5(0x29a)]({'function':'toggleBotMode','args':null});else{const _0x2b8475=configpath+_0x4868a5(0x24d)+_0x3c6e4a+_0x4868a5(0x26f),_0x1cd7c7=fs['readFileSync'](_0x2b8475),_0x218f98=JSON[_0x4868a5(0x1eb)](_0x1cd7c7),_0x4ba947=_0x218f98[_0x4868a5(0x215)][0x0][_0x4868a5(0x36f)];_0x218f98['bot'][0x0][_0x4868a5(0x36f)]=!_0x4ba947;const _0x1333ab=JSON[_0x4868a5(0x2d4)](_0x218f98,null,0x2);fs[_0x4868a5(0x33b)](_0x2b8475,_0x1333ab),config=getConfiguration(),io['to'](_0x4868a5(0x28b))['emit'](_0x4868a5(0x219),config),broadcastToBots(_0x4868a5(0x219),JSON[_0x4868a5(0x2d4)](config));}}function validateTelegram(_0x4ce3f8){const _0x4da61a=_0x6371da;if(_0x4ce3f8[_0x4da61a(0x22e)]['username']!=settings[_0x4da61a(0x2f4)]&&'@'+_0x4ce3f8[_0x4da61a(0x22e)][_0x4da61a(0x384)]!=settings[_0x4da61a(0x2f4)]||_0x4ce3f8[_0x4da61a(0x1c7)]['id']!=settings[_0x4da61a(0x1f0)])return sendTelegram(_0x4ce3f8[_0x4da61a(0x1c7)]['id'],_0x4da61a(0x317),{'parse_mode':_0x4da61a(0x32a)}),![];return!![];}function botRef(_0x54c444){const _0x5a1466=_0x6371da,_0x183c98=getBotAttributes(_0x54c444),_0x585c17=_0x183c98[_0x5a1466(0x1d5)]?_0x183c98[_0x5a1466(0x1e3)]:_0x5a1466(0x2fc)+_0x54c444;return _0x585c17;}async function initTelegram(){const _0x84a532=_0x6371da;tgBot&&(await tgBot[_0x84a532(0x392)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x84a532(0x1f9)]);let _0x2ffe03=_0x84a532(0x286);_0x2ffe03+='\x0a',_0x2ffe03+='/enable\x20-\x20enable\x20notifications\x0a',_0x2ffe03+=_0x84a532(0x265),_0x2ffe03+=_0x84a532(0x32b),_0x2ffe03+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x2ffe03+='/on\x20-\x20start\x20bot(s)\x0a',_0x2ffe03+='/off\x20-\x20stop\x20bot(s)\x0a',_0x2ffe03+=_0x84a532(0x365),_0x2ffe03+=_0x84a532(0x318),_0x2ffe03+=_0x84a532(0x23b),_0x2ffe03+=_0x84a532(0x260),_0x2ffe03+=_0x84a532(0x315),_0x2ffe03+='/logs\x20-\x20receive\x20log\x20files\x0a',_0x2ffe03+=_0x84a532(0x2a8),_0x2ffe03+=_0x84a532(0x32f),_0x2ffe03+=_0x84a532(0x374),_0x2ffe03+=_0x84a532(0x366);let _0x198d7c=_0x84a532(0x329);_0x198d7c+='\x0a',_0x198d7c+=_0x2ffe03,tgBot['catch']((_0x5e5ce3,_0x197c1c)=>{const _0x3193be=_0x84a532;logger[_0x3193be(0x192)](getTimeStamp()+_0x3193be(0x2ba)),logger[_0x3193be(0x1b7)](_0x3193be(0x375),_0x5e5ce3);}),tgBot[_0x84a532(0x193)](async(_0x2d28d6,_0x3990c5)=>{const _0x5de94e=_0x84a532;if(settings[_0x5de94e(0x1f0)]||_0x2d28d6[_0x5de94e(0x33d)][_0x5de94e(0x2dd)]['text']!=_0x5de94e(0x1d3)){if(!validateTelegram(_0x2d28d6))return;}_0x3990c5();}),tgBot[_0x84a532(0x33a)]('start',async _0x50f549=>{const _0x39920a=_0x84a532;if(_0x50f549[_0x39920a(0x22e)][_0x39920a(0x384)]==settings[_0x39920a(0x2f4)]||'@'+_0x50f549['from'][_0x39920a(0x384)]==settings[_0x39920a(0x2f4)]){if(!settings[_0x39920a(0x1f0)])updateSetting('telegramChatId',_0x50f549[_0x39920a(0x1c7)]['id']);else{if(!validateTelegram(_0x50f549))return;}}else{if(!validateTelegram(_0x50f549))return;}updateSetting('telegramEnabled',!![]),await sendTelegram(_0x50f549[_0x39920a(0x1c7)]['id'],_0x198d7c);}),tgBot['command'](_0x84a532(0x1b0),async _0x46b1a7=>{const _0x38d3c3=_0x84a532;updateSetting(_0x38d3c3(0x34d),!![]),await sendTelegram(_0x46b1a7[_0x38d3c3(0x1c7)]['id'],'Notifications\x20enabled');}),tgBot['command']('disable',async _0x370fe5=>{const _0x690ba8=_0x84a532;await sendTelegram(_0x370fe5[_0x690ba8(0x1c7)]['id'],_0x690ba8(0x1bb)),updateSetting('telegramEnabled',![]);}),tgBot[_0x84a532(0x33a)](_0x84a532(0x386),async _0x5b06ab=>{const _0x232f28=_0x84a532,_0x33c6b5=Markup[_0x232f28(0x1e0)]([Markup['button']['callback'](_0x232f28(0x24c),_0x232f28(0x312)),Markup[_0x232f28(0x259)]['callback'](_0x232f28(0x22c),_0x232f28(0x2b2)),Markup[_0x232f28(0x259)][_0x232f28(0x28c)](_0x232f28(0x1b1),_0x232f28(0x262))]);_0x5b06ab['reply']('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x33c6b5);}),tgBot[_0x84a532(0x356)](_0x84a532(0x312),async _0x1067b4=>{const _0x17e307=_0x84a532;_0x1067b4[_0x17e307(0x1a4)](),updateSetting(_0x17e307(0x245),_0x17e307(0x33f)),updateSetting(_0x17e307(0x34d),!![]),await sendTelegram(_0x1067b4[_0x17e307(0x1c7)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x84a532(0x356)](_0x84a532(0x2b2),async _0x479912=>{const _0x3df85e=_0x84a532;_0x479912['editMessageReplyMarkup'](),updateSetting('telegramEvents','alerts'),updateSetting(_0x3df85e(0x34d),!![]),await sendTelegram(_0x479912[_0x3df85e(0x1c7)]['id'],_0x3df85e(0x1bc));}),tgBot[_0x84a532(0x356)](_0x84a532(0x262),async _0x5f272f=>{const _0x204777=_0x84a532;_0x5f272f[_0x204777(0x1a4)](),updateSetting(_0x204777(0x245),'all'),updateSetting(_0x204777(0x34d),!![]),await sendTelegram(_0x5f272f['chat']['id'],_0x204777(0x37d));}),tgBot[_0x84a532(0x33a)]('status',async _0x2034f8=>{const _0x5a5e61=_0x84a532,_0x1eac8b=getBotsWithMode();let _0x51cc59=_0x5a5e61(0x258);config[_0x5a5e61(0x1c4)](_0x32f03f=>{const _0x3d145d=_0x5a5e61,_0x1ebea9=_0x1eac8b[_0x3d145d(0x322)](_0x303163=>_0x303163['botID']==_0x32f03f[_0x3d145d(0x350)])[_0x3d145d(0x27e)];_0x51cc59+=_0x3d145d(0x2fc)+_0x32f03f[_0x3d145d(0x350)]+':\x20'+_0x32f03f['status']+_0x3d145d(0x2f6)+_0x1ebea9+_0x3d145d(0x2f6)+_0x32f03f[_0x3d145d(0x362)]+'\x0a';}),_0x51cc59+='\x0a',_0x51cc59+=_0x5a5e61(0x211),_0x51cc59+=!settings[_0x5a5e61(0x34d)]?_0x5a5e61(0x28f):_0x5a5e61(0x212),_0x51cc59+=settings[_0x5a5e61(0x34d)]?settings['telegramEvents']==_0x5a5e61(0x25c)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0x5a5e61(0x245)]+_0x5a5e61(0x39f):'',await sendTelegram(_0x2034f8[_0x5a5e61(0x1c7)]['id'],_0x51cc59,{'parse_mode':_0x5a5e61(0x32a)});}),tgBot['command']('restart',async _0x4a889a=>{const _0x3d038b=_0x84a532,_0x49c204=getEnabledBots();if(_0x49c204[_0x3d038b(0x285)]==0x0)await sendTelegram(_0x4a889a[_0x3d038b(0x1c7)]['id'],_0x3d038b(0x249));else{if(_0x49c204[_0x3d038b(0x285)]>0x1)_0x49c204[_0x3d038b(0x38b)]({'botID':_0x3d038b(0x25c)});let _0x53fc25=[],_0x465fda=[];const _0x59881f=_0x49c204[_0x3d038b(0x285)]%0x4==0x0||_0x49c204[_0x3d038b(0x285)]%0x4==0x3||_0x49c204['length']%0x3==0x1?0x4:0x3;let _0x2ccd9d=0x0;_0x49c204[_0x3d038b(0x1c4)]((_0x31029f,_0x57b8f8)=>{const _0x3f1fb1=_0x3d038b;if(_0x57b8f8%_0x59881f==0x0)_0x465fda=[];_0x465fda['push'](Markup['button'][_0x3f1fb1(0x28c)](_0x31029f[_0x3f1fb1(0x350)]=='all'?_0x3f1fb1(0x39d):botRef(_0x31029f[_0x3f1fb1(0x350)]),_0x3f1fb1(0x213)+_0x31029f[_0x3f1fb1(0x350)])),_0x57b8f8%_0x59881f==0x0&&(_0x53fc25[_0x2ccd9d]=_0x465fda,_0x2ccd9d++);});const _0x2f2ae9=Markup['inlineKeyboard'](_0x53fc25);_0x4a889a[_0x3d038b(0x292)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x2f2ae9);}}),tgBot[_0x84a532(0x356)](/restart_(.+)/,async _0x5c1815=>{const _0x5a1679=_0x84a532,_0x4b9a2e=_0x5c1815['match'][0x1];_0x5c1815[_0x5a1679(0x1a4)](),_0x4b9a2e==_0x5a1679(0x25c)?config['forEach'](_0x4b65af=>{const _0x33bcc0=_0x5a1679;restartBot(_0x4b65af[_0x33bcc0(0x350)]);}):restartBot(_0x4b9a2e);}),tgBot['command']('on',async _0x202fc2=>{const _0x47081a=_0x84a532,_0x1351c9=getDisabledBots();if(_0x1351c9['length']==0x0)await sendTelegram(_0x202fc2[_0x47081a(0x1c7)]['id'],_0x47081a(0x1c1));else{if(_0x1351c9[_0x47081a(0x285)]>0x1)_0x1351c9[_0x47081a(0x38b)]({'botID':_0x47081a(0x25c)});let _0x3d2018=[],_0x25c763=[];const _0x48b623=_0x1351c9['length']%0x4==0x0||_0x1351c9[_0x47081a(0x285)]%0x4==0x3||_0x1351c9[_0x47081a(0x285)]%0x3==0x1?0x4:0x3;let _0x66d339=0x0;_0x1351c9['forEach']((_0x52d6b2,_0x4fc951)=>{const _0x2eb110=_0x47081a;if(_0x4fc951%_0x48b623==0x0)_0x25c763=[];_0x25c763[_0x2eb110(0x38b)](Markup['button'][_0x2eb110(0x28c)](_0x52d6b2[_0x2eb110(0x350)]==_0x2eb110(0x25c)?_0x2eb110(0x39d):botRef(_0x52d6b2[_0x2eb110(0x350)]),_0x2eb110(0x2b0)+_0x52d6b2[_0x2eb110(0x350)])),_0x4fc951%_0x48b623==0x0&&(_0x3d2018[_0x66d339]=_0x25c763,_0x66d339++);});const _0x2ae540=Markup[_0x47081a(0x1e0)](_0x3d2018);_0x202fc2[_0x47081a(0x292)](_0x47081a(0x320),_0x2ae540);}}),tgBot[_0x84a532(0x356)](/on_(.+)/,async _0x17e771=>{const _0x34081b=_0x84a532,_0x4f91a4=_0x17e771['match'][0x1];_0x17e771[_0x34081b(0x1a4)]();if(_0x4f91a4==_0x34081b(0x25c)){const _0x4f2622=getDisabledBots();await sendTelegram(_0x17e771[_0x34081b(0x1c7)]['id'],_0x34081b(0x38a)),_0x4f2622[_0x34081b(0x1c4)](_0x586b11=>{const _0x523e90=_0x34081b;if(_0x586b11['botID']!=_0x523e90(0x25c))toggleBot(_0x586b11[_0x523e90(0x350)],toggleStatus(_0x586b11[_0x523e90(0x350)]),'stopped');});}else await sendTelegram(_0x17e771[_0x34081b(0x1c7)]['id'],_0x34081b(0x235)+botRef(_0x4f91a4)),toggleBot(_0x4f91a4,toggleStatus(_0x4f91a4),_0x34081b(0x30d));}),tgBot['command'](_0x84a532(0x2aa),async _0x369bec=>{const _0x1dd8d1=_0x84a532,_0x111787=getEnabledBots();if(_0x111787[_0x1dd8d1(0x285)]==0x0)await sendTelegram(_0x369bec['chat']['id'],_0x1dd8d1(0x249));else{if(_0x111787[_0x1dd8d1(0x285)]>0x1)_0x111787[_0x1dd8d1(0x38b)]({'botID':_0x1dd8d1(0x25c)});let _0x3fd083=[],_0x440557=[];const _0x38707c=_0x111787['length']%0x4==0x0||_0x111787['length']%0x4==0x3||_0x111787['length']%0x3==0x1?0x4:0x3;let _0x5d82af=0x0;_0x111787['forEach']((_0x5b50ed,_0x3d7d86)=>{const _0x41f3f7=_0x1dd8d1;if(_0x3d7d86%_0x38707c==0x0)_0x440557=[];_0x440557[_0x41f3f7(0x38b)](Markup[_0x41f3f7(0x259)][_0x41f3f7(0x28c)](_0x5b50ed['botID']=='all'?'All\x20bots':botRef(_0x5b50ed['botID']),_0x41f3f7(0x2ee)+_0x5b50ed[_0x41f3f7(0x350)])),_0x3d7d86%_0x38707c==0x0&&(_0x3fd083[_0x5d82af]=_0x440557,_0x5d82af++);});const _0x345da5=Markup[_0x1dd8d1(0x1e0)](_0x3fd083);_0x369bec[_0x1dd8d1(0x292)](_0x1dd8d1(0x278),_0x345da5);}}),tgBot[_0x84a532(0x356)](/off_(.+)/,async _0xe3ecb1=>{const _0x439cec=_0x84a532,_0x5da692=_0xe3ecb1[_0x439cec(0x36a)][0x1];_0xe3ecb1['editMessageReplyMarkup']();if(_0x5da692==_0x439cec(0x25c)){const _0x44e7fd=getEnabledBots();await sendTelegram(_0xe3ecb1[_0x439cec(0x1c7)]['id'],_0x439cec(0x271)),_0x44e7fd[_0x439cec(0x1c4)](_0x587e6b=>{const _0x10edb5=_0x439cec;if(_0x587e6b[_0x10edb5(0x350)]!=_0x10edb5(0x25c))toggleBot(_0x587e6b[_0x10edb5(0x350)],toggleStatus(_0x587e6b['botID']),'stopped');});}else await sendTelegram(_0xe3ecb1[_0x439cec(0x1c7)]['id'],_0x439cec(0x218)+botRef(_0x5da692)),toggleBot(_0x5da692,toggleStatus(_0x5da692),_0x439cec(0x30d));}),tgBot[_0x84a532(0x33a)](_0x84a532(0x246),async _0x377589=>{const _0x34cba9=_0x84a532,_0x3b3ee2=getEnabledBots();if(_0x3b3ee2['length']==0x0)await sendTelegram(_0x377589[_0x34cba9(0x1c7)]['id'],_0x34cba9(0x249));else{if(_0x3b3ee2[_0x34cba9(0x285)]>0x1){let _0xdf9b0c=[],_0x8562e5=[];const _0x44697b=_0x3b3ee2['length']%0x4==0x0||_0x3b3ee2[_0x34cba9(0x285)]%0x4==0x3||_0x3b3ee2[_0x34cba9(0x285)]%0x3==0x1?0x4:0x3;let _0x559de4=0x0;_0x3b3ee2['forEach']((_0x548e24,_0x1cdeb5)=>{const _0x1aff53=_0x34cba9;if(_0x1cdeb5%_0x44697b==0x0)_0x8562e5=[];_0x8562e5[_0x1aff53(0x38b)](Markup[_0x1aff53(0x259)][_0x1aff53(0x28c)](botRef(_0x548e24[_0x1aff53(0x350)]),_0x1aff53(0x319)+_0x548e24[_0x1aff53(0x350)])),_0x1cdeb5%_0x44697b==0x0&&(_0xdf9b0c[_0x559de4]=_0x8562e5,_0x559de4++);});const _0x4a0087=Markup[_0x34cba9(0x1e0)](_0xdf9b0c);_0x377589[_0x34cba9(0x292)](_0x34cba9(0x336),_0x4a0087);}else{const _0x1fb9b9=_0x3b3ee2[0x0]['botID'];if(pid[_0x1fb9b9])pid[_0x1fb9b9][_0x34cba9(0x29a)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x84a532(0x356)](/metrics_(.+)/,async _0x60c6dd=>{const _0x513dd0=_0x84a532,_0x1f9056=_0x60c6dd['match'][0x1];_0x60c6dd[_0x513dd0(0x1a4)]();if(pid[_0x1f9056])pid[_0x1f9056][_0x513dd0(0x29a)]({'function':_0x513dd0(0x380),'args':null});}),tgBot[_0x84a532(0x33a)](_0x84a532(0x341),async _0x2fc310=>{const _0x491fb3=_0x84a532,_0x564ed4=getEnabledBots();if(_0x564ed4[_0x491fb3(0x285)]==0x0)await sendTelegram(_0x2fc310[_0x491fb3(0x1c7)]['id'],_0x491fb3(0x249));else{if(_0x564ed4[_0x491fb3(0x285)]>0x1){let _0x1d2d10=[],_0x11ec88=[];const _0x175855=_0x564ed4[_0x491fb3(0x285)]%0x4==0x0||_0x564ed4[_0x491fb3(0x285)]%0x4==0x3||_0x564ed4[_0x491fb3(0x285)]%0x3==0x1?0x4:0x3;let _0x3da52a=0x0;_0x564ed4['forEach']((_0x3b6278,_0x23cd3b)=>{const _0x51f379=_0x491fb3;if(_0x23cd3b%_0x175855==0x0)_0x11ec88=[];_0x11ec88[_0x51f379(0x38b)](Markup[_0x51f379(0x259)][_0x51f379(0x28c)](botRef(_0x3b6278[_0x51f379(0x350)]),_0x51f379(0x1ec)+_0x3b6278[_0x51f379(0x350)])),_0x23cd3b%_0x175855==0x0&&(_0x1d2d10[_0x3da52a]=_0x11ec88,_0x3da52a++);});const _0x5a832f=Markup[_0x491fb3(0x1e0)](_0x1d2d10);_0x2fc310[_0x491fb3(0x292)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x5a832f);}else{const _0x4c79d7=_0x564ed4[0x0][_0x491fb3(0x350)];if(pid[_0x4c79d7])pid[_0x4c79d7][_0x491fb3(0x29a)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0xe5600a=>{const _0x28a5f6=_0x84a532,_0x441f1a=_0xe5600a['match'][0x1];_0xe5600a['editMessageReplyMarkup']();if(pid[_0x441f1a])pid[_0x441f1a][_0x28a5f6(0x29a)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x84a532(0x33a)](_0x84a532(0x364),async _0x5a613a=>{const _0x5f2ece=_0x84a532,_0x32edda=_0x5f2ece(0x364);await zipFiles(_0x32edda);const _0x291c1e=zippath+(_0x32edda+_0x5f2ece(0x257));_0x5a613a[_0x5f2ece(0x25b)]({'source':_0x291c1e})[_0x5f2ece(0x268)](()=>{})['catch'](_0x12e47e=>logger['debug']('Error\x20sending\x20'+_0x32edda+_0x5f2ece(0x370),_0x12e47e));}),tgBot[_0x84a532(0x33a)](_0x84a532(0x1de),async _0x5cba45=>{const _0x127aa2=_0x84a532,_0x4fd9b0=_0x127aa2(0x1de);await backupConfigFiles(),await zipFiles(_0x4fd9b0);const _0x2c6b0f=zippath+(_0x4fd9b0+_0x127aa2(0x257));_0x5cba45[_0x127aa2(0x25b)]({'source':_0x2c6b0f})[_0x127aa2(0x268)](()=>{})['catch'](_0x296334=>logger[_0x127aa2(0x1b7)](_0x127aa2(0x398)+_0x4fd9b0+_0x127aa2(0x370),_0x296334));}),tgBot[_0x84a532(0x33a)](_0x84a532(0x33d),async _0x186721=>{const _0x53c056=_0x84a532;await getMessages();if(!updateAvailable)await sendTelegram(_0x186721[_0x53c056(0x1c7)]['id'],_0x53c056(0x1d6));else{if(!validInstallation)await sendTelegram(_0x186721['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x5ef4a4=Markup[_0x53c056(0x1e0)]([Markup['button'][_0x53c056(0x28c)](_0x53c056(0x1e4),_0x53c056(0x1f1)),Markup['button'][_0x53c056(0x28c)]('No',_0x53c056(0x2d7))]);_0x186721['reply'](_0x53c056(0x308),_0x5ef4a4);}}}),tgBot[_0x84a532(0x356)](/update_(.+)/,async _0x351a1b=>{const _0x44a0ae=_0x84a532,_0x169626=_0x351a1b['match'][0x1];_0x351a1b[_0x44a0ae(0x1a4)](),_0x169626=='yes'&&(await sendTelegram(_0x351a1b['chat']['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB('update')),_0x169626=='no'&&await sendTelegram(_0x351a1b[_0x44a0ae(0x1c7)]['id'],_0x44a0ae(0x2ab));}),tgBot[_0x84a532(0x33a)](_0x84a532(0x233),async _0x464826=>{const _0x36231d=_0x84a532;if(!validInstallation)await sendTelegram(_0x464826[_0x36231d(0x1c7)]['id'],_0x36231d(0x303));else{const _0x4e084e=Markup['inlineKeyboard']([Markup[_0x36231d(0x259)][_0x36231d(0x28c)](_0x36231d(0x1e4),_0x36231d(0x1b5)),Markup['button'][_0x36231d(0x28c)]('No',_0x36231d(0x305))]);_0x464826[_0x36231d(0x292)](_0x36231d(0x239),_0x4e084e);}}),tgBot[_0x84a532(0x356)](/reinstall_(.+)/,async _0x576565=>{const _0x4e86f7=_0x84a532,_0x4ce4c0=_0x576565['match'][0x1];_0x576565['editMessageReplyMarkup'](),_0x4ce4c0==_0x4e86f7(0x2d5)&&(await sendTelegram(_0x576565['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x4e86f7(0x233))),_0x4ce4c0=='no'&&await sendTelegram(_0x576565[_0x4e86f7(0x1c7)]['id'],_0x4e86f7(0x328));}),tgBot[_0x84a532(0x33a)](_0x84a532(0x34f),async _0x4896ab=>{const _0x4fcabf=_0x84a532,_0x36667c=getBotsWithMode();if(_0x36667c['length']==0x0)await sendTelegram(_0x4896ab['chat']['id'],_0x4fcabf(0x249));else{let _0x7fb8cc=[],_0x590fd3=[];const _0x25994f=0x2;let _0x260210=0x0;_0x36667c[_0x4fcabf(0x1c4)]((_0x428924,_0x1b34b0)=>{const _0xe76ef8=_0x4fcabf;if(_0x1b34b0%_0x25994f==0x0)_0x590fd3=[];_0x590fd3[_0xe76ef8(0x38b)](Markup[_0xe76ef8(0x259)]['callback'](botRef(_0x428924['botID'])+'\x20('+_0x428924[_0xe76ef8(0x27e)]+')',_0xe76ef8(0x1f4)+_0x428924[_0xe76ef8(0x350)])),_0x1b34b0%_0x25994f==0x0&&(_0x7fb8cc[_0x260210]=_0x590fd3,_0x260210++);});const _0xdc62=Markup[_0x4fcabf(0x1e0)](_0x7fb8cc);_0x4896ab[_0x4fcabf(0x292)](_0x4fcabf(0x342),_0xdc62);}}),tgBot['action'](/toggle_(.+)/,async _0x9c72cc=>{const _0x59ba6e=_0x84a532,_0xcb9186=_0x9c72cc[_0x59ba6e(0x36a)][0x1];_0x9c72cc[_0x59ba6e(0x1a4)]();const _0x2cc002=getBotsWithMode(),_0x3d5b36=_0x2cc002[_0x59ba6e(0x322)](_0x93cf64=>_0x93cf64[_0x59ba6e(0x350)]==_0xcb9186),_0x44e9a6=_0x3d5b36[_0x59ba6e(0x27e)]==_0x59ba6e(0x367)?'manual':_0x59ba6e(0x367);await sendTelegram(_0x9c72cc['chat']['id'],_0x59ba6e(0x23c)+botRef(_0x3d5b36['botID'])+_0x59ba6e(0x1f2)+_0x44e9a6+_0x59ba6e(0x1d1)),toggleBotMode(_0xcb9186);}),tgBot[_0x84a532(0x33a)](_0x84a532(0x248),async _0xe272cb=>{const _0x1a779c=_0x84a532;let _0x35c31f='';config[_0x1a779c(0x1c4)](_0x280cbd=>{const _0x4d8f8c=_0x1a779c;_0x35c31f+=_0x4d8f8c(0x2fc)+_0x280cbd[_0x4d8f8c(0x350)]+':\x20'+_0x280cbd[_0x4d8f8c(0x1e3)]+'\x0a';}),await sendTelegram(_0xe272cb[_0x1a779c(0x1c7)]['id'],_0x35c31f,{'parse_mode':_0x1a779c(0x32a)});}),tgBot[_0x84a532(0x33a)](_0x84a532(0x31d),async _0x6e5dcb=>{const _0xb7b175=_0x84a532;await sendTelegram(_0x6e5dcb[_0xb7b175(0x1c7)]['id'],_0x2ffe03);}),process[_0x84a532(0x2c5)](_0x84a532(0x1dd),()=>tgBot[_0x84a532(0x392)](_0x84a532(0x1dd))),process['once'](_0x84a532(0x2dc),()=>tgBot[_0x84a532(0x392)](_0x84a532(0x2dc))),tgBot['launch']();}function disableTelegram(){const _0x298d05=_0x6371da;tgBot&&tgBot[_0x298d05(0x392)]();}async function sendTelegram(_0x4d7a3a,_0x5050dd,_0x4513fb){const _0xa4ea7c=_0x6371da;_0x4513fb={..._0x4513fb,'disable_web_page_preview':!![]};try{await tgBot[_0xa4ea7c(0x27f)][_0xa4ea7c(0x2b7)](_0x4d7a3a,_0x5050dd,_0x4513fb);}catch(_0x1cd6a2){logger[_0xa4ea7c(0x1b7)](_0xa4ea7c(0x2b3),_0x1cd6a2);}}async function sendTelegramBot(_0x5d6e55,_0x4b9244){const _0x38f8e8=_0x6371da;if(settings['telegramEnabled']){if(settings[_0x38f8e8(0x245)]=='all'||(_0x4b9244[_0x38f8e8(0x390)]==_0x38f8e8(0x267)||_0x4b9244[_0x38f8e8(0x390)]==_0x38f8e8(0x274)||_0x4b9244[_0x38f8e8(0x390)]=='success')&&settings[_0x38f8e8(0x245)]==_0x38f8e8(0x30b)||_0x4b9244[_0x38f8e8(0x390)]=='order'&&settings[_0x38f8e8(0x245)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x4b9244[_0x38f8e8(0x1d5)])await sendTelegram(settings[_0x38f8e8(0x1f0)],_0x4b9244[_0x38f8e8(0x1e3)]+_0x38f8e8(0x2f2)+_0x4b9244[_0x38f8e8(0x369)]);else await sendTelegram(settings[_0x38f8e8(0x1f0)],_0x38f8e8(0x2fc)+_0x5d6e55+'\x20>\x20'+_0x4b9244['event']);}}}}async function sendTelegramMsg(_0x57bc78,_0x1b8523=_0x6371da(0x32a)){const _0x2dcc69=_0x6371da;return tgBot&&settings[_0x2dcc69(0x1f0)]?(await sendTelegram(settings[_0x2dcc69(0x1f0)],_0x57bc78,{'parse_mode':_0x1b8523}),!![]):![];}function getDeviceWithIp(_0x32b326){return devices['find'](_0x1b3ea6=>_0x1b3ea6['ip']===_0x32b326);}async function temporaryAccess2FA(_0x5f3f2a,_0x506708){const _0x2ad5bd=_0x6371da;let _0x506915=new Date(),_0x149144=![];if(lastIpApproval){if(_0x506915-lastIpApproval<0x1388)_0x149144=!![];}lastIpApproval=new Date();if(_0x149144)return;if(tgBot&&settings[_0x2ad5bd(0x1f0)]){const _0x5c8004=uuidRandom();tmpStorage[_0x5c8004]={'uuid':_0x5f3f2a,'externalip':_0x506708};const _0x246037=Markup[_0x2ad5bd(0x1e0)]([Markup[_0x2ad5bd(0x259)]['callback'](_0x2ad5bd(0x2be),_0x2ad5bd(0x395)+_0x5c8004),Markup[_0x2ad5bd(0x259)][_0x2ad5bd(0x28c)]('15\x20min','tempaccess_15_'+_0x5c8004),Markup[_0x2ad5bd(0x259)][_0x2ad5bd(0x28c)]('30\x20min',_0x2ad5bd(0x222)+_0x5c8004),Markup[_0x2ad5bd(0x259)]['callback'](_0x2ad5bd(0x2f5),_0x2ad5bd(0x1e6)+_0x5c8004)]);await sendTelegram(settings[_0x2ad5bd(0x1f0)],_0x2ad5bd(0x28e)+normalizeIP(_0x506708)['show']+'\x20?',_0x246037),tgBot[_0x2ad5bd(0x356)](/tempaccess_(.+)_(.+)/,async _0x364b00=>{const _0x205ea2=_0x2ad5bd,_0x162b39=_0x364b00[_0x205ea2(0x36a)][0x1],_0x4d20e0=_0x364b00[_0x205ea2(0x36a)][0x2],{uuid:_0x50137f,externalip:_0x4d4f72}=tmpStorage[_0x4d20e0];delete tmpStorage[_0x4d20e0],_0x364b00[_0x205ea2(0x1a4)](),devices[_0x50137f][_0x205ea2(0x1a8)]={'clientip':_0x4d4f72,'timestamp':new Date()[_0x205ea2(0x1f6)](),'expiry':_0x162b39},_0x162b39!=_0x205ea2(0x2f5)?(await sendTelegram(_0x364b00[_0x205ea2(0x1c7)]['id'],_0x205ea2(0x224)+_0x162b39+_0x205ea2(0x288),{'parse_mode':_0x205ea2(0x32a)}),io['to'](_0x50137f)[_0x205ea2(0x287)](_0x205ea2(0x348),{'access':{'allow':![],'reason':_0x205ea2(0x26b),'token':null}})):(await sendTelegram(_0x364b00[_0x205ea2(0x1c7)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x50137f)['emit']('status',{'access':{'allow':![],'reason':_0x205ea2(0x1ba),'token':null}}));});}}async function loginAccess2FA(_0x2de4a7,_0x328038){const _0x252c94=_0x6371da;if(tgBot&&settings[_0x252c94(0x1f0)]){const _0x24683f=uuidRandom();tmpStorage[_0x24683f]={'uuid':_0x2de4a7,'externalip':_0x328038};const _0x19780f=Markup['inlineKeyboard']([Markup[_0x252c94(0x259)]['callback'](_0x252c94(0x241),_0x252c94(0x3a3)+loginExpiry+'_'+_0x24683f),Markup['button'][_0x252c94(0x28c)]('reject',_0x252c94(0x352)+_0x24683f)]);await sendTelegram(settings[_0x252c94(0x1f0)],_0x252c94(0x393)+normalizeIP(_0x328038)['show']+'\x20?',_0x19780f),tgBot[_0x252c94(0x356)](/login2fa_(.+)_(.+)/,async _0x31eb4f=>{const _0x1f9efe=_0x252c94,_0x9c31e2=_0x31eb4f[_0x1f9efe(0x36a)][0x1],_0x1851c2=_0x31eb4f[_0x1f9efe(0x36a)][0x2],{uuid:_0x4854a0,externalip:_0x473371}=tmpStorage[_0x1851c2];delete tmpStorage[_0x1851c2],_0x31eb4f[_0x1f9efe(0x1a4)](),devices[_0x4854a0][_0x1f9efe(0x34a)]={'clientip':_0x473371,'timestamp':new Date()[_0x1f9efe(0x1f6)](),'expiry':_0x9c31e2},_0x9c31e2!=_0x1f9efe(0x2f5)?(await sendTelegram(_0x31eb4f[_0x1f9efe(0x1c7)]['id'],'Login\x20accepted',{'parse_mode':_0x1f9efe(0x32a)}),io['to'](_0x4854a0)[_0x1f9efe(0x287)](_0x1f9efe(0x348),{'access':{'allow':![],'reason':_0x1f9efe(0x26b),'token':null}})):(await sendTelegram(_0x31eb4f[_0x1f9efe(0x1c7)]['id'],'Login\x20rejected'),io['to'](_0x4854a0)[_0x1f9efe(0x287)](_0x1f9efe(0x348),{'access':{'allow':![],'reason':_0x1f9efe(0x289),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3c9668=_0x6371da;return dbConfig[_0x3c9668(0x2f7)](_0x3c9668(0x219))[_0x3c9668(0x2e0)](_0x3c9668(0x350))[_0x3c9668(0x1b4)]({'status':_0x3c9668(0x2f3)})['value']()||[];}function getDisabledBots(){const _0xd6b4f0=_0x6371da;return dbConfig['get'](_0xd6b4f0(0x219))[_0xd6b4f0(0x2e0)](_0xd6b4f0(0x350))[_0xd6b4f0(0x1b4)]({'status':'disabled'})[_0xd6b4f0(0x2b6)]()||[];}function getBotAttributes(_0x1e2be2){const _0x189ffe=_0x6371da;let _0x32d379={};const _0x15e809=configpath+_0x189ffe(0x24d)+_0x1e2be2+_0x189ffe(0x26f),_0x1b1f77=fs[_0x189ffe(0x313)](_0x15e809);if(_0x1b1f77){const _0x522863=fs[_0x189ffe(0x272)](_0x15e809);try{const _0x4d5fdd=JSON[_0x189ffe(0x1eb)](_0x522863),_0x51b783=_0x4d5fdd?_0x4d5fdd['bot'][0x0][_0x189ffe(0x36f)]:![];_0x32d379[_0x189ffe(0x27e)]=_0x51b783?_0x189ffe(0x367):'manual',_0x32d379[_0x189ffe(0x1e3)]=_0x4d5fdd?_0x4d5fdd['bot'][0x0][_0x189ffe(0x1e3)]:_0x189ffe(0x2fc)+_0x1e2be2,_0x32d379[_0x189ffe(0x1d5)]=_0x4d5fdd?_0x4d5fdd[_0x189ffe(0x215)][0x0]['showname']:![];}catch(_0x13242e){_0x32d379[_0x189ffe(0x27e)]=_0x189ffe(0x371),_0x32d379[_0x189ffe(0x1e3)]=_0x189ffe(0x2fc)+_0x1e2be2,_0x32d379[_0x189ffe(0x1d5)]=![];}}else _0x32d379[_0x189ffe(0x27e)]=_0x189ffe(0x371),_0x32d379['botname']=_0x189ffe(0x2fc)+_0x1e2be2,_0x32d379[_0x189ffe(0x1d5)]=![];return _0x32d379;}function getBotsWithMode(){const _0x22ec41=_0x6371da,_0x2def1c=dbConfig[_0x22ec41(0x2f7)](_0x22ec41(0x219))[_0x22ec41(0x2e0)](_0x22ec41(0x350))['value']()||[];return _0x2def1c[_0x22ec41(0x1c4)](_0x16a345=>{const _0x4305c6=_0x22ec41;let _0xd51cd6=getBotAttributes(_0x16a345[_0x4305c6(0x350)]);_0x16a345[_0x4305c6(0x27e)]=_0xd51cd6[_0x4305c6(0x27e)];}),_0x2def1c;}function getBotExchanges(){const _0x4aaf38=_0x6371da;let _0x18851a=[];const _0x432080=dbConfig[_0x4aaf38(0x2f7)](_0x4aaf38(0x219))[_0x4aaf38(0x2e0)](_0x4aaf38(0x350))['value']()||[];_0x432080[_0x4aaf38(0x1c4)](_0x2c5561=>{const _0x592ce0=_0x4aaf38;if(_0x2c5561[_0x592ce0(0x348)]==_0x592ce0(0x2f3)){const _0x5f1457=configpath+_0x592ce0(0x24d)+_0x2c5561['botID']+_0x592ce0(0x26f),_0x8f3d53=fs[_0x592ce0(0x313)](_0x5f1457);let _0x18bddd;if(_0x8f3d53){const _0x9813e8=fs[_0x592ce0(0x272)](_0x5f1457);try{const _0x4ec4c2=JSON[_0x592ce0(0x1eb)](_0x9813e8);_0x18bddd=_0x4ec4c2?_0x4ec4c2[_0x592ce0(0x215)][0x0][_0x592ce0(0x199)]:null;}catch(_0x3e3c10){}}if(_0x18bddd)_0x18851a[_0x592ce0(0x38b)](_0x18bddd);}});const _0xeaac9e=[...new Set(_0x18851a)]['sort']();return _0xeaac9e;}async function initUser(){const _0x253481=_0x6371da;if(!settings[_0x253481(0x23d)]){const _0xf1f651=uuidRandom();mixpanel['alias'](_0xf1f651),updateSetting('userid',_0xf1f651);}}async function initSecure(){const _0xd52337=_0x6371da;let _0x2e6eaf=getSecure();if(!_0x2e6eaf[_0xd52337(0x295)](_0xd52337(0x385))){let _0x1fa0a0=await generateKeys();_0x2e6eaf['publicKey']=_0x1fa0a0['publicKey'],_0x2e6eaf[_0xd52337(0x372)]=_0x1fa0a0[_0xd52337(0x372)],_0x2e6eaf['secret']=crypto[_0xd52337(0x210)](0x20)[_0xd52337(0x28d)]('hex');;storeSecure(_0x2e6eaf);}}function getSettings(){const _0xbf389d=_0x6371da;return dbSettings[_0xbf389d(0x2f7)](_0xbf389d(0x347))['value']()||{};}function getSecure(){const _0x2769ca=_0x6371da;return dbSecure[_0x2769ca(0x2f7)](_0x2769ca(0x1a5))[_0x2769ca(0x2b6)]()||{};}function getBlacklist(){const _0x3e8927=_0x6371da;return dbSecure[_0x3e8927(0x2f7)](_0x3e8927(0x263))[_0x3e8927(0x2b6)]()||[];}function broadcastToBots(_0x212d62,_0x59b6a8){const _0x33f044=_0x6371da;config[_0x33f044(0x1c4)](_0x190755=>{const _0x4d3531=_0x33f044;if(_0x190755[_0x4d3531(0x348)]==_0x4d3531(0x2f3)&&_0x190755[_0x4d3531(0x362)]==_0x4d3531(0x277)||_0x190755[_0x4d3531(0x348)]==_0x4d3531(0x2bd)&&_0x190755['live']==_0x4d3531(0x277)){if(pid[_0x190755[_0x4d3531(0x350)]])pid[_0x190755[_0x4d3531(0x350)]]['send']({[_0x212d62]:_0x59b6a8});}});}async function storeSettings(_0x274d27,_0x7fb84d=![]){const _0x29b5d7=_0x6371da;_0x274d27={...settings,..._0x274d27};if(_0x7fb84d&&_0x274d27['bbPassword']!=_0x29b5d7(0x2a5)&&_0x274d27[_0x29b5d7(0x1be)]!=_0x29b5d7(0x237)&&_0x274d27[_0x29b5d7(0x1be)]!=''){const _0x4a5321=decryptRSA(secure[_0x29b5d7(0x372)],_0x274d27[_0x29b5d7(0x1be)])[_0x29b5d7(0x388)](_0x29b5d7(0x206))[0x0],_0x2e2ec9=bcrypt['hashSync'](_0x4a5321,saltRounds);_0x274d27={..._0x274d27,'bbPassword':_0x2e2ec9};}if(_0x7fb84d&&_0x274d27[_0x29b5d7(0x1f9)]!=_0x29b5d7(0x2a5)&&_0x274d27[_0x29b5d7(0x1f9)]!='***'&&_0x274d27[_0x29b5d7(0x1f9)]!=''){const _0x1a25b4=decryptRSA(secure[_0x29b5d7(0x372)],_0x274d27[_0x29b5d7(0x1f9)])[_0x29b5d7(0x388)](_0x29b5d7(0x206))[0x0];_0x274d27={..._0x274d27,'telegramToken':_0x1a25b4};}if(_0x7fb84d&&_0x274d27['marketcapApi']!='************'&&_0x274d27['marketcapApi']!=_0x29b5d7(0x237)&&_0x274d27[_0x29b5d7(0x2d3)]!=''){const _0x2457a9=decryptRSA(secure['privateKey'],_0x274d27[_0x29b5d7(0x2d3)])['split'](_0x29b5d7(0x206))[0x0];_0x274d27={..._0x274d27,'marketcapApi':_0x2457a9};}const _0x15f307=_0x274d27[_0x29b5d7(0x1f9)]!='************'&&_0x274d27['telegramToken']!=settings[_0x29b5d7(0x1f9)]||_0x274d27[_0x29b5d7(0x2f4)]!=settings[_0x29b5d7(0x2f4)],_0x37f979=_0x274d27[_0x29b5d7(0x1f9)]==''||_0x274d27[_0x29b5d7(0x2f4)]=='',_0x8cc40b=_0x274d27['marketcapApi']&&_0x274d27['marketcapApi']!=_0x29b5d7(0x2a5)&&_0x274d27[_0x29b5d7(0x2d3)]!=settings[_0x29b5d7(0x2d3)];_0x15f307&&(_0x274d27['telegramChatId']=null,_0x274d27[_0x29b5d7(0x245)]=_0x29b5d7(0x25c));for(const [_0x3a8595,_0x32238f]of Object['entries'](_0x274d27)){if(_0x3a8595==_0x29b5d7(0x1f9)&&_0x32238f==_0x29b5d7(0x2a5)){_0x274d27['telegramToken']=settings['telegramToken'];continue;};if(_0x3a8595==_0x29b5d7(0x1be)&&_0x32238f==_0x29b5d7(0x2a5)){_0x274d27[_0x29b5d7(0x1be)]=settings[_0x29b5d7(0x1be)];continue;};if(_0x3a8595==_0x29b5d7(0x2d3)&&_0x32238f=='************'){_0x274d27[_0x29b5d7(0x2d3)]=settings['marketcapApi'];continue;};dbSettings[_0x29b5d7(0x31f)]('settings.'+_0x3a8595,_0x32238f)[_0x29b5d7(0x2fe)]();}settings=_0x274d27,io['to'](_0x29b5d7(0x28b))[_0x29b5d7(0x287)](_0x29b5d7(0x347),cleanSettings()),broadcastToBots('timeshift',settings[_0x29b5d7(0x270)]),broadcastToBots(_0x29b5d7(0x198),settings[_0x29b5d7(0x198)]),broadcastToBots(_0x29b5d7(0x2d3),settings[_0x29b5d7(0x2d3)]);if(_0x15f307&&!_0x37f979)initTelegram();_0x15f307&&_0x37f979&&(updateSetting(_0x29b5d7(0x1f0),null),disableTelegram()),getAllClients()['forEach'](_0x5e0b0b=>{const _0x542de0=_0x29b5d7;getSocket(_0x5e0b0b['id'])[_0x542de0(0x287)](_0x542de0(0x348),{'access':{'allow':![],'reason':_0x542de0(0x26b),'token':null}});}),_0x8cc40b&&(await sleep(0xbb8),testMarketcapApi(_0x274d27[_0x29b5d7(0x2d3)]));}async function testMarketcapApi(_0x19ec98){const _0x277eac=_0x6371da,_0xdec850=['BCT',_0x277eac(0x19d)];try{await axios[_0x277eac(0x2f7)](_0x277eac(0x368),{'headers':{'X-CMC_PRO_API_KEY':_0x19ec98},'params':{'symbol':_0xdec850[_0x277eac(0x28d)]()}});}catch(_0x48d27a){_0x48d27a[_0x277eac(0x28d)]()[_0x277eac(0x309)](_0x277eac(0x2da))?(io['to'](_0x277eac(0x28b))[_0x277eac(0x287)](_0x277eac(0x37e),_0x277eac(0x387)),logger['full'](_0x277eac(0x387))):(io['to'](_0x277eac(0x28b))['emit'](_0x277eac(0x37e),_0x277eac(0x29d)),logger[_0x277eac(0x2e8)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x277eac(0x1b7)](_0x277eac(0x302),_0x48d27a[_0x277eac(0x28d)]()+_0x277eac(0x220)+_0x48d27a[_0x277eac(0x1fd)]));return;}logger['debug']('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x2462da,_0x3087b7){const _0x5923dc=_0x6371da;dbSettings[_0x5923dc(0x31f)]('settings.'+_0x2462da,_0x3087b7)[_0x5923dc(0x2fe)](),settings=getSettings(),io['to'](_0x5923dc(0x28b))[_0x5923dc(0x287)](_0x5923dc(0x347),cleanSettings());}function storeSecure(_0x280988){const _0xbc9773=_0x6371da;dbSecure[_0xbc9773(0x2f7)](_0xbc9773(0x1a5))[_0xbc9773(0x38b)](_0x280988)[_0xbc9773(0x2fe)](),secure=_0x280988;}function addBlacklist(_0x1e6eb0){const _0x2eb59f=_0x6371da;cleanBlacklist();let _0x250f79;devices[_0x1e6eb0][_0x2eb59f(0x1a8)]?_0x250f79=Math[_0x2eb59f(0x29c)](devices[_0x1e6eb0][_0x2eb59f(0x1a8)][_0x2eb59f(0x37c)],loginExpiry):_0x250f79=loginExpiry,dbSecure['get'](_0x2eb59f(0x263))[_0x2eb59f(0x38b)]({'expiry':new Date()[_0x2eb59f(0x1f6)]()+_0x250f79*0x3c*0x3e8,'token':devices[_0x1e6eb0][_0x2eb59f(0x2a0)]['token']})[_0x2eb59f(0x2fe)](),blacklist=dbSecure[_0x2eb59f(0x2f7)]('blacklist')[_0x2eb59f(0x2b6)]();}function cleanBlacklist(){const _0x15810f=_0x6371da;let _0x30259d=dbSecure[_0x15810f(0x2f7)](_0x15810f(0x263))[_0x15810f(0x396)]()[_0x15810f(0x2b6)](),_0x2147cb=new Date()[_0x15810f(0x1f6)]();_0x30259d[_0x15810f(0x1c4)](_0x501aa5=>{const _0x36c36d=_0x15810f;_0x501aa5[_0x36c36d(0x37c)]<_0x2147cb&&dbSecure[_0x36c36d(0x2f7)](_0x36c36d(0x263))[_0x36c36d(0x2a9)]({'expiry':_0x501aa5['expiry']})[_0x36c36d(0x2fe)]();});}function initStates(){const _0x191d04=_0x6371da;let _0x4dd989=getConfiguration();_0x4dd989[_0x191d04(0x1c4)](_0xe36ea1=>{const _0x932baa=_0x191d04;_0xe36ea1[_0x932baa(0x362)]=_0x932baa(0x30d);}),storeConfiguration(_0x4dd989);}async function generateKeys(){const _0x44966a=_0x6371da,_0x584873=forge[_0x44966a(0x2cc)][_0x44966a(0x1c9)][_0x44966a(0x242)]({'bits':0x1000,'e':0x10001}),_0x3a8c91=forge[_0x44966a(0x2cc)]['privateKeyToPem'](_0x584873[_0x44966a(0x372)]),_0x272a94=forge['pki'][_0x44966a(0x269)](_0x584873[_0x44966a(0x200)]);return{'privateKey':_0x3a8c91,'publicKey':_0x272a94};}function _0x2e16(_0x37225c,_0x183cd2){const _0x17b44a=_0x5088();return _0x2e16=function(_0x58c767,_0x21c5bb){_0x58c767=_0x58c767-0x190;let _0x5088aa=_0x17b44a[_0x58c767];return _0x5088aa;},_0x2e16(_0x37225c,_0x183cd2);}async function oneTimeMigration(){const _0x31d58f=_0x6371da;let _0x1d56fb=getSettings(),_0x1a2e74=![];!_0x1d56fb[_0x31d58f(0x295)](_0x31d58f(0x2db))&&(_0x1d56fb[_0x31d58f(0x2db)]=0x0,_0x1a2e74=!![]);!_0x1d56fb[_0x31d58f(0x295)](_0x31d58f(0x33c))&&(_0x1d56fb[_0x31d58f(0x33c)]=0x0,_0x1a2e74=!![]);!_0x1d56fb[_0x31d58f(0x295)](_0x31d58f(0x2a6))&&(_0x1d56fb['latestversion']=_0x31d58f(0x2c8),_0x1a2e74=!![]);!_0x1d56fb['hasOwnProperty']('onepagemode')&&(_0x1d56fb['onepagemode']=![],_0x1a2e74=!![]);!_0x1d56fb[_0x31d58f(0x295)](_0x31d58f(0x2d3))&&(_0x1d56fb[_0x31d58f(0x2d3)]='',_0x1a2e74=!![]);if(_0x1a2e74)storeSettings(_0x1d56fb);try{fs[_0x31d58f(0x2ac)](configbackuppath,{'withFileTypes':!![]})[_0x31d58f(0x1c4)](_0x4533ea=>{const _0x364e00=_0x31d58f;if(!_0x4533ea['isDirectory']()){if(!_0x4533ea[_0x364e00(0x1c5)][_0x364e00(0x27d)](_0x364e00(0x250)))fs[_0x364e00(0x1d4)](configbackuppath+_0x4533ea[_0x364e00(0x1c5)]);}else fs[_0x364e00(0x376)](configbackuppath+_0x4533ea[_0x364e00(0x1c5)],{'recursive':!![]});});}catch(_0x3aa134){logger[_0x31d58f(0x1b7)](_0x31d58f(0x21c),_0x3aa134);}}function storeConfiguration(_0x44586c){const _0x335968=_0x6371da;dbConfig['get'](_0x335968(0x219))[_0x335968(0x2a9)]()[_0x335968(0x2fe)](),dbConfig['get'](_0x335968(0x219))[_0x335968(0x38b)](..._0x44586c)[_0x335968(0x2fe)](),config=_0x44586c;}async function resetPassword(){const _0x24b3b9=_0x6371da;if(tgBot&&settings[_0x24b3b9(0x1f0)]){const _0x5c65a1=Markup[_0x24b3b9(0x1e0)]([Markup[_0x24b3b9(0x259)]['callback'](_0x24b3b9(0x2d5),_0x24b3b9(0x2a7)),Markup['button']['callback']('no',_0x24b3b9(0x344))]);await sendTelegram(settings[_0x24b3b9(0x1f0)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x5c65a1),tgBot[_0x24b3b9(0x356)](/resetpw_(.+)/,async _0x1da71c=>{const _0x3acc0b=_0x24b3b9,_0xd96687=_0x1da71c[_0x3acc0b(0x36a)][0x1];_0x1da71c[_0x3acc0b(0x1a4)]();if(_0xd96687!='no'){const _0x3ea354=0xf,_0x556c80=_0x3acc0b(0x2fd),_0x48e2ee=Array[_0x3acc0b(0x22e)](crypto['randomFillSync'](new Uint32Array(_0x3ea354)))[_0x3acc0b(0x357)](_0x10f7af=>_0x556c80[_0x10f7af%_0x556c80[_0x3acc0b(0x285)]])[_0x3acc0b(0x236)](''),_0x5b2910=bcrypt[_0x3acc0b(0x36b)](_0x48e2ee,saltRounds);storeSettings({'bbPassword':_0x5b2910}),await sendTelegram(_0x1da71c[_0x3acc0b(0x1c7)]['id'],_0x3acc0b(0x247)+_0x48e2ee,{'parse_mode':_0x3acc0b(0x32a)});}else await sendTelegram(_0x1da71c[_0x3acc0b(0x1c7)]['id'],'Password\x20reset\x20rejected');});}}function _0x5088(){const _0x44afe1=['storeConfiguration','running','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','backup/','replace','auth','telegraf','startsWith','mode','telegram','static','new-disabled','-----------------------------------------------------------------------------------','init','apiKey','length','You\x20can\x20use\x20the\x20following\x20commands:\x0a','emit','\x20minutes','2FA\x20login\x20rejected','Restarting\x20','botmanager','callback','toString','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Notifications\x20disabled\x0a','output-000.log','password','reply','update-bb','exit','hasOwnProperty','(((.+)+)+)+$','sort','pidExpireLogin','zip/','send','-results.json','max','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','Unauthorized\x20attempt\x20to\x20delete\x20alerts','headers','access','Invalid\x20authentication\x20token\x20(2)','staging','track','delete-alerts','************','latestversion','resetpw_yes','/backup\x20-\x20receive\x20backup\x20files\x0a','remove','off','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','readdirSync','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','confirm-message','output-002.log','on_','connected','config_alerts','Telegram\x20error:','slice','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','value','sendMessage','login\x20token\x20valid','http://localhost:',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','File\x20uploaded','::ffff:7f00:1','new','5\x20min','store-fiat','Token\x20blacklisted','host','\x1b[35m','(staging)','data','once','sha256','f2aRequired','0.0.0','Backup\x20file\x20unzipped\x20and\x20stored','getFullYear','sendFile','pki','User\x20has\x20been\x20validated','Unauthorized\x20attempt\x20to\x20delete\x20bot','place-order','binary','store','files','marketcapApi','stringify','yes','createWriteStream','update_no','build2','mixpanel','status\x20code\x20401','lastmsgtelegram','SIGTERM','message','path','backup-full','sortBy','get-messages','request','util','telegrammsg','storeHeadless','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','update-bot','full','get-portfolio','endsWith','5935433HoqHwB','disabled','store-settings','off_','bb-secure.json','search','toIPv4MappedAddress','\x20>\x20','enabled','telegramUsername','reject','\x20|\x20','get','placeOrder','download','\x1b[0m','No\x20authentication\x20token','Bot\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','write','Backup\x20file\x20uploaded',',\x20must\x20be\x20a\x204\x20digit\x20number',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Error\x20details:','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','/:bot/performance','reinstall_no','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','includes','open','alerts','clients','stopped','add-bot','exec','restore_yes_','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','config_orders','existsSync','get-logs','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','20501080mxKbRW','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','/names\x20-\x20show\x20bot\x20names\x0a','metrics_','add','Unauthorized\x20attempt\x20to\x20confirm\x20message','lowdb/adapters/FileSync','help','Bot\x20Mgr\x20>\x20','set','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','getHours','find','lowdb','Session\x20expired\x20for\x20user\x20...','RSA-OAEP','Unauthorized\x20attempt\x20to\x20store\x20configuration','kind','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','HTML','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Enabled\x20','DEFLATE','test','/update\x20-\x20update\x20Balance\x20Bot\x0a','logout','uncaughtException','Failed\x20to\x20download\x20','\x20|\x20user:\x20...','=>\x20Go\x20to\x20#CYA#http://','backup-files','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','\x1b[31m','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','command','writeFileSync','lastmsgemitted','update','timestamp','orders','getMonth','portfolio','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Markdown','resetpw_no','1732956zfznia','production','settings','status','decode64','telegram2FaApproval','messages','apply','telegramEnabled','version','toggle','botID','Invalid\x20username\x20or\x20IP\x20address','login2fa_reject_','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','config/','bbUsername','action','map','allow','private','temp/','/:bot/configuration','\x20|\x20client:\x20...','user','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20show\x20configuration','environment','show-config','live','6b67f3d61ee94b8f5c80b4affef4c4d9','logs','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','/help\x20-\x20show\x20available\x20commands\x0a','auto','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','event','match','hashSync','getStartingBalances','apiSecret','\x1b[33m','headless','\x20files\x20over\x20Telegram:','manual','privateKey','connection','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Telegraf\x20error:','rmSync','success','title','Restore\x20process\x20confirmed','2FA\x20login\x20required','6125748CVeiNa','expiry','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','notification','Unauthorized\x20attempt\x20to\x20get\x20events','sendMetricsTelegram',')\x20\x20\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','cancelLoading','username','secret','config','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','split','file','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','push','#RES#\x20if\x20running\x20on\x20server','log','keys','compareSync','type','Setting\x20access:\x20','stop','Allow\x20login\x20from\x20IP\x20address\x20','assign','tempaccess_5_','cloneDeep','http','Error\x20sending\x20','resetHistory','graphql-request','restore_no_','token','All\x20bots','login','\x20only\x0a','ipaddr.js','constructor','node','login2fa_','generateAsync','#RES#','bot.js','mkdirSync','/output-000.log','simple','use','jsonwebtoken','encryptedUuid','verify','loginRequired','onepagemode','exchange','getMinutes','Unauthorized\x20attempt\x20to\x20download\x20','address','ETH','referer','2FA\x20required','isIPv4MappedAddress','index.html','reason','server','editMessageReplyMarkup','secure','string','2FA','telegramIpApproval','defaults','decrypt','family','storeFiat','output-003.log','1453018VsxQIy','Server','enable','All','apiPassword','padStart','filter','reinstall_yes','listen','debug','function','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','temporary\x20access\x20rejected','Notifications\x20disabled','Ok,\x20will\x20send\x20alert\x20notifications\x20only','#RES#\x20','bbPassword','getUTCHours','Logged\x20out\x20user\x20...','All\x20bots\x20running\x20right\x20now','-events.json','sign','forEach','name','socket','chat','sockets','rsa','isDirectory','whitelistEnabled','ipc','login\x20not\x20required','format','6eJQxZr','Unauthorized\x20login\x20attempt\x20(timeout)','\x20mode','version.json','/start','unlinkSync','showname','Your\x20installation\x20is\x20already\x20up\x20to\x20date','date-fns','env','--------------------------------------','started','Deleted\x20Bot\x20','get-starting-balances','SIGINT','backup','node-forge','inlineKeyboard','[ip-address]','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','botname','Yes','argv','tempaccess_reject_','Unauthorized\x20attempt\x20to\x20update\x20settings','ipv6','Disabled\x20','bb-settings.json','parse','portfolio_','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','logged\x20out','disconnect','telegramChatId','update_yes','\x20to\x20','handshake','toggle_','temporary\x20token\x20generated','getTime','number','jszip','telegramToken','inherit','statSync','store-headless','code','get-backup-files','getPortfolio','publicKey','exp','\x1b[34m','1000','Unauthorized\x20attempt\x20to\x20get\x20messages','Unauthorized\x20attempt\x20to\x20update\x20bot','|@|','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Unauthorized\x20attempt\x20to\x20add\x20bot','Restore\x20process\x20aborted','getDate','/:bot/support','Idling\x20(','internal','temporaryAccessAllowed','randomBytes','<b>Telegram\x20Bot\x20Status:</b>\x0a','Notifications\x20enabled\x0a','restart_','emitHistory','bot','Starting\x20#RED#Balance\x20Bot\x20v','logs/','Bot\x20Mgr\x20>\x20Stopping\x20','bots','\x1b[36m','express-fileupload','Error\x20removing\x20old\x20backup\x20files:','privateKeyFromPem','login\x20token\x20generated','IPv4','\x20-\x20','mtime','tempaccess_30_','::ffff:127.0.0.1','Access\x20enabled\x20for\x20','conn','backup-full.zip','close','delete-bot','build','pidRefreshToken','showConfig','Alerts','restore-backup-file','from','Unauthorized\x20attempt\x20to\x20log\x20out','2882715nleztn','cancel-loading','tkn','reinstall','uuid','Bot\x20Mgr\x20>\x20Starting\x20','join','***','copyFileSync','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','#RES#\x20if\x20running\x20locally\x0a','/status\x20-\x20show\x20bot(s)\x20status\x0a','Bot\x20Mgr\x20>\x20Toggling\x20','userid','create','crypto','2FA\x20login\x20token\x20generated','accept','generateKeyPair','invalid\x20credentials','Node.js\x20v','telegramEvents','metrics','Password\x20has\x20been\x20reset\x20to:\x20','names','No\x20bots\x20running\x20right\x20now','isValid','Starting\x20new\x20bot\x20|\x20Bot\x20','Orders','bot-','bbvNew','remoteAddress','backup-full@','updatebotmanager','getSeconds','any','1427120DhXhkK','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Logged\x20in\x20user\x20...','.zip','<b>Balance\x20Bot\x20Status:</b>\x0a','button','clientip','replyWithDocument','all','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','port','Starting\x20(','/metrics\x20-\x20show\x20bot\x20performance\x0a','express','config_all','blacklist',':\x20Bot\x20Mgr\x20>\x20','/disable\x20-\x20disable\x20notifications\x0a','kill','error','then','publicKeyToPem','output-001.log','reload','range','Invalid\x20IP\x20address','Unauthorized\x20attempt\x20to\x20get\x20portfolio','-config.json','timeshift','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','readFileSync','child_process','warning','login\x20required'];_0x5088=function(){return _0x44afe1;};return _0x5088();}async function confirmRestore(_0x39b2ab,_0x4b5830){const _0x89d00d=_0x6371da;io['to'](_0x89d00d(0x28b))['emit'](_0x89d00d(0x37e),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x89d00d(0x377));if(tgBot&&settings['telegramChatId']){const _0x2a0935=uuidRandom();tmpStorage[_0x2a0935]={'path':_0x39b2ab,'filename':_0x4b5830};const _0x591793=Markup[_0x89d00d(0x1e0)]([Markup[_0x89d00d(0x259)]['callback']('yes',_0x89d00d(0x310)+_0x2a0935),Markup[_0x89d00d(0x259)][_0x89d00d(0x28c)]('no',_0x89d00d(0x39b)+_0x2a0935)]);await sendTelegram(settings[_0x89d00d(0x1f0)],_0x89d00d(0x306),_0x591793),tgBot[_0x89d00d(0x356)](/restore_(.+)_(.+)/,async _0x500ef4=>{const _0x169b7f=_0x89d00d,_0x492581=_0x500ef4[_0x169b7f(0x36a)][0x1],_0x40eea3=_0x500ef4[_0x169b7f(0x36a)][0x2],{path:_0x314a8d,filename:_0x49d9b8}=tmpStorage[_0x40eea3];delete tmpStorage[_0x40eea3],_0x500ef4[_0x169b7f(0x1a4)](),_0x492581==_0x169b7f(0x2d5)?(logger[_0x169b7f(0x1b7)](_0x169b7f(0x379)),await sendTelegram(_0x500ef4[_0x169b7f(0x1c7)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x169b7f(0x32a)}),unzipFile(_0x314a8d,_0x49d9b8)):(logger[_0x169b7f(0x1b7)](_0x169b7f(0x20a)),await sendTelegram(_0x500ef4[_0x169b7f(0x1c7)]['id'],_0x169b7f(0x20a)));});}}function getServerTime(){const _0x4cbd8a=_0x6371da,_0x3e3674=new Date();return _0x3e3674[_0x4cbd8a(0x2ca)]()+'/'+(_0x3e3674['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x3e3674['getDate']()[_0x4cbd8a(0x28d)]()[_0x4cbd8a(0x1b3)](0x2,'0')+'\x20'+_0x3e3674[_0x4cbd8a(0x321)]()[_0x4cbd8a(0x28d)]()['padStart'](0x2,'0')+':'+_0x3e3674['getMinutes']()['toString']()[_0x4cbd8a(0x1b3)](0x2,'0')+':'+_0x3e3674['getSeconds']()[_0x4cbd8a(0x28d)]()[_0x4cbd8a(0x1b3)](0x2,'0');}function getTimeStamp(){const _0x552919=_0x6371da,_0x499bdd=shiftedTime();return _0x499bdd[_0x552919(0x2ca)]()+'/'+(_0x499bdd[_0x552919(0x340)]()+0x1)['toString']()[_0x552919(0x1b3)](0x2,'0')+'/'+_0x499bdd[_0x552919(0x20b)]()['toString']()[_0x552919(0x1b3)](0x2,'0')+'\x20'+_0x499bdd[_0x552919(0x321)]()[_0x552919(0x28d)]()[_0x552919(0x1b3)](0x2,'0')+':'+_0x499bdd['getMinutes']()[_0x552919(0x28d)]()[_0x552919(0x1b3)](0x2,'0')+':'+_0x499bdd[_0x552919(0x252)]()[_0x552919(0x28d)]()[_0x552919(0x1b3)](0x2,'0');}function getCleanTimeStamp(){const _0x93abb3=_0x6371da,_0x182e98=shiftedTime();return _0x182e98[_0x93abb3(0x2ca)]()+(_0x182e98[_0x93abb3(0x340)]()+0x1)[_0x93abb3(0x28d)]()[_0x93abb3(0x1b3)](0x2,'0')+_0x182e98[_0x93abb3(0x20b)]()[_0x93abb3(0x28d)]()['padStart'](0x2,'0')+'-'+_0x182e98['getHours']()[_0x93abb3(0x28d)]()[_0x93abb3(0x1b3)](0x2,'0')+_0x182e98[_0x93abb3(0x19a)]()[_0x93abb3(0x28d)]()[_0x93abb3(0x1b3)](0x2,'0')+_0x182e98[_0x93abb3(0x252)]()[_0x93abb3(0x28d)]()[_0x93abb3(0x1b3)](0x2,'0');}function shiftedTime(){const _0x2eaca5=_0x6371da,_0x288799=new Date();let _0x377531=_0x288799;if(settings[_0x2eaca5(0x270)]&&settings[_0x2eaca5(0x270)]!==0x0)_0x377531=fns[_0x2eaca5(0x31a)](_0x288799,{'hours':settings['timeshift']});return _0x377531;}async function startScheduler(){const _0x51a4a7=_0x6371da,_0x30f304=new Date()[_0x51a4a7(0x1bf)](),_0x442440=shiftedTime()[_0x51a4a7(0x321)]();_0x442440==0x4&&backupConfigFiles(),_0x442440==0x0&&(rotateLogFiles(),logger[_0x51a4a7(0x1b7)](_0x51a4a7(0x1d9)),logger[_0x51a4a7(0x1b7)]('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0x51a4a7(0x2a2)?_0x51a4a7(0x2c3):'')),logger[_0x51a4a7(0x1b7)](_0x51a4a7(0x1d9))),_0x30f304%0x6==0x0&&triggerAnalytics(),_0x30f304%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x51629d){const _0x163269=_0x6371da;logger[_0x163269(0x1b7)]('Restore\x20backup\x20file\x20'+_0x51629d);const _0xefa55c=getBotsWithMode();_0xefa55c['length']>0x0?confirmRestore(configbackuppath,_0x51629d):unzipFile(configbackuppath,_0x51629d);}async function getBackupFiles(_0x498f43=null){const _0x4ca685=_0x6371da;let _0x9ace93=[],_0x2ee045=fs[_0x4ca685(0x2ac)](configbackuppath,{'withFileTypes':!![]});_0x2ee045[_0x4ca685(0x297)]((_0x15659c,_0x55962f)=>_0x15659c[_0x4ca685(0x1c5)]<_0x55962f['name']?0x1:_0x55962f[_0x4ca685(0x1c5)]<_0x15659c[_0x4ca685(0x1c5)]?-0x1:0x0),_0x2ee045[_0x4ca685(0x1c4)](_0x45450f=>{const _0x58c9fb=_0x4ca685;if(!_0x45450f[_0x58c9fb(0x1ca)]()&&_0x45450f['name'][_0x58c9fb(0x27d)](_0x58c9fb(0x250))&&_0x45450f[_0x58c9fb(0x1c5)][_0x58c9fb(0x2ea)](_0x58c9fb(0x257))){const _0x55fa01=formatDate(fs['statSync'](configbackuppath+_0x45450f[_0x58c9fb(0x1c5)])[_0x58c9fb(0x221)]);_0x9ace93[_0x58c9fb(0x38b)]({'name':_0x45450f['name'],'mtime':_0x55fa01});}});if(_0x498f43)io['to'](_0x498f43)['emit'](_0x4ca685(0x335),_0x9ace93);else return _0x9ace93;}async function backupConfigFiles(){const _0x3dced7=_0x6371da;await zipFiles(_0x3dced7(0x2df));const _0x312e9b=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x3dced7(0x226),configbackuppath+('backup-full@'+_0x312e9b+'.zip'));let _0x44baba=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x44baba[_0x3dced7(0x297)]((_0x15b1a8,_0x3a95d4)=>_0x15b1a8['name']<_0x3a95d4['name']?0x1:_0x3a95d4[_0x3dced7(0x1c5)]<_0x15b1a8[_0x3dced7(0x1c5)]?-0x1:0x0),_0x44baba['length']>maxBackups&&fs[_0x3dced7(0x1d4)](configbackuppath+_0x44baba[_0x44baba[_0x3dced7(0x285)]-0x1]['name']);}function rotateLogFiles(){const _0x3ce38a=_0x6371da,_0x5989bf=fs[_0x3ce38a(0x1fb)](logspath+_0x3ce38a(0x290)),_0x1abd9f=_0x5989bf['size']/0x400;if(_0x1abd9f>0x64){let _0x3515da=fs[_0x3ce38a(0x2ac)](logspath,{'withFileTypes':!![]});_0x3515da[_0x3ce38a(0x297)]((_0x1d4098,_0x23cf83)=>_0x1d4098[_0x3ce38a(0x1c5)]<_0x23cf83[_0x3ce38a(0x1c5)]?0x1:_0x23cf83['name']<_0x1d4098[_0x3ce38a(0x1c5)]?-0x1:0x0),_0x3515da[_0x3ce38a(0x1c4)](_0x4a3e08=>{const _0x5bc706=_0x3ce38a;if(_0x4a3e08[_0x5bc706(0x1c5)]=='output-002.log')fs[_0x5bc706(0x238)](logspath+_0x4a3e08[_0x5bc706(0x1c5)],logspath+_0x5bc706(0x1ad));if(_0x4a3e08[_0x5bc706(0x1c5)]==_0x5bc706(0x26a))fs['copyFileSync'](logspath+_0x4a3e08['name'],logspath+_0x5bc706(0x2af));_0x4a3e08[_0x5bc706(0x1c5)]==_0x5bc706(0x290)&&(fs[_0x5bc706(0x238)](logspath+_0x4a3e08[_0x5bc706(0x1c5)],logspath+'output-001.log'),fs[_0x5bc706(0x33b)](logspath+_0x4a3e08[_0x5bc706(0x1c5)],''));});}}async function zipFiles(_0x1ab499){const _0x2a2ce7=_0x6371da;let _0x2183f5;if(_0x1ab499=='logs')_0x2183f5=logspath;if(_0x1ab499==_0x2a2ce7(0x1de))_0x2183f5=configpath;if(_0x1ab499==_0x2a2ce7(0x2df))_0x2183f5=configpath;let _0x28caaa=fs[_0x2a2ce7(0x2ac)](_0x2183f5,{'withFileTypes':!![]});const _0x3f3d12=new JSZip();_0x28caaa[_0x2a2ce7(0x1c4)](_0x4b66fa=>{const _0x25fb8c=_0x2a2ce7;if(!_0x4b66fa['isDirectory']()){let _0x4defe0=fs[_0x25fb8c(0x272)](_0x2183f5+_0x4b66fa[_0x25fb8c(0x1c5)]);if(_0x1ab499==_0x25fb8c(0x1de)){const _0x4bd456=/^bot-[0-9]{3}-config.json$/,_0x31a910=_0x4bd456[_0x25fb8c(0x32e)](_0x4b66fa['name']);if(_0x31a910){const _0xe2a696=JSON['parse'](_0x4defe0);if(_0xe2a696[_0x25fb8c(0x215)][0x0]){_0xe2a696[_0x25fb8c(0x215)][0x0]['apiKey']=_0x25fb8c(0x237),_0xe2a696[_0x25fb8c(0x215)][0x0][_0x25fb8c(0x36d)]=_0x25fb8c(0x237);if(_0xe2a696[_0x25fb8c(0x215)][0x0][_0x25fb8c(0x1b2)])_0xe2a696[_0x25fb8c(0x215)][0x0]['apiPassword']=_0x25fb8c(0x237);}_0x4defe0=JSON[_0x25fb8c(0x2d4)](_0xe2a696,null,0x2);}if(_0x4b66fa[_0x25fb8c(0x1c5)]=='bb-settings.json'){const _0x405300=JSON[_0x25fb8c(0x1eb)](_0x4defe0);if(_0x405300[_0x25fb8c(0x347)]['loginRequired'])_0x405300['settings']['loginRequired']=![];if(_0x405300[_0x25fb8c(0x347)][_0x25fb8c(0x1be)])_0x405300[_0x25fb8c(0x347)][_0x25fb8c(0x1be)]=_0x25fb8c(0x237);if(_0x405300[_0x25fb8c(0x347)][_0x25fb8c(0x1f9)])_0x405300[_0x25fb8c(0x347)][_0x25fb8c(0x1f9)]=_0x25fb8c(0x237);if(_0x405300[_0x25fb8c(0x347)]['telegramChatId'])_0x405300[_0x25fb8c(0x347)]['telegramChatId']=null;if(_0x405300[_0x25fb8c(0x347)][_0x25fb8c(0x2d3)])_0x405300[_0x25fb8c(0x347)][_0x25fb8c(0x2d3)]='***';_0x4defe0=JSON['stringify'](_0x405300,null,0x2);}if(_0x4b66fa[_0x25fb8c(0x1c5)]!=_0x25fb8c(0x2ef))_0x3f3d12[_0x25fb8c(0x389)](_0x4b66fa[_0x25fb8c(0x1c5)],_0x4defe0);}else _0x3f3d12[_0x25fb8c(0x389)](_0x4b66fa[_0x25fb8c(0x1c5)],_0x4defe0);}});const _0x6f6ef1=await _0x3f3d12[_0x2a2ce7(0x3a4)]({'type':_0x2a2ce7(0x1a6),'base64':![],'compression':_0x2a2ce7(0x32d)});fs[_0x2a2ce7(0x33b)](zippath+(_0x1ab499+_0x2a2ce7(0x257)),_0x6f6ef1,_0x2a2ce7(0x2d0));}async function unzipFile(_0x3c9afe,_0x44bd24){const _0x2f10d2=_0x6371da;fs[_0x2f10d2(0x2ac)](configpath,{'withFileTypes':!![]})[_0x2f10d2(0x1c4)](_0x2f78f6=>{const _0x6694ef=_0x2f10d2;if(!_0x2f78f6[_0x6694ef(0x1ca)]())fs[_0x6694ef(0x376)](configpath+_0x2f78f6[_0x6694ef(0x1c5)]);});const _0x46bf4c=fs[_0x2f10d2(0x272)](_0x3c9afe+_0x44bd24,_0x2f10d2(0x2d0)),_0xf8564b=await JSZip['loadAsync'](_0x46bf4c,{'base64':![],'checkCRC32':!![]});for(const _0x45923a of Object[_0x2f10d2(0x38e)](_0xf8564b[_0x2f10d2(0x2d2)])){const _0x6b25ef=_0xf8564b[_0x2f10d2(0x2d2)][_0x45923a],_0x5f131b=await _0x6b25ef['async'](_0x2f10d2(0x1a6));fs[_0x2f10d2(0x33b)](configpath+_0x6b25ef[_0x2f10d2(0x1c5)],_0x5f131b);}fs[_0x2f10d2(0x2ac)](temppath,{'withFileTypes':!![]})[_0x2f10d2(0x1c4)](_0x10d4bc=>{const _0x4b3300=_0x2f10d2;if(!_0x10d4bc[_0x4b3300(0x1ca)]())fs[_0x4b3300(0x376)](temppath+_0x10d4bc['name']);}),logger[_0x2f10d2(0x1b7)](_0x2f10d2(0x2c9)),process[_0x2f10d2(0x29a)]({'restore':!![]},_0x2be654=>{});}async function getPublicIp(){const _0x31faf7=_0x6371da;try{const _0x101294=await axios['get']('https://api.ipify.org?format=json');publicip=_0x101294[_0x31faf7(0x2c4)]['ip'];}catch(_0x463421){}}async function triggerAnalytics(){const _0x43a5c9=_0x6371da;if(!publicip)await getPublicIp();const _0x400b17=getBotsWithMode();let _0x35cae4=0x0;_0x400b17['forEach'](_0x529a7f=>{const _0x443db8=_0x2e16;if(_0x529a7f[_0x443db8(0x348)]===_0x443db8(0x2f3))_0x35cae4++;});const _0x1c62df=getBotExchanges();mixpanel[_0x43a5c9(0x2a3)](_0x43a5c9(0x1af),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x400b17[_0x43a5c9(0x285)],'numbotsenabled':_0x35cae4,'exchanges':_0x1c62df,'environment':environment});}async function getMessages(){const _0x459024=_0x6371da,_0x3c2497=_0x459024(0x338),_0x3e30fb=new GraphQLClient(_0x3c2497),_0x26180a={'authorization':_0x459024(0x339)},_0x5c0b29=serverversion[_0x459024(0x388)]('.'),_0x18ecf3=_0x5c0b29[0x0]+'.'+_0x5c0b29[0x1],_0xd1b972=Math['min'](settings[_0x459024(0x2db)],settings['lastmsgemitted']),_0x28edeb={'last':parseInt(_0xd1b972),'bbm':_0x18ecf3},_0x967300=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x204f5b;try{_0x204f5b=await _0x3e30fb[_0x459024(0x2e2)](_0x967300,_0x28edeb,_0x26180a);}catch(_0xa91f34){}if(_0x204f5b&&_0x204f5b[_0x459024(0x34b)]){let _0x2047cd=settings[_0x459024(0x2db)],_0x2e08d0=settings[_0x459024(0x2db)];newMessages=[];for(const _0x3d190c of _0x204f5b['messages']){newMessages[_0x459024(0x38b)](_0x3d190c);let _0x2660c2=![];_0x3d190c['bbvNew']&&(updateSetting(_0x459024(0x2a6),_0x3d190c[_0x459024(0x24e)]),_0x2660c2=isNewerVersion(serverversion,_0x3d190c['bbvNew'])||serverversion==_0x3d190c['bbvNew']);if(!_0x2660c2&&_0x3d190c[_0x459024(0x1f7)]>_0x2047cd){if(_0x3d190c['bbvReceive']===_0x459024(0x253)||serverversion[_0x459024(0x27d)](_0x3d190c['bbvReceive'])){let _0x2b1f39=''+_0x3d190c[_0x459024(0x378)]+'\x0a\x0a'+_0x3d190c[_0x459024(0x2dd)];const _0x2e0d62=await sendTelegramMsg(toTelegramMarkdown(_0x2b1f39),_0x459024(0x343));_0x2047cd=_0x3d190c[_0x459024(0x1f7)];}}_0x2e08d0=_0x3d190c[_0x459024(0x1f7)];}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x459024(0x2db),_0x2e08d0),emitMessages();}}function emitMessages(){const _0x388e06=_0x6371da,_0x4a1842=settings[_0x388e06(0x33c)];let _0x178366=[];newMessages[_0x388e06(0x1c4)](_0x2c7441=>{const _0x4de5be=_0x388e06;_0x2c7441[_0x4de5be(0x1f7)]>_0x4a1842&&_0x178366[_0x4de5be(0x38b)](_0x2c7441);}),_0x178366['length']>0x0&&getAllClients()['forEach'](_0x53925c=>{const _0x1eb177=_0x388e06;getSocket(_0x53925c['id'])[_0x1eb177(0x287)](_0x1eb177(0x2dd),_0x178366);});}function confirmMessage(_0xeb714c){const _0x389fc9=_0x6371da;updateSetting(_0x389fc9(0x33c),Number(_0xeb714c));}function isNewerVersion(_0x3b0ae9,_0x1af0a4){const _0x18cc9a=_0x6371da,_0xb9653e=_0x1af0a4['split']('.'),_0xc1c764=_0x3b0ae9[_0x18cc9a(0x388)]('.');for(var _0x5b66df=0x0;_0x5b66df<_0xc1c764[_0x18cc9a(0x285)];_0x5b66df++){const _0x3f47a3=~~_0xc1c764[_0x5b66df],_0x56706c=~~_0xb9653e[_0x5b66df];if(_0x3f47a3>_0x56706c)return!![];if(_0x3f47a3<_0x56706c)return![];}return![];}function toTelegramMarkdown(_0x76ccb0){const _0x6921c9=_0x6371da,_0x5a7f69=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x561dd5=/\*{2}(.+?)\*{2}/gim;return _0x76ccb0=_0x76ccb0['replace'](_0x5a7f69,'$1_$2_$3')[_0x6921c9(0x27a)](_0x561dd5,'*$1*'),_0x76ccb0;}async function validateConfigFile(){const _0x2b6634=_0x6371da,_0x43db48=dbConfig[_0x2b6634(0x2f7)](_0x2b6634(0x219))[_0x2b6634(0x2e0)](_0x2b6634(0x350))[_0x2b6634(0x2b6)]()||[];if(_0x43db48['length']==0x0){let _0x397db8=0x0,_0xb533d0=[];const _0x48c499=/^bot-([0-9]{3})-config.json$/,_0x310455=fs[_0x2b6634(0x2ac)](configpath);_0x310455['forEach'](_0x366313=>{const _0x2d3a84=_0x2b6634,_0x4c79e5=_0x48c499[_0x2d3a84(0x30f)](_0x366313);if(_0x4c79e5){const _0x4389d3=_0x4c79e5[0x1];let _0x34c43c=getBotAttributes(_0x4389d3);_0xb533d0[_0x2d3a84(0x38b)]({'botID':_0x4389d3,'botname':_0x34c43c['botname'],'status':_0x2d3a84(0x2ec),'live':_0x2d3a84(0x30d)}),_0x397db8++;}}),_0x397db8!=0x0&&(dbConfig[_0x2b6634(0x2f7)](_0x2b6634(0x219))[_0x2b6634(0x394)](_0xb533d0)[_0x2b6634(0x2fe)](),config=_0xb533d0,restoredConfigFile=_0x397db8);}}async function restoreConfigNotify(_0x23a1da){const _0x4dd23d=_0x6371da;let _0x21003f;if(restoredConfigFile==0x1)_0x21003f=_0x4dd23d(0x207);else _0x21003f=_0x4dd23d(0x1e2);if(_0x23a1da)io['to']('botmanager')[_0x4dd23d(0x287)]('notification',_0x21003f);else{logger[_0x4dd23d(0x192)](_0x4dd23d(0x282)),logger['simple'](_0x21003f),logger[_0x4dd23d(0x192)](_0x4dd23d(0x282)),logger[_0x4dd23d(0x192)]('');if(tgBot&&settings[_0x4dd23d(0x1f0)]&&settings['telegramEvents']!=_0x4dd23d(0x33f))await sendTelegram(settings[_0x4dd23d(0x1f0)],'Bot\x20Mgr\x20>\x20'+_0x21003f);}}function decryptRSA(_0x3998fe,_0x52da4c){const _0xd4d3e3=_0x6371da,_0x556bd9=forge['pki'][_0xd4d3e3(0x21d)](_0x3998fe),_0x5370bd=_0x556bd9[_0xd4d3e3(0x1aa)](forge[_0xd4d3e3(0x2e3)][_0xd4d3e3(0x349)](_0x52da4c),_0xd4d3e3(0x325),{'md':forge['md'][_0xd4d3e3(0x2c6)][_0xd4d3e3(0x23e)](),'mgf1':{'md':forge['md'][_0xd4d3e3(0x2c6)][_0xd4d3e3(0x23e)]()}});return _0x5370bd;}function validateCredentials(_0x1150d5,_0x38bf46){const _0x35cd8d=_0x6371da;if(_0x1150d5['username']==settings[_0x35cd8d(0x355)]&&bcrypt[_0x35cd8d(0x38f)](_0x1150d5[_0x35cd8d(0x291)],settings['bbPassword'])){if(settings[_0x35cd8d(0x2c7)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x45b546=generateLoginToken(_0x38bf46);return{'allow':!![],'reason':_0x35cd8d(0x21e),'token':_0x45b546};}}else return{'allow':![],'reason':_0x35cd8d(0x243),'token':null};}function refreshToken(_0xc8de93){const _0xbd48c6=generateLoginToken(_0xc8de93);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0xbd48c6};}function validateAccess(_0x1735b0,_0x11fddf,_0x55a449){const _0x400276=_0x6371da,_0x57abf9=_0x55a449?_0x55a449:devices[_0x11fddf]['ip'];let _0x3e5ac4;const _0x3e277c=_0x5dbacf=>{const _0x3c7142=_0x2e16;if(settings[_0x3c7142(0x197)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x11fddf)){const _0xd679c1=generateLoginToken(_0x11fddf);return{'allow':!![],'reason':_0x3c7142(0x240),'token':_0xd679c1};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x3e5ac4=validToken(_0x5dbacf,_0x11fddf),_0x3e5ac4['hasOwnProperty'](_0x3c7142(0x377))?{'allow':!![],'reason':_0x3c7142(0x2b8),'token':_0x5dbacf}:{'allow':![],'reason':_0x3c7142(0x275),'token':null};}else return{'allow':!![],'reason':_0x3c7142(0x1cd),'token':null};};if(settings[_0x400276(0x1cb)]){let _0x261c3e=[...settings['whitelist'],'::1',_0x400276(0x223),'127.0.0.1',_0x400276(0x2bc)];if(_0x261c3e[_0x400276(0x309)](_0x57abf9))return _0x3e277c(_0x1735b0);else{_0x3e5ac4=validToken(_0x1735b0,_0x11fddf);if(_0x3e5ac4['hasOwnProperty'](_0x400276(0x377)))return _0x3e277c(_0x1735b0);else{if(telegramIpApproved(_0x11fddf)){const _0xc42c87=generateToken(_0x11fddf);return _0x3e5ac4=_0x3e277c(_0x1735b0),_0x3e5ac4[_0x400276(0x358)]?{'allow':!![],'reason':_0x400276(0x1f5),'token':_0xc42c87}:_0x3e5ac4;}else return settings[_0x400276(0x20f)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x3e277c(_0x1735b0);}function timelyDecrypt(_0x274703,_0x16374c,_0x5888c9='@'){const _0x291fc5=_0x6371da;if(_0x274703)try{const _0x5cb68d=decryptRSA(secure[_0x291fc5(0x372)],_0x274703),_0x1925c2=_0x5cb68d[_0x291fc5(0x388)](_0x5888c9)[0x0],_0x58a090=_0x5cb68d['split'](_0x5888c9)[0x1],_0xab8385=new Date()[_0x291fc5(0x1f6)]();if(_0x16374c){if(_0xab8385-_0x58a090<maxSecretAge*0x3e8)return _0x1925c2;else return![];}else return _0x1925c2;}catch(_0x210c14){return![];}else return![];}const validToken=(_0x5573f2,_0x12b63b)=>{const _0x4b8949=_0x6371da,_0x409ceb=devices[_0x12b63b]['ip'];if(!_0x5573f2)return{'error':_0x4b8949(0x2fb)};for(let _0x444648 of blacklist){if(_0x444648[_0x4b8949(0x39c)]==_0x5573f2)return{'error':_0x4b8949(0x2c0)};}let _0x4b7bb6;try{_0x4b7bb6=jwt[_0x4b8949(0x196)](_0x5573f2,secure['secret']+_0x12b63b);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x4b7bb6[_0x4b8949(0x295)]('clientip')&&!_0x4b7bb6[_0x4b8949(0x295)](_0x4b8949(0x384))||!_0x4b7bb6['hasOwnProperty'](_0x4b8949(0x201)))return{'error':_0x4b8949(0x2a1)};if(!_0x4b7bb6[_0x4b8949(0x295)]('username')&&_0x4b7bb6['hasOwnProperty'](_0x4b8949(0x25a))){const {clientip:_0x276676}=_0x4b7bb6;return _0x409ceb==_0x276676?{'success':_0x4b8949(0x2cd)}:{'error':_0x4b8949(0x26d)};}else{if(_0x4b7bb6['hasOwnProperty'](_0x4b8949(0x384))&&_0x4b7bb6[_0x4b8949(0x295)]('clientip')){const {username:_0x85991e,clientip:_0x4ff3cf}=_0x4b7bb6;return settings[_0x4b8949(0x355)]==_0x85991e&&_0x409ceb==_0x4ff3cf?{'success':_0x4b8949(0x2cd)}:{'error':_0x4b8949(0x351)};}}},generateLoginToken=_0x343858=>{const _0x3dafb0=_0x6371da;if(_0x343858){const _0x3cb01e=devices[_0x343858]['ip'];return jwt[_0x3dafb0(0x1c3)]({'username':settings['bbUsername'],'clientip':_0x3cb01e},secure[_0x3dafb0(0x385)]+_0x343858,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0xda20c4=>{const _0x3e0e6b=_0x6371da;if(_0xda20c4){const _0x411dba=devices[_0xda20c4]['ip'];return jwt[_0x3e0e6b(0x1c3)]({'clientip':_0x411dba},secure['secret']+_0xda20c4,{'expiresIn':devices[_0xda20c4][_0x3e0e6b(0x1a8)][_0x3e0e6b(0x37c)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x203c2d=>{const _0x3cd414=_0x6371da;let _0x13096e=![];return devices[_0x203c2d][_0x3cd414(0x1a8)]&&devices[_0x203c2d]['telegramIpApproval'][_0x3cd414(0x37c)]!=_0x3cd414(0x2f5)&&(_0x13096e=devices[_0x203c2d][_0x3cd414(0x1a8)][_0x3cd414(0x25a)]==devices[_0x203c2d]['ip']&&new Date()['getTime']()-devices[_0x203c2d][_0x3cd414(0x1a8)]['timestamp']<devices[_0x203c2d][_0x3cd414(0x1a8)][_0x3cd414(0x37c)]*0x3c*0x3e8),_0x13096e;},telegram2FaApproved=_0x19024c=>{const _0x31518a=_0x6371da;let _0x1b72e3=![];return devices[_0x19024c][_0x31518a(0x34a)]&&devices[_0x19024c][_0x31518a(0x34a)]['expiry']!='reject'&&(_0x1b72e3=devices[_0x19024c][_0x31518a(0x34a)][_0x31518a(0x25a)]==devices[_0x19024c]['ip']&&new Date()[_0x31518a(0x1f6)]()-devices[_0x19024c][_0x31518a(0x34a)][_0x31518a(0x33e)]<devices[_0x19024c][_0x31518a(0x34a)]['expiry']*0x3c*0x3e8),_0x1b72e3;},normalizeIP=_0x143b19=>{const _0x3d5261=_0x6371da;let _0xc4f385=null,_0x4735e4=null;if(ipaddr[_0x3d5261(0x24a)](_0x143b19)){const _0x26c779=ipaddr[_0x3d5261(0x1eb)](_0x143b19);_0x26c779[_0x3d5261(0x327)]()===_0x3d5261(0x1e8)?(_0x26c779[_0x3d5261(0x1a0)]()&&(_0xc4f385=_0x26c779['toIPv4Address']()[_0x3d5261(0x28d)]()),_0x4735e4=_0x26c779['toString']()):(_0xc4f385=_0x26c779[_0x3d5261(0x28d)](),_0x4735e4=_0x26c779[_0x3d5261(0x2f1)]()[_0x3d5261(0x28d)]());}return{'show':_0xc4f385?_0xc4f385:_0x4735e4,'store':_0x4735e4};};function formatDate(_0x15f6ca){const _0x3386a1=_0x6371da;return _0x15f6ca[_0x3386a1(0x2ca)]()+'/'+(_0x15f6ca['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x15f6ca['getDate']()[_0x3386a1(0x28d)]()[_0x3386a1(0x1b3)](0x2,'0')+'\x20'+_0x15f6ca[_0x3386a1(0x321)]()[_0x3386a1(0x28d)]()[_0x3386a1(0x1b3)](0x2,'0')+':'+_0x15f6ca[_0x3386a1(0x19a)]()['toString']()[_0x3386a1(0x1b3)](0x2,'0')+':'+_0x15f6ca['getSeconds']()[_0x3386a1(0x28d)]()[_0x3386a1(0x1b3)](0x2,'0');}function sleep(_0x434167){return new Promise(_0x5e291c=>setTimeout(_0x5e291c,_0x434167));}