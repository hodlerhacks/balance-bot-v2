const _0x173b69=_0x2275;(function(_0x3b1f0c,_0x8f0629){const _0x2b2494=_0x2275,_0x475f8d=_0x3b1f0c();while(!![]){try{const _0x5d7c53=parseInt(_0x2b2494(0x1d0))/0x1*(parseInt(_0x2b2494(0xeb))/0x2)+parseInt(_0x2b2494(0x104))/0x3+parseInt(_0x2b2494(0x23e))/0x4+parseInt(_0x2b2494(0x282))/0x5*(parseInt(_0x2b2494(0xb3))/0x6)+-parseInt(_0x2b2494(0xfa))/0x7*(parseInt(_0x2b2494(0x298))/0x8)+parseInt(_0x2b2494(0x13f))/0x9+-parseInt(_0x2b2494(0x267))/0xa*(parseInt(_0x2b2494(0x149))/0xb);if(_0x5d7c53===_0x8f0629)break;else _0x475f8d['push'](_0x475f8d['shift']());}catch(_0x531659){_0x475f8d['push'](_0x475f8d['shift']());}}}(_0x3249,0x9acdd));const _0x4044f6=function(){let _0x2b059c=!![];return function(_0x38e90b,_0x3f3d9b){const _0x3302d7=_0x2b059c?function(){const _0x390b67=_0x2275;if(_0x3f3d9b){const _0x1febaf=_0x3f3d9b[_0x390b67(0x197)](_0x38e90b,arguments);return _0x3f3d9b=null,_0x1febaf;}}:function(){};return _0x2b059c=![],_0x3302d7;};}(),_0x115db3=_0x4044f6(this,function(){const _0x431260=_0x2275;return _0x115db3[_0x431260(0x191)]()[_0x431260(0x90)](_0x431260(0x225))[_0x431260(0x191)]()[_0x431260(0x15b)](_0x115db3)[_0x431260(0x90)]('(((.+)+)+)+$');});_0x115db3();'use strict';process[_0x173b69(0x1d2)][_0x173b69(0x1d7)]=0x1;const childProcess=require(_0x173b69(0x26e)),fs=require('fs'),fns=require(_0x173b69(0x10a)),low=require(_0x173b69(0x1bf)),FileSync=require(_0x173b69(0x110)),path=require(_0x173b69(0x115)),crypto=require(_0x173b69(0x1f4)),forge=require('node-forge'),bcrypt=require(_0x173b69(0xb4)),jwt=require('jsonwebtoken'),ipaddr=require(_0x173b69(0xe7)),argv=require(_0x173b69(0x121))(process[_0x173b69(0x13a)]['slice'](0x2))[_0x173b69(0x13a)],uuidRandom=require(_0x173b69(0x11a)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x173b69(0x213)),axios=require(_0x173b69(0x22f)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x173b69(0x187)),fileUpload=require(_0x173b69(0x11b)),{networkInterfaces}=require('os'),JSZip=require(_0x173b69(0x134)),PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x173b69(0x14b)](PORT)&&(console[_0x173b69(0x226)](_0x173b69(0x1a9)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0x173b69(0x163)]||null,userID=argv[_0x173b69(0x1d5)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x173b69(0x12e)]['node'];function _0x2275(_0x517f90,_0x40f75c){const _0x1b07d1=_0x3249();return _0x2275=function(_0x115db3,_0x4044f6){_0x115db3=_0x115db3-0x8b;let _0x324983=_0x1b07d1[_0x115db3];return _0x324983;},_0x2275(_0x517f90,_0x40f75c);}let bbpath=_0x173b69(0xa8),bbpath2='';const botfile='bot.js',configfile=_0x173b69(0x1c7),settingsfile='bb-settings.json',securefile=_0x173b69(0xe8),environment=require('./'+bbpath2+'version.json')[_0x173b69(0xb1)]||_0x173b69(0x16a),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x173b69(0x139)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x173b69(0x95),configbackuppath=configpath+_0x173b69(0x223),logspath=userID?bbpath+_0x173b69(0x188)+userID+'/':bbpath+_0x173b69(0x188),zippath=userID?bbpath+_0x173b69(0x182)+userID+'/':bbpath+'zip/',loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x173b69(0x24e)+userID+'/':bbpath+_0x173b69(0x24e);!fs[_0x173b69(0x260)](configpath)&&fs[_0x173b69(0x261)](configpath);!fs[_0x173b69(0x260)](configbackuppath)&&fs[_0x173b69(0x261)](configbackuppath);!fs[_0x173b69(0x260)](logspath)&&fs[_0x173b69(0x261)](logspath);!fs[_0x173b69(0x260)](zippath)&&fs[_0x173b69(0x261)](zippath);!fs[_0x173b69(0x260)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x173b69(0x268)]({'bots':[]})[_0x173b69(0x192)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x173b69(0x92),'onepagemode':![],'marketcapApi':''}})[_0x173b69(0x192)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x173b69(0x268)]({'secure':{},'blacklist':[]})['write']();const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x173b69(0x19d),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x173b69(0x25b)]!=''&&settings[_0x173b69(0x25b)]!='***')&&settings[_0x173b69(0x1d1)]&&settings['telegramUsername']!='')initTelegram();function _0x3249(){const _0x1f21f=['cancelLoading','notification','sendPortfolioTelegram','alias','send','#RES#\x20','Unauthorized\x20attempt\x20to\x20store\x20configuration','Invalid\x20username\x20or\x20IP\x20address','Password\x20has\x20been\x20reset\x20to:\x20','config_all','build','\x20>\x20','bbPassword','remove','generateKeyPair','startsWith','http','getMinutes','Password\x20reset\x20rejected','CoinMarketCap\x20API\x20key\x20validated','lastmsgtelegram','full','address','keys','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','isIPv4MappedAddress','Enabled\x20Bot\x20','running','entries','Error\x20sending\x20','-config.json','reset-password','mode','sign','ipaddr.js','bb-secure.json','reload','2FA\x20login\x20token\x20generated','1888058rySOCo','reinstall_yes','Starting\x20Balance\x20Bot\x20reinstallation','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','version',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','fork','telegrammsg','on_','store-headless','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','file','Node.js\x20v','7BPAdNG','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','telegramEnabled','get-portfolio','-results.json','files','headers','#RES#','includes','.zip','2700627TpxxgV','once','Starting\x20new\x20bot\x20|\x20Bot\x20','status\x20code\x20401','match','backup-full','date-fns','reinstall','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','output-001.log','toIPv4MappedAddress','\x1b[35m','lowdb/adapters/FileSync','sha256','static','showConfig',')\x20\x20\x20|\x20Bot\x20','path','Error\x20details:','settings.','SIGTERM','::ffff:127.0.0.1','uuid-random','express-fileupload','ipc','inlineKeyboard','event','Starting\x20Balance\x20Bot\x20update','isDirectory','yargs/yargs','placeOrder','emit','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','push','endsWith','Logged\x20out\x20user\x20...','pki','/download/:type','server','Running\x20#RED#Balance\x20Bot\x20v','private','conn','versions','build2','launch','/:bot/history','temporary\x20token\x20generated','exchange','jszip','storeFiat','HTML','2FA\x20required','telegramChatId','clients','argv','[ip-address]','login\x20required','timestamp','resetHistory','4736169hbNhBD','decode64','BCT','add','auto','join','All\x20bots\x20running\x20right\x20now','/update\x20-\x20update\x20Balance\x20Bot\x0a','apiPassword','Yes','12419Oeexoj','\x20minutes','test','Restoring\x20bot(s)\x20from\x20backup','enabled','Unauthorized\x20attempt\x20to\x20log\x20out','store','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','max','parse','bot-','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','userid',')\x20|\x20Bot\x20','toggle','isValid','loginRequired','simple','constructor','/:bot/performance','/:bot/coins','place-order','Bot\x20Mgr\x20>\x20','writeFileSync','inherit','Restarting\x20Bot\x20','host','binary','secret','Ok,\x20will\x20send\x20order\x20notifications\x20only','toggle_','address\x20already\x20in\x20use','start','production','started','publicKey','get-messages','filter','username','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','15\x20min','Bot\x20','Error\x20while\x20deleting\x20config\x20files:\x20','code','Markdown','bot','resetpw_no','number','alerts','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','reject','clientip','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','disabled','*$1*','then','request','zip/','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','get','whitelist','You\x20can\x20use\x20the\x20following\x20commands:\x0a','util','logs/','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','referer','reply','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','map','tempaccess_reject_','remoteAddress','toString','write','ipv6','config_orders','rsa','restore-backup-file','apply','action','User\x20has\x20been\x20validated','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','update-bb','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','6b67f3d61ee94b8f5c80b4affef4c4d9','metrics_','getFullYear','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','tkn','create','toggleBotMode','bbUsername','stringify','deleteHistoryAlerts','invalid\x20credentials','warning','Error:\x20Invalid\x20argument\x20','button','from','mtime','command','sendMessage','\x20mode','\x1b[36m','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','split','close','version.json','Unauthorized\x20attempt\x20to\x20confirm\x20message','Unauthorized\x20attempt\x20to\x20show\x20configuration','toggle-bot-mode','Access\x20enabled\x20for\x20','restore_no_','secure','Invalid\x20authentication\x20token\x20(2)','index.html','sendFile','login\x20token\x20valid','lowdb','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','get-logs','Backup\x20file\x20uploaded','_nsps','exp','/on\x20-\x20start\x20bot(s)\x0a','/status\x20-\x20show\x20bot(s)\x20status\x0a','bb-config.json','/:bot','assign','new-disabled','logged\x20out','$1_$2_$3','disable','rmSync','lastmsgemitted','1kUxuBY','telegramUsername','env','initclient','staging','user','store-fiat','NTBA_FIX_319','padStart','getDate','portfolio','#RES#\x20if\x20running\x20locally\x0a','telegram2FaApproval','reinstall-bb','Unauthorized\x20attempt\x20to\x20delete\x20alerts','kind','pidRefreshToken','DEFLATE','login\x20token\x20generated','<b>Telegram\x20Bot\x20Status:</b>\x0a','/disable\x20-\x20disable\x20notifications\x0a','Failed\x20to\x20download\x20','data','Server','Session\x20expired\x20for\x20user\x20...','replace','Login\x20accepted','Allow\x20login\x20from\x20IP\x20address\x20','/upload-backup','login2fa_reject_','help','Setting\x20access:\x20','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','error','accept','crypto','/backup\x20-\x20receive\x20backup\x20files\x0a','title','token','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','tempaccess_30_','update','allow','\x1b[31m','restart','format','name','getSeconds','::1','whitelistEnabled','-events.json','logs','slice','set','Deleted\x20Bot\x20','express','value','compareSync','socket','marketcapApi','backup-full.zip','debug','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','-----------------------------------------------------------------------------------','forEach','unlinkSync','mixpanel','stopped','botmanager','/:bot/portfolio','<b>Balance\x20Bot\x20Status:</b>\x0a','show-config','type','stop','Unauthorized\x20attempt\x20to\x20add\x20bot','message','No\x20bots\x20running\x20right\x20now','find','login','Restore\x20process\x20confirmed','apiKey','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','backup/','\x20|\x20','(((.+)+)+)+$','log','privateKey','disconnect','=>\x20Go\x20to\x20#CYA#http://','Disabled\x20Bot\x20','No\x20authentication\x20token','/logs\x20-\x20receive\x20log\x20files\x0a','status','hex','axios','updatebotmanager','/names\x20-\x20show\x20bot\x20names\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','listen',':\x20Bot\x20Mgr\x20>\x20','reset-history','use','sort','socket.io','getTime','text','\x1b[33m','2FA\x20login\x20required','Ok,\x20will\x20send\x20alert\x20notifications\x20only','2616220kuVpLT','params','apiSecret','new','kill','success','reinstall_no','backup-full@','decrypt','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','bbvNew','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','getUTCHours','ETH','|@|','generateAsync','temp/','yes','************','randomFillSync','orders','telegramIpApproval','blacklist','/off\x20-\x20stop\x20bot(s)\x0a','function','\x20to\x20','f2aRequired','temporaryAccessAllowed','Restore\x20backup\x20file\x20','telegramToken','Unauthorized\x20attempt\x20to\x20update\x20settings','names','Your\x20installation\x20is\x20already\x20up\x20to\x20date','emitHistory','existsSync','mkdirSync','copyFileSync','Notifications\x20disabled\x0a','getMonth','callback','temporary\x20access\x20not\x20allowed','18770uJZNZu','defaults','All','Restore\x20process\x20aborted','/:bot/configuration','Unauthorized\x20attempt\x20to\x20download\x20','messages','child_process','reason','order','\x20|\x20user:\x20...','length','Starting\x20(','getHours','login\x20not\x20required','off','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','\x20files\x20over\x20Telegram:','sortBy','handshake','timeshift','telegram','pidExpireLogin','Backup\x20file\x20unzipped\x20and\x20stored','Telegraf\x20error:','string','hasOwnProperty','10qojOyY','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','-performance.json','readdirSync','Temporary\x20access\x20rejected','privateKeyFromPem','sendMetricsTelegram','headless','bots','showname','latestversion','chat',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','storeConfiguration','password','expiry','\x20(2)','\x20-\x20','publicKeyToPem','resetpw_yes','get-starting-balances','delete-alerts','8727808rUbDAU','live','statSync','exit','(staging)','manual','/start','backup','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','/metrics\x20-\x20show\x20bot\x20performance\x0a','\x20only\x0a','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','search','logout','0.0.0','bbvReceive','privateKeyToPem','config/','Unauthorized\x20login\x20attempt\x20(timeout)','settings','\x1b[34m','***','backup-files','output-000.log','All\x20bots','https://api.ipify.org?format=json','30\x20min','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','#RES#\x20if\x20running\x20on\x20server','metrics','2FA\x20login\x20rejected','botname','Unauthorized\x20attempt\x20to\x20get\x20messages','\x1b[0m','show','bb/','telegramEvents','config_alerts','createServer','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','range','access','Unauthorized\x20attempt\x20to\x20get\x20events','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','environment','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','2458956TgHGNx','bcryptjs','--------------------------------------','uuid','any','botID','all','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','loadAsync','editMessageReplyMarkup','readFileSync','Orders','catch','hashSync','Idling\x20(','family','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','onepagemode'];_0x3249=function(){return _0x1f21f;};return _0x3249();}const parseColor=(_0x4c9b19,_0x4543ec)=>{const _0xcbe025=_0x173b69,_0xc6341e=/#[A-Z]{3}#/g;if(typeof _0x4c9b19=='string'){!_0x4543ec?_0x4c9b19=_0x4c9b19[_0xcbe025(0x1e9)](_0xc6341e,''):(_0x4c9b19=_0x4c9b19[_0xcbe025(0x1e9)](/#BLU#/g,_0xcbe025(0x98)),_0x4c9b19=_0x4c9b19[_0xcbe025(0x1e9)](/#RED#/g,_0xcbe025(0x1fc)),_0x4c9b19=_0x4c9b19[_0xcbe025(0x1e9)](/#YEL#/g,_0xcbe025(0x23b)),_0x4c9b19=_0x4c9b19[_0xcbe025(0x1e9)](/#MAG#/g,_0xcbe025(0x10f)),_0x4c9b19=_0x4c9b19['replace'](/#CYA#/g,_0xcbe025(0x1b0)),_0x4c9b19=_0x4c9b19['replace'](/#RES#/g,_0xcbe025(0xa6)));;}return _0x4c9b19;},logger={'screen':_0xcd71f6=>{const _0x58f6e3=_0x173b69;console[_0x58f6e3(0x226)](parseColor(_0xcd71f6,!![]));},'simple':_0x3d83ab=>{const _0x51b181=_0x173b69;console['log'](parseColor(_0x3d83ab,!![])),loggerfile[_0x51b181(0x192)](util[_0x51b181(0x1fe)](parseColor(_0x3d83ab,![]))+'\x0a');},'full':async _0x5cfebc=>{const _0x42905e=_0x173b69,_0x2d9097=getTimeStamp()+_0x42905e(0x234)+_0x5cfebc;console['log'](parseColor(_0x2d9097,!![])),loggerfile['write'](util[_0x42905e(0x1fe)](parseColor(_0x2d9097,![]))+'\x0a');if(tgBot&&settings[_0x42905e(0x138)]&&settings[_0x42905e(0xa9)]!=_0x42905e(0x252))await sendTelegram(settings[_0x42905e(0x138)],_0x42905e(0x15f)+parseColor(_0x5cfebc,![]));},'debug':async(_0x2b0c1f,_0x32be06='')=>{const _0x590fc4=_0x173b69,_0x1bc7c1=getTimeStamp()+_0x590fc4(0xf0)+_0x2b0c1f;if(debugging)console['log'](parseColor(_0x1bc7c1,!![]));loggerfile[_0x590fc4(0x192)](util[_0x590fc4(0x1fe)](parseColor(_0x1bc7c1,![]))+'\x0a');if(_0x32be06){if(debugging)console[_0x590fc4(0x226)](_0x32be06);loggerfile[_0x590fc4(0x192)](util[_0x590fc4(0x1fe)](_0x32be06)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x2a2bb3){const _0x4c6191=_0x173b69;_0x2a2bb3[_0x4c6191(0x191)]()['includes'](_0x4c6191(0x168))?(logger['simple']('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x2a2bb3['port']+_0x4c6191(0x101)),process[_0x4c6191(0xc9)]({'terminate':!![]},_0x59451d=>{})):logger[_0x4c6191(0x15a)](_0x2a2bb3);}),process['on'](_0x173b69(0x29b),()=>{const _0x10c3a3=_0x173b69;stopAllBots(),process[_0x10c3a3(0x29b)](0x0);}),process['on'](_0x173b69(0x118),()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGINT',()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x173b69(0x1b4))[_0x173b69(0xef)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x173b69(0x208)),app=express(),http=require(_0x173b69(0xd5))[_0x173b69(0xab)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x173b69(0x184)](_0x173b69(0x129),async(_0x3c8c5f,_0x3fc141)=>{const _0x41a662=_0x173b69,_0x1ac8c4=_0x3c8c5f[_0x41a662(0x23f)]['type'],_0x5f2134=getClientsWithBotID(_0x41a662(0x215)),_0x47111e=_0x3c8c5f[_0x41a662(0x100)][_0x41a662(0xb6)],_0x5b5860=timelyDecrypt(_0x47111e,![]),_0x27939a=_0x5f2134[_0x41a662(0x21e)](_0x374e4b=>_0x374e4b[_0x41a662(0xb6)]==_0x5b5860);if(_0x27939a){const _0x4a096c=normalizeIP(_0x3c8c5f[_0x41a662(0x20b)][_0x41a662(0x190)])['store'],_0x37709c=_0x3c8c5f[_0x41a662(0x100)][_0x41a662(0x1a1)];if(validateAccess(_0x37709c,_0x5b5860,_0x4a096c)[_0x41a662(0x1fb)])_0x1ac8c4=='backup'&&await backupConfigFiles(),await zipFiles(_0x1ac8c4),_0x3fc141['download'](zippath+(_0x1ac8c4+_0x41a662(0x103)),_0x51960b=>{const _0x238929=_0x41a662;_0x51960b&&(logger[_0x238929(0xda)](_0x238929(0x1e5)+_0x1ac8c4),logger['simple'](_0x51960b));});else logger[_0x41a662(0xda)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x1ac8c4+'\x20(1)');}else logger[_0x41a662(0xda)](_0x41a662(0x26c)+_0x1ac8c4+_0x41a662(0x292));}),app['post'](_0x173b69(0x1ec),async(_0x1e8267,_0x2c12c6)=>{const _0x10ceae=_0x173b69,_0x4044ad=getClientsWithBotID(_0x10ceae(0x215)),_0x4b9280=_0x1e8267['headers'][_0x10ceae(0xb6)],_0x339a79=timelyDecrypt(_0x4b9280,![]),_0x53e693=_0x4044ad[_0x10ceae(0x21e)](_0x5def44=>_0x5def44[_0x10ceae(0xb6)]==_0x339a79);logger[_0x10ceae(0x20e)](_0x10ceae(0x1c2));if(_0x53e693){const _0x375705=normalizeIP(_0x1e8267['socket'][_0x10ceae(0x190)])[_0x10ceae(0x14f)],_0x578d48=_0x1e8267[_0x10ceae(0x100)]['tkn'];if(validateAccess(_0x578d48,_0x339a79,_0x375705)[_0x10ceae(0x1fb)]){if(_0x1e8267['files']){const _0x34f099=_0x1e8267['files']['backupfile'];await _0x34f099['mv'](temppath+_0x34f099['name']),_0x2c12c6[_0x10ceae(0xc9)]({'status':!![],'message':'File\x20uploaded'});const _0x9b4b70=getBotsWithMode();_0x9b4b70['length']>0x0?confirmRestore(temppath,_0x34f099[_0x10ceae(0x1ff)]):unzipFile(temppath,_0x34f099[_0x10ceae(0x1ff)]);}}else logger[_0x10ceae(0xda)](_0x10ceae(0x18d));}else logger[_0x10ceae(0xda)](_0x10ceae(0x277));}),app[_0x173b69(0x236)](express[_0x173b69(0x112)](path[_0x173b69(0x144)](__dirname,bbpath2,_0x173b69(0x12f)))),app[_0x173b69(0x236)](express[_0x173b69(0x112)](path[_0x173b69(0x144)](__dirname,bbpath2,_0x173b69(0xcf)))),app['get']('/',function(_0x445e2e,_0x1df577){const _0x2933f0=_0x173b69;_0x1df577[_0x2933f0(0x1bd)](path[_0x2933f0(0x144)](__dirname,bbpath2,_0x2933f0(0x12f),_0x2933f0(0x1bc)));}),app[_0x173b69(0x184)](_0x173b69(0x1c8),function(_0x4e9a4a,_0x1c1fcd){const _0x14f5db=_0x173b69;_0x1c1fcd['sendFile'](path[_0x14f5db(0x144)](__dirname,bbpath2,_0x14f5db(0xcf),_0x14f5db(0x1bc)));}),app['get'](_0x173b69(0x216),(_0x3e5703,_0x350abd)=>{const _0x4d0aed=_0x173b69;_0x350abd['sendFile'](path[_0x4d0aed(0x144)](__dirname,bbpath2,_0x4d0aed(0xcf),_0x4d0aed(0x1bc)));}),app[_0x173b69(0x184)](_0x173b69(0x15c),(_0x26f0cb,_0x31a102)=>{const _0x1b2fa0=_0x173b69;_0x31a102['sendFile'](path[_0x1b2fa0(0x144)](__dirname,bbpath2,_0x1b2fa0(0xcf),_0x1b2fa0(0x1bc)));}),app[_0x173b69(0x184)](_0x173b69(0x15d),(_0x4dfe53,_0x517591)=>{const _0x2669c0=_0x173b69;_0x517591[_0x2669c0(0x1bd)](path[_0x2669c0(0x144)](__dirname,bbpath2,_0x2669c0(0xcf),'index.html'));}),app[_0x173b69(0x184)](_0x173b69(0x131),(_0x3ddc87,_0x1da24d)=>{const _0x3c34d4=_0x173b69;_0x1da24d[_0x3c34d4(0x1bd)](path[_0x3c34d4(0x144)](__dirname,bbpath2,_0x3c34d4(0xcf),'index.html'));}),app[_0x173b69(0x184)](_0x173b69(0x26b),(_0x13bf9d,_0x3ebc15)=>{const _0x2e16ef=_0x173b69;_0x3ebc15[_0x2e16ef(0x1bd)](path[_0x2e16ef(0x144)](__dirname,bbpath2,_0x2e16ef(0xcf),_0x2e16ef(0x1bc)));}),app[_0x173b69(0x184)]('/:bot/support',(_0x22d11f,_0x4fd636)=>{const _0x1c2db8=_0x173b69;_0x4fd636[_0x1c2db8(0x1bd)](path[_0x1c2db8(0x144)](__dirname,bbpath2,'build',_0x1c2db8(0x1bc)));});if(HOST)http[_0x173b69(0x233)](PORT,HOST);else http['listen'](PORT);const io=require(_0x173b69(0x238))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0xe56819=_0x173b69;let _0x1ab5af=_0xe56819(0x13b);const _0xe36a53=networkInterfaces(),_0x52e730={};for(const _0x237b7b of Object[_0xe56819(0xdc)](_0xe36a53)){for(const _0x29754d of _0xe36a53[_0x237b7b]){if((_0x29754d['family']=='IPv4'||_0x29754d[_0xe56819(0xc2)]==0x4)&&!_0x29754d['internal']){const _0x143e1e=ipaddr[_0xe56819(0x152)](_0x29754d[_0xe56819(0xdb)])[_0xe56819(0xad)]();_0x143e1e!=_0xe56819(0x12c)&&(!_0x52e730[_0x237b7b]&&(_0x52e730[_0x237b7b]=[]),_0x52e730[_0x237b7b]['push'](_0x29754d[_0xe56819(0xdb)]),_0x1ab5af=_0x29754d['address']);}}}return{'serverip':_0x1ab5af,'netinterfaces':_0x52e730};}async function startServer(){const _0x1f8567=_0x173b69,{serverip:_0x53492a,netinterfaces:_0x5b42c8}=getServerIP();logger[_0x1f8567(0x15a)](''),logger[_0x1f8567(0x15a)](_0x1f8567(0x210)),await logger[_0x1f8567(0xda)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x1f8567(0xca)+(environment==_0x1f8567(0x1d4)?_0x1f8567(0x29c):'')+'\x0a'+(_0x1f8567(0x283)+PORT+_0x1f8567(0x1db))+(_0x1f8567(0x229)+_0x53492a+':'+PORT+_0x1f8567(0xa1))),logger[_0x1f8567(0x15a)]('-----------------------------------------------------------------------------------');if(config[_0x1f8567(0x272)]!=0x0)for(const _0x528996 of config){const _0x33431b=_0x528996['mode']==_0x1f8567(0x143)?'a':'m';if(_0x528996[_0x1f8567(0x22d)]=='enabled'||_0x528996[_0x1f8567(0x22d)]==_0x1f8567(0x241))await logger[_0x1f8567(0xda)](_0x1f8567(0x273)+_0x33431b+_0x1f8567(0x156)+_0x528996[_0x1f8567(0xb8)]+_0x1f8567(0x224)+_0x528996['botname']),startBot([_0x528996[_0x1f8567(0xb8)],userID],{'cwd':bbpath},function(_0x226b0b){const _0x2a142e=_0x1f8567;if(_0x226b0b)logger[_0x2a142e(0xda)](_0x226b0b);});else(_0x528996[_0x1f8567(0x22d)]==_0x1f8567(0x17e)||_0x528996['status']==_0x1f8567(0x1ca))&&await logger[_0x1f8567(0xda)](_0x1f8567(0xc1)+_0x33431b+_0x1f8567(0x114)+_0x528996['botID']+'\x20|\x20'+_0x528996[_0x1f8567(0xa4)]);}else!newBot&&logger['simple'](_0x1f8567(0x189));if(newBot)addBot();logger[_0x1f8567(0x15a)](_0x1f8567(0x210)),logger['simple'](''),await logger[_0x1f8567(0x20e)](_0x1f8567(0xf9)+nodeversion),await logger[_0x1f8567(0x20e)]('Network\x20Interfaces:',_0x5b42c8);}function startSocket(){io['on']('connection',_0x34c58b=>{const _0x16c49d=_0x2275;let _0x2fc79f,_0x5451ed,_0x505aec,_0x4091c1,_0x2dfa5e;const _0x27bb9e=_0x34c58b[_0x16c49d(0x27a)][_0x16c49d(0x100)][_0x16c49d(0x18a)];_0x5451ed=_0x27bb9e[_0x16c49d(0x108)](/bot[0-9]{3}/);if(_0x5451ed)_0x505aec=_0x5451ed[0x0]['match'](/[0-9]{3}/);if(_0x505aec)_0x2fc79f=_0x505aec[0x0];else _0x2fc79f=_0x16c49d(0x215);const _0x12dd4b=_0x34c58b[_0x16c49d(0x27a)]['auth']['encryptedUuid'];if(!_0x12dd4b)_0x34c58b['emit'](_0x16c49d(0x22d),{'publicKey':secure[_0x16c49d(0x16c)]});else{_0x4091c1=timelyDecrypt(_0x12dd4b,![]);if(!_0x4091c1)_0x34c58b['emit'](_0x16c49d(0x22d),{'publicKey':secure[_0x16c49d(0x16c)]});else{_0x2dfa5e=normalizeIP(_0x34c58b[_0x16c49d(0x12d)][_0x16c49d(0x190)])['store'];if(!devices[_0x4091c1])devices[_0x4091c1]={'uuid':_0x4091c1,'access':{'token':null}};devices[_0x4091c1]['ip']=_0x2dfa5e;const _0xf06a9=addClient(_0x34c58b['id'],_0x4091c1,_0x2fc79f);setAccess(_0xf06a9),emitMessages(),_0x34c58b['on']('login',_0x57ebe1=>{const _0xe6f9ff=_0x16c49d,_0x12e52e=timelyDecrypt(_0x57ebe1[_0xe6f9ff(0x290)],!![],_0xe6f9ff(0x24c));if(_0x12e52e){_0x57ebe1={'username':_0x57ebe1[_0xe6f9ff(0x16f)],'password':_0x12e52e},devices[_0x4091c1]['access']=validateCredentials(_0x57ebe1,_0x4091c1);if(devices[_0x4091c1][_0xe6f9ff(0xae)][_0xe6f9ff(0x1fb)]==![]&&devices[_0x4091c1]['access'][_0xe6f9ff(0x26f)]=='2FA\x20login\x20required')_0x34c58b[_0xe6f9ff(0x123)](_0xe6f9ff(0x22d),{'access':devices[_0x4091c1]['access']}),loginAccess2FA(_0x4091c1,_0x2dfa5e);else{if(devices[_0x4091c1][_0xe6f9ff(0xae)][_0xe6f9ff(0x1fb)]==![]&&devices[_0x4091c1][_0xe6f9ff(0xae)]['reason']=='invalid\x20credentials')_0x34c58b[_0xe6f9ff(0x123)](_0xe6f9ff(0x22d),{'access':devices[_0x4091c1][_0xe6f9ff(0xae)]});else devices[_0x4091c1][_0xe6f9ff(0xae)][_0xe6f9ff(0x1fb)]&&devices[_0x4091c1]['access']['reason']==_0xe6f9ff(0x1e2)&&(getClientsWithUuid(_0x4091c1)['forEach'](_0x286f23=>{setAccess(_0x286f23);}),logger['debug']('Logged\x20in\x20user\x20...'+_0x4091c1['slice'](-0x8)),setTokenRefresh(_0x4091c1),setSessionTimeout(_0xe6f9ff(0x21f),_0x4091c1));}}else logger[_0xe6f9ff(0xda)](_0xe6f9ff(0x96));}),_0x34c58b['on'](_0x16c49d(0xe4),()=>{resetPassword();}),_0x34c58b['on'](_0x16c49d(0x228),_0x57e87a=>{removeClient(_0x34c58b['id']);}),_0x2fc79f==_0x16c49d(0x215)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x3c36f3){const _0x44f4a2=_0x173b69;if(_0x3c36f3!=_0x44f4a2(0x215)&&config[_0x44f4a2(0x221)]!=''){if(pid[_0x3c36f3])pid[_0x3c36f3][_0x44f4a2(0xc9)]({'function':_0x44f4a2(0x1d3),'args':null});}_0x3c36f3!='botmanager'&&broadcastToBots(_0x44f4a2(0x28a),JSON[_0x44f4a2(0x1a5)](config));}function reloadBotManager(){const _0x2f0f0e=_0x173b69;getClientsWithBotID(_0x2f0f0e(0x215))['forEach'](_0x5615e0=>{const _0x3e0329=_0x2f0f0e;getSocket(_0x5615e0['id'])['emit'](_0x3e0329(0x22d),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x19af3e){const _0x2d5eb9=_0x173b69,_0x575832=io[_0x2d5eb9(0x1c3)][_0x2d5eb9(0x184)]('/');return _0x575832['sockets'][_0x2d5eb9(0x184)](_0x19af3e);}function setAccess(_0x1edd14){const _0x5e507b=_0x173b69,_0x3e4330=getSocket(_0x1edd14['id']),_0x1774b0=_0x1edd14[_0x5e507b(0xb6)],_0x820bb9=_0x1edd14[_0x5e507b(0x176)];devices[_0x1774b0][_0x5e507b(0xae)]=validateAccess(devices[_0x1774b0]['access'][_0x5e507b(0x1f7)],_0x1774b0),logger[_0x5e507b(0x20e)](_0x5e507b(0x1ef)+devices[_0x1774b0][_0x5e507b(0xae)][_0x5e507b(0x26f)]+'\x20|\x20client:\x20...'+_0x1edd14['id']['slice'](-0x8)+_0x5e507b(0x271)+_0x1774b0[_0x5e507b(0x205)](-0x8)),_0x3e4330[_0x5e507b(0x144)](_0x1774b0);if(devices[_0x1774b0][_0x5e507b(0xae)][_0x5e507b(0x1fb)]){_0x3e4330[_0x5e507b(0x144)](_0x820bb9);if(_0x820bb9==_0x5e507b(0x215))initializeSocketBotManager(_0x3e4330);else initializeSocketBot(_0x3e4330);initClient(_0x820bb9);}devices[_0x1774b0]['access'][_0x5e507b(0x1f7)]&&devices[_0x1774b0][_0x5e507b(0xae)][_0x5e507b(0x26f)]==_0x5e507b(0x132)&&setSessionTimeout('2FA',_0x1774b0),devices[_0x1774b0]['access'][_0x5e507b(0x1f7)]&&devices[_0x1774b0][_0x5e507b(0xae)]['reason']==_0x5e507b(0xea)&&setSessionTimeout('login',_0x1774b0),_0x3e4330[_0x5e507b(0x123)](_0x5e507b(0x22d),{'status':_0x1edd14[_0x5e507b(0x12a)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1774b0][_0x5e507b(0xae)],'externalip':devices[_0x1774b0]['ip'],'publicKey':secure[_0x5e507b(0x16c)],'userid':settings[_0x5e507b(0x155)],'validInstallation':validInstallation}),devices[_0x1774b0][_0x5e507b(0xae)]['allow']==![]&&devices[_0x1774b0][_0x5e507b(0xae)][_0x5e507b(0x26f)]==_0x5e507b(0x137)&&temporaryAccess2FA(_0x1774b0,devices[_0x1774b0]['ip']);}function setSessionTimeout(_0x58a2ec,_0xf69d08){const _0xc2133d=_0x173b69;let _0x4747fb;if(_0x58a2ec==_0xc2133d(0x21f))_0x4747fb=loginExpiry*0x3c*0x3e8;else _0x4747fb=devices[_0xf69d08][_0xc2133d(0x253)][_0xc2133d(0x291)]*0x3c*0x3e8-(new Date()[_0xc2133d(0x239)]()-devices[_0xf69d08]['telegramIpApproval'][_0xc2133d(0x13d)]);if(devices[_0xf69d08]['pidExpireLogin'])clearTimeout(devices[_0xf69d08][_0xc2133d(0x27d)]);devices[_0xf69d08][_0xc2133d(0x27d)]=setTimeout(()=>{const _0x5a547a=_0xc2133d;if(devices[_0xf69d08][_0x5a547a(0x1e0)])clearTimeout(devices[_0xf69d08]['pidRefreshToken']);removeSocketListeners(_0xf69d08),addBlacklist(_0xf69d08),devices[_0xf69d08][_0x5a547a(0x253)]=null,devices[_0xf69d08][_0x5a547a(0x1dc)]=null,devices[_0xf69d08][_0x5a547a(0xae)][_0x5a547a(0x1f7)]=null,logger['debug'](_0x5a547a(0x1e8)+_0xf69d08[_0x5a547a(0x205)](-0x8)),devices[_0xf69d08]['access']=validateAccess(devices[_0xf69d08][_0x5a547a(0xae)][_0x5a547a(0x1f7)],_0xf69d08),!(devices[_0xf69d08]['access'][_0x5a547a(0x1fb)]&&devices[_0xf69d08][_0x5a547a(0xae)][_0x5a547a(0x26f)]==_0x5a547a(0x275))&&(_0x58a2ec=='login'?io['to'](_0xf69d08)[_0x5a547a(0x123)](_0x5a547a(0x22d),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0xf69d08)[_0x5a547a(0x123)](_0x5a547a(0x22d),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0xf69d08][_0x5a547a(0xae)][_0x5a547a(0x1f7)]=null;},_0x4747fb);}function setTokenRefresh(_0x215e3a){const _0x14edaf=_0x173b69;if(devices[_0x215e3a]['pidRefreshToken'])clearTimeout(devices[_0x215e3a][_0x14edaf(0x1e0)]);devices[_0x215e3a][_0x14edaf(0x1e0)]=setTimeout(()=>{const _0x5c890c=_0x14edaf;getClientsWithUuid(_0x215e3a)[_0x5c890c(0x272)]!=0x0?(devices[_0x215e3a][_0x5c890c(0xae)]=refreshToken(_0x215e3a),io['to'](_0x215e3a)['emit']('status',{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x215e3a][_0x5c890c(0xae)],'externalip':devices[_0x215e3a]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x215e3a)):clearTimeout(devices[_0x215e3a][_0x5c890c(0x1e0)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4026ce){const _0x474755=_0x173b69,_0xca06b7=getClient(_0x4026ce['id'])[_0x474755(0xb6)];_0x4026ce[_0x474755(0x123)]('bots',config),_0x4026ce[_0x474755(0x123)](_0x474755(0x97),cleanSettings()),_0x4026ce['on']('add-bot',_0x19f0d9=>{const _0x3f574c=_0x474755;if(validateAccess(_0x19f0d9,_0xca06b7)[_0x3f574c(0x1fb)])addBot();else logger[_0x3f574c(0xda)](_0x3f574c(0x21b));}),_0x4026ce['on']('update-bot',(_0x3671c6,_0x5bca7a)=>{const _0x42a012=_0x474755;if(validateAccess(_0x5bca7a,_0xca06b7)['allow'])toggleBot(_0x3671c6[_0x42a012(0xb8)],_0x3671c6['status'],_0x3671c6[_0x42a012(0x299)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4026ce['on'](_0x474755(0x1b7),(_0x491d69,_0x1ba758)=>{const _0x12aa29=_0x474755;if(validateAccess(_0x1ba758,_0xca06b7)[_0x12aa29(0x1fb)])toggleBotMode(_0x491d69);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4026ce['on']('delete-bot',(_0x5cd32a,_0x562407)=>{const _0x444dd5=_0x474755;if(validateAccess(_0x562407,_0xca06b7)[_0x444dd5(0x1fb)])deleteBot(_0x5cd32a);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x4026ce['on']('store-settings',(_0x5db301,_0x4c5051)=>{const _0x298b2e=_0x474755;if(validateAccess(_0x4c5051,_0xca06b7)[_0x298b2e(0x1fb)])storeSettings(_0x5db301,!![]);else logger[_0x298b2e(0xda)](_0x298b2e(0x25c));}),_0x4026ce['on'](_0x474755(0x19b),_0x5397cb=>{const _0x2786cc=_0x474755;if(validateAccess(_0x5397cb,_0xca06b7)[_0x2786cc(0x1fb)])updateBB(_0x2786cc(0x1fa));else logger[_0x2786cc(0xda)](_0x2786cc(0x150));}),_0x4026ce['on'](_0x474755(0x1dd),_0x3db8cf=>{const _0x39b173=_0x474755;if(validateAccess(_0x3db8cf,_0xca06b7)['allow'])updateBB('reinstall');else logger[_0x39b173(0xda)](_0x39b173(0xb2));}),_0x4026ce['on']('get-backup-files',_0x353ed2=>{const _0x1e4f00=_0x474755;if(validateAccess(_0x353ed2,_0xca06b7)[_0x1e4f00(0x1fb)]){const _0x1ba0b3=getClient(_0x4026ce['id']);if(_0x1ba0b3)getBackupFiles(_0x1ba0b3['uuid']);else logger['full']('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x4026ce['on'](_0x474755(0x196),(_0x55c34a,_0xeca696)=>{const _0x2ce2ec=_0x474755;if(validateAccess(_0xeca696,_0xca06b7)['allow'])restoreBackupFile(_0x55c34a);else logger[_0x2ce2ec(0xda)](_0x2ce2ec(0x1a0));}),_0x4026ce['on'](_0x474755(0x16d),_0x83640c=>{const _0x91196a=_0x474755;if(validateAccess(_0x83640c,_0xca06b7)[_0x91196a(0x1fb)])getMessages();else logger[_0x91196a(0xda)](_0x91196a(0xa5));}),_0x4026ce['on']('confirm-message',(_0x4c28ac,_0x108e41)=>{const _0x112f5b=_0x474755;if(validateAccess(_0x108e41,_0xca06b7)[_0x112f5b(0x1fb)])confirmMessage(_0x4c28ac);else logger[_0x112f5b(0xda)](_0x112f5b(0x1b5));}),_0x4026ce['on']('logout',_0x1da515=>{const _0x39bae4=_0x474755;if(validateAccess(_0x1da515,_0xca06b7)['allow']){if(devices[_0xca06b7][_0x39bae4(0x1e0)])clearTimeout(devices[_0xca06b7][_0x39bae4(0x1e0)]);if(devices[_0xca06b7]['pidExpireLogin'])clearTimeout(devices[_0xca06b7]['pidExpireLogin']);removeSocketListeners(getClient(_0x4026ce['id'])[_0x39bae4(0xb6)]),addBlacklist(_0xca06b7),devices[_0xca06b7][_0x39bae4(0x253)]=null,devices[_0xca06b7][_0x39bae4(0x1dc)]=null,devices[_0xca06b7][_0x39bae4(0xae)][_0x39bae4(0x1f7)]=null,logger[_0x39bae4(0x20e)](_0x39bae4(0x127)+_0xca06b7[_0x39bae4(0x205)](-0x8)),io['to'](getClient(_0x4026ce['id'])[_0x39bae4(0xb6)])[_0x39bae4(0x123)](_0x39bae4(0x22d),{'access':{'allow':![],'reason':_0x39bae4(0x1cb),'token':null}});}else logger[_0x39bae4(0xda)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x54cf90){const _0x299f5e=_0x173b69,_0x403479=getClient(_0x54cf90['id'])[_0x299f5e(0x176)],_0x1ddaeb=getClient(_0x54cf90['id'])[_0x299f5e(0xb6)];_0x54cf90['on'](_0x299f5e(0x1c1),(_0x3e0917,_0x3f7d46)=>{const _0x4a5d9b=_0x299f5e;if(validateAccess(_0x3f7d46,_0x1ddaeb)[_0x4a5d9b(0x1fb)]){if(pid[_0x403479])pid[_0x403479]['send']({'function':_0x4a5d9b(0x25f),'args':_0x3e0917});}else logger['full'](_0x4a5d9b(0xaf));}),_0x54cf90['on'](_0x299f5e(0x297),(_0x92f448,_0x3d6406)=>{const _0x2e5e2e=_0x299f5e;if(validateAccess(_0x3d6406,_0x1ddaeb)[_0x2e5e2e(0x1fb)]){if(pid[_0x403479])pid[_0x403479][_0x2e5e2e(0xc9)]({'function':_0x2e5e2e(0x1a6),'args':_0x92f448});}else logger[_0x2e5e2e(0xda)](_0x2e5e2e(0x1de));}),_0x54cf90['on'](_0x299f5e(0xfd),(_0x57422c,_0x1ee44a)=>{const _0x84c85=_0x299f5e;if(validateAccess(_0x1ee44a,_0x1ddaeb)['allow']){if(pid[_0x403479])pid[_0x403479][_0x84c85(0xc9)]({'function':'getPortfolio','args':_0x57422c});}else logger[_0x84c85(0xda)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x54cf90['on']('store-configuration',(_0x3dbeb2,_0x569e46)=>{const _0x2f7adb=_0x299f5e;if(validateAccess(_0x569e46,_0x1ddaeb)[_0x2f7adb(0x1fb)]){if(pid[_0x403479])pid[_0x403479][_0x2f7adb(0xc9)]({'function':_0x2f7adb(0x28f),'args':_0x3dbeb2});}else logger[_0x2f7adb(0xda)](_0x2f7adb(0xcb));}),_0x54cf90['on'](_0x299f5e(0xf6),(_0x1c212d,_0x280de6)=>{const _0x36da27=_0x299f5e;if(validateAccess(_0x280de6,_0x1ddaeb)[_0x36da27(0x1fb)]){if(pid[_0x403479])pid[_0x403479][_0x36da27(0xc9)]({'function':'storeHeadless','args':_0x1c212d});}else logger[_0x36da27(0xda)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x54cf90['on'](_0x299f5e(0x1d6),(_0x4530fd,_0x3d20cf)=>{const _0x22a4d4=_0x299f5e;if(validateAccess(_0x3d20cf,_0x1ddaeb)[_0x22a4d4(0x1fb)]){if(pid[_0x403479])pid[_0x403479][_0x22a4d4(0xc9)]({'function':_0x22a4d4(0x135),'args':_0x4530fd});}else logger[_0x22a4d4(0xda)](_0x22a4d4(0xb0));}),_0x54cf90['on'](_0x299f5e(0x235),_0x5ca4fd=>{const _0x3f6d13=_0x299f5e;if(validateAccess(_0x5ca4fd,_0x1ddaeb)['allow']){if(pid[_0x403479])pid[_0x403479][_0x3f6d13(0xc9)]({'function':_0x3f6d13(0x13e),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x54cf90['on'](_0x299f5e(0x296),_0x2bf37d=>{const _0x394e68=_0x299f5e;if(validateAccess(_0x2bf37d,_0x1ddaeb)[_0x394e68(0x1fb)]){if(pid[_0x403479])pid[_0x403479][_0x394e68(0xc9)]({'function':'getStartingBalances','args':null});}else logger[_0x394e68(0xda)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x54cf90['on'](_0x299f5e(0x15e),(_0xa777f3,_0x14342d)=>{const _0x4cfb0f=_0x299f5e;if(validateAccess(_0x14342d,_0x1ddaeb)[_0x4cfb0f(0x1fb)]){if(pid[_0x403479])pid[_0x403479]['send']({'function':_0x4cfb0f(0x122),'args':_0xa777f3});}else logger[_0x4cfb0f(0xda)](_0x4cfb0f(0x1f8));}),_0x54cf90['on']('cancel-loading',_0x264add=>{const _0x991824=_0x299f5e;if(validateAccess(_0x264add,_0x1ddaeb)[_0x991824(0x1fb)]){if(pid[_0x403479])pid[_0x403479][_0x991824(0xc9)]({'function':_0x991824(0xc5),'args':null});}else logger[_0x991824(0xda)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x54cf90['on'](_0x299f5e(0x218),_0x4040d1=>{const _0x2b96f7=_0x299f5e;if(validateAccess(_0x4040d1,_0x1ddaeb)['allow']){if(pid[_0x403479])pid[_0x403479][_0x2b96f7(0xc9)]({'function':_0x2b96f7(0x113),'args':null});}else logger[_0x2b96f7(0xda)](_0x2b96f7(0x1b6));}),_0x54cf90['on']('update-bb',_0x191e19=>{const _0x69b8ba=_0x299f5e;if(validateAccess(_0x191e19,_0x1ddaeb)[_0x69b8ba(0x1fb)])updateBB(_0x69b8ba(0x1fa));else logger[_0x69b8ba(0xda)](_0x69b8ba(0x150));}),_0x54cf90['on'](_0x299f5e(0x16d),_0x286676=>{const _0x2f85af=_0x299f5e;if(validateAccess(_0x286676,_0x1ddaeb)[_0x2f85af(0x1fb)])getMessages();else logger[_0x2f85af(0xda)](_0x2f85af(0xa5));}),_0x54cf90['on']('confirm-message',(_0x4aa28a,_0x2c0bee)=>{const _0x2dca6f=_0x299f5e;if(validateAccess(_0x2c0bee,_0x1ddaeb)[_0x2dca6f(0x1fb)])confirmMessage(_0x4aa28a);else logger['full'](_0x2dca6f(0x1b5));}),_0x54cf90['on'](_0x299f5e(0x91),_0x4c6663=>{const _0x32ee83=_0x299f5e;if(validateAccess(_0x4c6663,_0x1ddaeb)[_0x32ee83(0x1fb)]){if(devices[_0x1ddaeb][_0x32ee83(0x1e0)])clearTimeout(devices[_0x1ddaeb]['pidRefreshToken']);if(devices[_0x1ddaeb][_0x32ee83(0x27d)])clearTimeout(devices[_0x1ddaeb]['pidExpireLogin']);removeSocketListeners(getClient(_0x54cf90['id'])[_0x32ee83(0xb6)]),addBlacklist(_0x1ddaeb),devices[_0x1ddaeb][_0x32ee83(0x253)]=null,devices[_0x1ddaeb]['telegram2FaApproval']=null,devices[_0x1ddaeb][_0x32ee83(0xae)][_0x32ee83(0x1f7)]=null,logger[_0x32ee83(0x20e)](_0x32ee83(0x127)+_0x1ddaeb[_0x32ee83(0x205)](-0x8)),io['to'](getClient(_0x54cf90['id'])['uuid'])[_0x32ee83(0x123)]('status',{'access':{'allow':![],'reason':_0x32ee83(0x1cb),'token':null}});}else logger[_0x32ee83(0xda)](_0x32ee83(0x14e));});}function removeSocketListeners(_0x36dc7c){const _0xef3898=_0x173b69;getClientsWithUuid(_0x36dc7c)[_0xef3898(0x211)](_0x17901a=>{getSocket(_0x17901a['id'])['removeAllListeners']();});}function cleanSettings(){const _0x199639=_0x173b69;let _0x8c148c=settings;return settings['telegramToken']&&settings[_0x199639(0x25b)]!=''&&(_0x8c148c={..._0x8c148c,'telegramToken':_0x199639(0x250)}),settings[_0x199639(0xd1)]&&settings[_0x199639(0xd1)]!=''&&(_0x8c148c={..._0x8c148c,'bbPassword':_0x199639(0x250)}),settings[_0x199639(0x20c)]&&settings[_0x199639(0x20c)]!=''&&(_0x8c148c={..._0x8c148c,'marketcapApi':'************'}),(settings['bbPassword']&&settings[_0x199639(0xd1)]==_0x199639(0x99)||settings['telegramToken']&&settings['telegramToken']==_0x199639(0x99)||settings[_0x199639(0x20c)]&&settings[_0x199639(0x20c)]==_0x199639(0x99))&&(_0x8c148c={..._0x8c148c,'restored':{'password':settings[_0x199639(0xd1)]==_0x199639(0x99),'telegram':settings[_0x199639(0x25b)]=='***','marketcap':settings[_0x199639(0x20c)]=='***'}}),_0x8c148c;}async function updateBB(_0x2bade8){const _0x8c5787=_0x173b69;await backupConfigFiles(),installingUpdate=!![],config[_0x8c5787(0x211)](_0x40be96=>{const _0x5e5c3c=_0x8c5787;restartBot(_0x40be96[_0x5e5c3c(0xb8)]);});if(_0x2bade8==_0x8c5787(0x1fa))process[_0x8c5787(0xc9)]({'update':!![],'environment':environment},_0x3ffbaf=>{});else _0x2bade8=='reinstall'&&process[_0x8c5787(0xc9)]({'reinstall':!![],'environment':environment},_0x301213=>{});}function startBot(_0x19c191,_0x52ff32,_0x2b9169){const _0x3109cf=_0x173b69;if(debugging)_0x19c191[_0x3109cf(0x125)]('-d');if(recreate)_0x19c191[_0x3109cf(0x125)]('-r');let _0x3c58f0=![];const _0x16e97d=_0x19c191[0x0];_0x52ff32={..._0x52ff32,'stdio':[_0x3109cf(0x161),_0x3109cf(0x161),_0x3109cf(0x161),_0x3109cf(0x11c)]},pid[_0x16e97d]=childProcess[_0x3109cf(0xf3)](botfile,_0x19c191,_0x52ff32),pid[_0x16e97d]['on']('message',_0x5628f9=>{const _0x30eb89=_0x3109cf;switch(Object[_0x30eb89(0xdc)](_0x5628f9)[0x0]){case _0x30eb89(0xa4):updateBotName(_0x16e97d,_0x5628f9[_0x30eb89(0xa4)]);break;case _0x30eb89(0x230):updateBotManager();break;case'status':updateStatus(_0x16e97d,_0x5628f9['status']);break;case _0x30eb89(0x299):updateLive(_0x16e97d,_0x5628f9['live']);break;case'started':updateLive(_0x16e97d,_0x5628f9[_0x30eb89(0x16b)]),io['to'](_0x16e97d)[_0x30eb89(0x123)](_0x30eb89(0x22d),{'access':{'allow':![],'reason':_0x30eb89(0xe9),'token':null}});break;case _0x30eb89(0x21a):_0x5628f9[_0x30eb89(0x21a)]==_0x30eb89(0x1fd)&&restartBot(_0x16e97d);_0x5628f9[_0x30eb89(0x21a)]==_0x30eb89(0x242)&&toggleBot(_0x16e97d,_0x30eb89(0x17e),_0x30eb89(0x214));break;case _0x30eb89(0x27c):sendTelegramBot(_0x16e97d,_0x5628f9['telegram']);break;case _0x30eb89(0xf4):sendTelegramMsg(_0x5628f9[_0x30eb89(0xf4)]);break;case _0x30eb89(0x256):io['to'](_0x16e97d)[_0x30eb89(0x123)](_0x5628f9['function'],_0x5628f9['args']);break;}}),pid[_0x16e97d]['on'](_0x3109cf(0x1f2),function(_0x839ca5){if(_0x3c58f0)return;_0x3c58f0=!![],_0x2b9169(_0x839ca5);}),pid[_0x16e97d]['on'](_0x3109cf(0x29b),async function(_0x3201bf){const _0x4e2be4=_0x3109cf;if(terminating)return;if(installingUpdate){io[_0x4e2be4(0x1b3)]();return;}if(_0x3c58f0)return;_0x3c58f0=!![],_0x2b9169(null);const _0xb54a92=dbConfig[_0x4e2be4(0x184)](_0x4e2be4(0x28a))[_0x4e2be4(0x21e)]({'botID':_0x16e97d})[_0x4e2be4(0x209)]();_0xb54a92&&(_0xb54a92[_0x4e2be4(0x22d)]=='enabled'||_0xb54a92[_0x4e2be4(0x22d)]==_0x4e2be4(0x241))&&(await sleep(0x3e8),updateLive(_0x16e97d,_0x4e2be4(0x214)),logger[_0x4e2be4(0xda)](_0x4e2be4(0x162)+_0x16e97d),startBot([_0x16e97d,userID],{'cwd':bbpath},function(_0x4d8b94){const _0x47bdc5=_0x4e2be4;if(_0x4d8b94)logger[_0x47bdc5(0xda)](_0x4d8b94);}));});}function stopBot(_0x43ab7a){const _0x5402be=_0x173b69;getClientsWithBotID(_0x43ab7a)[_0x5402be(0x211)](_0x3b8edf=>{const _0x3f73db=_0x5402be;getSocket(_0x3b8edf['id'])[_0x3f73db(0x228)](!![]),removeClient(_0x3b8edf['id']);}),pid[_0x43ab7a]&&(pid[_0x43ab7a][_0x5402be(0x242)](),pid[_0x43ab7a]=null);}function stopAllBots(){terminating=!![];const _0x1666fe=getEnabledBots();_0x1666fe['forEach'](_0x5538ea=>{stopBot(_0x5538ea['botID']);});}function restartBot(_0x521509){const _0x4721bd=_0x173b69;if(pid[_0x521509])pid[_0x521509][_0x4721bd(0x242)]();}function addBot(){const _0x3d0bc5=_0x173b69;let _0xd3eb5b;for(let _0x30511d=0x1;_0x30511d<0x3e9;_0x30511d++){_0xd3eb5b=_0x30511d[_0x3d0bc5(0x191)]()[_0x3d0bc5(0x1d8)](0x3,'0');let _0x109205=config[_0x3d0bc5(0x21e)](_0x50e5f3=>_0x50e5f3[_0x3d0bc5(0xb8)]==_0xd3eb5b);if(!_0x109205)break;}if(_0xd3eb5b==='1000'){logger['full'](_0x3d0bc5(0x183));return;}logger[_0x3d0bc5(0xda)](_0x3d0bc5(0x106)+_0xd3eb5b),dbConfig[_0x3d0bc5(0x184)](_0x3d0bc5(0x28a))[_0x3d0bc5(0x125)]({'botID':_0xd3eb5b,'botname':_0x3d0bc5(0x172)+_0xd3eb5b,'status':'new','live':''})[_0x3d0bc5(0x192)](),startBot([_0xd3eb5b,userID],{'cwd':bbpath},function(_0x5ca299){const _0x2ef29a=_0x3d0bc5;if(_0x5ca299)logger[_0x2ef29a(0xda)](_0x5ca299);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0x3d0bc5(0x28a),config),broadcastToBots(_0x3d0bc5(0x28a),JSON['stringify'](config));}function deleteBot(_0x299774){const _0x118fa1=_0x173b69;getClientsWithBotID(_0x299774)['forEach'](_0x1a709f=>{const _0x46967b=_0x2275;getSocket(_0x1a709f['id'])[_0x46967b(0x228)](!![]),removeClient(_0x1a709f['id']);}),dbConfig[_0x118fa1(0x184)](_0x118fa1(0x28a))[_0x118fa1(0xd2)]({'botID':_0x299774})[_0x118fa1(0x192)](),logger[_0x118fa1(0xda)](_0x118fa1(0x207)+_0x299774),stopBot(_0x299774);try{if(fs['existsSync'](path[_0x118fa1(0x144)](configpath,_0x118fa1(0x153)+_0x299774+_0x118fa1(0xe3))))fs[_0x118fa1(0x212)](path[_0x118fa1(0x144)](configpath,_0x118fa1(0x153)+_0x299774+_0x118fa1(0xe3)));if(fs[_0x118fa1(0x260)](path[_0x118fa1(0x144)](configpath,_0x118fa1(0x153)+_0x299774+_0x118fa1(0x203))))fs[_0x118fa1(0x212)](path[_0x118fa1(0x144)](configpath,_0x118fa1(0x153)+_0x299774+_0x118fa1(0x203)));if(fs[_0x118fa1(0x260)](path[_0x118fa1(0x144)](configpath,_0x118fa1(0x153)+_0x299774+_0x118fa1(0x284))))fs[_0x118fa1(0x212)](path[_0x118fa1(0x144)](configpath,_0x118fa1(0x153)+_0x299774+_0x118fa1(0x284)));if(fs['existsSync'](path[_0x118fa1(0x144)](configpath,_0x118fa1(0x153)+_0x299774+_0x118fa1(0xfe))))fs['unlinkSync'](path[_0x118fa1(0x144)](configpath,'bot-'+_0x299774+_0x118fa1(0xfe)));}catch(_0x587e5b){if(_0x587e5b)logger[_0x118fa1(0xda)](_0x118fa1(0x173),_0x587e5b);}config=getConfiguration(),io['to'](_0x118fa1(0x215))['emit'](_0x118fa1(0x28a),config),broadcastToBots(_0x118fa1(0x28a),JSON[_0x118fa1(0x1a5)](config));}function toggleBot(_0x5615ba,_0x462371,_0x32ed8c){const _0x2eff3c=_0x173b69;dbConfig[_0x2eff3c(0x184)](_0x2eff3c(0x28a))[_0x2eff3c(0x21e)]({'botID':_0x5615ba})[_0x2eff3c(0x1c9)]({'status':_0x462371})[_0x2eff3c(0x1c9)]({'live':_0x32ed8c})[_0x2eff3c(0x192)]();if(_0x462371=='enabled'||_0x462371==_0x2eff3c(0x241))logger['full'](_0x2eff3c(0xdf)+_0x5615ba),startBot([_0x5615ba,userID],{'cwd':bbpath},function(_0x88506b){const _0x1eeffd=_0x2eff3c;if(_0x88506b)logger[_0x1eeffd(0xda)](_0x88506b);});else(_0x462371==_0x2eff3c(0x17e)||_0x462371==_0x2eff3c(0x1ca))&&(logger[_0x2eff3c(0xda)](_0x2eff3c(0x22a)+_0x5615ba),stopBot(_0x5615ba));config=getConfiguration(),io['to'](_0x2eff3c(0x215))[_0x2eff3c(0x123)](_0x2eff3c(0x28a),config),broadcastToBots(_0x2eff3c(0x28a),JSON['stringify'](config));}function toggleStatus(_0x5278f8){const _0x40a30a=_0x173b69;let _0x3cc19e=dbConfig[_0x40a30a(0x184)](_0x40a30a(0x28a))[_0x40a30a(0x21e)]({'botID':_0x5278f8})[_0x40a30a(0x209)](),_0xdd0390;if(_0x3cc19e[_0x40a30a(0x22d)]===_0x40a30a(0x14d))_0xdd0390=_0x40a30a(0x17e);else{if(_0x3cc19e[_0x40a30a(0x22d)]===_0x40a30a(0x241))_0xdd0390='new-disabled';else{if(_0x3cc19e[_0x40a30a(0x22d)]==='new-disabled')_0xdd0390='new';else{if(_0x3cc19e[_0x40a30a(0x22d)]==='disabled')_0xdd0390=_0x40a30a(0x14d);}}}return _0xdd0390;}function updateStatus(_0x2ef6b6,_0x447abd){const _0x3a3b4a=_0x173b69;dbConfig['get'](_0x3a3b4a(0x28a))[_0x3a3b4a(0x21e)]({'botID':_0x2ef6b6})[_0x3a3b4a(0x1c9)]({'status':_0x447abd})['write'](),config=getConfiguration(),io['to'](_0x3a3b4a(0x215))['emit'](_0x3a3b4a(0x28a),config),broadcastToBots(_0x3a3b4a(0x28a),JSON[_0x3a3b4a(0x1a5)](config));}function updateLive(_0xa30ea2,_0x3e9a57){const _0x47573a=_0x173b69;dbConfig['get'](_0x47573a(0x28a))[_0x47573a(0x21e)]({'botID':_0xa30ea2})[_0x47573a(0x1c9)]({'live':_0x3e9a57})[_0x47573a(0x192)](),config=getConfiguration(),io['to']('botmanager')[_0x47573a(0x123)](_0x47573a(0x28a),config),broadcastToBots(_0x47573a(0x28a),JSON['stringify'](config));}function updateBotName(_0xca6c66,_0x59b1da){const _0xc0603e=_0x173b69;dbConfig['get']('bots')[_0xc0603e(0x21e)]({'botID':_0xca6c66})['assign']({'botname':_0x59b1da})['write'](),config=getConfiguration(),io['to'](_0xc0603e(0x215))[_0xc0603e(0x123)](_0xc0603e(0x28a),config),broadcastToBots(_0xc0603e(0x28a),JSON[_0xc0603e(0x1a5)](config));}function updateBotManager(){const _0xec666a=_0x173b69;config=getConfiguration(),io['to'](_0xec666a(0x215))[_0xec666a(0x123)](_0xec666a(0x28a),config),broadcastToBots(_0xec666a(0x28a),JSON[_0xec666a(0x1a5)](config));}function toggleBotMode(_0x4638e5){const _0x48c9e0=_0x173b69;if(pid[_0x4638e5])pid[_0x4638e5][_0x48c9e0(0xc9)]({'function':_0x48c9e0(0x1a3),'args':null});else{const _0x1e8e51=configpath+'bot-'+_0x4638e5+'-config.json',_0x5f5d43=fs[_0x48c9e0(0xbd)](_0x1e8e51),_0x353469=JSON['parse'](_0x5f5d43),_0x33486e=_0x353469['bot'][0x0]['headless'];_0x353469[_0x48c9e0(0x176)][0x0][_0x48c9e0(0x289)]=!_0x33486e;const _0x522f44=JSON[_0x48c9e0(0x1a5)](_0x353469,null,0x2);fs[_0x48c9e0(0x160)](_0x1e8e51,_0x522f44),config=getConfiguration(),io['to'](_0x48c9e0(0x215))[_0x48c9e0(0x123)](_0x48c9e0(0x28a),config),broadcastToBots('bots',JSON[_0x48c9e0(0x1a5)](config));}}function validateTelegram(_0x1ca955){const _0xbe0c28=_0x173b69;if(_0x1ca955[_0xbe0c28(0x1ab)]['username']!=settings[_0xbe0c28(0x1d1)]&&'@'+_0x1ca955[_0xbe0c28(0x1ab)][_0xbe0c28(0x16f)]!=settings[_0xbe0c28(0x1d1)]||_0x1ca955['chat']['id']!=settings[_0xbe0c28(0x138)])return sendTelegram(_0x1ca955[_0xbe0c28(0x28d)]['id'],_0xbe0c28(0x124),{'parse_mode':_0xbe0c28(0x136)}),![];return!![];}async function initTelegram(){const _0x5565fc=_0x173b69;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x5565fc(0x25b)]);let _0x1c11ef=_0x5565fc(0x186);_0x1c11ef+='\x0a',_0x1c11ef+='/enable\x20-\x20enable\x20notifications\x0a',_0x1c11ef+=_0x5565fc(0x1e4),_0x1c11ef+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x1c11ef+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x1c11ef+=_0x5565fc(0x1c5),_0x1c11ef+=_0x5565fc(0x255),_0x1c11ef+=_0x5565fc(0x1f1),_0x1c11ef+=_0x5565fc(0x231),_0x1c11ef+=_0x5565fc(0x1c6),_0x1c11ef+=_0x5565fc(0x8d),_0x1c11ef+=_0x5565fc(0xfb),_0x1c11ef+=_0x5565fc(0x22c),_0x1c11ef+=_0x5565fc(0x1f5),_0x1c11ef+=_0x5565fc(0x146),_0x1c11ef+=_0x5565fc(0xdd),_0x1c11ef+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x4acb1c=_0x5565fc(0x1f0);_0x4acb1c+='\x0a',_0x4acb1c+=_0x1c11ef,tgBot[_0x5565fc(0xbf)]((_0x2caefd,_0x304d1e)=>{const _0x53a00a=_0x5565fc;logger[_0x53a00a(0x15a)](getTimeStamp()+_0x53a00a(0x28e)),logger[_0x53a00a(0x20e)](_0x53a00a(0x27f),_0x2caefd);}),tgBot[_0x5565fc(0x236)](async(_0x4eca61,_0x4f5f37)=>{const _0x932fc9=_0x5565fc;if(settings['telegramChatId']||_0x4eca61[_0x932fc9(0x1fa)][_0x932fc9(0x21c)][_0x932fc9(0x23a)]!=_0x932fc9(0x29e)){if(!validateTelegram(_0x4eca61))return;}_0x4f5f37();}),tgBot[_0x5565fc(0x1ad)](_0x5565fc(0x169),async _0x2a9a18=>{const _0x4c55ed=_0x5565fc;if(_0x2a9a18['from']['username']==settings[_0x4c55ed(0x1d1)]||'@'+_0x2a9a18['from'][_0x4c55ed(0x16f)]==settings['telegramUsername']){if(!settings[_0x4c55ed(0x138)])updateSetting(_0x4c55ed(0x138),_0x2a9a18[_0x4c55ed(0x28d)]['id']);else{if(!validateTelegram(_0x2a9a18))return;}}else{if(!validateTelegram(_0x2a9a18))return;}updateSetting(_0x4c55ed(0xfc),!![]),await sendTelegram(_0x2a9a18[_0x4c55ed(0x28d)]['id'],_0x4acb1c);}),tgBot[_0x5565fc(0x1ad)]('enable',async _0x3061e6=>{const _0x2de1f2=_0x5565fc;updateSetting(_0x2de1f2(0xfc),!![]),await sendTelegram(_0x3061e6['chat']['id'],'Notifications\x20enabled');}),tgBot[_0x5565fc(0x1ad)](_0x5565fc(0x1cd),async _0x321cb7=>{const _0xca676e=_0x5565fc;await sendTelegram(_0x321cb7[_0xca676e(0x28d)]['id'],'Notifications\x20disabled'),updateSetting(_0xca676e(0xfc),![]);}),tgBot[_0x5565fc(0x1ad)]('config',async _0x2b7baa=>{const _0x3d2897=_0x5565fc,_0x4c8118=Markup[_0x3d2897(0x11d)]([Markup[_0x3d2897(0x1aa)]['callback'](_0x3d2897(0xbe),_0x3d2897(0x194)),Markup[_0x3d2897(0x1aa)][_0x3d2897(0x265)]('Alerts',_0x3d2897(0xaa)),Markup[_0x3d2897(0x1aa)][_0x3d2897(0x265)](_0x3d2897(0x269),'config_all')]);_0x2b7baa[_0x3d2897(0x18b)](_0x3d2897(0x154),_0x4c8118);}),tgBot[_0x5565fc(0x198)]('config_orders',async _0x19178b=>{const _0x458bbe=_0x5565fc;_0x19178b[_0x458bbe(0xbc)](),updateSetting(_0x458bbe(0xa9),_0x458bbe(0x252)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x19178b['chat']['id'],_0x458bbe(0x166));}),tgBot[_0x5565fc(0x198)](_0x5565fc(0xaa),async _0x524516=>{const _0x3f7c11=_0x5565fc;_0x524516['editMessageReplyMarkup'](),updateSetting(_0x3f7c11(0xa9),_0x3f7c11(0x179)),updateSetting(_0x3f7c11(0xfc),!![]),await sendTelegram(_0x524516[_0x3f7c11(0x28d)]['id'],_0x3f7c11(0x23d));}),tgBot[_0x5565fc(0x198)](_0x5565fc(0xce),async _0x3e10e6=>{const _0x2688ad=_0x5565fc;_0x3e10e6['editMessageReplyMarkup'](),updateSetting(_0x2688ad(0xa9),'all'),updateSetting(_0x2688ad(0xfc),!![]),await sendTelegram(_0x3e10e6['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x5565fc(0x1ad)]('status',async _0x20cb5a=>{const _0x3ecb0d=_0x5565fc,_0x787fcd=getBotsWithMode();let _0x4ffdc9=_0x3ecb0d(0x217);config[_0x3ecb0d(0x211)](_0x4428cf=>{const _0x11d6f4=_0x3ecb0d,_0x402cb5=_0x787fcd['find'](_0x4f1920=>_0x4f1920[_0x11d6f4(0xb8)]==_0x4428cf[_0x11d6f4(0xb8)])['mode'];_0x4ffdc9+='Bot\x20'+_0x4428cf[_0x11d6f4(0xb8)]+':\x20'+_0x4428cf[_0x11d6f4(0x22d)]+_0x11d6f4(0x224)+_0x402cb5+_0x11d6f4(0x224)+_0x4428cf[_0x11d6f4(0x299)]+'\x0a';}),_0x4ffdc9+='\x0a',_0x4ffdc9+=_0x3ecb0d(0x1e3),_0x4ffdc9+=!settings[_0x3ecb0d(0xfc)]?_0x3ecb0d(0x263):'Notifications\x20enabled\x0a',_0x4ffdc9+=settings['telegramEnabled']?settings[_0x3ecb0d(0xa9)]==_0x3ecb0d(0xb9)?_0x3ecb0d(0x1b1):'Notifications\x20types:\x20'+settings[_0x3ecb0d(0xa9)]+_0x3ecb0d(0x8e):'',await sendTelegram(_0x20cb5a['chat']['id'],_0x4ffdc9,{'parse_mode':_0x3ecb0d(0x136)});}),tgBot[_0x5565fc(0x1ad)]('restart',async _0x4db284=>{const _0x1ec0fd=_0x5565fc,_0x145a34=getEnabledBots();if(_0x145a34['length']==0x0)await sendTelegram(_0x4db284['chat']['id'],_0x1ec0fd(0x21d));else{if(_0x145a34['length']>0x1)_0x145a34[_0x1ec0fd(0x125)]({'botID':_0x1ec0fd(0xb9)});let _0x529b90=[],_0x18c8af=[];const _0x4217b8=_0x145a34[_0x1ec0fd(0x272)]%0x4==0x0||_0x145a34[_0x1ec0fd(0x272)]%0x4==0x3||_0x145a34[_0x1ec0fd(0x272)]%0x3==0x1?0x4:0x3;let _0xca40c=0x0;_0x145a34[_0x1ec0fd(0x211)]((_0x22af22,_0x268467)=>{const _0x25933a=_0x1ec0fd;if(_0x268467%_0x4217b8==0x0)_0x18c8af=[];_0x18c8af[_0x25933a(0x125)](Markup[_0x25933a(0x1aa)][_0x25933a(0x265)](_0x22af22[_0x25933a(0xb8)]==_0x25933a(0xb9)?_0x25933a(0x9c):_0x25933a(0x172)+_0x22af22['botID'],'restart_'+_0x22af22[_0x25933a(0xb8)])),_0x268467%_0x4217b8==0x0&&(_0x529b90[_0xca40c]=_0x18c8af,_0xca40c++);});const _0x297d2d=Markup[_0x1ec0fd(0x11d)](_0x529b90);_0x4db284['reply'](_0x1ec0fd(0xac),_0x297d2d);}}),tgBot['action'](/restart_(.+)/,async _0x951c53=>{const _0x43d365=_0x5565fc,_0x179421=_0x951c53[_0x43d365(0x108)][0x1];_0x951c53[_0x43d365(0xbc)](),_0x179421==_0x43d365(0xb9)?config[_0x43d365(0x211)](_0x5d6985=>{const _0x1ee2cd=_0x43d365;restartBot(_0x5d6985[_0x1ee2cd(0xb8)]);}):restartBot(_0x179421);}),tgBot[_0x5565fc(0x1ad)]('on',async _0x4e600a=>{const _0x14e83e=_0x5565fc,_0x388f15=getDisabledBots();if(_0x388f15[_0x14e83e(0x272)]==0x0)await sendTelegram(_0x4e600a[_0x14e83e(0x28d)]['id'],_0x14e83e(0x145));else{if(_0x388f15[_0x14e83e(0x272)]>0x1)_0x388f15['push']({'botID':_0x14e83e(0xb9)});let _0x1ebf59=[],_0x149212=[];const _0x5f11c3=_0x388f15[_0x14e83e(0x272)]%0x4==0x0||_0x388f15[_0x14e83e(0x272)]%0x4==0x3||_0x388f15[_0x14e83e(0x272)]%0x3==0x1?0x4:0x3;let _0xf5125e=0x0;_0x388f15[_0x14e83e(0x211)]((_0x50a62c,_0x144cc2)=>{const _0x411a0e=_0x14e83e;if(_0x144cc2%_0x5f11c3==0x0)_0x149212=[];_0x149212[_0x411a0e(0x125)](Markup[_0x411a0e(0x1aa)]['callback'](_0x50a62c[_0x411a0e(0xb8)]==_0x411a0e(0xb9)?_0x411a0e(0x9c):_0x411a0e(0x172)+_0x50a62c['botID'],_0x411a0e(0xf5)+_0x50a62c['botID'])),_0x144cc2%_0x5f11c3==0x0&&(_0x1ebf59[_0xf5125e]=_0x149212,_0xf5125e++);});const _0x5bd916=Markup[_0x14e83e(0x11d)](_0x1ebf59);_0x4e600a[_0x14e83e(0x18b)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x5bd916);}}),tgBot[_0x5565fc(0x198)](/on_(.+)/,async _0x12d50a=>{const _0x49e1e0=_0x5565fc,_0x906a2b=_0x12d50a[_0x49e1e0(0x108)][0x1];_0x12d50a[_0x49e1e0(0xbc)]();if(_0x906a2b==_0x49e1e0(0xb9)){const _0x38d44e=getDisabledBots();await sendTelegram(_0x12d50a['chat']['id'],_0x49e1e0(0x17d)),_0x38d44e[_0x49e1e0(0x211)](_0x455a4f=>{const _0x4c0ac1=_0x49e1e0;if(_0x455a4f[_0x4c0ac1(0xb8)]!=_0x4c0ac1(0xb9))toggleBot(_0x455a4f[_0x4c0ac1(0xb8)],toggleStatus(_0x455a4f[_0x4c0ac1(0xb8)]),_0x4c0ac1(0x214));});}else await sendTelegram(_0x12d50a[_0x49e1e0(0x28d)]['id'],_0x49e1e0(0x19a)+_0x906a2b),toggleBot(_0x906a2b,toggleStatus(_0x906a2b),_0x49e1e0(0x214));}),tgBot[_0x5565fc(0x1ad)](_0x5565fc(0x276),async _0x54f945=>{const _0x1a0fee=_0x5565fc,_0x3c5fb4=getEnabledBots();if(_0x3c5fb4['length']==0x0)await sendTelegram(_0x54f945['chat']['id'],_0x1a0fee(0x21d));else{if(_0x3c5fb4[_0x1a0fee(0x272)]>0x1)_0x3c5fb4['push']({'botID':_0x1a0fee(0xb9)});let _0x21c836=[],_0x19b411=[];const _0x538ecb=_0x3c5fb4['length']%0x4==0x0||_0x3c5fb4['length']%0x4==0x3||_0x3c5fb4[_0x1a0fee(0x272)]%0x3==0x1?0x4:0x3;let _0x2f2cc1=0x0;_0x3c5fb4['forEach']((_0x4c5c51,_0x37cf33)=>{const _0x236cb6=_0x1a0fee;if(_0x37cf33%_0x538ecb==0x0)_0x19b411=[];_0x19b411[_0x236cb6(0x125)](Markup[_0x236cb6(0x1aa)][_0x236cb6(0x265)](_0x4c5c51['botID']==_0x236cb6(0xb9)?_0x236cb6(0x9c):_0x236cb6(0x172)+_0x4c5c51[_0x236cb6(0xb8)],'off_'+_0x4c5c51['botID'])),_0x37cf33%_0x538ecb==0x0&&(_0x21c836[_0x2f2cc1]=_0x19b411,_0x2f2cc1++);});const _0x2df53f=Markup[_0x1a0fee(0x11d)](_0x21c836);_0x54f945['reply'](_0x1a0fee(0x232),_0x2df53f);}}),tgBot[_0x5565fc(0x198)](/off_(.+)/,async _0xfd70e3=>{const _0x200e42=_0x5565fc,_0x42740c=_0xfd70e3[_0x200e42(0x108)][0x1];_0xfd70e3[_0x200e42(0xbc)]();if(_0x42740c==_0x200e42(0xb9)){const _0x62704=getEnabledBots();await sendTelegram(_0xfd70e3[_0x200e42(0x28d)]['id'],_0x200e42(0xee)),_0x62704[_0x200e42(0x211)](_0x402b0c=>{const _0x5aa3b5=_0x200e42;if(_0x402b0c[_0x5aa3b5(0xb8)]!=_0x5aa3b5(0xb9))toggleBot(_0x402b0c[_0x5aa3b5(0xb8)],toggleStatus(_0x402b0c[_0x5aa3b5(0xb8)]),_0x5aa3b5(0x214));});}else await sendTelegram(_0xfd70e3[_0x200e42(0x28d)]['id'],_0x200e42(0x222)+_0x42740c),toggleBot(_0x42740c,toggleStatus(_0x42740c),_0x200e42(0x214));}),tgBot[_0x5565fc(0x1ad)](_0x5565fc(0xa2),async _0x365ad0=>{const _0xa6b74f=_0x5565fc,_0x24a54c=getEnabledBots();if(_0x24a54c[_0xa6b74f(0x272)]==0x0)await sendTelegram(_0x365ad0[_0xa6b74f(0x28d)]['id'],_0xa6b74f(0x21d));else{if(_0x24a54c[_0xa6b74f(0x272)]>0x1){let _0x59e92f=[],_0x303299=[];const _0x5876d7=_0x24a54c[_0xa6b74f(0x272)]%0x4==0x0||_0x24a54c[_0xa6b74f(0x272)]%0x4==0x3||_0x24a54c[_0xa6b74f(0x272)]%0x3==0x1?0x4:0x3;let _0x3d0802=0x0;_0x24a54c[_0xa6b74f(0x211)]((_0x4e0667,_0x399fb6)=>{const _0x3a53d3=_0xa6b74f;if(_0x399fb6%_0x5876d7==0x0)_0x303299=[];_0x303299[_0x3a53d3(0x125)](Markup['button'][_0x3a53d3(0x265)](_0x3a53d3(0x172)+_0x4e0667[_0x3a53d3(0xb8)],_0x3a53d3(0x19e)+_0x4e0667[_0x3a53d3(0xb8)])),_0x399fb6%_0x5876d7==0x0&&(_0x59e92f[_0x3d0802]=_0x303299,_0x3d0802++);});const _0xcdf025=Markup[_0xa6b74f(0x11d)](_0x59e92f);_0x365ad0[_0xa6b74f(0x18b)](_0xa6b74f(0x9f),_0xcdf025);}else{const _0x2a5b18=_0x24a54c[0x0]['botID'];if(pid[_0x2a5b18])pid[_0x2a5b18][_0xa6b74f(0xc9)]({'function':_0xa6b74f(0x288),'args':null});}}}),tgBot[_0x5565fc(0x198)](/metrics_(.+)/,async _0x2cbb1a=>{const _0x46e5bc=_0x5565fc,_0x2a55e6=_0x2cbb1a['match'][0x1];_0x2cbb1a[_0x46e5bc(0xbc)]();if(pid[_0x2a55e6])pid[_0x2a55e6]['send']({'function':_0x46e5bc(0x288),'args':null});}),tgBot[_0x5565fc(0x1ad)](_0x5565fc(0x1da),async _0x479239=>{const _0x5b7e59=_0x5565fc,_0x2fed53=getEnabledBots();if(_0x2fed53[_0x5b7e59(0x272)]==0x0)await sendTelegram(_0x479239[_0x5b7e59(0x28d)]['id'],_0x5b7e59(0x21d));else{if(_0x2fed53[_0x5b7e59(0x272)]>0x1){let _0x292b2f=[],_0x4365c2=[];const _0x55b210=_0x2fed53[_0x5b7e59(0x272)]%0x4==0x0||_0x2fed53[_0x5b7e59(0x272)]%0x4==0x3||_0x2fed53[_0x5b7e59(0x272)]%0x3==0x1?0x4:0x3;let _0x386d0a=0x0;_0x2fed53[_0x5b7e59(0x211)]((_0x3b981a,_0x43904c)=>{const _0x5aec1b=_0x5b7e59;if(_0x43904c%_0x55b210==0x0)_0x4365c2=[];_0x4365c2[_0x5aec1b(0x125)](Markup[_0x5aec1b(0x1aa)]['callback'](_0x5aec1b(0x172)+_0x3b981a[_0x5aec1b(0xb8)],'portfolio_'+_0x3b981a['botID'])),_0x43904c%_0x55b210==0x0&&(_0x292b2f[_0x386d0a]=_0x4365c2,_0x386d0a++);});const _0x3482b2=Markup['inlineKeyboard'](_0x292b2f);_0x479239[_0x5b7e59(0x18b)](_0x5b7e59(0x247),_0x3482b2);}else{const _0x140871=_0x2fed53[0x0][_0x5b7e59(0xb8)];if(pid[_0x140871])pid[_0x140871][_0x5b7e59(0xc9)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x5565fc(0x198)](/portfolio_(.+)/,async _0x51c811=>{const _0xfbed63=_0x5565fc,_0x5dfdc7=_0x51c811['match'][0x1];_0x51c811['editMessageReplyMarkup']();if(pid[_0x5dfdc7])pid[_0x5dfdc7][_0xfbed63(0xc9)]({'function':_0xfbed63(0xc7),'args':null});}),tgBot['command'](_0x5565fc(0x204),async _0x439a34=>{const _0x54b811=_0x5565fc,_0x505acb=_0x54b811(0x204);await zipFiles(_0x505acb);const _0x1f4667=zippath+(_0x505acb+'.zip');_0x439a34['replyWithDocument']({'source':_0x1f4667})[_0x54b811(0x180)](()=>{})[_0x54b811(0xbf)](_0x5efc91=>logger[_0x54b811(0x20e)](_0x54b811(0xe2)+_0x505acb+_0x54b811(0x278),_0x5efc91));}),tgBot[_0x5565fc(0x1ad)](_0x5565fc(0x8b),async _0x7c2e73=>{const _0x14e42e=_0x5565fc,_0x260165=_0x14e42e(0x8b);await backupConfigFiles(),await zipFiles(_0x260165);const _0x456779=zippath+(_0x260165+_0x14e42e(0x103));_0x7c2e73['replyWithDocument']({'source':_0x456779})[_0x14e42e(0x180)](()=>{})[_0x14e42e(0xbf)](_0x417f00=>logger['debug'](_0x14e42e(0xe2)+_0x260165+_0x14e42e(0x278),_0x417f00));}),tgBot[_0x5565fc(0x1ad)]('update',async _0xc26b22=>{const _0x205849=_0x5565fc;await getMessages();if(!updateAvailable)await sendTelegram(_0xc26b22[_0x205849(0x28d)]['id'],_0x205849(0x25e));else{if(!validInstallation)await sendTelegram(_0xc26b22['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x23873d=Markup[_0x205849(0x11d)]([Markup[_0x205849(0x1aa)][_0x205849(0x265)](_0x205849(0x148),'update_yes'),Markup['button'][_0x205849(0x265)]('No','update_no')]);_0xc26b22['reply'](_0x205849(0x1c0),_0x23873d);}}}),tgBot[_0x5565fc(0x198)](/update_(.+)/,async _0x26567f=>{const _0x3daee5=_0x5565fc,_0x2285ab=_0x26567f[_0x3daee5(0x108)][0x1];_0x26567f[_0x3daee5(0xbc)](),_0x2285ab=='yes'&&(await sendTelegram(_0x26567f[_0x3daee5(0x28d)]['id'],_0x3daee5(0x11f)),updateBB(_0x3daee5(0x1fa))),_0x2285ab=='no'&&await sendTelegram(_0x26567f[_0x3daee5(0x28d)]['id'],_0x3daee5(0x18c));}),tgBot[_0x5565fc(0x1ad)]('reinstall',async _0x1f2006=>{const _0x2d2522=_0x5565fc;if(!validInstallation)await sendTelegram(_0x1f2006[_0x2d2522(0x28d)]['id'],_0x2d2522(0xba));else{const _0x18208f=Markup[_0x2d2522(0x11d)]([Markup[_0x2d2522(0x1aa)][_0x2d2522(0x265)](_0x2d2522(0x148),_0x2d2522(0xec)),Markup[_0x2d2522(0x1aa)][_0x2d2522(0x265)]('No',_0x2d2522(0x244))]);_0x1f2006[_0x2d2522(0x18b)](_0x2d2522(0x249),_0x18208f);}}),tgBot['action'](/reinstall_(.+)/,async _0x21975c=>{const _0x244ede=_0x5565fc,_0x41afb8=_0x21975c[_0x244ede(0x108)][0x1];_0x21975c[_0x244ede(0xbc)](),_0x41afb8=='yes'&&(await sendTelegram(_0x21975c[_0x244ede(0x28d)]['id'],_0x244ede(0xed)),updateBB(_0x244ede(0x10b))),_0x41afb8=='no'&&await sendTelegram(_0x21975c[_0x244ede(0x28d)]['id'],_0x244ede(0x17a));}),tgBot['command'](_0x5565fc(0x157),async _0x536668=>{const _0x2722ad=_0x5565fc,_0x4f85ab=getBotsWithMode();if(_0x4f85ab[_0x2722ad(0x272)]==0x0)await sendTelegram(_0x536668[_0x2722ad(0x28d)]['id'],_0x2722ad(0x21d));else{let _0x431558=[],_0x25072b=[];const _0x1747c8=0x2;let _0x1d5da4=0x0;_0x4f85ab['forEach']((_0x595dde,_0x4ee3d0)=>{const _0x16d4d9=_0x2722ad;if(_0x4ee3d0%_0x1747c8==0x0)_0x25072b=[];_0x25072b[_0x16d4d9(0x125)](Markup[_0x16d4d9(0x1aa)][_0x16d4d9(0x265)](_0x16d4d9(0x172)+_0x595dde[_0x16d4d9(0xb8)]+'\x20('+_0x595dde[_0x16d4d9(0xe5)]+')',_0x16d4d9(0x167)+_0x595dde[_0x16d4d9(0xb8)])),_0x4ee3d0%_0x1747c8==0x0&&(_0x431558[_0x1d5da4]=_0x25072b,_0x1d5da4++);});const _0x56d5b7=Markup[_0x2722ad(0x11d)](_0x431558);_0x536668[_0x2722ad(0x18b)](_0x2722ad(0xf1),_0x56d5b7);}}),tgBot[_0x5565fc(0x198)](/toggle_(.+)/,async _0x441264=>{const _0x7fa625=_0x5565fc,_0x559423=_0x441264['match'][0x1];_0x441264['editMessageReplyMarkup']();const _0xaefa87=getBotsWithMode(),_0x5825b3=_0xaefa87[_0x7fa625(0x21e)](_0x2cf4ae=>_0x2cf4ae['botID']==_0x559423),_0x1197ce=_0x5825b3['mode']=='auto'?'manual':_0x7fa625(0x143);await sendTelegram(_0x441264[_0x7fa625(0x28d)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x559423+_0x7fa625(0x257)+_0x1197ce+_0x7fa625(0x1af)),toggleBotMode(_0x559423);}),tgBot[_0x5565fc(0x1ad)](_0x5565fc(0x25d),async _0x35fbe7=>{const _0x42cea2=_0x5565fc;let _0x71df87='';config[_0x42cea2(0x211)](_0x259d2e=>{const _0x2be3a6=_0x42cea2;_0x71df87+=_0x2be3a6(0x172)+_0x259d2e[_0x2be3a6(0xb8)]+':\x20'+_0x259d2e[_0x2be3a6(0xa4)]+'\x0a';}),await sendTelegram(_0x35fbe7[_0x42cea2(0x28d)]['id'],_0x71df87,{'parse_mode':_0x42cea2(0x136)});}),tgBot[_0x5565fc(0x1ad)](_0x5565fc(0x1ee),async _0x756869=>{await sendTelegram(_0x756869['chat']['id'],_0x1c11ef);}),process['once']('SIGINT',()=>tgBot[_0x5565fc(0x21a)]('SIGINT')),process[_0x5565fc(0x105)](_0x5565fc(0x118),()=>tgBot[_0x5565fc(0x21a)](_0x5565fc(0x118))),tgBot[_0x5565fc(0x130)]();}function disableTelegram(){const _0x52b2e7=_0x173b69;tgBot&&tgBot[_0x52b2e7(0x21a)]();}async function sendTelegram(_0x3debc8,_0x71a6ef,_0x5300bf){const _0x5a092e=_0x173b69;_0x5300bf={..._0x5300bf,'disable_web_page_preview':!![]};try{await tgBot[_0x5a092e(0x27c)][_0x5a092e(0x1ae)](_0x3debc8,_0x71a6ef,_0x5300bf);}catch(_0x3ac73e){logger[_0x5a092e(0x20e)]('Telegram\x20error:',_0x3ac73e);}}async function sendTelegramBot(_0x5a5c35,_0x569316){const _0x4d484e=_0x173b69;if(settings[_0x4d484e(0xfc)]){if(settings[_0x4d484e(0xa9)]==_0x4d484e(0xb9)||(_0x569316['type']==_0x4d484e(0x1f2)||_0x569316[_0x4d484e(0x219)]==_0x4d484e(0x1a8)||_0x569316[_0x4d484e(0x219)]==_0x4d484e(0x243))&&settings[_0x4d484e(0xa9)]=='alerts'||_0x569316[_0x4d484e(0x219)]==_0x4d484e(0x270)&&settings['telegramEvents']==_0x4d484e(0x252)){if(tgBot&&settings[_0x4d484e(0x138)]){if(_0x569316[_0x4d484e(0x28b)])await sendTelegram(settings[_0x4d484e(0x138)],_0x569316['botname']+_0x4d484e(0xd0)+_0x569316[_0x4d484e(0x11e)]);else await sendTelegram(settings['telegramChatId'],_0x4d484e(0x172)+_0x5a5c35+_0x4d484e(0xd0)+_0x569316['event']);}}}}async function sendTelegramMsg(_0x29db93,_0x4db657='HTML'){const _0x46cc4b=_0x173b69;return settings[_0x46cc4b(0xfc)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x46cc4b(0x138)],_0x29db93,{'parse_mode':_0x4db657}),!![]):![];}function getDeviceWithIp(_0xffbc91){const _0x563403=_0x173b69;return devices[_0x563403(0x21e)](_0x715b76=>_0x715b76['ip']===_0xffbc91);}async function temporaryAccess2FA(_0xe8a109,_0x5b52cb){const _0x1a3f5f=_0x173b69;let _0x3e6b0f=new Date(),_0xd204ea=![];if(lastIpApproval){if(_0x3e6b0f-lastIpApproval<0x1388)_0xd204ea=!![];}lastIpApproval=new Date();if(_0xd204ea)return;if(tgBot&&settings[_0x1a3f5f(0x138)]){const _0x18b39f=uuidRandom();tmpStorage[_0x18b39f]={'uuid':_0xe8a109,'externalip':_0x5b52cb};const _0x30df9c=Markup[_0x1a3f5f(0x11d)]([Markup[_0x1a3f5f(0x1aa)][_0x1a3f5f(0x265)]('5\x20min','tempaccess_5_'+_0x18b39f),Markup[_0x1a3f5f(0x1aa)][_0x1a3f5f(0x265)](_0x1a3f5f(0x171),'tempaccess_15_'+_0x18b39f),Markup[_0x1a3f5f(0x1aa)][_0x1a3f5f(0x265)](_0x1a3f5f(0x9e),_0x1a3f5f(0x1f9)+_0x18b39f),Markup[_0x1a3f5f(0x1aa)][_0x1a3f5f(0x265)]('reject',_0x1a3f5f(0x18f)+_0x18b39f)]);await sendTelegram(settings[_0x1a3f5f(0x138)],_0x1a3f5f(0x20f)+normalizeIP(_0x5b52cb)[_0x1a3f5f(0xa7)]+'\x20?',_0x30df9c),tgBot[_0x1a3f5f(0x198)](/tempaccess_(.+)_(.+)/,async _0x19fb7a=>{const _0x3ec659=_0x1a3f5f,_0x5bf66d=_0x19fb7a[_0x3ec659(0x108)][0x1],_0x7b9fc4=_0x19fb7a[_0x3ec659(0x108)][0x2],{uuid:_0x26ab4b,externalip:_0x2dece9}=tmpStorage[_0x7b9fc4];delete tmpStorage[_0x7b9fc4],_0x19fb7a[_0x3ec659(0xbc)](),devices[_0x26ab4b]['telegramIpApproval']={'clientip':_0x2dece9,'timestamp':new Date()[_0x3ec659(0x239)](),'expiry':_0x5bf66d},_0x5bf66d!='reject'?(await sendTelegram(_0x19fb7a[_0x3ec659(0x28d)]['id'],_0x3ec659(0x1b8)+_0x5bf66d+_0x3ec659(0x14a),{'parse_mode':'HTML'}),io['to'](_0x26ab4b)['emit'](_0x3ec659(0x22d),{'access':{'allow':![],'reason':_0x3ec659(0xe9),'token':null}})):(await sendTelegram(_0x19fb7a[_0x3ec659(0x28d)]['id'],_0x3ec659(0x286)),io['to'](_0x26ab4b)[_0x3ec659(0x123)](_0x3ec659(0x22d),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x291fbb,_0x414395){const _0x39f954=_0x173b69;if(tgBot&&settings[_0x39f954(0x138)]){const _0x5b0759=uuidRandom();tmpStorage[_0x5b0759]={'uuid':_0x291fbb,'externalip':_0x414395};const _0x4fff68=Markup[_0x39f954(0x11d)]([Markup[_0x39f954(0x1aa)]['callback'](_0x39f954(0x1f3),'login2fa_'+loginExpiry+'_'+_0x5b0759),Markup[_0x39f954(0x1aa)][_0x39f954(0x265)]('reject',_0x39f954(0x1ed)+_0x5b0759)]);await sendTelegram(settings[_0x39f954(0x138)],_0x39f954(0x1eb)+normalizeIP(_0x414395)[_0x39f954(0xa7)]+'\x20?',_0x4fff68),tgBot[_0x39f954(0x198)](/login2fa_(.+)_(.+)/,async _0x5ad11a=>{const _0x501052=_0x39f954,_0x46da62=_0x5ad11a['match'][0x1],_0x234638=_0x5ad11a[_0x501052(0x108)][0x2],{uuid:_0x253d76,externalip:_0x4fbf3d}=tmpStorage[_0x234638];delete tmpStorage[_0x234638],_0x5ad11a['editMessageReplyMarkup'](),devices[_0x253d76][_0x501052(0x1dc)]={'clientip':_0x4fbf3d,'timestamp':new Date()[_0x501052(0x239)](),'expiry':_0x46da62},_0x46da62!=_0x501052(0x17b)?(await sendTelegram(_0x5ad11a[_0x501052(0x28d)]['id'],_0x501052(0x1ea),{'parse_mode':'HTML'}),io['to'](_0x253d76)[_0x501052(0x123)]('status',{'access':{'allow':![],'reason':_0x501052(0xe9),'token':null}})):(await sendTelegram(_0x5ad11a[_0x501052(0x28d)]['id'],'Login\x20rejected'),io['to'](_0x253d76)[_0x501052(0x123)]('status',{'access':{'allow':![],'reason':_0x501052(0xa3),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x55a761=_0x173b69;return dbConfig['get'](_0x55a761(0x28a))['sortBy'](_0x55a761(0xb8))[_0x55a761(0x16e)]({'status':'enabled'})[_0x55a761(0x209)]()||[];}function getDisabledBots(){const _0x408f56=_0x173b69;return dbConfig['get'](_0x408f56(0x28a))['sortBy'](_0x408f56(0xb8))[_0x408f56(0x16e)]({'status':_0x408f56(0x17e)})['value']()||[];}function getBotAttributes(_0x12bc07){const _0x4983c5=_0x173b69;let _0x297a9a={};const _0x3a7c1b=configpath+_0x4983c5(0x153)+_0x12bc07+_0x4983c5(0xe3),_0x465907=fs[_0x4983c5(0x260)](_0x3a7c1b);if(_0x465907){const _0x518e9e=fs[_0x4983c5(0xbd)](_0x3a7c1b);try{const _0x179162=JSON[_0x4983c5(0x152)](_0x518e9e),_0x5ec1e1=_0x179162?_0x179162['bot'][0x0][_0x4983c5(0x289)]:![];_0x297a9a['mode']=_0x5ec1e1?'auto':_0x4983c5(0x29d),_0x297a9a[_0x4983c5(0xa4)]=_0x179162?_0x179162['bot'][0x0][_0x4983c5(0xa4)]:_0x4983c5(0x172)+_0x12bc07;}catch(_0x393ead){_0x297a9a[_0x4983c5(0xe5)]=_0x4983c5(0x29d),_0x297a9a[_0x4983c5(0xa4)]=_0x4983c5(0x172)+_0x12bc07;}}else _0x297a9a[_0x4983c5(0xe5)]=_0x4983c5(0x29d),_0x297a9a[_0x4983c5(0xa4)]=_0x4983c5(0x172)+_0x12bc07;return _0x297a9a;}function getBotsWithMode(){const _0x3a0860=_0x173b69,_0x51904e=dbConfig['get'](_0x3a0860(0x28a))[_0x3a0860(0x279)]('botID')[_0x3a0860(0x209)]()||[];return _0x51904e[_0x3a0860(0x211)](_0x602601=>{const _0x1347b5=_0x3a0860;let _0x14e6e2=getBotAttributes(_0x602601[_0x1347b5(0xb8)]);_0x602601[_0x1347b5(0xe5)]=_0x14e6e2[_0x1347b5(0xe5)];}),_0x51904e;}function getBotExchanges(){const _0x36c8b9=_0x173b69;let _0xe0648b=[];const _0x1d26a8=dbConfig['get']('bots')['sortBy'](_0x36c8b9(0xb8))['value']()||[];_0x1d26a8[_0x36c8b9(0x211)](_0x2bf600=>{const _0x4b769d=_0x36c8b9;if(_0x2bf600['status']==_0x4b769d(0x14d)){const _0x901f70=configpath+_0x4b769d(0x153)+_0x2bf600['botID']+_0x4b769d(0xe3),_0x463fdf=fs[_0x4b769d(0x260)](_0x901f70);let _0x22b9ec;if(_0x463fdf){const _0x3c1368=fs[_0x4b769d(0xbd)](_0x901f70);try{const _0x340add=JSON[_0x4b769d(0x152)](_0x3c1368);_0x22b9ec=_0x340add?_0x340add[_0x4b769d(0x176)][0x0][_0x4b769d(0x133)]:null;}catch(_0xc1b93c){}}if(_0x22b9ec)_0xe0648b[_0x4b769d(0x125)](_0x22b9ec);}});const _0xa2dfa7=[...new Set(_0xe0648b)][_0x36c8b9(0x237)]();return _0xa2dfa7;}async function initUser(){const _0x4cd372=_0x173b69;if(!settings['userid']){const _0x45890b=uuidRandom();mixpanel[_0x4cd372(0xc8)](_0x45890b),updateSetting(_0x4cd372(0x155),_0x45890b);}}async function initSecure(){const _0x1d0d2d=_0x173b69;let _0x28b352=getSecure();if(!_0x28b352[_0x1d0d2d(0x281)](_0x1d0d2d(0x165))){let _0x5c1d58=await generateKeys();_0x28b352[_0x1d0d2d(0x16c)]=_0x5c1d58[_0x1d0d2d(0x16c)],_0x28b352[_0x1d0d2d(0x227)]=_0x5c1d58[_0x1d0d2d(0x227)],_0x28b352[_0x1d0d2d(0x165)]=crypto['randomBytes'](0x20)['toString'](_0x1d0d2d(0x22e));;storeSecure(_0x28b352);}}function getSettings(){const _0x1170ac=_0x173b69;return dbSettings[_0x1170ac(0x184)](_0x1170ac(0x97))[_0x1170ac(0x209)]()||{};}function getSecure(){const _0x4e1a7d=_0x173b69;return dbSecure['get'](_0x4e1a7d(0x1ba))[_0x4e1a7d(0x209)]()||{};}function getBlacklist(){const _0x52e323=_0x173b69;return dbSecure[_0x52e323(0x184)](_0x52e323(0x254))['value']()||[];}function broadcastToBots(_0x4d7260,_0x45610b){const _0xa5bb69=_0x173b69;config[_0xa5bb69(0x211)](_0x1fc53e=>{const _0x6b11e0=_0xa5bb69;if(_0x1fc53e[_0x6b11e0(0x22d)]==_0x6b11e0(0x14d)&&_0x1fc53e[_0x6b11e0(0x299)]==_0x6b11e0(0xe0)||_0x1fc53e[_0x6b11e0(0x22d)]==_0x6b11e0(0x241)&&_0x1fc53e[_0x6b11e0(0x299)]==_0x6b11e0(0xe0)){if(pid[_0x1fc53e[_0x6b11e0(0xb8)]])pid[_0x1fc53e[_0x6b11e0(0xb8)]]['send']({[_0x4d7260]:_0x45610b});}});}async function storeSettings(_0x3cd903,_0x41fbbd=![]){const _0x20a2a2=_0x173b69;_0x3cd903={...settings,..._0x3cd903};if(_0x41fbbd&&_0x3cd903[_0x20a2a2(0xd1)]!=_0x20a2a2(0x250)&&_0x3cd903[_0x20a2a2(0xd1)]!='***'&&_0x3cd903[_0x20a2a2(0xd1)]!=''){const _0x5dc4f5=decryptRSA(secure[_0x20a2a2(0x227)],_0x3cd903[_0x20a2a2(0xd1)])[_0x20a2a2(0x1b2)](_0x20a2a2(0x24c))[0x0],_0xf420bd=bcrypt[_0x20a2a2(0xc0)](_0x5dc4f5,saltRounds);_0x3cd903={..._0x3cd903,'bbPassword':_0xf420bd};}if(_0x41fbbd&&_0x3cd903[_0x20a2a2(0x25b)]!=_0x20a2a2(0x250)&&_0x3cd903[_0x20a2a2(0x25b)]!='***'&&_0x3cd903[_0x20a2a2(0x25b)]!=''){const _0x22c07e=decryptRSA(secure['privateKey'],_0x3cd903[_0x20a2a2(0x25b)])[_0x20a2a2(0x1b2)](_0x20a2a2(0x24c))[0x0];_0x3cd903={..._0x3cd903,'telegramToken':_0x22c07e};}if(_0x41fbbd&&_0x3cd903['marketcapApi']!='************'&&_0x3cd903['marketcapApi']!=_0x20a2a2(0x99)&&_0x3cd903[_0x20a2a2(0x20c)]!=''){const _0x3bd181=decryptRSA(secure[_0x20a2a2(0x227)],_0x3cd903[_0x20a2a2(0x20c)])['split'](_0x20a2a2(0x24c))[0x0];_0x3cd903={..._0x3cd903,'marketcapApi':_0x3bd181};}const _0x44aa48=_0x3cd903[_0x20a2a2(0x25b)]!='************'&&_0x3cd903['telegramToken']!=settings['telegramToken']||_0x3cd903[_0x20a2a2(0x1d1)]!=settings[_0x20a2a2(0x1d1)],_0x335cde=_0x3cd903['telegramToken']==''||_0x3cd903[_0x20a2a2(0x1d1)]=='',_0x13f51c=_0x3cd903[_0x20a2a2(0x20c)]&&_0x3cd903[_0x20a2a2(0x20c)]!=_0x20a2a2(0x250)&&_0x3cd903[_0x20a2a2(0x20c)]!=settings[_0x20a2a2(0x20c)];_0x44aa48&&(_0x3cd903[_0x20a2a2(0x138)]=null,_0x3cd903[_0x20a2a2(0xa9)]=_0x20a2a2(0xb9));for(const [_0x66e65e,_0xe18a4b]of Object[_0x20a2a2(0xe1)](_0x3cd903)){if(_0x66e65e=='telegramToken'&&_0xe18a4b==_0x20a2a2(0x250)){_0x3cd903['telegramToken']=settings[_0x20a2a2(0x25b)];continue;};if(_0x66e65e==_0x20a2a2(0xd1)&&_0xe18a4b==_0x20a2a2(0x250)){_0x3cd903[_0x20a2a2(0xd1)]=settings['bbPassword'];continue;};if(_0x66e65e==_0x20a2a2(0x20c)&&_0xe18a4b==_0x20a2a2(0x250)){_0x3cd903['marketcapApi']=settings['marketcapApi'];continue;};dbSettings[_0x20a2a2(0x206)](_0x20a2a2(0x117)+_0x66e65e,_0xe18a4b)[_0x20a2a2(0x192)]();}settings=_0x3cd903,io['to']('botmanager')[_0x20a2a2(0x123)](_0x20a2a2(0x97),cleanSettings()),broadcastToBots('timeshift',settings[_0x20a2a2(0x27b)]),broadcastToBots('onepagemode',settings[_0x20a2a2(0xc4)]),broadcastToBots(_0x20a2a2(0x20c),settings[_0x20a2a2(0x20c)]);if(_0x44aa48&&!_0x335cde)initTelegram();_0x44aa48&&_0x335cde&&(updateSetting(_0x20a2a2(0x138),null),disableTelegram()),getAllClients()['forEach'](_0x178ee0=>{const _0x54ac3e=_0x20a2a2;getSocket(_0x178ee0['id'])[_0x54ac3e(0x123)](_0x54ac3e(0x22d),{'access':{'allow':![],'reason':_0x54ac3e(0xe9),'token':null}});}),_0x13f51c&&(await sleep(0xbb8),testMarketcapApi(_0x3cd903[_0x20a2a2(0x20c)]));}async function testMarketcapApi(_0x139142){const _0xd1ecb4=_0x173b69,_0x3acb18=[_0xd1ecb4(0x141),_0xd1ecb4(0x24b)];try{await axios[_0xd1ecb4(0x184)](_0xd1ecb4(0x19c),{'headers':{'X-CMC_PRO_API_KEY':_0x139142},'params':{'symbol':_0x3acb18[_0xd1ecb4(0x191)]()}});}catch(_0x2c3432){_0x2c3432[_0xd1ecb4(0x191)]()['includes'](_0xd1ecb4(0x107))?(io['to'](_0xd1ecb4(0x215))[_0xd1ecb4(0x123)](_0xd1ecb4(0xc6),_0xd1ecb4(0xa0)),logger[_0xd1ecb4(0xda)](_0xd1ecb4(0xa0))):(io['to'](_0xd1ecb4(0x215))[_0xd1ecb4(0x123)](_0xd1ecb4(0xc6),_0xd1ecb4(0xf7)),logger[_0xd1ecb4(0xda)](_0xd1ecb4(0xf7)),logger[_0xd1ecb4(0x20e)](_0xd1ecb4(0x116),_0x2c3432[_0xd1ecb4(0x191)]()+_0xd1ecb4(0x293)+_0x2c3432[_0xd1ecb4(0x174)]));return;}logger[_0xd1ecb4(0x20e)](_0xd1ecb4(0xd8));}function updateSetting(_0x22fff4,_0x3c7cb8){const _0x57b58e=_0x173b69;dbSettings['set']('settings.'+_0x22fff4,_0x3c7cb8)[_0x57b58e(0x192)](),settings=getSettings(),io['to'](_0x57b58e(0x215))[_0x57b58e(0x123)]('settings',cleanSettings());}function storeSecure(_0x4d3adb){const _0x4f3173=_0x173b69;dbSecure[_0x4f3173(0x184)]('secure')[_0x4f3173(0x125)](_0x4d3adb)['write'](),secure=_0x4d3adb;}function addBlacklist(_0x1a0510){const _0x2e384d=_0x173b69;cleanBlacklist();let _0x226ad6;devices[_0x1a0510][_0x2e384d(0x253)]?_0x226ad6=Math[_0x2e384d(0x151)](devices[_0x1a0510][_0x2e384d(0x253)][_0x2e384d(0x291)],loginExpiry):_0x226ad6=loginExpiry,dbSecure[_0x2e384d(0x184)](_0x2e384d(0x254))['push']({'expiry':new Date()[_0x2e384d(0x239)]()+_0x226ad6*0x3c*0x3e8,'token':devices[_0x1a0510][_0x2e384d(0xae)][_0x2e384d(0x1f7)]})[_0x2e384d(0x192)](),blacklist=dbSecure[_0x2e384d(0x184)](_0x2e384d(0x254))[_0x2e384d(0x209)]();}function cleanBlacklist(){const _0x10886b=_0x173b69;let _0x175661=dbSecure[_0x10886b(0x184)](_0x10886b(0x254))['cloneDeep']()[_0x10886b(0x209)](),_0x35d963=new Date()[_0x10886b(0x239)]();_0x175661[_0x10886b(0x211)](_0x670662=>{const _0x1fffab=_0x10886b;_0x670662[_0x1fffab(0x291)]<_0x35d963&&dbSecure[_0x1fffab(0x184)](_0x1fffab(0x254))[_0x1fffab(0xd2)]({'expiry':_0x670662[_0x1fffab(0x291)]})['write']();});}function initStates(){const _0x3d3840=_0x173b69;let _0x61d843=getConfiguration();_0x61d843[_0x3d3840(0x211)](_0x30e517=>{const _0x3a8cec=_0x3d3840;_0x30e517['live']=_0x3a8cec(0x214);}),storeConfiguration(_0x61d843);}async function generateKeys(){const _0x5cf7bf=_0x173b69,_0x2ab54c=forge['pki'][_0x5cf7bf(0x195)][_0x5cf7bf(0xd3)]({'bits':0x1000,'e':0x10001}),_0x5983fd=forge['pki'][_0x5cf7bf(0x94)](_0x2ab54c[_0x5cf7bf(0x227)]),_0x1844dc=forge['pki'][_0x5cf7bf(0x294)](_0x2ab54c['publicKey']);return{'privateKey':_0x5983fd,'publicKey':_0x1844dc};}async function oneTimeMigration(){const _0x195811=_0x173b69;let _0x49303c=getSettings(),_0x1d3cda=![];!_0x49303c[_0x195811(0x281)](_0x195811(0xd9))&&(_0x49303c[_0x195811(0xd9)]=0x0,_0x1d3cda=!![]);!_0x49303c['hasOwnProperty'](_0x195811(0x1cf))&&(_0x49303c[_0x195811(0x1cf)]=0x0,_0x1d3cda=!![]);!_0x49303c[_0x195811(0x281)](_0x195811(0x28c))&&(_0x49303c[_0x195811(0x28c)]=_0x195811(0x92),_0x1d3cda=!![]);!_0x49303c[_0x195811(0x281)](_0x195811(0xc4))&&(_0x49303c[_0x195811(0xc4)]=![],_0x1d3cda=!![]);!_0x49303c[_0x195811(0x281)](_0x195811(0x20c))&&(_0x49303c[_0x195811(0x20c)]='',_0x1d3cda=!![]);if(_0x1d3cda)storeSettings(_0x49303c);try{fs[_0x195811(0x285)](configbackuppath,{'withFileTypes':!![]})[_0x195811(0x211)](_0x3d2c56=>{const _0x4eef4b=_0x195811;if(!_0x3d2c56[_0x4eef4b(0x120)]()){if(!_0x3d2c56['name'][_0x4eef4b(0xd4)](_0x4eef4b(0x245)))fs['unlinkSync'](configbackuppath+_0x3d2c56['name']);}else fs[_0x4eef4b(0x1ce)](configbackuppath+_0x3d2c56[_0x4eef4b(0x1ff)],{'recursive':!![]});});}catch(_0x2f7d8f){logger[_0x195811(0x20e)]('Error\x20removing\x20old\x20backup\x20files:',_0x2f7d8f);}}function storeConfiguration(_0x172fbc){const _0x4e82f6=_0x173b69;dbConfig['get'](_0x4e82f6(0x28a))[_0x4e82f6(0xd2)]()['write'](),dbConfig[_0x4e82f6(0x184)]('bots')[_0x4e82f6(0x125)](..._0x172fbc)['write'](),config=_0x172fbc;}async function resetPassword(){const _0x3d0144=_0x173b69;if(tgBot&&settings[_0x3d0144(0x138)]){const _0x4309d1=Markup[_0x3d0144(0x11d)]([Markup[_0x3d0144(0x1aa)]['callback'](_0x3d0144(0x24f),_0x3d0144(0x295)),Markup[_0x3d0144(0x1aa)][_0x3d0144(0x265)]('no',_0x3d0144(0x177))]);await sendTelegram(settings[_0x3d0144(0x138)],_0x3d0144(0x10c),_0x4309d1),tgBot[_0x3d0144(0x198)](/resetpw_(.+)/,async _0x150941=>{const _0x4b3827=_0x3d0144,_0x4ab33d=_0x150941[_0x4b3827(0x108)][0x1];_0x150941['editMessageReplyMarkup']();if(_0x4ab33d!='no'){const _0x69d4db=0xf,_0x1e3450=_0x4b3827(0x170),_0x36fc94=Array[_0x4b3827(0x1ab)](crypto[_0x4b3827(0x251)](new Uint32Array(_0x69d4db)))[_0x4b3827(0x18e)](_0x563496=>_0x1e3450[_0x563496%_0x1e3450['length']])[_0x4b3827(0x144)](''),_0x96e67b=bcrypt[_0x4b3827(0xc0)](_0x36fc94,saltRounds);storeSettings({'bbPassword':_0x96e67b}),await sendTelegram(_0x150941['chat']['id'],_0x4b3827(0xcd)+_0x36fc94,{'parse_mode':_0x4b3827(0x136)});}else await sendTelegram(_0x150941[_0x4b3827(0x28d)]['id'],_0x4b3827(0xd7));});}}async function confirmRestore(_0x28cedb,_0x40d170){const _0x597123=_0x173b69;io['to']('botmanager')[_0x597123(0x123)]('notification','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','success');if(tgBot&&settings['telegramChatId']){const _0x387f80=uuidRandom();tmpStorage[_0x387f80]={'path':_0x28cedb,'filename':_0x40d170};const _0x4da6df=Markup[_0x597123(0x11d)]([Markup[_0x597123(0x1aa)][_0x597123(0x265)](_0x597123(0x24f),'restore_yes_'+_0x387f80),Markup[_0x597123(0x1aa)][_0x597123(0x265)]('no',_0x597123(0x1b9)+_0x387f80)]);await sendTelegram(settings[_0x597123(0x138)],_0x597123(0x8f),_0x4da6df),tgBot[_0x597123(0x198)](/restore_(.+)_(.+)/,async _0x58d3d3=>{const _0x55d6fb=_0x597123,_0x14777f=_0x58d3d3[_0x55d6fb(0x108)][0x1],_0x53ed70=_0x58d3d3[_0x55d6fb(0x108)][0x2],{path:_0x5a43ab,filename:_0x32f39a}=tmpStorage[_0x53ed70];delete tmpStorage[_0x53ed70],_0x58d3d3['editMessageReplyMarkup'](),_0x14777f==_0x55d6fb(0x24f)?(logger[_0x55d6fb(0x20e)](_0x55d6fb(0x220)),await sendTelegram(_0x58d3d3['chat']['id'],_0x55d6fb(0x14c),{'parse_mode':'HTML'}),unzipFile(_0x5a43ab,_0x32f39a)):(logger['debug'](_0x55d6fb(0x26a)),await sendTelegram(_0x58d3d3[_0x55d6fb(0x28d)]['id'],_0x55d6fb(0x26a)));});}}function getServerTime(){const _0xdd9f56=_0x173b69,_0x1ea42f=new Date();return _0x1ea42f[_0xdd9f56(0x19f)]()+'/'+(_0x1ea42f[_0xdd9f56(0x264)]()+0x1)[_0xdd9f56(0x191)]()[_0xdd9f56(0x1d8)](0x2,'0')+'/'+_0x1ea42f[_0xdd9f56(0x1d9)]()[_0xdd9f56(0x191)]()[_0xdd9f56(0x1d8)](0x2,'0')+'\x20'+_0x1ea42f['getHours']()['toString']()[_0xdd9f56(0x1d8)](0x2,'0')+':'+_0x1ea42f[_0xdd9f56(0xd6)]()[_0xdd9f56(0x191)]()[_0xdd9f56(0x1d8)](0x2,'0')+':'+_0x1ea42f[_0xdd9f56(0x200)]()[_0xdd9f56(0x191)]()[_0xdd9f56(0x1d8)](0x2,'0');}function getTimeStamp(){const _0x3c3988=_0x173b69,_0x3c6e8c=shiftedTime();return _0x3c6e8c['getFullYear']()+'/'+(_0x3c6e8c[_0x3c3988(0x264)]()+0x1)[_0x3c3988(0x191)]()[_0x3c3988(0x1d8)](0x2,'0')+'/'+_0x3c6e8c['getDate']()[_0x3c3988(0x191)]()[_0x3c3988(0x1d8)](0x2,'0')+'\x20'+_0x3c6e8c[_0x3c3988(0x274)]()['toString']()[_0x3c3988(0x1d8)](0x2,'0')+':'+_0x3c6e8c[_0x3c3988(0xd6)]()[_0x3c3988(0x191)]()['padStart'](0x2,'0')+':'+_0x3c6e8c[_0x3c3988(0x200)]()[_0x3c3988(0x191)]()[_0x3c3988(0x1d8)](0x2,'0');}function getCleanTimeStamp(){const _0x3364f1=_0x173b69,_0x5e2397=shiftedTime();return _0x5e2397[_0x3364f1(0x19f)]()+(_0x5e2397[_0x3364f1(0x264)]()+0x1)[_0x3364f1(0x191)]()[_0x3364f1(0x1d8)](0x2,'0')+_0x5e2397[_0x3364f1(0x1d9)]()[_0x3364f1(0x191)]()[_0x3364f1(0x1d8)](0x2,'0')+'-'+_0x5e2397[_0x3364f1(0x274)]()[_0x3364f1(0x191)]()['padStart'](0x2,'0')+_0x5e2397[_0x3364f1(0xd6)]()['toString']()[_0x3364f1(0x1d8)](0x2,'0')+_0x5e2397[_0x3364f1(0x200)]()[_0x3364f1(0x191)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x6ec1f4=_0x173b69,_0x3e610f=new Date();let _0x5d2918=_0x3e610f;if(settings[_0x6ec1f4(0x27b)]&&settings[_0x6ec1f4(0x27b)]!==0x0)_0x5d2918=fns[_0x6ec1f4(0x142)](_0x3e610f,{'hours':settings[_0x6ec1f4(0x27b)]});return _0x5d2918;}async function startScheduler(){const _0x7b9b86=_0x173b69,_0x40c17b=new Date()[_0x7b9b86(0x24a)](),_0x2f1258=shiftedTime()[_0x7b9b86(0x274)]();_0x2f1258==0x4&&backupConfigFiles(),_0x2f1258==0x0&&(rotateLogFiles(),logger[_0x7b9b86(0x20e)](_0x7b9b86(0xb5)),logger['debug'](_0x7b9b86(0x12b)+serverversion+_0x7b9b86(0xca)+(environment==_0x7b9b86(0x1d4)?_0x7b9b86(0x29c):'')),logger[_0x7b9b86(0x20e)](_0x7b9b86(0xb5))),_0x40c17b%0x6==0x0&&triggerAnalytics(),_0x40c17b%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x5c6b3b){const _0x354ba8=_0x173b69;logger[_0x354ba8(0x20e)](_0x354ba8(0x25a)+_0x5c6b3b);const _0x5d885d=getBotsWithMode();_0x5d885d[_0x354ba8(0x272)]>0x0?confirmRestore(configbackuppath,_0x5c6b3b):unzipFile(configbackuppath,_0x5c6b3b);}async function getBackupFiles(_0x4a87c0=null){const _0x3c8786=_0x173b69;let _0x369d91=[],_0x4048f7=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x4048f7[_0x3c8786(0x237)]((_0x34def9,_0x25f6d5)=>_0x34def9['name']<_0x25f6d5[_0x3c8786(0x1ff)]?0x1:_0x25f6d5[_0x3c8786(0x1ff)]<_0x34def9[_0x3c8786(0x1ff)]?-0x1:0x0),_0x4048f7[_0x3c8786(0x211)](_0x20c37a=>{const _0x13f7d4=_0x3c8786;if(!_0x20c37a[_0x13f7d4(0x120)]()&&_0x20c37a[_0x13f7d4(0x1ff)][_0x13f7d4(0xd4)](_0x13f7d4(0x245))&&_0x20c37a['name'][_0x13f7d4(0x126)]('.zip')){const _0x5a4167=formatDate(fs[_0x13f7d4(0x29a)](configbackuppath+_0x20c37a[_0x13f7d4(0x1ff)])[_0x13f7d4(0x1ac)]);_0x369d91[_0x13f7d4(0x125)]({'name':_0x20c37a[_0x13f7d4(0x1ff)],'mtime':_0x5a4167});}});if(_0x4a87c0)io['to'](_0x4a87c0)['emit'](_0x3c8786(0x9a),_0x369d91);else return _0x369d91;}async function backupConfigFiles(){const _0x4f4be5=_0x173b69;await zipFiles(_0x4f4be5(0x109));const _0x517465=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x4f4be5(0x20d),configbackuppath+(_0x4f4be5(0x245)+_0x517465+_0x4f4be5(0x103)));let _0x37d020=fs[_0x4f4be5(0x285)](configbackuppath,{'withFileTypes':!![]});_0x37d020[_0x4f4be5(0x237)]((_0xca0fa2,_0x8efc9a)=>_0xca0fa2[_0x4f4be5(0x1ff)]<_0x8efc9a['name']?0x1:_0x8efc9a[_0x4f4be5(0x1ff)]<_0xca0fa2['name']?-0x1:0x0),_0x37d020[_0x4f4be5(0x272)]>maxBackups&&fs[_0x4f4be5(0x212)](configbackuppath+_0x37d020[_0x37d020[_0x4f4be5(0x272)]-0x1]['name']);}function rotateLogFiles(){const _0x32840e=_0x173b69,_0x44828d=fs[_0x32840e(0x29a)](logspath+_0x32840e(0x9b)),_0x468557=_0x44828d['size']/0x400;if(_0x468557>0x64){let _0x3ece08=fs[_0x32840e(0x285)](logspath,{'withFileTypes':!![]});_0x3ece08[_0x32840e(0x237)]((_0x133569,_0x4ef489)=>_0x133569[_0x32840e(0x1ff)]<_0x4ef489[_0x32840e(0x1ff)]?0x1:_0x4ef489[_0x32840e(0x1ff)]<_0x133569['name']?-0x1:0x0),_0x3ece08[_0x32840e(0x211)](_0x222c84=>{const _0xf64d6d=_0x32840e;if(_0x222c84[_0xf64d6d(0x1ff)]=='output-002.log')fs[_0xf64d6d(0x262)](logspath+_0x222c84[_0xf64d6d(0x1ff)],logspath+'output-003.log');if(_0x222c84[_0xf64d6d(0x1ff)]==_0xf64d6d(0x10d))fs[_0xf64d6d(0x262)](logspath+_0x222c84[_0xf64d6d(0x1ff)],logspath+'output-002.log');_0x222c84['name']=='output-000.log'&&(fs[_0xf64d6d(0x262)](logspath+_0x222c84[_0xf64d6d(0x1ff)],logspath+_0xf64d6d(0x10d)),fs[_0xf64d6d(0x160)](logspath+_0x222c84[_0xf64d6d(0x1ff)],''));});}}async function zipFiles(_0x529358){const _0x37e3c8=_0x173b69;let _0x16bee5;if(_0x529358==_0x37e3c8(0x204))_0x16bee5=logspath;if(_0x529358==_0x37e3c8(0x8b))_0x16bee5=configpath;if(_0x529358=='backup-full')_0x16bee5=configpath;let _0x5b9cf0=fs[_0x37e3c8(0x285)](_0x16bee5,{'withFileTypes':!![]});const _0x281ca1=new JSZip();_0x5b9cf0[_0x37e3c8(0x211)](_0x426093=>{const _0x14a3b9=_0x37e3c8;if(!_0x426093[_0x14a3b9(0x120)]()){let _0x56abd4=fs[_0x14a3b9(0xbd)](_0x16bee5+_0x426093['name']);if(_0x529358==_0x14a3b9(0x8b)){const _0x44d981=/^bot-[0-9]{3}-config.json$/,_0x3f748e=_0x44d981[_0x14a3b9(0x14b)](_0x426093['name']);if(_0x3f748e){const _0x54d57f=JSON[_0x14a3b9(0x152)](_0x56abd4);if(_0x54d57f[_0x14a3b9(0x176)][0x0]){_0x54d57f['bot'][0x0]['apiKey']=_0x14a3b9(0x99),_0x54d57f[_0x14a3b9(0x176)][0x0][_0x14a3b9(0x240)]='***';if(_0x54d57f[_0x14a3b9(0x176)][0x0][_0x14a3b9(0x147)])_0x54d57f[_0x14a3b9(0x176)][0x0][_0x14a3b9(0x147)]=_0x14a3b9(0x99);}_0x56abd4=JSON['stringify'](_0x54d57f,null,0x2);}if(_0x426093[_0x14a3b9(0x1ff)]=='bb-settings.json'){const _0x3ed728=JSON[_0x14a3b9(0x152)](_0x56abd4);if(_0x3ed728[_0x14a3b9(0x97)][_0x14a3b9(0x159)])_0x3ed728[_0x14a3b9(0x97)][_0x14a3b9(0x159)]=![];if(_0x3ed728[_0x14a3b9(0x97)][_0x14a3b9(0xd1)])_0x3ed728[_0x14a3b9(0x97)][_0x14a3b9(0xd1)]=_0x14a3b9(0x99);if(_0x3ed728[_0x14a3b9(0x97)][_0x14a3b9(0x25b)])_0x3ed728['settings'][_0x14a3b9(0x25b)]='***';if(_0x3ed728['settings'][_0x14a3b9(0x138)])_0x3ed728['settings']['telegramChatId']=null;if(_0x3ed728[_0x14a3b9(0x97)]['marketcapApi'])_0x3ed728[_0x14a3b9(0x97)][_0x14a3b9(0x20c)]=_0x14a3b9(0x99);_0x56abd4=JSON[_0x14a3b9(0x1a5)](_0x3ed728,null,0x2);}if(_0x426093['name']!=_0x14a3b9(0xe8))_0x281ca1[_0x14a3b9(0xf8)](_0x426093['name'],_0x56abd4);}else _0x281ca1[_0x14a3b9(0xf8)](_0x426093[_0x14a3b9(0x1ff)],_0x56abd4);}});const _0x265867=await _0x281ca1[_0x37e3c8(0x24d)]({'type':_0x37e3c8(0x280),'base64':![],'compression':_0x37e3c8(0x1e1)});fs['writeFileSync'](zippath+(_0x529358+'.zip'),_0x265867,'binary');}async function unzipFile(_0x280e23,_0x1fa8b7){const _0x35dab4=_0x173b69;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x35dab4(0x211)](_0x2e3c83=>{const _0x2751d7=_0x35dab4;if(!_0x2e3c83[_0x2751d7(0x120)]())fs['rmSync'](configpath+_0x2e3c83[_0x2751d7(0x1ff)]);});const _0x557b12=fs[_0x35dab4(0xbd)](_0x280e23+_0x1fa8b7,_0x35dab4(0x164)),_0x3df47d=await JSZip[_0x35dab4(0xbb)](_0x557b12,{'base64':![],'checkCRC32':!![]});for(const _0x2265db of Object[_0x35dab4(0xdc)](_0x3df47d[_0x35dab4(0xff)])){const _0x4795d9=_0x3df47d[_0x35dab4(0xff)][_0x2265db],_0x201f4f=await _0x4795d9['async'](_0x35dab4(0x280));fs[_0x35dab4(0x160)](configpath+_0x4795d9['name'],_0x201f4f);}fs[_0x35dab4(0x285)](temppath,{'withFileTypes':!![]})['forEach'](_0x2ac9d7=>{const _0x48f8b6=_0x35dab4;if(!_0x2ac9d7['isDirectory']())fs[_0x48f8b6(0x1ce)](temppath+_0x2ac9d7[_0x48f8b6(0x1ff)]);}),logger[_0x35dab4(0x20e)](_0x35dab4(0x27e)),process[_0x35dab4(0xc9)]({'restore':!![]},_0x28f2eb=>{});}async function getPublicIp(){const _0x127799=_0x173b69;try{const _0x5f1152=await axios[_0x127799(0x184)](_0x127799(0x9d));publicip=_0x5f1152[_0x127799(0x1e6)]['ip'];}catch(_0x151ae1){}}async function triggerAnalytics(){const _0x483214=_0x173b69;if(!publicip)await getPublicIp();const _0x50644d=getBotsWithMode();let _0x39080f=0x0;_0x50644d['forEach'](_0x2386a7=>{const _0x14dd52=_0x2275;if(_0x2386a7['status']===_0x14dd52(0x14d))_0x39080f++;});const _0x76754f=getBotExchanges();mixpanel['track'](_0x483214(0x1e7),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x50644d['length'],'numbotsenabled':_0x39080f,'exchanges':_0x76754f,'environment':environment});}async function getMessages(){const _0xec2590=_0x173b69,_0x390349='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x54bfcb=new GraphQLClient(_0x390349),_0x4454e5={'authorization':_0xec2590(0xc3)},_0x5a57e1=serverversion[_0xec2590(0x1b2)]('.'),_0x3d4bae=_0x5a57e1[0x0]+'.'+_0x5a57e1[0x1],_0x35ede8=Math['min'](settings[_0xec2590(0xd9)],settings[_0xec2590(0x1cf)]),_0x3dbcb2={'last':parseInt(_0x35ede8),'bbm':_0x3d4bae},_0x3073d4=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x189304;try{_0x189304=await _0x54bfcb[_0xec2590(0x181)](_0x3073d4,_0x3dbcb2,_0x4454e5);}catch(_0x113666){}if(_0x189304&&_0x189304[_0xec2590(0x26d)]){let _0x5b087d=settings[_0xec2590(0xd9)];newMessages=[];for(const _0x2b4234 of _0x189304[_0xec2590(0x26d)]){newMessages['push'](_0x2b4234);let _0x42227a=![];_0x2b4234[_0xec2590(0x248)]&&(updateSetting(_0xec2590(0x28c),_0x2b4234[_0xec2590(0x248)]),_0x42227a=isNewerVersion(serverversion,_0x2b4234['bbvNew'])||serverversion==_0x2b4234[_0xec2590(0x248)]);if(!_0x42227a&&_0x2b4234[_0xec2590(0x178)]>_0x5b087d){if(_0x2b4234[_0xec2590(0x93)]===_0xec2590(0xb7)||serverversion[_0xec2590(0xd4)](_0x2b4234[_0xec2590(0x93)])){let _0x19a044=''+_0x2b4234[_0xec2590(0x1f6)]+'\x0a\x0a'+_0x2b4234[_0xec2590(0x21c)];const _0x1efa3e=await sendTelegramMsg(toTelegramMarkdown(_0x19a044),_0xec2590(0x175));if(_0x1efa3e)_0x5b087d=_0x2b4234[_0xec2590(0x178)];}}}updateAvailable=isNewerVersion(settings[_0xec2590(0x28c)],serverversion),updateSetting(_0xec2590(0xd9),_0x5b087d),emitMessages();}}function emitMessages(){const _0x1acff8=_0x173b69,_0x32bbfe=settings[_0x1acff8(0x1cf)];let _0x2f8bb7=[];newMessages[_0x1acff8(0x211)](_0x4fa298=>{const _0x4f2722=_0x1acff8;_0x4fa298[_0x4f2722(0x178)]>_0x32bbfe&&_0x2f8bb7['push'](_0x4fa298);}),_0x2f8bb7[_0x1acff8(0x272)]>0x0&&getAllClients()[_0x1acff8(0x211)](_0x3c847f=>{const _0x39eb19=_0x1acff8;getSocket(_0x3c847f['id'])[_0x39eb19(0x123)](_0x39eb19(0x21c),_0x2f8bb7);});}function confirmMessage(_0x3ff9c1){updateSetting('lastmsgemitted',Number(_0x3ff9c1));}function isNewerVersion(_0x181b0b,_0x2541dc){const _0x4eeefe=_0x173b69,_0x2e90e4=_0x2541dc[_0x4eeefe(0x1b2)]('.'),_0x3922bf=_0x181b0b['split']('.');for(var _0xb586ab=0x0;_0xb586ab<_0x3922bf[_0x4eeefe(0x272)];_0xb586ab++){const _0x445bce=~~_0x3922bf[_0xb586ab],_0x5e488b=~~_0x2e90e4[_0xb586ab];if(_0x445bce>_0x5e488b)return!![];if(_0x445bce<_0x5e488b)return![];}return![];}function toTelegramMarkdown(_0x370841){const _0x55af59=_0x173b69,_0x55ea0f=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xb1c890=/\*{2}(.+?)\*{2}/gim;return _0x370841=_0x370841[_0x55af59(0x1e9)](_0x55ea0f,_0x55af59(0x1cc))[_0x55af59(0x1e9)](_0xb1c890,_0x55af59(0x17f)),_0x370841;}async function validateConfigFile(){const _0x23f211=_0x173b69,_0x47c33d=dbConfig[_0x23f211(0x184)](_0x23f211(0x28a))[_0x23f211(0x279)](_0x23f211(0xb8))['value']()||[];if(_0x47c33d[_0x23f211(0x272)]==0x0){let _0x3d9a85=0x0,_0x10e879=[];const _0x462146=/^bot-([0-9]{3})-config.json$/,_0x53e34c=fs['readdirSync'](configpath);_0x53e34c[_0x23f211(0x211)](_0x572382=>{const _0x582215=_0x23f211,_0x5c020a=_0x462146['exec'](_0x572382);if(_0x5c020a){const _0x12e8dd=_0x5c020a[0x1];let _0x1d4602=getBotAttributes(_0x12e8dd);_0x10e879['push']({'botID':_0x12e8dd,'botname':_0x1d4602[_0x582215(0xa4)],'status':_0x582215(0x17e),'live':_0x582215(0x214)}),_0x3d9a85++;}}),_0x3d9a85!=0x0&&(dbConfig['get'](_0x23f211(0x28a))[_0x23f211(0x1c9)](_0x10e879)['write'](),config=_0x10e879,restoredConfigFile=_0x3d9a85);}}async function restoreConfigNotify(_0x51804f){const _0x215596=_0x173b69;let _0x454130;if(restoredConfigFile==0x1)_0x454130=_0x215596(0xf2);else _0x454130=_0x215596(0x8c);if(_0x51804f)io['to'](_0x215596(0x215))[_0x215596(0x123)](_0x215596(0xc6),_0x454130);else{logger[_0x215596(0x15a)]('-----------------------------------------------------------------------------------'),logger[_0x215596(0x15a)](_0x454130),logger[_0x215596(0x15a)](_0x215596(0x210)),logger[_0x215596(0x15a)]('');if(tgBot&&settings[_0x215596(0x138)]&&settings[_0x215596(0xa9)]!=_0x215596(0x252))await sendTelegram(settings[_0x215596(0x138)],_0x215596(0x15f)+_0x454130);}}function decryptRSA(_0x3b9de1,_0x57dc3f){const _0x14fd16=_0x173b69,_0x41cb4f=forge[_0x14fd16(0x128)][_0x14fd16(0x287)](_0x3b9de1),_0x1f051b=_0x41cb4f[_0x14fd16(0x246)](forge[_0x14fd16(0x187)][_0x14fd16(0x140)](_0x57dc3f),'RSA-OAEP',{'md':forge['md'][_0x14fd16(0x111)][_0x14fd16(0x1a2)](),'mgf1':{'md':forge['md'][_0x14fd16(0x111)]['create']()}});return _0x1f051b;}function validateCredentials(_0x11ce54,_0x5e26bf){const _0x1f7b3e=_0x173b69;if(_0x11ce54['username']==settings[_0x1f7b3e(0x1a4)]&&bcrypt[_0x1f7b3e(0x20a)](_0x11ce54['password'],settings['bbPassword'])){if(settings[_0x1f7b3e(0x258)])return{'allow':![],'reason':_0x1f7b3e(0x23c),'token':null};else{const _0x59aeca=generateLoginToken(_0x5e26bf);return{'allow':!![],'reason':_0x1f7b3e(0x1e2),'token':_0x59aeca};}}else return{'allow':![],'reason':_0x1f7b3e(0x1a7),'token':null};}function refreshToken(_0x38515b){const _0x2b2653=_0x173b69,_0x34f6ff=generateLoginToken(_0x38515b);return{'allow':!![],'reason':_0x2b2653(0x1e2),'token':_0x34f6ff};}function validateAccess(_0x4636ea,_0x54eccb,_0x19b00b){const _0x56328b=_0x173b69,_0xa653e=_0x19b00b?_0x19b00b:devices[_0x54eccb]['ip'];let _0x972443;const _0x42eaf7=_0x3dc8c4=>{const _0xf59d6f=_0x2275;if(settings['loginRequired']){if(settings[_0xf59d6f(0x258)]){if(telegram2FaApproved(_0x54eccb)){const _0x3da7bc=generateLoginToken(_0x54eccb);return{'allow':!![],'reason':_0xf59d6f(0xea),'token':_0x3da7bc};}else return{'allow':![],'reason':_0xf59d6f(0x13c),'token':null};}else return _0x972443=validToken(_0x3dc8c4,_0x54eccb),_0x972443['hasOwnProperty']('success')?{'allow':!![],'reason':_0xf59d6f(0x1be),'token':_0x3dc8c4}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0xf59d6f(0x275),'token':null};};if(settings[_0x56328b(0x202)]){let _0x40cb92=[...settings[_0x56328b(0x185)],_0x56328b(0x201),_0x56328b(0x119),'127.0.0.1'];if(_0x40cb92[_0x56328b(0x102)](_0xa653e))return _0x42eaf7(_0x4636ea);else{_0x972443=validToken(_0x4636ea,_0x54eccb);if(_0x972443[_0x56328b(0x281)](_0x56328b(0x243)))return _0x42eaf7(_0x4636ea);else{if(telegramIpApproved(_0x54eccb)){const _0x8e128a=generateToken(_0x54eccb);return _0x972443=_0x42eaf7(_0x4636ea),_0x972443[_0x56328b(0x1fb)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x8e128a}:_0x972443;}else return settings[_0x56328b(0x259)]?{'allow':![],'reason':_0x56328b(0x137),'token':null}:{'allow':![],'reason':_0x56328b(0x266),'token':null};}}}else return _0x42eaf7(_0x4636ea);}function timelyDecrypt(_0x5c5f76,_0x35d73e,_0x23d91e='@'){const _0x2a8e99=_0x173b69;if(_0x5c5f76)try{const _0x3743ce=decryptRSA(secure['privateKey'],_0x5c5f76),_0x4aad75=_0x3743ce['split'](_0x23d91e)[0x0],_0x77b277=_0x3743ce[_0x2a8e99(0x1b2)](_0x23d91e)[0x1],_0x5efb99=new Date()[_0x2a8e99(0x239)]();if(_0x35d73e){if(_0x5efb99-_0x77b277<maxSecretAge*0x3e8)return _0x4aad75;else return![];}else return _0x4aad75;}catch(_0x19315a){return![];}else return![];}const validToken=(_0xe05aef,_0x54acd2)=>{const _0x34eb80=_0x173b69,_0x221992=devices[_0x54acd2]['ip'];if(!_0xe05aef)return{'error':_0x34eb80(0x22b)};for(let _0x457bed of blacklist){if(_0x457bed[_0x34eb80(0x1f7)]==_0xe05aef)return{'error':'Token\x20blacklisted'};}let _0x34ba15;try{_0x34ba15=jwt['verify'](_0xe05aef,secure[_0x34eb80(0x165)]+_0x54acd2);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x34ba15[_0x34eb80(0x281)](_0x34eb80(0x17c))&&!_0x34ba15[_0x34eb80(0x281)](_0x34eb80(0x16f))||!_0x34ba15[_0x34eb80(0x281)](_0x34eb80(0x1c4)))return{'error':_0x34eb80(0x1bb)};if(!_0x34ba15[_0x34eb80(0x281)](_0x34eb80(0x16f))&&_0x34ba15[_0x34eb80(0x281)](_0x34eb80(0x17c))){const {clientip:_0x13d280}=_0x34ba15;return _0x221992==_0x13d280?{'success':_0x34eb80(0x199)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x34ba15[_0x34eb80(0x281)]('username')&&_0x34ba15[_0x34eb80(0x281)](_0x34eb80(0x17c))){const {username:_0x4de564,clientip:_0x3b35c7}=_0x34ba15;return settings[_0x34eb80(0x1a4)]==_0x4de564&&_0x221992==_0x3b35c7?{'success':_0x34eb80(0x199)}:{'error':_0x34eb80(0xcc)};}}},generateLoginToken=_0x3a3140=>{const _0x4764ce=_0x173b69;if(_0x3a3140){const _0x136c67=devices[_0x3a3140]['ip'];return jwt['sign']({'username':settings['bbUsername'],'clientip':_0x136c67},secure[_0x4764ce(0x165)]+_0x3a3140,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x81f363=>{const _0x28a00f=_0x173b69;if(_0x81f363){const _0x1ada5a=devices[_0x81f363]['ip'];return jwt[_0x28a00f(0xe6)]({'clientip':_0x1ada5a},secure[_0x28a00f(0x165)]+_0x81f363,{'expiresIn':devices[_0x81f363][_0x28a00f(0x253)][_0x28a00f(0x291)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x5da6e7=>{const _0x58a260=_0x173b69;let _0xbd043a=![];return devices[_0x5da6e7]['telegramIpApproval']&&devices[_0x5da6e7]['telegramIpApproval'][_0x58a260(0x291)]!=_0x58a260(0x17b)&&(_0xbd043a=devices[_0x5da6e7][_0x58a260(0x253)][_0x58a260(0x17c)]==devices[_0x5da6e7]['ip']&&new Date()[_0x58a260(0x239)]()-devices[_0x5da6e7]['telegramIpApproval'][_0x58a260(0x13d)]<devices[_0x5da6e7]['telegramIpApproval'][_0x58a260(0x291)]*0x3c*0x3e8),_0xbd043a;},telegram2FaApproved=_0x2d64cd=>{const _0x17449c=_0x173b69;let _0x5e85a5=![];return devices[_0x2d64cd]['telegram2FaApproval']&&devices[_0x2d64cd][_0x17449c(0x1dc)][_0x17449c(0x291)]!=_0x17449c(0x17b)&&(_0x5e85a5=devices[_0x2d64cd][_0x17449c(0x1dc)]['clientip']==devices[_0x2d64cd]['ip']&&new Date()[_0x17449c(0x239)]()-devices[_0x2d64cd]['telegram2FaApproval']['timestamp']<devices[_0x2d64cd][_0x17449c(0x1dc)][_0x17449c(0x291)]*0x3c*0x3e8),_0x5e85a5;},normalizeIP=_0x2a0446=>{const _0x2e6f34=_0x173b69;let _0xce986a=null,_0x11130c=null;if(ipaddr[_0x2e6f34(0x158)](_0x2a0446)){const _0x23f6d8=ipaddr[_0x2e6f34(0x152)](_0x2a0446);_0x23f6d8[_0x2e6f34(0x1df)]()===_0x2e6f34(0x193)?(_0x23f6d8[_0x2e6f34(0xde)]()&&(_0xce986a=_0x23f6d8['toIPv4Address']()['toString']()),_0x11130c=_0x23f6d8[_0x2e6f34(0x191)]()):(_0xce986a=_0x23f6d8[_0x2e6f34(0x191)](),_0x11130c=_0x23f6d8[_0x2e6f34(0x10e)]()['toString']());}return{'show':_0xce986a?_0xce986a:_0x11130c,'store':_0x11130c};};function formatDate(_0x2680b0){const _0x9b558c=_0x173b69;return _0x2680b0[_0x9b558c(0x19f)]()+'/'+(_0x2680b0[_0x9b558c(0x264)]()+0x1)[_0x9b558c(0x191)]()[_0x9b558c(0x1d8)](0x2,'0')+'/'+_0x2680b0[_0x9b558c(0x1d9)]()[_0x9b558c(0x191)]()['padStart'](0x2,'0')+'\x20'+_0x2680b0[_0x9b558c(0x274)]()['toString']()['padStart'](0x2,'0')+':'+_0x2680b0[_0x9b558c(0xd6)]()['toString']()[_0x9b558c(0x1d8)](0x2,'0')+':'+_0x2680b0[_0x9b558c(0x200)]()['toString']()[_0x9b558c(0x1d8)](0x2,'0');}function sleep(_0x3c9541){return new Promise(_0x3d636b=>setTimeout(_0x3d636b,_0x3c9541));}