const _0x219694=_0x1332;(function(_0x4bea08,_0x3530f3){const _0x4706f4=_0x1332,_0x444f1f=_0x4bea08();while(!![]){try{const _0x42ecdc=parseInt(_0x4706f4(0x2c9))/0x1*(-parseInt(_0x4706f4(0x25e))/0x2)+-parseInt(_0x4706f4(0x2ea))/0x3*(-parseInt(_0x4706f4(0x198))/0x4)+-parseInt(_0x4706f4(0x352))/0x5*(parseInt(_0x4706f4(0x2fb))/0x6)+parseInt(_0x4706f4(0x1e2))/0x7*(parseInt(_0x4706f4(0x36b))/0x8)+parseInt(_0x4706f4(0x2c8))/0x9+-parseInt(_0x4706f4(0x1a9))/0xa+parseInt(_0x4706f4(0x1b0))/0xb;if(_0x42ecdc===_0x3530f3)break;else _0x444f1f['push'](_0x444f1f['shift']());}catch(_0x251703){_0x444f1f['push'](_0x444f1f['shift']());}}}(_0x5426,0xa14ab));const _0x59bb5d=function(){let _0x404191=!![];return function(_0xc1546e,_0x3ad2c6){const _0x45780b=_0x404191?function(){if(_0x3ad2c6){const _0x33b07a=_0x3ad2c6['apply'](_0xc1546e,arguments);return _0x3ad2c6=null,_0x33b07a;}}:function(){};return _0x404191=![],_0x45780b;};}(),_0x1bec46=_0x59bb5d(this,function(){const _0x43e5f5=_0x1332;return _0x1bec46[_0x43e5f5(0x29e)]()[_0x43e5f5(0x27b)](_0x43e5f5(0x1c7))[_0x43e5f5(0x29e)]()[_0x43e5f5(0x207)](_0x1bec46)['search'](_0x43e5f5(0x1c7));});_0x1bec46();'use strict';process[_0x219694(0x28c)][_0x219694(0x26a)]=0x1;const childProcess=require(_0x219694(0x2bb)),fs=require('fs'),fns=require(_0x219694(0x315)),low=require(_0x219694(0x1a6)),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require('crypto'),forge=require('node-forge'),bcrypt=require(_0x219694(0x2d8)),jwt=require(_0x219694(0x2a8)),ipaddr=require('ipaddr.js'),argv=require(_0x219694(0x1da))(process[_0x219694(0x203)][_0x219694(0x247)](0x2))['argv'],uuidRandom=require(_0x219694(0x38c)),{Telegraf,Markup}=require(_0x219694(0x238)),Mixpanel=require('mixpanel'),axios=require(_0x219694(0x289)),{GraphQLClient,gql}=require(_0x219694(0x1fe)),util=require(_0x219694(0x19d)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x219694(0x234)),PORT=argv[_0x219694(0x292)]||_0x219694(0x1a0),pattern=/^[0-9]{2,4}$/;!pattern[_0x219694(0x19a)](PORT)&&(console['log']('Error:\x20Invalid\x20argument\x20'+PORT+_0x219694(0x373)),process['exit'](0x1));const HOST=argv[_0x219694(0x33e)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x219694(0x2af)][_0x219694(0x2e5)];let bbpath=_0x219694(0x260),bbpath2='';const botfile=_0x219694(0x28b),configfile=_0x219694(0x36d),settingsfile='bb-settings.json',securefile=_0x219694(0x27a),environment=require('./'+bbpath2+_0x219694(0x299))[_0x219694(0x20c)]||_0x219694(0x282),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x219694(0x2bf)),configpath=userID?bbpath+_0x219694(0x1eb)+userID+'/':bbpath+_0x219694(0x1eb),configbackuppath=configpath+_0x219694(0x192),logspath=userID?bbpath+_0x219694(0x357)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x219694(0x280)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x219694(0x1f6)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x219694(0x255)+userID+'/':bbpath+_0x219694(0x255);!fs['existsSync'](configpath)&&fs[_0x219694(0x2d9)](configpath);!fs[_0x219694(0x31d)](configbackuppath)&&fs[_0x219694(0x2d9)](configbackuppath);!fs[_0x219694(0x31d)](logspath)&&fs[_0x219694(0x2d9)](logspath);!fs['existsSync'](zippath)&&fs[_0x219694(0x2d9)](zippath);!fs['existsSync'](temppath)&&fs[_0x219694(0x2d9)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x219694(0x1d4)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x219694(0x1d4)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x219694(0x26c),'onepagemode':![],'marketcapApi':''}})[_0x219694(0x346)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();const saltRounds=0xa,mixpanel=Mixpanel[_0x219694(0x1b2)](_0x219694(0x330),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x219694(0x370)]&&(settings[_0x219694(0x370)]!=''&&settings[_0x219694(0x370)]!=_0x219694(0x2ff))&&settings[_0x219694(0x1ec)]&&settings[_0x219694(0x1ec)]!='')initTelegram();const parseColor=(_0x4eae42,_0x550dd7)=>{const _0x38f395=_0x219694,_0x55a098=/#[A-Z]{3}#/g;if(typeof _0x4eae42==_0x38f395(0x2f1)){!_0x550dd7?_0x4eae42=_0x4eae42['replace'](_0x55a098,''):(_0x4eae42=_0x4eae42[_0x38f395(0x29a)](/#BLU#/g,_0x38f395(0x33d)),_0x4eae42=_0x4eae42['replace'](/#RED#/g,_0x38f395(0x341)),_0x4eae42=_0x4eae42[_0x38f395(0x29a)](/#YEL#/g,'\x1b[33m'),_0x4eae42=_0x4eae42[_0x38f395(0x29a)](/#MAG#/g,_0x38f395(0x2b1)),_0x4eae42=_0x4eae42['replace'](/#CYA#/g,_0x38f395(0x326)),_0x4eae42=_0x4eae42['replace'](/#RES#/g,'\x1b[0m'));;}return _0x4eae42;},logger={'screen':_0x1f9e6b=>{const _0x96bcd2=_0x219694;console[_0x96bcd2(0x19f)](parseColor(_0x1f9e6b,!![]));},'simple':_0x4851eb=>{const _0x2378b8=_0x219694;console[_0x2378b8(0x19f)](parseColor(_0x4851eb,!![])),loggerfile[_0x2378b8(0x346)](util[_0x2378b8(0x391)](parseColor(_0x4851eb,![]))+'\x0a');},'full':async _0x3951b2=>{const _0x2e12df=_0x219694,_0x207d16=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x3951b2;console[_0x2e12df(0x19f)](parseColor(_0x207d16,!![])),loggerfile['write'](util[_0x2e12df(0x391)](parseColor(_0x207d16,![]))+'\x0a');if(tgBot&&settings[_0x2e12df(0x240)]&&settings[_0x2e12df(0x2cd)]!=_0x2e12df(0x379))await sendTelegram(settings[_0x2e12df(0x240)],_0x2e12df(0x308)+parseColor(_0x3951b2,![]));},'debug':async(_0x5af23b,_0xd8787f='')=>{const _0x2eee52=_0x219694,_0x132cac=getTimeStamp()+_0x2eee52(0x1de)+_0x5af23b;if(debugging)console[_0x2eee52(0x19f)](parseColor(_0x132cac,!![]));loggerfile[_0x2eee52(0x346)](util[_0x2eee52(0x391)](parseColor(_0x132cac,![]))+'\x0a');if(_0xd8787f){if(debugging)console[_0x2eee52(0x19f)](_0xd8787f);loggerfile[_0x2eee52(0x346)](util[_0x2eee52(0x391)](_0xd8787f)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x265a43){const _0xf706e0=_0x219694;_0x265a43[_0xf706e0(0x29e)]()['includes'](_0xf706e0(0x297))?(logger[_0xf706e0(0x399)](_0xf706e0(0x32b)+_0x265a43['port']+_0xf706e0(0x272)),process[_0xf706e0(0x1ab)]({'terminate':!![]},_0x3b293c=>{})):logger[_0xf706e0(0x399)](_0x265a43);}),process['on']('exit',()=>{const _0x146556=_0x219694;stopAllBots(),process[_0x146556(0x209)](0x0);}),process['on'](_0x219694(0x310),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x219694(0x214),()=>{const _0x531575=_0x219694;stopAllBots(),process[_0x531575(0x209)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x219694(0x299))[_0x219694(0x1bb)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x219694(0x243)),app=express(),http=require(_0x219694(0x1be))[_0x219694(0x1a5)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x219694(0x1a1)](_0x219694(0x1d9),async(_0x40f003,_0x48ce01)=>{const _0x383e36=_0x219694,_0x23758e=_0x40f003[_0x383e36(0x2f4)][_0x383e36(0x34f)],_0x20e61c=getClientsWithBotID('botmanager'),_0x6ba971=_0x40f003[_0x383e36(0x211)]['uuid'],_0x21ab3f=timelyDecrypt(_0x6ba971,![]),_0x50d890=_0x20e61c[_0x383e36(0x281)](_0x1895a0=>_0x1895a0[_0x383e36(0x2cb)]==_0x21ab3f);if(_0x50d890){const _0x4371c4=normalizeIP(_0x40f003[_0x383e36(0x27e)][_0x383e36(0x2da)])[_0x383e36(0x244)],_0x223c2b=_0x40f003[_0x383e36(0x211)][_0x383e36(0x2ef)];if(validateAccess(_0x223c2b,_0x21ab3f,_0x4371c4)[_0x383e36(0x396)])_0x23758e==_0x383e36(0x365)&&await backupConfigFiles(),await zipFiles(_0x23758e),_0x48ce01[_0x383e36(0x268)](zippath+(_0x23758e+_0x383e36(0x376)),_0x335fa4=>{const _0x1bed8d=_0x383e36;_0x335fa4&&(logger[_0x1bed8d(0x266)](_0x1bed8d(0x301)+_0x23758e),logger[_0x1bed8d(0x399)](_0x335fa4));});else logger['full'](_0x383e36(0x2ec)+_0x23758e+_0x383e36(0x351));}else logger[_0x383e36(0x266)](_0x383e36(0x2ec)+_0x23758e+'\x20(2)');}),app[_0x219694(0x2f2)](_0x219694(0x288),async(_0x2d769f,_0x3e449c)=>{const _0x23cc8f=_0x219694,_0x2a203e=getClientsWithBotID(_0x23cc8f(0x37e)),_0x417773=_0x2d769f['headers'][_0x23cc8f(0x2cb)],_0x44b7f3=timelyDecrypt(_0x417773,![]),_0x33b048=_0x2a203e[_0x23cc8f(0x281)](_0x16cf1b=>_0x16cf1b[_0x23cc8f(0x2cb)]==_0x44b7f3);logger[_0x23cc8f(0x253)]('Backup\x20file\x20uploaded');if(_0x33b048){const _0x3adb0a=normalizeIP(_0x2d769f[_0x23cc8f(0x27e)][_0x23cc8f(0x2da)])[_0x23cc8f(0x244)],_0x583df5=_0x2d769f[_0x23cc8f(0x211)][_0x23cc8f(0x2ef)];if(validateAccess(_0x583df5,_0x44b7f3,_0x3adb0a)['allow']){if(_0x2d769f[_0x23cc8f(0x1ff)]){const _0x10de65=_0x2d769f[_0x23cc8f(0x1ff)][_0x23cc8f(0x39f)];await _0x10de65['mv'](temppath+_0x10de65['name']),_0x3e449c[_0x23cc8f(0x1ab)]({'status':!![],'message':_0x23cc8f(0x2aa)});const _0x3df8a3=getBotsWithMode();_0x3df8a3[_0x23cc8f(0x2a0)]>0x0?confirmRestore(temppath,_0x10de65[_0x23cc8f(0x1ac)]):unzipFile(temppath,_0x10de65[_0x23cc8f(0x1ac)]);}}else logger['full'](_0x23cc8f(0x2c0));}else logger[_0x23cc8f(0x266)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app['use'](express[_0x219694(0x24a)](path['join'](__dirname,bbpath2,_0x219694(0x1df)))),app[_0x219694(0x1a8)](express[_0x219694(0x24a)](path[_0x219694(0x371)](__dirname,bbpath2,'build'))),app[_0x219694(0x1a1)]('/',function(_0x2fca12,_0x2dba9e){const _0x3ced7d=_0x219694;_0x2dba9e['sendFile'](path[_0x3ced7d(0x371)](__dirname,bbpath2,_0x3ced7d(0x1df),_0x3ced7d(0x228)));}),app['get']('/:bot',function(_0x1b8c12,_0x4468c6){const _0x2fad55=_0x219694;_0x4468c6[_0x2fad55(0x263)](path[_0x2fad55(0x371)](__dirname,bbpath2,_0x2fad55(0x249),_0x2fad55(0x228)));}),app[_0x219694(0x1a1)](_0x219694(0x200),(_0x464b65,_0x96bd54)=>{const _0x3d8924=_0x219694;_0x96bd54['sendFile'](path[_0x3d8924(0x371)](__dirname,bbpath2,_0x3d8924(0x249),'index.html'));}),app[_0x219694(0x1a1)]('/:bot/performance',(_0x23a68c,_0x4b081e)=>{const _0x42a2c2=_0x219694;_0x4b081e[_0x42a2c2(0x263)](path[_0x42a2c2(0x371)](__dirname,bbpath2,_0x42a2c2(0x249),_0x42a2c2(0x228)));}),app['get'](_0x219694(0x31a),(_0x1853c4,_0x28a3c8)=>{const _0x10555c=_0x219694;_0x28a3c8[_0x10555c(0x263)](path[_0x10555c(0x371)](__dirname,bbpath2,_0x10555c(0x249),_0x10555c(0x228)));}),app[_0x219694(0x1a1)]('/:bot/history',(_0x169130,_0x331f2e)=>{const _0x3a0d78=_0x219694;_0x331f2e[_0x3a0d78(0x263)](path[_0x3a0d78(0x371)](__dirname,bbpath2,'build',_0x3a0d78(0x228)));}),app[_0x219694(0x1a1)](_0x219694(0x2a5),(_0x88c7db,_0x3d8f15)=>{const _0x2f771b=_0x219694;_0x3d8f15[_0x2f771b(0x263)](path[_0x2f771b(0x371)](__dirname,bbpath2,'build',_0x2f771b(0x228)));}),app[_0x219694(0x1a1)](_0x219694(0x354),(_0x423740,_0x54c3a5)=>{const _0x1ad47c=_0x219694;_0x54c3a5[_0x1ad47c(0x263)](path[_0x1ad47c(0x371)](__dirname,bbpath2,_0x1ad47c(0x249),_0x1ad47c(0x228)));});if(HOST)http[_0x219694(0x26e)](PORT,HOST);else http[_0x219694(0x26e)](PORT);const io=require(_0x219694(0x215))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x28316d=_0x219694;let _0x3d36a2=_0x28316d(0x248);const _0x34ac6a=networkInterfaces(),_0x1b25d1={};for(const _0x1ad33a of Object['keys'](_0x34ac6a)){for(const _0x1088c5 of _0x34ac6a[_0x1ad33a]){if((_0x1088c5[_0x28316d(0x1ad)]==_0x28316d(0x226)||_0x1088c5[_0x28316d(0x1ad)]==0x4)&&!_0x1088c5['internal']){const _0x59e165=ipaddr['parse'](_0x1088c5[_0x28316d(0x36a)])['range']();_0x59e165!=_0x28316d(0x2d7)&&(!_0x1b25d1[_0x1ad33a]&&(_0x1b25d1[_0x1ad33a]=[]),_0x1b25d1[_0x1ad33a][_0x28316d(0x222)](_0x1088c5[_0x28316d(0x36a)]),_0x3d36a2=_0x1088c5[_0x28316d(0x36a)]);}}}return{'serverip':_0x3d36a2,'netinterfaces':_0x1b25d1};}async function startServer(){const _0x270b41=_0x219694,{serverip:_0x5352d6,netinterfaces:_0x1374eb}=getServerIP();logger[_0x270b41(0x399)](''),logger[_0x270b41(0x399)](_0x270b41(0x208)),await logger[_0x270b41(0x266)](_0x270b41(0x274)+serverversion+_0x270b41(0x24c)+(environment==_0x270b41(0x361)?_0x270b41(0x1d6):'')+'\x0a'+(_0x270b41(0x1b5)+PORT+_0x270b41(0x35e))+(_0x270b41(0x388)+_0x5352d6+':'+PORT+_0x270b41(0x394))),logger['simple'](_0x270b41(0x208));if(config[_0x270b41(0x2a0)]!=0x0)for(const _0x3511c2 of config){const _0x5f15fb=_0x3511c2[_0x270b41(0x359)]==_0x270b41(0x304)?'a':'m';if(_0x3511c2[_0x270b41(0x1f9)]==_0x270b41(0x382)||_0x3511c2[_0x270b41(0x1f9)]=='new')await logger[_0x270b41(0x266)](_0x270b41(0x1f0)+_0x5f15fb+_0x270b41(0x221)+_0x3511c2[_0x270b41(0x2b3)]+_0x270b41(0x227)+_0x3511c2['botname']),startBot([_0x3511c2[_0x270b41(0x2b3)],userID],{'cwd':bbpath},function(_0x2fe180){const _0x441b66=_0x270b41;if(_0x2fe180)logger[_0x441b66(0x266)](_0x2fe180);});else(_0x3511c2[_0x270b41(0x1f9)]==_0x270b41(0x2e0)||_0x3511c2[_0x270b41(0x1f9)]=='new-disabled')&&await logger[_0x270b41(0x266)](_0x270b41(0x25f)+_0x5f15fb+_0x270b41(0x363)+_0x3511c2['botID']+_0x270b41(0x227)+_0x3511c2[_0x270b41(0x1ba)]);}else!newBot&&logger[_0x270b41(0x399)](_0x270b41(0x23e));if(newBot)addBot();logger[_0x270b41(0x399)]('-----------------------------------------------------------------------------------'),logger[_0x270b41(0x399)](''),await logger[_0x270b41(0x253)]('Node.js\x20v'+nodeversion),await logger[_0x270b41(0x253)](_0x270b41(0x311),_0x1374eb);}function startSocket(){const _0x398340=_0x219694;io['on'](_0x398340(0x1cf),_0x27aecc=>{const _0x51f016=_0x398340;let _0x1caa8f,_0x19cee6,_0x5743bf,_0x4539eb,_0x3b2631;const _0x3ecc93=_0x27aecc[_0x51f016(0x318)][_0x51f016(0x211)][_0x51f016(0x37a)];_0x19cee6=_0x3ecc93['match'](/bot[0-9]{3}/);if(_0x19cee6)_0x5743bf=_0x19cee6[0x0][_0x51f016(0x366)](/[0-9]{3}/);if(_0x5743bf)_0x1caa8f=_0x5743bf[0x0];else _0x1caa8f='botmanager';const _0x935dac=_0x27aecc[_0x51f016(0x318)][_0x51f016(0x21f)][_0x51f016(0x1d1)];if(!_0x935dac)_0x27aecc[_0x51f016(0x25c)](_0x51f016(0x1f9),{'publicKey':secure['publicKey']});else{_0x4539eb=timelyDecrypt(_0x935dac,![]);if(!_0x4539eb)_0x27aecc[_0x51f016(0x25c)](_0x51f016(0x1f9),{'publicKey':secure[_0x51f016(0x276)]});else{_0x3b2631=normalizeIP(_0x27aecc[_0x51f016(0x271)][_0x51f016(0x2da)])['store'];if(!devices[_0x4539eb])devices[_0x4539eb]={'uuid':_0x4539eb,'access':{'token':null}};devices[_0x4539eb]['ip']=_0x3b2631;const _0x4278fd=addClient(_0x27aecc['id'],_0x4539eb,_0x1caa8f);setAccess(_0x4278fd),emitMessages(),_0x27aecc['on'](_0x51f016(0x18f),_0x32c0c0=>{const _0x3396c3=_0x51f016,_0x3af314=timelyDecrypt(_0x32c0c0[_0x3396c3(0x1db)],!![],_0x3396c3(0x283));if(_0x3af314){_0x32c0c0={'username':_0x32c0c0[_0x3396c3(0x218)],'password':_0x3af314},devices[_0x4539eb][_0x3396c3(0x1af)]=validateCredentials(_0x32c0c0,_0x4539eb);if(devices[_0x4539eb][_0x3396c3(0x1af)][_0x3396c3(0x396)]==![]&&devices[_0x4539eb][_0x3396c3(0x1af)][_0x3396c3(0x2a7)]=='2FA\x20login\x20required')_0x27aecc[_0x3396c3(0x25c)]('status',{'access':devices[_0x4539eb][_0x3396c3(0x1af)]}),loginAccess2FA(_0x4539eb,_0x3b2631);else{if(devices[_0x4539eb][_0x3396c3(0x1af)]['allow']==![]&&devices[_0x4539eb][_0x3396c3(0x1af)]['reason']==_0x3396c3(0x1e6))_0x27aecc[_0x3396c3(0x25c)](_0x3396c3(0x1f9),{'access':devices[_0x4539eb][_0x3396c3(0x1af)]});else devices[_0x4539eb][_0x3396c3(0x1af)][_0x3396c3(0x396)]&&devices[_0x4539eb][_0x3396c3(0x1af)][_0x3396c3(0x2a7)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x4539eb)[_0x3396c3(0x1ed)](_0xee8509=>{setAccess(_0xee8509);}),logger[_0x3396c3(0x253)]('Logged\x20in\x20user\x20...'+_0x4539eb[_0x3396c3(0x247)](-0x8)),setTokenRefresh(_0x4539eb),setSessionTimeout(_0x3396c3(0x18f),_0x4539eb));}}else logger['full'](_0x3396c3(0x23b));}),_0x27aecc['on']('reset-password',()=>{resetPassword();}),_0x27aecc['on'](_0x51f016(0x230),_0x473aa8=>{removeClient(_0x27aecc['id']);}),_0x1caa8f==_0x51f016(0x37e)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x29c1b6){const _0x4558bc=_0x219694;if(_0x29c1b6!='botmanager'&&config[_0x4558bc(0x2a4)]!=''){if(pid[_0x29c1b6])pid[_0x29c1b6]['send']({'function':'initclient','args':null});}_0x29c1b6!=_0x4558bc(0x37e)&&broadcastToBots(_0x4558bc(0x369),JSON[_0x4558bc(0x1d3)](config));}function reloadBotManager(){const _0x2c0752=_0x219694;getClientsWithBotID(_0x2c0752(0x37e))[_0x2c0752(0x1ed)](_0x40b890=>{const _0x28fda8=_0x2c0752;getSocket(_0x40b890['id'])[_0x28fda8(0x25c)](_0x28fda8(0x1f9),{'access':{'allow':![],'reason':_0x28fda8(0x1cc),'token':null}});});}function getSocket(_0x4b2f79){const _0x44334a=_0x219694,_0x43bd0b=io[_0x44334a(0x347)][_0x44334a(0x1a1)]('/');return _0x43bd0b[_0x44334a(0x29b)][_0x44334a(0x1a1)](_0x4b2f79);}function setAccess(_0x1ccfb7){const _0x2ccbc6=_0x219694,_0x4fb13d=getSocket(_0x1ccfb7['id']),_0x33fe1e=_0x1ccfb7[_0x2ccbc6(0x2cb)],_0x2fc0ed=_0x1ccfb7[_0x2ccbc6(0x332)];devices[_0x33fe1e]['access']=validateAccess(devices[_0x33fe1e][_0x2ccbc6(0x1af)][_0x2ccbc6(0x389)],_0x33fe1e),logger['debug']('Setting\x20access:\x20'+devices[_0x33fe1e]['access'][_0x2ccbc6(0x2a7)]+_0x2ccbc6(0x2de)+_0x1ccfb7['id']['slice'](-0x8)+_0x2ccbc6(0x262)+_0x33fe1e[_0x2ccbc6(0x247)](-0x8)),_0x4fb13d[_0x2ccbc6(0x371)](_0x33fe1e);if(devices[_0x33fe1e][_0x2ccbc6(0x1af)][_0x2ccbc6(0x396)]){_0x4fb13d[_0x2ccbc6(0x371)](_0x2fc0ed);if(_0x2fc0ed=='botmanager')initializeSocketBotManager(_0x4fb13d);else initializeSocketBot(_0x4fb13d);initClient(_0x2fc0ed);}devices[_0x33fe1e][_0x2ccbc6(0x1af)][_0x2ccbc6(0x389)]&&devices[_0x33fe1e][_0x2ccbc6(0x1af)][_0x2ccbc6(0x2a7)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x2ccbc6(0x1f7),_0x33fe1e),devices[_0x33fe1e][_0x2ccbc6(0x1af)][_0x2ccbc6(0x389)]&&devices[_0x33fe1e][_0x2ccbc6(0x1af)][_0x2ccbc6(0x2a7)]==_0x2ccbc6(0x1f8)&&setSessionTimeout('login',_0x33fe1e),_0x4fb13d[_0x2ccbc6(0x25c)](_0x2ccbc6(0x1f9),{'status':_0x1ccfb7['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x33fe1e]['access'],'externalip':devices[_0x33fe1e]['ip'],'publicKey':secure[_0x2ccbc6(0x276)],'userid':settings[_0x2ccbc6(0x1d7)],'validInstallation':validInstallation}),devices[_0x33fe1e][_0x2ccbc6(0x1af)][_0x2ccbc6(0x396)]==![]&&devices[_0x33fe1e][_0x2ccbc6(0x1af)]['reason']==_0x2ccbc6(0x328)&&temporaryAccess2FA(_0x33fe1e,devices[_0x33fe1e]['ip']);}function setSessionTimeout(_0x5daeb2,_0x24ca7b){const _0x2fc605=_0x219694;let _0x14c25a;if(_0x5daeb2=='login')_0x14c25a=loginExpiry*0x3c*0x3e8;else _0x14c25a=devices[_0x24ca7b]['telegramIpApproval'][_0x2fc605(0x334)]*0x3c*0x3e8-(new Date()[_0x2fc605(0x205)]()-devices[_0x24ca7b][_0x2fc605(0x1b8)][_0x2fc605(0x31b)]);if(devices[_0x24ca7b][_0x2fc605(0x2c4)])clearTimeout(devices[_0x24ca7b]['pidExpireLogin']);devices[_0x24ca7b][_0x2fc605(0x2c4)]=setTimeout(()=>{const _0x1932eb=_0x2fc605;if(devices[_0x24ca7b][_0x1932eb(0x1b4)])clearTimeout(devices[_0x24ca7b][_0x1932eb(0x1b4)]);removeSocketListeners(_0x24ca7b),addBlacklist(_0x24ca7b),devices[_0x24ca7b][_0x1932eb(0x1b8)]=null,devices[_0x24ca7b][_0x1932eb(0x30b)]=null,devices[_0x24ca7b][_0x1932eb(0x1af)][_0x1932eb(0x389)]=null,logger[_0x1932eb(0x253)](_0x1932eb(0x25d)+_0x24ca7b[_0x1932eb(0x247)](-0x8)),devices[_0x24ca7b][_0x1932eb(0x1af)]=validateAccess(devices[_0x24ca7b]['access'][_0x1932eb(0x389)],_0x24ca7b),!(devices[_0x24ca7b][_0x1932eb(0x1af)][_0x1932eb(0x396)]&&devices[_0x24ca7b]['access']['reason']==_0x1932eb(0x2b2))&&(_0x5daeb2==_0x1932eb(0x18f)?io['to'](_0x24ca7b)['emit']('status',{'access':{'allow':![],'reason':_0x1932eb(0x287),'token':null}}):io['to'](_0x24ca7b)[_0x1932eb(0x25c)]('status',{'access':{'allow':![],'reason':_0x1932eb(0x1f5),'token':null}})),devices[_0x24ca7b]['access'][_0x1932eb(0x389)]=null;},_0x14c25a);}function setTokenRefresh(_0x52832a){const _0x1a75c7=_0x219694;if(devices[_0x52832a]['pidRefreshToken'])clearTimeout(devices[_0x52832a][_0x1a75c7(0x1b4)]);devices[_0x52832a][_0x1a75c7(0x1b4)]=setTimeout(()=>{const _0x69412b=_0x1a75c7;getClientsWithUuid(_0x52832a)[_0x69412b(0x2a0)]!=0x0?(devices[_0x52832a][_0x69412b(0x1af)]=refreshToken(_0x52832a),io['to'](_0x52832a)[_0x69412b(0x25c)](_0x69412b(0x1f9),{'status':_0x69412b(0x2b9),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x52832a][_0x69412b(0x1af)],'externalip':devices[_0x52832a]['ip'],'publicKey':secure[_0x69412b(0x276)],'validInstallation':validInstallation}),setTokenRefresh(_0x52832a)):clearTimeout(devices[_0x52832a][_0x69412b(0x1b4)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x39e1fe){const _0x4a51f9=_0x219694,_0x3d2040=getClient(_0x39e1fe['id'])[_0x4a51f9(0x2cb)];_0x39e1fe[_0x4a51f9(0x25c)](_0x4a51f9(0x369),config),_0x39e1fe[_0x4a51f9(0x25c)](_0x4a51f9(0x378),cleanSettings()),_0x39e1fe['on'](_0x4a51f9(0x252),_0x350d5f=>{const _0x3c0df1=_0x4a51f9;if(validateAccess(_0x350d5f,_0x3d2040)[_0x3c0df1(0x396)])addBot();else logger['full'](_0x3c0df1(0x345));}),_0x39e1fe['on'](_0x4a51f9(0x1a3),(_0x27c7e0,_0x404f2e)=>{const _0x2f8c56=_0x4a51f9;if(validateAccess(_0x404f2e,_0x3d2040)[_0x2f8c56(0x396)])toggleBot(_0x27c7e0[_0x2f8c56(0x2b3)],_0x27c7e0[_0x2f8c56(0x1f9)],_0x27c7e0[_0x2f8c56(0x34d)]);else logger[_0x2f8c56(0x266)](_0x2f8c56(0x2dc));}),_0x39e1fe['on'](_0x4a51f9(0x258),(_0x3dbfd6,_0x224263)=>{const _0x636a86=_0x4a51f9;if(validateAccess(_0x224263,_0x3d2040)[_0x636a86(0x396)])toggleBotMode(_0x3dbfd6);else logger[_0x636a86(0x266)](_0x636a86(0x2dc));}),_0x39e1fe['on'](_0x4a51f9(0x1e7),(_0x50d7a6,_0x366bb1)=>{const _0x26c8b0=_0x4a51f9;if(validateAccess(_0x366bb1,_0x3d2040)['allow'])deleteBot(_0x50d7a6);else logger[_0x26c8b0(0x266)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x39e1fe['on'](_0x4a51f9(0x1c8),(_0x7f2886,_0x3f8f5a)=>{const _0xafd027=_0x4a51f9;if(validateAccess(_0x3f8f5a,_0x3d2040)[_0xafd027(0x396)])storeSettings(_0x7f2886,!![]);else logger['full'](_0xafd027(0x3a1));}),_0x39e1fe['on'](_0x4a51f9(0x307),_0x57df3d=>{const _0x44c921=_0x4a51f9;if(validateAccess(_0x57df3d,_0x3d2040)['allow'])updateBB(_0x44c921(0x2f8));else logger[_0x44c921(0x266)](_0x44c921(0x2e2));}),_0x39e1fe['on'](_0x4a51f9(0x33c),_0x5bfd89=>{const _0xc2ad1=_0x4a51f9;if(validateAccess(_0x5bfd89,_0x3d2040)[_0xc2ad1(0x396)])updateBB(_0xc2ad1(0x278));else logger[_0xc2ad1(0x266)](_0xc2ad1(0x358));}),_0x39e1fe['on']('get-backup-files',_0x29fce1=>{const _0x195c02=_0x4a51f9;if(validateAccess(_0x29fce1,_0x3d2040)['allow']){const _0x626fc5=getClient(_0x39e1fe['id']);if(_0x626fc5)getBackupFiles(_0x626fc5[_0x195c02(0x2cb)]);else logger[_0x195c02(0x266)](_0x195c02(0x195));}else logger[_0x195c02(0x266)](_0x195c02(0x30f));}),_0x39e1fe['on'](_0x4a51f9(0x2c7),(_0xe3b9a9,_0x412dff)=>{const _0x47f999=_0x4a51f9;if(validateAccess(_0x412dff,_0x3d2040)['allow'])restoreBackupFile(_0xe3b9a9);else logger['full'](_0x47f999(0x2e7));}),_0x39e1fe['on'](_0x4a51f9(0x2a3),_0x1edd42=>{const _0x4644b5=_0x4a51f9;if(validateAccess(_0x1edd42,_0x3d2040)[_0x4644b5(0x396)])getMessages();else logger[_0x4644b5(0x266)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x39e1fe['on'](_0x4a51f9(0x187),(_0x336524,_0x5a66a2)=>{const _0x26bc20=_0x4a51f9;if(validateAccess(_0x5a66a2,_0x3d2040)[_0x26bc20(0x396)])confirmMessage(_0x336524);else logger[_0x26bc20(0x266)](_0x26bc20(0x29d));}),_0x39e1fe['on'](_0x4a51f9(0x20f),_0x24dd02=>{const _0x425d70=_0x4a51f9;if(validateAccess(_0x24dd02,_0x3d2040)[_0x425d70(0x396)]){if(devices[_0x3d2040][_0x425d70(0x1b4)])clearTimeout(devices[_0x3d2040]['pidRefreshToken']);if(devices[_0x3d2040]['pidExpireLogin'])clearTimeout(devices[_0x3d2040]['pidExpireLogin']);removeSocketListeners(getClient(_0x39e1fe['id'])[_0x425d70(0x2cb)]),addBlacklist(_0x3d2040),devices[_0x3d2040][_0x425d70(0x1b8)]=null,devices[_0x3d2040][_0x425d70(0x30b)]=null,devices[_0x3d2040][_0x425d70(0x1af)][_0x425d70(0x389)]=null,logger[_0x425d70(0x253)](_0x425d70(0x2b6)+_0x3d2040[_0x425d70(0x247)](-0x8)),io['to'](getClient(_0x39e1fe['id'])[_0x425d70(0x2cb)])[_0x425d70(0x25c)](_0x425d70(0x1f9),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x425d70(0x266)](_0x425d70(0x18c));});}function initializeSocketBot(_0x5e260b){const _0x1a820d=_0x219694,_0x5e31c6=getClient(_0x5e260b['id'])[_0x1a820d(0x332)],_0x25fcb0=getClient(_0x5e260b['id'])[_0x1a820d(0x2cb)];_0x5e260b['on']('get-logs',(_0x56245a,_0x4a241f)=>{const _0x4caa62=_0x1a820d;if(validateAccess(_0x4a241f,_0x25fcb0)['allow']){if(pid[_0x5e31c6])pid[_0x5e31c6][_0x4caa62(0x1ab)]({'function':_0x4caa62(0x309),'args':_0x56245a});}else logger[_0x4caa62(0x266)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x5e260b['on'](_0x1a820d(0x32c),(_0x566863,_0x86a07f)=>{const _0x31f15c=_0x1a820d;if(validateAccess(_0x86a07f,_0x25fcb0)['allow']){if(pid[_0x5e31c6])pid[_0x5e31c6][_0x31f15c(0x1ab)]({'function':_0x31f15c(0x1c6),'args':_0x566863});}else logger[_0x31f15c(0x266)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x5e260b['on'](_0x1a820d(0x29f),(_0x34a8e3,_0x1aa871)=>{const _0x23f6f5=_0x1a820d;if(validateAccess(_0x1aa871,_0x25fcb0)['allow']){if(pid[_0x5e31c6])pid[_0x5e31c6]['send']({'function':_0x23f6f5(0x2b7),'args':_0x34a8e3});}else logger[_0x23f6f5(0x266)](_0x23f6f5(0x30a));}),_0x5e260b['on'](_0x1a820d(0x34c),(_0x3a9cca,_0x1a6d0f)=>{const _0x38f371=_0x1a820d;if(validateAccess(_0x1a6d0f,_0x25fcb0)[_0x38f371(0x396)]){if(pid[_0x5e31c6])pid[_0x5e31c6][_0x38f371(0x1ab)]({'function':_0x38f371(0x300),'args':_0x3a9cca});}else logger['full'](_0x38f371(0x306));}),_0x5e260b['on'](_0x1a820d(0x321),(_0x4e186c,_0x46dbec)=>{const _0x339aa1=_0x1a820d;if(validateAccess(_0x46dbec,_0x25fcb0)['allow']){if(pid[_0x5e31c6])pid[_0x5e31c6][_0x339aa1(0x1ab)]({'function':_0x339aa1(0x350),'args':_0x4e186c});}else logger['full'](_0x339aa1(0x320));}),_0x5e260b['on'](_0x1a820d(0x2ad),(_0x927aea,_0x15e0d8)=>{const _0x5780a2=_0x1a820d;if(validateAccess(_0x15e0d8,_0x25fcb0)[_0x5780a2(0x396)]){if(pid[_0x5e31c6])pid[_0x5e31c6][_0x5780a2(0x1ab)]({'function':_0x5780a2(0x35b),'args':_0x927aea});}else logger['full'](_0x5780a2(0x32d));}),_0x5e260b['on']('reset-history',_0x72c845=>{const _0x3513b1=_0x1a820d;if(validateAccess(_0x72c845,_0x25fcb0)[_0x3513b1(0x396)]){if(pid[_0x5e31c6])pid[_0x5e31c6][_0x3513b1(0x1ab)]({'function':_0x3513b1(0x1dd),'args':null});}else logger[_0x3513b1(0x266)](_0x3513b1(0x3a2));}),_0x5e260b['on'](_0x1a820d(0x2a9),_0x485f25=>{const _0x2bca61=_0x1a820d;if(validateAccess(_0x485f25,_0x25fcb0)['allow']){if(pid[_0x5e31c6])pid[_0x5e31c6][_0x2bca61(0x1ab)]({'function':'getStartingBalances','args':null});}else logger[_0x2bca61(0x266)](_0x2bca61(0x275));}),_0x5e260b['on'](_0x1a820d(0x2db),(_0x34d5f7,_0xc49c4a)=>{const _0x4fd599=_0x1a820d;if(validateAccess(_0xc49c4a,_0x25fcb0)[_0x4fd599(0x396)]){if(pid[_0x5e31c6])pid[_0x5e31c6]['send']({'function':_0x4fd599(0x1dc),'args':_0x34d5f7});}else logger[_0x4fd599(0x266)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x5e260b['on']('cancel-loading',_0x1a267c=>{const _0x36127f=_0x1a820d;if(validateAccess(_0x1a267c,_0x25fcb0)['allow']){if(pid[_0x5e31c6])pid[_0x5e31c6][_0x36127f(0x1ab)]({'function':_0x36127f(0x30e),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x5e260b['on'](_0x1a820d(0x319),_0x21ddbf=>{const _0x4c7d8e=_0x1a820d;if(validateAccess(_0x21ddbf,_0x25fcb0)[_0x4c7d8e(0x396)]){if(pid[_0x5e31c6])pid[_0x5e31c6][_0x4c7d8e(0x1ab)]({'function':_0x4c7d8e(0x2d5),'args':null});}else logger['full'](_0x4c7d8e(0x1bc));}),_0x5e260b['on']('update-bb',_0x19b493=>{const _0x14fd8c=_0x1a820d;if(validateAccess(_0x19b493,_0x25fcb0)[_0x14fd8c(0x396)])updateBB(_0x14fd8c(0x2f8));else logger[_0x14fd8c(0x266)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x5e260b['on'](_0x1a820d(0x2a3),_0x5400a9=>{const _0x503d9b=_0x1a820d;if(validateAccess(_0x5400a9,_0x25fcb0)[_0x503d9b(0x396)])getMessages();else logger[_0x503d9b(0x266)](_0x503d9b(0x186));}),_0x5e260b['on']('confirm-message',(_0x3cc1a7,_0x1cf535)=>{const _0x2dba06=_0x1a820d;if(validateAccess(_0x1cf535,_0x25fcb0)[_0x2dba06(0x396)])confirmMessage(_0x3cc1a7);else logger['full'](_0x2dba06(0x29d));}),_0x5e260b['on']('logout',_0x4c1ce3=>{const _0x3b7ed7=_0x1a820d;if(validateAccess(_0x4c1ce3,_0x25fcb0)[_0x3b7ed7(0x396)]){if(devices[_0x25fcb0][_0x3b7ed7(0x1b4)])clearTimeout(devices[_0x25fcb0][_0x3b7ed7(0x1b4)]);if(devices[_0x25fcb0][_0x3b7ed7(0x2c4)])clearTimeout(devices[_0x25fcb0][_0x3b7ed7(0x2c4)]);removeSocketListeners(getClient(_0x5e260b['id'])[_0x3b7ed7(0x2cb)]),addBlacklist(_0x25fcb0),devices[_0x25fcb0]['telegramIpApproval']=null,devices[_0x25fcb0][_0x3b7ed7(0x30b)]=null,devices[_0x25fcb0][_0x3b7ed7(0x1af)][_0x3b7ed7(0x389)]=null,logger[_0x3b7ed7(0x253)](_0x3b7ed7(0x2b6)+_0x25fcb0[_0x3b7ed7(0x247)](-0x8)),io['to'](getClient(_0x5e260b['id'])[_0x3b7ed7(0x2cb)])[_0x3b7ed7(0x25c)]('status',{'access':{'allow':![],'reason':_0x3b7ed7(0x1cd),'token':null}});}else logger[_0x3b7ed7(0x266)](_0x3b7ed7(0x18c));});}function removeSocketListeners(_0x9eba7f){const _0x3e06ab=_0x219694;getClientsWithUuid(_0x9eba7f)[_0x3e06ab(0x1ed)](_0x4e9785=>{getSocket(_0x4e9785['id'])['removeAllListeners']();});}function cleanSettings(){const _0x26d38b=_0x219694;let _0x2db55b=settings;return settings[_0x26d38b(0x370)]&&settings[_0x26d38b(0x370)]!=''&&(_0x2db55b={..._0x2db55b,'telegramToken':_0x26d38b(0x197)}),settings[_0x26d38b(0x386)]&&settings['bbPassword']!=''&&(_0x2db55b={..._0x2db55b,'bbPassword':_0x26d38b(0x197)}),settings['marketcapApi']&&settings[_0x26d38b(0x392)]!=''&&(_0x2db55b={..._0x2db55b,'marketcapApi':'************'}),(settings[_0x26d38b(0x386)]&&settings['bbPassword']==_0x26d38b(0x2ff)||settings[_0x26d38b(0x370)]&&settings[_0x26d38b(0x370)]==_0x26d38b(0x2ff)||settings[_0x26d38b(0x392)]&&settings[_0x26d38b(0x392)]==_0x26d38b(0x2ff))&&(_0x2db55b={..._0x2db55b,'restored':{'password':settings[_0x26d38b(0x386)]==_0x26d38b(0x2ff),'telegram':settings[_0x26d38b(0x370)]==_0x26d38b(0x2ff),'marketcap':settings[_0x26d38b(0x392)]==_0x26d38b(0x2ff)}}),_0x2db55b;}async function updateBB(_0x440ef3){const _0x20f8fd=_0x219694;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x217af1=>{const _0x4c7254=_0x1332;restartBot(_0x217af1[_0x4c7254(0x2b3)]);});if(_0x440ef3=='update')process[_0x20f8fd(0x1ab)]({'update':!![],'environment':environment},_0x6546a2=>{});else _0x440ef3=='reinstall'&&process[_0x20f8fd(0x1ab)]({'reinstall':!![],'environment':environment},_0x53100f=>{});}function startBot(_0x2d52b3,_0x3ca04f,_0x11a4e5){const _0x14d4ee=_0x219694;if(debugging)_0x2d52b3[_0x14d4ee(0x222)]('-d');let _0x1521cc=![];const _0x4b0450=_0x2d52b3[0x0];_0x3ca04f={..._0x3ca04f,'stdio':['inherit',_0x14d4ee(0x35d),_0x14d4ee(0x35d),'ipc']},pid[_0x4b0450]=childProcess[_0x14d4ee(0x1e0)](botfile,_0x2d52b3,_0x3ca04f),pid[_0x4b0450]['on'](_0x14d4ee(0x3a0),_0x13ef90=>{const _0x117aba=_0x14d4ee;switch(Object[_0x117aba(0x1a7)](_0x13ef90)[0x0]){case _0x117aba(0x1ba):updateBotName(_0x4b0450,_0x13ef90[_0x117aba(0x1ba)]);break;case _0x117aba(0x1ce):updateBotManager();break;case _0x117aba(0x1f9):updateStatus(_0x4b0450,_0x13ef90[_0x117aba(0x1f9)]);break;case'live':updateLive(_0x4b0450,_0x13ef90['live']);break;case _0x117aba(0x294):updateLive(_0x4b0450,_0x13ef90[_0x117aba(0x294)]),io['to'](_0x4b0450)['emit'](_0x117aba(0x1f9),{'access':{'allow':![],'reason':_0x117aba(0x1cc),'token':null}});break;case'stop':_0x13ef90[_0x117aba(0x29c)]==_0x117aba(0x26b)&&restartBot(_0x4b0450);_0x13ef90[_0x117aba(0x29c)]==_0x117aba(0x2fe)&&toggleBot(_0x4b0450,_0x117aba(0x2e0),_0x117aba(0x344));break;case'telegram':sendTelegramBot(_0x4b0450,_0x13ef90[_0x117aba(0x285)]);break;case _0x117aba(0x18a):sendTelegramMsg(_0x13ef90[_0x117aba(0x18a)]);break;case'function':io['to'](_0x4b0450)['emit'](_0x13ef90[_0x117aba(0x2a6)],_0x13ef90[_0x117aba(0x290)]);break;}}),pid[_0x4b0450]['on'](_0x14d4ee(0x32a),function(_0x3e7feb){if(_0x1521cc)return;_0x1521cc=!![],_0x11a4e5(_0x3e7feb);}),pid[_0x4b0450]['on'](_0x14d4ee(0x209),async function(_0x4020f4){const _0x143395=_0x14d4ee;if(terminating)return;if(installingUpdate){io[_0x143395(0x23a)]();return;}if(_0x1521cc)return;_0x1521cc=!![],_0x11a4e5(null);const _0x5932e8=dbConfig[_0x143395(0x1a1)](_0x143395(0x369))[_0x143395(0x281)]({'botID':_0x4b0450})[_0x143395(0x393)]();_0x5932e8&&(_0x5932e8[_0x143395(0x1f9)]==_0x143395(0x382)||_0x5932e8[_0x143395(0x1f9)]==_0x143395(0x2dd))&&(await sleep(0x3e8),updateLive(_0x4b0450,_0x143395(0x344)),logger[_0x143395(0x266)](_0x143395(0x3a3)+_0x4b0450),startBot([_0x4b0450,userID],{'cwd':bbpath},function(_0x277212){const _0x119978=_0x143395;if(_0x277212)logger[_0x119978(0x266)](_0x277212);}));});}function stopBot(_0x52be3c){const _0x352b5c=_0x219694;getClientsWithBotID(_0x52be3c)['forEach'](_0x1147d5=>{getSocket(_0x1147d5['id'])['disconnect'](!![]),removeClient(_0x1147d5['id']);}),pid[_0x52be3c]&&(pid[_0x52be3c][_0x352b5c(0x2fe)](),pid[_0x52be3c]=null);}function stopAllBots(){const _0x2782c3=_0x219694;terminating=!![];const _0x4157e5=getEnabledBots();_0x4157e5[_0x2782c3(0x1ed)](_0x4434d4=>{const _0x174d91=_0x2782c3;stopBot(_0x4434d4[_0x174d91(0x2b3)]);});}function restartBot(_0x317e6d){if(pid[_0x317e6d])pid[_0x317e6d]['kill']();}function addBot(){const _0x40eda1=_0x219694;let _0x18876f;for(let _0x49de51=0x1;_0x49de51<0x3e9;_0x49de51++){_0x18876f=_0x49de51[_0x40eda1(0x29e)]()[_0x40eda1(0x39e)](0x3,'0');let _0x2e50a3=config[_0x40eda1(0x281)](_0x4819be=>_0x4819be[_0x40eda1(0x2b3)]==_0x18876f);if(!_0x2e50a3)break;}if(_0x18876f===_0x40eda1(0x1aa)){logger[_0x40eda1(0x266)](_0x40eda1(0x237));return;}logger[_0x40eda1(0x266)](_0x40eda1(0x1c1)+_0x18876f),dbConfig[_0x40eda1(0x1a1)]('bots')['push']({'botID':_0x18876f,'botname':_0x40eda1(0x327)+_0x18876f,'status':_0x40eda1(0x2dd),'live':''})[_0x40eda1(0x346)](),startBot([_0x18876f,userID],{'cwd':bbpath},function(_0x3794f4){if(_0x3794f4)logger['full'](_0x3794f4);}),config=getConfiguration(),io['to'](_0x40eda1(0x37e))[_0x40eda1(0x25c)](_0x40eda1(0x369),config),broadcastToBots(_0x40eda1(0x369),JSON[_0x40eda1(0x1d3)](config));}function deleteBot(_0x2d1c75){const _0x507a07=_0x219694;getClientsWithBotID(_0x2d1c75)[_0x507a07(0x1ed)](_0x829057=>{const _0x560522=_0x507a07;getSocket(_0x829057['id'])[_0x560522(0x230)](!![]),removeClient(_0x829057['id']);}),dbConfig[_0x507a07(0x1a1)](_0x507a07(0x369))[_0x507a07(0x36f)]({'botID':_0x2d1c75})['write'](),logger[_0x507a07(0x266)]('Deleted\x20Bot\x20'+_0x2d1c75),stopBot(_0x2d1c75);try{if(fs[_0x507a07(0x31d)](path[_0x507a07(0x371)](configpath,_0x507a07(0x32e)+_0x2d1c75+_0x507a07(0x355))))fs[_0x507a07(0x22e)](path['join'](configpath,_0x507a07(0x32e)+_0x2d1c75+_0x507a07(0x355)));if(fs[_0x507a07(0x31d)](path['join'](configpath,_0x507a07(0x32e)+_0x2d1c75+_0x507a07(0x256))))fs[_0x507a07(0x22e)](path['join'](configpath,_0x507a07(0x32e)+_0x2d1c75+_0x507a07(0x256)));if(fs['existsSync'](path[_0x507a07(0x371)](configpath,_0x507a07(0x32e)+_0x2d1c75+_0x507a07(0x22f))))fs[_0x507a07(0x22e)](path[_0x507a07(0x371)](configpath,_0x507a07(0x32e)+_0x2d1c75+_0x507a07(0x22f)));if(fs[_0x507a07(0x31d)](path[_0x507a07(0x371)](configpath,'bot-'+_0x2d1c75+_0x507a07(0x235))))fs['unlinkSync'](path[_0x507a07(0x371)](configpath,_0x507a07(0x32e)+_0x2d1c75+'-results.json'));}catch(_0x379ce2){if(_0x379ce2)logger[_0x507a07(0x266)](_0x507a07(0x277),_0x379ce2);}config=getConfiguration(),io['to'](_0x507a07(0x37e))[_0x507a07(0x25c)](_0x507a07(0x369),config),broadcastToBots(_0x507a07(0x369),JSON[_0x507a07(0x1d3)](config));}function toggleBot(_0x6c87ef,_0x425c3a,_0x1603a9){const _0xabbdd0=_0x219694;dbConfig['get'](_0xabbdd0(0x369))[_0xabbdd0(0x281)]({'botID':_0x6c87ef})[_0xabbdd0(0x2ee)]({'status':_0x425c3a})[_0xabbdd0(0x2ee)]({'live':_0x1603a9})['write']();if(_0x425c3a==_0xabbdd0(0x382)||_0x425c3a==_0xabbdd0(0x2dd))logger[_0xabbdd0(0x266)](_0xabbdd0(0x27d)+_0x6c87ef),startBot([_0x6c87ef,userID],{'cwd':bbpath},function(_0x442f8d){const _0x57ac5a=_0xabbdd0;if(_0x442f8d)logger[_0x57ac5a(0x266)](_0x442f8d);});else(_0x425c3a==_0xabbdd0(0x2e0)||_0x425c3a==_0xabbdd0(0x316))&&(logger[_0xabbdd0(0x266)](_0xabbdd0(0x313)+_0x6c87ef),stopBot(_0x6c87ef));config=getConfiguration(),io['to'](_0xabbdd0(0x37e))[_0xabbdd0(0x25c)](_0xabbdd0(0x369),config),broadcastToBots(_0xabbdd0(0x369),JSON[_0xabbdd0(0x1d3)](config));}function toggleStatus(_0x2ce56c){const _0x3ad991=_0x219694;let _0x54c12a=dbConfig[_0x3ad991(0x1a1)]('bots')[_0x3ad991(0x281)]({'botID':_0x2ce56c})[_0x3ad991(0x393)](),_0x178722;if(_0x54c12a['status']==='enabled')_0x178722='disabled';else{if(_0x54c12a[_0x3ad991(0x1f9)]===_0x3ad991(0x2dd))_0x178722=_0x3ad991(0x316);else{if(_0x54c12a['status']==='new-disabled')_0x178722=_0x3ad991(0x2dd);else{if(_0x54c12a['status']===_0x3ad991(0x2e0))_0x178722=_0x3ad991(0x382);}}}return _0x178722;}function updateStatus(_0x15c274,_0x112e78){const _0x3e93ef=_0x219694;dbConfig[_0x3e93ef(0x1a1)]('bots')['find']({'botID':_0x15c274})[_0x3e93ef(0x2ee)]({'status':_0x112e78})[_0x3e93ef(0x346)](),config=getConfiguration(),io['to'](_0x3e93ef(0x37e))[_0x3e93ef(0x25c)]('bots',config),broadcastToBots(_0x3e93ef(0x369),JSON[_0x3e93ef(0x1d3)](config));}function updateLive(_0x6d781e,_0x5050b8){const _0x22dc20=_0x219694;dbConfig[_0x22dc20(0x1a1)](_0x22dc20(0x369))[_0x22dc20(0x281)]({'botID':_0x6d781e})[_0x22dc20(0x2ee)]({'live':_0x5050b8})[_0x22dc20(0x346)](),config=getConfiguration(),io['to']('botmanager')[_0x22dc20(0x25c)](_0x22dc20(0x369),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotName(_0x3c7bb6,_0x3332b8){const _0x4bd230=_0x219694;dbConfig[_0x4bd230(0x1a1)](_0x4bd230(0x369))[_0x4bd230(0x281)]({'botID':_0x3c7bb6})[_0x4bd230(0x2ee)]({'botname':_0x3332b8})['write'](),config=getConfiguration(),io['to'](_0x4bd230(0x37e))['emit'](_0x4bd230(0x369),config),broadcastToBots(_0x4bd230(0x369),JSON[_0x4bd230(0x1d3)](config));}function updateBotManager(){const _0x29e23c=_0x219694;config=getConfiguration(),io['to']('botmanager')[_0x29e23c(0x25c)]('bots',config),broadcastToBots(_0x29e23c(0x369),JSON['stringify'](config));}function toggleBotMode(_0x39281a){const _0x39dae7=_0x219694;if(pid[_0x39281a])pid[_0x39281a]['send']({'function':_0x39dae7(0x381),'args':null});else{const _0x504fe6=configpath+_0x39dae7(0x32e)+_0x39281a+_0x39dae7(0x355),_0x2ff670=fs[_0x39dae7(0x325)](_0x504fe6),_0xed7174=JSON['parse'](_0x2ff670),_0x45859c=_0xed7174['bot'][0x0]['headless'];_0xed7174[_0x39dae7(0x332)][0x0][_0x39dae7(0x1e9)]=!_0x45859c;const _0x1e2cea=JSON[_0x39dae7(0x1d3)](_0xed7174,null,0x2);fs[_0x39dae7(0x38e)](_0x504fe6,_0x1e2cea),config=getConfiguration(),io['to'](_0x39dae7(0x37e))[_0x39dae7(0x25c)](_0x39dae7(0x369),config),broadcastToBots(_0x39dae7(0x369),JSON[_0x39dae7(0x1d3)](config));}}function _0x5426(){const _0x433e46=['***','storeConfiguration','Failed\x20to\x20download\x20','chat','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','auto','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Unauthorized\x20attempt\x20to\x20store\x20configuration','update-bb','Bot\x20Mgr\x20>\x20','emitHistory','Unauthorized\x20attempt\x20to\x20get\x20portfolio','telegram2FaApproval','lastmsgemitted','loginRequired','cancelLoading','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','SIGTERM','Network\x20Interfaces:','randomBytes','Disabled\x20Bot\x20','replyWithDocument','date-fns','new-disabled','any','handshake','show-config','/:bot/coins','timestamp','sort','existsSync','bbUsername','backup-full.zip','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','store-headless','Ok,\x20will\x20send\x20order\x20notifications\x20only','Telegraf\x20error:','config','readFileSync','\x1b[36m','Bot\x20','2FA\x20required','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','error','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','delete-alerts','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','bot-','order','6b67f3d61ee94b8f5c80b4affef4c4d9','exchange','bot','startsWith','expiry','set','getUTCHours','getMinutes','temporary\x20token\x20generated','includes','reinstall_no','tempaccess_30_','reinstall-bb','\x1b[34m','host','decrypt','update_yes','\x1b[31m','hasOwnProperty','readdirSync','stopped','Unauthorized\x20attempt\x20to\x20add\x20bot','write','_nsps','rmSync','Invalid\x20authentication\x20token\x20(1)','filter','logs','store-configuration','live','/names\x20-\x20show\x20bot\x20names\x0a','type','storeHeadless','\x20(1)','40GCFiwF','ipv6','/:bot/support','-config.json','copyFileSync','logs/','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','mode','endsWith','storeFiat','Invalid\x20username\x20or\x20IP\x20address','inherit','#RES#\x20if\x20running\x20locally\x0a','sha256','enable','staging','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager',')\x20\x20\x20|\x20Bot\x20','backup-full@','backup','match','temporary\x20access\x20rejected','All\x20bots\x20running\x20right\x20now','bots','address','132536NFNdWX','command','bb-config.json','Invalid\x20authentication\x20token\x20(2)','remove','telegramToken','join','isValid',',\x20must\x20be\x20a\x204\x20digit\x20number','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','running','.zip','Restore\x20backup\x20file\x20','settings','orders','referer','button','temporaryAccessAllowed','publicKeyToPem','botmanager','clientip','\x20only\x0a','toggleBotMode','enabled','toggle_','Error\x20sending\x20','Login\x20rejected','bbPassword','/disable\x20-\x20disable\x20notifications\x0a','=>\x20Go\x20to\x20#CYA#http://','token','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','then','uuid-random','track','writeFileSync','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','format','marketcapApi','value','#RES#\x20if\x20running\x20on\x20server','portfolio','allow','hashSync','$1_$2_$3','simple','apiSecret','callback','sortBy','Notifications\x20enabled','padStart','backupfile','message','Unauthorized\x20attempt\x20to\x20update\x20settings','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Restarting\x20Bot\x20','tempaccess_15_','Unauthorized\x20attempt\x20to\x20get\x20messages','confirm-message','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','/backup\x20-\x20receive\x20backup\x20files\x0a','telegrammsg','success','Unauthorized\x20attempt\x20to\x20log\x20out','blacklist','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','login','request','help','backup/','create','output-000.log','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','************','35824yAtopY','Ok,\x20will\x20send\x20alert\x20notifications\x20only','test','alias','action','util','login\x20token\x20valid','log','3000','get','<b>Telegram\x20Bot\x20Status:</b>\x0a','update-bot','Orders','createServer','lowdb','keys','use','718740yJCeXm','1000','send','name','family','once','access','1263207yMHySt','portfolio_','init','exp','pidRefreshToken','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Restore\x20process\x20confirmed','names','telegramIpApproval','Restoring\x20bot(s)\x20from\x20backup','botname','version','Unauthorized\x20attempt\x20to\x20show\x20configuration','show','http','apiPassword','Starting\x20Balance\x20Bot\x20reinstallation','Starting\x20new\x20bot\x20|\x20Bot\x20','Password\x20reset\x20rejected','/update\x20-\x20update\x20Balance\x20Bot\x0a','toggle','privateKey','deleteHistoryAlerts','(((.+)+)+)+$','store-settings','settings.','Access\x20enabled\x20for\x20','size','reload','logged\x20out','updatebotmanager','connection','config_alerts','encryptedUuid','max','stringify','defaults','Temporary\x20access\x20rejected','(staging)','userid','Allow\x20login\x20from\x20IP\x20address\x20','/download/:type','yargs/yargs','password','placeOrder','resetHistory',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','build2','fork','f2aRequired','112FikHbs','Yes','config_orders','alerts','invalid\x20credentials','delete-bot','pki','headless','isDirectory','config/','telegramUsername','forEach','exec','/start','Starting\x20(','messages','getFullYear','/logs\x20-\x20receive\x20log\x20files\x0a','inlineKeyboard','temporary\x20access\x20timeout','createWriteStream','2FA','2FA\x20login\x20token\x20generated','status','bbvNew','from','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','lastmsgtelegram','graphql-request','files','/:bot/portfolio','metrics','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','argv','Your\x20installation\x20is\x20already\x20up\x20to\x20date','getTime','loadAsync','constructor','-----------------------------------------------------------------------------------','exit','/enable\x20-\x20enable\x20notifications\x0a','\x20-\x20','environment','Starting\x20Balance\x20Bot\x20update','toIPv4Address','logout','sendPortfolioTelegram','headers','output-001.log','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','SIGINT','socket.io','/off\x20-\x20stop\x20bot(s)\x0a','backup-full','username','toIPv4MappedAddress','latestversion','editMessageReplyMarkup','Invalid\x20IP\x20address','/help\x20-\x20show\x20available\x20commands\x0a','map','auth','/metrics\x20-\x20show\x20bot\x20performance\x0a',')\x20|\x20Bot\x20','push','verify','bbvReceive','https://api.ipify.org?format=json','IPv4','\x20|\x20','index.html','on_','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','parse','/restart\x20-\x20restart\x20bot(s)\x0a','secret','unlinkSync','-performance.json','disconnect','/status\x20-\x20show\x20bot(s)\x20status\x0a','HTML','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','jszip','-results.json','hex','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','telegraf','restore_no_','close','Unauthorized\x20login\x20attempt\x20(timeout)','ETH','No\x20bots\x20running\x20right\x20now','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','output-002.log','telegramChatId','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','split','express','store','onepagemode','telegramEnabled','slice','[ip-address]','build','static','tempaccess_5_','#RES#\x20','file','status\x20code\x20401','showname','127.0.0.1','whitelistEnabled','add-bot','debug','start','temp/','-events.json','output-003.log','toggle-bot-mode','Login\x20accepted','code','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','emit','Session\x20expired\x20for\x20user\x20...','180TnJjVq','Idling\x20(','bb/','5\x20min','\x20|\x20user:\x20...','sendFile','Token\x20blacklisted','All\x20bots','full','yes','download','::ffff:127.0.0.1','NTBA_FIX_319','restart','0.0.0','getSeconds','listen','whitelist','async','conn','#RES#','data','Starting\x20#RED#Balance\x20Bot\x20v','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','publicKey','Error\x20while\x20deleting\x20config\x20files:\x20','reinstall','catch','bb-secure.json','search','\x20minutes','Enabled\x20Bot\x20','socket','launch','zip/','find','production','|@|','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','telegram','compareSync','access\x20timeout','/upload-backup','axios','Markdown','bot.js','env','privateKeyFromPem','login\x20token\x20generated','Notifications\x20types:\x20','args','login2fa_','port','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','started','Notifications\x20disabled','statSync','address\x20already\x20in\x20use','temporary\x20access\x20not\x20allowed','version.json','replace','sockets','stop','Unauthorized\x20attempt\x20to\x20confirm\x20message','toString','get-portfolio','length','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','all','get-messages','apiKey','/:bot/configuration','function','reason','jsonwebtoken','get-starting-balances','File\x20uploaded','getHours','Backup\x20file\x20unzipped\x20and\x20stored','store-fiat','notification','versions','add','\x1b[35m','login\x20not\x20required','botID','Alerts','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Logged\x20out\x20user\x20...','getPortfolio','Server','connected','Running\x20#RED#Balance\x20Bot\x20v','child_process','User\x20has\x20been\x20validated','login\x20required','accept','clients','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','reply','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','timeshift','pidExpireLogin','Restore\x20process\x20aborted','15\x20min','restore-backup-file','5117886PMlrhX','1967DhtCek','config_all','uuid','event','telegramEvents','DEFLATE','getMonth','secure','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','rsa','off_','manual','showConfig','--------------------------------------','private','bcryptjs','mkdirSync','remoteAddress','place-order','Unauthorized\x20attempt\x20to\x20update\x20bot','new','\x20|\x20client:\x20...','login2fa_reject_','disabled','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Error\x20details:','<b>Balance\x20Bot\x20Status:</b>\x0a','node','/on\x20-\x20start\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','sendMetricsTelegram','disable','6ZAIMmq','privateKeyToPem','Unauthorized\x20attempt\x20to\x20download\x20','\x20to\x20','assign','tkn','getDate','string','post','2FA\x20login\x20rejected','params','sign','number','randomFillSync','update','reject','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','42690tIKrIN','cloneDeep','*$1*','kill'];_0x5426=function(){return _0x433e46;};return _0x5426();}function validateTelegram(_0x545912){const _0x9fbaa0=_0x219694;if(_0x545912[_0x9fbaa0(0x1fb)][_0x9fbaa0(0x218)]!=settings[_0x9fbaa0(0x1ec)]&&'@'+_0x545912[_0x9fbaa0(0x1fb)][_0x9fbaa0(0x218)]!=settings[_0x9fbaa0(0x1ec)]||_0x545912['chat']['id']!=settings[_0x9fbaa0(0x240)])return sendTelegram(_0x545912[_0x9fbaa0(0x302)]['id'],_0x9fbaa0(0x303),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x2ddf20=_0x219694;tgBot&&(await tgBot[_0x2ddf20(0x29c)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x2ddf20(0x370)]);let _0x197b8b=_0x2ddf20(0x305);_0x197b8b+='\x0a',_0x197b8b+=_0x2ddf20(0x20a),_0x197b8b+=_0x2ddf20(0x387),_0x197b8b+=_0x2ddf20(0x213),_0x197b8b+=_0x2ddf20(0x22c),_0x197b8b+=_0x2ddf20(0x2e6),_0x197b8b+=_0x2ddf20(0x216),_0x197b8b+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x197b8b+=_0x2ddf20(0x34e),_0x197b8b+=_0x2ddf20(0x231),_0x197b8b+=_0x2ddf20(0x220),_0x197b8b+=_0x2ddf20(0x329),_0x197b8b+=_0x2ddf20(0x1f3),_0x197b8b+=_0x2ddf20(0x189),_0x197b8b+=_0x2ddf20(0x1c3),_0x197b8b+=_0x2ddf20(0x2fa),_0x197b8b+=_0x2ddf20(0x21d);let _0x1e7129='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x1e7129+='\x0a',_0x1e7129+=_0x197b8b,tgBot[_0x2ddf20(0x279)]((_0x15f437,_0x2cbf69)=>{const _0x2d7515=_0x2ddf20;logger[_0x2d7515(0x399)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x2d7515(0x253)](_0x2d7515(0x323),_0x15f437);}),tgBot['use'](async(_0x161897,_0x1bc2b6)=>{const _0x41bd8e=_0x2ddf20;if(!(!settings[_0x41bd8e(0x240)]&&_0x161897[_0x41bd8e(0x2f8)][_0x41bd8e(0x3a0)]['text']==_0x41bd8e(0x1ef))){if(!validateTelegram(_0x161897))return;}_0x1bc2b6();}),tgBot['command'](_0x2ddf20(0x254),async _0x541f50=>{const _0x33c46a=_0x2ddf20;if(_0x541f50[_0x33c46a(0x1fb)]['username']==settings['telegramUsername']||'@'+_0x541f50[_0x33c46a(0x1fb)][_0x33c46a(0x218)]==settings[_0x33c46a(0x1ec)]){if(!settings[_0x33c46a(0x240)])updateSetting(_0x33c46a(0x240),_0x541f50[_0x33c46a(0x302)]['id']);}if(!validateTelegram(_0x541f50))return;updateSetting(_0x33c46a(0x246),!![]),await sendTelegram(_0x541f50['chat']['id'],_0x1e7129);}),tgBot[_0x2ddf20(0x36c)](_0x2ddf20(0x360),async _0x34055d=>{const _0x2e714e=_0x2ddf20;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x34055d[_0x2e714e(0x302)]['id'],_0x2e714e(0x39d));}),tgBot[_0x2ddf20(0x36c)](_0x2ddf20(0x2e9),async _0x2465cd=>{const _0x3b4380=_0x2ddf20;await sendTelegram(_0x2465cd['chat']['id'],_0x3b4380(0x295)),updateSetting(_0x3b4380(0x246),![]);}),tgBot[_0x2ddf20(0x36c)](_0x2ddf20(0x324),async _0x1cbb21=>{const _0x11d79d=_0x2ddf20,_0x10d895=Markup[_0x11d79d(0x1f4)]([Markup['button'][_0x11d79d(0x39b)](_0x11d79d(0x1a4),_0x11d79d(0x1e4)),Markup['button'][_0x11d79d(0x39b)](_0x11d79d(0x2b4),_0x11d79d(0x1d0)),Markup[_0x11d79d(0x37b)][_0x11d79d(0x39b)]('All','config_all')]);_0x1cbb21['reply']('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x10d895);}),tgBot['action']('config_orders',async _0x35dceb=>{const _0x315577=_0x2ddf20;_0x35dceb[_0x315577(0x21b)](),updateSetting(_0x315577(0x2cd),'orders'),updateSetting(_0x315577(0x246),!![]),await sendTelegram(_0x35dceb[_0x315577(0x302)]['id'],_0x315577(0x322));}),tgBot[_0x2ddf20(0x19c)](_0x2ddf20(0x1d0),async _0xd4b583=>{const _0x2d31c4=_0x2ddf20;_0xd4b583[_0x2d31c4(0x21b)](),updateSetting('telegramEvents',_0x2d31c4(0x1e5)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0xd4b583[_0x2d31c4(0x302)]['id'],_0x2d31c4(0x199));}),tgBot[_0x2ddf20(0x19c)](_0x2ddf20(0x2ca),async _0x43c7c9=>{const _0x529a9e=_0x2ddf20;_0x43c7c9['editMessageReplyMarkup'](),updateSetting(_0x529a9e(0x2cd),_0x529a9e(0x2a2)),updateSetting(_0x529a9e(0x246),!![]),await sendTelegram(_0x43c7c9[_0x529a9e(0x302)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x2ddf20(0x36c)]('status',async _0x3163dc=>{const _0x147817=_0x2ddf20,_0x1d55bc=getBotsWithMode();let _0x3bec62=_0x147817(0x2e4);config[_0x147817(0x1ed)](_0x46233f=>{const _0x37267b=_0x147817,_0x51f517=_0x1d55bc['find'](_0xe8adf6=>_0xe8adf6[_0x37267b(0x2b3)]==_0x46233f[_0x37267b(0x2b3)])['mode'];_0x3bec62+=_0x37267b(0x327)+_0x46233f[_0x37267b(0x2b3)]+':\x20'+_0x46233f[_0x37267b(0x1f9)]+_0x37267b(0x227)+_0x51f517+_0x37267b(0x227)+_0x46233f[_0x37267b(0x34d)]+'\x0a';}),_0x3bec62+='\x0a',_0x3bec62+=_0x147817(0x1a2),_0x3bec62+=!settings[_0x147817(0x246)]?'Notifications\x20disabled\x0a':'Notifications\x20enabled\x0a',_0x3bec62+=settings[_0x147817(0x246)]?settings['telegramEvents']==_0x147817(0x2a2)?_0x147817(0x202):_0x147817(0x28f)+settings[_0x147817(0x2cd)]+_0x147817(0x380):'',await sendTelegram(_0x3163dc[_0x147817(0x302)]['id'],_0x3bec62,{'parse_mode':_0x147817(0x232)});}),tgBot['command'](_0x2ddf20(0x26b),async _0x5e7992=>{const _0x595192=_0x2ddf20,_0x977d2d=getEnabledBots();if(_0x977d2d[_0x595192(0x2a0)]==0x0)await sendTelegram(_0x5e7992['chat']['id'],_0x595192(0x23d));else{if(_0x977d2d[_0x595192(0x2a0)]>0x1)_0x977d2d[_0x595192(0x222)]({'botID':_0x595192(0x2a2)});let _0x1e9216=[],_0x10ef11=[];const _0x2a7d80=_0x977d2d[_0x595192(0x2a0)]%0x4==0x0||_0x977d2d[_0x595192(0x2a0)]%0x4==0x3||_0x977d2d['length']%0x3==0x1?0x4:0x3;let _0xba9fec=0x0;_0x977d2d[_0x595192(0x1ed)]((_0x52a6b0,_0x1a6f12)=>{const _0x4186f3=_0x595192;if(_0x1a6f12%_0x2a7d80==0x0)_0x10ef11=[];_0x10ef11['push'](Markup[_0x4186f3(0x37b)]['callback'](_0x52a6b0[_0x4186f3(0x2b3)]==_0x4186f3(0x2a2)?_0x4186f3(0x265):_0x4186f3(0x327)+_0x52a6b0[_0x4186f3(0x2b3)],'restart_'+_0x52a6b0[_0x4186f3(0x2b3)])),_0x1a6f12%_0x2a7d80==0x0&&(_0x1e9216[_0xba9fec]=_0x10ef11,_0xba9fec++);});const _0x2c29ef=Markup['inlineKeyboard'](_0x1e9216);_0x5e7992[_0x595192(0x2c1)](_0x595192(0x241),_0x2c29ef);}}),tgBot['action'](/restart_(.+)/,async _0x2fd26c=>{const _0x86d007=_0x2ddf20,_0x3b9d92=_0x2fd26c['match'][0x1];_0x2fd26c[_0x86d007(0x21b)](),_0x3b9d92==_0x86d007(0x2a2)?config['forEach'](_0x275c21=>{const _0x5df91e=_0x86d007;restartBot(_0x275c21[_0x5df91e(0x2b3)]);}):restartBot(_0x3b9d92);}),tgBot['command']('on',async _0x314b47=>{const _0x68b637=_0x2ddf20,_0x250b87=getDisabledBots();if(_0x250b87[_0x68b637(0x2a0)]==0x0)await sendTelegram(_0x314b47[_0x68b637(0x302)]['id'],_0x68b637(0x368));else{if(_0x250b87['length']>0x1)_0x250b87[_0x68b637(0x222)]({'botID':_0x68b637(0x2a2)});let _0x5ad524=[],_0x3a0df3=[];const _0x5df6fc=_0x250b87[_0x68b637(0x2a0)]%0x4==0x0||_0x250b87[_0x68b637(0x2a0)]%0x4==0x3||_0x250b87[_0x68b637(0x2a0)]%0x3==0x1?0x4:0x3;let _0x2d3b0b=0x0;_0x250b87['forEach']((_0x378894,_0x436ca2)=>{const _0x721617=_0x68b637;if(_0x436ca2%_0x5df6fc==0x0)_0x3a0df3=[];_0x3a0df3[_0x721617(0x222)](Markup[_0x721617(0x37b)]['callback'](_0x378894[_0x721617(0x2b3)]==_0x721617(0x2a2)?_0x721617(0x265):'Bot\x20'+_0x378894['botID'],_0x721617(0x229)+_0x378894['botID'])),_0x436ca2%_0x5df6fc==0x0&&(_0x5ad524[_0x2d3b0b]=_0x3a0df3,_0x2d3b0b++);});const _0x1cde85=Markup[_0x68b637(0x1f4)](_0x5ad524);_0x314b47[_0x68b637(0x2c1)](_0x68b637(0x22a),_0x1cde85);}}),tgBot['action'](/on_(.+)/,async _0x3e5eb8=>{const _0x24436c=_0x2ddf20,_0x1b32f1=_0x3e5eb8[_0x24436c(0x366)][0x1];_0x3e5eb8[_0x24436c(0x21b)]();if(_0x1b32f1==_0x24436c(0x2a2)){const _0x113063=getDisabledBots();await sendTelegram(_0x3e5eb8[_0x24436c(0x302)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x113063[_0x24436c(0x1ed)](_0x263560=>{const _0x3dc029=_0x24436c;if(_0x263560['botID']!='all')toggleBot(_0x263560[_0x3dc029(0x2b3)],toggleStatus(_0x263560[_0x3dc029(0x2b3)]),'stopped');});}else await sendTelegram(_0x3e5eb8[_0x24436c(0x302)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x1b32f1),toggleBot(_0x1b32f1,toggleStatus(_0x1b32f1),_0x24436c(0x344));}),tgBot[_0x2ddf20(0x36c)]('off',async _0x379eae=>{const _0x3b13f7=_0x2ddf20,_0x77d6e8=getEnabledBots();if(_0x77d6e8[_0x3b13f7(0x2a0)]==0x0)await sendTelegram(_0x379eae[_0x3b13f7(0x302)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x77d6e8[_0x3b13f7(0x2a0)]>0x1)_0x77d6e8[_0x3b13f7(0x222)]({'botID':'all'});let _0x5eb1bd=[],_0x2a19bb=[];const _0xf58625=_0x77d6e8[_0x3b13f7(0x2a0)]%0x4==0x0||_0x77d6e8['length']%0x4==0x3||_0x77d6e8[_0x3b13f7(0x2a0)]%0x3==0x1?0x4:0x3;let _0x551e90=0x0;_0x77d6e8[_0x3b13f7(0x1ed)]((_0x5a0ea0,_0x2b7945)=>{const _0x6f26b7=_0x3b13f7;if(_0x2b7945%_0xf58625==0x0)_0x2a19bb=[];_0x2a19bb[_0x6f26b7(0x222)](Markup[_0x6f26b7(0x37b)][_0x6f26b7(0x39b)](_0x5a0ea0[_0x6f26b7(0x2b3)]==_0x6f26b7(0x2a2)?_0x6f26b7(0x265):_0x6f26b7(0x327)+_0x5a0ea0['botID'],_0x6f26b7(0x2d3)+_0x5a0ea0[_0x6f26b7(0x2b3)])),_0x2b7945%_0xf58625==0x0&&(_0x5eb1bd[_0x551e90]=_0x2a19bb,_0x551e90++);});const _0x292c6c=Markup[_0x3b13f7(0x1f4)](_0x5eb1bd);_0x379eae[_0x3b13f7(0x2c1)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x292c6c);}}),tgBot[_0x2ddf20(0x19c)](/off_(.+)/,async _0x5ad1c7=>{const _0x4305c6=_0x2ddf20,_0x44d1c0=_0x5ad1c7['match'][0x1];_0x5ad1c7['editMessageReplyMarkup']();if(_0x44d1c0==_0x4305c6(0x2a2)){const _0x167064=getEnabledBots();await sendTelegram(_0x5ad1c7[_0x4305c6(0x302)]['id'],_0x4305c6(0x2d1)),_0x167064[_0x4305c6(0x1ed)](_0x135ebf=>{const _0x78a6d0=_0x4305c6;if(_0x135ebf['botID']!='all')toggleBot(_0x135ebf['botID'],toggleStatus(_0x135ebf[_0x78a6d0(0x2b3)]),_0x78a6d0(0x344));});}else await sendTelegram(_0x5ad1c7[_0x4305c6(0x302)]['id'],_0x4305c6(0x25b)+_0x44d1c0),toggleBot(_0x44d1c0,toggleStatus(_0x44d1c0),_0x4305c6(0x344));}),tgBot[_0x2ddf20(0x36c)](_0x2ddf20(0x201),async _0x39a7f4=>{const _0x48460d=_0x2ddf20,_0xae679d=getEnabledBots();if(_0xae679d[_0x48460d(0x2a0)]==0x0)await sendTelegram(_0x39a7f4[_0x48460d(0x302)]['id'],_0x48460d(0x23d));else{if(_0xae679d['length']>0x1){let _0x1c8fb5=[],_0x2168e4=[];const _0x310c5c=_0xae679d[_0x48460d(0x2a0)]%0x4==0x0||_0xae679d[_0x48460d(0x2a0)]%0x4==0x3||_0xae679d[_0x48460d(0x2a0)]%0x3==0x1?0x4:0x3;let _0x14e09d=0x0;_0xae679d[_0x48460d(0x1ed)]((_0x536776,_0x477ea6)=>{const _0x7e9a77=_0x48460d;if(_0x477ea6%_0x310c5c==0x0)_0x2168e4=[];_0x2168e4[_0x7e9a77(0x222)](Markup[_0x7e9a77(0x37b)][_0x7e9a77(0x39b)](_0x7e9a77(0x327)+_0x536776[_0x7e9a77(0x2b3)],'metrics_'+_0x536776[_0x7e9a77(0x2b3)])),_0x477ea6%_0x310c5c==0x0&&(_0x1c8fb5[_0x14e09d]=_0x2168e4,_0x14e09d++);});const _0x33bd42=Markup[_0x48460d(0x1f4)](_0x1c8fb5);_0x39a7f4['reply'](_0x48460d(0x293),_0x33bd42);}else{const _0xe6c862=_0xae679d[0x0][_0x48460d(0x2b3)];if(pid[_0xe6c862])pid[_0xe6c862][_0x48460d(0x1ab)]({'function':_0x48460d(0x2e8),'args':null});}}}),tgBot[_0x2ddf20(0x19c)](/metrics_(.+)/,async _0x1457f5=>{const _0x50a604=_0x2ddf20,_0x216c2a=_0x1457f5[_0x50a604(0x366)][0x1];_0x1457f5['editMessageReplyMarkup']();if(pid[_0x216c2a])pid[_0x216c2a]['send']({'function':_0x50a604(0x2e8),'args':null});}),tgBot[_0x2ddf20(0x36c)](_0x2ddf20(0x395),async _0x53db5d=>{const _0x1c3995=_0x2ddf20,_0x56740c=getEnabledBots();if(_0x56740c[_0x1c3995(0x2a0)]==0x0)await sendTelegram(_0x53db5d[_0x1c3995(0x302)]['id'],_0x1c3995(0x23d));else{if(_0x56740c['length']>0x1){let _0x5c5e7e=[],_0x45b1ca=[];const _0x3affe4=_0x56740c[_0x1c3995(0x2a0)]%0x4==0x0||_0x56740c[_0x1c3995(0x2a0)]%0x4==0x3||_0x56740c[_0x1c3995(0x2a0)]%0x3==0x1?0x4:0x3;let _0x52d3a5=0x0;_0x56740c[_0x1c3995(0x1ed)]((_0x325c3a,_0x37096e)=>{const _0x8239a9=_0x1c3995;if(_0x37096e%_0x3affe4==0x0)_0x45b1ca=[];_0x45b1ca[_0x8239a9(0x222)](Markup['button'][_0x8239a9(0x39b)](_0x8239a9(0x327)+_0x325c3a[_0x8239a9(0x2b3)],_0x8239a9(0x1b1)+_0x325c3a[_0x8239a9(0x2b3)])),_0x37096e%_0x3affe4==0x0&&(_0x5c5e7e[_0x52d3a5]=_0x45b1ca,_0x52d3a5++);});const _0x25069f=Markup[_0x1c3995(0x1f4)](_0x5c5e7e);_0x53db5d[_0x1c3995(0x2c1)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x25069f);}else{const _0x2d7c18=_0x56740c[0x0][_0x1c3995(0x2b3)];if(pid[_0x2d7c18])pid[_0x2d7c18][_0x1c3995(0x1ab)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x2ddf20(0x19c)](/portfolio_(.+)/,async _0x36d1be=>{const _0x5813c9=_0x2ddf20,_0x58b102=_0x36d1be[_0x5813c9(0x366)][0x1];_0x36d1be[_0x5813c9(0x21b)]();if(pid[_0x58b102])pid[_0x58b102][_0x5813c9(0x1ab)]({'function':_0x5813c9(0x210),'args':null});}),tgBot[_0x2ddf20(0x36c)]('logs',async _0x3d7df7=>{const _0x3260e6=_0x2ddf20,_0x34e18f=_0x3260e6(0x34b);await zipFiles(_0x34e18f);const _0x351155=zippath+(_0x34e18f+_0x3260e6(0x376));_0x3d7df7[_0x3260e6(0x314)]({'source':_0x351155})[_0x3260e6(0x38b)](()=>{})[_0x3260e6(0x279)](_0x3865cd=>logger[_0x3260e6(0x253)](_0x3260e6(0x384)+_0x34e18f+'\x20files\x20over\x20Telegram:',_0x3865cd));}),tgBot['command']('backup',async _0xc8f3ec=>{const _0x21de40=_0x2ddf20,_0x194bea=_0x21de40(0x365);await backupConfigFiles(),await zipFiles(_0x194bea);const _0x25ca68=zippath+(_0x194bea+'.zip');_0xc8f3ec[_0x21de40(0x314)]({'source':_0x25ca68})[_0x21de40(0x38b)](()=>{})[_0x21de40(0x279)](_0x41cceb=>logger[_0x21de40(0x253)]('Error\x20sending\x20'+_0x194bea+'\x20files\x20over\x20Telegram:',_0x41cceb));}),tgBot[_0x2ddf20(0x36c)](_0x2ddf20(0x2f8),async _0x1aa57f=>{const _0x167a53=_0x2ddf20;await getMessages();if(!updateAvailable)await sendTelegram(_0x1aa57f[_0x167a53(0x302)]['id'],_0x167a53(0x204));else{if(!validInstallation)await sendTelegram(_0x1aa57f[_0x167a53(0x302)]['id'],_0x167a53(0x1fc));else{const _0xf09ef3=Markup[_0x167a53(0x1f4)]([Markup['button'][_0x167a53(0x39b)](_0x167a53(0x1e3),_0x167a53(0x340)),Markup[_0x167a53(0x37b)][_0x167a53(0x39b)]('No','update_no')]);_0x1aa57f[_0x167a53(0x2c1)](_0x167a53(0x188),_0xf09ef3);}}}),tgBot[_0x2ddf20(0x19c)](/update_(.+)/,async _0x591923=>{const _0x5a304c=_0x2ddf20,_0x54584f=_0x591923[_0x5a304c(0x366)][0x1];_0x591923[_0x5a304c(0x21b)](),_0x54584f==_0x5a304c(0x267)&&(await sendTelegram(_0x591923[_0x5a304c(0x302)]['id'],_0x5a304c(0x20d)),updateBB(_0x5a304c(0x2f8))),_0x54584f=='no'&&await sendTelegram(_0x591923[_0x5a304c(0x302)]['id'],_0x5a304c(0x196));}),tgBot[_0x2ddf20(0x36c)](_0x2ddf20(0x278),async _0x441648=>{const _0x520558=_0x2ddf20;if(!validInstallation)await sendTelegram(_0x441648['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x1afd52=Markup[_0x520558(0x1f4)]([Markup[_0x520558(0x37b)][_0x520558(0x39b)](_0x520558(0x1e3),'reinstall_yes'),Markup[_0x520558(0x37b)][_0x520558(0x39b)]('No',_0x520558(0x33a))]);_0x441648[_0x520558(0x2c1)](_0x520558(0x390),_0x1afd52);}}),tgBot[_0x2ddf20(0x19c)](/reinstall_(.+)/,async _0x4ad668=>{const _0x4ef01e=_0x2ddf20,_0x3e45e2=_0x4ad668[_0x4ef01e(0x366)][0x1];_0x4ad668['editMessageReplyMarkup'](),_0x3e45e2==_0x4ef01e(0x267)&&(await sendTelegram(_0x4ad668[_0x4ef01e(0x302)]['id'],_0x4ef01e(0x1c0)),updateBB('reinstall')),_0x3e45e2=='no'&&await sendTelegram(_0x4ad668[_0x4ef01e(0x302)]['id'],_0x4ef01e(0x233));}),tgBot[_0x2ddf20(0x36c)](_0x2ddf20(0x1c4),async _0x4dd9c6=>{const _0x302ec6=_0x2ddf20,_0xe4fffa=getBotsWithMode();if(_0xe4fffa[_0x302ec6(0x2a0)]==0x0)await sendTelegram(_0x4dd9c6['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x429b49=[],_0x5c637f=[];const _0xde52be=0x2;let _0x3e9b64=0x0;_0xe4fffa['forEach']((_0x1e3a8a,_0x423e46)=>{const _0x12ae7a=_0x302ec6;if(_0x423e46%_0xde52be==0x0)_0x5c637f=[];_0x5c637f['push'](Markup['button'][_0x12ae7a(0x39b)](_0x12ae7a(0x327)+_0x1e3a8a['botID']+'\x20('+_0x1e3a8a['mode']+')',_0x12ae7a(0x383)+_0x1e3a8a['botID'])),_0x423e46%_0xde52be==0x0&&(_0x429b49[_0x3e9b64]=_0x5c637f,_0x3e9b64++);});const _0xb89516=Markup[_0x302ec6(0x1f4)](_0x429b49);_0x4dd9c6['reply'](_0x302ec6(0x284),_0xb89516);}}),tgBot[_0x2ddf20(0x19c)](/toggle_(.+)/,async _0xc70538=>{const _0x2fd9db=_0x2ddf20,_0x55b802=_0xc70538['match'][0x1];_0xc70538[_0x2fd9db(0x21b)]();const _0x299946=getBotsWithMode(),_0x2a10a8=_0x299946[_0x2fd9db(0x281)](_0x36a663=>_0x36a663[_0x2fd9db(0x2b3)]==_0x55b802),_0x3c0963=_0x2a10a8['mode']=='auto'?_0x2fd9db(0x2d4):_0x2fd9db(0x304);await sendTelegram(_0xc70538['chat']['id'],_0x2fd9db(0x374)+_0x55b802+_0x2fd9db(0x2ed)+_0x3c0963+'\x20mode'),toggleBotMode(_0x55b802);}),tgBot[_0x2ddf20(0x36c)](_0x2ddf20(0x1b7),async _0x4cb799=>{const _0x5acf25=_0x2ddf20;let _0xc3f084='';config[_0x5acf25(0x1ed)](_0x3e7d14=>{const _0x37000e=_0x5acf25;_0xc3f084+=_0x37000e(0x327)+_0x3e7d14[_0x37000e(0x2b3)]+':\x20'+_0x3e7d14[_0x37000e(0x1ba)]+'\x0a';}),await sendTelegram(_0x4cb799[_0x5acf25(0x302)]['id'],_0xc3f084,{'parse_mode':_0x5acf25(0x232)});}),tgBot[_0x2ddf20(0x36c)](_0x2ddf20(0x191),async _0x244f6e=>{await sendTelegram(_0x244f6e['chat']['id'],_0x197b8b);}),process[_0x2ddf20(0x1ae)](_0x2ddf20(0x214),()=>tgBot[_0x2ddf20(0x29c)]('SIGINT')),process[_0x2ddf20(0x1ae)](_0x2ddf20(0x310),()=>tgBot[_0x2ddf20(0x29c)](_0x2ddf20(0x310))),tgBot[_0x2ddf20(0x27f)]();}function disableTelegram(){const _0x2d2d95=_0x219694;tgBot&&tgBot[_0x2d2d95(0x29c)]();}async function sendTelegram(_0x15c049,_0x1d339c,_0x2d798f){const _0x1574d8=_0x219694;_0x2d798f={..._0x2d798f,'disable_web_page_preview':!![]};try{await tgBot['telegram']['sendMessage'](_0x15c049,_0x1d339c,_0x2d798f);}catch(_0x712fcf){logger[_0x1574d8(0x253)]('Telegram\x20error:',_0x712fcf);}}async function sendTelegramBot(_0x34eb26,_0x6272f2){const _0x5a8a28=_0x219694;if(settings[_0x5a8a28(0x246)]){if(settings[_0x5a8a28(0x2cd)]==_0x5a8a28(0x2a2)||(_0x6272f2[_0x5a8a28(0x34f)]==_0x5a8a28(0x32a)||_0x6272f2[_0x5a8a28(0x34f)]=='warning'||_0x6272f2['type']==_0x5a8a28(0x18b))&&settings['telegramEvents']==_0x5a8a28(0x1e5)||_0x6272f2[_0x5a8a28(0x34f)]==_0x5a8a28(0x32f)&&settings[_0x5a8a28(0x2cd)]=='orders'){if(tgBot&&settings[_0x5a8a28(0x240)]){if(_0x6272f2[_0x5a8a28(0x24f)])await sendTelegram(settings[_0x5a8a28(0x240)],_0x6272f2[_0x5a8a28(0x1ba)]+'\x20>\x20'+_0x6272f2['event']);else await sendTelegram(settings[_0x5a8a28(0x240)],_0x5a8a28(0x327)+_0x34eb26+'\x20>\x20'+_0x6272f2[_0x5a8a28(0x2cc)]);}}}}async function sendTelegramMsg(_0x1b4b41,_0x55697e=_0x219694(0x232)){const _0x4b54d5=_0x219694;return settings[_0x4b54d5(0x246)]&&tgBot&&settings[_0x4b54d5(0x240)]?(await sendTelegram(settings[_0x4b54d5(0x240)],_0x1b4b41,{'parse_mode':_0x55697e}),!![]):![];}function getDeviceWithIp(_0x1a2997){const _0x1ec703=_0x219694;return devices[_0x1ec703(0x281)](_0x51e313=>_0x51e313['ip']===_0x1a2997);}async function temporaryAccess2FA(_0x142480,_0x30981a){const _0x1b5213=_0x219694;let _0x586e7c=new Date(),_0x31e576=![];if(lastIpApproval){if(_0x586e7c-lastIpApproval<0x1388)_0x31e576=!![];}lastIpApproval=new Date();if(_0x31e576)return;if(tgBot&&settings[_0x1b5213(0x240)]){const _0x37fba4=uuidRandom();tmpStorage[_0x37fba4]={'uuid':_0x142480,'externalip':_0x30981a};const _0x26eec5=Markup[_0x1b5213(0x1f4)]([Markup['button'][_0x1b5213(0x39b)](_0x1b5213(0x261),_0x1b5213(0x24b)+_0x37fba4),Markup[_0x1b5213(0x37b)][_0x1b5213(0x39b)](_0x1b5213(0x2c6),_0x1b5213(0x185)+_0x37fba4),Markup[_0x1b5213(0x37b)][_0x1b5213(0x39b)]('30\x20min',_0x1b5213(0x33b)+_0x37fba4),Markup[_0x1b5213(0x37b)]['callback'](_0x1b5213(0x2f9),'tempaccess_reject_'+_0x37fba4)]);await sendTelegram(settings[_0x1b5213(0x240)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x30981a)[_0x1b5213(0x1bd)]+'\x20?',_0x26eec5),tgBot[_0x1b5213(0x19c)](/tempaccess_(.+)_(.+)/,async _0xe8b76f=>{const _0x5f45e9=_0x1b5213,_0x152b8d=_0xe8b76f[_0x5f45e9(0x366)][0x1],_0x32a04e=_0xe8b76f[_0x5f45e9(0x366)][0x2],{uuid:_0x439bb3,externalip:_0x182bfb}=tmpStorage[_0x32a04e];delete tmpStorage[_0x32a04e],_0xe8b76f[_0x5f45e9(0x21b)](),devices[_0x439bb3]['telegramIpApproval']={'clientip':_0x182bfb,'timestamp':new Date()['getTime'](),'expiry':_0x152b8d},_0x152b8d!=_0x5f45e9(0x2f9)?(await sendTelegram(_0xe8b76f[_0x5f45e9(0x302)]['id'],_0x5f45e9(0x1ca)+_0x152b8d+_0x5f45e9(0x27c),{'parse_mode':_0x5f45e9(0x232)}),io['to'](_0x439bb3)[_0x5f45e9(0x25c)](_0x5f45e9(0x1f9),{'access':{'allow':![],'reason':_0x5f45e9(0x1cc),'token':null}})):(await sendTelegram(_0xe8b76f[_0x5f45e9(0x302)]['id'],_0x5f45e9(0x1d5)),io['to'](_0x439bb3)['emit'](_0x5f45e9(0x1f9),{'access':{'allow':![],'reason':_0x5f45e9(0x367),'token':null}}));});}}async function loginAccess2FA(_0x553a0d,_0x4a2d24){const _0x343b9b=_0x219694;if(tgBot&&settings[_0x343b9b(0x240)]){const _0x53f1b9=uuidRandom();tmpStorage[_0x53f1b9]={'uuid':_0x553a0d,'externalip':_0x4a2d24};const _0x3f0a0e=Markup[_0x343b9b(0x1f4)]([Markup[_0x343b9b(0x37b)][_0x343b9b(0x39b)](_0x343b9b(0x2be),_0x343b9b(0x291)+loginExpiry+'_'+_0x53f1b9),Markup[_0x343b9b(0x37b)][_0x343b9b(0x39b)](_0x343b9b(0x2f9),_0x343b9b(0x2df)+_0x53f1b9)]);await sendTelegram(settings[_0x343b9b(0x240)],_0x343b9b(0x1d8)+normalizeIP(_0x4a2d24)[_0x343b9b(0x1bd)]+'\x20?',_0x3f0a0e),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x11b787=>{const _0x3b93c0=_0x343b9b,_0x537e9e=_0x11b787[_0x3b93c0(0x366)][0x1],_0x521a5f=_0x11b787[_0x3b93c0(0x366)][0x2],{uuid:_0x5b699e,externalip:_0x5f43f0}=tmpStorage[_0x521a5f];delete tmpStorage[_0x521a5f],_0x11b787['editMessageReplyMarkup'](),devices[_0x5b699e][_0x3b93c0(0x30b)]={'clientip':_0x5f43f0,'timestamp':new Date()[_0x3b93c0(0x205)](),'expiry':_0x537e9e},_0x537e9e!=_0x3b93c0(0x2f9)?(await sendTelegram(_0x11b787['chat']['id'],_0x3b93c0(0x259),{'parse_mode':'HTML'}),io['to'](_0x5b699e)[_0x3b93c0(0x25c)](_0x3b93c0(0x1f9),{'access':{'allow':![],'reason':_0x3b93c0(0x1cc),'token':null}})):(await sendTelegram(_0x11b787['chat']['id'],_0x3b93c0(0x385)),io['to'](_0x5b699e)[_0x3b93c0(0x25c)](_0x3b93c0(0x1f9),{'access':{'allow':![],'reason':_0x3b93c0(0x2f3),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xcc5c94=_0x219694;return dbConfig[_0xcc5c94(0x1a1)]('bots')['sortBy'](_0xcc5c94(0x2b3))[_0xcc5c94(0x34a)]({'status':_0xcc5c94(0x382)})[_0xcc5c94(0x393)]()||[];}function getDisabledBots(){const _0x3e2ec5=_0x219694;return dbConfig[_0x3e2ec5(0x1a1)](_0x3e2ec5(0x369))[_0x3e2ec5(0x39c)](_0x3e2ec5(0x2b3))[_0x3e2ec5(0x34a)]({'status':_0x3e2ec5(0x2e0)})[_0x3e2ec5(0x393)]()||[];}function getBotAttributes(_0x4c11e0){const _0x2d04b1=_0x219694;let _0x5088f1={};const _0x399769=configpath+_0x2d04b1(0x32e)+_0x4c11e0+_0x2d04b1(0x355),_0x17a07e=fs['existsSync'](_0x399769);if(_0x17a07e){const _0x45d507=fs[_0x2d04b1(0x325)](_0x399769);try{const _0x554941=JSON['parse'](_0x45d507),_0x26cc54=_0x554941?_0x554941[_0x2d04b1(0x332)][0x0][_0x2d04b1(0x1e9)]:![];_0x5088f1['mode']=_0x26cc54?_0x2d04b1(0x304):'manual',_0x5088f1[_0x2d04b1(0x1ba)]=_0x554941?_0x554941[_0x2d04b1(0x332)][0x0][_0x2d04b1(0x1ba)]:_0x2d04b1(0x327)+_0x4c11e0;}catch(_0x896e18){_0x5088f1[_0x2d04b1(0x359)]=_0x2d04b1(0x2d4),_0x5088f1[_0x2d04b1(0x1ba)]='Bot\x20'+_0x4c11e0;}}else _0x5088f1[_0x2d04b1(0x359)]=_0x2d04b1(0x2d4),_0x5088f1[_0x2d04b1(0x1ba)]='Bot\x20'+_0x4c11e0;return _0x5088f1;}function getBotsWithMode(){const _0x37cd34=_0x219694,_0x7807eb=dbConfig[_0x37cd34(0x1a1)](_0x37cd34(0x369))[_0x37cd34(0x39c)]('botID')[_0x37cd34(0x393)]()||[];return _0x7807eb[_0x37cd34(0x1ed)](_0x3435d6=>{let _0x172880=getBotAttributes(_0x3435d6['botID']);_0x3435d6['mode']=_0x172880['mode'];}),_0x7807eb;}function getBotExchanges(){const _0x3a2356=_0x219694;let _0x1e8688=[];const _0x55c6e2=dbConfig[_0x3a2356(0x1a1)](_0x3a2356(0x369))[_0x3a2356(0x39c)](_0x3a2356(0x2b3))['value']()||[];_0x55c6e2[_0x3a2356(0x1ed)](_0x510a0a=>{const _0x30e8fe=_0x3a2356;if(_0x510a0a[_0x30e8fe(0x1f9)]==_0x30e8fe(0x382)){const _0x353166=configpath+'bot-'+_0x510a0a[_0x30e8fe(0x2b3)]+_0x30e8fe(0x355),_0x591bda=fs[_0x30e8fe(0x31d)](_0x353166);let _0x328af4;if(_0x591bda){const _0x39937f=fs['readFileSync'](_0x353166);try{const _0x5056a3=JSON[_0x30e8fe(0x22b)](_0x39937f);_0x328af4=_0x5056a3?_0x5056a3['bot'][0x0][_0x30e8fe(0x331)]:null;}catch(_0x2446e9){}}if(_0x328af4)_0x1e8688[_0x30e8fe(0x222)](_0x328af4);}});const _0x5d9541=[...new Set(_0x1e8688)]['sort']();return _0x5d9541;}async function initUser(){const _0x57b4b2=_0x219694;if(!settings[_0x57b4b2(0x1d7)]){const _0x57a6e5=uuidRandom();mixpanel[_0x57b4b2(0x19b)](_0x57a6e5),updateSetting('userid',_0x57a6e5);}}async function initSecure(){const _0x56bf8a=_0x219694;let _0x36d87c=getSecure();if(!_0x36d87c[_0x56bf8a(0x342)]('secret')){let _0x3af4ea=await generateKeys();_0x36d87c[_0x56bf8a(0x276)]=_0x3af4ea['publicKey'],_0x36d87c[_0x56bf8a(0x1c5)]=_0x3af4ea['privateKey'],_0x36d87c[_0x56bf8a(0x22d)]=crypto[_0x56bf8a(0x312)](0x20)[_0x56bf8a(0x29e)](_0x56bf8a(0x236));;storeSecure(_0x36d87c);}}function getSettings(){const _0x44b69e=_0x219694;return dbSettings[_0x44b69e(0x1a1)](_0x44b69e(0x378))[_0x44b69e(0x393)]()||{};}function getSecure(){const _0x41c97d=_0x219694;return dbSecure[_0x41c97d(0x1a1)]('secure')[_0x41c97d(0x393)]()||{};}function getBlacklist(){const _0x113120=_0x219694;return dbSecure[_0x113120(0x1a1)](_0x113120(0x18d))[_0x113120(0x393)]()||[];}function broadcastToBots(_0x507626,_0x37e833){config['forEach'](_0x4fdb59=>{const _0x812bc0=_0x1332;if(_0x4fdb59[_0x812bc0(0x1f9)]==_0x812bc0(0x382)&&_0x4fdb59[_0x812bc0(0x34d)]=='running'||_0x4fdb59['status']==_0x812bc0(0x2dd)&&_0x4fdb59['live']==_0x812bc0(0x375)){if(pid[_0x4fdb59[_0x812bc0(0x2b3)]])pid[_0x4fdb59[_0x812bc0(0x2b3)]][_0x812bc0(0x1ab)]({[_0x507626]:_0x37e833});}});}async function storeSettings(_0x1116a8,_0x267e61=![]){const _0x553f28=_0x219694;_0x1116a8={...settings,..._0x1116a8};if(_0x267e61&&_0x1116a8[_0x553f28(0x386)]!=_0x553f28(0x197)&&_0x1116a8['bbPassword']!=_0x553f28(0x2ff)&&_0x1116a8[_0x553f28(0x386)]!=''){const _0x2a8bc8=decryptRSA(secure[_0x553f28(0x1c5)],_0x1116a8[_0x553f28(0x386)])[_0x553f28(0x242)](_0x553f28(0x283))[0x0],_0x57d2cd=bcrypt[_0x553f28(0x397)](_0x2a8bc8,saltRounds);_0x1116a8={..._0x1116a8,'bbPassword':_0x57d2cd};}if(_0x267e61&&_0x1116a8[_0x553f28(0x370)]!=_0x553f28(0x197)&&_0x1116a8['telegramToken']!=_0x553f28(0x2ff)&&_0x1116a8[_0x553f28(0x370)]!=''){const _0x10646e=decryptRSA(secure['privateKey'],_0x1116a8[_0x553f28(0x370)])[_0x553f28(0x242)](_0x553f28(0x283))[0x0];_0x1116a8={..._0x1116a8,'telegramToken':_0x10646e};}if(_0x267e61&&_0x1116a8['marketcapApi']!=_0x553f28(0x197)&&_0x1116a8['marketcapApi']!=_0x553f28(0x2ff)&&_0x1116a8['marketcapApi']!=''){const _0x2edc00=decryptRSA(secure[_0x553f28(0x1c5)],_0x1116a8[_0x553f28(0x392)])[_0x553f28(0x242)](_0x553f28(0x283))[0x0];_0x1116a8={..._0x1116a8,'marketcapApi':_0x2edc00};}const _0x1306a0=_0x1116a8[_0x553f28(0x370)]!=_0x553f28(0x197)&&_0x1116a8[_0x553f28(0x370)]!=settings[_0x553f28(0x370)]||_0x1116a8['telegramUsername']!=settings['telegramUsername'],_0x33b286=_0x1116a8[_0x553f28(0x370)]==''||_0x1116a8[_0x553f28(0x1ec)]=='',_0x343058=_0x1116a8[_0x553f28(0x392)]&&_0x1116a8['marketcapApi']!=_0x553f28(0x197)&&_0x1116a8['marketcapApi']!=settings[_0x553f28(0x392)];_0x1306a0&&(_0x1116a8[_0x553f28(0x240)]=null,_0x1116a8[_0x553f28(0x2cd)]=_0x553f28(0x2a2));for(const [_0x316253,_0x393295]of Object['entries'](_0x1116a8)){if(_0x316253=='telegramToken'&&_0x393295==_0x553f28(0x197)){_0x1116a8[_0x553f28(0x370)]=settings[_0x553f28(0x370)];continue;};if(_0x316253==_0x553f28(0x386)&&_0x393295==_0x553f28(0x197)){_0x1116a8['bbPassword']=settings[_0x553f28(0x386)];continue;};if(_0x316253=='marketcapApi'&&_0x393295==_0x553f28(0x197)){_0x1116a8[_0x553f28(0x392)]=settings[_0x553f28(0x392)];continue;};dbSettings['set'](_0x553f28(0x1c9)+_0x316253,_0x393295)[_0x553f28(0x346)]();}settings=_0x1116a8,io['to'](_0x553f28(0x37e))[_0x553f28(0x25c)](_0x553f28(0x378),cleanSettings()),broadcastToBots(_0x553f28(0x2c3),settings['timeshift']),broadcastToBots(_0x553f28(0x245),settings[_0x553f28(0x245)]),broadcastToBots(_0x553f28(0x392),settings[_0x553f28(0x392)]);if(_0x1306a0&&!_0x33b286)initTelegram();if(_0x1306a0&&_0x33b286)disableTelegram();getAllClients()[_0x553f28(0x1ed)](_0x5396a9=>{const _0x3999c6=_0x553f28;getSocket(_0x5396a9['id'])[_0x3999c6(0x25c)](_0x3999c6(0x1f9),{'access':{'allow':![],'reason':_0x3999c6(0x1cc),'token':null}});}),_0x343058&&(await sleep(0xbb8),testMarketcapApi(_0x1116a8[_0x553f28(0x392)]));}async function testMarketcapApi(_0x4f0369){const _0xdba0ff=_0x219694,_0x4c8e12=['BCT',_0xdba0ff(0x23c)];try{await axios[_0xdba0ff(0x1a1)](_0xdba0ff(0x2c2),{'headers':{'X-CMC_PRO_API_KEY':_0x4f0369},'params':{'symbol':_0x4c8e12[_0xdba0ff(0x29e)]()}});}catch(_0x2dcc98){_0x2dcc98[_0xdba0ff(0x29e)]()['includes'](_0xdba0ff(0x24e))?(io['to'](_0xdba0ff(0x37e))['emit'](_0xdba0ff(0x2ae),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0xdba0ff(0x266)](_0xdba0ff(0x362))):(io['to'](_0xdba0ff(0x37e))[_0xdba0ff(0x25c)]('notification','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger['full'](_0xdba0ff(0x18e)),logger[_0xdba0ff(0x253)](_0xdba0ff(0x2e3),_0x2dcc98[_0xdba0ff(0x29e)]()+_0xdba0ff(0x20b)+_0x2dcc98[_0xdba0ff(0x25a)]));return;}logger[_0xdba0ff(0x253)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x3b8e98,_0xb82e5c){const _0x6b013f=_0x219694;dbSettings[_0x6b013f(0x335)](_0x6b013f(0x1c9)+_0x3b8e98,_0xb82e5c)[_0x6b013f(0x346)](),settings=getSettings(),io['to'](_0x6b013f(0x37e))['emit'](_0x6b013f(0x378),cleanSettings());}function storeSecure(_0x3512f5){const _0x2eb99b=_0x219694;dbSecure[_0x2eb99b(0x1a1)](_0x2eb99b(0x2d0))['push'](_0x3512f5)[_0x2eb99b(0x346)](),secure=_0x3512f5;}function addBlacklist(_0x5eac19){const _0x2965db=_0x219694;cleanBlacklist();let _0x1d229a;devices[_0x5eac19][_0x2965db(0x1b8)]?_0x1d229a=Math[_0x2965db(0x1d2)](devices[_0x5eac19][_0x2965db(0x1b8)][_0x2965db(0x334)],loginExpiry):_0x1d229a=loginExpiry,dbSecure['get']('blacklist')[_0x2965db(0x222)]({'expiry':new Date()['getTime']()+_0x1d229a*0x3c*0x3e8,'token':devices[_0x5eac19]['access'][_0x2965db(0x389)]})[_0x2965db(0x346)](),blacklist=dbSecure['get'](_0x2965db(0x18d))[_0x2965db(0x393)]();}function cleanBlacklist(){const _0xd5b0ca=_0x219694;let _0x2b879f=dbSecure[_0xd5b0ca(0x1a1)](_0xd5b0ca(0x18d))[_0xd5b0ca(0x2fc)]()['value'](),_0x43d3ba=new Date()[_0xd5b0ca(0x205)]();_0x2b879f[_0xd5b0ca(0x1ed)](_0x24fee5=>{const _0x7b3f65=_0xd5b0ca;_0x24fee5[_0x7b3f65(0x334)]<_0x43d3ba&&dbSecure['get'](_0x7b3f65(0x18d))[_0x7b3f65(0x36f)]({'expiry':_0x24fee5['expiry']})[_0x7b3f65(0x346)]();});}function initStates(){const _0x1962b0=_0x219694;let _0x22ab73=getConfiguration();_0x22ab73[_0x1962b0(0x1ed)](_0x4371b4=>{const _0x3b94e3=_0x1962b0;_0x4371b4[_0x3b94e3(0x34d)]='stopped';}),storeConfiguration(_0x22ab73);}async function generateKeys(){const _0x1446b6=_0x219694,_0x131e47=forge[_0x1446b6(0x1e8)][_0x1446b6(0x2d2)]['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x147946=forge[_0x1446b6(0x1e8)][_0x1446b6(0x2eb)](_0x131e47[_0x1446b6(0x1c5)]),_0x370263=forge[_0x1446b6(0x1e8)][_0x1446b6(0x37d)](_0x131e47['publicKey']);return{'privateKey':_0x147946,'publicKey':_0x370263};}async function oneTimeMigration(){const _0xc1bade=_0x219694;let _0x3c7521=getSettings(),_0x59d1ff=![];!_0x3c7521[_0xc1bade(0x342)]('lastmsgtelegram')&&(_0x3c7521[_0xc1bade(0x1fd)]=0x0,_0x59d1ff=!![]);!_0x3c7521[_0xc1bade(0x342)]('lastmsgemitted')&&(_0x3c7521['lastmsgemitted']=0x0,_0x59d1ff=!![]);!_0x3c7521[_0xc1bade(0x342)](_0xc1bade(0x21a))&&(_0x3c7521['latestversion']=_0xc1bade(0x26c),_0x59d1ff=!![]);!_0x3c7521[_0xc1bade(0x342)](_0xc1bade(0x245))&&(_0x3c7521[_0xc1bade(0x245)]=![],_0x59d1ff=!![]);!_0x3c7521[_0xc1bade(0x342)](_0xc1bade(0x392))&&(_0x3c7521[_0xc1bade(0x392)]='',_0x59d1ff=!![]);if(_0x59d1ff)storeSettings(_0x3c7521);try{fs[_0xc1bade(0x343)](configbackuppath,{'withFileTypes':!![]})[_0xc1bade(0x1ed)](_0x4e5c2b=>{const _0x221a71=_0xc1bade;if(!_0x4e5c2b[_0x221a71(0x1ea)]()){if(!_0x4e5c2b['name'][_0x221a71(0x333)](_0x221a71(0x364)))fs[_0x221a71(0x22e)](configbackuppath+_0x4e5c2b['name']);}else fs['rmSync'](configbackuppath+_0x4e5c2b['name'],{'recursive':!![]});});}catch(_0x2c13b4){logger[_0xc1bade(0x253)]('Error\x20removing\x20old\x20backup\x20files:',_0x2c13b4);}}function storeConfiguration(_0x4d6a21){const _0x59d983=_0x219694;dbConfig[_0x59d983(0x1a1)](_0x59d983(0x369))[_0x59d983(0x36f)]()[_0x59d983(0x346)](),dbConfig[_0x59d983(0x1a1)](_0x59d983(0x369))[_0x59d983(0x222)](..._0x4d6a21)[_0x59d983(0x346)](),config=_0x4d6a21;}async function resetPassword(){const _0x5c5fb3=_0x219694;if(tgBot&&settings['telegramChatId']){const _0x52fb1c=Markup[_0x5c5fb3(0x1f4)]([Markup[_0x5c5fb3(0x37b)]['callback']('yes','resetpw_yes'),Markup[_0x5c5fb3(0x37b)][_0x5c5fb3(0x39b)]('no','resetpw_no')]);await sendTelegram(settings['telegramChatId'],_0x5c5fb3(0x2b5),_0x52fb1c),tgBot['action'](/resetpw_(.+)/,async _0x67ee22=>{const _0x436492=_0x5c5fb3,_0x285025=_0x67ee22[_0x436492(0x366)][0x1];_0x67ee22['editMessageReplyMarkup']();if(_0x285025!='no'){const _0x52b731=0xf,_0x6a65fc=_0x436492(0x2a1),_0x5d562f=Array[_0x436492(0x1fb)](crypto[_0x436492(0x2f7)](new Uint32Array(_0x52b731)))[_0x436492(0x21e)](_0x1fb180=>_0x6a65fc[_0x1fb180%_0x6a65fc[_0x436492(0x2a0)]])[_0x436492(0x371)](''),_0x2b428d=bcrypt[_0x436492(0x397)](_0x5d562f,saltRounds);storeSettings({'bbPassword':_0x2b428d}),await sendTelegram(_0x67ee22[_0x436492(0x302)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x5d562f,{'parse_mode':_0x436492(0x232)});}else await sendTelegram(_0x67ee22[_0x436492(0x302)]['id'],_0x436492(0x1c2));});}}async function confirmRestore(_0x351aeb,_0x21b1ea){const _0x338dca=_0x219694;io['to']('botmanager')[_0x338dca(0x25c)](_0x338dca(0x2ae),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x338dca(0x18b));if(tgBot&&settings[_0x338dca(0x240)]){const _0xa20ef9=uuidRandom();tmpStorage[_0xa20ef9]={'path':_0x351aeb,'filename':_0x21b1ea};const _0x27bfbb=Markup[_0x338dca(0x1f4)]([Markup['button']['callback'](_0x338dca(0x267),'restore_yes_'+_0xa20ef9),Markup['button'][_0x338dca(0x39b)]('no',_0x338dca(0x239)+_0xa20ef9)]);await sendTelegram(settings[_0x338dca(0x240)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x27bfbb),tgBot[_0x338dca(0x19c)](/restore_(.+)_(.+)/,async _0x3fc33b=>{const _0x47f89c=_0x338dca,_0xf7e2d3=_0x3fc33b[_0x47f89c(0x366)][0x1],_0xb523a9=_0x3fc33b[_0x47f89c(0x366)][0x2],{path:_0x3a0827,filename:_0x3ee4f}=tmpStorage[_0xb523a9];delete tmpStorage[_0xb523a9],_0x3fc33b[_0x47f89c(0x21b)](),_0xf7e2d3==_0x47f89c(0x267)?(logger[_0x47f89c(0x253)](_0x47f89c(0x1b6)),await sendTelegram(_0x3fc33b[_0x47f89c(0x302)]['id'],_0x47f89c(0x1b9),{'parse_mode':_0x47f89c(0x232)}),unzipFile(_0x3a0827,_0x3ee4f)):(logger[_0x47f89c(0x253)](_0x47f89c(0x2c5)),await sendTelegram(_0x3fc33b[_0x47f89c(0x302)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x15df93=_0x219694,_0x18c395=new Date();return _0x18c395['getFullYear']()+'/'+(_0x18c395[_0x15df93(0x2cf)]()+0x1)[_0x15df93(0x29e)]()['padStart'](0x2,'0')+'/'+_0x18c395[_0x15df93(0x2f0)]()[_0x15df93(0x29e)]()[_0x15df93(0x39e)](0x2,'0')+'\x20'+_0x18c395[_0x15df93(0x2ab)]()[_0x15df93(0x29e)]()[_0x15df93(0x39e)](0x2,'0')+':'+_0x18c395[_0x15df93(0x337)]()['toString']()[_0x15df93(0x39e)](0x2,'0')+':'+_0x18c395[_0x15df93(0x26d)]()[_0x15df93(0x29e)]()[_0x15df93(0x39e)](0x2,'0');}function getTimeStamp(){const _0x4498e6=_0x219694,_0x56137e=shiftedTime();return _0x56137e[_0x4498e6(0x1f2)]()+'/'+(_0x56137e[_0x4498e6(0x2cf)]()+0x1)[_0x4498e6(0x29e)]()['padStart'](0x2,'0')+'/'+_0x56137e[_0x4498e6(0x2f0)]()['toString']()[_0x4498e6(0x39e)](0x2,'0')+'\x20'+_0x56137e[_0x4498e6(0x2ab)]()[_0x4498e6(0x29e)]()[_0x4498e6(0x39e)](0x2,'0')+':'+_0x56137e[_0x4498e6(0x337)]()[_0x4498e6(0x29e)]()[_0x4498e6(0x39e)](0x2,'0')+':'+_0x56137e[_0x4498e6(0x26d)]()[_0x4498e6(0x29e)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x4ee495=_0x219694,_0x4db849=shiftedTime();return _0x4db849[_0x4ee495(0x1f2)]()+(_0x4db849[_0x4ee495(0x2cf)]()+0x1)[_0x4ee495(0x29e)]()[_0x4ee495(0x39e)](0x2,'0')+_0x4db849[_0x4ee495(0x2f0)]()[_0x4ee495(0x29e)]()[_0x4ee495(0x39e)](0x2,'0')+'-'+_0x4db849[_0x4ee495(0x2ab)]()[_0x4ee495(0x29e)]()['padStart'](0x2,'0')+_0x4db849[_0x4ee495(0x337)]()[_0x4ee495(0x29e)]()[_0x4ee495(0x39e)](0x2,'0')+_0x4db849[_0x4ee495(0x26d)]()[_0x4ee495(0x29e)]()[_0x4ee495(0x39e)](0x2,'0');}function shiftedTime(){const _0x41d311=_0x219694,_0x51c3cd=new Date();let _0xf26ed0=_0x51c3cd;if(settings['timeshift']&&settings[_0x41d311(0x2c3)]!==0x0)_0xf26ed0=fns[_0x41d311(0x2b0)](_0x51c3cd,{'hours':settings[_0x41d311(0x2c3)]});return _0xf26ed0;}async function startScheduler(){const _0x6e1c4=_0x219694,_0x13084c=new Date()[_0x6e1c4(0x336)](),_0xca5898=shiftedTime()[_0x6e1c4(0x2ab)]();_0xca5898==0x4&&backupConfigFiles(),_0xca5898==0x0&&(rotateLogFiles(),logger['debug'](_0x6e1c4(0x2d6)),logger['debug'](_0x6e1c4(0x2ba)+serverversion+_0x6e1c4(0x24c)+(environment==_0x6e1c4(0x361)?_0x6e1c4(0x1d6):'')),logger[_0x6e1c4(0x253)](_0x6e1c4(0x2d6))),_0x13084c%0x6==0x0&&triggerAnalytics(),_0x13084c%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x39f810){const _0x1e016c=_0x219694;logger[_0x1e016c(0x253)](_0x1e016c(0x377)+_0x39f810);const _0x13de09=getBotsWithMode();_0x13de09['length']>0x0?confirmRestore(configbackuppath,_0x39f810):unzipFile(configbackuppath,_0x39f810);}async function getBackupFiles(_0x1593b0=null){const _0x5ef0d2=_0x219694;let _0x540a97=[],_0x314dff=fs[_0x5ef0d2(0x343)](configbackuppath,{'withFileTypes':!![]});_0x314dff[_0x5ef0d2(0x31c)]((_0x2434f1,_0x4fd0a7)=>_0x2434f1[_0x5ef0d2(0x1ac)]<_0x4fd0a7[_0x5ef0d2(0x1ac)]?0x1:_0x4fd0a7[_0x5ef0d2(0x1ac)]<_0x2434f1['name']?-0x1:0x0),_0x314dff['forEach'](_0x34ce35=>{const _0x605d6c=_0x5ef0d2;if(!_0x34ce35[_0x605d6c(0x1ea)]()&&_0x34ce35[_0x605d6c(0x1ac)][_0x605d6c(0x333)](_0x605d6c(0x364))&&_0x34ce35[_0x605d6c(0x1ac)][_0x605d6c(0x35a)](_0x605d6c(0x376))){const _0x5c0926=formatDate(fs[_0x605d6c(0x296)](configbackuppath+_0x34ce35['name'])['mtime']);_0x540a97[_0x605d6c(0x222)]({'name':_0x34ce35['name'],'mtime':_0x5c0926});}});if(_0x1593b0)io['to'](_0x1593b0)[_0x5ef0d2(0x25c)]('backup-files',_0x540a97);else return _0x540a97;}async function backupConfigFiles(){const _0x20b85a=_0x219694;await zipFiles(_0x20b85a(0x217));const _0x50db2a=getCleanTimeStamp();fs[_0x20b85a(0x356)](zippath+_0x20b85a(0x31f),configbackuppath+(_0x20b85a(0x364)+_0x50db2a+_0x20b85a(0x376)));let _0x522a0c=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x522a0c['sort']((_0x115922,_0x405949)=>_0x115922[_0x20b85a(0x1ac)]<_0x405949[_0x20b85a(0x1ac)]?0x1:_0x405949[_0x20b85a(0x1ac)]<_0x115922['name']?-0x1:0x0),_0x522a0c['length']>maxBackups&&fs['unlinkSync'](configbackuppath+_0x522a0c[_0x522a0c['length']-0x1][_0x20b85a(0x1ac)]);}function rotateLogFiles(){const _0x935574=_0x219694,_0x26cb2b=fs['statSync'](logspath+_0x935574(0x194)),_0x4ef963=_0x26cb2b[_0x935574(0x1cb)]/0x400;if(_0x4ef963>0x64){let _0x553767=fs[_0x935574(0x343)](logspath,{'withFileTypes':!![]});_0x553767[_0x935574(0x31c)]((_0x3948db,_0xbf4f12)=>_0x3948db['name']<_0xbf4f12[_0x935574(0x1ac)]?0x1:_0xbf4f12[_0x935574(0x1ac)]<_0x3948db[_0x935574(0x1ac)]?-0x1:0x0),_0x553767[_0x935574(0x1ed)](_0x531f17=>{const _0x68782a=_0x935574;if(_0x531f17[_0x68782a(0x1ac)]=='output-002.log')fs[_0x68782a(0x356)](logspath+_0x531f17[_0x68782a(0x1ac)],logspath+_0x68782a(0x257));if(_0x531f17['name']==_0x68782a(0x212))fs[_0x68782a(0x356)](logspath+_0x531f17[_0x68782a(0x1ac)],logspath+_0x68782a(0x23f));_0x531f17[_0x68782a(0x1ac)]==_0x68782a(0x194)&&(fs[_0x68782a(0x356)](logspath+_0x531f17[_0x68782a(0x1ac)],logspath+_0x68782a(0x212)),fs[_0x68782a(0x38e)](logspath+_0x531f17[_0x68782a(0x1ac)],''));});}}async function zipFiles(_0x533a5c){const _0x462768=_0x219694;let _0x4b83da;if(_0x533a5c=='logs')_0x4b83da=logspath;if(_0x533a5c=='backup')_0x4b83da=configpath;if(_0x533a5c=='backup-full')_0x4b83da=configpath;let _0x120245=fs['readdirSync'](_0x4b83da,{'withFileTypes':!![]});const _0x2c32ba=new JSZip();_0x120245[_0x462768(0x1ed)](_0x50921d=>{const _0x287aa0=_0x462768;if(!_0x50921d[_0x287aa0(0x1ea)]()){let _0x372d76=fs['readFileSync'](_0x4b83da+_0x50921d['name']);if(_0x533a5c==_0x287aa0(0x365)){const _0x757711=/^bot-[0-9]{3}-config.json$/,_0x2988e4=_0x757711[_0x287aa0(0x19a)](_0x50921d['name']);if(_0x2988e4){const _0x18cdba=JSON[_0x287aa0(0x22b)](_0x372d76);if(_0x18cdba['bot'][0x0]){_0x18cdba['bot'][0x0][_0x287aa0(0x2a4)]='***',_0x18cdba[_0x287aa0(0x332)][0x0][_0x287aa0(0x39a)]=_0x287aa0(0x2ff);if(_0x18cdba[_0x287aa0(0x332)][0x0][_0x287aa0(0x1bf)])_0x18cdba[_0x287aa0(0x332)][0x0][_0x287aa0(0x1bf)]=_0x287aa0(0x2ff);}_0x372d76=JSON[_0x287aa0(0x1d3)](_0x18cdba,null,0x2);}if(_0x50921d[_0x287aa0(0x1ac)]=='bb-settings.json'){const _0x14ac53=JSON['parse'](_0x372d76);if(_0x14ac53['settings'][_0x287aa0(0x30d)])_0x14ac53[_0x287aa0(0x378)][_0x287aa0(0x30d)]=![];if(_0x14ac53[_0x287aa0(0x378)][_0x287aa0(0x386)])_0x14ac53[_0x287aa0(0x378)][_0x287aa0(0x386)]=_0x287aa0(0x2ff);if(_0x14ac53[_0x287aa0(0x378)]['telegramToken'])_0x14ac53[_0x287aa0(0x378)]['telegramToken']=_0x287aa0(0x2ff);if(_0x14ac53[_0x287aa0(0x378)][_0x287aa0(0x240)])_0x14ac53[_0x287aa0(0x378)][_0x287aa0(0x240)]=null;if(_0x14ac53[_0x287aa0(0x378)][_0x287aa0(0x392)])_0x14ac53[_0x287aa0(0x378)][_0x287aa0(0x392)]=_0x287aa0(0x2ff);_0x372d76=JSON['stringify'](_0x14ac53,null,0x2);}if(_0x50921d[_0x287aa0(0x1ac)]!=_0x287aa0(0x27a))_0x2c32ba[_0x287aa0(0x24d)](_0x50921d[_0x287aa0(0x1ac)],_0x372d76);}else _0x2c32ba[_0x287aa0(0x24d)](_0x50921d['name'],_0x372d76);}});const _0x4b30d6=await _0x2c32ba['generateAsync']({'type':_0x462768(0x2f1),'base64':![],'compression':_0x462768(0x2ce)});fs['writeFileSync'](zippath+(_0x533a5c+_0x462768(0x376)),_0x4b30d6,'binary');}function _0x1332(_0x32c807,_0x46d76e){const _0x247795=_0x5426();return _0x1332=function(_0x1bec46,_0x59bb5d){_0x1bec46=_0x1bec46-0x185;let _0x5426bc=_0x247795[_0x1bec46];return _0x5426bc;},_0x1332(_0x32c807,_0x46d76e);}async function unzipFile(_0x12f0c0,_0x1cc5b3){const _0xed4c4f=_0x219694;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0xed4c4f(0x1ed)](_0x3ad3fa=>{const _0x390464=_0xed4c4f;if(!_0x3ad3fa[_0x390464(0x1ea)]())fs[_0x390464(0x348)](configpath+_0x3ad3fa[_0x390464(0x1ac)]);});const _0x3e035e=fs[_0xed4c4f(0x325)](_0x12f0c0+_0x1cc5b3,'binary'),_0x298aa6=await JSZip[_0xed4c4f(0x206)](_0x3e035e,{'base64':![],'checkCRC32':!![]});for(const _0x1f24c9 of Object[_0xed4c4f(0x1a7)](_0x298aa6['files'])){const _0x41d771=_0x298aa6[_0xed4c4f(0x1ff)][_0x1f24c9],_0x1f2899=await _0x41d771[_0xed4c4f(0x270)]('string');fs[_0xed4c4f(0x38e)](configpath+_0x41d771[_0xed4c4f(0x1ac)],_0x1f2899);}fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0xed4c4f(0x1ed)](_0xcddd64=>{const _0x51a88e=_0xed4c4f;if(!_0xcddd64['isDirectory']())fs[_0x51a88e(0x348)](temppath+_0xcddd64[_0x51a88e(0x1ac)]);}),logger['debug'](_0xed4c4f(0x2ac)),process[_0xed4c4f(0x1ab)]({'restore':!![]},_0x3973da=>{});}async function getPublicIp(){const _0x4a9ae5=_0x219694;try{const _0xe466ad=await axios[_0x4a9ae5(0x1a1)](_0x4a9ae5(0x225));publicip=_0xe466ad[_0x4a9ae5(0x273)]['ip'];}catch(_0x359b22){}}async function triggerAnalytics(){const _0x1137b5=_0x219694;if(!publicip)await getPublicIp();const _0x594cbd=getBotsWithMode();let _0x46ed9a=0x0;_0x594cbd[_0x1137b5(0x1ed)](_0x121459=>{const _0x4e7075=_0x1137b5;if(_0x121459[_0x4e7075(0x1f9)]==='enabled')_0x46ed9a++;});const _0x1c5555=getBotExchanges();mixpanel[_0x1137b5(0x38d)](_0x1137b5(0x2b8),{'distinct_id':settings[_0x1137b5(0x1d7)],'ip':publicip,'version':serverversion,'numbots':_0x594cbd[_0x1137b5(0x2a0)],'numbotsenabled':_0x46ed9a,'exchanges':_0x1c5555,'environment':environment});}async function getMessages(){const _0x27e7b8=_0x219694,_0x5e7eb4=_0x27e7b8(0x2e1),_0x33f9e7=new GraphQLClient(_0x5e7eb4),_0x3dd498={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x34c859=serverversion[_0x27e7b8(0x242)]('.'),_0x5a9080=_0x34c859[0x0]+'.'+_0x34c859[0x1],_0x49a131=Math['min'](settings[_0x27e7b8(0x1fd)],settings[_0x27e7b8(0x30c)]),_0x5cd19a={'last':parseInt(_0x49a131),'bbm':_0x5a9080},_0x5363bf=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3c8ab4;try{_0x3c8ab4=await _0x33f9e7[_0x27e7b8(0x190)](_0x5363bf,_0x5cd19a,_0x3dd498);}catch(_0x3cef97){}if(_0x3c8ab4&&_0x3c8ab4[_0x27e7b8(0x1f1)]){let _0x32f880=settings[_0x27e7b8(0x1fd)];newMessages=[];for(const _0x55f7b6 of _0x3c8ab4['messages']){newMessages['push'](_0x55f7b6);let _0x558fb1=![];_0x55f7b6['bbvNew']&&(updateSetting(_0x27e7b8(0x21a),_0x55f7b6['bbvNew']),_0x558fb1=isNewerVersion(serverversion,_0x55f7b6[_0x27e7b8(0x1fa)])||serverversion==_0x55f7b6[_0x27e7b8(0x1fa)]);if(!_0x558fb1&&_0x55f7b6[_0x27e7b8(0x2f6)]>_0x32f880){if(_0x55f7b6[_0x27e7b8(0x224)]===_0x27e7b8(0x317)||serverversion[_0x27e7b8(0x333)](_0x55f7b6[_0x27e7b8(0x224)])){let _0x430f41=''+_0x55f7b6['title']+'\x0a\x0a'+_0x55f7b6[_0x27e7b8(0x3a0)];const _0x1463a6=await sendTelegramMsg(toTelegramMarkdown(_0x430f41),_0x27e7b8(0x28a));if(_0x1463a6)_0x32f880=_0x55f7b6[_0x27e7b8(0x2f6)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x32f880),emitMessages();}}function emitMessages(){const _0x215862=_0x219694,_0x3a460d=settings['lastmsgemitted'];let _0x22dad0=[];newMessages[_0x215862(0x1ed)](_0xf20fa8=>{const _0x1c2f1a=_0x215862;_0xf20fa8[_0x1c2f1a(0x2f6)]>_0x3a460d&&_0x22dad0[_0x1c2f1a(0x222)](_0xf20fa8);}),_0x22dad0[_0x215862(0x2a0)]>0x0&&getAllClients()[_0x215862(0x1ed)](_0xf6dec1=>{const _0xc10991=_0x215862;getSocket(_0xf6dec1['id'])['emit'](_0xc10991(0x3a0),_0x22dad0);});}function confirmMessage(_0x34cbfa){const _0x53c5cb=_0x219694;updateSetting(_0x53c5cb(0x30c),Number(_0x34cbfa));}function isNewerVersion(_0x2c01bd,_0x3a420d){const _0x1fbde7=_0x219694,_0x3c5143=_0x3a420d[_0x1fbde7(0x242)]('.'),_0x108380=_0x2c01bd[_0x1fbde7(0x242)]('.');for(var _0x1c04c5=0x0;_0x1c04c5<_0x108380[_0x1fbde7(0x2a0)];_0x1c04c5++){const _0x145a48=~~_0x108380[_0x1c04c5],_0x25f912=~~_0x3c5143[_0x1c04c5];if(_0x145a48>_0x25f912)return!![];if(_0x145a48<_0x25f912)return![];}return![];}function toTelegramMarkdown(_0x3b9be2){const _0x579029=_0x219694,_0x465077=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x229923=/\*{2}(.+?)\*{2}/gim;return _0x3b9be2=_0x3b9be2['replace'](_0x465077,_0x579029(0x398))[_0x579029(0x29a)](_0x229923,_0x579029(0x2fd)),_0x3b9be2;}async function validateConfigFile(){const _0x35bb06=_0x219694,_0x37af57=dbConfig[_0x35bb06(0x1a1)](_0x35bb06(0x369))[_0x35bb06(0x39c)](_0x35bb06(0x2b3))[_0x35bb06(0x393)]()||[];if(_0x37af57[_0x35bb06(0x2a0)]==0x0){let _0x13afab=0x0,_0x50e0d6=[];const _0x42dd15=/^bot-([0-9]{3})-config.json$/,_0x1847a0=fs[_0x35bb06(0x343)](configpath);_0x1847a0[_0x35bb06(0x1ed)](_0x2dc12d=>{const _0x8d909a=_0x35bb06,_0x4a4579=_0x42dd15[_0x8d909a(0x1ee)](_0x2dc12d);if(_0x4a4579){const _0x34bde8=_0x4a4579[0x1];let _0x545592=getBotAttributes(_0x34bde8);_0x50e0d6[_0x8d909a(0x222)]({'botID':_0x34bde8,'botname':_0x545592['botname'],'status':'disabled','live':_0x8d909a(0x344)}),_0x13afab++;}}),_0x13afab!=0x0&&(dbConfig[_0x35bb06(0x1a1)]('bots')['assign'](_0x50e0d6)[_0x35bb06(0x346)](),config=_0x50e0d6,restoredConfigFile=_0x13afab);}}async function restoreConfigNotify(_0x3664a2){const _0x3a0eff=_0x219694;let _0x2e7e17;if(restoredConfigFile==0x1)_0x2e7e17=_0x3a0eff(0x38f);else _0x2e7e17=_0x3a0eff(0x38a);if(_0x3664a2)io['to'](_0x3a0eff(0x37e))[_0x3a0eff(0x25c)](_0x3a0eff(0x2ae),_0x2e7e17);else{logger[_0x3a0eff(0x399)](_0x3a0eff(0x208)),logger['simple'](_0x2e7e17),logger['simple'](_0x3a0eff(0x208)),logger[_0x3a0eff(0x399)]('');if(tgBot&&settings[_0x3a0eff(0x240)]&&settings[_0x3a0eff(0x2cd)]!=_0x3a0eff(0x379))await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x2e7e17);}}function decryptRSA(_0x4ddd93,_0x6fe93c){const _0x4151aa=_0x219694,_0x3368d7=forge[_0x4151aa(0x1e8)][_0x4151aa(0x28d)](_0x4ddd93),_0x478fe5=_0x3368d7[_0x4151aa(0x33f)](forge['util']['decode64'](_0x6fe93c),'RSA-OAEP',{'md':forge['md'][_0x4151aa(0x35f)][_0x4151aa(0x193)](),'mgf1':{'md':forge['md']['sha256']['create']()}});return _0x478fe5;}function validateCredentials(_0x1a4617,_0x4c19cb){const _0xd7578e=_0x219694;if(_0x1a4617[_0xd7578e(0x218)]==settings[_0xd7578e(0x31e)]&&bcrypt[_0xd7578e(0x286)](_0x1a4617[_0xd7578e(0x1db)],settings[_0xd7578e(0x386)])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x3eb268=generateLoginToken(_0x4c19cb);return{'allow':!![],'reason':_0xd7578e(0x28e),'token':_0x3eb268};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x262db1){const _0x4b6a68=generateLoginToken(_0x262db1);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x4b6a68};}function validateAccess(_0x4354ab,_0x2496f3,_0x155855){const _0x106152=_0x219694,_0x34b9be=_0x155855?_0x155855:devices[_0x2496f3]['ip'];let _0x13cfde;const _0x28c55b=_0x3a46d1=>{const _0x3674ff=_0x1332;if(settings[_0x3674ff(0x30d)]){if(settings[_0x3674ff(0x1e1)]){if(telegram2FaApproved(_0x2496f3)){const _0x5f4811=generateLoginToken(_0x2496f3);return{'allow':!![],'reason':_0x3674ff(0x1f8),'token':_0x5f4811};}else return{'allow':![],'reason':_0x3674ff(0x2bd),'token':null};}else return _0x13cfde=validToken(_0x3a46d1,_0x2496f3),_0x13cfde['hasOwnProperty']('success')?{'allow':!![],'reason':_0x3674ff(0x19e),'token':_0x3a46d1}:{'allow':![],'reason':_0x3674ff(0x2bd),'token':null};}else return{'allow':!![],'reason':_0x3674ff(0x2b2),'token':null};};if(settings[_0x106152(0x251)]){let _0x438409=[...settings[_0x106152(0x26f)],'::1',_0x106152(0x269),_0x106152(0x250)];if(_0x438409[_0x106152(0x339)](_0x34b9be))return _0x28c55b(_0x4354ab);else{_0x13cfde=validToken(_0x4354ab,_0x2496f3);if(_0x13cfde[_0x106152(0x342)]('success'))return _0x28c55b(_0x4354ab);else{if(telegramIpApproved(_0x2496f3)){const _0x41979f=generateToken(_0x2496f3);return _0x13cfde=_0x28c55b(_0x4354ab),_0x13cfde['allow']?{'allow':!![],'reason':_0x106152(0x338),'token':_0x41979f}:_0x13cfde;}else return settings[_0x106152(0x37c)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x106152(0x298),'token':null};}}}else return _0x28c55b(_0x4354ab);}function timelyDecrypt(_0x11f484,_0x33cd15,_0x3dccbe='@'){const _0x314ba8=_0x219694;if(_0x11f484)try{const _0x1ba4f7=decryptRSA(secure[_0x314ba8(0x1c5)],_0x11f484),_0x496eb4=_0x1ba4f7[_0x314ba8(0x242)](_0x3dccbe)[0x0],_0xae7b1a=_0x1ba4f7['split'](_0x3dccbe)[0x1],_0x23110f=new Date()[_0x314ba8(0x205)]();if(_0x33cd15){if(_0x23110f-_0xae7b1a<maxSecretAge*0x3e8)return _0x496eb4;else return![];}else return _0x496eb4;}catch(_0x555ea6){return![];}else return![];}const validToken=(_0x2be64c,_0x50353b)=>{const _0x21f830=_0x219694,_0x56bbbb=devices[_0x50353b]['ip'];if(!_0x2be64c)return{'error':'No\x20authentication\x20token'};for(let _0xf44d17 of blacklist){if(_0xf44d17['token']==_0x2be64c)return{'error':_0x21f830(0x264)};}let _0x136cc9;try{_0x136cc9=jwt[_0x21f830(0x223)](_0x2be64c,secure[_0x21f830(0x22d)]+_0x50353b);}catch{return{'error':_0x21f830(0x349)};}if(!_0x136cc9['hasOwnProperty'](_0x21f830(0x37f))&&!_0x136cc9[_0x21f830(0x342)](_0x21f830(0x218))||!_0x136cc9[_0x21f830(0x342)](_0x21f830(0x1b3)))return{'error':_0x21f830(0x36e)};if(!_0x136cc9['hasOwnProperty'](_0x21f830(0x218))&&_0x136cc9[_0x21f830(0x342)](_0x21f830(0x37f))){const {clientip:_0xa41c66}=_0x136cc9;return _0x56bbbb==_0xa41c66?{'success':_0x21f830(0x2bc)}:{'error':_0x21f830(0x21c)};}else{if(_0x136cc9[_0x21f830(0x342)](_0x21f830(0x218))&&_0x136cc9[_0x21f830(0x342)](_0x21f830(0x37f))){const {username:_0x4fc10d,clientip:_0x4bc212}=_0x136cc9;return settings[_0x21f830(0x31e)]==_0x4fc10d&&_0x56bbbb==_0x4bc212?{'success':_0x21f830(0x2bc)}:{'error':_0x21f830(0x35c)};}}},generateLoginToken=_0x5dbc04=>{const _0x4eca24=_0x219694;if(_0x5dbc04){const _0xe98b4a=devices[_0x5dbc04]['ip'];return jwt[_0x4eca24(0x2f5)]({'username':settings[_0x4eca24(0x31e)],'clientip':_0xe98b4a},secure[_0x4eca24(0x22d)]+_0x5dbc04,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0xe00257=>{const _0x1c65f8=_0x219694;if(_0xe00257){const _0x4e1612=devices[_0xe00257]['ip'];return jwt[_0x1c65f8(0x2f5)]({'clientip':_0x4e1612},secure['secret']+_0xe00257,{'expiresIn':devices[_0xe00257][_0x1c65f8(0x1b8)][_0x1c65f8(0x334)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x100178=>{const _0x1d7591=_0x219694;let _0x2d3ecd=![];return devices[_0x100178][_0x1d7591(0x1b8)]&&devices[_0x100178]['telegramIpApproval'][_0x1d7591(0x334)]!=_0x1d7591(0x2f9)&&(_0x2d3ecd=devices[_0x100178][_0x1d7591(0x1b8)][_0x1d7591(0x37f)]==devices[_0x100178]['ip']&&new Date()[_0x1d7591(0x205)]()-devices[_0x100178][_0x1d7591(0x1b8)][_0x1d7591(0x31b)]<devices[_0x100178]['telegramIpApproval'][_0x1d7591(0x334)]*0x3c*0x3e8),_0x2d3ecd;},telegram2FaApproved=_0x2ad39a=>{const _0x23f830=_0x219694;let _0xd6881f=![];return devices[_0x2ad39a][_0x23f830(0x30b)]&&devices[_0x2ad39a][_0x23f830(0x30b)][_0x23f830(0x334)]!='reject'&&(_0xd6881f=devices[_0x2ad39a][_0x23f830(0x30b)][_0x23f830(0x37f)]==devices[_0x2ad39a]['ip']&&new Date()[_0x23f830(0x205)]()-devices[_0x2ad39a][_0x23f830(0x30b)][_0x23f830(0x31b)]<devices[_0x2ad39a]['telegram2FaApproval'][_0x23f830(0x334)]*0x3c*0x3e8),_0xd6881f;},normalizeIP=_0x19ebf5=>{const _0x392a8f=_0x219694;let _0x287b90=null,_0x302e22=null;if(ipaddr[_0x392a8f(0x372)](_0x19ebf5)){const _0x21adec=ipaddr[_0x392a8f(0x22b)](_0x19ebf5);_0x21adec['kind']()===_0x392a8f(0x353)?(_0x21adec['isIPv4MappedAddress']()&&(_0x287b90=_0x21adec[_0x392a8f(0x20e)]()[_0x392a8f(0x29e)]()),_0x302e22=_0x21adec[_0x392a8f(0x29e)]()):(_0x287b90=_0x21adec[_0x392a8f(0x29e)](),_0x302e22=_0x21adec[_0x392a8f(0x219)]()[_0x392a8f(0x29e)]());}return{'show':_0x287b90?_0x287b90:_0x302e22,'store':_0x302e22};};function formatDate(_0x4f1abe){const _0x1039fe=_0x219694;return _0x4f1abe[_0x1039fe(0x1f2)]()+'/'+(_0x4f1abe[_0x1039fe(0x2cf)]()+0x1)[_0x1039fe(0x29e)]()[_0x1039fe(0x39e)](0x2,'0')+'/'+_0x4f1abe['getDate']()['toString']()[_0x1039fe(0x39e)](0x2,'0')+'\x20'+_0x4f1abe[_0x1039fe(0x2ab)]()[_0x1039fe(0x29e)]()[_0x1039fe(0x39e)](0x2,'0')+':'+_0x4f1abe[_0x1039fe(0x337)]()[_0x1039fe(0x29e)]()[_0x1039fe(0x39e)](0x2,'0')+':'+_0x4f1abe[_0x1039fe(0x26d)]()[_0x1039fe(0x29e)]()[_0x1039fe(0x39e)](0x2,'0');}function sleep(_0x22e81f){return new Promise(_0x2830fa=>setTimeout(_0x2830fa,_0x22e81f));}