const _0x459bb3=_0x4b6b;(function(_0x9e3f5a,_0x200233){const _0x374191=_0x4b6b,_0x5b8685=_0x9e3f5a();while(!![]){try{const _0x1a9e06=parseInt(_0x374191(0x3cd))/0x1*(parseInt(_0x374191(0x23b))/0x2)+-parseInt(_0x374191(0x3bc))/0x3+parseInt(_0x374191(0x22a))/0x4+parseInt(_0x374191(0x28e))/0x5+parseInt(_0x374191(0x20f))/0x6+parseInt(_0x374191(0x3ed))/0x7*(-parseInt(_0x374191(0x3ac))/0x8)+-parseInt(_0x374191(0x2c3))/0x9;if(_0x1a9e06===_0x200233)break;else _0x5b8685['push'](_0x5b8685['shift']());}catch(_0x5b98a1){_0x5b8685['push'](_0x5b8685['shift']());}}}(_0xa419,0x83b49));const _0x5aa72e=function(){let _0x5c587e=!![];return function(_0x12ca26,_0xe5e4a7){const _0x25114c=_0x5c587e?function(){const _0x5f0240=_0x4b6b;if(_0xe5e4a7){const _0x5a2341=_0xe5e4a7[_0x5f0240(0x392)](_0x12ca26,arguments);return _0xe5e4a7=null,_0x5a2341;}}:function(){};return _0x5c587e=![],_0x25114c;};}(),_0x61157e=_0x5aa72e(this,function(){const _0x30f452=_0x4b6b;return _0x61157e[_0x30f452(0x2bf)]()[_0x30f452(0x2c5)](_0x30f452(0x296))['toString']()[_0x30f452(0x318)](_0x61157e)[_0x30f452(0x2c5)](_0x30f452(0x296));});_0x61157e();'use strict';process[_0x459bb3(0x368)][_0x459bb3(0x354)]=0x1;const childProcess=require(_0x459bb3(0x2bd)),fs=require('fs'),fns=require(_0x459bb3(0x348)),low=require(_0x459bb3(0x391)),FileSync=require(_0x459bb3(0x3e8)),path=require(_0x459bb3(0x21b)),crypto=require(_0x459bb3(0x236)),forge=require(_0x459bb3(0x2e8)),bcrypt=require(_0x459bb3(0x254)),jwt=require('jsonwebtoken'),ipaddr=require(_0x459bb3(0x289)),argv=require(_0x459bb3(0x362))(process[_0x459bb3(0x37a)][_0x459bb3(0x1f3)](0x2))[_0x459bb3(0x37a)],uuidRandom=require(_0x459bb3(0x2f6)),{Telegraf,Markup}=require(_0x459bb3(0x28d)),Mixpanel=require('mixpanel'),axios=require(_0x459bb3(0x2a7)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x459bb3(0x3e4)),fileUpload=require(_0x459bb3(0x35a)),{networkInterfaces}=require('os'),JSZip=require(_0x459bb3(0x38f)),PORT=argv[_0x459bb3(0x389)]||_0x459bb3(0x22c),pattern=/^[0-9]{2,4}$/;!pattern[_0x459bb3(0x1e6)](PORT)&&(console['log']('Error:\x20Invalid\x20argument\x20'+PORT+_0x459bb3(0x3a8)),process[_0x459bb3(0x2f8)](0x1));const HOST=argv[_0x459bb3(0x28b)]||null,userID=argv['user']||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x459bb3(0x291)][_0x459bb3(0x249)];let bbpath=_0x459bb3(0x31a),bbpath2='';const botfile='bot.js',configfile='bb-config.json',settingsfile='bb-settings.json',securefile=_0x459bb3(0x202),environment=require('./'+bbpath2+'version.json')[_0x459bb3(0x377)]||_0x459bb3(0x260),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x459bb3(0x200)+userID+'/':bbpath+_0x459bb3(0x200),configbackuppath=configpath+_0x459bb3(0x3ea),logspath=userID?bbpath+_0x459bb3(0x2be)+userID+'/':bbpath+_0x459bb3(0x2be),zippath=userID?bbpath+_0x459bb3(0x211)+userID+'/':bbpath+_0x459bb3(0x211),loggerfile=fs[_0x459bb3(0x282)](logspath+_0x459bb3(0x2e1),{'flags':'a'}),temppath=userID?bbpath+_0x459bb3(0x366)+userID+'/':bbpath+_0x459bb3(0x366);!fs[_0x459bb3(0x1f5)](configpath)&&fs[_0x459bb3(0x37e)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x459bb3(0x37e)](configbackuppath);!fs[_0x459bb3(0x1f5)](logspath)&&fs[_0x459bb3(0x37e)](logspath);!fs[_0x459bb3(0x1f5)](zippath)&&fs[_0x459bb3(0x37e)](zippath);!fs[_0x459bb3(0x1f5)](temppath)&&fs[_0x459bb3(0x37e)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x459bb3(0x3cc)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x459bb3(0x3cc)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x459bb3(0x26d),'onepagemode':![],'marketcapApi':''}})[_0x459bb3(0x274)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x459bb3(0x3cc)]({'secure':{},'blacklist':[]})[_0x459bb3(0x274)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x459bb3(0x2d1)](_0x459bb3(0x3d5),{'host':_0x459bb3(0x3f1)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x459bb3(0x3d6)]&&(settings[_0x459bb3(0x3d6)]!=''&&settings['telegramToken']!='***')&&settings[_0x459bb3(0x2ba)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x22614b,_0x10cceb)=>{const _0x244d1c=_0x459bb3,_0x484e7b=/#[A-Z]{3}#/g;if(typeof _0x22614b==_0x244d1c(0x257)){!_0x10cceb?_0x22614b=_0x22614b[_0x244d1c(0x25c)](_0x484e7b,''):(_0x22614b=_0x22614b[_0x244d1c(0x25c)](/#BLU#/g,_0x244d1c(0x384)),_0x22614b=_0x22614b['replace'](/#RED#/g,_0x244d1c(0x339)),_0x22614b=_0x22614b[_0x244d1c(0x25c)](/#YEL#/g,_0x244d1c(0x1eb)),_0x22614b=_0x22614b['replace'](/#MAG#/g,_0x244d1c(0x29d)),_0x22614b=_0x22614b[_0x244d1c(0x25c)](/#CYA#/g,_0x244d1c(0x2a9)),_0x22614b=_0x22614b[_0x244d1c(0x25c)](/#RES#/g,_0x244d1c(0x1d8)));;}return _0x22614b;},logger={'screen':_0x47d76b=>{console['log'](parseColor(_0x47d76b,!![]));},'simple':_0x49afcb=>{const _0x5423e2=_0x459bb3;console['log'](parseColor(_0x49afcb,!![])),loggerfile[_0x5423e2(0x274)](util[_0x5423e2(0x3f2)](parseColor(_0x49afcb,![]))+'\x0a');},'full':async _0x174129=>{const _0x414db0=_0x459bb3,_0x274a99=getTimeStamp()+_0x414db0(0x3ad)+_0x174129;console[_0x414db0(0x32b)](parseColor(_0x274a99,!![])),loggerfile[_0x414db0(0x274)](util[_0x414db0(0x3f2)](parseColor(_0x274a99,![]))+'\x0a');if(tgBot&&settings[_0x414db0(0x1ee)]&&settings[_0x414db0(0x22e)]!=_0x414db0(0x24d))await sendTelegram(settings[_0x414db0(0x1ee)],_0x414db0(0x372)+parseColor(_0x174129,![]));},'debug':async(_0x3541a2,_0x3f9c19='')=>{const _0x7df167=_0x459bb3,_0x3b3bd2=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x3541a2;if(debugging)console[_0x7df167(0x32b)](parseColor(_0x3b3bd2,!![]));loggerfile[_0x7df167(0x274)](util['format'](parseColor(_0x3b3bd2,![]))+'\x0a');if(_0x3f9c19){if(debugging)console['log'](_0x3f9c19);loggerfile[_0x7df167(0x274)](util['format'](_0x3f9c19)+'\x0a');}}};let terminating=![];process['on'](_0x459bb3(0x352),function(_0x2252a1){const _0x3a5a6f=_0x459bb3;_0x2252a1['toString']()[_0x3a5a6f(0x201)](_0x3a5a6f(0x3e5))?(logger[_0x3a5a6f(0x28a)](_0x3a5a6f(0x312)+_0x2252a1[_0x3a5a6f(0x389)]+_0x3a5a6f(0x397)),process['send']({'terminate':!![]},_0x3e73b3=>{})):logger[_0x3a5a6f(0x28a)](_0x2252a1);}),process['on'](_0x459bb3(0x2f8),()=>{const _0xac82b3=_0x459bb3;stopAllBots(),process[_0xac82b3(0x2f8)](0x0);}),process['on'](_0x459bb3(0x26b),()=>{const _0x36531d=_0x459bb3;stopAllBots(),process[_0x36531d(0x2f8)](0x0);}),process['on']('SIGINT',()=>{const _0x449848=_0x459bb3;stopAllBots(),process[_0x449848(0x2f8)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x459bb3(0x2e3))[_0x459bb3(0x2ea)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x459bb3(0x2d2)),app=express(),http=require(_0x459bb3(0x35e))[_0x459bb3(0x3f3)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x459bb3(0x303)](_0x459bb3(0x331),async(_0xaff3e1,_0x46b2da)=>{const _0x5d7b38=_0x459bb3,_0x401e51=_0xaff3e1[_0x5d7b38(0x1e4)][_0x5d7b38(0x1d6)],_0x1fe316=getClientsWithBotID('botmanager'),_0x2860b3=_0xaff3e1['headers'][_0x5d7b38(0x215)],_0x3aab74=timelyDecrypt(_0x2860b3,![]),_0x2c414e=_0x1fe316[_0x5d7b38(0x3d4)](_0x510df9=>_0x510df9[_0x5d7b38(0x215)]==_0x3aab74);if(_0x2c414e){const _0x1b9eb8=normalizeIP(_0xaff3e1[_0x5d7b38(0x2c1)]['remoteAddress'])['store'],_0x1181ab=_0xaff3e1[_0x5d7b38(0x3b7)][_0x5d7b38(0x1e8)];if(validateAccess(_0x1181ab,_0x3aab74,_0x1b9eb8)[_0x5d7b38(0x217)])_0x401e51==_0x5d7b38(0x300)&&await backupConfigFiles(),await zipFiles(_0x401e51),_0x46b2da[_0x5d7b38(0x1d5)](zippath+(_0x401e51+_0x5d7b38(0x1f0)),_0x40a3c5=>{const _0x3cbd43=_0x5d7b38;_0x40a3c5&&(logger[_0x3cbd43(0x2cd)](_0x3cbd43(0x26c)+_0x401e51),logger['simple'](_0x40a3c5));});else logger[_0x5d7b38(0x2cd)](_0x5d7b38(0x219)+_0x401e51+_0x5d7b38(0x30c));}else logger[_0x5d7b38(0x2cd)](_0x5d7b38(0x219)+_0x401e51+_0x5d7b38(0x2e4));}),app[_0x459bb3(0x23f)](_0x459bb3(0x2d0),async(_0x199400,_0x4f5bda)=>{const _0x3f088c=_0x459bb3,_0x164f2f=getClientsWithBotID(_0x3f088c(0x380)),_0x19b11f=_0x199400[_0x3f088c(0x3b7)][_0x3f088c(0x215)],_0x3ac623=timelyDecrypt(_0x19b11f,![]),_0x410ff0=_0x164f2f[_0x3f088c(0x3d4)](_0x3abc01=>_0x3abc01[_0x3f088c(0x215)]==_0x3ac623);logger[_0x3f088c(0x311)]('Backup\x20file\x20uploaded');if(_0x410ff0){const _0xe15c0f=normalizeIP(_0x199400['socket'][_0x3f088c(0x3e3)])[_0x3f088c(0x1d2)],_0x3529ec=_0x199400[_0x3f088c(0x3b7)][_0x3f088c(0x1e8)];if(validateAccess(_0x3529ec,_0x3ac623,_0xe15c0f)[_0x3f088c(0x217)]){if(_0x199400[_0x3f088c(0x2c8)]){const _0x26d6d3=_0x199400[_0x3f088c(0x2c8)][_0x3f088c(0x2de)];await _0x26d6d3['mv'](temppath+_0x26d6d3[_0x3f088c(0x363)]),_0x4f5bda[_0x3f088c(0x250)]({'status':!![],'message':'File\x20uploaded'});const _0x8923fb=getBotsWithMode();_0x8923fb[_0x3f088c(0x30a)]>0x0?confirmRestore(temppath,_0x26d6d3[_0x3f088c(0x363)]):unzipFile(temppath,_0x26d6d3[_0x3f088c(0x363)]);}}else logger[_0x3f088c(0x2cd)](_0x3f088c(0x367));}else logger[_0x3f088c(0x2cd)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app['use'](express['static'](path['join'](__dirname,bbpath2,'build2'))),app[_0x459bb3(0x2c2)](express['static'](path['join'](__dirname,bbpath2,_0x459bb3(0x3be)))),app[_0x459bb3(0x303)]('/',function(_0x191700,_0x4241b5){const _0x3d5cfe=_0x459bb3;_0x4241b5[_0x3d5cfe(0x2ca)](path[_0x3d5cfe(0x316)](__dirname,bbpath2,'build2',_0x3d5cfe(0x243)));}),app['get']('/:bot',function(_0x4fd6cb,_0x533000){const _0x26845d=_0x459bb3;_0x533000[_0x26845d(0x2ca)](path[_0x26845d(0x316)](__dirname,bbpath2,_0x26845d(0x3be),'index.html'));}),app[_0x459bb3(0x303)]('/:bot/portfolio',(_0x4fd4b2,_0x1952e1)=>{const _0xde081a=_0x459bb3;_0x1952e1[_0xde081a(0x2ca)](path[_0xde081a(0x316)](__dirname,bbpath2,_0xde081a(0x3be),_0xde081a(0x243)));}),app[_0x459bb3(0x303)](_0x459bb3(0x1db),(_0x30314b,_0x350f99)=>{const _0x21b79a=_0x459bb3;_0x350f99[_0x21b79a(0x2ca)](path[_0x21b79a(0x316)](__dirname,bbpath2,_0x21b79a(0x3be),_0x21b79a(0x243)));}),app[_0x459bb3(0x303)](_0x459bb3(0x378),(_0xb78158,_0x500ccd)=>{const _0x4822b2=_0x459bb3;_0x500ccd[_0x4822b2(0x2ca)](path[_0x4822b2(0x316)](__dirname,bbpath2,_0x4822b2(0x3be),_0x4822b2(0x243)));}),app[_0x459bb3(0x303)](_0x459bb3(0x27c),(_0x1f8333,_0x493849)=>{const _0x11add0=_0x459bb3;_0x493849[_0x11add0(0x2ca)](path[_0x11add0(0x316)](__dirname,bbpath2,_0x11add0(0x3be),_0x11add0(0x243)));}),app[_0x459bb3(0x303)](_0x459bb3(0x240),(_0x4f5dca,_0x3d734c)=>{const _0x1394bd=_0x459bb3;_0x3d734c['sendFile'](path['join'](__dirname,bbpath2,_0x1394bd(0x3be),_0x1394bd(0x243)));}),app['get'](_0x459bb3(0x3a5),(_0x5ad27d,_0x3d5207)=>{const _0xbe28a3=_0x459bb3;_0x3d5207[_0xbe28a3(0x2ca)](path[_0xbe28a3(0x316)](__dirname,bbpath2,_0xbe28a3(0x3be),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x459bb3(0x3ec))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x50357a=_0x459bb3;let _0x50f104=_0x50357a(0x3a2);const _0x75000d=networkInterfaces(),_0x3c1f0f={};for(const _0x239d50 of Object[_0x50357a(0x208)](_0x75000d)){for(const _0x14d2ee of _0x75000d[_0x239d50]){if((_0x14d2ee[_0x50357a(0x28c)]==_0x50357a(0x31b)||_0x14d2ee['family']==0x4)&&!_0x14d2ee[_0x50357a(0x2b9)]){const _0x576b82=ipaddr[_0x50357a(0x2b0)](_0x14d2ee[_0x50357a(0x228)])[_0x50357a(0x3c2)]();_0x576b82!=_0x50357a(0x2b8)&&(!_0x3c1f0f[_0x239d50]&&(_0x3c1f0f[_0x239d50]=[]),_0x3c1f0f[_0x239d50][_0x50357a(0x3b3)](_0x14d2ee[_0x50357a(0x228)]),_0x50f104=_0x14d2ee[_0x50357a(0x228)]);}}}return{'serverip':_0x50f104,'netinterfaces':_0x3c1f0f};}async function startServer(){const _0xa6b910=_0x459bb3,{serverip:_0x5321c7,netinterfaces:_0x49bce0}=getServerIP();logger[_0xa6b910(0x28a)](''),logger[_0xa6b910(0x28a)](_0xa6b910(0x3e7)),await logger[_0xa6b910(0x2cd)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0xa6b910(0x256)+(environment==_0xa6b910(0x37c)?'(staging)':'')+'\x0a'+(_0xa6b910(0x1f2)+PORT+_0xa6b910(0x3c5))+(_0xa6b910(0x383)+_0x5321c7+':'+PORT+_0xa6b910(0x244))),logger[_0xa6b910(0x28a)](_0xa6b910(0x3e7));if(config[_0xa6b910(0x30a)]!=0x0)for(const _0x453e1e of config){const _0x139db9=_0x453e1e['mode']=='auto'?'a':'m';if(_0x453e1e[_0xa6b910(0x2d3)]==_0xa6b910(0x25a)||_0x453e1e[_0xa6b910(0x2d3)]==_0xa6b910(0x299))await logger[_0xa6b910(0x2cd)]('Starting\x20('+_0x139db9+_0xa6b910(0x315)+_0x453e1e[_0xa6b910(0x33f)]+_0xa6b910(0x344)+_0x453e1e['botname']),startBot([_0x453e1e[_0xa6b910(0x33f)],userID],{'cwd':bbpath},function(_0x559594){const _0x1af528=_0xa6b910;if(_0x559594)logger[_0x1af528(0x2cd)](_0x559594);});else(_0x453e1e['status']=='disabled'||_0x453e1e[_0xa6b910(0x2d3)]=='new-disabled')&&await logger['full']('Idling\x20('+_0x139db9+')\x20\x20\x20|\x20Bot\x20'+_0x453e1e[_0xa6b910(0x33f)]+_0xa6b910(0x344)+_0x453e1e['botname']);}else!newBot&&logger[_0xa6b910(0x28a)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0xa6b910(0x28a)](_0xa6b910(0x3e7)),logger[_0xa6b910(0x28a)](''),await logger[_0xa6b910(0x311)](_0xa6b910(0x218)+nodeversion),await logger['debug'](_0xa6b910(0x3ce),_0x49bce0);}function startSocket(){const _0x3b5ab1=_0x459bb3;io['on'](_0x3b5ab1(0x23e),_0x135a06=>{const _0x4ae8e9=_0x3b5ab1;let _0x5368db,_0x3a4264,_0x2168f4,_0x6dc502,_0x30bcef;const _0x4d4c8f=_0x135a06[_0x4ae8e9(0x273)]['headers'][_0x4ae8e9(0x261)];_0x3a4264=_0x4d4c8f['match'](/bot[0-9]{3}/);if(_0x3a4264)_0x2168f4=_0x3a4264[0x0][_0x4ae8e9(0x2a2)](/[0-9]{3}/);if(_0x2168f4)_0x5368db=_0x2168f4[0x0];else _0x5368db=_0x4ae8e9(0x380);const _0xcd0d30=_0x135a06['handshake'][_0x4ae8e9(0x35c)][_0x4ae8e9(0x22d)];if(!_0xcd0d30)_0x135a06[_0x4ae8e9(0x359)](_0x4ae8e9(0x2d3),{'publicKey':secure[_0x4ae8e9(0x349)]});else{_0x6dc502=timelyDecrypt(_0xcd0d30,![]);if(!_0x6dc502)_0x135a06['emit'](_0x4ae8e9(0x2d3),{'publicKey':secure[_0x4ae8e9(0x349)]});else{_0x30bcef=normalizeIP(_0x135a06[_0x4ae8e9(0x38d)][_0x4ae8e9(0x3e3)])['store'];if(!devices[_0x6dc502])devices[_0x6dc502]={'uuid':_0x6dc502,'access':{'token':null}};devices[_0x6dc502]['ip']=_0x30bcef;const _0x756f0a=addClient(_0x135a06['id'],_0x6dc502,_0x5368db);setAccess(_0x756f0a),emitMessages(),_0x135a06['on'](_0x4ae8e9(0x210),_0x5e2962=>{const _0x1d4df9=_0x4ae8e9,_0x2c799f=timelyDecrypt(_0x5e2962['password'],!![],_0x1d4df9(0x3c1));if(_0x2c799f){_0x5e2962={'username':_0x5e2962['username'],'password':_0x2c799f},devices[_0x6dc502][_0x1d4df9(0x1d1)]=validateCredentials(_0x5e2962,_0x6dc502);if(devices[_0x6dc502][_0x1d4df9(0x1d1)][_0x1d4df9(0x217)]==![]&&devices[_0x6dc502][_0x1d4df9(0x1d1)][_0x1d4df9(0x26e)]==_0x1d4df9(0x1dc))_0x135a06['emit'](_0x1d4df9(0x2d3),{'access':devices[_0x6dc502][_0x1d4df9(0x1d1)]}),loginAccess2FA(_0x6dc502,_0x30bcef);else{if(devices[_0x6dc502][_0x1d4df9(0x1d1)][_0x1d4df9(0x217)]==![]&&devices[_0x6dc502][_0x1d4df9(0x1d1)][_0x1d4df9(0x26e)]==_0x1d4df9(0x2b3))_0x135a06[_0x1d4df9(0x359)](_0x1d4df9(0x2d3),{'access':devices[_0x6dc502][_0x1d4df9(0x1d1)]});else devices[_0x6dc502]['access']['allow']&&devices[_0x6dc502][_0x1d4df9(0x1d1)][_0x1d4df9(0x26e)]==_0x1d4df9(0x309)&&(getClientsWithUuid(_0x6dc502)[_0x1d4df9(0x2ef)](_0x55110a=>{setAccess(_0x55110a);}),logger[_0x1d4df9(0x311)]('Logged\x20in\x20user\x20...'+_0x6dc502[_0x1d4df9(0x1f3)](-0x8)),setTokenRefresh(_0x6dc502),setSessionTimeout(_0x1d4df9(0x210),_0x6dc502));}}else logger['full'](_0x1d4df9(0x2ab));}),_0x135a06['on'](_0x4ae8e9(0x3b0),()=>{resetPassword();}),_0x135a06['on'](_0x4ae8e9(0x36c),_0x316c0d=>{removeClient(_0x135a06['id']);}),_0x5368db=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x2d5b18){const _0x33b124=_0x459bb3;if(_0x2d5b18!=_0x33b124(0x380)&&config[_0x33b124(0x258)]!=''){if(pid[_0x2d5b18])pid[_0x2d5b18][_0x33b124(0x250)]({'function':_0x33b124(0x284),'args':null});}_0x2d5b18!=_0x33b124(0x380)&&broadcastToBots(_0x33b124(0x270),JSON[_0x33b124(0x3cf)](config));}function reloadBotManager(){const _0xcf9cae=_0x459bb3;getClientsWithBotID(_0xcf9cae(0x380))[_0xcf9cae(0x2ef)](_0x3e0d3d=>{const _0xdb60cc=_0xcf9cae;getSocket(_0x3e0d3d['id'])['emit'](_0xdb60cc(0x2d3),{'access':{'allow':![],'reason':_0xdb60cc(0x2a1),'token':null}});});}function getSocket(_0x1d7b7b){const _0x219670=_0x459bb3,_0x4b7f40=io[_0x219670(0x3c3)]['get']('/');return _0x4b7f40[_0x219670(0x3da)][_0x219670(0x303)](_0x1d7b7b);}function setAccess(_0x35eecb){const _0x4c9c94=_0x459bb3,_0x3c5639=getSocket(_0x35eecb['id']),_0x4634d7=_0x35eecb[_0x4c9c94(0x215)],_0x346750=_0x35eecb['bot'];devices[_0x4634d7][_0x4c9c94(0x1d1)]=validateAccess(devices[_0x4634d7]['access'][_0x4c9c94(0x1e7)],_0x4634d7),logger[_0x4c9c94(0x311)]('Setting\x20access:\x20'+devices[_0x4634d7][_0x4c9c94(0x1d1)][_0x4c9c94(0x26e)]+_0x4c9c94(0x3aa)+_0x35eecb['id'][_0x4c9c94(0x1f3)](-0x8)+_0x4c9c94(0x30b)+_0x4634d7['slice'](-0x8)),_0x3c5639['join'](_0x4634d7);if(devices[_0x4634d7][_0x4c9c94(0x1d1)][_0x4c9c94(0x217)]){_0x3c5639[_0x4c9c94(0x316)](_0x346750);if(_0x346750==_0x4c9c94(0x380))initializeSocketBotManager(_0x3c5639);else initializeSocketBot(_0x3c5639);initClient(_0x346750);}devices[_0x4634d7][_0x4c9c94(0x1d1)]['token']&&devices[_0x4634d7][_0x4c9c94(0x1d1)][_0x4c9c94(0x26e)]==_0x4c9c94(0x2d5)&&setSessionTimeout(_0x4c9c94(0x288),_0x4634d7),devices[_0x4634d7][_0x4c9c94(0x1d1)][_0x4c9c94(0x1e7)]&&devices[_0x4634d7]['access'][_0x4c9c94(0x26e)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x4c9c94(0x210),_0x4634d7),_0x3c5639['emit'](_0x4c9c94(0x2d3),{'status':_0x35eecb['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4634d7]['access'],'externalip':devices[_0x4634d7]['ip'],'publicKey':secure[_0x4c9c94(0x349)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x4634d7]['access'][_0x4c9c94(0x217)]==![]&&devices[_0x4634d7][_0x4c9c94(0x1d1)][_0x4c9c94(0x26e)]==_0x4c9c94(0x2b6)&&temporaryAccess2FA(_0x4634d7,devices[_0x4634d7]['ip']);}function setSessionTimeout(_0x43f1f1,_0x10828f){const _0x4faa36=_0x459bb3;let _0x33100a;if(_0x43f1f1==_0x4faa36(0x210))_0x33100a=loginExpiry*0x3c*0x3e8;else _0x33100a=devices[_0x10828f][_0x4faa36(0x1df)][_0x4faa36(0x2f5)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x10828f]['telegramIpApproval']['timestamp']);if(devices[_0x10828f][_0x4faa36(0x1e2)])clearTimeout(devices[_0x10828f]['pidExpireLogin']);devices[_0x10828f][_0x4faa36(0x1e2)]=setTimeout(()=>{const _0x48890e=_0x4faa36;if(devices[_0x10828f][_0x48890e(0x30d)])clearTimeout(devices[_0x10828f][_0x48890e(0x30d)]);removeSocketListeners(_0x10828f),addBlacklist(_0x10828f),devices[_0x10828f]['telegramIpApproval']=null,devices[_0x10828f][_0x48890e(0x345)]=null,devices[_0x10828f][_0x48890e(0x1d1)]['token']=null,logger['debug'](_0x48890e(0x207)+_0x10828f[_0x48890e(0x1f3)](-0x8)),devices[_0x10828f]['access']=validateAccess(devices[_0x10828f][_0x48890e(0x1d1)][_0x48890e(0x1e7)],_0x10828f),!(devices[_0x10828f][_0x48890e(0x1d1)][_0x48890e(0x217)]&&devices[_0x10828f][_0x48890e(0x1d1)][_0x48890e(0x26e)]=='login\x20not\x20required')&&(_0x43f1f1==_0x48890e(0x210)?io['to'](_0x10828f)[_0x48890e(0x359)](_0x48890e(0x2d3),{'access':{'allow':![],'reason':_0x48890e(0x280),'token':null}}):io['to'](_0x10828f)[_0x48890e(0x359)](_0x48890e(0x2d3),{'access':{'allow':![],'reason':_0x48890e(0x3a7),'token':null}})),devices[_0x10828f][_0x48890e(0x1d1)][_0x48890e(0x1e7)]=null;},_0x33100a);}function setTokenRefresh(_0x10fad9){const _0x181f36=_0x459bb3;if(devices[_0x10fad9][_0x181f36(0x30d)])clearTimeout(devices[_0x10fad9][_0x181f36(0x30d)]);devices[_0x10fad9][_0x181f36(0x30d)]=setTimeout(()=>{const _0x10536b=_0x181f36;getClientsWithUuid(_0x10fad9)['length']!=0x0?(devices[_0x10fad9][_0x10536b(0x1d1)]=refreshToken(_0x10fad9),io['to'](_0x10fad9)['emit'](_0x10536b(0x2d3),{'status':_0x10536b(0x1e9),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x10fad9][_0x10536b(0x1d1)],'externalip':devices[_0x10fad9]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x10fad9)):clearTimeout(devices[_0x10fad9][_0x10536b(0x30d)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x42f000){const _0x129b11=_0x459bb3,_0x2fa5b2=getClient(_0x42f000['id'])[_0x129b11(0x215)];_0x42f000[_0x129b11(0x359)](_0x129b11(0x270),config),_0x42f000[_0x129b11(0x359)](_0x129b11(0x3dc),cleanSettings()),_0x42f000['on']('add-bot',_0x509b17=>{const _0xe6f22c=_0x129b11;if(validateAccess(_0x509b17,_0x2fa5b2)[_0xe6f22c(0x217)])addBot();else logger['full'](_0xe6f22c(0x253));}),_0x42f000['on'](_0x129b11(0x332),(_0x4d0e2c,_0x42c574)=>{const _0x809273=_0x129b11;if(validateAccess(_0x42c574,_0x2fa5b2)[_0x809273(0x217)])toggleBot(_0x4d0e2c[_0x809273(0x33f)],_0x4d0e2c[_0x809273(0x2d3)],_0x4d0e2c['live']);else logger[_0x809273(0x2cd)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x42f000['on'](_0x129b11(0x323),(_0x22ff27,_0x59a151)=>{const _0x2d88dd=_0x129b11;if(validateAccess(_0x59a151,_0x2fa5b2)[_0x2d88dd(0x217)])toggleBotMode(_0x22ff27);else logger[_0x2d88dd(0x2cd)](_0x2d88dd(0x320));}),_0x42f000['on']('delete-bot',(_0x1d0b64,_0x37b3da)=>{const _0x3a206c=_0x129b11;if(validateAccess(_0x37b3da,_0x2fa5b2)[_0x3a206c(0x217)])deleteBot(_0x1d0b64);else logger[_0x3a206c(0x2cd)](_0x3a206c(0x3c9));}),_0x42f000['on'](_0x129b11(0x283),(_0x402a4f,_0x108b9e)=>{const _0x7bc902=_0x129b11;if(validateAccess(_0x108b9e,_0x2fa5b2)['allow'])storeSettings(_0x402a4f,!![]);else logger[_0x7bc902(0x2cd)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x42f000['on'](_0x129b11(0x31e),_0x53a619=>{const _0x31e409=_0x129b11;if(validateAccess(_0x53a619,_0x2fa5b2)[_0x31e409(0x217)])updateBB(_0x31e409(0x34a));else logger[_0x31e409(0x2cd)](_0x31e409(0x32e));}),_0x42f000['on']('reinstall-bb',_0x4456e0=>{const _0x19770c=_0x129b11;if(validateAccess(_0x4456e0,_0x2fa5b2)[_0x19770c(0x217)])updateBB('reinstall');else logger[_0x19770c(0x2cd)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x42f000['on'](_0x129b11(0x3a6),_0x2330c8=>{const _0x328782=_0x129b11;if(validateAccess(_0x2330c8,_0x2fa5b2)[_0x328782(0x217)]){const _0x769830=getClient(_0x42f000['id']);if(_0x769830)getBackupFiles(_0x769830['uuid']);else logger[_0x328782(0x2cd)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x328782(0x2cd)](_0x328782(0x27b));}),_0x42f000['on'](_0x129b11(0x1d4),(_0x37a7f8,_0x407885)=>{const _0x2d4f86=_0x129b11;if(validateAccess(_0x407885,_0x2fa5b2)['allow'])restoreBackupFile(_0x37a7f8);else logger[_0x2d4f86(0x2cd)](_0x2d4f86(0x2db));}),_0x42f000['on']('get-messages',_0x4a387f=>{const _0x5723be=_0x129b11;if(validateAccess(_0x4a387f,_0x2fa5b2)['allow'])getMessages();else logger[_0x5723be(0x2cd)](_0x5723be(0x2f3));}),_0x42f000['on'](_0x129b11(0x2bc),(_0xc7e2b3,_0x81fbb2)=>{const _0x9db903=_0x129b11;if(validateAccess(_0x81fbb2,_0x2fa5b2)[_0x9db903(0x217)])confirmMessage(_0xc7e2b3);else logger['full'](_0x9db903(0x292));}),_0x42f000['on'](_0x129b11(0x361),_0x1d3ec3=>{const _0x24d300=_0x129b11;if(validateAccess(_0x1d3ec3,_0x2fa5b2)[_0x24d300(0x217)]){if(devices[_0x2fa5b2]['pidRefreshToken'])clearTimeout(devices[_0x2fa5b2][_0x24d300(0x30d)]);if(devices[_0x2fa5b2]['pidExpireLogin'])clearTimeout(devices[_0x2fa5b2][_0x24d300(0x1e2)]);removeSocketListeners(getClient(_0x42f000['id'])[_0x24d300(0x215)]),addBlacklist(_0x2fa5b2),devices[_0x2fa5b2][_0x24d300(0x1df)]=null,devices[_0x2fa5b2][_0x24d300(0x345)]=null,devices[_0x2fa5b2][_0x24d300(0x1d1)]['token']=null,logger['debug'](_0x24d300(0x3df)+_0x2fa5b2['slice'](-0x8)),io['to'](getClient(_0x42f000['id'])['uuid'])[_0x24d300(0x359)](_0x24d300(0x2d3),{'access':{'allow':![],'reason':_0x24d300(0x1f9),'token':null}});}else logger['full'](_0x24d300(0x334));});}function initializeSocketBot(_0x598bb6){const _0x3379f5=_0x459bb3,_0x37c074=getClient(_0x598bb6['id'])[_0x3379f5(0x203)],_0x3b0bb0=getClient(_0x598bb6['id'])['uuid'];_0x598bb6['on'](_0x3379f5(0x2cf),(_0x2b8c96,_0x28aabb)=>{const _0x13a154=_0x3379f5;if(validateAccess(_0x28aabb,_0x3b0bb0)[_0x13a154(0x217)]){if(pid[_0x37c074])pid[_0x37c074]['send']({'function':_0x13a154(0x2ed),'args':_0x2b8c96});}else logger[_0x13a154(0x2cd)](_0x13a154(0x2ae));}),_0x598bb6['on'](_0x3379f5(0x3b4),(_0x2557c0,_0x1a3955)=>{const _0x5e83cd=_0x3379f5;if(validateAccess(_0x1a3955,_0x3b0bb0)[_0x5e83cd(0x217)]){if(pid[_0x37c074])pid[_0x37c074]['send']({'function':_0x5e83cd(0x259),'args':_0x2557c0});}else logger['full'](_0x5e83cd(0x2c4));}),_0x598bb6['on'](_0x3379f5(0x387),(_0x2a6c1f,_0x288320)=>{const _0x5473b4=_0x3379f5;if(validateAccess(_0x288320,_0x3b0bb0)[_0x5473b4(0x217)]){if(pid[_0x37c074])pid[_0x37c074][_0x5473b4(0x250)]({'function':_0x5473b4(0x3d2),'args':_0x2a6c1f});}else logger[_0x5473b4(0x2cd)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x598bb6['on'](_0x3379f5(0x20e),(_0x3b7f0f,_0x394ce5)=>{const _0x2a5de2=_0x3379f5;if(validateAccess(_0x394ce5,_0x3b0bb0)[_0x2a5de2(0x217)]){if(pid[_0x37c074])pid[_0x37c074]['send']({'function':_0x2a5de2(0x2bb),'args':_0x3b7f0f});}else logger[_0x2a5de2(0x2cd)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x598bb6['on'](_0x3379f5(0x275),(_0x32a10b,_0x958a74)=>{const _0x2eb6b4=_0x3379f5;if(validateAccess(_0x958a74,_0x3b0bb0)[_0x2eb6b4(0x217)]){if(pid[_0x37c074])pid[_0x37c074][_0x2eb6b4(0x250)]({'function':_0x2eb6b4(0x394),'args':_0x32a10b});}else logger[_0x2eb6b4(0x2cd)](_0x2eb6b4(0x264));}),_0x598bb6['on']('store-fiat',(_0xbf37fb,_0x3f7eba)=>{const _0x5e6164=_0x3379f5;if(validateAccess(_0x3f7eba,_0x3b0bb0)['allow']){if(pid[_0x37c074])pid[_0x37c074][_0x5e6164(0x250)]({'function':_0x5e6164(0x21d),'args':_0xbf37fb});}else logger[_0x5e6164(0x2cd)](_0x5e6164(0x2e2));}),_0x598bb6['on'](_0x3379f5(0x263),_0xfda874=>{const _0x4aae3e=_0x3379f5;if(validateAccess(_0xfda874,_0x3b0bb0)[_0x4aae3e(0x217)]){if(pid[_0x37c074])pid[_0x37c074][_0x4aae3e(0x250)]({'function':_0x4aae3e(0x29f),'args':null});}else logger[_0x4aae3e(0x2cd)](_0x4aae3e(0x229));}),_0x598bb6['on'](_0x3379f5(0x3a0),_0x108dfe=>{const _0x5ad85e=_0x3379f5;if(validateAccess(_0x108dfe,_0x3b0bb0)['allow']){if(pid[_0x37c074])pid[_0x37c074][_0x5ad85e(0x250)]({'function':'getStartingBalances','args':null});}else logger[_0x5ad85e(0x2cd)](_0x5ad85e(0x327));}),_0x598bb6['on'](_0x3379f5(0x278),(_0x6248a4,_0xf89107)=>{const _0x47dad0=_0x3379f5;if(validateAccess(_0xf89107,_0x3b0bb0)[_0x47dad0(0x217)]){if(pid[_0x37c074])pid[_0x37c074]['send']({'function':_0x47dad0(0x2b7),'args':_0x6248a4});}else logger[_0x47dad0(0x2cd)](_0x47dad0(0x3af));}),_0x598bb6['on'](_0x3379f5(0x293),_0x3d53b0=>{const _0x12eb55=_0x3379f5;if(validateAccess(_0x3d53b0,_0x3b0bb0)[_0x12eb55(0x217)]){if(pid[_0x37c074])pid[_0x37c074][_0x12eb55(0x250)]({'function':_0x12eb55(0x1d7),'args':null});}else logger[_0x12eb55(0x2cd)](_0x12eb55(0x286));}),_0x598bb6['on'](_0x3379f5(0x3d3),_0x41b45c=>{const _0x26ee77=_0x3379f5;if(validateAccess(_0x41b45c,_0x3b0bb0)[_0x26ee77(0x217)]){if(pid[_0x37c074])pid[_0x37c074][_0x26ee77(0x250)]({'function':'showConfig','args':null});}else logger[_0x26ee77(0x2cd)](_0x26ee77(0x2dc));}),_0x598bb6['on']('update-bb',_0x25a670=>{const _0x2df67d=_0x3379f5;if(validateAccess(_0x25a670,_0x3b0bb0)[_0x2df67d(0x217)])updateBB(_0x2df67d(0x34a));else logger[_0x2df67d(0x2cd)](_0x2df67d(0x32e));}),_0x598bb6['on'](_0x3379f5(0x396),_0x5681d4=>{const _0x4086f0=_0x3379f5;if(validateAccess(_0x5681d4,_0x3b0bb0)['allow'])getMessages();else logger[_0x4086f0(0x2cd)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x598bb6['on'](_0x3379f5(0x2bc),(_0x2fb4b2,_0xa8b8d7)=>{const _0x12d9c0=_0x3379f5;if(validateAccess(_0xa8b8d7,_0x3b0bb0)[_0x12d9c0(0x217)])confirmMessage(_0x2fb4b2);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x598bb6['on'](_0x3379f5(0x361),_0x540065=>{const _0x5540e3=_0x3379f5;if(validateAccess(_0x540065,_0x3b0bb0)[_0x5540e3(0x217)]){if(devices[_0x3b0bb0][_0x5540e3(0x30d)])clearTimeout(devices[_0x3b0bb0]['pidRefreshToken']);if(devices[_0x3b0bb0][_0x5540e3(0x1e2)])clearTimeout(devices[_0x3b0bb0][_0x5540e3(0x1e2)]);removeSocketListeners(getClient(_0x598bb6['id'])[_0x5540e3(0x215)]),addBlacklist(_0x3b0bb0),devices[_0x3b0bb0][_0x5540e3(0x1df)]=null,devices[_0x3b0bb0][_0x5540e3(0x345)]=null,devices[_0x3b0bb0][_0x5540e3(0x1d1)][_0x5540e3(0x1e7)]=null,logger[_0x5540e3(0x311)](_0x5540e3(0x3df)+_0x3b0bb0[_0x5540e3(0x1f3)](-0x8)),io['to'](getClient(_0x598bb6['id'])[_0x5540e3(0x215)])['emit'](_0x5540e3(0x2d3),{'access':{'allow':![],'reason':_0x5540e3(0x1f9),'token':null}});}else logger[_0x5540e3(0x2cd)](_0x5540e3(0x334));});}function removeSocketListeners(_0x3c68a0){getClientsWithUuid(_0x3c68a0)['forEach'](_0x27ef98=>{const _0x52f178=_0x4b6b;getSocket(_0x27ef98['id'])[_0x52f178(0x227)]();});}function cleanSettings(){const _0x55fb34=_0x459bb3;let _0x222c6b=settings;return settings[_0x55fb34(0x3d6)]&&settings[_0x55fb34(0x3d6)]!=''&&(_0x222c6b={..._0x222c6b,'telegramToken':_0x55fb34(0x3a3)}),settings['bbPassword']&&settings[_0x55fb34(0x385)]!=''&&(_0x222c6b={..._0x222c6b,'bbPassword':_0x55fb34(0x3a3)}),settings[_0x55fb34(0x32d)]&&settings[_0x55fb34(0x32d)]!=''&&(_0x222c6b={..._0x222c6b,'marketcapApi':'************'}),(settings[_0x55fb34(0x385)]&&settings[_0x55fb34(0x385)]=='***'||settings[_0x55fb34(0x3d6)]&&settings[_0x55fb34(0x3d6)]=='***'||settings['marketcapApi']&&settings[_0x55fb34(0x32d)]=='***')&&(_0x222c6b={..._0x222c6b,'restored':{'password':settings[_0x55fb34(0x385)]==_0x55fb34(0x324),'telegram':settings[_0x55fb34(0x3d6)]=='***','marketcap':settings[_0x55fb34(0x32d)]==_0x55fb34(0x324)}}),_0x222c6b;}async function updateBB(_0x2187f7){const _0x1fc0e4=_0x459bb3;await backupConfigFiles(),installingUpdate=!![],config[_0x1fc0e4(0x2ef)](_0x30f60e=>{const _0x116b51=_0x1fc0e4;restartBot(_0x30f60e[_0x116b51(0x33f)]);});if(_0x2187f7==_0x1fc0e4(0x34a))process['send']({'update':!![],'environment':environment},_0x1ce868=>{});else _0x2187f7==_0x1fc0e4(0x239)&&process['send']({'reinstall':!![],'environment':environment},_0x4c0794=>{});}function startBot(_0x273f41,_0x2731f8,_0x2d61ef){const _0x5ee474=_0x459bb3;if(debugging)_0x273f41[_0x5ee474(0x3b3)]('-d');if(recreate)_0x273f41[_0x5ee474(0x3b3)]('-r');let _0x1d0644=![];const _0x4d6794=_0x273f41[0x0];_0x2731f8={..._0x2731f8,'stdio':[_0x5ee474(0x23a),'inherit',_0x5ee474(0x23a),_0x5ee474(0x314)]},pid[_0x4d6794]=childProcess[_0x5ee474(0x231)](botfile,_0x273f41,_0x2731f8),pid[_0x4d6794]['on']('message',_0x9cfdd2=>{const _0x44e824=_0x5ee474;switch(Object[_0x44e824(0x208)](_0x9cfdd2)[0x0]){case _0x44e824(0x27a):updateBotName(_0x4d6794,_0x9cfdd2['botname']);break;case'updatebotmanager':updateBotManager();break;case _0x44e824(0x2d3):updateStatus(_0x4d6794,_0x9cfdd2[_0x44e824(0x2d3)]);break;case _0x44e824(0x277):updateLive(_0x4d6794,_0x9cfdd2[_0x44e824(0x277)]);break;case _0x44e824(0x1ed):updateLive(_0x4d6794,_0x9cfdd2['started']),io['to'](_0x4d6794)[_0x44e824(0x359)](_0x44e824(0x2d3),{'access':{'allow':![],'reason':_0x44e824(0x2a1),'token':null}});break;case _0x44e824(0x295):_0x9cfdd2[_0x44e824(0x295)]==_0x44e824(0x29e)&&restartBot(_0x4d6794);_0x9cfdd2[_0x44e824(0x295)]==_0x44e824(0x2ee)&&toggleBot(_0x4d6794,_0x44e824(0x34c),_0x44e824(0x31f));break;case'telegram':sendTelegramBot(_0x4d6794,_0x9cfdd2[_0x44e824(0x39e)]);break;case _0x44e824(0x281):sendTelegramMsg(_0x9cfdd2[_0x44e824(0x281)]);break;case _0x44e824(0x386):io['to'](_0x4d6794)[_0x44e824(0x359)](_0x9cfdd2[_0x44e824(0x386)],_0x9cfdd2['args']);break;}}),pid[_0x4d6794]['on'](_0x5ee474(0x238),function(_0x5923a2){if(_0x1d0644)return;_0x1d0644=!![],_0x2d61ef(_0x5923a2);}),pid[_0x4d6794]['on'](_0x5ee474(0x2f8),async function(_0x57f545){const _0xe58df3=_0x5ee474;if(terminating)return;if(installingUpdate){io[_0xe58df3(0x358)]();return;}if(_0x1d0644)return;_0x1d0644=!![],_0x2d61ef(null);const _0x5f202c=dbConfig[_0xe58df3(0x303)](_0xe58df3(0x270))[_0xe58df3(0x3d4)]({'botID':_0x4d6794})[_0xe58df3(0x290)]();_0x5f202c&&(_0x5f202c[_0xe58df3(0x2d3)]=='enabled'||_0x5f202c[_0xe58df3(0x2d3)]=='new')&&(await sleep(0x3e8),updateLive(_0x4d6794,_0xe58df3(0x31f)),logger['full']('Restarting\x20Bot\x20'+_0x4d6794),startBot([_0x4d6794,userID],{'cwd':bbpath},function(_0x40a005){if(_0x40a005)logger['full'](_0x40a005);}));});}function stopBot(_0x1dbc70){getClientsWithBotID(_0x1dbc70)['forEach'](_0x33e55d=>{const _0xacbcb0=_0x4b6b;getSocket(_0x33e55d['id'])[_0xacbcb0(0x36c)](!![]),removeClient(_0x33e55d['id']);}),pid[_0x1dbc70]&&(pid[_0x1dbc70]['kill'](),pid[_0x1dbc70]=null);}function stopAllBots(){const _0x575939=_0x459bb3;terminating=!![];const _0x57e0a9=getEnabledBots();_0x57e0a9[_0x575939(0x2ef)](_0x3fd6a3=>{const _0x1695b1=_0x575939;stopBot(_0x3fd6a3[_0x1695b1(0x33f)]);});}function restartBot(_0x57a9d3){const _0x546625=_0x459bb3;if(pid[_0x57a9d3])pid[_0x57a9d3][_0x546625(0x2ee)]();}function addBot(){const _0x5c5496=_0x459bb3;let _0x1c47e9;for(let _0x293a16=0x1;_0x293a16<0x3e9;_0x293a16++){_0x1c47e9=_0x293a16[_0x5c5496(0x2bf)]()['padStart'](0x3,'0');let _0x383601=config[_0x5c5496(0x3d4)](_0x26e1b9=>_0x26e1b9[_0x5c5496(0x33f)]==_0x1c47e9);if(!_0x383601)break;}if(_0x1c47e9===_0x5c5496(0x29b)){logger[_0x5c5496(0x2cd)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger['full'](_0x5c5496(0x251)+_0x1c47e9),dbConfig['get'](_0x5c5496(0x270))[_0x5c5496(0x3b3)]({'botID':_0x1c47e9,'botname':_0x5c5496(0x1d0)+_0x1c47e9,'status':'new','live':''})[_0x5c5496(0x274)](),startBot([_0x1c47e9,userID],{'cwd':bbpath},function(_0x4569e0){const _0x343735=_0x5c5496;if(_0x4569e0)logger[_0x343735(0x2cd)](_0x4569e0);}),config=getConfiguration(),io['to'](_0x5c5496(0x380))[_0x5c5496(0x359)](_0x5c5496(0x270),config),broadcastToBots(_0x5c5496(0x270),JSON[_0x5c5496(0x3cf)](config));}function deleteBot(_0x57882e){const _0x349b1f=_0x459bb3;getClientsWithBotID(_0x57882e)[_0x349b1f(0x2ef)](_0xbdc922=>{getSocket(_0xbdc922['id'])['disconnect'](!![]),removeClient(_0xbdc922['id']);}),dbConfig[_0x349b1f(0x303)](_0x349b1f(0x270))[_0x349b1f(0x329)]({'botID':_0x57882e})[_0x349b1f(0x274)](),logger['full'](_0x349b1f(0x272)+_0x57882e),stopBot(_0x57882e);try{if(fs[_0x349b1f(0x1f5)](path[_0x349b1f(0x316)](configpath,_0x349b1f(0x307)+_0x57882e+'-config.json')))fs[_0x349b1f(0x37d)](path[_0x349b1f(0x316)](configpath,_0x349b1f(0x307)+_0x57882e+_0x349b1f(0x20c)));if(fs['existsSync'](path[_0x349b1f(0x316)](configpath,_0x349b1f(0x307)+_0x57882e+_0x349b1f(0x1da))))fs[_0x349b1f(0x37d)](path[_0x349b1f(0x316)](configpath,'bot-'+_0x57882e+_0x349b1f(0x1da)));if(fs[_0x349b1f(0x1f5)](path[_0x349b1f(0x316)](configpath,_0x349b1f(0x307)+_0x57882e+_0x349b1f(0x247))))fs[_0x349b1f(0x37d)](path[_0x349b1f(0x316)](configpath,_0x349b1f(0x307)+_0x57882e+_0x349b1f(0x247)));if(fs[_0x349b1f(0x1f5)](path[_0x349b1f(0x316)](configpath,_0x349b1f(0x307)+_0x57882e+_0x349b1f(0x2eb))))fs['unlinkSync'](path[_0x349b1f(0x316)](configpath,_0x349b1f(0x307)+_0x57882e+'-results.json'));}catch(_0xe546d){if(_0xe546d)logger['full']('Error\x20while\x20deleting\x20config\x20files:\x20',_0xe546d);}config=getConfiguration(),io['to'](_0x349b1f(0x380))[_0x349b1f(0x359)](_0x349b1f(0x270),config),broadcastToBots('bots',JSON[_0x349b1f(0x3cf)](config));}function toggleBot(_0x46aa0f,_0x481978,_0x2595f5){const _0x3ed905=_0x459bb3;dbConfig[_0x3ed905(0x303)](_0x3ed905(0x270))[_0x3ed905(0x3d4)]({'botID':_0x46aa0f})[_0x3ed905(0x212)]({'status':_0x481978})[_0x3ed905(0x212)]({'live':_0x2595f5})[_0x3ed905(0x274)]();if(_0x481978==_0x3ed905(0x25a)||_0x481978==_0x3ed905(0x299))logger[_0x3ed905(0x2cd)](_0x3ed905(0x39d)+_0x46aa0f),startBot([_0x46aa0f,userID],{'cwd':bbpath},function(_0x62bdda){const _0x316be8=_0x3ed905;if(_0x62bdda)logger[_0x316be8(0x2cd)](_0x62bdda);});else(_0x481978==_0x3ed905(0x34c)||_0x481978==_0x3ed905(0x3de))&&(logger['full'](_0x3ed905(0x351)+_0x46aa0f),stopBot(_0x46aa0f));config=getConfiguration(),io['to'](_0x3ed905(0x380))[_0x3ed905(0x359)]('bots',config),broadcastToBots(_0x3ed905(0x270),JSON[_0x3ed905(0x3cf)](config));}function toggleStatus(_0x39ea5f){const _0x5f2407=_0x459bb3;let _0x3e6a80=dbConfig[_0x5f2407(0x303)](_0x5f2407(0x270))[_0x5f2407(0x3d4)]({'botID':_0x39ea5f})[_0x5f2407(0x290)](),_0x3dc0ff;if(_0x3e6a80[_0x5f2407(0x2d3)]===_0x5f2407(0x25a))_0x3dc0ff=_0x5f2407(0x34c);else{if(_0x3e6a80[_0x5f2407(0x2d3)]===_0x5f2407(0x299))_0x3dc0ff='new-disabled';else{if(_0x3e6a80['status']===_0x5f2407(0x3de))_0x3dc0ff=_0x5f2407(0x299);else{if(_0x3e6a80['status']==='disabled')_0x3dc0ff=_0x5f2407(0x25a);}}}return _0x3dc0ff;}function updateStatus(_0x3a1a53,_0x13adac){const _0x14bbb9=_0x459bb3;dbConfig[_0x14bbb9(0x303)]('bots')[_0x14bbb9(0x3d4)]({'botID':_0x3a1a53})['assign']({'status':_0x13adac})['write'](),config=getConfiguration(),io['to'](_0x14bbb9(0x380))[_0x14bbb9(0x359)]('bots',config),broadcastToBots(_0x14bbb9(0x270),JSON['stringify'](config));}function updateLive(_0x43b696,_0xddf719){const _0x499489=_0x459bb3;dbConfig[_0x499489(0x303)](_0x499489(0x270))[_0x499489(0x3d4)]({'botID':_0x43b696})[_0x499489(0x212)]({'live':_0xddf719})[_0x499489(0x274)](),config=getConfiguration(),io['to'](_0x499489(0x380))[_0x499489(0x359)]('bots',config),broadcastToBots(_0x499489(0x270),JSON['stringify'](config));}function updateBotName(_0x5f2671,_0x519ac6){const _0x4f0e4c=_0x459bb3;dbConfig[_0x4f0e4c(0x303)](_0x4f0e4c(0x270))[_0x4f0e4c(0x3d4)]({'botID':_0x5f2671})['assign']({'botname':_0x519ac6})['write'](),config=getConfiguration(),io['to'](_0x4f0e4c(0x380))['emit'](_0x4f0e4c(0x270),config),broadcastToBots('bots',JSON[_0x4f0e4c(0x3cf)](config));}function updateBotManager(){const _0x53024a=_0x459bb3;config=getConfiguration(),io['to']('botmanager')[_0x53024a(0x359)](_0x53024a(0x270),config),broadcastToBots(_0x53024a(0x270),JSON[_0x53024a(0x3cf)](config));}function toggleBotMode(_0x364cdf){const _0x5215e9=_0x459bb3;if(pid[_0x364cdf])pid[_0x364cdf][_0x5215e9(0x250)]({'function':_0x5215e9(0x27e),'args':null});else{const _0x568cb0=configpath+_0x5215e9(0x307)+_0x364cdf+_0x5215e9(0x20c),_0x27d069=fs[_0x5215e9(0x2e9)](_0x568cb0),_0x19693a=JSON['parse'](_0x27d069),_0x16b045=_0x19693a['bot'][0x0][_0x5215e9(0x2f2)];_0x19693a[_0x5215e9(0x203)][0x0][_0x5215e9(0x2f2)]=!_0x16b045;const _0x1bc337=JSON[_0x5215e9(0x3cf)](_0x19693a,null,0x2);fs[_0x5215e9(0x393)](_0x568cb0,_0x1bc337),config=getConfiguration(),io['to'](_0x5215e9(0x380))[_0x5215e9(0x359)]('bots',config),broadcastToBots(_0x5215e9(0x270),JSON[_0x5215e9(0x3cf)](config));}}function validateTelegram(_0x18c59d){const _0x375660=_0x459bb3;if(_0x18c59d[_0x375660(0x2ce)]['username']!=settings[_0x375660(0x2ba)]&&'@'+_0x18c59d['from'][_0x375660(0x355)]!=settings[_0x375660(0x2ba)]||_0x18c59d['chat']['id']!=settings[_0x375660(0x1ee)])return sendTelegram(_0x18c59d[_0x375660(0x3c7)]['id'],_0x375660(0x2f4),{'parse_mode':_0x375660(0x322)}),![];return!![];}async function initTelegram(){const _0x2fa52e=_0x459bb3;tgBot&&(await tgBot[_0x2fa52e(0x295)](),await sleep(0x7d0));tgBot=new Telegraf(settings['telegramToken']);let _0x4c60bb=_0x2fa52e(0x245);_0x4c60bb+='\x0a',_0x4c60bb+=_0x2fa52e(0x342),_0x4c60bb+=_0x2fa52e(0x3cb),_0x4c60bb+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x4c60bb+=_0x2fa52e(0x237),_0x4c60bb+=_0x2fa52e(0x27d),_0x4c60bb+=_0x2fa52e(0x2b5),_0x4c60bb+=_0x2fa52e(0x371),_0x4c60bb+=_0x2fa52e(0x373),_0x4c60bb+=_0x2fa52e(0x262),_0x4c60bb+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x4c60bb+=_0x2fa52e(0x23d),_0x4c60bb+=_0x2fa52e(0x346),_0x4c60bb+=_0x2fa52e(0x24c),_0x4c60bb+=_0x2fa52e(0x3c4),_0x4c60bb+=_0x2fa52e(0x1d9),_0x4c60bb+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x22a79e=_0x2fa52e(0x2a6);_0x22a79e+='\x0a',_0x22a79e+=_0x4c60bb,tgBot[_0x2fa52e(0x2c0)]((_0x97dfaf,_0x3cb56b)=>{const _0x732e1e=_0x2fa52e;logger[_0x732e1e(0x28a)](getTimeStamp()+_0x732e1e(0x301)),logger[_0x732e1e(0x311)](_0x732e1e(0x2ad),_0x97dfaf);}),tgBot[_0x2fa52e(0x2c2)](async(_0x4a25c0,_0x4efaaf)=>{const _0x84156d=_0x2fa52e;if(settings['telegramChatId']||_0x4a25c0['update'][_0x84156d(0x205)][_0x84156d(0x1ec)]!=_0x84156d(0x36e)){if(!validateTelegram(_0x4a25c0))return;}_0x4efaaf();}),tgBot[_0x2fa52e(0x26a)](_0x2fa52e(0x38c),async _0x47b7b6=>{const _0x127b38=_0x2fa52e;if(_0x47b7b6[_0x127b38(0x2ce)]['username']==settings[_0x127b38(0x2ba)]||'@'+_0x47b7b6[_0x127b38(0x2ce)]['username']==settings[_0x127b38(0x2ba)]){if(!settings[_0x127b38(0x1ee)])updateSetting('telegramChatId',_0x47b7b6[_0x127b38(0x3c7)]['id']);else{if(!validateTelegram(_0x47b7b6))return;}}else{if(!validateTelegram(_0x47b7b6))return;}updateSetting(_0x127b38(0x3bb),!![]),await sendTelegram(_0x47b7b6[_0x127b38(0x3c7)]['id'],_0x22a79e);}),tgBot['command'](_0x2fa52e(0x3d0),async _0x4f0059=>{const _0x2b3a33=_0x2fa52e;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x4f0059[_0x2b3a33(0x3c7)]['id'],_0x2b3a33(0x32c));}),tgBot['command']('disable',async _0x362c7c=>{const _0x3d0fc1=_0x2fa52e;await sendTelegram(_0x362c7c[_0x3d0fc1(0x3c7)]['id'],_0x3d0fc1(0x2fe)),updateSetting('telegramEnabled',![]);}),tgBot['command'](_0x2fa52e(0x2fb),async _0x33813a=>{const _0x3fab48=_0x2fa52e,_0x3005b6=Markup[_0x3fab48(0x2a5)]([Markup[_0x3fab48(0x33e)][_0x3fab48(0x304)](_0x3fab48(0x221),'config_orders'),Markup[_0x3fab48(0x33e)][_0x3fab48(0x304)](_0x3fab48(0x20d),_0x3fab48(0x22f)),Markup[_0x3fab48(0x33e)][_0x3fab48(0x304)]('All','config_all')]);_0x33813a[_0x3fab48(0x317)](_0x3fab48(0x3f0),_0x3005b6);}),tgBot[_0x2fa52e(0x3b5)](_0x2fa52e(0x3eb),async _0x2ae15c=>{const _0x47a10d=_0x2fa52e;_0x2ae15c[_0x47a10d(0x3e2)](),updateSetting(_0x47a10d(0x22e),_0x47a10d(0x24d)),updateSetting(_0x47a10d(0x3bb),!![]),await sendTelegram(_0x2ae15c['chat']['id'],_0x47a10d(0x220));}),tgBot[_0x2fa52e(0x3b5)](_0x2fa52e(0x22f),async _0x43c61b=>{const _0x15da0c=_0x2fa52e;_0x43c61b[_0x15da0c(0x3e2)](),updateSetting(_0x15da0c(0x22e),'alerts'),updateSetting(_0x15da0c(0x3bb),!![]),await sendTelegram(_0x43c61b[_0x15da0c(0x3c7)]['id'],_0x15da0c(0x3a1));}),tgBot['action'](_0x2fa52e(0x2b1),async _0x56ac55=>{const _0x150908=_0x2fa52e;_0x56ac55[_0x150908(0x3e2)](),updateSetting(_0x150908(0x22e),_0x150908(0x305)),updateSetting(_0x150908(0x3bb),!![]),await sendTelegram(_0x56ac55[_0x150908(0x3c7)]['id'],_0x150908(0x341));}),tgBot[_0x2fa52e(0x26a)](_0x2fa52e(0x2d3),async _0x3e90e5=>{const _0x1dafed=_0x2fa52e,_0x1498c2=getBotsWithMode();let _0x3bd948=_0x1dafed(0x2fc);config[_0x1dafed(0x2ef)](_0x45c289=>{const _0x13568e=_0x1dafed,_0xf82484=_0x1498c2['find'](_0x4dc8db=>_0x4dc8db[_0x13568e(0x33f)]==_0x45c289[_0x13568e(0x33f)])[_0x13568e(0x353)];_0x3bd948+=_0x13568e(0x1d0)+_0x45c289[_0x13568e(0x33f)]+':\x20'+_0x45c289['status']+_0x13568e(0x344)+_0xf82484+_0x13568e(0x344)+_0x45c289[_0x13568e(0x277)]+'\x0a';}),_0x3bd948+='\x0a',_0x3bd948+=_0x1dafed(0x3e1),_0x3bd948+=!settings['telegramEnabled']?'Notifications\x20disabled\x0a':_0x1dafed(0x252),_0x3bd948+=settings['telegramEnabled']?settings[_0x1dafed(0x22e)]==_0x1dafed(0x305)?_0x1dafed(0x29a):'Notifications\x20types:\x20'+settings['telegramEvents']+_0x1dafed(0x2a4):'',await sendTelegram(_0x3e90e5['chat']['id'],_0x3bd948,{'parse_mode':_0x1dafed(0x322)});}),tgBot[_0x2fa52e(0x26a)]('restart',async _0x47ec8c=>{const _0x4e2882=_0x2fa52e,_0x1cce44=getEnabledBots();if(_0x1cce44['length']==0x0)await sendTelegram(_0x47ec8c[_0x4e2882(0x3c7)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1cce44['length']>0x1)_0x1cce44['push']({'botID':'all'});let _0x5497ad=[],_0x55b196=[];const _0x3c718d=_0x1cce44['length']%0x4==0x0||_0x1cce44['length']%0x4==0x3||_0x1cce44[_0x4e2882(0x30a)]%0x3==0x1?0x4:0x3;let _0x1da960=0x0;_0x1cce44['forEach']((_0x4b6db8,_0x21119a)=>{const _0x586943=_0x4e2882;if(_0x21119a%_0x3c718d==0x0)_0x55b196=[];_0x55b196[_0x586943(0x3b3)](Markup[_0x586943(0x33e)][_0x586943(0x304)](_0x4b6db8[_0x586943(0x33f)]==_0x586943(0x305)?'All\x20bots':_0x586943(0x1d0)+_0x4b6db8[_0x586943(0x33f)],'restart_'+_0x4b6db8[_0x586943(0x33f)])),_0x21119a%_0x3c718d==0x0&&(_0x5497ad[_0x1da960]=_0x55b196,_0x1da960++);});const _0x46f8cc=Markup['inlineKeyboard'](_0x5497ad);_0x47ec8c[_0x4e2882(0x317)](_0x4e2882(0x3ef),_0x46f8cc);}}),tgBot[_0x2fa52e(0x3b5)](/restart_(.+)/,async _0x2e9602=>{const _0x37522e=_0x2fa52e,_0x2193b0=_0x2e9602[_0x37522e(0x2a2)][0x1];_0x2e9602[_0x37522e(0x3e2)](),_0x2193b0==_0x37522e(0x305)?config[_0x37522e(0x2ef)](_0x2c786b=>{const _0x499943=_0x37522e;restartBot(_0x2c786b[_0x499943(0x33f)]);}):restartBot(_0x2193b0);}),tgBot[_0x2fa52e(0x26a)]('on',async _0x2fa556=>{const _0x1053cc=_0x2fa52e,_0xa91462=getDisabledBots();if(_0xa91462[_0x1053cc(0x30a)]==0x0)await sendTelegram(_0x2fa556[_0x1053cc(0x3c7)]['id'],_0x1053cc(0x374));else{if(_0xa91462['length']>0x1)_0xa91462[_0x1053cc(0x3b3)]({'botID':_0x1053cc(0x305)});let _0x1aa036=[],_0x8b1f98=[];const _0x1e9e56=_0xa91462[_0x1053cc(0x30a)]%0x4==0x0||_0xa91462[_0x1053cc(0x30a)]%0x4==0x3||_0xa91462[_0x1053cc(0x30a)]%0x3==0x1?0x4:0x3;let _0x5d82d2=0x0;_0xa91462[_0x1053cc(0x2ef)]((_0x73a4a6,_0x1d51f7)=>{const _0x4f0ac1=_0x1053cc;if(_0x1d51f7%_0x1e9e56==0x0)_0x8b1f98=[];_0x8b1f98[_0x4f0ac1(0x3b3)](Markup[_0x4f0ac1(0x33e)]['callback'](_0x73a4a6['botID']==_0x4f0ac1(0x305)?'All\x20bots':_0x4f0ac1(0x1d0)+_0x73a4a6[_0x4f0ac1(0x33f)],'on_'+_0x73a4a6[_0x4f0ac1(0x33f)])),_0x1d51f7%_0x1e9e56==0x0&&(_0x1aa036[_0x5d82d2]=_0x8b1f98,_0x5d82d2++);});const _0x8c70ae=Markup[_0x1053cc(0x2a5)](_0x1aa036);_0x2fa556['reply'](_0x1053cc(0x2b4),_0x8c70ae);}}),tgBot[_0x2fa52e(0x3b5)](/on_(.+)/,async _0x23b0f5=>{const _0x253871=_0x2fa52e,_0x47c6e5=_0x23b0f5['match'][0x1];_0x23b0f5[_0x253871(0x3e2)]();if(_0x47c6e5==_0x253871(0x305)){const _0x15eca8=getDisabledBots();await sendTelegram(_0x23b0f5[_0x253871(0x3c7)]['id'],_0x253871(0x25b)),_0x15eca8['forEach'](_0x6d843b=>{const _0x5978ee=_0x253871;if(_0x6d843b[_0x5978ee(0x33f)]!='all')toggleBot(_0x6d843b[_0x5978ee(0x33f)],toggleStatus(_0x6d843b['botID']),_0x5978ee(0x31f));});}else await sendTelegram(_0x23b0f5['chat']['id'],_0x253871(0x271)+_0x47c6e5),toggleBot(_0x47c6e5,toggleStatus(_0x47c6e5),'stopped');}),tgBot[_0x2fa52e(0x26a)](_0x2fa52e(0x382),async _0x344968=>{const _0x25ba81=_0x2fa52e,_0x298bf4=getEnabledBots();if(_0x298bf4[_0x25ba81(0x30a)]==0x0)await sendTelegram(_0x344968[_0x25ba81(0x3c7)]['id'],_0x25ba81(0x1fd));else{if(_0x298bf4[_0x25ba81(0x30a)]>0x1)_0x298bf4['push']({'botID':_0x25ba81(0x305)});let _0x12b993=[],_0x163e2c=[];const _0x1dba8b=_0x298bf4['length']%0x4==0x0||_0x298bf4[_0x25ba81(0x30a)]%0x4==0x3||_0x298bf4[_0x25ba81(0x30a)]%0x3==0x1?0x4:0x3;let _0x5f1692=0x0;_0x298bf4[_0x25ba81(0x2ef)]((_0x3df45d,_0x28938a)=>{const _0x3f5b9b=_0x25ba81;if(_0x28938a%_0x1dba8b==0x0)_0x163e2c=[];_0x163e2c[_0x3f5b9b(0x3b3)](Markup['button'][_0x3f5b9b(0x304)](_0x3df45d[_0x3f5b9b(0x33f)]=='all'?_0x3f5b9b(0x1f4):_0x3f5b9b(0x1d0)+_0x3df45d[_0x3f5b9b(0x33f)],_0x3f5b9b(0x398)+_0x3df45d[_0x3f5b9b(0x33f)])),_0x28938a%_0x1dba8b==0x0&&(_0x12b993[_0x5f1692]=_0x163e2c,_0x5f1692++);});const _0x2cdc31=Markup[_0x25ba81(0x2a5)](_0x12b993);_0x344968['reply'](_0x25ba81(0x3ab),_0x2cdc31);}}),tgBot[_0x2fa52e(0x3b5)](/off_(.+)/,async _0x44e3ff=>{const _0x18568d=_0x2fa52e,_0x34241f=_0x44e3ff[_0x18568d(0x2a2)][0x1];_0x44e3ff[_0x18568d(0x3e2)]();if(_0x34241f==_0x18568d(0x305)){const _0x23b96a=getEnabledBots();await sendTelegram(_0x44e3ff['chat']['id'],_0x18568d(0x2a0)),_0x23b96a['forEach'](_0x19f8e5=>{const _0x568c6b=_0x18568d;if(_0x19f8e5[_0x568c6b(0x33f)]!=_0x568c6b(0x305))toggleBot(_0x19f8e5[_0x568c6b(0x33f)],toggleStatus(_0x19f8e5[_0x568c6b(0x33f)]),_0x568c6b(0x31f));});}else await sendTelegram(_0x44e3ff[_0x18568d(0x3c7)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x34241f),toggleBot(_0x34241f,toggleStatus(_0x34241f),'stopped');}),tgBot[_0x2fa52e(0x26a)]('metrics',async _0x45580c=>{const _0x46958c=_0x2fa52e,_0x2ccbd7=getEnabledBots();if(_0x2ccbd7['length']==0x0)await sendTelegram(_0x45580c['chat']['id'],_0x46958c(0x1fd));else{if(_0x2ccbd7[_0x46958c(0x30a)]>0x1){let _0x341e4b=[],_0x2fa05a=[];const _0x37629a=_0x2ccbd7[_0x46958c(0x30a)]%0x4==0x0||_0x2ccbd7[_0x46958c(0x30a)]%0x4==0x3||_0x2ccbd7[_0x46958c(0x30a)]%0x3==0x1?0x4:0x3;let _0x400d97=0x0;_0x2ccbd7[_0x46958c(0x2ef)]((_0x4a7159,_0x13b3a0)=>{const _0x3c2f00=_0x46958c;if(_0x13b3a0%_0x37629a==0x0)_0x2fa05a=[];_0x2fa05a['push'](Markup[_0x3c2f00(0x33e)][_0x3c2f00(0x304)](_0x3c2f00(0x1d0)+_0x4a7159[_0x3c2f00(0x33f)],_0x3c2f00(0x21f)+_0x4a7159['botID'])),_0x13b3a0%_0x37629a==0x0&&(_0x341e4b[_0x400d97]=_0x2fa05a,_0x400d97++);});const _0xa1a9b2=Markup[_0x46958c(0x2a5)](_0x341e4b);_0x45580c[_0x46958c(0x317)](_0x46958c(0x2fd),_0xa1a9b2);}else{const _0xa0cd0e=_0x2ccbd7[0x0][_0x46958c(0x33f)];if(pid[_0xa0cd0e])pid[_0xa0cd0e][_0x46958c(0x250)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x2fa52e(0x3b5)](/metrics_(.+)/,async _0x4315b6=>{const _0xe01e60=_0x2fa52e,_0x387a7c=_0x4315b6[_0xe01e60(0x2a2)][0x1];_0x4315b6[_0xe01e60(0x3e2)]();if(pid[_0x387a7c])pid[_0x387a7c][_0xe01e60(0x250)]({'function':_0xe01e60(0x390),'args':null});}),tgBot[_0x2fa52e(0x26a)](_0x2fa52e(0x1cf),async _0x16468a=>{const _0x175939=_0x2fa52e,_0x46411a=getEnabledBots();if(_0x46411a[_0x175939(0x30a)]==0x0)await sendTelegram(_0x16468a[_0x175939(0x3c7)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x46411a[_0x175939(0x30a)]>0x1){let _0x22ce3c=[],_0x288912=[];const _0x51b352=_0x46411a['length']%0x4==0x0||_0x46411a[_0x175939(0x30a)]%0x4==0x3||_0x46411a[_0x175939(0x30a)]%0x3==0x1?0x4:0x3;let _0x392233=0x0;_0x46411a[_0x175939(0x2ef)]((_0x1978bd,_0x4a9e73)=>{const _0x196cf3=_0x175939;if(_0x4a9e73%_0x51b352==0x0)_0x288912=[];_0x288912[_0x196cf3(0x3b3)](Markup['button'][_0x196cf3(0x304)](_0x196cf3(0x1d0)+_0x1978bd[_0x196cf3(0x33f)],_0x196cf3(0x326)+_0x1978bd['botID'])),_0x4a9e73%_0x51b352==0x0&&(_0x22ce3c[_0x392233]=_0x288912,_0x392233++);});const _0x47b15f=Markup['inlineKeyboard'](_0x22ce3c);_0x16468a[_0x175939(0x317)](_0x175939(0x28f),_0x47b15f);}else{const _0xed6843=_0x46411a[0x0][_0x175939(0x33f)];if(pid[_0xed6843])pid[_0xed6843][_0x175939(0x250)]({'function':_0x175939(0x3ca),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x1de155=>{const _0x16a2af=_0x2fa52e,_0x2c5324=_0x1de155[_0x16a2af(0x2a2)][0x1];_0x1de155[_0x16a2af(0x3e2)]();if(pid[_0x2c5324])pid[_0x2c5324][_0x16a2af(0x250)]({'function':_0x16a2af(0x3ca),'args':null});}),tgBot[_0x2fa52e(0x26a)](_0x2fa52e(0x364),async _0x1b2d66=>{const _0xe9d76f=_0x2fa52e,_0x4a767b=_0xe9d76f(0x364);await zipFiles(_0x4a767b);const _0x2afc19=zippath+(_0x4a767b+'.zip');_0x1b2d66[_0xe9d76f(0x2af)]({'source':_0x2afc19})[_0xe9d76f(0x1ea)](()=>{})[_0xe9d76f(0x2c0)](_0x3fa03e=>logger[_0xe9d76f(0x311)](_0xe9d76f(0x3dd)+_0x4a767b+_0xe9d76f(0x350),_0x3fa03e));}),tgBot[_0x2fa52e(0x26a)](_0x2fa52e(0x300),async _0x1ead1e=>{const _0x3bef5b=_0x2fa52e,_0x4ab09=_0x3bef5b(0x300);await backupConfigFiles(),await zipFiles(_0x4ab09);const _0x4f6e15=zippath+(_0x4ab09+_0x3bef5b(0x1f0));_0x1ead1e[_0x3bef5b(0x2af)]({'source':_0x4f6e15})[_0x3bef5b(0x1ea)](()=>{})[_0x3bef5b(0x2c0)](_0x4a6556=>logger[_0x3bef5b(0x311)](_0x3bef5b(0x3dd)+_0x4ab09+_0x3bef5b(0x350),_0x4a6556));}),tgBot[_0x2fa52e(0x26a)](_0x2fa52e(0x34a),async _0x431587=>{const _0x1ecac5=_0x2fa52e;await getMessages();if(!updateAvailable)await sendTelegram(_0x431587['chat']['id'],_0x1ecac5(0x399));else{if(!validInstallation)await sendTelegram(_0x431587[_0x1ecac5(0x3c7)]['id'],_0x1ecac5(0x287));else{const _0x24b592=Markup['inlineKeyboard']([Markup[_0x1ecac5(0x33e)][_0x1ecac5(0x304)]('Yes',_0x1ecac5(0x241)),Markup[_0x1ecac5(0x33e)][_0x1ecac5(0x304)]('No',_0x1ecac5(0x2a3))]);_0x431587[_0x1ecac5(0x317)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x24b592);}}}),tgBot[_0x2fa52e(0x3b5)](/update_(.+)/,async _0xc2b3bf=>{const _0x481d7b=_0x2fa52e,_0x5212de=_0xc2b3bf[_0x481d7b(0x2a2)][0x1];_0xc2b3bf[_0x481d7b(0x3e2)](),_0x5212de==_0x481d7b(0x310)&&(await sendTelegram(_0xc2b3bf['chat']['id'],_0x481d7b(0x34e)),updateBB(_0x481d7b(0x34a))),_0x5212de=='no'&&await sendTelegram(_0xc2b3bf[_0x481d7b(0x3c7)]['id'],_0x481d7b(0x223));}),tgBot['command']('reinstall',async _0x256afd=>{const _0x246545=_0x2fa52e;if(!validInstallation)await sendTelegram(_0x256afd[_0x246545(0x3c7)]['id'],_0x246545(0x319));else{const _0x32f2f2=Markup[_0x246545(0x2a5)]([Markup[_0x246545(0x33e)]['callback']('Yes','reinstall_yes'),Markup[_0x246545(0x33e)]['callback']('No',_0x246545(0x2d4))]);_0x256afd[_0x246545(0x317)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x32f2f2);}}),tgBot[_0x2fa52e(0x3b5)](/reinstall_(.+)/,async _0xc490d4=>{const _0x3bbb22=_0x2fa52e,_0x4cfed5=_0xc490d4[_0x3bbb22(0x2a2)][0x1];_0xc490d4['editMessageReplyMarkup'](),_0x4cfed5==_0x3bbb22(0x310)&&(await sendTelegram(_0xc490d4[_0x3bbb22(0x3c7)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB('reinstall')),_0x4cfed5=='no'&&await sendTelegram(_0xc490d4['chat']['id'],_0x3bbb22(0x2d6));}),tgBot[_0x2fa52e(0x26a)](_0x2fa52e(0x25e),async _0x22b3be=>{const _0x538d6b=_0x2fa52e,_0x401af0=getBotsWithMode();if(_0x401af0[_0x538d6b(0x30a)]==0x0)await sendTelegram(_0x22b3be[_0x538d6b(0x3c7)]['id'],_0x538d6b(0x1fd));else{let _0x3fc1d1=[],_0x5cc769=[];const _0x3bcc4f=0x2;let _0x2dcdad=0x0;_0x401af0[_0x538d6b(0x2ef)]((_0x1e7e9f,_0x32e1e6)=>{const _0x44c970=_0x538d6b;if(_0x32e1e6%_0x3bcc4f==0x0)_0x5cc769=[];_0x5cc769['push'](Markup[_0x44c970(0x33e)][_0x44c970(0x304)](_0x44c970(0x1d0)+_0x1e7e9f[_0x44c970(0x33f)]+'\x20('+_0x1e7e9f['mode']+')',_0x44c970(0x347)+_0x1e7e9f[_0x44c970(0x33f)])),_0x32e1e6%_0x3bcc4f==0x0&&(_0x3fc1d1[_0x2dcdad]=_0x5cc769,_0x2dcdad++);});const _0x52e32b=Markup[_0x538d6b(0x2a5)](_0x3fc1d1);_0x22b3be[_0x538d6b(0x317)](_0x538d6b(0x20b),_0x52e32b);}}),tgBot[_0x2fa52e(0x3b5)](/toggle_(.+)/,async _0x3dd817=>{const _0x295837=_0x2fa52e,_0x3ddbf6=_0x3dd817['match'][0x1];_0x3dd817[_0x295837(0x3e2)]();const _0x3dd705=getBotsWithMode(),_0x3bb419=_0x3dd705[_0x295837(0x3d4)](_0x19b7b4=>_0x19b7b4['botID']==_0x3ddbf6),_0x51ab83=_0x3bb419[_0x295837(0x353)]=='auto'?_0x295837(0x38a):_0x295837(0x294);await sendTelegram(_0x3dd817[_0x295837(0x3c7)]['id'],_0x295837(0x39f)+_0x3ddbf6+'\x20to\x20'+_0x51ab83+_0x295837(0x23c)),toggleBotMode(_0x3ddbf6);}),tgBot[_0x2fa52e(0x26a)]('names',async _0x73e6f2=>{const _0x2b46bd=_0x2fa52e;let _0x20477c='';config[_0x2b46bd(0x2ef)](_0x15c827=>{const _0x4fcc18=_0x2b46bd;_0x20477c+=_0x4fcc18(0x1d0)+_0x15c827[_0x4fcc18(0x33f)]+':\x20'+_0x15c827['botname']+'\x0a';}),await sendTelegram(_0x73e6f2['chat']['id'],_0x20477c,{'parse_mode':_0x2b46bd(0x322)});}),tgBot[_0x2fa52e(0x26a)]('help',async _0x16b068=>{const _0x3348cb=_0x2fa52e;await sendTelegram(_0x16b068[_0x3348cb(0x3c7)]['id'],_0x4c60bb);}),process['once'](_0x2fa52e(0x365),()=>tgBot[_0x2fa52e(0x295)]('SIGINT')),process[_0x2fa52e(0x279)](_0x2fa52e(0x26b),()=>tgBot[_0x2fa52e(0x295)](_0x2fa52e(0x26b))),tgBot[_0x2fa52e(0x2d7)]();}function disableTelegram(){const _0x32655c=_0x459bb3;tgBot&&tgBot[_0x32655c(0x295)]();}async function sendTelegram(_0x1812bf,_0xf85abd,_0x297425){const _0x1ce416=_0x459bb3;_0x297425={..._0x297425,'disable_web_page_preview':!![]};try{await tgBot[_0x1ce416(0x39e)]['sendMessage'](_0x1812bf,_0xf85abd,_0x297425);}catch(_0x38f79b){logger[_0x1ce416(0x311)](_0x1ce416(0x24f),_0x38f79b);}}async function sendTelegramBot(_0x49ac92,_0x461e1b){const _0x21be48=_0x459bb3;if(settings[_0x21be48(0x3bb)]){if(settings['telegramEvents']==_0x21be48(0x305)||(_0x461e1b[_0x21be48(0x1d6)]=='error'||_0x461e1b[_0x21be48(0x1d6)]==_0x21be48(0x248)||_0x461e1b[_0x21be48(0x1d6)]==_0x21be48(0x3d7))&&settings[_0x21be48(0x22e)]==_0x21be48(0x1f1)||_0x461e1b[_0x21be48(0x1d6)]=='order'&&settings[_0x21be48(0x22e)]=='orders'){if(tgBot&&settings[_0x21be48(0x1ee)]){if(_0x461e1b[_0x21be48(0x269)])await sendTelegram(settings[_0x21be48(0x1ee)],_0x461e1b[_0x21be48(0x27a)]+_0x21be48(0x2ac)+_0x461e1b[_0x21be48(0x27f)]);else await sendTelegram(settings[_0x21be48(0x1ee)],_0x21be48(0x1d0)+_0x49ac92+'\x20>\x20'+_0x461e1b['event']);}}}}async function sendTelegramMsg(_0x3a2e57,_0x46c2b7='HTML'){const _0x4c4e92=_0x459bb3;return settings[_0x4c4e92(0x3bb)]&&tgBot&&settings[_0x4c4e92(0x1ee)]?(await sendTelegram(settings[_0x4c4e92(0x1ee)],_0x3a2e57,{'parse_mode':_0x46c2b7}),!![]):![];}function getDeviceWithIp(_0x3bd552){const _0x44558f=_0x459bb3;return devices[_0x44558f(0x3d4)](_0x103762=>_0x103762['ip']===_0x3bd552);}async function temporaryAccess2FA(_0x632a8d,_0x3be92c){const _0x1173e3=_0x459bb3;let _0x1d16c6=new Date(),_0x17f5c3=![];if(lastIpApproval){if(_0x1d16c6-lastIpApproval<0x1388)_0x17f5c3=!![];}lastIpApproval=new Date();if(_0x17f5c3)return;if(tgBot&&settings['telegramChatId']){const _0x5e3f1b=uuidRandom();tmpStorage[_0x5e3f1b]={'uuid':_0x632a8d,'externalip':_0x3be92c};const _0x29e9cd=Markup['inlineKeyboard']([Markup[_0x1173e3(0x33e)][_0x1173e3(0x304)](_0x1173e3(0x2e5),_0x1173e3(0x24a)+_0x5e3f1b),Markup['button']['callback'](_0x1173e3(0x325),_0x1173e3(0x336)+_0x5e3f1b),Markup[_0x1173e3(0x33e)][_0x1173e3(0x304)](_0x1173e3(0x328),_0x1173e3(0x3ee)+_0x5e3f1b),Markup[_0x1173e3(0x33e)][_0x1173e3(0x304)]('reject',_0x1173e3(0x34b)+_0x5e3f1b)]);await sendTelegram(settings[_0x1173e3(0x1ee)],_0x1173e3(0x3e6)+normalizeIP(_0x3be92c)[_0x1173e3(0x3b1)]+'\x20?',_0x29e9cd),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x20edd7=>{const _0xe51df9=_0x1173e3,_0x232c49=_0x20edd7[_0xe51df9(0x2a2)][0x1],_0x34b1d2=_0x20edd7[_0xe51df9(0x2a2)][0x2],{uuid:_0x40ea16,externalip:_0x2b6f1e}=tmpStorage[_0x34b1d2];delete tmpStorage[_0x34b1d2],_0x20edd7['editMessageReplyMarkup'](),devices[_0x40ea16]['telegramIpApproval']={'clientip':_0x2b6f1e,'timestamp':new Date()['getTime'](),'expiry':_0x232c49},_0x232c49!=_0xe51df9(0x26f)?(await sendTelegram(_0x20edd7[_0xe51df9(0x3c7)]['id'],_0xe51df9(0x246)+_0x232c49+_0xe51df9(0x39b),{'parse_mode':_0xe51df9(0x322)}),io['to'](_0x40ea16)[_0xe51df9(0x359)](_0xe51df9(0x2d3),{'access':{'allow':![],'reason':_0xe51df9(0x2a1),'token':null}})):(await sendTelegram(_0x20edd7[_0xe51df9(0x3c7)]['id'],_0xe51df9(0x306)),io['to'](_0x40ea16)[_0xe51df9(0x359)](_0xe51df9(0x2d3),{'access':{'allow':![],'reason':_0xe51df9(0x330),'token':null}}));});}}async function loginAccess2FA(_0x4288ee,_0x33efb3){const _0x4c08bf=_0x459bb3;if(tgBot&&settings[_0x4c08bf(0x1ee)]){const _0x5a0d04=uuidRandom();tmpStorage[_0x5a0d04]={'uuid':_0x4288ee,'externalip':_0x33efb3};const _0x5d2193=Markup[_0x4c08bf(0x2a5)]([Markup[_0x4c08bf(0x33e)][_0x4c08bf(0x304)](_0x4c08bf(0x224),_0x4c08bf(0x369)+loginExpiry+'_'+_0x5a0d04),Markup[_0x4c08bf(0x33e)]['callback'](_0x4c08bf(0x26f),_0x4c08bf(0x2c7)+_0x5a0d04)]);await sendTelegram(settings['telegramChatId'],_0x4c08bf(0x25d)+normalizeIP(_0x33efb3)['show']+'\x20?',_0x5d2193),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x2e62be=>{const _0x518684=_0x4c08bf,_0x1ba6a4=_0x2e62be[_0x518684(0x2a2)][0x1],_0x284dfd=_0x2e62be[_0x518684(0x2a2)][0x2],{uuid:_0x1d5eaf,externalip:_0x44339b}=tmpStorage[_0x284dfd];delete tmpStorage[_0x284dfd],_0x2e62be[_0x518684(0x3e2)](),devices[_0x1d5eaf]['telegram2FaApproval']={'clientip':_0x44339b,'timestamp':new Date()[_0x518684(0x3d1)](),'expiry':_0x1ba6a4},_0x1ba6a4!=_0x518684(0x26f)?(await sendTelegram(_0x2e62be[_0x518684(0x3c7)]['id'],_0x518684(0x1d3),{'parse_mode':_0x518684(0x322)}),io['to'](_0x1d5eaf)[_0x518684(0x359)]('status',{'access':{'allow':![],'reason':_0x518684(0x2a1),'token':null}})):(await sendTelegram(_0x2e62be[_0x518684(0x3c7)]['id'],_0x518684(0x381)),io['to'](_0x1d5eaf)['emit']('status',{'access':{'allow':![],'reason':_0x518684(0x3e0),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x9d4607=_0x459bb3;return dbConfig[_0x9d4607(0x303)](_0x9d4607(0x270))[_0x9d4607(0x34f)](_0x9d4607(0x33f))['filter']({'status':'enabled'})['value']()||[];}function getDisabledBots(){const _0x47fac1=_0x459bb3;return dbConfig[_0x47fac1(0x303)](_0x47fac1(0x270))['sortBy']('botID')[_0x47fac1(0x22b)]({'status':_0x47fac1(0x34c)})[_0x47fac1(0x290)]()||[];}function getBotAttributes(_0xb44e23){const _0x2ea4ad=_0x459bb3;let _0x401233={};const _0x8fd08b=configpath+_0x2ea4ad(0x307)+_0xb44e23+_0x2ea4ad(0x20c),_0x642398=fs['existsSync'](_0x8fd08b);if(_0x642398){const _0x19393b=fs['readFileSync'](_0x8fd08b);try{const _0x20adfb=JSON[_0x2ea4ad(0x2b0)](_0x19393b),_0x2f648b=_0x20adfb?_0x20adfb['bot'][0x0][_0x2ea4ad(0x2f2)]:![];_0x401233['mode']=_0x2f648b?'auto':_0x2ea4ad(0x38a),_0x401233[_0x2ea4ad(0x27a)]=_0x20adfb?_0x20adfb['bot'][0x0]['botname']:_0x2ea4ad(0x1d0)+_0xb44e23;}catch(_0x88ee5d){_0x401233[_0x2ea4ad(0x353)]=_0x2ea4ad(0x38a),_0x401233[_0x2ea4ad(0x27a)]=_0x2ea4ad(0x1d0)+_0xb44e23;}}else _0x401233['mode']=_0x2ea4ad(0x38a),_0x401233[_0x2ea4ad(0x27a)]='Bot\x20'+_0xb44e23;return _0x401233;}function getBotsWithMode(){const _0x36762f=_0x459bb3,_0x4a5ddf=dbConfig[_0x36762f(0x303)]('bots')[_0x36762f(0x34f)](_0x36762f(0x33f))['value']()||[];return _0x4a5ddf[_0x36762f(0x2ef)](_0x2cf2fc=>{const _0x5ce94d=_0x36762f;let _0x352d55=getBotAttributes(_0x2cf2fc[_0x5ce94d(0x33f)]);_0x2cf2fc['mode']=_0x352d55[_0x5ce94d(0x353)];}),_0x4a5ddf;}function getBotExchanges(){const _0x46b6e1=_0x459bb3;let _0xf686eb=[];const _0x3c0f2b=dbConfig[_0x46b6e1(0x303)](_0x46b6e1(0x270))[_0x46b6e1(0x34f)](_0x46b6e1(0x33f))[_0x46b6e1(0x290)]()||[];_0x3c0f2b[_0x46b6e1(0x2ef)](_0x3d0a5a=>{const _0x198da0=_0x46b6e1;if(_0x3d0a5a[_0x198da0(0x2d3)]==_0x198da0(0x25a)){const _0x3ced82=configpath+_0x198da0(0x307)+_0x3d0a5a[_0x198da0(0x33f)]+_0x198da0(0x20c),_0x213dcd=fs[_0x198da0(0x1f5)](_0x3ced82);let _0x5e0811;if(_0x213dcd){const _0x4ec6c0=fs['readFileSync'](_0x3ced82);try{const _0x530a88=JSON[_0x198da0(0x2b0)](_0x4ec6c0);_0x5e0811=_0x530a88?_0x530a88[_0x198da0(0x203)][0x0]['exchange']:null;}catch(_0x2f7446){}}if(_0x5e0811)_0xf686eb[_0x198da0(0x3b3)](_0x5e0811);}});const _0x55b1eb=[...new Set(_0xf686eb)][_0x46b6e1(0x33b)]();return _0x55b1eb;}async function initUser(){const _0x575351=_0x459bb3;if(!settings['userid']){const _0x2505f0=uuidRandom();mixpanel[_0x575351(0x222)](_0x2505f0),updateSetting(_0x575351(0x3c8),_0x2505f0);}}async function initSecure(){const _0x1da41f=_0x459bb3;let _0x1a78d0=getSecure();if(!_0x1a78d0[_0x1da41f(0x2f0)](_0x1da41f(0x2c9))){let _0x130d7e=await generateKeys();_0x1a78d0[_0x1da41f(0x349)]=_0x130d7e[_0x1da41f(0x349)],_0x1a78d0['privateKey']=_0x130d7e[_0x1da41f(0x356)],_0x1a78d0['secret']=crypto['randomBytes'](0x20)[_0x1da41f(0x2bf)](_0x1da41f(0x2f7));;storeSecure(_0x1a78d0);}}function getSettings(){const _0x102743=_0x459bb3;return dbSettings[_0x102743(0x303)](_0x102743(0x3dc))[_0x102743(0x290)]()||{};}function getSecure(){const _0x889b08=_0x459bb3;return dbSecure[_0x889b08(0x303)]('secure')['value']()||{};}function getBlacklist(){const _0x3b74eb=_0x459bb3;return dbSecure[_0x3b74eb(0x303)](_0x3b74eb(0x298))[_0x3b74eb(0x290)]()||[];}function broadcastToBots(_0x7c63ff,_0x56b6c5){const _0xe97c28=_0x459bb3;config[_0xe97c28(0x2ef)](_0x8fd93c=>{const _0x5f58ab=_0xe97c28;if(_0x8fd93c[_0x5f58ab(0x2d3)]==_0x5f58ab(0x25a)&&_0x8fd93c['live']==_0x5f58ab(0x232)||_0x8fd93c[_0x5f58ab(0x2d3)]==_0x5f58ab(0x299)&&_0x8fd93c['live']==_0x5f58ab(0x232)){if(pid[_0x8fd93c[_0x5f58ab(0x33f)]])pid[_0x8fd93c[_0x5f58ab(0x33f)]][_0x5f58ab(0x250)]({[_0x7c63ff]:_0x56b6c5});}});}async function storeSettings(_0xa5d8cd,_0x4b104b=![]){const _0x211a9e=_0x459bb3;_0xa5d8cd={...settings,..._0xa5d8cd};if(_0x4b104b&&_0xa5d8cd[_0x211a9e(0x385)]!=_0x211a9e(0x3a3)&&_0xa5d8cd['bbPassword']!=_0x211a9e(0x324)&&_0xa5d8cd['bbPassword']!=''){const _0x125c8f=decryptRSA(secure[_0x211a9e(0x356)],_0xa5d8cd[_0x211a9e(0x385)])[_0x211a9e(0x36d)](_0x211a9e(0x3c1))[0x0],_0x4c17e3=bcrypt[_0x211a9e(0x3b8)](_0x125c8f,saltRounds);_0xa5d8cd={..._0xa5d8cd,'bbPassword':_0x4c17e3};}if(_0x4b104b&&_0xa5d8cd['telegramToken']!=_0x211a9e(0x3a3)&&_0xa5d8cd[_0x211a9e(0x3d6)]!=_0x211a9e(0x324)&&_0xa5d8cd[_0x211a9e(0x3d6)]!=''){const _0x621c8d=decryptRSA(secure[_0x211a9e(0x356)],_0xa5d8cd[_0x211a9e(0x3d6)])[_0x211a9e(0x36d)](_0x211a9e(0x3c1))[0x0];_0xa5d8cd={..._0xa5d8cd,'telegramToken':_0x621c8d};}if(_0x4b104b&&_0xa5d8cd[_0x211a9e(0x32d)]!='************'&&_0xa5d8cd[_0x211a9e(0x32d)]!=_0x211a9e(0x324)&&_0xa5d8cd[_0x211a9e(0x32d)]!=''){const _0x34e071=decryptRSA(secure[_0x211a9e(0x356)],_0xa5d8cd[_0x211a9e(0x32d)])[_0x211a9e(0x36d)](_0x211a9e(0x3c1))[0x0];_0xa5d8cd={..._0xa5d8cd,'marketcapApi':_0x34e071};}const _0x22ef75=_0xa5d8cd['telegramToken']!=_0x211a9e(0x3a3)&&_0xa5d8cd[_0x211a9e(0x3d6)]!=settings['telegramToken']||_0xa5d8cd[_0x211a9e(0x2ba)]!=settings[_0x211a9e(0x2ba)],_0x381f71=_0xa5d8cd[_0x211a9e(0x3d6)]==''||_0xa5d8cd[_0x211a9e(0x2ba)]=='',_0x3df452=_0xa5d8cd[_0x211a9e(0x32d)]&&_0xa5d8cd[_0x211a9e(0x32d)]!=_0x211a9e(0x3a3)&&_0xa5d8cd[_0x211a9e(0x32d)]!=settings[_0x211a9e(0x32d)];_0x22ef75&&(_0xa5d8cd[_0x211a9e(0x1ee)]=null,_0xa5d8cd['telegramEvents']=_0x211a9e(0x305));for(const [_0x34d0bb,_0x16178b]of Object[_0x211a9e(0x37b)](_0xa5d8cd)){if(_0x34d0bb==_0x211a9e(0x3d6)&&_0x16178b==_0x211a9e(0x3a3)){_0xa5d8cd[_0x211a9e(0x3d6)]=settings[_0x211a9e(0x3d6)];continue;};if(_0x34d0bb==_0x211a9e(0x385)&&_0x16178b==_0x211a9e(0x3a3)){_0xa5d8cd['bbPassword']=settings[_0x211a9e(0x385)];continue;};if(_0x34d0bb==_0x211a9e(0x32d)&&_0x16178b==_0x211a9e(0x3a3)){_0xa5d8cd[_0x211a9e(0x32d)]=settings[_0x211a9e(0x32d)];continue;};dbSettings['set'](_0x211a9e(0x338)+_0x34d0bb,_0x16178b)[_0x211a9e(0x274)]();}settings=_0xa5d8cd,io['to']('botmanager')[_0x211a9e(0x359)]('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x211a9e(0x225)]),broadcastToBots('onepagemode',settings['onepagemode']),broadcastToBots(_0x211a9e(0x32d),settings['marketcapApi']);if(_0x22ef75&&!_0x381f71)initTelegram();_0x22ef75&&_0x381f71&&(updateSetting(_0x211a9e(0x1ee),null),disableTelegram()),getAllClients()[_0x211a9e(0x2ef)](_0x5d6d06=>{const _0x4181d8=_0x211a9e;getSocket(_0x5d6d06['id'])['emit'](_0x4181d8(0x2d3),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x3df452&&(await sleep(0xbb8),testMarketcapApi(_0xa5d8cd[_0x211a9e(0x32d)]));}async function testMarketcapApi(_0x5de753){const _0x53aa60=_0x459bb3,_0x20584c=[_0x53aa60(0x24b),_0x53aa60(0x1ff)];try{await axios['get'](_0x53aa60(0x266),{'headers':{'X-CMC_PRO_API_KEY':_0x5de753},'params':{'symbol':_0x20584c[_0x53aa60(0x2bf)]()}});}catch(_0x5a136b){_0x5a136b[_0x53aa60(0x2bf)]()[_0x53aa60(0x201)](_0x53aa60(0x3e9))?(io['to'](_0x53aa60(0x380))[_0x53aa60(0x359)](_0x53aa60(0x3a4),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x53aa60(0x2cd)](_0x53aa60(0x3b9))):(io['to'](_0x53aa60(0x380))['emit'](_0x53aa60(0x3a4),_0x53aa60(0x36b)),logger[_0x53aa60(0x2cd)](_0x53aa60(0x36b)),logger[_0x53aa60(0x311)](_0x53aa60(0x30e),_0x5a136b[_0x53aa60(0x2bf)]()+'\x20-\x20'+_0x5a136b[_0x53aa60(0x31d)]));return;}logger['debug']('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x1f9a19,_0xc4d07c){const _0x49b7e4=_0x459bb3;dbSettings[_0x49b7e4(0x379)](_0x49b7e4(0x338)+_0x1f9a19,_0xc4d07c)[_0x49b7e4(0x274)](),settings=getSettings(),io['to'](_0x49b7e4(0x380))['emit'](_0x49b7e4(0x3dc),cleanSettings());}function storeSecure(_0x2a2f42){const _0x3b437c=_0x459bb3;dbSecure['get'](_0x3b437c(0x234))[_0x3b437c(0x3b3)](_0x2a2f42)['write'](),secure=_0x2a2f42;}function addBlacklist(_0x2d7d68){const _0x468fbc=_0x459bb3;cleanBlacklist();let _0x19dd75;devices[_0x2d7d68][_0x468fbc(0x1df)]?_0x19dd75=Math['max'](devices[_0x2d7d68]['telegramIpApproval'][_0x468fbc(0x2f5)],loginExpiry):_0x19dd75=loginExpiry,dbSecure[_0x468fbc(0x303)]('blacklist')[_0x468fbc(0x3b3)]({'expiry':new Date()[_0x468fbc(0x3d1)]()+_0x19dd75*0x3c*0x3e8,'token':devices[_0x2d7d68]['access'][_0x468fbc(0x1e7)]})[_0x468fbc(0x274)](),blacklist=dbSecure[_0x468fbc(0x303)]('blacklist')[_0x468fbc(0x290)]();}function cleanBlacklist(){const _0x2b43ab=_0x459bb3;let _0x3b50da=dbSecure['get'](_0x2b43ab(0x298))[_0x2b43ab(0x1fa)]()[_0x2b43ab(0x290)](),_0x3dec20=new Date()[_0x2b43ab(0x3d1)]();_0x3b50da[_0x2b43ab(0x2ef)](_0x13fa97=>{const _0x15bf45=_0x2b43ab;_0x13fa97[_0x15bf45(0x2f5)]<_0x3dec20&&dbSecure[_0x15bf45(0x303)]('blacklist')[_0x15bf45(0x329)]({'expiry':_0x13fa97[_0x15bf45(0x2f5)]})[_0x15bf45(0x274)]();});}function initStates(){const _0xae971e=_0x459bb3;let _0x14d29f=getConfiguration();_0x14d29f[_0xae971e(0x2ef)](_0x2d2160=>{const _0x567491=_0xae971e;_0x2d2160[_0x567491(0x277)]='stopped';}),storeConfiguration(_0x14d29f);}async function generateKeys(){const _0x548d89=_0x459bb3,_0x5aabfb=forge['pki']['rsa']['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x5d2491=forge['pki'][_0x548d89(0x39a)](_0x5aabfb['privateKey']),_0x15313f=forge['pki'][_0x548d89(0x25f)](_0x5aabfb[_0x548d89(0x349)]);return{'privateKey':_0x5d2491,'publicKey':_0x15313f};}async function oneTimeMigration(){const _0x9547c4=_0x459bb3;let _0x40b811=getSettings(),_0x22752d=![];!_0x40b811[_0x9547c4(0x2f0)]('lastmsgtelegram')&&(_0x40b811[_0x9547c4(0x2a8)]=0x0,_0x22752d=!![]);!_0x40b811[_0x9547c4(0x2f0)](_0x9547c4(0x2c6))&&(_0x40b811[_0x9547c4(0x2c6)]=0x0,_0x22752d=!![]);!_0x40b811['hasOwnProperty'](_0x9547c4(0x216))&&(_0x40b811['latestversion']=_0x9547c4(0x26d),_0x22752d=!![]);!_0x40b811['hasOwnProperty']('onepagemode')&&(_0x40b811[_0x9547c4(0x32a)]=![],_0x22752d=!![]);!_0x40b811[_0x9547c4(0x2f0)](_0x9547c4(0x32d))&&(_0x40b811['marketcapApi']='',_0x22752d=!![]);if(_0x22752d)storeSettings(_0x40b811);try{fs[_0x9547c4(0x2e6)](configbackuppath,{'withFileTypes':!![]})[_0x9547c4(0x2ef)](_0x53871b=>{const _0x56a99a=_0x9547c4;if(!_0x53871b[_0x56a99a(0x388)]()){if(!_0x53871b[_0x56a99a(0x363)][_0x56a99a(0x3d8)](_0x56a99a(0x1fb)))fs[_0x56a99a(0x37d)](configbackuppath+_0x53871b['name']);}else fs[_0x56a99a(0x1f7)](configbackuppath+_0x53871b[_0x56a99a(0x363)],{'recursive':!![]});});}catch(_0x2a2c02){logger['debug'](_0x9547c4(0x2da),_0x2a2c02);}}function storeConfiguration(_0x589eb4){const _0x1211e8=_0x459bb3;dbConfig[_0x1211e8(0x303)]('bots')['remove']()['write'](),dbConfig[_0x1211e8(0x303)](_0x1211e8(0x270))[_0x1211e8(0x3b3)](..._0x589eb4)[_0x1211e8(0x274)](),config=_0x589eb4;}async function resetPassword(){const _0xef663a=_0x459bb3;if(tgBot&&settings[_0xef663a(0x1ee)]){const _0x4ca583=Markup[_0xef663a(0x2a5)]([Markup['button'][_0xef663a(0x304)](_0xef663a(0x310),_0xef663a(0x24e)),Markup[_0xef663a(0x33e)][_0xef663a(0x304)]('no',_0xef663a(0x38b))]);await sendTelegram(settings['telegramChatId'],_0xef663a(0x337),_0x4ca583),tgBot[_0xef663a(0x3b5)](/resetpw_(.+)/,async _0x2077b6=>{const _0x291288=_0xef663a,_0x45e9b6=_0x2077b6[_0x291288(0x2a2)][0x1];_0x2077b6[_0x291288(0x3e2)]();if(_0x45e9b6!='no'){const _0x239709=0xf,_0x550f5b=_0x291288(0x31c),_0x583600=Array['from'](crypto[_0x291288(0x38e)](new Uint32Array(_0x239709)))[_0x291288(0x2f1)](_0x3c60ac=>_0x550f5b[_0x3c60ac%_0x550f5b['length']])[_0x291288(0x316)](''),_0x26638f=bcrypt[_0x291288(0x3b8)](_0x583600,saltRounds);storeSettings({'bbPassword':_0x26638f}),await sendTelegram(_0x2077b6[_0x291288(0x3c7)]['id'],_0x291288(0x3c6)+_0x583600,{'parse_mode':_0x291288(0x322)});}else await sendTelegram(_0x2077b6['chat']['id'],_0x291288(0x3a9));});}}async function confirmRestore(_0x22973f,_0x3a9d21){const _0x405a1b=_0x459bb3;io['to']('botmanager')[_0x405a1b(0x359)](_0x405a1b(0x3a4),_0x405a1b(0x209),_0x405a1b(0x3d7));if(tgBot&&settings[_0x405a1b(0x1ee)]){const _0x16d58b=uuidRandom();tmpStorage[_0x16d58b]={'path':_0x22973f,'filename':_0x3a9d21};const _0xb6db12=Markup[_0x405a1b(0x2a5)]([Markup[_0x405a1b(0x33e)][_0x405a1b(0x304)]('yes',_0x405a1b(0x36a)+_0x16d58b),Markup[_0x405a1b(0x33e)][_0x405a1b(0x304)]('no',_0x405a1b(0x3ba)+_0x16d58b)]);await sendTelegram(settings[_0x405a1b(0x1ee)],_0x405a1b(0x267),_0xb6db12),tgBot[_0x405a1b(0x3b5)](/restore_(.+)_(.+)/,async _0x2f6e9c=>{const _0x1a0b46=_0x405a1b,_0x398478=_0x2f6e9c[_0x1a0b46(0x2a2)][0x1],_0x4e5309=_0x2f6e9c[_0x1a0b46(0x2a2)][0x2],{path:_0x3616e2,filename:_0x572e0c}=tmpStorage[_0x4e5309];delete tmpStorage[_0x4e5309],_0x2f6e9c[_0x1a0b46(0x3e2)](),_0x398478==_0x1a0b46(0x310)?(logger[_0x1a0b46(0x311)](_0x1a0b46(0x33c)),await sendTelegram(_0x2f6e9c[_0x1a0b46(0x3c7)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':'HTML'}),unzipFile(_0x3616e2,_0x572e0c)):(logger['debug'](_0x1a0b46(0x226)),await sendTelegram(_0x2f6e9c[_0x1a0b46(0x3c7)]['id'],_0x1a0b46(0x226)));});}}function getServerTime(){const _0x38fff0=_0x459bb3,_0x5dde20=new Date();return _0x5dde20[_0x38fff0(0x276)]()+'/'+(_0x5dde20['getMonth']()+0x1)[_0x38fff0(0x2bf)]()[_0x38fff0(0x20a)](0x2,'0')+'/'+_0x5dde20[_0x38fff0(0x370)]()[_0x38fff0(0x2bf)]()[_0x38fff0(0x20a)](0x2,'0')+'\x20'+_0x5dde20[_0x38fff0(0x308)]()[_0x38fff0(0x2bf)]()['padStart'](0x2,'0')+':'+_0x5dde20[_0x38fff0(0x1f8)]()[_0x38fff0(0x2bf)]()[_0x38fff0(0x20a)](0x2,'0')+':'+_0x5dde20['getSeconds']()[_0x38fff0(0x2bf)]()[_0x38fff0(0x20a)](0x2,'0');}function getTimeStamp(){const _0x3f0bf5=_0x459bb3,_0x54fedf=shiftedTime();return _0x54fedf[_0x3f0bf5(0x276)]()+'/'+(_0x54fedf[_0x3f0bf5(0x2ec)]()+0x1)[_0x3f0bf5(0x2bf)]()['padStart'](0x2,'0')+'/'+_0x54fedf['getDate']()[_0x3f0bf5(0x2bf)]()['padStart'](0x2,'0')+'\x20'+_0x54fedf[_0x3f0bf5(0x308)]()[_0x3f0bf5(0x2bf)]()[_0x3f0bf5(0x20a)](0x2,'0')+':'+_0x54fedf[_0x3f0bf5(0x1f8)]()[_0x3f0bf5(0x2bf)]()[_0x3f0bf5(0x20a)](0x2,'0')+':'+_0x54fedf[_0x3f0bf5(0x2d9)]()['toString']()['padStart'](0x2,'0');}function _0x4b6b(_0xa46a35,_0xd9e79a){const _0x393d37=_0xa419();return _0x4b6b=function(_0x61157e,_0x5aa72e){_0x61157e=_0x61157e-0x1cf;let _0xa419b9=_0x393d37[_0x61157e];return _0xa419b9;},_0x4b6b(_0xa46a35,_0xd9e79a);}function getCleanTimeStamp(){const _0x40d621=_0x459bb3,_0x1c064a=shiftedTime();return _0x1c064a[_0x40d621(0x276)]()+(_0x1c064a[_0x40d621(0x2ec)]()+0x1)[_0x40d621(0x2bf)]()['padStart'](0x2,'0')+_0x1c064a[_0x40d621(0x370)]()[_0x40d621(0x2bf)]()['padStart'](0x2,'0')+'-'+_0x1c064a[_0x40d621(0x308)]()['toString']()[_0x40d621(0x20a)](0x2,'0')+_0x1c064a[_0x40d621(0x1f8)]()['toString']()['padStart'](0x2,'0')+_0x1c064a[_0x40d621(0x2d9)]()['toString']()[_0x40d621(0x20a)](0x2,'0');}function shiftedTime(){const _0x35aae2=_0x459bb3,_0x5d4dba=new Date();let _0x50f04b=_0x5d4dba;if(settings[_0x35aae2(0x225)]&&settings['timeshift']!==0x0)_0x50f04b=fns[_0x35aae2(0x3d9)](_0x5d4dba,{'hours':settings['timeshift']});return _0x50f04b;}async function startScheduler(){const _0x466495=_0x459bb3,_0x36e1e3=new Date()['getUTCHours'](),_0x500cad=shiftedTime()[_0x466495(0x308)]();_0x500cad==0x4&&backupConfigFiles(),_0x500cad==0x0&&(rotateLogFiles(),logger[_0x466495(0x311)](_0x466495(0x204)),logger[_0x466495(0x311)](_0x466495(0x360)+serverversion+_0x466495(0x256)+(environment==_0x466495(0x37c)?_0x466495(0x21e):'')),logger[_0x466495(0x311)](_0x466495(0x204))),_0x36e1e3%0x6==0x0&&triggerAnalytics(),_0x36e1e3%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x5df6ea){const _0x52ba81=_0x459bb3;logger[_0x52ba81(0x311)](_0x52ba81(0x343)+_0x5df6ea);const _0x1b2e32=getBotsWithMode();_0x1b2e32[_0x52ba81(0x30a)]>0x0?confirmRestore(configbackuppath,_0x5df6ea):unzipFile(configbackuppath,_0x5df6ea);}function _0xa419(){const _0xe77cea=['Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','HTML','toggle-bot-mode','***','15\x20min','portfolio_','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','30\x20min','remove','onepagemode','log','Notifications\x20enabled','marketcapApi','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','apiPassword','temporary\x20access\x20rejected','/download/:type','update-bot','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Unauthorized\x20attempt\x20to\x20log\x20out','login\x20required','tempaccess_15_','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','settings.','\x1b[31m','mtime','sort','Restore\x20process\x20confirmed','whitelist','button','botID','apiSecret','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','/enable\x20-\x20enable\x20notifications\x0a','Restore\x20backup\x20file\x20','\x20|\x20','telegram2FaApproval','/logs\x20-\x20receive\x20log\x20files\x0a','toggle_','date-fns','publicKey','update','tempaccess_reject_','disabled','ipv6','Starting\x20Balance\x20Bot\x20update','sortBy','\x20files\x20over\x20Telegram:','Disabled\x20Bot\x20','uncaughtException','mode','NTBA_FIX_319','username','privateKey','copyFileSync','close','emit','express-fileupload','clientip','auth','DEFLATE','http','output-002.log','Running\x20#RED#Balance\x20Bot\x20v','logout','yargs/yargs','name','logs','SIGINT','temp/','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','env','login2fa_','restore_yes_','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','disconnect','split','/start','kind','getDate','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Bot\x20Mgr\x20>\x20','/names\x20-\x20show\x20bot\x20names\x0a','All\x20bots\x20running\x20right\x20now','output-001.log','Invalid\x20authentication\x20token\x20(2)','environment','/:bot/coins','set','argv','entries','staging','unlinkSync','mkdirSync','create','botmanager','Login\x20rejected','off','=>\x20Go\x20to\x20#CYA#http://','\x1b[34m','bbPassword','function','get-portfolio','isDirectory','port','manual','resetpw_no','start','conn','randomFillSync','jszip','sendMetricsTelegram','lowdb','apply','writeFileSync','storeHeadless','https://api.ipify.org?format=json','get-messages','#RES#','off_','Your\x20installation\x20is\x20already\x20up\x20to\x20date','privateKeyToPem','\x20minutes','bbUsername','Enabled\x20Bot\x20','telegram','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','get-starting-balances','Ok,\x20will\x20send\x20alert\x20notifications\x20only','[ip-address]','************','notification','/:bot/support','get-backup-files','temporary\x20access\x20timeout',',\x20must\x20be\x20a\x204\x20digit\x20number','Password\x20reset\x20rejected','\x20|\x20client:\x20...','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','118768vsTBrz',':\x20Bot\x20Mgr\x20>\x20','endsWith','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','reset-password','show','loginRequired','push','delete-alerts','action','temporaryAccessAllowed','headers','hashSync','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','restore_no_','telegramEnabled','221304wdMPFK','No\x20authentication\x20token','build','compareSync','Invalid\x20username\x20or\x20IP\x20address','|@|','range','_nsps','/update\x20-\x20update\x20Balance\x20Bot\x0a','#RES#\x20if\x20running\x20locally\x0a','Password\x20has\x20been\x20reset\x20to:\x20','chat','userid','Unauthorized\x20attempt\x20to\x20delete\x20bot','sendPortfolioTelegram','/disable\x20-\x20disable\x20notifications\x0a','defaults','383jEbUag','Network\x20Interfaces:','stringify','enable','getTime','getPortfolio','show-config','find','6b67f3d61ee94b8f5c80b4affef4c4d9','telegramToken','success','startsWith','add','sockets','loadAsync','settings','Error\x20sending\x20','new-disabled','Logged\x20out\x20user\x20...','2FA\x20login\x20rejected','<b>Telegram\x20Bot\x20Status:</b>\x0a','editMessageReplyMarkup','remoteAddress','util','address\x20already\x20in\x20use','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','-----------------------------------------------------------------------------------','lowdb/adapters/FileSync','status\x20code\x20401','backup/','config_orders','socket.io','224ubbeRn','tempaccess_30_','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','api-eu.mixpanel.com','format','createServer','portfolio','Bot\x20','access','store','Login\x20accepted','restore-backup-file','download','type','cancelLoading','\x1b[0m','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','-events.json','/:bot/performance','2FA\x20login\x20required','messages','pki','telegramIpApproval','backup-full','2FA\x20login\x20token\x20generated','pidExpireLogin','exp','params','temporary\x20access\x20not\x20allowed','test','token','tkn','connected','then','\x1b[33m','text','started','telegramChatId','bbvNew','.zip','alerts','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','slice','All\x20bots','existsSync','$1_$2_$3','rmSync','getMinutes','logged\x20out','cloneDeep','backup-full@','isValid','No\x20bots\x20running\x20right\x20now','file','ETH','config/','includes','bb-secure.json','bot','--------------------------------------','message','generateAsync','Session\x20expired\x20for\x20user\x20...','keys','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','padStart','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','-config.json','Alerts','store-configuration','3329082xkuukh','login','zip/','assign','timestamp','verify','uuid','latestversion','allow','Node.js\x20v','Unauthorized\x20attempt\x20to\x20download\x20','sign','path','statSync','storeFiat','(staging)','metrics_','Ok,\x20will\x20send\x20order\x20notifications\x20only','Orders','alias','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','accept','timeshift','Restore\x20process\x20aborted','removeAllListeners','address','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','907372WPpniL','filter','3000','encryptedUuid','telegramEvents','config_alerts','decode64','fork','running','Invalid\x20authentication\x20token\x20(1)','secure','min','crypto','/restart\x20-\x20restart\x20bot(s)\x0a','error','reinstall','inherit','422mzDDeK','\x20mode','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','connection','post','/:bot/configuration','update_yes','login\x20token\x20valid','index.html','#RES#\x20if\x20running\x20on\x20server','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Access\x20enabled\x20for\x20','-performance.json','warning','node','tempaccess_5_','BCT','/backup\x20-\x20receive\x20backup\x20files\x0a','orders','resetpw_yes','Telegram\x20error:','send','Starting\x20new\x20bot\x20|\x20Bot\x20','Notifications\x20enabled\x0a','Unauthorized\x20attempt\x20to\x20add\x20bot','bcryptjs','decrypt','#RES#\x20','string','apiKey','deleteHistoryAlerts','enabled','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','replace','Allow\x20login\x20from\x20IP\x20address\x20','toggle','publicKeyToPem','production','referer','/status\x20-\x20show\x20bot(s)\x20status\x0a','reset-history','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Invalid\x20IP\x20address','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','number','showname','command','SIGTERM','Failed\x20to\x20download\x20','0.0.0','reason','reject','bots','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Deleted\x20Bot\x20','handshake','write','store-headless','getFullYear','live','place-order','once','botname','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','/:bot/history','/on\x20-\x20start\x20bot(s)\x0a','toggleBotMode','event','access\x20timeout','telegrammsg','createWriteStream','store-settings','initclient','::1','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','2FA','ipaddr.js','simple','host','family','telegraf','2466350giPfoz','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','value','versions','Unauthorized\x20attempt\x20to\x20confirm\x20message','cancel-loading','auto','stop','(((.+)+)+)+$','bb-settings.json','blacklist','new','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','1000','password','\x1b[35m','restart','resetHistory','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','reload','match','update_no','\x20only\x0a','inlineKeyboard','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','axios','lastmsgtelegram','\x1b[36m','whitelistEnabled','Unauthorized\x20login\x20attempt\x20(timeout)','\x20>\x20','Telegraf\x20error:','Unauthorized\x20attempt\x20to\x20get\x20events','replyWithDocument','parse','config_all','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','invalid\x20credentials','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','/off\x20-\x20stop\x20bot(s)\x0a','2FA\x20required','placeOrder','private','internal','telegramUsername','storeConfiguration','confirm-message','child_process','logs/','toString','catch','socket','use','2407212tgukku','Unauthorized\x20attempt\x20to\x20delete\x20alerts','search','lastmsgemitted','login2fa_reject_','files','secret','sendFile','size','User\x20has\x20been\x20validated','full','from','get-logs','/upload-backup','init','express','status','reinstall_no','temporary\x20token\x20generated','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','launch','Backup\x20file\x20unzipped\x20and\x20stored','getSeconds','Error\x20removing\x20old\x20backup\x20files:','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Unauthorized\x20attempt\x20to\x20show\x20configuration','request','backupfile','RSA-OAEP','f2aRequired','/output-000.log','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','version.json','\x20(2)','5\x20min','readdirSync','backup-files','node-forge','readFileSync','version','-results.json','getMonth','emitHistory','kill','forEach','hasOwnProperty','map','headless','Unauthorized\x20attempt\x20to\x20get\x20messages','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','expiry','uuid-random','hex','exit','sha256','login\x20not\x20required','config','<b>Balance\x20Bot\x20Status:</b>\x0a','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Notifications\x20disabled','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','backup',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','binary','get','callback','all','Temporary\x20access\x20rejected','bot-','getHours','login\x20token\x20generated','length','\x20|\x20user:\x20...','\x20(1)','pidRefreshToken','Error\x20details:','output-000.log','yes','debug','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','Markdown','ipc',')\x20|\x20Bot\x20','join','reply','constructor','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','bb/','IPv4','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','code','update-bb','stopped','Unauthorized\x20attempt\x20to\x20update\x20bot'];_0xa419=function(){return _0xe77cea;};return _0xa419();}async function getBackupFiles(_0x3469e9=null){const _0x1be882=_0x459bb3;let _0x5a1aa6=[],_0x50a708=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x50a708['sort']((_0x1df406,_0x47088b)=>_0x1df406[_0x1be882(0x363)]<_0x47088b[_0x1be882(0x363)]?0x1:_0x47088b[_0x1be882(0x363)]<_0x1df406[_0x1be882(0x363)]?-0x1:0x0),_0x50a708[_0x1be882(0x2ef)](_0x338f0e=>{const _0x1089e4=_0x1be882;if(!_0x338f0e[_0x1089e4(0x388)]()&&_0x338f0e['name'][_0x1089e4(0x3d8)](_0x1089e4(0x1fb))&&_0x338f0e[_0x1089e4(0x363)][_0x1089e4(0x3ae)](_0x1089e4(0x1f0))){const _0x4395a2=formatDate(fs[_0x1089e4(0x21c)](configbackuppath+_0x338f0e[_0x1089e4(0x363)])[_0x1089e4(0x33a)]);_0x5a1aa6[_0x1089e4(0x3b3)]({'name':_0x338f0e[_0x1089e4(0x363)],'mtime':_0x4395a2});}});if(_0x3469e9)io['to'](_0x3469e9)['emit'](_0x1be882(0x2e7),_0x5a1aa6);else return _0x5a1aa6;}async function backupConfigFiles(){const _0x1b4ab2=_0x459bb3;await zipFiles(_0x1b4ab2(0x1e0));const _0x4dffa0=getCleanTimeStamp();fs['copyFileSync'](zippath+'backup-full.zip',configbackuppath+(_0x1b4ab2(0x1fb)+_0x4dffa0+_0x1b4ab2(0x1f0)));let _0x533743=fs[_0x1b4ab2(0x2e6)](configbackuppath,{'withFileTypes':!![]});_0x533743[_0x1b4ab2(0x33b)]((_0x3c1609,_0x25bb04)=>_0x3c1609['name']<_0x25bb04[_0x1b4ab2(0x363)]?0x1:_0x25bb04[_0x1b4ab2(0x363)]<_0x3c1609[_0x1b4ab2(0x363)]?-0x1:0x0),_0x533743[_0x1b4ab2(0x30a)]>maxBackups&&fs[_0x1b4ab2(0x37d)](configbackuppath+_0x533743[_0x533743[_0x1b4ab2(0x30a)]-0x1][_0x1b4ab2(0x363)]);}function rotateLogFiles(){const _0x35a97f=_0x459bb3,_0x4b372d=fs[_0x35a97f(0x21c)](logspath+_0x35a97f(0x30f)),_0x5cf39b=_0x4b372d[_0x35a97f(0x2cb)]/0x400;if(_0x5cf39b>0x64){let _0x3a109d=fs[_0x35a97f(0x2e6)](logspath,{'withFileTypes':!![]});_0x3a109d[_0x35a97f(0x33b)]((_0x218f77,_0x21bac4)=>_0x218f77['name']<_0x21bac4[_0x35a97f(0x363)]?0x1:_0x21bac4[_0x35a97f(0x363)]<_0x218f77[_0x35a97f(0x363)]?-0x1:0x0),_0x3a109d[_0x35a97f(0x2ef)](_0xb9c74a=>{const _0x10d7e3=_0x35a97f;if(_0xb9c74a['name']==_0x10d7e3(0x35f))fs[_0x10d7e3(0x357)](logspath+_0xb9c74a[_0x10d7e3(0x363)],logspath+'output-003.log');if(_0xb9c74a[_0x10d7e3(0x363)]==_0x10d7e3(0x375))fs[_0x10d7e3(0x357)](logspath+_0xb9c74a[_0x10d7e3(0x363)],logspath+_0x10d7e3(0x35f));_0xb9c74a[_0x10d7e3(0x363)]==_0x10d7e3(0x30f)&&(fs[_0x10d7e3(0x357)](logspath+_0xb9c74a[_0x10d7e3(0x363)],logspath+'output-001.log'),fs[_0x10d7e3(0x393)](logspath+_0xb9c74a[_0x10d7e3(0x363)],''));});}}async function zipFiles(_0x488e5a){const _0x2c30e7=_0x459bb3;let _0x3d305a;if(_0x488e5a==_0x2c30e7(0x364))_0x3d305a=logspath;if(_0x488e5a==_0x2c30e7(0x300))_0x3d305a=configpath;if(_0x488e5a==_0x2c30e7(0x1e0))_0x3d305a=configpath;let _0x37194a=fs[_0x2c30e7(0x2e6)](_0x3d305a,{'withFileTypes':!![]});const _0x4b5aab=new JSZip();_0x37194a[_0x2c30e7(0x2ef)](_0x2425b1=>{const _0x2efbba=_0x2c30e7;if(!_0x2425b1[_0x2efbba(0x388)]()){let _0xfb4e66=fs[_0x2efbba(0x2e9)](_0x3d305a+_0x2425b1['name']);if(_0x488e5a==_0x2efbba(0x300)){const _0x564aac=/^bot-[0-9]{3}-config.json$/,_0x16fac7=_0x564aac['test'](_0x2425b1['name']);if(_0x16fac7){const _0x59d88b=JSON['parse'](_0xfb4e66);if(_0x59d88b[_0x2efbba(0x203)][0x0]){_0x59d88b[_0x2efbba(0x203)][0x0]['apiKey']=_0x2efbba(0x324),_0x59d88b['bot'][0x0][_0x2efbba(0x340)]=_0x2efbba(0x324);if(_0x59d88b[_0x2efbba(0x203)][0x0]['apiPassword'])_0x59d88b[_0x2efbba(0x203)][0x0][_0x2efbba(0x32f)]=_0x2efbba(0x324);}_0xfb4e66=JSON['stringify'](_0x59d88b,null,0x2);}if(_0x2425b1['name']==_0x2efbba(0x297)){const _0x49f921=JSON[_0x2efbba(0x2b0)](_0xfb4e66);if(_0x49f921['settings'][_0x2efbba(0x3b2)])_0x49f921['settings'][_0x2efbba(0x3b2)]=![];if(_0x49f921[_0x2efbba(0x3dc)][_0x2efbba(0x385)])_0x49f921[_0x2efbba(0x3dc)][_0x2efbba(0x385)]=_0x2efbba(0x324);if(_0x49f921[_0x2efbba(0x3dc)][_0x2efbba(0x3d6)])_0x49f921['settings'][_0x2efbba(0x3d6)]='***';if(_0x49f921[_0x2efbba(0x3dc)]['telegramChatId'])_0x49f921[_0x2efbba(0x3dc)]['telegramChatId']=null;if(_0x49f921['settings']['marketcapApi'])_0x49f921['settings'][_0x2efbba(0x32d)]=_0x2efbba(0x324);_0xfb4e66=JSON[_0x2efbba(0x3cf)](_0x49f921,null,0x2);}if(_0x2425b1['name']!=_0x2efbba(0x202))_0x4b5aab[_0x2efbba(0x1fe)](_0x2425b1['name'],_0xfb4e66);}else _0x4b5aab[_0x2efbba(0x1fe)](_0x2425b1[_0x2efbba(0x363)],_0xfb4e66);}});const _0xa652c8=await _0x4b5aab[_0x2c30e7(0x206)]({'type':_0x2c30e7(0x257),'base64':![],'compression':_0x2c30e7(0x35d)});fs[_0x2c30e7(0x393)](zippath+(_0x488e5a+_0x2c30e7(0x1f0)),_0xa652c8,_0x2c30e7(0x302));}async function unzipFile(_0x180935,_0x27d435){const _0x44bea3=_0x459bb3;fs[_0x44bea3(0x2e6)](configpath,{'withFileTypes':!![]})[_0x44bea3(0x2ef)](_0xeb56b8=>{const _0xdd877c=_0x44bea3;if(!_0xeb56b8[_0xdd877c(0x388)]())fs[_0xdd877c(0x1f7)](configpath+_0xeb56b8[_0xdd877c(0x363)]);});const _0x31f247=fs[_0x44bea3(0x2e9)](_0x180935+_0x27d435,_0x44bea3(0x302)),_0x7a99e1=await JSZip[_0x44bea3(0x3db)](_0x31f247,{'base64':![],'checkCRC32':!![]});for(const _0x247a6a of Object[_0x44bea3(0x208)](_0x7a99e1[_0x44bea3(0x2c8)])){const _0x1e2fbc=_0x7a99e1[_0x44bea3(0x2c8)][_0x247a6a],_0x492260=await _0x1e2fbc['async'](_0x44bea3(0x257));fs['writeFileSync'](configpath+_0x1e2fbc[_0x44bea3(0x363)],_0x492260);}fs[_0x44bea3(0x2e6)](temppath,{'withFileTypes':!![]})[_0x44bea3(0x2ef)](_0x1c186b=>{const _0x1f3279=_0x44bea3;if(!_0x1c186b['isDirectory']())fs[_0x1f3279(0x1f7)](temppath+_0x1c186b[_0x1f3279(0x363)]);}),logger[_0x44bea3(0x311)](_0x44bea3(0x2d8)),process[_0x44bea3(0x250)]({'restore':!![]},_0xede004=>{});}async function getPublicIp(){const _0x11d677=_0x459bb3;try{const _0x9efad5=await axios[_0x11d677(0x303)](_0x11d677(0x395));publicip=_0x9efad5['data']['ip'];}catch(_0xb3f9a3){}}async function triggerAnalytics(){const _0xe057ca=_0x459bb3;if(!publicip)await getPublicIp();const _0x331ec6=getBotsWithMode();let _0x58a067=0x0;_0x331ec6[_0xe057ca(0x2ef)](_0x4f647e=>{const _0x2a72f2=_0xe057ca;if(_0x4f647e[_0x2a72f2(0x2d3)]===_0x2a72f2(0x25a))_0x58a067++;});const _0x51db4f=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings[_0xe057ca(0x3c8)],'ip':publicip,'version':serverversion,'numbots':_0x331ec6[_0xe057ca(0x30a)],'numbotsenabled':_0x58a067,'exchanges':_0x51db4f,'environment':environment});}async function getMessages(){const _0x4b23e1=_0x459bb3,_0xf27529=_0x4b23e1(0x2ff),_0x380b07=new GraphQLClient(_0xf27529),_0x446f70={'authorization':_0x4b23e1(0x321)},_0x5950d4=serverversion[_0x4b23e1(0x36d)]('.'),_0x422903=_0x5950d4[0x0]+'.'+_0x5950d4[0x1],_0x59a0aa=Math[_0x4b23e1(0x235)](settings[_0x4b23e1(0x2a8)],settings[_0x4b23e1(0x2c6)]),_0x888088={'last':parseInt(_0x59a0aa),'bbm':_0x422903},_0x50db27=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1627ac;try{_0x1627ac=await _0x380b07[_0x4b23e1(0x2dd)](_0x50db27,_0x888088,_0x446f70);}catch(_0x2ecff7){}if(_0x1627ac&&_0x1627ac[_0x4b23e1(0x1dd)]){let _0x1ab1b8=settings[_0x4b23e1(0x2a8)],_0x296858=settings[_0x4b23e1(0x2a8)];newMessages=[];for(const _0x395eb7 of _0x1627ac[_0x4b23e1(0x1dd)]){newMessages['push'](_0x395eb7);let _0x4f35fc=![];_0x395eb7[_0x4b23e1(0x1ef)]&&(updateSetting(_0x4b23e1(0x216),_0x395eb7[_0x4b23e1(0x1ef)]),_0x4f35fc=isNewerVersion(serverversion,_0x395eb7['bbvNew'])||serverversion==_0x395eb7[_0x4b23e1(0x1ef)]);if(!_0x4f35fc&&_0x395eb7[_0x4b23e1(0x268)]>_0x1ab1b8){if(_0x395eb7['bbvReceive']==='any'||serverversion[_0x4b23e1(0x3d8)](_0x395eb7['bbvReceive'])){let _0x36b684=''+_0x395eb7['title']+'\x0a\x0a'+_0x395eb7[_0x4b23e1(0x205)];const _0x37308f=await sendTelegramMsg(toTelegramMarkdown(_0x36b684),_0x4b23e1(0x313));_0x1ab1b8=_0x395eb7['number'];}}_0x296858=_0x395eb7[_0x4b23e1(0x268)];}updateAvailable=isNewerVersion(settings[_0x4b23e1(0x216)],serverversion),updateSetting(_0x4b23e1(0x2a8),_0x296858),emitMessages();}}function emitMessages(){const _0x64980b=_0x459bb3,_0x3fbe53=settings[_0x64980b(0x2c6)];let _0x2c4a25=[];newMessages[_0x64980b(0x2ef)](_0x29fcb6=>{const _0x5b8022=_0x64980b;_0x29fcb6[_0x5b8022(0x268)]>_0x3fbe53&&_0x2c4a25['push'](_0x29fcb6);}),_0x2c4a25[_0x64980b(0x30a)]>0x0&&getAllClients()[_0x64980b(0x2ef)](_0x36fd26=>{const _0x458064=_0x64980b;getSocket(_0x36fd26['id'])[_0x458064(0x359)](_0x458064(0x205),_0x2c4a25);});}function confirmMessage(_0x2c3b86){updateSetting('lastmsgemitted',Number(_0x2c3b86));}function isNewerVersion(_0x4e990e,_0x344a53){const _0x13ce41=_0x459bb3,_0x543014=_0x344a53['split']('.'),_0x2c3daf=_0x4e990e[_0x13ce41(0x36d)]('.');for(var _0x524d84=0x0;_0x524d84<_0x2c3daf['length'];_0x524d84++){const _0x361431=~~_0x2c3daf[_0x524d84],_0x135ec7=~~_0x543014[_0x524d84];if(_0x361431>_0x135ec7)return!![];if(_0x361431<_0x135ec7)return![];}return![];}function toTelegramMarkdown(_0x1692ca){const _0x522d70=_0x459bb3,_0x5b37f0=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x48ae9b=/\*{2}(.+?)\*{2}/gim;return _0x1692ca=_0x1692ca[_0x522d70(0x25c)](_0x5b37f0,_0x522d70(0x1f6))[_0x522d70(0x25c)](_0x48ae9b,'*$1*'),_0x1692ca;}async function validateConfigFile(){const _0x26fb42=_0x459bb3,_0x3b6e18=dbConfig[_0x26fb42(0x303)]('bots')[_0x26fb42(0x34f)](_0x26fb42(0x33f))['value']()||[];if(_0x3b6e18[_0x26fb42(0x30a)]==0x0){let _0x1b0690=0x0,_0x5d500d=[];const _0x2a5d3a=/^bot-([0-9]{3})-config.json$/,_0x5f4ee7=fs['readdirSync'](configpath);_0x5f4ee7['forEach'](_0x38789f=>{const _0x3d84dc=_0x26fb42,_0x505afe=_0x2a5d3a['exec'](_0x38789f);if(_0x505afe){const _0x1547ff=_0x505afe[0x1];let _0x589e35=getBotAttributes(_0x1547ff);_0x5d500d[_0x3d84dc(0x3b3)]({'botID':_0x1547ff,'botname':_0x589e35[_0x3d84dc(0x27a)],'status':_0x3d84dc(0x34c),'live':'stopped'}),_0x1b0690++;}}),_0x1b0690!=0x0&&(dbConfig[_0x26fb42(0x303)](_0x26fb42(0x270))[_0x26fb42(0x212)](_0x5d500d)[_0x26fb42(0x274)](),config=_0x5d500d,restoredConfigFile=_0x1b0690);}}async function restoreConfigNotify(_0x54cced){const _0x3fa5a9=_0x459bb3;let _0x3a5c1f;if(restoredConfigFile==0x1)_0x3a5c1f=_0x3fa5a9(0x2b2);else _0x3a5c1f=_0x3fa5a9(0x333);if(_0x54cced)io['to'](_0x3fa5a9(0x380))[_0x3fa5a9(0x359)]('notification',_0x3a5c1f);else{logger[_0x3fa5a9(0x28a)](_0x3fa5a9(0x3e7)),logger[_0x3fa5a9(0x28a)](_0x3a5c1f),logger[_0x3fa5a9(0x28a)](_0x3fa5a9(0x3e7)),logger['simple']('');if(tgBot&&settings[_0x3fa5a9(0x1ee)]&&settings[_0x3fa5a9(0x22e)]!='orders')await sendTelegram(settings[_0x3fa5a9(0x1ee)],_0x3fa5a9(0x372)+_0x3a5c1f);}}function decryptRSA(_0x1ead0e,_0x342f10){const _0x2804a1=_0x459bb3,_0x5c7c62=forge[_0x2804a1(0x1de)]['privateKeyFromPem'](_0x1ead0e),_0x2b634b=_0x5c7c62[_0x2804a1(0x255)](forge['util'][_0x2804a1(0x230)](_0x342f10),_0x2804a1(0x2df),{'md':forge['md']['sha256'][_0x2804a1(0x37f)](),'mgf1':{'md':forge['md'][_0x2804a1(0x2f9)][_0x2804a1(0x37f)]()}});return _0x2b634b;}function validateCredentials(_0x5df230,_0x3431c7){const _0x59c23a=_0x459bb3;if(_0x5df230[_0x59c23a(0x355)]==settings[_0x59c23a(0x39c)]&&bcrypt[_0x59c23a(0x3bf)](_0x5df230[_0x59c23a(0x29c)],settings[_0x59c23a(0x385)])){if(settings[_0x59c23a(0x2e0)])return{'allow':![],'reason':_0x59c23a(0x1dc),'token':null};else{const _0xdceaae=generateLoginToken(_0x3431c7);return{'allow':!![],'reason':_0x59c23a(0x309),'token':_0xdceaae};}}else return{'allow':![],'reason':_0x59c23a(0x2b3),'token':null};}function refreshToken(_0x4591f1){const _0x498dfa=generateLoginToken(_0x4591f1);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x498dfa};}function validateAccess(_0x49221d,_0x43f999,_0x3b75b5){const _0x388784=_0x459bb3,_0x87f9a8=_0x3b75b5?_0x3b75b5:devices[_0x43f999]['ip'];let _0x1e31ae;const _0x366e47=_0x13e5c0=>{const _0x1f919f=_0x4b6b;if(settings['loginRequired']){if(settings[_0x1f919f(0x2e0)]){if(telegram2FaApproved(_0x43f999)){const _0x3d615a=generateLoginToken(_0x43f999);return{'allow':!![],'reason':_0x1f919f(0x1e1),'token':_0x3d615a};}else return{'allow':![],'reason':_0x1f919f(0x335),'token':null};}else return _0x1e31ae=validToken(_0x13e5c0,_0x43f999),_0x1e31ae[_0x1f919f(0x2f0)](_0x1f919f(0x3d7))?{'allow':!![],'reason':_0x1f919f(0x242),'token':_0x13e5c0}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x1f919f(0x2fa),'token':null};};if(settings[_0x388784(0x2aa)]){let _0x125896=[...settings[_0x388784(0x33d)],_0x388784(0x285),'::ffff:127.0.0.1','127.0.0.1'];if(_0x125896[_0x388784(0x201)](_0x87f9a8))return _0x366e47(_0x49221d);else{_0x1e31ae=validToken(_0x49221d,_0x43f999);if(_0x1e31ae['hasOwnProperty'](_0x388784(0x3d7)))return _0x366e47(_0x49221d);else{if(telegramIpApproved(_0x43f999)){const _0x3d90aa=generateToken(_0x43f999);return _0x1e31ae=_0x366e47(_0x49221d),_0x1e31ae[_0x388784(0x217)]?{'allow':!![],'reason':_0x388784(0x2d5),'token':_0x3d90aa}:_0x1e31ae;}else return settings[_0x388784(0x3b6)]?{'allow':![],'reason':_0x388784(0x2b6),'token':null}:{'allow':![],'reason':_0x388784(0x1e5),'token':null};}}}else return _0x366e47(_0x49221d);}function timelyDecrypt(_0x1f5fc5,_0xd1178,_0x1ada19='@'){const _0x308d95=_0x459bb3;if(_0x1f5fc5)try{const _0x190588=decryptRSA(secure['privateKey'],_0x1f5fc5),_0x581030=_0x190588[_0x308d95(0x36d)](_0x1ada19)[0x0],_0x4a4a6b=_0x190588[_0x308d95(0x36d)](_0x1ada19)[0x1],_0x43523c=new Date()[_0x308d95(0x3d1)]();if(_0xd1178){if(_0x43523c-_0x4a4a6b<maxSecretAge*0x3e8)return _0x581030;else return![];}else return _0x581030;}catch(_0x54655d){return![];}else return![];}const validToken=(_0x8c8de5,_0x2b0066)=>{const _0x3f20e5=_0x459bb3,_0x3216c3=devices[_0x2b0066]['ip'];if(!_0x8c8de5)return{'error':_0x3f20e5(0x3bd)};for(let _0x318dec of blacklist){if(_0x318dec[_0x3f20e5(0x1e7)]==_0x8c8de5)return{'error':'Token\x20blacklisted'};}let _0x87ab8d;try{_0x87ab8d=jwt[_0x3f20e5(0x214)](_0x8c8de5,secure[_0x3f20e5(0x2c9)]+_0x2b0066);}catch{return{'error':_0x3f20e5(0x233)};}if(!_0x87ab8d[_0x3f20e5(0x2f0)]('clientip')&&!_0x87ab8d['hasOwnProperty'](_0x3f20e5(0x355))||!_0x87ab8d['hasOwnProperty'](_0x3f20e5(0x1e3)))return{'error':_0x3f20e5(0x376)};if(!_0x87ab8d['hasOwnProperty'](_0x3f20e5(0x355))&&_0x87ab8d[_0x3f20e5(0x2f0)](_0x3f20e5(0x35b))){const {clientip:_0x4709ea}=_0x87ab8d;return _0x3216c3==_0x4709ea?{'success':_0x3f20e5(0x2cc)}:{'error':_0x3f20e5(0x265)};}else{if(_0x87ab8d['hasOwnProperty'](_0x3f20e5(0x355))&&_0x87ab8d[_0x3f20e5(0x2f0)]('clientip')){const {username:_0x3bd35e,clientip:_0x5b648a}=_0x87ab8d;return settings[_0x3f20e5(0x39c)]==_0x3bd35e&&_0x3216c3==_0x5b648a?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x3f20e5(0x3c0)};}}},generateLoginToken=_0x7cec2=>{const _0x3fe47f=_0x459bb3;if(_0x7cec2){const _0x322bc4=devices[_0x7cec2]['ip'];return jwt[_0x3fe47f(0x21a)]({'username':settings[_0x3fe47f(0x39c)],'clientip':_0x322bc4},secure['secret']+_0x7cec2,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0xe33ff2=>{const _0x4132d0=_0x459bb3;if(_0xe33ff2){const _0xef8a0d=devices[_0xe33ff2]['ip'];return jwt['sign']({'clientip':_0xef8a0d},secure[_0x4132d0(0x2c9)]+_0xe33ff2,{'expiresIn':devices[_0xe33ff2][_0x4132d0(0x1df)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x1c5d49=>{const _0x21203f=_0x459bb3;let _0x43050a=![];return devices[_0x1c5d49]['telegramIpApproval']&&devices[_0x1c5d49][_0x21203f(0x1df)][_0x21203f(0x2f5)]!=_0x21203f(0x26f)&&(_0x43050a=devices[_0x1c5d49]['telegramIpApproval'][_0x21203f(0x35b)]==devices[_0x1c5d49]['ip']&&new Date()[_0x21203f(0x3d1)]()-devices[_0x1c5d49][_0x21203f(0x1df)][_0x21203f(0x213)]<devices[_0x1c5d49][_0x21203f(0x1df)][_0x21203f(0x2f5)]*0x3c*0x3e8),_0x43050a;},telegram2FaApproved=_0x4cafaf=>{const _0xd2f0da=_0x459bb3;let _0x5b533c=![];return devices[_0x4cafaf][_0xd2f0da(0x345)]&&devices[_0x4cafaf][_0xd2f0da(0x345)][_0xd2f0da(0x2f5)]!=_0xd2f0da(0x26f)&&(_0x5b533c=devices[_0x4cafaf]['telegram2FaApproval']['clientip']==devices[_0x4cafaf]['ip']&&new Date()[_0xd2f0da(0x3d1)]()-devices[_0x4cafaf][_0xd2f0da(0x345)]['timestamp']<devices[_0x4cafaf]['telegram2FaApproval'][_0xd2f0da(0x2f5)]*0x3c*0x3e8),_0x5b533c;},normalizeIP=_0x456a1f=>{const _0x131a49=_0x459bb3;let _0x461702=null,_0x21b5bd=null;if(ipaddr[_0x131a49(0x1fc)](_0x456a1f)){const _0x184edf=ipaddr[_0x131a49(0x2b0)](_0x456a1f);_0x184edf[_0x131a49(0x36f)]()===_0x131a49(0x34d)?(_0x184edf['isIPv4MappedAddress']()&&(_0x461702=_0x184edf['toIPv4Address']()[_0x131a49(0x2bf)]()),_0x21b5bd=_0x184edf['toString']()):(_0x461702=_0x184edf[_0x131a49(0x2bf)](),_0x21b5bd=_0x184edf['toIPv4MappedAddress']()['toString']());}return{'show':_0x461702?_0x461702:_0x21b5bd,'store':_0x21b5bd};};function formatDate(_0x2185e9){const _0x10bb84=_0x459bb3;return _0x2185e9[_0x10bb84(0x276)]()+'/'+(_0x2185e9[_0x10bb84(0x2ec)]()+0x1)[_0x10bb84(0x2bf)]()[_0x10bb84(0x20a)](0x2,'0')+'/'+_0x2185e9['getDate']()[_0x10bb84(0x2bf)]()['padStart'](0x2,'0')+'\x20'+_0x2185e9[_0x10bb84(0x308)]()[_0x10bb84(0x2bf)]()[_0x10bb84(0x20a)](0x2,'0')+':'+_0x2185e9['getMinutes']()[_0x10bb84(0x2bf)]()['padStart'](0x2,'0')+':'+_0x2185e9[_0x10bb84(0x2d9)]()[_0x10bb84(0x2bf)]()[_0x10bb84(0x20a)](0x2,'0');}function sleep(_0x2c4c35){return new Promise(_0x60c9a0=>setTimeout(_0x60c9a0,_0x2c4c35));}