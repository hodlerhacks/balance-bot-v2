const _0x77986a=_0x2018;(function(_0x2cac71,_0x12a76e){const _0x348f1b=_0x2018,_0x2b1aaa=_0x2cac71();while(!![]){try{const _0x870ade=-parseInt(_0x348f1b(0x1be))/0x1*(parseInt(_0x348f1b(0x195))/0x2)+-parseInt(_0x348f1b(0x199))/0x3*(-parseInt(_0x348f1b(0x128))/0x4)+parseInt(_0x348f1b(0x157))/0x5*(parseInt(_0x348f1b(0x1ad))/0x6)+parseInt(_0x348f1b(0x15b))/0x7+-parseInt(_0x348f1b(0xff))/0x8*(-parseInt(_0x348f1b(0x261))/0x9)+-parseInt(_0x348f1b(0x230))/0xa+parseInt(_0x348f1b(0x105))/0xb;if(_0x870ade===_0x12a76e)break;else _0x2b1aaa['push'](_0x2b1aaa['shift']());}catch(_0x37e06b){_0x2b1aaa['push'](_0x2b1aaa['shift']());}}}(_0x2163,0xebaa5));const _0x55feb0=function(){let _0xf1b81a=!![];return function(_0x2ea95f,_0x5b52ba){const _0xbc5ca9=_0xf1b81a?function(){const _0x56b6b9=_0x2018;if(_0x5b52ba){const _0x1c21d7=_0x5b52ba[_0x56b6b9(0xf5)](_0x2ea95f,arguments);return _0x5b52ba=null,_0x1c21d7;}}:function(){};return _0xf1b81a=![],_0xbc5ca9;};}(),_0x183884=_0x55feb0(this,function(){const _0x3ef067=_0x2018;return _0x183884[_0x3ef067(0x25f)]()['search'](_0x3ef067(0x244))[_0x3ef067(0x25f)]()[_0x3ef067(0x1a7)](_0x183884)[_0x3ef067(0x1f4)](_0x3ef067(0x244));});_0x183884();'use strict';process[_0x77986a(0xf1)][_0x77986a(0x281)]=0x1;const childProcess=require(_0x77986a(0x2c4)),fs=require('fs'),fns=require(_0x77986a(0x1f5)),low=require(_0x77986a(0xef)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x77986a(0x1f6)),crypto=require('crypto'),forge=require(_0x77986a(0x121)),bcrypt=require(_0x77986a(0x1c3)),jwt=require(_0x77986a(0x132)),ipaddr=require(_0x77986a(0x224)),argv=require(_0x77986a(0x26a))(process[_0x77986a(0x1db)][_0x77986a(0x2bf)](0x2))[_0x77986a(0x1db)],uuidRandom=require(_0x77986a(0x23e)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x77986a(0x11e)),axios=require(_0x77986a(0x171)),{GraphQLClient,gql}=require(_0x77986a(0x1af)),util=require(_0x77986a(0x216)),fileUpload=require(_0x77986a(0x2e6)),{networkInterfaces}=require('os'),JSZip=require(_0x77986a(0x16c)),PORT=argv[_0x77986a(0x1a4)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x77986a(0x2a5)](PORT)&&(console[_0x77986a(0x22a)](_0x77986a(0x210)+PORT+_0x77986a(0x27d)),process[_0x77986a(0x284)](0x1));const HOST=argv[_0x77986a(0x1fe)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x77986a(0x100)][_0x77986a(0x2c1)];let bbpath=_0x77986a(0x228),bbpath2='';const botfile='bot.js',configfile=_0x77986a(0x101),settingsfile=_0x77986a(0x143),securefile=_0x77986a(0x2be),environment=require('./'+bbpath2+_0x77986a(0x111))[_0x77986a(0x225)]||_0x77986a(0x110),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x77986a(0x2ba)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x77986a(0x14a)),configpath=userID?bbpath+_0x77986a(0x2ad)+userID+'/':bbpath+_0x77986a(0x2ad),configbackuppath=configpath+_0x77986a(0x21e),logspath=userID?bbpath+_0x77986a(0x2b3)+userID+'/':bbpath+_0x77986a(0x2b3),zippath=userID?bbpath+_0x77986a(0x160)+userID+'/':bbpath+_0x77986a(0x160),loggerfile=fs[_0x77986a(0x2ea)](logspath+_0x77986a(0x17d),{'flags':'a'}),temppath=userID?bbpath+_0x77986a(0x2d4)+userID+'/':bbpath+_0x77986a(0x2d4);!fs['existsSync'](configpath)&&fs[_0x77986a(0x1f7)](configpath);!fs[_0x77986a(0x2ba)](configbackuppath)&&fs[_0x77986a(0x1f7)](configbackuppath);!fs[_0x77986a(0x2ba)](logspath)&&fs[_0x77986a(0x1f7)](logspath);!fs[_0x77986a(0x2ba)](zippath)&&fs[_0x77986a(0x1f7)](zippath);!fs[_0x77986a(0x2ba)](temppath)&&fs[_0x77986a(0x1f7)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x77986a(0x16a)]({'bots':[]})[_0x77986a(0x15f)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x77986a(0x16a)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x77986a(0x2c2),'onepagemode':![],'marketcapApi':''}})[_0x77986a(0x15f)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x77986a(0x16a)]({'secure':{},'blacklist':[]})[_0x77986a(0x15f)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x77986a(0x120)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x77986a(0x2f6)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x77986a(0x2cf)]&&(settings[_0x77986a(0x2cf)]!=''&&settings[_0x77986a(0x2cf)]!='***')&&settings[_0x77986a(0x24b)]&&settings[_0x77986a(0x24b)]!='')initTelegram();const parseColor=(_0x448201,_0x5cf894)=>{const _0xdfcfc6=_0x77986a,_0x11bfb4=/#[A-Z]{3}#/g;if(typeof _0x448201==_0xdfcfc6(0x269)){!_0x5cf894?_0x448201=_0x448201[_0xdfcfc6(0x23d)](_0x11bfb4,''):(_0x448201=_0x448201[_0xdfcfc6(0x23d)](/#BLU#/g,'\x1b[34m'),_0x448201=_0x448201[_0xdfcfc6(0x23d)](/#RED#/g,_0xdfcfc6(0x1bb)),_0x448201=_0x448201['replace'](/#YEL#/g,'\x1b[33m'),_0x448201=_0x448201[_0xdfcfc6(0x23d)](/#MAG#/g,'\x1b[35m'),_0x448201=_0x448201['replace'](/#CYA#/g,_0xdfcfc6(0x2a0)),_0x448201=_0x448201[_0xdfcfc6(0x23d)](/#RES#/g,_0xdfcfc6(0x220)));;}return _0x448201;},logger={'screen':_0x7b7d26=>{const _0x32a032=_0x77986a;console[_0x32a032(0x22a)](parseColor(_0x7b7d26,!![]));},'simple':_0x5b2e39=>{const _0x5123a6=_0x77986a;console[_0x5123a6(0x22a)](parseColor(_0x5b2e39,!![])),loggerfile[_0x5123a6(0x15f)](util[_0x5123a6(0xdc)](parseColor(_0x5b2e39,![]))+'\x0a');},'full':async _0x6ada61=>{const _0x27aaa9=_0x77986a,_0x1cb4cd=getTimeStamp()+_0x27aaa9(0x20a)+_0x6ada61;console[_0x27aaa9(0x22a)](parseColor(_0x1cb4cd,!![])),loggerfile['write'](util[_0x27aaa9(0xdc)](parseColor(_0x1cb4cd,![]))+'\x0a');if(tgBot&&settings[_0x27aaa9(0x18a)]&&settings[_0x27aaa9(0x180)]!=_0x27aaa9(0x1e7))await sendTelegram(settings[_0x27aaa9(0x18a)],_0x27aaa9(0x11f)+parseColor(_0x6ada61,![]));},'debug':async(_0x48d7ba,_0x5b3104='')=>{const _0x15a462=_0x77986a,_0xc8a5d=getTimeStamp()+_0x15a462(0x185)+_0x48d7ba;if(debugging)console[_0x15a462(0x22a)](parseColor(_0xc8a5d,!![]));loggerfile[_0x15a462(0x15f)](util['format'](parseColor(_0xc8a5d,![]))+'\x0a');if(_0x5b3104){if(debugging)console['log'](_0x5b3104);loggerfile[_0x15a462(0x15f)](util[_0x15a462(0xdc)](_0x5b3104)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x47f75a){const _0x55841e=_0x77986a;_0x47f75a[_0x55841e(0x25f)]()[_0x55841e(0x21c)](_0x55841e(0x136))?(logger[_0x55841e(0x253)](_0x55841e(0x135)+_0x47f75a['port']+'#RES#'),process[_0x55841e(0x204)]({'terminate':!![]},_0x3d2bcf=>{})):logger[_0x55841e(0x253)](_0x47f75a);}),process['on'](_0x77986a(0x284),()=>{const _0x38488a=_0x77986a;stopAllBots(),process[_0x38488a(0x284)](0x0);}),process['on']('SIGTERM',()=>{const _0x273620=_0x77986a;stopAllBots(),process[_0x273620(0x284)](0x0);}),process['on']('SIGINT',()=>{const _0x28e7b2=_0x77986a;stopAllBots(),process[_0x28e7b2(0x284)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x77986a(0x111))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x77986a(0x2d8)),app=express(),http=require(_0x77986a(0x16e))[_0x77986a(0x1f1)](app);app[_0x77986a(0x234)](fileUpload({'useTempFiles':!![]})),app[_0x77986a(0x164)](_0x77986a(0xeb),async(_0x3d23bf,_0x5e4cf1)=>{const _0x506840=_0x77986a,_0x54d544=_0x3d23bf[_0x506840(0x156)][_0x506840(0x130)],_0x24983f=getClientsWithBotID(_0x506840(0xf7)),_0x4331c4=_0x3d23bf['headers']['uuid'],_0x36cb3d=timelyDecrypt(_0x4331c4,![]),_0x35fea2=_0x24983f[_0x506840(0x2d5)](_0x2716be=>_0x2716be[_0x506840(0x28a)]==_0x36cb3d);if(_0x35fea2){const _0x514b06=normalizeIP(_0x3d23bf[_0x506840(0x182)][_0x506840(0x104)])[_0x506840(0x1d6)],_0x4f7c8f=_0x3d23bf['headers'][_0x506840(0x2b6)];if(validateAccess(_0x4f7c8f,_0x36cb3d,_0x514b06)[_0x506840(0x1b1)])_0x54d544==_0x506840(0x119)&&await backupConfigFiles(),await zipFiles(_0x54d544),_0x5e4cf1[_0x506840(0x2a8)](zippath+(_0x54d544+_0x506840(0x1f2)),_0x14e4d8=>{const _0x4ea89d=_0x506840;_0x14e4d8&&(logger[_0x4ea89d(0x1c9)](_0x4ea89d(0x203)+_0x54d544),logger[_0x4ea89d(0x253)](_0x14e4d8));});else logger[_0x506840(0x1c9)](_0x506840(0x168)+_0x54d544+_0x506840(0x28f));}else logger[_0x506840(0x1c9)](_0x506840(0x168)+_0x54d544+_0x506840(0x2c3));}),app[_0x77986a(0x1ab)](_0x77986a(0x131),async(_0x3873ac,_0x3e1aa8)=>{const _0x49c99d=_0x77986a,_0x417db8=getClientsWithBotID(_0x49c99d(0xf7)),_0x48ba81=_0x3873ac[_0x49c99d(0x17a)][_0x49c99d(0x28a)],_0x4cd77d=timelyDecrypt(_0x48ba81,![]),_0x20106c=_0x417db8[_0x49c99d(0x2d5)](_0x3a649e=>_0x3a649e[_0x49c99d(0x28a)]==_0x4cd77d);logger[_0x49c99d(0x1ae)]('Backup\x20file\x20uploaded');if(_0x20106c){const _0x1f68dd=normalizeIP(_0x3873ac[_0x49c99d(0x182)][_0x49c99d(0x104)])[_0x49c99d(0x1d6)],_0x52c852=_0x3873ac[_0x49c99d(0x17a)][_0x49c99d(0x2b6)];if(validateAccess(_0x52c852,_0x4cd77d,_0x1f68dd)[_0x49c99d(0x1b1)]){if(_0x3873ac[_0x49c99d(0x1c2)]){const _0xc64404=_0x3873ac[_0x49c99d(0x1c2)]['backupfile'];await _0xc64404['mv'](temppath+_0xc64404['name']),_0x3e1aa8[_0x49c99d(0x204)]({'status':!![],'message':_0x49c99d(0x293)});const _0x4077ce=getBotsWithMode();_0x4077ce[_0x49c99d(0x2b5)]>0x0?confirmRestore(temppath,_0xc64404[_0x49c99d(0x1c5)]):unzipFile(temppath,_0xc64404[_0x49c99d(0x1c5)]);}}else logger[_0x49c99d(0x1c9)](_0x49c99d(0x2b7));}else logger[_0x49c99d(0x1c9)](_0x49c99d(0x2b4));}),app[_0x77986a(0x234)](express[_0x77986a(0x22b)](path['join'](__dirname,bbpath2,_0x77986a(0x1ef)))),app[_0x77986a(0x234)](express['static'](path[_0x77986a(0x2c6)](__dirname,bbpath2,_0x77986a(0x227)))),app[_0x77986a(0x164)]('/',function(_0x5654ba,_0x2878ab){const _0x54dd1d=_0x77986a;_0x2878ab[_0x54dd1d(0x202)](path[_0x54dd1d(0x2c6)](__dirname,bbpath2,'build2','index.html'));}),app['get'](_0x77986a(0x247),function(_0x21b347,_0x477cfe){const _0x4b0bdf=_0x77986a;_0x477cfe[_0x4b0bdf(0x202)](path[_0x4b0bdf(0x2c6)](__dirname,bbpath2,'build',_0x4b0bdf(0x2fc)));}),app[_0x77986a(0x164)]('/:bot/portfolio',(_0x54a9f0,_0x5e4421)=>{const _0x4e4c0f=_0x77986a;_0x5e4421[_0x4e4c0f(0x202)](path['join'](__dirname,bbpath2,'build',_0x4e4c0f(0x2fc)));}),app[_0x77986a(0x164)](_0x77986a(0x1a0),(_0x41e05c,_0x1ca972)=>{const _0x1a36b7=_0x77986a;_0x1ca972[_0x1a36b7(0x202)](path[_0x1a36b7(0x2c6)](__dirname,bbpath2,_0x1a36b7(0x227),_0x1a36b7(0x2fc)));}),app[_0x77986a(0x164)](_0x77986a(0x140),(_0x593640,_0x257b58)=>{const _0x11a2eb=_0x77986a;_0x257b58['sendFile'](path[_0x11a2eb(0x2c6)](__dirname,bbpath2,_0x11a2eb(0x227),'index.html'));}),app[_0x77986a(0x164)](_0x77986a(0x151),(_0x14b1cb,_0x2890ee)=>{const _0x494a5c=_0x77986a;_0x2890ee[_0x494a5c(0x202)](path[_0x494a5c(0x2c6)](__dirname,bbpath2,'build',_0x494a5c(0x2fc)));}),app['get']('/:bot/configuration',(_0x2f0c13,_0xa3241d)=>{const _0x56c025=_0x77986a;_0xa3241d[_0x56c025(0x202)](path['join'](__dirname,bbpath2,_0x56c025(0x227),_0x56c025(0x2fc)));}),app[_0x77986a(0x164)]('/:bot/support',(_0x15a25b,_0x4dc2be)=>{const _0x12e1ce=_0x77986a;_0x4dc2be[_0x12e1ce(0x202)](path[_0x12e1ce(0x2c6)](__dirname,bbpath2,_0x12e1ce(0x227),_0x12e1ce(0x2fc)));});if(HOST)http[_0x77986a(0x12f)](PORT,HOST);else http[_0x77986a(0x12f)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x163bd6=_0x77986a;let _0x11bc27=_0x163bd6(0x28d);const _0x383693=networkInterfaces(),_0x3a4bfa={};for(const _0xe564f3 of Object[_0x163bd6(0x1d2)](_0x383693)){for(const _0x1f3caa of _0x383693[_0xe564f3]){if((_0x1f3caa['family']==_0x163bd6(0x19b)||_0x1f3caa['family']==0x4)&&!_0x1f3caa[_0x163bd6(0x167)]){const _0x532b8b=ipaddr[_0x163bd6(0x20f)](_0x1f3caa[_0x163bd6(0x122)])[_0x163bd6(0x205)]();_0x532b8b!=_0x163bd6(0x1fb)&&(!_0x3a4bfa[_0xe564f3]&&(_0x3a4bfa[_0xe564f3]=[]),_0x3a4bfa[_0xe564f3][_0x163bd6(0x27b)](_0x1f3caa['address']),_0x11bc27=_0x1f3caa[_0x163bd6(0x122)]);}}}return{'serverip':_0x11bc27,'netinterfaces':_0x3a4bfa};}async function startServer(){const _0x4bbfc9=_0x77986a,{serverip:_0x4c067c,netinterfaces:_0x5044fe}=getServerIP();logger[_0x4bbfc9(0x253)](''),logger[_0x4bbfc9(0x253)]('-----------------------------------------------------------------------------------'),await logger[_0x4bbfc9(0x1c9)](_0x4bbfc9(0x145)+serverversion+_0x4bbfc9(0x2c9)+(environment=='staging'?_0x4bbfc9(0x292):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x4bbfc9(0x12d))+(_0x4bbfc9(0x1d7)+_0x4c067c+':'+PORT+_0x4bbfc9(0x1fa))),logger['simple'](_0x4bbfc9(0x1c0));if(config['length']!=0x0)for(const _0xaaa7aa of config){const _0x2449b6=_0xaaa7aa[_0x4bbfc9(0x2dc)]==_0x4bbfc9(0x29e)?'a':'m';if(_0xaaa7aa['status']=='enabled'||_0xaaa7aa[_0x4bbfc9(0x277)]==_0x4bbfc9(0x2dd))await logger[_0x4bbfc9(0x1c9)]('Starting\x20('+_0x2449b6+_0x4bbfc9(0xec)+_0xaaa7aa[_0x4bbfc9(0x1ff)]+_0x4bbfc9(0x2da)+_0xaaa7aa[_0x4bbfc9(0x1c7)]),startBot([_0xaaa7aa[_0x4bbfc9(0x1ff)],userID],{'cwd':bbpath},function(_0x5d2f85){const _0x1a0318=_0x4bbfc9;if(_0x5d2f85)logger[_0x1a0318(0x1c9)](_0x5d2f85);});else(_0xaaa7aa[_0x4bbfc9(0x277)]==_0x4bbfc9(0xe9)||_0xaaa7aa['status']=='new-disabled')&&await logger[_0x4bbfc9(0x1c9)]('Idling\x20('+_0x2449b6+_0x4bbfc9(0x12e)+_0xaaa7aa[_0x4bbfc9(0x1ff)]+_0x4bbfc9(0x2da)+_0xaaa7aa[_0x4bbfc9(0x1c7)]);}else!newBot&&logger[_0x4bbfc9(0x253)](_0x4bbfc9(0x13d));if(newBot)addBot();logger[_0x4bbfc9(0x253)](_0x4bbfc9(0x1c0)),logger[_0x4bbfc9(0x253)](''),await logger[_0x4bbfc9(0x1ae)]('Node.js\x20v'+nodeversion),await logger[_0x4bbfc9(0x1ae)](_0x4bbfc9(0x10a),_0x5044fe);}function startSocket(){const _0x4f883a=_0x77986a;io['on'](_0x4f883a(0x278),_0x15644d=>{const _0x31f682=_0x4f883a;let _0x16efae,_0x7df26b,_0x15c485,_0x5497fb,_0x1818eb;const _0x42f874=_0x15644d['handshake'][_0x31f682(0x17a)][_0x31f682(0x251)];_0x7df26b=_0x42f874[_0x31f682(0x1e8)](/bot[0-9]{3}/);if(_0x7df26b)_0x15c485=_0x7df26b[0x0][_0x31f682(0x1e8)](/[0-9]{3}/);if(_0x15c485)_0x16efae=_0x15c485[0x0];else _0x16efae=_0x31f682(0xf7);const _0x5061d9=_0x15644d[_0x31f682(0x2f8)][_0x31f682(0x237)][_0x31f682(0x15e)];if(!_0x5061d9)_0x15644d[_0x31f682(0x161)](_0x31f682(0x277),{'publicKey':secure[_0x31f682(0x2d2)]});else{_0x5497fb=timelyDecrypt(_0x5061d9,![]);if(!_0x5497fb)_0x15644d[_0x31f682(0x161)]('status',{'publicKey':secure[_0x31f682(0x2d2)]});else{_0x1818eb=normalizeIP(_0x15644d[_0x31f682(0x24e)]['remoteAddress'])['store'];if(!devices[_0x5497fb])devices[_0x5497fb]={'uuid':_0x5497fb,'access':{'token':null}};devices[_0x5497fb]['ip']=_0x1818eb;const _0x3b49e0=addClient(_0x15644d['id'],_0x5497fb,_0x16efae);setAccess(_0x3b49e0),emitMessages(),_0x15644d['on'](_0x31f682(0x10b),_0x1f9d43=>{const _0x4423ae=_0x31f682,_0x22a4bb=timelyDecrypt(_0x1f9d43['password'],!![],_0x4423ae(0x2db));if(_0x22a4bb){_0x1f9d43={'username':_0x1f9d43[_0x4423ae(0x2e2)],'password':_0x22a4bb},devices[_0x5497fb][_0x4423ae(0x2f5)]=validateCredentials(_0x1f9d43,_0x5497fb);if(devices[_0x5497fb][_0x4423ae(0x2f5)][_0x4423ae(0x1b1)]==![]&&devices[_0x5497fb][_0x4423ae(0x2f5)][_0x4423ae(0x16d)]=='2FA\x20login\x20required')_0x15644d['emit'](_0x4423ae(0x277),{'access':devices[_0x5497fb][_0x4423ae(0x2f5)]}),loginAccess2FA(_0x5497fb,_0x1818eb);else{if(devices[_0x5497fb][_0x4423ae(0x2f5)][_0x4423ae(0x1b1)]==![]&&devices[_0x5497fb][_0x4423ae(0x2f5)][_0x4423ae(0x16d)]==_0x4423ae(0x23c))_0x15644d[_0x4423ae(0x161)]('status',{'access':devices[_0x5497fb]['access']});else devices[_0x5497fb]['access'][_0x4423ae(0x1b1)]&&devices[_0x5497fb][_0x4423ae(0x2f5)]['reason']==_0x4423ae(0x181)&&(getClientsWithUuid(_0x5497fb)[_0x4423ae(0x106)](_0x1dc276=>{setAccess(_0x1dc276);}),logger[_0x4423ae(0x1ae)]('Logged\x20in\x20user\x20...'+_0x5497fb[_0x4423ae(0x2bf)](-0x8)),setTokenRefresh(_0x5497fb),setSessionTimeout(_0x4423ae(0x10b),_0x5497fb));}}else logger[_0x4423ae(0x1c9)](_0x4423ae(0x239));}),_0x15644d['on']('reset-password',()=>{resetPassword();}),_0x15644d['on'](_0x31f682(0x196),_0x5cd832=>{removeClient(_0x15644d['id']);}),_0x16efae==_0x31f682(0xf7)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x18ac5b){const _0x5706e4=_0x77986a;if(_0x18ac5b!=_0x5706e4(0xf7)&&config[_0x5706e4(0x1b2)]!=''){if(pid[_0x18ac5b])pid[_0x18ac5b][_0x5706e4(0x204)]({'function':'initclient','args':null});}_0x18ac5b!=_0x5706e4(0xf7)&&broadcastToBots(_0x5706e4(0xf8),JSON[_0x5706e4(0xf3)](config));}function reloadBotManager(){const _0x455906=_0x77986a;getClientsWithBotID('botmanager')[_0x455906(0x106)](_0x481171=>{const _0x273e06=_0x455906;getSocket(_0x481171['id'])[_0x273e06(0x161)](_0x273e06(0x277),{'access':{'allow':![],'reason':_0x273e06(0x2fb),'token':null}});});}function getSocket(_0x1acb27){const _0x5eb463=_0x77986a,_0x15daf6=io[_0x5eb463(0x175)][_0x5eb463(0x164)]('/');return _0x15daf6[_0x5eb463(0x206)]['get'](_0x1acb27);}function setAccess(_0x462bb6){const _0x2ec2ec=_0x77986a,_0x159d3d=getSocket(_0x462bb6['id']),_0x2905bc=_0x462bb6[_0x2ec2ec(0x28a)],_0x37e795=_0x462bb6[_0x2ec2ec(0x14d)];devices[_0x2905bc][_0x2ec2ec(0x2f5)]=validateAccess(devices[_0x2905bc][_0x2ec2ec(0x2f5)]['token'],_0x2905bc),logger['debug'](_0x2ec2ec(0x147)+devices[_0x2905bc][_0x2ec2ec(0x2f5)][_0x2ec2ec(0x16d)]+_0x2ec2ec(0x295)+_0x462bb6['id']['slice'](-0x8)+'\x20|\x20user:\x20...'+_0x2905bc[_0x2ec2ec(0x2bf)](-0x8)),_0x159d3d['join'](_0x2905bc);if(devices[_0x2905bc][_0x2ec2ec(0x2f5)]['allow']){_0x159d3d['join'](_0x37e795);if(_0x37e795=='botmanager')initializeSocketBotManager(_0x159d3d);else initializeSocketBot(_0x159d3d);initClient(_0x37e795);}devices[_0x2905bc][_0x2ec2ec(0x2f5)][_0x2ec2ec(0x102)]&&devices[_0x2905bc][_0x2ec2ec(0x2f5)][_0x2ec2ec(0x16d)]==_0x2ec2ec(0x1cf)&&setSessionTimeout(_0x2ec2ec(0xfb),_0x2905bc),devices[_0x2905bc]['access'][_0x2ec2ec(0x102)]&&devices[_0x2905bc][_0x2ec2ec(0x2f5)][_0x2ec2ec(0x16d)]==_0x2ec2ec(0x14f)&&setSessionTimeout(_0x2ec2ec(0x10b),_0x2905bc),_0x159d3d['emit'](_0x2ec2ec(0x277),{'status':_0x462bb6[_0x2ec2ec(0x1ed)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2905bc]['access'],'externalip':devices[_0x2905bc]['ip'],'publicKey':secure[_0x2ec2ec(0x2d2)],'userid':settings[_0x2ec2ec(0x27e)],'validInstallation':validInstallation}),devices[_0x2905bc][_0x2ec2ec(0x2f5)][_0x2ec2ec(0x1b1)]==![]&&devices[_0x2905bc][_0x2ec2ec(0x2f5)][_0x2ec2ec(0x16d)]==_0x2ec2ec(0xe7)&&temporaryAccess2FA(_0x2905bc,devices[_0x2905bc]['ip']);}function setSessionTimeout(_0x25e433,_0x4e9acd){const _0x83c12=_0x77986a;let _0x214bf3;if(_0x25e433==_0x83c12(0x10b))_0x214bf3=loginExpiry*0x3c*0x3e8;else _0x214bf3=devices[_0x4e9acd]['telegramIpApproval'][_0x83c12(0x10f)]*0x3c*0x3e8-(new Date()[_0x83c12(0x10c)]()-devices[_0x4e9acd][_0x83c12(0x118)][_0x83c12(0x26e)]);if(devices[_0x4e9acd][_0x83c12(0x2af)])clearTimeout(devices[_0x4e9acd][_0x83c12(0x2af)]);devices[_0x4e9acd]['pidExpireLogin']=setTimeout(()=>{const _0x11162d=_0x83c12;if(devices[_0x4e9acd][_0x11162d(0x22e)])clearTimeout(devices[_0x4e9acd][_0x11162d(0x22e)]);removeSocketListeners(_0x4e9acd),addBlacklist(_0x4e9acd),devices[_0x4e9acd][_0x11162d(0x118)]=null,devices[_0x4e9acd][_0x11162d(0x186)]=null,devices[_0x4e9acd][_0x11162d(0x2f5)][_0x11162d(0x102)]=null,logger[_0x11162d(0x1ae)](_0x11162d(0x2cb)+_0x4e9acd['slice'](-0x8)),devices[_0x4e9acd][_0x11162d(0x2f5)]=validateAccess(devices[_0x4e9acd][_0x11162d(0x2f5)][_0x11162d(0x102)],_0x4e9acd),!(devices[_0x4e9acd]['access']['allow']&&devices[_0x4e9acd][_0x11162d(0x2f5)][_0x11162d(0x16d)]==_0x11162d(0x163))&&(_0x25e433=='login'?io['to'](_0x4e9acd)[_0x11162d(0x161)]('status',{'access':{'allow':![],'reason':_0x11162d(0x1f0),'token':null}}):io['to'](_0x4e9acd)['emit'](_0x11162d(0x277),{'access':{'allow':![],'reason':_0x11162d(0x1ea),'token':null}})),devices[_0x4e9acd][_0x11162d(0x2f5)][_0x11162d(0x102)]=null;},_0x214bf3);}function setTokenRefresh(_0x3f7de5){const _0x2e08c0=_0x77986a;if(devices[_0x3f7de5][_0x2e08c0(0x22e)])clearTimeout(devices[_0x3f7de5][_0x2e08c0(0x22e)]);devices[_0x3f7de5][_0x2e08c0(0x22e)]=setTimeout(()=>{const _0x477ff2=_0x2e08c0;getClientsWithUuid(_0x3f7de5)['length']!=0x0?(devices[_0x3f7de5][_0x477ff2(0x2f5)]=refreshToken(_0x3f7de5),io['to'](_0x3f7de5)[_0x477ff2(0x161)](_0x477ff2(0x277),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3f7de5][_0x477ff2(0x2f5)],'externalip':devices[_0x3f7de5]['ip'],'publicKey':secure[_0x477ff2(0x2d2)],'validInstallation':validInstallation}),setTokenRefresh(_0x3f7de5)):clearTimeout(devices[_0x3f7de5][_0x477ff2(0x22e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xfe3694){const _0x45936c=_0x77986a,_0x44f1f5=getClient(_0xfe3694['id'])[_0x45936c(0x28a)];_0xfe3694['emit'](_0x45936c(0xf8),config),_0xfe3694[_0x45936c(0x161)](_0x45936c(0x2e8),cleanSettings()),_0xfe3694['on'](_0x45936c(0x26f),_0x37244a=>{const _0x492702=_0x45936c;if(validateAccess(_0x37244a,_0x44f1f5)[_0x492702(0x1b1)])addBot();else logger['full'](_0x492702(0x14c));}),_0xfe3694['on'](_0x45936c(0x208),(_0x2afcd5,_0x171231)=>{const _0x2ec415=_0x45936c;if(validateAccess(_0x171231,_0x44f1f5)['allow'])toggleBot(_0x2afcd5[_0x2ec415(0x1ff)],_0x2afcd5[_0x2ec415(0x277)],_0x2afcd5[_0x2ec415(0x1a3)]);else logger[_0x2ec415(0x1c9)](_0x2ec415(0x1f8));}),_0xfe3694['on'](_0x45936c(0x2e9),(_0x205da8,_0x50c57f)=>{const _0xbcd266=_0x45936c;if(validateAccess(_0x50c57f,_0x44f1f5)[_0xbcd266(0x1b1)])toggleBotMode(_0x205da8);else logger[_0xbcd266(0x1c9)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0xfe3694['on'](_0x45936c(0x1ec),(_0x514f82,_0x4efb1a)=>{const _0x2a153e=_0x45936c;if(validateAccess(_0x4efb1a,_0x44f1f5)['allow'])deleteBot(_0x514f82);else logger[_0x2a153e(0x1c9)](_0x2a153e(0x125));}),_0xfe3694['on']('store-settings',(_0x2f4145,_0x3bc773)=>{const _0x828a87=_0x45936c;if(validateAccess(_0x3bc773,_0x44f1f5)[_0x828a87(0x1b1)])storeSettings(_0x2f4145,!![]);else logger[_0x828a87(0x1c9)](_0x828a87(0x2eb));}),_0xfe3694['on'](_0x45936c(0x250),_0xb57235=>{const _0x622d83=_0x45936c;if(validateAccess(_0xb57235,_0x44f1f5)[_0x622d83(0x1b1)])updateBB(_0x622d83(0x12a));else logger['full'](_0x622d83(0x133));}),_0xfe3694['on'](_0x45936c(0x192),_0x2c5f09=>{const _0x5e9c83=_0x45936c;if(validateAccess(_0x2c5f09,_0x44f1f5)[_0x5e9c83(0x1b1)])updateBB(_0x5e9c83(0x273));else logger[_0x5e9c83(0x1c9)](_0x5e9c83(0x2bc));}),_0xfe3694['on'](_0x45936c(0x1e6),_0x236ef8=>{const _0x46db35=_0x45936c;if(validateAccess(_0x236ef8,_0x44f1f5)['allow']){const _0x4ee99d=getClient(_0xfe3694['id']);if(_0x4ee99d)getBackupFiles(_0x4ee99d[_0x46db35(0x28a)]);else logger[_0x46db35(0x1c9)](_0x46db35(0x18e));}else logger[_0x46db35(0x1c9)](_0x46db35(0x108));}),_0xfe3694['on'](_0x45936c(0x294),(_0x44b4e6,_0x5350c0)=>{const _0x345bd5=_0x45936c;if(validateAccess(_0x5350c0,_0x44f1f5)[_0x345bd5(0x1b1)])restoreBackupFile(_0x44b4e6);else logger[_0x345bd5(0x1c9)](_0x345bd5(0x2d9));}),_0xfe3694['on'](_0x45936c(0x211),_0x4d0958=>{const _0x3bd3ad=_0x45936c;if(validateAccess(_0x4d0958,_0x44f1f5)[_0x3bd3ad(0x1b1)])getMessages();else logger[_0x3bd3ad(0x1c9)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0xfe3694['on'](_0x45936c(0x141),(_0x519c41,_0x260601)=>{const _0x5d9dea=_0x45936c;if(validateAccess(_0x260601,_0x44f1f5)[_0x5d9dea(0x1b1)])confirmMessage(_0x519c41);else logger[_0x5d9dea(0x1c9)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0xfe3694['on'](_0x45936c(0x1b7),_0x5df685=>{const _0x23d0a8=_0x45936c;if(validateAccess(_0x5df685,_0x44f1f5)[_0x23d0a8(0x1b1)]){if(devices[_0x44f1f5]['pidRefreshToken'])clearTimeout(devices[_0x44f1f5][_0x23d0a8(0x22e)]);if(devices[_0x44f1f5][_0x23d0a8(0x2af)])clearTimeout(devices[_0x44f1f5][_0x23d0a8(0x2af)]);removeSocketListeners(getClient(_0xfe3694['id'])[_0x23d0a8(0x28a)]),addBlacklist(_0x44f1f5),devices[_0x44f1f5]['telegramIpApproval']=null,devices[_0x44f1f5]['telegram2FaApproval']=null,devices[_0x44f1f5][_0x23d0a8(0x2f5)]['token']=null,logger['debug'](_0x23d0a8(0x27c)+_0x44f1f5[_0x23d0a8(0x2bf)](-0x8)),io['to'](getClient(_0xfe3694['id'])[_0x23d0a8(0x28a)])[_0x23d0a8(0x161)](_0x23d0a8(0x277),{'access':{'allow':![],'reason':_0x23d0a8(0x1a9),'token':null}});}else logger[_0x23d0a8(0x1c9)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x4a871c){const _0x5a6de6=_0x77986a,_0x2f59cb=getClient(_0x4a871c['id'])[_0x5a6de6(0x14d)],_0x486baa=getClient(_0x4a871c['id'])[_0x5a6de6(0x28a)];_0x4a871c['on'](_0x5a6de6(0x193),(_0x2ab921,_0x29f68c)=>{const _0x27e3e0=_0x5a6de6;if(validateAccess(_0x29f68c,_0x486baa)['allow']){if(pid[_0x2f59cb])pid[_0x2f59cb][_0x27e3e0(0x204)]({'function':_0x27e3e0(0xfc),'args':_0x2ab921});}else logger[_0x27e3e0(0x1c9)](_0x27e3e0(0x158));}),_0x4a871c['on'](_0x5a6de6(0x1e0),(_0x19ca60,_0x4e15c0)=>{const _0x41a271=_0x5a6de6;if(validateAccess(_0x4e15c0,_0x486baa)[_0x41a271(0x1b1)]){if(pid[_0x2f59cb])pid[_0x2f59cb][_0x41a271(0x204)]({'function':_0x41a271(0x18d),'args':_0x19ca60});}else logger['full'](_0x41a271(0x2b0));}),_0x4a871c['on'](_0x5a6de6(0x207),(_0x5926b6,_0x428f67)=>{const _0x1e42ba=_0x5a6de6;if(validateAccess(_0x428f67,_0x486baa)[_0x1e42ba(0x1b1)]){if(pid[_0x2f59cb])pid[_0x2f59cb][_0x1e42ba(0x204)]({'function':_0x1e42ba(0x240),'args':_0x5926b6});}else logger[_0x1e42ba(0x1c9)](_0x1e42ba(0x23f));}),_0x4a871c['on'](_0x5a6de6(0xee),(_0x39462a,_0x396d8b)=>{const _0x19a2af=_0x5a6de6;if(validateAccess(_0x396d8b,_0x486baa)['allow']){if(pid[_0x2f59cb])pid[_0x2f59cb][_0x19a2af(0x204)]({'function':_0x19a2af(0xea),'args':_0x39462a});}else logger[_0x19a2af(0x1c9)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x4a871c['on'](_0x5a6de6(0x285),(_0x188329,_0x46af50)=>{const _0x1b1e87=_0x5a6de6;if(validateAccess(_0x46af50,_0x486baa)[_0x1b1e87(0x1b1)]){if(pid[_0x2f59cb])pid[_0x2f59cb][_0x1b1e87(0x204)]({'function':'storeHeadless','args':_0x188329});}else logger[_0x1b1e87(0x1c9)](_0x1b1e87(0xe2));}),_0x4a871c['on'](_0x5a6de6(0x1b3),(_0x2e3d41,_0x3ff628)=>{const _0x22b511=_0x5a6de6;if(validateAccess(_0x3ff628,_0x486baa)[_0x22b511(0x1b1)]){if(pid[_0x2f59cb])pid[_0x2f59cb][_0x22b511(0x204)]({'function':_0x22b511(0x258),'args':_0x2e3d41});}else logger[_0x22b511(0x1c9)](_0x22b511(0x14b));}),_0x4a871c['on'](_0x5a6de6(0x297),_0x31f95d=>{const _0x5bfcf4=_0x5a6de6;if(validateAccess(_0x31f95d,_0x486baa)[_0x5bfcf4(0x1b1)]){if(pid[_0x2f59cb])pid[_0x2f59cb][_0x5bfcf4(0x204)]({'function':_0x5bfcf4(0x179),'args':null});}else logger[_0x5bfcf4(0x1c9)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x4a871c['on'](_0x5a6de6(0x2cd),_0x43e23d=>{const _0x354083=_0x5a6de6;if(validateAccess(_0x43e23d,_0x486baa)['allow']){if(pid[_0x2f59cb])pid[_0x2f59cb][_0x354083(0x204)]({'function':_0x354083(0x212),'args':null});}else logger['full'](_0x354083(0x24d));}),_0x4a871c['on'](_0x5a6de6(0x23a),(_0x41cfac,_0x5be3ce)=>{const _0x1ee43f=_0x5a6de6;if(validateAccess(_0x5be3ce,_0x486baa)[_0x1ee43f(0x1b1)]){if(pid[_0x2f59cb])pid[_0x2f59cb][_0x1ee43f(0x204)]({'function':'placeOrder','args':_0x41cfac});}else logger['full'](_0x1ee43f(0x18f));}),_0x4a871c['on'](_0x5a6de6(0x2a2),_0x212960=>{const _0x423e6f=_0x5a6de6;if(validateAccess(_0x212960,_0x486baa)['allow']){if(pid[_0x2f59cb])pid[_0x2f59cb][_0x423e6f(0x204)]({'function':'cancelLoading','args':null});}else logger[_0x423e6f(0x1c9)](_0x423e6f(0x1fd));}),_0x4a871c['on'](_0x5a6de6(0x190),_0x43d585=>{const _0x38dba6=_0x5a6de6;if(validateAccess(_0x43d585,_0x486baa)['allow']){if(pid[_0x2f59cb])pid[_0x2f59cb][_0x38dba6(0x204)]({'function':_0x38dba6(0x2ae),'args':null});}else logger[_0x38dba6(0x1c9)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x4a871c['on'](_0x5a6de6(0x250),_0x384128=>{const _0x3dfb26=_0x5a6de6;if(validateAccess(_0x384128,_0x486baa)[_0x3dfb26(0x1b1)])updateBB(_0x3dfb26(0x12a));else logger[_0x3dfb26(0x1c9)](_0x3dfb26(0x133));}),_0x4a871c['on']('get-messages',_0x261d4d=>{const _0x11b8b9=_0x5a6de6;if(validateAccess(_0x261d4d,_0x486baa)[_0x11b8b9(0x1b1)])getMessages();else logger['full'](_0x11b8b9(0x2c0));}),_0x4a871c['on']('confirm-message',(_0x443ef8,_0x2d7357)=>{const _0x4e0ee8=_0x5a6de6;if(validateAccess(_0x2d7357,_0x486baa)[_0x4e0ee8(0x1b1)])confirmMessage(_0x443ef8);else logger[_0x4e0ee8(0x1c9)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x4a871c['on']('logout',_0xaff20=>{const _0x3137e8=_0x5a6de6;if(validateAccess(_0xaff20,_0x486baa)['allow']){if(devices[_0x486baa][_0x3137e8(0x22e)])clearTimeout(devices[_0x486baa][_0x3137e8(0x22e)]);if(devices[_0x486baa][_0x3137e8(0x2af)])clearTimeout(devices[_0x486baa][_0x3137e8(0x2af)]);removeSocketListeners(getClient(_0x4a871c['id'])[_0x3137e8(0x28a)]),addBlacklist(_0x486baa),devices[_0x486baa][_0x3137e8(0x118)]=null,devices[_0x486baa]['telegram2FaApproval']=null,devices[_0x486baa]['access'][_0x3137e8(0x102)]=null,logger['debug'](_0x3137e8(0x27c)+_0x486baa[_0x3137e8(0x2bf)](-0x8)),io['to'](getClient(_0x4a871c['id'])[_0x3137e8(0x28a)])['emit']('status',{'access':{'allow':![],'reason':_0x3137e8(0x1a9),'token':null}});}else logger[_0x3137e8(0x1c9)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x46b737){const _0x2ec14d=_0x77986a;getClientsWithUuid(_0x46b737)[_0x2ec14d(0x106)](_0x2255cb=>{const _0x430dbc=_0x2ec14d;getSocket(_0x2255cb['id'])[_0x430dbc(0x127)]();});}function cleanSettings(){const _0x979c9a=_0x77986a;let _0x20f3d3=settings;return settings['telegramToken']&&settings[_0x979c9a(0x2cf)]!=''&&(_0x20f3d3={..._0x20f3d3,'telegramToken':_0x979c9a(0x18b)}),settings['bbPassword']&&settings[_0x979c9a(0x10e)]!=''&&(_0x20f3d3={..._0x20f3d3,'bbPassword':_0x979c9a(0x18b)}),settings[_0x979c9a(0x28c)]&&settings['marketcapApi']!=''&&(_0x20f3d3={..._0x20f3d3,'marketcapApi':'************'}),(settings['bbPassword']&&settings[_0x979c9a(0x10e)]==_0x979c9a(0x2f3)||settings[_0x979c9a(0x2cf)]&&settings[_0x979c9a(0x2cf)]=='***'||settings['marketcapApi']&&settings['marketcapApi']=='***')&&(_0x20f3d3={..._0x20f3d3,'restored':{'password':settings['bbPassword']=='***','telegram':settings[_0x979c9a(0x2cf)]==_0x979c9a(0x2f3),'marketcap':settings[_0x979c9a(0x28c)]==_0x979c9a(0x2f3)}}),_0x20f3d3;}async function updateBB(_0x24f731){const _0x64b9ab=_0x77986a;await backupConfigFiles(),installingUpdate=!![],config[_0x64b9ab(0x106)](_0x47ef35=>{const _0x363d59=_0x64b9ab;restartBot(_0x47ef35[_0x363d59(0x1ff)]);});if(_0x24f731==_0x64b9ab(0x12a))process[_0x64b9ab(0x204)]({'update':!![],'environment':environment},_0x526f4b=>{});else _0x24f731==_0x64b9ab(0x273)&&process[_0x64b9ab(0x204)]({'reinstall':!![],'environment':environment},_0x15dd79=>{});}function startBot(_0x415369,_0x37caad,_0x3acabf){const _0x35f58d=_0x77986a;if(debugging)_0x415369[_0x35f58d(0x27b)]('-d');let _0x13636b=![];const _0x1f1660=_0x415369[0x0];_0x37caad={..._0x37caad,'stdio':['inherit','inherit',_0x35f58d(0x272),_0x35f58d(0x2e4)]},pid[_0x1f1660]=childProcess[_0x35f58d(0x13f)](botfile,_0x415369,_0x37caad),pid[_0x1f1660]['on'](_0x35f58d(0x29d),_0xaf6352=>{const _0x187c9f=_0x35f58d;switch(Object[_0x187c9f(0x1d2)](_0xaf6352)[0x0]){case _0x187c9f(0x1c7):updateBotName(_0x1f1660,_0xaf6352[_0x187c9f(0x1c7)]);break;case _0x187c9f(0xe1):updateBotManager();break;case _0x187c9f(0x277):updateStatus(_0x1f1660,_0xaf6352[_0x187c9f(0x277)]);break;case'live':updateLive(_0x1f1660,_0xaf6352[_0x187c9f(0x1a3)]);break;case _0x187c9f(0x262):updateLive(_0x1f1660,_0xaf6352[_0x187c9f(0x262)]),io['to'](_0x1f1660)['emit']('status',{'access':{'allow':![],'reason':_0x187c9f(0x2fb),'token':null}});break;case'stop':_0xaf6352[_0x187c9f(0x26d)]=='restart'&&restartBot(_0x1f1660);_0xaf6352[_0x187c9f(0x26d)]=='kill'&&toggleBot(_0x1f1660,_0x187c9f(0xe9),_0x187c9f(0x25c));break;case _0x187c9f(0x28b):sendTelegramBot(_0x1f1660,_0xaf6352[_0x187c9f(0x28b)]);break;case _0x187c9f(0x2a1):sendTelegramMsg(_0xaf6352[_0x187c9f(0x2a1)]);break;case _0x187c9f(0x218):io['to'](_0x1f1660)['emit'](_0xaf6352[_0x187c9f(0x218)],_0xaf6352[_0x187c9f(0x2e3)]);break;}}),pid[_0x1f1660]['on'](_0x35f58d(0x2fa),function(_0x144f86){if(_0x13636b)return;_0x13636b=!![],_0x3acabf(_0x144f86);}),pid[_0x1f1660]['on'](_0x35f58d(0x284),async function(_0x20a499){const _0x405b03=_0x35f58d;if(terminating)return;if(installingUpdate){io[_0x405b03(0x223)]();return;}if(_0x13636b)return;_0x13636b=!![],_0x3acabf(null);const _0x10dc55=dbConfig['get'](_0x405b03(0xf8))[_0x405b03(0x2d5)]({'botID':_0x1f1660})['value']();_0x10dc55&&(_0x10dc55[_0x405b03(0x277)]=='enabled'||_0x10dc55['status']=='new')&&(await sleep(0x3e8),updateLive(_0x1f1660,_0x405b03(0x25c)),logger['full']('Restarting\x20Bot\x20'+_0x1f1660),startBot([_0x1f1660,userID],{'cwd':bbpath},function(_0x463112){const _0x458448=_0x405b03;if(_0x463112)logger[_0x458448(0x1c9)](_0x463112);}));});}function stopBot(_0x5d350b){const _0x68395e=_0x77986a;getClientsWithBotID(_0x5d350b)[_0x68395e(0x106)](_0x5c4052=>{const _0x90f4d=_0x68395e;getSocket(_0x5c4052['id'])[_0x90f4d(0x196)](!![]),removeClient(_0x5c4052['id']);}),pid[_0x5d350b]&&(pid[_0x5d350b][_0x68395e(0x2d0)](),pid[_0x5d350b]=null);}function stopAllBots(){const _0x74c462=_0x77986a;terminating=!![];const _0x157960=getEnabledBots();_0x157960[_0x74c462(0x106)](_0x5281dc=>{stopBot(_0x5281dc['botID']);});}function restartBot(_0x3b4fa4){const _0x1ab1c5=_0x77986a;if(pid[_0x3b4fa4])pid[_0x3b4fa4][_0x1ab1c5(0x2d0)]();}function addBot(){const _0x39ece7=_0x77986a;let _0x487816;for(let _0x316a93=0x1;_0x316a93<0x3e9;_0x316a93++){_0x487816=_0x316a93[_0x39ece7(0x25f)]()[_0x39ece7(0x246)](0x3,'0');let _0x5561bd=config['find'](_0x2b1fb1=>_0x2b1fb1[_0x39ece7(0x1ff)]==_0x487816);if(!_0x5561bd)break;}if(_0x487816===_0x39ece7(0x25e)){logger['full']('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x39ece7(0x1c9)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x487816),dbConfig[_0x39ece7(0x164)](_0x39ece7(0xf8))[_0x39ece7(0x27b)]({'botID':_0x487816,'botname':'Bot\x20'+_0x487816,'status':_0x39ece7(0x2dd),'live':''})[_0x39ece7(0x15f)](),startBot([_0x487816,userID],{'cwd':bbpath},function(_0x29291d){const _0x559fd5=_0x39ece7;if(_0x29291d)logger[_0x559fd5(0x1c9)](_0x29291d);}),config=getConfiguration(),io['to']('botmanager')[_0x39ece7(0x161)](_0x39ece7(0xf8),config),broadcastToBots(_0x39ece7(0xf8),JSON[_0x39ece7(0xf3)](config));}function deleteBot(_0x24f38a){const _0x7b6e0c=_0x77986a;getClientsWithBotID(_0x24f38a)[_0x7b6e0c(0x106)](_0x4ce014=>{const _0x4c08ba=_0x7b6e0c;getSocket(_0x4ce014['id'])[_0x4c08ba(0x196)](!![]),removeClient(_0x4ce014['id']);}),dbConfig['get'](_0x7b6e0c(0xf8))[_0x7b6e0c(0x259)]({'botID':_0x24f38a})[_0x7b6e0c(0x15f)](),logger['full']('Deleted\x20Bot\x20'+_0x24f38a),stopBot(_0x24f38a);try{if(fs[_0x7b6e0c(0x2ba)](path['join'](configpath,_0x7b6e0c(0x296)+_0x24f38a+_0x7b6e0c(0x229))))fs[_0x7b6e0c(0x2e7)](path[_0x7b6e0c(0x2c6)](configpath,'bot-'+_0x24f38a+_0x7b6e0c(0x229)));if(fs[_0x7b6e0c(0x2ba)](path[_0x7b6e0c(0x2c6)](configpath,_0x7b6e0c(0x296)+_0x24f38a+_0x7b6e0c(0x22c))))fs[_0x7b6e0c(0x2e7)](path[_0x7b6e0c(0x2c6)](configpath,_0x7b6e0c(0x296)+_0x24f38a+'-events.json'));if(fs['existsSync'](path[_0x7b6e0c(0x2c6)](configpath,'bot-'+_0x24f38a+'-performance.json')))fs['unlinkSync'](path[_0x7b6e0c(0x2c6)](configpath,_0x7b6e0c(0x296)+_0x24f38a+_0x7b6e0c(0x1aa)));if(fs[_0x7b6e0c(0x2ba)](path[_0x7b6e0c(0x2c6)](configpath,_0x7b6e0c(0x296)+_0x24f38a+_0x7b6e0c(0x19a))))fs[_0x7b6e0c(0x2e7)](path['join'](configpath,'bot-'+_0x24f38a+_0x7b6e0c(0x19a)));}catch(_0x1423d5){if(_0x1423d5)logger[_0x7b6e0c(0x1c9)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x1423d5);}config=getConfiguration(),io['to'](_0x7b6e0c(0xf7))['emit']('bots',config),broadcastToBots(_0x7b6e0c(0xf8),JSON[_0x7b6e0c(0xf3)](config));}function toggleBot(_0x325b8d,_0x1f6b1e,_0x28fd51){const _0x3eb7c4=_0x77986a;dbConfig[_0x3eb7c4(0x164)]('bots')['find']({'botID':_0x325b8d})[_0x3eb7c4(0x282)]({'status':_0x1f6b1e})[_0x3eb7c4(0x282)]({'live':_0x28fd51})[_0x3eb7c4(0x15f)]();if(_0x1f6b1e==_0x3eb7c4(0x290)||_0x1f6b1e==_0x3eb7c4(0x2dd))logger[_0x3eb7c4(0x1c9)](_0x3eb7c4(0x24f)+_0x325b8d),startBot([_0x325b8d,userID],{'cwd':bbpath},function(_0xd4044a){const _0x5d5565=_0x3eb7c4;if(_0xd4044a)logger[_0x5d5565(0x1c9)](_0xd4044a);});else(_0x1f6b1e==_0x3eb7c4(0xe9)||_0x1f6b1e=='new-disabled')&&(logger[_0x3eb7c4(0x1c9)]('Disabled\x20Bot\x20'+_0x325b8d),stopBot(_0x325b8d));config=getConfiguration(),io['to'](_0x3eb7c4(0xf7))[_0x3eb7c4(0x161)](_0x3eb7c4(0xf8),config),broadcastToBots(_0x3eb7c4(0xf8),JSON[_0x3eb7c4(0xf3)](config));}function toggleStatus(_0x4690b8){const _0x2307e2=_0x77986a;let _0x4eb73a=dbConfig[_0x2307e2(0x164)](_0x2307e2(0xf8))[_0x2307e2(0x2d5)]({'botID':_0x4690b8})['value'](),_0x5b04ff;if(_0x4eb73a[_0x2307e2(0x277)]===_0x2307e2(0x290))_0x5b04ff=_0x2307e2(0xe9);else{if(_0x4eb73a[_0x2307e2(0x277)]===_0x2307e2(0x2dd))_0x5b04ff=_0x2307e2(0x115);else{if(_0x4eb73a[_0x2307e2(0x277)]===_0x2307e2(0x115))_0x5b04ff=_0x2307e2(0x2dd);else{if(_0x4eb73a['status']===_0x2307e2(0xe9))_0x5b04ff=_0x2307e2(0x290);}}}return _0x5b04ff;}function updateStatus(_0x24ee32,_0x173753){const _0x248a33=_0x77986a;dbConfig[_0x248a33(0x164)](_0x248a33(0xf8))[_0x248a33(0x2d5)]({'botID':_0x24ee32})['assign']({'status':_0x173753})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x248a33(0x161)](_0x248a33(0xf8),config),broadcastToBots(_0x248a33(0xf8),JSON[_0x248a33(0xf3)](config));}function updateLive(_0x112dc2,_0xfd9f35){const _0x265a0c=_0x77986a;dbConfig[_0x265a0c(0x164)](_0x265a0c(0xf8))[_0x265a0c(0x2d5)]({'botID':_0x112dc2})[_0x265a0c(0x282)]({'live':_0xfd9f35})['write'](),config=getConfiguration(),io['to'](_0x265a0c(0xf7))[_0x265a0c(0x161)](_0x265a0c(0xf8),config),broadcastToBots('bots',JSON[_0x265a0c(0xf3)](config));}function updateBotName(_0x1739f5,_0x445c3e){const _0xad955c=_0x77986a;dbConfig['get'](_0xad955c(0xf8))[_0xad955c(0x2d5)]({'botID':_0x1739f5})[_0xad955c(0x282)]({'botname':_0x445c3e})[_0xad955c(0x15f)](),config=getConfiguration(),io['to'](_0xad955c(0xf7))[_0xad955c(0x161)](_0xad955c(0xf8),config),broadcastToBots(_0xad955c(0xf8),JSON[_0xad955c(0xf3)](config));}function updateBotManager(){const _0x34b595=_0x77986a;config=getConfiguration(),io['to'](_0x34b595(0xf7))[_0x34b595(0x161)](_0x34b595(0xf8),config),broadcastToBots(_0x34b595(0xf8),JSON[_0x34b595(0xf3)](config));}function toggleBotMode(_0x3e7f38){const _0x134572=_0x77986a;if(pid[_0x3e7f38])pid[_0x3e7f38][_0x134572(0x204)]({'function':'toggleBotMode','args':null});else{const _0x5d63ea=configpath+'bot-'+_0x3e7f38+_0x134572(0x229),_0x1d3a94=fs[_0x134572(0x1a5)](_0x5d63ea),_0x32731b=JSON[_0x134572(0x20f)](_0x1d3a94),_0x54f63f=_0x32731b['bot'][0x0][_0x134572(0x20c)];_0x32731b[_0x134572(0x14d)][0x0][_0x134572(0x20c)]=!_0x54f63f;const _0x5250e5=JSON['stringify'](_0x32731b,null,0x2);fs[_0x134572(0x173)](_0x5d63ea,_0x5250e5),config=getConfiguration(),io['to']('botmanager')[_0x134572(0x161)](_0x134572(0xf8),config),broadcastToBots(_0x134572(0xf8),JSON[_0x134572(0xf3)](config));}}function validateTelegram(_0x5b32fe){const _0x504be7=_0x77986a;if(_0x5b32fe['from'][_0x504be7(0x2e2)]!=settings['telegramUsername']&&'@'+_0x5b32fe['from'][_0x504be7(0x2e2)]!=settings[_0x504be7(0x24b)]||_0x5b32fe[_0x504be7(0x1b0)]['id']!=settings[_0x504be7(0x18a)])return sendTelegram(_0x5b32fe['chat']['id'],_0x504be7(0x188),{'parse_mode':_0x504be7(0x1f3)}),![];return!![];}async function initTelegram(){const _0x43bf20=_0x77986a;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x43bf20(0x2cf)]);let _0x558011='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x558011+='\x0a',_0x558011+=_0x43bf20(0x138),_0x558011+=_0x43bf20(0x1d9),_0x558011+=_0x43bf20(0x219),_0x558011+=_0x43bf20(0x10d),_0x558011+=_0x43bf20(0x213),_0x558011+=_0x43bf20(0x19f),_0x558011+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x558011+='/names\x20-\x20show\x20bot\x20names\x0a',_0x558011+=_0x43bf20(0x19e),_0x558011+=_0x43bf20(0x178),_0x558011+=_0x43bf20(0x29f),_0x558011+=_0x43bf20(0x126),_0x558011+=_0x43bf20(0x2b8),_0x558011+=_0x43bf20(0x215),_0x558011+=_0x43bf20(0x165),_0x558011+=_0x43bf20(0x11d);let _0x8fb202='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x8fb202+='\x0a',_0x8fb202+=_0x558011,tgBot[_0x43bf20(0x1d0)]((_0x3131cc,_0x42086f)=>{const _0x2e873a=_0x43bf20;logger['simple'](getTimeStamp()+_0x2e873a(0x268)),logger['debug'](_0x2e873a(0x27f),_0x3131cc);}),tgBot['use'](async(_0x369f90,_0x31645f)=>{const _0x529ac2=_0x43bf20;if(!(!settings[_0x529ac2(0x18a)]&&_0x369f90[_0x529ac2(0x12a)][_0x529ac2(0x29d)]['text']==_0x529ac2(0xed))){if(!validateTelegram(_0x369f90))return;}_0x31645f();}),tgBot[_0x43bf20(0x2f1)]('start',async _0x3c74d3=>{const _0x2a0adf=_0x43bf20;if(_0x3c74d3['from'][_0x2a0adf(0x2e2)]==settings['telegramUsername']||'@'+_0x3c74d3[_0x2a0adf(0x245)][_0x2a0adf(0x2e2)]==settings[_0x2a0adf(0x24b)]){if(!settings[_0x2a0adf(0x18a)])updateSetting(_0x2a0adf(0x18a),_0x3c74d3[_0x2a0adf(0x1b0)]['id']);}if(!validateTelegram(_0x3c74d3))return;updateSetting(_0x2a0adf(0x222),!![]),await sendTelegram(_0x3c74d3['chat']['id'],_0x8fb202);}),tgBot['command'](_0x43bf20(0x23b),async _0x4c4f95=>{const _0x19e38f=_0x43bf20;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x4c4f95[_0x19e38f(0x1b0)]['id'],'Notifications\x20enabled');}),tgBot[_0x43bf20(0x2f1)](_0x43bf20(0x11c),async _0x3459d0=>{const _0x4c45c5=_0x43bf20;await sendTelegram(_0x3459d0[_0x4c45c5(0x1b0)]['id'],_0x4c45c5(0x19d)),updateSetting(_0x4c45c5(0x222),![]);}),tgBot['command'](_0x43bf20(0x1b5),async _0x316c74=>{const _0x2aa7f5=_0x43bf20,_0x22bb55=Markup[_0x2aa7f5(0x2a9)]([Markup[_0x2aa7f5(0x21f)][_0x2aa7f5(0x15d)](_0x2aa7f5(0x1c1),_0x2aa7f5(0x1d1)),Markup['button'][_0x2aa7f5(0x15d)](_0x2aa7f5(0x116),_0x2aa7f5(0x109)),Markup[_0x2aa7f5(0x21f)][_0x2aa7f5(0x15d)](_0x2aa7f5(0x2f4),'config_all')]);_0x316c74[_0x2aa7f5(0x191)](_0x2aa7f5(0x276),_0x22bb55);}),tgBot[_0x43bf20(0x271)](_0x43bf20(0x1d1),async _0x87b963=>{const _0x1f1426=_0x43bf20;_0x87b963[_0x1f1426(0x226)](),updateSetting(_0x1f1426(0x180),'orders'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x87b963['chat']['id'],_0x1f1426(0x20d));}),tgBot[_0x43bf20(0x271)](_0x43bf20(0x109),async _0x55a9c9=>{const _0x28c4f0=_0x43bf20;_0x55a9c9[_0x28c4f0(0x226)](),updateSetting(_0x28c4f0(0x180),_0x28c4f0(0x13e)),updateSetting(_0x28c4f0(0x222),!![]),await sendTelegram(_0x55a9c9[_0x28c4f0(0x1b0)]['id'],_0x28c4f0(0x20e));}),tgBot[_0x43bf20(0x271)](_0x43bf20(0x233),async _0x33e3c3=>{const _0x40b9c1=_0x43bf20;_0x33e3c3['editMessageReplyMarkup'](),updateSetting(_0x40b9c1(0x180),'all'),updateSetting(_0x40b9c1(0x222),!![]),await sendTelegram(_0x33e3c3[_0x40b9c1(0x1b0)]['id'],_0x40b9c1(0xe3));}),tgBot[_0x43bf20(0x2f1)](_0x43bf20(0x277),async _0x3b421e=>{const _0x455870=_0x43bf20,_0x48c2b2=getBotsWithMode();let _0x37c6bb=_0x455870(0x2a3);config['forEach'](_0x30c304=>{const _0x1af876=_0x455870,_0x44b77d=_0x48c2b2[_0x1af876(0x2d5)](_0x134922=>_0x134922[_0x1af876(0x1ff)]==_0x30c304[_0x1af876(0x1ff)])[_0x1af876(0x2dc)];_0x37c6bb+=_0x1af876(0xdf)+_0x30c304['botID']+':\x20'+_0x30c304[_0x1af876(0x277)]+_0x1af876(0x2da)+_0x44b77d+_0x1af876(0x2da)+_0x30c304[_0x1af876(0x1a3)]+'\x0a';}),_0x37c6bb+='\x0a',_0x37c6bb+=_0x455870(0x1d4),_0x37c6bb+=!settings['telegramEnabled']?'Notifications\x20disabled\x0a':_0x455870(0x1e1),_0x37c6bb+=settings[_0x455870(0x222)]?settings[_0x455870(0x180)]==_0x455870(0x169)?_0x455870(0x21d):_0x455870(0x184)+settings['telegramEvents']+_0x455870(0x2d6):'',await sendTelegram(_0x3b421e[_0x455870(0x1b0)]['id'],_0x37c6bb,{'parse_mode':_0x455870(0x1f3)});}),tgBot[_0x43bf20(0x2f1)](_0x43bf20(0x1d3),async _0x540278=>{const _0x1f460f=_0x43bf20,_0x594dc6=getEnabledBots();if(_0x594dc6[_0x1f460f(0x2b5)]==0x0)await sendTelegram(_0x540278['chat']['id'],_0x1f460f(0x155));else{if(_0x594dc6[_0x1f460f(0x2b5)]>0x1)_0x594dc6['push']({'botID':_0x1f460f(0x169)});let _0x4c68ab=[],_0x50a59b=[];const _0x22e36a=_0x594dc6['length']%0x4==0x0||_0x594dc6[_0x1f460f(0x2b5)]%0x4==0x3||_0x594dc6[_0x1f460f(0x2b5)]%0x3==0x1?0x4:0x3;let _0x169a7d=0x0;_0x594dc6[_0x1f460f(0x106)]((_0x216999,_0xc74d01)=>{const _0x3829cd=_0x1f460f;if(_0xc74d01%_0x22e36a==0x0)_0x50a59b=[];_0x50a59b['push'](Markup['button']['callback'](_0x216999[_0x3829cd(0x1ff)]==_0x3829cd(0x169)?_0x3829cd(0xfe):_0x3829cd(0xdf)+_0x216999[_0x3829cd(0x1ff)],_0x3829cd(0x29b)+_0x216999[_0x3829cd(0x1ff)])),_0xc74d01%_0x22e36a==0x0&&(_0x4c68ab[_0x169a7d]=_0x50a59b,_0x169a7d++);});const _0x1711a9=Markup['inlineKeyboard'](_0x4c68ab);_0x540278[_0x1f460f(0x191)](_0x1f460f(0x1dd),_0x1711a9);}}),tgBot[_0x43bf20(0x271)](/restart_(.+)/,async _0x13c03a=>{const _0x2a0466=_0x43bf20,_0x2f0522=_0x13c03a[_0x2a0466(0x1e8)][0x1];_0x13c03a[_0x2a0466(0x226)](),_0x2f0522==_0x2a0466(0x169)?config[_0x2a0466(0x106)](_0x36ac95=>{const _0x45459e=_0x2a0466;restartBot(_0x36ac95[_0x45459e(0x1ff)]);}):restartBot(_0x2f0522);}),tgBot[_0x43bf20(0x2f1)]('on',async _0x99e2f2=>{const _0x4fa1d7=_0x43bf20,_0x3f8f86=getDisabledBots();if(_0x3f8f86[_0x4fa1d7(0x2b5)]==0x0)await sendTelegram(_0x99e2f2[_0x4fa1d7(0x1b0)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x3f8f86[_0x4fa1d7(0x2b5)]>0x1)_0x3f8f86[_0x4fa1d7(0x27b)]({'botID':_0x4fa1d7(0x169)});let _0x30770c=[],_0x4701b1=[];const _0x5f14e8=_0x3f8f86[_0x4fa1d7(0x2b5)]%0x4==0x0||_0x3f8f86[_0x4fa1d7(0x2b5)]%0x4==0x3||_0x3f8f86['length']%0x3==0x1?0x4:0x3;let _0x52da0e=0x0;_0x3f8f86[_0x4fa1d7(0x106)]((_0x231026,_0x10c65f)=>{const _0x4a08fb=_0x4fa1d7;if(_0x10c65f%_0x5f14e8==0x0)_0x4701b1=[];_0x4701b1[_0x4a08fb(0x27b)](Markup[_0x4a08fb(0x21f)][_0x4a08fb(0x15d)](_0x231026[_0x4a08fb(0x1ff)]==_0x4a08fb(0x169)?'All\x20bots':'Bot\x20'+_0x231026[_0x4a08fb(0x1ff)],'on_'+_0x231026[_0x4a08fb(0x1ff)])),_0x10c65f%_0x5f14e8==0x0&&(_0x30770c[_0x52da0e]=_0x4701b1,_0x52da0e++);});const _0x2f3aa1=Markup[_0x4fa1d7(0x2a9)](_0x30770c);_0x99e2f2[_0x4fa1d7(0x191)](_0x4fa1d7(0x1a6),_0x2f3aa1);}}),tgBot[_0x43bf20(0x271)](/on_(.+)/,async _0xb74ab3=>{const _0x44452e=_0x43bf20,_0x2bfb92=_0xb74ab3[_0x44452e(0x1e8)][0x1];_0xb74ab3[_0x44452e(0x226)]();if(_0x2bfb92=='all'){const _0x42e5a2=getDisabledBots();await sendTelegram(_0xb74ab3[_0x44452e(0x1b0)]['id'],_0x44452e(0x166)),_0x42e5a2['forEach'](_0xb67ab3=>{const _0x5e2ce0=_0x44452e;if(_0xb67ab3['botID']!='all')toggleBot(_0xb67ab3[_0x5e2ce0(0x1ff)],toggleStatus(_0xb67ab3[_0x5e2ce0(0x1ff)]),_0x5e2ce0(0x25c));});}else await sendTelegram(_0xb74ab3[_0x44452e(0x1b0)]['id'],_0x44452e(0x286)+_0x2bfb92),toggleBot(_0x2bfb92,toggleStatus(_0x2bfb92),_0x44452e(0x25c));}),tgBot[_0x43bf20(0x2f1)](_0x43bf20(0xe0),async _0x4b9120=>{const _0x46ae9d=_0x43bf20,_0x1967ae=getEnabledBots();if(_0x1967ae[_0x46ae9d(0x2b5)]==0x0)await sendTelegram(_0x4b9120[_0x46ae9d(0x1b0)]['id'],_0x46ae9d(0x155));else{if(_0x1967ae[_0x46ae9d(0x2b5)]>0x1)_0x1967ae[_0x46ae9d(0x27b)]({'botID':_0x46ae9d(0x169)});let _0x406310=[],_0x2fa226=[];const _0x1b968e=_0x1967ae['length']%0x4==0x0||_0x1967ae[_0x46ae9d(0x2b5)]%0x4==0x3||_0x1967ae['length']%0x3==0x1?0x4:0x3;let _0x560df3=0x0;_0x1967ae[_0x46ae9d(0x106)]((_0x27ca85,_0x42fa59)=>{const _0x2c5a13=_0x46ae9d;if(_0x42fa59%_0x1b968e==0x0)_0x2fa226=[];_0x2fa226[_0x2c5a13(0x27b)](Markup[_0x2c5a13(0x21f)]['callback'](_0x27ca85[_0x2c5a13(0x1ff)]==_0x2c5a13(0x169)?_0x2c5a13(0xfe):'Bot\x20'+_0x27ca85[_0x2c5a13(0x1ff)],_0x2c5a13(0x17b)+_0x27ca85[_0x2c5a13(0x1ff)])),_0x42fa59%_0x1b968e==0x0&&(_0x406310[_0x560df3]=_0x2fa226,_0x560df3++);});const _0x354d09=Markup[_0x46ae9d(0x2a9)](_0x406310);_0x4b9120[_0x46ae9d(0x191)](_0x46ae9d(0xfd),_0x354d09);}}),tgBot[_0x43bf20(0x271)](/off_(.+)/,async _0x56ebeb=>{const _0x44e6e5=_0x43bf20,_0x2cd22c=_0x56ebeb[_0x44e6e5(0x1e8)][0x1];_0x56ebeb[_0x44e6e5(0x226)]();if(_0x2cd22c==_0x44e6e5(0x169)){const _0x1b9a2b=getEnabledBots();await sendTelegram(_0x56ebeb[_0x44e6e5(0x1b0)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x1b9a2b['forEach'](_0x4618bb=>{const _0x3e632d=_0x44e6e5;if(_0x4618bb[_0x3e632d(0x1ff)]!=_0x3e632d(0x169))toggleBot(_0x4618bb['botID'],toggleStatus(_0x4618bb[_0x3e632d(0x1ff)]),_0x3e632d(0x25c));});}else await sendTelegram(_0x56ebeb[_0x44e6e5(0x1b0)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x2cd22c),toggleBot(_0x2cd22c,toggleStatus(_0x2cd22c),'stopped');}),tgBot['command']('metrics',async _0x22ee81=>{const _0x4fca69=_0x43bf20,_0x53b317=getEnabledBots();if(_0x53b317['length']==0x0)await sendTelegram(_0x22ee81[_0x4fca69(0x1b0)]['id'],_0x4fca69(0x155));else{if(_0x53b317['length']>0x1){let _0x4183c2=[],_0x19ff31=[];const _0x572b5e=_0x53b317['length']%0x4==0x0||_0x53b317[_0x4fca69(0x2b5)]%0x4==0x3||_0x53b317['length']%0x3==0x1?0x4:0x3;let _0x21b16b=0x0;_0x53b317['forEach']((_0x451b94,_0x1c3ce6)=>{const _0x1ff2bd=_0x4fca69;if(_0x1c3ce6%_0x572b5e==0x0)_0x19ff31=[];_0x19ff31[_0x1ff2bd(0x27b)](Markup[_0x1ff2bd(0x21f)][_0x1ff2bd(0x15d)](_0x1ff2bd(0xdf)+_0x451b94['botID'],_0x1ff2bd(0x11a)+_0x451b94['botID'])),_0x1c3ce6%_0x572b5e==0x0&&(_0x4183c2[_0x21b16b]=_0x19ff31,_0x21b16b++);});const _0x5f5088=Markup[_0x4fca69(0x2a9)](_0x4183c2);_0x22ee81[_0x4fca69(0x191)](_0x4fca69(0x159),_0x5f5088);}else{const _0x427843=_0x53b317[0x0][_0x4fca69(0x1ff)];if(pid[_0x427843])pid[_0x427843][_0x4fca69(0x204)]({'function':_0x4fca69(0x149),'args':null});}}}),tgBot[_0x43bf20(0x271)](/metrics_(.+)/,async _0x30557e=>{const _0x933aea=_0x43bf20,_0x5b4995=_0x30557e['match'][0x1];_0x30557e[_0x933aea(0x226)]();if(pid[_0x5b4995])pid[_0x5b4995][_0x933aea(0x204)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x43bf20(0x2f1)](_0x43bf20(0x22d),async _0x3518fb=>{const _0x782597=_0x43bf20,_0x5dcce1=getEnabledBots();if(_0x5dcce1[_0x782597(0x2b5)]==0x0)await sendTelegram(_0x3518fb[_0x782597(0x1b0)]['id'],_0x782597(0x155));else{if(_0x5dcce1[_0x782597(0x2b5)]>0x1){let _0x521539=[],_0x32a508=[];const _0xacb062=_0x5dcce1[_0x782597(0x2b5)]%0x4==0x0||_0x5dcce1[_0x782597(0x2b5)]%0x4==0x3||_0x5dcce1['length']%0x3==0x1?0x4:0x3;let _0x37fe28=0x0;_0x5dcce1[_0x782597(0x106)]((_0x546a0b,_0x1cd0e4)=>{const _0x358cf7=_0x782597;if(_0x1cd0e4%_0xacb062==0x0)_0x32a508=[];_0x32a508['push'](Markup[_0x358cf7(0x21f)][_0x358cf7(0x15d)](_0x358cf7(0xdf)+_0x546a0b['botID'],'portfolio_'+_0x546a0b[_0x358cf7(0x1ff)])),_0x1cd0e4%_0xacb062==0x0&&(_0x521539[_0x37fe28]=_0x32a508,_0x37fe28++);});const _0x59d65f=Markup[_0x782597(0x2a9)](_0x521539);_0x3518fb['reply'](_0x782597(0x266),_0x59d65f);}else{const _0x4f8754=_0x5dcce1[0x0][_0x782597(0x1ff)];if(pid[_0x4f8754])pid[_0x4f8754][_0x782597(0x204)]({'function':_0x782597(0x249),'args':null});}}}),tgBot[_0x43bf20(0x271)](/portfolio_(.+)/,async _0x4da3ff=>{const _0x4f8c7c=_0x43bf20,_0xa00bdb=_0x4da3ff[_0x4f8c7c(0x1e8)][0x1];_0x4da3ff['editMessageReplyMarkup']();if(pid[_0xa00bdb])pid[_0xa00bdb][_0x4f8c7c(0x204)]({'function':_0x4f8c7c(0x249),'args':null});}),tgBot[_0x43bf20(0x2f1)](_0x43bf20(0x2e1),async _0x59d88a=>{const _0x3b0b4e=_0x43bf20,_0xfa2462='logs';await zipFiles(_0xfa2462);const _0x39b366=zippath+(_0xfa2462+'.zip');_0x59d88a[_0x3b0b4e(0x153)]({'source':_0x39b366})['then'](()=>{})[_0x3b0b4e(0x1d0)](_0x4a48b6=>logger[_0x3b0b4e(0x1ae)](_0x3b0b4e(0xdd)+_0xfa2462+_0x3b0b4e(0x11b),_0x4a48b6));}),tgBot[_0x43bf20(0x2f1)](_0x43bf20(0x119),async _0x22e182=>{const _0x1c7054=_0x43bf20,_0x118e09=_0x1c7054(0x119);await backupConfigFiles(),await zipFiles(_0x118e09);const _0x1b22dc=zippath+(_0x118e09+'.zip');_0x22e182[_0x1c7054(0x153)]({'source':_0x1b22dc})[_0x1c7054(0x28e)](()=>{})[_0x1c7054(0x1d0)](_0x48ff38=>logger[_0x1c7054(0x1ae)](_0x1c7054(0xdd)+_0x118e09+_0x1c7054(0x11b),_0x48ff38));}),tgBot['command'](_0x43bf20(0x12a),async _0x20e9ac=>{const _0x42c8dd=_0x43bf20;await getMessages();if(!updateAvailable)await sendTelegram(_0x20e9ac[_0x42c8dd(0x1b0)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x20e9ac[_0x42c8dd(0x1b0)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x4ed155=Markup[_0x42c8dd(0x2a9)]([Markup[_0x42c8dd(0x21f)]['callback'](_0x42c8dd(0x12c),_0x42c8dd(0x150)),Markup[_0x42c8dd(0x21f)][_0x42c8dd(0x15d)]('No',_0x42c8dd(0x274))]);_0x20e9ac[_0x42c8dd(0x191)](_0x42c8dd(0x260),_0x4ed155);}}}),tgBot[_0x43bf20(0x271)](/update_(.+)/,async _0x671c29=>{const _0x4e8bc2=_0x43bf20,_0x284956=_0x671c29[_0x4e8bc2(0x1e8)][0x1];_0x671c29[_0x4e8bc2(0x226)](),_0x284956==_0x4e8bc2(0x221)&&(await sendTelegram(_0x671c29[_0x4e8bc2(0x1b0)]['id'],_0x4e8bc2(0x2f0)),updateBB('update')),_0x284956=='no'&&await sendTelegram(_0x671c29[_0x4e8bc2(0x1b0)]['id'],_0x4e8bc2(0x1c4));}),tgBot['command'](_0x43bf20(0x273),async _0x32d066=>{const _0x2ffb93=_0x43bf20;if(!validInstallation)await sendTelegram(_0x32d066[_0x2ffb93(0x1b0)]['id'],_0x2ffb93(0xf2));else{const _0x1bc824=Markup[_0x2ffb93(0x2a9)]([Markup[_0x2ffb93(0x21f)][_0x2ffb93(0x15d)](_0x2ffb93(0x12c),_0x2ffb93(0xf4)),Markup['button'][_0x2ffb93(0x15d)]('No',_0x2ffb93(0x29c))]);_0x32d066[_0x2ffb93(0x191)](_0x2ffb93(0x1df),_0x1bc824);}}),tgBot[_0x43bf20(0x271)](/reinstall_(.+)/,async _0x520f4c=>{const _0x440204=_0x43bf20,_0x55b467=_0x520f4c['match'][0x1];_0x520f4c[_0x440204(0x226)](),_0x55b467==_0x440204(0x221)&&(await sendTelegram(_0x520f4c['chat']['id'],_0x440204(0x231)),updateBB(_0x440204(0x273))),_0x55b467=='no'&&await sendTelegram(_0x520f4c['chat']['id'],_0x440204(0x263));}),tgBot[_0x43bf20(0x2f1)](_0x43bf20(0x13c),async _0x144a85=>{const _0x4376e2=_0x43bf20,_0x52303b=getBotsWithMode();if(_0x52303b['length']==0x0)await sendTelegram(_0x144a85[_0x4376e2(0x1b0)]['id'],_0x4376e2(0x155));else{let _0x13593a=[],_0x4f4196=[];const _0x3e7c15=0x2;let _0x501925=0x0;_0x52303b['forEach']((_0x3c21d0,_0x48703b)=>{const _0x1594ab=_0x4376e2;if(_0x48703b%_0x3e7c15==0x0)_0x4f4196=[];_0x4f4196[_0x1594ab(0x27b)](Markup[_0x1594ab(0x21f)][_0x1594ab(0x15d)](_0x1594ab(0xdf)+_0x3c21d0['botID']+'\x20('+_0x3c21d0['mode']+')','toggle_'+_0x3c21d0[_0x1594ab(0x1ff)])),_0x48703b%_0x3e7c15==0x0&&(_0x13593a[_0x501925]=_0x4f4196,_0x501925++);});const _0x18592e=Markup[_0x4376e2(0x2a9)](_0x13593a);_0x144a85[_0x4376e2(0x191)](_0x4376e2(0x2e0),_0x18592e);}}),tgBot[_0x43bf20(0x271)](/toggle_(.+)/,async _0x4654db=>{const _0x40a97c=_0x43bf20,_0x49b247=_0x4654db[_0x40a97c(0x1e8)][0x1];_0x4654db['editMessageReplyMarkup']();const _0x28ba4d=getBotsWithMode(),_0x53a082=_0x28ba4d[_0x40a97c(0x2d5)](_0xa5d6ee=>_0xa5d6ee[_0x40a97c(0x1ff)]==_0x49b247),_0x43e85e=_0x53a082[_0x40a97c(0x2dc)]==_0x40a97c(0x29e)?'manual':_0x40a97c(0x29e);await sendTelegram(_0x4654db['chat']['id'],_0x40a97c(0x1bc)+_0x49b247+_0x40a97c(0x2ca)+_0x43e85e+_0x40a97c(0x18c)),toggleBotMode(_0x49b247);}),tgBot['command'](_0x43bf20(0x257),async _0x148978=>{const _0x47c3fd=_0x43bf20;let _0x4d3b66='';config[_0x47c3fd(0x106)](_0xb41da4=>{const _0x47521c=_0x47c3fd;_0x4d3b66+=_0x47521c(0xdf)+_0xb41da4['botID']+':\x20'+_0xb41da4[_0x47521c(0x1c7)]+'\x0a';}),await sendTelegram(_0x148978[_0x47c3fd(0x1b0)]['id'],_0x4d3b66,{'parse_mode':_0x47c3fd(0x1f3)});}),tgBot[_0x43bf20(0x2f1)](_0x43bf20(0x1a8),async _0xdfe84b=>{const _0x4b3826=_0x43bf20;await sendTelegram(_0xdfe84b[_0x4b3826(0x1b0)]['id'],_0x558011);}),process['once']('SIGINT',()=>tgBot[_0x43bf20(0x26d)]('SIGINT')),process[_0x43bf20(0x2ec)](_0x43bf20(0xf0),()=>tgBot[_0x43bf20(0x26d)]('SIGTERM')),tgBot[_0x43bf20(0x241)]();}function disableTelegram(){const _0x579fd8=_0x77986a;tgBot&&tgBot[_0x579fd8(0x26d)]();}async function sendTelegram(_0x3de142,_0x2979bd,_0x249dc6){const _0x4d59fe=_0x77986a;_0x249dc6={..._0x249dc6,'disable_web_page_preview':!![]};try{await tgBot[_0x4d59fe(0x28b)][_0x4d59fe(0x1e9)](_0x3de142,_0x2979bd,_0x249dc6);}catch(_0x50ba29){logger[_0x4d59fe(0x1ae)](_0x4d59fe(0x124),_0x50ba29);}}async function sendTelegramBot(_0x2900ed,_0x3d1800){const _0x101f8a=_0x77986a;if(settings[_0x101f8a(0x222)]){if(settings[_0x101f8a(0x180)]==_0x101f8a(0x169)||(_0x3d1800[_0x101f8a(0x130)]=='error'||_0x3d1800['type']==_0x101f8a(0x113)||_0x3d1800[_0x101f8a(0x130)]==_0x101f8a(0x117))&&settings['telegramEvents']=='alerts'||_0x3d1800[_0x101f8a(0x130)]=='order'&&settings['telegramEvents']==_0x101f8a(0x1e7)){if(tgBot&&settings[_0x101f8a(0x18a)]){if(_0x3d1800[_0x101f8a(0x21b)])await sendTelegram(settings[_0x101f8a(0x18a)],_0x3d1800[_0x101f8a(0x1c7)]+'\x20>\x20'+_0x3d1800[_0x101f8a(0x25b)]);else await sendTelegram(settings[_0x101f8a(0x18a)],_0x101f8a(0xdf)+_0x2900ed+_0x101f8a(0x267)+_0x3d1800[_0x101f8a(0x25b)]);}}}}async function sendTelegramMsg(_0x4dd073,_0x37f9da=_0x77986a(0x1f3)){const _0x23963a=_0x77986a;return settings[_0x23963a(0x222)]&&tgBot&&settings[_0x23963a(0x18a)]?(await sendTelegram(settings['telegramChatId'],_0x4dd073,{'parse_mode':_0x37f9da}),!![]):![];}function getDeviceWithIp(_0x11de00){const _0x5b58fc=_0x77986a;return devices[_0x5b58fc(0x2d5)](_0x4ca281=>_0x4ca281['ip']===_0x11de00);}async function temporaryAccess2FA(_0x3b596b,_0x5d57ce){const _0x1582f6=_0x77986a;let _0x47d30d=new Date(),_0xeef0f=![];if(lastIpApproval){if(_0x47d30d-lastIpApproval<0x1388)_0xeef0f=!![];}lastIpApproval=new Date();if(_0xeef0f)return;if(tgBot&&settings['telegramChatId']){const _0x297fdf=uuidRandom();tmpStorage[_0x297fdf]={'uuid':_0x3b596b,'externalip':_0x5d57ce};const _0x3c44a8=Markup[_0x1582f6(0x2a9)]([Markup[_0x1582f6(0x21f)][_0x1582f6(0x15d)](_0x1582f6(0x27a),_0x1582f6(0x2b2)+_0x297fdf),Markup[_0x1582f6(0x21f)][_0x1582f6(0x15d)](_0x1582f6(0x170),_0x1582f6(0x123)+_0x297fdf),Markup['button'][_0x1582f6(0x15d)](_0x1582f6(0x275),_0x1582f6(0x183)+_0x297fdf),Markup['button'][_0x1582f6(0x15d)](_0x1582f6(0x15a),'tempaccess_reject_'+_0x297fdf)]);await sendTelegram(settings[_0x1582f6(0x18a)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x5d57ce)['show']+'\x20?',_0x3c44a8),tgBot[_0x1582f6(0x271)](/tempaccess_(.+)_(.+)/,async _0x3bb299=>{const _0x491355=_0x1582f6,_0x2b9448=_0x3bb299[_0x491355(0x1e8)][0x1],_0x346aa9=_0x3bb299[_0x491355(0x1e8)][0x2],{uuid:_0x5ee7a4,externalip:_0x13d280}=tmpStorage[_0x346aa9];delete tmpStorage[_0x346aa9],_0x3bb299[_0x491355(0x226)](),devices[_0x5ee7a4][_0x491355(0x118)]={'clientip':_0x13d280,'timestamp':new Date()[_0x491355(0x10c)](),'expiry':_0x2b9448},_0x2b9448!='reject'?(await sendTelegram(_0x3bb299['chat']['id'],_0x491355(0x194)+_0x2b9448+_0x491355(0x17e),{'parse_mode':_0x491355(0x1f3)}),io['to'](_0x5ee7a4)[_0x491355(0x161)](_0x491355(0x277),{'access':{'allow':![],'reason':_0x491355(0x2fb),'token':null}})):(await sendTelegram(_0x3bb299['chat']['id'],_0x491355(0x2f7)),io['to'](_0x5ee7a4)['emit'](_0x491355(0x277),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}function _0x2018(_0x29b3b9,_0xe20391){const _0x457ee3=_0x2163();return _0x2018=function(_0x183884,_0x55feb0){_0x183884=_0x183884-0xdc;let _0x21637c=_0x457ee3[_0x183884];return _0x21637c;},_0x2018(_0x29b3b9,_0xe20391);}async function loginAccess2FA(_0x1d0154,_0x3f215e){const _0x4434a8=_0x77986a;if(tgBot&&settings[_0x4434a8(0x18a)]){const _0x4bb694=uuidRandom();tmpStorage[_0x4bb694]={'uuid':_0x1d0154,'externalip':_0x3f215e};const _0x1b23de=Markup[_0x4434a8(0x2a9)]([Markup['button'][_0x4434a8(0x15d)](_0x4434a8(0x288),_0x4434a8(0x1cd)+loginExpiry+'_'+_0x4bb694),Markup['button'][_0x4434a8(0x15d)](_0x4434a8(0x15a),_0x4434a8(0x174)+_0x4bb694)]);await sendTelegram(settings[_0x4434a8(0x18a)],_0x4434a8(0x2a7)+normalizeIP(_0x3f215e)['show']+'\x20?',_0x1b23de),tgBot[_0x4434a8(0x271)](/login2fa_(.+)_(.+)/,async _0x483eaa=>{const _0x1e531f=_0x4434a8,_0x9978d9=_0x483eaa['match'][0x1],_0x4af1b5=_0x483eaa[_0x1e531f(0x1e8)][0x2],{uuid:_0x2e67c0,externalip:_0x5c402f}=tmpStorage[_0x4af1b5];delete tmpStorage[_0x4af1b5],_0x483eaa[_0x1e531f(0x226)](),devices[_0x2e67c0][_0x1e531f(0x186)]={'clientip':_0x5c402f,'timestamp':new Date()['getTime'](),'expiry':_0x9978d9},_0x9978d9!=_0x1e531f(0x15a)?(await sendTelegram(_0x483eaa[_0x1e531f(0x1b0)]['id'],_0x1e531f(0x299),{'parse_mode':_0x1e531f(0x1f3)}),io['to'](_0x2e67c0)[_0x1e531f(0x161)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x483eaa[_0x1e531f(0x1b0)]['id'],'Login\x20rejected'),io['to'](_0x2e67c0)[_0x1e531f(0x161)](_0x1e531f(0x277),{'access':{'allow':![],'reason':_0x1e531f(0x1e3),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x42961d=_0x77986a;return dbConfig[_0x42961d(0x164)](_0x42961d(0xf8))[_0x42961d(0x232)](_0x42961d(0x1ff))['filter']({'status':_0x42961d(0x290)})['value']()||[];}function getDisabledBots(){const _0x5311df=_0x77986a;return dbConfig['get'](_0x5311df(0xf8))[_0x5311df(0x232)](_0x5311df(0x1ff))[_0x5311df(0x24a)]({'status':'disabled'})[_0x5311df(0x2de)]()||[];}function getBotAttributes(_0x95776f){const _0x975611=_0x77986a;let _0x104acb={};const _0x1efca8=configpath+_0x975611(0x296)+_0x95776f+'-config.json',_0x309c32=fs[_0x975611(0x2ba)](_0x1efca8);if(_0x309c32){const _0x33073c=fs['readFileSync'](_0x1efca8);try{const _0x14b203=JSON['parse'](_0x33073c),_0x4173d0=_0x14b203?_0x14b203[_0x975611(0x14d)][0x0][_0x975611(0x20c)]:![];_0x104acb[_0x975611(0x2dc)]=_0x4173d0?'auto':'manual',_0x104acb['botname']=_0x14b203?_0x14b203[_0x975611(0x14d)][0x0][_0x975611(0x1c7)]:_0x975611(0xdf)+_0x95776f;}catch(_0x286612){_0x104acb[_0x975611(0x2dc)]=_0x975611(0x2ac),_0x104acb[_0x975611(0x1c7)]=_0x975611(0xdf)+_0x95776f;}}else _0x104acb[_0x975611(0x2dc)]='manual',_0x104acb[_0x975611(0x1c7)]=_0x975611(0xdf)+_0x95776f;return _0x104acb;}function getBotsWithMode(){const _0x20f592=_0x77986a,_0x449e1f=dbConfig[_0x20f592(0x164)]('bots')[_0x20f592(0x232)](_0x20f592(0x1ff))[_0x20f592(0x2de)]()||[];return _0x449e1f['forEach'](_0x1b34b9=>{const _0x37b4c1=_0x20f592;let _0x264a41=getBotAttributes(_0x1b34b9[_0x37b4c1(0x1ff)]);_0x1b34b9[_0x37b4c1(0x2dc)]=_0x264a41[_0x37b4c1(0x2dc)];}),_0x449e1f;}function getBotExchanges(){const _0x1c1f9d=_0x77986a;let _0x4e1852=[];const _0x2bbda8=dbConfig[_0x1c1f9d(0x164)]('bots')[_0x1c1f9d(0x232)](_0x1c1f9d(0x1ff))['value']()||[];_0x2bbda8[_0x1c1f9d(0x106)](_0x5362f0=>{const _0x180270=_0x1c1f9d;if(_0x5362f0[_0x180270(0x277)]==_0x180270(0x290)){const _0x1965dd=configpath+_0x180270(0x296)+_0x5362f0['botID']+_0x180270(0x229),_0x2be77f=fs['existsSync'](_0x1965dd);let _0x4088a4;if(_0x2be77f){const _0x5354a9=fs['readFileSync'](_0x1965dd);try{const _0x26679a=JSON[_0x180270(0x20f)](_0x5354a9);_0x4088a4=_0x26679a?_0x26679a[_0x180270(0x14d)][0x0][_0x180270(0x187)]:null;}catch(_0x36cf8f){}}if(_0x4088a4)_0x4e1852[_0x180270(0x27b)](_0x4088a4);}});const _0x449676=[...new Set(_0x4e1852)]['sort']();return _0x449676;}async function initUser(){const _0x398da0=_0x77986a;if(!settings[_0x398da0(0x27e)]){const _0x395489=uuidRandom();mixpanel[_0x398da0(0xfa)](_0x395489),updateSetting(_0x398da0(0x27e),_0x395489);}}async function initSecure(){const _0x5b9a80=_0x77986a;let _0x5139ce=getSecure();if(!_0x5139ce[_0x5b9a80(0x162)]('secret')){let _0xab6870=await generateKeys();_0x5139ce[_0x5b9a80(0x2d2)]=_0xab6870[_0x5b9a80(0x2d2)],_0x5139ce['privateKey']=_0xab6870[_0x5b9a80(0x1c8)],_0x5139ce[_0x5b9a80(0x17c)]=crypto[_0x5b9a80(0x1ce)](0x20)[_0x5b9a80(0x25f)]('hex');;storeSecure(_0x5139ce);}}function getSettings(){const _0x7d65ed=_0x77986a;return dbSettings['get'](_0x7d65ed(0x2e8))[_0x7d65ed(0x2de)]()||{};}function getSecure(){const _0x382c3e=_0x77986a;return dbSecure[_0x382c3e(0x164)]('secure')['value']()||{};}function getBlacklist(){const _0x566be5=_0x77986a;return dbSecure[_0x566be5(0x164)](_0x566be5(0x270))[_0x566be5(0x2de)]()||[];}function broadcastToBots(_0x2cc03a,_0x1699ef){const _0x12cedf=_0x77986a;config[_0x12cedf(0x106)](_0x4d5298=>{const _0x46edfe=_0x12cedf;if(_0x4d5298['status']=='enabled'&&_0x4d5298['live']==_0x46edfe(0x242)||_0x4d5298[_0x46edfe(0x277)]==_0x46edfe(0x2dd)&&_0x4d5298[_0x46edfe(0x1a3)]==_0x46edfe(0x242)){if(pid[_0x4d5298[_0x46edfe(0x1ff)]])pid[_0x4d5298[_0x46edfe(0x1ff)]]['send']({[_0x2cc03a]:_0x1699ef});}});}async function storeSettings(_0x4a2e4a,_0x55431a=![]){const _0x3be610=_0x77986a;_0x4a2e4a={...settings,..._0x4a2e4a};if(_0x55431a&&_0x4a2e4a[_0x3be610(0x10e)]!=_0x3be610(0x18b)&&_0x4a2e4a[_0x3be610(0x10e)]!=_0x3be610(0x2f3)&&_0x4a2e4a[_0x3be610(0x10e)]!=''){const _0x4ec8a6=decryptRSA(secure[_0x3be610(0x1c8)],_0x4a2e4a[_0x3be610(0x10e)])[_0x3be610(0x1b8)](_0x3be610(0x2db))[0x0],_0x3a92d5=bcrypt[_0x3be610(0x189)](_0x4ec8a6,saltRounds);_0x4a2e4a={..._0x4a2e4a,'bbPassword':_0x3a92d5};}if(_0x55431a&&_0x4a2e4a[_0x3be610(0x2cf)]!=_0x3be610(0x18b)&&_0x4a2e4a['telegramToken']!=_0x3be610(0x2f3)&&_0x4a2e4a[_0x3be610(0x2cf)]!=''){const _0x4e7c2c=decryptRSA(secure[_0x3be610(0x1c8)],_0x4a2e4a[_0x3be610(0x2cf)])[_0x3be610(0x1b8)](_0x3be610(0x2db))[0x0];_0x4a2e4a={..._0x4a2e4a,'telegramToken':_0x4e7c2c};}if(_0x55431a&&_0x4a2e4a[_0x3be610(0x28c)]!=_0x3be610(0x18b)&&_0x4a2e4a[_0x3be610(0x28c)]!='***'&&_0x4a2e4a[_0x3be610(0x28c)]!=''){const _0x1bb6e8=decryptRSA(secure[_0x3be610(0x1c8)],_0x4a2e4a[_0x3be610(0x28c)])[_0x3be610(0x1b8)](_0x3be610(0x2db))[0x0];_0x4a2e4a={..._0x4a2e4a,'marketcapApi':_0x1bb6e8};}const _0x189b4f=_0x4a2e4a[_0x3be610(0x2cf)]!=_0x3be610(0x18b)&&_0x4a2e4a[_0x3be610(0x2cf)]!=settings[_0x3be610(0x2cf)]||_0x4a2e4a[_0x3be610(0x24b)]!=settings['telegramUsername'],_0x3244b0=_0x4a2e4a[_0x3be610(0x2cf)]==''||_0x4a2e4a['telegramUsername']=='',_0x547d02=_0x4a2e4a[_0x3be610(0x28c)]&&_0x4a2e4a[_0x3be610(0x28c)]!=_0x3be610(0x18b)&&_0x4a2e4a[_0x3be610(0x28c)]!=settings[_0x3be610(0x28c)];_0x189b4f&&(_0x4a2e4a[_0x3be610(0x18a)]=null,_0x4a2e4a['telegramEvents']='all');for(const [_0x3f65b0,_0x35c38e]of Object['entries'](_0x4a2e4a)){if(_0x3f65b0==_0x3be610(0x2cf)&&_0x35c38e==_0x3be610(0x18b)){_0x4a2e4a[_0x3be610(0x2cf)]=settings[_0x3be610(0x2cf)];continue;};if(_0x3f65b0==_0x3be610(0x10e)&&_0x35c38e==_0x3be610(0x18b)){_0x4a2e4a[_0x3be610(0x10e)]=settings[_0x3be610(0x10e)];continue;};if(_0x3f65b0=='marketcapApi'&&_0x35c38e==_0x3be610(0x18b)){_0x4a2e4a[_0x3be610(0x28c)]=settings['marketcapApi'];continue;};dbSettings[_0x3be610(0x20b)](_0x3be610(0x146)+_0x3f65b0,_0x35c38e)[_0x3be610(0x15f)]();}settings=_0x4a2e4a,io['to'](_0x3be610(0xf7))['emit'](_0x3be610(0x2e8),cleanSettings()),broadcastToBots(_0x3be610(0x2a6),settings[_0x3be610(0x2a6)]),broadcastToBots('onepagemode',settings['onepagemode']),broadcastToBots('marketcapApi',settings[_0x3be610(0x28c)]);if(_0x189b4f&&!_0x3244b0)initTelegram();if(_0x189b4f&&_0x3244b0)disableTelegram();getAllClients()[_0x3be610(0x106)](_0x5bd81b=>{const _0xc9489b=_0x3be610;getSocket(_0x5bd81b['id'])[_0xc9489b(0x161)]('status',{'access':{'allow':![],'reason':_0xc9489b(0x2fb),'token':null}});}),_0x547d02&&(await sleep(0xbb8),testMarketcapApi(_0x4a2e4a[_0x3be610(0x28c)]));}async function testMarketcapApi(_0x429332){const _0x3be92b=_0x77986a,_0x694c07=[_0x3be92b(0x2cc),_0x3be92b(0x137)];try{await axios['get'](_0x3be92b(0x2f9),{'headers':{'X-CMC_PRO_API_KEY':_0x429332},'params':{'symbol':_0x694c07[_0x3be92b(0x25f)]()}});}catch(_0x59581c){_0x59581c[_0x3be92b(0x25f)]()[_0x3be92b(0x21c)]('status\x20code\x20401')?(io['to']('botmanager')[_0x3be92b(0x161)]('notification',_0x3be92b(0x235)),logger[_0x3be92b(0x1c9)](_0x3be92b(0x235))):(io['to']('botmanager')[_0x3be92b(0x161)](_0x3be92b(0x112),_0x3be92b(0x148)),logger[_0x3be92b(0x1c9)](_0x3be92b(0x148)),logger['debug']('Error\x20details:',_0x59581c[_0x3be92b(0x25f)]()+'\x20-\x20'+_0x59581c[_0x3be92b(0x254)]));return;}logger[_0x3be92b(0x1ae)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x32f6cc,_0x5b6cdb){const _0x4bfb5d=_0x77986a;dbSettings[_0x4bfb5d(0x20b)](_0x4bfb5d(0x146)+_0x32f6cc,_0x5b6cdb)[_0x4bfb5d(0x15f)](),settings=getSettings(),io['to'](_0x4bfb5d(0xf7))['emit']('settings',cleanSettings());}function storeSecure(_0x54ef15){const _0x136e97=_0x77986a;dbSecure[_0x136e97(0x164)](_0x136e97(0x2e5))[_0x136e97(0x27b)](_0x54ef15)['write'](),secure=_0x54ef15;}function addBlacklist(_0x4192f3){const _0x20ebd0=_0x77986a;cleanBlacklist();let _0x22e142;devices[_0x4192f3][_0x20ebd0(0x118)]?_0x22e142=Math[_0x20ebd0(0x289)](devices[_0x4192f3][_0x20ebd0(0x118)][_0x20ebd0(0x10f)],loginExpiry):_0x22e142=loginExpiry,dbSecure[_0x20ebd0(0x164)](_0x20ebd0(0x270))[_0x20ebd0(0x27b)]({'expiry':new Date()[_0x20ebd0(0x10c)]()+_0x22e142*0x3c*0x3e8,'token':devices[_0x4192f3][_0x20ebd0(0x2f5)][_0x20ebd0(0x102)]})[_0x20ebd0(0x15f)](),blacklist=dbSecure[_0x20ebd0(0x164)](_0x20ebd0(0x270))[_0x20ebd0(0x2de)]();}function cleanBlacklist(){const _0x54422b=_0x77986a;let _0x2e58f4=dbSecure[_0x54422b(0x164)]('blacklist')[_0x54422b(0x2bb)]()[_0x54422b(0x2de)](),_0xd33e4e=new Date()[_0x54422b(0x10c)]();_0x2e58f4[_0x54422b(0x106)](_0x5dd1ac=>{const _0x4c77b7=_0x54422b;_0x5dd1ac['expiry']<_0xd33e4e&&dbSecure[_0x4c77b7(0x164)](_0x4c77b7(0x270))[_0x4c77b7(0x259)]({'expiry':_0x5dd1ac[_0x4c77b7(0x10f)]})[_0x4c77b7(0x15f)]();});}function initStates(){const _0x9e43da=_0x77986a;let _0x4caf28=getConfiguration();_0x4caf28[_0x9e43da(0x106)](_0x21e694=>{const _0x465436=_0x9e43da;_0x21e694[_0x465436(0x1a3)]=_0x465436(0x25c);}),storeConfiguration(_0x4caf28);}async function generateKeys(){const _0x5074d8=_0x77986a,_0x9603a1=forge['pki'][_0x5074d8(0x2c5)][_0x5074d8(0x2d3)]({'bits':0x1000,'e':0x10001}),_0x28faba=forge[_0x5074d8(0x1d5)]['privateKeyToPem'](_0x9603a1[_0x5074d8(0x1c8)]),_0x252944=forge['pki'][_0x5074d8(0x2b9)](_0x9603a1['publicKey']);return{'privateKey':_0x28faba,'publicKey':_0x252944};}async function oneTimeMigration(){const _0x1edaa7=_0x77986a;let _0x1fe68d=getSettings(),_0x1ac51b=![];!_0x1fe68d[_0x1edaa7(0x162)]('lastmsgtelegram')&&(_0x1fe68d['lastmsgtelegram']=0x0,_0x1ac51b=!![]);!_0x1fe68d[_0x1edaa7(0x162)](_0x1edaa7(0x16f))&&(_0x1fe68d[_0x1edaa7(0x16f)]=0x0,_0x1ac51b=!![]);!_0x1fe68d['hasOwnProperty'](_0x1edaa7(0xe5))&&(_0x1fe68d['latestversion']=_0x1edaa7(0x2c2),_0x1ac51b=!![]);!_0x1fe68d['hasOwnProperty'](_0x1edaa7(0x142))&&(_0x1fe68d['onepagemode']=![],_0x1ac51b=!![]);!_0x1fe68d[_0x1edaa7(0x162)](_0x1edaa7(0x28c))&&(_0x1fe68d[_0x1edaa7(0x28c)]='',_0x1ac51b=!![]);if(_0x1ac51b)storeSettings(_0x1fe68d);try{fs[_0x1edaa7(0x26b)](configbackuppath,{'withFileTypes':!![]})[_0x1edaa7(0x106)](_0x37e717=>{const _0x4a6fbf=_0x1edaa7;if(!_0x37e717['isDirectory']()){if(!_0x37e717['name'][_0x4a6fbf(0xe4)]('backup-full@'))fs['unlinkSync'](configbackuppath+_0x37e717[_0x4a6fbf(0x1c5)]);}else fs['rmSync'](configbackuppath+_0x37e717[_0x4a6fbf(0x1c5)],{'recursive':!![]});});}catch(_0x5a234a){logger[_0x1edaa7(0x1ae)](_0x1edaa7(0x2ef),_0x5a234a);}}function storeConfiguration(_0x3271dd){const _0x32a0d5=_0x77986a;dbConfig[_0x32a0d5(0x164)](_0x32a0d5(0xf8))[_0x32a0d5(0x259)]()[_0x32a0d5(0x15f)](),dbConfig['get']('bots')['push'](..._0x3271dd)['write'](),config=_0x3271dd;}async function resetPassword(){const _0x4acc2b=_0x77986a;if(tgBot&&settings[_0x4acc2b(0x18a)]){const _0x2e100b=Markup[_0x4acc2b(0x2a9)]([Markup[_0x4acc2b(0x21f)][_0x4acc2b(0x15d)](_0x4acc2b(0x221),'resetpw_yes'),Markup['button'][_0x4acc2b(0x15d)]('no','resetpw_no')]);await sendTelegram(settings[_0x4acc2b(0x18a)],_0x4acc2b(0x1c6),_0x2e100b),tgBot[_0x4acc2b(0x271)](/resetpw_(.+)/,async _0x2452ad=>{const _0x443d52=_0x4acc2b,_0x214fd5=_0x2452ad[_0x443d52(0x1e8)][0x1];_0x2452ad[_0x443d52(0x226)]();if(_0x214fd5!='no'){const _0x1a9fd2=0xf,_0x5d8405=_0x443d52(0x129),_0x3bbf77=Array[_0x443d52(0x245)](crypto[_0x443d52(0x2ed)](new Uint32Array(_0x1a9fd2)))[_0x443d52(0x197)](_0x8298d1=>_0x5d8405[_0x8298d1%_0x5d8405['length']])[_0x443d52(0x2c6)](''),_0x4e9e20=bcrypt['hashSync'](_0x3bbf77,saltRounds);storeSettings({'bbPassword':_0x4e9e20}),await sendTelegram(_0x2452ad[_0x443d52(0x1b0)]['id'],_0x443d52(0x1dc)+_0x3bbf77,{'parse_mode':_0x443d52(0x1f3)});}else await sendTelegram(_0x2452ad[_0x443d52(0x1b0)]['id'],_0x443d52(0x114));});}}async function confirmRestore(_0xce8ea2,_0x2bb4c8){const _0xf6e84b=_0x77986a;io['to'](_0xf6e84b(0xf7))[_0xf6e84b(0x161)]('notification',_0xf6e84b(0x283),'success');if(tgBot&&settings['telegramChatId']){const _0x26dd71=uuidRandom();tmpStorage[_0x26dd71]={'path':_0xce8ea2,'filename':_0x2bb4c8};const _0x4a4bc4=Markup[_0xf6e84b(0x2a9)]([Markup[_0xf6e84b(0x21f)][_0xf6e84b(0x15d)]('yes','restore_yes_'+_0x26dd71),Markup['button'][_0xf6e84b(0x15d)]('no',_0xf6e84b(0x236)+_0x26dd71)]);await sendTelegram(settings[_0xf6e84b(0x18a)],_0xf6e84b(0x16b),_0x4a4bc4),tgBot[_0xf6e84b(0x271)](/restore_(.+)_(.+)/,async _0x49a0e8=>{const _0x531d7a=_0xf6e84b,_0x47e1d9=_0x49a0e8['match'][0x1],_0x169726=_0x49a0e8['match'][0x2],{path:_0x36e62a,filename:_0x211617}=tmpStorage[_0x169726];delete tmpStorage[_0x169726],_0x49a0e8[_0x531d7a(0x226)](),_0x47e1d9==_0x531d7a(0x221)?(logger['debug'](_0x531d7a(0x1da)),await sendTelegram(_0x49a0e8[_0x531d7a(0x1b0)]['id'],_0x531d7a(0x1b4),{'parse_mode':_0x531d7a(0x1f3)}),unzipFile(_0x36e62a,_0x211617)):(logger[_0x531d7a(0x1ae)](_0x531d7a(0x1eb)),await sendTelegram(_0x49a0e8[_0x531d7a(0x1b0)]['id'],_0x531d7a(0x1eb)));});}}function getServerTime(){const _0x3665c0=_0x77986a,_0x1b9f2c=new Date();return _0x1b9f2c['getFullYear']()+'/'+(_0x1b9f2c['getMonth']()+0x1)[_0x3665c0(0x25f)]()[_0x3665c0(0x246)](0x2,'0')+'/'+_0x1b9f2c['getDate']()['toString']()['padStart'](0x2,'0')+'\x20'+_0x1b9f2c['getHours']()['toString']()[_0x3665c0(0x246)](0x2,'0')+':'+_0x1b9f2c[_0x3665c0(0x139)]()[_0x3665c0(0x25f)]()['padStart'](0x2,'0')+':'+_0x1b9f2c[_0x3665c0(0x154)]()[_0x3665c0(0x25f)]()[_0x3665c0(0x246)](0x2,'0');}function getTimeStamp(){const _0x580f80=_0x77986a,_0x40f0b1=shiftedTime();return _0x40f0b1[_0x580f80(0x2d7)]()+'/'+(_0x40f0b1['getMonth']()+0x1)['toString']()[_0x580f80(0x246)](0x2,'0')+'/'+_0x40f0b1[_0x580f80(0x13b)]()[_0x580f80(0x25f)]()[_0x580f80(0x246)](0x2,'0')+'\x20'+_0x40f0b1['getHours']()[_0x580f80(0x25f)]()[_0x580f80(0x246)](0x2,'0')+':'+_0x40f0b1['getMinutes']()[_0x580f80(0x25f)]()['padStart'](0x2,'0')+':'+_0x40f0b1[_0x580f80(0x154)]()[_0x580f80(0x25f)]()[_0x580f80(0x246)](0x2,'0');}function getCleanTimeStamp(){const _0x119e88=_0x77986a,_0x441e5b=shiftedTime();return _0x441e5b[_0x119e88(0x2d7)]()+(_0x441e5b[_0x119e88(0x1d8)]()+0x1)[_0x119e88(0x25f)]()[_0x119e88(0x246)](0x2,'0')+_0x441e5b[_0x119e88(0x13b)]()[_0x119e88(0x25f)]()['padStart'](0x2,'0')+'-'+_0x441e5b[_0x119e88(0x209)]()['toString']()[_0x119e88(0x246)](0x2,'0')+_0x441e5b[_0x119e88(0x139)]()[_0x119e88(0x25f)]()[_0x119e88(0x246)](0x2,'0')+_0x441e5b[_0x119e88(0x154)]()[_0x119e88(0x25f)]()[_0x119e88(0x246)](0x2,'0');}function shiftedTime(){const _0x4dc690=_0x77986a,_0xd23d86=new Date();let _0x31f23d=_0xd23d86;if(settings[_0x4dc690(0x2a6)]&&settings['timeshift']!==0x0)_0x31f23d=fns[_0x4dc690(0x252)](_0xd23d86,{'hours':settings[_0x4dc690(0x2a6)]});return _0x31f23d;}async function startScheduler(){const _0x257004=_0x77986a,_0x2b3b5c=new Date()[_0x257004(0x17f)](),_0x562fa7=shiftedTime()[_0x257004(0x209)]();_0x562fa7==0x4&&backupConfigFiles(),_0x562fa7==0x0&&(rotateLogFiles(),logger['debug']('--------------------------------------'),logger[_0x257004(0x1ae)]('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0x257004(0x1e2)?'(staging)':'')),logger[_0x257004(0x1ae)](_0x257004(0x243))),_0x2b3b5c%0x6==0x0&&triggerAnalytics(),_0x2b3b5c%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x2ffa03){const _0x74a517=_0x77986a;logger[_0x74a517(0x1ae)]('Restore\x20backup\x20file\x20'+_0x2ffa03);const _0x4463c7=getBotsWithMode();_0x4463c7[_0x74a517(0x2b5)]>0x0?confirmRestore(configbackuppath,_0x2ffa03):unzipFile(configbackuppath,_0x2ffa03);}async function getBackupFiles(_0x53fa60=null){const _0x8b8fb=_0x77986a;let _0x4dea4b=[],_0x4139da=fs[_0x8b8fb(0x26b)](configbackuppath,{'withFileTypes':!![]});_0x4139da['sort']((_0x4f61a0,_0x1eb6c3)=>_0x4f61a0[_0x8b8fb(0x1c5)]<_0x1eb6c3['name']?0x1:_0x1eb6c3[_0x8b8fb(0x1c5)]<_0x4f61a0[_0x8b8fb(0x1c5)]?-0x1:0x0),_0x4139da['forEach'](_0x17428e=>{const _0xe7c08a=_0x8b8fb;if(!_0x17428e[_0xe7c08a(0x256)]()&&_0x17428e[_0xe7c08a(0x1c5)][_0xe7c08a(0xe4)](_0xe7c08a(0x200))&&_0x17428e['name'][_0xe7c08a(0x29a)]('.zip')){const _0x300385=formatDate(fs[_0xe7c08a(0x12b)](configbackuppath+_0x17428e[_0xe7c08a(0x1c5)])[_0xe7c08a(0x2c7)]);_0x4dea4b['push']({'name':_0x17428e['name'],'mtime':_0x300385});}});if(_0x53fa60)io['to'](_0x53fa60)[_0x8b8fb(0x161)](_0x8b8fb(0xde),_0x4dea4b);else return _0x4dea4b;}function _0x2163(){const _0x4bfb5b=['connection','output-001.log','5\x20min','push','Logged\x20out\x20user\x20...',',\x20must\x20be\x20a\x204\x20digit\x20number','userid','Telegraf\x20error:','bbUsername','NTBA_FIX_319','assign','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','exit','store-headless','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Invalid\x20authentication\x20token\x20(1)','accept','max','uuid','telegram','marketcapApi','[ip-address]','then','\x20(1)','enabled','Invalid\x20IP\x20address','(staging)','File\x20uploaded','restore-backup-file','\x20|\x20client:\x20...','bot-','reset-history','Invalid\x20username\x20or\x20IP\x20address','Login\x20accepted','endsWith','restart_','reinstall_no','message','auto','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','\x1b[36m','telegrammsg','cancel-loading','<b>Balance\x20Bot\x20Status:</b>\x0a','::1','test','timeshift','Allow\x20login\x20from\x20IP\x20address\x20','download','inlineKeyboard','sort','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','manual','config/','showConfig','pidExpireLogin','Unauthorized\x20attempt\x20to\x20delete\x20alerts','any','tempaccess_5_','logs/','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','length','tkn','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','/backup\x20-\x20receive\x20backup\x20files\x0a','publicKeyToPem','existsSync','cloneDeep','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','size','bb-secure.json','slice','Unauthorized\x20attempt\x20to\x20get\x20messages','node','0.0.0','\x20(2)','child_process','rsa','join','mtime','toIPv4Address','#RES#\x20','\x20to\x20','Session\x20expired\x20for\x20user\x20...','BCT','get-starting-balances','https://api.ipify.org?format=json','telegramToken','kill','binary','publicKey','generateKeyPair','temp/','find','\x20only\x0a','getFullYear','express','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','\x20|\x20','|@|','mode','new','value','sign','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','logs','username','args','ipc','secure','express-fileupload','unlinkSync','settings','toggle-bot-mode','createWriteStream','Unauthorized\x20attempt\x20to\x20update\x20settings','once','randomFillSync','Server','Error\x20removing\x20old\x20backup\x20files:','Starting\x20Balance\x20Bot\x20update','command','DEFLATE','***','All','access','api-eu.mixpanel.com','Temporary\x20access\x20rejected','handshake','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','error','reload','index.html','format','Error\x20sending\x20','backup-files','Bot\x20','off','updatebotmanager','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','startsWith','latestversion','whitelistEnabled','2FA\x20required','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','disabled','storeConfiguration','/download/:type',')\x20|\x20Bot\x20','/start','store-configuration','lowdb','SIGTERM','env','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','stringify','reinstall_yes','apply','bbvReceive','botmanager','bots','lastmsgtelegram','alias','2FA','emitHistory','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','All\x20bots','697464pPOyKE','versions','bb-config.json','token','whitelist','remoteAddress','8207408DXAfnD','forEach','title','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','config_alerts','Network\x20Interfaces:','login','getTime','/restart\x20-\x20restart\x20bot(s)\x0a','bbPassword','expiry','production','version.json','notification','warning','Password\x20reset\x20rejected','new-disabled','Alerts','success','telegramIpApproval','backup','metrics_','\x20files\x20over\x20Telegram:','disable','/help\x20-\x20show\x20available\x20commands\x0a','mixpanel','Bot\x20Mgr\x20>\x20','init','node-forge','address','tempaccess_15_','Telegram\x20error:','Unauthorized\x20attempt\x20to\x20delete\x20bot','/logs\x20-\x20receive\x20log\x20files\x0a','removeAllListeners','4xszkuy','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','update','statSync','Yes','#RES#\x20if\x20running\x20locally\x0a',')\x20\x20\x20|\x20Bot\x20','listen','type','/upload-backup','jsonwebtoken','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','output-000.log','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','address\x20already\x20in\x20use','ETH','/enable\x20-\x20enable\x20notifications\x0a','getMinutes','sha256','getDate','toggle','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','alerts','fork','/:bot/coins','confirm-message','onepagemode','bb-settings.json','generateAsync','Starting\x20#RED#Balance\x20Bot\x20v','settings.','Setting\x20access:\x20','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','sendMetricsTelegram','clients','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Unauthorized\x20attempt\x20to\x20add\x20bot','bot','kind','2FA\x20login\x20token\x20generated','update_yes','/:bot/history','backup-full','replyWithDocument','getSeconds','No\x20bots\x20running\x20right\x20now','params','838115ySUYlo','Unauthorized\x20attempt\x20to\x20get\x20events','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','reject','5268648FXTpcd','2FA\x20login\x20required','callback','encryptedUuid','write','zip/','emit','hasOwnProperty','login\x20not\x20required','get','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','internal','Unauthorized\x20attempt\x20to\x20download\x20','all','defaults','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','jszip','reason','http','lastmsgemitted','15\x20min','axios','isIPv4MappedAddress','writeFileSync','login2fa_reject_','_nsps','bbvNew','verify','/metrics\x20-\x20show\x20bot\x20performance\x0a','resetHistory','headers','off_','secret','/output-000.log','\x20minutes','getUTCHours','telegramEvents','login\x20token\x20generated','socket','tempaccess_30_','Notifications\x20types:\x20',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','telegram2FaApproval','exchange','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','hashSync','telegramChatId','************','\x20mode','deleteHistoryAlerts','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','show-config','reply','reinstall-bb','get-logs','Access\x20enabled\x20for\x20','9124DbAeUr','disconnect','map','create','636087SPQJhq','-results.json','IPv4','loginRequired','Notifications\x20disabled','/status\x20-\x20show\x20bot(s)\x20status\x0a','/off\x20-\x20stop\x20bot(s)\x0a','/:bot/performance','number','loadAsync','live','port','readFileSync','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','constructor','help','logged\x20out','-performance.json','post','Invalid\x20authentication\x20token\x20(2)','6KRsqUd','debug','graphql-request','chat','allow','apiKey','store-fiat','Restoring\x20bot(s)\x20from\x20backup','config','::ffff:127.0.0.1','logout','split','No\x20authentication\x20token','data','\x1b[31m','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','login\x20required','254BTMxvt','User\x20has\x20been\x20validated','-----------------------------------------------------------------------------------','Orders','files','bcryptjs','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','name','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','botname','privateKey','full','copyFileSync','login\x20token\x20valid','output-002.log','login2fa_','randomBytes','temporary\x20token\x20generated','catch','config_orders','keys','restart','<b>Telegram\x20Bot\x20Status:</b>\x0a','pki','store','=>\x20Go\x20to\x20#CYA#http://','getMonth','/disable\x20-\x20disable\x20notifications\x0a','Restore\x20process\x20confirmed','argv','Password\x20has\x20been\x20reset\x20to:\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','request','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','delete-alerts','Notifications\x20enabled\x0a','staging','2FA\x20login\x20rejected','min','f2aRequired','get-backup-files','orders','match','sendMessage','temporary\x20access\x20timeout','Restore\x20process\x20aborted','delete-bot','server','Backup\x20file\x20unzipped\x20and\x20stored','build2','access\x20timeout','createServer','.zip','HTML','search','date-fns','path','mkdirSync','Unauthorized\x20attempt\x20to\x20update\x20bot','127.0.0.1','#RES#\x20if\x20running\x20on\x20server','private','apiPassword','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','host','botID','backup-full@','password','sendFile','Failed\x20to\x20download\x20','send','range','sockets','get-portfolio','update-bot','getHours',':\x20Bot\x20Mgr\x20>\x20','set','headless','Ok,\x20will\x20send\x20order\x20notifications\x20only','Ok,\x20will\x20send\x20alert\x20notifications\x20only','parse','Error:\x20Invalid\x20argument\x20','get-messages','getStartingBalances','/on\x20-\x20start\x20bot(s)\x0a','async','/update\x20-\x20update\x20Balance\x20Bot\x0a','util','file','function','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','compareSync','showname','includes','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','backup/','button','\x1b[0m','yes','telegramEnabled','close','ipaddr.js','environment','editMessageReplyMarkup','build','bb/','-config.json','log','static','-events.json','portfolio','pidRefreshToken','decrypt','1031430YamNXw','Starting\x20Balance\x20Bot\x20reinstallation','sortBy','config_all','use','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','restore_no_','auth','exec','Unauthorized\x20login\x20attempt\x20(timeout)','place-order','enable','invalid\x20credentials','replace','uuid-random','Unauthorized\x20attempt\x20to\x20get\x20portfolio','getPortfolio','launch','running','--------------------------------------','(((.+)+)+)+$','from','padStart','/:bot','*$1*','sendPortfolioTelegram','filter','telegramUsername','toIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','conn','Enabled\x20Bot\x20','update-bb','referer','add','simple','code','decode64','isDirectory','names','storeFiat','remove','clientip','event','stopped','rmSync','1000','toString','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','36ndROib','started','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','messages','track','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','\x20>\x20',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','string','yargs/yargs','readdirSync','apiSecret','stop','timestamp','add-bot','blacklist','action','inherit','reinstall','update_no','30\x20min','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','status'];_0x2163=function(){return _0x4bfb5b;};return _0x2163();}async function backupConfigFiles(){const _0x69b0dc=_0x77986a;await zipFiles(_0x69b0dc(0x152));const _0x4ede23=getCleanTimeStamp();fs['copyFileSync'](zippath+'backup-full.zip',configbackuppath+(_0x69b0dc(0x200)+_0x4ede23+_0x69b0dc(0x1f2)));let _0x13bb09=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x13bb09[_0x69b0dc(0x2aa)]((_0x2985a1,_0xdd5d25)=>_0x2985a1[_0x69b0dc(0x1c5)]<_0xdd5d25[_0x69b0dc(0x1c5)]?0x1:_0xdd5d25['name']<_0x2985a1[_0x69b0dc(0x1c5)]?-0x1:0x0),_0x13bb09[_0x69b0dc(0x2b5)]>maxBackups&&fs[_0x69b0dc(0x2e7)](configbackuppath+_0x13bb09[_0x13bb09['length']-0x1][_0x69b0dc(0x1c5)]);}function rotateLogFiles(){const _0x3936d4=_0x77986a,_0x14728d=fs['statSync'](logspath+_0x3936d4(0x134)),_0x10fffc=_0x14728d[_0x3936d4(0x2bd)]/0x400;if(_0x10fffc>0x64){let _0x204dc3=fs[_0x3936d4(0x26b)](logspath,{'withFileTypes':!![]});_0x204dc3[_0x3936d4(0x2aa)]((_0x29d64a,_0x117971)=>_0x29d64a['name']<_0x117971['name']?0x1:_0x117971[_0x3936d4(0x1c5)]<_0x29d64a[_0x3936d4(0x1c5)]?-0x1:0x0),_0x204dc3['forEach'](_0x47992b=>{const _0x40f3bd=_0x3936d4;if(_0x47992b[_0x40f3bd(0x1c5)]==_0x40f3bd(0x1cc))fs['copyFileSync'](logspath+_0x47992b[_0x40f3bd(0x1c5)],logspath+'output-003.log');if(_0x47992b['name']==_0x40f3bd(0x279))fs[_0x40f3bd(0x1ca)](logspath+_0x47992b[_0x40f3bd(0x1c5)],logspath+_0x40f3bd(0x1cc));_0x47992b['name']==_0x40f3bd(0x134)&&(fs['copyFileSync'](logspath+_0x47992b[_0x40f3bd(0x1c5)],logspath+_0x40f3bd(0x279)),fs[_0x40f3bd(0x173)](logspath+_0x47992b[_0x40f3bd(0x1c5)],''));});}}async function zipFiles(_0x2f415a){const _0x568dd6=_0x77986a;let _0x12656d;if(_0x2f415a==_0x568dd6(0x2e1))_0x12656d=logspath;if(_0x2f415a==_0x568dd6(0x119))_0x12656d=configpath;if(_0x2f415a==_0x568dd6(0x152))_0x12656d=configpath;let _0x25f750=fs[_0x568dd6(0x26b)](_0x12656d,{'withFileTypes':!![]});const _0x470c14=new JSZip();_0x25f750['forEach'](_0x3c00ce=>{const _0x31ade1=_0x568dd6;if(!_0x3c00ce[_0x31ade1(0x256)]()){let _0x1c83a6=fs[_0x31ade1(0x1a5)](_0x12656d+_0x3c00ce['name']);if(_0x2f415a=='backup'){const _0x3fcc72=/^bot-[0-9]{3}-config.json$/,_0x56867e=_0x3fcc72[_0x31ade1(0x2a5)](_0x3c00ce[_0x31ade1(0x1c5)]);if(_0x56867e){const _0xaf6e01=JSON['parse'](_0x1c83a6);if(_0xaf6e01['bot'][0x0]){_0xaf6e01[_0x31ade1(0x14d)][0x0]['apiKey']=_0x31ade1(0x2f3),_0xaf6e01[_0x31ade1(0x14d)][0x0][_0x31ade1(0x26c)]=_0x31ade1(0x2f3);if(_0xaf6e01['bot'][0x0][_0x31ade1(0x1fc)])_0xaf6e01[_0x31ade1(0x14d)][0x0][_0x31ade1(0x1fc)]=_0x31ade1(0x2f3);}_0x1c83a6=JSON['stringify'](_0xaf6e01,null,0x2);}if(_0x3c00ce[_0x31ade1(0x1c5)]==_0x31ade1(0x143)){const _0x18faf6=JSON[_0x31ade1(0x20f)](_0x1c83a6);if(_0x18faf6['settings']['loginRequired'])_0x18faf6['settings']['loginRequired']=![];if(_0x18faf6['settings'][_0x31ade1(0x10e)])_0x18faf6[_0x31ade1(0x2e8)]['bbPassword']=_0x31ade1(0x2f3);if(_0x18faf6[_0x31ade1(0x2e8)]['telegramToken'])_0x18faf6[_0x31ade1(0x2e8)][_0x31ade1(0x2cf)]='***';if(_0x18faf6['settings']['telegramChatId'])_0x18faf6[_0x31ade1(0x2e8)][_0x31ade1(0x18a)]=null;if(_0x18faf6[_0x31ade1(0x2e8)][_0x31ade1(0x28c)])_0x18faf6[_0x31ade1(0x2e8)][_0x31ade1(0x28c)]='***';_0x1c83a6=JSON[_0x31ade1(0xf3)](_0x18faf6,null,0x2);}if(_0x3c00ce['name']!=_0x31ade1(0x2be))_0x470c14[_0x31ade1(0x217)](_0x3c00ce[_0x31ade1(0x1c5)],_0x1c83a6);}else _0x470c14[_0x31ade1(0x217)](_0x3c00ce['name'],_0x1c83a6);}});const _0x4a06d0=await _0x470c14[_0x568dd6(0x144)]({'type':'string','base64':![],'compression':_0x568dd6(0x2f2)});fs[_0x568dd6(0x173)](zippath+(_0x2f415a+'.zip'),_0x4a06d0,_0x568dd6(0x2d1));}async function unzipFile(_0x51e7f0,_0x3343de){const _0x4c6a0c=_0x77986a;fs[_0x4c6a0c(0x26b)](configpath,{'withFileTypes':!![]})[_0x4c6a0c(0x106)](_0x422bee=>{const _0x4815a4=_0x4c6a0c;if(!_0x422bee[_0x4815a4(0x256)]())fs[_0x4815a4(0x25d)](configpath+_0x422bee['name']);});const _0x4d3108=fs[_0x4c6a0c(0x1a5)](_0x51e7f0+_0x3343de,_0x4c6a0c(0x2d1)),_0x510f4e=await JSZip[_0x4c6a0c(0x1a2)](_0x4d3108,{'base64':![],'checkCRC32':!![]});for(const _0x1551b5 of Object[_0x4c6a0c(0x1d2)](_0x510f4e['files'])){const _0x468580=_0x510f4e[_0x4c6a0c(0x1c2)][_0x1551b5],_0x422f11=await _0x468580[_0x4c6a0c(0x214)](_0x4c6a0c(0x269));fs['writeFileSync'](configpath+_0x468580['name'],_0x422f11);}fs[_0x4c6a0c(0x26b)](temppath,{'withFileTypes':!![]})['forEach'](_0x4045ee=>{const _0x3f1020=_0x4c6a0c;if(!_0x4045ee[_0x3f1020(0x256)]())fs['rmSync'](temppath+_0x4045ee['name']);}),logger[_0x4c6a0c(0x1ae)](_0x4c6a0c(0x1ee)),process[_0x4c6a0c(0x204)]({'restore':!![]},_0x2c51fe=>{});}async function getPublicIp(){const _0x14535e=_0x77986a;try{const _0x504725=await axios[_0x14535e(0x164)](_0x14535e(0x2ce));publicip=_0x504725[_0x14535e(0x1ba)]['ip'];}catch(_0x49d509){}}async function triggerAnalytics(){const _0x45032e=_0x77986a;if(!publicip)await getPublicIp();const _0x24fd5a=getBotsWithMode();let _0x15ed4f=0x0;_0x24fd5a['forEach'](_0x3890fb=>{const _0x26f0b8=_0x2018;if(_0x3890fb[_0x26f0b8(0x277)]===_0x26f0b8(0x290))_0x15ed4f++;});const _0x46d9fb=getBotExchanges();mixpanel[_0x45032e(0x265)](_0x45032e(0x2ee),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x24fd5a[_0x45032e(0x2b5)],'numbotsenabled':_0x15ed4f,'exchanges':_0x46d9fb,'environment':environment});}async function getMessages(){const _0x264eb6=_0x77986a,_0x580897='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x31f0fb=new GraphQLClient(_0x580897),_0x4381ca={'authorization':_0x264eb6(0x2ab)},_0x37fe5b=serverversion[_0x264eb6(0x1b8)]('.'),_0xa78cf8=_0x37fe5b[0x0]+'.'+_0x37fe5b[0x1],_0x9bc06c=Math[_0x264eb6(0x1e4)](settings[_0x264eb6(0xf9)],settings['lastmsgemitted']),_0xff82fb={'last':parseInt(_0x9bc06c),'bbm':_0xa78cf8},_0x2c396e=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4b3d3b;try{_0x4b3d3b=await _0x31f0fb[_0x264eb6(0x1de)](_0x2c396e,_0xff82fb,_0x4381ca);}catch(_0x8ce88a){}if(_0x4b3d3b&&_0x4b3d3b['messages']){let _0x26824f=settings['lastmsgtelegram'];newMessages=[];for(const _0x5b87bd of _0x4b3d3b[_0x264eb6(0x264)]){newMessages[_0x264eb6(0x27b)](_0x5b87bd);let _0x5d13c9=![];_0x5b87bd[_0x264eb6(0x176)]&&(updateSetting('latestversion',_0x5b87bd['bbvNew']),_0x5d13c9=isNewerVersion(serverversion,_0x5b87bd[_0x264eb6(0x176)])||serverversion==_0x5b87bd[_0x264eb6(0x176)]);if(!_0x5d13c9&&_0x5b87bd['number']>_0x26824f){if(_0x5b87bd[_0x264eb6(0xf6)]===_0x264eb6(0x2b1)||serverversion[_0x264eb6(0xe4)](_0x5b87bd['bbvReceive'])){let _0x45d63f=''+_0x5b87bd[_0x264eb6(0x107)]+'\x0a\x0a'+_0x5b87bd[_0x264eb6(0x29d)];const _0x327a86=await sendTelegramMsg(toTelegramMarkdown(_0x45d63f),'Markdown');if(_0x327a86)_0x26824f=_0x5b87bd[_0x264eb6(0x1a1)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x26824f),emitMessages();}}function emitMessages(){const _0x519beb=_0x77986a,_0x597f40=settings[_0x519beb(0x16f)];let _0x56760a=[];newMessages['forEach'](_0x3eb20a=>{_0x3eb20a['number']>_0x597f40&&_0x56760a['push'](_0x3eb20a);}),_0x56760a[_0x519beb(0x2b5)]>0x0&&getAllClients()[_0x519beb(0x106)](_0x58db07=>{const _0x4e44f6=_0x519beb;getSocket(_0x58db07['id'])['emit'](_0x4e44f6(0x29d),_0x56760a);});}function confirmMessage(_0x4df765){updateSetting('lastmsgemitted',Number(_0x4df765));}function isNewerVersion(_0x27f505,_0x5eb8b0){const _0x5780d4=_0x77986a,_0x4e1c02=_0x5eb8b0[_0x5780d4(0x1b8)]('.'),_0x30983b=_0x27f505[_0x5780d4(0x1b8)]('.');for(var _0x14d88f=0x0;_0x14d88f<_0x30983b['length'];_0x14d88f++){const _0x168c3f=~~_0x30983b[_0x14d88f],_0xdf319d=~~_0x4e1c02[_0x14d88f];if(_0x168c3f>_0xdf319d)return!![];if(_0x168c3f<_0xdf319d)return![];}return![];}function toTelegramMarkdown(_0x12476d){const _0x4b6236=_0x77986a,_0x457473=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x28a6d6=/\*{2}(.+?)\*{2}/gim;return _0x12476d=_0x12476d[_0x4b6236(0x23d)](_0x457473,'$1_$2_$3')['replace'](_0x28a6d6,_0x4b6236(0x248)),_0x12476d;}async function validateConfigFile(){const _0x4ee29a=_0x77986a,_0x2ed447=dbConfig[_0x4ee29a(0x164)]('bots')['sortBy'](_0x4ee29a(0x1ff))[_0x4ee29a(0x2de)]()||[];if(_0x2ed447[_0x4ee29a(0x2b5)]==0x0){let _0x4b8f2e=0x0,_0x2c2266=[];const _0x41e4f9=/^bot-([0-9]{3})-config.json$/,_0x3ad2f4=fs[_0x4ee29a(0x26b)](configpath);_0x3ad2f4['forEach'](_0x2c806a=>{const _0xffe536=_0x4ee29a,_0x1f15fd=_0x41e4f9[_0xffe536(0x238)](_0x2c806a);if(_0x1f15fd){const _0x4c0939=_0x1f15fd[0x1];let _0x470465=getBotAttributes(_0x4c0939);_0x2c2266[_0xffe536(0x27b)]({'botID':_0x4c0939,'botname':_0x470465[_0xffe536(0x1c7)],'status':_0xffe536(0xe9),'live':'stopped'}),_0x4b8f2e++;}}),_0x4b8f2e!=0x0&&(dbConfig[_0x4ee29a(0x164)]('bots')[_0x4ee29a(0x282)](_0x2c2266)[_0x4ee29a(0x15f)](),config=_0x2c2266,restoredConfigFile=_0x4b8f2e);}}async function restoreConfigNotify(_0x47aa7b){const _0x2aa8f1=_0x77986a;let _0x48dc7a;if(restoredConfigFile==0x1)_0x48dc7a=_0x2aa8f1(0xe8);else _0x48dc7a='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x47aa7b)io['to']('botmanager')[_0x2aa8f1(0x161)](_0x2aa8f1(0x112),_0x48dc7a);else{logger[_0x2aa8f1(0x253)](_0x2aa8f1(0x1c0)),logger[_0x2aa8f1(0x253)](_0x48dc7a),logger['simple'](_0x2aa8f1(0x1c0)),logger[_0x2aa8f1(0x253)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x2aa8f1(0x180)]!='orders')await sendTelegram(settings['telegramChatId'],_0x2aa8f1(0x11f)+_0x48dc7a);}}function decryptRSA(_0x4306a7,_0x5711f6){const _0x5228dd=_0x77986a,_0x5e4797=forge[_0x5228dd(0x1d5)]['privateKeyFromPem'](_0x4306a7),_0x1aa1ed=_0x5e4797[_0x5228dd(0x22f)](forge['util'][_0x5228dd(0x255)](_0x5711f6),'RSA-OAEP',{'md':forge['md'][_0x5228dd(0x13a)][_0x5228dd(0x198)](),'mgf1':{'md':forge['md']['sha256'][_0x5228dd(0x198)]()}});return _0x1aa1ed;}function validateCredentials(_0x22d792,_0x1e7aab){const _0x27b42e=_0x77986a;if(_0x22d792[_0x27b42e(0x2e2)]==settings[_0x27b42e(0x280)]&&bcrypt[_0x27b42e(0x21a)](_0x22d792[_0x27b42e(0x201)],settings['bbPassword'])){if(settings[_0x27b42e(0x1e5)])return{'allow':![],'reason':_0x27b42e(0x15c),'token':null};else{const _0x3bd7e6=generateLoginToken(_0x1e7aab);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x3bd7e6};}}else return{'allow':![],'reason':_0x27b42e(0x23c),'token':null};}function refreshToken(_0x1c2184){const _0x4f27a6=generateLoginToken(_0x1c2184);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x4f27a6};}function validateAccess(_0x21f8ec,_0xae759,_0x215dd9){const _0x5720b9=_0x77986a,_0x2696dd=_0x215dd9?_0x215dd9:devices[_0xae759]['ip'];let _0x148bff;const _0x467652=_0x3b3e46=>{const _0xec7618=_0x2018;if(settings[_0xec7618(0x19c)]){if(settings[_0xec7618(0x1e5)]){if(telegram2FaApproved(_0xae759)){const _0x34470b=generateLoginToken(_0xae759);return{'allow':!![],'reason':_0xec7618(0x14f),'token':_0x34470b};}else return{'allow':![],'reason':_0xec7618(0x1bd),'token':null};}else return _0x148bff=validToken(_0x3b3e46,_0xae759),_0x148bff[_0xec7618(0x162)](_0xec7618(0x117))?{'allow':!![],'reason':_0xec7618(0x1cb),'token':_0x3b3e46}:{'allow':![],'reason':_0xec7618(0x1bd),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x5720b9(0xe6)]){let _0x5321c9=[...settings[_0x5720b9(0x103)],_0x5720b9(0x2a4),_0x5720b9(0x1b6),_0x5720b9(0x1f9)];if(_0x5321c9[_0x5720b9(0x21c)](_0x2696dd))return _0x467652(_0x21f8ec);else{_0x148bff=validToken(_0x21f8ec,_0xae759);if(_0x148bff[_0x5720b9(0x162)]('success'))return _0x467652(_0x21f8ec);else{if(telegramIpApproved(_0xae759)){const _0x11cd2c=generateToken(_0xae759);return _0x148bff=_0x467652(_0x21f8ec),_0x148bff[_0x5720b9(0x1b1)]?{'allow':!![],'reason':_0x5720b9(0x1cf),'token':_0x11cd2c}:_0x148bff;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x5720b9(0xe7),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x467652(_0x21f8ec);}function timelyDecrypt(_0x4eb71f,_0x1ed73a,_0x1348a2='@'){const _0x48127b=_0x77986a;if(_0x4eb71f)try{const _0x414e37=decryptRSA(secure[_0x48127b(0x1c8)],_0x4eb71f),_0x145883=_0x414e37[_0x48127b(0x1b8)](_0x1348a2)[0x0],_0x2a5ba1=_0x414e37[_0x48127b(0x1b8)](_0x1348a2)[0x1],_0x3b0cf2=new Date()[_0x48127b(0x10c)]();if(_0x1ed73a){if(_0x3b0cf2-_0x2a5ba1<maxSecretAge*0x3e8)return _0x145883;else return![];}else return _0x145883;}catch(_0x299013){return![];}else return![];}const validToken=(_0xc1cf51,_0x4de569)=>{const _0x5d1357=_0x77986a,_0x212a59=devices[_0x4de569]['ip'];if(!_0xc1cf51)return{'error':_0x5d1357(0x1b9)};for(let _0x5b0334 of blacklist){if(_0x5b0334[_0x5d1357(0x102)]==_0xc1cf51)return{'error':'Token\x20blacklisted'};}let _0x51e7ac;try{_0x51e7ac=jwt[_0x5d1357(0x177)](_0xc1cf51,secure[_0x5d1357(0x17c)]+_0x4de569);}catch{return{'error':_0x5d1357(0x287)};}if(!_0x51e7ac[_0x5d1357(0x162)](_0x5d1357(0x25a))&&!_0x51e7ac['hasOwnProperty'](_0x5d1357(0x2e2))||!_0x51e7ac[_0x5d1357(0x162)]('exp'))return{'error':_0x5d1357(0x1ac)};if(!_0x51e7ac['hasOwnProperty']('username')&&_0x51e7ac['hasOwnProperty']('clientip')){const {clientip:_0x5642da}=_0x51e7ac;return _0x212a59==_0x5642da?{'success':_0x5d1357(0x1bf)}:{'error':_0x5d1357(0x291)};}else{if(_0x51e7ac[_0x5d1357(0x162)]('username')&&_0x51e7ac[_0x5d1357(0x162)](_0x5d1357(0x25a))){const {username:_0x49e850,clientip:_0x262b55}=_0x51e7ac;return settings['bbUsername']==_0x49e850&&_0x212a59==_0x262b55?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x5d1357(0x298)};}}},generateLoginToken=_0x2e8b66=>{const _0x1b41eb=_0x77986a;if(_0x2e8b66){const _0x17306c=devices[_0x2e8b66]['ip'];return jwt[_0x1b41eb(0x2df)]({'username':settings[_0x1b41eb(0x280)],'clientip':_0x17306c},secure[_0x1b41eb(0x17c)]+_0x2e8b66,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x3a9017=>{const _0x11605d=_0x77986a;if(_0x3a9017){const _0x293f41=devices[_0x3a9017]['ip'];return jwt[_0x11605d(0x2df)]({'clientip':_0x293f41},secure[_0x11605d(0x17c)]+_0x3a9017,{'expiresIn':devices[_0x3a9017]['telegramIpApproval'][_0x11605d(0x10f)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0xba77ed=>{const _0x3cd556=_0x77986a;let _0x424ebb=![];return devices[_0xba77ed][_0x3cd556(0x118)]&&devices[_0xba77ed][_0x3cd556(0x118)][_0x3cd556(0x10f)]!=_0x3cd556(0x15a)&&(_0x424ebb=devices[_0xba77ed]['telegramIpApproval'][_0x3cd556(0x25a)]==devices[_0xba77ed]['ip']&&new Date()[_0x3cd556(0x10c)]()-devices[_0xba77ed][_0x3cd556(0x118)][_0x3cd556(0x26e)]<devices[_0xba77ed][_0x3cd556(0x118)][_0x3cd556(0x10f)]*0x3c*0x3e8),_0x424ebb;},telegram2FaApproved=_0x524e13=>{const _0x579e04=_0x77986a;let _0x4fd49c=![];return devices[_0x524e13]['telegram2FaApproval']&&devices[_0x524e13][_0x579e04(0x186)]['expiry']!=_0x579e04(0x15a)&&(_0x4fd49c=devices[_0x524e13][_0x579e04(0x186)][_0x579e04(0x25a)]==devices[_0x524e13]['ip']&&new Date()[_0x579e04(0x10c)]()-devices[_0x524e13][_0x579e04(0x186)][_0x579e04(0x26e)]<devices[_0x524e13][_0x579e04(0x186)][_0x579e04(0x10f)]*0x3c*0x3e8),_0x4fd49c;},normalizeIP=_0x3939b3=>{const _0x339081=_0x77986a;let _0x400273=null,_0xf306a6=null;if(ipaddr['isValid'](_0x3939b3)){const _0x4f883c=ipaddr[_0x339081(0x20f)](_0x3939b3);_0x4f883c[_0x339081(0x14e)]()==='ipv6'?(_0x4f883c[_0x339081(0x172)]()&&(_0x400273=_0x4f883c[_0x339081(0x2c8)]()[_0x339081(0x25f)]()),_0xf306a6=_0x4f883c[_0x339081(0x25f)]()):(_0x400273=_0x4f883c['toString'](),_0xf306a6=_0x4f883c[_0x339081(0x24c)]()['toString']());}return{'show':_0x400273?_0x400273:_0xf306a6,'store':_0xf306a6};};function formatDate(_0x96e6b7){const _0x4830f5=_0x77986a;return _0x96e6b7[_0x4830f5(0x2d7)]()+'/'+(_0x96e6b7[_0x4830f5(0x1d8)]()+0x1)['toString']()[_0x4830f5(0x246)](0x2,'0')+'/'+_0x96e6b7[_0x4830f5(0x13b)]()[_0x4830f5(0x25f)]()[_0x4830f5(0x246)](0x2,'0')+'\x20'+_0x96e6b7[_0x4830f5(0x209)]()['toString']()['padStart'](0x2,'0')+':'+_0x96e6b7[_0x4830f5(0x139)]()[_0x4830f5(0x25f)]()[_0x4830f5(0x246)](0x2,'0')+':'+_0x96e6b7[_0x4830f5(0x154)]()[_0x4830f5(0x25f)]()[_0x4830f5(0x246)](0x2,'0');}function sleep(_0x225904){return new Promise(_0x347ea3=>setTimeout(_0x347ea3,_0x225904));}