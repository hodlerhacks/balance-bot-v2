const _0x373308=_0xbb71;(function(_0x2a72ac,_0x59e6a2){const _0x16d1b0=_0xbb71,_0x183647=_0x2a72ac();while(!![]){try{const _0x58bcd2=parseInt(_0x16d1b0(0x1b9))/0x1+parseInt(_0x16d1b0(0xba))/0x2*(-parseInt(_0x16d1b0(0x90))/0x3)+parseInt(_0x16d1b0(0x28d))/0x4+parseInt(_0x16d1b0(0xac))/0x5+-parseInt(_0x16d1b0(0x28c))/0x6+parseInt(_0x16d1b0(0x198))/0x7*(parseInt(_0x16d1b0(0xb8))/0x8)+parseInt(_0x16d1b0(0xe9))/0x9*(-parseInt(_0x16d1b0(0xc7))/0xa);if(_0x58bcd2===_0x59e6a2)break;else _0x183647['push'](_0x183647['shift']());}catch(_0x4a7136){_0x183647['push'](_0x183647['shift']());}}}(_0xdcde,0x3f6b6));const _0x17c979=function(){let _0x1daa14=!![];return function(_0x8915ef,_0x3464a2){const _0x47c678=_0x1daa14?function(){if(_0x3464a2){const _0x43a9dd=_0x3464a2['apply'](_0x8915ef,arguments);return _0x3464a2=null,_0x43a9dd;}}:function(){};return _0x1daa14=![],_0x47c678;};}(),_0x342b00=_0x17c979(this,function(){const _0xcd5791=_0xbb71;return _0x342b00[_0xcd5791(0x226)]()[_0xcd5791(0x85)](_0xcd5791(0x215))[_0xcd5791(0x226)]()['constructor'](_0x342b00)[_0xcd5791(0x85)](_0xcd5791(0x215));});_0x342b00();'use strict';process[_0x373308(0x266)][_0x373308(0xfe)]=0x1;const childProcess=require(_0x373308(0x1d9)),fs=require('fs'),fns=require(_0x373308(0x25e)),low=require(_0x373308(0xe7)),FileSync=require(_0x373308(0x12a)),path=require(_0x373308(0x1e6)),crypto=require(_0x373308(0x100)),forge=require(_0x373308(0x1ca)),bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require(_0x373308(0x1cd)),argv=require(_0x373308(0x1bd))(process[_0x373308(0xb3)][_0x373308(0x128)](0x2))['argv'],uuidRandom=require(_0x373308(0x80)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x373308(0xcd)),axios=require('axios'),{GraphQLClient,gql}=require(_0x373308(0x16f)),util=require('util'),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x373308(0x101)),PORT=argv[_0x373308(0x109)]||_0x373308(0x126),pattern=/^[0-9]{2,4}$/;!pattern[_0x373308(0x1ac)](PORT)&&(console[_0x373308(0x235)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0x373308(0x238)]||null,userID=argv[_0x373308(0xf9)]||'',debugging=argv['d']||![],nodeversion=process[_0x373308(0x7a)][_0x373308(0xce)];let bbpath=_0x373308(0x19a),bbpath2='';const botfile=_0x373308(0x1f8),configfile=_0x373308(0x232),settingsfile=_0x373308(0xbd),securefile=_0x373308(0x210),environment=require('./'+bbpath2+'version.json')[_0x373308(0x178)]||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x373308(0x8b)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x373308(0x1db),configbackuppath=configpath+_0x373308(0x1f5),logspath=userID?bbpath+_0x373308(0x92)+userID+'/':bbpath+_0x373308(0x92),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+'zip/',loggerfile=fs[_0x373308(0x9d)](logspath+_0x373308(0x11f),{'flags':'a'}),temppath=userID?bbpath+_0x373308(0x294)+userID+'/':bbpath+_0x373308(0x294);!fs['existsSync'](configpath)&&fs[_0x373308(0x120)](configpath);!fs[_0x373308(0x8b)](configbackuppath)&&fs[_0x373308(0x120)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x373308(0x120)](logspath);!fs[_0x373308(0x8b)](zippath)&&fs[_0x373308(0x120)](zippath);!fs['existsSync'](temppath)&&fs[_0x373308(0x120)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x373308(0x204)]({'bots':[]})[_0x373308(0x162)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x373308(0x204)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x373308(0x162)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x373308(0x204)]({'secure':{},'blacklist':[]})[_0x373308(0x162)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x373308(0x1fe)](_0x373308(0x22d),{'host':_0x373308(0x187)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x373308(0xa9)]&&(settings[_0x373308(0xa9)]!=''&&settings[_0x373308(0xa9)]!=_0x373308(0xbe))&&settings[_0x373308(0x1dc)]&&settings[_0x373308(0x1dc)]!='')initTelegram();const parseColor=(_0x1fe62b,_0x39c478)=>{const _0x157af0=_0x373308,_0x2da131=/#[A-Z]{3}#/g;if(typeof _0x1fe62b==_0x157af0(0x1ea)){!_0x39c478?_0x1fe62b=_0x1fe62b[_0x157af0(0x201)](_0x2da131,''):(_0x1fe62b=_0x1fe62b[_0x157af0(0x201)](/#BLU#/g,_0x157af0(0xd7)),_0x1fe62b=_0x1fe62b['replace'](/#RED#/g,'\x1b[31m'),_0x1fe62b=_0x1fe62b[_0x157af0(0x201)](/#YEL#/g,'\x1b[33m'),_0x1fe62b=_0x1fe62b[_0x157af0(0x201)](/#MAG#/g,_0x157af0(0x25d)),_0x1fe62b=_0x1fe62b['replace'](/#CYA#/g,_0x157af0(0xf3)),_0x1fe62b=_0x1fe62b[_0x157af0(0x201)](/#RES#/g,_0x157af0(0x145)));;}return _0x1fe62b;},logger={'screen':_0x22446c=>{console['log'](parseColor(_0x22446c,!![]));},'simple':_0x9cb9a9=>{const _0x20ffc0=_0x373308;console['log'](parseColor(_0x9cb9a9,!![])),loggerfile[_0x20ffc0(0x162)](util['format'](parseColor(_0x9cb9a9,![]))+'\x0a');},'full':async _0x2f0e13=>{const _0x19f313=_0x373308,_0x1eff88=getTimeStamp()+_0x19f313(0x27e)+_0x2f0e13;console['log'](parseColor(_0x1eff88,!![])),loggerfile[_0x19f313(0x162)](util[_0x19f313(0x209)](parseColor(_0x1eff88,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!='orders')await sendTelegram(settings[_0x19f313(0x133)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x2f0e13,![]));},'debug':async(_0x187c17,_0x1a9684='')=>{const _0x149e8d=_0x373308,_0x42b042=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x187c17;if(debugging)console[_0x149e8d(0x235)](parseColor(_0x42b042,!![]));loggerfile[_0x149e8d(0x162)](util['format'](parseColor(_0x42b042,![]))+'\x0a');if(_0x1a9684){if(debugging)console[_0x149e8d(0x235)](_0x1a9684);loggerfile[_0x149e8d(0x162)](util['format'](_0x1a9684)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0xec2865){const _0x12b777=_0x373308;_0xec2865[_0x12b777(0x226)]()[_0x12b777(0xc5)](_0x12b777(0x22e))?(logger['simple'](_0x12b777(0x103)+_0xec2865['port']+_0x12b777(0x21d)),process[_0x12b777(0x26f)]({'terminate':!![]},_0x25d1a4=>{})):logger['simple'](_0xec2865);}),process['on'](_0x373308(0x174),()=>{const _0x490f0b=_0x373308;stopAllBots(),process[_0x490f0b(0x174)](0x0);}),process['on']('SIGTERM',()=>{const _0x2a6909=_0x373308;stopAllBots(),process[_0x2a6909(0x174)](0x0);}),process['on'](_0x373308(0xa5),()=>{const _0x58509c=_0x373308;stopAllBots(),process[_0x58509c(0x174)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x373308(0x116))[_0x373308(0x261)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x373308(0x17c))[_0x373308(0x9b)](app);app[_0x373308(0x1d5)](fileUpload({'useTempFiles':!![]})),app[_0x373308(0x1ab)](_0x373308(0xcf),async(_0x1a915c,_0x10f1ed)=>{const _0x55afa9=_0x373308,_0x4bfb49=_0x1a915c[_0x55afa9(0x15d)][_0x55afa9(0x139)],_0x563527=getClientsWithBotID('botmanager'),_0x8ef938=_0x1a915c[_0x55afa9(0xf1)][_0x55afa9(0x1d8)],_0x367c08=timelyDecrypt(_0x8ef938,![]),_0x247f08=_0x563527[_0x55afa9(0xe0)](_0x25489c=>_0x25489c[_0x55afa9(0x1d8)]==_0x367c08);if(_0x247f08){const _0x110821=normalizeIP(_0x1a915c['socket'][_0x55afa9(0xf7)])[_0x55afa9(0x23c)],_0xa72375=_0x1a915c[_0x55afa9(0xf1)][_0x55afa9(0xc4)];if(validateAccess(_0xa72375,_0x367c08,_0x110821)[_0x55afa9(0x14b)])_0x4bfb49==_0x55afa9(0x1d7)&&await backupConfigFiles(),await zipFiles(_0x4bfb49),_0x10f1ed[_0x55afa9(0x1f7)](zippath+(_0x4bfb49+'.zip'),_0x17d8e6=>{const _0x5c7292=_0x55afa9;_0x17d8e6&&(logger[_0x5c7292(0x82)](_0x5c7292(0x293)+_0x4bfb49),logger['simple'](_0x17d8e6));});else logger[_0x55afa9(0x82)](_0x55afa9(0x1f6)+_0x4bfb49+'\x20(1)');}else logger[_0x55afa9(0x82)](_0x55afa9(0x1f6)+_0x4bfb49+'\x20(2)');}),app[_0x373308(0x1ee)](_0x373308(0x23e),async(_0x1416e4,_0x2a7291)=>{const _0x1c4292=_0x373308,_0x133657=getClientsWithBotID('botmanager'),_0x14483f=_0x1416e4[_0x1c4292(0xf1)][_0x1c4292(0x1d8)],_0xcf5cd=timelyDecrypt(_0x14483f,![]),_0x56a8ef=_0x133657[_0x1c4292(0xe0)](_0x464853=>_0x464853['uuid']==_0xcf5cd);logger[_0x1c4292(0x8e)](_0x1c4292(0x28b));if(_0x56a8ef){const _0x2cda01=normalizeIP(_0x1416e4[_0x1c4292(0x79)]['remoteAddress'])[_0x1c4292(0x23c)],_0x6dea34=_0x1416e4['headers']['tkn'];if(validateAccess(_0x6dea34,_0xcf5cd,_0x2cda01)[_0x1c4292(0x14b)]){if(_0x1416e4[_0x1c4292(0x1aa)]){const _0x3de156=_0x1416e4['files'][_0x1c4292(0xad)];await _0x3de156['mv'](temppath+_0x3de156[_0x1c4292(0x12e)]),_0x2a7291['send']({'status':!![],'message':'File\x20uploaded'});const _0x5541be=getBotsWithMode();_0x5541be[_0x1c4292(0x16b)]>0x0?confirmRestore(temppath,_0x3de156[_0x1c4292(0x12e)]):unzipFile(temppath,_0x3de156['name']);}}else logger[_0x1c4292(0x82)](_0x1c4292(0x21a));}else logger[_0x1c4292(0x82)](_0x1c4292(0x7c));}),app[_0x373308(0x1d5)](express[_0x373308(0x23f)](path[_0x373308(0xf2)](__dirname,bbpath2,_0x373308(0x1bf)))),app['use'](express[_0x373308(0x23f)](path[_0x373308(0xf2)](__dirname,bbpath2,_0x373308(0x150)))),app[_0x373308(0x1ab)]('/',function(_0x5cfdef,_0x101392){const _0x44412=_0x373308;_0x101392[_0x44412(0xa0)](path[_0x44412(0xf2)](__dirname,bbpath2,_0x44412(0x1bf),_0x44412(0x15c)));}),app[_0x373308(0x1ab)](_0x373308(0x233),function(_0x193dd5,_0x5907d8){const _0x3c55dc=_0x373308;_0x5907d8[_0x3c55dc(0xa0)](path[_0x3c55dc(0xf2)](__dirname,bbpath2,_0x3c55dc(0x150),'index.html'));}),app[_0x373308(0x1ab)](_0x373308(0xb7),(_0x5b76e9,_0x4e2bcf)=>{const _0x49752b=_0x373308;_0x4e2bcf[_0x49752b(0xa0)](path[_0x49752b(0xf2)](__dirname,bbpath2,'build',_0x49752b(0x15c)));}),app['get'](_0x373308(0x97),(_0x1c01b1,_0x2a808b)=>{const _0x34e1a2=_0x373308;_0x2a808b[_0x34e1a2(0xa0)](path[_0x34e1a2(0xf2)](__dirname,bbpath2,_0x34e1a2(0x150),_0x34e1a2(0x15c)));}),app[_0x373308(0x1ab)](_0x373308(0x19e),(_0x569401,_0x95a397)=>{const _0x5a9d34=_0x373308;_0x95a397[_0x5a9d34(0xa0)](path[_0x5a9d34(0xf2)](__dirname,bbpath2,'build',_0x5a9d34(0x15c)));}),app[_0x373308(0x1ab)](_0x373308(0xb9),(_0x4525cf,_0x46e32d)=>{const _0xb20498=_0x373308;_0x46e32d[_0xb20498(0xa0)](path[_0xb20498(0xf2)](__dirname,bbpath2,'build',_0xb20498(0x15c)));}),app['get'](_0x373308(0x1a9),(_0x197e89,_0x585f81)=>{const _0x47e24a=_0x373308;_0x585f81[_0x47e24a(0xa0)](path[_0x47e24a(0xf2)](__dirname,bbpath2,_0x47e24a(0x150),_0x47e24a(0x15c)));}),app['get'](_0x373308(0x1c6),(_0xfd8b16,_0xc4eb27)=>{const _0x1e9cbd=_0x373308;_0xc4eb27[_0x1e9cbd(0xa0)](path[_0x1e9cbd(0xf2)](__dirname,bbpath2,_0x1e9cbd(0x150),_0x1e9cbd(0x15c)));});if(HOST)http['listen'](PORT,HOST);else http[_0x373308(0x1c9)](PORT);const io=require(_0x373308(0x24e))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0xfe6c4a=_0x373308;let _0x120a93='[ip-address]';const _0x35d9fb=networkInterfaces(),_0x44dffc={};for(const _0x31614e of Object[_0xfe6c4a(0x25b)](_0x35d9fb)){for(const _0x89ac0d of _0x35d9fb[_0x31614e]){if((_0x89ac0d[_0xfe6c4a(0xd5)]==_0xfe6c4a(0x264)||_0x89ac0d[_0xfe6c4a(0xd5)]==0x4)&&!_0x89ac0d[_0xfe6c4a(0xfc)]){const _0x73fc11=ipaddr[_0xfe6c4a(0x108)](_0x89ac0d['address'])['range']();_0x73fc11!='private'&&(!_0x44dffc[_0x31614e]&&(_0x44dffc[_0x31614e]=[]),_0x44dffc[_0x31614e][_0xfe6c4a(0xaa)](_0x89ac0d[_0xfe6c4a(0x14e)]),_0x120a93=_0x89ac0d[_0xfe6c4a(0x14e)]);}}}return{'serverip':_0x120a93,'netinterfaces':_0x44dffc};}async function startServer(){const _0x489ed3=_0x373308,{serverip:_0x5850e3,netinterfaces:_0x40c291}=getServerIP();logger[_0x489ed3(0x160)](''),logger['simple'](_0x489ed3(0x1e4)),await logger[_0x489ed3(0x82)](_0x489ed3(0x1b2)+serverversion+_0x489ed3(0x1e7)+(environment==_0x489ed3(0x1dd)?_0x489ed3(0x289):'')+'\x0a'+(_0x489ed3(0x8d)+PORT+_0x489ed3(0x9e))+('=>\x20Go\x20to\x20#CYA#http://'+_0x5850e3+':'+PORT+_0x489ed3(0x96))),logger[_0x489ed3(0x160)](_0x489ed3(0x1e4));if(config['length']!=0x0)for(const _0x1a4531 of config){const _0x42715f=_0x1a4531['mode']==_0x489ed3(0x1ed)?'a':'m';if(_0x1a4531['status']==_0x489ed3(0x19f)||_0x1a4531[_0x489ed3(0x122)]==_0x489ed3(0x1e9))await logger['full'](_0x489ed3(0x95)+_0x42715f+_0x489ed3(0x182)+_0x1a4531['botID']+_0x489ed3(0x8f)+_0x1a4531[_0x489ed3(0x1d0)]),startBot([_0x1a4531[_0x489ed3(0x142)],userID],{'cwd':bbpath},function(_0x4b4f34){const _0x28c398=_0x489ed3;if(_0x4b4f34)logger[_0x28c398(0x82)](_0x4b4f34);});else(_0x1a4531[_0x489ed3(0x122)]==_0x489ed3(0xff)||_0x1a4531[_0x489ed3(0x122)]==_0x489ed3(0x230))&&await logger[_0x489ed3(0x82)]('Idling\x20('+_0x42715f+_0x489ed3(0x175)+_0x1a4531[_0x489ed3(0x142)]+_0x489ed3(0x8f)+_0x1a4531[_0x489ed3(0x1d0)]);}else!newBot&&logger[_0x489ed3(0x160)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x489ed3(0x160)](_0x489ed3(0x1e4)),logger[_0x489ed3(0x160)](''),await logger[_0x489ed3(0x8e)](_0x489ed3(0xcb)+nodeversion),await logger[_0x489ed3(0x8e)](_0x489ed3(0x256),_0x40c291);}function startSocket(){const _0x1bf75d=_0x373308;io['on'](_0x1bf75d(0xe3),_0x151161=>{const _0x1d55c2=_0x1bf75d;let _0x2195d8,_0x57b616,_0x550afa,_0x2aa395,_0x5b13b1;const _0x310a66=_0x151161[_0x1d55c2(0x240)][_0x1d55c2(0xf1)][_0x1d55c2(0xe6)];_0x57b616=_0x310a66[_0x1d55c2(0x1fc)](/bot[0-9]{3}/);if(_0x57b616)_0x550afa=_0x57b616[0x0][_0x1d55c2(0x1fc)](/[0-9]{3}/);if(_0x550afa)_0x2195d8=_0x550afa[0x0];else _0x2195d8=_0x1d55c2(0x155);const _0x38d7b0=_0x151161[_0x1d55c2(0x240)][_0x1d55c2(0xea)]['encryptedUuid'];if(!_0x38d7b0)_0x151161[_0x1d55c2(0x129)](_0x1d55c2(0x122),{'publicKey':secure[_0x1d55c2(0x130)]});else{_0x2aa395=timelyDecrypt(_0x38d7b0,![]);if(!_0x2aa395)_0x151161[_0x1d55c2(0x129)](_0x1d55c2(0x122),{'publicKey':secure[_0x1d55c2(0x130)]});else{_0x5b13b1=normalizeIP(_0x151161['conn'][_0x1d55c2(0xf7)])['store'];if(!devices[_0x2aa395])devices[_0x2aa395]={'uuid':_0x2aa395,'access':{'token':null}};devices[_0x2aa395]['ip']=_0x5b13b1;const _0x4704c8=addClient(_0x151161['id'],_0x2aa395,_0x2195d8);setAccess(_0x4704c8),emitMessages(),_0x151161['on'](_0x1d55c2(0xd4),_0x1586ac=>{const _0x3bd84c=_0x1d55c2,_0x3139fd=timelyDecrypt(_0x1586ac['password'],!![],_0x3bd84c(0x183));if(_0x3139fd){_0x1586ac={'username':_0x1586ac['username'],'password':_0x3139fd},devices[_0x2aa395]['access']=validateCredentials(_0x1586ac,_0x2aa395);if(devices[_0x2aa395][_0x3bd84c(0x248)][_0x3bd84c(0x14b)]==![]&&devices[_0x2aa395][_0x3bd84c(0x248)][_0x3bd84c(0x163)]==_0x3bd84c(0x13b))_0x151161[_0x3bd84c(0x129)](_0x3bd84c(0x122),{'access':devices[_0x2aa395][_0x3bd84c(0x248)]}),loginAccess2FA(_0x2aa395,_0x5b13b1);else{if(devices[_0x2aa395]['access']['allow']==![]&&devices[_0x2aa395]['access'][_0x3bd84c(0x163)]==_0x3bd84c(0x7d))_0x151161[_0x3bd84c(0x129)](_0x3bd84c(0x122),{'access':devices[_0x2aa395]['access']});else devices[_0x2aa395][_0x3bd84c(0x248)][_0x3bd84c(0x14b)]&&devices[_0x2aa395][_0x3bd84c(0x248)][_0x3bd84c(0x163)]==_0x3bd84c(0x17e)&&(getClientsWithUuid(_0x2aa395)[_0x3bd84c(0x24a)](_0x28e80a=>{setAccess(_0x28e80a);}),logger[_0x3bd84c(0x8e)](_0x3bd84c(0x9c)+_0x2aa395[_0x3bd84c(0x128)](-0x8)),setTokenRefresh(_0x2aa395),setSessionTimeout(_0x3bd84c(0xd4),_0x2aa395));}}else logger[_0x3bd84c(0x82)](_0x3bd84c(0x214));}),_0x151161['on']('reset-password',()=>{resetPassword();}),_0x151161['on'](_0x1d55c2(0x17b),_0x1d7038=>{removeClient(_0x151161['id']);}),_0x2195d8==_0x1d55c2(0x155)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x3e52c6){const _0x2289f7=_0x373308;if(_0x3e52c6!=_0x2289f7(0x155)&&config[_0x2289f7(0x159)]!=''){if(pid[_0x3e52c6])pid[_0x3e52c6]['send']({'function':_0x2289f7(0x10f),'args':null});}_0x3e52c6!='botmanager'&&broadcastToBots('bots',JSON[_0x2289f7(0x229)](config));}function reloadBotManager(){const _0x4966aa=_0x373308;getClientsWithBotID(_0x4966aa(0x155))[_0x4966aa(0x24a)](_0x42c5e9=>{const _0x49950e=_0x4966aa;getSocket(_0x42c5e9['id'])[_0x49950e(0x129)](_0x49950e(0x122),{'access':{'allow':![],'reason':_0x49950e(0x166),'token':null}});});}function getSocket(_0x42295e){const _0x46c341=_0x373308,_0x3f6033=io['_nsps'][_0x46c341(0x1ab)]('/');return _0x3f6033[_0x46c341(0xf6)]['get'](_0x42295e);}function setAccess(_0x5b7178){const _0x565360=_0x373308,_0xb90688=getSocket(_0x5b7178['id']),_0x56e1dc=_0x5b7178['uuid'],_0x4126df=_0x5b7178[_0x565360(0x205)];devices[_0x56e1dc]['access']=validateAccess(devices[_0x56e1dc][_0x565360(0x248)][_0x565360(0x161)],_0x56e1dc),logger[_0x565360(0x8e)]('Setting\x20access:\x20'+devices[_0x56e1dc]['access'][_0x565360(0x163)]+_0x565360(0x20b)+_0x5b7178['id'][_0x565360(0x128)](-0x8)+_0x565360(0x218)+_0x56e1dc[_0x565360(0x128)](-0x8)),_0xb90688[_0x565360(0xf2)](_0x56e1dc);if(devices[_0x56e1dc]['access']['allow']){_0xb90688['join'](_0x4126df);if(_0x4126df=='botmanager')initializeSocketBotManager(_0xb90688);else initializeSocketBot(_0xb90688);initClient(_0x4126df);}devices[_0x56e1dc][_0x565360(0x248)]['token']&&devices[_0x56e1dc][_0x565360(0x248)][_0x565360(0x163)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x565360(0x147),_0x56e1dc),devices[_0x56e1dc][_0x565360(0x248)][_0x565360(0x161)]&&devices[_0x56e1dc][_0x565360(0x248)][_0x565360(0x163)]==_0x565360(0x1bb)&&setSessionTimeout('login',_0x56e1dc),_0xb90688[_0x565360(0x129)]('status',{'status':_0x5b7178[_0x565360(0x27c)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x56e1dc][_0x565360(0x248)],'externalip':devices[_0x56e1dc]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x565360(0x236)],'validInstallation':validInstallation}),devices[_0x56e1dc][_0x565360(0x248)][_0x565360(0x14b)]==![]&&devices[_0x56e1dc][_0x565360(0x248)][_0x565360(0x163)]==_0x565360(0x12d)&&temporaryAccess2FA(_0x56e1dc,devices[_0x56e1dc]['ip']);}function setSessionTimeout(_0x26408a,_0xc3bdc3){const _0x41043f=_0x373308;let _0x18bc81;if(_0x26408a=='login')_0x18bc81=loginExpiry*0x3c*0x3e8;else _0x18bc81=devices[_0xc3bdc3][_0x41043f(0x27d)][_0x41043f(0x1b6)]*0x3c*0x3e8-(new Date()[_0x41043f(0x24c)]()-devices[_0xc3bdc3][_0x41043f(0x27d)]['timestamp']);if(devices[_0xc3bdc3][_0x41043f(0x15e)])clearTimeout(devices[_0xc3bdc3][_0x41043f(0x15e)]);devices[_0xc3bdc3][_0x41043f(0x15e)]=setTimeout(()=>{const _0x1bec27=_0x41043f;if(devices[_0xc3bdc3][_0x1bec27(0x1d3)])clearTimeout(devices[_0xc3bdc3][_0x1bec27(0x1d3)]);removeSocketListeners(_0xc3bdc3),addBlacklist(_0xc3bdc3),devices[_0xc3bdc3][_0x1bec27(0x27d)]=null,devices[_0xc3bdc3][_0x1bec27(0x176)]=null,devices[_0xc3bdc3]['access']['token']=null,logger[_0x1bec27(0x8e)](_0x1bec27(0x28f)+_0xc3bdc3[_0x1bec27(0x128)](-0x8)),devices[_0xc3bdc3]['access']=validateAccess(devices[_0xc3bdc3][_0x1bec27(0x248)][_0x1bec27(0x161)],_0xc3bdc3),!(devices[_0xc3bdc3][_0x1bec27(0x248)]['allow']&&devices[_0xc3bdc3]['access'][_0x1bec27(0x163)]==_0x1bec27(0x260))&&(_0x26408a=='login'?io['to'](_0xc3bdc3)[_0x1bec27(0x129)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0xc3bdc3)[_0x1bec27(0x129)](_0x1bec27(0x122),{'access':{'allow':![],'reason':_0x1bec27(0xa7),'token':null}})),devices[_0xc3bdc3][_0x1bec27(0x248)][_0x1bec27(0x161)]=null;},_0x18bc81);}function setTokenRefresh(_0x2e7bae){const _0x6d7d64=_0x373308;if(devices[_0x2e7bae][_0x6d7d64(0x1d3)])clearTimeout(devices[_0x2e7bae][_0x6d7d64(0x1d3)]);devices[_0x2e7bae][_0x6d7d64(0x1d3)]=setTimeout(()=>{const _0x5df44f=_0x6d7d64;getClientsWithUuid(_0x2e7bae)[_0x5df44f(0x16b)]!=0x0?(devices[_0x2e7bae][_0x5df44f(0x248)]=refreshToken(_0x2e7bae),io['to'](_0x2e7bae)[_0x5df44f(0x129)](_0x5df44f(0x122),{'status':_0x5df44f(0x137),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2e7bae][_0x5df44f(0x248)],'externalip':devices[_0x2e7bae]['ip'],'publicKey':secure[_0x5df44f(0x130)],'validInstallation':validInstallation}),setTokenRefresh(_0x2e7bae)):clearTimeout(devices[_0x2e7bae][_0x5df44f(0x1d3)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4d2298){const _0x5c64a8=_0x373308,_0x42bc06=getClient(_0x4d2298['id'])[_0x5c64a8(0x1d8)];_0x4d2298[_0x5c64a8(0x129)](_0x5c64a8(0x89),config),_0x4d2298[_0x5c64a8(0x129)](_0x5c64a8(0x93),cleanSettings()),_0x4d2298['on'](_0x5c64a8(0x13d),_0x40e775=>{const _0x6d699f=_0x5c64a8;if(validateAccess(_0x40e775,_0x42bc06)[_0x6d699f(0x14b)])addBot();else logger[_0x6d699f(0x82)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x4d2298['on'](_0x5c64a8(0xe2),(_0x5bf91a,_0x52fbd3)=>{const _0x368213=_0x5c64a8;if(validateAccess(_0x52fbd3,_0x42bc06)['allow'])toggleBot(_0x5bf91a[_0x368213(0x142)],_0x5bf91a[_0x368213(0x122)],_0x5bf91a[_0x368213(0xa8)]);else logger[_0x368213(0x82)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4d2298['on'](_0x5c64a8(0x251),(_0x5f260c,_0x1427da)=>{const _0x305ec6=_0x5c64a8;if(validateAccess(_0x1427da,_0x42bc06)[_0x305ec6(0x14b)])toggleBotMode(_0x5f260c);else logger['full'](_0x305ec6(0x216));}),_0x4d2298['on'](_0x5c64a8(0x27a),(_0xf3caa8,_0x13eab1)=>{const _0x2a7547=_0x5c64a8;if(validateAccess(_0x13eab1,_0x42bc06)[_0x2a7547(0x14b)])deleteBot(_0xf3caa8);else logger[_0x2a7547(0x82)](_0x2a7547(0x12b));}),_0x4d2298['on'](_0x5c64a8(0x21b),(_0x381867,_0x6729b6)=>{const _0x6865fb=_0x5c64a8;if(validateAccess(_0x6729b6,_0x42bc06)[_0x6865fb(0x14b)])storeSettings(_0x381867,!![]);else logger[_0x6865fb(0x82)](_0x6865fb(0x212));}),_0x4d2298['on'](_0x5c64a8(0x1b7),_0x85e69f=>{const _0x24b611=_0x5c64a8;if(validateAccess(_0x85e69f,_0x42bc06)[_0x24b611(0x14b)])updateBB(_0x24b611(0xb6));else logger[_0x24b611(0x82)](_0x24b611(0x200));}),_0x4d2298['on'](_0x5c64a8(0xbb),_0x252f34=>{const _0x419534=_0x5c64a8;if(validateAccess(_0x252f34,_0x42bc06)[_0x419534(0x14b)])updateBB(_0x419534(0x91));else logger[_0x419534(0x82)](_0x419534(0x269));}),_0x4d2298['on'](_0x5c64a8(0x20d),_0xa015f9=>{const _0x497b67=_0x5c64a8;if(validateAccess(_0xa015f9,_0x42bc06)[_0x497b67(0x14b)]){const _0x2839f5=getClient(_0x4d2298['id']);if(_0x2839f5)getBackupFiles(_0x2839f5['uuid']);else logger[_0x497b67(0x82)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x497b67(0x82)](_0x497b67(0x265));}),_0x4d2298['on'](_0x5c64a8(0x1a8),(_0x3301a2,_0xc9f86)=>{const _0x5dc2fa=_0x5c64a8;if(validateAccess(_0xc9f86,_0x42bc06)['allow'])restoreBackupFile(_0x3301a2);else logger[_0x5dc2fa(0x82)](_0x5dc2fa(0x19c));}),_0x4d2298['on'](_0x5c64a8(0x164),_0x34a4cd=>{const _0x175bd2=_0x5c64a8;if(validateAccess(_0x34a4cd,_0x42bc06)[_0x175bd2(0x14b)])getMessages();else logger[_0x175bd2(0x82)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x4d2298['on'](_0x5c64a8(0x168),(_0x58e058,_0x151a90)=>{const _0x26bd4f=_0x5c64a8;if(validateAccess(_0x151a90,_0x42bc06)[_0x26bd4f(0x14b)])confirmMessage(_0x58e058);else logger[_0x26bd4f(0x82)](_0x26bd4f(0x136));}),_0x4d2298['on'](_0x5c64a8(0x22b),_0x236a64=>{const _0xa5ef09=_0x5c64a8;if(validateAccess(_0x236a64,_0x42bc06)[_0xa5ef09(0x14b)]){if(devices[_0x42bc06][_0xa5ef09(0x1d3)])clearTimeout(devices[_0x42bc06]['pidRefreshToken']);if(devices[_0x42bc06][_0xa5ef09(0x15e)])clearTimeout(devices[_0x42bc06][_0xa5ef09(0x15e)]);removeSocketListeners(getClient(_0x4d2298['id'])[_0xa5ef09(0x1d8)]),addBlacklist(_0x42bc06),devices[_0x42bc06][_0xa5ef09(0x27d)]=null,devices[_0x42bc06][_0xa5ef09(0x176)]=null,devices[_0x42bc06][_0xa5ef09(0x248)][_0xa5ef09(0x161)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x42bc06['slice'](-0x8)),io['to'](getClient(_0x4d2298['id'])[_0xa5ef09(0x1d8)])['emit']('status',{'access':{'allow':![],'reason':_0xa5ef09(0x1ce),'token':null}});}else logger[_0xa5ef09(0x82)](_0xa5ef09(0xdf));});}function initializeSocketBot(_0x2c6be6){const _0x39fdc8=_0x373308,_0x5671aa=getClient(_0x2c6be6['id'])[_0x39fdc8(0x205)],_0x5885cf=getClient(_0x2c6be6['id'])['uuid'];_0x2c6be6['on']('get-logs',(_0x44d16c,_0x55a167)=>{const _0x1e2e58=_0x39fdc8;if(validateAccess(_0x55a167,_0x5885cf)[_0x1e2e58(0x14b)]){if(pid[_0x5671aa])pid[_0x5671aa][_0x1e2e58(0x26f)]({'function':'emitHistory','args':_0x44d16c});}else logger[_0x1e2e58(0x82)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x2c6be6['on'](_0x39fdc8(0x207),(_0x127959,_0x720be6)=>{const _0x394382=_0x39fdc8;if(validateAccess(_0x720be6,_0x5885cf)['allow']){if(pid[_0x5671aa])pid[_0x5671aa][_0x394382(0x26f)]({'function':_0x394382(0xdb),'args':_0x127959});}else logger[_0x394382(0x82)](_0x394382(0x1b5));}),_0x2c6be6['on'](_0x39fdc8(0x1a2),(_0x53773d,_0x52719f)=>{const _0x330920=_0x39fdc8;if(validateAccess(_0x52719f,_0x5885cf)[_0x330920(0x14b)]){if(pid[_0x5671aa])pid[_0x5671aa][_0x330920(0x26f)]({'function':_0x330920(0x25a),'args':_0x53773d});}else logger[_0x330920(0x82)](_0x330920(0x190));}),_0x2c6be6['on'](_0x39fdc8(0xc0),(_0x2a6b0a,_0x2a86da)=>{const _0x5171b9=_0x39fdc8;if(validateAccess(_0x2a86da,_0x5885cf)[_0x5171b9(0x14b)]){if(pid[_0x5671aa])pid[_0x5671aa][_0x5171b9(0x26f)]({'function':_0x5171b9(0x1da),'args':_0x2a6b0a});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x2c6be6['on'](_0x39fdc8(0xed),(_0xc5b20,_0x304b5b)=>{const _0x1f478e=_0x39fdc8;if(validateAccess(_0x304b5b,_0x5885cf)['allow']){if(pid[_0x5671aa])pid[_0x5671aa][_0x1f478e(0x26f)]({'function':'storeHeadless','args':_0xc5b20});}else logger[_0x1f478e(0x82)](_0x1f478e(0x149));}),_0x2c6be6['on']('store-fiat',(_0x21e09a,_0x58269e)=>{const _0x540e70=_0x39fdc8;if(validateAccess(_0x58269e,_0x5885cf)[_0x540e70(0x14b)]){if(pid[_0x5671aa])pid[_0x5671aa][_0x540e70(0x26f)]({'function':'storeFiat','args':_0x21e09a});}else logger[_0x540e70(0x82)](_0x540e70(0x1c1));}),_0x2c6be6['on'](_0x39fdc8(0xfa),_0x473000=>{const _0x46623d=_0x39fdc8;if(validateAccess(_0x473000,_0x5885cf)[_0x46623d(0x14b)]){if(pid[_0x5671aa])pid[_0x5671aa][_0x46623d(0x26f)]({'function':_0x46623d(0xee),'args':null});}else logger[_0x46623d(0x82)](_0x46623d(0x258));}),_0x2c6be6['on'](_0x39fdc8(0x1b3),_0x3dbd05=>{const _0x2d6e07=_0x39fdc8;if(validateAccess(_0x3dbd05,_0x5885cf)[_0x2d6e07(0x14b)]){if(pid[_0x5671aa])pid[_0x5671aa][_0x2d6e07(0x26f)]({'function':_0x2d6e07(0x10a),'args':null});}else logger[_0x2d6e07(0x82)](_0x2d6e07(0x158));}),_0x2c6be6['on'](_0x39fdc8(0x196),(_0xe4270e,_0x33b8fb)=>{const _0x44cb3b=_0x39fdc8;if(validateAccess(_0x33b8fb,_0x5885cf)[_0x44cb3b(0x14b)]){if(pid[_0x5671aa])pid[_0x5671aa][_0x44cb3b(0x26f)]({'function':_0x44cb3b(0x7b),'args':_0xe4270e});}else logger['full']('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x2c6be6['on'](_0x39fdc8(0x257),_0x4289cb=>{const _0x1b1b24=_0x39fdc8;if(validateAccess(_0x4289cb,_0x5885cf)[_0x1b1b24(0x14b)]){if(pid[_0x5671aa])pid[_0x5671aa][_0x1b1b24(0x26f)]({'function':_0x1b1b24(0xf5),'args':null});}else logger[_0x1b1b24(0x82)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x2c6be6['on'](_0x39fdc8(0x16d),_0x5b3c09=>{const _0x47a487=_0x39fdc8;if(validateAccess(_0x5b3c09,_0x5885cf)[_0x47a487(0x14b)]){if(pid[_0x5671aa])pid[_0x5671aa][_0x47a487(0x26f)]({'function':_0x47a487(0xd8),'args':null});}else logger[_0x47a487(0x82)](_0x47a487(0xae));}),_0x2c6be6['on'](_0x39fdc8(0x1b7),_0x4c59b0=>{const _0x4a5b51=_0x39fdc8;if(validateAccess(_0x4c59b0,_0x5885cf)['allow'])updateBB('update');else logger['full'](_0x4a5b51(0x200));}),_0x2c6be6['on'](_0x39fdc8(0x164),_0x104ae7=>{const _0x5f175c=_0x39fdc8;if(validateAccess(_0x104ae7,_0x5885cf)[_0x5f175c(0x14b)])getMessages();else logger[_0x5f175c(0x82)](_0x5f175c(0x18b));}),_0x2c6be6['on'](_0x39fdc8(0x168),(_0x256bd3,_0x4f410d)=>{const _0x142f2f=_0x39fdc8;if(validateAccess(_0x4f410d,_0x5885cf)[_0x142f2f(0x14b)])confirmMessage(_0x256bd3);else logger[_0x142f2f(0x82)](_0x142f2f(0x136));}),_0x2c6be6['on'](_0x39fdc8(0x22b),_0x14ef48=>{const _0x3c223b=_0x39fdc8;if(validateAccess(_0x14ef48,_0x5885cf)['allow']){if(devices[_0x5885cf]['pidRefreshToken'])clearTimeout(devices[_0x5885cf][_0x3c223b(0x1d3)]);if(devices[_0x5885cf]['pidExpireLogin'])clearTimeout(devices[_0x5885cf][_0x3c223b(0x15e)]);removeSocketListeners(getClient(_0x2c6be6['id'])[_0x3c223b(0x1d8)]),addBlacklist(_0x5885cf),devices[_0x5885cf][_0x3c223b(0x27d)]=null,devices[_0x5885cf][_0x3c223b(0x176)]=null,devices[_0x5885cf][_0x3c223b(0x248)][_0x3c223b(0x161)]=null,logger['debug'](_0x3c223b(0x1e5)+_0x5885cf[_0x3c223b(0x128)](-0x8)),io['to'](getClient(_0x2c6be6['id'])[_0x3c223b(0x1d8)])[_0x3c223b(0x129)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x3c223b(0x82)](_0x3c223b(0xdf));});}function removeSocketListeners(_0x5abab9){const _0x57af02=_0x373308;getClientsWithUuid(_0x5abab9)[_0x57af02(0x24a)](_0x40fc83=>{const _0x2de16b=_0x57af02;getSocket(_0x40fc83['id'])[_0x2de16b(0x106)]();});}function cleanSettings(){const _0x5895ea=_0x373308;let _0x2e27c7=settings;return settings[_0x5895ea(0xa9)]&&settings[_0x5895ea(0xa9)]!=''&&(_0x2e27c7={..._0x2e27c7,'telegramToken':'************'}),settings[_0x5895ea(0x11e)]&&settings[_0x5895ea(0x11e)]!=''&&(_0x2e27c7={..._0x2e27c7,'bbPassword':_0x5895ea(0x1e1)}),settings[_0x5895ea(0x1ef)]&&settings['marketcapApi']!=''&&(_0x2e27c7={..._0x2e27c7,'marketcapApi':_0x5895ea(0x1e1)}),(settings[_0x5895ea(0x11e)]&&settings[_0x5895ea(0x11e)]=='***'||settings['telegramToken']&&settings[_0x5895ea(0xa9)]=='***'||settings[_0x5895ea(0x1ef)]&&settings[_0x5895ea(0x1ef)]=='***')&&(_0x2e27c7={..._0x2e27c7,'restored':{'password':settings[_0x5895ea(0x11e)]==_0x5895ea(0xbe),'telegram':settings[_0x5895ea(0xa9)]==_0x5895ea(0xbe),'marketcap':settings['marketcapApi']=='***'}}),_0x2e27c7;}async function updateBB(_0x23553d){const _0x194606=_0x373308;await backupConfigFiles(),installingUpdate=!![],config[_0x194606(0x24a)](_0xc171a3=>{restartBot(_0xc171a3['botID']);});if(_0x23553d=='update')process[_0x194606(0x26f)]({'update':!![],'environment':environment},_0x47af63=>{});else _0x23553d==_0x194606(0x91)&&process[_0x194606(0x26f)]({'reinstall':!![],'environment':environment},_0x14509e=>{});}function startBot(_0x11327b,_0x48aea1,_0x4b3787){const _0x19b891=_0x373308;if(debugging)_0x11327b['push']('-d');let _0x4c5ebb=![];const _0x20114a=_0x11327b[0x0];_0x48aea1={..._0x48aea1,'stdio':[_0x19b891(0x202),'inherit',_0x19b891(0x202),_0x19b891(0xc9)]},pid[_0x20114a]=childProcess[_0x19b891(0x189)](botfile,_0x11327b,_0x48aea1),pid[_0x20114a]['on'](_0x19b891(0x246),_0x17de82=>{const _0x3b65a8=_0x19b891;switch(Object['keys'](_0x17de82)[0x0]){case'botname':updateBotName(_0x20114a,_0x17de82[_0x3b65a8(0x1d0)]);break;case _0x3b65a8(0x14c):updateBotManager();break;case'status':updateStatus(_0x20114a,_0x17de82[_0x3b65a8(0x122)]);break;case'live':updateLive(_0x20114a,_0x17de82[_0x3b65a8(0xa8)]);break;case _0x3b65a8(0x1ae):updateLive(_0x20114a,_0x17de82[_0x3b65a8(0x1ae)]),io['to'](_0x20114a)[_0x3b65a8(0x129)](_0x3b65a8(0x122),{'access':{'allow':![],'reason':_0x3b65a8(0x166),'token':null}});break;case _0x3b65a8(0x16e):_0x17de82['stop']=='restart'&&restartBot(_0x20114a);_0x17de82['stop']=='kill'&&toggleBot(_0x20114a,_0x3b65a8(0xff),_0x3b65a8(0x8c));break;case _0x3b65a8(0x237):sendTelegramBot(_0x20114a,_0x17de82[_0x3b65a8(0x237)]);break;case'telegrammsg':sendTelegramMsg(_0x17de82[_0x3b65a8(0xb2)]);break;case _0x3b65a8(0x1c4):io['to'](_0x20114a)[_0x3b65a8(0x129)](_0x17de82[_0x3b65a8(0x1c4)],_0x17de82[_0x3b65a8(0x219)]);break;}}),pid[_0x20114a]['on'](_0x19b891(0x244),function(_0x1d3139){if(_0x4c5ebb)return;_0x4c5ebb=!![],_0x4b3787(_0x1d3139);}),pid[_0x20114a]['on'](_0x19b891(0x174),async function(_0xa1ec15){const _0x513305=_0x19b891;if(terminating)return;if(installingUpdate){io[_0x513305(0x20e)]();return;}if(_0x4c5ebb)return;_0x4c5ebb=!![],_0x4b3787(null);const _0x3ba0b0=dbConfig[_0x513305(0x1ab)](_0x513305(0x89))['find']({'botID':_0x20114a})[_0x513305(0x220)]();_0x3ba0b0&&(_0x3ba0b0[_0x513305(0x122)]==_0x513305(0x19f)||_0x3ba0b0[_0x513305(0x122)]==_0x513305(0x1e9))&&(await sleep(0x3e8),updateLive(_0x20114a,_0x513305(0x8c)),logger[_0x513305(0x82)](_0x513305(0x191)+_0x20114a),startBot([_0x20114a,userID],{'cwd':bbpath},function(_0x551db0){const _0x48dc8b=_0x513305;if(_0x551db0)logger[_0x48dc8b(0x82)](_0x551db0);}));});}function stopBot(_0x75d4c7){const _0x52f9c0=_0x373308;getClientsWithBotID(_0x75d4c7)[_0x52f9c0(0x24a)](_0x352dd4=>{const _0x5a8e59=_0x52f9c0;getSocket(_0x352dd4['id'])[_0x5a8e59(0x17b)](!![]),removeClient(_0x352dd4['id']);}),pid[_0x75d4c7]&&(pid[_0x75d4c7][_0x52f9c0(0x18c)](),pid[_0x75d4c7]=null);}function stopAllBots(){const _0x5de6b0=_0x373308;terminating=!![];const _0x4491aa=getEnabledBots();_0x4491aa[_0x5de6b0(0x24a)](_0x1a947b=>{const _0x3732c8=_0x5de6b0;stopBot(_0x1a947b[_0x3732c8(0x142)]);});}function restartBot(_0x193da3){const _0x2dcb8d=_0x373308;if(pid[_0x193da3])pid[_0x193da3][_0x2dcb8d(0x18c)]();}function addBot(){const _0x49e58b=_0x373308;let _0x8fe704;for(let _0x5e029b=0x1;_0x5e029b<0x3e9;_0x5e029b++){_0x8fe704=_0x5e029b[_0x49e58b(0x226)]()[_0x49e58b(0xbc)](0x3,'0');let _0x4a020d=config[_0x49e58b(0xe0)](_0x1b8eb0=>_0x1b8eb0[_0x49e58b(0x142)]==_0x8fe704);if(!_0x4a020d)break;}if(_0x8fe704===_0x49e58b(0x111)){logger[_0x49e58b(0x82)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger['full']('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x8fe704),dbConfig[_0x49e58b(0x1ab)](_0x49e58b(0x89))['push']({'botID':_0x8fe704,'botname':_0x49e58b(0x14d)+_0x8fe704,'status':'new','live':''})[_0x49e58b(0x162)](),startBot([_0x8fe704,userID],{'cwd':bbpath},function(_0x2a85bc){if(_0x2a85bc)logger['full'](_0x2a85bc);}),config=getConfiguration(),io['to'](_0x49e58b(0x155))['emit'](_0x49e58b(0x89),config),broadcastToBots(_0x49e58b(0x89),JSON[_0x49e58b(0x229)](config));}function deleteBot(_0x2e1f0e){const _0x76d297=_0x373308;getClientsWithBotID(_0x2e1f0e)[_0x76d297(0x24a)](_0x3b7b41=>{const _0x5296ad=_0x76d297;getSocket(_0x3b7b41['id'])[_0x5296ad(0x17b)](!![]),removeClient(_0x3b7b41['id']);}),dbConfig[_0x76d297(0x1ab)](_0x76d297(0x89))['remove']({'botID':_0x2e1f0e})[_0x76d297(0x162)](),logger[_0x76d297(0x82)]('Deleted\x20Bot\x20'+_0x2e1f0e),stopBot(_0x2e1f0e);try{if(fs[_0x76d297(0x8b)](path['join'](configpath,_0x76d297(0x27b)+_0x2e1f0e+_0x76d297(0x17a))))fs[_0x76d297(0x23d)](path[_0x76d297(0xf2)](configpath,_0x76d297(0x27b)+_0x2e1f0e+_0x76d297(0x17a)));if(fs['existsSync'](path[_0x76d297(0xf2)](configpath,_0x76d297(0x27b)+_0x2e1f0e+'-events.json')))fs['unlinkSync'](path[_0x76d297(0xf2)](configpath,_0x76d297(0x27b)+_0x2e1f0e+'-events.json'));if(fs[_0x76d297(0x8b)](path[_0x76d297(0xf2)](configpath,'bot-'+_0x2e1f0e+_0x76d297(0x1a4))))fs[_0x76d297(0x23d)](path[_0x76d297(0xf2)](configpath,_0x76d297(0x27b)+_0x2e1f0e+_0x76d297(0x1a4)));if(fs[_0x76d297(0x8b)](path[_0x76d297(0xf2)](configpath,_0x76d297(0x27b)+_0x2e1f0e+_0x76d297(0x276))))fs[_0x76d297(0x23d)](path[_0x76d297(0xf2)](configpath,'bot-'+_0x2e1f0e+_0x76d297(0x276)));}catch(_0x1ea0e5){if(_0x1ea0e5)logger[_0x76d297(0x82)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x1ea0e5);}config=getConfiguration(),io['to'](_0x76d297(0x155))[_0x76d297(0x129)]('bots',config),broadcastToBots(_0x76d297(0x89),JSON['stringify'](config));}function toggleBot(_0x214ec9,_0x2c2673,_0x3e2d72){const _0x14e1eb=_0x373308;dbConfig['get'](_0x14e1eb(0x89))[_0x14e1eb(0xe0)]({'botID':_0x214ec9})[_0x14e1eb(0x81)]({'status':_0x2c2673})[_0x14e1eb(0x81)]({'live':_0x3e2d72})[_0x14e1eb(0x162)]();if(_0x2c2673==_0x14e1eb(0x19f)||_0x2c2673=='new')logger[_0x14e1eb(0x82)]('Enabled\x20Bot\x20'+_0x214ec9),startBot([_0x214ec9,userID],{'cwd':bbpath},function(_0x56ff09){const _0x1eadd7=_0x14e1eb;if(_0x56ff09)logger[_0x1eadd7(0x82)](_0x56ff09);});else(_0x2c2673==_0x14e1eb(0xff)||_0x2c2673==_0x14e1eb(0x230))&&(logger[_0x14e1eb(0x82)]('Disabled\x20Bot\x20'+_0x214ec9),stopBot(_0x214ec9));config=getConfiguration(),io['to'](_0x14e1eb(0x155))[_0x14e1eb(0x129)]('bots',config),broadcastToBots(_0x14e1eb(0x89),JSON['stringify'](config));}function toggleStatus(_0x214da7){const _0xd3a7f8=_0x373308;let _0x1f2a66=dbConfig[_0xd3a7f8(0x1ab)](_0xd3a7f8(0x89))[_0xd3a7f8(0xe0)]({'botID':_0x214da7})['value'](),_0x487882;if(_0x1f2a66[_0xd3a7f8(0x122)]==='enabled')_0x487882=_0xd3a7f8(0xff);else{if(_0x1f2a66[_0xd3a7f8(0x122)]===_0xd3a7f8(0x1e9))_0x487882=_0xd3a7f8(0x230);else{if(_0x1f2a66['status']===_0xd3a7f8(0x230))_0x487882=_0xd3a7f8(0x1e9);else{if(_0x1f2a66[_0xd3a7f8(0x122)]===_0xd3a7f8(0xff))_0x487882=_0xd3a7f8(0x19f);}}}return _0x487882;}function updateStatus(_0x385e6e,_0x554925){const _0xd77bdf=_0x373308;dbConfig[_0xd77bdf(0x1ab)](_0xd77bdf(0x89))[_0xd77bdf(0xe0)]({'botID':_0x385e6e})['assign']({'status':_0x554925})[_0xd77bdf(0x162)](),config=getConfiguration(),io['to'](_0xd77bdf(0x155))['emit'](_0xd77bdf(0x89),config),broadcastToBots('bots',JSON[_0xd77bdf(0x229)](config));}function updateLive(_0x5e6e19,_0x26e10c){const _0x4a287e=_0x373308;dbConfig[_0x4a287e(0x1ab)](_0x4a287e(0x89))[_0x4a287e(0xe0)]({'botID':_0x5e6e19})[_0x4a287e(0x81)]({'live':_0x26e10c})[_0x4a287e(0x162)](),config=getConfiguration(),io['to'](_0x4a287e(0x155))[_0x4a287e(0x129)](_0x4a287e(0x89),config),broadcastToBots(_0x4a287e(0x89),JSON['stringify'](config));}function updateBotName(_0x492a38,_0xa26228){const _0x41ee29=_0x373308;dbConfig[_0x41ee29(0x1ab)](_0x41ee29(0x89))[_0x41ee29(0xe0)]({'botID':_0x492a38})[_0x41ee29(0x81)]({'botname':_0xa26228})[_0x41ee29(0x162)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x41ee29(0x89),config),broadcastToBots(_0x41ee29(0x89),JSON['stringify'](config));}function updateBotManager(){const _0x3f1f86=_0x373308;config=getConfiguration(),io['to']('botmanager')['emit'](_0x3f1f86(0x89),config),broadcastToBots('bots',JSON[_0x3f1f86(0x229)](config));}function toggleBotMode(_0x576187){const _0x5d8831=_0x373308;if(pid[_0x576187])pid[_0x576187][_0x5d8831(0x26f)]({'function':_0x5d8831(0x148),'args':null});else{const _0x4f5336=configpath+'bot-'+_0x576187+_0x5d8831(0x17a),_0x2bd97d=fs[_0x5d8831(0x88)](_0x4f5336),_0x14a336=JSON['parse'](_0x2bd97d),_0x34ed20=_0x14a336[_0x5d8831(0x205)][0x0]['headless'];_0x14a336[_0x5d8831(0x205)][0x0][_0x5d8831(0x117)]=!_0x34ed20;const _0x5732ca=JSON[_0x5d8831(0x229)](_0x14a336,null,0x2);fs['writeFileSync'](_0x4f5336,_0x5732ca),config=getConfiguration(),io['to'](_0x5d8831(0x155))['emit'](_0x5d8831(0x89),config),broadcastToBots(_0x5d8831(0x89),JSON[_0x5d8831(0x229)](config));}}function validateTelegram(_0x54cf4a){const _0x21c558=_0x373308;if(_0x54cf4a[_0x21c558(0x250)][_0x21c558(0x180)]!=settings[_0x21c558(0x1dc)]&&'@'+_0x54cf4a[_0x21c558(0x250)][_0x21c558(0x180)]!=settings[_0x21c558(0x1dc)]||_0x54cf4a[_0x21c558(0x165)]['id']!=settings[_0x21c558(0x133)])return sendTelegram(_0x54cf4a[_0x21c558(0x165)]['id'],_0x21c558(0x1ad),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0xfce8c4=_0x373308;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0xfce8c4(0xa9)]);let _0x1b9174='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x1b9174+='\x0a',_0x1b9174+=_0xfce8c4(0xa6),_0x1b9174+='/disable\x20-\x20disable\x20notifications\x0a',_0x1b9174+=_0xfce8c4(0x1f2),_0x1b9174+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x1b9174+=_0xfce8c4(0x242),_0x1b9174+=_0xfce8c4(0x104),_0x1b9174+=_0xfce8c4(0x11c),_0x1b9174+=_0xfce8c4(0x224),_0x1b9174+=_0xfce8c4(0x28e),_0x1b9174+=_0xfce8c4(0x1c2),_0x1b9174+=_0xfce8c4(0x217),_0x1b9174+=_0xfce8c4(0x1e8),_0x1b9174+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0x1b9174+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x1b9174+=_0xfce8c4(0x253),_0x1b9174+=_0xfce8c4(0x27f);let _0x32c65b=_0xfce8c4(0x185);_0x32c65b+='\x0a',_0x32c65b+=_0x1b9174,tgBot['catch']((_0x3c2cb6,_0x50c214)=>{const _0x37e765=_0xfce8c4;logger['simple'](getTimeStamp()+_0x37e765(0x123)),logger['debug'](_0x37e765(0x140),_0x3c2cb6);}),tgBot[_0xfce8c4(0x1d5)](async(_0x5a5636,_0x5a4eee)=>{const _0x1a2ef8=_0xfce8c4;if(!(!settings[_0x1a2ef8(0x133)]&&_0x5a5636[_0x1a2ef8(0xb6)]['message'][_0x1a2ef8(0x19d)]=='/start')){if(!validateTelegram(_0x5a5636))return;}_0x5a4eee();}),tgBot[_0xfce8c4(0x22a)](_0xfce8c4(0x1de),async _0x38fe12=>{const _0x72d24e=_0xfce8c4;if(_0x38fe12[_0x72d24e(0x250)][_0x72d24e(0x180)]==settings[_0x72d24e(0x1dc)]||'@'+_0x38fe12[_0x72d24e(0x250)][_0x72d24e(0x180)]==settings['telegramUsername']){if(!settings['telegramChatId'])updateSetting(_0x72d24e(0x133),_0x38fe12['chat']['id']);}if(!validateTelegram(_0x38fe12))return;updateSetting(_0x72d24e(0x1f9),!![]),await sendTelegram(_0x38fe12[_0x72d24e(0x165)]['id'],_0x32c65b);}),tgBot[_0xfce8c4(0x22a)](_0xfce8c4(0x1a3),async _0x28c4db=>{const _0xeee1bf=_0xfce8c4;updateSetting(_0xeee1bf(0x1f9),!![]),await sendTelegram(_0x28c4db[_0xeee1bf(0x165)]['id'],_0xeee1bf(0x114));}),tgBot[_0xfce8c4(0x22a)]('disable',async _0x5d2b8c=>{const _0x139882=_0xfce8c4;await sendTelegram(_0x5d2b8c[_0x139882(0x165)]['id'],_0x139882(0x25c)),updateSetting(_0x139882(0x1f9),![]);}),tgBot[_0xfce8c4(0x22a)]('config',async _0x3ed3d1=>{const _0x14a429=_0xfce8c4,_0x4752be=Markup[_0x14a429(0x13e)]([Markup[_0x14a429(0x20f)][_0x14a429(0x23b)](_0x14a429(0x1c0),_0x14a429(0x12f)),Markup[_0x14a429(0x20f)]['callback'](_0x14a429(0x13f),_0x14a429(0x132)),Markup['button'][_0x14a429(0x23b)](_0x14a429(0xdd),_0x14a429(0x203))]);_0x3ed3d1[_0x14a429(0xa4)](_0x14a429(0x112),_0x4752be);}),tgBot[_0xfce8c4(0x273)](_0xfce8c4(0x12f),async _0x3e060f=>{const _0x5efd8c=_0xfce8c4;_0x3e060f[_0x5efd8c(0x284)](),updateSetting(_0x5efd8c(0x87),_0x5efd8c(0x171)),updateSetting(_0x5efd8c(0x1f9),!![]),await sendTelegram(_0x3e060f[_0x5efd8c(0x165)]['id'],_0x5efd8c(0x102));}),tgBot['action'](_0xfce8c4(0x132),async _0x214533=>{const _0x305d1f=_0xfce8c4;_0x214533[_0x305d1f(0x284)](),updateSetting('telegramEvents',_0x305d1f(0x18e)),updateSetting(_0x305d1f(0x1f9),!![]),await sendTelegram(_0x214533[_0x305d1f(0x165)]['id'],_0x305d1f(0x1df));}),tgBot[_0xfce8c4(0x273)](_0xfce8c4(0x203),async _0x39e6a4=>{const _0x1498b5=_0xfce8c4;_0x39e6a4[_0x1498b5(0x284)](),updateSetting('telegramEvents','all'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x39e6a4[_0x1498b5(0x165)]['id'],_0x1498b5(0x291));}),tgBot[_0xfce8c4(0x22a)](_0xfce8c4(0x122),async _0x454f1e=>{const _0x468b55=_0xfce8c4,_0x368f69=getBotsWithMode();let _0x579459=_0x468b55(0x193);config[_0x468b55(0x24a)](_0x5c17ca=>{const _0x1f94e0=_0x468b55,_0x170619=_0x368f69[_0x1f94e0(0xe0)](_0x2ad7d7=>_0x2ad7d7[_0x1f94e0(0x142)]==_0x5c17ca[_0x1f94e0(0x142)])['mode'];_0x579459+=_0x1f94e0(0x14d)+_0x5c17ca[_0x1f94e0(0x142)]+':\x20'+_0x5c17ca[_0x1f94e0(0x122)]+_0x1f94e0(0x8f)+_0x170619+_0x1f94e0(0x8f)+_0x5c17ca[_0x1f94e0(0xa8)]+'\x0a';}),_0x579459+='\x0a',_0x579459+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x579459+=!settings[_0x468b55(0x1f9)]?_0x468b55(0x170):'Notifications\x20enabled\x0a',_0x579459+=settings[_0x468b55(0x1f9)]?settings['telegramEvents']==_0x468b55(0x1d6)?_0x468b55(0x15f):'Notifications\x20types:\x20'+settings[_0x468b55(0x87)]+_0x468b55(0x118):'',await sendTelegram(_0x454f1e['chat']['id'],_0x579459,{'parse_mode':_0x468b55(0x286)});}),tgBot[_0xfce8c4(0x22a)](_0xfce8c4(0x127),async _0x237945=>{const _0x44c26a=_0xfce8c4,_0x4859e7=getEnabledBots();if(_0x4859e7[_0x44c26a(0x16b)]==0x0)await sendTelegram(_0x237945[_0x44c26a(0x165)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x4859e7[_0x44c26a(0x16b)]>0x1)_0x4859e7[_0x44c26a(0xaa)]({'botID':_0x44c26a(0x1d6)});let _0x5276a0=[],_0x310ca4=[];const _0x2868e5=_0x4859e7[_0x44c26a(0x16b)]%0x4==0x0||_0x4859e7['length']%0x4==0x3||_0x4859e7['length']%0x3==0x1?0x4:0x3;let _0x2386de=0x0;_0x4859e7[_0x44c26a(0x24a)]((_0x6e333d,_0x27090e)=>{const _0xf52efd=_0x44c26a;if(_0x27090e%_0x2868e5==0x0)_0x310ca4=[];_0x310ca4[_0xf52efd(0xaa)](Markup['button'][_0xf52efd(0x23b)](_0x6e333d[_0xf52efd(0x142)]==_0xf52efd(0x1d6)?_0xf52efd(0x14a):_0xf52efd(0x14d)+_0x6e333d[_0xf52efd(0x142)],_0xf52efd(0xd3)+_0x6e333d[_0xf52efd(0x142)])),_0x27090e%_0x2868e5==0x0&&(_0x5276a0[_0x2386de]=_0x310ca4,_0x2386de++);});const _0x285a24=Markup[_0x44c26a(0x13e)](_0x5276a0);_0x237945[_0x44c26a(0xa4)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x285a24);}}),tgBot[_0xfce8c4(0x273)](/restart_(.+)/,async _0x596ebd=>{const _0x967d62=_0xfce8c4,_0x2a2631=_0x596ebd['match'][0x1];_0x596ebd['editMessageReplyMarkup'](),_0x2a2631==_0x967d62(0x1d6)?config[_0x967d62(0x24a)](_0xb08a37=>{restartBot(_0xb08a37['botID']);}):restartBot(_0x2a2631);}),tgBot[_0xfce8c4(0x22a)]('on',async _0x1b89d5=>{const _0x82d295=_0xfce8c4,_0x113a83=getDisabledBots();if(_0x113a83[_0x82d295(0x16b)]==0x0)await sendTelegram(_0x1b89d5['chat']['id'],_0x82d295(0xec));else{if(_0x113a83['length']>0x1)_0x113a83[_0x82d295(0xaa)]({'botID':_0x82d295(0x1d6)});let _0x3fae70=[],_0x1d6227=[];const _0x257f37=_0x113a83['length']%0x4==0x0||_0x113a83[_0x82d295(0x16b)]%0x4==0x3||_0x113a83[_0x82d295(0x16b)]%0x3==0x1?0x4:0x3;let _0x265676=0x0;_0x113a83[_0x82d295(0x24a)]((_0x49f034,_0x41fb89)=>{const _0x408ddf=_0x82d295;if(_0x41fb89%_0x257f37==0x0)_0x1d6227=[];_0x1d6227['push'](Markup[_0x408ddf(0x20f)][_0x408ddf(0x23b)](_0x49f034[_0x408ddf(0x142)]==_0x408ddf(0x1d6)?_0x408ddf(0x14a):_0x408ddf(0x14d)+_0x49f034['botID'],_0x408ddf(0x156)+_0x49f034['botID'])),_0x41fb89%_0x257f37==0x0&&(_0x3fae70[_0x265676]=_0x1d6227,_0x265676++);});const _0x59918c=Markup[_0x82d295(0x13e)](_0x3fae70);_0x1b89d5['reply'](_0x82d295(0x221),_0x59918c);}}),tgBot[_0xfce8c4(0x273)](/on_(.+)/,async _0x5b2331=>{const _0x4311c4=_0xfce8c4,_0x4c14b6=_0x5b2331['match'][0x1];_0x5b2331[_0x4311c4(0x284)]();if(_0x4c14b6==_0x4311c4(0x1d6)){const _0x11909c=getDisabledBots();await sendTelegram(_0x5b2331[_0x4311c4(0x165)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x11909c[_0x4311c4(0x24a)](_0x58d0a4=>{const _0x46cf60=_0x4311c4;if(_0x58d0a4[_0x46cf60(0x142)]!='all')toggleBot(_0x58d0a4[_0x46cf60(0x142)],toggleStatus(_0x58d0a4['botID']),_0x46cf60(0x8c));});}else await sendTelegram(_0x5b2331[_0x4311c4(0x165)]['id'],_0x4311c4(0x278)+_0x4c14b6),toggleBot(_0x4c14b6,toggleStatus(_0x4c14b6),'stopped');}),tgBot['command'](_0xfce8c4(0x1e2),async _0x3cd04f=>{const _0x3e0cfc=_0xfce8c4,_0x5e19c2=getEnabledBots();if(_0x5e19c2[_0x3e0cfc(0x16b)]==0x0)await sendTelegram(_0x3cd04f[_0x3e0cfc(0x165)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x5e19c2[_0x3e0cfc(0x16b)]>0x1)_0x5e19c2[_0x3e0cfc(0xaa)]({'botID':_0x3e0cfc(0x1d6)});let _0x307895=[],_0x4e8676=[];const _0x46fbbe=_0x5e19c2[_0x3e0cfc(0x16b)]%0x4==0x0||_0x5e19c2[_0x3e0cfc(0x16b)]%0x4==0x3||_0x5e19c2['length']%0x3==0x1?0x4:0x3;let _0x2f3532=0x0;_0x5e19c2[_0x3e0cfc(0x24a)]((_0x3496b1,_0x3eea91)=>{const _0x3c8009=_0x3e0cfc;if(_0x3eea91%_0x46fbbe==0x0)_0x4e8676=[];_0x4e8676[_0x3c8009(0xaa)](Markup[_0x3c8009(0x20f)]['callback'](_0x3496b1['botID']=='all'?_0x3c8009(0x14a):_0x3c8009(0x14d)+_0x3496b1[_0x3c8009(0x142)],_0x3c8009(0x272)+_0x3496b1[_0x3c8009(0x142)])),_0x3eea91%_0x46fbbe==0x0&&(_0x307895[_0x2f3532]=_0x4e8676,_0x2f3532++);});const _0x31a0dc=Markup[_0x3e0cfc(0x13e)](_0x307895);_0x3cd04f[_0x3e0cfc(0xa4)](_0x3e0cfc(0x1a1),_0x31a0dc);}}),tgBot[_0xfce8c4(0x273)](/off_(.+)/,async _0x546988=>{const _0x413dfe=_0xfce8c4,_0x33e9d6=_0x546988['match'][0x1];_0x546988['editMessageReplyMarkup']();if(_0x33e9d6==_0x413dfe(0x1d6)){const _0x232fe8=getEnabledBots();await sendTelegram(_0x546988[_0x413dfe(0x165)]['id'],_0x413dfe(0x125)),_0x232fe8[_0x413dfe(0x24a)](_0x3edb95=>{const _0xeebf2c=_0x413dfe;if(_0x3edb95[_0xeebf2c(0x142)]!='all')toggleBot(_0x3edb95['botID'],toggleStatus(_0x3edb95['botID']),_0xeebf2c(0x8c));});}else await sendTelegram(_0x546988[_0x413dfe(0x165)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x33e9d6),toggleBot(_0x33e9d6,toggleStatus(_0x33e9d6),_0x413dfe(0x8c));}),tgBot[_0xfce8c4(0x22a)](_0xfce8c4(0x146),async _0x28a46b=>{const _0x3114ef=_0xfce8c4,_0x125ed4=getEnabledBots();if(_0x125ed4[_0x3114ef(0x16b)]==0x0)await sendTelegram(_0x28a46b[_0x3114ef(0x165)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x125ed4['length']>0x1){let _0x2d4521=[],_0x3c36f1=[];const _0x41d11b=_0x125ed4[_0x3114ef(0x16b)]%0x4==0x0||_0x125ed4[_0x3114ef(0x16b)]%0x4==0x3||_0x125ed4[_0x3114ef(0x16b)]%0x3==0x1?0x4:0x3;let _0x1c9c11=0x0;_0x125ed4[_0x3114ef(0x24a)]((_0x3cc503,_0xdf7910)=>{const _0x19e016=_0x3114ef;if(_0xdf7910%_0x41d11b==0x0)_0x3c36f1=[];_0x3c36f1[_0x19e016(0xaa)](Markup['button'][_0x19e016(0x23b)]('Bot\x20'+_0x3cc503[_0x19e016(0x142)],_0x19e016(0xc2)+_0x3cc503[_0x19e016(0x142)])),_0xdf7910%_0x41d11b==0x0&&(_0x2d4521[_0x1c9c11]=_0x3c36f1,_0x1c9c11++);});const _0x39b854=Markup[_0x3114ef(0x13e)](_0x2d4521);_0x28a46b['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x39b854);}else{const _0x23b2af=_0x125ed4[0x0][_0x3114ef(0x142)];if(pid[_0x23b2af])pid[_0x23b2af][_0x3114ef(0x26f)]({'function':_0x3114ef(0xfd),'args':null});}}}),tgBot[_0xfce8c4(0x273)](/metrics_(.+)/,async _0x139f90=>{const _0x1223b0=_0xfce8c4,_0x418b13=_0x139f90[_0x1223b0(0x1fc)][0x1];_0x139f90[_0x1223b0(0x284)]();if(pid[_0x418b13])pid[_0x418b13]['send']({'function':_0x1223b0(0xfd),'args':null});}),tgBot['command'](_0xfce8c4(0x113),async _0x3ba08d=>{const _0x636cfb=_0xfce8c4,_0x24abf6=getEnabledBots();if(_0x24abf6[_0x636cfb(0x16b)]==0x0)await sendTelegram(_0x3ba08d['chat']['id'],_0x636cfb(0x1d4));else{if(_0x24abf6['length']>0x1){let _0x1f3b00=[],_0x19b823=[];const _0x557912=_0x24abf6['length']%0x4==0x0||_0x24abf6[_0x636cfb(0x16b)]%0x4==0x3||_0x24abf6[_0x636cfb(0x16b)]%0x3==0x1?0x4:0x3;let _0x450eaa=0x0;_0x24abf6[_0x636cfb(0x24a)]((_0x201b05,_0x1464ad)=>{const _0x9c476c=_0x636cfb;if(_0x1464ad%_0x557912==0x0)_0x19b823=[];_0x19b823[_0x9c476c(0xaa)](Markup[_0x9c476c(0x20f)][_0x9c476c(0x23b)](_0x9c476c(0x14d)+_0x201b05[_0x9c476c(0x142)],_0x9c476c(0x282)+_0x201b05[_0x9c476c(0x142)])),_0x1464ad%_0x557912==0x0&&(_0x1f3b00[_0x450eaa]=_0x19b823,_0x450eaa++);});const _0x4457f7=Markup[_0x636cfb(0x13e)](_0x1f3b00);_0x3ba08d[_0x636cfb(0xa4)](_0x636cfb(0xc6),_0x4457f7);}else{const _0x14f0dd=_0x24abf6[0x0][_0x636cfb(0x142)];if(pid[_0x14f0dd])pid[_0x14f0dd][_0x636cfb(0x26f)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0xfce8c4(0x273)](/portfolio_(.+)/,async _0x50ea95=>{const _0x427c8f=_0xfce8c4,_0x30e7d9=_0x50ea95[_0x427c8f(0x1fc)][0x1];_0x50ea95[_0x427c8f(0x284)]();if(pid[_0x30e7d9])pid[_0x30e7d9][_0x427c8f(0x26f)]({'function':_0x427c8f(0x259),'args':null});}),tgBot[_0xfce8c4(0x22a)]('logs',async _0x45317f=>{const _0x13883f=_0xfce8c4,_0x34b6b0=_0x13883f(0x262);await zipFiles(_0x34b6b0);const _0x196378=zippath+(_0x34b6b0+'.zip');_0x45317f[_0x13883f(0x17f)]({'source':_0x196378})['then'](()=>{})['catch'](_0x474c82=>logger[_0x13883f(0x8e)](_0x13883f(0x1c7)+_0x34b6b0+_0x13883f(0x247),_0x474c82));}),tgBot[_0xfce8c4(0x22a)](_0xfce8c4(0x1d7),async _0x36f26d=>{const _0x870c57=_0xfce8c4,_0x496a69=_0x870c57(0x1d7);await backupConfigFiles(),await zipFiles(_0x496a69);const _0xaf3cca=zippath+(_0x496a69+_0x870c57(0x18a));_0x36f26d[_0x870c57(0x17f)]({'source':_0xaf3cca})[_0x870c57(0x138)](()=>{})[_0x870c57(0x8a)](_0x58b400=>logger[_0x870c57(0x8e)](_0x870c57(0x1c7)+_0x496a69+'\x20files\x20over\x20Telegram:',_0x58b400));}),tgBot['command'](_0xfce8c4(0xb6),async _0xb545b7=>{const _0x146768=_0xfce8c4;await getMessages();if(!updateAvailable)await sendTelegram(_0xb545b7['chat']['id'],_0x146768(0x15a));else{if(!validInstallation)await sendTelegram(_0xb545b7[_0x146768(0x165)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x4c1dc3=Markup[_0x146768(0x13e)]([Markup[_0x146768(0x20f)][_0x146768(0x23b)](_0x146768(0xaf),_0x146768(0x20c)),Markup[_0x146768(0x20f)][_0x146768(0x23b)]('No',_0x146768(0x271))]);_0xb545b7[_0x146768(0xa4)](_0x146768(0x134),_0x4c1dc3);}}}),tgBot['action'](/update_(.+)/,async _0x1ab2a0=>{const _0x3c6b2f=_0xfce8c4,_0x6fc2df=_0x1ab2a0[_0x3c6b2f(0x1fc)][0x1];_0x1ab2a0[_0x3c6b2f(0x284)](),_0x6fc2df==_0x3c6b2f(0x288)&&(await sendTelegram(_0x1ab2a0[_0x3c6b2f(0x165)]['id'],_0x3c6b2f(0x151)),updateBB('update')),_0x6fc2df=='no'&&await sendTelegram(_0x1ab2a0[_0x3c6b2f(0x165)]['id'],_0x3c6b2f(0x28a));}),tgBot[_0xfce8c4(0x22a)](_0xfce8c4(0x91),async _0x2e84c6=>{const _0x190221=_0xfce8c4;if(!validInstallation)await sendTelegram(_0x2e84c6[_0x190221(0x165)]['id'],_0x190221(0xd2));else{const _0x44f6fa=Markup['inlineKeyboard']([Markup[_0x190221(0x20f)][_0x190221(0x23b)](_0x190221(0xaf),_0x190221(0x181)),Markup[_0x190221(0x20f)][_0x190221(0x23b)]('No',_0x190221(0x188))]);_0x2e84c6[_0x190221(0xa4)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x44f6fa);}}),tgBot[_0xfce8c4(0x273)](/reinstall_(.+)/,async _0x526f68=>{const _0x3ddfe0=_0xfce8c4,_0x4f0eb2=_0x526f68['match'][0x1];_0x526f68[_0x3ddfe0(0x284)](),_0x4f0eb2==_0x3ddfe0(0x288)&&(await sendTelegram(_0x526f68[_0x3ddfe0(0x165)]['id'],_0x3ddfe0(0x285)),updateBB('reinstall')),_0x4f0eb2=='no'&&await sendTelegram(_0x526f68[_0x3ddfe0(0x165)]['id'],_0x3ddfe0(0xb4));}),tgBot['command'](_0xfce8c4(0x194),async _0x2564c9=>{const _0x41b953=_0xfce8c4,_0x4bf8a5=getBotsWithMode();if(_0x4bf8a5[_0x41b953(0x16b)]==0x0)await sendTelegram(_0x2564c9[_0x41b953(0x165)]['id'],_0x41b953(0x1d4));else{let _0x483814=[],_0x514933=[];const _0x1f5e84=0x2;let _0x276c30=0x0;_0x4bf8a5[_0x41b953(0x24a)]((_0x5a1b47,_0x4224aa)=>{const _0x7ce8a1=_0x41b953;if(_0x4224aa%_0x1f5e84==0x0)_0x514933=[];_0x514933[_0x7ce8a1(0xaa)](Markup[_0x7ce8a1(0x20f)][_0x7ce8a1(0x23b)](_0x7ce8a1(0x14d)+_0x5a1b47[_0x7ce8a1(0x142)]+'\x20('+_0x5a1b47[_0x7ce8a1(0x24b)]+')',_0x7ce8a1(0x15b)+_0x5a1b47['botID'])),_0x4224aa%_0x1f5e84==0x0&&(_0x483814[_0x276c30]=_0x514933,_0x276c30++);});const _0x56c018=Markup[_0x41b953(0x13e)](_0x483814);_0x2564c9[_0x41b953(0xa4)](_0x41b953(0x1f4),_0x56c018);}}),tgBot[_0xfce8c4(0x273)](/toggle_(.+)/,async _0x439166=>{const _0x49b9c4=_0xfce8c4,_0x36f80e=_0x439166[_0x49b9c4(0x1fc)][0x1];_0x439166[_0x49b9c4(0x284)]();const _0x53346a=getBotsWithMode(),_0x5e8f7b=_0x53346a[_0x49b9c4(0xe0)](_0x326c29=>_0x326c29['botID']==_0x36f80e),_0x5490d5=_0x5e8f7b[_0x49b9c4(0x24b)]==_0x49b9c4(0x1ed)?_0x49b9c4(0x9f):_0x49b9c4(0x1ed);await sendTelegram(_0x439166['chat']['id'],_0x49b9c4(0xbf)+_0x36f80e+_0x49b9c4(0xe4)+_0x5490d5+_0x49b9c4(0xd9)),toggleBotMode(_0x36f80e);}),tgBot[_0xfce8c4(0x22a)](_0xfce8c4(0x23a),async _0x4f2ece=>{const _0x7be3a1=_0xfce8c4;let _0x13e58a='';config['forEach'](_0x5e2654=>{const _0x529926=_0xbb71;_0x13e58a+='Bot\x20'+_0x5e2654[_0x529926(0x142)]+':\x20'+_0x5e2654[_0x529926(0x1d0)]+'\x0a';}),await sendTelegram(_0x4f2ece[_0x7be3a1(0x165)]['id'],_0x13e58a,{'parse_mode':_0x7be3a1(0x286)});}),tgBot['command'](_0xfce8c4(0x1d2),async _0x524911=>{const _0x2d824d=_0xfce8c4;await sendTelegram(_0x524911[_0x2d824d(0x165)]['id'],_0x1b9174);}),process[_0xfce8c4(0x13a)](_0xfce8c4(0xa5),()=>tgBot['stop'](_0xfce8c4(0xa5))),process[_0xfce8c4(0x13a)](_0xfce8c4(0xe8),()=>tgBot[_0xfce8c4(0x16e)](_0xfce8c4(0xe8))),tgBot[_0xfce8c4(0x105)]();}function disableTelegram(){const _0x53efd8=_0x373308;tgBot&&tgBot[_0x53efd8(0x16e)]();}async function sendTelegram(_0xbcc93,_0x47eb52,_0x1d9ee0){const _0x5d7cc0=_0x373308;_0x1d9ee0={..._0x1d9ee0,'disable_web_page_preview':!![]};try{await tgBot[_0x5d7cc0(0x237)][_0x5d7cc0(0x231)](_0xbcc93,_0x47eb52,_0x1d9ee0);}catch(_0x2cdbf4){logger[_0x5d7cc0(0x8e)](_0x5d7cc0(0x26c),_0x2cdbf4);}}async function sendTelegramBot(_0x5c560f,_0xfa1e31){const _0x1c4e06=_0x373308;if(settings['telegramEnabled']){if(settings[_0x1c4e06(0x87)]==_0x1c4e06(0x1d6)||(_0xfa1e31[_0x1c4e06(0x139)]==_0x1c4e06(0x244)||_0xfa1e31[_0x1c4e06(0x139)]==_0x1c4e06(0x287)||_0xfa1e31[_0x1c4e06(0x139)]==_0x1c4e06(0x12c))&&settings[_0x1c4e06(0x87)]==_0x1c4e06(0x18e)||_0xfa1e31[_0x1c4e06(0x139)]==_0x1c4e06(0x11a)&&settings[_0x1c4e06(0x87)]==_0x1c4e06(0x171)){if(tgBot&&settings[_0x1c4e06(0x133)]){if(_0xfa1e31[_0x1c4e06(0xcc)])await sendTelegram(settings['telegramChatId'],_0xfa1e31[_0x1c4e06(0x1d0)]+_0x1c4e06(0x208)+_0xfa1e31[_0x1c4e06(0x1fb)]);else await sendTelegram(settings['telegramChatId'],_0x1c4e06(0x14d)+_0x5c560f+_0x1c4e06(0x208)+_0xfa1e31[_0x1c4e06(0x1fb)]);}}}}async function sendTelegramMsg(_0x31c91c,_0xdf0e71='HTML'){const _0x2c5ad5=_0x373308;return settings[_0x2c5ad5(0x1f9)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x2c5ad5(0x133)],_0x31c91c,{'parse_mode':_0xdf0e71}),!![]):![];}function getDeviceWithIp(_0x5a99db){return devices['find'](_0x101566=>_0x101566['ip']===_0x5a99db);}async function temporaryAccess2FA(_0x532e65,_0x208784){const _0x5c46f1=_0x373308;let _0x13423c=new Date(),_0x47912a=![];if(lastIpApproval){if(_0x13423c-lastIpApproval<0x1388)_0x47912a=!![];}lastIpApproval=new Date();if(_0x47912a)return;if(tgBot&&settings['telegramChatId']){const _0x110eec=uuidRandom();tmpStorage[_0x110eec]={'uuid':_0x532e65,'externalip':_0x208784};const _0x2bb0c1=Markup[_0x5c46f1(0x13e)]([Markup[_0x5c46f1(0x20f)]['callback'](_0x5c46f1(0x239),_0x5c46f1(0x243)+_0x110eec),Markup['button'][_0x5c46f1(0x23b)](_0x5c46f1(0xe1),'tempaccess_15_'+_0x110eec),Markup[_0x5c46f1(0x20f)][_0x5c46f1(0x23b)](_0x5c46f1(0x1b4),'tempaccess_30_'+_0x110eec),Markup['button'][_0x5c46f1(0x23b)](_0x5c46f1(0x245),_0x5c46f1(0x10b)+_0x110eec)]);await sendTelegram(settings[_0x5c46f1(0x133)],_0x5c46f1(0x83)+normalizeIP(_0x208784)[_0x5c46f1(0x192)]+'\x20?',_0x2bb0c1),tgBot[_0x5c46f1(0x273)](/tempaccess_(.+)_(.+)/,async _0x4e13d7=>{const _0x2ddb08=_0x5c46f1,_0x3cefdc=_0x4e13d7['match'][0x1],_0x50baaa=_0x4e13d7['match'][0x2],{uuid:_0x12219b,externalip:_0x563771}=tmpStorage[_0x50baaa];delete tmpStorage[_0x50baaa],_0x4e13d7[_0x2ddb08(0x284)](),devices[_0x12219b][_0x2ddb08(0x27d)]={'clientip':_0x563771,'timestamp':new Date()['getTime'](),'expiry':_0x3cefdc},_0x3cefdc!=_0x2ddb08(0x245)?(await sendTelegram(_0x4e13d7[_0x2ddb08(0x165)]['id'],_0x2ddb08(0xe5)+_0x3cefdc+_0x2ddb08(0xb0),{'parse_mode':_0x2ddb08(0x286)}),io['to'](_0x12219b)[_0x2ddb08(0x129)](_0x2ddb08(0x122),{'access':{'allow':![],'reason':_0x2ddb08(0x166),'token':null}})):(await sendTelegram(_0x4e13d7[_0x2ddb08(0x165)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x12219b)[_0x2ddb08(0x129)](_0x2ddb08(0x122),{'access':{'allow':![],'reason':_0x2ddb08(0x110),'token':null}}));});}}async function loginAccess2FA(_0x12bb6b,_0x6805a3){const _0x2c83e7=_0x373308;if(tgBot&&settings['telegramChatId']){const _0x544fc7=uuidRandom();tmpStorage[_0x544fc7]={'uuid':_0x12bb6b,'externalip':_0x6805a3};const _0x32b5b3=Markup[_0x2c83e7(0x13e)]([Markup['button'][_0x2c83e7(0x23b)](_0x2c83e7(0x270),_0x2c83e7(0x281)+loginExpiry+'_'+_0x544fc7),Markup[_0x2c83e7(0x20f)][_0x2c83e7(0x23b)](_0x2c83e7(0x245),_0x2c83e7(0xc1)+_0x544fc7)]);await sendTelegram(settings[_0x2c83e7(0x133)],_0x2c83e7(0x21e)+normalizeIP(_0x6805a3)[_0x2c83e7(0x192)]+'\x20?',_0x32b5b3),tgBot[_0x2c83e7(0x273)](/login2fa_(.+)_(.+)/,async _0x3c0b11=>{const _0x4818cc=_0x2c83e7,_0x4cc8f5=_0x3c0b11['match'][0x1],_0x2dcb91=_0x3c0b11[_0x4818cc(0x1fc)][0x2],{uuid:_0x8288bd,externalip:_0x1cf0bc}=tmpStorage[_0x2dcb91];delete tmpStorage[_0x2dcb91],_0x3c0b11[_0x4818cc(0x284)](),devices[_0x8288bd][_0x4818cc(0x176)]={'clientip':_0x1cf0bc,'timestamp':new Date()[_0x4818cc(0x24c)](),'expiry':_0x4cc8f5},_0x4cc8f5!=_0x4818cc(0x245)?(await sendTelegram(_0x3c0b11[_0x4818cc(0x165)]['id'],_0x4818cc(0x24f),{'parse_mode':'HTML'}),io['to'](_0x8288bd)[_0x4818cc(0x129)](_0x4818cc(0x122),{'access':{'allow':![],'reason':_0x4818cc(0x166),'token':null}})):(await sendTelegram(_0x3c0b11['chat']['id'],_0x4818cc(0x1b8)),io['to'](_0x8288bd)[_0x4818cc(0x129)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4f7019=_0x373308;return dbConfig['get'](_0x4f7019(0x89))[_0x4f7019(0x254)](_0x4f7019(0x142))['filter']({'status':_0x4f7019(0x19f)})['value']()||[];}function getDisabledBots(){const _0x143535=_0x373308;return dbConfig[_0x143535(0x1ab)](_0x143535(0x89))[_0x143535(0x254)](_0x143535(0x142))[_0x143535(0x1f0)]({'status':_0x143535(0xff)})[_0x143535(0x220)]()||[];}function getBotAttributes(_0x1db3b0){const _0x44d3bd=_0x373308;let _0x937ef3={};const _0x580969=configpath+_0x44d3bd(0x27b)+_0x1db3b0+_0x44d3bd(0x17a),_0x99bf99=fs['existsSync'](_0x580969);if(_0x99bf99){const _0x119d38=fs[_0x44d3bd(0x88)](_0x580969);try{const _0x1259d0=JSON[_0x44d3bd(0x108)](_0x119d38),_0x4ab821=_0x1259d0?_0x1259d0[_0x44d3bd(0x205)][0x0][_0x44d3bd(0x117)]:![];_0x937ef3[_0x44d3bd(0x24b)]=_0x4ab821?_0x44d3bd(0x1ed):'manual',_0x937ef3[_0x44d3bd(0x1d0)]=_0x1259d0?_0x1259d0[_0x44d3bd(0x205)][0x0][_0x44d3bd(0x1d0)]:_0x44d3bd(0x14d)+_0x1db3b0;}catch(_0x93f2ad){_0x937ef3[_0x44d3bd(0x24b)]=_0x44d3bd(0x9f),_0x937ef3[_0x44d3bd(0x1d0)]='Bot\x20'+_0x1db3b0;}}else _0x937ef3[_0x44d3bd(0x24b)]=_0x44d3bd(0x9f),_0x937ef3[_0x44d3bd(0x1d0)]=_0x44d3bd(0x14d)+_0x1db3b0;return _0x937ef3;}function getBotsWithMode(){const _0x3e01f8=_0x373308,_0x418624=dbConfig[_0x3e01f8(0x1ab)]('bots')[_0x3e01f8(0x254)](_0x3e01f8(0x142))['value']()||[];return _0x418624['forEach'](_0x272f72=>{const _0x152cc2=_0x3e01f8;let _0x48ff6b=getBotAttributes(_0x272f72[_0x152cc2(0x142)]);_0x272f72[_0x152cc2(0x24b)]=_0x48ff6b[_0x152cc2(0x24b)];}),_0x418624;}function getBotExchanges(){const _0x2a0a89=_0x373308;let _0x1c40ad=[];const _0x334f22=dbConfig[_0x2a0a89(0x1ab)](_0x2a0a89(0x89))['sortBy']('botID')[_0x2a0a89(0x220)]()||[];_0x334f22[_0x2a0a89(0x24a)](_0x1ce1b4=>{const _0x4d7c8c=_0x2a0a89;if(_0x1ce1b4[_0x4d7c8c(0x122)]==_0x4d7c8c(0x19f)){const _0x153b7a=configpath+_0x4d7c8c(0x27b)+_0x1ce1b4[_0x4d7c8c(0x142)]+_0x4d7c8c(0x17a),_0x3311f0=fs[_0x4d7c8c(0x8b)](_0x153b7a);let _0x42cdd9;if(_0x3311f0){const _0x456865=fs[_0x4d7c8c(0x88)](_0x153b7a);try{const _0x41bfc1=JSON['parse'](_0x456865);_0x42cdd9=_0x41bfc1?_0x41bfc1['bot'][0x0]['exchange']:null;}catch(_0x541a87){}}if(_0x42cdd9)_0x1c40ad[_0x4d7c8c(0xaa)](_0x42cdd9);}});const _0x128027=[...new Set(_0x1c40ad)]['sort']();return _0x128027;}async function initUser(){const _0x1cf600=_0x373308;if(!settings[_0x1cf600(0x236)]){const _0x5ac89e=uuidRandom();mixpanel[_0x1cf600(0xde)](_0x5ac89e),updateSetting('userid',_0x5ac89e);}}async function initSecure(){const _0x459f5e=_0x373308;let _0x35e9ea=getSecure();if(!_0x35e9ea[_0x459f5e(0x213)](_0x459f5e(0x195))){let _0x3bf122=await generateKeys();_0x35e9ea['publicKey']=_0x3bf122[_0x459f5e(0x130)],_0x35e9ea[_0x459f5e(0xeb)]=_0x3bf122[_0x459f5e(0xeb)],_0x35e9ea['secret']=crypto['randomBytes'](0x20)[_0x459f5e(0x226)](_0x459f5e(0x84));;storeSecure(_0x35e9ea);}}function getSettings(){const _0x1fc679=_0x373308;return dbSettings[_0x1fc679(0x1ab)](_0x1fc679(0x93))[_0x1fc679(0x220)]()||{};}function getSecure(){const _0x3b9bef=_0x373308;return dbSecure[_0x3b9bef(0x1ab)](_0x3b9bef(0x1cf))['value']()||{};}function getBlacklist(){const _0x548a6e=_0x373308;return dbSecure[_0x548a6e(0x1ab)]('blacklist')['value']()||[];}function broadcastToBots(_0x51fe0e,_0x5c1b79){const _0x50b65b=_0x373308;config[_0x50b65b(0x24a)](_0x3ca819=>{const _0x41f8b1=_0x50b65b;if(_0x3ca819['status']==_0x41f8b1(0x19f)&&_0x3ca819[_0x41f8b1(0xa8)]==_0x41f8b1(0x131)||_0x3ca819[_0x41f8b1(0x122)]=='new'&&_0x3ca819[_0x41f8b1(0xa8)]=='running'){if(pid[_0x3ca819['botID']])pid[_0x3ca819[_0x41f8b1(0x142)]][_0x41f8b1(0x26f)]({[_0x51fe0e]:_0x5c1b79});}});}async function storeSettings(_0x3c05d8,_0x579693=![]){const _0x532894=_0x373308;_0x3c05d8={...settings,..._0x3c05d8};if(_0x579693&&_0x3c05d8['bbPassword']!=_0x532894(0x1e1)&&_0x3c05d8['bbPassword']!=_0x532894(0xbe)&&_0x3c05d8['bbPassword']!=''){const _0x4e0da5=decryptRSA(secure['privateKey'],_0x3c05d8['bbPassword'])[_0x532894(0x255)](_0x532894(0x183))[0x0],_0x5b9593=bcrypt[_0x532894(0xc3)](_0x4e0da5,saltRounds);_0x3c05d8={..._0x3c05d8,'bbPassword':_0x5b9593};}if(_0x579693&&_0x3c05d8['telegramToken']!=_0x532894(0x1e1)&&_0x3c05d8[_0x532894(0xa9)]!='***'&&_0x3c05d8[_0x532894(0xa9)]!=''){const _0x3222da=decryptRSA(secure[_0x532894(0xeb)],_0x3c05d8[_0x532894(0xa9)])[_0x532894(0x255)](_0x532894(0x183))[0x0];_0x3c05d8={..._0x3c05d8,'telegramToken':_0x3222da};}if(_0x579693&&_0x3c05d8[_0x532894(0x1ef)]!=_0x532894(0x1e1)&&_0x3c05d8[_0x532894(0x1ef)]!=_0x532894(0xbe)&&_0x3c05d8['marketcapApi']!=''){const _0x3164ef=decryptRSA(secure[_0x532894(0xeb)],_0x3c05d8[_0x532894(0x1ef)])[_0x532894(0x255)]('|@|')[0x0];_0x3c05d8={..._0x3c05d8,'marketcapApi':_0x3164ef};}const _0x1cda62=_0x3c05d8[_0x532894(0xa9)]!=_0x532894(0x1e1)&&_0x3c05d8['telegramToken']!=settings['telegramToken']||_0x3c05d8[_0x532894(0x1dc)]!=settings['telegramUsername'],_0xbe1617=_0x3c05d8[_0x532894(0xa9)]==''||_0x3c05d8['telegramUsername']=='',_0x7aee47=_0x3c05d8[_0x532894(0x1ef)]&&_0x3c05d8[_0x532894(0x1ef)]!=_0x532894(0x1e1)&&_0x3c05d8['marketcapApi']!=settings['telegramToken'];_0x1cda62&&(_0x3c05d8[_0x532894(0x133)]=null,_0x3c05d8[_0x532894(0x87)]='all');for(const [_0x1c9874,_0x19f039]of Object[_0x532894(0x14f)](_0x3c05d8)){if(_0x1c9874==_0x532894(0xa9)&&_0x19f039==_0x532894(0x1e1)){_0x3c05d8[_0x532894(0xa9)]=settings['telegramToken'];continue;};if(_0x1c9874==_0x532894(0x11e)&&_0x19f039==_0x532894(0x1e1)){_0x3c05d8[_0x532894(0x11e)]=settings[_0x532894(0x11e)];continue;};if(_0x1c9874=='marketcapApi'&&_0x19f039==_0x532894(0x1e1)){_0x3c05d8[_0x532894(0x1ef)]=settings[_0x532894(0x1ef)];continue;};dbSettings[_0x532894(0x197)]('settings.'+_0x1c9874,_0x19f039)[_0x532894(0x162)]();}settings=_0x3c05d8,io['to'](_0x532894(0x155))[_0x532894(0x129)](_0x532894(0x93),cleanSettings()),broadcastToBots('timeshift',settings[_0x532894(0x13c)]),broadcastToBots('onepagemode',settings[_0x532894(0xc8)]),broadcastToBots(_0x532894(0x1ef),settings[_0x532894(0x1ef)]);if(_0x1cda62&&!_0xbe1617)initTelegram();if(_0x1cda62&&_0xbe1617)disableTelegram();getAllClients()['forEach'](_0x5e837c=>{const _0x15e95e=_0x532894;getSocket(_0x5e837c['id'])['emit'](_0x15e95e(0x122),{'access':{'allow':![],'reason':_0x15e95e(0x166),'token':null}});}),_0x7aee47&&(await sleep(0xbb8),testMarketcapApi(_0x3c05d8['marketcapApi']));}async function testMarketcapApi(_0x40cc43){const _0x5dd65c=_0x373308,_0x345800=['BCT',_0x5dd65c(0x283)];try{await axios['get'](_0x5dd65c(0x22f),{'headers':{'X-CMC_PRO_API_KEY':_0x40cc43},'params':{'symbol':_0x345800[_0x5dd65c(0x226)]()}});}catch(_0x1d3ce0){_0x1d3ce0['toString']()[_0x5dd65c(0xc5)](_0x5dd65c(0x1c3))?(io['to']('botmanager')[_0x5dd65c(0x129)](_0x5dd65c(0x7e),_0x5dd65c(0x228)),logger[_0x5dd65c(0x82)](_0x5dd65c(0x228))):(io['to'](_0x5dd65c(0x155))[_0x5dd65c(0x129)](_0x5dd65c(0x7e),_0x5dd65c(0x169)),logger['full'](_0x5dd65c(0x169)),logger[_0x5dd65c(0x8e)]('Error\x20details:',_0x1d3ce0['toString']()+_0x5dd65c(0x252)+_0x1d3ce0['code']));return;}logger[_0x5dd65c(0x8e)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x2b0d69,_0x210467){const _0x41d6a1=_0x373308;dbSettings['set'](_0x41d6a1(0x184)+_0x2b0d69,_0x210467)['write'](),settings=getSettings(),io['to'](_0x41d6a1(0x155))[_0x41d6a1(0x129)](_0x41d6a1(0x93),cleanSettings());}function storeSecure(_0x3ec04f){const _0x40394d=_0x373308;dbSecure[_0x40394d(0x1ab)](_0x40394d(0x1cf))['push'](_0x3ec04f)[_0x40394d(0x162)](),secure=_0x3ec04f;}function addBlacklist(_0x34a531){const _0x8413c0=_0x373308;cleanBlacklist();let _0x3f82bc;devices[_0x34a531]['telegramIpApproval']?_0x3f82bc=Math[_0x8413c0(0x1f3)](devices[_0x34a531]['telegramIpApproval'][_0x8413c0(0x1b6)],loginExpiry):_0x3f82bc=loginExpiry,dbSecure[_0x8413c0(0x1ab)](_0x8413c0(0x16c))[_0x8413c0(0xaa)]({'expiry':new Date()[_0x8413c0(0x24c)]()+_0x3f82bc*0x3c*0x3e8,'token':devices[_0x34a531][_0x8413c0(0x248)][_0x8413c0(0x161)]})[_0x8413c0(0x162)](),blacklist=dbSecure[_0x8413c0(0x1ab)](_0x8413c0(0x16c))[_0x8413c0(0x220)]();}function cleanBlacklist(){const _0x3033b8=_0x373308;let _0x2322aa=dbSecure[_0x3033b8(0x1ab)](_0x3033b8(0x16c))['cloneDeep']()[_0x3033b8(0x220)](),_0x59e5ef=new Date()[_0x3033b8(0x24c)]();_0x2322aa['forEach'](_0x98c8bb=>{const _0x52bacf=_0x3033b8;_0x98c8bb['expiry']<_0x59e5ef&&dbSecure[_0x52bacf(0x1ab)](_0x52bacf(0x16c))[_0x52bacf(0x263)]({'expiry':_0x98c8bb[_0x52bacf(0x1b6)]})[_0x52bacf(0x162)]();});}function initStates(){const _0x43acc9=_0x373308;let _0x4e0c29=getConfiguration();_0x4e0c29[_0x43acc9(0x24a)](_0x1947ad=>{const _0x467ec9=_0x43acc9;_0x1947ad[_0x467ec9(0xa8)]=_0x467ec9(0x8c);}),storeConfiguration(_0x4e0c29);}async function generateKeys(){const _0x273f77=_0x373308,_0x2feb33=forge[_0x273f77(0xef)][_0x273f77(0x135)][_0x273f77(0x223)]({'bits':0x1000,'e':0x10001}),_0x1fb171=forge[_0x273f77(0xef)][_0x273f77(0xb5)](_0x2feb33[_0x273f77(0xeb)]),_0x420e54=forge[_0x273f77(0xef)][_0x273f77(0x78)](_0x2feb33[_0x273f77(0x130)]);return{'privateKey':_0x1fb171,'publicKey':_0x420e54};}async function oneTimeMigration(){const _0x3863f4=_0x373308;let _0x738009=getSettings(),_0x1cd1aa=![];!_0x738009[_0x3863f4(0x213)](_0x3863f4(0xd6))&&(_0x738009[_0x3863f4(0xd6)]=0x0,_0x1cd1aa=!![]);!_0x738009[_0x3863f4(0x213)](_0x3863f4(0x1cb))&&(_0x738009[_0x3863f4(0x1cb)]=0x0,_0x1cd1aa=!![]);!_0x738009[_0x3863f4(0x213)](_0x3863f4(0x1a0))&&(_0x738009['latestversion']='0.0.0',_0x1cd1aa=!![]);!_0x738009[_0x3863f4(0x213)](_0x3863f4(0xc8))&&(_0x738009[_0x3863f4(0xc8)]=![],_0x1cd1aa=!![]);!_0x738009[_0x3863f4(0x213)](_0x3863f4(0x1ef))&&(_0x738009[_0x3863f4(0x1ef)]='',_0x1cd1aa=!![]);if(_0x1cd1aa)storeSettings(_0x738009);try{fs[_0x3863f4(0x290)](configbackuppath,{'withFileTypes':!![]})[_0x3863f4(0x24a)](_0x40d72d=>{const _0x3d63f6=_0x3863f4;if(!_0x40d72d[_0x3d63f6(0x20a)]()){if(!_0x40d72d['name'][_0x3d63f6(0x222)](_0x3d63f6(0x1e0)))fs[_0x3d63f6(0x23d)](configbackuppath+_0x40d72d[_0x3d63f6(0x12e)]);}else fs['rmSync'](configbackuppath+_0x40d72d['name'],{'recursive':!![]});});}catch(_0x58339f){logger[_0x3863f4(0x8e)](_0x3863f4(0x21c),_0x58339f);}}function storeConfiguration(_0xf247a8){const _0x3b0b7a=_0x373308;dbConfig[_0x3b0b7a(0x1ab)](_0x3b0b7a(0x89))[_0x3b0b7a(0x263)]()['write'](),dbConfig['get'](_0x3b0b7a(0x89))[_0x3b0b7a(0xaa)](..._0xf247a8)[_0x3b0b7a(0x162)](),config=_0xf247a8;}async function resetPassword(){const _0x1d76cb=_0x373308;if(tgBot&&settings[_0x1d76cb(0x133)]){const _0x26b385=Markup['inlineKeyboard']([Markup[_0x1d76cb(0x20f)][_0x1d76cb(0x23b)](_0x1d76cb(0x288),_0x1d76cb(0x1d1)),Markup[_0x1d76cb(0x20f)][_0x1d76cb(0x23b)]('no',_0x1d76cb(0x107))]);await sendTelegram(settings['telegramChatId'],_0x1d76cb(0x275),_0x26b385),tgBot[_0x1d76cb(0x273)](/resetpw_(.+)/,async _0x25bea7=>{const _0x284828=_0x1d76cb,_0x5e3175=_0x25bea7['match'][0x1];_0x25bea7['editMessageReplyMarkup']();if(_0x5e3175!='no'){const _0x3d0581=0xf,_0x4f91e3=_0x284828(0x119),_0x4ccc05=Array[_0x284828(0x250)](crypto[_0x284828(0x9a)](new Uint32Array(_0x3d0581)))[_0x284828(0xa1)](_0x139749=>_0x4f91e3[_0x139749%_0x4f91e3['length']])['join'](''),_0x2f2560=bcrypt['hashSync'](_0x4ccc05,saltRounds);storeSettings({'bbPassword':_0x2f2560}),await sendTelegram(_0x25bea7[_0x284828(0x165)]['id'],_0x284828(0x1c5)+_0x4ccc05,{'parse_mode':_0x284828(0x286)});}else await sendTelegram(_0x25bea7['chat']['id'],_0x284828(0x199));});}}async function confirmRestore(_0x4f87ff,_0x48dfc8){const _0x57e522=_0x373308;io['to']('botmanager')[_0x57e522(0x129)](_0x57e522(0x7e),'Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x57e522(0x12c));if(tgBot&&settings[_0x57e522(0x133)]){const _0x3cba8d=uuidRandom();tmpStorage[_0x3cba8d]={'path':_0x4f87ff,'filename':_0x48dfc8};const _0x3b934d=Markup[_0x57e522(0x13e)]([Markup[_0x57e522(0x20f)][_0x57e522(0x23b)](_0x57e522(0x288),_0x57e522(0x1a5)+_0x3cba8d),Markup[_0x57e522(0x20f)][_0x57e522(0x23b)]('no',_0x57e522(0x227)+_0x3cba8d)]);await sendTelegram(settings[_0x57e522(0x133)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x3b934d),tgBot['action'](/restore_(.+)_(.+)/,async _0x3a386f=>{const _0x308bf6=_0x57e522,_0x1655cc=_0x3a386f[_0x308bf6(0x1fc)][0x1],_0x439f21=_0x3a386f['match'][0x2],{path:_0x2fedfe,filename:_0x4e9dc3}=tmpStorage[_0x439f21];delete tmpStorage[_0x439f21],_0x3a386f[_0x308bf6(0x284)](),_0x1655cc==_0x308bf6(0x288)?(logger['debug'](_0x308bf6(0x99)),await sendTelegram(_0x3a386f[_0x308bf6(0x165)]['id'],_0x308bf6(0x19b),{'parse_mode':_0x308bf6(0x286)}),unzipFile(_0x2fedfe,_0x4e9dc3)):(logger[_0x308bf6(0x8e)](_0x308bf6(0x277)),await sendTelegram(_0x3a386f[_0x308bf6(0x165)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x19aa5a=_0x373308,_0x3974e3=new Date();return _0x3974e3['getFullYear']()+'/'+(_0x3974e3[_0x19aa5a(0x172)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x3974e3[_0x19aa5a(0x18f)]()[_0x19aa5a(0x226)]()[_0x19aa5a(0xbc)](0x2,'0')+'\x20'+_0x3974e3[_0x19aa5a(0x115)]()['toString']()[_0x19aa5a(0xbc)](0x2,'0')+':'+_0x3974e3[_0x19aa5a(0x26b)]()[_0x19aa5a(0x226)]()[_0x19aa5a(0xbc)](0x2,'0')+':'+_0x3974e3[_0x19aa5a(0xf4)]()[_0x19aa5a(0x226)]()[_0x19aa5a(0xbc)](0x2,'0');}function getTimeStamp(){const _0xb70c38=_0x373308,_0xf10418=shiftedTime();return _0xf10418[_0xb70c38(0xfb)]()+'/'+(_0xf10418[_0xb70c38(0x172)]()+0x1)[_0xb70c38(0x226)]()['padStart'](0x2,'0')+'/'+_0xf10418[_0xb70c38(0x18f)]()['toString']()[_0xb70c38(0xbc)](0x2,'0')+'\x20'+_0xf10418[_0xb70c38(0x115)]()[_0xb70c38(0x226)]()[_0xb70c38(0xbc)](0x2,'0')+':'+_0xf10418[_0xb70c38(0x26b)]()[_0xb70c38(0x226)]()[_0xb70c38(0xbc)](0x2,'0')+':'+_0xf10418[_0xb70c38(0xf4)]()[_0xb70c38(0x226)]()[_0xb70c38(0xbc)](0x2,'0');}function getCleanTimeStamp(){const _0x41d2dc=_0x373308,_0x1b27c6=shiftedTime();return _0x1b27c6[_0x41d2dc(0xfb)]()+(_0x1b27c6[_0x41d2dc(0x172)]()+0x1)[_0x41d2dc(0x226)]()['padStart'](0x2,'0')+_0x1b27c6[_0x41d2dc(0x18f)]()['toString']()[_0x41d2dc(0xbc)](0x2,'0')+'-'+_0x1b27c6[_0x41d2dc(0x115)]()[_0x41d2dc(0x226)]()[_0x41d2dc(0xbc)](0x2,'0')+_0x1b27c6[_0x41d2dc(0x26b)]()[_0x41d2dc(0x226)]()[_0x41d2dc(0xbc)](0x2,'0')+_0x1b27c6[_0x41d2dc(0xf4)]()[_0x41d2dc(0x226)]()[_0x41d2dc(0xbc)](0x2,'0');}function shiftedTime(){const _0x1e541a=_0x373308,_0x19daee=new Date();let _0x4b3120=_0x19daee;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x4b3120=fns[_0x1e541a(0x26d)](_0x19daee,{'hours':settings['timeshift']});return _0x4b3120;}async function startScheduler(){const _0x544601=_0x373308,_0x562a0b=new Date()[_0x544601(0x1eb)](),_0x34a934=shiftedTime()[_0x544601(0x115)]();_0x34a934==0x4&&backupConfigFiles(),_0x34a934==0x0&&(rotateLogFiles(),logger[_0x544601(0x8e)]('--------------------------------------'),logger[_0x544601(0x8e)]('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0x544601(0x1dd)?'(staging)':'')),logger[_0x544601(0x8e)](_0x544601(0xa2))),_0x562a0b%0x6==0x0&&triggerAnalytics(),_0x562a0b%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}function _0xbb71(_0x7f7fef,_0x12622c){const _0x25f144=_0xdcde();return _0xbb71=function(_0x342b00,_0x17c979){_0x342b00=_0x342b00-0x78;let _0xdcde1c=_0x25f144[_0x342b00];return _0xdcde1c;},_0xbb71(_0x7f7fef,_0x12622c);}async function restoreBackupFile(_0x6064){logger['debug']('Restore\x20backup\x20file\x20'+_0x6064);const _0x433a40=getBotsWithMode();_0x433a40['length']>0x0?confirmRestore(configbackuppath,_0x6064):unzipFile(configbackuppath,_0x6064);}async function getBackupFiles(_0x4cc68b=null){const _0x24279e=_0x373308;let _0x11b999=[],_0x423450=fs[_0x24279e(0x290)](configbackuppath,{'withFileTypes':!![]});_0x423450[_0x24279e(0x24d)]((_0x5f4616,_0x2b1a7b)=>_0x5f4616['name']<_0x2b1a7b['name']?0x1:_0x2b1a7b[_0x24279e(0x12e)]<_0x5f4616['name']?-0x1:0x0),_0x423450[_0x24279e(0x24a)](_0x3b3eb2=>{const _0x29e969=_0x24279e;if(!_0x3b3eb2[_0x29e969(0x20a)]()&&_0x3b3eb2[_0x29e969(0x12e)][_0x29e969(0x222)](_0x29e969(0x1e0))&&_0x3b3eb2[_0x29e969(0x12e)][_0x29e969(0x1fd)](_0x29e969(0x18a))){const _0x8dd3b0=formatDate(fs[_0x29e969(0x1b1)](configbackuppath+_0x3b3eb2['name'])[_0x29e969(0x225)]);_0x11b999[_0x29e969(0xaa)]({'name':_0x3b3eb2[_0x29e969(0x12e)],'mtime':_0x8dd3b0});}});if(_0x4cc68b)io['to'](_0x4cc68b)['emit'](_0x24279e(0x22c),_0x11b999);else return _0x11b999;}async function backupConfigFiles(){const _0x5615f9=_0x373308;await zipFiles(_0x5615f9(0x144));const _0x50a532=getCleanTimeStamp();fs[_0x5615f9(0x16a)](zippath+_0x5615f9(0x152),configbackuppath+('backup-full@'+_0x50a532+_0x5615f9(0x18a)));let _0xf27bd8=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0xf27bd8[_0x5615f9(0x24d)]((_0x1a15bb,_0xb8a377)=>_0x1a15bb[_0x5615f9(0x12e)]<_0xb8a377[_0x5615f9(0x12e)]?0x1:_0xb8a377['name']<_0x1a15bb['name']?-0x1:0x0),_0xf27bd8['length']>maxBackups&&fs[_0x5615f9(0x23d)](configbackuppath+_0xf27bd8[_0xf27bd8[_0x5615f9(0x16b)]-0x1][_0x5615f9(0x12e)]);}function rotateLogFiles(){const _0x180eef=_0x373308,_0x3b495f=fs[_0x180eef(0x1b1)](logspath+_0x180eef(0x21f)),_0x261d5b=_0x3b495f[_0x180eef(0xdc)]/0x400;if(_0x261d5b>0x64){let _0xd8c071=fs[_0x180eef(0x290)](logspath,{'withFileTypes':!![]});_0xd8c071[_0x180eef(0x24d)]((_0x1b7ba8,_0x3b4218)=>_0x1b7ba8['name']<_0x3b4218[_0x180eef(0x12e)]?0x1:_0x3b4218[_0x180eef(0x12e)]<_0x1b7ba8[_0x180eef(0x12e)]?-0x1:0x0),_0xd8c071['forEach'](_0x1b4865=>{const _0xba35f4=_0x180eef;if(_0x1b4865[_0xba35f4(0x12e)]==_0xba35f4(0xca))fs[_0xba35f4(0x16a)](logspath+_0x1b4865[_0xba35f4(0x12e)],logspath+'output-003.log');if(_0x1b4865[_0xba35f4(0x12e)]==_0xba35f4(0x124))fs['copyFileSync'](logspath+_0x1b4865[_0xba35f4(0x12e)],logspath+_0xba35f4(0xca));_0x1b4865['name']==_0xba35f4(0x21f)&&(fs['copyFileSync'](logspath+_0x1b4865['name'],logspath+'output-001.log'),fs[_0xba35f4(0x268)](logspath+_0x1b4865[_0xba35f4(0x12e)],''));});}}async function zipFiles(_0x5c1513){const _0x5ae02b=_0x373308;let _0x3e131d;if(_0x5c1513==_0x5ae02b(0x262))_0x3e131d=logspath;if(_0x5c1513==_0x5ae02b(0x1d7))_0x3e131d=configpath;if(_0x5c1513==_0x5ae02b(0x144))_0x3e131d=configpath;let _0x58a5ab=fs['readdirSync'](_0x3e131d,{'withFileTypes':!![]});const _0x19a138=new JSZip();_0x58a5ab[_0x5ae02b(0x24a)](_0x27fb75=>{const _0x247035=_0x5ae02b;if(!_0x27fb75[_0x247035(0x20a)]()){let _0x3c6362=fs[_0x247035(0x88)](_0x3e131d+_0x27fb75[_0x247035(0x12e)]);if(_0x5c1513==_0x247035(0x1d7)){const _0x202915=/^bot-[0-9]{3}-config.json$/,_0x31aaa1=_0x202915[_0x247035(0x1ac)](_0x27fb75[_0x247035(0x12e)]);if(_0x31aaa1){const _0x405192=JSON['parse'](_0x3c6362);if(_0x405192['bot'][0x0]){_0x405192['bot'][0x0][_0x247035(0x159)]='***',_0x405192[_0x247035(0x205)][0x0][_0x247035(0x26e)]='***';if(_0x405192[_0x247035(0x205)][0x0][_0x247035(0x17d)])_0x405192['bot'][0x0]['apiPassword']=_0x247035(0xbe);}_0x3c6362=JSON[_0x247035(0x229)](_0x405192,null,0x2);}if(_0x27fb75['name']==_0x247035(0xbd)){const _0x938d43=JSON['parse'](_0x3c6362);if(_0x938d43['settings'][_0x247035(0x153)])_0x938d43[_0x247035(0x93)][_0x247035(0x153)]=![];if(_0x938d43[_0x247035(0x93)][_0x247035(0x11e)])_0x938d43[_0x247035(0x93)]['bbPassword']=_0x247035(0xbe);if(_0x938d43[_0x247035(0x93)][_0x247035(0xa9)])_0x938d43['settings']['telegramToken']=_0x247035(0xbe);if(_0x938d43[_0x247035(0x93)][_0x247035(0x133)])_0x938d43[_0x247035(0x93)]['telegramChatId']=null;if(_0x938d43[_0x247035(0x93)][_0x247035(0x1ef)])_0x938d43[_0x247035(0x93)][_0x247035(0x1ef)]=_0x247035(0xbe);_0x3c6362=JSON[_0x247035(0x229)](_0x938d43,null,0x2);}if(_0x27fb75[_0x247035(0x12e)]!='bb-secure.json')_0x19a138['file'](_0x27fb75[_0x247035(0x12e)],_0x3c6362);}else _0x19a138['file'](_0x27fb75['name'],_0x3c6362);}});const _0x4884ff=await _0x19a138[_0x5ae02b(0xa3)]({'type':'string','base64':![],'compression':'DEFLATE'});fs[_0x5ae02b(0x268)](zippath+(_0x5c1513+_0x5ae02b(0x18a)),_0x4884ff,_0x5ae02b(0x157));}async function unzipFile(_0x506178,_0x13dd31){const _0x515e58=_0x373308;fs[_0x515e58(0x290)](configpath,{'withFileTypes':!![]})[_0x515e58(0x24a)](_0x29585b=>{const _0x437845=_0x515e58;if(!_0x29585b[_0x437845(0x20a)]())fs[_0x437845(0x279)](configpath+_0x29585b[_0x437845(0x12e)]);});const _0x5d892b=fs[_0x515e58(0x88)](_0x506178+_0x13dd31,_0x515e58(0x157)),_0x556867=await JSZip[_0x515e58(0x1e3)](_0x5d892b,{'base64':![],'checkCRC32':!![]});for(const _0x42a990 of Object['keys'](_0x556867['files'])){const _0x1acb03=_0x556867['files'][_0x42a990],_0x1504b6=await _0x1acb03[_0x515e58(0x1c8)]('string');fs[_0x515e58(0x268)](configpath+_0x1acb03['name'],_0x1504b6);}fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x515e58(0x24a)](_0x15f394=>{const _0x9d095f=_0x515e58;if(!_0x15f394[_0x9d095f(0x20a)]())fs[_0x9d095f(0x279)](temppath+_0x15f394[_0x9d095f(0x12e)]);}),logger[_0x515e58(0x8e)](_0x515e58(0x10c)),process['send']({'restore':!![]},_0x477baa=>{});}async function getPublicIp(){const _0x276df8=_0x373308;try{const _0x327d03=await axios[_0x276df8(0x1ab)](_0x276df8(0x7f));publicip=_0x327d03[_0x276df8(0x1fa)]['ip'];}catch(_0x1e8c55){}}async function triggerAnalytics(){const _0x342aac=_0x373308;if(!publicip)await getPublicIp();const _0x4e3393=getBotsWithMode();let _0x5bfb2e=0x0;_0x4e3393['forEach'](_0x321847=>{if(_0x321847['status']==='enabled')_0x5bfb2e++;});const _0x547248=getBotExchanges();mixpanel['track'](_0x342aac(0x1ff),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x4e3393['length'],'numbotsenabled':_0x5bfb2e,'exchanges':_0x547248,'environment':environment});}async function getMessages(){const _0x58f385=_0x373308,_0x24f79a='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x3a799f=new GraphQLClient(_0x24f79a),_0x146bba={'authorization':_0x58f385(0x1b0)},_0x43347d=serverversion['split']('.'),_0x1992d7=_0x43347d[0x0]+'.'+_0x43347d[0x1],_0x4f2384=Math['min'](settings['lastmsgtelegram'],settings[_0x58f385(0x1cb)]),_0x37fc40={'last':parseInt(_0x4f2384),'bbm':_0x1992d7},_0xf6deb8=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x40dce6;try{_0x40dce6=await _0x3a799f[_0x58f385(0x154)](_0xf6deb8,_0x37fc40,_0x146bba);}catch(_0x532435){}if(_0x40dce6&&_0x40dce6[_0x58f385(0x98)]){let _0x1e4e35=settings[_0x58f385(0xd6)];newMessages=[];for(const _0x6f1d29 of _0x40dce6[_0x58f385(0x98)]){newMessages['push'](_0x6f1d29);let _0x4463f1=![];_0x6f1d29[_0x58f385(0x167)]&&(updateSetting('latestversion',_0x6f1d29[_0x58f385(0x167)]),_0x4463f1=isNewerVersion(serverversion,_0x6f1d29['bbvNew'])||serverversion==_0x6f1d29[_0x58f385(0x167)]);if(!_0x4463f1&&_0x6f1d29[_0x58f385(0x206)]>_0x1e4e35){if(_0x6f1d29[_0x58f385(0x177)]===_0x58f385(0x1cc)||serverversion['startsWith'](_0x6f1d29[_0x58f385(0x177)])){let _0x12c97b=''+_0x6f1d29[_0x58f385(0x25f)]+'\x0a\x0a'+_0x6f1d29[_0x58f385(0x246)];const _0x2113cd=await sendTelegramMsg(toTelegramMarkdown(_0x12c97b),'Markdown');if(_0x2113cd)_0x1e4e35=_0x6f1d29[_0x58f385(0x206)];}}}updateAvailable=isNewerVersion(settings[_0x58f385(0x1a0)],serverversion),updateSetting(_0x58f385(0xd6),_0x1e4e35),emitMessages();}}function emitMessages(){const _0x5b0e37=_0x373308,_0x8ccb29=settings['lastmsgemitted'];let _0x26b6d0=[];newMessages['forEach'](_0xa0fbf0=>{const _0xfe0d89=_0xbb71;_0xa0fbf0[_0xfe0d89(0x206)]>_0x8ccb29&&_0x26b6d0['push'](_0xa0fbf0);}),_0x26b6d0[_0x5b0e37(0x16b)]>0x0&&getAllClients()[_0x5b0e37(0x24a)](_0x418a31=>{const _0x181aa2=_0x5b0e37;getSocket(_0x418a31['id'])[_0x181aa2(0x129)](_0x181aa2(0x246),_0x26b6d0);});}function _0xdcde(){const _0x59e9d4=['node-forge','lastmsgemitted','any','ipaddr.js','logged\x20out','secure','botname','resetpw_yes','help','pidRefreshToken','No\x20bots\x20running\x20right\x20now','use','all','backup','uuid','child_process','storeConfiguration','config/','telegramUsername','staging','start','Ok,\x20will\x20send\x20alert\x20notifications\x20only','backup-full@','************','off','loadAsync','-----------------------------------------------------------------------------------','Logged\x20out\x20user\x20...','path','#RES#\x20','/logs\x20-\x20receive\x20log\x20files\x0a','new','string','getUTCHours','User\x20has\x20been\x20validated','auto','post','marketcapApi','filter','Bot\x20Mgr\x20>\x20','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','max','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','backup/','Unauthorized\x20attempt\x20to\x20download\x20','download','bot.js','telegramEnabled','data','event','match','endsWith','init','Server','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','replace','inherit','config_all','defaults','bot','number','delete-alerts','\x20>\x20','format','isDirectory','\x20|\x20client:\x20...','update_yes','get-backup-files','close','button','bb-secure.json','127.0.0.1','Unauthorized\x20attempt\x20to\x20update\x20settings','hasOwnProperty','Unauthorized\x20login\x20attempt\x20(timeout)','(((.+)+)+)+$','Unauthorized\x20attempt\x20to\x20update\x20bot','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','\x20|\x20user:\x20...','args','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','store-settings','Error\x20removing\x20old\x20backup\x20files:','#RES#','Allow\x20login\x20from\x20IP\x20address\x20','output-000.log','value','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','startsWith','generateKeyPair','/names\x20-\x20show\x20bot\x20names\x0a','mtime','toString','restore_no_','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','stringify','command','logout','backup-files','6b67f3d61ee94b8f5c80b4affef4c4d9','address\x20already\x20in\x20use','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','new-disabled','sendMessage','bb-config.json','/:bot','whitelistEnabled','log','userid','telegram','host','5\x20min','names','callback','store','unlinkSync','/upload-backup','static','handshake','login\x20required','/on\x20-\x20start\x20bot(s)\x0a','tempaccess_5_','error','reject','message','\x20files\x20over\x20Telegram:','access','temporary\x20access\x20not\x20allowed','forEach','mode','getTime','sort','socket.io','Login\x20accepted','from','toggle-bot-mode','\x20-\x20','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','sortBy','split','Network\x20Interfaces:','cancel-loading','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','sendPortfolioTelegram','getPortfolio','keys','Notifications\x20disabled','\x1b[35m','date-fns','title','login\x20not\x20required','version','logs','remove','IPv4','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','env','*$1*','writeFileSync','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','timestamp','getMinutes','Telegram\x20error:','add','apiSecret','send','accept','update_no','off_','action','Invalid\x20authentication\x20token\x20(2)','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','-results.json','Restore\x20process\x20aborted','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','rmSync','delete-bot','bot-','server','telegramIpApproval',':\x20Bot\x20Mgr\x20>\x20','/help\x20-\x20show\x20available\x20commands\x0a','decrypt','login2fa_','portfolio_','ETH','editMessageReplyMarkup','Starting\x20Balance\x20Bot\x20reinstallation','HTML','warning','yes','(staging)','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Backup\x20file\x20uploaded','159066FPkVqB','1491156GwRzaQ','/status\x20-\x20show\x20bot(s)\x20status\x0a','Session\x20expired\x20for\x20user\x20...','readdirSync','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','toIPv4Address','Failed\x20to\x20download\x20','temp/','publicKeyToPem','socket','versions','placeOrder','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','invalid\x20credentials','notification','https://api.ipify.org?format=json','uuid-random','assign','full','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','hex','search','create','telegramEvents','readFileSync','bots','catch','existsSync','stopped','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','debug','\x20|\x20','2607qAyRuy','reinstall','logs/','settings','temporaryAccessAllowed','Starting\x20(','#RES#\x20if\x20running\x20on\x20server','/:bot/performance','messages','Restore\x20process\x20confirmed','randomFillSync','createServer','Logged\x20in\x20user\x20...','createWriteStream','#RES#\x20if\x20running\x20locally\x0a','manual','sendFile','map','--------------------------------------','generateAsync','reply','SIGINT','/enable\x20-\x20enable\x20notifications\x0a','temporary\x20access\x20timeout','live','telegramToken','push','compareSync','1384645DOOazF','backupfile','Unauthorized\x20attempt\x20to\x20show\x20configuration','Yes','\x20minutes','sha256','telegrammsg','argv','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','privateKeyToPem','update','/:bot/portfolio','1616wEVIip','/:bot/history','1110gkJhtm','reinstall-bb','padStart','bb-settings.json','***','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','store-configuration','login2fa_reject_','metrics_','hashSync','tkn','includes','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','10EWSPcr','onepagemode','ipc','output-002.log','Node.js\x20v','showname','mixpanel','node','/download/:type','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Invalid\x20IP\x20address','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','restart_','login','family','lastmsgtelegram','\x1b[34m','showConfig','\x20mode','$1_$2_$3','deleteHistoryAlerts','size','All','alias','Unauthorized\x20attempt\x20to\x20log\x20out','find','15\x20min','update-bot','connection','\x20to\x20','Access\x20enabled\x20for\x20','referer','lowdb','SIGTERM','3411009dfvLRS','auth','privateKey','All\x20bots\x20running\x20right\x20now','store-headless','resetHistory','pki','clientip','headers','join','\x1b[36m','getSeconds','cancelLoading','sockets','remoteAddress','sign','user','reset-history','getFullYear','internal','sendMetricsTelegram','NTBA_FIX_319','disabled','crypto','jszip','Ok,\x20will\x20send\x20order\x20notifications\x20only','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','/off\x20-\x20stop\x20bot(s)\x0a','launch','removeAllListeners','resetpw_no','parse','port','getStartingBalances','tempaccess_reject_','Backup\x20file\x20unzipped\x20and\x20stored','kind','RSA-OAEP','initclient','temporary\x20access\x20rejected','1000','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','portfolio','Notifications\x20enabled','getHours','version.json','headless','\x20only\x0a','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','order','login\x20token\x20valid','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','bbUsername','bbPassword','/output-000.log','mkdirSync','isValid','status',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','output-001.log','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','3000','restart','slice','emit','lowdb/adapters/FileSync','Unauthorized\x20attempt\x20to\x20delete\x20bot','success','2FA\x20required','name','config_orders','publicKey','running','config_alerts','telegramChatId','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','rsa','Unauthorized\x20attempt\x20to\x20confirm\x20message','connected','then','type','once','2FA\x20login\x20required','timeshift','add-bot','inlineKeyboard','Alerts','Telegraf\x20error:','No\x20authentication\x20token','botID','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','backup-full','\x1b[0m','metrics','2FA','toggleBotMode','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','All\x20bots','allow','updatebotmanager','Bot\x20','address','entries','build','Starting\x20Balance\x20Bot\x20update','backup-full.zip','loginRequired','request','botmanager','on_','binary','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','apiKey','Your\x20installation\x20is\x20already\x20up\x20to\x20date','toggle_','index.html','params','pidExpireLogin','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','simple','token','write','reason','get-messages','chat','reload','bbvNew','confirm-message','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','copyFileSync','length','blacklist','show-config','stop','graphql-request','Notifications\x20disabled\x0a','orders','getMonth','verify','exit',')\x20\x20\x20|\x20Bot\x20','telegram2FaApproval','bbvReceive','environment','toIPv4MappedAddress','-config.json','disconnect','http','apiPassword','login\x20token\x20generated','replyWithDocument','username','reinstall_yes',')\x20|\x20Bot\x20','|@|','settings.','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','privateKeyFromPem','api-eu.mixpanel.com','reinstall_no','fork','.zip','Unauthorized\x20attempt\x20to\x20get\x20messages','kill','::ffff:127.0.0.1','alerts','getDate','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Restarting\x20Bot\x20','show','<b>Balance\x20Bot\x20Status:</b>\x0a','toggle','secret','place-order','set','182cSOjJp','Password\x20reset\x20rejected','bb/','Restoring\x20bot(s)\x20from\x20backup','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','text','/:bot/coins','enabled','latestversion','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','get-portfolio','enable','-performance.json','restore_yes_','Invalid\x20authentication\x20token\x20(1)','whitelist','restore-backup-file','/:bot/configuration','files','get','test','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','started','exec','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','statSync','Starting\x20#RED#Balance\x20Bot\x20v','get-starting-balances','30\x20min','Unauthorized\x20attempt\x20to\x20delete\x20alerts','expiry','update-bb','Login\x20rejected','492603QudVvI','password','2FA\x20login\x20token\x20generated','util','yargs/yargs','f2aRequired','build2','Orders','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','/metrics\x20-\x20show\x20bot\x20performance\x0a','status\x20code\x20401','function','Password\x20has\x20been\x20reset\x20to:\x20','/:bot/support','Error\x20sending\x20','async','listen'];_0xdcde=function(){return _0x59e9d4;};return _0xdcde();}function confirmMessage(_0x19507f){updateSetting('lastmsgemitted',Number(_0x19507f));}function isNewerVersion(_0x2a1853,_0x390df2){const _0x1bee67=_0x373308,_0xb4a5ef=_0x390df2[_0x1bee67(0x255)]('.'),_0x251d92=_0x2a1853[_0x1bee67(0x255)]('.');for(var _0x1cfcee=0x0;_0x1cfcee<_0x251d92[_0x1bee67(0x16b)];_0x1cfcee++){const _0x1c2e58=~~_0x251d92[_0x1cfcee],_0x2c102b=~~_0xb4a5ef[_0x1cfcee];if(_0x1c2e58>_0x2c102b)return!![];if(_0x1c2e58<_0x2c102b)return![];}return![];}function toTelegramMarkdown(_0x2d6204){const _0x4c2e92=_0x373308,_0x5e9b5f=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xdeb615=/\*{2}(.+?)\*{2}/gim;return _0x2d6204=_0x2d6204[_0x4c2e92(0x201)](_0x5e9b5f,_0x4c2e92(0xda))[_0x4c2e92(0x201)](_0xdeb615,_0x4c2e92(0x267)),_0x2d6204;}async function validateConfigFile(){const _0x488a53=_0x373308,_0x34c632=dbConfig[_0x488a53(0x1ab)]('bots')[_0x488a53(0x254)](_0x488a53(0x142))[_0x488a53(0x220)]()||[];if(_0x34c632[_0x488a53(0x16b)]==0x0){let _0x4d13a8=0x0,_0x23413b=[];const _0x2d30d0=/^bot-([0-9]{3})-config.json$/,_0x599049=fs[_0x488a53(0x290)](configpath);_0x599049[_0x488a53(0x24a)](_0x760cd3=>{const _0x2ee208=_0x488a53,_0x5d5ce5=_0x2d30d0[_0x2ee208(0x1af)](_0x760cd3);if(_0x5d5ce5){const _0x333b49=_0x5d5ce5[0x1];let _0x7872=getBotAttributes(_0x333b49);_0x23413b['push']({'botID':_0x333b49,'botname':_0x7872['botname'],'status':_0x2ee208(0xff),'live':_0x2ee208(0x8c)}),_0x4d13a8++;}}),_0x4d13a8!=0x0&&(dbConfig['get']('bots')['assign'](_0x23413b)[_0x488a53(0x162)](),config=_0x23413b,restoredConfigFile=_0x4d13a8);}}async function restoreConfigNotify(_0x7a67bb){const _0x47e034=_0x373308;let _0x495e94;if(restoredConfigFile==0x1)_0x495e94=_0x47e034(0xd0);else _0x495e94=_0x47e034(0x143);if(_0x7a67bb)io['to']('botmanager')['emit'](_0x47e034(0x7e),_0x495e94);else{logger[_0x47e034(0x160)]('-----------------------------------------------------------------------------------'),logger[_0x47e034(0x160)](_0x495e94),logger[_0x47e034(0x160)](_0x47e034(0x1e4)),logger['simple']('');if(tgBot&&settings[_0x47e034(0x133)]&&settings[_0x47e034(0x87)]!='orders')await sendTelegram(settings['telegramChatId'],_0x47e034(0x1f1)+_0x495e94);}}function decryptRSA(_0x3419c9,_0x45bfe8){const _0x28b2a5=_0x373308,_0x13bfdb=forge[_0x28b2a5(0xef)][_0x28b2a5(0x186)](_0x3419c9),_0x3454c2=_0x13bfdb[_0x28b2a5(0x280)](forge[_0x28b2a5(0x1bc)]['decode64'](_0x45bfe8),_0x28b2a5(0x10e),{'md':forge['md']['sha256']['create'](),'mgf1':{'md':forge['md'][_0x28b2a5(0xb1)][_0x28b2a5(0x86)]()}});return _0x3454c2;}function validateCredentials(_0x16cea3,_0x4daa16){const _0x1949de=_0x373308;if(_0x16cea3['username']==settings[_0x1949de(0x11d)]&&bcrypt[_0x1949de(0xab)](_0x16cea3[_0x1949de(0x1ba)],settings['bbPassword'])){if(settings[_0x1949de(0x1be)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x5bb121=generateLoginToken(_0x4daa16);return{'allow':!![],'reason':_0x1949de(0x17e),'token':_0x5bb121};}}else return{'allow':![],'reason':_0x1949de(0x7d),'token':null};}function refreshToken(_0x1964c7){const _0x3e7d7d=_0x373308,_0x51de7c=generateLoginToken(_0x1964c7);return{'allow':!![],'reason':_0x3e7d7d(0x17e),'token':_0x51de7c};}function validateAccess(_0x41096d,_0x5e5493,_0x9eb3c1){const _0x52a801=_0x373308,_0xfb8aa2=_0x9eb3c1?_0x9eb3c1:devices[_0x5e5493]['ip'];let _0x4e5594;const _0x490ec5=_0x41942b=>{const _0x54cf46=_0xbb71;if(settings['loginRequired']){if(settings[_0x54cf46(0x1be)]){if(telegram2FaApproved(_0x5e5493)){const _0x10a6fb=generateLoginToken(_0x5e5493);return{'allow':!![],'reason':_0x54cf46(0x1bb),'token':_0x10a6fb};}else return{'allow':![],'reason':_0x54cf46(0x241),'token':null};}else return _0x4e5594=validToken(_0x41942b,_0x5e5493),_0x4e5594[_0x54cf46(0x213)]('success')?{'allow':!![],'reason':_0x54cf46(0x11b),'token':_0x41942b}:{'allow':![],'reason':_0x54cf46(0x241),'token':null};}else return{'allow':!![],'reason':_0x54cf46(0x260),'token':null};};if(settings[_0x52a801(0x234)]){let _0x4803d0=[...settings[_0x52a801(0x1a7)],'::1',_0x52a801(0x18d),_0x52a801(0x211)];if(_0x4803d0[_0x52a801(0xc5)](_0xfb8aa2))return _0x490ec5(_0x41096d);else{_0x4e5594=validToken(_0x41096d,_0x5e5493);if(_0x4e5594[_0x52a801(0x213)](_0x52a801(0x12c)))return _0x490ec5(_0x41096d);else{if(telegramIpApproved(_0x5e5493)){const _0x3ce5f4=generateToken(_0x5e5493);return _0x4e5594=_0x490ec5(_0x41096d),_0x4e5594['allow']?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x3ce5f4}:_0x4e5594;}else return settings[_0x52a801(0x94)]?{'allow':![],'reason':_0x52a801(0x12d),'token':null}:{'allow':![],'reason':_0x52a801(0x249),'token':null};}}}else return _0x490ec5(_0x41096d);}function timelyDecrypt(_0x554a40,_0x3fd4fd,_0x321a9c='@'){const _0x1225a7=_0x373308;if(_0x554a40)try{const _0x41cbb6=decryptRSA(secure[_0x1225a7(0xeb)],_0x554a40),_0x620443=_0x41cbb6['split'](_0x321a9c)[0x0],_0x3aebbb=_0x41cbb6[_0x1225a7(0x255)](_0x321a9c)[0x1],_0x133803=new Date()[_0x1225a7(0x24c)]();if(_0x3fd4fd){if(_0x133803-_0x3aebbb<maxSecretAge*0x3e8)return _0x620443;else return![];}else return _0x620443;}catch(_0x422447){return![];}else return![];}const validToken=(_0x900105,_0x6ad162)=>{const _0x9d6e3f=_0x373308,_0x49c87c=devices[_0x6ad162]['ip'];if(!_0x900105)return{'error':_0x9d6e3f(0x141)};for(let _0x1d9222 of blacklist){if(_0x1d9222[_0x9d6e3f(0x161)]==_0x900105)return{'error':'Token\x20blacklisted'};}let _0x45152a;try{_0x45152a=jwt[_0x9d6e3f(0x173)](_0x900105,secure[_0x9d6e3f(0x195)]+_0x6ad162);}catch{return{'error':_0x9d6e3f(0x1a6)};}if(!_0x45152a[_0x9d6e3f(0x213)](_0x9d6e3f(0xf0))&&!_0x45152a[_0x9d6e3f(0x213)]('username')||!_0x45152a[_0x9d6e3f(0x213)]('exp'))return{'error':_0x9d6e3f(0x274)};if(!_0x45152a[_0x9d6e3f(0x213)](_0x9d6e3f(0x180))&&_0x45152a[_0x9d6e3f(0x213)]('clientip')){const {clientip:_0x49509b}=_0x45152a;return _0x49c87c==_0x49509b?{'success':_0x9d6e3f(0x1ec)}:{'error':_0x9d6e3f(0xd1)};}else{if(_0x45152a[_0x9d6e3f(0x213)]('username')&&_0x45152a['hasOwnProperty'](_0x9d6e3f(0xf0))){const {username:_0x184a40,clientip:_0x2e1563}=_0x45152a;return settings[_0x9d6e3f(0x11d)]==_0x184a40&&_0x49c87c==_0x2e1563?{'success':_0x9d6e3f(0x1ec)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x56cb0e=>{const _0x3f4da8=_0x373308;if(_0x56cb0e){const _0x2cee9e=devices[_0x56cb0e]['ip'];return jwt['sign']({'username':settings[_0x3f4da8(0x11d)],'clientip':_0x2cee9e},secure[_0x3f4da8(0x195)]+_0x56cb0e,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x4e9800=>{const _0x271668=_0x373308;if(_0x4e9800){const _0xc8ecfa=devices[_0x4e9800]['ip'];return jwt[_0x271668(0xf8)]({'clientip':_0xc8ecfa},secure['secret']+_0x4e9800,{'expiresIn':devices[_0x4e9800][_0x271668(0x27d)][_0x271668(0x1b6)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x1559b9=>{const _0x89c10b=_0x373308;let _0x25ea34=![];return devices[_0x1559b9][_0x89c10b(0x27d)]&&devices[_0x1559b9]['telegramIpApproval'][_0x89c10b(0x1b6)]!=_0x89c10b(0x245)&&(_0x25ea34=devices[_0x1559b9][_0x89c10b(0x27d)]['clientip']==devices[_0x1559b9]['ip']&&new Date()[_0x89c10b(0x24c)]()-devices[_0x1559b9][_0x89c10b(0x27d)][_0x89c10b(0x26a)]<devices[_0x1559b9][_0x89c10b(0x27d)][_0x89c10b(0x1b6)]*0x3c*0x3e8),_0x25ea34;},telegram2FaApproved=_0x44706d=>{const _0x16845d=_0x373308;let _0x2a0c1e=![];return devices[_0x44706d][_0x16845d(0x176)]&&devices[_0x44706d][_0x16845d(0x176)][_0x16845d(0x1b6)]!=_0x16845d(0x245)&&(_0x2a0c1e=devices[_0x44706d][_0x16845d(0x176)][_0x16845d(0xf0)]==devices[_0x44706d]['ip']&&new Date()[_0x16845d(0x24c)]()-devices[_0x44706d][_0x16845d(0x176)][_0x16845d(0x26a)]<devices[_0x44706d][_0x16845d(0x176)][_0x16845d(0x1b6)]*0x3c*0x3e8),_0x2a0c1e;},normalizeIP=_0x5910a1=>{const _0x50c418=_0x373308;let _0x2c211f=null,_0x2bdd44=null;if(ipaddr[_0x50c418(0x121)](_0x5910a1)){const _0x4cbc74=ipaddr[_0x50c418(0x108)](_0x5910a1);_0x4cbc74[_0x50c418(0x10d)]()==='ipv6'?(_0x4cbc74['isIPv4MappedAddress']()&&(_0x2c211f=_0x4cbc74[_0x50c418(0x292)]()[_0x50c418(0x226)]()),_0x2bdd44=_0x4cbc74[_0x50c418(0x226)]()):(_0x2c211f=_0x4cbc74[_0x50c418(0x226)](),_0x2bdd44=_0x4cbc74[_0x50c418(0x179)]()[_0x50c418(0x226)]());}return{'show':_0x2c211f?_0x2c211f:_0x2bdd44,'store':_0x2bdd44};};function formatDate(_0x3a9ba2){const _0x1d42ee=_0x373308;return _0x3a9ba2['getFullYear']()+'/'+(_0x3a9ba2['getMonth']()+0x1)[_0x1d42ee(0x226)]()[_0x1d42ee(0xbc)](0x2,'0')+'/'+_0x3a9ba2[_0x1d42ee(0x18f)]()[_0x1d42ee(0x226)]()[_0x1d42ee(0xbc)](0x2,'0')+'\x20'+_0x3a9ba2[_0x1d42ee(0x115)]()['toString']()[_0x1d42ee(0xbc)](0x2,'0')+':'+_0x3a9ba2['getMinutes']()['toString']()['padStart'](0x2,'0')+':'+_0x3a9ba2[_0x1d42ee(0xf4)]()['toString']()[_0x1d42ee(0xbc)](0x2,'0');}function sleep(_0x3c5886){return new Promise(_0x1451d8=>setTimeout(_0x1451d8,_0x3c5886));}