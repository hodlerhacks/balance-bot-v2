const _0x454ffa=_0x3362;(function(_0x49ff6d,_0x138387){const _0x44e545=_0x3362,_0x3a772c=_0x49ff6d();while(!![]){try{const _0x479216=parseInt(_0x44e545(0x2e8))/0x1+-parseInt(_0x44e545(0x2d8))/0x2*(parseInt(_0x44e545(0x244))/0x3)+-parseInt(_0x44e545(0x326))/0x4+parseInt(_0x44e545(0x259))/0x5*(-parseInt(_0x44e545(0x2eb))/0x6)+-parseInt(_0x44e545(0x278))/0x7+parseInt(_0x44e545(0x22f))/0x8*(parseInt(_0x44e545(0x2bb))/0x9)+parseInt(_0x44e545(0x1b5))/0xa;if(_0x479216===_0x138387)break;else _0x3a772c['push'](_0x3a772c['shift']());}catch(_0x45ae8b){_0x3a772c['push'](_0x3a772c['shift']());}}}(_0x4332,0x4aff7));const _0x28df75=function(){let _0x14b906=!![];return function(_0x25deca,_0x522faf){const _0x5b688d=_0x14b906?function(){if(_0x522faf){const _0x5622dd=_0x522faf['apply'](_0x25deca,arguments);return _0x522faf=null,_0x5622dd;}}:function(){};return _0x14b906=![],_0x5b688d;};}(),_0x5520ee=_0x28df75(this,function(){const _0x27200a=_0x3362;return _0x5520ee[_0x27200a(0x2ba)]()[_0x27200a(0x239)]('(((.+)+)+)+$')[_0x27200a(0x2ba)]()['constructor'](_0x5520ee)[_0x27200a(0x239)](_0x27200a(0x316));});_0x5520ee();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require(_0x454ffa(0x34a)),fs=require('fs'),fns=require('date-fns'),low=require(_0x454ffa(0x1da)),FileSync=require(_0x454ffa(0x273)),path=require(_0x454ffa(0x197)),crypto=require(_0x454ffa(0x351)),forge=require('node-forge'),bcrypt=require(_0x454ffa(0x368)),jwt=require(_0x454ffa(0x2fb)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x454ffa(0x2f7)][_0x454ffa(0x261)](0x2))[_0x454ffa(0x2f7)],uuidRandom=require(_0x454ffa(0x377)),{Telegraf,Markup}=require(_0x454ffa(0x344)),Mixpanel=require(_0x454ffa(0x310)),axios=require('axios'),{GraphQLClient,gql}=require(_0x454ffa(0x216)),util=require(_0x454ffa(0x33c)),fileUpload=require(_0x454ffa(0x299)),{networkInterfaces}=require('os'),JSZip=require(_0x454ffa(0x233)),PORT=argv[_0x454ffa(0x22e)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x454ffa(0x369)](_0x454ffa(0x313)+PORT+_0x454ffa(0x2c1)),process['exit'](0x1));const HOST=argv['host']||null,userID=argv['user']||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x454ffa(0x1d5)][_0x454ffa(0x30e)];let bbpath=_0x454ffa(0x36f),bbpath2='';const botfile=_0x454ffa(0x257),configfile='bb-config.json',settingsfile=_0x454ffa(0x290),securefile=_0x454ffa(0x236),environment=require('./'+bbpath2+_0x454ffa(0x1e6))[_0x454ffa(0x1e2)]||_0x454ffa(0x36d),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x454ffa(0x39a)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x454ffa(0x391)),configpath=userID?bbpath+_0x454ffa(0x272)+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x454ffa(0x1ed)+userID+'/':bbpath+_0x454ffa(0x1ed),zippath=userID?bbpath+_0x454ffa(0x2e0)+userID+'/':bbpath+_0x454ffa(0x2e0),loggerfile=fs[_0x454ffa(0x231)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x454ffa(0x32b)+userID+'/':bbpath+_0x454ffa(0x32b);!fs[_0x454ffa(0x39a)](configpath)&&fs[_0x454ffa(0x1d0)](configpath);!fs[_0x454ffa(0x39a)](configbackuppath)&&fs[_0x454ffa(0x1d0)](configbackuppath);!fs[_0x454ffa(0x39a)](logspath)&&fs[_0x454ffa(0x1d0)](logspath);!fs[_0x454ffa(0x39a)](zippath)&&fs[_0x454ffa(0x1d0)](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x454ffa(0x235)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x454ffa(0x361),'onepagemode':![],'marketcapApi':''}})[_0x454ffa(0x308)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x454ffa(0x235)]({'secure':{},'blacklist':[]})[_0x454ffa(0x308)]();function _0x4332(){const _0x1b18b9=['editMessageReplyMarkup','show','referer','exchange','restore-backup-file','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','add-bot','config_alerts','argv','<b>Telegram\x20Bot\x20Status:</b>\x0a','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Bot\x20Mgr\x20>\x20','jsonwebtoken','generateKeyPair','create','orders','token','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','notification','update_no','#RES#\x20if\x20running\x20on\x20server','127.0.0.1','telegramToken','running','/download/:type','write','\x20files\x20over\x20Telegram:','name','/off\x20-\x20stop\x20bot(s)\x0a','Logged\x20out\x20user\x20...','full','node','get','mixpanel','Invalid\x20authentication\x20token\x20(1)','/disable\x20-\x20disable\x20notifications\x0a','Error:\x20Invalid\x20argument\x20','=>\x20Go\x20to\x20#CYA#http://','started','(((.+)+)+)+$','copyFileSync','disconnect','marketcapApi','ipv6','toggle_','on_','bots','sendFile','live',')\x20|\x20Bot\x20','Backup\x20file\x20uploaded','/:bot/performance','login\x20required','Restoring\x20bot(s)\x20from\x20backup','names','579776FGOZsg','30\x20min','manual','string','\x20>\x20','temp/','\x20-\x20','async','allow','\x1b[31m','tempaccess_15_','/:bot','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','send','stop','All','[ip-address]','statSync','(staging)','build2','enabled','botmanager','util','placeOrder','uuid','metrics_','.zip','BCT','disabled','botID','telegraf','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','createServer','data','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Token\x20blacklisted','child_process','config_orders','length','User\x20has\x20been\x20validated','catch','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','crypto','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','server','Your\x20installation\x20is\x20already\x20up\x20to\x20date','All\x20bots\x20running\x20right\x20now','binary','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','place-order','files','fork','join','getUTCHours','blacklist','/:bot/support','/enable\x20-\x20enable\x20notifications\x0a','pidRefreshToken','0.0.0','2FA\x20login\x20token\x20generated','bbPassword','entries','lastmsgemitted','exit','/start','bcryptjs','log','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','-performance.json','production','decrypt','bb/','sendPortfolioTelegram','headless','-events.json','bot','-----------------------------------------------------------------------------------','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','replace','uuid-random','size','Idling\x20(','decode64','get-messages','request','cancelLoading','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','/:bot/portfolio','from','ETH','event','No\x20authentication\x20token','readFileSync','telegramEvents','Notifications\x20enabled\x0a','reply','listen','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','toggle-bot-mode','Bot\x20','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','handshake','get-backup-files','https://api.ipify.org?format=json','\x1b[35m','clients','reinstall','format','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Ok,\x20will\x20send\x20alert\x20notifications\x20only','password','-config.json','push','update_yes','existsSync','Logged\x20in\x20user\x20...','login\x20token\x20generated','invalid\x20credentials','hex','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','CoinMarketCap\x20API\x20key\x20validated','Restore\x20backup\x20file\x20','path','publicKey','/status\x20-\x20show\x20bot(s)\x20status\x0a','reset-history','All\x20bots','userid','initclient','/upload-backup','accept','conn','min','Running\x20#RED#Balance\x20Bot\x20v','map','callback','yes','hasOwnProperty','SIGTERM','reinstall_yes','Unauthorized\x20attempt\x20to\x20log\x20out','enable','\x1b[36m','getDate','expiry','HTML','file','store-settings','login\x20token\x20valid','Network\x20Interfaces:','telegram','kill','13190070RkRVuv','*$1*','secret','function','config_all','randomFillSync','connected','RSA-OAEP','telegramChatId','storeConfiguration',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','off','max','update-bb','family','Error\x20details:','privateKeyFromPem','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','telegram2FaApproval','#RES#\x20if\x20running\x20locally\x0a','15\x20min','store-fiat','filter','confirm-message','temporary\x20access\x20not\x20allowed','restart_','timestamp','mkdirSync','sign','message','action','use','versions','whitelistEnabled','status\x20code\x20401','clientip','whitelist','lowdb','output-002.log','Error\x20removing\x20old\x20backup\x20files:','delete-bot','telegramIpApproval',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','pidExpireLogin','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','environment','tkn','verify','telegramEnabled','version.json','backupfile','backup-full','get-logs','<b>Balance\x20Bot\x20Status:</b>\x0a','once','replyWithDocument','logs/','\x1b[34m','access','mode','f2aRequired','build','reject','store-headless','lastmsgtelegram','logs','getMonth','status','backup','::1','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','No\x20bots\x20running\x20right\x20now','bot-','express','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','login2fa_','SIGINT','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','DEFLATE','privateKey','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','reinstall-bb','auto','download','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','_nsps','Setting\x20access:\x20','getPortfolio','new','forEach','test','\x1b[0m','Unauthorized\x20attempt\x20to\x20delete\x20bot','Unauthorized\x20attempt\x20to\x20confirm\x20message','apiPassword','static','stringify','graphql-request','assign','getMinutes','store-configuration','alerts','\x20|\x20client:\x20...','api-eu.mixpanel.com','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','inherit','/restart\x20-\x20restart\x20bot(s)\x0a','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','range','cancel-loading','delete-alerts','readdirSync','help','set','chat','sha256','Starting\x20(','/:bot/history','button','\x20to\x20','getFullYear','port','432RvcgwC','uncaughtException','createWriteStream','store','jszip','output-000.log','defaults','bb-secure.json','temporary\x20access\x20rejected','1000','search','onepagemode','rsa','Invalid\x20authentication\x20token\x20(2)','track','botname','bbvNew','/backup\x20-\x20receive\x20backup\x20files\x0a','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','1893xnVqGk','Enabled\x20Bot\x20','init','update','padStart','value','match','exp','remoteAddress','output-003.log','5\x20min','Ok,\x20will\x20send\x20order\x20notifications\x20only','startsWith','Restore\x20process\x20aborted','Unauthorized\x20attempt\x20to\x20get\x20messages','\x20|\x20user:\x20...','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','generateAsync','number','bot.js','start','2026050mUWkZJ','resetHistory','auth','latestversion','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','timeshift','#RES#\x20','Telegraf\x20error:','slice','getStartingBalances','apiKey','remove','new-disabled','any','tempaccess_30_','disable','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','\x20|\x20','publicKeyToPem','staging','toggle','backup-full@','bbUsername','output-001.log','config/','lowdb/adapters/FileSync','showConfig','restore_no_','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','resetpw_no','4177467FXtoUE','resetpw_yes','debug','close','loadAsync','headers','temporary\x20access\x20timeout','secure','writeFileSync','portfolio','keys','toIPv4Address','address','Unauthorized\x20attempt\x20to\x20show\x20configuration','apiSecret','http','************','private','split','Notifications\x20types:\x20','$1_$2_$3','unlinkSync','all','Markdown','bb-settings.json','login','Disabled\x20Bot\x20','inlineKeyboard','get-portfolio','add','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','parse','toIPv4MappedAddress','express-fileupload',')\x20\x20\x20|\x20Bot\x20','index.html','Unauthorized\x20attempt\x20to\x20download\x20','Notifications\x20enabled','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','temporary\x20token\x20generated','Starting\x20#RED#Balance\x20Bot\x20v','|@|','Deleted\x20Bot\x20','Access\x20enabled\x20for\x20','simple','tempaccess_5_','logout','***','--------------------------------------','Error\x20sending\x20','command','File\x20uploaded','Server','loginRequired','find','sort','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','removeAllListeners','includes','settings.','backup-full.zip','storeHeadless','exec','ipc','version','getHours','toString','6597tHNqVB','Restore\x20process\x20confirmed','Unauthorized\x20attempt\x20to\x20update\x20bot','type','Unauthorized\x20attempt\x20to\x20add\x20bot','error',',\x20must\x20be\x20a\x204\x20digit\x20number','-results.json','rmSync','sockets','bbvReceive','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','/names\x20-\x20show\x20bot\x20names\x0a','reload','args','show-config','messages','getTime','stopped','6b67f3d61ee94b8f5c80b4affef4c4d9','Yes','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','text','success','sortBy','pki','restart','Login\x20rejected','code','914enUWnH','login\x20not\x20required','Alerts','isDirectory','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','settings','reason','sendMetricsTelegram','zip/','telegramUsername','Backup\x20file\x20unzipped\x20and\x20stored','portfolio_','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','hashSync','metrics','Session\x20expired\x20for\x20user\x20...','383904qMNdie','kind','Invalid\x20IP\x20address','6FTBSqg','Temporary\x20access\x20rejected','emit','username'];_0x4332=function(){return _0x1b18b9;};return _0x4332();}const saltRounds=0xa,mixpanel=Mixpanel[_0x454ffa(0x246)](_0x454ffa(0x2ce),{'host':_0x454ffa(0x21c)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x454ffa(0x305)]!=''&&settings[_0x454ffa(0x305)]!=_0x454ffa(0x2a7))&&settings[_0x454ffa(0x2e1)]&&settings[_0x454ffa(0x2e1)]!='')initTelegram();const parseColor=(_0xca3b56,_0x272146)=>{const _0x44fddc=_0x454ffa,_0x4bba04=/#[A-Z]{3}#/g;if(typeof _0xca3b56==_0x44fddc(0x329)){!_0x272146?_0xca3b56=_0xca3b56[_0x44fddc(0x376)](_0x4bba04,''):(_0xca3b56=_0xca3b56[_0x44fddc(0x376)](/#BLU#/g,_0x44fddc(0x1ee)),_0xca3b56=_0xca3b56[_0x44fddc(0x376)](/#RED#/g,_0x44fddc(0x32f)),_0xca3b56=_0xca3b56['replace'](/#YEL#/g,'\x1b[33m'),_0xca3b56=_0xca3b56['replace'](/#MAG#/g,_0x44fddc(0x390)),_0xca3b56=_0xca3b56[_0x44fddc(0x376)](/#CYA#/g,_0x44fddc(0x1ab)),_0xca3b56=_0xca3b56[_0x44fddc(0x376)](/#RES#/g,_0x44fddc(0x210)));;}return _0xca3b56;},logger={'screen':_0xba4047=>{const _0xc501e4=_0x454ffa;console[_0xc501e4(0x369)](parseColor(_0xba4047,!![]));},'simple':_0x4ae09e=>{const _0xc82fcd=_0x454ffa;console['log'](parseColor(_0x4ae09e,!![])),loggerfile['write'](util[_0xc82fcd(0x393)](parseColor(_0x4ae09e,![]))+'\x0a');},'full':async _0x1c34fe=>{const _0x455825=_0x454ffa,_0x410996=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x1c34fe;console[_0x455825(0x369)](parseColor(_0x410996,!![])),loggerfile['write'](util[_0x455825(0x393)](parseColor(_0x410996,![]))+'\x0a');if(tgBot&&settings[_0x455825(0x1bd)]&&settings[_0x455825(0x385)]!='orders')await sendTelegram(settings[_0x455825(0x1bd)],_0x455825(0x2fa)+parseColor(_0x1c34fe,![]));},'debug':async(_0x44ac0f,_0x30748c='')=>{const _0x130a08=_0x454ffa,_0x386d4c=getTimeStamp()+_0x130a08(0x1bf)+_0x44ac0f;if(debugging)console['log'](parseColor(_0x386d4c,!![]));loggerfile[_0x130a08(0x308)](util['format'](parseColor(_0x386d4c,![]))+'\x0a');if(_0x30748c){if(debugging)console['log'](_0x30748c);loggerfile['write'](util['format'](_0x30748c)+'\x0a');}}};let terminating=![];process['on'](_0x454ffa(0x230),function(_0x32e7bc){const _0x1ff40b=_0x454ffa;_0x32e7bc['toString']()['includes']('address\x20already\x20in\x20use')?(logger[_0x1ff40b(0x2a4)](_0x1ff40b(0x2d0)+_0x32e7bc[_0x1ff40b(0x22e)]+'#RES#'),process['send']({'terminate':!![]},_0x4ebb0c=>{})):logger['simple'](_0x32e7bc);}),process['on'](_0x454ffa(0x366),()=>{const _0x5adfa4=_0x454ffa;stopAllBots(),process[_0x5adfa4(0x366)](0x0);}),process['on'](_0x454ffa(0x1a7),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x454ffa(0x201),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x454ffa(0x2b8)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x454ffa(0x1fe)),app=express(),http=require(_0x454ffa(0x287))[_0x454ffa(0x346)](app);app[_0x454ffa(0x1d4)](fileUpload({'useTempFiles':!![]})),app['get'](_0x454ffa(0x307),async(_0x2dd4b9,_0x31c662)=>{const _0x4bd1b7=_0x454ffa,_0x3c190f=_0x2dd4b9['params'][_0x4bd1b7(0x2be)],_0x386493=getClientsWithBotID(_0x4bd1b7(0x33b)),_0x24c32c=_0x2dd4b9[_0x4bd1b7(0x27d)][_0x4bd1b7(0x33e)],_0x1234c4=timelyDecrypt(_0x24c32c,![]),_0x3f540e=_0x386493[_0x4bd1b7(0x2ae)](_0x247436=>_0x247436[_0x4bd1b7(0x33e)]==_0x1234c4);if(_0x3f540e){const _0x21e6bf=normalizeIP(_0x2dd4b9['socket']['remoteAddress'])['store'],_0x26a60d=_0x2dd4b9[_0x4bd1b7(0x27d)]['tkn'];if(validateAccess(_0x26a60d,_0x1234c4,_0x21e6bf)[_0x4bd1b7(0x32e)])_0x3c190f==_0x4bd1b7(0x1f9)&&await backupConfigFiles(),await zipFiles(_0x3c190f),_0x31c662[_0x4bd1b7(0x208)](zippath+(_0x3c190f+'.zip'),_0x59ecff=>{const _0x5c380d=_0x4bd1b7;_0x59ecff&&(logger[_0x5c380d(0x30d)]('Failed\x20to\x20download\x20'+_0x3c190f),logger['simple'](_0x59ecff));});else logger['full'](_0x4bd1b7(0x29c)+_0x3c190f+'\x20(1)');}else logger['full'](_0x4bd1b7(0x29c)+_0x3c190f+'\x20(2)');}),app['post'](_0x454ffa(0x19e),async(_0x2920c9,_0x3c8b49)=>{const _0x1ee896=_0x454ffa,_0x32300b=getClientsWithBotID(_0x1ee896(0x33b)),_0x1c3853=_0x2920c9[_0x1ee896(0x27d)]['uuid'],_0x443a46=timelyDecrypt(_0x1c3853,![]),_0x5593c1=_0x32300b['find'](_0x5d6fe3=>_0x5d6fe3[_0x1ee896(0x33e)]==_0x443a46);logger['debug'](_0x1ee896(0x321));if(_0x5593c1){const _0x1ee3d3=normalizeIP(_0x2920c9['socket']['remoteAddress'])[_0x1ee896(0x232)],_0x5dfccd=_0x2920c9[_0x1ee896(0x27d)][_0x1ee896(0x1e3)];if(validateAccess(_0x5dfccd,_0x443a46,_0x1ee3d3)['allow']){if(_0x2920c9[_0x1ee896(0x359)]){const _0x21a501=_0x2920c9[_0x1ee896(0x359)][_0x1ee896(0x1e7)];await _0x21a501['mv'](temppath+_0x21a501[_0x1ee896(0x30a)]),_0x3c8b49[_0x1ee896(0x333)]({'status':!![],'message':_0x1ee896(0x2ab)});const _0x368ef0=getBotsWithMode();_0x368ef0['length']>0x0?confirmRestore(temppath,_0x21a501['name']):unzipFile(temppath,_0x21a501[_0x1ee896(0x30a)]);}}else logger[_0x1ee896(0x30d)](_0x1ee896(0x34f));}else logger[_0x1ee896(0x30d)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app['use'](express[_0x454ffa(0x214)](path[_0x454ffa(0x35b)](__dirname,bbpath2,'build2'))),app[_0x454ffa(0x1d4)](express['static'](path['join'](__dirname,bbpath2,_0x454ffa(0x1f2)))),app[_0x454ffa(0x30f)]('/',function(_0x1ea7b0,_0x2a7bcb){const _0x2857e5=_0x454ffa;_0x2a7bcb[_0x2857e5(0x31e)](path['join'](__dirname,bbpath2,_0x2857e5(0x339),_0x2857e5(0x29b)));}),app[_0x454ffa(0x30f)](_0x454ffa(0x331),function(_0x4ab89e,_0x3f9f49){const _0x4798d4=_0x454ffa;_0x3f9f49[_0x4798d4(0x31e)](path[_0x4798d4(0x35b)](__dirname,bbpath2,_0x4798d4(0x1f2),_0x4798d4(0x29b)));}),app[_0x454ffa(0x30f)](_0x454ffa(0x37f),(_0x512ca2,_0x39e9c2)=>{const _0x38aaa1=_0x454ffa;_0x39e9c2[_0x38aaa1(0x31e)](path[_0x38aaa1(0x35b)](__dirname,bbpath2,_0x38aaa1(0x1f2),'index.html'));}),app['get'](_0x454ffa(0x322),(_0x43e690,_0x204ba5)=>{const _0x36efd5=_0x454ffa;_0x204ba5[_0x36efd5(0x31e)](path[_0x36efd5(0x35b)](__dirname,bbpath2,_0x36efd5(0x1f2),'index.html'));}),app['get']('/:bot/coins',(_0x5bd24f,_0x2f2457)=>{const _0x389626=_0x454ffa;_0x2f2457[_0x389626(0x31e)](path[_0x389626(0x35b)](__dirname,bbpath2,_0x389626(0x1f2),'index.html'));}),app[_0x454ffa(0x30f)](_0x454ffa(0x22a),(_0xa14200,_0x507f05)=>{const _0x49c269=_0x454ffa;_0x507f05[_0x49c269(0x31e)](path['join'](__dirname,bbpath2,_0x49c269(0x1f2),_0x49c269(0x29b)));}),app[_0x454ffa(0x30f)]('/:bot/configuration',(_0x4cc031,_0x70099c)=>{const _0x33f93c=_0x454ffa;_0x70099c[_0x33f93c(0x31e)](path[_0x33f93c(0x35b)](__dirname,bbpath2,_0x33f93c(0x1f2),_0x33f93c(0x29b)));}),app[_0x454ffa(0x30f)](_0x454ffa(0x35e),(_0x5a5f9b,_0x1535c0)=>{const _0x3ac586=_0x454ffa;_0x1535c0[_0x3ac586(0x31e)](path[_0x3ac586(0x35b)](__dirname,bbpath2,'build',_0x3ac586(0x29b)));});if(HOST)http[_0x454ffa(0x388)](PORT,HOST);else http[_0x454ffa(0x388)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1cf494=_0x454ffa;let _0x33f096=_0x1cf494(0x336);const _0x1ac48f=networkInterfaces(),_0x56d397={};for(const _0x2de5e7 of Object[_0x1cf494(0x282)](_0x1ac48f)){for(const _0x339423 of _0x1ac48f[_0x2de5e7]){if((_0x339423[_0x1cf494(0x1c3)]=='IPv4'||_0x339423[_0x1cf494(0x1c3)]==0x4)&&!_0x339423['internal']){const _0x26bd87=ipaddr[_0x1cf494(0x297)](_0x339423['address'])[_0x1cf494(0x221)]();_0x26bd87!=_0x1cf494(0x289)&&(!_0x56d397[_0x2de5e7]&&(_0x56d397[_0x2de5e7]=[]),_0x56d397[_0x2de5e7][_0x1cf494(0x398)](_0x339423[_0x1cf494(0x284)]),_0x33f096=_0x339423[_0x1cf494(0x284)]);}}}return{'serverip':_0x33f096,'netinterfaces':_0x56d397};}async function startServer(){const _0x143550=_0x454ffa,{serverip:_0x5a024c,netinterfaces:_0x145d8f}=getServerIP();logger[_0x143550(0x2a4)](''),logger[_0x143550(0x2a4)](_0x143550(0x374)),await logger['full'](_0x143550(0x2a0)+serverversion+_0x143550(0x25f)+(environment==_0x143550(0x26d)?_0x143550(0x338):'')+'\x0a'+(_0x143550(0x21d)+PORT+_0x143550(0x1c8))+(_0x143550(0x314)+_0x5a024c+':'+PORT+_0x143550(0x303))),logger[_0x143550(0x2a4)](_0x143550(0x374));if(config['length']!=0x0)for(const _0x18d4ce of config){const _0x1cd076=_0x18d4ce[_0x143550(0x1f0)]==_0x143550(0x207)?'a':'m';if(_0x18d4ce['status']==_0x143550(0x33a)||_0x18d4ce['status']=='new')await logger[_0x143550(0x30d)](_0x143550(0x229)+_0x1cd076+_0x143550(0x320)+_0x18d4ce[_0x143550(0x343)]+'\x20|\x20'+_0x18d4ce[_0x143550(0x23e)]),startBot([_0x18d4ce[_0x143550(0x343)],userID],{'cwd':bbpath},function(_0x117281){const _0xd35d38=_0x143550;if(_0x117281)logger[_0xd35d38(0x30d)](_0x117281);});else(_0x18d4ce[_0x143550(0x1f8)]=='disabled'||_0x18d4ce['status']=='new-disabled')&&await logger[_0x143550(0x30d)](_0x143550(0x379)+_0x1cd076+_0x143550(0x29a)+_0x18d4ce[_0x143550(0x343)]+_0x143550(0x26b)+_0x18d4ce[_0x143550(0x23e)]);}else!newBot&&logger[_0x143550(0x2a4)](_0x143550(0x205));if(newBot)addBot();logger[_0x143550(0x2a4)](_0x143550(0x374)),logger[_0x143550(0x2a4)](''),await logger[_0x143550(0x27a)]('Node.js\x20v'+nodeversion),await logger[_0x143550(0x27a)](_0x143550(0x1b2),_0x145d8f);}function startSocket(){io['on']('connection',_0x212bac=>{const _0x67e687=_0x3362;let _0x42f9a2,_0x568463,_0x48b9d1,_0x12bdcb,_0x5a8b00;const _0x1545ec=_0x212bac[_0x67e687(0x38d)][_0x67e687(0x27d)][_0x67e687(0x2f1)];_0x568463=_0x1545ec['match'](/bot[0-9]{3}/);if(_0x568463)_0x48b9d1=_0x568463[0x0][_0x67e687(0x24a)](/[0-9]{3}/);if(_0x48b9d1)_0x42f9a2=_0x48b9d1[0x0];else _0x42f9a2=_0x67e687(0x33b);const _0xb9bd31=_0x212bac['handshake'][_0x67e687(0x25b)]['encryptedUuid'];if(!_0xb9bd31)_0x212bac[_0x67e687(0x2ed)]('status',{'publicKey':secure['publicKey']});else{_0x12bdcb=timelyDecrypt(_0xb9bd31,![]);if(!_0x12bdcb)_0x212bac[_0x67e687(0x2ed)](_0x67e687(0x1f8),{'publicKey':secure[_0x67e687(0x198)]});else{_0x5a8b00=normalizeIP(_0x212bac[_0x67e687(0x1a0)][_0x67e687(0x24c)])[_0x67e687(0x232)];if(!devices[_0x12bdcb])devices[_0x12bdcb]={'uuid':_0x12bdcb,'access':{'token':null}};devices[_0x12bdcb]['ip']=_0x5a8b00;const _0x546ddd=addClient(_0x212bac['id'],_0x12bdcb,_0x42f9a2);setAccess(_0x546ddd),emitMessages(),_0x212bac['on']('login',_0x3102d4=>{const _0x49c189=_0x67e687,_0x5b339d=timelyDecrypt(_0x3102d4[_0x49c189(0x396)],!![],_0x49c189(0x2a1));if(_0x5b339d){_0x3102d4={'username':_0x3102d4[_0x49c189(0x2ee)],'password':_0x5b339d},devices[_0x12bdcb][_0x49c189(0x1ef)]=validateCredentials(_0x3102d4,_0x12bdcb);if(devices[_0x12bdcb][_0x49c189(0x1ef)][_0x49c189(0x32e)]==![]&&devices[_0x12bdcb][_0x49c189(0x1ef)][_0x49c189(0x2de)]=='2FA\x20login\x20required')_0x212bac[_0x49c189(0x2ed)](_0x49c189(0x1f8),{'access':devices[_0x12bdcb][_0x49c189(0x1ef)]}),loginAccess2FA(_0x12bdcb,_0x5a8b00);else{if(devices[_0x12bdcb][_0x49c189(0x1ef)][_0x49c189(0x32e)]==![]&&devices[_0x12bdcb][_0x49c189(0x1ef)]['reason']==_0x49c189(0x192))_0x212bac['emit'](_0x49c189(0x1f8),{'access':devices[_0x12bdcb][_0x49c189(0x1ef)]});else devices[_0x12bdcb][_0x49c189(0x1ef)][_0x49c189(0x32e)]&&devices[_0x12bdcb][_0x49c189(0x1ef)]['reason']==_0x49c189(0x191)&&(getClientsWithUuid(_0x12bdcb)[_0x49c189(0x20e)](_0x1085f1=>{setAccess(_0x1085f1);}),logger['debug'](_0x49c189(0x39b)+_0x12bdcb['slice'](-0x8)),setTokenRefresh(_0x12bdcb),setSessionTimeout(_0x49c189(0x291),_0x12bdcb));}}else logger[_0x49c189(0x30d)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x212bac['on']('reset-password',()=>{resetPassword();}),_0x212bac['on']('disconnect',_0x5d4d8e=>{removeClient(_0x212bac['id']);}),_0x42f9a2==_0x67e687(0x33b)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x37d2da){const _0x167c8b=_0x454ffa;if(_0x37d2da!=_0x167c8b(0x33b)&&config[_0x167c8b(0x263)]!=''){if(pid[_0x37d2da])pid[_0x37d2da][_0x167c8b(0x333)]({'function':_0x167c8b(0x19d),'args':null});}_0x37d2da!=_0x167c8b(0x33b)&&broadcastToBots('bots',JSON[_0x167c8b(0x215)](config));}function reloadBotManager(){const _0x925dff=_0x454ffa;getClientsWithBotID(_0x925dff(0x33b))['forEach'](_0x54a24c=>{const _0x3cd30e=_0x925dff;getSocket(_0x54a24c['id'])[_0x3cd30e(0x2ed)](_0x3cd30e(0x1f8),{'access':{'allow':![],'reason':_0x3cd30e(0x2c8),'token':null}});});}function getSocket(_0xdbce14){const _0xa9e2f6=_0x454ffa,_0x2ba6f6=io[_0xa9e2f6(0x20a)][_0xa9e2f6(0x30f)]('/');return _0x2ba6f6[_0xa9e2f6(0x2c4)][_0xa9e2f6(0x30f)](_0xdbce14);}function setAccess(_0x64fb49){const _0x54a92d=_0x454ffa,_0x34ea2a=getSocket(_0x64fb49['id']),_0x4d2e49=_0x64fb49['uuid'],_0x2965a5=_0x64fb49[_0x54a92d(0x373)];devices[_0x4d2e49]['access']=validateAccess(devices[_0x4d2e49][_0x54a92d(0x1ef)][_0x54a92d(0x2ff)],_0x4d2e49),logger[_0x54a92d(0x27a)](_0x54a92d(0x20b)+devices[_0x4d2e49][_0x54a92d(0x1ef)][_0x54a92d(0x2de)]+_0x54a92d(0x21b)+_0x64fb49['id'][_0x54a92d(0x261)](-0x8)+_0x54a92d(0x253)+_0x4d2e49['slice'](-0x8)),_0x34ea2a[_0x54a92d(0x35b)](_0x4d2e49);if(devices[_0x4d2e49][_0x54a92d(0x1ef)][_0x54a92d(0x32e)]){_0x34ea2a[_0x54a92d(0x35b)](_0x2965a5);if(_0x2965a5==_0x54a92d(0x33b))initializeSocketBotManager(_0x34ea2a);else initializeSocketBot(_0x34ea2a);initClient(_0x2965a5);}devices[_0x4d2e49][_0x54a92d(0x1ef)][_0x54a92d(0x2ff)]&&devices[_0x4d2e49][_0x54a92d(0x1ef)][_0x54a92d(0x2de)]=='temporary\x20token\x20generated'&&setSessionTimeout('2FA',_0x4d2e49),devices[_0x4d2e49][_0x54a92d(0x1ef)][_0x54a92d(0x2ff)]&&devices[_0x4d2e49][_0x54a92d(0x1ef)][_0x54a92d(0x2de)]==_0x54a92d(0x362)&&setSessionTimeout('login',_0x4d2e49),_0x34ea2a['emit']('status',{'status':_0x64fb49[_0x54a92d(0x353)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4d2e49]['access'],'externalip':devices[_0x4d2e49]['ip'],'publicKey':secure[_0x54a92d(0x198)],'userid':settings[_0x54a92d(0x19c)],'validInstallation':validInstallation}),devices[_0x4d2e49]['access'][_0x54a92d(0x32e)]==![]&&devices[_0x4d2e49]['access']['reason']=='2FA\x20required'&&temporaryAccess2FA(_0x4d2e49,devices[_0x4d2e49]['ip']);}function setSessionTimeout(_0x51b6f3,_0x10147c){const _0x5570df=_0x454ffa;let _0x4c84e6;if(_0x51b6f3==_0x5570df(0x291))_0x4c84e6=loginExpiry*0x3c*0x3e8;else _0x4c84e6=devices[_0x10147c][_0x5570df(0x1de)][_0x5570df(0x1ad)]*0x3c*0x3e8-(new Date()[_0x5570df(0x2cc)]()-devices[_0x10147c][_0x5570df(0x1de)][_0x5570df(0x1cf)]);if(devices[_0x10147c][_0x5570df(0x1e0)])clearTimeout(devices[_0x10147c][_0x5570df(0x1e0)]);devices[_0x10147c][_0x5570df(0x1e0)]=setTimeout(()=>{const _0x1edb81=_0x5570df;if(devices[_0x10147c]['pidRefreshToken'])clearTimeout(devices[_0x10147c][_0x1edb81(0x360)]);removeSocketListeners(_0x10147c),addBlacklist(_0x10147c),devices[_0x10147c][_0x1edb81(0x1de)]=null,devices[_0x10147c][_0x1edb81(0x1c7)]=null,devices[_0x10147c]['access']['token']=null,logger['debug'](_0x1edb81(0x2e7)+_0x10147c[_0x1edb81(0x261)](-0x8)),devices[_0x10147c][_0x1edb81(0x1ef)]=validateAccess(devices[_0x10147c][_0x1edb81(0x1ef)][_0x1edb81(0x2ff)],_0x10147c),!(devices[_0x10147c][_0x1edb81(0x1ef)]['allow']&&devices[_0x10147c]['access'][_0x1edb81(0x2de)]==_0x1edb81(0x2d9))&&(_0x51b6f3==_0x1edb81(0x291)?io['to'](_0x10147c)[_0x1edb81(0x2ed)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x10147c)[_0x1edb81(0x2ed)](_0x1edb81(0x1f8),{'access':{'allow':![],'reason':_0x1edb81(0x27e),'token':null}})),devices[_0x10147c][_0x1edb81(0x1ef)]['token']=null;},_0x4c84e6);}function setTokenRefresh(_0x35611e){const _0xe8ce3b=_0x454ffa;if(devices[_0x35611e][_0xe8ce3b(0x360)])clearTimeout(devices[_0x35611e][_0xe8ce3b(0x360)]);devices[_0x35611e]['pidRefreshToken']=setTimeout(()=>{const _0x3ea213=_0xe8ce3b;getClientsWithUuid(_0x35611e)['length']!=0x0?(devices[_0x35611e][_0x3ea213(0x1ef)]=refreshToken(_0x35611e),io['to'](_0x35611e)[_0x3ea213(0x2ed)](_0x3ea213(0x1f8),{'status':_0x3ea213(0x1bb),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x35611e]['access'],'externalip':devices[_0x35611e]['ip'],'publicKey':secure[_0x3ea213(0x198)],'validInstallation':validInstallation}),setTokenRefresh(_0x35611e)):clearTimeout(devices[_0x35611e]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x5c58f2){const _0x55ff73=_0x454ffa,_0xa2fa47=getClient(_0x5c58f2['id'])[_0x55ff73(0x33e)];_0x5c58f2[_0x55ff73(0x2ed)](_0x55ff73(0x31d),config),_0x5c58f2[_0x55ff73(0x2ed)](_0x55ff73(0x2dd),cleanSettings()),_0x5c58f2['on'](_0x55ff73(0x2f5),_0x10c835=>{const _0x3c81ff=_0x55ff73;if(validateAccess(_0x10c835,_0xa2fa47)[_0x3c81ff(0x32e)])addBot();else logger[_0x3c81ff(0x30d)](_0x3c81ff(0x2bf));}),_0x5c58f2['on']('update-bot',(_0x3cd947,_0x51c044)=>{const _0x7d7eaa=_0x55ff73;if(validateAccess(_0x51c044,_0xa2fa47)[_0x7d7eaa(0x32e)])toggleBot(_0x3cd947[_0x7d7eaa(0x343)],_0x3cd947[_0x7d7eaa(0x1f8)],_0x3cd947['live']);else logger[_0x7d7eaa(0x30d)](_0x7d7eaa(0x2bd));}),_0x5c58f2['on'](_0x55ff73(0x38a),(_0x51531e,_0x12bc94)=>{const _0xe93a38=_0x55ff73;if(validateAccess(_0x12bc94,_0xa2fa47)[_0xe93a38(0x32e)])toggleBotMode(_0x51531e);else logger[_0xe93a38(0x30d)](_0xe93a38(0x2bd));}),_0x5c58f2['on'](_0x55ff73(0x1dd),(_0x4e8a67,_0x3c8cec)=>{const _0x41599c=_0x55ff73;if(validateAccess(_0x3c8cec,_0xa2fa47)[_0x41599c(0x32e)])deleteBot(_0x4e8a67);else logger[_0x41599c(0x30d)](_0x41599c(0x211));}),_0x5c58f2['on'](_0x55ff73(0x1b0),(_0x1e9876,_0x59d3ff)=>{const _0x33e680=_0x55ff73;if(validateAccess(_0x59d3ff,_0xa2fa47)[_0x33e680(0x32e)])storeSettings(_0x1e9876,!![]);else logger[_0x33e680(0x30d)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x5c58f2['on'](_0x55ff73(0x1c2),_0xf0f2f0=>{const _0x30e9f0=_0x55ff73;if(validateAccess(_0xf0f2f0,_0xa2fa47)[_0x30e9f0(0x32e)])updateBB(_0x30e9f0(0x247));else logger[_0x30e9f0(0x30d)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x5c58f2['on'](_0x55ff73(0x206),_0x22486d=>{const _0x398577=_0x55ff73;if(validateAccess(_0x22486d,_0xa2fa47)[_0x398577(0x32e)])updateBB('reinstall');else logger[_0x398577(0x30d)](_0x398577(0x2b0));}),_0x5c58f2['on'](_0x55ff73(0x38e),_0x4d7ea5=>{const _0x2e4267=_0x55ff73;if(validateAccess(_0x4d7ea5,_0xa2fa47)['allow']){const _0x3d7130=getClient(_0x5c58f2['id']);if(_0x3d7130)getBackupFiles(_0x3d7130['uuid']);else logger[_0x2e4267(0x30d)](_0x2e4267(0x2f9));}else logger[_0x2e4267(0x30d)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x5c58f2['on'](_0x55ff73(0x2f3),(_0x450bb7,_0x368af9)=>{const _0x11b784=_0x55ff73;if(validateAccess(_0x368af9,_0xa2fa47)['allow'])restoreBackupFile(_0x450bb7);else logger[_0x11b784(0x30d)](_0x11b784(0x194));}),_0x5c58f2['on'](_0x55ff73(0x37b),_0x510d5e=>{const _0x4c16df=_0x55ff73;if(validateAccess(_0x510d5e,_0xa2fa47)['allow'])getMessages();else logger[_0x4c16df(0x30d)](_0x4c16df(0x252));}),_0x5c58f2['on'](_0x55ff73(0x1cc),(_0x537750,_0x8f341c)=>{const _0x3065d9=_0x55ff73;if(validateAccess(_0x8f341c,_0xa2fa47)[_0x3065d9(0x32e)])confirmMessage(_0x537750);else logger['full'](_0x3065d9(0x212));}),_0x5c58f2['on'](_0x55ff73(0x2a6),_0x146fce=>{const _0x37ae28=_0x55ff73;if(validateAccess(_0x146fce,_0xa2fa47)['allow']){if(devices[_0xa2fa47][_0x37ae28(0x360)])clearTimeout(devices[_0xa2fa47][_0x37ae28(0x360)]);if(devices[_0xa2fa47][_0x37ae28(0x1e0)])clearTimeout(devices[_0xa2fa47][_0x37ae28(0x1e0)]);removeSocketListeners(getClient(_0x5c58f2['id'])['uuid']),addBlacklist(_0xa2fa47),devices[_0xa2fa47]['telegramIpApproval']=null,devices[_0xa2fa47][_0x37ae28(0x1c7)]=null,devices[_0xa2fa47][_0x37ae28(0x1ef)][_0x37ae28(0x2ff)]=null,logger[_0x37ae28(0x27a)](_0x37ae28(0x30c)+_0xa2fa47[_0x37ae28(0x261)](-0x8)),io['to'](getClient(_0x5c58f2['id'])[_0x37ae28(0x33e)])[_0x37ae28(0x2ed)](_0x37ae28(0x1f8),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x37ae28(0x30d)](_0x37ae28(0x1a9));});}function initializeSocketBot(_0x46efd2){const _0x4d30e0=_0x454ffa,_0x5aa54e=getClient(_0x46efd2['id'])[_0x4d30e0(0x373)],_0x2cc11a=getClient(_0x46efd2['id'])[_0x4d30e0(0x33e)];_0x46efd2['on'](_0x4d30e0(0x1e9),(_0x2ec93e,_0x158597)=>{const _0x1ef5ee=_0x4d30e0;if(validateAccess(_0x158597,_0x2cc11a)[_0x1ef5ee(0x32e)]){if(pid[_0x5aa54e])pid[_0x5aa54e][_0x1ef5ee(0x333)]({'function':'emitHistory','args':_0x2ec93e});}else logger[_0x1ef5ee(0x30d)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x46efd2['on'](_0x4d30e0(0x223),(_0x41901a,_0xd06f5e)=>{const _0x47843f=_0x4d30e0;if(validateAccess(_0xd06f5e,_0x2cc11a)[_0x47843f(0x32e)]){if(pid[_0x5aa54e])pid[_0x5aa54e]['send']({'function':'deleteHistoryAlerts','args':_0x41901a});}else logger[_0x47843f(0x30d)](_0x47843f(0x348));}),_0x46efd2['on'](_0x4d30e0(0x294),(_0x4c9695,_0x41ad7e)=>{const _0x2a12ce=_0x4d30e0;if(validateAccess(_0x41ad7e,_0x2cc11a)['allow']){if(pid[_0x5aa54e])pid[_0x5aa54e][_0x2a12ce(0x333)]({'function':_0x2a12ce(0x20c),'args':_0x4c9695});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x46efd2['on'](_0x4d30e0(0x219),(_0x451bf9,_0x17a479)=>{const _0x386fe1=_0x4d30e0;if(validateAccess(_0x17a479,_0x2cc11a)[_0x386fe1(0x32e)]){if(pid[_0x5aa54e])pid[_0x5aa54e][_0x386fe1(0x333)]({'function':_0x386fe1(0x1be),'args':_0x451bf9});}else logger[_0x386fe1(0x30d)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x46efd2['on'](_0x4d30e0(0x1f4),(_0x52dc9d,_0xcbb3c7)=>{const _0x315892=_0x4d30e0;if(validateAccess(_0xcbb3c7,_0x2cc11a)[_0x315892(0x32e)]){if(pid[_0x5aa54e])pid[_0x5aa54e][_0x315892(0x333)]({'function':_0x315892(0x2b5),'args':_0x52dc9d});}else logger[_0x315892(0x30d)](_0x315892(0x394));}),_0x46efd2['on'](_0x4d30e0(0x1ca),(_0x4f683e,_0x4e3d7d)=>{const _0x5a2e89=_0x4d30e0;if(validateAccess(_0x4e3d7d,_0x2cc11a)[_0x5a2e89(0x32e)]){if(pid[_0x5aa54e])pid[_0x5aa54e][_0x5a2e89(0x333)]({'function':'storeFiat','args':_0x4f683e});}else logger[_0x5a2e89(0x30d)](_0x5a2e89(0x332));}),_0x46efd2['on'](_0x4d30e0(0x19a),_0x18ff87=>{const _0x493bc1=_0x4d30e0;if(validateAccess(_0x18ff87,_0x2cc11a)[_0x493bc1(0x32e)]){if(pid[_0x5aa54e])pid[_0x5aa54e][_0x493bc1(0x333)]({'function':_0x493bc1(0x25a),'args':null});}else logger[_0x493bc1(0x30d)](_0x493bc1(0x276));}),_0x46efd2['on']('get-starting-balances',_0xfe27f8=>{const _0x4375bf=_0x4d30e0;if(validateAccess(_0xfe27f8,_0x2cc11a)[_0x4375bf(0x32e)]){if(pid[_0x5aa54e])pid[_0x5aa54e]['send']({'function':_0x4375bf(0x262),'args':null});}else logger[_0x4375bf(0x30d)](_0x4375bf(0x26a));}),_0x46efd2['on'](_0x4d30e0(0x358),(_0x29f0de,_0x4b7b62)=>{const _0x41e505=_0x4d30e0;if(validateAccess(_0x4b7b62,_0x2cc11a)[_0x41e505(0x32e)]){if(pid[_0x5aa54e])pid[_0x5aa54e][_0x41e505(0x333)]({'function':_0x41e505(0x33d),'args':_0x29f0de});}else logger['full'](_0x41e505(0x352));}),_0x46efd2['on'](_0x4d30e0(0x222),_0x58d4ec=>{const _0x30cf6a=_0x4d30e0;if(validateAccess(_0x58d4ec,_0x2cc11a)['allow']){if(pid[_0x5aa54e])pid[_0x5aa54e][_0x30cf6a(0x333)]({'function':_0x30cf6a(0x37d),'args':null});}else logger['full'](_0x30cf6a(0x37e));}),_0x46efd2['on'](_0x4d30e0(0x2ca),_0x4571c2=>{const _0x2163ba=_0x4d30e0;if(validateAccess(_0x4571c2,_0x2cc11a)[_0x2163ba(0x32e)]){if(pid[_0x5aa54e])pid[_0x5aa54e][_0x2163ba(0x333)]({'function':_0x2163ba(0x274),'args':null});}else logger['full'](_0x2163ba(0x285));}),_0x46efd2['on']('update-bb',_0x21c1e6=>{const _0x4d31d3=_0x4d30e0;if(validateAccess(_0x21c1e6,_0x2cc11a)['allow'])updateBB(_0x4d31d3(0x247));else logger['full'](_0x4d31d3(0x1c6));}),_0x46efd2['on'](_0x4d30e0(0x37b),_0x2fe57a=>{const _0x3300bb=_0x4d30e0;if(validateAccess(_0x2fe57a,_0x2cc11a)[_0x3300bb(0x32e)])getMessages();else logger[_0x3300bb(0x30d)](_0x3300bb(0x252));}),_0x46efd2['on']('confirm-message',(_0xc9adbb,_0x42401a)=>{const _0x501803=_0x4d30e0;if(validateAccess(_0x42401a,_0x2cc11a)[_0x501803(0x32e)])confirmMessage(_0xc9adbb);else logger[_0x501803(0x30d)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x46efd2['on'](_0x4d30e0(0x2a6),_0x18755a=>{const _0x2bec64=_0x4d30e0;if(validateAccess(_0x18755a,_0x2cc11a)[_0x2bec64(0x32e)]){if(devices[_0x2cc11a][_0x2bec64(0x360)])clearTimeout(devices[_0x2cc11a][_0x2bec64(0x360)]);if(devices[_0x2cc11a][_0x2bec64(0x1e0)])clearTimeout(devices[_0x2cc11a][_0x2bec64(0x1e0)]);removeSocketListeners(getClient(_0x46efd2['id'])[_0x2bec64(0x33e)]),addBlacklist(_0x2cc11a),devices[_0x2cc11a][_0x2bec64(0x1de)]=null,devices[_0x2cc11a][_0x2bec64(0x1c7)]=null,devices[_0x2cc11a][_0x2bec64(0x1ef)][_0x2bec64(0x2ff)]=null,logger[_0x2bec64(0x27a)](_0x2bec64(0x30c)+_0x2cc11a[_0x2bec64(0x261)](-0x8)),io['to'](getClient(_0x46efd2['id'])[_0x2bec64(0x33e)])[_0x2bec64(0x2ed)](_0x2bec64(0x1f8),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x8276d0){getClientsWithUuid(_0x8276d0)['forEach'](_0x43f27c=>{const _0x24e4dd=_0x3362;getSocket(_0x43f27c['id'])[_0x24e4dd(0x2b1)]();});}function cleanSettings(){const _0x4cd8b6=_0x454ffa;let _0x106535=settings;return settings[_0x4cd8b6(0x305)]&&settings['telegramToken']!=''&&(_0x106535={..._0x106535,'telegramToken':_0x4cd8b6(0x288)}),settings['bbPassword']&&settings[_0x4cd8b6(0x363)]!=''&&(_0x106535={..._0x106535,'bbPassword':'************'}),settings[_0x4cd8b6(0x319)]&&settings[_0x4cd8b6(0x319)]!=''&&(_0x106535={..._0x106535,'marketcapApi':_0x4cd8b6(0x288)}),(settings['bbPassword']&&settings[_0x4cd8b6(0x363)]=='***'||settings[_0x4cd8b6(0x305)]&&settings[_0x4cd8b6(0x305)]=='***'||settings[_0x4cd8b6(0x319)]&&settings[_0x4cd8b6(0x319)]==_0x4cd8b6(0x2a7))&&(_0x106535={..._0x106535,'restored':{'password':settings[_0x4cd8b6(0x363)]=='***','telegram':settings[_0x4cd8b6(0x305)]=='***','marketcap':settings[_0x4cd8b6(0x319)]==_0x4cd8b6(0x2a7)}}),_0x106535;}async function updateBB(_0x4ef85){const _0x3c91d2=_0x454ffa;await backupConfigFiles(),installingUpdate=!![],config[_0x3c91d2(0x20e)](_0xe26101=>{const _0x1ba7f2=_0x3c91d2;restartBot(_0xe26101[_0x1ba7f2(0x343)]);});if(_0x4ef85==_0x3c91d2(0x247))process[_0x3c91d2(0x333)]({'update':!![],'environment':environment},_0x791b4b=>{});else _0x4ef85==_0x3c91d2(0x392)&&process[_0x3c91d2(0x333)]({'reinstall':!![],'environment':environment},_0x1bb84e=>{});}function startBot(_0xc1d670,_0x15c216,_0x1a319b){const _0x443402=_0x454ffa;if(debugging)_0xc1d670[_0x443402(0x398)]('-d');if(recreate)_0xc1d670[_0x443402(0x398)]('-r');let _0x13b1be=![];const _0x463dc5=_0xc1d670[0x0];_0x15c216={..._0x15c216,'stdio':[_0x443402(0x21e),_0x443402(0x21e),_0x443402(0x21e),_0x443402(0x2b7)]},pid[_0x463dc5]=childProcess[_0x443402(0x35a)](botfile,_0xc1d670,_0x15c216),pid[_0x463dc5]['on'](_0x443402(0x1d2),_0x1c60a6=>{const _0x4f5ee3=_0x443402;switch(Object[_0x4f5ee3(0x282)](_0x1c60a6)[0x0]){case _0x4f5ee3(0x23e):updateBotName(_0x463dc5,_0x1c60a6[_0x4f5ee3(0x23e)]);break;case'updatebotmanager':updateBotManager();break;case _0x4f5ee3(0x1f8):updateStatus(_0x463dc5,_0x1c60a6[_0x4f5ee3(0x1f8)]);break;case'live':updateLive(_0x463dc5,_0x1c60a6[_0x4f5ee3(0x31f)]);break;case _0x4f5ee3(0x315):updateLive(_0x463dc5,_0x1c60a6[_0x4f5ee3(0x315)]),io['to'](_0x463dc5)[_0x4f5ee3(0x2ed)](_0x4f5ee3(0x1f8),{'access':{'allow':![],'reason':_0x4f5ee3(0x2c8),'token':null}});break;case _0x4f5ee3(0x334):_0x1c60a6[_0x4f5ee3(0x334)]=='restart'&&restartBot(_0x463dc5);_0x1c60a6[_0x4f5ee3(0x334)]==_0x4f5ee3(0x1b4)&&toggleBot(_0x463dc5,_0x4f5ee3(0x342),_0x4f5ee3(0x2cd));break;case _0x4f5ee3(0x1b3):sendTelegramBot(_0x463dc5,_0x1c60a6[_0x4f5ee3(0x1b3)]);break;case'telegrammsg':sendTelegramMsg(_0x1c60a6['telegrammsg']);break;case _0x4f5ee3(0x1b8):io['to'](_0x463dc5)[_0x4f5ee3(0x2ed)](_0x1c60a6['function'],_0x1c60a6[_0x4f5ee3(0x2c9)]);break;}}),pid[_0x463dc5]['on'](_0x443402(0x2c0),function(_0x24db69){if(_0x13b1be)return;_0x13b1be=!![],_0x1a319b(_0x24db69);}),pid[_0x463dc5]['on']('exit',async function(_0x481c4f){const _0x3265db=_0x443402;if(terminating)return;if(installingUpdate){io[_0x3265db(0x27b)]();return;}if(_0x13b1be)return;_0x13b1be=!![],_0x1a319b(null);const _0x6667d8=dbConfig[_0x3265db(0x30f)](_0x3265db(0x31d))['find']({'botID':_0x463dc5})[_0x3265db(0x249)]();_0x6667d8&&(_0x6667d8[_0x3265db(0x1f8)]=='enabled'||_0x6667d8[_0x3265db(0x1f8)]==_0x3265db(0x20d))&&(await sleep(0x3e8),updateLive(_0x463dc5,'stopped'),logger[_0x3265db(0x30d)]('Restarting\x20Bot\x20'+_0x463dc5),startBot([_0x463dc5,userID],{'cwd':bbpath},function(_0x1475f0){const _0xaefd5c=_0x3265db;if(_0x1475f0)logger[_0xaefd5c(0x30d)](_0x1475f0);}));});}function stopBot(_0x204738){const _0x352bb4=_0x454ffa;getClientsWithBotID(_0x204738)[_0x352bb4(0x20e)](_0x4ad1c4=>{const _0x44d5fd=_0x352bb4;getSocket(_0x4ad1c4['id'])[_0x44d5fd(0x318)](!![]),removeClient(_0x4ad1c4['id']);}),pid[_0x204738]&&(pid[_0x204738][_0x352bb4(0x1b4)](),pid[_0x204738]=null);}function stopAllBots(){terminating=!![];const _0x4a7280=getEnabledBots();_0x4a7280['forEach'](_0x5b70a5=>{const _0x4670fa=_0x3362;stopBot(_0x5b70a5[_0x4670fa(0x343)]);});}function restartBot(_0x10077e){const _0x2f2323=_0x454ffa;if(pid[_0x10077e])pid[_0x10077e][_0x2f2323(0x1b4)]();}function addBot(){const _0x37146b=_0x454ffa;let _0x59f7ef;for(let _0xe6096b=0x1;_0xe6096b<0x3e9;_0xe6096b++){_0x59f7ef=_0xe6096b[_0x37146b(0x2ba)]()[_0x37146b(0x248)](0x3,'0');let _0x5504cd=config[_0x37146b(0x2ae)](_0x3a5acc=>_0x3a5acc[_0x37146b(0x343)]==_0x59f7ef);if(!_0x5504cd)break;}if(_0x59f7ef===_0x37146b(0x238)){logger[_0x37146b(0x30d)](_0x37146b(0x2dc));return;}logger['full']('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x59f7ef),dbConfig[_0x37146b(0x30f)]('bots')[_0x37146b(0x398)]({'botID':_0x59f7ef,'botname':_0x37146b(0x38b)+_0x59f7ef,'status':_0x37146b(0x20d),'live':''})['write'](),startBot([_0x59f7ef,userID],{'cwd':bbpath},function(_0x31475a){const _0x244334=_0x37146b;if(_0x31475a)logger[_0x244334(0x30d)](_0x31475a);}),config=getConfiguration(),io['to']('botmanager')[_0x37146b(0x2ed)](_0x37146b(0x31d),config),broadcastToBots(_0x37146b(0x31d),JSON[_0x37146b(0x215)](config));}function deleteBot(_0xc34821){const _0x6e8432=_0x454ffa;getClientsWithBotID(_0xc34821)[_0x6e8432(0x20e)](_0x499158=>{const _0x5c85ac=_0x6e8432;getSocket(_0x499158['id'])[_0x5c85ac(0x318)](!![]),removeClient(_0x499158['id']);}),dbConfig[_0x6e8432(0x30f)](_0x6e8432(0x31d))['remove']({'botID':_0xc34821})[_0x6e8432(0x308)](),logger[_0x6e8432(0x30d)](_0x6e8432(0x2a2)+_0xc34821),stopBot(_0xc34821);try{if(fs['existsSync'](path[_0x6e8432(0x35b)](configpath,'bot-'+_0xc34821+_0x6e8432(0x397))))fs[_0x6e8432(0x28d)](path['join'](configpath,_0x6e8432(0x1fd)+_0xc34821+_0x6e8432(0x397)));if(fs[_0x6e8432(0x39a)](path[_0x6e8432(0x35b)](configpath,_0x6e8432(0x1fd)+_0xc34821+_0x6e8432(0x372))))fs[_0x6e8432(0x28d)](path['join'](configpath,'bot-'+_0xc34821+_0x6e8432(0x372)));if(fs[_0x6e8432(0x39a)](path[_0x6e8432(0x35b)](configpath,'bot-'+_0xc34821+'-performance.json')))fs[_0x6e8432(0x28d)](path[_0x6e8432(0x35b)](configpath,_0x6e8432(0x1fd)+_0xc34821+_0x6e8432(0x36c)));if(fs[_0x6e8432(0x39a)](path[_0x6e8432(0x35b)](configpath,_0x6e8432(0x1fd)+_0xc34821+_0x6e8432(0x2c2))))fs[_0x6e8432(0x28d)](path[_0x6e8432(0x35b)](configpath,_0x6e8432(0x1fd)+_0xc34821+_0x6e8432(0x2c2)));}catch(_0xd5d7c){if(_0xd5d7c)logger[_0x6e8432(0x30d)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0xd5d7c);}config=getConfiguration(),io['to']('botmanager')[_0x6e8432(0x2ed)]('bots',config),broadcastToBots(_0x6e8432(0x31d),JSON[_0x6e8432(0x215)](config));}function toggleBot(_0x1c6d2a,_0x41531d,_0x1cf618){const _0x6d198d=_0x454ffa;dbConfig['get'](_0x6d198d(0x31d))['find']({'botID':_0x1c6d2a})[_0x6d198d(0x217)]({'status':_0x41531d})['assign']({'live':_0x1cf618})['write']();if(_0x41531d=='enabled'||_0x41531d==_0x6d198d(0x20d))logger[_0x6d198d(0x30d)](_0x6d198d(0x245)+_0x1c6d2a),startBot([_0x1c6d2a,userID],{'cwd':bbpath},function(_0x29d51b){const _0x2dbeec=_0x6d198d;if(_0x29d51b)logger[_0x2dbeec(0x30d)](_0x29d51b);});else(_0x41531d=='disabled'||_0x41531d=='new-disabled')&&(logger['full'](_0x6d198d(0x292)+_0x1c6d2a),stopBot(_0x1c6d2a));config=getConfiguration(),io['to'](_0x6d198d(0x33b))[_0x6d198d(0x2ed)]('bots',config),broadcastToBots(_0x6d198d(0x31d),JSON[_0x6d198d(0x215)](config));}function toggleStatus(_0x54c5c5){const _0xee0792=_0x454ffa;let _0x31e7ac=dbConfig[_0xee0792(0x30f)](_0xee0792(0x31d))[_0xee0792(0x2ae)]({'botID':_0x54c5c5})[_0xee0792(0x249)](),_0x306482;if(_0x31e7ac[_0xee0792(0x1f8)]===_0xee0792(0x33a))_0x306482=_0xee0792(0x342);else{if(_0x31e7ac[_0xee0792(0x1f8)]===_0xee0792(0x20d))_0x306482=_0xee0792(0x265);else{if(_0x31e7ac['status']===_0xee0792(0x265))_0x306482=_0xee0792(0x20d);else{if(_0x31e7ac['status']===_0xee0792(0x342))_0x306482=_0xee0792(0x33a);}}}return _0x306482;}function updateStatus(_0x4f7cac,_0x396f11){const _0x1a8a04=_0x454ffa;dbConfig['get'](_0x1a8a04(0x31d))['find']({'botID':_0x4f7cac})[_0x1a8a04(0x217)]({'status':_0x396f11})[_0x1a8a04(0x308)](),config=getConfiguration(),io['to'](_0x1a8a04(0x33b))['emit'](_0x1a8a04(0x31d),config),broadcastToBots(_0x1a8a04(0x31d),JSON[_0x1a8a04(0x215)](config));}function updateLive(_0x5a3329,_0x4651d1){const _0x4837e4=_0x454ffa;dbConfig[_0x4837e4(0x30f)](_0x4837e4(0x31d))[_0x4837e4(0x2ae)]({'botID':_0x5a3329})[_0x4837e4(0x217)]({'live':_0x4651d1})[_0x4837e4(0x308)](),config=getConfiguration(),io['to'](_0x4837e4(0x33b))['emit'](_0x4837e4(0x31d),config),broadcastToBots(_0x4837e4(0x31d),JSON[_0x4837e4(0x215)](config));}function updateBotName(_0x82098d,_0x41557c){const _0x1b7e96=_0x454ffa;dbConfig[_0x1b7e96(0x30f)](_0x1b7e96(0x31d))[_0x1b7e96(0x2ae)]({'botID':_0x82098d})[_0x1b7e96(0x217)]({'botname':_0x41557c})[_0x1b7e96(0x308)](),config=getConfiguration(),io['to'](_0x1b7e96(0x33b))[_0x1b7e96(0x2ed)]('bots',config),broadcastToBots(_0x1b7e96(0x31d),JSON[_0x1b7e96(0x215)](config));}function updateBotManager(){const _0x11fcf4=_0x454ffa;config=getConfiguration(),io['to'](_0x11fcf4(0x33b))['emit'](_0x11fcf4(0x31d),config),broadcastToBots(_0x11fcf4(0x31d),JSON[_0x11fcf4(0x215)](config));}function toggleBotMode(_0x171ef1){const _0x593436=_0x454ffa;if(pid[_0x171ef1])pid[_0x171ef1][_0x593436(0x333)]({'function':'toggleBotMode','args':null});else{const _0x1f39e1=configpath+'bot-'+_0x171ef1+_0x593436(0x397),_0x4fb2d8=fs[_0x593436(0x384)](_0x1f39e1),_0x239eb5=JSON[_0x593436(0x297)](_0x4fb2d8),_0x4cd327=_0x239eb5[_0x593436(0x373)][0x0]['headless'];_0x239eb5['bot'][0x0]['headless']=!_0x4cd327;const _0x395071=JSON[_0x593436(0x215)](_0x239eb5,null,0x2);fs[_0x593436(0x280)](_0x1f39e1,_0x395071),config=getConfiguration(),io['to'](_0x593436(0x33b))['emit']('bots',config),broadcastToBots(_0x593436(0x31d),JSON['stringify'](config));}}function validateTelegram(_0x26dc14){const _0x17d701=_0x454ffa;if(_0x26dc14['from'][_0x17d701(0x2ee)]!=settings['telegramUsername']&&'@'+_0x26dc14[_0x17d701(0x380)][_0x17d701(0x2ee)]!=settings[_0x17d701(0x2e1)]||_0x26dc14['chat']['id']!=settings[_0x17d701(0x1bd)])return sendTelegram(_0x26dc14[_0x17d701(0x227)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x17d701(0x1ae)}),![];return!![];}async function initTelegram(){const _0x519901=_0x454ffa;tgBot&&(await tgBot[_0x519901(0x334)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x519901(0x305)]);let _0xa32409=_0x519901(0x269);_0xa32409+='\x0a',_0xa32409+=_0x519901(0x35f),_0xa32409+=_0x519901(0x312),_0xa32409+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0xa32409+=_0x519901(0x21f),_0xa32409+='/on\x20-\x20start\x20bot(s)\x0a',_0xa32409+=_0x519901(0x30b),_0xa32409+=_0x519901(0x296),_0xa32409+=_0x519901(0x2c7),_0xa32409+=_0x519901(0x199),_0xa32409+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0xa32409+=_0x519901(0x241),_0xa32409+='/logs\x20-\x20receive\x20log\x20files\x0a',_0xa32409+=_0x519901(0x240),_0xa32409+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0xa32409+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0xa32409+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x43487e=_0x519901(0x202);_0x43487e+='\x0a',_0x43487e+=_0xa32409,tgBot['catch']((_0x5de57c,_0xeb88fa)=>{const _0x4ecb27=_0x519901;logger[_0x4ecb27(0x2a4)](getTimeStamp()+_0x4ecb27(0x1df)),logger[_0x4ecb27(0x27a)](_0x4ecb27(0x260),_0x5de57c);}),tgBot[_0x519901(0x1d4)](async(_0x299cb1,_0x36501f)=>{const _0x5d3815=_0x519901;if(settings[_0x5d3815(0x1bd)]||_0x299cb1[_0x5d3815(0x247)][_0x5d3815(0x1d2)][_0x5d3815(0x2d1)]!=_0x5d3815(0x367)){if(!validateTelegram(_0x299cb1))return;}_0x36501f();}),tgBot[_0x519901(0x2aa)](_0x519901(0x258),async _0x3bff7f=>{const _0x24fbf4=_0x519901;if(_0x3bff7f[_0x24fbf4(0x380)]['username']==settings[_0x24fbf4(0x2e1)]||'@'+_0x3bff7f['from'][_0x24fbf4(0x2ee)]==settings[_0x24fbf4(0x2e1)]){if(!settings[_0x24fbf4(0x1bd)])updateSetting(_0x24fbf4(0x1bd),_0x3bff7f['chat']['id']);else{if(!validateTelegram(_0x3bff7f))return;}}else{if(!validateTelegram(_0x3bff7f))return;}updateSetting('telegramEnabled',!![]),await sendTelegram(_0x3bff7f[_0x24fbf4(0x227)]['id'],_0x43487e);}),tgBot[_0x519901(0x2aa)](_0x519901(0x1aa),async _0x592599=>{const _0x30c16e=_0x519901;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x592599[_0x30c16e(0x227)]['id'],_0x30c16e(0x29d));}),tgBot[_0x519901(0x2aa)](_0x519901(0x268),async _0x5e0347=>{const _0xafcca7=_0x519901;await sendTelegram(_0x5e0347['chat']['id'],'Notifications\x20disabled'),updateSetting(_0xafcca7(0x1e5),![]);}),tgBot['command']('config',async _0x3d398c=>{const _0xaf18cc=_0x519901,_0x4b5fe7=Markup[_0xaf18cc(0x293)]([Markup[_0xaf18cc(0x22b)][_0xaf18cc(0x1a4)]('Orders',_0xaf18cc(0x34b)),Markup['button'][_0xaf18cc(0x1a4)](_0xaf18cc(0x2da),_0xaf18cc(0x2f6)),Markup[_0xaf18cc(0x22b)][_0xaf18cc(0x1a4)](_0xaf18cc(0x335),'config_all')]);_0x3d398c[_0xaf18cc(0x387)](_0xaf18cc(0x350),_0x4b5fe7);}),tgBot[_0x519901(0x1d3)](_0x519901(0x34b),async _0x27cd3b=>{const _0x5f27be=_0x519901;_0x27cd3b[_0x5f27be(0x2ef)](),updateSetting(_0x5f27be(0x385),_0x5f27be(0x2fe)),updateSetting(_0x5f27be(0x1e5),!![]),await sendTelegram(_0x27cd3b[_0x5f27be(0x227)]['id'],_0x5f27be(0x24f));}),tgBot[_0x519901(0x1d3)](_0x519901(0x2f6),async _0x55ca3f=>{const _0x1ce0bc=_0x519901;_0x55ca3f[_0x1ce0bc(0x2ef)](),updateSetting('telegramEvents','alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x55ca3f['chat']['id'],_0x1ce0bc(0x395));}),tgBot[_0x519901(0x1d3)](_0x519901(0x1b9),async _0xf035e8=>{const _0x196703=_0x519901;_0xf035e8[_0x196703(0x2ef)](),updateSetting('telegramEvents',_0x196703(0x28e)),updateSetting(_0x196703(0x1e5),!![]),await sendTelegram(_0xf035e8[_0x196703(0x227)]['id'],_0x196703(0x2c6));}),tgBot[_0x519901(0x2aa)](_0x519901(0x1f8),async _0x39ba8c=>{const _0x5f0212=_0x519901,_0xff79d1=getBotsWithMode();let _0xcecd69=_0x5f0212(0x1ea);config[_0x5f0212(0x20e)](_0x248ac0=>{const _0x383508=_0x5f0212,_0x5de150=_0xff79d1['find'](_0x3ab4ac=>_0x3ab4ac['botID']==_0x248ac0[_0x383508(0x343)])[_0x383508(0x1f0)];_0xcecd69+=_0x383508(0x38b)+_0x248ac0[_0x383508(0x343)]+':\x20'+_0x248ac0[_0x383508(0x1f8)]+_0x383508(0x26b)+_0x5de150+_0x383508(0x26b)+_0x248ac0['live']+'\x0a';}),_0xcecd69+='\x0a',_0xcecd69+=_0x5f0212(0x2f8),_0xcecd69+=!settings[_0x5f0212(0x1e5)]?'Notifications\x20disabled\x0a':_0x5f0212(0x386),_0xcecd69+=settings[_0x5f0212(0x1e5)]?settings[_0x5f0212(0x385)]==_0x5f0212(0x28e)?_0x5f0212(0x345):_0x5f0212(0x28b)+settings[_0x5f0212(0x385)]+'\x20only\x0a':'',await sendTelegram(_0x39ba8c[_0x5f0212(0x227)]['id'],_0xcecd69,{'parse_mode':_0x5f0212(0x1ae)});}),tgBot[_0x519901(0x2aa)](_0x519901(0x2d5),async _0x2bc4ce=>{const _0xd05b83=_0x519901,_0x2a5bd2=getEnabledBots();if(_0x2a5bd2[_0xd05b83(0x34c)]==0x0)await sendTelegram(_0x2bc4ce[_0xd05b83(0x227)]['id'],_0xd05b83(0x1fc));else{if(_0x2a5bd2[_0xd05b83(0x34c)]>0x1)_0x2a5bd2[_0xd05b83(0x398)]({'botID':_0xd05b83(0x28e)});let _0x315d2a=[],_0x4d27cf=[];const _0x3726d3=_0x2a5bd2['length']%0x4==0x0||_0x2a5bd2[_0xd05b83(0x34c)]%0x4==0x3||_0x2a5bd2['length']%0x3==0x1?0x4:0x3;let _0x526151=0x0;_0x2a5bd2[_0xd05b83(0x20e)]((_0x34fe2e,_0x4df5a1)=>{const _0x152190=_0xd05b83;if(_0x4df5a1%_0x3726d3==0x0)_0x4d27cf=[];_0x4d27cf[_0x152190(0x398)](Markup[_0x152190(0x22b)][_0x152190(0x1a4)](_0x34fe2e[_0x152190(0x343)]==_0x152190(0x28e)?_0x152190(0x19b):_0x152190(0x38b)+_0x34fe2e[_0x152190(0x343)],_0x152190(0x1ce)+_0x34fe2e['botID'])),_0x4df5a1%_0x3726d3==0x0&&(_0x315d2a[_0x526151]=_0x4d27cf,_0x526151++);});const _0x2eef52=Markup[_0xd05b83(0x293)](_0x315d2a);_0x2bc4ce['reply'](_0xd05b83(0x1fb),_0x2eef52);}}),tgBot['action'](/restart_(.+)/,async _0x420179=>{const _0x18de31=_0x519901,_0x575d9c=_0x420179[_0x18de31(0x24a)][0x1];_0x420179[_0x18de31(0x2ef)](),_0x575d9c==_0x18de31(0x28e)?config[_0x18de31(0x20e)](_0x86bfe5=>{const _0x424022=_0x18de31;restartBot(_0x86bfe5[_0x424022(0x343)]);}):restartBot(_0x575d9c);}),tgBot['command']('on',async _0x1670fd=>{const _0x37a1b8=_0x519901,_0x41b256=getDisabledBots();if(_0x41b256[_0x37a1b8(0x34c)]==0x0)await sendTelegram(_0x1670fd[_0x37a1b8(0x227)]['id'],_0x37a1b8(0x355));else{if(_0x41b256[_0x37a1b8(0x34c)]>0x1)_0x41b256[_0x37a1b8(0x398)]({'botID':'all'});let _0x5a2d6e=[],_0xcd801a=[];const _0x3cfb87=_0x41b256[_0x37a1b8(0x34c)]%0x4==0x0||_0x41b256[_0x37a1b8(0x34c)]%0x4==0x3||_0x41b256['length']%0x3==0x1?0x4:0x3;let _0x45e174=0x0;_0x41b256['forEach']((_0x263fcc,_0x320de6)=>{const _0x3b1003=_0x37a1b8;if(_0x320de6%_0x3cfb87==0x0)_0xcd801a=[];_0xcd801a[_0x3b1003(0x398)](Markup[_0x3b1003(0x22b)][_0x3b1003(0x1a4)](_0x263fcc['botID']=='all'?_0x3b1003(0x19b):_0x3b1003(0x38b)+_0x263fcc[_0x3b1003(0x343)],_0x3b1003(0x31c)+_0x263fcc[_0x3b1003(0x343)])),_0x320de6%_0x3cfb87==0x0&&(_0x5a2d6e[_0x45e174]=_0xcd801a,_0x45e174++);});const _0x8b56c9=Markup[_0x37a1b8(0x293)](_0x5a2d6e);_0x1670fd[_0x37a1b8(0x387)](_0x37a1b8(0x357),_0x8b56c9);}}),tgBot['action'](/on_(.+)/,async _0x5b2b11=>{const _0x3327c0=_0x519901,_0x296baa=_0x5b2b11['match'][0x1];_0x5b2b11[_0x3327c0(0x2ef)]();if(_0x296baa==_0x3327c0(0x28e)){const _0x508567=getDisabledBots();await sendTelegram(_0x5b2b11[_0x3327c0(0x227)]['id'],_0x3327c0(0x243)),_0x508567[_0x3327c0(0x20e)](_0x53b813=>{const _0x4ed67b=_0x3327c0;if(_0x53b813['botID']!=_0x4ed67b(0x28e))toggleBot(_0x53b813[_0x4ed67b(0x343)],toggleStatus(_0x53b813[_0x4ed67b(0x343)]),_0x4ed67b(0x2cd));});}else await sendTelegram(_0x5b2b11[_0x3327c0(0x227)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x296baa),toggleBot(_0x296baa,toggleStatus(_0x296baa),_0x3327c0(0x2cd));}),tgBot[_0x519901(0x2aa)](_0x519901(0x1c0),async _0x46de8a=>{const _0x243cb4=_0x519901,_0x10578a=getEnabledBots();if(_0x10578a[_0x243cb4(0x34c)]==0x0)await sendTelegram(_0x46de8a['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x10578a['length']>0x1)_0x10578a[_0x243cb4(0x398)]({'botID':_0x243cb4(0x28e)});let _0x2bea40=[],_0x191517=[];const _0x292395=_0x10578a['length']%0x4==0x0||_0x10578a['length']%0x4==0x3||_0x10578a[_0x243cb4(0x34c)]%0x3==0x1?0x4:0x3;let _0x545698=0x0;_0x10578a[_0x243cb4(0x20e)]((_0x40b848,_0x3be953)=>{const _0x3ef30c=_0x243cb4;if(_0x3be953%_0x292395==0x0)_0x191517=[];_0x191517['push'](Markup['button']['callback'](_0x40b848[_0x3ef30c(0x343)]==_0x3ef30c(0x28e)?_0x3ef30c(0x19b):_0x3ef30c(0x38b)+_0x40b848[_0x3ef30c(0x343)],'off_'+_0x40b848['botID'])),_0x3be953%_0x292395==0x0&&(_0x2bea40[_0x545698]=_0x191517,_0x545698++);});const _0x1e1bb1=Markup[_0x243cb4(0x293)](_0x2bea40);_0x46de8a['reply'](_0x243cb4(0x242),_0x1e1bb1);}}),tgBot['action'](/off_(.+)/,async _0x3d2aa7=>{const _0x5d4daa=_0x519901,_0x6e5437=_0x3d2aa7[_0x5d4daa(0x24a)][0x1];_0x3d2aa7['editMessageReplyMarkup']();if(_0x6e5437==_0x5d4daa(0x28e)){const _0x484030=getEnabledBots();await sendTelegram(_0x3d2aa7[_0x5d4daa(0x227)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x484030[_0x5d4daa(0x20e)](_0x216ba7=>{const _0x7d4c53=_0x5d4daa;if(_0x216ba7['botID']!=_0x7d4c53(0x28e))toggleBot(_0x216ba7[_0x7d4c53(0x343)],toggleStatus(_0x216ba7[_0x7d4c53(0x343)]),_0x7d4c53(0x2cd));});}else await sendTelegram(_0x3d2aa7[_0x5d4daa(0x227)]['id'],_0x5d4daa(0x1e1)+_0x6e5437),toggleBot(_0x6e5437,toggleStatus(_0x6e5437),_0x5d4daa(0x2cd));}),tgBot[_0x519901(0x2aa)](_0x519901(0x2e6),async _0x8c083=>{const _0x2ff3b6=_0x519901,_0x5cd561=getEnabledBots();if(_0x5cd561['length']==0x0)await sendTelegram(_0x8c083[_0x2ff3b6(0x227)]['id'],_0x2ff3b6(0x1fc));else{if(_0x5cd561[_0x2ff3b6(0x34c)]>0x1){let _0x441ee9=[],_0x297ed7=[];const _0x170090=_0x5cd561[_0x2ff3b6(0x34c)]%0x4==0x0||_0x5cd561[_0x2ff3b6(0x34c)]%0x4==0x3||_0x5cd561['length']%0x3==0x1?0x4:0x3;let _0x32a839=0x0;_0x5cd561['forEach']((_0xb3ea65,_0x1afc72)=>{const _0x3df432=_0x2ff3b6;if(_0x1afc72%_0x170090==0x0)_0x297ed7=[];_0x297ed7[_0x3df432(0x398)](Markup[_0x3df432(0x22b)]['callback'](_0x3df432(0x38b)+_0xb3ea65[_0x3df432(0x343)],_0x3df432(0x33f)+_0xb3ea65[_0x3df432(0x343)])),_0x1afc72%_0x170090==0x0&&(_0x441ee9[_0x32a839]=_0x297ed7,_0x32a839++);});const _0x37776=Markup['inlineKeyboard'](_0x441ee9);_0x8c083[_0x2ff3b6(0x387)](_0x2ff3b6(0x300),_0x37776);}else{const _0x43200d=_0x5cd561[0x0][_0x2ff3b6(0x343)];if(pid[_0x43200d])pid[_0x43200d][_0x2ff3b6(0x333)]({'function':_0x2ff3b6(0x2df),'args':null});}}}),tgBot[_0x519901(0x1d3)](/metrics_(.+)/,async _0x437e39=>{const _0x2b70fc=_0x519901,_0x3d3894=_0x437e39['match'][0x1];_0x437e39['editMessageReplyMarkup']();if(pid[_0x3d3894])pid[_0x3d3894]['send']({'function':_0x2b70fc(0x2df),'args':null});}),tgBot[_0x519901(0x2aa)](_0x519901(0x281),async _0x478dc3=>{const _0x5b7695=_0x519901,_0x3f9d2c=getEnabledBots();if(_0x3f9d2c[_0x5b7695(0x34c)]==0x0)await sendTelegram(_0x478dc3[_0x5b7695(0x227)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x3f9d2c[_0x5b7695(0x34c)]>0x1){let _0x16360c=[],_0x1b75a0=[];const _0x39121b=_0x3f9d2c[_0x5b7695(0x34c)]%0x4==0x0||_0x3f9d2c['length']%0x4==0x3||_0x3f9d2c[_0x5b7695(0x34c)]%0x3==0x1?0x4:0x3;let _0x4e0dd8=0x0;_0x3f9d2c[_0x5b7695(0x20e)]((_0x5d7c06,_0x14f524)=>{const _0x573473=_0x5b7695;if(_0x14f524%_0x39121b==0x0)_0x1b75a0=[];_0x1b75a0[_0x573473(0x398)](Markup[_0x573473(0x22b)][_0x573473(0x1a4)](_0x573473(0x38b)+_0x5d7c06[_0x573473(0x343)],_0x573473(0x2e3)+_0x5d7c06[_0x573473(0x343)])),_0x14f524%_0x39121b==0x0&&(_0x16360c[_0x4e0dd8]=_0x1b75a0,_0x4e0dd8++);});const _0x2f6249=Markup[_0x5b7695(0x293)](_0x16360c);_0x478dc3[_0x5b7695(0x387)](_0x5b7695(0x1ff),_0x2f6249);}else{const _0x1c3f4d=_0x3f9d2c[0x0][_0x5b7695(0x343)];if(pid[_0x1c3f4d])pid[_0x1c3f4d][_0x5b7695(0x333)]({'function':_0x5b7695(0x370),'args':null});}}}),tgBot[_0x519901(0x1d3)](/portfolio_(.+)/,async _0x4ab018=>{const _0x137cd9=_0x519901,_0x48a6de=_0x4ab018[_0x137cd9(0x24a)][0x1];_0x4ab018[_0x137cd9(0x2ef)]();if(pid[_0x48a6de])pid[_0x48a6de][_0x137cd9(0x333)]({'function':_0x137cd9(0x370),'args':null});}),tgBot[_0x519901(0x2aa)](_0x519901(0x1f6),async _0x588add=>{const _0x255336=_0x519901,_0xc0afb0=_0x255336(0x1f6);await zipFiles(_0xc0afb0);const _0x6e448=zippath+(_0xc0afb0+_0x255336(0x340));_0x588add[_0x255336(0x1ec)]({'source':_0x6e448})['then'](()=>{})['catch'](_0x25befe=>logger[_0x255336(0x27a)](_0x255336(0x2a9)+_0xc0afb0+_0x255336(0x309),_0x25befe));}),tgBot[_0x519901(0x2aa)](_0x519901(0x1f9),async _0x5a6e34=>{const _0x18063a=_0x519901,_0x2eeb55='backup';await backupConfigFiles(),await zipFiles(_0x2eeb55);const _0x31f253=zippath+(_0x2eeb55+'.zip');_0x5a6e34[_0x18063a(0x1ec)]({'source':_0x31f253})['then'](()=>{})[_0x18063a(0x34e)](_0xafb754=>logger[_0x18063a(0x27a)](_0x18063a(0x2a9)+_0x2eeb55+_0x18063a(0x309),_0xafb754));}),tgBot['command'](_0x519901(0x247),async _0x3d6fdf=>{const _0x4980f4=_0x519901;await getMessages();if(!updateAvailable)await sendTelegram(_0x3d6fdf['chat']['id'],_0x4980f4(0x354));else{if(!validInstallation)await sendTelegram(_0x3d6fdf[_0x4980f4(0x227)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x1a78fa=Markup[_0x4980f4(0x293)]([Markup[_0x4980f4(0x22b)][_0x4980f4(0x1a4)]('Yes',_0x4980f4(0x399)),Markup[_0x4980f4(0x22b)]['callback']('No',_0x4980f4(0x302))]);_0x3d6fdf['reply']('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x1a78fa);}}}),tgBot[_0x519901(0x1d3)](/update_(.+)/,async _0x431922=>{const _0x36dd54=_0x519901,_0x4b5e04=_0x431922['match'][0x1];_0x431922[_0x36dd54(0x2ef)](),_0x4b5e04==_0x36dd54(0x1a5)&&(await sendTelegram(_0x431922['chat']['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB('update')),_0x4b5e04=='no'&&await sendTelegram(_0x431922[_0x36dd54(0x227)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x519901(0x2aa)](_0x519901(0x392),async _0x8a7caa=>{const _0x4a9101=_0x519901;if(!validInstallation)await sendTelegram(_0x8a7caa['chat']['id'],_0x4a9101(0x29e));else{const _0x9f49bd=Markup['inlineKeyboard']([Markup[_0x4a9101(0x22b)]['callback'](_0x4a9101(0x2cf),_0x4a9101(0x1a8)),Markup[_0x4a9101(0x22b)][_0x4a9101(0x1a4)]('No','reinstall_no')]);_0x8a7caa[_0x4a9101(0x387)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x9f49bd);}}),tgBot[_0x519901(0x1d3)](/reinstall_(.+)/,async _0x495490=>{const _0x4dfd29=_0x519901,_0x166d0f=_0x495490[_0x4dfd29(0x24a)][0x1];_0x495490[_0x4dfd29(0x2ef)](),_0x166d0f==_0x4dfd29(0x1a5)&&(await sendTelegram(_0x495490[_0x4dfd29(0x227)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x4dfd29(0x392))),_0x166d0f=='no'&&await sendTelegram(_0x495490['chat']['id'],_0x4dfd29(0x2e4));}),tgBot['command'](_0x519901(0x26e),async _0xd94c10=>{const _0x532518=_0x519901,_0x3a7ba4=getBotsWithMode();if(_0x3a7ba4[_0x532518(0x34c)]==0x0)await sendTelegram(_0xd94c10[_0x532518(0x227)]['id'],_0x532518(0x1fc));else{let _0x2f80f1=[],_0x2f2a49=[];const _0x3a7879=0x2;let _0x14fbd6=0x0;_0x3a7ba4[_0x532518(0x20e)]((_0x4c09cb,_0x705000)=>{const _0x2d7b50=_0x532518;if(_0x705000%_0x3a7879==0x0)_0x2f2a49=[];_0x2f2a49['push'](Markup[_0x2d7b50(0x22b)][_0x2d7b50(0x1a4)](_0x2d7b50(0x38b)+_0x4c09cb[_0x2d7b50(0x343)]+'\x20('+_0x4c09cb[_0x2d7b50(0x1f0)]+')',_0x2d7b50(0x31b)+_0x4c09cb['botID'])),_0x705000%_0x3a7879==0x0&&(_0x2f80f1[_0x14fbd6]=_0x2f2a49,_0x14fbd6++);});const _0x2e4fe6=Markup[_0x532518(0x293)](_0x2f80f1);_0xd94c10[_0x532518(0x387)](_0x532518(0x2f4),_0x2e4fe6);}}),tgBot[_0x519901(0x1d3)](/toggle_(.+)/,async _0x3f0e7f=>{const _0x419099=_0x519901,_0x1db7a9=_0x3f0e7f['match'][0x1];_0x3f0e7f['editMessageReplyMarkup']();const _0x5230c5=getBotsWithMode(),_0x262bf2=_0x5230c5[_0x419099(0x2ae)](_0x551156=>_0x551156[_0x419099(0x343)]==_0x1db7a9),_0x3a62c7=_0x262bf2['mode']==_0x419099(0x207)?'manual':_0x419099(0x207);await sendTelegram(_0x3f0e7f[_0x419099(0x227)]['id'],_0x419099(0x36a)+_0x1db7a9+_0x419099(0x22c)+_0x3a62c7+'\x20mode'),toggleBotMode(_0x1db7a9);}),tgBot['command'](_0x519901(0x325),async _0x40fd5f=>{const _0x56db13=_0x519901;let _0xfee336='';config[_0x56db13(0x20e)](_0x9ebf65=>{const _0x4a8dda=_0x56db13;_0xfee336+=_0x4a8dda(0x38b)+_0x9ebf65[_0x4a8dda(0x343)]+':\x20'+_0x9ebf65[_0x4a8dda(0x23e)]+'\x0a';}),await sendTelegram(_0x40fd5f['chat']['id'],_0xfee336,{'parse_mode':'HTML'});}),tgBot[_0x519901(0x2aa)](_0x519901(0x225),async _0x518257=>{const _0xa823a8=_0x519901;await sendTelegram(_0x518257[_0xa823a8(0x227)]['id'],_0xa32409);}),process[_0x519901(0x1eb)]('SIGINT',()=>tgBot['stop']('SIGINT')),process[_0x519901(0x1eb)]('SIGTERM',()=>tgBot['stop'](_0x519901(0x1a7))),tgBot['launch']();}function disableTelegram(){const _0x2ddb1c=_0x454ffa;tgBot&&tgBot[_0x2ddb1c(0x334)]();}async function sendTelegram(_0x2adea8,_0x24938b,_0x4577c4){const _0x46c9f8=_0x454ffa;_0x4577c4={..._0x4577c4,'disable_web_page_preview':!![]};try{await tgBot[_0x46c9f8(0x1b3)]['sendMessage'](_0x2adea8,_0x24938b,_0x4577c4);}catch(_0x4bea2a){logger[_0x46c9f8(0x27a)]('Telegram\x20error:',_0x4bea2a);}}async function sendTelegramBot(_0x3fddb1,_0x4d6fbd){const _0x482a9b=_0x454ffa;if(settings[_0x482a9b(0x1e5)]){if(settings[_0x482a9b(0x385)]=='all'||(_0x4d6fbd[_0x482a9b(0x2be)]==_0x482a9b(0x2c0)||_0x4d6fbd['type']=='warning'||_0x4d6fbd[_0x482a9b(0x2be)]==_0x482a9b(0x2d2))&&settings['telegramEvents']==_0x482a9b(0x21a)||_0x4d6fbd['type']=='order'&&settings['telegramEvents']==_0x482a9b(0x2fe)){if(tgBot&&settings[_0x482a9b(0x1bd)]){if(_0x4d6fbd['showname'])await sendTelegram(settings[_0x482a9b(0x1bd)],_0x4d6fbd[_0x482a9b(0x23e)]+_0x482a9b(0x32a)+_0x4d6fbd[_0x482a9b(0x382)]);else await sendTelegram(settings[_0x482a9b(0x1bd)],'Bot\x20'+_0x3fddb1+_0x482a9b(0x32a)+_0x4d6fbd['event']);}}}}async function sendTelegramMsg(_0x4903ac,_0x389b0e=_0x454ffa(0x1ae)){const _0x361534=_0x454ffa;return settings[_0x361534(0x1e5)]&&tgBot&&settings[_0x361534(0x1bd)]?(await sendTelegram(settings['telegramChatId'],_0x4903ac,{'parse_mode':_0x389b0e}),!![]):![];}function getDeviceWithIp(_0x42220e){return devices['find'](_0x2d97bb=>_0x2d97bb['ip']===_0x42220e);}async function temporaryAccess2FA(_0x199e37,_0x4e213f){const _0x221e0a=_0x454ffa;let _0x33dbb2=new Date(),_0x46f3c6=![];if(lastIpApproval){if(_0x33dbb2-lastIpApproval<0x1388)_0x46f3c6=!![];}lastIpApproval=new Date();if(_0x46f3c6)return;if(tgBot&&settings[_0x221e0a(0x1bd)]){const _0xbc5ecb=uuidRandom();tmpStorage[_0xbc5ecb]={'uuid':_0x199e37,'externalip':_0x4e213f};const _0x4bf32a=Markup[_0x221e0a(0x293)]([Markup[_0x221e0a(0x22b)][_0x221e0a(0x1a4)](_0x221e0a(0x24e),_0x221e0a(0x2a5)+_0xbc5ecb),Markup[_0x221e0a(0x22b)][_0x221e0a(0x1a4)](_0x221e0a(0x1c9),_0x221e0a(0x330)+_0xbc5ecb),Markup[_0x221e0a(0x22b)][_0x221e0a(0x1a4)](_0x221e0a(0x327),_0x221e0a(0x267)+_0xbc5ecb),Markup[_0x221e0a(0x22b)][_0x221e0a(0x1a4)]('reject','tempaccess_reject_'+_0xbc5ecb)]);await sendTelegram(settings['telegramChatId'],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x4e213f)[_0x221e0a(0x2f0)]+'\x20?',_0x4bf32a),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x4f821a=>{const _0x549b5=_0x221e0a,_0x4b9fa5=_0x4f821a[_0x549b5(0x24a)][0x1],_0x42e53d=_0x4f821a['match'][0x2],{uuid:_0x50244c,externalip:_0x13177c}=tmpStorage[_0x42e53d];delete tmpStorage[_0x42e53d],_0x4f821a[_0x549b5(0x2ef)](),devices[_0x50244c]['telegramIpApproval']={'clientip':_0x13177c,'timestamp':new Date()[_0x549b5(0x2cc)](),'expiry':_0x4b9fa5},_0x4b9fa5!=_0x549b5(0x1f3)?(await sendTelegram(_0x4f821a['chat']['id'],_0x549b5(0x2a3)+_0x4b9fa5+'\x20minutes',{'parse_mode':'HTML'}),io['to'](_0x50244c)[_0x549b5(0x2ed)]('status',{'access':{'allow':![],'reason':_0x549b5(0x2c8),'token':null}})):(await sendTelegram(_0x4f821a[_0x549b5(0x227)]['id'],_0x549b5(0x2ec)),io['to'](_0x50244c)[_0x549b5(0x2ed)](_0x549b5(0x1f8),{'access':{'allow':![],'reason':_0x549b5(0x237),'token':null}}));});}}async function loginAccess2FA(_0x171bc2,_0xa86430){const _0x3fa4b9=_0x454ffa;if(tgBot&&settings['telegramChatId']){const _0x26b0dd=uuidRandom();tmpStorage[_0x26b0dd]={'uuid':_0x171bc2,'externalip':_0xa86430};const _0x2b1a4b=Markup[_0x3fa4b9(0x293)]([Markup[_0x3fa4b9(0x22b)][_0x3fa4b9(0x1a4)](_0x3fa4b9(0x19f),_0x3fa4b9(0x200)+loginExpiry+'_'+_0x26b0dd),Markup[_0x3fa4b9(0x22b)][_0x3fa4b9(0x1a4)](_0x3fa4b9(0x1f3),'login2fa_reject_'+_0x26b0dd)]);await sendTelegram(settings[_0x3fa4b9(0x1bd)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0xa86430)[_0x3fa4b9(0x2f0)]+'\x20?',_0x2b1a4b),tgBot[_0x3fa4b9(0x1d3)](/login2fa_(.+)_(.+)/,async _0x508f41=>{const _0x53a416=_0x3fa4b9,_0xd832bd=_0x508f41['match'][0x1],_0x4c9595=_0x508f41['match'][0x2],{uuid:_0x671fc1,externalip:_0x5a8365}=tmpStorage[_0x4c9595];delete tmpStorage[_0x4c9595],_0x508f41['editMessageReplyMarkup'](),devices[_0x671fc1][_0x53a416(0x1c7)]={'clientip':_0x5a8365,'timestamp':new Date()['getTime'](),'expiry':_0xd832bd},_0xd832bd!=_0x53a416(0x1f3)?(await sendTelegram(_0x508f41['chat']['id'],'Login\x20accepted',{'parse_mode':_0x53a416(0x1ae)}),io['to'](_0x671fc1)['emit'](_0x53a416(0x1f8),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x508f41[_0x53a416(0x227)]['id'],_0x53a416(0x2d6)),io['to'](_0x671fc1)[_0x53a416(0x2ed)](_0x53a416(0x1f8),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xfc9441=_0x454ffa;return dbConfig[_0xfc9441(0x30f)](_0xfc9441(0x31d))[_0xfc9441(0x2d3)](_0xfc9441(0x343))['filter']({'status':_0xfc9441(0x33a)})[_0xfc9441(0x249)]()||[];}function getDisabledBots(){const _0xeba974=_0x454ffa;return dbConfig[_0xeba974(0x30f)]('bots')[_0xeba974(0x2d3)](_0xeba974(0x343))[_0xeba974(0x1cb)]({'status':_0xeba974(0x342)})[_0xeba974(0x249)]()||[];}function getBotAttributes(_0x3cbabf){const _0x501f32=_0x454ffa;let _0xee4337={};const _0x2ea42f=configpath+_0x501f32(0x1fd)+_0x3cbabf+_0x501f32(0x397),_0x382609=fs['existsSync'](_0x2ea42f);if(_0x382609){const _0x24f25c=fs[_0x501f32(0x384)](_0x2ea42f);try{const _0x5e1f14=JSON[_0x501f32(0x297)](_0x24f25c),_0x3b7f2a=_0x5e1f14?_0x5e1f14['bot'][0x0][_0x501f32(0x371)]:![];_0xee4337['mode']=_0x3b7f2a?_0x501f32(0x207):_0x501f32(0x328),_0xee4337[_0x501f32(0x23e)]=_0x5e1f14?_0x5e1f14['bot'][0x0][_0x501f32(0x23e)]:_0x501f32(0x38b)+_0x3cbabf;}catch(_0x1762f8){_0xee4337[_0x501f32(0x1f0)]=_0x501f32(0x328),_0xee4337[_0x501f32(0x23e)]='Bot\x20'+_0x3cbabf;}}else _0xee4337[_0x501f32(0x1f0)]='manual',_0xee4337[_0x501f32(0x23e)]=_0x501f32(0x38b)+_0x3cbabf;return _0xee4337;}function getBotsWithMode(){const _0x3055be=_0x454ffa,_0x184e7c=dbConfig[_0x3055be(0x30f)](_0x3055be(0x31d))[_0x3055be(0x2d3)](_0x3055be(0x343))[_0x3055be(0x249)]()||[];return _0x184e7c[_0x3055be(0x20e)](_0x192c96=>{const _0x2b4b4b=_0x3055be;let _0x34ed00=getBotAttributes(_0x192c96[_0x2b4b4b(0x343)]);_0x192c96[_0x2b4b4b(0x1f0)]=_0x34ed00[_0x2b4b4b(0x1f0)];}),_0x184e7c;}function getBotExchanges(){const _0x2f2dad=_0x454ffa;let _0x357461=[];const _0x1bd8c1=dbConfig[_0x2f2dad(0x30f)](_0x2f2dad(0x31d))[_0x2f2dad(0x2d3)](_0x2f2dad(0x343))['value']()||[];_0x1bd8c1[_0x2f2dad(0x20e)](_0x455936=>{const _0x3ffa29=_0x2f2dad;if(_0x455936[_0x3ffa29(0x1f8)]==_0x3ffa29(0x33a)){const _0x3cca20=configpath+_0x3ffa29(0x1fd)+_0x455936[_0x3ffa29(0x343)]+_0x3ffa29(0x397),_0x276da4=fs[_0x3ffa29(0x39a)](_0x3cca20);let _0x2f1927;if(_0x276da4){const _0x2c2721=fs['readFileSync'](_0x3cca20);try{const _0x48201f=JSON[_0x3ffa29(0x297)](_0x2c2721);_0x2f1927=_0x48201f?_0x48201f['bot'][0x0][_0x3ffa29(0x2f2)]:null;}catch(_0x4aff8c){}}if(_0x2f1927)_0x357461[_0x3ffa29(0x398)](_0x2f1927);}});const _0x2acb18=[...new Set(_0x357461)][_0x2f2dad(0x2af)]();return _0x2acb18;}async function initUser(){const _0x2c07ba=_0x454ffa;if(!settings[_0x2c07ba(0x19c)]){const _0x56d131=uuidRandom();mixpanel['alias'](_0x56d131),updateSetting(_0x2c07ba(0x19c),_0x56d131);}}async function initSecure(){const _0x167b70=_0x454ffa;let _0x322950=getSecure();if(!_0x322950['hasOwnProperty'](_0x167b70(0x1b7))){let _0x15691d=await generateKeys();_0x322950[_0x167b70(0x198)]=_0x15691d[_0x167b70(0x198)],_0x322950[_0x167b70(0x204)]=_0x15691d[_0x167b70(0x204)],_0x322950['secret']=crypto['randomBytes'](0x20)['toString'](_0x167b70(0x193));;storeSecure(_0x322950);}}function getSettings(){const _0x438105=_0x454ffa;return dbSettings['get'](_0x438105(0x2dd))[_0x438105(0x249)]()||{};}function getSecure(){const _0x1284d3=_0x454ffa;return dbSecure[_0x1284d3(0x30f)](_0x1284d3(0x27f))['value']()||{};}function getBlacklist(){const _0x3c120c=_0x454ffa;return dbSecure[_0x3c120c(0x30f)](_0x3c120c(0x35d))[_0x3c120c(0x249)]()||[];}function broadcastToBots(_0x44ca12,_0x103e71){const _0xf9723b=_0x454ffa;config[_0xf9723b(0x20e)](_0x2a1f31=>{const _0x388460=_0xf9723b;if(_0x2a1f31[_0x388460(0x1f8)]==_0x388460(0x33a)&&_0x2a1f31[_0x388460(0x31f)]==_0x388460(0x306)||_0x2a1f31[_0x388460(0x1f8)]==_0x388460(0x20d)&&_0x2a1f31[_0x388460(0x31f)]==_0x388460(0x306)){if(pid[_0x2a1f31['botID']])pid[_0x2a1f31['botID']][_0x388460(0x333)]({[_0x44ca12]:_0x103e71});}});}async function storeSettings(_0x9c6767,_0x472b6a=![]){const _0x7f369b=_0x454ffa;_0x9c6767={...settings,..._0x9c6767};if(_0x472b6a&&_0x9c6767[_0x7f369b(0x363)]!=_0x7f369b(0x288)&&_0x9c6767[_0x7f369b(0x363)]!='***'&&_0x9c6767[_0x7f369b(0x363)]!=''){const _0x11e0aa=decryptRSA(secure[_0x7f369b(0x204)],_0x9c6767[_0x7f369b(0x363)])[_0x7f369b(0x28a)](_0x7f369b(0x2a1))[0x0],_0x72deaf=bcrypt[_0x7f369b(0x2e5)](_0x11e0aa,saltRounds);_0x9c6767={..._0x9c6767,'bbPassword':_0x72deaf};}if(_0x472b6a&&_0x9c6767['telegramToken']!=_0x7f369b(0x288)&&_0x9c6767['telegramToken']!=_0x7f369b(0x2a7)&&_0x9c6767[_0x7f369b(0x305)]!=''){const _0x39b2e1=decryptRSA(secure[_0x7f369b(0x204)],_0x9c6767['telegramToken'])[_0x7f369b(0x28a)]('|@|')[0x0];_0x9c6767={..._0x9c6767,'telegramToken':_0x39b2e1};}if(_0x472b6a&&_0x9c6767['marketcapApi']!='************'&&_0x9c6767[_0x7f369b(0x319)]!=_0x7f369b(0x2a7)&&_0x9c6767['marketcapApi']!=''){const _0x4cbed3=decryptRSA(secure[_0x7f369b(0x204)],_0x9c6767[_0x7f369b(0x319)])[_0x7f369b(0x28a)]('|@|')[0x0];_0x9c6767={..._0x9c6767,'marketcapApi':_0x4cbed3};}const _0x55da9=_0x9c6767['telegramToken']!=_0x7f369b(0x288)&&_0x9c6767[_0x7f369b(0x305)]!=settings['telegramToken']||_0x9c6767[_0x7f369b(0x2e1)]!=settings[_0x7f369b(0x2e1)],_0x282e5f=_0x9c6767[_0x7f369b(0x305)]==''||_0x9c6767[_0x7f369b(0x2e1)]=='',_0xe5b435=_0x9c6767[_0x7f369b(0x319)]&&_0x9c6767[_0x7f369b(0x319)]!='************'&&_0x9c6767[_0x7f369b(0x319)]!=settings['marketcapApi'];_0x55da9&&(_0x9c6767[_0x7f369b(0x1bd)]=null,_0x9c6767[_0x7f369b(0x385)]=_0x7f369b(0x28e));for(const [_0x33205a,_0x4b3f85]of Object[_0x7f369b(0x364)](_0x9c6767)){if(_0x33205a==_0x7f369b(0x305)&&_0x4b3f85=='************'){_0x9c6767[_0x7f369b(0x305)]=settings[_0x7f369b(0x305)];continue;};if(_0x33205a==_0x7f369b(0x363)&&_0x4b3f85==_0x7f369b(0x288)){_0x9c6767[_0x7f369b(0x363)]=settings[_0x7f369b(0x363)];continue;};if(_0x33205a=='marketcapApi'&&_0x4b3f85==_0x7f369b(0x288)){_0x9c6767[_0x7f369b(0x319)]=settings[_0x7f369b(0x319)];continue;};dbSettings[_0x7f369b(0x226)](_0x7f369b(0x2b3)+_0x33205a,_0x4b3f85)[_0x7f369b(0x308)]();}settings=_0x9c6767,io['to'](_0x7f369b(0x33b))[_0x7f369b(0x2ed)](_0x7f369b(0x2dd),cleanSettings()),broadcastToBots(_0x7f369b(0x25e),settings['timeshift']),broadcastToBots(_0x7f369b(0x23a),settings[_0x7f369b(0x23a)]),broadcastToBots(_0x7f369b(0x319),settings['marketcapApi']);if(_0x55da9&&!_0x282e5f)initTelegram();_0x55da9&&_0x282e5f&&(updateSetting(_0x7f369b(0x1bd),null),disableTelegram()),getAllClients()['forEach'](_0x3078e0=>{const _0x6d1fc3=_0x7f369b;getSocket(_0x3078e0['id'])[_0x6d1fc3(0x2ed)](_0x6d1fc3(0x1f8),{'access':{'allow':![],'reason':_0x6d1fc3(0x2c8),'token':null}});}),_0xe5b435&&(await sleep(0xbb8),testMarketcapApi(_0x9c6767[_0x7f369b(0x319)]));}async function testMarketcapApi(_0x444e8a){const _0x317994=_0x454ffa,_0x489569=[_0x317994(0x341),_0x317994(0x381)];try{await axios[_0x317994(0x30f)]('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x444e8a},'params':{'symbol':_0x489569['toString']()}});}catch(_0x528935){_0x528935['toString']()[_0x317994(0x2b2)](_0x317994(0x1d7))?(io['to'](_0x317994(0x33b))[_0x317994(0x2ed)](_0x317994(0x301),_0x317994(0x38c)),logger[_0x317994(0x30d)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to']('botmanager')['emit']('notification','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x317994(0x30d)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x317994(0x27a)](_0x317994(0x1c4),_0x528935[_0x317994(0x2ba)]()+_0x317994(0x32c)+_0x528935[_0x317994(0x2d7)]));return;}logger[_0x317994(0x27a)](_0x317994(0x195));}function updateSetting(_0x4c74ec,_0x3cb82f){const _0x3fe4a6=_0x454ffa;dbSettings[_0x3fe4a6(0x226)](_0x3fe4a6(0x2b3)+_0x4c74ec,_0x3cb82f)[_0x3fe4a6(0x308)](),settings=getSettings(),io['to'](_0x3fe4a6(0x33b))[_0x3fe4a6(0x2ed)](_0x3fe4a6(0x2dd),cleanSettings());}function storeSecure(_0x4554a5){const _0x21ae37=_0x454ffa;dbSecure[_0x21ae37(0x30f)]('secure')['push'](_0x4554a5)[_0x21ae37(0x308)](),secure=_0x4554a5;}function addBlacklist(_0x45cb6e){const _0x12c1f2=_0x454ffa;cleanBlacklist();let _0x17d718;devices[_0x45cb6e]['telegramIpApproval']?_0x17d718=Math[_0x12c1f2(0x1c1)](devices[_0x45cb6e][_0x12c1f2(0x1de)]['expiry'],loginExpiry):_0x17d718=loginExpiry,dbSecure[_0x12c1f2(0x30f)]('blacklist')['push']({'expiry':new Date()['getTime']()+_0x17d718*0x3c*0x3e8,'token':devices[_0x45cb6e][_0x12c1f2(0x1ef)][_0x12c1f2(0x2ff)]})[_0x12c1f2(0x308)](),blacklist=dbSecure[_0x12c1f2(0x30f)](_0x12c1f2(0x35d))[_0x12c1f2(0x249)]();}function cleanBlacklist(){const _0x56e4b=_0x454ffa;let _0x5565d0=dbSecure[_0x56e4b(0x30f)]('blacklist')['cloneDeep']()[_0x56e4b(0x249)](),_0x9a5208=new Date()[_0x56e4b(0x2cc)]();_0x5565d0[_0x56e4b(0x20e)](_0x49c066=>{const _0x54d32b=_0x56e4b;_0x49c066[_0x54d32b(0x1ad)]<_0x9a5208&&dbSecure[_0x54d32b(0x30f)](_0x54d32b(0x35d))[_0x54d32b(0x264)]({'expiry':_0x49c066[_0x54d32b(0x1ad)]})[_0x54d32b(0x308)]();});}function initStates(){let _0xb7ef0c=getConfiguration();_0xb7ef0c['forEach'](_0xea836d=>{const _0x10ce44=_0x3362;_0xea836d[_0x10ce44(0x31f)]='stopped';}),storeConfiguration(_0xb7ef0c);}async function generateKeys(){const _0x255f2a=_0x454ffa,_0x3855cf=forge[_0x255f2a(0x2d4)][_0x255f2a(0x23b)][_0x255f2a(0x2fc)]({'bits':0x1000,'e':0x10001}),_0x102b5a=forge[_0x255f2a(0x2d4)]['privateKeyToPem'](_0x3855cf[_0x255f2a(0x204)]),_0x5ae5c0=forge[_0x255f2a(0x2d4)][_0x255f2a(0x26c)](_0x3855cf[_0x255f2a(0x198)]);return{'privateKey':_0x102b5a,'publicKey':_0x5ae5c0};}async function oneTimeMigration(){const _0x17dc90=_0x454ffa;let _0x145802=getSettings(),_0x230cd0=![];!_0x145802[_0x17dc90(0x1a6)](_0x17dc90(0x1f5))&&(_0x145802[_0x17dc90(0x1f5)]=0x0,_0x230cd0=!![]);!_0x145802['hasOwnProperty'](_0x17dc90(0x365))&&(_0x145802[_0x17dc90(0x365)]=0x0,_0x230cd0=!![]);!_0x145802[_0x17dc90(0x1a6)]('latestversion')&&(_0x145802[_0x17dc90(0x25c)]=_0x17dc90(0x361),_0x230cd0=!![]);!_0x145802[_0x17dc90(0x1a6)](_0x17dc90(0x23a))&&(_0x145802['onepagemode']=![],_0x230cd0=!![]);!_0x145802[_0x17dc90(0x1a6)]('marketcapApi')&&(_0x145802[_0x17dc90(0x319)]='',_0x230cd0=!![]);if(_0x230cd0)storeSettings(_0x145802);try{fs[_0x17dc90(0x224)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x5e09d2=>{const _0x59b0b=_0x17dc90;if(!_0x5e09d2[_0x59b0b(0x2db)]()){if(!_0x5e09d2[_0x59b0b(0x30a)]['startsWith'](_0x59b0b(0x26f)))fs[_0x59b0b(0x28d)](configbackuppath+_0x5e09d2[_0x59b0b(0x30a)]);}else fs[_0x59b0b(0x2c3)](configbackuppath+_0x5e09d2['name'],{'recursive':!![]});});}catch(_0x1c1089){logger['debug'](_0x17dc90(0x1dc),_0x1c1089);}}function storeConfiguration(_0x204fc8){const _0x5bf13b=_0x454ffa;dbConfig[_0x5bf13b(0x30f)](_0x5bf13b(0x31d))[_0x5bf13b(0x264)]()[_0x5bf13b(0x308)](),dbConfig[_0x5bf13b(0x30f)]('bots')[_0x5bf13b(0x398)](..._0x204fc8)[_0x5bf13b(0x308)](),config=_0x204fc8;}async function resetPassword(){const _0x4daa9d=_0x454ffa;if(tgBot&&settings[_0x4daa9d(0x1bd)]){const _0x1c0e8b=Markup[_0x4daa9d(0x293)]([Markup['button'][_0x4daa9d(0x1a4)](_0x4daa9d(0x1a5),_0x4daa9d(0x279)),Markup[_0x4daa9d(0x22b)][_0x4daa9d(0x1a4)]('no',_0x4daa9d(0x277))]);await sendTelegram(settings[_0x4daa9d(0x1bd)],_0x4daa9d(0x375),_0x1c0e8b),tgBot['action'](/resetpw_(.+)/,async _0x28d055=>{const _0xd98ec2=_0x4daa9d,_0x121a3b=_0x28d055['match'][0x1];_0x28d055['editMessageReplyMarkup']();if(_0x121a3b!='no'){const _0x4c60dd=0xf,_0x68f58b=_0xd98ec2(0x220),_0x2b6701=Array[_0xd98ec2(0x380)](crypto[_0xd98ec2(0x1ba)](new Uint32Array(_0x4c60dd)))[_0xd98ec2(0x1a3)](_0x275554=>_0x68f58b[_0x275554%_0x68f58b[_0xd98ec2(0x34c)]])['join'](''),_0x4a7eff=bcrypt[_0xd98ec2(0x2e5)](_0x2b6701,saltRounds);storeSettings({'bbPassword':_0x4a7eff}),await sendTelegram(_0x28d055[_0xd98ec2(0x227)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x2b6701,{'parse_mode':_0xd98ec2(0x1ae)});}else await sendTelegram(_0x28d055[_0xd98ec2(0x227)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x3fc65d,_0x420ee9){const _0x14bf31=_0x454ffa;io['to'](_0x14bf31(0x33b))[_0x14bf31(0x2ed)](_0x14bf31(0x301),_0x14bf31(0x209),_0x14bf31(0x2d2));if(tgBot&&settings[_0x14bf31(0x1bd)]){const _0x3e1d15=uuidRandom();tmpStorage[_0x3e1d15]={'path':_0x3fc65d,'filename':_0x420ee9};const _0x5a0a87=Markup[_0x14bf31(0x293)]([Markup[_0x14bf31(0x22b)][_0x14bf31(0x1a4)](_0x14bf31(0x1a5),'restore_yes_'+_0x3e1d15),Markup[_0x14bf31(0x22b)][_0x14bf31(0x1a4)]('no',_0x14bf31(0x275)+_0x3e1d15)]);await sendTelegram(settings[_0x14bf31(0x1bd)],_0x14bf31(0x254),_0x5a0a87),tgBot['action'](/restore_(.+)_(.+)/,async _0x384412=>{const _0x29d821=_0x14bf31,_0x14d503=_0x384412[_0x29d821(0x24a)][0x1],_0x289ee7=_0x384412[_0x29d821(0x24a)][0x2],{path:_0x29cf8a,filename:_0x5459a5}=tmpStorage[_0x289ee7];delete tmpStorage[_0x289ee7],_0x384412[_0x29d821(0x2ef)](),_0x14d503==_0x29d821(0x1a5)?(logger[_0x29d821(0x27a)](_0x29d821(0x2bc)),await sendTelegram(_0x384412['chat']['id'],_0x29d821(0x324),{'parse_mode':_0x29d821(0x1ae)}),unzipFile(_0x29cf8a,_0x5459a5)):(logger[_0x29d821(0x27a)](_0x29d821(0x251)),await sendTelegram(_0x384412[_0x29d821(0x227)]['id'],_0x29d821(0x251)));});}}function getServerTime(){const _0x1f5f87=_0x454ffa,_0x32a9f5=new Date();return _0x32a9f5[_0x1f5f87(0x22d)]()+'/'+(_0x32a9f5[_0x1f5f87(0x1f7)]()+0x1)[_0x1f5f87(0x2ba)]()[_0x1f5f87(0x248)](0x2,'0')+'/'+_0x32a9f5[_0x1f5f87(0x1ac)]()[_0x1f5f87(0x2ba)]()[_0x1f5f87(0x248)](0x2,'0')+'\x20'+_0x32a9f5[_0x1f5f87(0x2b9)]()[_0x1f5f87(0x2ba)]()['padStart'](0x2,'0')+':'+_0x32a9f5[_0x1f5f87(0x218)]()[_0x1f5f87(0x2ba)]()[_0x1f5f87(0x248)](0x2,'0')+':'+_0x32a9f5['getSeconds']()[_0x1f5f87(0x2ba)]()[_0x1f5f87(0x248)](0x2,'0');}function getTimeStamp(){const _0x4668f1=_0x454ffa,_0x3429f1=shiftedTime();return _0x3429f1[_0x4668f1(0x22d)]()+'/'+(_0x3429f1['getMonth']()+0x1)[_0x4668f1(0x2ba)]()[_0x4668f1(0x248)](0x2,'0')+'/'+_0x3429f1[_0x4668f1(0x1ac)]()['toString']()[_0x4668f1(0x248)](0x2,'0')+'\x20'+_0x3429f1[_0x4668f1(0x2b9)]()[_0x4668f1(0x2ba)]()[_0x4668f1(0x248)](0x2,'0')+':'+_0x3429f1[_0x4668f1(0x218)]()['toString']()[_0x4668f1(0x248)](0x2,'0')+':'+_0x3429f1['getSeconds']()[_0x4668f1(0x2ba)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x250f64=_0x454ffa,_0x37733f=shiftedTime();return _0x37733f[_0x250f64(0x22d)]()+(_0x37733f[_0x250f64(0x1f7)]()+0x1)[_0x250f64(0x2ba)]()['padStart'](0x2,'0')+_0x37733f[_0x250f64(0x1ac)]()[_0x250f64(0x2ba)]()[_0x250f64(0x248)](0x2,'0')+'-'+_0x37733f[_0x250f64(0x2b9)]()[_0x250f64(0x2ba)]()['padStart'](0x2,'0')+_0x37733f[_0x250f64(0x218)]()[_0x250f64(0x2ba)]()[_0x250f64(0x248)](0x2,'0')+_0x37733f['getSeconds']()[_0x250f64(0x2ba)]()[_0x250f64(0x248)](0x2,'0');}function shiftedTime(){const _0x274d70=_0x454ffa,_0x4ae7c8=new Date();let _0x3caa42=_0x4ae7c8;if(settings[_0x274d70(0x25e)]&&settings[_0x274d70(0x25e)]!==0x0)_0x3caa42=fns[_0x274d70(0x295)](_0x4ae7c8,{'hours':settings['timeshift']});return _0x3caa42;}async function startScheduler(){const _0x2911cf=_0x454ffa,_0x5f3d72=new Date()[_0x2911cf(0x35c)](),_0xbd9a13=shiftedTime()['getHours']();_0xbd9a13==0x4&&backupConfigFiles(),_0xbd9a13==0x0&&(rotateLogFiles(),logger['debug'](_0x2911cf(0x2a8)),logger[_0x2911cf(0x27a)](_0x2911cf(0x1a2)+serverversion+'#RES#\x20'+(environment==_0x2911cf(0x26d)?_0x2911cf(0x338):'')),logger[_0x2911cf(0x27a)](_0x2911cf(0x2a8))),_0x5f3d72%0x6==0x0&&triggerAnalytics(),_0x5f3d72%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x117898){const _0x335462=_0x454ffa;logger[_0x335462(0x27a)](_0x335462(0x196)+_0x117898);const _0x1da39d=getBotsWithMode();_0x1da39d[_0x335462(0x34c)]>0x0?confirmRestore(configbackuppath,_0x117898):unzipFile(configbackuppath,_0x117898);}async function getBackupFiles(_0x30801e=null){const _0x2f3dcd=_0x454ffa;let _0x2f8213=[],_0x57ef0f=fs[_0x2f3dcd(0x224)](configbackuppath,{'withFileTypes':!![]});_0x57ef0f[_0x2f3dcd(0x2af)]((_0x56286d,_0xac5f4)=>_0x56286d[_0x2f3dcd(0x30a)]<_0xac5f4[_0x2f3dcd(0x30a)]?0x1:_0xac5f4['name']<_0x56286d[_0x2f3dcd(0x30a)]?-0x1:0x0),_0x57ef0f[_0x2f3dcd(0x20e)](_0x117611=>{const _0x55107e=_0x2f3dcd;if(!_0x117611[_0x55107e(0x2db)]()&&_0x117611['name'][_0x55107e(0x250)]('backup-full@')&&_0x117611[_0x55107e(0x30a)]['endsWith'](_0x55107e(0x340))){const _0x205644=formatDate(fs['statSync'](configbackuppath+_0x117611[_0x55107e(0x30a)])['mtime']);_0x2f8213[_0x55107e(0x398)]({'name':_0x117611[_0x55107e(0x30a)],'mtime':_0x205644});}});if(_0x30801e)io['to'](_0x30801e)[_0x2f3dcd(0x2ed)]('backup-files',_0x2f8213);else return _0x2f8213;}async function backupConfigFiles(){const _0x139690=_0x454ffa;await zipFiles(_0x139690(0x1e8));const _0x188d8c=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x139690(0x2b4),configbackuppath+('backup-full@'+_0x188d8c+_0x139690(0x340)));let _0x2c3cdb=fs[_0x139690(0x224)](configbackuppath,{'withFileTypes':!![]});_0x2c3cdb[_0x139690(0x2af)]((_0x9b5644,_0xc8cc15)=>_0x9b5644[_0x139690(0x30a)]<_0xc8cc15[_0x139690(0x30a)]?0x1:_0xc8cc15[_0x139690(0x30a)]<_0x9b5644[_0x139690(0x30a)]?-0x1:0x0),_0x2c3cdb['length']>maxBackups&&fs[_0x139690(0x28d)](configbackuppath+_0x2c3cdb[_0x2c3cdb[_0x139690(0x34c)]-0x1][_0x139690(0x30a)]);}function rotateLogFiles(){const _0x53a778=_0x454ffa,_0x42ab08=fs[_0x53a778(0x337)](logspath+_0x53a778(0x234)),_0x5bed09=_0x42ab08[_0x53a778(0x378)]/0x400;if(_0x5bed09>0x64){let _0x1804c5=fs[_0x53a778(0x224)](logspath,{'withFileTypes':!![]});_0x1804c5['sort']((_0x5cdcf4,_0x556c73)=>_0x5cdcf4['name']<_0x556c73[_0x53a778(0x30a)]?0x1:_0x556c73[_0x53a778(0x30a)]<_0x5cdcf4[_0x53a778(0x30a)]?-0x1:0x0),_0x1804c5[_0x53a778(0x20e)](_0x289bb8=>{const _0x263ee7=_0x53a778;if(_0x289bb8[_0x263ee7(0x30a)]==_0x263ee7(0x1db))fs[_0x263ee7(0x317)](logspath+_0x289bb8[_0x263ee7(0x30a)],logspath+_0x263ee7(0x24d));if(_0x289bb8[_0x263ee7(0x30a)]==_0x263ee7(0x271))fs[_0x263ee7(0x317)](logspath+_0x289bb8['name'],logspath+_0x263ee7(0x1db));_0x289bb8[_0x263ee7(0x30a)]=='output-000.log'&&(fs['copyFileSync'](logspath+_0x289bb8[_0x263ee7(0x30a)],logspath+_0x263ee7(0x271)),fs['writeFileSync'](logspath+_0x289bb8[_0x263ee7(0x30a)],''));});}}async function zipFiles(_0x419e94){const _0x3a7260=_0x454ffa;let _0x4928d7;if(_0x419e94==_0x3a7260(0x1f6))_0x4928d7=logspath;if(_0x419e94==_0x3a7260(0x1f9))_0x4928d7=configpath;if(_0x419e94=='backup-full')_0x4928d7=configpath;let _0x22f445=fs[_0x3a7260(0x224)](_0x4928d7,{'withFileTypes':!![]});const _0x15205e=new JSZip();_0x22f445['forEach'](_0x21384d=>{const _0x5e0f2a=_0x3a7260;if(!_0x21384d[_0x5e0f2a(0x2db)]()){let _0x4be775=fs[_0x5e0f2a(0x384)](_0x4928d7+_0x21384d[_0x5e0f2a(0x30a)]);if(_0x419e94=='backup'){const _0x275cde=/^bot-[0-9]{3}-config.json$/,_0x51d7b6=_0x275cde[_0x5e0f2a(0x20f)](_0x21384d[_0x5e0f2a(0x30a)]);if(_0x51d7b6){const _0x3c881d=JSON[_0x5e0f2a(0x297)](_0x4be775);if(_0x3c881d[_0x5e0f2a(0x373)][0x0]){_0x3c881d[_0x5e0f2a(0x373)][0x0]['apiKey']=_0x5e0f2a(0x2a7),_0x3c881d['bot'][0x0][_0x5e0f2a(0x286)]=_0x5e0f2a(0x2a7);if(_0x3c881d[_0x5e0f2a(0x373)][0x0][_0x5e0f2a(0x213)])_0x3c881d[_0x5e0f2a(0x373)][0x0]['apiPassword']='***';}_0x4be775=JSON[_0x5e0f2a(0x215)](_0x3c881d,null,0x2);}if(_0x21384d[_0x5e0f2a(0x30a)]=='bb-settings.json'){const _0x37fb87=JSON['parse'](_0x4be775);if(_0x37fb87['settings'][_0x5e0f2a(0x2ad)])_0x37fb87[_0x5e0f2a(0x2dd)]['loginRequired']=![];if(_0x37fb87[_0x5e0f2a(0x2dd)][_0x5e0f2a(0x363)])_0x37fb87[_0x5e0f2a(0x2dd)][_0x5e0f2a(0x363)]='***';if(_0x37fb87[_0x5e0f2a(0x2dd)][_0x5e0f2a(0x305)])_0x37fb87['settings']['telegramToken']=_0x5e0f2a(0x2a7);if(_0x37fb87[_0x5e0f2a(0x2dd)][_0x5e0f2a(0x1bd)])_0x37fb87[_0x5e0f2a(0x2dd)][_0x5e0f2a(0x1bd)]=null;if(_0x37fb87['settings'][_0x5e0f2a(0x319)])_0x37fb87[_0x5e0f2a(0x2dd)][_0x5e0f2a(0x319)]=_0x5e0f2a(0x2a7);_0x4be775=JSON[_0x5e0f2a(0x215)](_0x37fb87,null,0x2);}if(_0x21384d[_0x5e0f2a(0x30a)]!=_0x5e0f2a(0x236))_0x15205e[_0x5e0f2a(0x1af)](_0x21384d['name'],_0x4be775);}else _0x15205e[_0x5e0f2a(0x1af)](_0x21384d[_0x5e0f2a(0x30a)],_0x4be775);}});const _0x59ec66=await _0x15205e[_0x3a7260(0x255)]({'type':'string','base64':![],'compression':_0x3a7260(0x203)});fs[_0x3a7260(0x280)](zippath+(_0x419e94+_0x3a7260(0x340)),_0x59ec66,_0x3a7260(0x356));}async function unzipFile(_0x4050d3,_0x28180d){const _0x43a938=_0x454ffa;fs[_0x43a938(0x224)](configpath,{'withFileTypes':!![]})[_0x43a938(0x20e)](_0x332d51=>{const _0x9b67c5=_0x43a938;if(!_0x332d51['isDirectory']())fs[_0x9b67c5(0x2c3)](configpath+_0x332d51[_0x9b67c5(0x30a)]);});const _0x569e9a=fs[_0x43a938(0x384)](_0x4050d3+_0x28180d,_0x43a938(0x356)),_0x153aa0=await JSZip[_0x43a938(0x27c)](_0x569e9a,{'base64':![],'checkCRC32':!![]});for(const _0xd17267 of Object[_0x43a938(0x282)](_0x153aa0[_0x43a938(0x359)])){const _0xa1d660=_0x153aa0[_0x43a938(0x359)][_0xd17267],_0x35690a=await _0xa1d660[_0x43a938(0x32d)]('string');fs[_0x43a938(0x280)](configpath+_0xa1d660[_0x43a938(0x30a)],_0x35690a);}fs['readdirSync'](temppath,{'withFileTypes':!![]})['forEach'](_0x2faa2f=>{const _0x2ffe29=_0x43a938;if(!_0x2faa2f['isDirectory']())fs[_0x2ffe29(0x2c3)](temppath+_0x2faa2f[_0x2ffe29(0x30a)]);}),logger[_0x43a938(0x27a)](_0x43a938(0x2e2)),process[_0x43a938(0x333)]({'restore':!![]},_0x3bd585=>{});}async function getPublicIp(){const _0x534428=_0x454ffa;try{const _0x6559c2=await axios[_0x534428(0x30f)](_0x534428(0x38f));publicip=_0x6559c2[_0x534428(0x347)]['ip'];}catch(_0x406e1d){}}async function triggerAnalytics(){const _0x192774=_0x454ffa;if(!publicip)await getPublicIp();const _0x303852=getBotsWithMode();let _0x557fe5=0x0;_0x303852[_0x192774(0x20e)](_0x23092a=>{const _0x13c232=_0x192774;if(_0x23092a[_0x13c232(0x1f8)]===_0x13c232(0x33a))_0x557fe5++;});const _0x46069f=getBotExchanges();mixpanel[_0x192774(0x23d)](_0x192774(0x2ac),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x303852[_0x192774(0x34c)],'numbotsenabled':_0x557fe5,'exchanges':_0x46069f,'environment':environment});}async function getMessages(){const _0x52e422=_0x454ffa,_0x171cb8=_0x52e422(0x389),_0x34b4ac=new GraphQLClient(_0x171cb8),_0xc8ba80={'authorization':_0x52e422(0x36b)},_0x1bf9d9=serverversion[_0x52e422(0x28a)]('.'),_0x2a1f38=_0x1bf9d9[0x0]+'.'+_0x1bf9d9[0x1],_0x41d65b=Math[_0x52e422(0x1a1)](settings[_0x52e422(0x1f5)],settings[_0x52e422(0x365)]),_0x56ca3c={'last':parseInt(_0x41d65b),'bbm':_0x2a1f38},_0x28b902=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5f4aa6;try{_0x5f4aa6=await _0x34b4ac[_0x52e422(0x37c)](_0x28b902,_0x56ca3c,_0xc8ba80);}catch(_0x172b1d){}if(_0x5f4aa6&&_0x5f4aa6[_0x52e422(0x2cb)]){let _0x3d0870=settings['lastmsgtelegram'],_0x5d44b2=settings[_0x52e422(0x1f5)];newMessages=[];for(const _0x2fe913 of _0x5f4aa6['messages']){newMessages[_0x52e422(0x398)](_0x2fe913);let _0x580f07=![];_0x2fe913[_0x52e422(0x23f)]&&(updateSetting('latestversion',_0x2fe913['bbvNew']),_0x580f07=isNewerVersion(serverversion,_0x2fe913[_0x52e422(0x23f)])||serverversion==_0x2fe913['bbvNew']);if(!_0x580f07&&_0x2fe913['number']>_0x3d0870){if(_0x2fe913[_0x52e422(0x2c5)]===_0x52e422(0x266)||serverversion[_0x52e422(0x250)](_0x2fe913['bbvReceive'])){let _0x3ae10e=''+_0x2fe913['title']+'\x0a\x0a'+_0x2fe913[_0x52e422(0x1d2)];const _0x42303e=await sendTelegramMsg(toTelegramMarkdown(_0x3ae10e),_0x52e422(0x28f));_0x3d0870=_0x2fe913[_0x52e422(0x256)];}}_0x5d44b2=_0x2fe913[_0x52e422(0x256)];}updateAvailable=isNewerVersion(settings[_0x52e422(0x25c)],serverversion),updateSetting('lastmsgtelegram',_0x5d44b2),emitMessages();}}function _0x3362(_0x1a1649,_0x30d6ef){const _0x2dc8c1=_0x4332();return _0x3362=function(_0x5520ee,_0x28df75){_0x5520ee=_0x5520ee-0x191;let _0x433211=_0x2dc8c1[_0x5520ee];return _0x433211;},_0x3362(_0x1a1649,_0x30d6ef);}function emitMessages(){const _0xfde564=_0x454ffa,_0x3f6745=settings['lastmsgemitted'];let _0x38f736=[];newMessages[_0xfde564(0x20e)](_0x4660a2=>{const _0x1a4d4e=_0xfde564;_0x4660a2[_0x1a4d4e(0x256)]>_0x3f6745&&_0x38f736[_0x1a4d4e(0x398)](_0x4660a2);}),_0x38f736[_0xfde564(0x34c)]>0x0&&getAllClients()[_0xfde564(0x20e)](_0x5b1581=>{const _0x443ec9=_0xfde564;getSocket(_0x5b1581['id'])[_0x443ec9(0x2ed)](_0x443ec9(0x1d2),_0x38f736);});}function confirmMessage(_0x40e011){updateSetting('lastmsgemitted',Number(_0x40e011));}function isNewerVersion(_0x773371,_0x2838cd){const _0x51cc43=_0x454ffa,_0xa73333=_0x2838cd[_0x51cc43(0x28a)]('.'),_0x3d90fc=_0x773371[_0x51cc43(0x28a)]('.');for(var _0x40908f=0x0;_0x40908f<_0x3d90fc[_0x51cc43(0x34c)];_0x40908f++){const _0x590a70=~~_0x3d90fc[_0x40908f],_0x2286d9=~~_0xa73333[_0x40908f];if(_0x590a70>_0x2286d9)return!![];if(_0x590a70<_0x2286d9)return![];}return![];}function toTelegramMarkdown(_0x11ff56){const _0x25a5ee=_0x454ffa,_0x99c4e4=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x525948=/\*{2}(.+?)\*{2}/gim;return _0x11ff56=_0x11ff56[_0x25a5ee(0x376)](_0x99c4e4,_0x25a5ee(0x28c))[_0x25a5ee(0x376)](_0x525948,_0x25a5ee(0x1b6)),_0x11ff56;}async function validateConfigFile(){const _0x4f5cbb=_0x454ffa,_0x562ca2=dbConfig[_0x4f5cbb(0x30f)]('bots')[_0x4f5cbb(0x2d3)](_0x4f5cbb(0x343))['value']()||[];if(_0x562ca2[_0x4f5cbb(0x34c)]==0x0){let _0x5230b8=0x0,_0x48a65b=[];const _0x380cf4=/^bot-([0-9]{3})-config.json$/,_0x19fe0f=fs[_0x4f5cbb(0x224)](configpath);_0x19fe0f[_0x4f5cbb(0x20e)](_0x46893b=>{const _0x1549de=_0x4f5cbb,_0x224cd8=_0x380cf4[_0x1549de(0x2b6)](_0x46893b);if(_0x224cd8){const _0x318ee7=_0x224cd8[0x1];let _0x420d0c=getBotAttributes(_0x318ee7);_0x48a65b['push']({'botID':_0x318ee7,'botname':_0x420d0c['botname'],'status':_0x1549de(0x342),'live':_0x1549de(0x2cd)}),_0x5230b8++;}}),_0x5230b8!=0x0&&(dbConfig[_0x4f5cbb(0x30f)](_0x4f5cbb(0x31d))[_0x4f5cbb(0x217)](_0x48a65b)[_0x4f5cbb(0x308)](),config=_0x48a65b,restoredConfigFile=_0x5230b8);}}async function restoreConfigNotify(_0x2e93a4){const _0x775f4b=_0x454ffa;let _0x58e9c9;if(restoredConfigFile==0x1)_0x58e9c9='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x58e9c9=_0x775f4b(0x25d);if(_0x2e93a4)io['to'](_0x775f4b(0x33b))['emit']('notification',_0x58e9c9);else{logger['simple'](_0x775f4b(0x374)),logger[_0x775f4b(0x2a4)](_0x58e9c9),logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x775f4b(0x2a4)]('');if(tgBot&&settings[_0x775f4b(0x1bd)]&&settings[_0x775f4b(0x385)]!='orders')await sendTelegram(settings['telegramChatId'],_0x775f4b(0x2fa)+_0x58e9c9);}}function decryptRSA(_0x3c4a23,_0x3134cb){const _0x1ce363=_0x454ffa,_0x7f9777=forge['pki'][_0x1ce363(0x1c5)](_0x3c4a23),_0x224675=_0x7f9777[_0x1ce363(0x36e)](forge[_0x1ce363(0x33c)][_0x1ce363(0x37a)](_0x3134cb),_0x1ce363(0x1bc),{'md':forge['md'][_0x1ce363(0x228)][_0x1ce363(0x2fd)](),'mgf1':{'md':forge['md']['sha256'][_0x1ce363(0x2fd)]()}});return _0x224675;}function validateCredentials(_0x5beacc,_0x5b63a5){const _0x58e411=_0x454ffa;if(_0x5beacc[_0x58e411(0x2ee)]==settings['bbUsername']&&bcrypt['compareSync'](_0x5beacc[_0x58e411(0x396)],settings[_0x58e411(0x363)])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x1fad22=generateLoginToken(_0x5b63a5);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x1fad22};}}else return{'allow':![],'reason':_0x58e411(0x192),'token':null};}function refreshToken(_0x20eac1){const _0x4c4f0a=_0x454ffa,_0x2b5462=generateLoginToken(_0x20eac1);return{'allow':!![],'reason':_0x4c4f0a(0x191),'token':_0x2b5462};}function validateAccess(_0x4d902e,_0x179705,_0xfb24b0){const _0x1242a1=_0x454ffa,_0x257e4e=_0xfb24b0?_0xfb24b0:devices[_0x179705]['ip'];let _0x278aa3;const _0x42bc70=_0x32a4ef=>{const _0x179d64=_0x3362;if(settings[_0x179d64(0x2ad)]){if(settings[_0x179d64(0x1f1)]){if(telegram2FaApproved(_0x179705)){const _0x24d9db=generateLoginToken(_0x179705);return{'allow':!![],'reason':_0x179d64(0x362),'token':_0x24d9db};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x278aa3=validToken(_0x32a4ef,_0x179705),_0x278aa3[_0x179d64(0x1a6)]('success')?{'allow':!![],'reason':_0x179d64(0x1b1),'token':_0x32a4ef}:{'allow':![],'reason':_0x179d64(0x323),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x1242a1(0x1d6)]){let _0x3632d0=[...settings[_0x1242a1(0x1d9)],_0x1242a1(0x1fa),'::ffff:127.0.0.1',_0x1242a1(0x304)];if(_0x3632d0[_0x1242a1(0x2b2)](_0x257e4e))return _0x42bc70(_0x4d902e);else{_0x278aa3=validToken(_0x4d902e,_0x179705);if(_0x278aa3[_0x1242a1(0x1a6)](_0x1242a1(0x2d2)))return _0x42bc70(_0x4d902e);else{if(telegramIpApproved(_0x179705)){const _0x32ad6a=generateToken(_0x179705);return _0x278aa3=_0x42bc70(_0x4d902e),_0x278aa3['allow']?{'allow':!![],'reason':_0x1242a1(0x29f),'token':_0x32ad6a}:_0x278aa3;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x1242a1(0x1cd),'token':null};}}}else return _0x42bc70(_0x4d902e);}function timelyDecrypt(_0x314954,_0x46b9a4,_0x8112ce='@'){const _0x366a4d=_0x454ffa;if(_0x314954)try{const _0x599987=decryptRSA(secure['privateKey'],_0x314954),_0x3d088a=_0x599987[_0x366a4d(0x28a)](_0x8112ce)[0x0],_0x271961=_0x599987[_0x366a4d(0x28a)](_0x8112ce)[0x1],_0x5707b8=new Date()[_0x366a4d(0x2cc)]();if(_0x46b9a4){if(_0x5707b8-_0x271961<maxSecretAge*0x3e8)return _0x3d088a;else return![];}else return _0x3d088a;}catch(_0x582b8e){return![];}else return![];}const validToken=(_0x2bf80c,_0x338a90)=>{const _0x43afb2=_0x454ffa,_0x561368=devices[_0x338a90]['ip'];if(!_0x2bf80c)return{'error':_0x43afb2(0x383)};for(let _0x5803ff of blacklist){if(_0x5803ff[_0x43afb2(0x2ff)]==_0x2bf80c)return{'error':_0x43afb2(0x349)};}let _0x2f9341;try{_0x2f9341=jwt[_0x43afb2(0x1e4)](_0x2bf80c,secure[_0x43afb2(0x1b7)]+_0x338a90);}catch{return{'error':_0x43afb2(0x311)};}if(!_0x2f9341[_0x43afb2(0x1a6)](_0x43afb2(0x1d8))&&!_0x2f9341[_0x43afb2(0x1a6)](_0x43afb2(0x2ee))||!_0x2f9341['hasOwnProperty'](_0x43afb2(0x24b)))return{'error':_0x43afb2(0x23c)};if(!_0x2f9341[_0x43afb2(0x1a6)]('username')&&_0x2f9341[_0x43afb2(0x1a6)](_0x43afb2(0x1d8))){const {clientip:_0x5994c8}=_0x2f9341;return _0x561368==_0x5994c8?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x43afb2(0x2ea)};}else{if(_0x2f9341['hasOwnProperty'](_0x43afb2(0x2ee))&&_0x2f9341[_0x43afb2(0x1a6)](_0x43afb2(0x1d8))){const {username:_0x1c32e8,clientip:_0x180cbc}=_0x2f9341;return settings[_0x43afb2(0x270)]==_0x1c32e8&&_0x561368==_0x180cbc?{'success':_0x43afb2(0x34d)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x1da039=>{const _0x454038=_0x454ffa;if(_0x1da039){const _0x413bb3=devices[_0x1da039]['ip'];return jwt['sign']({'username':settings[_0x454038(0x270)],'clientip':_0x413bb3},secure[_0x454038(0x1b7)]+_0x1da039,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x158755=>{const _0x34fa84=_0x454ffa;if(_0x158755){const _0x3ddbda=devices[_0x158755]['ip'];return jwt[_0x34fa84(0x1d1)]({'clientip':_0x3ddbda},secure[_0x34fa84(0x1b7)]+_0x158755,{'expiresIn':devices[_0x158755][_0x34fa84(0x1de)][_0x34fa84(0x1ad)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x5ac6ed=>{const _0x1f782e=_0x454ffa;let _0x1cf767=![];return devices[_0x5ac6ed][_0x1f782e(0x1de)]&&devices[_0x5ac6ed][_0x1f782e(0x1de)][_0x1f782e(0x1ad)]!=_0x1f782e(0x1f3)&&(_0x1cf767=devices[_0x5ac6ed][_0x1f782e(0x1de)][_0x1f782e(0x1d8)]==devices[_0x5ac6ed]['ip']&&new Date()[_0x1f782e(0x2cc)]()-devices[_0x5ac6ed][_0x1f782e(0x1de)][_0x1f782e(0x1cf)]<devices[_0x5ac6ed][_0x1f782e(0x1de)][_0x1f782e(0x1ad)]*0x3c*0x3e8),_0x1cf767;},telegram2FaApproved=_0x3d09b9=>{const _0x2cc73e=_0x454ffa;let _0xcec2d4=![];return devices[_0x3d09b9][_0x2cc73e(0x1c7)]&&devices[_0x3d09b9][_0x2cc73e(0x1c7)]['expiry']!='reject'&&(_0xcec2d4=devices[_0x3d09b9][_0x2cc73e(0x1c7)]['clientip']==devices[_0x3d09b9]['ip']&&new Date()[_0x2cc73e(0x2cc)]()-devices[_0x3d09b9][_0x2cc73e(0x1c7)]['timestamp']<devices[_0x3d09b9][_0x2cc73e(0x1c7)][_0x2cc73e(0x1ad)]*0x3c*0x3e8),_0xcec2d4;},normalizeIP=_0x2f5a4b=>{const _0x5c19ae=_0x454ffa;let _0x273d36=null,_0x399bf3=null;if(ipaddr['isValid'](_0x2f5a4b)){const _0x119b7e=ipaddr[_0x5c19ae(0x297)](_0x2f5a4b);_0x119b7e[_0x5c19ae(0x2e9)]()===_0x5c19ae(0x31a)?(_0x119b7e['isIPv4MappedAddress']()&&(_0x273d36=_0x119b7e[_0x5c19ae(0x283)]()['toString']()),_0x399bf3=_0x119b7e[_0x5c19ae(0x2ba)]()):(_0x273d36=_0x119b7e[_0x5c19ae(0x2ba)](),_0x399bf3=_0x119b7e[_0x5c19ae(0x298)]()[_0x5c19ae(0x2ba)]());}return{'show':_0x273d36?_0x273d36:_0x399bf3,'store':_0x399bf3};};function formatDate(_0x58e751){const _0x10c8b4=_0x454ffa;return _0x58e751['getFullYear']()+'/'+(_0x58e751['getMonth']()+0x1)[_0x10c8b4(0x2ba)]()[_0x10c8b4(0x248)](0x2,'0')+'/'+_0x58e751[_0x10c8b4(0x1ac)]()[_0x10c8b4(0x2ba)]()['padStart'](0x2,'0')+'\x20'+_0x58e751[_0x10c8b4(0x2b9)]()[_0x10c8b4(0x2ba)]()[_0x10c8b4(0x248)](0x2,'0')+':'+_0x58e751[_0x10c8b4(0x218)]()['toString']()[_0x10c8b4(0x248)](0x2,'0')+':'+_0x58e751['getSeconds']()['toString']()['padStart'](0x2,'0');}function sleep(_0x74204b){return new Promise(_0x3d5d8c=>setTimeout(_0x3d5d8c,_0x74204b));}