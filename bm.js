const _0x35ea9f=_0x56d9;(function(_0x129f5e,_0x5c1aa0){const _0x8d6b9c=_0x56d9,_0x4752d9=_0x129f5e();while(!![]){try{const _0x1ad2fc=-parseInt(_0x8d6b9c(0x214))/0x1+parseInt(_0x8d6b9c(0x36e))/0x2*(parseInt(_0x8d6b9c(0x313))/0x3)+parseInt(_0x8d6b9c(0x383))/0x4*(-parseInt(_0x8d6b9c(0x205))/0x5)+-parseInt(_0x8d6b9c(0x389))/0x6*(parseInt(_0x8d6b9c(0x39b))/0x7)+-parseInt(_0x8d6b9c(0x30e))/0x8*(parseInt(_0x8d6b9c(0x3ab))/0x9)+parseInt(_0x8d6b9c(0x2a7))/0xa*(-parseInt(_0x8d6b9c(0x3b2))/0xb)+parseInt(_0x8d6b9c(0x223))/0xc;if(_0x1ad2fc===_0x5c1aa0)break;else _0x4752d9['push'](_0x4752d9['shift']());}catch(_0x48f684){_0x4752d9['push'](_0x4752d9['shift']());}}}(_0x3875,0x6f814));const _0x5261cc=function(){let _0x1756b8=!![];return function(_0x5f4c83,_0x436d95){const _0x2deb0b=_0x1756b8?function(){const _0x34f52e=_0x56d9;if(_0x436d95){const _0x2bcd9a=_0x436d95[_0x34f52e(0x22f)](_0x5f4c83,arguments);return _0x436d95=null,_0x2bcd9a;}}:function(){};return _0x1756b8=![],_0x2deb0b;};}(),_0x3e4bd0=_0x5261cc(this,function(){const _0x4eb3a8=_0x56d9;return _0x3e4bd0['toString']()['search'](_0x4eb3a8(0x3c6))['toString']()['constructor'](_0x3e4bd0)[_0x4eb3a8(0x31d)](_0x4eb3a8(0x3c6));});_0x3e4bd0();'use strict';process[_0x35ea9f(0x3ba)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x35ea9f(0x26a)),fs=require('fs'),fns=require(_0x35ea9f(0x286)),low=require(_0x35ea9f(0x324)),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require('crypto'),forge=require(_0x35ea9f(0x378)),bcrypt=require('bcryptjs'),jwt=require(_0x35ea9f(0x2aa)),ipaddr=require(_0x35ea9f(0x24e)),argv=require(_0x35ea9f(0x311))(process[_0x35ea9f(0x2c8)][_0x35ea9f(0x207)](0x2))['argv'],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x35ea9f(0x268)),Mixpanel=require(_0x35ea9f(0x319)),axios=require(_0x35ea9f(0x2c5)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x35ea9f(0x2b5)),fileUpload=require(_0x35ea9f(0x3ed)),{networkInterfaces}=require('os'),JSZip=require(_0x35ea9f(0x282)),PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x35ea9f(0x2e5)](PORT)&&(console[_0x35ea9f(0x257)](_0x35ea9f(0x37d)+PORT+_0x35ea9f(0x251)),process[_0x35ea9f(0x3b5)](0x1));const HOST=argv['host']||null,userID=argv[_0x35ea9f(0x3a3)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process['versions'][_0x35ea9f(0x367)];let bbpath='bb/',bbpath2='';const botfile=_0x35ea9f(0x310),configfile='bb-config.json',settingsfile=_0x35ea9f(0x32d),securefile=_0x35ea9f(0x2fb),environment=require('./'+bbpath2+'version.json')[_0x35ea9f(0x28b)]||_0x35ea9f(0x3b8),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x35ea9f(0x1f5)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x35ea9f(0x2bb)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x35ea9f(0x230),logspath=userID?bbpath+_0x35ea9f(0x2db)+userID+'/':bbpath+_0x35ea9f(0x2db),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x35ea9f(0x37e),loggerfile=fs['createWriteStream'](logspath+_0x35ea9f(0x248),{'flags':'a'}),temppath=userID?bbpath+_0x35ea9f(0x3e6)+userID+'/':bbpath+_0x35ea9f(0x3e6);!fs[_0x35ea9f(0x1f5)](configpath)&&fs[_0x35ea9f(0x3e4)](configpath);!fs[_0x35ea9f(0x1f5)](configbackuppath)&&fs[_0x35ea9f(0x3e4)](configbackuppath);!fs[_0x35ea9f(0x1f5)](logspath)&&fs[_0x35ea9f(0x3e4)](logspath);!fs[_0x35ea9f(0x1f5)](zippath)&&fs[_0x35ea9f(0x3e4)](zippath);!fs['existsSync'](temppath)&&fs[_0x35ea9f(0x3e4)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);function _0x56d9(_0x52d8ca,_0x323dbe){const _0xbcf3bf=_0x3875();return _0x56d9=function(_0x3e4bd0,_0x5261cc){_0x3e4bd0=_0x3e4bd0-0x1df;let _0x3875d7=_0xbcf3bf[_0x3e4bd0];return _0x3875d7;},_0x56d9(_0x52d8ca,_0x323dbe);}dbConfig[_0x35ea9f(0x2d1)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x35ea9f(0x2d1)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x35ea9f(0x30f),'onepagemode':![],'marketcapApi':''}})[_0x35ea9f(0x341)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x35ea9f(0x341)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x35ea9f(0x2fe)](_0x35ea9f(0x209),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x35ea9f(0x2b1)]&&(settings[_0x35ea9f(0x2b1)]!=''&&settings[_0x35ea9f(0x2b1)]!=_0x35ea9f(0x2cd))&&settings[_0x35ea9f(0x1ea)]&&settings[_0x35ea9f(0x1ea)]!='')initTelegram();const parseColor=(_0x332dbf,_0x4a8e82)=>{const _0x4d6f51=_0x35ea9f,_0x3b0ddf=/#[A-Z]{3}#/g;if(typeof _0x332dbf==_0x4d6f51(0x2e7)){!_0x4a8e82?_0x332dbf=_0x332dbf[_0x4d6f51(0x21c)](_0x3b0ddf,''):(_0x332dbf=_0x332dbf[_0x4d6f51(0x21c)](/#BLU#/g,_0x4d6f51(0x235)),_0x332dbf=_0x332dbf[_0x4d6f51(0x21c)](/#RED#/g,'\x1b[31m'),_0x332dbf=_0x332dbf[_0x4d6f51(0x21c)](/#YEL#/g,_0x4d6f51(0x32a)),_0x332dbf=_0x332dbf[_0x4d6f51(0x21c)](/#MAG#/g,_0x4d6f51(0x3d9)),_0x332dbf=_0x332dbf[_0x4d6f51(0x21c)](/#CYA#/g,'\x1b[36m'),_0x332dbf=_0x332dbf[_0x4d6f51(0x21c)](/#RES#/g,_0x4d6f51(0x3ef)));;}return _0x332dbf;},logger={'screen':_0x2e2cd7=>{const _0x2d96ed=_0x35ea9f;console[_0x2d96ed(0x257)](parseColor(_0x2e2cd7,!![]));},'simple':_0x2e54a6=>{const _0x24ca60=_0x35ea9f;console[_0x24ca60(0x257)](parseColor(_0x2e54a6,!![])),loggerfile[_0x24ca60(0x341)](util[_0x24ca60(0x263)](parseColor(_0x2e54a6,![]))+'\x0a');},'full':async _0x2d746e=>{const _0x1e1142=_0x35ea9f,_0x554559=getTimeStamp()+_0x1e1142(0x20e)+_0x2d746e;console[_0x1e1142(0x257)](parseColor(_0x554559,!![])),loggerfile['write'](util[_0x1e1142(0x263)](parseColor(_0x554559,![]))+'\x0a');if(tgBot&&settings[_0x1e1142(0x242)]&&settings[_0x1e1142(0x343)]!=_0x1e1142(0x3d3))await sendTelegram(settings[_0x1e1142(0x242)],_0x1e1142(0x359)+parseColor(_0x2d746e,![]));},'debug':async(_0x7e3a8d,_0x7e5fa4='')=>{const _0x56ef98=_0x35ea9f,_0x2b5bce=getTimeStamp()+_0x56ef98(0x28e)+_0x7e3a8d;if(debugging)console[_0x56ef98(0x257)](parseColor(_0x2b5bce,!![]));loggerfile[_0x56ef98(0x341)](util[_0x56ef98(0x263)](parseColor(_0x2b5bce,![]))+'\x0a');if(_0x7e5fa4){if(debugging)console['log'](_0x7e5fa4);loggerfile[_0x56ef98(0x341)](util['format'](_0x7e5fa4)+'\x0a');}}};let terminating=![];process['on'](_0x35ea9f(0x206),function(_0x40d204){const _0x34e0e5=_0x35ea9f;_0x40d204[_0x34e0e5(0x309)]()[_0x34e0e5(0x2c4)]('address\x20already\x20in\x20use')?(logger[_0x34e0e5(0x1e0)](_0x34e0e5(0x35f)+_0x40d204[_0x34e0e5(0x3a9)]+_0x34e0e5(0x238)),process[_0x34e0e5(0x374)]({'terminate':!![]},_0x4de8e0=>{})):logger[_0x34e0e5(0x1e0)](_0x40d204);}),process['on'](_0x35ea9f(0x3b5),()=>{const _0x26095b=_0x35ea9f;stopAllBots(),process[_0x26095b(0x3b5)](0x0);}),process['on']('SIGTERM',()=>{const _0xa2aeb1=_0x35ea9f;stopAllBots(),process[_0xa2aeb1(0x3b5)](0x0);}),process['on'](_0x35ea9f(0x2fc),()=>{const _0x2ff322=_0x35ea9f;stopAllBots(),process[_0x2ff322(0x3b5)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x35ea9f(0x21a))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')[_0x35ea9f(0x385)](app);app[_0x35ea9f(0x254)](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x1182f5,_0x3d3035)=>{const _0x38045d=_0x35ea9f,_0x106cb7=_0x1182f5['params'][_0x38045d(0x318)],_0x5eefe4=getClientsWithBotID(_0x38045d(0x1ee)),_0x281e65=_0x1182f5[_0x38045d(0x3e9)][_0x38045d(0x37f)],_0x28a5b7=timelyDecrypt(_0x281e65,![]),_0x5be4fa=_0x5eefe4[_0x38045d(0x26b)](_0x4334ed=>_0x4334ed[_0x38045d(0x37f)]==_0x28a5b7);if(_0x5be4fa){const _0x3b41aa=normalizeIP(_0x1182f5[_0x38045d(0x351)][_0x38045d(0x215)])[_0x38045d(0x2cb)],_0x165aad=_0x1182f5[_0x38045d(0x3e9)][_0x38045d(0x297)];if(validateAccess(_0x165aad,_0x28a5b7,_0x3b41aa)['allow'])_0x106cb7=='backup'&&await backupConfigFiles(),await zipFiles(_0x106cb7),_0x3d3035[_0x38045d(0x1f7)](zippath+(_0x106cb7+_0x38045d(0x1fa)),_0x494e8d=>{const _0x33ee09=_0x38045d;_0x494e8d&&(logger[_0x33ee09(0x2f2)]('Failed\x20to\x20download\x20'+_0x106cb7),logger[_0x33ee09(0x1e0)](_0x494e8d));});else logger[_0x38045d(0x2f2)](_0x38045d(0x3d5)+_0x106cb7+'\x20(1)');}else logger[_0x38045d(0x2f2)](_0x38045d(0x3d5)+_0x106cb7+_0x38045d(0x1f0));}),app[_0x35ea9f(0x222)](_0x35ea9f(0x2d5),async(_0x103371,_0x7dffc0)=>{const _0x564c9d=_0x35ea9f,_0xcadcc=getClientsWithBotID(_0x564c9d(0x1ee)),_0x5615fe=_0x103371[_0x564c9d(0x3e9)]['uuid'],_0x446144=timelyDecrypt(_0x5615fe,![]),_0x26a755=_0xcadcc[_0x564c9d(0x26b)](_0x3dd99b=>_0x3dd99b[_0x564c9d(0x37f)]==_0x446144);logger[_0x564c9d(0x3c4)](_0x564c9d(0x380));if(_0x26a755){const _0x3a82c4=normalizeIP(_0x103371['socket'][_0x564c9d(0x215)])['store'],_0x1776f0=_0x103371[_0x564c9d(0x3e9)][_0x564c9d(0x297)];if(validateAccess(_0x1776f0,_0x446144,_0x3a82c4)[_0x564c9d(0x3f0)]){if(_0x103371[_0x564c9d(0x346)]){const _0x2653fa=_0x103371[_0x564c9d(0x346)][_0x564c9d(0x36f)];await _0x2653fa['mv'](temppath+_0x2653fa[_0x564c9d(0x240)]),_0x7dffc0[_0x564c9d(0x374)]({'status':!![],'message':_0x564c9d(0x3d6)});const _0x4f1524=getBotsWithMode();_0x4f1524[_0x564c9d(0x292)]>0x0?confirmRestore(temppath,_0x2653fa[_0x564c9d(0x240)]):unzipFile(temppath,_0x2653fa[_0x564c9d(0x240)]);}}else logger[_0x564c9d(0x2f2)](_0x564c9d(0x340));}else logger[_0x564c9d(0x2f2)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x35ea9f(0x254)](express[_0x35ea9f(0x344)](path[_0x35ea9f(0x3e0)](__dirname,bbpath2,_0x35ea9f(0x395)))),app[_0x35ea9f(0x254)](express[_0x35ea9f(0x344)](path[_0x35ea9f(0x3e0)](__dirname,bbpath2,_0x35ea9f(0x3a4)))),app[_0x35ea9f(0x236)]('/',function(_0x4a6890,_0x50f005){const _0x2bf148=_0x35ea9f;_0x50f005[_0x2bf148(0x2ff)](path['join'](__dirname,bbpath2,'build2',_0x2bf148(0x2a6)));}),app[_0x35ea9f(0x236)](_0x35ea9f(0x29e),function(_0x1cdf46,_0x2c2ac9){const _0x9a6451=_0x35ea9f;_0x2c2ac9[_0x9a6451(0x2ff)](path[_0x9a6451(0x3e0)](__dirname,bbpath2,'build','index.html'));}),app[_0x35ea9f(0x236)](_0x35ea9f(0x36c),(_0x41c209,_0x15ddc8)=>{const _0x535452=_0x35ea9f;_0x15ddc8[_0x535452(0x2ff)](path[_0x535452(0x3e0)](__dirname,bbpath2,_0x535452(0x3a4),'index.html'));}),app[_0x35ea9f(0x236)](_0x35ea9f(0x3b6),(_0x184069,_0x2184b7)=>{const _0x1c4ea7=_0x35ea9f;_0x2184b7[_0x1c4ea7(0x2ff)](path[_0x1c4ea7(0x3e0)](__dirname,bbpath2,'build',_0x1c4ea7(0x2a6)));}),app[_0x35ea9f(0x236)](_0x35ea9f(0x250),(_0x42236e,_0x8611de)=>{const _0x5a42d2=_0x35ea9f;_0x8611de['sendFile'](path[_0x5a42d2(0x3e0)](__dirname,bbpath2,_0x5a42d2(0x3a4),_0x5a42d2(0x2a6)));}),app[_0x35ea9f(0x236)](_0x35ea9f(0x24a),(_0x29c593,_0x46d494)=>{const _0x51514a=_0x35ea9f;_0x46d494[_0x51514a(0x2ff)](path[_0x51514a(0x3e0)](__dirname,bbpath2,'build','index.html'));}),app[_0x35ea9f(0x236)]('/:bot/configuration',(_0x24f615,_0x510944)=>{const _0x7f984d=_0x35ea9f;_0x510944['sendFile'](path['join'](__dirname,bbpath2,'build',_0x7f984d(0x2a6)));}),app[_0x35ea9f(0x236)](_0x35ea9f(0x24b),(_0x4205de,_0x2d0e58)=>{const _0x3bcaf6=_0x35ea9f;_0x2d0e58[_0x3bcaf6(0x2ff)](path[_0x3bcaf6(0x3e0)](__dirname,bbpath2,'build',_0x3bcaf6(0x2a6)));});if(HOST)http[_0x35ea9f(0x394)](PORT,HOST);else http[_0x35ea9f(0x394)](PORT);const io=require(_0x35ea9f(0x38b))(http,{});openBrowser&&(async()=>{const _0x3cefcd=_0x35ea9f,_0x33a107=(await import(_0x3cefcd(0x3d7)))['default'];await _0x33a107('http://localhost:'+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x3c766e=_0x35ea9f;let _0x5c848e=_0x3c766e(0x37c);const _0x1469c3=networkInterfaces(),_0x56ff26={};for(const _0x24ec01 of Object[_0x3c766e(0x237)](_0x1469c3)){for(const _0x24d6e1 of _0x1469c3[_0x24ec01]){if((_0x24d6e1[_0x3c766e(0x280)]==_0x3c766e(0x20d)||_0x24d6e1[_0x3c766e(0x280)]==0x4)&&!_0x24d6e1[_0x3c766e(0x1e5)]){const _0xeb2d0e=ipaddr[_0x3c766e(0x2bd)](_0x24d6e1[_0x3c766e(0x349)])[_0x3c766e(0x1e2)]();_0xeb2d0e!=_0x3c766e(0x32c)&&(!_0x56ff26[_0x24ec01]&&(_0x56ff26[_0x24ec01]=[]),_0x56ff26[_0x24ec01]['push'](_0x24d6e1['address']),_0x5c848e=_0x24d6e1[_0x3c766e(0x349)]);}}}return{'serverip':_0x5c848e,'netinterfaces':_0x56ff26};}async function startServer(){const _0xfb5fb1=_0x35ea9f,{serverip:_0xea822,netinterfaces:_0xd75853}=getServerIP();logger[_0xfb5fb1(0x1e0)](''),logger[_0xfb5fb1(0x1e0)](_0xfb5fb1(0x2d9)),await logger[_0xfb5fb1(0x2f2)](_0xfb5fb1(0x34e)+serverversion+_0xfb5fb1(0x2d3)+(environment==_0xfb5fb1(0x2c9)?'(staging)':'')+'\x0a'+(_0xfb5fb1(0x363)+PORT+_0xfb5fb1(0x2c1))+(_0xfb5fb1(0x221)+_0xea822+':'+PORT+_0xfb5fb1(0x1e7))),logger[_0xfb5fb1(0x1e0)](_0xfb5fb1(0x2d9));if(config[_0xfb5fb1(0x292)]!=0x0)for(const _0x596cf8 of config){const _0xf3264c=_0x596cf8['mode']==_0xfb5fb1(0x370)?'a':'m';if(_0x596cf8[_0xfb5fb1(0x39a)]==_0xfb5fb1(0x30a)||_0x596cf8[_0xfb5fb1(0x39a)]==_0xfb5fb1(0x247))await logger[_0xfb5fb1(0x2f2)](_0xfb5fb1(0x342)+_0xf3264c+_0xfb5fb1(0x347)+_0x596cf8[_0xfb5fb1(0x27f)]+'\x20|\x20'+_0x596cf8[_0xfb5fb1(0x32b)]),startBot([_0x596cf8[_0xfb5fb1(0x27f)],userID],{'cwd':bbpath},function(_0x1e026d){if(_0x1e026d)logger['full'](_0x1e026d);});else(_0x596cf8['status']==_0xfb5fb1(0x2e1)||_0x596cf8[_0xfb5fb1(0x39a)]==_0xfb5fb1(0x2ac))&&await logger[_0xfb5fb1(0x2f2)]('Idling\x20('+_0xf3264c+_0xfb5fb1(0x244)+_0x596cf8['botID']+_0xfb5fb1(0x393)+_0x596cf8[_0xfb5fb1(0x32b)]);}else!newBot&&logger[_0xfb5fb1(0x1e0)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0xfb5fb1(0x1e0)](_0xfb5fb1(0x2d9)),logger[_0xfb5fb1(0x1e0)](''),await logger[_0xfb5fb1(0x3c4)](_0xfb5fb1(0x20f)+nodeversion),await logger[_0xfb5fb1(0x3c4)](_0xfb5fb1(0x213),_0xd75853);}function startSocket(){const _0x1fa701=_0x35ea9f;io['on'](_0x1fa701(0x39f),_0x152434=>{const _0x55f643=_0x1fa701;let _0x84124,_0xd173d5,_0x2540c6,_0x46eec1,_0x24c640;const _0x567639=_0x152434[_0x55f643(0x1eb)]['headers'][_0x55f643(0x39c)];_0xd173d5=_0x567639[_0x55f643(0x38e)](/bot[0-9]{3}/);if(_0xd173d5)_0x2540c6=_0xd173d5[0x0]['match'](/[0-9]{3}/);if(_0x2540c6)_0x84124=_0x2540c6[0x0];else _0x84124='botmanager';const _0x122463=_0x152434[_0x55f643(0x1eb)][_0x55f643(0x272)][_0x55f643(0x38d)];if(!_0x122463)_0x152434['emit'](_0x55f643(0x39a),{'publicKey':secure['publicKey']});else{_0x46eec1=timelyDecrypt(_0x122463,![]);if(!_0x46eec1)_0x152434['emit'](_0x55f643(0x39a),{'publicKey':secure[_0x55f643(0x33e)]});else{_0x24c640=normalizeIP(_0x152434[_0x55f643(0x22d)][_0x55f643(0x215)])[_0x55f643(0x2cb)];if(!devices[_0x46eec1])devices[_0x46eec1]={'uuid':_0x46eec1,'access':{'token':null}};devices[_0x46eec1]['ip']=_0x24c640;const _0x49c242=addClient(_0x152434['id'],_0x46eec1,_0x84124);setAccess(_0x49c242),emitMessages(),_0x152434['on'](_0x55f643(0x233),_0x526f2d=>{const _0x3104a6=_0x55f643,_0x3770b8=timelyDecrypt(_0x526f2d[_0x3104a6(0x20c)],!![],'|@|');if(_0x3770b8){_0x526f2d={'username':_0x526f2d['username'],'password':_0x3770b8},devices[_0x46eec1]['access']=validateCredentials(_0x526f2d,_0x46eec1);if(devices[_0x46eec1]['access']['allow']==![]&&devices[_0x46eec1][_0x3104a6(0x1ec)]['reason']==_0x3104a6(0x387))_0x152434[_0x3104a6(0x284)]('status',{'access':devices[_0x46eec1]['access']}),loginAccess2FA(_0x46eec1,_0x24c640);else{if(devices[_0x46eec1][_0x3104a6(0x1ec)]['allow']==![]&&devices[_0x46eec1]['access'][_0x3104a6(0x302)]==_0x3104a6(0x379))_0x152434[_0x3104a6(0x284)](_0x3104a6(0x39a),{'access':devices[_0x46eec1]['access']});else devices[_0x46eec1][_0x3104a6(0x1ec)]['allow']&&devices[_0x46eec1][_0x3104a6(0x1ec)][_0x3104a6(0x302)]==_0x3104a6(0x25a)&&(getClientsWithUuid(_0x46eec1)['forEach'](_0x46d2a1=>{setAccess(_0x46d2a1);}),logger[_0x3104a6(0x3c4)](_0x3104a6(0x25c)+_0x46eec1['slice'](-0x8)),setTokenRefresh(_0x46eec1),setSessionTimeout('login',_0x46eec1));}}else logger[_0x3104a6(0x2f2)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x152434['on'](_0x55f643(0x231),()=>{resetPassword();}),_0x152434['on'](_0x55f643(0x337),_0xbbfff6=>{removeClient(_0x152434['id']);}),_0x84124==_0x55f643(0x1ee)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x519d79){const _0x506570=_0x35ea9f;if(_0x519d79!=_0x506570(0x1ee)&&config[_0x506570(0x227)]!=''){if(pid[_0x519d79])pid[_0x519d79][_0x506570(0x374)]({'function':_0x506570(0x1fb),'args':null});}_0x519d79!=_0x506570(0x1ee)&&broadcastToBots(_0x506570(0x301),JSON['stringify'](config));}function reloadBotManager(){const _0x5e62fa=_0x35ea9f;getClientsWithBotID(_0x5e62fa(0x1ee))[_0x5e62fa(0x1f2)](_0x16c83d=>{const _0x7c0549=_0x5e62fa;getSocket(_0x16c83d['id'])[_0x7c0549(0x284)](_0x7c0549(0x39a),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x65f084){const _0x33d708=_0x35ea9f,_0x112168=io[_0x33d708(0x2d2)][_0x33d708(0x236)]('/');return _0x112168[_0x33d708(0x373)][_0x33d708(0x236)](_0x65f084);}function setAccess(_0x49cafe){const _0x566eaa=_0x35ea9f,_0x49da70=getSocket(_0x49cafe['id']),_0x43fd4f=_0x49cafe['uuid'],_0x250142=_0x49cafe['bot'];devices[_0x43fd4f]['access']=validateAccess(devices[_0x43fd4f]['access'][_0x566eaa(0x30d)],_0x43fd4f),logger['debug']('Setting\x20access:\x20'+devices[_0x43fd4f][_0x566eaa(0x1ec)][_0x566eaa(0x302)]+_0x566eaa(0x3bb)+_0x49cafe['id']['slice'](-0x8)+'\x20|\x20user:\x20...'+_0x43fd4f['slice'](-0x8)),_0x49da70[_0x566eaa(0x3e0)](_0x43fd4f);if(devices[_0x43fd4f][_0x566eaa(0x1ec)][_0x566eaa(0x3f0)]){_0x49da70['join'](_0x250142);if(_0x250142==_0x566eaa(0x1ee))initializeSocketBotManager(_0x49da70);else initializeSocketBot(_0x49da70);initClient(_0x250142);}devices[_0x43fd4f]['access'][_0x566eaa(0x30d)]&&devices[_0x43fd4f][_0x566eaa(0x1ec)]['reason']==_0x566eaa(0x23d)&&setSessionTimeout(_0x566eaa(0x317),_0x43fd4f),devices[_0x43fd4f][_0x566eaa(0x1ec)][_0x566eaa(0x30d)]&&devices[_0x43fd4f]['access'][_0x566eaa(0x302)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x566eaa(0x233),_0x43fd4f),_0x49da70[_0x566eaa(0x284)]('status',{'status':_0x49cafe['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x43fd4f][_0x566eaa(0x1ec)],'externalip':devices[_0x43fd4f]['ip'],'publicKey':secure[_0x566eaa(0x33e)],'userid':settings[_0x566eaa(0x278)],'validInstallation':validInstallation}),devices[_0x43fd4f]['access'][_0x566eaa(0x3f0)]==![]&&devices[_0x43fd4f][_0x566eaa(0x1ec)]['reason']==_0x566eaa(0x34b)&&temporaryAccess2FA(_0x43fd4f,devices[_0x43fd4f]['ip']);}function setSessionTimeout(_0x33b677,_0x36f6ed){const _0x5ba77c=_0x35ea9f;let _0x400252;if(_0x33b677==_0x5ba77c(0x233))_0x400252=loginExpiry*0x3c*0x3e8;else _0x400252=devices[_0x36f6ed][_0x5ba77c(0x3c0)][_0x5ba77c(0x2cc)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x36f6ed][_0x5ba77c(0x3c0)][_0x5ba77c(0x274)]);if(devices[_0x36f6ed]['pidExpireLogin'])clearTimeout(devices[_0x36f6ed][_0x5ba77c(0x2f9)]);devices[_0x36f6ed][_0x5ba77c(0x2f9)]=setTimeout(()=>{const _0x5e71d7=_0x5ba77c;if(devices[_0x36f6ed][_0x5e71d7(0x3ec)])clearTimeout(devices[_0x36f6ed][_0x5e71d7(0x3ec)]);removeSocketListeners(_0x36f6ed),addBlacklist(_0x36f6ed),devices[_0x36f6ed][_0x5e71d7(0x3c0)]=null,devices[_0x36f6ed][_0x5e71d7(0x2d4)]=null,devices[_0x36f6ed]['access']['token']=null,logger[_0x5e71d7(0x3c4)](_0x5e71d7(0x3ac)+_0x36f6ed[_0x5e71d7(0x207)](-0x8)),devices[_0x36f6ed]['access']=validateAccess(devices[_0x36f6ed][_0x5e71d7(0x1ec)][_0x5e71d7(0x30d)],_0x36f6ed),!(devices[_0x36f6ed][_0x5e71d7(0x1ec)]['allow']&&devices[_0x36f6ed][_0x5e71d7(0x1ec)][_0x5e71d7(0x302)]==_0x5e71d7(0x323))&&(_0x33b677==_0x5e71d7(0x233)?io['to'](_0x36f6ed)[_0x5e71d7(0x284)](_0x5e71d7(0x39a),{'access':{'allow':![],'reason':_0x5e71d7(0x3ce),'token':null}}):io['to'](_0x36f6ed)[_0x5e71d7(0x284)](_0x5e71d7(0x39a),{'access':{'allow':![],'reason':_0x5e71d7(0x285),'token':null}})),devices[_0x36f6ed][_0x5e71d7(0x1ec)][_0x5e71d7(0x30d)]=null;},_0x400252);}function setTokenRefresh(_0x240c75){const _0x4848c6=_0x35ea9f;if(devices[_0x240c75][_0x4848c6(0x3ec)])clearTimeout(devices[_0x240c75]['pidRefreshToken']);devices[_0x240c75][_0x4848c6(0x3ec)]=setTimeout(()=>{const _0x3105f9=_0x4848c6;getClientsWithUuid(_0x240c75)[_0x3105f9(0x292)]!=0x0?(devices[_0x240c75][_0x3105f9(0x1ec)]=refreshToken(_0x240c75),io['to'](_0x240c75)['emit'](_0x3105f9(0x39a),{'status':_0x3105f9(0x2be),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x240c75][_0x3105f9(0x1ec)],'externalip':devices[_0x240c75]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x240c75)):clearTimeout(devices[_0x240c75][_0x3105f9(0x3ec)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x163d45){const _0x442fd3=_0x35ea9f,_0x174961=getClient(_0x163d45['id'])[_0x442fd3(0x37f)];_0x163d45[_0x442fd3(0x284)](_0x442fd3(0x301),config),_0x163d45['emit'](_0x442fd3(0x33c),cleanSettings()),_0x163d45['on'](_0x442fd3(0x398),_0x20d465=>{const _0x46620d=_0x442fd3;if(validateAccess(_0x20d465,_0x174961)['allow'])addBot();else logger[_0x46620d(0x2f2)](_0x46620d(0x397));}),_0x163d45['on'](_0x442fd3(0x258),(_0x1f025b,_0x466bc6)=>{const _0x21e256=_0x442fd3;if(validateAccess(_0x466bc6,_0x174961)[_0x21e256(0x3f0)])toggleBot(_0x1f025b[_0x21e256(0x27f)],_0x1f025b[_0x21e256(0x39a)],_0x1f025b[_0x21e256(0x291)]);else logger[_0x21e256(0x2f2)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x163d45['on']('toggle-bot-mode',(_0xf092dd,_0x280644)=>{const _0x442e09=_0x442fd3;if(validateAccess(_0x280644,_0x174961)['allow'])toggleBotMode(_0xf092dd);else logger['full'](_0x442e09(0x3cc));}),_0x163d45['on'](_0x442fd3(0x3cf),(_0xcd3842,_0x56d2e2)=>{const _0x490b99=_0x442fd3;if(validateAccess(_0x56d2e2,_0x174961)[_0x490b99(0x3f0)])deleteBot(_0xcd3842);else logger['full'](_0x490b99(0x3ea));}),_0x163d45['on']('store-settings',(_0x303111,_0x4b4ab5)=>{const _0x55697c=_0x442fd3;if(validateAccess(_0x4b4ab5,_0x174961)[_0x55697c(0x3f0)])storeSettings(_0x303111,!![]);else logger[_0x55697c(0x2f2)](_0x55697c(0x2a4));}),_0x163d45['on'](_0x442fd3(0x203),_0x403f5b=>{const _0x13eb88=_0x442fd3;if(validateAccess(_0x403f5b,_0x174961)[_0x13eb88(0x3f0)])updateBB(_0x13eb88(0x329));else logger['full'](_0x13eb88(0x3cb));}),_0x163d45['on'](_0x442fd3(0x333),_0x3beb01=>{const _0x9d6eb4=_0x442fd3;if(validateAccess(_0x3beb01,_0x174961)[_0x9d6eb4(0x3f0)])updateBB(_0x9d6eb4(0x2d7));else logger[_0x9d6eb4(0x2f2)](_0x9d6eb4(0x3af));}),_0x163d45['on'](_0x442fd3(0x391),_0x2ddaf6=>{const _0x443f15=_0x442fd3;if(validateAccess(_0x2ddaf6,_0x174961)['allow']){const _0x38517b=getClient(_0x163d45['id']);if(_0x38517b)getBackupFiles(_0x38517b['uuid']);else logger[_0x443f15(0x2f2)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x443f15(0x2f2)](_0x443f15(0x39d));}),_0x163d45['on']('restore-backup-file',(_0x358cb0,_0x4ff379)=>{const _0x46a39d=_0x442fd3;if(validateAccess(_0x4ff379,_0x174961)[_0x46a39d(0x3f0)])restoreBackupFile(_0x358cb0);else logger[_0x46a39d(0x2f2)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x163d45['on'](_0x442fd3(0x243),_0x3b2357=>{const _0x4f8103=_0x442fd3;if(validateAccess(_0x3b2357,_0x174961)[_0x4f8103(0x3f0)])getMessages();else logger[_0x4f8103(0x2f2)](_0x4f8103(0x30b));}),_0x163d45['on']('confirm-message',(_0x1c7fca,_0x203780)=>{const _0x5697d6=_0x442fd3;if(validateAccess(_0x203780,_0x174961)[_0x5697d6(0x3f0)])confirmMessage(_0x1c7fca);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x163d45['on'](_0x442fd3(0x259),_0xa97ad0=>{const _0x139ecf=_0x442fd3;if(validateAccess(_0xa97ad0,_0x174961)['allow']){if(devices[_0x174961][_0x139ecf(0x3ec)])clearTimeout(devices[_0x174961][_0x139ecf(0x3ec)]);if(devices[_0x174961][_0x139ecf(0x2f9)])clearTimeout(devices[_0x174961]['pidExpireLogin']);removeSocketListeners(getClient(_0x163d45['id'])[_0x139ecf(0x37f)]),addBlacklist(_0x174961),devices[_0x174961][_0x139ecf(0x3c0)]=null,devices[_0x174961][_0x139ecf(0x2d4)]=null,devices[_0x174961][_0x139ecf(0x1ec)][_0x139ecf(0x30d)]=null,logger[_0x139ecf(0x3c4)](_0x139ecf(0x2ba)+_0x174961['slice'](-0x8)),io['to'](getClient(_0x163d45['id'])[_0x139ecf(0x37f)])[_0x139ecf(0x284)](_0x139ecf(0x39a),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x139ecf(0x2f2)](_0x139ecf(0x24d));});}function initializeSocketBot(_0x2c2cc8){const _0x23b5b8=_0x35ea9f,_0x127537=getClient(_0x2c2cc8['id'])['bot'],_0x1bf2ff=getClient(_0x2c2cc8['id'])[_0x23b5b8(0x37f)];_0x2c2cc8['on'](_0x23b5b8(0x232),(_0x14741d,_0x5ece4e)=>{const _0x48207d=_0x23b5b8;if(validateAccess(_0x5ece4e,_0x1bf2ff)['allow']){if(pid[_0x127537])pid[_0x127537][_0x48207d(0x374)]({'function':_0x48207d(0x255),'args':_0x14741d});}else logger[_0x48207d(0x2f2)](_0x48207d(0x33d));}),_0x2c2cc8['on']('delete-alerts',(_0x33a06a,_0x40e522)=>{const _0x11d1ac=_0x23b5b8;if(validateAccess(_0x40e522,_0x1bf2ff)[_0x11d1ac(0x3f0)]){if(pid[_0x127537])pid[_0x127537][_0x11d1ac(0x374)]({'function':_0x11d1ac(0x358),'args':_0x33a06a});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x2c2cc8['on'](_0x23b5b8(0x3de),(_0x3ed1ff,_0x580ccc)=>{const _0x2c3428=_0x23b5b8;if(validateAccess(_0x580ccc,_0x1bf2ff)['allow']){if(pid[_0x127537])pid[_0x127537][_0x2c3428(0x374)]({'function':'getPortfolio','args':_0x3ed1ff});}else logger[_0x2c3428(0x2f2)](_0x2c3428(0x288));}),_0x2c2cc8['on'](_0x23b5b8(0x2f6),(_0x87973d,_0x264f76)=>{const _0xeeeb6c=_0x23b5b8;if(validateAccess(_0x264f76,_0x1bf2ff)['allow']){if(pid[_0x127537])pid[_0x127537][_0xeeeb6c(0x374)]({'function':_0xeeeb6c(0x314),'args':_0x87973d});}else logger[_0xeeeb6c(0x2f2)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x2c2cc8['on'](_0x23b5b8(0x306),(_0x4a147f,_0x1425a3)=>{const _0x33d6df=_0x23b5b8;if(validateAccess(_0x1425a3,_0x1bf2ff)[_0x33d6df(0x3f0)]){if(pid[_0x127537])pid[_0x127537]['send']({'function':'storeHeadless','args':_0x4a147f});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x2c2cc8['on'](_0x23b5b8(0x368),(_0x1bd831,_0x36e0c4)=>{const _0x2c514f=_0x23b5b8;if(validateAccess(_0x36e0c4,_0x1bf2ff)[_0x2c514f(0x3f0)]){if(pid[_0x127537])pid[_0x127537][_0x2c514f(0x374)]({'function':_0x2c514f(0x3aa),'args':_0x1bd831});}else logger['full'](_0x2c514f(0x338));}),_0x2c2cc8['on'](_0x23b5b8(0x22c),_0x4860ff=>{const _0x4b9792=_0x23b5b8;if(validateAccess(_0x4860ff,_0x1bf2ff)[_0x4b9792(0x3f0)]){if(pid[_0x127537])pid[_0x127537][_0x4b9792(0x374)]({'function':_0x4b9792(0x39e),'args':null});}else logger[_0x4b9792(0x2f2)](_0x4b9792(0x33a));}),_0x2c2cc8['on']('get-starting-balances',_0x53df11=>{const _0x2dfd9f=_0x23b5b8;if(validateAccess(_0x53df11,_0x1bf2ff)[_0x2dfd9f(0x3f0)]){if(pid[_0x127537])pid[_0x127537][_0x2dfd9f(0x374)]({'function':_0x2dfd9f(0x1f8),'args':null});}else logger[_0x2dfd9f(0x2f2)](_0x2dfd9f(0x305));}),_0x2c2cc8['on'](_0x23b5b8(0x38f),(_0x1dafaa,_0x25f996)=>{const _0x352bb8=_0x23b5b8;if(validateAccess(_0x25f996,_0x1bf2ff)[_0x352bb8(0x3f0)]){if(pid[_0x127537])pid[_0x127537][_0x352bb8(0x374)]({'function':'placeOrder','args':_0x1dafaa});}else logger['full'](_0x352bb8(0x3ad));}),_0x2c2cc8['on'](_0x23b5b8(0x35e),_0x53dd00=>{const _0x3f98f5=_0x23b5b8;if(validateAccess(_0x53dd00,_0x1bf2ff)['allow']){if(pid[_0x127537])pid[_0x127537][_0x3f98f5(0x374)]({'function':_0x3f98f5(0x345),'args':null});}else logger['full'](_0x3f98f5(0x365));}),_0x2c2cc8['on'](_0x23b5b8(0x2af),_0x30d726=>{const _0x41b4ec=_0x23b5b8;if(validateAccess(_0x30d726,_0x1bf2ff)[_0x41b4ec(0x3f0)]){if(pid[_0x127537])pid[_0x127537][_0x41b4ec(0x374)]({'function':_0x41b4ec(0x3d8),'args':null});}else logger[_0x41b4ec(0x2f2)](_0x41b4ec(0x36b));}),_0x2c2cc8['on'](_0x23b5b8(0x203),_0x753731=>{const _0x9808c1=_0x23b5b8;if(validateAccess(_0x753731,_0x1bf2ff)['allow'])updateBB(_0x9808c1(0x329));else logger[_0x9808c1(0x2f2)](_0x9808c1(0x3cb));}),_0x2c2cc8['on']('get-messages',_0xa9dcce=>{const _0x1ef48e=_0x23b5b8;if(validateAccess(_0xa9dcce,_0x1bf2ff)['allow'])getMessages();else logger[_0x1ef48e(0x2f2)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x2c2cc8['on'](_0x23b5b8(0x299),(_0x32cbaa,_0x236024)=>{const _0x46f39d=_0x23b5b8;if(validateAccess(_0x236024,_0x1bf2ff)[_0x46f39d(0x3f0)])confirmMessage(_0x32cbaa);else logger[_0x46f39d(0x2f2)](_0x46f39d(0x2bf));}),_0x2c2cc8['on'](_0x23b5b8(0x259),_0x45d8f7=>{const _0x3b9a95=_0x23b5b8;if(validateAccess(_0x45d8f7,_0x1bf2ff)[_0x3b9a95(0x3f0)]){if(devices[_0x1bf2ff][_0x3b9a95(0x3ec)])clearTimeout(devices[_0x1bf2ff][_0x3b9a95(0x3ec)]);if(devices[_0x1bf2ff][_0x3b9a95(0x2f9)])clearTimeout(devices[_0x1bf2ff][_0x3b9a95(0x2f9)]);removeSocketListeners(getClient(_0x2c2cc8['id'])['uuid']),addBlacklist(_0x1bf2ff),devices[_0x1bf2ff][_0x3b9a95(0x3c0)]=null,devices[_0x1bf2ff]['telegram2FaApproval']=null,devices[_0x1bf2ff][_0x3b9a95(0x1ec)][_0x3b9a95(0x30d)]=null,logger[_0x3b9a95(0x3c4)](_0x3b9a95(0x2ba)+_0x1bf2ff[_0x3b9a95(0x207)](-0x8)),io['to'](getClient(_0x2c2cc8['id'])[_0x3b9a95(0x37f)])[_0x3b9a95(0x284)]('status',{'access':{'allow':![],'reason':_0x3b9a95(0x2a5),'token':null}});}else logger[_0x3b9a95(0x2f2)](_0x3b9a95(0x24d));});}function removeSocketListeners(_0x42a47e){const _0x4e2511=_0x35ea9f;getClientsWithUuid(_0x42a47e)[_0x4e2511(0x1f2)](_0x89b642=>{const _0x13e78f=_0x4e2511;getSocket(_0x89b642['id'])[_0x13e78f(0x396)]();});}function cleanSettings(){const _0x211d53=_0x35ea9f;let _0x2c2a3b=settings;return settings[_0x211d53(0x2b1)]&&settings[_0x211d53(0x2b1)]!=''&&(_0x2c2a3b={..._0x2c2a3b,'telegramToken':_0x211d53(0x2ef)}),settings[_0x211d53(0x2f3)]&&settings[_0x211d53(0x2f3)]!=''&&(_0x2c2a3b={..._0x2c2a3b,'bbPassword':_0x211d53(0x2ef)}),settings[_0x211d53(0x31e)]&&settings['marketcapApi']!=''&&(_0x2c2a3b={..._0x2c2a3b,'marketcapApi':_0x211d53(0x2ef)}),(settings[_0x211d53(0x2f3)]&&settings[_0x211d53(0x2f3)]==_0x211d53(0x2cd)||settings[_0x211d53(0x2b1)]&&settings[_0x211d53(0x2b1)]==_0x211d53(0x2cd)||settings[_0x211d53(0x31e)]&&settings[_0x211d53(0x31e)]==_0x211d53(0x2cd))&&(_0x2c2a3b={..._0x2c2a3b,'restored':{'password':settings[_0x211d53(0x2f3)]==_0x211d53(0x2cd),'telegram':settings[_0x211d53(0x2b1)]==_0x211d53(0x2cd),'marketcap':settings['marketcapApi']==_0x211d53(0x2cd)}}),_0x2c2a3b;}async function updateBB(_0x16d22b){const _0xb72fe=_0x35ea9f;await backupConfigFiles(),installingUpdate=!![],config[_0xb72fe(0x1f2)](_0x3f2b19=>{restartBot(_0x3f2b19['botID']);});if(_0x16d22b=='update')process['send']({'update':!![],'environment':environment},_0x3a11f4=>{});else _0x16d22b==_0xb72fe(0x2d7)&&process[_0xb72fe(0x374)]({'reinstall':!![],'environment':environment},_0x39fe08=>{});}function startBot(_0x2409da,_0x1e4c03,_0xf586ce){const _0x51e825=_0x35ea9f;if(debugging)_0x2409da[_0x51e825(0x273)]('-d');if(recreate)_0x2409da['push']('-r');let _0x3af3e0=![];const _0x4d567b=_0x2409da[0x0];_0x1e4c03={..._0x1e4c03,'stdio':[_0x51e825(0x1f6),_0x51e825(0x1f6),_0x51e825(0x1f6),_0x51e825(0x357)]},pid[_0x4d567b]=childProcess['fork'](botfile,_0x2409da,_0x1e4c03),pid[_0x4d567b]['on'](_0x51e825(0x1f4),_0x2f61d6=>{const _0x118885=_0x51e825;switch(Object[_0x118885(0x237)](_0x2f61d6)[0x0]){case _0x118885(0x32b):updateBotName(_0x4d567b,_0x2f61d6[_0x118885(0x32b)]);break;case _0x118885(0x1e8):updateBotManager();break;case _0x118885(0x39a):updateStatus(_0x4d567b,_0x2f61d6['status']);break;case _0x118885(0x291):updateLive(_0x4d567b,_0x2f61d6['live']);break;case _0x118885(0x2e6):updateLive(_0x4d567b,_0x2f61d6[_0x118885(0x2e6)]),io['to'](_0x4d567b)[_0x118885(0x284)](_0x118885(0x39a),{'access':{'allow':![],'reason':_0x118885(0x265),'token':null}});break;case _0x118885(0x29d):_0x2f61d6['stop']==_0x118885(0x37a)&&restartBot(_0x4d567b);_0x2f61d6['stop']=='kill'&&toggleBot(_0x4d567b,_0x118885(0x2e1),'stopped');break;case _0x118885(0x2a8):sendTelegramBot(_0x4d567b,_0x2f61d6[_0x118885(0x2a8)]);break;case'telegrammsg':sendTelegramMsg(_0x2f61d6[_0x118885(0x31a)]);break;case _0x118885(0x3f4):io['to'](_0x4d567b)[_0x118885(0x284)](_0x2f61d6[_0x118885(0x3f4)],_0x2f61d6[_0x118885(0x26e)]);break;}}),pid[_0x4d567b]['on'](_0x51e825(0x2f1),function(_0x4c653b){if(_0x3af3e0)return;_0x3af3e0=!![],_0xf586ce(_0x4c653b);}),pid[_0x4d567b]['on'](_0x51e825(0x3b5),async function(_0x31b740){const _0x8364f2=_0x51e825;if(terminating)return;if(installingUpdate){io[_0x8364f2(0x355)]();return;}if(_0x3af3e0)return;_0x3af3e0=!![],_0xf586ce(null);const _0x4a7af2=dbConfig[_0x8364f2(0x236)]('bots')[_0x8364f2(0x26b)]({'botID':_0x4d567b})[_0x8364f2(0x296)]();_0x4a7af2&&(_0x4a7af2[_0x8364f2(0x39a)]==_0x8364f2(0x30a)||_0x4a7af2[_0x8364f2(0x39a)]==_0x8364f2(0x247))&&(await sleep(0x3e8),updateLive(_0x4d567b,_0x8364f2(0x3ee)),logger[_0x8364f2(0x2f2)](_0x8364f2(0x281)+botRef(_0x4d567b)),startBot([_0x4d567b,userID],{'cwd':bbpath},function(_0x17061b){if(_0x17061b)logger['full'](_0x17061b);}));});}function stopBot(_0x42cd3d){const _0x3d9ae1=_0x35ea9f;getClientsWithBotID(_0x42cd3d)['forEach'](_0x42dfdc=>{const _0x124a7e=_0x56d9;getSocket(_0x42dfdc['id'])[_0x124a7e(0x337)](!![]),removeClient(_0x42dfdc['id']);}),pid[_0x42cd3d]&&(pid[_0x42cd3d][_0x3d9ae1(0x1e9)](),pid[_0x42cd3d]=null);}function stopAllBots(){const _0x37cb33=_0x35ea9f;terminating=!![];const _0x567c7e=getEnabledBots();_0x567c7e[_0x37cb33(0x1f2)](_0x279fdd=>{const _0x340ffc=_0x37cb33;stopBot(_0x279fdd[_0x340ffc(0x27f)]);});}function restartBot(_0x4722af){const _0x5b1dd6=_0x35ea9f;if(pid[_0x4722af])pid[_0x4722af][_0x5b1dd6(0x1e9)]();}function addBot(){const _0xc9008=_0x35ea9f;let _0x2e8063;for(let _0x169bb5=0x1;_0x169bb5<0x3e9;_0x169bb5++){_0x2e8063=_0x169bb5[_0xc9008(0x309)]()[_0xc9008(0x200)](0x3,'0');let _0x29bd75=config[_0xc9008(0x26b)](_0x583a9d=>_0x583a9d[_0xc9008(0x27f)]==_0x2e8063);if(!_0x29bd75)break;}if(_0x2e8063===_0xc9008(0x335)){logger['full'](_0xc9008(0x315));return;}logger[_0xc9008(0x2f2)](_0xc9008(0x26f)+_0x2e8063),dbConfig[_0xc9008(0x236)](_0xc9008(0x301))[_0xc9008(0x273)]({'botID':_0x2e8063,'botname':_0xc9008(0x270)+_0x2e8063,'status':_0xc9008(0x247),'live':''})[_0xc9008(0x341)](),startBot([_0x2e8063,userID],{'cwd':bbpath},function(_0x19d5e0){const _0x1692b1=_0xc9008;if(_0x19d5e0)logger[_0x1692b1(0x2f2)](_0x19d5e0);}),config=getConfiguration(),io['to'](_0xc9008(0x1ee))[_0xc9008(0x284)]('bots',config),broadcastToBots('bots',JSON[_0xc9008(0x1fd)](config));}function deleteBot(_0x1f5018){const _0x45a170=_0x35ea9f;getClientsWithBotID(_0x1f5018)[_0x45a170(0x1f2)](_0x498c43=>{const _0x44720e=_0x45a170;getSocket(_0x498c43['id'])[_0x44720e(0x337)](!![]),removeClient(_0x498c43['id']);}),dbConfig[_0x45a170(0x236)](_0x45a170(0x301))[_0x45a170(0x234)]({'botID':_0x1f5018})[_0x45a170(0x341)](),logger[_0x45a170(0x2f2)](_0x45a170(0x2f5)+_0x1f5018),stopBot(_0x1f5018);try{if(fs[_0x45a170(0x1f5)](path[_0x45a170(0x3e0)](configpath,_0x45a170(0x28a)+_0x1f5018+'-config.json')))fs['unlinkSync'](path[_0x45a170(0x3e0)](configpath,_0x45a170(0x28a)+_0x1f5018+_0x45a170(0x3e8)));if(fs['existsSync'](path['join'](configpath,_0x45a170(0x28a)+_0x1f5018+_0x45a170(0x2fd))))fs['unlinkSync'](path[_0x45a170(0x3e0)](configpath,'bot-'+_0x1f5018+_0x45a170(0x2fd)));if(fs[_0x45a170(0x1f5)](path[_0x45a170(0x3e0)](configpath,'bot-'+_0x1f5018+'-performance.json')))fs[_0x45a170(0x2c3)](path[_0x45a170(0x3e0)](configpath,_0x45a170(0x28a)+_0x1f5018+_0x45a170(0x269)));if(fs[_0x45a170(0x1f5)](path['join'](configpath,_0x45a170(0x28a)+_0x1f5018+_0x45a170(0x360))))fs[_0x45a170(0x2c3)](path['join'](configpath,'bot-'+_0x1f5018+_0x45a170(0x360)));}catch(_0x5557ad){if(_0x5557ad)logger[_0x45a170(0x2f2)](_0x45a170(0x2e4),_0x5557ad);}config=getConfiguration(),io['to'](_0x45a170(0x1ee))[_0x45a170(0x284)](_0x45a170(0x301),config),broadcastToBots('bots',JSON[_0x45a170(0x1fd)](config));}function toggleBot(_0x563fff,_0x4a87d5,_0x5c236f){const _0x1b60dc=_0x35ea9f;dbConfig[_0x1b60dc(0x236)](_0x1b60dc(0x301))['find']({'botID':_0x563fff})[_0x1b60dc(0x20b)]({'status':_0x4a87d5})[_0x1b60dc(0x20b)]({'live':_0x5c236f})[_0x1b60dc(0x341)]();const _0x412a13=botRef(_0x563fff);if(_0x4a87d5==_0x1b60dc(0x30a)||_0x4a87d5==_0x1b60dc(0x247))logger['full'](_0x1b60dc(0x23b)+_0x412a13),startBot([_0x563fff,userID],{'cwd':bbpath},function(_0xa4a4a5){const _0x53f400=_0x1b60dc;if(_0xa4a4a5)logger[_0x53f400(0x2f2)](_0xa4a4a5);});else(_0x4a87d5=='disabled'||_0x4a87d5==_0x1b60dc(0x2ac))&&(logger[_0x1b60dc(0x2f2)](_0x1b60dc(0x381)+_0x412a13),stopBot(_0x563fff));config=getConfiguration(),io['to']('botmanager')[_0x1b60dc(0x284)](_0x1b60dc(0x301),config),broadcastToBots(_0x1b60dc(0x301),JSON['stringify'](config));}function toggleStatus(_0x2862c9){const _0x1716ff=_0x35ea9f;let _0x31dbd7=dbConfig['get'](_0x1716ff(0x301))[_0x1716ff(0x26b)]({'botID':_0x2862c9})[_0x1716ff(0x296)](),_0x280d65;if(_0x31dbd7[_0x1716ff(0x39a)]===_0x1716ff(0x30a))_0x280d65=_0x1716ff(0x2e1);else{if(_0x31dbd7[_0x1716ff(0x39a)]===_0x1716ff(0x247))_0x280d65=_0x1716ff(0x2ac);else{if(_0x31dbd7['status']===_0x1716ff(0x2ac))_0x280d65=_0x1716ff(0x247);else{if(_0x31dbd7[_0x1716ff(0x39a)]===_0x1716ff(0x2e1))_0x280d65=_0x1716ff(0x30a);}}}return _0x280d65;}function updateStatus(_0x3d897e,_0x1af9a3){const _0x17c62f=_0x35ea9f;dbConfig['get'](_0x17c62f(0x301))[_0x17c62f(0x26b)]({'botID':_0x3d897e})[_0x17c62f(0x20b)]({'status':_0x1af9a3})[_0x17c62f(0x341)](),config=getConfiguration(),io['to'](_0x17c62f(0x1ee))['emit'](_0x17c62f(0x301),config),broadcastToBots(_0x17c62f(0x301),JSON[_0x17c62f(0x1fd)](config));}function updateLive(_0x278530,_0x1d62bc){const _0x2f38eb=_0x35ea9f;dbConfig['get'](_0x2f38eb(0x301))[_0x2f38eb(0x26b)]({'botID':_0x278530})[_0x2f38eb(0x20b)]({'live':_0x1d62bc})[_0x2f38eb(0x341)](),config=getConfiguration(),io['to'](_0x2f38eb(0x1ee))['emit'](_0x2f38eb(0x301),config),broadcastToBots(_0x2f38eb(0x301),JSON[_0x2f38eb(0x1fd)](config));}function updateBotName(_0x4d0138,_0x1cd6ee){const _0x2bea15=_0x35ea9f;dbConfig[_0x2bea15(0x236)]('bots')[_0x2bea15(0x26b)]({'botID':_0x4d0138})['assign']({'botname':_0x1cd6ee})[_0x2bea15(0x341)](),config=getConfiguration(),io['to'](_0x2bea15(0x1ee))[_0x2bea15(0x284)]('bots',config),broadcastToBots('bots',JSON[_0x2bea15(0x1fd)](config));}function updateBotManager(){const _0x1b94bb=_0x35ea9f;config=getConfiguration(),io['to'](_0x1b94bb(0x1ee))[_0x1b94bb(0x284)](_0x1b94bb(0x301),config),broadcastToBots(_0x1b94bb(0x301),JSON['stringify'](config));}function toggleBotMode(_0x735606){const _0x4220c2=_0x35ea9f;if(pid[_0x735606])pid[_0x735606]['send']({'function':_0x4220c2(0x3b7),'args':null});else{const _0x3fddbb=configpath+_0x4220c2(0x28a)+_0x735606+_0x4220c2(0x3e8),_0x1f2bfd=fs[_0x4220c2(0x212)](_0x3fddbb),_0x1b810d=JSON['parse'](_0x1f2bfd),_0x476e00=_0x1b810d['bot'][0x0]['headless'];_0x1b810d['bot'][0x0]['headless']=!_0x476e00;const _0x105cf5=JSON[_0x4220c2(0x1fd)](_0x1b810d,null,0x2);fs[_0x4220c2(0x2ca)](_0x3fddbb,_0x105cf5),config=getConfiguration(),io['to'](_0x4220c2(0x1ee))[_0x4220c2(0x284)](_0x4220c2(0x301),config),broadcastToBots(_0x4220c2(0x301),JSON['stringify'](config));}}function validateTelegram(_0x11a53a){const _0x39c8e0=_0x35ea9f;if(_0x11a53a['from'][_0x39c8e0(0x392)]!=settings[_0x39c8e0(0x1ea)]&&'@'+_0x11a53a[_0x39c8e0(0x2e2)]['username']!=settings[_0x39c8e0(0x1ea)]||_0x11a53a[_0x39c8e0(0x316)]['id']!=settings['telegramChatId'])return sendTelegram(_0x11a53a[_0x39c8e0(0x316)]['id'],_0x39c8e0(0x322),{'parse_mode':_0x39c8e0(0x23f)}),![];return!![];}function botRef(_0x3edc48){const _0x1d6701=_0x35ea9f,_0x3d272f=getBotAttributes(_0x3edc48),_0x22c719=_0x3d272f[_0x1d6701(0x201)]?_0x3d272f[_0x1d6701(0x32b)]:_0x1d6701(0x270)+_0x3edc48;return _0x22c719;}async function initTelegram(){const _0x3416d2=_0x35ea9f;tgBot&&(await tgBot[_0x3416d2(0x29d)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x3416d2(0x2b1)]);let _0x38acbe=_0x3416d2(0x2ea);_0x38acbe+='\x0a',_0x38acbe+=_0x3416d2(0x2ed),_0x38acbe+=_0x3416d2(0x3e2),_0x38acbe+=_0x3416d2(0x2c6),_0x38acbe+=_0x3416d2(0x362),_0x38acbe+=_0x3416d2(0x339),_0x38acbe+=_0x3416d2(0x24f),_0x38acbe+=_0x3416d2(0x34d),_0x38acbe+=_0x3416d2(0x330),_0x38acbe+=_0x3416d2(0x1e3),_0x38acbe+=_0x3416d2(0x29a),_0x38acbe+=_0x3416d2(0x2b2),_0x38acbe+=_0x3416d2(0x388),_0x38acbe+=_0x3416d2(0x264),_0x38acbe+=_0x3416d2(0x27e),_0x38acbe+=_0x3416d2(0x3a0),_0x38acbe+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x3069c1=_0x3416d2(0x2a2);_0x3069c1+='\x0a',_0x3069c1+=_0x38acbe,tgBot['catch']((_0x2dcbf7,_0x479642)=>{const _0x511ebc=_0x3416d2;logger[_0x511ebc(0x1e0)](getTimeStamp()+_0x511ebc(0x275)),logger[_0x511ebc(0x3c4)](_0x511ebc(0x3dc),_0x2dcbf7);}),tgBot[_0x3416d2(0x254)](async(_0x20c22b,_0x241b4b)=>{const _0x5bd33c=_0x3416d2;if(settings['telegramChatId']||_0x20c22b[_0x5bd33c(0x329)][_0x5bd33c(0x1f4)][_0x5bd33c(0x35b)]!=_0x5bd33c(0x21e)){if(!validateTelegram(_0x20c22b))return;}_0x241b4b();}),tgBot['command'](_0x3416d2(0x2d0),async _0x6d90ce=>{const _0x3e7f56=_0x3416d2;if(_0x6d90ce[_0x3e7f56(0x2e2)][_0x3e7f56(0x392)]==settings[_0x3e7f56(0x1ea)]||'@'+_0x6d90ce['from'][_0x3e7f56(0x392)]==settings[_0x3e7f56(0x1ea)]){if(!settings[_0x3e7f56(0x242)])updateSetting('telegramChatId',_0x6d90ce[_0x3e7f56(0x316)]['id']);else{if(!validateTelegram(_0x6d90ce))return;}}else{if(!validateTelegram(_0x6d90ce))return;}updateSetting(_0x3e7f56(0x3da),!![]),await sendTelegram(_0x6d90ce[_0x3e7f56(0x316)]['id'],_0x3069c1);}),tgBot[_0x3416d2(0x225)]('enable',async _0x570420=>{const _0x4926fb=_0x3416d2;updateSetting(_0x4926fb(0x3da),!![]),await sendTelegram(_0x570420['chat']['id'],'Notifications\x20enabled');}),tgBot[_0x3416d2(0x225)](_0x3416d2(0x372),async _0x57e1c8=>{const _0x17394e=_0x3416d2;await sendTelegram(_0x57e1c8[_0x17394e(0x316)]['id'],_0x17394e(0x353)),updateSetting(_0x17394e(0x3da),![]);}),tgBot[_0x3416d2(0x225)](_0x3416d2(0x3f5),async _0x1632b8=>{const _0x77344f=_0x3416d2,_0x529e8a=Markup[_0x77344f(0x245)]([Markup[_0x77344f(0x295)][_0x77344f(0x384)](_0x77344f(0x3a7),_0x77344f(0x308)),Markup[_0x77344f(0x295)][_0x77344f(0x384)](_0x77344f(0x376),_0x77344f(0x325)),Markup['button']['callback'](_0x77344f(0x1ff),_0x77344f(0x3f2))]);_0x1632b8[_0x77344f(0x3c2)](_0x77344f(0x31c),_0x529e8a);}),tgBot['action'](_0x3416d2(0x308),async _0x20253c=>{const _0xc4faa7=_0x3416d2;_0x20253c[_0xc4faa7(0x3a6)](),updateSetting('telegramEvents',_0xc4faa7(0x3d3)),updateSetting(_0xc4faa7(0x3da),!![]),await sendTelegram(_0x20253c[_0xc4faa7(0x316)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot['action']('config_alerts',async _0x38790e=>{const _0x160c9c=_0x3416d2;_0x38790e[_0x160c9c(0x3a6)](),updateSetting(_0x160c9c(0x343),'alerts'),updateSetting(_0x160c9c(0x3da),!![]),await sendTelegram(_0x38790e[_0x160c9c(0x316)]['id'],_0x160c9c(0x326));}),tgBot[_0x3416d2(0x3a5)]('config_all',async _0xcbd189=>{const _0x382591=_0x3416d2;_0xcbd189[_0x382591(0x3a6)](),updateSetting(_0x382591(0x343),_0x382591(0x35a)),updateSetting(_0x382591(0x3da),!![]),await sendTelegram(_0xcbd189['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot['command'](_0x3416d2(0x39a),async _0x344ecd=>{const _0x2fbbbb=_0x3416d2,_0x50250c=getBotsWithMode();let _0x123e2f=_0x2fbbbb(0x208);config[_0x2fbbbb(0x1f2)](_0x58c4a1=>{const _0x52f979=_0x2fbbbb,_0x1051de=_0x50250c['find'](_0x4541d6=>_0x4541d6[_0x52f979(0x27f)]==_0x58c4a1[_0x52f979(0x27f)])[_0x52f979(0x31b)];_0x123e2f+=_0x52f979(0x270)+_0x58c4a1['botID']+':\x20'+_0x58c4a1['status']+_0x52f979(0x393)+_0x1051de+'\x20|\x20'+_0x58c4a1[_0x52f979(0x291)]+'\x0a';}),_0x123e2f+='\x0a',_0x123e2f+=_0x2fbbbb(0x3b0),_0x123e2f+=!settings[_0x2fbbbb(0x3da)]?'Notifications\x20disabled\x0a':_0x2fbbbb(0x3be),_0x123e2f+=settings[_0x2fbbbb(0x3da)]?settings['telegramEvents']==_0x2fbbbb(0x35a)?_0x2fbbbb(0x2e9):_0x2fbbbb(0x366)+settings[_0x2fbbbb(0x343)]+_0x2fbbbb(0x3a8):'',await sendTelegram(_0x344ecd[_0x2fbbbb(0x316)]['id'],_0x123e2f,{'parse_mode':_0x2fbbbb(0x23f)});}),tgBot['command'](_0x3416d2(0x37a),async _0x2115e8=>{const _0x2a95b5=_0x3416d2,_0x1eef79=getEnabledBots();if(_0x1eef79['length']==0x0)await sendTelegram(_0x2115e8[_0x2a95b5(0x316)]['id'],_0x2a95b5(0x3d1));else{if(_0x1eef79[_0x2a95b5(0x292)]>0x1)_0x1eef79['push']({'botID':'all'});let _0x530e33=[],_0x3040c2=[];const _0xae07c9=_0x1eef79['length']%0x4==0x0||_0x1eef79[_0x2a95b5(0x292)]%0x4==0x3||_0x1eef79[_0x2a95b5(0x292)]%0x3==0x1?0x4:0x3;let _0x51756e=0x0;_0x1eef79[_0x2a95b5(0x1f2)]((_0x533b77,_0x364360)=>{const _0x382682=_0x2a95b5;if(_0x364360%_0xae07c9==0x0)_0x3040c2=[];_0x3040c2[_0x382682(0x273)](Markup[_0x382682(0x295)][_0x382682(0x384)](_0x533b77[_0x382682(0x27f)]==_0x382682(0x35a)?_0x382682(0x26c):botRef(_0x533b77['botID']),_0x382682(0x2fa)+_0x533b77['botID'])),_0x364360%_0xae07c9==0x0&&(_0x530e33[_0x51756e]=_0x3040c2,_0x51756e++);});const _0x2b9336=Markup[_0x2a95b5(0x245)](_0x530e33);_0x2115e8[_0x2a95b5(0x3c2)](_0x2a95b5(0x3e3),_0x2b9336);}}),tgBot[_0x3416d2(0x3a5)](/restart_(.+)/,async _0x4c424a=>{const _0x203356=_0x3416d2,_0x288bdd=_0x4c424a[_0x203356(0x38e)][0x1];_0x4c424a[_0x203356(0x3a6)](),_0x288bdd=='all'?config['forEach'](_0x43ff37=>{const _0x40a4a6=_0x203356;restartBot(_0x43ff37[_0x40a4a6(0x27f)]);}):restartBot(_0x288bdd);}),tgBot[_0x3416d2(0x225)]('on',async _0x538393=>{const _0x565d8b=_0x3416d2,_0x466f31=getDisabledBots();if(_0x466f31[_0x565d8b(0x292)]==0x0)await sendTelegram(_0x538393[_0x565d8b(0x316)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x466f31['length']>0x1)_0x466f31[_0x565d8b(0x273)]({'botID':_0x565d8b(0x35a)});let _0x26d09b=[],_0xbec4cd=[];const _0x2398fe=_0x466f31[_0x565d8b(0x292)]%0x4==0x0||_0x466f31[_0x565d8b(0x292)]%0x4==0x3||_0x466f31[_0x565d8b(0x292)]%0x3==0x1?0x4:0x3;let _0x3d2afc=0x0;_0x466f31[_0x565d8b(0x1f2)]((_0x24ff4b,_0x2fc413)=>{const _0x564ea1=_0x565d8b;if(_0x2fc413%_0x2398fe==0x0)_0xbec4cd=[];_0xbec4cd[_0x564ea1(0x273)](Markup[_0x564ea1(0x295)][_0x564ea1(0x384)](_0x24ff4b[_0x564ea1(0x27f)]==_0x564ea1(0x35a)?_0x564ea1(0x26c):botRef(_0x24ff4b[_0x564ea1(0x27f)]),_0x564ea1(0x303)+_0x24ff4b[_0x564ea1(0x27f)])),_0x2fc413%_0x2398fe==0x0&&(_0x26d09b[_0x3d2afc]=_0xbec4cd,_0x3d2afc++);});const _0x264aa2=Markup['inlineKeyboard'](_0x26d09b);_0x538393[_0x565d8b(0x3c2)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x264aa2);}}),tgBot['action'](/on_(.+)/,async _0x426930=>{const _0x18afe6=_0x3416d2,_0x1ddc13=_0x426930[_0x18afe6(0x38e)][0x1];_0x426930[_0x18afe6(0x3a6)]();if(_0x1ddc13==_0x18afe6(0x35a)){const _0x3d6328=getDisabledBots();await sendTelegram(_0x426930[_0x18afe6(0x316)]['id'],_0x18afe6(0x321)),_0x3d6328[_0x18afe6(0x1f2)](_0x275e29=>{const _0x12b9a1=_0x18afe6;if(_0x275e29['botID']!='all')toggleBot(_0x275e29[_0x12b9a1(0x27f)],toggleStatus(_0x275e29[_0x12b9a1(0x27f)]),_0x12b9a1(0x3ee));});}else await sendTelegram(_0x426930[_0x18afe6(0x316)]['id'],_0x18afe6(0x307)+botRef(_0x1ddc13)),toggleBot(_0x1ddc13,toggleStatus(_0x1ddc13),'stopped');}),tgBot[_0x3416d2(0x225)](_0x3416d2(0x277),async _0xfea39a=>{const _0x432eb8=_0x3416d2,_0x5b038e=getEnabledBots();if(_0x5b038e[_0x432eb8(0x292)]==0x0)await sendTelegram(_0xfea39a[_0x432eb8(0x316)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x5b038e[_0x432eb8(0x292)]>0x1)_0x5b038e['push']({'botID':_0x432eb8(0x35a)});let _0x525ba1=[],_0x1d6062=[];const _0xc011dd=_0x5b038e['length']%0x4==0x0||_0x5b038e[_0x432eb8(0x292)]%0x4==0x3||_0x5b038e[_0x432eb8(0x292)]%0x3==0x1?0x4:0x3;let _0x2f432a=0x0;_0x5b038e['forEach']((_0x4529b4,_0x2d88d5)=>{const _0x371f08=_0x432eb8;if(_0x2d88d5%_0xc011dd==0x0)_0x1d6062=[];_0x1d6062[_0x371f08(0x273)](Markup['button'][_0x371f08(0x384)](_0x4529b4[_0x371f08(0x27f)]=='all'?'All\x20bots':botRef(_0x4529b4[_0x371f08(0x27f)]),_0x371f08(0x218)+_0x4529b4['botID'])),_0x2d88d5%_0xc011dd==0x0&&(_0x525ba1[_0x2f432a]=_0x1d6062,_0x2f432a++);});const _0x198498=Markup[_0x432eb8(0x245)](_0x525ba1);_0xfea39a[_0x432eb8(0x3c2)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x198498);}}),tgBot[_0x3416d2(0x3a5)](/off_(.+)/,async _0x155bb3=>{const _0x192fd5=_0x3416d2,_0x132828=_0x155bb3[_0x192fd5(0x38e)][0x1];_0x155bb3[_0x192fd5(0x3a6)]();if(_0x132828=='all'){const _0x5cc04d=getEnabledBots();await sendTelegram(_0x155bb3['chat']['id'],'Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots'),_0x5cc04d[_0x192fd5(0x1f2)](_0x33ab63=>{const _0x5062bb=_0x192fd5;if(_0x33ab63[_0x5062bb(0x27f)]!='all')toggleBot(_0x33ab63['botID'],toggleStatus(_0x33ab63[_0x5062bb(0x27f)]),_0x5062bb(0x3ee));});}else await sendTelegram(_0x155bb3[_0x192fd5(0x316)]['id'],_0x192fd5(0x2dd)+botRef(_0x132828)),toggleBot(_0x132828,toggleStatus(_0x132828),_0x192fd5(0x3ee));}),tgBot[_0x3416d2(0x225)]('metrics',async _0x131d84=>{const _0x582035=_0x3416d2,_0x50b099=getEnabledBots();if(_0x50b099[_0x582035(0x292)]==0x0)await sendTelegram(_0x131d84[_0x582035(0x316)]['id'],_0x582035(0x3d1));else{if(_0x50b099[_0x582035(0x292)]>0x1){let _0x20c508=[],_0x1a2496=[];const _0x48b9cf=_0x50b099[_0x582035(0x292)]%0x4==0x0||_0x50b099[_0x582035(0x292)]%0x4==0x3||_0x50b099[_0x582035(0x292)]%0x3==0x1?0x4:0x3;let _0x4037f5=0x0;_0x50b099['forEach']((_0x2668fd,_0x5255ee)=>{const _0x458103=_0x582035;if(_0x5255ee%_0x48b9cf==0x0)_0x1a2496=[];_0x1a2496[_0x458103(0x273)](Markup['button']['callback'](botRef(_0x2668fd[_0x458103(0x27f)]),_0x458103(0x3f1)+_0x2668fd[_0x458103(0x27f)])),_0x5255ee%_0x48b9cf==0x0&&(_0x20c508[_0x4037f5]=_0x1a2496,_0x4037f5++);});const _0x56f094=Markup[_0x582035(0x245)](_0x20c508);_0x131d84['reply'](_0x582035(0x2dc),_0x56f094);}else{const _0x59a3a4=_0x50b099[0x0][_0x582035(0x27f)];if(pid[_0x59a3a4])pid[_0x59a3a4]['send']({'function':_0x582035(0x202),'args':null});}}}),tgBot[_0x3416d2(0x3a5)](/metrics_(.+)/,async _0x126278=>{const _0x402c85=_0x3416d2,_0x41f600=_0x126278[_0x402c85(0x38e)][0x1];_0x126278[_0x402c85(0x3a6)]();if(pid[_0x41f600])pid[_0x41f600][_0x402c85(0x374)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x3416d2(0x225)](_0x3416d2(0x2de),async _0x20490c=>{const _0x6509d3=_0x3416d2,_0x165af0=getEnabledBots();if(_0x165af0['length']==0x0)await sendTelegram(_0x20490c[_0x6509d3(0x316)]['id'],_0x6509d3(0x3d1));else{if(_0x165af0[_0x6509d3(0x292)]>0x1){let _0x254920=[],_0x2a3154=[];const _0x23c80c=_0x165af0['length']%0x4==0x0||_0x165af0[_0x6509d3(0x292)]%0x4==0x3||_0x165af0['length']%0x3==0x1?0x4:0x3;let _0x4452f3=0x0;_0x165af0[_0x6509d3(0x1f2)]((_0x274972,_0x419321)=>{const _0x46c6cf=_0x6509d3;if(_0x419321%_0x23c80c==0x0)_0x2a3154=[];_0x2a3154[_0x46c6cf(0x273)](Markup[_0x46c6cf(0x295)][_0x46c6cf(0x384)](botRef(_0x274972['botID']),'portfolio_'+_0x274972[_0x46c6cf(0x27f)])),_0x419321%_0x23c80c==0x0&&(_0x254920[_0x4452f3]=_0x2a3154,_0x4452f3++);});const _0x2c3efb=Markup[_0x6509d3(0x245)](_0x254920);_0x20490c['reply'](_0x6509d3(0x3c7),_0x2c3efb);}else{const _0x56c791=_0x165af0[0x0][_0x6509d3(0x27f)];if(pid[_0x56c791])pid[_0x56c791][_0x6509d3(0x374)]({'function':_0x6509d3(0x2c0),'args':null});}}}),tgBot[_0x3416d2(0x3a5)](/portfolio_(.+)/,async _0x578553=>{const _0x2a5786=_0x3416d2,_0x4e74f5=_0x578553[_0x2a5786(0x38e)][0x1];_0x578553['editMessageReplyMarkup']();if(pid[_0x4e74f5])pid[_0x4e74f5][_0x2a5786(0x374)]({'function':_0x2a5786(0x2c0),'args':null});}),tgBot[_0x3416d2(0x225)]('logs',async _0x2d45f1=>{const _0x91a23c=_0x3416d2,_0x29e6f3=_0x91a23c(0x25d);await zipFiles(_0x29e6f3);const _0xf44ac2=zippath+(_0x29e6f3+_0x91a23c(0x1fa));_0x2d45f1['replyWithDocument']({'source':_0xf44ac2})[_0x91a23c(0x23a)](()=>{})['catch'](_0x458b42=>logger[_0x91a23c(0x3c4)](_0x91a23c(0x267)+_0x29e6f3+_0x91a23c(0x3a2),_0x458b42));}),tgBot[_0x3416d2(0x225)](_0x3416d2(0x1f1),async _0x5b8b3b=>{const _0x44632f=_0x3416d2,_0xc5d760=_0x44632f(0x1f1);await backupConfigFiles(),await zipFiles(_0xc5d760);const _0x4cb17d=zippath+(_0xc5d760+'.zip');_0x5b8b3b['replyWithDocument']({'source':_0x4cb17d})[_0x44632f(0x23a)](()=>{})['catch'](_0x4f2516=>logger[_0x44632f(0x3c4)](_0x44632f(0x267)+_0xc5d760+_0x44632f(0x3a2),_0x4f2516));}),tgBot[_0x3416d2(0x225)](_0x3416d2(0x329),async _0x34a998=>{const _0x423f38=_0x3416d2;await getMessages();if(!updateAvailable)await sendTelegram(_0x34a998[_0x423f38(0x316)]['id'],_0x423f38(0x3a1));else{if(!validInstallation)await sendTelegram(_0x34a998[_0x423f38(0x316)]['id'],_0x423f38(0x361));else{const _0x302ca7=Markup[_0x423f38(0x245)]([Markup[_0x423f38(0x295)]['callback'](_0x423f38(0x386),_0x423f38(0x38c)),Markup[_0x423f38(0x295)][_0x423f38(0x384)]('No',_0x423f38(0x24c))]);_0x34a998[_0x423f38(0x3c2)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x302ca7);}}}),tgBot[_0x3416d2(0x3a5)](/update_(.+)/,async _0x58e642=>{const _0x2de01d=_0x3416d2,_0x17e008=_0x58e642[_0x2de01d(0x38e)][0x1];_0x58e642[_0x2de01d(0x3a6)](),_0x17e008==_0x2de01d(0x229)&&(await sendTelegram(_0x58e642[_0x2de01d(0x316)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0x2de01d(0x329))),_0x17e008=='no'&&await sendTelegram(_0x58e642[_0x2de01d(0x316)]['id'],_0x2de01d(0x241));}),tgBot[_0x3416d2(0x225)](_0x3416d2(0x2d7),async _0x1eccfc=>{const _0x1efd1f=_0x3416d2;if(!validInstallation)await sendTelegram(_0x1eccfc['chat']['id'],_0x1efd1f(0x382));else{const _0x291dea=Markup[_0x1efd1f(0x245)]([Markup['button'][_0x1efd1f(0x384)](_0x1efd1f(0x386),_0x1efd1f(0x23e)),Markup['button'][_0x1efd1f(0x384)]('No',_0x1efd1f(0x217))]);_0x1eccfc[_0x1efd1f(0x3c2)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x291dea);}}),tgBot['action'](/reinstall_(.+)/,async _0x3d0a52=>{const _0x577fa6=_0x3416d2,_0x1564f6=_0x3d0a52['match'][0x1];_0x3d0a52[_0x577fa6(0x3a6)](),_0x1564f6==_0x577fa6(0x229)&&(await sendTelegram(_0x3d0a52['chat']['id'],_0x577fa6(0x2e8)),updateBB(_0x577fa6(0x2d7))),_0x1564f6=='no'&&await sendTelegram(_0x3d0a52['chat']['id'],_0x577fa6(0x266));}),tgBot[_0x3416d2(0x225)]('toggle',async _0x1a8093=>{const _0xeb66c0=_0x3416d2,_0x331188=getBotsWithMode();if(_0x331188[_0xeb66c0(0x292)]==0x0)await sendTelegram(_0x1a8093[_0xeb66c0(0x316)]['id'],_0xeb66c0(0x3d1));else{let _0x52f3de=[],_0x49b922=[];const _0x405563=0x2;let _0x22d4be=0x0;_0x331188[_0xeb66c0(0x1f2)]((_0x38e47d,_0x461045)=>{const _0x237238=_0xeb66c0;if(_0x461045%_0x405563==0x0)_0x49b922=[];_0x49b922[_0x237238(0x273)](Markup['button'][_0x237238(0x384)](botRef(_0x38e47d[_0x237238(0x27f)])+'\x20('+_0x38e47d['mode']+')',_0x237238(0x2ce)+_0x38e47d[_0x237238(0x27f)])),_0x461045%_0x405563==0x0&&(_0x52f3de[_0x22d4be]=_0x49b922,_0x22d4be++);});const _0x153716=Markup[_0xeb66c0(0x245)](_0x52f3de);_0x1a8093['reply'](_0xeb66c0(0x289),_0x153716);}}),tgBot[_0x3416d2(0x3a5)](/toggle_(.+)/,async _0x340ae4=>{const _0x2b3079=_0x3416d2,_0x22f9b9=_0x340ae4[_0x2b3079(0x38e)][0x1];_0x340ae4[_0x2b3079(0x3a6)]();const _0x16f184=getBotsWithMode(),_0x44c39d=_0x16f184[_0x2b3079(0x26b)](_0x253518=>_0x253518[_0x2b3079(0x27f)]==_0x22f9b9),_0x423a28=_0x44c39d[_0x2b3079(0x31b)]==_0x2b3079(0x370)?'manual':_0x2b3079(0x370);await sendTelegram(_0x340ae4[_0x2b3079(0x316)]['id'],_0x2b3079(0x2b8)+botRef(_0x44c39d[_0x2b3079(0x27f)])+_0x2b3079(0x2eb)+_0x423a28+_0x2b3079(0x2f8)),toggleBotMode(_0x22f9b9);}),tgBot[_0x3416d2(0x225)](_0x3416d2(0x27a),async _0x4d7efe=>{let _0x7f8759='';config['forEach'](_0x47f4dc=>{const _0x2a2a6c=_0x56d9;_0x7f8759+='Bot\x20'+_0x47f4dc[_0x2a2a6c(0x27f)]+':\x20'+_0x47f4dc[_0x2a2a6c(0x32b)]+'\x0a';}),await sendTelegram(_0x4d7efe['chat']['id'],_0x7f8759,{'parse_mode':'HTML'});}),tgBot['command'](_0x3416d2(0x21d),async _0x2eb66c=>{const _0x3ea3e4=_0x3416d2;await sendTelegram(_0x2eb66c[_0x3ea3e4(0x316)]['id'],_0x38acbe);}),process['once'](_0x3416d2(0x2fc),()=>tgBot['stop'](_0x3416d2(0x2fc))),process[_0x3416d2(0x35d)](_0x3416d2(0x328),()=>tgBot['stop'](_0x3416d2(0x328))),tgBot[_0x3416d2(0x3eb)]();}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x585aa1,_0x45921f,_0x478ff0){const _0x93184f=_0x35ea9f;_0x478ff0={..._0x478ff0,'disable_web_page_preview':!![]};try{await tgBot[_0x93184f(0x2a8)][_0x93184f(0x3c9)](_0x585aa1,_0x45921f,_0x478ff0);}catch(_0x4b57be){logger[_0x93184f(0x3c4)](_0x93184f(0x261),_0x4b57be);}}async function sendTelegramBot(_0xecf2b4,_0x3ff0d6){const _0x520005=_0x35ea9f;if(settings[_0x520005(0x3da)]){if(settings[_0x520005(0x343)]==_0x520005(0x35a)||(_0x3ff0d6[_0x520005(0x318)]==_0x520005(0x2f1)||_0x3ff0d6[_0x520005(0x318)]=='warning'||_0x3ff0d6['type']=='success')&&settings[_0x520005(0x343)]==_0x520005(0x3b1)||_0x3ff0d6[_0x520005(0x318)]==_0x520005(0x271)&&settings[_0x520005(0x343)]==_0x520005(0x3d3)){if(tgBot&&settings[_0x520005(0x242)]){if(_0x3ff0d6['showname'])await sendTelegram(settings['telegramChatId'],_0x3ff0d6[_0x520005(0x32b)]+_0x520005(0x1f9)+_0x3ff0d6['event']);else await sendTelegram(settings[_0x520005(0x242)],'Bot\x20'+_0xecf2b4+_0x520005(0x1f9)+_0x3ff0d6[_0x520005(0x3e7)]);}}}}async function sendTelegramMsg(_0x4ac680,_0x2e8314=_0x35ea9f(0x23f)){const _0x17d051=_0x35ea9f;return tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x17d051(0x242)],_0x4ac680,{'parse_mode':_0x2e8314}),!![]):![];}function getDeviceWithIp(_0x5819b8){const _0x4c4a64=_0x35ea9f;return devices[_0x4c4a64(0x26b)](_0x4c9cd7=>_0x4c9cd7['ip']===_0x5819b8);}async function temporaryAccess2FA(_0x5ac9b8,_0x4fb056){const _0x1d1a8e=_0x35ea9f;let _0x440a3a=new Date(),_0x4d32c8=![];if(lastIpApproval){if(_0x440a3a-lastIpApproval<0x1388)_0x4d32c8=!![];}lastIpApproval=new Date();if(_0x4d32c8)return;if(tgBot&&settings[_0x1d1a8e(0x242)]){const _0x4475b0=uuidRandom();tmpStorage[_0x4475b0]={'uuid':_0x5ac9b8,'externalip':_0x4fb056};const _0x19e795=Markup[_0x1d1a8e(0x245)]([Markup[_0x1d1a8e(0x295)][_0x1d1a8e(0x384)](_0x1d1a8e(0x2f4),_0x1d1a8e(0x2d6)+_0x4475b0),Markup[_0x1d1a8e(0x295)][_0x1d1a8e(0x384)]('15\x20min','tempaccess_15_'+_0x4475b0),Markup[_0x1d1a8e(0x295)][_0x1d1a8e(0x384)](_0x1d1a8e(0x364),'tempaccess_30_'+_0x4475b0),Markup['button'][_0x1d1a8e(0x384)]('reject',_0x1d1a8e(0x1fc)+_0x4475b0)]);await sendTelegram(settings[_0x1d1a8e(0x242)],_0x1d1a8e(0x2b9)+normalizeIP(_0x4fb056)['show']+'\x20?',_0x19e795),tgBot[_0x1d1a8e(0x3a5)](/tempaccess_(.+)_(.+)/,async _0x360515=>{const _0x179e28=_0x1d1a8e,_0x2842c5=_0x360515[_0x179e28(0x38e)][0x1],_0x59d04e=_0x360515[_0x179e28(0x38e)][0x2],{uuid:_0x51710f,externalip:_0x2ccb14}=tmpStorage[_0x59d04e];delete tmpStorage[_0x59d04e],_0x360515['editMessageReplyMarkup'](),devices[_0x51710f]['telegramIpApproval']={'clientip':_0x2ccb14,'timestamp':new Date()[_0x179e28(0x34c)](),'expiry':_0x2842c5},_0x2842c5!='reject'?(await sendTelegram(_0x360515[_0x179e28(0x316)]['id'],_0x179e28(0x290)+_0x2842c5+_0x179e28(0x3bd),{'parse_mode':_0x179e28(0x23f)}),io['to'](_0x51710f)[_0x179e28(0x284)](_0x179e28(0x39a),{'access':{'allow':![],'reason':_0x179e28(0x265),'token':null}})):(await sendTelegram(_0x360515[_0x179e28(0x316)]['id'],_0x179e28(0x3d4)),io['to'](_0x51710f)['emit'](_0x179e28(0x39a),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x45411a,_0x34b40a){const _0x5e79f4=_0x35ea9f;if(tgBot&&settings['telegramChatId']){const _0x42d83e=uuidRandom();tmpStorage[_0x42d83e]={'uuid':_0x45411a,'externalip':_0x34b40a};const _0xcbe161=Markup[_0x5e79f4(0x245)]([Markup['button'][_0x5e79f4(0x384)](_0x5e79f4(0x3f3),'login2fa_'+loginExpiry+'_'+_0x42d83e),Markup['button'][_0x5e79f4(0x384)](_0x5e79f4(0x327),_0x5e79f4(0x377)+_0x42d83e)]);await sendTelegram(settings[_0x5e79f4(0x242)],_0x5e79f4(0x29b)+normalizeIP(_0x34b40a)[_0x5e79f4(0x32f)]+'\x20?',_0xcbe161),tgBot[_0x5e79f4(0x3a5)](/login2fa_(.+)_(.+)/,async _0x175931=>{const _0x6b7315=_0x5e79f4,_0x4d0b4b=_0x175931[_0x6b7315(0x38e)][0x1],_0x460852=_0x175931[_0x6b7315(0x38e)][0x2],{uuid:_0x18891d,externalip:_0x1ebe74}=tmpStorage[_0x460852];delete tmpStorage[_0x460852],_0x175931[_0x6b7315(0x3a6)](),devices[_0x18891d][_0x6b7315(0x2d4)]={'clientip':_0x1ebe74,'timestamp':new Date()[_0x6b7315(0x34c)](),'expiry':_0x4d0b4b},_0x4d0b4b!='reject'?(await sendTelegram(_0x175931['chat']['id'],_0x6b7315(0x3b9),{'parse_mode':_0x6b7315(0x23f)}),io['to'](_0x18891d)[_0x6b7315(0x284)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x175931['chat']['id'],_0x6b7315(0x3e1)),io['to'](_0x18891d)[_0x6b7315(0x284)](_0x6b7315(0x39a),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4b26fd=_0x35ea9f;return dbConfig['get'](_0x4b26fd(0x301))[_0x4b26fd(0x27c)](_0x4b26fd(0x27f))[_0x4b26fd(0x23c)]({'status':_0x4b26fd(0x30a)})['value']()||[];}function getDisabledBots(){const _0x461eb7=_0x35ea9f;return dbConfig[_0x461eb7(0x236)](_0x461eb7(0x301))[_0x461eb7(0x27c)](_0x461eb7(0x27f))[_0x461eb7(0x23c)]({'status':_0x461eb7(0x2e1)})['value']()||[];}function getBotAttributes(_0x1f8bcf){const _0x4c0d12=_0x35ea9f;let _0x54b26b={};const _0x414223=configpath+'bot-'+_0x1f8bcf+'-config.json',_0x16c600=fs[_0x4c0d12(0x1f5)](_0x414223);if(_0x16c600){const _0x184bb4=fs['readFileSync'](_0x414223);try{const _0x58774b=JSON[_0x4c0d12(0x2bd)](_0x184bb4),_0x1da5f6=_0x58774b?_0x58774b[_0x4c0d12(0x3bf)][0x0][_0x4c0d12(0x332)]:![];_0x54b26b[_0x4c0d12(0x31b)]=_0x1da5f6?_0x4c0d12(0x370):_0x4c0d12(0x22e),_0x54b26b[_0x4c0d12(0x32b)]=_0x58774b?_0x58774b[_0x4c0d12(0x3bf)][0x0]['botname']:_0x4c0d12(0x270)+_0x1f8bcf,_0x54b26b[_0x4c0d12(0x201)]=_0x58774b?_0x58774b[_0x4c0d12(0x3bf)][0x0][_0x4c0d12(0x201)]:![];}catch(_0x509760){_0x54b26b[_0x4c0d12(0x31b)]=_0x4c0d12(0x22e),_0x54b26b[_0x4c0d12(0x32b)]=_0x4c0d12(0x270)+_0x1f8bcf,_0x54b26b[_0x4c0d12(0x201)]=![];}}else _0x54b26b[_0x4c0d12(0x31b)]=_0x4c0d12(0x22e),_0x54b26b[_0x4c0d12(0x32b)]=_0x4c0d12(0x270)+_0x1f8bcf,_0x54b26b[_0x4c0d12(0x201)]=![];return _0x54b26b;}function getBotsWithMode(){const _0x4d8be3=_0x35ea9f,_0x17f81c=dbConfig['get']('bots')[_0x4d8be3(0x27c)](_0x4d8be3(0x27f))[_0x4d8be3(0x296)]()||[];return _0x17f81c[_0x4d8be3(0x1f2)](_0x1f7c4b=>{const _0x392066=_0x4d8be3;let _0x332424=getBotAttributes(_0x1f7c4b[_0x392066(0x27f)]);_0x1f7c4b['mode']=_0x332424[_0x392066(0x31b)];}),_0x17f81c;}function getBotExchanges(){const _0x513caa=_0x35ea9f;let _0x30a599=[];const _0x4b4144=dbConfig[_0x513caa(0x236)]('bots')[_0x513caa(0x27c)](_0x513caa(0x27f))[_0x513caa(0x296)]()||[];_0x4b4144['forEach'](_0x49d407=>{const _0x9065f0=_0x513caa;if(_0x49d407[_0x9065f0(0x39a)]==_0x9065f0(0x30a)){const _0x2bb13f=configpath+_0x9065f0(0x28a)+_0x49d407[_0x9065f0(0x27f)]+'-config.json',_0x399967=fs[_0x9065f0(0x1f5)](_0x2bb13f);let _0x1676ae;if(_0x399967){const _0x2c9458=fs['readFileSync'](_0x2bb13f);try{const _0x43e60b=JSON['parse'](_0x2c9458);_0x1676ae=_0x43e60b?_0x43e60b['bot'][0x0][_0x9065f0(0x1fe)]:null;}catch(_0x20e2f1){}}if(_0x1676ae)_0x30a599[_0x9065f0(0x273)](_0x1676ae);}});const _0x487438=[...new Set(_0x30a599)][_0x513caa(0x2df)]();return _0x487438;}async function initUser(){const _0x31f112=_0x35ea9f;if(!settings[_0x31f112(0x278)]){const _0x4037fa=uuidRandom();mixpanel[_0x31f112(0x25f)](_0x4037fa),updateSetting(_0x31f112(0x278),_0x4037fa);}}async function initSecure(){const _0x5bd651=_0x35ea9f;let _0xf3f94c=getSecure();if(!_0xf3f94c[_0x5bd651(0x300)](_0x5bd651(0x256))){let _0xb12a93=await generateKeys();_0xf3f94c[_0x5bd651(0x33e)]=_0xb12a93[_0x5bd651(0x33e)],_0xf3f94c[_0x5bd651(0x220)]=_0xb12a93[_0x5bd651(0x220)],_0xf3f94c[_0x5bd651(0x256)]=crypto[_0x5bd651(0x260)](0x20)[_0x5bd651(0x309)](_0x5bd651(0x2b3));;storeSecure(_0xf3f94c);}}function getSettings(){const _0xf9dcc5=_0x35ea9f;return dbSettings[_0xf9dcc5(0x236)](_0xf9dcc5(0x33c))['value']()||{};}function getSecure(){const _0x22c152=_0x35ea9f;return dbSecure[_0x22c152(0x236)](_0x22c152(0x3cd))['value']()||{};}function getBlacklist(){const _0x1bee41=_0x35ea9f;return dbSecure[_0x1bee41(0x236)](_0x1bee41(0x375))[_0x1bee41(0x296)]()||[];}function broadcastToBots(_0x576d5c,_0x30a5a9){const _0xceaf25=_0x35ea9f;config[_0xceaf25(0x1f2)](_0x2e1c01=>{const _0x50968f=_0xceaf25;if(_0x2e1c01[_0x50968f(0x39a)]==_0x50968f(0x30a)&&_0x2e1c01[_0x50968f(0x291)]==_0x50968f(0x371)||_0x2e1c01[_0x50968f(0x39a)]==_0x50968f(0x247)&&_0x2e1c01[_0x50968f(0x291)]==_0x50968f(0x371)){if(pid[_0x2e1c01['botID']])pid[_0x2e1c01[_0x50968f(0x27f)]]['send']({[_0x576d5c]:_0x30a5a9});}});}async function storeSettings(_0x2ecfd0,_0x58ee6d=![]){const _0x50faee=_0x35ea9f;_0x2ecfd0={...settings,..._0x2ecfd0};if(_0x58ee6d&&_0x2ecfd0[_0x50faee(0x2f3)]!=_0x50faee(0x2ef)&&_0x2ecfd0[_0x50faee(0x2f3)]!=_0x50faee(0x2cd)&&_0x2ecfd0['bbPassword']!=''){const _0x190366=decryptRSA(secure[_0x50faee(0x220)],_0x2ecfd0[_0x50faee(0x2f3)])[_0x50faee(0x1df)](_0x50faee(0x369))[0x0],_0x187e8d=bcrypt[_0x50faee(0x246)](_0x190366,saltRounds);_0x2ecfd0={..._0x2ecfd0,'bbPassword':_0x187e8d};}if(_0x58ee6d&&_0x2ecfd0['telegramToken']!=_0x50faee(0x2ef)&&_0x2ecfd0[_0x50faee(0x2b1)]!='***'&&_0x2ecfd0['telegramToken']!=''){const _0x218091=decryptRSA(secure[_0x50faee(0x220)],_0x2ecfd0[_0x50faee(0x2b1)])['split'](_0x50faee(0x369))[0x0];_0x2ecfd0={..._0x2ecfd0,'telegramToken':_0x218091};}if(_0x58ee6d&&_0x2ecfd0[_0x50faee(0x31e)]!=_0x50faee(0x2ef)&&_0x2ecfd0[_0x50faee(0x31e)]!='***'&&_0x2ecfd0[_0x50faee(0x31e)]!=''){const _0xb7f74d=decryptRSA(secure[_0x50faee(0x220)],_0x2ecfd0[_0x50faee(0x31e)])[_0x50faee(0x1df)](_0x50faee(0x369))[0x0];_0x2ecfd0={..._0x2ecfd0,'marketcapApi':_0xb7f74d};}const _0x5b3df0=_0x2ecfd0[_0x50faee(0x2b1)]!='************'&&_0x2ecfd0[_0x50faee(0x2b1)]!=settings[_0x50faee(0x2b1)]||_0x2ecfd0[_0x50faee(0x1ea)]!=settings[_0x50faee(0x1ea)],_0x343dbe=_0x2ecfd0[_0x50faee(0x2b1)]==''||_0x2ecfd0[_0x50faee(0x1ea)]=='',_0xa73eeb=_0x2ecfd0['marketcapApi']&&_0x2ecfd0['marketcapApi']!=_0x50faee(0x2ef)&&_0x2ecfd0[_0x50faee(0x31e)]!=settings[_0x50faee(0x31e)];_0x5b3df0&&(_0x2ecfd0[_0x50faee(0x242)]=null,_0x2ecfd0[_0x50faee(0x343)]=_0x50faee(0x35a));for(const [_0x2ae292,_0x16e95b]of Object['entries'](_0x2ecfd0)){if(_0x2ae292==_0x50faee(0x2b1)&&_0x16e95b==_0x50faee(0x2ef)){_0x2ecfd0['telegramToken']=settings['telegramToken'];continue;};if(_0x2ae292==_0x50faee(0x2f3)&&_0x16e95b==_0x50faee(0x2ef)){_0x2ecfd0['bbPassword']=settings[_0x50faee(0x2f3)];continue;};if(_0x2ae292=='marketcapApi'&&_0x16e95b=='************'){_0x2ecfd0[_0x50faee(0x31e)]=settings[_0x50faee(0x31e)];continue;};dbSettings['set'](_0x50faee(0x29c)+_0x2ae292,_0x16e95b)['write']();}settings=_0x2ecfd0,io['to'](_0x50faee(0x1ee))[_0x50faee(0x284)]('settings',cleanSettings()),broadcastToBots(_0x50faee(0x29f),settings[_0x50faee(0x29f)]),broadcastToBots('onepagemode',settings['onepagemode']),broadcastToBots('marketcapApi',settings[_0x50faee(0x31e)]);if(_0x5b3df0&&!_0x343dbe)initTelegram();_0x5b3df0&&_0x343dbe&&(updateSetting(_0x50faee(0x242),null),disableTelegram()),getAllClients()['forEach'](_0x4a76dc=>{const _0x2e3d4a=_0x50faee;getSocket(_0x4a76dc['id'])[_0x2e3d4a(0x284)](_0x2e3d4a(0x39a),{'access':{'allow':![],'reason':_0x2e3d4a(0x265),'token':null}});}),_0xa73eeb&&(await sleep(0xbb8),testMarketcapApi(_0x2ecfd0[_0x50faee(0x31e)]));}async function testMarketcapApi(_0x46e7e3){const _0x5cfe61=_0x35ea9f,_0x485efc=[_0x5cfe61(0x2f7),_0x5cfe61(0x262)];try{await axios[_0x5cfe61(0x236)](_0x5cfe61(0x3bc),{'headers':{'X-CMC_PRO_API_KEY':_0x46e7e3},'params':{'symbol':_0x485efc[_0x5cfe61(0x309)]()}});}catch(_0x102158){_0x102158[_0x5cfe61(0x309)]()[_0x5cfe61(0x2c4)](_0x5cfe61(0x294))?(io['to'](_0x5cfe61(0x1ee))[_0x5cfe61(0x284)](_0x5cfe61(0x2ee),_0x5cfe61(0x2b4)),logger['full'](_0x5cfe61(0x2b4))):(io['to']('botmanager')[_0x5cfe61(0x284)](_0x5cfe61(0x2ee),_0x5cfe61(0x27b)),logger[_0x5cfe61(0x2f2)](_0x5cfe61(0x27b)),logger['debug']('Error\x20details:',_0x102158[_0x5cfe61(0x309)]()+'\x20-\x20'+_0x102158[_0x5cfe61(0x219)]));return;}logger[_0x5cfe61(0x3c4)](_0x5cfe61(0x3ca));}function updateSetting(_0x330c7e,_0xcf2183){const _0x288891=_0x35ea9f;dbSettings[_0x288891(0x3c3)]('settings.'+_0x330c7e,_0xcf2183)[_0x288891(0x341)](),settings=getSettings(),io['to'](_0x288891(0x1ee))[_0x288891(0x284)](_0x288891(0x33c),cleanSettings());}function storeSecure(_0x44a54c){const _0x54f241=_0x35ea9f;dbSecure[_0x54f241(0x236)](_0x54f241(0x3cd))['push'](_0x44a54c)['write'](),secure=_0x44a54c;}function addBlacklist(_0x2753bf){const _0x3a1788=_0x35ea9f;cleanBlacklist();let _0xfd7a74;devices[_0x2753bf]['telegramIpApproval']?_0xfd7a74=Math[_0x3a1788(0x25b)](devices[_0x2753bf][_0x3a1788(0x3c0)]['expiry'],loginExpiry):_0xfd7a74=loginExpiry,dbSecure[_0x3a1788(0x236)]('blacklist')[_0x3a1788(0x273)]({'expiry':new Date()[_0x3a1788(0x34c)]()+_0xfd7a74*0x3c*0x3e8,'token':devices[_0x2753bf][_0x3a1788(0x1ec)][_0x3a1788(0x30d)]})[_0x3a1788(0x341)](),blacklist=dbSecure[_0x3a1788(0x236)](_0x3a1788(0x375))[_0x3a1788(0x296)]();}function cleanBlacklist(){const _0x5f5b10=_0x35ea9f;let _0x112e47=dbSecure['get'](_0x5f5b10(0x375))[_0x5f5b10(0x1e6)]()[_0x5f5b10(0x296)](),_0x27d73b=new Date()['getTime']();_0x112e47[_0x5f5b10(0x1f2)](_0x29c4da=>{const _0xe94253=_0x5f5b10;_0x29c4da[_0xe94253(0x2cc)]<_0x27d73b&&dbSecure[_0xe94253(0x236)](_0xe94253(0x375))[_0xe94253(0x234)]({'expiry':_0x29c4da[_0xe94253(0x2cc)]})[_0xe94253(0x341)]();});}function initStates(){const _0x59bd01=_0x35ea9f;let _0xd736e2=getConfiguration();_0xd736e2[_0x59bd01(0x1f2)](_0x809072=>{const _0x120f90=_0x59bd01;_0x809072[_0x120f90(0x291)]=_0x120f90(0x3ee);}),storeConfiguration(_0xd736e2);}async function generateKeys(){const _0x5f2d64=_0x35ea9f,_0x1542a6=forge['pki']['rsa'][_0x5f2d64(0x2a1)]({'bits':0x1000,'e':0x10001}),_0x1f1566=forge[_0x5f2d64(0x210)][_0x5f2d64(0x36a)](_0x1542a6['privateKey']),_0x2a8257=forge['pki'][_0x5f2d64(0x204)](_0x1542a6['publicKey']);return{'privateKey':_0x1f1566,'publicKey':_0x2a8257};}async function oneTimeMigration(){const _0x2615ba=_0x35ea9f;let _0x6f743f=getSettings(),_0x5bf097=![];!_0x6f743f[_0x2615ba(0x300)](_0x2615ba(0x26d))&&(_0x6f743f[_0x2615ba(0x26d)]=0x0,_0x5bf097=!![]);!_0x6f743f[_0x2615ba(0x300)](_0x2615ba(0x3b4))&&(_0x6f743f[_0x2615ba(0x3b4)]=0x0,_0x5bf097=!![]);!_0x6f743f[_0x2615ba(0x300)](_0x2615ba(0x2bc))&&(_0x6f743f[_0x2615ba(0x2bc)]=_0x2615ba(0x30f),_0x5bf097=!![]);!_0x6f743f[_0x2615ba(0x300)](_0x2615ba(0x34a))&&(_0x6f743f[_0x2615ba(0x34a)]=![],_0x5bf097=!![]);!_0x6f743f[_0x2615ba(0x300)](_0x2615ba(0x31e))&&(_0x6f743f[_0x2615ba(0x31e)]='',_0x5bf097=!![]);if(_0x5bf097)storeSettings(_0x6f743f);try{fs[_0x2615ba(0x211)](configbackuppath,{'withFileTypes':!![]})[_0x2615ba(0x1f2)](_0x4646fa=>{const _0xa83628=_0x2615ba;if(!_0x4646fa[_0xa83628(0x2ad)]()){if(!_0x4646fa[_0xa83628(0x240)]['startsWith'](_0xa83628(0x30c)))fs[_0xa83628(0x2c3)](configbackuppath+_0x4646fa[_0xa83628(0x240)]);}else fs[_0xa83628(0x2b0)](configbackuppath+_0x4646fa[_0xa83628(0x240)],{'recursive':!![]});});}catch(_0x135da9){logger[_0x2615ba(0x3c4)]('Error\x20removing\x20old\x20backup\x20files:',_0x135da9);}}function storeConfiguration(_0x195c70){const _0x31087c=_0x35ea9f;dbConfig[_0x31087c(0x236)]('bots')[_0x31087c(0x234)]()[_0x31087c(0x341)](),dbConfig[_0x31087c(0x236)]('bots')[_0x31087c(0x273)](..._0x195c70)[_0x31087c(0x341)](),config=_0x195c70;}async function resetPassword(){const _0x26ca11=_0x35ea9f;if(tgBot&&settings[_0x26ca11(0x242)]){const _0x196347=Markup['inlineKeyboard']([Markup[_0x26ca11(0x295)][_0x26ca11(0x384)](_0x26ca11(0x229),'resetpw_yes'),Markup[_0x26ca11(0x295)][_0x26ca11(0x384)]('no',_0x26ca11(0x20a))]);await sendTelegram(settings[_0x26ca11(0x242)],_0x26ca11(0x28f),_0x196347),tgBot[_0x26ca11(0x3a5)](/resetpw_(.+)/,async _0x2ad52a=>{const _0x13101e=_0x26ca11,_0x2a7f88=_0x2ad52a[_0x13101e(0x38e)][0x1];_0x2ad52a[_0x13101e(0x3a6)]();if(_0x2a7f88!='no'){const _0x21a1d6=0xf,_0x4f9bb6=_0x13101e(0x1ed),_0x49dfc9=Array[_0x13101e(0x2e2)](crypto[_0x13101e(0x25e)](new Uint32Array(_0x21a1d6)))[_0x13101e(0x2cf)](_0x4b8f75=>_0x4f9bb6[_0x4b8f75%_0x4f9bb6[_0x13101e(0x292)]])['join'](''),_0x1f814e=bcrypt[_0x13101e(0x246)](_0x49dfc9,saltRounds);storeSettings({'bbPassword':_0x1f814e}),await sendTelegram(_0x2ad52a[_0x13101e(0x316)]['id'],_0x13101e(0x2ae)+_0x49dfc9,{'parse_mode':_0x13101e(0x23f)});}else await sendTelegram(_0x2ad52a[_0x13101e(0x316)]['id'],_0x13101e(0x216));});}}async function confirmRestore(_0x4a6bf5,_0x4fb4a3){const _0x249ffc=_0x35ea9f;io['to'](_0x249ffc(0x1ee))['emit'](_0x249ffc(0x2ee),_0x249ffc(0x312),'success');if(tgBot&&settings[_0x249ffc(0x242)]){const _0x5d5d16=uuidRandom();tmpStorage[_0x5d5d16]={'path':_0x4a6bf5,'filename':_0x4fb4a3};const _0x316e10=Markup['inlineKeyboard']([Markup['button'][_0x249ffc(0x384)](_0x249ffc(0x229),_0x249ffc(0x28d)+_0x5d5d16),Markup[_0x249ffc(0x295)]['callback']('no',_0x249ffc(0x224)+_0x5d5d16)]);await sendTelegram(settings['telegramChatId'],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x316e10),tgBot[_0x249ffc(0x3a5)](/restore_(.+)_(.+)/,async _0x1d0674=>{const _0x55655c=_0x249ffc,_0x51a761=_0x1d0674[_0x55655c(0x38e)][0x1],_0x30314a=_0x1d0674[_0x55655c(0x38e)][0x2],{path:_0x2bb4ed,filename:_0x4efa0f}=tmpStorage[_0x30314a];delete tmpStorage[_0x30314a],_0x1d0674[_0x55655c(0x3a6)](),_0x51a761==_0x55655c(0x229)?(logger[_0x55655c(0x3c4)](_0x55655c(0x3db)),await sendTelegram(_0x1d0674[_0x55655c(0x316)]['id'],_0x55655c(0x287),{'parse_mode':_0x55655c(0x23f)}),unzipFile(_0x2bb4ed,_0x4efa0f)):(logger[_0x55655c(0x3c4)]('Restore\x20process\x20aborted'),await sendTelegram(_0x1d0674[_0x55655c(0x316)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x4db404=_0x35ea9f,_0x1912c5=new Date();return _0x1912c5[_0x4db404(0x2b7)]()+'/'+(_0x1912c5[_0x4db404(0x279)]()+0x1)[_0x4db404(0x309)]()[_0x4db404(0x200)](0x2,'0')+'/'+_0x1912c5[_0x4db404(0x2c2)]()[_0x4db404(0x309)]()[_0x4db404(0x200)](0x2,'0')+'\x20'+_0x1912c5[_0x4db404(0x239)]()[_0x4db404(0x309)]()['padStart'](0x2,'0')+':'+_0x1912c5[_0x4db404(0x334)]()[_0x4db404(0x309)]()[_0x4db404(0x200)](0x2,'0')+':'+_0x1912c5['getSeconds']()[_0x4db404(0x309)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x213284=_0x35ea9f,_0x10b106=shiftedTime();return _0x10b106[_0x213284(0x2b7)]()+'/'+(_0x10b106[_0x213284(0x279)]()+0x1)[_0x213284(0x309)]()['padStart'](0x2,'0')+'/'+_0x10b106[_0x213284(0x2c2)]()['toString']()[_0x213284(0x200)](0x2,'0')+'\x20'+_0x10b106[_0x213284(0x239)]()[_0x213284(0x309)]()[_0x213284(0x200)](0x2,'0')+':'+_0x10b106['getMinutes']()['toString']()[_0x213284(0x200)](0x2,'0')+':'+_0x10b106[_0x213284(0x3b3)]()[_0x213284(0x309)]()[_0x213284(0x200)](0x2,'0');}function getCleanTimeStamp(){const _0x36c02d=_0x35ea9f,_0x512e41=shiftedTime();return _0x512e41[_0x36c02d(0x2b7)]()+(_0x512e41['getMonth']()+0x1)[_0x36c02d(0x309)]()[_0x36c02d(0x200)](0x2,'0')+_0x512e41[_0x36c02d(0x2c2)]()[_0x36c02d(0x309)]()[_0x36c02d(0x200)](0x2,'0')+'-'+_0x512e41['getHours']()['toString']()[_0x36c02d(0x200)](0x2,'0')+_0x512e41[_0x36c02d(0x334)]()[_0x36c02d(0x309)]()[_0x36c02d(0x200)](0x2,'0')+_0x512e41[_0x36c02d(0x3b3)]()[_0x36c02d(0x309)]()[_0x36c02d(0x200)](0x2,'0');}function shiftedTime(){const _0x1a939a=_0x35ea9f,_0x3d8357=new Date();let _0x9f3f47=_0x3d8357;if(settings[_0x1a939a(0x29f)]&&settings['timeshift']!==0x0)_0x9f3f47=fns[_0x1a939a(0x2c7)](_0x3d8357,{'hours':settings['timeshift']});return _0x9f3f47;}async function startScheduler(){const _0x4c5f2c=_0x35ea9f,_0x2e22c1=new Date()['getUTCHours'](),_0x132267=shiftedTime()['getHours']();_0x132267==0x4&&backupConfigFiles(),_0x132267==0x0&&(rotateLogFiles(),logger[_0x4c5f2c(0x3c4)](_0x4c5f2c(0x2a3)),logger[_0x4c5f2c(0x3c4)]('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x4c5f2c(0x2d3)+(environment==_0x4c5f2c(0x2c9)?_0x4c5f2c(0x283):'')),logger[_0x4c5f2c(0x3c4)](_0x4c5f2c(0x2a3))),_0x2e22c1%0x6==0x0&&triggerAnalytics(),_0x2e22c1%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x401b57){const _0x188a0b=_0x35ea9f;logger[_0x188a0b(0x3c4)]('Restore\x20backup\x20file\x20'+_0x401b57);const _0x4fec25=getBotsWithMode();_0x4fec25[_0x188a0b(0x292)]>0x0?confirmRestore(configbackuppath,_0x401b57):unzipFile(configbackuppath,_0x401b57);}async function getBackupFiles(_0x25a3e6=null){const _0x4c1721=_0x35ea9f;let _0x53467f=[],_0x24acea=fs[_0x4c1721(0x211)](configbackuppath,{'withFileTypes':!![]});_0x24acea[_0x4c1721(0x2df)]((_0x4655a5,_0xb83e5b)=>_0x4655a5[_0x4c1721(0x240)]<_0xb83e5b[_0x4c1721(0x240)]?0x1:_0xb83e5b[_0x4c1721(0x240)]<_0x4655a5[_0x4c1721(0x240)]?-0x1:0x0),_0x24acea[_0x4c1721(0x1f2)](_0x420df6=>{const _0x2599c4=_0x4c1721;if(!_0x420df6[_0x2599c4(0x2ad)]()&&_0x420df6[_0x2599c4(0x240)][_0x2599c4(0x38a)](_0x2599c4(0x30c))&&_0x420df6[_0x2599c4(0x240)][_0x2599c4(0x252)](_0x2599c4(0x1fa))){const _0x25a435=formatDate(fs[_0x2599c4(0x276)](configbackuppath+_0x420df6['name'])['mtime']);_0x53467f[_0x2599c4(0x273)]({'name':_0x420df6[_0x2599c4(0x240)],'mtime':_0x25a435});}});if(_0x25a3e6)io['to'](_0x25a3e6)[_0x4c1721(0x284)](_0x4c1721(0x37b),_0x53467f);else return _0x53467f;}async function backupConfigFiles(){const _0xbbe746=_0x35ea9f;await zipFiles('backup-full');const _0x430165=getCleanTimeStamp();fs['copyFileSync'](zippath+_0xbbe746(0x34f),configbackuppath+(_0xbbe746(0x30c)+_0x430165+'.zip'));let _0x576ea1=fs[_0xbbe746(0x211)](configbackuppath,{'withFileTypes':!![]});_0x576ea1[_0xbbe746(0x2df)]((_0x4b465c,_0xa3540d)=>_0x4b465c[_0xbbe746(0x240)]<_0xa3540d[_0xbbe746(0x240)]?0x1:_0xa3540d[_0xbbe746(0x240)]<_0x4b465c[_0xbbe746(0x240)]?-0x1:0x0),_0x576ea1['length']>maxBackups&&fs[_0xbbe746(0x2c3)](configbackuppath+_0x576ea1[_0x576ea1[_0xbbe746(0x292)]-0x1][_0xbbe746(0x240)]);}function rotateLogFiles(){const _0x2865e8=_0x35ea9f,_0x1b0614=fs['statSync'](logspath+_0x2865e8(0x3e5)),_0x48ccec=_0x1b0614['size']/0x400;if(_0x48ccec>0x64){let _0x298548=fs[_0x2865e8(0x211)](logspath,{'withFileTypes':!![]});_0x298548['sort']((_0x567eb1,_0x4a59d8)=>_0x567eb1[_0x2865e8(0x240)]<_0x4a59d8['name']?0x1:_0x4a59d8[_0x2865e8(0x240)]<_0x567eb1[_0x2865e8(0x240)]?-0x1:0x0),_0x298548[_0x2865e8(0x1f2)](_0xcf3343=>{const _0x4d46f3=_0x2865e8;if(_0xcf3343[_0x4d46f3(0x240)]==_0x4d46f3(0x3c8))fs['copyFileSync'](logspath+_0xcf3343[_0x4d46f3(0x240)],logspath+_0x4d46f3(0x28c));if(_0xcf3343[_0x4d46f3(0x240)]==_0x4d46f3(0x35c))fs[_0x4d46f3(0x2ec)](logspath+_0xcf3343[_0x4d46f3(0x240)],logspath+_0x4d46f3(0x3c8));_0xcf3343[_0x4d46f3(0x240)]==_0x4d46f3(0x3e5)&&(fs['copyFileSync'](logspath+_0xcf3343[_0x4d46f3(0x240)],logspath+_0x4d46f3(0x35c)),fs[_0x4d46f3(0x2ca)](logspath+_0xcf3343[_0x4d46f3(0x240)],''));});}}function _0x3875(){const _0x2bee68=['apiPassword','address','onepagemode','2FA\x20required','getTime','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Starting\x20#RED#Balance\x20Bot\x20v','backup-full.zip','messages','socket','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Notifications\x20disabled','https://api.ipify.org?format=json','close','exec','ipc','deleteHistoryAlerts','Bot\x20Mgr\x20>\x20','all','text','output-001.log','once','cancel-loading','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','-results.json','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','/restart\x20-\x20restart\x20bot(s)\x0a','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','30\x20min','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Notifications\x20types:\x20','node','store-fiat','|@|','privateKeyToPem','Unauthorized\x20attempt\x20to\x20show\x20configuration','/:bot/portfolio','create','32QNyAie','backupfile','auto','running','disable','sockets','send','blacklist','Alerts','login2fa_reject_','node-forge','invalid\x20credentials','restart','backup-files','[ip-address]','Error:\x20Invalid\x20argument\x20','zip/','uuid','Backup\x20file\x20uploaded','Disabled\x20','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','19556PojKyg','callback','createServer','Yes','2FA\x20login\x20required','/logs\x20-\x20receive\x20log\x20files\x0a','2638098anUqXW','startsWith','socket.io','update_yes','encryptedUuid','match','place-order','isIPv4MappedAddress','get-backup-files','username','\x20|\x20','listen','build2','removeAllListeners','Unauthorized\x20attempt\x20to\x20add\x20bot','add-bot','privateKeyFromPem','status','7OsrHUm','referer','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','resetHistory','connection','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Your\x20installation\x20is\x20already\x20up\x20to\x20date','\x20files\x20over\x20Telegram:','user','build','action','editMessageReplyMarkup','Orders','\x20only\x0a','port','storeFiat','18pmzPho','Session\x20expired\x20for\x20user\x20...','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','data','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','<b>Telegram\x20Bot\x20Status:</b>\x0a','alerts','12331SIycAH','getSeconds','lastmsgemitted','exit','/:bot/performance','toggleBotMode','production','Login\x20accepted','env','\x20|\x20client:\x20...','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','\x20minutes','Notifications\x20enabled\x0a','bot','telegramIpApproval','login\x20required','reply','set','debug','async','(((.+)+)+)+$','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','output-002.log','sendMessage','CoinMarketCap\x20API\x20key\x20validated','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Unauthorized\x20attempt\x20to\x20update\x20bot','secure','access\x20timeout','delete-bot','f2aRequired','No\x20bots\x20running\x20right\x20now','sign','orders','Temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20download\x20','File\x20uploaded','open','showConfig','\x1b[35m','telegramEnabled','Restore\x20process\x20confirmed','Telegraf\x20error:','exp','get-portfolio','Invalid\x20authentication\x20token\x20(2)','join','Login\x20rejected','/disable\x20-\x20disable\x20notifications\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','mkdirSync','output-000.log','temp/','event','-config.json','headers','Unauthorized\x20attempt\x20to\x20delete\x20bot','launch','pidRefreshToken','express-fileupload','stopped','\x1b[0m','allow','metrics_','config_all','accept','function','config','split','simple','whitelistEnabled','range','/status\x20-\x20show\x20bot(s)\x20status\x0a','verify','internal','cloneDeep','#RES#\x20if\x20running\x20on\x20server','updatebotmanager','kill','telegramUsername','handshake','access','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','botmanager','track','\x20(2)','backup','forEach','bbvNew','message','existsSync','inherit','download','getStartingBalances','\x20>\x20','.zip','initclient','tempaccess_reject_','stringify','exchange','All','padStart','showname','sendMetricsTelegram','update-bb','publicKeyToPem','5VQBUZH','uncaughtException','slice','<b>Balance\x20Bot\x20Status:</b>\x0a','6b67f3d61ee94b8f5c80b4affef4c4d9','resetpw_no','assign','password','IPv4',':\x20Bot\x20Mgr\x20>\x20','Node.js\x20v','pki','readdirSync','readFileSync','Network\x20Interfaces:','212673SnBXOd','remoteAddress','Password\x20reset\x20rejected','reinstall_no','off_','code','version.json','title','replace','help','/start','isValid','privateKey','=>\x20Go\x20to\x20#CYA#http://','post','19918728HeInDt','restore_no_','command','Invalid\x20authentication\x20token\x20(1)','apiKey','127.0.0.1','yes','file','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','reset-history','conn','manual','apply','backup/','reset-password','get-logs','login','remove','\x1b[34m','get','keys','#RES#','getHours','then','Enabled\x20','filter','temporary\x20token\x20generated','reinstall_yes','HTML','name','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','telegramChatId','get-messages',')\x20\x20\x20|\x20Bot\x20','inlineKeyboard','hashSync','new','/output-000.log','clientip','/:bot/history','/:bot/support','update_no','Unauthorized\x20attempt\x20to\x20log\x20out','ipaddr.js','/off\x20-\x20stop\x20bot(s)\x0a','/:bot/coins',',\x20must\x20be\x20a\x204\x20digit\x20number','endsWith','temporary\x20access\x20not\x20allowed','use','emitHistory','secret','log','update-bot','logout','login\x20token\x20generated','max','Logged\x20in\x20user\x20...','logs','randomFillSync','alias','randomBytes','Telegram\x20error:','ETH','format','/backup\x20-\x20receive\x20backup\x20files\x0a','reload','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Error\x20sending\x20','telegraf','-performance.json','child_process','find','All\x20bots','lastmsgtelegram','args','Starting\x20new\x20bot\x20|\x20Bot\x20','Bot\x20','order','auth','push','timestamp',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','statSync','off','userid','getMonth','names','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','sortBy','number','/update\x20-\x20update\x20Balance\x20Bot\x0a','botID','family','Restarting\x20','jszip','(staging)','emit','temporary\x20access\x20timeout','date-fns','Restoring\x20bot(s)\x20from\x20backup','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','bot-','environment','output-003.log','restore_yes_',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Access\x20enabled\x20for\x20','live','length','Token\x20blacklisted','status\x20code\x20401','button','value','tkn','bbvReceive','confirm-message','/metrics\x20-\x20show\x20bot\x20performance\x0a','Allow\x20login\x20from\x20IP\x20address\x20','settings.','stop','/:bot','timeshift','::ffff:7f00:1','generateKeyPair','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','--------------------------------------','Unauthorized\x20attempt\x20to\x20update\x20settings','logged\x20out','index.html','3170XkJWIC','telegram','::ffff:127.0.0.1','jsonwebtoken','Markdown','new-disabled','isDirectory','Password\x20has\x20been\x20reset\x20to:\x20','show-config','rmSync','telegramToken','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','hex','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','util','toIPv4MappedAddress','getFullYear','Bot\x20Mgr\x20>\x20Toggling\x20','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Logged\x20out\x20user\x20...','config/','latestversion','parse','connected','Unauthorized\x20attempt\x20to\x20confirm\x20message','sendPortfolioTelegram','#RES#\x20if\x20running\x20locally\x0a','getDate','unlinkSync','includes','axios','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','add','argv','staging','writeFileSync','store','expiry','***','toggle_','map','start','defaults','_nsps','#RES#\x20','telegram2FaApproval','/upload-backup','tempaccess_5_','reinstall','No\x20authentication\x20token','-----------------------------------------------------------------------------------','toIPv4Address','logs/','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Bot\x20Mgr\x20>\x20Stopping\x20','portfolio','sort','binary','disabled','from','success','Error\x20while\x20deleting\x20config\x20files:\x20','test','started','string','Starting\x20Balance\x20Bot\x20reinstallation','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','You\x20can\x20use\x20the\x20following\x20commands:\x0a','\x20to\x20','copyFileSync','/enable\x20-\x20enable\x20notifications\x0a','notification','************','bbUsername','error','full','bbPassword','5\x20min','Deleted\x20Bot\x20','store-configuration','BCT','\x20mode','pidExpireLogin','restart_','bb-secure.json','SIGINT','-events.json','init','sendFile','hasOwnProperty','bots','reason','on_','User\x20has\x20been\x20validated','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','store-headless','Bot\x20Mgr\x20>\x20Starting\x20','config_orders','toString','enabled','Unauthorized\x20attempt\x20to\x20get\x20messages','backup-full@','token','2269408BCrLUg','0.0.0','bot.js','yargs/yargs','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','70647UDYkYH','storeConfiguration','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','chat','2FA','type','mixpanel','telegrammsg','mode','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','search','marketcapApi','DEFLATE','generateAsync','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','login\x20not\x20required','lowdb','config_alerts','Ok,\x20will\x20send\x20alert\x20notifications\x20only','reject','SIGTERM','update','\x1b[33m','botname','private','bb-settings.json','loginRequired','show','/names\x20-\x20show\x20bot\x20names\x0a','RSA-OAEP','headless','reinstall-bb','getMinutes','1000','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','disconnect','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','/on\x20-\x20start\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','::1','settings','Unauthorized\x20attempt\x20to\x20get\x20events','publicKey','any','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','write','Starting\x20(','telegramEvents','static','cancelLoading','files',')\x20|\x20Bot\x20'];_0x3875=function(){return _0x2bee68;};return _0x3875();}async function zipFiles(_0x65ab65){const _0x1ac320=_0x35ea9f;let _0x4b8af9;if(_0x65ab65==_0x1ac320(0x25d))_0x4b8af9=logspath;if(_0x65ab65==_0x1ac320(0x1f1))_0x4b8af9=configpath;if(_0x65ab65=='backup-full')_0x4b8af9=configpath;let _0x4eaae0=fs[_0x1ac320(0x211)](_0x4b8af9,{'withFileTypes':!![]});const _0x2b60f8=new JSZip();_0x4eaae0[_0x1ac320(0x1f2)](_0x2f5198=>{const _0x197214=_0x1ac320;if(!_0x2f5198[_0x197214(0x2ad)]()){let _0x353932=fs[_0x197214(0x212)](_0x4b8af9+_0x2f5198['name']);if(_0x65ab65==_0x197214(0x1f1)){const _0x321b54=/^bot-[0-9]{3}-config.json$/,_0x18605a=_0x321b54['test'](_0x2f5198[_0x197214(0x240)]);if(_0x18605a){const _0x16cdf6=JSON[_0x197214(0x2bd)](_0x353932);if(_0x16cdf6['bot'][0x0]){_0x16cdf6[_0x197214(0x3bf)][0x0]['apiKey']=_0x197214(0x2cd),_0x16cdf6['bot'][0x0]['apiSecret']=_0x197214(0x2cd);if(_0x16cdf6[_0x197214(0x3bf)][0x0][_0x197214(0x348)])_0x16cdf6[_0x197214(0x3bf)][0x0]['apiPassword']='***';}_0x353932=JSON[_0x197214(0x1fd)](_0x16cdf6,null,0x2);}if(_0x2f5198[_0x197214(0x240)]==_0x197214(0x32d)){const _0x639904=JSON['parse'](_0x353932);if(_0x639904[_0x197214(0x33c)]['loginRequired'])_0x639904[_0x197214(0x33c)][_0x197214(0x32e)]=![];if(_0x639904['settings']['bbPassword'])_0x639904[_0x197214(0x33c)][_0x197214(0x2f3)]=_0x197214(0x2cd);if(_0x639904[_0x197214(0x33c)]['telegramToken'])_0x639904['settings'][_0x197214(0x2b1)]='***';if(_0x639904['settings'][_0x197214(0x242)])_0x639904['settings'][_0x197214(0x242)]=null;if(_0x639904[_0x197214(0x33c)][_0x197214(0x31e)])_0x639904[_0x197214(0x33c)]['marketcapApi']=_0x197214(0x2cd);_0x353932=JSON['stringify'](_0x639904,null,0x2);}if(_0x2f5198['name']!=_0x197214(0x2fb))_0x2b60f8[_0x197214(0x22a)](_0x2f5198[_0x197214(0x240)],_0x353932);}else _0x2b60f8[_0x197214(0x22a)](_0x2f5198[_0x197214(0x240)],_0x353932);}});const _0x564ab7=await _0x2b60f8[_0x1ac320(0x320)]({'type':_0x1ac320(0x2e7),'base64':![],'compression':_0x1ac320(0x31f)});fs[_0x1ac320(0x2ca)](zippath+(_0x65ab65+_0x1ac320(0x1fa)),_0x564ab7,_0x1ac320(0x2e0));}async function unzipFile(_0x370c3c,_0x112fbf){const _0x513088=_0x35ea9f;fs[_0x513088(0x211)](configpath,{'withFileTypes':!![]})[_0x513088(0x1f2)](_0x252602=>{const _0x33bb91=_0x513088;if(!_0x252602[_0x33bb91(0x2ad)]())fs[_0x33bb91(0x2b0)](configpath+_0x252602['name']);});const _0x3f6fcb=fs[_0x513088(0x212)](_0x370c3c+_0x112fbf,_0x513088(0x2e0)),_0x738eaa=await JSZip['loadAsync'](_0x3f6fcb,{'base64':![],'checkCRC32':!![]});for(const _0x121559 of Object[_0x513088(0x237)](_0x738eaa[_0x513088(0x346)])){const _0x317954=_0x738eaa[_0x513088(0x346)][_0x121559],_0x425eac=await _0x317954[_0x513088(0x3c5)]('string');fs[_0x513088(0x2ca)](configpath+_0x317954[_0x513088(0x240)],_0x425eac);}fs['readdirSync'](temppath,{'withFileTypes':!![]})['forEach'](_0x56467a=>{const _0x11dfdd=_0x513088;if(!_0x56467a[_0x11dfdd(0x2ad)]())fs[_0x11dfdd(0x2b0)](temppath+_0x56467a['name']);}),logger['debug']('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x513088(0x374)]({'restore':!![]},_0x157f7=>{});}async function getPublicIp(){const _0x2a3715=_0x35ea9f;try{const _0x59eb34=await axios[_0x2a3715(0x236)](_0x2a3715(0x354));publicip=_0x59eb34[_0x2a3715(0x3ae)]['ip'];}catch(_0x536887){}}async function triggerAnalytics(){const _0x8ed5b=_0x35ea9f;if(!publicip)await getPublicIp();const _0x2ee706=getBotsWithMode();let _0x1261fa=0x0;_0x2ee706[_0x8ed5b(0x1f2)](_0xa4f00d=>{const _0x13e800=_0x8ed5b;if(_0xa4f00d[_0x13e800(0x39a)]===_0x13e800(0x30a))_0x1261fa++;});const _0x31df37=getBotExchanges();mixpanel[_0x8ed5b(0x1ef)]('Server',{'distinct_id':settings[_0x8ed5b(0x278)],'ip':publicip,'version':serverversion,'numbots':_0x2ee706['length'],'numbotsenabled':_0x1261fa,'exchanges':_0x31df37,'environment':environment});}async function getMessages(){const _0x496ff9=_0x35ea9f,_0x590034=_0x496ff9(0x352),_0x298608=new GraphQLClient(_0x590034),_0x2d32ab={'authorization':_0x496ff9(0x22b)},_0xc57c8c=serverversion[_0x496ff9(0x1df)]('.'),_0x45b9a5=_0xc57c8c[0x0]+'.'+_0xc57c8c[0x1],_0x51a1b8=Math['min'](settings[_0x496ff9(0x26d)],settings[_0x496ff9(0x3b4)]),_0x415500={'last':parseInt(_0x51a1b8),'bbm':_0x45b9a5},_0xef8008=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xbec3bb;try{_0xbec3bb=await _0x298608['request'](_0xef8008,_0x415500,_0x2d32ab);}catch(_0xcbb4f3){}if(_0xbec3bb&&_0xbec3bb['messages']){let _0xe267c3=settings[_0x496ff9(0x26d)],_0x437787=settings[_0x496ff9(0x26d)];newMessages=[];for(const _0x2d35df of _0xbec3bb[_0x496ff9(0x350)]){newMessages[_0x496ff9(0x273)](_0x2d35df);let _0x54db75=![];_0x2d35df['bbvNew']&&(updateSetting(_0x496ff9(0x2bc),_0x2d35df[_0x496ff9(0x1f3)]),_0x54db75=isNewerVersion(serverversion,_0x2d35df[_0x496ff9(0x1f3)])||serverversion==_0x2d35df[_0x496ff9(0x1f3)]);if(!_0x54db75&&_0x2d35df[_0x496ff9(0x27d)]>_0xe267c3){if(_0x2d35df[_0x496ff9(0x298)]===_0x496ff9(0x33f)||serverversion[_0x496ff9(0x38a)](_0x2d35df[_0x496ff9(0x298)])){let _0x2c9b5a=''+_0x2d35df[_0x496ff9(0x21b)]+'\x0a\x0a'+_0x2d35df[_0x496ff9(0x1f4)];const _0x315142=await sendTelegramMsg(toTelegramMarkdown(_0x2c9b5a),_0x496ff9(0x2ab));_0xe267c3=_0x2d35df['number'];}}_0x437787=_0x2d35df[_0x496ff9(0x27d)];}updateAvailable=isNewerVersion(settings[_0x496ff9(0x2bc)],serverversion),updateSetting('lastmsgtelegram',_0x437787),emitMessages();}}function emitMessages(){const _0x3ef5c0=_0x35ea9f,_0x344b2a=settings[_0x3ef5c0(0x3b4)];let _0x51ce11=[];newMessages[_0x3ef5c0(0x1f2)](_0x1e130f=>{_0x1e130f['number']>_0x344b2a&&_0x51ce11['push'](_0x1e130f);}),_0x51ce11['length']>0x0&&getAllClients()[_0x3ef5c0(0x1f2)](_0x325042=>{const _0x510ebf=_0x3ef5c0;getSocket(_0x325042['id'])[_0x510ebf(0x284)](_0x510ebf(0x1f4),_0x51ce11);});}function confirmMessage(_0x55fcf9){const _0x399b99=_0x35ea9f;updateSetting(_0x399b99(0x3b4),Number(_0x55fcf9));}function isNewerVersion(_0x38ae95,_0x430466){const _0x11786b=_0x35ea9f,_0x1cbcd5=_0x430466[_0x11786b(0x1df)]('.'),_0x2939aa=_0x38ae95[_0x11786b(0x1df)]('.');for(var _0x45e162=0x0;_0x45e162<_0x2939aa['length'];_0x45e162++){const _0x122c19=~~_0x2939aa[_0x45e162],_0x537e5a=~~_0x1cbcd5[_0x45e162];if(_0x122c19>_0x537e5a)return!![];if(_0x122c19<_0x537e5a)return![];}return![];}function toTelegramMarkdown(_0x4014bd){const _0x54d53e=_0x35ea9f,_0xbb1f65=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x357b40=/\*{2}(.+?)\*{2}/gim;return _0x4014bd=_0x4014bd[_0x54d53e(0x21c)](_0xbb1f65,'$1_$2_$3')['replace'](_0x357b40,'*$1*'),_0x4014bd;}async function validateConfigFile(){const _0x56b213=_0x35ea9f,_0x136a3a=dbConfig[_0x56b213(0x236)](_0x56b213(0x301))[_0x56b213(0x27c)](_0x56b213(0x27f))[_0x56b213(0x296)]()||[];if(_0x136a3a[_0x56b213(0x292)]==0x0){let _0x2f2934=0x0,_0xc9a0c3=[];const _0x10aafd=/^bot-([0-9]{3})-config.json$/,_0x16bf00=fs[_0x56b213(0x211)](configpath);_0x16bf00['forEach'](_0x545a7a=>{const _0x11435a=_0x56b213,_0x5f085f=_0x10aafd[_0x11435a(0x356)](_0x545a7a);if(_0x5f085f){const _0x5c8704=_0x5f085f[0x1];let _0x563b38=getBotAttributes(_0x5c8704);_0xc9a0c3['push']({'botID':_0x5c8704,'botname':_0x563b38[_0x11435a(0x32b)],'status':_0x11435a(0x2e1),'live':'stopped'}),_0x2f2934++;}}),_0x2f2934!=0x0&&(dbConfig[_0x56b213(0x236)](_0x56b213(0x301))['assign'](_0xc9a0c3)[_0x56b213(0x341)](),config=_0xc9a0c3,restoredConfigFile=_0x2f2934);}}async function restoreConfigNotify(_0x3c1f37){const _0x20fee3=_0x35ea9f;let _0x2636bd;if(restoredConfigFile==0x1)_0x2636bd='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x2636bd=_0x20fee3(0x336);if(_0x3c1f37)io['to'](_0x20fee3(0x1ee))[_0x20fee3(0x284)](_0x20fee3(0x2ee),_0x2636bd);else{logger[_0x20fee3(0x1e0)](_0x20fee3(0x2d9)),logger[_0x20fee3(0x1e0)](_0x2636bd),logger['simple'](_0x20fee3(0x2d9)),logger['simple']('');if(tgBot&&settings[_0x20fee3(0x242)]&&settings['telegramEvents']!=_0x20fee3(0x3d3))await sendTelegram(settings[_0x20fee3(0x242)],_0x20fee3(0x359)+_0x2636bd);}}function decryptRSA(_0x1c6451,_0x2e6e7a){const _0xc3e4a6=_0x35ea9f,_0xfc737f=forge[_0xc3e4a6(0x210)][_0xc3e4a6(0x399)](_0x1c6451),_0x49cb3f=_0xfc737f['decrypt'](forge['util']['decode64'](_0x2e6e7a),_0xc3e4a6(0x331),{'md':forge['md']['sha256'][_0xc3e4a6(0x36d)](),'mgf1':{'md':forge['md']['sha256'][_0xc3e4a6(0x36d)]()}});return _0x49cb3f;}function validateCredentials(_0x434586,_0x4f76c7){const _0xd0a57=_0x35ea9f;if(_0x434586[_0xd0a57(0x392)]==settings[_0xd0a57(0x2f0)]&&bcrypt['compareSync'](_0x434586[_0xd0a57(0x20c)],settings[_0xd0a57(0x2f3)])){if(settings[_0xd0a57(0x3d0)])return{'allow':![],'reason':_0xd0a57(0x387),'token':null};else{const _0x3c7e80=generateLoginToken(_0x4f76c7);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x3c7e80};}}else return{'allow':![],'reason':_0xd0a57(0x379),'token':null};}function refreshToken(_0x35015b){const _0x5b8cba=_0x35ea9f,_0x10c2a4=generateLoginToken(_0x35015b);return{'allow':!![],'reason':_0x5b8cba(0x25a),'token':_0x10c2a4};}function validateAccess(_0x25963d,_0xeddb0f,_0xea366e){const _0x31026f=_0x35ea9f,_0x2f30ee=_0xea366e?_0xea366e:devices[_0xeddb0f]['ip'];let _0x2545af;const _0x2d8c99=_0x4cf51c=>{const _0xab992=_0x56d9;if(settings['loginRequired']){if(settings[_0xab992(0x3d0)]){if(telegram2FaApproved(_0xeddb0f)){const _0x384e25=generateLoginToken(_0xeddb0f);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x384e25};}else return{'allow':![],'reason':_0xab992(0x3c1),'token':null};}else return _0x2545af=validToken(_0x4cf51c,_0xeddb0f),_0x2545af[_0xab992(0x300)](_0xab992(0x2e3))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x4cf51c}:{'allow':![],'reason':_0xab992(0x3c1),'token':null};}else return{'allow':!![],'reason':_0xab992(0x323),'token':null};};if(settings[_0x31026f(0x1e1)]){let _0x5bd480=[...settings['whitelist'],_0x31026f(0x33b),_0x31026f(0x2a9),_0x31026f(0x228),_0x31026f(0x2a0)];if(_0x5bd480['includes'](_0x2f30ee))return _0x2d8c99(_0x25963d);else{_0x2545af=validToken(_0x25963d,_0xeddb0f);if(_0x2545af[_0x31026f(0x300)](_0x31026f(0x2e3)))return _0x2d8c99(_0x25963d);else{if(telegramIpApproved(_0xeddb0f)){const _0x10a9fa=generateToken(_0xeddb0f);return _0x2545af=_0x2d8c99(_0x25963d),_0x2545af[_0x31026f(0x3f0)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x10a9fa}:_0x2545af;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x31026f(0x253),'token':null};}}}else return _0x2d8c99(_0x25963d);}function timelyDecrypt(_0x2a6456,_0xabee0f,_0x44d036='@'){const _0x59e26e=_0x35ea9f;if(_0x2a6456)try{const _0x5fe84a=decryptRSA(secure[_0x59e26e(0x220)],_0x2a6456),_0x39e228=_0x5fe84a[_0x59e26e(0x1df)](_0x44d036)[0x0],_0x14f8c5=_0x5fe84a[_0x59e26e(0x1df)](_0x44d036)[0x1],_0x2deaa3=new Date()[_0x59e26e(0x34c)]();if(_0xabee0f){if(_0x2deaa3-_0x14f8c5<maxSecretAge*0x3e8)return _0x39e228;else return![];}else return _0x39e228;}catch(_0x5d536d){return![];}else return![];}const validToken=(_0x27c17d,_0x2ffe77)=>{const _0x3ebcdb=_0x35ea9f,_0xf52665=devices[_0x2ffe77]['ip'];if(!_0x27c17d)return{'error':_0x3ebcdb(0x2d8)};for(let _0x2affd1 of blacklist){if(_0x2affd1[_0x3ebcdb(0x30d)]==_0x27c17d)return{'error':_0x3ebcdb(0x293)};}let _0x49018b;try{_0x49018b=jwt[_0x3ebcdb(0x1e4)](_0x27c17d,secure[_0x3ebcdb(0x256)]+_0x2ffe77);}catch{return{'error':_0x3ebcdb(0x226)};}if(!_0x49018b[_0x3ebcdb(0x300)](_0x3ebcdb(0x249))&&!_0x49018b[_0x3ebcdb(0x300)](_0x3ebcdb(0x392))||!_0x49018b[_0x3ebcdb(0x300)](_0x3ebcdb(0x3dd)))return{'error':_0x3ebcdb(0x3df)};if(!_0x49018b[_0x3ebcdb(0x300)](_0x3ebcdb(0x392))&&_0x49018b[_0x3ebcdb(0x300)](_0x3ebcdb(0x249))){const {clientip:_0x669bce}=_0x49018b;return _0xf52665==_0x669bce?{'success':_0x3ebcdb(0x304)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x49018b[_0x3ebcdb(0x300)](_0x3ebcdb(0x392))&&_0x49018b['hasOwnProperty'](_0x3ebcdb(0x249))){const {username:_0x230097,clientip:_0xe65c7}=_0x49018b;return settings[_0x3ebcdb(0x2f0)]==_0x230097&&_0xf52665==_0xe65c7?{'success':_0x3ebcdb(0x304)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x3df717=>{const _0x39d436=_0x35ea9f;if(_0x3df717){const _0x3aed81=devices[_0x3df717]['ip'];return jwt[_0x39d436(0x3d2)]({'username':settings[_0x39d436(0x2f0)],'clientip':_0x3aed81},secure[_0x39d436(0x256)]+_0x3df717,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x15bf14=>{const _0x29703a=_0x35ea9f;if(_0x15bf14){const _0x4a6413=devices[_0x15bf14]['ip'];return jwt[_0x29703a(0x3d2)]({'clientip':_0x4a6413},secure['secret']+_0x15bf14,{'expiresIn':devices[_0x15bf14][_0x29703a(0x3c0)][_0x29703a(0x2cc)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x31f034=>{const _0x5919f1=_0x35ea9f;let _0x3aba6f=![];return devices[_0x31f034][_0x5919f1(0x3c0)]&&devices[_0x31f034]['telegramIpApproval'][_0x5919f1(0x2cc)]!=_0x5919f1(0x327)&&(_0x3aba6f=devices[_0x31f034]['telegramIpApproval'][_0x5919f1(0x249)]==devices[_0x31f034]['ip']&&new Date()[_0x5919f1(0x34c)]()-devices[_0x31f034]['telegramIpApproval'][_0x5919f1(0x274)]<devices[_0x31f034][_0x5919f1(0x3c0)]['expiry']*0x3c*0x3e8),_0x3aba6f;},telegram2FaApproved=_0x2572ca=>{const _0x48f1f3=_0x35ea9f;let _0x5a5699=![];return devices[_0x2572ca]['telegram2FaApproval']&&devices[_0x2572ca]['telegram2FaApproval'][_0x48f1f3(0x2cc)]!=_0x48f1f3(0x327)&&(_0x5a5699=devices[_0x2572ca][_0x48f1f3(0x2d4)][_0x48f1f3(0x249)]==devices[_0x2572ca]['ip']&&new Date()['getTime']()-devices[_0x2572ca][_0x48f1f3(0x2d4)][_0x48f1f3(0x274)]<devices[_0x2572ca][_0x48f1f3(0x2d4)][_0x48f1f3(0x2cc)]*0x3c*0x3e8),_0x5a5699;},normalizeIP=_0x102211=>{const _0x369394=_0x35ea9f;let _0x3a0a72=null,_0x2e068d=null;if(ipaddr[_0x369394(0x21f)](_0x102211)){const _0x46c5a9=ipaddr['parse'](_0x102211);_0x46c5a9['kind']()==='ipv6'?(_0x46c5a9[_0x369394(0x390)]()&&(_0x3a0a72=_0x46c5a9[_0x369394(0x2da)]()[_0x369394(0x309)]()),_0x2e068d=_0x46c5a9[_0x369394(0x309)]()):(_0x3a0a72=_0x46c5a9[_0x369394(0x309)](),_0x2e068d=_0x46c5a9[_0x369394(0x2b6)]()[_0x369394(0x309)]());}return{'show':_0x3a0a72?_0x3a0a72:_0x2e068d,'store':_0x2e068d};};function formatDate(_0x25b49b){const _0x40ec3c=_0x35ea9f;return _0x25b49b[_0x40ec3c(0x2b7)]()+'/'+(_0x25b49b[_0x40ec3c(0x279)]()+0x1)[_0x40ec3c(0x309)]()[_0x40ec3c(0x200)](0x2,'0')+'/'+_0x25b49b['getDate']()[_0x40ec3c(0x309)]()[_0x40ec3c(0x200)](0x2,'0')+'\x20'+_0x25b49b['getHours']()[_0x40ec3c(0x309)]()[_0x40ec3c(0x200)](0x2,'0')+':'+_0x25b49b[_0x40ec3c(0x334)]()['toString']()[_0x40ec3c(0x200)](0x2,'0')+':'+_0x25b49b[_0x40ec3c(0x3b3)]()[_0x40ec3c(0x309)]()[_0x40ec3c(0x200)](0x2,'0');}function sleep(_0xee5b43){return new Promise(_0x35c4d2=>setTimeout(_0x35c4d2,_0xee5b43));}