const _0x15ba34=_0x77ce;(function(_0x1d5894,_0x3dbe4b){const _0x55a093=_0x77ce,_0x5d4af3=_0x1d5894();while(!![]){try{const _0x47357d=-parseInt(_0x55a093(0x24f))/0x1+-parseInt(_0x55a093(0x3d3))/0x2*(parseInt(_0x55a093(0x22f))/0x3)+-parseInt(_0x55a093(0x26c))/0x4+-parseInt(_0x55a093(0x21a))/0x5*(-parseInt(_0x55a093(0x1ff))/0x6)+-parseInt(_0x55a093(0x368))/0x7+-parseInt(_0x55a093(0x2c7))/0x8+parseInt(_0x55a093(0x32f))/0x9;if(_0x47357d===_0x3dbe4b)break;else _0x5d4af3['push'](_0x5d4af3['shift']());}catch(_0x129ed6){_0x5d4af3['push'](_0x5d4af3['shift']());}}}(_0x5b61,0x64274));const _0x2a9874=function(){let _0xa19c4c=!![];return function(_0x3e33bf,_0x214efb){const _0x193516=_0xa19c4c?function(){const _0x875222=_0x77ce;if(_0x214efb){const _0x583530=_0x214efb[_0x875222(0x300)](_0x3e33bf,arguments);return _0x214efb=null,_0x583530;}}:function(){};return _0xa19c4c=![],_0x193516;};}(),_0x29271d=_0x2a9874(this,function(){const _0x4510aa=_0x77ce;return _0x29271d[_0x4510aa(0x1df)]()[_0x4510aa(0x2aa)](_0x4510aa(0x246))['toString']()['constructor'](_0x29271d)[_0x4510aa(0x2aa)](_0x4510aa(0x246));});_0x29271d();'use strict';process[_0x15ba34(0x1da)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x15ba34(0x3c8)),fs=require('fs'),fns=require('date-fns'),low=require('lowdb'),FileSync=require(_0x15ba34(0x1d6)),path=require(_0x15ba34(0x380)),crypto=require(_0x15ba34(0x1f4)),forge=require(_0x15ba34(0x3cc)),bcrypt=require(_0x15ba34(0x238)),jwt=require(_0x15ba34(0x2e2)),ipaddr=require(_0x15ba34(0x3c1)),yargs=require(_0x15ba34(0x1dd)),uuidRandom=require(_0x15ba34(0x344)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require('mixpanel'),axios=require(_0x15ba34(0x265)),{GraphQLClient,gql}=require(_0x15ba34(0x21c)),util=require(_0x15ba34(0x37f)),fileUpload=require(_0x15ba34(0x252)),{networkInterfaces}=require('os'),JSZip=require(_0x15ba34(0x38d)),argv=yargs(process[_0x15ba34(0x264)][_0x15ba34(0x2b5)](0x2))['argv'],PORT=argv['port']||_0x15ba34(0x336),pattern=/^[0-9]{2,4}$/;!pattern[_0x15ba34(0x29b)](PORT)&&(console[_0x15ba34(0x1d4)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x15ba34(0x2e7)),process[_0x15ba34(0x334)](0x1));const HOST=argv[_0x15ba34(0x2b4)]||null,userID=argv[_0x15ba34(0x2dc)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process[_0x15ba34(0x20d)][_0x15ba34(0x251)];let bbpath=_0x15ba34(0x307),bbpath2='';const botfile='bot.js',configfile=_0x15ba34(0x362),settingsfile='bb-settings.json',securefile=_0x15ba34(0x3ac),environment=require('./'+bbpath2+_0x15ba34(0x3d0))[_0x15ba34(0x2ef)]||_0x15ba34(0x33c),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x15ba34(0x229)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x15ba34(0x2b6)+userID+'/':bbpath+_0x15ba34(0x2b6),configbackuppath=configpath+_0x15ba34(0x2ec),logspath=userID?bbpath+_0x15ba34(0x250)+userID+'/':bbpath+_0x15ba34(0x250),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+'zip/',loggerfile=fs[_0x15ba34(0x223)](logspath+_0x15ba34(0x379),{'flags':'a'}),temppath=userID?bbpath+_0x15ba34(0x2d6)+userID+'/':bbpath+'temp/';!fs[_0x15ba34(0x229)](configpath)&&fs[_0x15ba34(0x2ea)](configpath);!fs[_0x15ba34(0x229)](configbackuppath)&&fs[_0x15ba34(0x2ea)](configbackuppath);!fs[_0x15ba34(0x229)](logspath)&&fs[_0x15ba34(0x2ea)](logspath);!fs[_0x15ba34(0x229)](zippath)&&fs[_0x15ba34(0x2ea)](zippath);!fs[_0x15ba34(0x229)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x15ba34(0x24e)]({'bots':[]})[_0x15ba34(0x34d)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x15ba34(0x24e)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x15ba34(0x279),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x15ba34(0x34d)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x15ba34(0x2e5)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x15ba34(0x28f)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x15ba34(0x2ba)]&&(settings[_0x15ba34(0x2ba)]!=''&&settings[_0x15ba34(0x2ba)]!=_0x15ba34(0x326))&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x289aec,_0x4785a5)=>{const _0x30c1ea=_0x15ba34,_0x3db40c=/#[A-Z]{3}#/g;if(typeof _0x289aec==_0x30c1ea(0x385)){!_0x4785a5?_0x289aec=_0x289aec['replace'](_0x3db40c,''):(_0x289aec=_0x289aec[_0x30c1ea(0x3bc)](/#BLU#/g,_0x30c1ea(0x245)),_0x289aec=_0x289aec[_0x30c1ea(0x3bc)](/#RED#/g,_0x30c1ea(0x232)),_0x289aec=_0x289aec[_0x30c1ea(0x3bc)](/#YEL#/g,_0x30c1ea(0x200)),_0x289aec=_0x289aec[_0x30c1ea(0x3bc)](/#MAG#/g,_0x30c1ea(0x21d)),_0x289aec=_0x289aec[_0x30c1ea(0x3bc)](/#CYA#/g,'\x1b[36m'),_0x289aec=_0x289aec[_0x30c1ea(0x3bc)](/#RES#/g,'\x1b[0m'));;}return _0x289aec;},logger={'screen':_0x3c9e6c=>{const _0x523b92=_0x15ba34;console[_0x523b92(0x1d4)](parseColor(_0x3c9e6c,!![]));},'simple':_0xd7abdf=>{const _0x41db67=_0x15ba34;console[_0x41db67(0x1d4)](parseColor(_0xd7abdf,!![])),loggerfile[_0x41db67(0x34d)](util[_0x41db67(0x21f)](parseColor(_0xd7abdf,![]))+'\x0a');},'full':async _0x296cb8=>{const _0x5adb3=_0x15ba34,_0x379e5c=getTimeStamp()+_0x5adb3(0x31b)+_0x296cb8;console[_0x5adb3(0x1d4)](parseColor(_0x379e5c,!![])),loggerfile[_0x5adb3(0x34d)](util[_0x5adb3(0x21f)](parseColor(_0x379e5c,![]))+'\x0a');if(tgBot&&settings[_0x5adb3(0x1d1)]&&settings[_0x5adb3(0x38f)]!=_0x5adb3(0x309))await sendTelegram(settings['telegramChatId'],_0x5adb3(0x233)+parseColor(_0x296cb8,![]));},'debug':async(_0x5d4573,_0x16ca8f='')=>{const _0x258d55=_0x15ba34,_0x390894=getTimeStamp()+_0x258d55(0x1f0)+_0x5d4573;if(debugging)console[_0x258d55(0x1d4)](parseColor(_0x390894,!![]));loggerfile['write'](util['format'](parseColor(_0x390894,![]))+'\x0a');if(_0x16ca8f){if(debugging)console[_0x258d55(0x1d4)](_0x16ca8f);loggerfile[_0x258d55(0x34d)](util['format'](_0x16ca8f)+'\x0a');}}};let terminating=![];process['on'](_0x15ba34(0x28a),function(_0x203b9d){const _0x309c56=_0x15ba34;_0x203b9d[_0x309c56(0x1df)]()[_0x309c56(0x31e)](_0x309c56(0x204))?(logger[_0x309c56(0x1e2)](_0x309c56(0x3ba)+_0x203b9d[_0x309c56(0x2a4)]+_0x309c56(0x253)),process[_0x309c56(0x1dc)]({'terminate':!![]},_0x288ed5=>{})):logger['simple'](_0x203b9d);}),process['on']('exit',()=>{const _0x30a61f=_0x15ba34;stopAllBots(),process[_0x30a61f(0x334)](0x0);}),process['on'](_0x15ba34(0x2b7),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x15ba34(0x27f),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x15ba34(0x301)),app=express(),http=require(_0x15ba34(0x2b9))['createServer'](app);app[_0x15ba34(0x201)](fileUpload({'useTempFiles':!![]})),app[_0x15ba34(0x1d7)]('/download/:type',async(_0x475016,_0x3bdc99)=>{const _0x265298=_0x15ba34,_0x96b70e=_0x475016['params'][_0x265298(0x2c8)],_0x51d1d7=getClientsWithBotID(_0x265298(0x209)),_0x49ad0a=_0x475016[_0x265298(0x2be)]['uuid'],_0x4bb873=timelyDecrypt(_0x49ad0a,![]),_0x459c74=_0x51d1d7[_0x265298(0x37a)](_0x27d4c7=>_0x27d4c7['uuid']==_0x4bb873);if(_0x459c74){const _0x9a96dd=normalizeIP(_0x475016[_0x265298(0x1ea)][_0x265298(0x236)])['store'],_0x43626e=_0x475016['headers'][_0x265298(0x1f9)];if(validateAccess(_0x43626e,_0x4bb873,_0x9a96dd)[_0x265298(0x3d1)])_0x96b70e==_0x265298(0x3cf)&&await backupConfigFiles(),await zipFiles(_0x96b70e),_0x3bdc99[_0x265298(0x367)](zippath+(_0x96b70e+_0x265298(0x310)),_0x113385=>{const _0x2ae7f7=_0x265298;_0x113385&&(logger[_0x2ae7f7(0x1d9)](_0x2ae7f7(0x31d)+_0x96b70e),logger[_0x2ae7f7(0x1e2)](_0x113385));});else logger[_0x265298(0x1d9)](_0x265298(0x23a)+_0x96b70e+'\x20(1)');}else logger[_0x265298(0x1d9)](_0x265298(0x23a)+_0x96b70e+'\x20(2)');}),app[_0x15ba34(0x1d3)](_0x15ba34(0x24b),async(_0x7ad355,_0x366fb7)=>{const _0x27c33e=_0x15ba34,_0x14e1b6=getClientsWithBotID(_0x27c33e(0x209)),_0x2f6eaa=_0x7ad355[_0x27c33e(0x2be)][_0x27c33e(0x3a7)],_0x564f72=timelyDecrypt(_0x2f6eaa,![]),_0x42076a=_0x14e1b6[_0x27c33e(0x37a)](_0x5b48a7=>_0x5b48a7[_0x27c33e(0x3a7)]==_0x564f72);logger[_0x27c33e(0x335)](_0x27c33e(0x35b));if(_0x42076a){const _0x3e253f=normalizeIP(_0x7ad355[_0x27c33e(0x1ea)][_0x27c33e(0x236)])[_0x27c33e(0x28b)],_0x2c9161=_0x7ad355['headers']['tkn'];if(validateAccess(_0x2c9161,_0x564f72,_0x3e253f)['allow']){if(_0x7ad355[_0x27c33e(0x296)]){const _0x54e10e=_0x7ad355['files']['backupfile'];await _0x54e10e['mv'](temppath+_0x54e10e[_0x27c33e(0x26d)]),_0x366fb7[_0x27c33e(0x1dc)]({'status':!![],'message':_0x27c33e(0x3be)});const _0x1aca21=getBotsWithMode();_0x1aca21['length']>0x0?confirmRestore(temppath,_0x54e10e[_0x27c33e(0x26d)]):unzipFile(temppath,_0x54e10e['name']);}}else logger[_0x27c33e(0x1d9)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x27c33e(0x1d9)](_0x27c33e(0x1ee));}),app[_0x15ba34(0x201)](express[_0x15ba34(0x304)](path['join'](__dirname,bbpath2,_0x15ba34(0x240)))),app[_0x15ba34(0x201)](express['static'](path[_0x15ba34(0x38b)](__dirname,bbpath2,_0x15ba34(0x278)))),app[_0x15ba34(0x1d7)]('/',function(_0x34f580,_0x634556){const _0x389d35=_0x15ba34;_0x634556['sendFile'](path['join'](__dirname,bbpath2,_0x389d35(0x240),_0x389d35(0x202)));}),app[_0x15ba34(0x1d7)](_0x15ba34(0x2d7),function(_0x310651,_0x450657){const _0xe43cec=_0x15ba34;_0x450657['sendFile'](path[_0xe43cec(0x38b)](__dirname,bbpath2,_0xe43cec(0x278),_0xe43cec(0x202)));}),app[_0x15ba34(0x1d7)]('/:bot/portfolio',(_0xd19b72,_0x4c7421)=>{const _0x1fefb5=_0x15ba34;_0x4c7421[_0x1fefb5(0x357)](path[_0x1fefb5(0x38b)](__dirname,bbpath2,_0x1fefb5(0x278),_0x1fefb5(0x202)));}),app[_0x15ba34(0x1d7)](_0x15ba34(0x298),(_0x1a9a09,_0x327692)=>{const _0xcaa278=_0x15ba34;_0x327692[_0xcaa278(0x357)](path[_0xcaa278(0x38b)](__dirname,bbpath2,_0xcaa278(0x278),_0xcaa278(0x202)));}),app['get'](_0x15ba34(0x207),(_0x50d1fb,_0x430dfe)=>{const _0x50b66b=_0x15ba34;_0x430dfe['sendFile'](path[_0x50b66b(0x38b)](__dirname,bbpath2,_0x50b66b(0x278),_0x50b66b(0x202)));}),app[_0x15ba34(0x1d7)]('/:bot/history',(_0x380e88,_0x2d93cc)=>{const _0x3d40b2=_0x15ba34;_0x2d93cc[_0x3d40b2(0x357)](path[_0x3d40b2(0x38b)](__dirname,bbpath2,_0x3d40b2(0x278),_0x3d40b2(0x202)));}),app[_0x15ba34(0x1d7)](_0x15ba34(0x339),(_0x3c92b6,_0x2a9836)=>{const _0x22326c=_0x15ba34;_0x2a9836[_0x22326c(0x357)](path[_0x22326c(0x38b)](__dirname,bbpath2,_0x22326c(0x278),'index.html'));}),app[_0x15ba34(0x1d7)](_0x15ba34(0x35a),(_0xcbe2ee,_0x51eff6)=>{const _0x5f3965=_0x15ba34;_0x51eff6[_0x5f3965(0x357)](path[_0x5f3965(0x38b)](__dirname,bbpath2,_0x5f3965(0x278),_0x5f3965(0x202)));});if(HOST)http['listen'](PORT,HOST);else http[_0x15ba34(0x29d)](PORT);const io=require('socket.io')(http,{});openBrowser&&(async()=>{const _0x56ec00=_0x15ba34,{default:_0x2a8749}=await import(_0x56ec00(0x324));await _0x2a8749(_0x56ec00(0x3da)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x197b11=_0x15ba34;let _0x28915f=_0x197b11(0x2cf);const _0x27598e=networkInterfaces(),_0x428650={};for(const _0x532485 of Object['keys'](_0x27598e)){for(const _0x260e5e of _0x27598e[_0x532485]){if((_0x260e5e[_0x197b11(0x242)]==_0x197b11(0x353)||_0x260e5e[_0x197b11(0x242)]==0x4)&&!_0x260e5e[_0x197b11(0x20a)]){const _0x46fbfe=ipaddr['parse'](_0x260e5e[_0x197b11(0x317)])[_0x197b11(0x2ff)]();_0x46fbfe!='private'&&(!_0x428650[_0x532485]&&(_0x428650[_0x532485]=[]),_0x428650[_0x532485]['push'](_0x260e5e[_0x197b11(0x317)]),_0x28915f=_0x260e5e[_0x197b11(0x317)]);}}}return{'serverip':_0x28915f,'netinterfaces':_0x428650};}async function startServer(){const _0x2020b9=_0x15ba34,{serverip:_0xf4f7d1,netinterfaces:_0x485b44}=getServerIP();logger[_0x2020b9(0x1e2)](''),logger[_0x2020b9(0x1e2)]('-----------------------------------------------------------------------------------'),await logger[_0x2020b9(0x1d9)](_0x2020b9(0x222)+serverversion+'#RES#\x20'+(environment==_0x2020b9(0x270)?_0x2020b9(0x2ca):'')+'\x0a'+(_0x2020b9(0x2fc)+PORT+_0x2020b9(0x259))+(_0x2020b9(0x22d)+_0xf4f7d1+':'+PORT+_0x2020b9(0x2df))),logger[_0x2020b9(0x1e2)](_0x2020b9(0x313));if(config[_0x2020b9(0x226)]!=0x0)for(const _0x35ff13 of config){const _0x41a6d7=_0x35ff13['mode']==_0x2020b9(0x3a8)?'a':'m';if(_0x35ff13[_0x2020b9(0x224)]==_0x2020b9(0x1d0)||_0x35ff13[_0x2020b9(0x224)]=='new')await logger[_0x2020b9(0x1d9)]('Starting\x20('+_0x41a6d7+_0x2020b9(0x36c)+_0x35ff13[_0x2020b9(0x312)]+_0x2020b9(0x24a)+_0x35ff13['botname']),startBot([_0x35ff13[_0x2020b9(0x312)],userID],{'cwd':bbpath},function(_0x1bd603){const _0x31aed0=_0x2020b9;if(_0x1bd603)logger[_0x31aed0(0x1d9)](_0x1bd603);});else(_0x35ff13['status']==_0x2020b9(0x2db)||_0x35ff13['status']==_0x2020b9(0x381))&&await logger[_0x2020b9(0x1d9)]('Idling\x20('+_0x41a6d7+')\x20\x20\x20|\x20Bot\x20'+_0x35ff13[_0x2020b9(0x312)]+'\x20|\x20'+_0x35ff13[_0x2020b9(0x3df)]);}else!newBot&&logger[_0x2020b9(0x1e2)](_0x2020b9(0x2c5));if(newBot)addBot();logger[_0x2020b9(0x1e2)]('-----------------------------------------------------------------------------------'),logger['simple'](''),await logger[_0x2020b9(0x335)]('Node.js\x20v'+nodeversion),await logger[_0x2020b9(0x335)]('Network\x20Interfaces:',_0x485b44);}function startSocket(){const _0x3cdaa1=_0x15ba34;io['on'](_0x3cdaa1(0x392),_0x3c5d11=>{const _0x2e8e74=_0x3cdaa1;let _0x1abf10,_0x11a859,_0x4efdc1,_0x44d9bc,_0x29fe9e;const _0x377ecc=_0x3c5d11[_0x2e8e74(0x2e0)]['headers'][_0x2e8e74(0x3bd)];_0x11a859=_0x377ecc[_0x2e8e74(0x284)](/bot[0-9]{3}/);if(_0x11a859)_0x4efdc1=_0x11a859[0x0][_0x2e8e74(0x284)](/[0-9]{3}/);if(_0x4efdc1)_0x1abf10=_0x4efdc1[0x0];else _0x1abf10=_0x2e8e74(0x209);const _0x1c4cb6=_0x3c5d11[_0x2e8e74(0x2e0)][_0x2e8e74(0x293)][_0x2e8e74(0x325)];if(!_0x1c4cb6)_0x3c5d11['emit'](_0x2e8e74(0x224),{'publicKey':secure[_0x2e8e74(0x2b0)]});else{_0x44d9bc=timelyDecrypt(_0x1c4cb6,![]);if(!_0x44d9bc)_0x3c5d11[_0x2e8e74(0x2bc)](_0x2e8e74(0x224),{'publicKey':secure[_0x2e8e74(0x2b0)]});else{_0x29fe9e=normalizeIP(_0x3c5d11[_0x2e8e74(0x32d)][_0x2e8e74(0x236)])[_0x2e8e74(0x28b)];if(!devices[_0x44d9bc])devices[_0x44d9bc]={'uuid':_0x44d9bc,'access':{'token':null}};devices[_0x44d9bc]['ip']=_0x29fe9e;const _0x5b60e6=addClient(_0x3c5d11['id'],_0x44d9bc,_0x1abf10);setAccess(_0x5b60e6),emitMessages(),_0x3c5d11['on'](_0x2e8e74(0x220),_0x3b3d34=>{const _0x4088da=_0x2e8e74,_0x1ff8c0=timelyDecrypt(_0x3b3d34['password'],!![],_0x4088da(0x329));if(_0x1ff8c0){_0x3b3d34={'username':_0x3b3d34[_0x4088da(0x37c)],'password':_0x1ff8c0},devices[_0x44d9bc][_0x4088da(0x37e)]=validateCredentials(_0x3b3d34,_0x44d9bc);if(devices[_0x44d9bc][_0x4088da(0x37e)][_0x4088da(0x3d1)]==![]&&devices[_0x44d9bc]['access'][_0x4088da(0x39b)]==_0x4088da(0x206))_0x3c5d11[_0x4088da(0x2bc)]('status',{'access':devices[_0x44d9bc][_0x4088da(0x37e)]}),loginAccess2FA(_0x44d9bc,_0x29fe9e);else{if(devices[_0x44d9bc][_0x4088da(0x37e)]['allow']==![]&&devices[_0x44d9bc][_0x4088da(0x37e)][_0x4088da(0x39b)]=='invalid\x20credentials')_0x3c5d11[_0x4088da(0x2bc)](_0x4088da(0x224),{'access':devices[_0x44d9bc][_0x4088da(0x37e)]});else devices[_0x44d9bc][_0x4088da(0x37e)][_0x4088da(0x3d1)]&&devices[_0x44d9bc][_0x4088da(0x37e)][_0x4088da(0x39b)]==_0x4088da(0x221)&&(getClientsWithUuid(_0x44d9bc)[_0x4088da(0x1ed)](_0x357694=>{setAccess(_0x357694);}),logger['debug'](_0x4088da(0x2d4)+_0x44d9bc[_0x4088da(0x2b5)](-0x8)),setTokenRefresh(_0x44d9bc),setSessionTimeout(_0x4088da(0x220),_0x44d9bc));}}else logger['full'](_0x4088da(0x2f3));}),_0x3c5d11['on'](_0x2e8e74(0x280),()=>{resetPassword();}),_0x3c5d11['on'](_0x2e8e74(0x2ce),_0x4c4686=>{removeClient(_0x3c5d11['id']);}),_0x1abf10==_0x2e8e74(0x209)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x55c22c){const _0xf7929=_0x15ba34;if(_0x55c22c!=_0xf7929(0x209)&&config[_0xf7929(0x1e8)]!=''){if(pid[_0x55c22c])pid[_0x55c22c][_0xf7929(0x1dc)]({'function':_0xf7929(0x1f7),'args':null});}_0x55c22c!=_0xf7929(0x209)&&broadcastToBots(_0xf7929(0x3a4),JSON[_0xf7929(0x1e9)](config));}function reloadBotManager(){const _0x3f779c=_0x15ba34;getClientsWithBotID(_0x3f779c(0x209))['forEach'](_0x5ee38a=>{const _0x6722af=_0x3f779c;getSocket(_0x5ee38a['id'])[_0x6722af(0x2bc)](_0x6722af(0x224),{'access':{'allow':![],'reason':_0x6722af(0x2b8),'token':null}});});}function getSocket(_0x44ddf0){const _0x1e836e=_0x15ba34,_0x2299cd=io[_0x1e836e(0x37d)]['get']('/');return _0x2299cd[_0x1e836e(0x1fe)][_0x1e836e(0x1d7)](_0x44ddf0);}function setAccess(_0x36c41f){const _0x439ec1=_0x15ba34,_0x2725f4=getSocket(_0x36c41f['id']),_0x3c729b=_0x36c41f['uuid'],_0x2f14e0=_0x36c41f[_0x439ec1(0x39d)];devices[_0x3c729b]['access']=validateAccess(devices[_0x3c729b][_0x439ec1(0x37e)]['token'],_0x3c729b),logger[_0x439ec1(0x335)](_0x439ec1(0x30d)+devices[_0x3c729b][_0x439ec1(0x37e)]['reason']+'\x20|\x20client:\x20...'+_0x36c41f['id'][_0x439ec1(0x2b5)](-0x8)+'\x20|\x20user:\x20...'+_0x3c729b[_0x439ec1(0x2b5)](-0x8)),_0x2725f4[_0x439ec1(0x38b)](_0x3c729b);if(devices[_0x3c729b][_0x439ec1(0x37e)][_0x439ec1(0x3d1)]){_0x2725f4['join'](_0x2f14e0);if(_0x2f14e0==_0x439ec1(0x209))initializeSocketBotManager(_0x2725f4);else initializeSocketBot(_0x2725f4);initClient(_0x2f14e0);}devices[_0x3c729b][_0x439ec1(0x37e)][_0x439ec1(0x36e)]&&devices[_0x3c729b][_0x439ec1(0x37e)]['reason']==_0x439ec1(0x1eb)&&setSessionTimeout(_0x439ec1(0x285),_0x3c729b),devices[_0x3c729b][_0x439ec1(0x37e)][_0x439ec1(0x36e)]&&devices[_0x3c729b][_0x439ec1(0x37e)][_0x439ec1(0x39b)]==_0x439ec1(0x302)&&setSessionTimeout('login',_0x3c729b),_0x2725f4['emit']('status',{'status':_0x36c41f['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3c729b][_0x439ec1(0x37e)],'externalip':devices[_0x3c729b]['ip'],'publicKey':secure[_0x439ec1(0x2b0)],'userid':settings[_0x439ec1(0x338)],'validInstallation':validInstallation}),devices[_0x3c729b]['access'][_0x439ec1(0x3d1)]==![]&&devices[_0x3c729b][_0x439ec1(0x37e)][_0x439ec1(0x39b)]==_0x439ec1(0x394)&&temporaryAccess2FA(_0x3c729b,devices[_0x3c729b]['ip']);}function setSessionTimeout(_0x3512f3,_0x4fe81c){const _0x5e3abd=_0x15ba34;let _0x549731;if(_0x3512f3==_0x5e3abd(0x220))_0x549731=loginExpiry*0x3c*0x3e8;else _0x549731=devices[_0x4fe81c][_0x5e3abd(0x1f5)]['expiry']*0x3c*0x3e8-(new Date()[_0x5e3abd(0x3d6)]()-devices[_0x4fe81c][_0x5e3abd(0x1f5)][_0x5e3abd(0x281)]);if(devices[_0x4fe81c][_0x5e3abd(0x318)])clearTimeout(devices[_0x4fe81c][_0x5e3abd(0x318)]);devices[_0x4fe81c][_0x5e3abd(0x318)]=setTimeout(()=>{const _0x49b437=_0x5e3abd;if(devices[_0x4fe81c][_0x49b437(0x2bf)])clearTimeout(devices[_0x4fe81c]['pidRefreshToken']);removeSocketListeners(_0x4fe81c),addBlacklist(_0x4fe81c),devices[_0x4fe81c]['telegramIpApproval']=null,devices[_0x4fe81c]['telegram2FaApproval']=null,devices[_0x4fe81c][_0x49b437(0x37e)][_0x49b437(0x36e)]=null,logger['debug'](_0x49b437(0x3a5)+_0x4fe81c[_0x49b437(0x2b5)](-0x8)),devices[_0x4fe81c][_0x49b437(0x37e)]=validateAccess(devices[_0x4fe81c][_0x49b437(0x37e)][_0x49b437(0x36e)],_0x4fe81c),!(devices[_0x4fe81c]['access'][_0x49b437(0x3d1)]&&devices[_0x4fe81c]['access']['reason']==_0x49b437(0x39a))&&(_0x3512f3==_0x49b437(0x220)?io['to'](_0x4fe81c)[_0x49b437(0x2bc)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x4fe81c)[_0x49b437(0x2bc)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x4fe81c][_0x49b437(0x37e)][_0x49b437(0x36e)]=null;},_0x549731);}function setTokenRefresh(_0x121933){const _0x18451b=_0x15ba34;if(devices[_0x121933][_0x18451b(0x2bf)])clearTimeout(devices[_0x121933]['pidRefreshToken']);devices[_0x121933][_0x18451b(0x2bf)]=setTimeout(()=>{const _0x1fab8b=_0x18451b;getClientsWithUuid(_0x121933)[_0x1fab8b(0x226)]!=0x0?(devices[_0x121933]['access']=refreshToken(_0x121933),io['to'](_0x121933)['emit'](_0x1fab8b(0x224),{'status':_0x1fab8b(0x299),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x121933][_0x1fab8b(0x37e)],'externalip':devices[_0x121933]['ip'],'publicKey':secure[_0x1fab8b(0x2b0)],'validInstallation':validInstallation}),setTokenRefresh(_0x121933)):clearTimeout(devices[_0x121933][_0x1fab8b(0x2bf)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x36468c){const _0x20e6b9=_0x15ba34,_0x21a44a=getClient(_0x36468c['id'])['uuid'];_0x36468c[_0x20e6b9(0x2bc)](_0x20e6b9(0x3a4),config),_0x36468c[_0x20e6b9(0x2bc)](_0x20e6b9(0x2f8),cleanSettings()),_0x36468c['on'](_0x20e6b9(0x243),_0x4641b2=>{const _0x2602d5=_0x20e6b9;if(validateAccess(_0x4641b2,_0x21a44a)[_0x2602d5(0x3d1)])addBot();else logger[_0x2602d5(0x1d9)](_0x2602d5(0x25b));}),_0x36468c['on'](_0x20e6b9(0x37b),(_0x15c62f,_0x3ecb5)=>{const _0x34fe71=_0x20e6b9;if(validateAccess(_0x3ecb5,_0x21a44a)[_0x34fe71(0x3d1)])toggleBot(_0x15c62f[_0x34fe71(0x312)],_0x15c62f[_0x34fe71(0x224)],_0x15c62f[_0x34fe71(0x3ad)]);else logger['full'](_0x34fe71(0x343));}),_0x36468c['on'](_0x20e6b9(0x25d),(_0x3563f6,_0x43e438)=>{const _0x5defbb=_0x20e6b9;if(validateAccess(_0x43e438,_0x21a44a)[_0x5defbb(0x3d1)])toggleBotMode(_0x3563f6);else logger[_0x5defbb(0x1d9)](_0x5defbb(0x343));}),_0x36468c['on'](_0x20e6b9(0x216),(_0x454b77,_0x11f7cf)=>{const _0x973dfc=_0x20e6b9;if(validateAccess(_0x11f7cf,_0x21a44a)[_0x973dfc(0x3d1)])deleteBot(_0x454b77);else logger[_0x973dfc(0x1d9)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x36468c['on']('store-settings',(_0x40d7ad,_0x330ff4)=>{const _0x263beb=_0x20e6b9;if(validateAccess(_0x330ff4,_0x21a44a)[_0x263beb(0x3d1)])storeSettings(_0x40d7ad,!![]);else logger[_0x263beb(0x1d9)](_0x263beb(0x23e));}),_0x36468c['on'](_0x20e6b9(0x20c),_0x37c049=>{const _0x25d857=_0x20e6b9;if(validateAccess(_0x37c049,_0x21a44a)[_0x25d857(0x3d1)])updateBB(_0x25d857(0x27c));else logger[_0x25d857(0x1d9)](_0x25d857(0x322));}),_0x36468c['on'](_0x20e6b9(0x2e9),_0x2e1dd3=>{const _0xb0730d=_0x20e6b9;if(validateAccess(_0x2e1dd3,_0x21a44a)['allow'])updateBB(_0xb0730d(0x2c4));else logger[_0xb0730d(0x1d9)](_0xb0730d(0x22e));}),_0x36468c['on'](_0x20e6b9(0x210),_0x4efd66=>{const _0x1c236d=_0x20e6b9;if(validateAccess(_0x4efd66,_0x21a44a)['allow']){const _0x401ef4=getClient(_0x36468c['id']);if(_0x401ef4)getBackupFiles(_0x401ef4[_0x1c236d(0x3a7)]);else logger[_0x1c236d(0x1d9)](_0x1c236d(0x2f4));}else logger[_0x1c236d(0x1d9)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x36468c['on'](_0x20e6b9(0x396),(_0x1db75e,_0x3d8fac)=>{const _0x33cce4=_0x20e6b9;if(validateAccess(_0x3d8fac,_0x21a44a)[_0x33cce4(0x3d1)])restoreBackupFile(_0x1db75e);else logger[_0x33cce4(0x1d9)](_0x33cce4(0x25a));}),_0x36468c['on'](_0x20e6b9(0x36a),_0xb02d63=>{const _0x285244=_0x20e6b9;if(validateAccess(_0xb02d63,_0x21a44a)[_0x285244(0x3d1)])getMessages();else logger['full'](_0x285244(0x350));}),_0x36468c['on'](_0x20e6b9(0x2d5),(_0xc924e5,_0x389787)=>{const _0xc8aa98=_0x20e6b9;if(validateAccess(_0x389787,_0x21a44a)[_0xc8aa98(0x3d1)])confirmMessage(_0xc924e5);else logger[_0xc8aa98(0x1d9)](_0xc8aa98(0x26f));}),_0x36468c['on']('logout',_0x198d6f=>{const _0x25a634=_0x20e6b9;if(validateAccess(_0x198d6f,_0x21a44a)[_0x25a634(0x3d1)]){if(devices[_0x21a44a]['pidRefreshToken'])clearTimeout(devices[_0x21a44a][_0x25a634(0x2bf)]);if(devices[_0x21a44a]['pidExpireLogin'])clearTimeout(devices[_0x21a44a][_0x25a634(0x318)]);removeSocketListeners(getClient(_0x36468c['id'])['uuid']),addBlacklist(_0x21a44a),devices[_0x21a44a][_0x25a634(0x1f5)]=null,devices[_0x21a44a][_0x25a634(0x267)]=null,devices[_0x21a44a][_0x25a634(0x37e)][_0x25a634(0x36e)]=null,logger[_0x25a634(0x335)](_0x25a634(0x3d9)+_0x21a44a[_0x25a634(0x2b5)](-0x8)),io['to'](getClient(_0x36468c['id'])[_0x25a634(0x3a7)])[_0x25a634(0x2bc)]('status',{'access':{'allow':![],'reason':_0x25a634(0x283),'token':null}});}else logger[_0x25a634(0x1d9)](_0x25a634(0x3c4));});}function initializeSocketBot(_0x218a6a){const _0x322ff4=_0x15ba34,_0x37c57d=getClient(_0x218a6a['id'])[_0x322ff4(0x39d)],_0x1176b1=getClient(_0x218a6a['id'])['uuid'];_0x218a6a['on'](_0x322ff4(0x399),(_0x122526,_0xe2eb68)=>{const _0xbfe4b0=_0x322ff4;if(validateAccess(_0xe2eb68,_0x1176b1)[_0xbfe4b0(0x3d1)]){if(pid[_0x37c57d])pid[_0x37c57d]['send']({'function':_0xbfe4b0(0x1f3),'args':_0x122526});}else logger[_0xbfe4b0(0x1d9)](_0xbfe4b0(0x352));}),_0x218a6a['on'](_0x322ff4(0x2a8),(_0x18c15c,_0x12d6c8)=>{const _0x27bf1c=_0x322ff4;if(validateAccess(_0x12d6c8,_0x1176b1)[_0x27bf1c(0x3d1)]){if(pid[_0x37c57d])pid[_0x37c57d][_0x27bf1c(0x1dc)]({'function':'deleteHistoryAlerts','args':_0x18c15c});}else logger[_0x27bf1c(0x1d9)](_0x27bf1c(0x29c));}),_0x218a6a['on'](_0x322ff4(0x388),(_0x35c139,_0x37ebd2)=>{const _0x4e68fd=_0x322ff4;if(validateAccess(_0x37ebd2,_0x1176b1)[_0x4e68fd(0x3d1)]){if(pid[_0x37c57d])pid[_0x37c57d][_0x4e68fd(0x1dc)]({'function':'getPortfolio','args':_0x35c139});}else logger[_0x4e68fd(0x1d9)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x218a6a['on'](_0x322ff4(0x306),(_0x1cee0f,_0x1acf8d)=>{const _0x4d633d=_0x322ff4;if(validateAccess(_0x1acf8d,_0x1176b1)['allow']){if(pid[_0x37c57d])pid[_0x37c57d][_0x4d633d(0x1dc)]({'function':_0x4d633d(0x28e),'args':_0x1cee0f});}else logger[_0x4d633d(0x1d9)](_0x4d633d(0x29e));}),_0x218a6a['on'](_0x322ff4(0x2d8),(_0x3a63c7,_0x4a7f3b)=>{const _0x44b921=_0x322ff4;if(validateAccess(_0x4a7f3b,_0x1176b1)[_0x44b921(0x3d1)]){if(pid[_0x37c57d])pid[_0x37c57d][_0x44b921(0x1dc)]({'function':_0x44b921(0x347),'args':_0x3a63c7});}else logger[_0x44b921(0x1d9)](_0x44b921(0x225));}),_0x218a6a['on'](_0x322ff4(0x218),(_0x1782d6,_0x495c23)=>{const _0xe84ea=_0x322ff4;if(validateAccess(_0x495c23,_0x1176b1)[_0xe84ea(0x3d1)]){if(pid[_0x37c57d])pid[_0x37c57d][_0xe84ea(0x1dc)]({'function':_0xe84ea(0x235),'args':_0x1782d6});}else logger[_0xe84ea(0x1d9)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x218a6a['on'](_0x322ff4(0x21b),_0x2419ab=>{const _0x31e2a4=_0x322ff4;if(validateAccess(_0x2419ab,_0x1176b1)['allow']){if(pid[_0x37c57d])pid[_0x37c57d][_0x31e2a4(0x1dc)]({'function':_0x31e2a4(0x23f),'args':null});}else logger[_0x31e2a4(0x1d9)](_0x31e2a4(0x268));}),_0x218a6a['on'](_0x322ff4(0x231),_0x523320=>{const _0x5a9a14=_0x322ff4;if(validateAccess(_0x523320,_0x1176b1)[_0x5a9a14(0x3d1)]){if(pid[_0x37c57d])pid[_0x37c57d][_0x5a9a14(0x1dc)]({'function':_0x5a9a14(0x23b),'args':null});}else logger[_0x5a9a14(0x1d9)](_0x5a9a14(0x36d));}),_0x218a6a['on'](_0x322ff4(0x2da),(_0x283a23,_0x3de9f9)=>{const _0x2d6a8c=_0x322ff4;if(validateAccess(_0x3de9f9,_0x1176b1)[_0x2d6a8c(0x3d1)]){if(pid[_0x37c57d])pid[_0x37c57d]['send']({'function':'placeOrder','args':_0x283a23});}else logger['full'](_0x2d6a8c(0x2e3));}),_0x218a6a['on'](_0x322ff4(0x3bf),_0x160616=>{const _0x1a0d6e=_0x322ff4;if(validateAccess(_0x160616,_0x1176b1)['allow']){if(pid[_0x37c57d])pid[_0x37c57d][_0x1a0d6e(0x1dc)]({'function':_0x1a0d6e(0x3c2),'args':null});}else logger['full'](_0x1a0d6e(0x276));}),_0x218a6a['on'](_0x322ff4(0x3bb),_0x2b41c2=>{const _0x83e775=_0x322ff4;if(validateAccess(_0x2b41c2,_0x1176b1)['allow']){if(pid[_0x37c57d])pid[_0x37c57d]['send']({'function':_0x83e775(0x2c0),'args':null});}else logger[_0x83e775(0x1d9)](_0x83e775(0x2a6));}),_0x218a6a['on'](_0x322ff4(0x20c),_0x241125=>{const _0x35140b=_0x322ff4;if(validateAccess(_0x241125,_0x1176b1)[_0x35140b(0x3d1)])updateBB(_0x35140b(0x27c));else logger['full'](_0x35140b(0x322));}),_0x218a6a['on']('get-messages',_0x3f54ff=>{const _0x38de4b=_0x322ff4;if(validateAccess(_0x3f54ff,_0x1176b1)[_0x38de4b(0x3d1)])getMessages();else logger[_0x38de4b(0x1d9)](_0x38de4b(0x350));}),_0x218a6a['on'](_0x322ff4(0x2d5),(_0x52d073,_0x265856)=>{const _0x419eef=_0x322ff4;if(validateAccess(_0x265856,_0x1176b1)['allow'])confirmMessage(_0x52d073);else logger[_0x419eef(0x1d9)](_0x419eef(0x26f));}),_0x218a6a['on'](_0x322ff4(0x1cd),_0x5ae536=>{const _0x59866f=_0x322ff4;if(validateAccess(_0x5ae536,_0x1176b1)[_0x59866f(0x3d1)]){if(devices[_0x1176b1][_0x59866f(0x2bf)])clearTimeout(devices[_0x1176b1][_0x59866f(0x2bf)]);if(devices[_0x1176b1][_0x59866f(0x318)])clearTimeout(devices[_0x1176b1]['pidExpireLogin']);removeSocketListeners(getClient(_0x218a6a['id'])[_0x59866f(0x3a7)]),addBlacklist(_0x1176b1),devices[_0x1176b1][_0x59866f(0x1f5)]=null,devices[_0x1176b1][_0x59866f(0x267)]=null,devices[_0x1176b1][_0x59866f(0x37e)]['token']=null,logger['debug'](_0x59866f(0x3d9)+_0x1176b1[_0x59866f(0x2b5)](-0x8)),io['to'](getClient(_0x218a6a['id'])['uuid'])[_0x59866f(0x2bc)](_0x59866f(0x224),{'access':{'allow':![],'reason':_0x59866f(0x283),'token':null}});}else logger['full'](_0x59866f(0x3c4));});}function removeSocketListeners(_0x2a911d){const _0xde3d52=_0x15ba34;getClientsWithUuid(_0x2a911d)[_0xde3d52(0x1ed)](_0x2522f2=>{const _0x2a1bad=_0xde3d52;getSocket(_0x2522f2['id'])[_0x2a1bad(0x3b9)]();});}function cleanSettings(){const _0x56ca03=_0x15ba34;let _0x1394ce=settings;return settings[_0x56ca03(0x2ba)]&&settings[_0x56ca03(0x2ba)]!=''&&(_0x1394ce={..._0x1394ce,'telegramToken':_0x56ca03(0x247)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x1394ce={..._0x1394ce,'bbPassword':_0x56ca03(0x247)}),settings[_0x56ca03(0x2d9)]&&settings[_0x56ca03(0x2d9)]!=''&&(_0x1394ce={..._0x1394ce,'marketcapApi':'************'}),(settings[_0x56ca03(0x2b2)]&&settings[_0x56ca03(0x2b2)]==_0x56ca03(0x326)||settings['telegramToken']&&settings[_0x56ca03(0x2ba)]==_0x56ca03(0x326)||settings[_0x56ca03(0x2d9)]&&settings['marketcapApi']==_0x56ca03(0x326))&&(_0x1394ce={..._0x1394ce,'restored':{'password':settings[_0x56ca03(0x2b2)]==_0x56ca03(0x326),'telegram':settings['telegramToken']=='***','marketcap':settings[_0x56ca03(0x2d9)]==_0x56ca03(0x326)}}),_0x1394ce;}function _0x77ce(_0x402e9b,_0x375237){const _0x18339d=_0x5b61();return _0x77ce=function(_0x29271d,_0x2a9874){_0x29271d=_0x29271d-0x1cd;let _0x5b61e7=_0x18339d[_0x29271d];return _0x5b61e7;},_0x77ce(_0x402e9b,_0x375237);}async function updateBB(_0x36be40){const _0x3d9965=_0x15ba34;await backupConfigFiles(),installingUpdate=!![],config[_0x3d9965(0x1ed)](_0x5884eb=>{const _0x407bb0=_0x3d9965;restartBot(_0x5884eb[_0x407bb0(0x312)]);});if(_0x36be40==_0x3d9965(0x27c))process['send']({'update':!![],'environment':environment},_0x56df53=>{});else _0x36be40=='reinstall'&&process['send']({'reinstall':!![],'environment':environment},_0x333182=>{});}function startBot(_0x10dc4b,_0x3c3ce,_0xbe789a){const _0xf1c8b3=_0x15ba34;if(debugging)_0x10dc4b[_0xf1c8b3(0x2f2)]('-d');if(recreate)_0x10dc4b[_0xf1c8b3(0x2f2)]('-r');let _0x11930a=![];const _0x291dc4=_0x10dc4b[0x0];_0x3c3ce={..._0x3c3ce,'stdio':['inherit','inherit',_0xf1c8b3(0x2f0),_0xf1c8b3(0x33b)]},pid[_0x291dc4]=childProcess[_0xf1c8b3(0x3db)](botfile,_0x10dc4b,_0x3c3ce),pid[_0x291dc4]['on'](_0xf1c8b3(0x38c),_0x763afa=>{const _0x1e7017=_0xf1c8b3;switch(Object[_0x1e7017(0x1e4)](_0x763afa)[0x0]){case _0x1e7017(0x3df):updateBotName(_0x291dc4,_0x763afa[_0x1e7017(0x3df)]);break;case _0x1e7017(0x214):updateBotManager();break;case _0x1e7017(0x224):updateStatus(_0x291dc4,_0x763afa[_0x1e7017(0x224)]);break;case'live':updateLive(_0x291dc4,_0x763afa[_0x1e7017(0x3ad)]);break;case _0x1e7017(0x256):updateLive(_0x291dc4,_0x763afa[_0x1e7017(0x256)]),io['to'](_0x291dc4)[_0x1e7017(0x2bc)](_0x1e7017(0x224),{'access':{'allow':![],'reason':_0x1e7017(0x2b8),'token':null}});break;case _0x1e7017(0x1d2):_0x763afa[_0x1e7017(0x1d2)]==_0x1e7017(0x249)&&restartBot(_0x291dc4);_0x763afa[_0x1e7017(0x1d2)]==_0x1e7017(0x21e)&&toggleBot(_0x291dc4,'disabled',_0x1e7017(0x3ce));break;case _0x1e7017(0x2af):sendTelegramBot(_0x291dc4,_0x763afa[_0x1e7017(0x2af)]);break;case'telegrammsg':sendTelegramMsg(_0x763afa['telegrammsg']);break;case'function':io['to'](_0x291dc4)[_0x1e7017(0x2bc)](_0x763afa[_0x1e7017(0x375)],_0x763afa[_0x1e7017(0x1ce)]);break;}}),pid[_0x291dc4]['on'](_0xf1c8b3(0x2cd),function(_0x3012eb){if(_0x11930a)return;_0x11930a=!![],_0xbe789a(_0x3012eb);}),pid[_0x291dc4]['on']('exit',async function(_0x213c17){const _0x519aaa=_0xf1c8b3;if(terminating)return;if(installingUpdate){io[_0x519aaa(0x2cc)]();return;}if(_0x11930a)return;_0x11930a=!![],_0xbe789a(null);const _0xb0976b=dbConfig[_0x519aaa(0x1d7)](_0x519aaa(0x3a4))[_0x519aaa(0x37a)]({'botID':_0x291dc4})[_0x519aaa(0x333)]();_0xb0976b&&(_0xb0976b['status']==_0x519aaa(0x1d0)||_0xb0976b[_0x519aaa(0x224)]=='new')&&(await sleep(0x3e8),updateLive(_0x291dc4,_0x519aaa(0x3ce)),logger[_0x519aaa(0x1d9)](_0x519aaa(0x387)+botRef(_0x291dc4)),startBot([_0x291dc4,userID],{'cwd':bbpath},function(_0x4a80ba){if(_0x4a80ba)logger['full'](_0x4a80ba);}));});}function stopBot(_0x270e83){const _0x454ca1=_0x15ba34;getClientsWithBotID(_0x270e83)[_0x454ca1(0x1ed)](_0x4cadeb=>{const _0x3b8b74=_0x454ca1;getSocket(_0x4cadeb['id'])[_0x3b8b74(0x2ce)](!![]),removeClient(_0x4cadeb['id']);}),pid[_0x270e83]&&(pid[_0x270e83][_0x454ca1(0x21e)](),pid[_0x270e83]=null);}function stopAllBots(){terminating=!![];const _0x223976=getEnabledBots();_0x223976['forEach'](_0x4167aa=>{stopBot(_0x4167aa['botID']);});}function restartBot(_0x2ce415){if(pid[_0x2ce415])pid[_0x2ce415]['kill']();}function addBot(){const _0x54797c=_0x15ba34;let _0x39dc56;for(let _0x5e29ff=0x1;_0x5e29ff<0x3e9;_0x5e29ff++){_0x39dc56=_0x5e29ff['toString']()[_0x54797c(0x2f7)](0x3,'0');let _0x218c5d=config[_0x54797c(0x37a)](_0x187547=>_0x187547[_0x54797c(0x312)]==_0x39dc56);if(!_0x218c5d)break;}if(_0x39dc56==='1000'){logger[_0x54797c(0x1d9)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x54797c(0x1d9)](_0x54797c(0x311)+_0x39dc56),dbConfig[_0x54797c(0x1d7)](_0x54797c(0x3a4))['push']({'botID':_0x39dc56,'botname':'Bot\x20'+_0x39dc56,'status':_0x54797c(0x244),'live':''})[_0x54797c(0x34d)](),startBot([_0x39dc56,userID],{'cwd':bbpath},function(_0x5d6604){const _0x4c73b2=_0x54797c;if(_0x5d6604)logger[_0x4c73b2(0x1d9)](_0x5d6604);}),config=getConfiguration(),io['to']('botmanager')[_0x54797c(0x2bc)](_0x54797c(0x3a4),config),broadcastToBots('bots',JSON[_0x54797c(0x1e9)](config));}function deleteBot(_0x703745){const _0x343e5c=_0x15ba34;getClientsWithBotID(_0x703745)['forEach'](_0x28d783=>{const _0x3c5d4c=_0x77ce;getSocket(_0x28d783['id'])[_0x3c5d4c(0x2ce)](!![]),removeClient(_0x28d783['id']);}),dbConfig['get'](_0x343e5c(0x3a4))[_0x343e5c(0x275)]({'botID':_0x703745})['write'](),logger[_0x343e5c(0x1d9)](_0x343e5c(0x266)+_0x703745),stopBot(_0x703745);try{if(fs['existsSync'](path[_0x343e5c(0x38b)](configpath,_0x343e5c(0x351)+_0x703745+'-config.json')))fs[_0x343e5c(0x1e1)](path[_0x343e5c(0x38b)](configpath,_0x343e5c(0x351)+_0x703745+_0x343e5c(0x217)));if(fs[_0x343e5c(0x229)](path[_0x343e5c(0x38b)](configpath,'bot-'+_0x703745+'-events.json')))fs[_0x343e5c(0x1e1)](path[_0x343e5c(0x38b)](configpath,_0x343e5c(0x351)+_0x703745+'-events.json'));if(fs[_0x343e5c(0x229)](path['join'](configpath,_0x343e5c(0x351)+_0x703745+_0x343e5c(0x3b7))))fs[_0x343e5c(0x1e1)](path[_0x343e5c(0x38b)](configpath,_0x343e5c(0x351)+_0x703745+_0x343e5c(0x3b7)));if(fs['existsSync'](path[_0x343e5c(0x38b)](configpath,_0x343e5c(0x351)+_0x703745+_0x343e5c(0x376))))fs[_0x343e5c(0x1e1)](path[_0x343e5c(0x38b)](configpath,_0x343e5c(0x351)+_0x703745+_0x343e5c(0x376)));}catch(_0xfbe131){if(_0xfbe131)logger[_0x343e5c(0x1d9)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0xfbe131);}config=getConfiguration(),io['to']('botmanager')[_0x343e5c(0x2bc)](_0x343e5c(0x3a4),config),broadcastToBots(_0x343e5c(0x3a4),JSON[_0x343e5c(0x1e9)](config));}function toggleBot(_0x2d6f0d,_0x3d9c89,_0x469018){const _0x2afac7=_0x15ba34;dbConfig[_0x2afac7(0x1d7)](_0x2afac7(0x3a4))[_0x2afac7(0x37a)]({'botID':_0x2d6f0d})['assign']({'status':_0x3d9c89})[_0x2afac7(0x340)]({'live':_0x469018})[_0x2afac7(0x34d)]();const _0x277231=botRef(_0x2d6f0d);if(_0x3d9c89=='enabled'||_0x3d9c89=='new')logger[_0x2afac7(0x1d9)](_0x2afac7(0x38a)+_0x277231),startBot([_0x2d6f0d,userID],{'cwd':bbpath},function(_0x3bf213){const _0x177720=_0x2afac7;if(_0x3bf213)logger[_0x177720(0x1d9)](_0x3bf213);});else(_0x3d9c89=='disabled'||_0x3d9c89==_0x2afac7(0x381))&&(logger['full'](_0x2afac7(0x349)+_0x277231),stopBot(_0x2d6f0d));config=getConfiguration(),io['to'](_0x2afac7(0x209))[_0x2afac7(0x2bc)](_0x2afac7(0x3a4),config),broadcastToBots(_0x2afac7(0x3a4),JSON[_0x2afac7(0x1e9)](config));}function toggleStatus(_0x4c8bce){const _0x1a1559=_0x15ba34;let _0x5a50da=dbConfig[_0x1a1559(0x1d7)](_0x1a1559(0x3a4))[_0x1a1559(0x37a)]({'botID':_0x4c8bce})[_0x1a1559(0x333)](),_0x5c7bdd;if(_0x5a50da[_0x1a1559(0x224)]==='enabled')_0x5c7bdd=_0x1a1559(0x2db);else{if(_0x5a50da[_0x1a1559(0x224)]==='new')_0x5c7bdd=_0x1a1559(0x381);else{if(_0x5a50da[_0x1a1559(0x224)]===_0x1a1559(0x381))_0x5c7bdd=_0x1a1559(0x244);else{if(_0x5a50da['status']===_0x1a1559(0x2db))_0x5c7bdd=_0x1a1559(0x1d0);}}}return _0x5c7bdd;}function updateStatus(_0x3063c2,_0x1a5754){const _0x41a508=_0x15ba34;dbConfig[_0x41a508(0x1d7)](_0x41a508(0x3a4))[_0x41a508(0x37a)]({'botID':_0x3063c2})[_0x41a508(0x340)]({'status':_0x1a5754})[_0x41a508(0x34d)](),config=getConfiguration(),io['to'](_0x41a508(0x209))['emit']('bots',config),broadcastToBots(_0x41a508(0x3a4),JSON['stringify'](config));}function updateLive(_0x479ab8,_0x123b96){const _0x1bd22d=_0x15ba34;dbConfig[_0x1bd22d(0x1d7)](_0x1bd22d(0x3a4))[_0x1bd22d(0x37a)]({'botID':_0x479ab8})[_0x1bd22d(0x340)]({'live':_0x123b96})['write'](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotName(_0x58070e,_0x5ddf3b){const _0x163a9a=_0x15ba34;dbConfig[_0x163a9a(0x1d7)](_0x163a9a(0x3a4))[_0x163a9a(0x37a)]({'botID':_0x58070e})[_0x163a9a(0x340)]({'botname':_0x5ddf3b})[_0x163a9a(0x34d)](),config=getConfiguration(),io['to'](_0x163a9a(0x209))[_0x163a9a(0x2bc)](_0x163a9a(0x3a4),config),broadcastToBots(_0x163a9a(0x3a4),JSON[_0x163a9a(0x1e9)](config));}function updateBotManager(){const _0x2050f8=_0x15ba34;config=getConfiguration(),io['to'](_0x2050f8(0x209))['emit'](_0x2050f8(0x3a4),config),broadcastToBots(_0x2050f8(0x3a4),JSON[_0x2050f8(0x1e9)](config));}function toggleBotMode(_0xbad464){const _0x4e898e=_0x15ba34;if(pid[_0xbad464])pid[_0xbad464][_0x4e898e(0x1dc)]({'function':'toggleBotMode','args':null});else{const _0x439540=configpath+_0x4e898e(0x351)+_0xbad464+'-config.json',_0x307a3b=fs[_0x4e898e(0x24d)](_0x439540),_0x359744=JSON['parse'](_0x307a3b),_0x223f35=_0x359744['bot'][0x0][_0x4e898e(0x33f)];_0x359744[_0x4e898e(0x39d)][0x0][_0x4e898e(0x33f)]=!_0x223f35;const _0x4907f9=JSON[_0x4e898e(0x1e9)](_0x359744,null,0x2);fs[_0x4e898e(0x33d)](_0x439540,_0x4907f9),config=getConfiguration(),io['to'](_0x4e898e(0x209))[_0x4e898e(0x2bc)](_0x4e898e(0x3a4),config),broadcastToBots('bots',JSON[_0x4e898e(0x1e9)](config));}}function validateTelegram(_0xe698a1){const _0x2f316d=_0x15ba34;if(_0xe698a1[_0x2f316d(0x2a9)][_0x2f316d(0x37c)]!=settings['telegramUsername']&&'@'+_0xe698a1[_0x2f316d(0x2a9)][_0x2f316d(0x37c)]!=settings[_0x2f316d(0x32e)]||_0xe698a1['chat']['id']!=settings['telegramChatId'])return sendTelegram(_0xe698a1[_0x2f316d(0x3aa)]['id'],_0x2f316d(0x212),{'parse_mode':_0x2f316d(0x31c)}),![];return!![];}function botRef(_0x485efb){const _0x58db92=_0x15ba34,_0x5e7d14=getBotAttributes(_0x485efb),_0x9f4eca=_0x5e7d14[_0x58db92(0x3b8)]?_0x5e7d14[_0x58db92(0x3df)]:_0x58db92(0x3d5)+_0x485efb;return _0x9f4eca;}async function initTelegram(){const _0x9b3be=_0x15ba34;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x9b3be(0x2ba)]);let _0xf9a2a3=_0x9b3be(0x258);_0xf9a2a3+='\x0a',_0xf9a2a3+='/enable\x20-\x20enable\x20notifications\x0a',_0xf9a2a3+=_0x9b3be(0x23d),_0xf9a2a3+=_0x9b3be(0x2a0),_0xf9a2a3+='/restart\x20-\x20restart\x20bot(s)\x0a',_0xf9a2a3+=_0x9b3be(0x228),_0xf9a2a3+=_0x9b3be(0x290),_0xf9a2a3+=_0x9b3be(0x26e),_0xf9a2a3+='/names\x20-\x20show\x20bot\x20names\x0a',_0xf9a2a3+=_0x9b3be(0x1cf),_0xf9a2a3+=_0x9b3be(0x2de),_0xf9a2a3+=_0x9b3be(0x2d0),_0xf9a2a3+='/logs\x20-\x20receive\x20log\x20files\x0a',_0xf9a2a3+=_0x9b3be(0x213),_0xf9a2a3+=_0x9b3be(0x22b),_0xf9a2a3+=_0x9b3be(0x22a),_0xf9a2a3+=_0x9b3be(0x386);let _0x5ec3a6='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x5ec3a6+='\x0a',_0x5ec3a6+=_0xf9a2a3,tgBot[_0x9b3be(0x341)]((_0x38a1d1,_0x14f976)=>{const _0xdfece1=_0x9b3be;logger[_0xdfece1(0x1e2)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0xdfece1(0x335)](_0xdfece1(0x30f),_0x38a1d1);}),tgBot[_0x9b3be(0x201)](async(_0x302504,_0x2eb081)=>{const _0x28d56c=_0x9b3be;if(settings[_0x28d56c(0x1d1)]||_0x302504[_0x28d56c(0x27c)][_0x28d56c(0x38c)]['text']!=_0x28d56c(0x3c9)){if(!validateTelegram(_0x302504))return;}_0x2eb081();}),tgBot['command'](_0x9b3be(0x371),async _0x54d830=>{const _0x46cb5c=_0x9b3be;if(_0x54d830[_0x46cb5c(0x2a9)][_0x46cb5c(0x37c)]==settings['telegramUsername']||'@'+_0x54d830[_0x46cb5c(0x2a9)][_0x46cb5c(0x37c)]==settings[_0x46cb5c(0x32e)]){if(!settings[_0x46cb5c(0x1d1)])updateSetting('telegramChatId',_0x54d830['chat']['id']);else{if(!validateTelegram(_0x54d830))return;}}else{if(!validateTelegram(_0x54d830))return;}updateSetting('telegramEnabled',!![]),await sendTelegram(_0x54d830[_0x46cb5c(0x3aa)]['id'],_0x5ec3a6);}),tgBot[_0x9b3be(0x282)](_0x9b3be(0x2a5),async _0x58ae66=>{const _0x300f81=_0x9b3be;updateSetting(_0x300f81(0x366),!![]),await sendTelegram(_0x58ae66['chat']['id'],_0x300f81(0x34f));}),tgBot['command']('disable',async _0x3cee5d=>{const _0x21768e=_0x9b3be;await sendTelegram(_0x3cee5d[_0x21768e(0x3aa)]['id'],_0x21768e(0x1fb)),updateSetting(_0x21768e(0x366),![]);}),tgBot[_0x9b3be(0x282)](_0x9b3be(0x3c3),async _0x1483a8=>{const _0x2dc9aa=_0x9b3be,_0x507b54=Markup[_0x2dc9aa(0x261)]([Markup[_0x2dc9aa(0x2c3)][_0x2dc9aa(0x2f9)]('Orders',_0x2dc9aa(0x3b4)),Markup[_0x2dc9aa(0x2c3)][_0x2dc9aa(0x2f9)]('Alerts',_0x2dc9aa(0x363)),Markup['button'][_0x2dc9aa(0x2f9)](_0x2dc9aa(0x369),'config_all')]);_0x1483a8[_0x2dc9aa(0x314)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x507b54);}),tgBot[_0x9b3be(0x288)](_0x9b3be(0x3b4),async _0x1bc37b=>{const _0x206ec2=_0x9b3be;_0x1bc37b['editMessageReplyMarkup'](),updateSetting(_0x206ec2(0x38f),_0x206ec2(0x309)),updateSetting(_0x206ec2(0x366),!![]),await sendTelegram(_0x1bc37b[_0x206ec2(0x3aa)]['id'],_0x206ec2(0x391));}),tgBot[_0x9b3be(0x288)]('config_alerts',async _0x12e241=>{const _0x1d40b3=_0x9b3be;_0x12e241[_0x1d40b3(0x378)](),updateSetting(_0x1d40b3(0x38f),_0x1d40b3(0x1fc)),updateSetting(_0x1d40b3(0x366),!![]),await sendTelegram(_0x12e241[_0x1d40b3(0x3aa)]['id'],_0x1d40b3(0x2e1));}),tgBot[_0x9b3be(0x288)]('config_all',async _0x560e73=>{const _0x3cd5a2=_0x9b3be;_0x560e73[_0x3cd5a2(0x378)](),updateSetting(_0x3cd5a2(0x38f),_0x3cd5a2(0x29a)),updateSetting(_0x3cd5a2(0x366),!![]),await sendTelegram(_0x560e73[_0x3cd5a2(0x3aa)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x9b3be(0x282)](_0x9b3be(0x224),async _0x370180=>{const _0x43740d=_0x9b3be,_0xcd3e4b=getBotsWithMode();let _0x499d6e=_0x43740d(0x346);config[_0x43740d(0x1ed)](_0x3adf14=>{const _0x34ae50=_0x43740d,_0x3b5035=_0xcd3e4b['find'](_0x435950=>_0x435950[_0x34ae50(0x312)]==_0x3adf14[_0x34ae50(0x312)])[_0x34ae50(0x33a)];_0x499d6e+='Bot\x20'+_0x3adf14[_0x34ae50(0x312)]+':\x20'+_0x3adf14[_0x34ae50(0x224)]+_0x34ae50(0x24a)+_0x3b5035+'\x20|\x20'+_0x3adf14[_0x34ae50(0x3ad)]+'\x0a';}),_0x499d6e+='\x0a',_0x499d6e+=_0x43740d(0x3a6),_0x499d6e+=!settings['telegramEnabled']?_0x43740d(0x28c):_0x43740d(0x372),_0x499d6e+=settings[_0x43740d(0x366)]?settings[_0x43740d(0x38f)]==_0x43740d(0x29a)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x43740d(0x2d1)+settings[_0x43740d(0x38f)]+'\x20only\x0a':'',await sendTelegram(_0x370180[_0x43740d(0x3aa)]['id'],_0x499d6e,{'parse_mode':_0x43740d(0x31c)});}),tgBot['command']('restart',async _0x4ddbf1=>{const _0xb5f7e6=_0x9b3be,_0x225428=getEnabledBots();if(_0x225428['length']==0x0)await sendTelegram(_0x4ddbf1['chat']['id'],_0xb5f7e6(0x3d8));else{if(_0x225428['length']>0x1)_0x225428['push']({'botID':_0xb5f7e6(0x29a)});let _0x564988=[],_0x5dbc9b=[];const _0x318554=_0x225428[_0xb5f7e6(0x226)]%0x4==0x0||_0x225428[_0xb5f7e6(0x226)]%0x4==0x3||_0x225428['length']%0x3==0x1?0x4:0x3;let _0x3b84e6=0x0;_0x225428[_0xb5f7e6(0x1ed)]((_0x4b8d05,_0x2103c9)=>{const _0x228909=_0xb5f7e6;if(_0x2103c9%_0x318554==0x0)_0x5dbc9b=[];_0x5dbc9b[_0x228909(0x2f2)](Markup[_0x228909(0x2c3)][_0x228909(0x2f9)](_0x4b8d05[_0x228909(0x312)]==_0x228909(0x29a)?_0x228909(0x1e5):botRef(_0x4b8d05[_0x228909(0x312)]),_0x228909(0x364)+_0x4b8d05[_0x228909(0x312)])),_0x2103c9%_0x318554==0x0&&(_0x564988[_0x3b84e6]=_0x5dbc9b,_0x3b84e6++);});const _0x527b37=Markup['inlineKeyboard'](_0x564988);_0x4ddbf1[_0xb5f7e6(0x314)](_0xb5f7e6(0x3b1),_0x527b37);}}),tgBot[_0x9b3be(0x288)](/restart_(.+)/,async _0x462923=>{const _0x1cfb1c=_0x9b3be,_0x296a45=_0x462923[_0x1cfb1c(0x284)][0x1];_0x462923[_0x1cfb1c(0x378)](),_0x296a45==_0x1cfb1c(0x29a)?config['forEach'](_0x59ef4c=>{const _0x5b6e6f=_0x1cfb1c;restartBot(_0x59ef4c[_0x5b6e6f(0x312)]);}):restartBot(_0x296a45);}),tgBot[_0x9b3be(0x282)]('on',async _0x58b7dc=>{const _0x4b2616=_0x9b3be,_0x31a3d0=getDisabledBots();if(_0x31a3d0[_0x4b2616(0x226)]==0x0)await sendTelegram(_0x58b7dc[_0x4b2616(0x3aa)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x31a3d0[_0x4b2616(0x226)]>0x1)_0x31a3d0[_0x4b2616(0x2f2)]({'botID':'all'});let _0x3d6a2d=[],_0x2f5e96=[];const _0x51203f=_0x31a3d0[_0x4b2616(0x226)]%0x4==0x0||_0x31a3d0['length']%0x4==0x3||_0x31a3d0[_0x4b2616(0x226)]%0x3==0x1?0x4:0x3;let _0x309cbe=0x0;_0x31a3d0['forEach']((_0x53c0a3,_0x3d8265)=>{const _0x4a029d=_0x4b2616;if(_0x3d8265%_0x51203f==0x0)_0x2f5e96=[];_0x2f5e96[_0x4a029d(0x2f2)](Markup[_0x4a029d(0x2c3)]['callback'](_0x53c0a3[_0x4a029d(0x312)]=='all'?_0x4a029d(0x1e5):botRef(_0x53c0a3[_0x4a029d(0x312)]),_0x4a029d(0x1f2)+_0x53c0a3[_0x4a029d(0x312)])),_0x3d8265%_0x51203f==0x0&&(_0x3d6a2d[_0x309cbe]=_0x2f5e96,_0x309cbe++);});const _0x57c45f=Markup[_0x4b2616(0x261)](_0x3d6a2d);_0x58b7dc[_0x4b2616(0x314)](_0x4b2616(0x31a),_0x57c45f);}}),tgBot[_0x9b3be(0x288)](/on_(.+)/,async _0xcb0d1=>{const _0xeb735c=_0x9b3be,_0x2a9a85=_0xcb0d1[_0xeb735c(0x284)][0x1];_0xcb0d1[_0xeb735c(0x378)]();if(_0x2a9a85=='all'){const _0x265434=getDisabledBots();await sendTelegram(_0xcb0d1[_0xeb735c(0x3aa)]['id'],_0xeb735c(0x2f1)),_0x265434[_0xeb735c(0x1ed)](_0x47f91b=>{const _0x2e41bb=_0xeb735c;if(_0x47f91b['botID']!=_0x2e41bb(0x29a))toggleBot(_0x47f91b[_0x2e41bb(0x312)],toggleStatus(_0x47f91b['botID']),_0x2e41bb(0x3ce));});}else await sendTelegram(_0xcb0d1['chat']['id'],_0xeb735c(0x27a)+botRef(_0x2a9a85)),toggleBot(_0x2a9a85,toggleStatus(_0x2a9a85),_0xeb735c(0x3ce));}),tgBot['command'](_0x9b3be(0x230),async _0x17ba93=>{const _0x865e34=_0x9b3be,_0x2b7fdf=getEnabledBots();if(_0x2b7fdf[_0x865e34(0x226)]==0x0)await sendTelegram(_0x17ba93[_0x865e34(0x3aa)]['id'],_0x865e34(0x3d8));else{if(_0x2b7fdf[_0x865e34(0x226)]>0x1)_0x2b7fdf[_0x865e34(0x2f2)]({'botID':_0x865e34(0x29a)});let _0x241a69=[],_0x5c815b=[];const _0x5c7f5e=_0x2b7fdf['length']%0x4==0x0||_0x2b7fdf[_0x865e34(0x226)]%0x4==0x3||_0x2b7fdf[_0x865e34(0x226)]%0x3==0x1?0x4:0x3;let _0x4c3baa=0x0;_0x2b7fdf[_0x865e34(0x1ed)]((_0x4dbf2a,_0xa1cb0a)=>{const _0x39ba2e=_0x865e34;if(_0xa1cb0a%_0x5c7f5e==0x0)_0x5c815b=[];_0x5c815b[_0x39ba2e(0x2f2)](Markup[_0x39ba2e(0x2c3)]['callback'](_0x4dbf2a['botID']==_0x39ba2e(0x29a)?_0x39ba2e(0x1e5):botRef(_0x4dbf2a[_0x39ba2e(0x312)]),_0x39ba2e(0x2ab)+_0x4dbf2a[_0x39ba2e(0x312)])),_0xa1cb0a%_0x5c7f5e==0x0&&(_0x241a69[_0x4c3baa]=_0x5c815b,_0x4c3baa++);});const _0x119359=Markup[_0x865e34(0x261)](_0x241a69);_0x17ba93[_0x865e34(0x314)](_0x865e34(0x358),_0x119359);}}),tgBot[_0x9b3be(0x288)](/off_(.+)/,async _0x214b3a=>{const _0x53df3b=_0x9b3be,_0xb427f8=_0x214b3a[_0x53df3b(0x284)][0x1];_0x214b3a[_0x53df3b(0x378)]();if(_0xb427f8=='all'){const _0x4e0e82=getEnabledBots();await sendTelegram(_0x214b3a[_0x53df3b(0x3aa)]['id'],_0x53df3b(0x3a3)),_0x4e0e82[_0x53df3b(0x1ed)](_0x1f3a37=>{const _0x81aa75=_0x53df3b;if(_0x1f3a37['botID']!=_0x81aa75(0x29a))toggleBot(_0x1f3a37[_0x81aa75(0x312)],toggleStatus(_0x1f3a37['botID']),_0x81aa75(0x3ce));});}else await sendTelegram(_0x214b3a[_0x53df3b(0x3aa)]['id'],_0x53df3b(0x355)+botRef(_0xb427f8)),toggleBot(_0xb427f8,toggleStatus(_0xb427f8),_0x53df3b(0x3ce));}),tgBot[_0x9b3be(0x282)](_0x9b3be(0x332),async _0x476546=>{const _0x514344=_0x9b3be,_0x188b57=getEnabledBots();if(_0x188b57[_0x514344(0x226)]==0x0)await sendTelegram(_0x476546['chat']['id'],_0x514344(0x3d8));else{if(_0x188b57[_0x514344(0x226)]>0x1){let _0x43aadf=[],_0x3f14f0=[];const _0xf4ab6f=_0x188b57[_0x514344(0x226)]%0x4==0x0||_0x188b57[_0x514344(0x226)]%0x4==0x3||_0x188b57[_0x514344(0x226)]%0x3==0x1?0x4:0x3;let _0x5dac16=0x0;_0x188b57[_0x514344(0x1ed)]((_0x42b195,_0x27619c)=>{const _0x1a4667=_0x514344;if(_0x27619c%_0xf4ab6f==0x0)_0x3f14f0=[];_0x3f14f0[_0x1a4667(0x2f2)](Markup[_0x1a4667(0x2c3)][_0x1a4667(0x2f9)](botRef(_0x42b195['botID']),_0x1a4667(0x3b0)+_0x42b195[_0x1a4667(0x312)])),_0x27619c%_0xf4ab6f==0x0&&(_0x43aadf[_0x5dac16]=_0x3f14f0,_0x5dac16++);});const _0x1883f4=Markup['inlineKeyboard'](_0x43aadf);_0x476546['reply'](_0x514344(0x2c6),_0x1883f4);}else{const _0xeb1c82=_0x188b57[0x0][_0x514344(0x312)];if(pid[_0xeb1c82])pid[_0xeb1c82][_0x514344(0x1dc)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x9b3be(0x288)](/metrics_(.+)/,async _0x5326fd=>{const _0x30b681=_0x9b3be,_0x1fbe45=_0x5326fd[_0x30b681(0x284)][0x1];_0x5326fd[_0x30b681(0x378)]();if(pid[_0x1fbe45])pid[_0x1fbe45][_0x30b681(0x1dc)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x9b3be(0x282)]('portfolio',async _0x450bee=>{const _0x36528b=_0x9b3be,_0x5b3c05=getEnabledBots();if(_0x5b3c05[_0x36528b(0x226)]==0x0)await sendTelegram(_0x450bee['chat']['id'],_0x36528b(0x3d8));else{if(_0x5b3c05['length']>0x1){let _0x346452=[],_0x55009c=[];const _0x413180=_0x5b3c05[_0x36528b(0x226)]%0x4==0x0||_0x5b3c05[_0x36528b(0x226)]%0x4==0x3||_0x5b3c05[_0x36528b(0x226)]%0x3==0x1?0x4:0x3;let _0x3e54a6=0x0;_0x5b3c05['forEach']((_0x2c0cee,_0x13a359)=>{const _0x275ec=_0x36528b;if(_0x13a359%_0x413180==0x0)_0x55009c=[];_0x55009c['push'](Markup[_0x275ec(0x2c3)][_0x275ec(0x2f9)](botRef(_0x2c0cee[_0x275ec(0x312)]),_0x275ec(0x260)+_0x2c0cee[_0x275ec(0x312)])),_0x13a359%_0x413180==0x0&&(_0x346452[_0x3e54a6]=_0x55009c,_0x3e54a6++);});const _0x51c039=Markup[_0x36528b(0x261)](_0x346452);_0x450bee['reply'](_0x36528b(0x356),_0x51c039);}else{const _0x2d3494=_0x5b3c05[0x0]['botID'];if(pid[_0x2d3494])pid[_0x2d3494][_0x36528b(0x1dc)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x9b3be(0x288)](/portfolio_(.+)/,async _0x3050df=>{const _0x384dd7=_0x9b3be,_0x2ff462=_0x3050df[_0x384dd7(0x284)][0x1];_0x3050df['editMessageReplyMarkup']();if(pid[_0x2ff462])pid[_0x2ff462][_0x384dd7(0x1dc)]({'function':_0x384dd7(0x348),'args':null});}),tgBot['command'](_0x9b3be(0x3b5),async _0x3cdf4c=>{const _0x3e368b=_0x9b3be,_0x432a9c=_0x3e368b(0x3b5);await zipFiles(_0x432a9c);const _0x4b45ac=zippath+(_0x432a9c+_0x3e368b(0x310));_0x3cdf4c[_0x3e368b(0x316)]({'source':_0x4b45ac})[_0x3e368b(0x297)](()=>{})[_0x3e368b(0x341)](_0x3ff7ca=>logger[_0x3e368b(0x335)](_0x3e368b(0x389)+_0x432a9c+_0x3e368b(0x227),_0x3ff7ca));}),tgBot[_0x9b3be(0x282)](_0x9b3be(0x3cf),async _0x17196e=>{const _0x792445=_0x9b3be,_0x4d46b6='backup';await backupConfigFiles(),await zipFiles(_0x4d46b6);const _0x546b2a=zippath+(_0x4d46b6+_0x792445(0x310));_0x17196e[_0x792445(0x316)]({'source':_0x546b2a})[_0x792445(0x297)](()=>{})[_0x792445(0x341)](_0x4253e6=>logger[_0x792445(0x335)](_0x792445(0x389)+_0x4d46b6+_0x792445(0x227),_0x4253e6));}),tgBot[_0x9b3be(0x282)](_0x9b3be(0x27c),async _0xe8ff3e=>{const _0x2a39bf=_0x9b3be;await getMessages();if(!updateAvailable)await sendTelegram(_0xe8ff3e[_0x2a39bf(0x3aa)]['id'],_0x2a39bf(0x319));else{if(!validInstallation)await sendTelegram(_0xe8ff3e[_0x2a39bf(0x3aa)]['id'],_0x2a39bf(0x359));else{const _0x31b95a=Markup[_0x2a39bf(0x261)]([Markup[_0x2a39bf(0x2c3)]['callback'](_0x2a39bf(0x2bb),_0x2a39bf(0x3c7)),Markup[_0x2a39bf(0x2c3)]['callback']('No',_0x2a39bf(0x331))]);_0xe8ff3e[_0x2a39bf(0x314)](_0x2a39bf(0x2e8),_0x31b95a);}}}),tgBot[_0x9b3be(0x288)](/update_(.+)/,async _0x7cc725=>{const _0xaa591a=_0x9b3be,_0x9070b8=_0x7cc725['match'][0x1];_0x7cc725[_0xaa591a(0x378)](),_0x9070b8==_0xaa591a(0x1e3)&&(await sendTelegram(_0x7cc725['chat']['id'],_0xaa591a(0x2f5)),updateBB('update')),_0x9070b8=='no'&&await sendTelegram(_0x7cc725[_0xaa591a(0x3aa)]['id'],_0xaa591a(0x2ad));}),tgBot[_0x9b3be(0x282)]('reinstall',async _0x23d3f9=>{const _0x151c76=_0x9b3be;if(!validInstallation)await sendTelegram(_0x23d3f9[_0x151c76(0x3aa)]['id'],_0x151c76(0x330));else{const _0x127f5f=Markup[_0x151c76(0x261)]([Markup['button']['callback'](_0x151c76(0x2bb),'reinstall_yes'),Markup[_0x151c76(0x2c3)][_0x151c76(0x2f9)]('No','reinstall_no')]);_0x23d3f9[_0x151c76(0x314)](_0x151c76(0x1d5),_0x127f5f);}}),tgBot[_0x9b3be(0x288)](/reinstall_(.+)/,async _0x3a0390=>{const _0x5b2028=_0x9b3be,_0x54263f=_0x3a0390[_0x5b2028(0x284)][0x1];_0x3a0390[_0x5b2028(0x378)](),_0x54263f==_0x5b2028(0x1e3)&&(await sendTelegram(_0x3a0390[_0x5b2028(0x3aa)]['id'],_0x5b2028(0x36f)),updateBB(_0x5b2028(0x2c4))),_0x54263f=='no'&&await sendTelegram(_0x3a0390[_0x5b2028(0x3aa)]['id'],_0x5b2028(0x38e));}),tgBot[_0x9b3be(0x282)]('toggle',async _0x81725d=>{const _0x5bddb4=_0x9b3be,_0x57f7a5=getBotsWithMode();if(_0x57f7a5['length']==0x0)await sendTelegram(_0x81725d[_0x5bddb4(0x3aa)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x211ace=[],_0x126c5f=[];const _0x4ce696=0x2;let _0x4bf2b3=0x0;_0x57f7a5['forEach']((_0x104118,_0x248373)=>{const _0x21fe8b=_0x5bddb4;if(_0x248373%_0x4ce696==0x0)_0x126c5f=[];_0x126c5f[_0x21fe8b(0x2f2)](Markup['button'][_0x21fe8b(0x2f9)](botRef(_0x104118[_0x21fe8b(0x312)])+'\x20('+_0x104118['mode']+')',_0x21fe8b(0x2eb)+_0x104118['botID'])),_0x248373%_0x4ce696==0x0&&(_0x211ace[_0x4bf2b3]=_0x126c5f,_0x4bf2b3++);});const _0x5f524b=Markup[_0x5bddb4(0x261)](_0x211ace);_0x81725d[_0x5bddb4(0x314)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x5f524b);}}),tgBot[_0x9b3be(0x288)](/toggle_(.+)/,async _0x350448=>{const _0x192c29=_0x9b3be,_0x282707=_0x350448[_0x192c29(0x284)][0x1];_0x350448[_0x192c29(0x378)]();const _0x261e9b=getBotsWithMode(),_0x1c078f=_0x261e9b[_0x192c29(0x37a)](_0x2aee3d=>_0x2aee3d[_0x192c29(0x312)]==_0x282707),_0x4b4fbe=_0x1c078f[_0x192c29(0x33a)]==_0x192c29(0x3a8)?_0x192c29(0x3b6):_0x192c29(0x3a8);await sendTelegram(_0x350448[_0x192c29(0x3aa)]['id'],_0x192c29(0x286)+botRef(_0x1c078f[_0x192c29(0x312)])+'\x20to\x20'+_0x4b4fbe+'\x20mode'),toggleBotMode(_0x282707);}),tgBot[_0x9b3be(0x282)](_0x9b3be(0x2fd),async _0x54f78e=>{const _0x4cdb38=_0x9b3be;let _0x48c7b9='';config[_0x4cdb38(0x1ed)](_0x54c393=>{const _0x9f08f8=_0x4cdb38;_0x48c7b9+=_0x9f08f8(0x3d5)+_0x54c393[_0x9f08f8(0x312)]+':\x20'+_0x54c393[_0x9f08f8(0x3df)]+'\x0a';}),await sendTelegram(_0x54f78e['chat']['id'],_0x48c7b9,{'parse_mode':_0x4cdb38(0x31c)});}),tgBot[_0x9b3be(0x282)](_0x9b3be(0x383),async _0x137ddc=>{await sendTelegram(_0x137ddc['chat']['id'],_0xf9a2a3);}),process[_0x9b3be(0x3dd)]('SIGINT',()=>tgBot['stop'](_0x9b3be(0x27f))),process[_0x9b3be(0x3dd)](_0x9b3be(0x2b7),()=>tgBot['stop'](_0x9b3be(0x2b7))),tgBot[_0x9b3be(0x3d4)]();}function disableTelegram(){const _0x5aa210=_0x15ba34;tgBot&&tgBot[_0x5aa210(0x1d2)]();}async function sendTelegram(_0x57ea13,_0x45ff40,_0x14dc12){const _0x2a3e18=_0x15ba34;_0x14dc12={..._0x14dc12,'disable_web_page_preview':!![]};try{await tgBot[_0x2a3e18(0x2af)]['sendMessage'](_0x57ea13,_0x45ff40,_0x14dc12);}catch(_0x16c4b8){logger[_0x2a3e18(0x335)]('Telegram\x20error:',_0x16c4b8);}}async function sendTelegramBot(_0x44e125,_0x51ce39){const _0x26c519=_0x15ba34;if(settings[_0x26c519(0x366)]){if(settings[_0x26c519(0x38f)]=='all'||(_0x51ce39[_0x26c519(0x2c8)]==_0x26c519(0x2cd)||_0x51ce39['type']==_0x26c519(0x3de)||_0x51ce39[_0x26c519(0x2c8)]=='success')&&settings['telegramEvents']==_0x26c519(0x1fc)||_0x51ce39['type']==_0x26c519(0x3a2)&&settings[_0x26c519(0x38f)]==_0x26c519(0x309)){if(tgBot&&settings[_0x26c519(0x1d1)]){if(_0x51ce39[_0x26c519(0x3b8)])await sendTelegram(settings[_0x26c519(0x1d1)],_0x51ce39[_0x26c519(0x3df)]+_0x26c519(0x370)+_0x51ce39[_0x26c519(0x30c)]);else await sendTelegram(settings['telegramChatId'],_0x26c519(0x3d5)+_0x44e125+_0x26c519(0x370)+_0x51ce39[_0x26c519(0x30c)]);}}}}async function sendTelegramMsg(_0x2b9ac9,_0xc108be=_0x15ba34(0x31c)){const _0x4bf869=_0x15ba34;return tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x4bf869(0x1d1)],_0x2b9ac9,{'parse_mode':_0xc108be}),!![]):![];}function getDeviceWithIp(_0x22ee31){return devices['find'](_0x554c38=>_0x554c38['ip']===_0x22ee31);}async function temporaryAccess2FA(_0x5ba63b,_0x92c828){const _0x1d082b=_0x15ba34;let _0x2e156f=new Date(),_0x55021a=![];if(lastIpApproval){if(_0x2e156f-lastIpApproval<0x1388)_0x55021a=!![];}lastIpApproval=new Date();if(_0x55021a)return;if(tgBot&&settings[_0x1d082b(0x1d1)]){const _0x4f77a8=uuidRandom();tmpStorage[_0x4f77a8]={'uuid':_0x5ba63b,'externalip':_0x92c828};const _0x409bad=Markup[_0x1d082b(0x261)]([Markup[_0x1d082b(0x2c3)][_0x1d082b(0x2f9)](_0x1d082b(0x323),_0x1d082b(0x208)+_0x4f77a8),Markup[_0x1d082b(0x2c3)][_0x1d082b(0x2f9)](_0x1d082b(0x30a),_0x1d082b(0x3dc)+_0x4f77a8),Markup[_0x1d082b(0x2c3)]['callback'](_0x1d082b(0x398),_0x1d082b(0x2ac)+_0x4f77a8),Markup['button'][_0x1d082b(0x2f9)](_0x1d082b(0x2bd),_0x1d082b(0x3a0)+_0x4f77a8)]);await sendTelegram(settings['telegramChatId'],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x92c828)[_0x1d082b(0x3af)]+'\x20?',_0x409bad),tgBot[_0x1d082b(0x288)](/tempaccess_(.+)_(.+)/,async _0x11962e=>{const _0x3a4088=_0x1d082b,_0xc3c03d=_0x11962e[_0x3a4088(0x284)][0x1],_0x14fe4e=_0x11962e[_0x3a4088(0x284)][0x2],{uuid:_0x20cda8,externalip:_0x3a0ee3}=tmpStorage[_0x14fe4e];delete tmpStorage[_0x14fe4e],_0x11962e[_0x3a4088(0x378)](),devices[_0x20cda8][_0x3a4088(0x1f5)]={'clientip':_0x3a0ee3,'timestamp':new Date()[_0x3a4088(0x3d6)](),'expiry':_0xc3c03d},_0xc3c03d!=_0x3a4088(0x2bd)?(await sendTelegram(_0x11962e['chat']['id'],'Access\x20enabled\x20for\x20'+_0xc3c03d+'\x20minutes',{'parse_mode':_0x3a4088(0x31c)}),io['to'](_0x20cda8)[_0x3a4088(0x2bc)](_0x3a4088(0x224),{'access':{'allow':![],'reason':_0x3a4088(0x2b8),'token':null}})):(await sendTelegram(_0x11962e[_0x3a4088(0x3aa)]['id'],_0x3a4088(0x3d7)),io['to'](_0x20cda8)[_0x3a4088(0x2bc)](_0x3a4088(0x224),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x1e38cb,_0x3340e6){const _0x1759ca=_0x15ba34;if(tgBot&&settings[_0x1759ca(0x1d1)]){const _0x36c729=uuidRandom();tmpStorage[_0x36c729]={'uuid':_0x1e38cb,'externalip':_0x3340e6};const _0x1012ac=Markup[_0x1759ca(0x261)]([Markup[_0x1759ca(0x2c3)][_0x1759ca(0x2f9)]('accept','login2fa_'+loginExpiry+'_'+_0x36c729),Markup[_0x1759ca(0x2c3)]['callback'](_0x1759ca(0x2bd),_0x1759ca(0x39e)+_0x36c729)]);await sendTelegram(settings['telegramChatId'],_0x1759ca(0x35f)+normalizeIP(_0x3340e6)[_0x1759ca(0x3af)]+'\x20?',_0x1012ac),tgBot[_0x1759ca(0x288)](/login2fa_(.+)_(.+)/,async _0x3f12df=>{const _0x5ca3e7=_0x1759ca,_0x3740ec=_0x3f12df[_0x5ca3e7(0x284)][0x1],_0x10ffb4=_0x3f12df[_0x5ca3e7(0x284)][0x2],{uuid:_0x2f8da9,externalip:_0x324f09}=tmpStorage[_0x10ffb4];delete tmpStorage[_0x10ffb4],_0x3f12df[_0x5ca3e7(0x378)](),devices[_0x2f8da9][_0x5ca3e7(0x267)]={'clientip':_0x324f09,'timestamp':new Date()[_0x5ca3e7(0x3d6)](),'expiry':_0x3740ec},_0x3740ec!=_0x5ca3e7(0x2bd)?(await sendTelegram(_0x3f12df['chat']['id'],_0x5ca3e7(0x397),{'parse_mode':_0x5ca3e7(0x31c)}),io['to'](_0x2f8da9)[_0x5ca3e7(0x2bc)](_0x5ca3e7(0x224),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x3f12df[_0x5ca3e7(0x3aa)]['id'],_0x5ca3e7(0x2fe)),io['to'](_0x2f8da9)[_0x5ca3e7(0x2bc)](_0x5ca3e7(0x224),{'access':{'allow':![],'reason':_0x5ca3e7(0x257),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4ecd53=_0x15ba34;return dbConfig[_0x4ecd53(0x1d7)]('bots')['sortBy']('botID')[_0x4ecd53(0x239)]({'status':'enabled'})[_0x4ecd53(0x333)]()||[];}function getDisabledBots(){const _0x5e00c9=_0x15ba34;return dbConfig[_0x5e00c9(0x1d7)](_0x5e00c9(0x3a4))[_0x5e00c9(0x254)](_0x5e00c9(0x312))[_0x5e00c9(0x239)]({'status':_0x5e00c9(0x2db)})[_0x5e00c9(0x333)]()||[];}function getBotAttributes(_0x39c694){const _0x50e044=_0x15ba34;let _0x5c46f9={};const _0x540110=configpath+'bot-'+_0x39c694+'-config.json',_0x4a5533=fs[_0x50e044(0x229)](_0x540110);if(_0x4a5533){const _0x1b1adc=fs[_0x50e044(0x24d)](_0x540110);try{const _0x38a83e=JSON[_0x50e044(0x2d2)](_0x1b1adc),_0x452e58=_0x38a83e?_0x38a83e[_0x50e044(0x39d)][0x0][_0x50e044(0x33f)]:![];_0x5c46f9['mode']=_0x452e58?_0x50e044(0x3a8):_0x50e044(0x3b6),_0x5c46f9[_0x50e044(0x3df)]=_0x38a83e?_0x38a83e[_0x50e044(0x39d)][0x0][_0x50e044(0x3df)]:'Bot\x20'+_0x39c694,_0x5c46f9[_0x50e044(0x3b8)]=_0x38a83e?_0x38a83e[_0x50e044(0x39d)][0x0][_0x50e044(0x3b8)]:![];}catch(_0x2cdc95){_0x5c46f9[_0x50e044(0x33a)]=_0x50e044(0x3b6),_0x5c46f9[_0x50e044(0x3df)]='Bot\x20'+_0x39c694,_0x5c46f9['showname']=![];}}else _0x5c46f9[_0x50e044(0x33a)]=_0x50e044(0x3b6),_0x5c46f9[_0x50e044(0x3df)]='Bot\x20'+_0x39c694,_0x5c46f9['showname']=![];return _0x5c46f9;}function getBotsWithMode(){const _0x771b6a=_0x15ba34,_0x2ee7b0=dbConfig[_0x771b6a(0x1d7)](_0x771b6a(0x3a4))[_0x771b6a(0x254)](_0x771b6a(0x312))['value']()||[];return _0x2ee7b0[_0x771b6a(0x1ed)](_0xc14872=>{const _0x47afcc=_0x771b6a;let _0x5768a3=getBotAttributes(_0xc14872['botID']);_0xc14872[_0x47afcc(0x33a)]=_0x5768a3[_0x47afcc(0x33a)];}),_0x2ee7b0;}function getBotExchanges(){const _0x4540ef=_0x15ba34;let _0x1d703a=[];const _0x760d03=dbConfig['get']('bots')['sortBy']('botID')['value']()||[];_0x760d03['forEach'](_0x49ddbd=>{const _0x517c12=_0x77ce;if(_0x49ddbd[_0x517c12(0x224)]==_0x517c12(0x1d0)){const _0x1f46c6=configpath+_0x517c12(0x351)+_0x49ddbd[_0x517c12(0x312)]+'-config.json',_0x253f7f=fs['existsSync'](_0x1f46c6);let _0xf34471;if(_0x253f7f){const _0x16b57a=fs[_0x517c12(0x24d)](_0x1f46c6);try{const _0x598ec9=JSON['parse'](_0x16b57a);_0xf34471=_0x598ec9?_0x598ec9[_0x517c12(0x39d)][0x0][_0x517c12(0x1fd)]:null;}catch(_0x3008a7){}}if(_0xf34471)_0x1d703a['push'](_0xf34471);}});const _0x58fae2=[...new Set(_0x1d703a)][_0x4540ef(0x374)]();return _0x58fae2;}async function initUser(){const _0x543216=_0x15ba34;if(!settings['userid']){const _0x5a0792=uuidRandom();mixpanel['alias'](_0x5a0792),updateSetting(_0x543216(0x338),_0x5a0792);}}async function initSecure(){const _0x5a29f4=_0x15ba34;let _0x392f45=getSecure();if(!_0x392f45[_0x5a29f4(0x22c)](_0x5a29f4(0x32c))){let _0x2cf56f=await generateKeys();_0x392f45['publicKey']=_0x2cf56f[_0x5a29f4(0x2b0)],_0x392f45[_0x5a29f4(0x320)]=_0x2cf56f[_0x5a29f4(0x320)],_0x392f45['secret']=crypto['randomBytes'](0x20)[_0x5a29f4(0x1df)](_0x5a29f4(0x2a3));;storeSecure(_0x392f45);}}function getSettings(){const _0x5c62ce=_0x15ba34;return dbSettings[_0x5c62ce(0x1d7)](_0x5c62ce(0x2f8))[_0x5c62ce(0x333)]()||{};}function getSecure(){const _0x152616=_0x15ba34;return dbSecure[_0x152616(0x1d7)](_0x152616(0x3b3))[_0x152616(0x333)]()||{};}function getBlacklist(){const _0x235da5=_0x15ba34;return dbSecure[_0x235da5(0x1d7)]('blacklist')[_0x235da5(0x333)]()||[];}function broadcastToBots(_0x50dc16,_0x350ceb){const _0x1c9bc5=_0x15ba34;config[_0x1c9bc5(0x1ed)](_0x1bdcfa=>{const _0x4a8c48=_0x1c9bc5;if(_0x1bdcfa[_0x4a8c48(0x224)]==_0x4a8c48(0x1d0)&&_0x1bdcfa[_0x4a8c48(0x3ad)]==_0x4a8c48(0x25c)||_0x1bdcfa[_0x4a8c48(0x224)]==_0x4a8c48(0x244)&&_0x1bdcfa[_0x4a8c48(0x3ad)]==_0x4a8c48(0x25c)){if(pid[_0x1bdcfa[_0x4a8c48(0x312)]])pid[_0x1bdcfa[_0x4a8c48(0x312)]][_0x4a8c48(0x1dc)]({[_0x50dc16]:_0x350ceb});}});}async function storeSettings(_0x15a95d,_0x59fb5d=![]){const _0x22f907=_0x15ba34;_0x15a95d={...settings,..._0x15a95d};if(_0x59fb5d&&_0x15a95d['bbPassword']!=_0x22f907(0x247)&&_0x15a95d['bbPassword']!=_0x22f907(0x326)&&_0x15a95d[_0x22f907(0x2b2)]!=''){const _0xf9de00=decryptRSA(secure[_0x22f907(0x320)],_0x15a95d['bbPassword'])['split']('|@|')[0x0],_0x11e995=bcrypt[_0x22f907(0x291)](_0xf9de00,saltRounds);_0x15a95d={..._0x15a95d,'bbPassword':_0x11e995};}if(_0x59fb5d&&_0x15a95d[_0x22f907(0x2ba)]!='************'&&_0x15a95d[_0x22f907(0x2ba)]!=_0x22f907(0x326)&&_0x15a95d['telegramToken']!=''){const _0x1f5d0c=decryptRSA(secure[_0x22f907(0x320)],_0x15a95d[_0x22f907(0x2ba)])[_0x22f907(0x2c2)](_0x22f907(0x329))[0x0];_0x15a95d={..._0x15a95d,'telegramToken':_0x1f5d0c};}if(_0x59fb5d&&_0x15a95d[_0x22f907(0x2d9)]!=_0x22f907(0x247)&&_0x15a95d['marketcapApi']!=_0x22f907(0x326)&&_0x15a95d[_0x22f907(0x2d9)]!=''){const _0x3b13d5=decryptRSA(secure[_0x22f907(0x320)],_0x15a95d[_0x22f907(0x2d9)])[_0x22f907(0x2c2)]('|@|')[0x0];_0x15a95d={..._0x15a95d,'marketcapApi':_0x3b13d5};}const _0x17db7b=_0x15a95d['telegramToken']!='************'&&_0x15a95d[_0x22f907(0x2ba)]!=settings[_0x22f907(0x2ba)]||_0x15a95d['telegramUsername']!=settings[_0x22f907(0x32e)],_0x2548e1=_0x15a95d['telegramToken']==''||_0x15a95d[_0x22f907(0x32e)]=='',_0x128478=_0x15a95d[_0x22f907(0x2d9)]&&_0x15a95d['marketcapApi']!=_0x22f907(0x247)&&_0x15a95d['marketcapApi']!=settings['marketcapApi'];_0x17db7b&&(_0x15a95d['telegramChatId']=null,_0x15a95d[_0x22f907(0x38f)]=_0x22f907(0x29a));for(const [_0x58589d,_0x5ee84c]of Object[_0x22f907(0x255)](_0x15a95d)){if(_0x58589d==_0x22f907(0x2ba)&&_0x5ee84c==_0x22f907(0x247)){_0x15a95d[_0x22f907(0x2ba)]=settings[_0x22f907(0x2ba)];continue;};if(_0x58589d==_0x22f907(0x2b2)&&_0x5ee84c==_0x22f907(0x247)){_0x15a95d['bbPassword']=settings[_0x22f907(0x2b2)];continue;};if(_0x58589d==_0x22f907(0x2d9)&&_0x5ee84c==_0x22f907(0x247)){_0x15a95d[_0x22f907(0x2d9)]=settings['marketcapApi'];continue;};dbSettings[_0x22f907(0x263)]('settings.'+_0x58589d,_0x5ee84c)['write']();}settings=_0x15a95d,io['to'](_0x22f907(0x209))[_0x22f907(0x2bc)](_0x22f907(0x2f8),cleanSettings()),broadcastToBots('timeshift',settings['timeshift']),broadcastToBots(_0x22f907(0x26b),settings[_0x22f907(0x26b)]),broadcastToBots(_0x22f907(0x2d9),settings['marketcapApi']);if(_0x17db7b&&!_0x2548e1)initTelegram();_0x17db7b&&_0x2548e1&&(updateSetting(_0x22f907(0x1d1),null),disableTelegram()),getAllClients()[_0x22f907(0x1ed)](_0x322e11=>{const _0x101b9a=_0x22f907;getSocket(_0x322e11['id'])[_0x101b9a(0x2bc)]('status',{'access':{'allow':![],'reason':_0x101b9a(0x2b8),'token':null}});}),_0x128478&&(await sleep(0xbb8),testMarketcapApi(_0x15a95d[_0x22f907(0x2d9)]));}async function testMarketcapApi(_0x3f7347){const _0x34b58e=_0x15ba34,_0x19076d=[_0x34b58e(0x308),_0x34b58e(0x315)];try{await axios[_0x34b58e(0x1d7)](_0x34b58e(0x2cb),{'headers':{'X-CMC_PRO_API_KEY':_0x3f7347},'params':{'symbol':_0x19076d['toString']()}});}catch(_0x4cdd85){_0x4cdd85[_0x34b58e(0x1df)]()[_0x34b58e(0x31e)](_0x34b58e(0x272))?(io['to'](_0x34b58e(0x209))[_0x34b58e(0x2bc)](_0x34b58e(0x34c),_0x34b58e(0x28d)),logger[_0x34b58e(0x1d9)](_0x34b58e(0x28d))):(io['to'](_0x34b58e(0x209))['emit']('notification',_0x34b58e(0x2e4)),logger[_0x34b58e(0x1d9)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x34b58e(0x335)](_0x34b58e(0x3a9),_0x4cdd85[_0x34b58e(0x1df)]()+_0x34b58e(0x23c)+_0x4cdd85['code']));return;}logger[_0x34b58e(0x335)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x57d1f0,_0x55e8d2){const _0x123a3b=_0x15ba34;dbSettings[_0x123a3b(0x263)](_0x123a3b(0x241)+_0x57d1f0,_0x55e8d2)[_0x123a3b(0x34d)](),settings=getSettings(),io['to'](_0x123a3b(0x209))[_0x123a3b(0x2bc)](_0x123a3b(0x2f8),cleanSettings());}function storeSecure(_0x3afa59){const _0x221580=_0x15ba34;dbSecure[_0x221580(0x1d7)](_0x221580(0x3b3))[_0x221580(0x2f2)](_0x3afa59)[_0x221580(0x34d)](),secure=_0x3afa59;}function addBlacklist(_0x4fe9c8){const _0x18d3de=_0x15ba34;cleanBlacklist();let _0x31362b;devices[_0x4fe9c8][_0x18d3de(0x1f5)]?_0x31362b=Math[_0x18d3de(0x2ae)](devices[_0x4fe9c8][_0x18d3de(0x1f5)]['expiry'],loginExpiry):_0x31362b=loginExpiry,dbSecure['get']('blacklist')[_0x18d3de(0x2f2)]({'expiry':new Date()[_0x18d3de(0x3d6)]()+_0x31362b*0x3c*0x3e8,'token':devices[_0x4fe9c8][_0x18d3de(0x37e)][_0x18d3de(0x36e)]})['write'](),blacklist=dbSecure[_0x18d3de(0x1d7)]('blacklist')['value']();}function cleanBlacklist(){const _0x3e4f49=_0x15ba34;let _0x47c519=dbSecure[_0x3e4f49(0x1d7)](_0x3e4f49(0x30b))[_0x3e4f49(0x215)]()[_0x3e4f49(0x333)](),_0x28120d=new Date()[_0x3e4f49(0x3d6)]();_0x47c519[_0x3e4f49(0x1ed)](_0x5a536f=>{const _0x4ce0c7=_0x3e4f49;_0x5a536f['expiry']<_0x28120d&&dbSecure[_0x4ce0c7(0x1d7)](_0x4ce0c7(0x30b))['remove']({'expiry':_0x5a536f[_0x4ce0c7(0x20b)]})[_0x4ce0c7(0x34d)]();});}function initStates(){let _0x248332=getConfiguration();_0x248332['forEach'](_0x546341=>{const _0x24bea5=_0x77ce;_0x546341[_0x24bea5(0x3ad)]=_0x24bea5(0x3ce);}),storeConfiguration(_0x248332);}async function generateKeys(){const _0x5313de=_0x15ba34,_0x1b15db=forge[_0x5313de(0x327)][_0x5313de(0x36b)][_0x5313de(0x3c5)]({'bits':0x1000,'e':0x10001}),_0x220598=forge[_0x5313de(0x327)][_0x5313de(0x342)](_0x1b15db[_0x5313de(0x320)]),_0x432e08=forge[_0x5313de(0x327)][_0x5313de(0x321)](_0x1b15db[_0x5313de(0x2b0)]);return{'privateKey':_0x220598,'publicKey':_0x432e08};}async function oneTimeMigration(){const _0xf12b78=_0x15ba34;let _0x222370=getSettings(),_0x3b659e=![];!_0x222370[_0xf12b78(0x22c)](_0xf12b78(0x274))&&(_0x222370[_0xf12b78(0x274)]=0x0,_0x3b659e=!![]);!_0x222370[_0xf12b78(0x22c)](_0xf12b78(0x20f))&&(_0x222370[_0xf12b78(0x20f)]=0x0,_0x3b659e=!![]);!_0x222370[_0xf12b78(0x22c)](_0xf12b78(0x237))&&(_0x222370[_0xf12b78(0x237)]=_0xf12b78(0x279),_0x3b659e=!![]);!_0x222370[_0xf12b78(0x22c)](_0xf12b78(0x26b))&&(_0x222370[_0xf12b78(0x26b)]=![],_0x3b659e=!![]);!_0x222370['hasOwnProperty'](_0xf12b78(0x2d9))&&(_0x222370[_0xf12b78(0x2d9)]='',_0x3b659e=!![]);if(_0x3b659e)storeSettings(_0x222370);try{fs[_0xf12b78(0x273)](configbackuppath,{'withFileTypes':!![]})[_0xf12b78(0x1ed)](_0x1c7467=>{const _0x4cb56e=_0xf12b78;if(!_0x1c7467[_0x4cb56e(0x262)]()){if(!_0x1c7467[_0x4cb56e(0x26d)][_0x4cb56e(0x2ed)](_0x4cb56e(0x3ab)))fs[_0x4cb56e(0x1e1)](configbackuppath+_0x1c7467[_0x4cb56e(0x26d)]);}else fs[_0x4cb56e(0x1fa)](configbackuppath+_0x1c7467[_0x4cb56e(0x26d)],{'recursive':!![]});});}catch(_0x46de36){logger[_0xf12b78(0x335)](_0xf12b78(0x34a),_0x46de36);}}function storeConfiguration(_0x3c06ef){const _0x5ef3ba=_0x15ba34;dbConfig[_0x5ef3ba(0x1d7)](_0x5ef3ba(0x3a4))['remove']()[_0x5ef3ba(0x34d)](),dbConfig[_0x5ef3ba(0x1d7)](_0x5ef3ba(0x3a4))[_0x5ef3ba(0x2f2)](..._0x3c06ef)[_0x5ef3ba(0x34d)](),config=_0x3c06ef;}async function resetPassword(){const _0xd0ea14=_0x15ba34;if(tgBot&&settings[_0xd0ea14(0x1d1)]){const _0x4a38e5=Markup['inlineKeyboard']([Markup[_0xd0ea14(0x2c3)][_0xd0ea14(0x2f9)](_0xd0ea14(0x1e3),_0xd0ea14(0x29f)),Markup['button']['callback']('no','resetpw_no')]);await sendTelegram(settings[_0xd0ea14(0x1d1)],_0xd0ea14(0x361),_0x4a38e5),tgBot['action'](/resetpw_(.+)/,async _0x36b618=>{const _0x3774a6=_0xd0ea14,_0x9e27a4=_0x36b618[_0x3774a6(0x284)][0x1];_0x36b618[_0x3774a6(0x378)]();if(_0x9e27a4!='no'){const _0x3d8cb3=0xf,_0x1c5b5a='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x172429=Array['from'](crypto[_0x3774a6(0x382)](new Uint32Array(_0x3d8cb3)))[_0x3774a6(0x277)](_0x311517=>_0x1c5b5a[_0x311517%_0x1c5b5a[_0x3774a6(0x226)]])[_0x3774a6(0x38b)](''),_0x3e12e7=bcrypt['hashSync'](_0x172429,saltRounds);storeSettings({'bbPassword':_0x3e12e7}),await sendTelegram(_0x36b618[_0x3774a6(0x3aa)]['id'],_0x3774a6(0x3cd)+_0x172429,{'parse_mode':_0x3774a6(0x31c)});}else await sendTelegram(_0x36b618[_0x3774a6(0x3aa)]['id'],_0x3774a6(0x390));});}}async function confirmRestore(_0x49d81e,_0x267059){const _0x54bd1c=_0x15ba34;io['to']('botmanager')['emit'](_0x54bd1c(0x34c),_0x54bd1c(0x32a),_0x54bd1c(0x337));if(tgBot&&settings[_0x54bd1c(0x1d1)]){const _0x424779=uuidRandom();tmpStorage[_0x424779]={'path':_0x49d81e,'filename':_0x267059};const _0x20178e=Markup[_0x54bd1c(0x261)]([Markup[_0x54bd1c(0x2c3)][_0x54bd1c(0x2f9)](_0x54bd1c(0x1e3),'restore_yes_'+_0x424779),Markup[_0x54bd1c(0x2c3)][_0x54bd1c(0x2f9)]('no','restore_no_'+_0x424779)]);await sendTelegram(settings[_0x54bd1c(0x1d1)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x20178e),tgBot[_0x54bd1c(0x288)](/restore_(.+)_(.+)/,async _0xf15e04=>{const _0x102393=_0x54bd1c,_0x1a790a=_0xf15e04[_0x102393(0x284)][0x1],_0x7ed802=_0xf15e04[_0x102393(0x284)][0x2],{path:_0x127ecf,filename:_0x299756}=tmpStorage[_0x7ed802];delete tmpStorage[_0x7ed802],_0xf15e04[_0x102393(0x378)](),_0x1a790a==_0x102393(0x1e3)?(logger[_0x102393(0x335)]('Restore\x20process\x20confirmed'),await sendTelegram(_0xf15e04[_0x102393(0x3aa)]['id'],_0x102393(0x1f1),{'parse_mode':_0x102393(0x31c)}),unzipFile(_0x127ecf,_0x299756)):(logger[_0x102393(0x335)](_0x102393(0x24c)),await sendTelegram(_0xf15e04[_0x102393(0x3aa)]['id'],_0x102393(0x24c)));});}}function getServerTime(){const _0xd2c5fb=_0x15ba34,_0x3fa987=new Date();return _0x3fa987[_0xd2c5fb(0x292)]()+'/'+(_0x3fa987['getMonth']()+0x1)[_0xd2c5fb(0x1df)]()['padStart'](0x2,'0')+'/'+_0x3fa987['getDate']()['toString']()['padStart'](0x2,'0')+'\x20'+_0x3fa987['getHours']()['toString']()['padStart'](0x2,'0')+':'+_0x3fa987[_0xd2c5fb(0x26a)]()[_0xd2c5fb(0x1df)]()['padStart'](0x2,'0')+':'+_0x3fa987[_0xd2c5fb(0x2fa)]()['toString']()[_0xd2c5fb(0x2f7)](0x2,'0');}function getTimeStamp(){const _0x23f73f=_0x15ba34,_0xd6426f=shiftedTime();return _0xd6426f[_0x23f73f(0x292)]()+'/'+(_0xd6426f[_0x23f73f(0x211)]()+0x1)[_0x23f73f(0x1df)]()[_0x23f73f(0x2f7)](0x2,'0')+'/'+_0xd6426f[_0x23f73f(0x377)]()[_0x23f73f(0x1df)]()[_0x23f73f(0x2f7)](0x2,'0')+'\x20'+_0xd6426f[_0x23f73f(0x1de)]()['toString']()[_0x23f73f(0x2f7)](0x2,'0')+':'+_0xd6426f[_0x23f73f(0x26a)]()[_0x23f73f(0x1df)]()[_0x23f73f(0x2f7)](0x2,'0')+':'+_0xd6426f[_0x23f73f(0x2fa)]()[_0x23f73f(0x1df)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x29f722=_0x15ba34,_0x1fc096=shiftedTime();return _0x1fc096[_0x29f722(0x292)]()+(_0x1fc096[_0x29f722(0x211)]()+0x1)[_0x29f722(0x1df)]()[_0x29f722(0x2f7)](0x2,'0')+_0x1fc096[_0x29f722(0x377)]()[_0x29f722(0x1df)]()['padStart'](0x2,'0')+'-'+_0x1fc096['getHours']()['toString']()[_0x29f722(0x2f7)](0x2,'0')+_0x1fc096[_0x29f722(0x26a)]()[_0x29f722(0x1df)]()[_0x29f722(0x2f7)](0x2,'0')+_0x1fc096['getSeconds']()[_0x29f722(0x1df)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x3e6a18=_0x15ba34,_0x37e7f2=new Date();let _0x10432f=_0x37e7f2;if(settings[_0x3e6a18(0x3d2)]&&settings['timeshift']!==0x0)_0x10432f=fns[_0x3e6a18(0x384)](_0x37e7f2,{'hours':settings[_0x3e6a18(0x3d2)]});return _0x10432f;}async function startScheduler(){const _0x46e024=_0x15ba34,_0x1e1087=new Date()[_0x46e024(0x2b1)](),_0x4cce9e=shiftedTime()[_0x46e024(0x1de)]();_0x4cce9e==0x4&&backupConfigFiles(),_0x4cce9e==0x0&&(rotateLogFiles(),logger[_0x46e024(0x335)](_0x46e024(0x35d)),logger[_0x46e024(0x335)](_0x46e024(0x25e)+serverversion+_0x46e024(0x2f6)+(environment==_0x46e024(0x270)?'(staging)':'')),logger[_0x46e024(0x335)](_0x46e024(0x35d))),_0x1e1087%0x6==0x0&&triggerAnalytics(),_0x1e1087%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x45b800){const _0x55dbdd=_0x15ba34;logger[_0x55dbdd(0x335)](_0x55dbdd(0x25f)+_0x45b800);const _0x2941ad=getBotsWithMode();_0x2941ad[_0x55dbdd(0x226)]>0x0?confirmRestore(configbackuppath,_0x45b800):unzipFile(configbackuppath,_0x45b800);}async function getBackupFiles(_0x4283b3=null){const _0x4e62e3=_0x15ba34;let _0x39ef77=[],_0x471e12=fs[_0x4e62e3(0x273)](configbackuppath,{'withFileTypes':!![]});_0x471e12[_0x4e62e3(0x374)]((_0x466f44,_0x35bd8d)=>_0x466f44['name']<_0x35bd8d[_0x4e62e3(0x26d)]?0x1:_0x35bd8d['name']<_0x466f44['name']?-0x1:0x0),_0x471e12['forEach'](_0x3d1efe=>{const _0x43e4d5=_0x4e62e3;if(!_0x3d1efe['isDirectory']()&&_0x3d1efe[_0x43e4d5(0x26d)][_0x43e4d5(0x2ed)](_0x43e4d5(0x3ab))&&_0x3d1efe['name'][_0x43e4d5(0x287)]('.zip')){const _0x3984af=formatDate(fs[_0x43e4d5(0x34e)](configbackuppath+_0x3d1efe[_0x43e4d5(0x26d)])[_0x43e4d5(0x3cb)]);_0x39ef77['push']({'name':_0x3d1efe[_0x43e4d5(0x26d)],'mtime':_0x3984af});}});if(_0x4283b3)io['to'](_0x4283b3)[_0x4e62e3(0x2bc)]('backup-files',_0x39ef77);else return _0x39ef77;}async function backupConfigFiles(){const _0x41dfe7=_0x15ba34;await zipFiles(_0x41dfe7(0x3ca));const _0x4203f0=getCleanTimeStamp();fs[_0x41dfe7(0x234)](zippath+'backup-full.zip',configbackuppath+(_0x41dfe7(0x3ab)+_0x4203f0+'.zip'));let _0x253760=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x253760['sort']((_0x11ec85,_0x401fca)=>_0x11ec85[_0x41dfe7(0x26d)]<_0x401fca[_0x41dfe7(0x26d)]?0x1:_0x401fca['name']<_0x11ec85[_0x41dfe7(0x26d)]?-0x1:0x0),_0x253760[_0x41dfe7(0x226)]>maxBackups&&fs[_0x41dfe7(0x1e1)](configbackuppath+_0x253760[_0x253760[_0x41dfe7(0x226)]-0x1]['name']);}function rotateLogFiles(){const _0x2b80b1=_0x15ba34,_0x38ad81=fs[_0x2b80b1(0x34e)](logspath+_0x2b80b1(0x1ec)),_0x13224e=_0x38ad81[_0x2b80b1(0x2a2)]/0x400;if(_0x13224e>0x64){let _0x1f36a1=fs[_0x2b80b1(0x273)](logspath,{'withFileTypes':!![]});_0x1f36a1[_0x2b80b1(0x374)]((_0x20dcad,_0x28ff47)=>_0x20dcad['name']<_0x28ff47['name']?0x1:_0x28ff47[_0x2b80b1(0x26d)]<_0x20dcad[_0x2b80b1(0x26d)]?-0x1:0x0),_0x1f36a1[_0x2b80b1(0x1ed)](_0x2b27b9=>{const _0x20d729=_0x2b80b1;if(_0x2b27b9[_0x20d729(0x26d)]==_0x20d729(0x1db))fs[_0x20d729(0x234)](logspath+_0x2b27b9[_0x20d729(0x26d)],logspath+_0x20d729(0x32b));if(_0x2b27b9[_0x20d729(0x26d)]==_0x20d729(0x203))fs[_0x20d729(0x234)](logspath+_0x2b27b9[_0x20d729(0x26d)],logspath+_0x20d729(0x1db));_0x2b27b9[_0x20d729(0x26d)]==_0x20d729(0x1ec)&&(fs[_0x20d729(0x234)](logspath+_0x2b27b9[_0x20d729(0x26d)],logspath+_0x20d729(0x203)),fs['writeFileSync'](logspath+_0x2b27b9[_0x20d729(0x26d)],''));});}}function _0x5b61(){const _0x440a46=['/config\x20-\x20notification\x20types\x20to\x20receive\x0a','whitelist','size','hex','port','enable','Unauthorized\x20attempt\x20to\x20show\x20configuration','request','delete-alerts','from','search','off_','tempaccess_30_','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','max','telegram','publicKey','getUTCHours','bbPassword','DEFLATE','host','slice','config/','SIGTERM','reload','http','telegramToken','Yes','emit','reject','headers','pidRefreshToken','showConfig','127.0.0.1','split','button','reinstall','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','6379056rWaxpT','type','bb-settings.json','(staging)','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','close','error','disconnect','[ip-address]','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Notifications\x20types:\x20','parse','User\x20has\x20been\x20validated','Logged\x20in\x20user\x20...','confirm-message','temp/','/:bot','store-headless','marketcapApi','place-order','disabled','user','f2aRequired','/metrics\x20-\x20show\x20bot\x20performance\x0a','#RES#\x20if\x20running\x20on\x20server','handshake','Ok,\x20will\x20send\x20alert\x20notifications\x20only','jsonwebtoken','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','init','title',',\x20must\x20be\x20a\x204\x20digit\x20number','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','reinstall-bb','mkdirSync','toggle_','backup/','startsWith','exec','environment','inherit','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','push','Unauthorized\x20login\x20attempt\x20(timeout)','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Starting\x20Balance\x20Bot\x20update','#RES#\x20','padStart','settings','callback','getSeconds','bbvNew','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','names','Login\x20rejected','range','apply','express','2FA\x20login\x20token\x20generated','exp','static','track','store-configuration','bb/','BCT','orders','15\x20min','blacklist','event','Setting\x20access:\x20','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Telegraf\x20error:','.zip','Starting\x20new\x20bot\x20|\x20Bot\x20','botID','-----------------------------------------------------------------------------------','reply','ETH','replyWithDocument','address','pidExpireLogin','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Which\x20bot\x20do\x20you\x20want\x20to\x20start?',':\x20Bot\x20Mgr\x20>\x20','HTML','Failed\x20to\x20download\x20','includes','verify','privateKey','publicKeyToPem','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','5\x20min','open','encryptedUuid','***','pki','invalid\x20credentials','|@|','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','output-003.log','secret','conn','telegramUsername','31817034BdnfuG','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','update_no','metrics','value','exit','debug','3000','success','userid','/:bot/configuration','mode','ipc','production','writeFileSync','binary','headless','assign','catch','privateKeyToPem','Unauthorized\x20attempt\x20to\x20update\x20bot','uuid-random','::ffff:127.0.0.1','<b>Balance\x20Bot\x20Status:</b>\x0a','storeHeadless','sendPortfolioTelegram','Disabled\x20','Error\x20removing\x20old\x20backup\x20files:','Markdown','notification','write','statSync','Notifications\x20enabled','Unauthorized\x20attempt\x20to\x20get\x20messages','bot-','Unauthorized\x20attempt\x20to\x20get\x20events','IPv4','clientip','Bot\x20Mgr\x20>\x20Stopping\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','sendFile','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','/:bot/support','Backup\x20file\x20uploaded','min','--------------------------------------','apiPassword','Allow\x20login\x20from\x20IP\x20address\x20','any','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','bb-config.json','config_alerts','restart_','https://api.ipify.org?format=json','telegramEnabled','download','3386439ofJZdO','All','get-messages','rsa',')\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','token','Starting\x20Balance\x20Bot\x20reinstallation','\x20>\x20','start','Notifications\x20enabled\x0a','privateKeyFromPem','sort','function','-results.json','getDate','editMessageReplyMarkup','/output-000.log','find','update-bot','username','_nsps','access','util','path','new-disabled','randomFillSync','help','add','string','/help\x20-\x20show\x20available\x20commands\x0a','Restarting\x20','get-portfolio','Error\x20sending\x20','Enabled\x20','join','message','jszip','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','telegramEvents','Password\x20reset\x20rejected','Ok,\x20will\x20send\x20order\x20notifications\x20only','connection','toIPv4MappedAddress','2FA\x20required','loginRequired','restore-backup-file','Login\x20accepted','30\x20min','get-logs','login\x20not\x20required','reason','No\x20authentication\x20token','bot','login2fa_reject_','$1_$2_$3','tempaccess_reject_','bbvReceive','order','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','bots','Session\x20expired\x20for\x20user\x20...','<b>Telegram\x20Bot\x20Status:</b>\x0a','uuid','auto','Error\x20details:','chat','backup-full@','bb-secure.json','live','whitelistEnabled','show','metrics_','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','temporaryAccessAllowed','secure','config_orders','logs','manual','-performance.json','showname','removeAllListeners','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','show-config','replace','referer','File\x20uploaded','cancel-loading','password','ipaddr.js','cancelLoading','config','Unauthorized\x20attempt\x20to\x20log\x20out','generateKeyPair','async','update_yes','child_process','/start','backup-full','mtime','node-forge','Password\x20has\x20been\x20reset\x20to:\x20','stopped','backup','version.json','allow','timeshift','23794MSdbqe','launch','Bot\x20','getTime','Temporary\x20access\x20rejected','No\x20bots\x20running\x20right\x20now','Logged\x20out\x20user\x20...','http://localhost:','fork','tempaccess_15_','once','warning','botname','logout','args','/status\x20-\x20show\x20bot(s)\x20status\x0a','enabled','telegramChatId','stop','post','log','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','lowdb/adapters/FileSync','get','::1','full','env','output-002.log','send','yargs','getHours','toString','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','unlinkSync','simple','yes','keys','All\x20bots','RSA-OAEP','decrypt','apiKey','stringify','socket','temporary\x20token\x20generated','output-000.log','forEach','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','messages',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Restoring\x20bot(s)\x20from\x20backup','on_','emitHistory','crypto','telegramIpApproval','Backup\x20file\x20unzipped\x20and\x20stored','initclient','Server','tkn','rmSync','Notifications\x20disabled','alerts','exchange','sockets','174oYMLkK','\x1b[33m','use','index.html','output-001.log','address\x20already\x20in\x20use','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','2FA\x20login\x20required','/:bot/coins','tempaccess_5_','botmanager','internal','expiry','update-bb','versions','sign','lastmsgemitted','get-backup-files','getMonth','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','/backup\x20-\x20receive\x20backup\x20files\x0a','updatebotmanager','cloneDeep','delete-bot','-config.json','store-fiat','::ffff:7f00:1','35425tnbjDW','reset-history','graphql-request','\x1b[35m','kill','format','login','login\x20token\x20generated','Starting\x20#RED#Balance\x20Bot\x20v','createWriteStream','status','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','length','\x20files\x20over\x20Telegram:','/on\x20-\x20start\x20bot(s)\x0a','existsSync','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','/update\x20-\x20update\x20Balance\x20Bot\x0a','hasOwnProperty','=>\x20Go\x20to\x20#CYA#http://','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','180QfGOTU','off','get-starting-balances','\x1b[31m','Bot\x20Mgr\x20>\x20','copyFileSync','storeFiat','remoteAddress','latestversion','bcryptjs','filter','Unauthorized\x20attempt\x20to\x20download\x20','getStartingBalances','\x20-\x20','/disable\x20-\x20disable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20update\x20settings','resetHistory','build2','settings.','family','add-bot','new','\x1b[34m','(((.+)+)+)+$','************','isIPv4MappedAddress','restart','\x20|\x20','/upload-backup','Restore\x20process\x20aborted','readFileSync','defaults','590279bOgLSl','logs/','node','express-fileupload','#RES#','sortBy','entries','started','2FA\x20login\x20rejected','You\x20can\x20use\x20the\x20following\x20commands:\x0a','#RES#\x20if\x20running\x20locally\x0a','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Unauthorized\x20attempt\x20to\x20add\x20bot','running','toggle-bot-mode','Running\x20#RED#Balance\x20Bot\x20v','Restore\x20backup\x20file\x20','portfolio_','inlineKeyboard','isDirectory','set','argv','axios','Deleted\x20Bot\x20','telegram2FaApproval','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','kind','getMinutes','onepagemode','2980820XhYVxR','name','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Unauthorized\x20attempt\x20to\x20confirm\x20message','staging','Invalid\x20authentication\x20token\x20(1)','status\x20code\x20401','readdirSync','lastmsgtelegram','remove','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','map','build','0.0.0','Bot\x20Mgr\x20>\x20Starting\x20','decode64','update','Token\x20blacklisted','toIPv4Address','SIGINT','reset-password','timestamp','command','logged\x20out','match','2FA','Bot\x20Mgr\x20>\x20Toggling\x20','endsWith','action','number','uncaughtException','store','Notifications\x20disabled\x0a','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','storeConfiguration','api-eu.mixpanel.com','/off\x20-\x20stop\x20bot(s)\x0a','hashSync','getFullYear','auth','bbUsername','sha256','files','then','/:bot/performance','connected','all','test','Unauthorized\x20attempt\x20to\x20delete\x20alerts','listen','Unauthorized\x20attempt\x20to\x20store\x20configuration','resetpw_yes'];_0x5b61=function(){return _0x440a46;};return _0x5b61();}async function zipFiles(_0x28b260){const _0x198754=_0x15ba34;let _0x55b7f6;if(_0x28b260=='logs')_0x55b7f6=logspath;if(_0x28b260==_0x198754(0x3cf))_0x55b7f6=configpath;if(_0x28b260=='backup-full')_0x55b7f6=configpath;let _0x26071e=fs['readdirSync'](_0x55b7f6,{'withFileTypes':!![]});const _0x45c7e9=new JSZip();_0x26071e[_0x198754(0x1ed)](_0x1a7a92=>{const _0x39a0aa=_0x198754;if(!_0x1a7a92[_0x39a0aa(0x262)]()){let _0x254a68=fs[_0x39a0aa(0x24d)](_0x55b7f6+_0x1a7a92[_0x39a0aa(0x26d)]);if(_0x28b260=='backup'){const _0x3576d4=/^bot-[0-9]{3}-config.json$/,_0x3f6b24=_0x3576d4[_0x39a0aa(0x29b)](_0x1a7a92[_0x39a0aa(0x26d)]);if(_0x3f6b24){const _0x4c4d61=JSON['parse'](_0x254a68);if(_0x4c4d61[_0x39a0aa(0x39d)][0x0]){_0x4c4d61[_0x39a0aa(0x39d)][0x0]['apiKey']=_0x39a0aa(0x326),_0x4c4d61['bot'][0x0]['apiSecret']=_0x39a0aa(0x326);if(_0x4c4d61[_0x39a0aa(0x39d)][0x0][_0x39a0aa(0x35e)])_0x4c4d61[_0x39a0aa(0x39d)][0x0]['apiPassword']='***';}_0x254a68=JSON[_0x39a0aa(0x1e9)](_0x4c4d61,null,0x2);}if(_0x1a7a92[_0x39a0aa(0x26d)]==_0x39a0aa(0x2c9)){const _0x463aec=JSON[_0x39a0aa(0x2d2)](_0x254a68);if(_0x463aec['settings'][_0x39a0aa(0x395)])_0x463aec[_0x39a0aa(0x2f8)][_0x39a0aa(0x395)]=![];if(_0x463aec[_0x39a0aa(0x2f8)][_0x39a0aa(0x2b2)])_0x463aec[_0x39a0aa(0x2f8)][_0x39a0aa(0x2b2)]=_0x39a0aa(0x326);if(_0x463aec['settings'][_0x39a0aa(0x2ba)])_0x463aec['settings'][_0x39a0aa(0x2ba)]='***';if(_0x463aec[_0x39a0aa(0x2f8)][_0x39a0aa(0x1d1)])_0x463aec[_0x39a0aa(0x2f8)][_0x39a0aa(0x1d1)]=null;if(_0x463aec[_0x39a0aa(0x2f8)]['marketcapApi'])_0x463aec['settings']['marketcapApi']=_0x39a0aa(0x326);_0x254a68=JSON[_0x39a0aa(0x1e9)](_0x463aec,null,0x2);}if(_0x1a7a92['name']!=_0x39a0aa(0x3ac))_0x45c7e9['file'](_0x1a7a92['name'],_0x254a68);}else _0x45c7e9['file'](_0x1a7a92['name'],_0x254a68);}});const _0x4cf4e5=await _0x45c7e9['generateAsync']({'type':_0x198754(0x385),'base64':![],'compression':_0x198754(0x2b3)});fs[_0x198754(0x33d)](zippath+(_0x28b260+_0x198754(0x310)),_0x4cf4e5,_0x198754(0x33e));}async function unzipFile(_0x11542f,_0x2e00c0){const _0x1a35dc=_0x15ba34;fs[_0x1a35dc(0x273)](configpath,{'withFileTypes':!![]})['forEach'](_0x235fa1=>{const _0x2fe168=_0x1a35dc;if(!_0x235fa1[_0x2fe168(0x262)]())fs[_0x2fe168(0x1fa)](configpath+_0x235fa1[_0x2fe168(0x26d)]);});const _0x36b68d=fs[_0x1a35dc(0x24d)](_0x11542f+_0x2e00c0,'binary'),_0xdcc633=await JSZip['loadAsync'](_0x36b68d,{'base64':![],'checkCRC32':!![]});for(const _0x345047 of Object[_0x1a35dc(0x1e4)](_0xdcc633[_0x1a35dc(0x296)])){const _0x13bde9=_0xdcc633[_0x1a35dc(0x296)][_0x345047],_0x5763fb=await _0x13bde9[_0x1a35dc(0x3c6)](_0x1a35dc(0x385));fs[_0x1a35dc(0x33d)](configpath+_0x13bde9['name'],_0x5763fb);}fs[_0x1a35dc(0x273)](temppath,{'withFileTypes':!![]})[_0x1a35dc(0x1ed)](_0xba14b8=>{const _0x18259b=_0x1a35dc;if(!_0xba14b8['isDirectory']())fs[_0x18259b(0x1fa)](temppath+_0xba14b8['name']);}),logger[_0x1a35dc(0x335)](_0x1a35dc(0x1f6)),process[_0x1a35dc(0x1dc)]({'restore':!![]},_0x50cefe=>{});}async function getPublicIp(){const _0x4b1655=_0x15ba34;try{const _0x379a45=await axios[_0x4b1655(0x1d7)](_0x4b1655(0x365));publicip=_0x379a45['data']['ip'];}catch(_0x38b3d4){}}async function triggerAnalytics(){const _0x18c054=_0x15ba34;if(!publicip)await getPublicIp();const _0x392bb9=getBotsWithMode();let _0xf29d0f=0x0;_0x392bb9[_0x18c054(0x1ed)](_0x449d16=>{const _0x21b3fc=_0x18c054;if(_0x449d16[_0x21b3fc(0x224)]==='enabled')_0xf29d0f++;});const _0x17ae5e=getBotExchanges();mixpanel[_0x18c054(0x305)](_0x18c054(0x1f8),{'distinct_id':settings[_0x18c054(0x338)],'ip':publicip,'version':serverversion,'numbots':_0x392bb9['length'],'numbotsenabled':_0xf29d0f,'exchanges':_0x17ae5e,'environment':environment});}async function getMessages(){const _0x362472=_0x15ba34,_0x2b0b20=_0x362472(0x30e),_0xc38d19=new GraphQLClient(_0x2b0b20),_0x12003b={'authorization':_0x362472(0x1e0)},_0x5a3548=serverversion[_0x362472(0x2c2)]('.'),_0x187f75=_0x5a3548[0x0]+'.'+_0x5a3548[0x1],_0x31cbe9=Math[_0x362472(0x35c)](settings['lastmsgtelegram'],settings[_0x362472(0x20f)]),_0x229a68={'last':parseInt(_0x31cbe9),'bbm':_0x187f75},_0x3d6e97=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2e7fe6;try{_0x2e7fe6=await _0xc38d19[_0x362472(0x2a7)](_0x3d6e97,_0x229a68,_0x12003b);}catch(_0x2f247e){}if(_0x2e7fe6&&_0x2e7fe6['messages']){let _0x108ed3=settings[_0x362472(0x274)],_0x189c5a=settings[_0x362472(0x274)];newMessages=[];for(const _0x587720 of _0x2e7fe6[_0x362472(0x1ef)]){newMessages[_0x362472(0x2f2)](_0x587720);let _0x20f08c=![];_0x587720[_0x362472(0x2fb)]&&(updateSetting(_0x362472(0x237),_0x587720[_0x362472(0x2fb)]),_0x20f08c=isNewerVersion(serverversion,_0x587720['bbvNew'])||serverversion==_0x587720[_0x362472(0x2fb)]);if(!_0x20f08c&&_0x587720[_0x362472(0x289)]>_0x108ed3){if(_0x587720[_0x362472(0x3a1)]===_0x362472(0x360)||serverversion['startsWith'](_0x587720[_0x362472(0x3a1)])){let _0x16d6d6=''+_0x587720[_0x362472(0x2e6)]+'\x0a\x0a'+_0x587720[_0x362472(0x38c)];const _0x3aa366=await sendTelegramMsg(toTelegramMarkdown(_0x16d6d6),_0x362472(0x34b));_0x108ed3=_0x587720[_0x362472(0x289)];}}_0x189c5a=_0x587720[_0x362472(0x289)];}updateAvailable=isNewerVersion(settings[_0x362472(0x237)],serverversion),updateSetting(_0x362472(0x274),_0x189c5a),emitMessages();}}function emitMessages(){const _0x47b518=_0x15ba34,_0x4dedbb=settings[_0x47b518(0x20f)];let _0xb3a8db=[];newMessages['forEach'](_0x4cd198=>{const _0x19066e=_0x47b518;_0x4cd198[_0x19066e(0x289)]>_0x4dedbb&&_0xb3a8db['push'](_0x4cd198);}),_0xb3a8db['length']>0x0&&getAllClients()[_0x47b518(0x1ed)](_0x2e4028=>{const _0x1b33f8=_0x47b518;getSocket(_0x2e4028['id'])[_0x1b33f8(0x2bc)](_0x1b33f8(0x38c),_0xb3a8db);});}function confirmMessage(_0x2acce4){updateSetting('lastmsgemitted',Number(_0x2acce4));}function isNewerVersion(_0x352351,_0x406670){const _0x2b5a6f=_0x15ba34,_0x2efe76=_0x406670[_0x2b5a6f(0x2c2)]('.'),_0x1a54d0=_0x352351[_0x2b5a6f(0x2c2)]('.');for(var _0xd196b0=0x0;_0xd196b0<_0x1a54d0['length'];_0xd196b0++){const _0x3f046c=~~_0x1a54d0[_0xd196b0],_0x1fefff=~~_0x2efe76[_0xd196b0];if(_0x3f046c>_0x1fefff)return!![];if(_0x3f046c<_0x1fefff)return![];}return![];}function toTelegramMarkdown(_0x319710){const _0x150e3a=_0x15ba34,_0x152d4a=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x597ed1=/\*{2}(.+?)\*{2}/gim;return _0x319710=_0x319710[_0x150e3a(0x3bc)](_0x152d4a,_0x150e3a(0x39f))[_0x150e3a(0x3bc)](_0x597ed1,'*$1*'),_0x319710;}async function validateConfigFile(){const _0xb524c9=_0x15ba34,_0x4d81a3=dbConfig['get'](_0xb524c9(0x3a4))[_0xb524c9(0x254)]('botID')[_0xb524c9(0x333)]()||[];if(_0x4d81a3[_0xb524c9(0x226)]==0x0){let _0x36021a=0x0,_0x21f1cc=[];const _0x22a8ab=/^bot-([0-9]{3})-config.json$/,_0x8b5962=fs[_0xb524c9(0x273)](configpath);_0x8b5962[_0xb524c9(0x1ed)](_0x3a1d13=>{const _0x3a28fe=_0xb524c9,_0x37cffe=_0x22a8ab[_0x3a28fe(0x2ee)](_0x3a1d13);if(_0x37cffe){const _0x42bf76=_0x37cffe[0x1];let _0xdea0ef=getBotAttributes(_0x42bf76);_0x21f1cc['push']({'botID':_0x42bf76,'botname':_0xdea0ef['botname'],'status':'disabled','live':_0x3a28fe(0x3ce)}),_0x36021a++;}}),_0x36021a!=0x0&&(dbConfig[_0xb524c9(0x1d7)]('bots')[_0xb524c9(0x340)](_0x21f1cc)[_0xb524c9(0x34d)](),config=_0x21f1cc,restoredConfigFile=_0x36021a);}}async function restoreConfigNotify(_0xeaea2c){const _0x36e0a3=_0x15ba34;let _0x5abb61;if(restoredConfigFile==0x1)_0x5abb61=_0x36e0a3(0x205);else _0x5abb61='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0xeaea2c)io['to']('botmanager')['emit'](_0x36e0a3(0x34c),_0x5abb61);else{logger['simple'](_0x36e0a3(0x313)),logger['simple'](_0x5abb61),logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x36e0a3(0x1e2)]('');if(tgBot&&settings[_0x36e0a3(0x1d1)]&&settings[_0x36e0a3(0x38f)]!=_0x36e0a3(0x309))await sendTelegram(settings[_0x36e0a3(0x1d1)],_0x36e0a3(0x233)+_0x5abb61);}}function decryptRSA(_0x229d41,_0xeffc9b){const _0x10783b=_0x15ba34,_0x3ddac8=forge[_0x10783b(0x327)][_0x10783b(0x373)](_0x229d41),_0x61c310=_0x3ddac8[_0x10783b(0x1e7)](forge['util'][_0x10783b(0x27b)](_0xeffc9b),_0x10783b(0x1e6),{'md':forge['md'][_0x10783b(0x295)]['create'](),'mgf1':{'md':forge['md'][_0x10783b(0x295)]['create']()}});return _0x61c310;}function validateCredentials(_0x506baa,_0x5ae4cc){const _0x5eff81=_0x15ba34;if(_0x506baa[_0x5eff81(0x37c)]==settings[_0x5eff81(0x294)]&&bcrypt['compareSync'](_0x506baa[_0x5eff81(0x3c0)],settings[_0x5eff81(0x2b2)])){if(settings[_0x5eff81(0x2dd)])return{'allow':![],'reason':_0x5eff81(0x206),'token':null};else{const _0x233338=generateLoginToken(_0x5ae4cc);return{'allow':!![],'reason':_0x5eff81(0x221),'token':_0x233338};}}else return{'allow':![],'reason':_0x5eff81(0x328),'token':null};}function refreshToken(_0x3c1336){const _0x4e43c3=_0x15ba34,_0x2865e9=generateLoginToken(_0x3c1336);return{'allow':!![],'reason':_0x4e43c3(0x221),'token':_0x2865e9};}function validateAccess(_0x517b52,_0x18f4b8,_0x2c9081){const _0x5d4fd1=_0x15ba34,_0xbf8cfa=_0x2c9081?_0x2c9081:devices[_0x18f4b8]['ip'];let _0x45f627;const _0x5cc6a2=_0x24d116=>{const _0x14ecb6=_0x77ce;if(settings[_0x14ecb6(0x395)]){if(settings[_0x14ecb6(0x2dd)]){if(telegram2FaApproved(_0x18f4b8)){const _0x305911=generateLoginToken(_0x18f4b8);return{'allow':!![],'reason':_0x14ecb6(0x302),'token':_0x305911};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x45f627=validToken(_0x24d116,_0x18f4b8),_0x45f627[_0x14ecb6(0x22c)](_0x14ecb6(0x337))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x24d116}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x14ecb6(0x39a),'token':null};};if(settings[_0x5d4fd1(0x3ae)]){let _0x84037f=[...settings[_0x5d4fd1(0x2a1)],_0x5d4fd1(0x1d8),_0x5d4fd1(0x345),_0x5d4fd1(0x2c1),_0x5d4fd1(0x219)];if(_0x84037f['includes'](_0xbf8cfa))return _0x5cc6a2(_0x517b52);else{_0x45f627=validToken(_0x517b52,_0x18f4b8);if(_0x45f627[_0x5d4fd1(0x22c)]('success'))return _0x5cc6a2(_0x517b52);else{if(telegramIpApproved(_0x18f4b8)){const _0x130335=generateToken(_0x18f4b8);return _0x45f627=_0x5cc6a2(_0x517b52),_0x45f627[_0x5d4fd1(0x3d1)]?{'allow':!![],'reason':_0x5d4fd1(0x1eb),'token':_0x130335}:_0x45f627;}else return settings[_0x5d4fd1(0x3b2)]?{'allow':![],'reason':_0x5d4fd1(0x394),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x5cc6a2(_0x517b52);}function timelyDecrypt(_0x5f06b2,_0x140fe9,_0x5f5aef='@'){const _0x323633=_0x15ba34;if(_0x5f06b2)try{const _0x150e69=decryptRSA(secure[_0x323633(0x320)],_0x5f06b2),_0x1b2e8a=_0x150e69[_0x323633(0x2c2)](_0x5f5aef)[0x0],_0xc70b7a=_0x150e69[_0x323633(0x2c2)](_0x5f5aef)[0x1],_0x152f03=new Date()[_0x323633(0x3d6)]();if(_0x140fe9){if(_0x152f03-_0xc70b7a<maxSecretAge*0x3e8)return _0x1b2e8a;else return![];}else return _0x1b2e8a;}catch(_0x4b6830){return![];}else return![];}const validToken=(_0x3fe563,_0x25c2cc)=>{const _0x45c171=_0x15ba34,_0x260546=devices[_0x25c2cc]['ip'];if(!_0x3fe563)return{'error':_0x45c171(0x39c)};for(let _0x473b9e of blacklist){if(_0x473b9e[_0x45c171(0x36e)]==_0x3fe563)return{'error':_0x45c171(0x27d)};}let _0x1d6d91;try{_0x1d6d91=jwt[_0x45c171(0x31f)](_0x3fe563,secure[_0x45c171(0x32c)]+_0x25c2cc);}catch{return{'error':_0x45c171(0x271)};}if(!_0x1d6d91[_0x45c171(0x22c)](_0x45c171(0x354))&&!_0x1d6d91[_0x45c171(0x22c)]('username')||!_0x1d6d91[_0x45c171(0x22c)](_0x45c171(0x303)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x1d6d91[_0x45c171(0x22c)]('username')&&_0x1d6d91[_0x45c171(0x22c)]('clientip')){const {clientip:_0x5e7818}=_0x1d6d91;return _0x260546==_0x5e7818?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x1d6d91['hasOwnProperty'](_0x45c171(0x37c))&&_0x1d6d91['hasOwnProperty'](_0x45c171(0x354))){const {username:_0x46297a,clientip:_0x2f54ef}=_0x1d6d91;return settings[_0x45c171(0x294)]==_0x46297a&&_0x260546==_0x2f54ef?{'success':_0x45c171(0x2d3)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x255428=>{const _0x5c9f9d=_0x15ba34;if(_0x255428){const _0xd2b6a1=devices[_0x255428]['ip'];return jwt[_0x5c9f9d(0x20e)]({'username':settings[_0x5c9f9d(0x294)],'clientip':_0xd2b6a1},secure['secret']+_0x255428,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0xe2ccd8=>{const _0x60e78e=_0x15ba34;if(_0xe2ccd8){const _0x3df111=devices[_0xe2ccd8]['ip'];return jwt[_0x60e78e(0x20e)]({'clientip':_0x3df111},secure['secret']+_0xe2ccd8,{'expiresIn':devices[_0xe2ccd8]['telegramIpApproval'][_0x60e78e(0x20b)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x3920ea=>{const _0xec8f29=_0x15ba34;let _0x217991=![];return devices[_0x3920ea]['telegramIpApproval']&&devices[_0x3920ea][_0xec8f29(0x1f5)]['expiry']!='reject'&&(_0x217991=devices[_0x3920ea][_0xec8f29(0x1f5)][_0xec8f29(0x354)]==devices[_0x3920ea]['ip']&&new Date()[_0xec8f29(0x3d6)]()-devices[_0x3920ea]['telegramIpApproval']['timestamp']<devices[_0x3920ea][_0xec8f29(0x1f5)][_0xec8f29(0x20b)]*0x3c*0x3e8),_0x217991;},telegram2FaApproved=_0x5e4602=>{const _0x4d6839=_0x15ba34;let _0x1984d3=![];return devices[_0x5e4602][_0x4d6839(0x267)]&&devices[_0x5e4602][_0x4d6839(0x267)]['expiry']!=_0x4d6839(0x2bd)&&(_0x1984d3=devices[_0x5e4602]['telegram2FaApproval']['clientip']==devices[_0x5e4602]['ip']&&new Date()[_0x4d6839(0x3d6)]()-devices[_0x5e4602]['telegram2FaApproval']['timestamp']<devices[_0x5e4602][_0x4d6839(0x267)]['expiry']*0x3c*0x3e8),_0x1984d3;},normalizeIP=_0x11a4f2=>{const _0x503db2=_0x15ba34;let _0x5b3c10=null,_0x446860=null;if(ipaddr['isValid'](_0x11a4f2)){const _0x3a48d9=ipaddr[_0x503db2(0x2d2)](_0x11a4f2);_0x3a48d9[_0x503db2(0x269)]()==='ipv6'?(_0x3a48d9[_0x503db2(0x248)]()&&(_0x5b3c10=_0x3a48d9[_0x503db2(0x27e)]()['toString']()),_0x446860=_0x3a48d9[_0x503db2(0x1df)]()):(_0x5b3c10=_0x3a48d9[_0x503db2(0x1df)](),_0x446860=_0x3a48d9[_0x503db2(0x393)]()[_0x503db2(0x1df)]());}return{'show':_0x5b3c10?_0x5b3c10:_0x446860,'store':_0x446860};};function formatDate(_0xab6820){const _0xdc46ce=_0x15ba34;return _0xab6820[_0xdc46ce(0x292)]()+'/'+(_0xab6820[_0xdc46ce(0x211)]()+0x1)[_0xdc46ce(0x1df)]()[_0xdc46ce(0x2f7)](0x2,'0')+'/'+_0xab6820[_0xdc46ce(0x377)]()[_0xdc46ce(0x1df)]()[_0xdc46ce(0x2f7)](0x2,'0')+'\x20'+_0xab6820[_0xdc46ce(0x1de)]()[_0xdc46ce(0x1df)]()[_0xdc46ce(0x2f7)](0x2,'0')+':'+_0xab6820[_0xdc46ce(0x26a)]()[_0xdc46ce(0x1df)]()[_0xdc46ce(0x2f7)](0x2,'0')+':'+_0xab6820[_0xdc46ce(0x2fa)]()['toString']()[_0xdc46ce(0x2f7)](0x2,'0');}function sleep(_0x164a4a){return new Promise(_0x1b206c=>setTimeout(_0x1b206c,_0x164a4a));}