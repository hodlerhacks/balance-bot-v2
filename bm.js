const _0x5c0f7b=_0x65bd;(function(_0x46cdfd,_0x28c9ec){const _0x59802d=_0x65bd,_0x237c90=_0x46cdfd();while(!![]){try{const _0x24e22f=-parseInt(_0x59802d(0xd6))/0x1*(-parseInt(_0x59802d(0x2bc))/0x2)+-parseInt(_0x59802d(0x161))/0x3*(-parseInt(_0x59802d(0x1ae))/0x4)+parseInt(_0x59802d(0x213))/0x5*(-parseInt(_0x59802d(0x21e))/0x6)+-parseInt(_0x59802d(0x140))/0x7+-parseInt(_0x59802d(0x195))/0x8*(-parseInt(_0x59802d(0x148))/0x9)+-parseInt(_0x59802d(0x172))/0xa+parseInt(_0x59802d(0xaa))/0xb*(parseInt(_0x59802d(0xb7))/0xc);if(_0x24e22f===_0x28c9ec)break;else _0x237c90['push'](_0x237c90['shift']());}catch(_0x4d7929){_0x237c90['push'](_0x237c90['shift']());}}}(_0x22ad,0x63655));const _0x53315f=function(){let _0x2633dc=!![];return function(_0x3774c5,_0x13e6a7){const _0x45ebff=_0x2633dc?function(){if(_0x13e6a7){const _0x2061a5=_0x13e6a7['apply'](_0x3774c5,arguments);return _0x13e6a7=null,_0x2061a5;}}:function(){};return _0x2633dc=![],_0x45ebff;};}(),_0x55d447=_0x53315f(this,function(){const _0x1a8394=_0x65bd;return _0x55d447[_0x1a8394(0x109)]()['search'](_0x1a8394(0xfd))[_0x1a8394(0x109)]()[_0x1a8394(0x26c)](_0x55d447)['search'](_0x1a8394(0xfd));});_0x55d447();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x5c0f7b(0x108)),low=require(_0x5c0f7b(0x2ae)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x5c0f7b(0x135)),crypto=require(_0x5c0f7b(0x2b6)),forge=require(_0x5c0f7b(0x2ba)),bcrypt=require(_0x5c0f7b(0x12d)),jwt=require('jsonwebtoken'),ipaddr=require(_0x5c0f7b(0x1b7)),argv=require(_0x5c0f7b(0x13a))(process[_0x5c0f7b(0x17a)][_0x5c0f7b(0x263)](0x2))['argv'],uuidRandom=require(_0x5c0f7b(0x19f)),{Telegraf,Markup}=require(_0x5c0f7b(0x10e)),Mixpanel=require(_0x5c0f7b(0x20c)),axios=require(_0x5c0f7b(0x230)),{GraphQLClient,gql}=require(_0x5c0f7b(0x283)),util=require(_0x5c0f7b(0x1a3)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x5c0f7b(0xf4)),PORT=argv[_0x5c0f7b(0x25b)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x5c0f7b(0x1b4)](PORT)&&(console['log']('Error:\x20Invalid\x20argument\x20'+PORT+_0x5c0f7b(0x127)),process['exit'](0x1));const HOST=argv[_0x5c0f7b(0x2b3)]||null,userID=argv[_0x5c0f7b(0x15a)]||'',debugging=argv['d']||![],nodeversion=process['versions'][_0x5c0f7b(0x160)];let bbpath=_0x5c0f7b(0x185),bbpath2='';const botfile='bot.js',configfile=_0x5c0f7b(0x233),settingsfile=_0x5c0f7b(0x1be),securefile=_0x5c0f7b(0x197),environment=require('./'+bbpath2+_0x5c0f7b(0x1a6))[_0x5c0f7b(0x1a9)]||_0x5c0f7b(0x1d3),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x5c0f7b(0xcd)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x5c0f7b(0x190)),configpath=userID?bbpath+_0x5c0f7b(0xb3)+userID+'/':bbpath+_0x5c0f7b(0xb3),configbackuppath=configpath+_0x5c0f7b(0x24d),logspath=userID?bbpath+_0x5c0f7b(0x153)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x5c0f7b(0x2b8),loggerfile=fs['createWriteStream'](logspath+_0x5c0f7b(0x129),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x5c0f7b(0xc2);!fs[_0x5c0f7b(0xcd)](configpath)&&fs[_0x5c0f7b(0x176)](configpath);!fs[_0x5c0f7b(0xcd)](configbackuppath)&&fs[_0x5c0f7b(0x176)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x5c0f7b(0x176)](logspath);function _0x22ad(){const _0xb7b306=['invalid\x20credentials','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','randomBytes','config_all','30\x20min','copyFileSync','status\x20code\x20401','(((.+)+)+)+$','referer','message','sendMessage','name','login\x20not\x20required','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','error','bbvReceive','date-fns','toString','/help\x20-\x20show\x20available\x20commands\x0a','login\x20token\x20generated','\x20files\x20over\x20Telegram:','/names\x20-\x20show\x20bot\x20names\x0a','telegraf','function','build2','placeOrder','\x20|\x20','temporaryAccessAllowed','Unauthorized\x20attempt\x20to\x20store\x20configuration','metrics','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Restore\x20process\x20aborted','portfolio_','whitelist','family','range','event','::ffff:127.0.0.1','sha256','You\x20can\x20use\x20the\x20following\x20commands:\x0a','create','split','All\x20bots','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','bbvNew','127.0.0.1','Ok,\x20will\x20send\x20alert\x20notifications\x20only',',\x20must\x20be\x20a\x204\x20digit\x20number','started','/output-000.log','store-configuration','send','sign','bcryptjs','decrypt','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Deleted\x20Bot\x20','getFullYear','Starting\x20#RED#Balance\x20Bot\x20v','find','Invalid\x20username\x20or\x20IP\x20address','path','\x20to\x20','Error\x20sending\x20','loginRequired','catch','yargs/yargs','kind','Login\x20rejected','2FA','format','telegramChatId','2030861HOoGqi','post','restore_yes_','Starting\x20Balance\x20Bot\x20update','any','showname','storeHeadless','temporary\x20access\x20rejected','942093GCqvOb',')\x20|\x20Bot\x20','botname','\x1b[34m','createServer','sort','/:bot/history','store-fiat','update_yes','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Unauthorized\x20attempt\x20to\x20confirm\x20message','logs/','\x1b[36m','generateKeyPair','/:bot/performance','\x20only\x0a','on_','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','user','\x1b[33m','--------------------------------------','push','kill','getTime','node','6ERkyjT','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Error\x20removing\x20old\x20backup\x20files:','index.html','|@|','sortBy','File\x20uploaded','includes','/on\x20-\x20start\x20bot(s)\x0a','Bot\x20','max','tempaccess_5_','show','cloneDeep','stopped','get-logs','reset-password','6283950UHhyBw','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','2FA\x20login\x20required','internal','mkdirSync','access','exit','toIPv4MappedAddress','argv',':\x20Bot\x20Mgr\x20>\x20','getSeconds','Login\x20accepted','\x20mode','temporary\x20access\x20timeout','all','new','reload','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','bb/','request','confirm-message','resetpw_yes','stop','\x1b[0m','add-bot','backup','generateAsync','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','chat','clients','command','#RES#','set','toggle','40xqscsd','backup-full','bb-secure.json','headless','Logged\x20out\x20user\x20...','isDirectory','CoinMarketCap\x20API\x20key\x20validated','bot-','binary','getUTCHours','uuid-random','_nsps','join','login','util','Unauthorized\x20attempt\x20to\x20download\x20','staging','version.json','verify','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','environment','manual','secure','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','headers','1498652kpieTd','exchange','5\x20min','\x20>\x20','#RES#\x20if\x20running\x20on\x20server','encryptedUuid','test','*$1*','-performance.json','ipaddr.js','live','get','editMessageReplyMarkup','Unauthorized\x20attempt\x20to\x20get\x20messages','<b>Telegram\x20Bot\x20Status:</b>\x0a','telegramToken','bb-settings.json','store','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','writeFileSync','randomFillSync','2FA\x20login\x20rejected','login2fa_reject_','forEach','HTML','reinstall-bb','restore-backup-file','entries','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','parse','secret','replyWithDocument','backup-files','privateKeyFromPem','Unauthorized\x20attempt\x20to\x20log\x20out','SIGTERM','inherit','production','telegramUsername','length','warning','Session\x20expired\x20for\x20user\x20...','telegrammsg','action','getMonth','timestamp','Yes','getPortfolio','botID','/metrics\x20-\x20show\x20bot\x20performance\x0a','telegramIpApproval','replace','lastmsgemitted','notification','names','***','allow','download','removeAllListeners','telegramEnabled','Setting\x20access:\x20','Restoring\x20bot(s)\x20from\x20backup','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','map','server','settings.',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','keys','userid','accept','backupfile','/enable\x20-\x20enable\x20notifications\x0a','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','token','remoteAddress','https://api.ipify.org?format=json','conn','login2fa_','stringify','/restart\x20-\x20restart\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20update\x20bot','isValid','Starting\x20(','help','rsa','Orders','messages','mode','\x20|\x20user:\x20...','login\x20token\x20valid','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','title','apiPassword','hasOwnProperty','mixpanel','close','\x20|\x20client:\x20...','callback','backup-full.zip','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','29020lQoyGI','telegramEvents','uuid','SIGINT','running','log','-----------------------------------------------------------------------------------','restart','\x1b[31m','track','Token\x20blacklisted','564HKImMK',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','get-starting-balances','15\x20min','Markdown','Network\x20Interfaces:','onepagemode','Restarting\x20Bot\x20','#RES#\x20if\x20running\x20locally\x0a','off','No\x20authentication\x20token','Temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Unauthorized\x20attempt\x20to\x20delete\x20alerts','min','reinstall_no','tempaccess_30_','use','axios','padStart','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','bb-config.json','reset-history','timeshift','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','fork','Invalid\x20authentication\x20token\x20(1)','statSync','tkn','sendFile','isIPv4MappedAddress','readFileSync','login\x20required','showConfig','text','mtime','/logs\x20-\x20receive\x20log\x20files\x0a','privateKeyToPem','compareSync','version','hashSync','express','Bot\x20Mgr\x20>\x20','=>\x20Go\x20to\x20#CYA#http://','emit','\x1b[35m','debug','backup/','tempaccess_reject_','Unauthorized\x20attempt\x20to\x20get\x20events','settings','\x20-\x20','show-config','auto','socket.io','apiKey','temporary\x20access\x20not\x20allowed','pidRefreshToken','getMinutes','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','output-000.log','port','Backup\x20file\x20unzipped\x20and\x20stored','reply','match','remove','telegram2FaApproval','getHours','f2aRequired','slice','toggle_','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','file','Failed\x20to\x20download\x20','2FA\x20required','assign','reinstall','Unauthorized\x20login\x20attempt\x20(timeout)','constructor','full','disabled','\x20minutes','bbUsername','cancelLoading','alerts','value','defaults','temporary\x20token\x20generated','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','privateKey','update_no','sockets','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','connected','lastmsgtelegram','DEFLATE','Starting\x20new\x20bot\x20|\x20Bot\x20','clientip','Telegram\x20error:','Disabled\x20Bot\x20','Notifications\x20disabled','graphql-request','params','bots','-config.json','Invalid\x20authentication\x20token\x20(2)','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','IPv4','\x20(1)','password','disable','getStartingBalances','enabled','publicKey','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','botmanager','Telegraf\x20error:','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','logged\x20out','telegram','async','orders','username','address\x20already\x20in\x20use','logs','launch','store-headless','rmSync','portfolio','latestversion','api-eu.mixpanel.com','Notifications\x20enabled\x0a','Access\x20enabled\x20for\x20','\x20(2)','order','write','.zip','from','start','reinstall_yes','pki','Error\x20details:','output-002.log','bbPassword','lowdb','hex','Notifications\x20types:\x20','update-bb','expiry','host','get-messages','getDate','crypto','/download/:type','zip/','cancel-loading','node-forge','Ok,\x20will\x20send\x20order\x20notifications\x20only','50OdGASq','readdirSync','auth','success','7997QLbbLQ','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','/status\x20-\x20show\x20bot(s)\x20status\x0a','enable','backup-full@','update-bot','Notifications\x20disabled\x0a','marketcapApi','sendMetricsTelegram','config/','yes','apiSecret','logout','6348ackvtp','status','type','Unauthorized\x20attempt\x20to\x20add\x20bot','pidExpireLogin','output-001.log','sendPortfolioTelegram','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','restore_no_','Password\x20has\x20been\x20reset\x20to:\x20','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','temp/','/:bot','reject','connection','disconnect','Restore\x20backup\x20file\x20','1000','2FA\x20login\x20token\x20generated','socket','update','startsWith','existsSync','button','(staging)','code','inlineKeyboard','config_alerts','No\x20bots\x20running\x20right\x20now','files','number','8557HykDSC','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','initclient','-results.json','config_orders','blacklist','emitHistory','string','new-disabled','/backup\x20-\x20receive\x20backup\x20files\x0a','bot','RSA-OAEP','delete-alerts','reason','static','build','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','data','unlinkSync','alias','toIPv4Address','place-order','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','metrics_','::1','simple','Starting\x20Balance\x20Bot\x20reinstallation','then','************','jszip','Unauthorized\x20attempt\x20to\x20place\x20market\x20order'];_0x22ad=function(){return _0xb7b306;};return _0x22ad();}!fs[_0x5c0f7b(0xcd)](zippath)&&fs[_0x5c0f7b(0x176)](zippath);!fs['existsSync'](temppath)&&fs[_0x5c0f7b(0x176)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x5c0f7b(0x274)]({'bots':[]})[_0x5c0f7b(0x2a5)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x5c0f7b(0x2a5)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x5c0f7b(0x274)]({'secure':{},'blacklist':[]})[_0x5c0f7b(0x2a5)]();const saltRounds=0xa,mixpanel=Mixpanel['init']('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x5c0f7b(0x2a0)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings['telegramToken']!=''&&settings[_0x5c0f7b(0x1bd)]!=_0x5c0f7b(0x1e5))&&settings['telegramUsername']&&settings[_0x5c0f7b(0x1d4)]!='')initTelegram();const parseColor=(_0x2ebf6d,_0x18486)=>{const _0x4513ad=_0x5c0f7b,_0x590310=/#[A-Z]{3}#/g;if(typeof _0x2ebf6d==_0x4513ad(0xdd)){!_0x18486?_0x2ebf6d=_0x2ebf6d[_0x4513ad(0x1e1)](_0x590310,''):(_0x2ebf6d=_0x2ebf6d[_0x4513ad(0x1e1)](/#BLU#/g,_0x4513ad(0x14b)),_0x2ebf6d=_0x2ebf6d[_0x4513ad(0x1e1)](/#RED#/g,_0x4513ad(0x21b)),_0x2ebf6d=_0x2ebf6d[_0x4513ad(0x1e1)](/#YEL#/g,_0x4513ad(0x15b)),_0x2ebf6d=_0x2ebf6d[_0x4513ad(0x1e1)](/#MAG#/g,_0x4513ad(0x24b)),_0x2ebf6d=_0x2ebf6d[_0x4513ad(0x1e1)](/#CYA#/g,_0x4513ad(0x154)),_0x2ebf6d=_0x2ebf6d[_0x4513ad(0x1e1)](/#RES#/g,_0x4513ad(0x18a)));;}return _0x2ebf6d;},logger={'screen':_0x5483e5=>{console['log'](parseColor(_0x5483e5,!![]));},'simple':_0x18065f=>{const _0xd4b00c=_0x5c0f7b;console[_0xd4b00c(0x218)](parseColor(_0x18065f,!![])),loggerfile['write'](util[_0xd4b00c(0x13e)](parseColor(_0x18065f,![]))+'\x0a');},'full':async _0x53d1db=>{const _0x443651=_0x5c0f7b,_0x4fe925=getTimeStamp()+_0x443651(0x17b)+_0x53d1db;console[_0x443651(0x218)](parseColor(_0x4fe925,!![])),loggerfile['write'](util[_0x443651(0x13e)](parseColor(_0x4fe925,![]))+'\x0a');if(tgBot&&settings[_0x443651(0x13f)]&&settings['telegramEvents']!=_0x443651(0x297))await sendTelegram(settings[_0x443651(0x13f)],_0x443651(0x248)+parseColor(_0x53d1db,![]));},'debug':async(_0x96b051,_0x17691f='')=>{const _0x26dedf=_0x5c0f7b,_0x5182e0=getTimeStamp()+_0x26dedf(0x21f)+_0x96b051;if(debugging)console[_0x26dedf(0x218)](parseColor(_0x5182e0,!![]));loggerfile['write'](util[_0x26dedf(0x13e)](parseColor(_0x5182e0,![]))+'\x0a');if(_0x17691f){if(debugging)console[_0x26dedf(0x218)](_0x17691f);loggerfile[_0x26dedf(0x2a5)](util['format'](_0x17691f)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x47064f){const _0x3fd9a5=_0x5c0f7b;_0x47064f['toString']()[_0x3fd9a5(0x168)](_0x3fd9a5(0x299))?(logger[_0x3fd9a5(0xf0)](_0x3fd9a5(0x159)+_0x47064f[_0x3fd9a5(0x25b)]+_0x3fd9a5(0x192)),process[_0x3fd9a5(0x12b)]({'terminate':!![]},_0x263800=>{})):logger['simple'](_0x47064f);}),process['on'](_0x5c0f7b(0x178),()=>{const _0xd5474f=_0x5c0f7b;stopAllBots(),process[_0xd5474f(0x178)](0x0);}),process['on']('SIGTERM',()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x5c0f7b(0x216),()=>{const _0x6854c=_0x5c0f7b;stopAllBots(),process[_0x6854c(0x178)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x5c0f7b(0x245)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x5c0f7b(0x247)),app=express(),http=require('http')[_0x5c0f7b(0x14c)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x5c0f7b(0x1b9)](_0x5c0f7b(0x2b7),async(_0x1a79dc,_0x283ff8)=>{const _0x365cf6=_0x5c0f7b,_0x1d516f=_0x1a79dc[_0x365cf6(0x284)]['type'],_0xa2f5fb=getClientsWithBotID(_0x365cf6(0x291)),_0x28bbcc=_0x1a79dc[_0x365cf6(0x1ad)][_0x365cf6(0x215)],_0x4f3a36=timelyDecrypt(_0x28bbcc,![]),_0x2f451a=_0xa2f5fb['find'](_0x3ffc1f=>_0x3ffc1f[_0x365cf6(0x215)]==_0x4f3a36);if(_0x2f451a){const _0x594e63=normalizeIP(_0x1a79dc['socket'][_0x365cf6(0x1f8)])[_0x365cf6(0x1bf)],_0x32186d=_0x1a79dc['headers'][_0x365cf6(0x23a)];if(validateAccess(_0x32186d,_0x4f3a36,_0x594e63)[_0x365cf6(0x1e6)])_0x1d516f==_0x365cf6(0x18c)&&await backupConfigFiles(),await zipFiles(_0x1d516f),_0x283ff8[_0x365cf6(0x1e7)](zippath+(_0x1d516f+'.zip'),_0x12f027=>{const _0x204478=_0x365cf6;_0x12f027&&(logger[_0x204478(0x26d)](_0x204478(0x267)+_0x1d516f),logger['simple'](_0x12f027));});else logger[_0x365cf6(0x26d)](_0x365cf6(0x1a4)+_0x1d516f+_0x365cf6(0x28a));}else logger[_0x365cf6(0x26d)](_0x365cf6(0x1a4)+_0x1d516f+_0x365cf6(0x2a3));}),app[_0x5c0f7b(0x141)]('/upload-backup',async(_0x16272c,_0xcbe9c1)=>{const _0x40fe92=_0x5c0f7b,_0x585dc4=getClientsWithBotID(_0x40fe92(0x291)),_0x8e7d86=_0x16272c['headers'][_0x40fe92(0x215)],_0x3292cb=timelyDecrypt(_0x8e7d86,![]),_0x2e5080=_0x585dc4[_0x40fe92(0x133)](_0x50d690=>_0x50d690[_0x40fe92(0x215)]==_0x3292cb);logger['debug']('Backup\x20file\x20uploaded');if(_0x2e5080){const _0x5cda0c=normalizeIP(_0x16272c[_0x40fe92(0xca)][_0x40fe92(0x1f8)])['store'],_0x23e51c=_0x16272c[_0x40fe92(0x1ad)][_0x40fe92(0x23a)];if(validateAccess(_0x23e51c,_0x3292cb,_0x5cda0c)[_0x40fe92(0x1e6)]){if(_0x16272c[_0x40fe92(0xd4)]){const _0xa6cf28=_0x16272c[_0x40fe92(0xd4)][_0x40fe92(0x1f4)];await _0xa6cf28['mv'](temppath+_0xa6cf28['name']),_0xcbe9c1[_0x40fe92(0x12b)]({'status':!![],'message':_0x40fe92(0x167)});const _0x3559cc=getBotsWithMode();_0x3559cc[_0x40fe92(0x1d5)]>0x0?confirmRestore(temppath,_0xa6cf28[_0x40fe92(0x101)]):unzipFile(temppath,_0xa6cf28[_0x40fe92(0x101)]);}}else logger[_0x40fe92(0x26d)](_0x40fe92(0x1ac));}else logger[_0x40fe92(0x26d)](_0x40fe92(0xf7));}),app[_0x5c0f7b(0x22f)](express[_0x5c0f7b(0xe4)](path['join'](__dirname,bbpath2,_0x5c0f7b(0x110)))),app['use'](express['static'](path[_0x5c0f7b(0x1a1)](__dirname,bbpath2,'build'))),app[_0x5c0f7b(0x1b9)]('/',function(_0x23ed29,_0x512af2){const _0x206405=_0x5c0f7b;_0x512af2[_0x206405(0x23b)](path[_0x206405(0x1a1)](__dirname,bbpath2,_0x206405(0x110),_0x206405(0x164)));}),app[_0x5c0f7b(0x1b9)](_0x5c0f7b(0xc3),function(_0x5ce6d9,_0x30e9c5){const _0x292e9f=_0x5c0f7b;_0x30e9c5[_0x292e9f(0x23b)](path[_0x292e9f(0x1a1)](__dirname,bbpath2,_0x292e9f(0xe5),_0x292e9f(0x164)));}),app[_0x5c0f7b(0x1b9)]('/:bot/portfolio',(_0x3f441b,_0x17ab42)=>{const _0x5468dc=_0x5c0f7b;_0x17ab42[_0x5468dc(0x23b)](path[_0x5468dc(0x1a1)](__dirname,bbpath2,_0x5468dc(0xe5),_0x5468dc(0x164)));}),app[_0x5c0f7b(0x1b9)](_0x5c0f7b(0x156),(_0x4d2966,_0x34cde4)=>{const _0x33c342=_0x5c0f7b;_0x34cde4['sendFile'](path['join'](__dirname,bbpath2,'build',_0x33c342(0x164)));}),app[_0x5c0f7b(0x1b9)]('/:bot/coins',(_0x271bf0,_0x242a17)=>{const _0x35238b=_0x5c0f7b;_0x242a17[_0x35238b(0x23b)](path[_0x35238b(0x1a1)](__dirname,bbpath2,'build',_0x35238b(0x164)));}),app[_0x5c0f7b(0x1b9)](_0x5c0f7b(0x14e),(_0xb37538,_0x318ddb)=>{const _0x3c5f23=_0x5c0f7b;_0x318ddb['sendFile'](path['join'](__dirname,bbpath2,_0x3c5f23(0xe5),_0x3c5f23(0x164)));}),app[_0x5c0f7b(0x1b9)]('/:bot/configuration',(_0x4f56f8,_0x40cfaf)=>{const _0x12ae4f=_0x5c0f7b;_0x40cfaf[_0x12ae4f(0x23b)](path[_0x12ae4f(0x1a1)](__dirname,bbpath2,_0x12ae4f(0xe5),'index.html'));}),app[_0x5c0f7b(0x1b9)]('/:bot/support',(_0x160a85,_0x105a26)=>{const _0x37397a=_0x5c0f7b;_0x105a26[_0x37397a(0x23b)](path[_0x37397a(0x1a1)](__dirname,bbpath2,'build',_0x37397a(0x164)));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x5c0f7b(0x254))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x594647=_0x5c0f7b;let _0x8f73f8='[ip-address]';const _0x28b3a7=networkInterfaces(),_0x29ba13={};for(const _0x198f63 of Object[_0x594647(0x1f1)](_0x28b3a7)){for(const _0x284d91 of _0x28b3a7[_0x198f63]){if((_0x284d91[_0x594647(0x11a)]==_0x594647(0x289)||_0x284d91[_0x594647(0x11a)]==0x4)&&!_0x284d91[_0x594647(0x175)]){const _0x40988c=ipaddr[_0x594647(0x1cb)](_0x284d91['address'])[_0x594647(0x11b)]();_0x40988c!='private'&&(!_0x29ba13[_0x198f63]&&(_0x29ba13[_0x198f63]=[]),_0x29ba13[_0x198f63]['push'](_0x284d91['address']),_0x8f73f8=_0x284d91['address']);}}}return{'serverip':_0x8f73f8,'netinterfaces':_0x29ba13};}async function startServer(){const _0x211509=_0x5c0f7b,{serverip:_0x2af73f,netinterfaces:_0x15219e}=getServerIP();logger[_0x211509(0xf0)](''),logger['simple'](_0x211509(0x219)),await logger[_0x211509(0x26d)](_0x211509(0x132)+serverversion+'#RES#\x20'+(environment=='staging'?_0x211509(0xcf):'')+'\x0a'+(_0x211509(0x116)+PORT+_0x211509(0x226))+(_0x211509(0x249)+_0x2af73f+':'+PORT+_0x211509(0x1b2))),logger[_0x211509(0xf0)](_0x211509(0x219));if(config['length']!=0x0)for(const _0x2d1838 of config){const _0x1e78d0=_0x2d1838[_0x211509(0x205)]=='auto'?'a':'m';if(_0x2d1838[_0x211509(0xb8)]==_0x211509(0x28e)||_0x2d1838[_0x211509(0xb8)]==_0x211509(0x181))await logger['full'](_0x211509(0x200)+_0x1e78d0+_0x211509(0x149)+_0x2d1838[_0x211509(0x1de)]+_0x211509(0x112)+_0x2d1838[_0x211509(0x14a)]),startBot([_0x2d1838['botID'],userID],{'cwd':bbpath},function(_0x33e0fb){const _0x1b09a9=_0x211509;if(_0x33e0fb)logger[_0x1b09a9(0x26d)](_0x33e0fb);});else(_0x2d1838['status']==_0x211509(0x26e)||_0x2d1838['status']==_0x211509(0xde))&&await logger[_0x211509(0x26d)]('Idling\x20('+_0x1e78d0+')\x20\x20\x20|\x20Bot\x20'+_0x2d1838['botID']+_0x211509(0x112)+_0x2d1838[_0x211509(0x14a)]);}else!newBot&&logger[_0x211509(0xf0)](_0x211509(0x12f));if(newBot)addBot();logger[_0x211509(0xf0)](_0x211509(0x219)),logger[_0x211509(0xf0)](''),await logger[_0x211509(0x24c)]('Node.js\x20v'+nodeversion),await logger[_0x211509(0x24c)](_0x211509(0x223),_0x15219e);}function startSocket(){const _0x281e14=_0x5c0f7b;io['on'](_0x281e14(0xc5),_0x3f6bbf=>{const _0x4ae4e0=_0x281e14;let _0x31f010,_0x119f94,_0x2db591,_0x44f50d,_0x14c9ea;const _0x4fd43c=_0x3f6bbf['handshake'][_0x4ae4e0(0x1ad)][_0x4ae4e0(0xfe)];_0x119f94=_0x4fd43c['match'](/bot[0-9]{3}/);if(_0x119f94)_0x2db591=_0x119f94[0x0][_0x4ae4e0(0x25e)](/[0-9]{3}/);if(_0x2db591)_0x31f010=_0x2db591[0x0];else _0x31f010=_0x4ae4e0(0x291);const _0x2829e8=_0x3f6bbf['handshake'][_0x4ae4e0(0x2be)][_0x4ae4e0(0x1b3)];if(!_0x2829e8)_0x3f6bbf[_0x4ae4e0(0x24a)](_0x4ae4e0(0xb8),{'publicKey':secure[_0x4ae4e0(0x28f)]});else{_0x44f50d=timelyDecrypt(_0x2829e8,![]);if(!_0x44f50d)_0x3f6bbf[_0x4ae4e0(0x24a)](_0x4ae4e0(0xb8),{'publicKey':secure[_0x4ae4e0(0x28f)]});else{_0x14c9ea=normalizeIP(_0x3f6bbf[_0x4ae4e0(0x1fa)]['remoteAddress'])[_0x4ae4e0(0x1bf)];if(!devices[_0x44f50d])devices[_0x44f50d]={'uuid':_0x44f50d,'access':{'token':null}};devices[_0x44f50d]['ip']=_0x14c9ea;const _0x98bd97=addClient(_0x3f6bbf['id'],_0x44f50d,_0x31f010);setAccess(_0x98bd97),emitMessages(),_0x3f6bbf['on'](_0x4ae4e0(0x1a2),_0x589590=>{const _0x180149=_0x4ae4e0,_0x8a2929=timelyDecrypt(_0x589590['password'],!![],_0x180149(0x165));if(_0x8a2929){_0x589590={'username':_0x589590[_0x180149(0x298)],'password':_0x8a2929},devices[_0x44f50d]['access']=validateCredentials(_0x589590,_0x44f50d);if(devices[_0x44f50d][_0x180149(0x177)][_0x180149(0x1e6)]==![]&&devices[_0x44f50d]['access'][_0x180149(0xe3)]==_0x180149(0x174))_0x3f6bbf[_0x180149(0x24a)]('status',{'access':devices[_0x44f50d]['access']}),loginAccess2FA(_0x44f50d,_0x14c9ea);else{if(devices[_0x44f50d]['access'][_0x180149(0x1e6)]==![]&&devices[_0x44f50d][_0x180149(0x177)][_0x180149(0xe3)]==_0x180149(0xf6))_0x3f6bbf[_0x180149(0x24a)](_0x180149(0xb8),{'access':devices[_0x44f50d]['access']});else devices[_0x44f50d][_0x180149(0x177)][_0x180149(0x1e6)]&&devices[_0x44f50d]['access'][_0x180149(0xe3)]==_0x180149(0x10b)&&(getClientsWithUuid(_0x44f50d)['forEach'](_0x53e1f8=>{setAccess(_0x53e1f8);}),logger[_0x180149(0x24c)]('Logged\x20in\x20user\x20...'+_0x44f50d[_0x180149(0x263)](-0x8)),setTokenRefresh(_0x44f50d),setSessionTimeout('login',_0x44f50d));}}else logger[_0x180149(0x26d)](_0x180149(0x26b));}),_0x3f6bbf['on'](_0x4ae4e0(0x171),()=>{resetPassword();}),_0x3f6bbf['on'](_0x4ae4e0(0xc6),_0x5f4528=>{removeClient(_0x3f6bbf['id']);}),_0x31f010==_0x4ae4e0(0x291)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5ca8a9){const _0xe589cf=_0x5c0f7b;if(_0x5ca8a9!=_0xe589cf(0x291)&&config[_0xe589cf(0x255)]!=''){if(pid[_0x5ca8a9])pid[_0x5ca8a9]['send']({'function':_0xe589cf(0xd8),'args':null});}_0x5ca8a9!=_0xe589cf(0x291)&&broadcastToBots(_0xe589cf(0x285),JSON['stringify'](config));}function reloadBotManager(){const _0xb9aa7f=_0x5c0f7b;getClientsWithBotID(_0xb9aa7f(0x291))[_0xb9aa7f(0x1c5)](_0x468e25=>{const _0x33c698=_0xb9aa7f;getSocket(_0x468e25['id'])[_0x33c698(0x24a)](_0x33c698(0xb8),{'access':{'allow':![],'reason':_0x33c698(0x182),'token':null}});});}function getSocket(_0x575db7){const _0x717d11=_0x5c0f7b,_0x121d2d=io[_0x717d11(0x1a0)][_0x717d11(0x1b9)]('/');return _0x121d2d[_0x717d11(0x279)][_0x717d11(0x1b9)](_0x575db7);}function setAccess(_0x5e01dd){const _0x25db86=_0x5c0f7b,_0x46d1d9=getSocket(_0x5e01dd['id']),_0x2deebe=_0x5e01dd['uuid'],_0x388b27=_0x5e01dd[_0x25db86(0xe0)];devices[_0x2deebe]['access']=validateAccess(devices[_0x2deebe]['access'][_0x25db86(0x1f7)],_0x2deebe),logger[_0x25db86(0x24c)](_0x25db86(0x1ea)+devices[_0x2deebe]['access'][_0x25db86(0xe3)]+_0x25db86(0x20e)+_0x5e01dd['id'][_0x25db86(0x263)](-0x8)+_0x25db86(0x206)+_0x2deebe[_0x25db86(0x263)](-0x8)),_0x46d1d9['join'](_0x2deebe);if(devices[_0x2deebe][_0x25db86(0x177)][_0x25db86(0x1e6)]){_0x46d1d9[_0x25db86(0x1a1)](_0x388b27);if(_0x388b27==_0x25db86(0x291))initializeSocketBotManager(_0x46d1d9);else initializeSocketBot(_0x46d1d9);initClient(_0x388b27);}devices[_0x2deebe]['access'][_0x25db86(0x1f7)]&&devices[_0x2deebe]['access'][_0x25db86(0xe3)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x25db86(0x13d),_0x2deebe),devices[_0x2deebe][_0x25db86(0x177)][_0x25db86(0x1f7)]&&devices[_0x2deebe]['access'][_0x25db86(0xe3)]==_0x25db86(0xc9)&&setSessionTimeout(_0x25db86(0x1a2),_0x2deebe),_0x46d1d9['emit'](_0x25db86(0xb8),{'status':_0x5e01dd[_0x25db86(0x1ee)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2deebe]['access'],'externalip':devices[_0x2deebe]['ip'],'publicKey':secure[_0x25db86(0x28f)],'userid':settings[_0x25db86(0x1f2)],'validInstallation':validInstallation}),devices[_0x2deebe][_0x25db86(0x177)][_0x25db86(0x1e6)]==![]&&devices[_0x2deebe][_0x25db86(0x177)]['reason']==_0x25db86(0x268)&&temporaryAccess2FA(_0x2deebe,devices[_0x2deebe]['ip']);}function setSessionTimeout(_0x512fd0,_0x1be14d){const _0x1ea26c=_0x5c0f7b;let _0x183016;if(_0x512fd0==_0x1ea26c(0x1a2))_0x183016=loginExpiry*0x3c*0x3e8;else _0x183016=devices[_0x1be14d][_0x1ea26c(0x1e0)][_0x1ea26c(0x2b2)]*0x3c*0x3e8-(new Date()[_0x1ea26c(0x15f)]()-devices[_0x1be14d][_0x1ea26c(0x1e0)][_0x1ea26c(0x1db)]);if(devices[_0x1be14d][_0x1ea26c(0xbb)])clearTimeout(devices[_0x1be14d][_0x1ea26c(0xbb)]);devices[_0x1be14d][_0x1ea26c(0xbb)]=setTimeout(()=>{const _0x397438=_0x1ea26c;if(devices[_0x1be14d][_0x397438(0x257)])clearTimeout(devices[_0x1be14d][_0x397438(0x257)]);removeSocketListeners(_0x1be14d),addBlacklist(_0x1be14d),devices[_0x1be14d][_0x397438(0x1e0)]=null,devices[_0x1be14d]['telegram2FaApproval']=null,devices[_0x1be14d][_0x397438(0x177)][_0x397438(0x1f7)]=null,logger[_0x397438(0x24c)](_0x397438(0x1d7)+_0x1be14d[_0x397438(0x263)](-0x8)),devices[_0x1be14d][_0x397438(0x177)]=validateAccess(devices[_0x1be14d]['access'][_0x397438(0x1f7)],_0x1be14d),!(devices[_0x1be14d][_0x397438(0x177)][_0x397438(0x1e6)]&&devices[_0x1be14d][_0x397438(0x177)][_0x397438(0xe3)]==_0x397438(0x102))&&(_0x512fd0==_0x397438(0x1a2)?io['to'](_0x1be14d)[_0x397438(0x24a)](_0x397438(0xb8),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x1be14d)[_0x397438(0x24a)](_0x397438(0xb8),{'access':{'allow':![],'reason':_0x397438(0x17f),'token':null}})),devices[_0x1be14d][_0x397438(0x177)]['token']=null;},_0x183016);}function setTokenRefresh(_0xf879ec){const _0x24d1f4=_0x5c0f7b;if(devices[_0xf879ec][_0x24d1f4(0x257)])clearTimeout(devices[_0xf879ec]['pidRefreshToken']);devices[_0xf879ec][_0x24d1f4(0x257)]=setTimeout(()=>{const _0x491fa0=_0x24d1f4;getClientsWithUuid(_0xf879ec)[_0x491fa0(0x1d5)]!=0x0?(devices[_0xf879ec][_0x491fa0(0x177)]=refreshToken(_0xf879ec),io['to'](_0xf879ec)[_0x491fa0(0x24a)]('status',{'status':_0x491fa0(0x27b),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xf879ec][_0x491fa0(0x177)],'externalip':devices[_0xf879ec]['ip'],'publicKey':secure[_0x491fa0(0x28f)],'validInstallation':validInstallation}),setTokenRefresh(_0xf879ec)):clearTimeout(devices[_0xf879ec][_0x491fa0(0x257)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1a4a0b){const _0x13e905=_0x5c0f7b,_0x360fc7=getClient(_0x1a4a0b['id'])[_0x13e905(0x215)];_0x1a4a0b[_0x13e905(0x24a)]('bots',config),_0x1a4a0b[_0x13e905(0x24a)]('settings',cleanSettings()),_0x1a4a0b['on'](_0x13e905(0x18b),_0x2039e4=>{const _0x3a5e78=_0x13e905;if(validateAccess(_0x2039e4,_0x360fc7)[_0x3a5e78(0x1e6)])addBot();else logger[_0x3a5e78(0x26d)](_0x3a5e78(0xba));}),_0x1a4a0b['on'](_0x13e905(0xaf),(_0x4cfa50,_0x4322f7)=>{const _0x40adbd=_0x13e905;if(validateAccess(_0x4322f7,_0x360fc7)[_0x40adbd(0x1e6)])toggleBot(_0x4cfa50['botID'],_0x4cfa50[_0x40adbd(0xb8)],_0x4cfa50[_0x40adbd(0x1b8)]);else logger[_0x40adbd(0x26d)](_0x40adbd(0x1fe));}),_0x1a4a0b['on']('toggle-bot-mode',(_0x380dd9,_0x4fc191)=>{const _0x5c6489=_0x13e905;if(validateAccess(_0x4fc191,_0x360fc7)[_0x5c6489(0x1e6)])toggleBotMode(_0x380dd9);else logger['full'](_0x5c6489(0x1fe));}),_0x1a4a0b['on']('delete-bot',(_0x1c5798,_0x117688)=>{const _0x3edc7b=_0x13e905;if(validateAccess(_0x117688,_0x360fc7)[_0x3edc7b(0x1e6)])deleteBot(_0x1c5798);else logger[_0x3edc7b(0x26d)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x1a4a0b['on']('store-settings',(_0x5f371f,_0x552f09)=>{const _0x12faa2=_0x13e905;if(validateAccess(_0x552f09,_0x360fc7)[_0x12faa2(0x1e6)])storeSettings(_0x5f371f,!![]);else logger[_0x12faa2(0x26d)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x1a4a0b['on'](_0x13e905(0x2b1),_0xb2bab=>{const _0x49701c=_0x13e905;if(validateAccess(_0xb2bab,_0x360fc7)[_0x49701c(0x1e6)])updateBB(_0x49701c(0xcb));else logger[_0x49701c(0x26d)](_0x49701c(0x22a));}),_0x1a4a0b['on'](_0x13e905(0x1c7),_0x34fc8f=>{const _0x12db49=_0x13e905;if(validateAccess(_0x34fc8f,_0x360fc7)['allow'])updateBB(_0x12db49(0x26a));else logger[_0x12db49(0x26d)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x1a4a0b['on']('get-backup-files',_0x531b09=>{const _0x4a6085=_0x13e905;if(validateAccess(_0x531b09,_0x360fc7)[_0x4a6085(0x1e6)]){const _0xe25a33=getClient(_0x1a4a0b['id']);if(_0xe25a33)getBackupFiles(_0xe25a33['uuid']);else logger[_0x4a6085(0x26d)](_0x4a6085(0xec));}else logger[_0x4a6085(0x26d)](_0x4a6085(0x162));}),_0x1a4a0b['on'](_0x13e905(0x1c8),(_0x27c0ea,_0xad973a)=>{const _0x2d174b=_0x13e905;if(validateAccess(_0xad973a,_0x360fc7)[_0x2d174b(0x1e6)])restoreBackupFile(_0x27c0ea);else logger[_0x2d174b(0x26d)](_0x2d174b(0x173));}),_0x1a4a0b['on'](_0x13e905(0x2b4),_0x49ad70=>{const _0x4293a3=_0x13e905;if(validateAccess(_0x49ad70,_0x360fc7)[_0x4293a3(0x1e6)])getMessages();else logger[_0x4293a3(0x26d)](_0x4293a3(0x1bb));}),_0x1a4a0b['on']('confirm-message',(_0xeb3bfb,_0x11ea4e)=>{const _0x462aea=_0x13e905;if(validateAccess(_0x11ea4e,_0x360fc7)[_0x462aea(0x1e6)])confirmMessage(_0xeb3bfb);else logger[_0x462aea(0x26d)](_0x462aea(0x152));}),_0x1a4a0b['on']('logout',_0x337d01=>{const _0x43b980=_0x13e905;if(validateAccess(_0x337d01,_0x360fc7)[_0x43b980(0x1e6)]){if(devices[_0x360fc7][_0x43b980(0x257)])clearTimeout(devices[_0x360fc7][_0x43b980(0x257)]);if(devices[_0x360fc7][_0x43b980(0xbb)])clearTimeout(devices[_0x360fc7][_0x43b980(0xbb)]);removeSocketListeners(getClient(_0x1a4a0b['id'])[_0x43b980(0x215)]),addBlacklist(_0x360fc7),devices[_0x360fc7][_0x43b980(0x1e0)]=null,devices[_0x360fc7]['telegram2FaApproval']=null,devices[_0x360fc7][_0x43b980(0x177)][_0x43b980(0x1f7)]=null,logger[_0x43b980(0x24c)](_0x43b980(0x199)+_0x360fc7['slice'](-0x8)),io['to'](getClient(_0x1a4a0b['id'])[_0x43b980(0x215)])[_0x43b980(0x24a)](_0x43b980(0xb8),{'access':{'allow':![],'reason':_0x43b980(0x294),'token':null}});}else logger['full'](_0x43b980(0x1d0));});}function initializeSocketBot(_0xd5b6b1){const _0x1ed7f4=_0x5c0f7b,_0x1479a3=getClient(_0xd5b6b1['id'])[_0x1ed7f4(0xe0)],_0x364c4f=getClient(_0xd5b6b1['id'])[_0x1ed7f4(0x215)];_0xd5b6b1['on'](_0x1ed7f4(0x170),(_0x2ad96b,_0x436e2c)=>{const _0x4fb0c1=_0x1ed7f4;if(validateAccess(_0x436e2c,_0x364c4f)[_0x4fb0c1(0x1e6)]){if(pid[_0x1479a3])pid[_0x1479a3][_0x4fb0c1(0x12b)]({'function':_0x4fb0c1(0xdc),'args':_0x2ad96b});}else logger[_0x4fb0c1(0x26d)](_0x4fb0c1(0x24f));}),_0xd5b6b1['on'](_0x1ed7f4(0xe2),(_0x3217bd,_0x56fa37)=>{const _0x2c89a0=_0x1ed7f4;if(validateAccess(_0x56fa37,_0x364c4f)[_0x2c89a0(0x1e6)]){if(pid[_0x1479a3])pid[_0x1479a3][_0x2c89a0(0x12b)]({'function':'deleteHistoryAlerts','args':_0x3217bd});}else logger[_0x2c89a0(0x26d)](_0x2c89a0(0x22b));}),_0xd5b6b1['on']('get-portfolio',(_0x234d33,_0x5e2bf1)=>{const _0xf1ad28=_0x1ed7f4;if(validateAccess(_0x5e2bf1,_0x364c4f)[_0xf1ad28(0x1e6)]){if(pid[_0x1479a3])pid[_0x1479a3][_0xf1ad28(0x12b)]({'function':_0xf1ad28(0x1dd),'args':_0x234d33});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0xd5b6b1['on'](_0x1ed7f4(0x12a),(_0x53ddfd,_0x12134f)=>{const _0x552ecf=_0x1ed7f4;if(validateAccess(_0x12134f,_0x364c4f)[_0x552ecf(0x1e6)]){if(pid[_0x1479a3])pid[_0x1479a3]['send']({'function':'storeConfiguration','args':_0x53ddfd});}else logger[_0x552ecf(0x26d)](_0x552ecf(0x114));}),_0xd5b6b1['on'](_0x1ed7f4(0x29c),(_0x377c4c,_0x66fcc0)=>{const _0xb3b8c6=_0x1ed7f4;if(validateAccess(_0x66fcc0,_0x364c4f)['allow']){if(pid[_0x1479a3])pid[_0x1479a3][_0xb3b8c6(0x12b)]({'function':_0xb3b8c6(0x146),'args':_0x377c4c});}else logger[_0xb3b8c6(0x26d)](_0xb3b8c6(0x1c0));}),_0xd5b6b1['on'](_0x1ed7f4(0x14f),(_0x45131c,_0x21925b)=>{const _0x346a71=_0x1ed7f4;if(validateAccess(_0x21925b,_0x364c4f)['allow']){if(pid[_0x1479a3])pid[_0x1479a3][_0x346a71(0x12b)]({'function':'storeFiat','args':_0x45131c});}else logger[_0x346a71(0x26d)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0xd5b6b1['on'](_0x1ed7f4(0x234),_0x1451f2=>{const _0x47ff0a=_0x1ed7f4;if(validateAccess(_0x1451f2,_0x364c4f)[_0x47ff0a(0x1e6)]){if(pid[_0x1479a3])pid[_0x1479a3]['send']({'function':'resetHistory','args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0xd5b6b1['on'](_0x1ed7f4(0x220),_0x33b3d3=>{const _0x173a28=_0x1ed7f4;if(validateAccess(_0x33b3d3,_0x364c4f)['allow']){if(pid[_0x1479a3])pid[_0x1479a3][_0x173a28(0x12b)]({'function':_0x173a28(0x28d),'args':null});}else logger[_0x173a28(0x26d)](_0x173a28(0x232));}),_0xd5b6b1['on'](_0x1ed7f4(0xeb),(_0x54cde3,_0x3a2aac)=>{const _0x317138=_0x1ed7f4;if(validateAccess(_0x3a2aac,_0x364c4f)[_0x317138(0x1e6)]){if(pid[_0x1479a3])pid[_0x1479a3][_0x317138(0x12b)]({'function':_0x317138(0x111),'args':_0x54cde3});}else logger[_0x317138(0x26d)](_0x317138(0xf5));}),_0xd5b6b1['on'](_0x1ed7f4(0x2b9),_0x3e1ad0=>{const _0x231273=_0x1ed7f4;if(validateAccess(_0x3e1ad0,_0x364c4f)[_0x231273(0x1e6)]){if(pid[_0x1479a3])pid[_0x1479a3][_0x231273(0x12b)]({'function':_0x231273(0x271),'args':null});}else logger[_0x231273(0x26d)](_0x231273(0x290));}),_0xd5b6b1['on'](_0x1ed7f4(0x252),_0x48eb39=>{const _0x287592=_0x1ed7f4;if(validateAccess(_0x48eb39,_0x364c4f)['allow']){if(pid[_0x1479a3])pid[_0x1479a3]['send']({'function':_0x287592(0x23f),'args':null});}else logger[_0x287592(0x26d)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0xd5b6b1['on']('update-bb',_0x17b309=>{const _0x196d68=_0x1ed7f4;if(validateAccess(_0x17b309,_0x364c4f)['allow'])updateBB(_0x196d68(0xcb));else logger[_0x196d68(0x26d)](_0x196d68(0x22a));}),_0xd5b6b1['on'](_0x1ed7f4(0x2b4),_0x2ae08c=>{const _0x5b824b=_0x1ed7f4;if(validateAccess(_0x2ae08c,_0x364c4f)[_0x5b824b(0x1e6)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0xd5b6b1['on'](_0x1ed7f4(0x187),(_0x36a5f5,_0x7b3e41)=>{const _0x2b7508=_0x1ed7f4;if(validateAccess(_0x7b3e41,_0x364c4f)[_0x2b7508(0x1e6)])confirmMessage(_0x36a5f5);else logger['full'](_0x2b7508(0x152));}),_0xd5b6b1['on'](_0x1ed7f4(0xb6),_0x5c7a35=>{const _0x33b395=_0x1ed7f4;if(validateAccess(_0x5c7a35,_0x364c4f)[_0x33b395(0x1e6)]){if(devices[_0x364c4f][_0x33b395(0x257)])clearTimeout(devices[_0x364c4f][_0x33b395(0x257)]);if(devices[_0x364c4f][_0x33b395(0xbb)])clearTimeout(devices[_0x364c4f]['pidExpireLogin']);removeSocketListeners(getClient(_0xd5b6b1['id'])[_0x33b395(0x215)]),addBlacklist(_0x364c4f),devices[_0x364c4f][_0x33b395(0x1e0)]=null,devices[_0x364c4f][_0x33b395(0x260)]=null,devices[_0x364c4f]['access']['token']=null,logger[_0x33b395(0x24c)](_0x33b395(0x199)+_0x364c4f['slice'](-0x8)),io['to'](getClient(_0xd5b6b1['id'])['uuid'])[_0x33b395(0x24a)]('status',{'access':{'allow':![],'reason':_0x33b395(0x294),'token':null}});}else logger['full'](_0x33b395(0x1d0));});}function removeSocketListeners(_0x264968){const _0x3445d7=_0x5c0f7b;getClientsWithUuid(_0x264968)[_0x3445d7(0x1c5)](_0x11ef81=>{const _0x26e839=_0x3445d7;getSocket(_0x11ef81['id'])[_0x26e839(0x1e8)]();});}function cleanSettings(){const _0x19458d=_0x5c0f7b;let _0x555e28=settings;return settings[_0x19458d(0x1bd)]&&settings[_0x19458d(0x1bd)]!=''&&(_0x555e28={..._0x555e28,'telegramToken':_0x19458d(0xf3)}),settings[_0x19458d(0x2ad)]&&settings[_0x19458d(0x2ad)]!=''&&(_0x555e28={..._0x555e28,'bbPassword':_0x19458d(0xf3)}),settings[_0x19458d(0xb1)]&&settings[_0x19458d(0xb1)]!=''&&(_0x555e28={..._0x555e28,'marketcapApi':_0x19458d(0xf3)}),(settings[_0x19458d(0x2ad)]&&settings['bbPassword']==_0x19458d(0x1e5)||settings['telegramToken']&&settings['telegramToken']==_0x19458d(0x1e5)||settings[_0x19458d(0xb1)]&&settings['marketcapApi']==_0x19458d(0x1e5))&&(_0x555e28={..._0x555e28,'restored':{'password':settings[_0x19458d(0x2ad)]==_0x19458d(0x1e5),'telegram':settings[_0x19458d(0x1bd)]=='***','marketcap':settings[_0x19458d(0xb1)]==_0x19458d(0x1e5)}}),_0x555e28;}async function updateBB(_0x36f401){const _0xa0c0e6=_0x5c0f7b;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x4b016e=>{const _0x18a255=_0x65bd;restartBot(_0x4b016e[_0x18a255(0x1de)]);});if(_0x36f401==_0xa0c0e6(0xcb))process['send']({'update':!![],'environment':environment},_0x524570=>{});else _0x36f401==_0xa0c0e6(0x26a)&&process[_0xa0c0e6(0x12b)]({'reinstall':!![],'environment':environment},_0x27b37b=>{});}function startBot(_0x7efb87,_0x1c068d,_0xd67fe3){const _0x4a6955=_0x5c0f7b;if(debugging)_0x7efb87[_0x4a6955(0x15d)]('-d');let _0x479a50=![];const _0xfd8102=_0x7efb87[0x0];_0x1c068d={..._0x1c068d,'stdio':[_0x4a6955(0x1d2),'inherit',_0x4a6955(0x1d2),'ipc']},pid[_0xfd8102]=childProcess[_0x4a6955(0x237)](botfile,_0x7efb87,_0x1c068d),pid[_0xfd8102]['on']('message',_0x50b554=>{const _0xbe34b3=_0x4a6955;switch(Object[_0xbe34b3(0x1f1)](_0x50b554)[0x0]){case _0xbe34b3(0x14a):updateBotName(_0xfd8102,_0x50b554[_0xbe34b3(0x14a)]);break;case'updatebotmanager':updateBotManager();break;case _0xbe34b3(0xb8):updateStatus(_0xfd8102,_0x50b554[_0xbe34b3(0xb8)]);break;case _0xbe34b3(0x1b8):updateLive(_0xfd8102,_0x50b554[_0xbe34b3(0x1b8)]);break;case _0xbe34b3(0x128):updateLive(_0xfd8102,_0x50b554[_0xbe34b3(0x128)]),io['to'](_0xfd8102)['emit'](_0xbe34b3(0xb8),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0xbe34b3(0x189):_0x50b554[_0xbe34b3(0x189)]=='restart'&&restartBot(_0xfd8102);_0x50b554[_0xbe34b3(0x189)]==_0xbe34b3(0x15e)&&toggleBot(_0xfd8102,_0xbe34b3(0x26e),_0xbe34b3(0x16f));break;case'telegram':sendTelegramBot(_0xfd8102,_0x50b554[_0xbe34b3(0x295)]);break;case _0xbe34b3(0x1d8):sendTelegramMsg(_0x50b554[_0xbe34b3(0x1d8)]);break;case _0xbe34b3(0x10f):io['to'](_0xfd8102)[_0xbe34b3(0x24a)](_0x50b554[_0xbe34b3(0x10f)],_0x50b554['args']);break;}}),pid[_0xfd8102]['on']('error',function(_0x13a60e){if(_0x479a50)return;_0x479a50=!![],_0xd67fe3(_0x13a60e);}),pid[_0xfd8102]['on']('exit',async function(_0x2c9287){const _0x8b399e=_0x4a6955;if(terminating)return;if(installingUpdate){io[_0x8b399e(0x20d)]();return;}if(_0x479a50)return;_0x479a50=!![],_0xd67fe3(null);const _0xccf931=dbConfig[_0x8b399e(0x1b9)](_0x8b399e(0x285))[_0x8b399e(0x133)]({'botID':_0xfd8102})[_0x8b399e(0x273)]();_0xccf931&&(_0xccf931['status']=='enabled'||_0xccf931[_0x8b399e(0xb8)]==_0x8b399e(0x181))&&(await sleep(0x3e8),updateLive(_0xfd8102,'stopped'),logger[_0x8b399e(0x26d)](_0x8b399e(0x225)+_0xfd8102),startBot([_0xfd8102,userID],{'cwd':bbpath},function(_0x4fcbd8){const _0x338152=_0x8b399e;if(_0x4fcbd8)logger[_0x338152(0x26d)](_0x4fcbd8);}));});}function stopBot(_0x4de7b4){const _0x364b1b=_0x5c0f7b;getClientsWithBotID(_0x4de7b4)[_0x364b1b(0x1c5)](_0x1679fe=>{const _0x131111=_0x364b1b;getSocket(_0x1679fe['id'])[_0x131111(0xc6)](!![]),removeClient(_0x1679fe['id']);}),pid[_0x4de7b4]&&(pid[_0x4de7b4][_0x364b1b(0x15e)](),pid[_0x4de7b4]=null);}function stopAllBots(){const _0x4926be=_0x5c0f7b;terminating=!![];const _0xbcad61=getEnabledBots();_0xbcad61[_0x4926be(0x1c5)](_0x2f7ec2=>{const _0x3a05b5=_0x4926be;stopBot(_0x2f7ec2[_0x3a05b5(0x1de)]);});}function restartBot(_0x4cfc7e){const _0x44a04e=_0x5c0f7b;if(pid[_0x4cfc7e])pid[_0x4cfc7e][_0x44a04e(0x15e)]();}function addBot(){const _0x295687=_0x5c0f7b;let _0x4cfe0d;for(let _0x4fdf2d=0x1;_0x4fdf2d<0x3e9;_0x4fdf2d++){_0x4cfe0d=_0x4fdf2d[_0x295687(0x109)]()['padStart'](0x3,'0');let _0x5d57f1=config[_0x295687(0x133)](_0x8d7621=>_0x8d7621[_0x295687(0x1de)]==_0x4cfe0d);if(!_0x5d57f1)break;}if(_0x4cfe0d===_0x295687(0xc8)){logger[_0x295687(0x26d)](_0x295687(0x103));return;}logger[_0x295687(0x26d)](_0x295687(0x27e)+_0x4cfe0d),dbConfig['get'](_0x295687(0x285))['push']({'botID':_0x4cfe0d,'botname':'Bot\x20'+_0x4cfe0d,'status':_0x295687(0x181),'live':''})['write'](),startBot([_0x4cfe0d,userID],{'cwd':bbpath},function(_0x4a59d2){const _0x3e682f=_0x295687;if(_0x4a59d2)logger[_0x3e682f(0x26d)](_0x4a59d2);}),config=getConfiguration(),io['to'](_0x295687(0x291))[_0x295687(0x24a)]('bots',config),broadcastToBots(_0x295687(0x285),JSON['stringify'](config));}function deleteBot(_0x1dc694){const _0x5963d7=_0x5c0f7b;getClientsWithBotID(_0x1dc694)[_0x5963d7(0x1c5)](_0x5b0a05=>{getSocket(_0x5b0a05['id'])['disconnect'](!![]),removeClient(_0x5b0a05['id']);}),dbConfig[_0x5963d7(0x1b9)](_0x5963d7(0x285))['remove']({'botID':_0x1dc694})[_0x5963d7(0x2a5)](),logger[_0x5963d7(0x26d)](_0x5963d7(0x130)+_0x1dc694),stopBot(_0x1dc694);try{if(fs['existsSync'](path[_0x5963d7(0x1a1)](configpath,_0x5963d7(0x19c)+_0x1dc694+'-config.json')))fs['unlinkSync'](path['join'](configpath,_0x5963d7(0x19c)+_0x1dc694+_0x5963d7(0x286)));if(fs[_0x5963d7(0xcd)](path[_0x5963d7(0x1a1)](configpath,_0x5963d7(0x19c)+_0x1dc694+'-events.json')))fs[_0x5963d7(0xe8)](path[_0x5963d7(0x1a1)](configpath,_0x5963d7(0x19c)+_0x1dc694+'-events.json'));if(fs['existsSync'](path[_0x5963d7(0x1a1)](configpath,_0x5963d7(0x19c)+_0x1dc694+_0x5963d7(0x1b6))))fs[_0x5963d7(0xe8)](path['join'](configpath,_0x5963d7(0x19c)+_0x1dc694+_0x5963d7(0x1b6)));if(fs['existsSync'](path[_0x5963d7(0x1a1)](configpath,_0x5963d7(0x19c)+_0x1dc694+_0x5963d7(0xd9))))fs[_0x5963d7(0xe8)](path['join'](configpath,_0x5963d7(0x19c)+_0x1dc694+'-results.json'));}catch(_0x12c049){if(_0x12c049)logger[_0x5963d7(0x26d)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x12c049);}config=getConfiguration(),io['to'](_0x5963d7(0x291))[_0x5963d7(0x24a)]('bots',config),broadcastToBots(_0x5963d7(0x285),JSON[_0x5963d7(0x1fc)](config));}function toggleBot(_0x40edc2,_0x34a082,_0x203e8d){const _0x5f2fc4=_0x5c0f7b;dbConfig[_0x5f2fc4(0x1b9)]('bots')['find']({'botID':_0x40edc2})['assign']({'status':_0x34a082})[_0x5f2fc4(0x269)]({'live':_0x203e8d})[_0x5f2fc4(0x2a5)]();if(_0x34a082==_0x5f2fc4(0x28e)||_0x34a082==_0x5f2fc4(0x181))logger['full']('Enabled\x20Bot\x20'+_0x40edc2),startBot([_0x40edc2,userID],{'cwd':bbpath},function(_0x47767b){if(_0x47767b)logger['full'](_0x47767b);});else(_0x34a082==_0x5f2fc4(0x26e)||_0x34a082==_0x5f2fc4(0xde))&&(logger[_0x5f2fc4(0x26d)](_0x5f2fc4(0x281)+_0x40edc2),stopBot(_0x40edc2));config=getConfiguration(),io['to'](_0x5f2fc4(0x291))[_0x5f2fc4(0x24a)](_0x5f2fc4(0x285),config),broadcastToBots(_0x5f2fc4(0x285),JSON[_0x5f2fc4(0x1fc)](config));}function toggleStatus(_0x2b0624){const _0x300e5a=_0x5c0f7b;let _0x3d593b=dbConfig[_0x300e5a(0x1b9)](_0x300e5a(0x285))[_0x300e5a(0x133)]({'botID':_0x2b0624})['value'](),_0x25f991;if(_0x3d593b[_0x300e5a(0xb8)]==='enabled')_0x25f991=_0x300e5a(0x26e);else{if(_0x3d593b[_0x300e5a(0xb8)]===_0x300e5a(0x181))_0x25f991=_0x300e5a(0xde);else{if(_0x3d593b[_0x300e5a(0xb8)]==='new-disabled')_0x25f991='new';else{if(_0x3d593b[_0x300e5a(0xb8)]===_0x300e5a(0x26e))_0x25f991='enabled';}}}return _0x25f991;}function updateStatus(_0x217454,_0x25ba77){const _0x1b8d5f=_0x5c0f7b;dbConfig[_0x1b8d5f(0x1b9)](_0x1b8d5f(0x285))['find']({'botID':_0x217454})[_0x1b8d5f(0x269)]({'status':_0x25ba77})[_0x1b8d5f(0x2a5)](),config=getConfiguration(),io['to'](_0x1b8d5f(0x291))[_0x1b8d5f(0x24a)](_0x1b8d5f(0x285),config),broadcastToBots(_0x1b8d5f(0x285),JSON[_0x1b8d5f(0x1fc)](config));}function updateLive(_0x408d1f,_0x175360){const _0x4fa691=_0x5c0f7b;dbConfig[_0x4fa691(0x1b9)](_0x4fa691(0x285))[_0x4fa691(0x133)]({'botID':_0x408d1f})[_0x4fa691(0x269)]({'live':_0x175360})[_0x4fa691(0x2a5)](),config=getConfiguration(),io['to'](_0x4fa691(0x291))[_0x4fa691(0x24a)](_0x4fa691(0x285),config),broadcastToBots(_0x4fa691(0x285),JSON['stringify'](config));}function updateBotName(_0xfc38e3,_0x17aa7a){const _0x1ddf95=_0x5c0f7b;dbConfig[_0x1ddf95(0x1b9)](_0x1ddf95(0x285))[_0x1ddf95(0x133)]({'botID':_0xfc38e3})[_0x1ddf95(0x269)]({'botname':_0x17aa7a})[_0x1ddf95(0x2a5)](),config=getConfiguration(),io['to']('botmanager')[_0x1ddf95(0x24a)](_0x1ddf95(0x285),config),broadcastToBots(_0x1ddf95(0x285),JSON[_0x1ddf95(0x1fc)](config));}function updateBotManager(){const _0x4904fd=_0x5c0f7b;config=getConfiguration(),io['to']('botmanager')[_0x4904fd(0x24a)]('bots',config),broadcastToBots(_0x4904fd(0x285),JSON[_0x4904fd(0x1fc)](config));}function toggleBotMode(_0x24bddc){const _0x3ed949=_0x5c0f7b;if(pid[_0x24bddc])pid[_0x24bddc][_0x3ed949(0x12b)]({'function':'toggleBotMode','args':null});else{const _0x24b781=configpath+_0x3ed949(0x19c)+_0x24bddc+'-config.json',_0x2dd042=fs[_0x3ed949(0x23d)](_0x24b781),_0x3f7615=JSON[_0x3ed949(0x1cb)](_0x2dd042),_0x13c371=_0x3f7615[_0x3ed949(0xe0)][0x0]['headless'];_0x3f7615[_0x3ed949(0xe0)][0x0][_0x3ed949(0x198)]=!_0x13c371;const _0x22b7f7=JSON[_0x3ed949(0x1fc)](_0x3f7615,null,0x2);fs[_0x3ed949(0x1c1)](_0x24b781,_0x22b7f7),config=getConfiguration(),io['to']('botmanager')[_0x3ed949(0x24a)](_0x3ed949(0x285),config),broadcastToBots(_0x3ed949(0x285),JSON[_0x3ed949(0x1fc)](config));}}function validateTelegram(_0x415666){const _0x2eb22c=_0x5c0f7b;if(_0x415666[_0x2eb22c(0x2a7)][_0x2eb22c(0x298)]!=settings[_0x2eb22c(0x1d4)]&&'@'+_0x415666['from']['username']!=settings[_0x2eb22c(0x1d4)]||_0x415666[_0x2eb22c(0x18f)]['id']!=settings[_0x2eb22c(0x13f)])return sendTelegram(_0x415666[_0x2eb22c(0x18f)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x2eb22c(0x1c6)}),![];return!![];}async function initTelegram(){const _0xb42b18=_0x5c0f7b;tgBot&&(await tgBot[_0xb42b18(0x189)](),await sleep(0x7d0));tgBot=new Telegraf(settings['telegramToken']);let _0x1d2d81=_0xb42b18(0x11f);_0x1d2d81+='\x0a',_0x1d2d81+=_0xb42b18(0x1f5),_0x1d2d81+='/disable\x20-\x20disable\x20notifications\x0a',_0x1d2d81+=_0xb42b18(0x208),_0x1d2d81+=_0xb42b18(0x1fd),_0x1d2d81+=_0xb42b18(0x169),_0x1d2d81+='/off\x20-\x20stop\x20bot(s)\x0a',_0x1d2d81+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x1d2d81+=_0xb42b18(0x10d),_0x1d2d81+=_0xb42b18(0xac),_0x1d2d81+=_0xb42b18(0x1df),_0x1d2d81+=_0xb42b18(0x1f6),_0x1d2d81+=_0xb42b18(0x242),_0x1d2d81+=_0xb42b18(0xdf),_0x1d2d81+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x1d2d81+=_0xb42b18(0xc1),_0x1d2d81+=_0xb42b18(0x10a);let _0x1c77f7='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x1c77f7+='\x0a',_0x1c77f7+=_0x1d2d81,tgBot[_0xb42b18(0x139)]((_0x4e7388,_0xfd99b6)=>{const _0x13ff05=_0xb42b18;logger[_0x13ff05(0xf0)](getTimeStamp()+_0x13ff05(0x1f0)),logger[_0x13ff05(0x24c)](_0x13ff05(0x292),_0x4e7388);}),tgBot['use'](async(_0x4cfa2d,_0x2d7d76)=>{const _0x57f7e4=_0xb42b18;if(!(!settings[_0x57f7e4(0x13f)]&&_0x4cfa2d[_0x57f7e4(0xcb)][_0x57f7e4(0xff)][_0x57f7e4(0x240)]=='/start')){if(!validateTelegram(_0x4cfa2d))return;}_0x2d7d76();}),tgBot[_0xb42b18(0x191)](_0xb42b18(0x2a8),async _0x597258=>{const _0x34254a=_0xb42b18;if(_0x597258[_0x34254a(0x2a7)][_0x34254a(0x298)]==settings[_0x34254a(0x1d4)]||'@'+_0x597258['from'][_0x34254a(0x298)]==settings[_0x34254a(0x1d4)]){if(!settings['telegramChatId'])updateSetting(_0x34254a(0x13f),_0x597258[_0x34254a(0x18f)]['id']);}if(!validateTelegram(_0x597258))return;updateSetting(_0x34254a(0x1e9),!![]),await sendTelegram(_0x597258[_0x34254a(0x18f)]['id'],_0x1c77f7);}),tgBot[_0xb42b18(0x191)](_0xb42b18(0xad),async _0x5a109c=>{const _0x188b9b=_0xb42b18;updateSetting(_0x188b9b(0x1e9),!![]),await sendTelegram(_0x5a109c[_0x188b9b(0x18f)]['id'],'Notifications\x20enabled');}),tgBot['command'](_0xb42b18(0x28c),async _0x2947b8=>{const _0x5edca1=_0xb42b18;await sendTelegram(_0x2947b8[_0x5edca1(0x18f)]['id'],_0x5edca1(0x282)),updateSetting('telegramEnabled',![]);}),tgBot['command']('config',async _0x32ba72=>{const _0x3f3b2a=_0xb42b18,_0x112eef=Markup[_0x3f3b2a(0xd1)]([Markup['button'][_0x3f3b2a(0x20f)](_0x3f3b2a(0x203),'config_orders'),Markup['button'][_0x3f3b2a(0x20f)]('Alerts',_0x3f3b2a(0xd2)),Markup['button'][_0x3f3b2a(0x20f)]('All',_0x3f3b2a(0xf9))]);_0x32ba72['reply'](_0x3f3b2a(0x27a),_0x112eef);}),tgBot[_0xb42b18(0x1d9)](_0xb42b18(0xda),async _0x4cd451=>{const _0x5a2ad5=_0xb42b18;_0x4cd451['editMessageReplyMarkup'](),updateSetting(_0x5a2ad5(0x214),_0x5a2ad5(0x297)),updateSetting(_0x5a2ad5(0x1e9),!![]),await sendTelegram(_0x4cd451[_0x5a2ad5(0x18f)]['id'],_0x5a2ad5(0x2bb));}),tgBot['action'](_0xb42b18(0xd2),async _0x536510=>{const _0x3b20ab=_0xb42b18;_0x536510['editMessageReplyMarkup'](),updateSetting(_0x3b20ab(0x214),_0x3b20ab(0x272)),updateSetting(_0x3b20ab(0x1e9),!![]),await sendTelegram(_0x536510[_0x3b20ab(0x18f)]['id'],_0x3b20ab(0x126));}),tgBot[_0xb42b18(0x1d9)](_0xb42b18(0xf9),async _0xbb7097=>{const _0x3fd428=_0xb42b18;_0xbb7097[_0x3fd428(0x1ba)](),updateSetting(_0x3fd428(0x214),_0x3fd428(0x180)),updateSetting(_0x3fd428(0x1e9),!![]),await sendTelegram(_0xbb7097['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0xb42b18(0x191)]('status',async _0xeacfa3=>{const _0x46d28e=_0xb42b18,_0x13c781=getBotsWithMode();let _0x4a3555='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x46d28e(0x1c5)](_0x595cd4=>{const _0x2446e9=_0x46d28e,_0x5d0237=_0x13c781['find'](_0x419169=>_0x419169['botID']==_0x595cd4[_0x2446e9(0x1de)])[_0x2446e9(0x205)];_0x4a3555+=_0x2446e9(0x16a)+_0x595cd4[_0x2446e9(0x1de)]+':\x20'+_0x595cd4[_0x2446e9(0xb8)]+_0x2446e9(0x112)+_0x5d0237+'\x20|\x20'+_0x595cd4['live']+'\x0a';}),_0x4a3555+='\x0a',_0x4a3555+=_0x46d28e(0x1bc),_0x4a3555+=!settings[_0x46d28e(0x1e9)]?_0x46d28e(0xb0):_0x46d28e(0x2a1),_0x4a3555+=settings['telegramEnabled']?settings[_0x46d28e(0x214)]==_0x46d28e(0x180)?_0x46d28e(0x151):_0x46d28e(0x2b0)+settings[_0x46d28e(0x214)]+_0x46d28e(0x157):'',await sendTelegram(_0xeacfa3[_0x46d28e(0x18f)]['id'],_0x4a3555,{'parse_mode':_0x46d28e(0x1c6)});}),tgBot['command'](_0xb42b18(0x21a),async _0x457a45=>{const _0x1f1c76=_0xb42b18,_0x2e9ac1=getEnabledBots();if(_0x2e9ac1[_0x1f1c76(0x1d5)]==0x0)await sendTelegram(_0x457a45['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x2e9ac1[_0x1f1c76(0x1d5)]>0x1)_0x2e9ac1[_0x1f1c76(0x15d)]({'botID':_0x1f1c76(0x180)});let _0xb89ee4=[],_0x405ece=[];const _0x360d3f=_0x2e9ac1[_0x1f1c76(0x1d5)]%0x4==0x0||_0x2e9ac1['length']%0x4==0x3||_0x2e9ac1[_0x1f1c76(0x1d5)]%0x3==0x1?0x4:0x3;let _0x5132d5=0x0;_0x2e9ac1[_0x1f1c76(0x1c5)]((_0x490100,_0x502194)=>{const _0x11a7e4=_0x1f1c76;if(_0x502194%_0x360d3f==0x0)_0x405ece=[];_0x405ece[_0x11a7e4(0x15d)](Markup['button'][_0x11a7e4(0x20f)](_0x490100['botID']==_0x11a7e4(0x180)?_0x11a7e4(0x122):_0x11a7e4(0x16a)+_0x490100[_0x11a7e4(0x1de)],'restart_'+_0x490100[_0x11a7e4(0x1de)])),_0x502194%_0x360d3f==0x0&&(_0xb89ee4[_0x5132d5]=_0x405ece,_0x5132d5++);});const _0x56f68e=Markup[_0x1f1c76(0xd1)](_0xb89ee4);_0x457a45[_0x1f1c76(0x25d)](_0x1f1c76(0xab),_0x56f68e);}}),tgBot['action'](/restart_(.+)/,async _0x4de07e=>{const _0x1c0d1f=_0xb42b18,_0x542e8f=_0x4de07e[_0x1c0d1f(0x25e)][0x1];_0x4de07e[_0x1c0d1f(0x1ba)](),_0x542e8f==_0x1c0d1f(0x180)?config[_0x1c0d1f(0x1c5)](_0x110027=>{const _0x5504ca=_0x1c0d1f;restartBot(_0x110027[_0x5504ca(0x1de)]);}):restartBot(_0x542e8f);}),tgBot['command']('on',async _0x5831d5=>{const _0x486971=_0xb42b18,_0xa566f7=getDisabledBots();if(_0xa566f7[_0x486971(0x1d5)]==0x0)await sendTelegram(_0x5831d5[_0x486971(0x18f)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0xa566f7[_0x486971(0x1d5)]>0x1)_0xa566f7['push']({'botID':_0x486971(0x180)});let _0x504c8c=[],_0x368948=[];const _0x5f53aa=_0xa566f7[_0x486971(0x1d5)]%0x4==0x0||_0xa566f7[_0x486971(0x1d5)]%0x4==0x3||_0xa566f7['length']%0x3==0x1?0x4:0x3;let _0x11a360=0x0;_0xa566f7[_0x486971(0x1c5)]((_0x35e0d2,_0x54d437)=>{const _0x812217=_0x486971;if(_0x54d437%_0x5f53aa==0x0)_0x368948=[];_0x368948[_0x812217(0x15d)](Markup[_0x812217(0xce)][_0x812217(0x20f)](_0x35e0d2['botID']==_0x812217(0x180)?_0x812217(0x122):'Bot\x20'+_0x35e0d2[_0x812217(0x1de)],_0x812217(0x158)+_0x35e0d2[_0x812217(0x1de)])),_0x54d437%_0x5f53aa==0x0&&(_0x504c8c[_0x11a360]=_0x368948,_0x11a360++);});const _0x3c62f3=Markup['inlineKeyboard'](_0x504c8c);_0x5831d5[_0x486971(0x25d)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x3c62f3);}}),tgBot['action'](/on_(.+)/,async _0x2cde12=>{const _0x40b075=_0xb42b18,_0x6569a2=_0x2cde12[_0x40b075(0x25e)][0x1];_0x2cde12['editMessageReplyMarkup']();if(_0x6569a2=='all'){const _0x5e570e=getDisabledBots();await sendTelegram(_0x2cde12[_0x40b075(0x18f)]['id'],_0x40b075(0x293)),_0x5e570e[_0x40b075(0x1c5)](_0x7b7075=>{const _0x3c028a=_0x40b075;if(_0x7b7075[_0x3c028a(0x1de)]!=_0x3c028a(0x180))toggleBot(_0x7b7075[_0x3c028a(0x1de)],toggleStatus(_0x7b7075['botID']),_0x3c028a(0x16f));});}else await sendTelegram(_0x2cde12[_0x40b075(0x18f)]['id'],_0x40b075(0xed)+_0x6569a2),toggleBot(_0x6569a2,toggleStatus(_0x6569a2),_0x40b075(0x16f));}),tgBot['command'](_0xb42b18(0x227),async _0x52766c=>{const _0x5deced=_0xb42b18,_0x27f019=getEnabledBots();if(_0x27f019[_0x5deced(0x1d5)]==0x0)await sendTelegram(_0x52766c[_0x5deced(0x18f)]['id'],_0x5deced(0xd3));else{if(_0x27f019[_0x5deced(0x1d5)]>0x1)_0x27f019['push']({'botID':_0x5deced(0x180)});let _0x3b09d3=[],_0x474b60=[];const _0x59ba72=_0x27f019['length']%0x4==0x0||_0x27f019['length']%0x4==0x3||_0x27f019['length']%0x3==0x1?0x4:0x3;let _0x5ec717=0x0;_0x27f019[_0x5deced(0x1c5)]((_0x515df6,_0x5728ee)=>{const _0x3cb159=_0x5deced;if(_0x5728ee%_0x59ba72==0x0)_0x474b60=[];_0x474b60[_0x3cb159(0x15d)](Markup[_0x3cb159(0xce)][_0x3cb159(0x20f)](_0x515df6[_0x3cb159(0x1de)]=='all'?_0x3cb159(0x122):_0x3cb159(0x16a)+_0x515df6['botID'],'off_'+_0x515df6[_0x3cb159(0x1de)])),_0x5728ee%_0x59ba72==0x0&&(_0x3b09d3[_0x5ec717]=_0x474b60,_0x5ec717++);});const _0x1a7cd2=Markup[_0x5deced(0xd1)](_0x3b09d3);_0x52766c[_0x5deced(0x25d)](_0x5deced(0x104),_0x1a7cd2);}}),tgBot[_0xb42b18(0x1d9)](/off_(.+)/,async _0x4dd277=>{const _0x2f9c03=_0xb42b18,_0x403626=_0x4dd277['match'][0x1];_0x4dd277['editMessageReplyMarkup']();if(_0x403626==_0x2f9c03(0x180)){const _0x389378=getEnabledBots();await sendTelegram(_0x4dd277['chat']['id'],_0x2f9c03(0x1ec)),_0x389378[_0x2f9c03(0x1c5)](_0x11bf06=>{const _0x2d4bbf=_0x2f9c03;if(_0x11bf06['botID']!='all')toggleBot(_0x11bf06['botID'],toggleStatus(_0x11bf06[_0x2d4bbf(0x1de)]),_0x2d4bbf(0x16f));});}else await sendTelegram(_0x4dd277[_0x2f9c03(0x18f)]['id'],_0x2f9c03(0x123)+_0x403626),toggleBot(_0x403626,toggleStatus(_0x403626),_0x2f9c03(0x16f));}),tgBot[_0xb42b18(0x191)](_0xb42b18(0x115),async _0x5c2fef=>{const _0x1a945b=_0xb42b18,_0x142d58=getEnabledBots();if(_0x142d58['length']==0x0)await sendTelegram(_0x5c2fef[_0x1a945b(0x18f)]['id'],_0x1a945b(0xd3));else{if(_0x142d58[_0x1a945b(0x1d5)]>0x1){let _0x2cb4cb=[],_0x185380=[];const _0x380ffd=_0x142d58[_0x1a945b(0x1d5)]%0x4==0x0||_0x142d58['length']%0x4==0x3||_0x142d58[_0x1a945b(0x1d5)]%0x3==0x1?0x4:0x3;let _0x39440b=0x0;_0x142d58[_0x1a945b(0x1c5)]((_0x437fa4,_0x248639)=>{const _0x4f36a8=_0x1a945b;if(_0x248639%_0x380ffd==0x0)_0x185380=[];_0x185380[_0x4f36a8(0x15d)](Markup['button'][_0x4f36a8(0x20f)](_0x4f36a8(0x16a)+_0x437fa4['botID'],_0x4f36a8(0xee)+_0x437fa4[_0x4f36a8(0x1de)])),_0x248639%_0x380ffd==0x0&&(_0x2cb4cb[_0x39440b]=_0x185380,_0x39440b++);});const _0x40f61e=Markup[_0x1a945b(0xd1)](_0x2cb4cb);_0x5c2fef[_0x1a945b(0x25d)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x40f61e);}else{const _0x3a098f=_0x142d58[0x0][_0x1a945b(0x1de)];if(pid[_0x3a098f])pid[_0x3a098f][_0x1a945b(0x12b)]({'function':_0x1a945b(0xb2),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x242207=>{const _0x41c97e=_0xb42b18,_0x449794=_0x242207[_0x41c97e(0x25e)][0x1];_0x242207[_0x41c97e(0x1ba)]();if(pid[_0x449794])pid[_0x449794][_0x41c97e(0x12b)]({'function':_0x41c97e(0xb2),'args':null});}),tgBot['command'](_0xb42b18(0x29e),async _0x5444a2=>{const _0x7ce18e=_0xb42b18,_0x41c1a7=getEnabledBots();if(_0x41c1a7['length']==0x0)await sendTelegram(_0x5444a2[_0x7ce18e(0x18f)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x41c1a7[_0x7ce18e(0x1d5)]>0x1){let _0x2b75d2=[],_0x36cd2=[];const _0x1d19c1=_0x41c1a7[_0x7ce18e(0x1d5)]%0x4==0x0||_0x41c1a7[_0x7ce18e(0x1d5)]%0x4==0x3||_0x41c1a7['length']%0x3==0x1?0x4:0x3;let _0x185989=0x0;_0x41c1a7[_0x7ce18e(0x1c5)]((_0x4354a6,_0x37541e)=>{const _0x2cb915=_0x7ce18e;if(_0x37541e%_0x1d19c1==0x0)_0x36cd2=[];_0x36cd2['push'](Markup[_0x2cb915(0xce)]['callback']('Bot\x20'+_0x4354a6[_0x2cb915(0x1de)],_0x2cb915(0x118)+_0x4354a6['botID'])),_0x37541e%_0x1d19c1==0x0&&(_0x2b75d2[_0x185989]=_0x36cd2,_0x185989++);});const _0x97a227=Markup[_0x7ce18e(0xd1)](_0x2b75d2);_0x5444a2[_0x7ce18e(0x25d)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x97a227);}else{const _0x14a3ef=_0x41c1a7[0x0][_0x7ce18e(0x1de)];if(pid[_0x14a3ef])pid[_0x14a3ef]['send']({'function':_0x7ce18e(0xbd),'args':null});}}}),tgBot[_0xb42b18(0x1d9)](/portfolio_(.+)/,async _0x8c381=>{const _0x1da686=_0xb42b18,_0x3579f5=_0x8c381['match'][0x1];_0x8c381[_0x1da686(0x1ba)]();if(pid[_0x3579f5])pid[_0x3579f5]['send']({'function':_0x1da686(0xbd),'args':null});}),tgBot[_0xb42b18(0x191)]('logs',async _0x25faef=>{const _0x4806ba=_0xb42b18,_0x44d5a3=_0x4806ba(0x29a);await zipFiles(_0x44d5a3);const _0x48bf0d=zippath+(_0x44d5a3+_0x4806ba(0x2a6));_0x25faef['replyWithDocument']({'source':_0x48bf0d})[_0x4806ba(0xf2)](()=>{})[_0x4806ba(0x139)](_0x2add5e=>logger[_0x4806ba(0x24c)](_0x4806ba(0x137)+_0x44d5a3+_0x4806ba(0x10c),_0x2add5e));}),tgBot[_0xb42b18(0x191)](_0xb42b18(0x18c),async _0x52d969=>{const _0xd16f61=_0xb42b18,_0x46fd51='backup';await backupConfigFiles(),await zipFiles(_0x46fd51);const _0xcdfe5=zippath+(_0x46fd51+_0xd16f61(0x2a6));_0x52d969[_0xd16f61(0x1cd)]({'source':_0xcdfe5})['then'](()=>{})[_0xd16f61(0x139)](_0x45d750=>logger[_0xd16f61(0x24c)](_0xd16f61(0x137)+_0x46fd51+_0xd16f61(0x10c),_0x45d750));}),tgBot[_0xb42b18(0x191)]('update',async _0x168b34=>{const _0x223a0f=_0xb42b18;await getMessages();if(!updateAvailable)await sendTelegram(_0x168b34[_0x223a0f(0x18f)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x168b34[_0x223a0f(0x18f)]['id'],_0x223a0f(0x1ca));else{const _0x15cbf2=Markup[_0x223a0f(0xd1)]([Markup[_0x223a0f(0xce)][_0x223a0f(0x20f)](_0x223a0f(0x1dc),_0x223a0f(0x150)),Markup[_0x223a0f(0xce)][_0x223a0f(0x20f)]('No',_0x223a0f(0x278))]);_0x168b34[_0x223a0f(0x25d)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x15cbf2);}}}),tgBot['action'](/update_(.+)/,async _0x296ddd=>{const _0x105eb5=_0xb42b18,_0x5aafa4=_0x296ddd[_0x105eb5(0x25e)][0x1];_0x296ddd[_0x105eb5(0x1ba)](),_0x5aafa4==_0x105eb5(0xb4)&&(await sendTelegram(_0x296ddd[_0x105eb5(0x18f)]['id'],_0x105eb5(0x143)),updateBB(_0x105eb5(0xcb))),_0x5aafa4=='no'&&await sendTelegram(_0x296ddd['chat']['id'],_0x105eb5(0x259));}),tgBot['command']('reinstall',async _0x5404ad=>{const _0x357e89=_0xb42b18;if(!validInstallation)await sendTelegram(_0x5404ad['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x4d18ba=Markup[_0x357e89(0xd1)]([Markup[_0x357e89(0xce)][_0x357e89(0x20f)](_0x357e89(0x1dc),_0x357e89(0x2a9)),Markup[_0x357e89(0xce)][_0x357e89(0x20f)]('No',_0x357e89(0x22d))]);_0x5404ad[_0x357e89(0x25d)](_0x357e89(0x288),_0x4d18ba);}}),tgBot[_0xb42b18(0x1d9)](/reinstall_(.+)/,async _0x502346=>{const _0x53ae56=_0xb42b18,_0x4ce570=_0x502346[_0x53ae56(0x25e)][0x1];_0x502346[_0x53ae56(0x1ba)](),_0x4ce570==_0x53ae56(0xb4)&&(await sendTelegram(_0x502346[_0x53ae56(0x18f)]['id'],_0x53ae56(0xf1)),updateBB(_0x53ae56(0x26a))),_0x4ce570=='no'&&await sendTelegram(_0x502346[_0x53ae56(0x18f)]['id'],_0x53ae56(0x184));}),tgBot[_0xb42b18(0x191)](_0xb42b18(0x194),async _0x18fa8d=>{const _0x4798ed=_0xb42b18,_0x12df8c=getBotsWithMode();if(_0x12df8c[_0x4798ed(0x1d5)]==0x0)await sendTelegram(_0x18fa8d[_0x4798ed(0x18f)]['id'],_0x4798ed(0xd3));else{let _0x13890c=[],_0x451dff=[];const _0x3d5f0e=0x2;let _0x3de9ef=0x0;_0x12df8c['forEach']((_0x327c12,_0x3feb23)=>{const _0x3951b6=_0x4798ed;if(_0x3feb23%_0x3d5f0e==0x0)_0x451dff=[];_0x451dff['push'](Markup[_0x3951b6(0xce)][_0x3951b6(0x20f)](_0x3951b6(0x16a)+_0x327c12[_0x3951b6(0x1de)]+'\x20('+_0x327c12[_0x3951b6(0x205)]+')',_0x3951b6(0x264)+_0x327c12[_0x3951b6(0x1de)])),_0x3feb23%_0x3d5f0e==0x0&&(_0x13890c[_0x3de9ef]=_0x451dff,_0x3de9ef++);});const _0x3be56f=Markup[_0x4798ed(0xd1)](_0x13890c);_0x18fa8d[_0x4798ed(0x25d)](_0x4798ed(0x265),_0x3be56f);}}),tgBot[_0xb42b18(0x1d9)](/toggle_(.+)/,async _0x235a4c=>{const _0x2e81b3=_0xb42b18,_0x14381e=_0x235a4c[_0x2e81b3(0x25e)][0x1];_0x235a4c['editMessageReplyMarkup']();const _0x4cdc31=getBotsWithMode(),_0x182dbb=_0x4cdc31[_0x2e81b3(0x133)](_0x477311=>_0x477311['botID']==_0x14381e),_0x34f4b5=_0x182dbb[_0x2e81b3(0x205)]==_0x2e81b3(0x253)?_0x2e81b3(0x1aa):_0x2e81b3(0x253);await sendTelegram(_0x235a4c[_0x2e81b3(0x18f)]['id'],_0x2e81b3(0x236)+_0x14381e+_0x2e81b3(0x136)+_0x34f4b5+_0x2e81b3(0x17e)),toggleBotMode(_0x14381e);}),tgBot['command'](_0xb42b18(0x1e4),async _0x151431=>{const _0x546bf8=_0xb42b18;let _0x3d1524='';config[_0x546bf8(0x1c5)](_0x2a7c8d=>{const _0x4b8b85=_0x546bf8;_0x3d1524+=_0x4b8b85(0x16a)+_0x2a7c8d[_0x4b8b85(0x1de)]+':\x20'+_0x2a7c8d['botname']+'\x0a';}),await sendTelegram(_0x151431[_0x546bf8(0x18f)]['id'],_0x3d1524,{'parse_mode':_0x546bf8(0x1c6)});}),tgBot[_0xb42b18(0x191)](_0xb42b18(0x201),async _0x330b24=>{await sendTelegram(_0x330b24['chat']['id'],_0x1d2d81);}),process['once'](_0xb42b18(0x216),()=>tgBot[_0xb42b18(0x189)](_0xb42b18(0x216))),process['once'](_0xb42b18(0x1d1),()=>tgBot['stop'](_0xb42b18(0x1d1))),tgBot[_0xb42b18(0x29b)]();}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x3ddd09,_0x2a8dd5,_0x515faa){const _0x4fe053=_0x5c0f7b;_0x515faa={..._0x515faa,'disable_web_page_preview':!![]};try{await tgBot[_0x4fe053(0x295)][_0x4fe053(0x100)](_0x3ddd09,_0x2a8dd5,_0x515faa);}catch(_0x3e4f91){logger[_0x4fe053(0x24c)](_0x4fe053(0x280),_0x3e4f91);}}async function sendTelegramBot(_0x1f8a5e,_0x1659a5){const _0x5dac89=_0x5c0f7b;if(settings['telegramEnabled']){if(settings[_0x5dac89(0x214)]==_0x5dac89(0x180)||(_0x1659a5[_0x5dac89(0xb9)]==_0x5dac89(0x106)||_0x1659a5[_0x5dac89(0xb9)]==_0x5dac89(0x1d6)||_0x1659a5[_0x5dac89(0xb9)]=='success')&&settings[_0x5dac89(0x214)]=='alerts'||_0x1659a5[_0x5dac89(0xb9)]==_0x5dac89(0x2a4)&&settings['telegramEvents']=='orders'){if(tgBot&&settings[_0x5dac89(0x13f)]){if(_0x1659a5[_0x5dac89(0x145)])await sendTelegram(settings[_0x5dac89(0x13f)],_0x1659a5[_0x5dac89(0x14a)]+_0x5dac89(0x1b1)+_0x1659a5['event']);else await sendTelegram(settings[_0x5dac89(0x13f)],'Bot\x20'+_0x1f8a5e+_0x5dac89(0x1b1)+_0x1659a5[_0x5dac89(0x11c)]);}}}}async function sendTelegramMsg(_0x31ef8a,_0x4fa8bf=_0x5c0f7b(0x1c6)){const _0x480cb4=_0x5c0f7b;return settings[_0x480cb4(0x1e9)]&&tgBot&&settings[_0x480cb4(0x13f)]?(await sendTelegram(settings[_0x480cb4(0x13f)],_0x31ef8a,{'parse_mode':_0x4fa8bf}),!![]):![];}function getDeviceWithIp(_0x1fffef){const _0x470a10=_0x5c0f7b;return devices[_0x470a10(0x133)](_0x150783=>_0x150783['ip']===_0x1fffef);}async function temporaryAccess2FA(_0x247cf0,_0x4aae43){const _0x3aa353=_0x5c0f7b;let _0x11c45c=new Date(),_0x33e1ee=![];if(lastIpApproval){if(_0x11c45c-lastIpApproval<0x1388)_0x33e1ee=!![];}lastIpApproval=new Date();if(_0x33e1ee)return;if(tgBot&&settings['telegramChatId']){const _0x4dd261=uuidRandom();tmpStorage[_0x4dd261]={'uuid':_0x247cf0,'externalip':_0x4aae43};const _0x311644=Markup[_0x3aa353(0xd1)]([Markup[_0x3aa353(0xce)]['callback'](_0x3aa353(0x1b0),_0x3aa353(0x16c)+_0x4dd261),Markup[_0x3aa353(0xce)][_0x3aa353(0x20f)](_0x3aa353(0x221),'tempaccess_15_'+_0x4dd261),Markup[_0x3aa353(0xce)][_0x3aa353(0x20f)](_0x3aa353(0xfa),_0x3aa353(0x22e)+_0x4dd261),Markup[_0x3aa353(0xce)]['callback'](_0x3aa353(0xc4),_0x3aa353(0x24e)+_0x4dd261)]);await sendTelegram(settings['telegramChatId'],_0x3aa353(0x183)+normalizeIP(_0x4aae43)['show']+'\x20?',_0x311644),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x202183=>{const _0x32baf1=_0x3aa353,_0x5f3e41=_0x202183[_0x32baf1(0x25e)][0x1],_0x2d7e50=_0x202183[_0x32baf1(0x25e)][0x2],{uuid:_0x4c276b,externalip:_0x249738}=tmpStorage[_0x2d7e50];delete tmpStorage[_0x2d7e50],_0x202183['editMessageReplyMarkup'](),devices[_0x4c276b][_0x32baf1(0x1e0)]={'clientip':_0x249738,'timestamp':new Date()['getTime'](),'expiry':_0x5f3e41},_0x5f3e41!='reject'?(await sendTelegram(_0x202183[_0x32baf1(0x18f)]['id'],_0x32baf1(0x2a2)+_0x5f3e41+_0x32baf1(0x26f),{'parse_mode':'HTML'}),io['to'](_0x4c276b)[_0x32baf1(0x24a)](_0x32baf1(0xb8),{'access':{'allow':![],'reason':_0x32baf1(0x182),'token':null}})):(await sendTelegram(_0x202183['chat']['id'],_0x32baf1(0x229)),io['to'](_0x4c276b)[_0x32baf1(0x24a)](_0x32baf1(0xb8),{'access':{'allow':![],'reason':_0x32baf1(0x147),'token':null}}));});}}async function loginAccess2FA(_0x454346,_0x3e8e3f){const _0x3bf342=_0x5c0f7b;if(tgBot&&settings[_0x3bf342(0x13f)]){const _0x2b6499=uuidRandom();tmpStorage[_0x2b6499]={'uuid':_0x454346,'externalip':_0x3e8e3f};const _0x5a6354=Markup[_0x3bf342(0xd1)]([Markup['button'][_0x3bf342(0x20f)](_0x3bf342(0x1f3),_0x3bf342(0x1fb)+loginExpiry+'_'+_0x2b6499),Markup[_0x3bf342(0xce)][_0x3bf342(0x20f)](_0x3bf342(0xc4),_0x3bf342(0x1c4)+_0x2b6499)]);await sendTelegram(settings[_0x3bf342(0x13f)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x3e8e3f)[_0x3bf342(0x16d)]+'\x20?',_0x5a6354),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x2dd03b=>{const _0x21c5db=_0x3bf342,_0x2c7133=_0x2dd03b['match'][0x1],_0x197890=_0x2dd03b[_0x21c5db(0x25e)][0x2],{uuid:_0x138024,externalip:_0x128f62}=tmpStorage[_0x197890];delete tmpStorage[_0x197890],_0x2dd03b[_0x21c5db(0x1ba)](),devices[_0x138024]['telegram2FaApproval']={'clientip':_0x128f62,'timestamp':new Date()['getTime'](),'expiry':_0x2c7133},_0x2c7133!=_0x21c5db(0xc4)?(await sendTelegram(_0x2dd03b['chat']['id'],_0x21c5db(0x17d),{'parse_mode':'HTML'}),io['to'](_0x138024)[_0x21c5db(0x24a)](_0x21c5db(0xb8),{'access':{'allow':![],'reason':_0x21c5db(0x182),'token':null}})):(await sendTelegram(_0x2dd03b['chat']['id'],_0x21c5db(0x13c)),io['to'](_0x138024)[_0x21c5db(0x24a)]('status',{'access':{'allow':![],'reason':_0x21c5db(0x1c3),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3fe523=_0x5c0f7b;return dbConfig['get']('bots')[_0x3fe523(0x166)](_0x3fe523(0x1de))['filter']({'status':_0x3fe523(0x28e)})['value']()||[];}function getDisabledBots(){const _0x46ff81=_0x5c0f7b;return dbConfig[_0x46ff81(0x1b9)](_0x46ff81(0x285))[_0x46ff81(0x166)](_0x46ff81(0x1de))['filter']({'status':_0x46ff81(0x26e)})[_0x46ff81(0x273)]()||[];}function getBotAttributes(_0xe11296){const _0x1f02ac=_0x5c0f7b;let _0x3d752b={};const _0x2930fc=configpath+_0x1f02ac(0x19c)+_0xe11296+'-config.json',_0x138170=fs[_0x1f02ac(0xcd)](_0x2930fc);if(_0x138170){const _0x1d15e5=fs[_0x1f02ac(0x23d)](_0x2930fc);try{const _0x3bc7a4=JSON[_0x1f02ac(0x1cb)](_0x1d15e5),_0xae8b55=_0x3bc7a4?_0x3bc7a4[_0x1f02ac(0xe0)][0x0][_0x1f02ac(0x198)]:![];_0x3d752b[_0x1f02ac(0x205)]=_0xae8b55?_0x1f02ac(0x253):_0x1f02ac(0x1aa),_0x3d752b[_0x1f02ac(0x14a)]=_0x3bc7a4?_0x3bc7a4[_0x1f02ac(0xe0)][0x0]['botname']:'Bot\x20'+_0xe11296;}catch(_0x588272){_0x3d752b[_0x1f02ac(0x205)]=_0x1f02ac(0x1aa),_0x3d752b['botname']=_0x1f02ac(0x16a)+_0xe11296;}}else _0x3d752b['mode']=_0x1f02ac(0x1aa),_0x3d752b[_0x1f02ac(0x14a)]=_0x1f02ac(0x16a)+_0xe11296;return _0x3d752b;}function getBotsWithMode(){const _0x2cd19f=_0x5c0f7b,_0x57b71d=dbConfig['get'](_0x2cd19f(0x285))[_0x2cd19f(0x166)](_0x2cd19f(0x1de))['value']()||[];return _0x57b71d[_0x2cd19f(0x1c5)](_0x1b5c66=>{const _0x404e8b=_0x2cd19f;let _0x2a4832=getBotAttributes(_0x1b5c66[_0x404e8b(0x1de)]);_0x1b5c66[_0x404e8b(0x205)]=_0x2a4832[_0x404e8b(0x205)];}),_0x57b71d;}function getBotExchanges(){const _0x27e996=_0x5c0f7b;let _0x50dd39=[];const _0x414bee=dbConfig[_0x27e996(0x1b9)](_0x27e996(0x285))[_0x27e996(0x166)](_0x27e996(0x1de))['value']()||[];_0x414bee[_0x27e996(0x1c5)](_0x231853=>{const _0x49b510=_0x27e996;if(_0x231853[_0x49b510(0xb8)]==_0x49b510(0x28e)){const _0x2d9099=configpath+_0x49b510(0x19c)+_0x231853[_0x49b510(0x1de)]+_0x49b510(0x286),_0x42c453=fs[_0x49b510(0xcd)](_0x2d9099);let _0x518c8a;if(_0x42c453){const _0x16a887=fs['readFileSync'](_0x2d9099);try{const _0x266d60=JSON[_0x49b510(0x1cb)](_0x16a887);_0x518c8a=_0x266d60?_0x266d60[_0x49b510(0xe0)][0x0][_0x49b510(0x1af)]:null;}catch(_0xb5613b){}}if(_0x518c8a)_0x50dd39[_0x49b510(0x15d)](_0x518c8a);}});const _0x26a03c=[...new Set(_0x50dd39)][_0x27e996(0x14d)]();return _0x26a03c;}async function initUser(){const _0x1ed9d0=_0x5c0f7b;if(!settings['userid']){const _0x7928e0=uuidRandom();mixpanel[_0x1ed9d0(0xe9)](_0x7928e0),updateSetting(_0x1ed9d0(0x1f2),_0x7928e0);}}async function initSecure(){const _0x595fa6=_0x5c0f7b;let _0x276f75=getSecure();if(!_0x276f75[_0x595fa6(0x20b)](_0x595fa6(0x1cc))){let _0x1de288=await generateKeys();_0x276f75['publicKey']=_0x1de288[_0x595fa6(0x28f)],_0x276f75[_0x595fa6(0x277)]=_0x1de288[_0x595fa6(0x277)],_0x276f75[_0x595fa6(0x1cc)]=crypto[_0x595fa6(0xf8)](0x20)[_0x595fa6(0x109)](_0x595fa6(0x2af));;storeSecure(_0x276f75);}}function getSettings(){const _0x1b89bf=_0x5c0f7b;return dbSettings[_0x1b89bf(0x1b9)](_0x1b89bf(0x250))[_0x1b89bf(0x273)]()||{};}function _0x65bd(_0x5d533e,_0x447678){const _0x328962=_0x22ad();return _0x65bd=function(_0x55d447,_0x53315f){_0x55d447=_0x55d447-0xaa;let _0x22ad5c=_0x328962[_0x55d447];return _0x22ad5c;},_0x65bd(_0x5d533e,_0x447678);}function getSecure(){const _0x569e7e=_0x5c0f7b;return dbSecure[_0x569e7e(0x1b9)](_0x569e7e(0x1ab))[_0x569e7e(0x273)]()||{};}function getBlacklist(){const _0x3d722b=_0x5c0f7b;return dbSecure['get'](_0x3d722b(0xdb))['value']()||[];}function broadcastToBots(_0x30fa05,_0x257683){const _0x13f965=_0x5c0f7b;config[_0x13f965(0x1c5)](_0x418f40=>{const _0x35318f=_0x13f965;if(_0x418f40[_0x35318f(0xb8)]=='enabled'&&_0x418f40['live']==_0x35318f(0x217)||_0x418f40['status']==_0x35318f(0x181)&&_0x418f40[_0x35318f(0x1b8)]==_0x35318f(0x217)){if(pid[_0x418f40[_0x35318f(0x1de)]])pid[_0x418f40[_0x35318f(0x1de)]]['send']({[_0x30fa05]:_0x257683});}});}async function storeSettings(_0x2255f2,_0x4acb54=![]){const _0x2cec06=_0x5c0f7b;_0x2255f2={...settings,..._0x2255f2};if(_0x4acb54&&_0x2255f2[_0x2cec06(0x2ad)]!=_0x2cec06(0xf3)&&_0x2255f2['bbPassword']!=_0x2cec06(0x1e5)&&_0x2255f2[_0x2cec06(0x2ad)]!=''){const _0xd5aef6=decryptRSA(secure[_0x2cec06(0x277)],_0x2255f2[_0x2cec06(0x2ad)])[_0x2cec06(0x121)]('|@|')[0x0],_0x3eed8a=bcrypt[_0x2cec06(0x246)](_0xd5aef6,saltRounds);_0x2255f2={..._0x2255f2,'bbPassword':_0x3eed8a};}if(_0x4acb54&&_0x2255f2[_0x2cec06(0x1bd)]!=_0x2cec06(0xf3)&&_0x2255f2[_0x2cec06(0x1bd)]!=_0x2cec06(0x1e5)&&_0x2255f2[_0x2cec06(0x1bd)]!=''){const _0x2a0389=decryptRSA(secure[_0x2cec06(0x277)],_0x2255f2['telegramToken'])[_0x2cec06(0x121)](_0x2cec06(0x165))[0x0];_0x2255f2={..._0x2255f2,'telegramToken':_0x2a0389};}if(_0x4acb54&&_0x2255f2['marketcapApi']!='************'&&_0x2255f2['marketcapApi']!='***'&&_0x2255f2[_0x2cec06(0xb1)]!=''){const _0x2e0132=decryptRSA(secure[_0x2cec06(0x277)],_0x2255f2[_0x2cec06(0xb1)])[_0x2cec06(0x121)](_0x2cec06(0x165))[0x0];_0x2255f2={..._0x2255f2,'marketcapApi':_0x2e0132};}const _0x35a01c=_0x2255f2['telegramToken']!=_0x2cec06(0xf3)&&_0x2255f2['telegramToken']!=settings['telegramToken']||_0x2255f2[_0x2cec06(0x1d4)]!=settings[_0x2cec06(0x1d4)],_0x4ba459=_0x2255f2[_0x2cec06(0x1bd)]==''||_0x2255f2['telegramUsername']=='',_0x263e16=_0x2255f2[_0x2cec06(0xb1)]&&_0x2255f2[_0x2cec06(0xb1)]!=_0x2cec06(0xf3)&&_0x2255f2['marketcapApi']!=settings[_0x2cec06(0x1bd)];_0x35a01c&&(_0x2255f2[_0x2cec06(0x13f)]=null,_0x2255f2[_0x2cec06(0x214)]=_0x2cec06(0x180));for(const [_0x3d2adc,_0x236f6f]of Object[_0x2cec06(0x1c9)](_0x2255f2)){if(_0x3d2adc==_0x2cec06(0x1bd)&&_0x236f6f==_0x2cec06(0xf3)){_0x2255f2['telegramToken']=settings[_0x2cec06(0x1bd)];continue;};if(_0x3d2adc=='bbPassword'&&_0x236f6f==_0x2cec06(0xf3)){_0x2255f2[_0x2cec06(0x2ad)]=settings[_0x2cec06(0x2ad)];continue;};if(_0x3d2adc==_0x2cec06(0xb1)&&_0x236f6f==_0x2cec06(0xf3)){_0x2255f2[_0x2cec06(0xb1)]=settings[_0x2cec06(0xb1)];continue;};dbSettings[_0x2cec06(0x193)](_0x2cec06(0x1ef)+_0x3d2adc,_0x236f6f)['write']();}settings=_0x2255f2,io['to']('botmanager')[_0x2cec06(0x24a)](_0x2cec06(0x250),cleanSettings()),broadcastToBots('timeshift',settings[_0x2cec06(0x235)]),broadcastToBots(_0x2cec06(0x224),settings[_0x2cec06(0x224)]),broadcastToBots(_0x2cec06(0xb1),settings[_0x2cec06(0xb1)]);if(_0x35a01c&&!_0x4ba459)initTelegram();if(_0x35a01c&&_0x4ba459)disableTelegram();getAllClients()[_0x2cec06(0x1c5)](_0x3815fe=>{const _0x55ae75=_0x2cec06;getSocket(_0x3815fe['id'])[_0x55ae75(0x24a)](_0x55ae75(0xb8),{'access':{'allow':![],'reason':_0x55ae75(0x182),'token':null}});}),_0x263e16&&(await sleep(0xbb8),testMarketcapApi(_0x2255f2['marketcapApi']));}async function testMarketcapApi(_0x50d6e3){const _0x21ca6a=_0x5c0f7b,_0x1c76d7=['BCT','ETH'];try{await axios[_0x21ca6a(0x1b9)](_0x21ca6a(0x105),{'headers':{'X-CMC_PRO_API_KEY':_0x50d6e3},'params':{'symbol':_0x1c76d7[_0x21ca6a(0x109)]()}});}catch(_0x13431d){_0x13431d[_0x21ca6a(0x109)]()[_0x21ca6a(0x168)](_0x21ca6a(0xfc))?(io['to']('botmanager')[_0x21ca6a(0x24a)](_0x21ca6a(0x1e3),_0x21ca6a(0xbe)),logger[_0x21ca6a(0x26d)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x21ca6a(0x291))['emit'](_0x21ca6a(0x1e3),_0x21ca6a(0xd7)),logger['full'](_0x21ca6a(0xd7)),logger['debug'](_0x21ca6a(0x2ab),_0x13431d['toString']()+_0x21ca6a(0x251)+_0x13431d[_0x21ca6a(0xd0)]));return;}logger[_0x21ca6a(0x24c)](_0x21ca6a(0x19b));}function updateSetting(_0x53448c,_0x3f2e78){const _0x297b84=_0x5c0f7b;dbSettings[_0x297b84(0x193)](_0x297b84(0x1ef)+_0x53448c,_0x3f2e78)['write'](),settings=getSettings(),io['to'](_0x297b84(0x291))['emit'](_0x297b84(0x250),cleanSettings());}function storeSecure(_0x1426f6){const _0x1212b4=_0x5c0f7b;dbSecure[_0x1212b4(0x1b9)](_0x1212b4(0x1ab))[_0x1212b4(0x15d)](_0x1426f6)['write'](),secure=_0x1426f6;}function addBlacklist(_0x17c33d){const _0x2dcf55=_0x5c0f7b;cleanBlacklist();let _0x3a7b38;devices[_0x17c33d][_0x2dcf55(0x1e0)]?_0x3a7b38=Math[_0x2dcf55(0x16b)](devices[_0x17c33d][_0x2dcf55(0x1e0)]['expiry'],loginExpiry):_0x3a7b38=loginExpiry,dbSecure[_0x2dcf55(0x1b9)](_0x2dcf55(0xdb))[_0x2dcf55(0x15d)]({'expiry':new Date()['getTime']()+_0x3a7b38*0x3c*0x3e8,'token':devices[_0x17c33d][_0x2dcf55(0x177)][_0x2dcf55(0x1f7)]})[_0x2dcf55(0x2a5)](),blacklist=dbSecure['get']('blacklist')[_0x2dcf55(0x273)]();}function cleanBlacklist(){const _0x11ffcb=_0x5c0f7b;let _0x40eb5d=dbSecure['get'](_0x11ffcb(0xdb))[_0x11ffcb(0x16e)]()['value'](),_0x33f060=new Date()[_0x11ffcb(0x15f)]();_0x40eb5d['forEach'](_0x3e2df8=>{const _0x1f47ed=_0x11ffcb;_0x3e2df8[_0x1f47ed(0x2b2)]<_0x33f060&&dbSecure[_0x1f47ed(0x1b9)](_0x1f47ed(0xdb))['remove']({'expiry':_0x3e2df8[_0x1f47ed(0x2b2)]})['write']();});}function initStates(){const _0x42270d=_0x5c0f7b;let _0x296233=getConfiguration();_0x296233[_0x42270d(0x1c5)](_0x446d0b=>{const _0x17595e=_0x42270d;_0x446d0b[_0x17595e(0x1b8)]='stopped';}),storeConfiguration(_0x296233);}async function generateKeys(){const _0x283f6f=_0x5c0f7b,_0x5dacc8=forge[_0x283f6f(0x2aa)][_0x283f6f(0x202)][_0x283f6f(0x155)]({'bits':0x1000,'e':0x10001}),_0x2cb58a=forge[_0x283f6f(0x2aa)][_0x283f6f(0x243)](_0x5dacc8['privateKey']),_0x124be7=forge[_0x283f6f(0x2aa)]['publicKeyToPem'](_0x5dacc8[_0x283f6f(0x28f)]);return{'privateKey':_0x2cb58a,'publicKey':_0x124be7};}async function oneTimeMigration(){const _0x52fc2c=_0x5c0f7b;let _0x4d16c5=getSettings(),_0x44c2e0=![];!_0x4d16c5['hasOwnProperty'](_0x52fc2c(0x27c))&&(_0x4d16c5[_0x52fc2c(0x27c)]=0x0,_0x44c2e0=!![]);!_0x4d16c5['hasOwnProperty']('lastmsgemitted')&&(_0x4d16c5[_0x52fc2c(0x1e2)]=0x0,_0x44c2e0=!![]);!_0x4d16c5[_0x52fc2c(0x20b)](_0x52fc2c(0x29f))&&(_0x4d16c5['latestversion']='0.0.0',_0x44c2e0=!![]);!_0x4d16c5[_0x52fc2c(0x20b)]('onepagemode')&&(_0x4d16c5[_0x52fc2c(0x224)]=![],_0x44c2e0=!![]);!_0x4d16c5[_0x52fc2c(0x20b)](_0x52fc2c(0xb1))&&(_0x4d16c5['marketcapApi']='',_0x44c2e0=!![]);if(_0x44c2e0)storeSettings(_0x4d16c5);try{fs[_0x52fc2c(0x2bd)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x66b016=>{const _0x376aed=_0x52fc2c;if(!_0x66b016[_0x376aed(0x19a)]()){if(!_0x66b016[_0x376aed(0x101)][_0x376aed(0xcc)](_0x376aed(0xae)))fs['unlinkSync'](configbackuppath+_0x66b016[_0x376aed(0x101)]);}else fs[_0x376aed(0x29d)](configbackuppath+_0x66b016[_0x376aed(0x101)],{'recursive':!![]});});}catch(_0x39754e){logger[_0x52fc2c(0x24c)](_0x52fc2c(0x163),_0x39754e);}}function storeConfiguration(_0x5a19b9){const _0x462959=_0x5c0f7b;dbConfig['get']('bots')[_0x462959(0x25f)]()[_0x462959(0x2a5)](),dbConfig[_0x462959(0x1b9)](_0x462959(0x285))['push'](..._0x5a19b9)[_0x462959(0x2a5)](),config=_0x5a19b9;}async function resetPassword(){const _0x346fa4=_0x5c0f7b;if(tgBot&&settings['telegramChatId']){const _0x3fa63f=Markup[_0x346fa4(0xd1)]([Markup[_0x346fa4(0xce)]['callback'](_0x346fa4(0xb4),_0x346fa4(0x188)),Markup[_0x346fa4(0xce)][_0x346fa4(0x20f)]('no','resetpw_no')]);await sendTelegram(settings[_0x346fa4(0x13f)],_0x346fa4(0x212),_0x3fa63f),tgBot[_0x346fa4(0x1d9)](/resetpw_(.+)/,async _0xe43bb0=>{const _0x4eb18f=_0x346fa4,_0x405a0c=_0xe43bb0[_0x4eb18f(0x25e)][0x1];_0xe43bb0['editMessageReplyMarkup']();if(_0x405a0c!='no'){const _0x11c9ce=0xf,_0x33b269=_0x4eb18f(0x18e),_0x4633d9=Array[_0x4eb18f(0x2a7)](crypto[_0x4eb18f(0x1c2)](new Uint32Array(_0x11c9ce)))[_0x4eb18f(0x1ed)](_0x125691=>_0x33b269[_0x125691%_0x33b269[_0x4eb18f(0x1d5)]])[_0x4eb18f(0x1a1)](''),_0x1058c4=bcrypt[_0x4eb18f(0x246)](_0x4633d9,saltRounds);storeSettings({'bbPassword':_0x1058c4}),await sendTelegram(_0xe43bb0[_0x4eb18f(0x18f)]['id'],_0x4eb18f(0xc0)+_0x4633d9,{'parse_mode':'HTML'});}else await sendTelegram(_0xe43bb0[_0x4eb18f(0x18f)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x339a15,_0x5aa869){const _0x3222fd=_0x5c0f7b;io['to'](_0x3222fd(0x291))[_0x3222fd(0x24a)](_0x3222fd(0x1e3),_0x3222fd(0xe6),_0x3222fd(0x2bf));if(tgBot&&settings[_0x3222fd(0x13f)]){const _0xa3e0ed=uuidRandom();tmpStorage[_0xa3e0ed]={'path':_0x339a15,'filename':_0x5aa869};const _0x53bb98=Markup['inlineKeyboard']([Markup[_0x3222fd(0xce)]['callback'](_0x3222fd(0xb4),_0x3222fd(0x142)+_0xa3e0ed),Markup[_0x3222fd(0xce)]['callback']('no',_0x3222fd(0xbf)+_0xa3e0ed)]);await sendTelegram(settings[_0x3222fd(0x13f)],_0x3222fd(0x276),_0x53bb98),tgBot[_0x3222fd(0x1d9)](/restore_(.+)_(.+)/,async _0x391c05=>{const _0x16089a=_0x3222fd,_0x41e3fd=_0x391c05[_0x16089a(0x25e)][0x1],_0x4d5647=_0x391c05[_0x16089a(0x25e)][0x2],{path:_0x37ad32,filename:_0x15bdf0}=tmpStorage[_0x4d5647];delete tmpStorage[_0x4d5647],_0x391c05[_0x16089a(0x1ba)](),_0x41e3fd==_0x16089a(0xb4)?(logger['debug']('Restore\x20process\x20confirmed'),await sendTelegram(_0x391c05[_0x16089a(0x18f)]['id'],_0x16089a(0x1eb),{'parse_mode':_0x16089a(0x1c6)}),unzipFile(_0x37ad32,_0x15bdf0)):(logger[_0x16089a(0x24c)]('Restore\x20process\x20aborted'),await sendTelegram(_0x391c05['chat']['id'],_0x16089a(0x117)));});}}function getServerTime(){const _0xed20c5=_0x5c0f7b,_0x173f8a=new Date();return _0x173f8a[_0xed20c5(0x131)]()+'/'+(_0x173f8a[_0xed20c5(0x1da)]()+0x1)[_0xed20c5(0x109)]()['padStart'](0x2,'0')+'/'+_0x173f8a[_0xed20c5(0x2b5)]()[_0xed20c5(0x109)]()[_0xed20c5(0x231)](0x2,'0')+'\x20'+_0x173f8a[_0xed20c5(0x261)]()[_0xed20c5(0x109)]()[_0xed20c5(0x231)](0x2,'0')+':'+_0x173f8a[_0xed20c5(0x258)]()[_0xed20c5(0x109)]()[_0xed20c5(0x231)](0x2,'0')+':'+_0x173f8a[_0xed20c5(0x17c)]()['toString']()[_0xed20c5(0x231)](0x2,'0');}function getTimeStamp(){const _0x5a0d06=_0x5c0f7b,_0x366dc7=shiftedTime();return _0x366dc7['getFullYear']()+'/'+(_0x366dc7[_0x5a0d06(0x1da)]()+0x1)['toString']()[_0x5a0d06(0x231)](0x2,'0')+'/'+_0x366dc7[_0x5a0d06(0x2b5)]()[_0x5a0d06(0x109)]()['padStart'](0x2,'0')+'\x20'+_0x366dc7[_0x5a0d06(0x261)]()[_0x5a0d06(0x109)]()['padStart'](0x2,'0')+':'+_0x366dc7[_0x5a0d06(0x258)]()[_0x5a0d06(0x109)]()['padStart'](0x2,'0')+':'+_0x366dc7[_0x5a0d06(0x17c)]()[_0x5a0d06(0x109)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x5db29f=_0x5c0f7b,_0x2184c1=shiftedTime();return _0x2184c1[_0x5db29f(0x131)]()+(_0x2184c1['getMonth']()+0x1)[_0x5db29f(0x109)]()['padStart'](0x2,'0')+_0x2184c1[_0x5db29f(0x2b5)]()[_0x5db29f(0x109)]()[_0x5db29f(0x231)](0x2,'0')+'-'+_0x2184c1[_0x5db29f(0x261)]()['toString']()[_0x5db29f(0x231)](0x2,'0')+_0x2184c1[_0x5db29f(0x258)]()['toString']()['padStart'](0x2,'0')+_0x2184c1[_0x5db29f(0x17c)]()[_0x5db29f(0x109)]()[_0x5db29f(0x231)](0x2,'0');}function shiftedTime(){const _0x3ed032=_0x5c0f7b,_0x475164=new Date();let _0x16f067=_0x475164;if(settings[_0x3ed032(0x235)]&&settings[_0x3ed032(0x235)]!==0x0)_0x16f067=fns['add'](_0x475164,{'hours':settings[_0x3ed032(0x235)]});return _0x16f067;}async function startScheduler(){const _0x533bd8=_0x5c0f7b,_0x57490e=new Date()[_0x533bd8(0x19e)](),_0x29440d=shiftedTime()[_0x533bd8(0x261)]();_0x29440d==0x4&&backupConfigFiles(),_0x29440d==0x0&&(rotateLogFiles(),logger[_0x533bd8(0x24c)](_0x533bd8(0x15c)),logger[_0x533bd8(0x24c)]('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0x533bd8(0x1a5)?_0x533bd8(0xcf):'')),logger[_0x533bd8(0x24c)](_0x533bd8(0x15c))),_0x57490e%0x6==0x0&&triggerAnalytics(),_0x57490e%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x162b65){const _0x5f41fc=_0x5c0f7b;logger[_0x5f41fc(0x24c)](_0x5f41fc(0xc7)+_0x162b65);const _0x157711=getBotsWithMode();_0x157711['length']>0x0?confirmRestore(configbackuppath,_0x162b65):unzipFile(configbackuppath,_0x162b65);}async function getBackupFiles(_0x47d17d=null){const _0x1d1af9=_0x5c0f7b;let _0x326320=[],_0x4b6c92=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x4b6c92[_0x1d1af9(0x14d)]((_0x138580,_0x1a78f2)=>_0x138580[_0x1d1af9(0x101)]<_0x1a78f2['name']?0x1:_0x1a78f2['name']<_0x138580[_0x1d1af9(0x101)]?-0x1:0x0),_0x4b6c92[_0x1d1af9(0x1c5)](_0x3bc997=>{const _0x1546b1=_0x1d1af9;if(!_0x3bc997['isDirectory']()&&_0x3bc997['name'][_0x1546b1(0xcc)](_0x1546b1(0xae))&&_0x3bc997['name']['endsWith']('.zip')){const _0x667851=formatDate(fs[_0x1546b1(0x239)](configbackuppath+_0x3bc997[_0x1546b1(0x101)])[_0x1546b1(0x241)]);_0x326320[_0x1546b1(0x15d)]({'name':_0x3bc997['name'],'mtime':_0x667851});}});if(_0x47d17d)io['to'](_0x47d17d)[_0x1d1af9(0x24a)](_0x1d1af9(0x1ce),_0x326320);else return _0x326320;}async function backupConfigFiles(){const _0xfe6622=_0x5c0f7b;await zipFiles(_0xfe6622(0x196));const _0x3a68a4=getCleanTimeStamp();fs[_0xfe6622(0xfb)](zippath+_0xfe6622(0x210),configbackuppath+(_0xfe6622(0xae)+_0x3a68a4+_0xfe6622(0x2a6)));let _0x5bf01d=fs[_0xfe6622(0x2bd)](configbackuppath,{'withFileTypes':!![]});_0x5bf01d['sort']((_0xb6791e,_0x18ca17)=>_0xb6791e[_0xfe6622(0x101)]<_0x18ca17[_0xfe6622(0x101)]?0x1:_0x18ca17['name']<_0xb6791e['name']?-0x1:0x0),_0x5bf01d[_0xfe6622(0x1d5)]>maxBackups&&fs[_0xfe6622(0xe8)](configbackuppath+_0x5bf01d[_0x5bf01d[_0xfe6622(0x1d5)]-0x1][_0xfe6622(0x101)]);}function rotateLogFiles(){const _0x2cd314=_0x5c0f7b,_0x3969e6=fs['statSync'](logspath+_0x2cd314(0x25a)),_0xf9949=_0x3969e6['size']/0x400;if(_0xf9949>0x64){let _0x17d2c4=fs[_0x2cd314(0x2bd)](logspath,{'withFileTypes':!![]});_0x17d2c4[_0x2cd314(0x14d)]((_0x189fee,_0x54f290)=>_0x189fee[_0x2cd314(0x101)]<_0x54f290['name']?0x1:_0x54f290[_0x2cd314(0x101)]<_0x189fee[_0x2cd314(0x101)]?-0x1:0x0),_0x17d2c4[_0x2cd314(0x1c5)](_0x2e1c22=>{const _0x3bfa27=_0x2cd314;if(_0x2e1c22[_0x3bfa27(0x101)]==_0x3bfa27(0x2ac))fs[_0x3bfa27(0xfb)](logspath+_0x2e1c22[_0x3bfa27(0x101)],logspath+'output-003.log');if(_0x2e1c22['name']=='output-001.log')fs[_0x3bfa27(0xfb)](logspath+_0x2e1c22['name'],logspath+_0x3bfa27(0x2ac));_0x2e1c22[_0x3bfa27(0x101)]=='output-000.log'&&(fs['copyFileSync'](logspath+_0x2e1c22[_0x3bfa27(0x101)],logspath+_0x3bfa27(0xbc)),fs[_0x3bfa27(0x1c1)](logspath+_0x2e1c22[_0x3bfa27(0x101)],''));});}}async function zipFiles(_0x22b108){const _0x50c7d9=_0x5c0f7b;let _0x1249c2;if(_0x22b108=='logs')_0x1249c2=logspath;if(_0x22b108=='backup')_0x1249c2=configpath;if(_0x22b108=='backup-full')_0x1249c2=configpath;let _0x1bf216=fs[_0x50c7d9(0x2bd)](_0x1249c2,{'withFileTypes':!![]});const _0xe83860=new JSZip();_0x1bf216['forEach'](_0xeda15e=>{const _0x24aff4=_0x50c7d9;if(!_0xeda15e[_0x24aff4(0x19a)]()){let _0x2559cc=fs['readFileSync'](_0x1249c2+_0xeda15e[_0x24aff4(0x101)]);if(_0x22b108==_0x24aff4(0x18c)){const _0x2eb83b=/^bot-[0-9]{3}-config.json$/,_0x3f907c=_0x2eb83b[_0x24aff4(0x1b4)](_0xeda15e[_0x24aff4(0x101)]);if(_0x3f907c){const _0x3c7ef3=JSON[_0x24aff4(0x1cb)](_0x2559cc);if(_0x3c7ef3[_0x24aff4(0xe0)][0x0]){_0x3c7ef3[_0x24aff4(0xe0)][0x0]['apiKey']=_0x24aff4(0x1e5),_0x3c7ef3[_0x24aff4(0xe0)][0x0][_0x24aff4(0xb5)]=_0x24aff4(0x1e5);if(_0x3c7ef3[_0x24aff4(0xe0)][0x0]['apiPassword'])_0x3c7ef3['bot'][0x0][_0x24aff4(0x20a)]=_0x24aff4(0x1e5);}_0x2559cc=JSON[_0x24aff4(0x1fc)](_0x3c7ef3,null,0x2);}if(_0xeda15e[_0x24aff4(0x101)]==_0x24aff4(0x1be)){const _0x5d9bae=JSON[_0x24aff4(0x1cb)](_0x2559cc);if(_0x5d9bae[_0x24aff4(0x250)][_0x24aff4(0x138)])_0x5d9bae['settings']['loginRequired']=![];if(_0x5d9bae[_0x24aff4(0x250)][_0x24aff4(0x2ad)])_0x5d9bae[_0x24aff4(0x250)]['bbPassword']=_0x24aff4(0x1e5);if(_0x5d9bae[_0x24aff4(0x250)][_0x24aff4(0x1bd)])_0x5d9bae[_0x24aff4(0x250)][_0x24aff4(0x1bd)]=_0x24aff4(0x1e5);if(_0x5d9bae['settings'][_0x24aff4(0x13f)])_0x5d9bae[_0x24aff4(0x250)][_0x24aff4(0x13f)]=null;if(_0x5d9bae[_0x24aff4(0x250)]['marketcapApi'])_0x5d9bae[_0x24aff4(0x250)][_0x24aff4(0xb1)]='***';_0x2559cc=JSON[_0x24aff4(0x1fc)](_0x5d9bae,null,0x2);}if(_0xeda15e[_0x24aff4(0x101)]!='bb-secure.json')_0xe83860['file'](_0xeda15e[_0x24aff4(0x101)],_0x2559cc);}else _0xe83860[_0x24aff4(0x266)](_0xeda15e[_0x24aff4(0x101)],_0x2559cc);}});const _0xdf46d3=await _0xe83860[_0x50c7d9(0x18d)]({'type':_0x50c7d9(0xdd),'base64':![],'compression':_0x50c7d9(0x27d)});fs[_0x50c7d9(0x1c1)](zippath+(_0x22b108+_0x50c7d9(0x2a6)),_0xdf46d3,'binary');}async function unzipFile(_0x4816d4,_0x198251){const _0x43e1e0=_0x5c0f7b;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x43e1e0(0x1c5)](_0x1f3d12=>{const _0x4aa03b=_0x43e1e0;if(!_0x1f3d12[_0x4aa03b(0x19a)]())fs[_0x4aa03b(0x29d)](configpath+_0x1f3d12['name']);});const _0x42c2de=fs['readFileSync'](_0x4816d4+_0x198251,_0x43e1e0(0x19d)),_0x2dca56=await JSZip['loadAsync'](_0x42c2de,{'base64':![],'checkCRC32':!![]});for(const _0x235b33 of Object[_0x43e1e0(0x1f1)](_0x2dca56['files'])){const _0x2714d9=_0x2dca56['files'][_0x235b33],_0x1dc910=await _0x2714d9[_0x43e1e0(0x296)](_0x43e1e0(0xdd));fs[_0x43e1e0(0x1c1)](configpath+_0x2714d9[_0x43e1e0(0x101)],_0x1dc910);}fs[_0x43e1e0(0x2bd)](temppath,{'withFileTypes':!![]})['forEach'](_0x2659c6=>{const _0x38368b=_0x43e1e0;if(!_0x2659c6[_0x38368b(0x19a)]())fs['rmSync'](temppath+_0x2659c6[_0x38368b(0x101)]);}),logger['debug'](_0x43e1e0(0x25c)),process['send']({'restore':!![]},_0xccbc78=>{});}async function getPublicIp(){const _0x44c1c3=_0x5c0f7b;try{const _0x23e263=await axios['get'](_0x44c1c3(0x1f9));publicip=_0x23e263[_0x44c1c3(0xe7)]['ip'];}catch(_0x2be57b){}}async function triggerAnalytics(){const _0x2a7685=_0x5c0f7b;if(!publicip)await getPublicIp();const _0x451c13=getBotsWithMode();let _0x3b9c4e=0x0;_0x451c13[_0x2a7685(0x1c5)](_0x280c00=>{const _0x242458=_0x2a7685;if(_0x280c00[_0x242458(0xb8)]===_0x242458(0x28e))_0x3b9c4e++;});const _0x1ac5bd=getBotExchanges();mixpanel[_0x2a7685(0x21c)]('Server',{'distinct_id':settings[_0x2a7685(0x1f2)],'ip':publicip,'version':serverversion,'numbots':_0x451c13[_0x2a7685(0x1d5)],'numbotsenabled':_0x3b9c4e,'exchanges':_0x1ac5bd,'environment':environment});}async function getMessages(){const _0x19db5c=_0x5c0f7b,_0x287b03=_0x19db5c(0x211),_0x19e5d9=new GraphQLClient(_0x287b03),_0x149ac0={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x571bd=serverversion[_0x19db5c(0x121)]('.'),_0x5b1bdc=_0x571bd[0x0]+'.'+_0x571bd[0x1],_0x4163fe=Math[_0x19db5c(0x22c)](settings['lastmsgtelegram'],settings['lastmsgemitted']),_0x67aae9={'last':parseInt(_0x4163fe),'bbm':_0x5b1bdc},_0x5ca8c8=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2820c6;try{_0x2820c6=await _0x19e5d9[_0x19db5c(0x186)](_0x5ca8c8,_0x67aae9,_0x149ac0);}catch(_0xd9f5c3){}if(_0x2820c6&&_0x2820c6[_0x19db5c(0x204)]){let _0x2c9719=settings['lastmsgtelegram'];newMessages=[];for(const _0x47bbe0 of _0x2820c6[_0x19db5c(0x204)]){newMessages['push'](_0x47bbe0);let _0x164cab=![];_0x47bbe0[_0x19db5c(0x124)]&&(updateSetting('latestversion',_0x47bbe0['bbvNew']),_0x164cab=isNewerVersion(serverversion,_0x47bbe0[_0x19db5c(0x124)])||serverversion==_0x47bbe0[_0x19db5c(0x124)]);if(!_0x164cab&&_0x47bbe0[_0x19db5c(0xd5)]>_0x2c9719){if(_0x47bbe0['bbvReceive']===_0x19db5c(0x144)||serverversion[_0x19db5c(0xcc)](_0x47bbe0[_0x19db5c(0x107)])){let _0x2ee0f9=''+_0x47bbe0[_0x19db5c(0x209)]+'\x0a\x0a'+_0x47bbe0[_0x19db5c(0xff)];const _0x729465=await sendTelegramMsg(toTelegramMarkdown(_0x2ee0f9),_0x19db5c(0x222));if(_0x729465)_0x2c9719=_0x47bbe0[_0x19db5c(0xd5)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x19db5c(0x27c),_0x2c9719),emitMessages();}}function emitMessages(){const _0x1f617a=_0x5c0f7b,_0x177482=settings[_0x1f617a(0x1e2)];let _0x1b9490=[];newMessages[_0x1f617a(0x1c5)](_0x2b3c66=>{const _0x410b63=_0x1f617a;_0x2b3c66[_0x410b63(0xd5)]>_0x177482&&_0x1b9490[_0x410b63(0x15d)](_0x2b3c66);}),_0x1b9490[_0x1f617a(0x1d5)]>0x0&&getAllClients()['forEach'](_0x31acb3=>{const _0x2e63b5=_0x1f617a;getSocket(_0x31acb3['id'])[_0x2e63b5(0x24a)](_0x2e63b5(0xff),_0x1b9490);});}function confirmMessage(_0x174590){const _0x5cc501=_0x5c0f7b;updateSetting(_0x5cc501(0x1e2),Number(_0x174590));}function isNewerVersion(_0x4279b5,_0x4d76c3){const _0x33ae9d=_0x5c0f7b,_0x481085=_0x4d76c3[_0x33ae9d(0x121)]('.'),_0x2e1182=_0x4279b5['split']('.');for(var _0x734349=0x0;_0x734349<_0x2e1182['length'];_0x734349++){const _0x319ef6=~~_0x2e1182[_0x734349],_0x51f292=~~_0x481085[_0x734349];if(_0x319ef6>_0x51f292)return!![];if(_0x319ef6<_0x51f292)return![];}return![];}function toTelegramMarkdown(_0x53db96){const _0x37aaa0=_0x5c0f7b,_0x3cafe6=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2f2c68=/\*{2}(.+?)\*{2}/gim;return _0x53db96=_0x53db96[_0x37aaa0(0x1e1)](_0x3cafe6,'$1_$2_$3')[_0x37aaa0(0x1e1)](_0x2f2c68,_0x37aaa0(0x1b5)),_0x53db96;}async function validateConfigFile(){const _0x525b92=_0x5c0f7b,_0x2d66ea=dbConfig[_0x525b92(0x1b9)](_0x525b92(0x285))[_0x525b92(0x166)](_0x525b92(0x1de))[_0x525b92(0x273)]()||[];if(_0x2d66ea['length']==0x0){let _0x3bd29b=0x0,_0xe6e52e=[];const _0x47de4b=/^bot-([0-9]{3})-config.json$/,_0x2e886c=fs['readdirSync'](configpath);_0x2e886c[_0x525b92(0x1c5)](_0x10b0fd=>{const _0x2fc037=_0x525b92,_0x4ff9ce=_0x47de4b['exec'](_0x10b0fd);if(_0x4ff9ce){const _0x12789d=_0x4ff9ce[0x1];let _0x474601=getBotAttributes(_0x12789d);_0xe6e52e[_0x2fc037(0x15d)]({'botID':_0x12789d,'botname':_0x474601[_0x2fc037(0x14a)],'status':_0x2fc037(0x26e),'live':_0x2fc037(0x16f)}),_0x3bd29b++;}}),_0x3bd29b!=0x0&&(dbConfig[_0x525b92(0x1b9)](_0x525b92(0x285))[_0x525b92(0x269)](_0xe6e52e)[_0x525b92(0x2a5)](),config=_0xe6e52e,restoredConfigFile=_0x3bd29b);}}async function restoreConfigNotify(_0x2e14a9){const _0x3dc4e9=_0x5c0f7b;let _0x1052a1;if(restoredConfigFile==0x1)_0x1052a1='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x1052a1=_0x3dc4e9(0x1a8);if(_0x2e14a9)io['to'](_0x3dc4e9(0x291))[_0x3dc4e9(0x24a)]('notification',_0x1052a1);else{logger[_0x3dc4e9(0xf0)](_0x3dc4e9(0x219)),logger['simple'](_0x1052a1),logger[_0x3dc4e9(0xf0)](_0x3dc4e9(0x219)),logger[_0x3dc4e9(0xf0)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x3dc4e9(0x214)]!=_0x3dc4e9(0x297))await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x1052a1);}}function decryptRSA(_0x2d6a53,_0x5330a3){const _0x3d3320=_0x5c0f7b,_0xa26c3d=forge[_0x3d3320(0x2aa)][_0x3d3320(0x1cf)](_0x2d6a53),_0x47dae7=_0xa26c3d[_0x3d3320(0x12e)](forge[_0x3d3320(0x1a3)]['decode64'](_0x5330a3),_0x3d3320(0xe1),{'md':forge['md'][_0x3d3320(0x11e)][_0x3d3320(0x120)](),'mgf1':{'md':forge['md'][_0x3d3320(0x11e)]['create']()}});return _0x47dae7;}function validateCredentials(_0x3e9120,_0x41fcd1){const _0x519b34=_0x5c0f7b;if(_0x3e9120[_0x519b34(0x298)]==settings[_0x519b34(0x270)]&&bcrypt[_0x519b34(0x244)](_0x3e9120[_0x519b34(0x28b)],settings['bbPassword'])){if(settings[_0x519b34(0x262)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x301982=generateLoginToken(_0x41fcd1);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x301982};}}else return{'allow':![],'reason':_0x519b34(0xf6),'token':null};}function refreshToken(_0x47bed5){const _0x43e8aa=_0x5c0f7b,_0x4f1c56=generateLoginToken(_0x47bed5);return{'allow':!![],'reason':_0x43e8aa(0x10b),'token':_0x4f1c56};}function validateAccess(_0x4f53b6,_0x1c1a51,_0x512919){const _0x141802=_0x5c0f7b,_0x27f716=_0x512919?_0x512919:devices[_0x1c1a51]['ip'];let _0x5e8242;const _0x178d8b=_0x5bde8a=>{const _0x32d97e=_0x65bd;if(settings['loginRequired']){if(settings[_0x32d97e(0x262)]){if(telegram2FaApproved(_0x1c1a51)){const _0x4fa8e2=generateLoginToken(_0x1c1a51);return{'allow':!![],'reason':_0x32d97e(0xc9),'token':_0x4fa8e2};}else return{'allow':![],'reason':_0x32d97e(0x23e),'token':null};}else return _0x5e8242=validToken(_0x5bde8a,_0x1c1a51),_0x5e8242['hasOwnProperty'](_0x32d97e(0x2bf))?{'allow':!![],'reason':_0x32d97e(0x207),'token':_0x5bde8a}:{'allow':![],'reason':_0x32d97e(0x23e),'token':null};}else return{'allow':!![],'reason':_0x32d97e(0x102),'token':null};};if(settings['whitelistEnabled']){let _0x441bf0=[...settings[_0x141802(0x119)],_0x141802(0xef),_0x141802(0x11d),_0x141802(0x125)];if(_0x441bf0[_0x141802(0x168)](_0x27f716))return _0x178d8b(_0x4f53b6);else{_0x5e8242=validToken(_0x4f53b6,_0x1c1a51);if(_0x5e8242[_0x141802(0x20b)]('success'))return _0x178d8b(_0x4f53b6);else{if(telegramIpApproved(_0x1c1a51)){const _0x17908a=generateToken(_0x1c1a51);return _0x5e8242=_0x178d8b(_0x4f53b6),_0x5e8242[_0x141802(0x1e6)]?{'allow':!![],'reason':_0x141802(0x275),'token':_0x17908a}:_0x5e8242;}else return settings[_0x141802(0x113)]?{'allow':![],'reason':_0x141802(0x268),'token':null}:{'allow':![],'reason':_0x141802(0x256),'token':null};}}}else return _0x178d8b(_0x4f53b6);}function timelyDecrypt(_0x3d0205,_0x42a0ab,_0x187ca2='@'){const _0xd49307=_0x5c0f7b;if(_0x3d0205)try{const _0x38fa15=decryptRSA(secure[_0xd49307(0x277)],_0x3d0205),_0x58c683=_0x38fa15['split'](_0x187ca2)[0x0],_0x25f0e3=_0x38fa15[_0xd49307(0x121)](_0x187ca2)[0x1],_0x46a938=new Date()[_0xd49307(0x15f)]();if(_0x42a0ab){if(_0x46a938-_0x25f0e3<maxSecretAge*0x3e8)return _0x58c683;else return![];}else return _0x58c683;}catch(_0xd8d9f1){return![];}else return![];}const validToken=(_0x10311f,_0x2b7ee6)=>{const _0x3b9480=_0x5c0f7b,_0x4a1b50=devices[_0x2b7ee6]['ip'];if(!_0x10311f)return{'error':_0x3b9480(0x228)};for(let _0x66904f of blacklist){if(_0x66904f[_0x3b9480(0x1f7)]==_0x10311f)return{'error':_0x3b9480(0x21d)};}let _0x38d34f;try{_0x38d34f=jwt[_0x3b9480(0x1a7)](_0x10311f,secure[_0x3b9480(0x1cc)]+_0x2b7ee6);}catch{return{'error':_0x3b9480(0x238)};}if(!_0x38d34f[_0x3b9480(0x20b)](_0x3b9480(0x27f))&&!_0x38d34f[_0x3b9480(0x20b)](_0x3b9480(0x298))||!_0x38d34f[_0x3b9480(0x20b)]('exp'))return{'error':_0x3b9480(0x287)};if(!_0x38d34f[_0x3b9480(0x20b)](_0x3b9480(0x298))&&_0x38d34f['hasOwnProperty']('clientip')){const {clientip:_0x5523f0}=_0x38d34f;return _0x4a1b50==_0x5523f0?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x38d34f['hasOwnProperty'](_0x3b9480(0x298))&&_0x38d34f[_0x3b9480(0x20b)](_0x3b9480(0x27f))){const {username:_0x6f6634,clientip:_0x285178}=_0x38d34f;return settings[_0x3b9480(0x270)]==_0x6f6634&&_0x4a1b50==_0x285178?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x3b9480(0x134)};}}},generateLoginToken=_0x17ef26=>{const _0x3dd207=_0x5c0f7b;if(_0x17ef26){const _0x5a7746=devices[_0x17ef26]['ip'];return jwt[_0x3dd207(0x12c)]({'username':settings['bbUsername'],'clientip':_0x5a7746},secure['secret']+_0x17ef26,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x560d91=>{const _0xefba7d=_0x5c0f7b;if(_0x560d91){const _0x5b09b3=devices[_0x560d91]['ip'];return jwt[_0xefba7d(0x12c)]({'clientip':_0x5b09b3},secure['secret']+_0x560d91,{'expiresIn':devices[_0x560d91][_0xefba7d(0x1e0)][_0xefba7d(0x2b2)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x13e909=>{const _0x45724c=_0x5c0f7b;let _0x3d382d=![];return devices[_0x13e909][_0x45724c(0x1e0)]&&devices[_0x13e909][_0x45724c(0x1e0)][_0x45724c(0x2b2)]!=_0x45724c(0xc4)&&(_0x3d382d=devices[_0x13e909][_0x45724c(0x1e0)][_0x45724c(0x27f)]==devices[_0x13e909]['ip']&&new Date()[_0x45724c(0x15f)]()-devices[_0x13e909]['telegramIpApproval'][_0x45724c(0x1db)]<devices[_0x13e909][_0x45724c(0x1e0)][_0x45724c(0x2b2)]*0x3c*0x3e8),_0x3d382d;},telegram2FaApproved=_0x5601f3=>{const _0x3a425b=_0x5c0f7b;let _0x5a8c09=![];return devices[_0x5601f3]['telegram2FaApproval']&&devices[_0x5601f3][_0x3a425b(0x260)][_0x3a425b(0x2b2)]!=_0x3a425b(0xc4)&&(_0x5a8c09=devices[_0x5601f3][_0x3a425b(0x260)][_0x3a425b(0x27f)]==devices[_0x5601f3]['ip']&&new Date()[_0x3a425b(0x15f)]()-devices[_0x5601f3][_0x3a425b(0x260)][_0x3a425b(0x1db)]<devices[_0x5601f3]['telegram2FaApproval'][_0x3a425b(0x2b2)]*0x3c*0x3e8),_0x5a8c09;},normalizeIP=_0x77038d=>{const _0x846945=_0x5c0f7b;let _0x509fc3=null,_0x16a920=null;if(ipaddr[_0x846945(0x1ff)](_0x77038d)){const _0x1924f9=ipaddr[_0x846945(0x1cb)](_0x77038d);_0x1924f9[_0x846945(0x13b)]()==='ipv6'?(_0x1924f9[_0x846945(0x23c)]()&&(_0x509fc3=_0x1924f9[_0x846945(0xea)]()[_0x846945(0x109)]()),_0x16a920=_0x1924f9['toString']()):(_0x509fc3=_0x1924f9[_0x846945(0x109)](),_0x16a920=_0x1924f9[_0x846945(0x179)]()[_0x846945(0x109)]());}return{'show':_0x509fc3?_0x509fc3:_0x16a920,'store':_0x16a920};};function formatDate(_0x5b9f43){const _0x4e43b9=_0x5c0f7b;return _0x5b9f43[_0x4e43b9(0x131)]()+'/'+(_0x5b9f43[_0x4e43b9(0x1da)]()+0x1)['toString']()[_0x4e43b9(0x231)](0x2,'0')+'/'+_0x5b9f43[_0x4e43b9(0x2b5)]()['toString']()[_0x4e43b9(0x231)](0x2,'0')+'\x20'+_0x5b9f43['getHours']()[_0x4e43b9(0x109)]()[_0x4e43b9(0x231)](0x2,'0')+':'+_0x5b9f43[_0x4e43b9(0x258)]()[_0x4e43b9(0x109)]()[_0x4e43b9(0x231)](0x2,'0')+':'+_0x5b9f43[_0x4e43b9(0x17c)]()[_0x4e43b9(0x109)]()[_0x4e43b9(0x231)](0x2,'0');}function sleep(_0x398bbf){return new Promise(_0x4d8308=>setTimeout(_0x4d8308,_0x398bbf));}