const _0x54c4c4=_0x1465;(function(_0x3fa2e8,_0xab9d9f){const _0x926d4d=_0x1465,_0x248ac5=_0x3fa2e8();while(!![]){try{const _0x5e0724=-parseInt(_0x926d4d(0x1a3))/0x1+-parseInt(_0x926d4d(0x1c0))/0x2*(-parseInt(_0x926d4d(0x278))/0x3)+parseInt(_0x926d4d(0x245))/0x4*(-parseInt(_0x926d4d(0x254))/0x5)+parseInt(_0x926d4d(0x18d))/0x6*(-parseInt(_0x926d4d(0xaa))/0x7)+-parseInt(_0x926d4d(0x204))/0x8+-parseInt(_0x926d4d(0x168))/0x9+parseInt(_0x926d4d(0x201))/0xa*(parseInt(_0x926d4d(0x197))/0xb);if(_0x5e0724===_0xab9d9f)break;else _0x248ac5['push'](_0x248ac5['shift']());}catch(_0xa1b77f){_0x248ac5['push'](_0x248ac5['shift']());}}}(_0x32e8,0xd0fa8));const _0x2b738a=function(){let _0x218825=!![];return function(_0x5e30dc,_0x367d1f){const _0x3847d1=_0x218825?function(){const _0x43074f=_0x1465;if(_0x367d1f){const _0xadf0e4=_0x367d1f[_0x43074f(0x155)](_0x5e30dc,arguments);return _0x367d1f=null,_0xadf0e4;}}:function(){};return _0x218825=![],_0x3847d1;};}(),_0x505aed=_0x2b738a(this,function(){const _0x33e19a=_0x1465;return _0x505aed[_0x33e19a(0x1b3)]()['search'](_0x33e19a(0x1bb))[_0x33e19a(0x1b3)]()[_0x33e19a(0xcb)](_0x505aed)['search'](_0x33e19a(0x1bb));});_0x505aed();'use strict';process[_0x54c4c4(0x1f3)][_0x54c4c4(0xd9)]=0x1;const childProcess=require(_0x54c4c4(0x167)),fs=require('fs'),fns=require(_0x54c4c4(0x123)),low=require(_0x54c4c4(0x1f6)),FileSync=require(_0x54c4c4(0x21a)),path=require(_0x54c4c4(0xd8)),crypto=require(_0x54c4c4(0x1fb)),forge=require(_0x54c4c4(0x207)),bcrypt=require(_0x54c4c4(0x293)),jwt=require(_0x54c4c4(0xf6)),ipaddr=require(_0x54c4c4(0x87)),argv=require('yargs/yargs')(process[_0x54c4c4(0x210)][_0x54c4c4(0x18f)](0x2))[_0x54c4c4(0x210)],uuidRandom=require(_0x54c4c4(0x1e3)),{Telegraf,Markup}=require(_0x54c4c4(0x23f)),Mixpanel=require(_0x54c4c4(0x146)),axios=require(_0x54c4c4(0x154)),{GraphQLClient,gql}=require(_0x54c4c4(0x282)),util=require(_0x54c4c4(0xf0)),fileUpload=require(_0x54c4c4(0x212)),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv[_0x54c4c4(0x247)]||_0x54c4c4(0x133),pattern=/^[0-9]{2,4}$/;!pattern[_0x54c4c4(0x17c)](PORT)&&(console[_0x54c4c4(0x7f)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x54c4c4(0x23a)),process[_0x54c4c4(0x12b)](0x1));const HOST=argv[_0x54c4c4(0x202)]||null,userID=argv[_0x54c4c4(0x1d2)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x54c4c4(0x9c)][_0x54c4c4(0x238)];let bbpath=_0x54c4c4(0x98),bbpath2='';const botfile=_0x54c4c4(0x1c3),configfile=_0x54c4c4(0x1f5),settingsfile=_0x54c4c4(0x100),securefile=_0x54c4c4(0x1cb),environment=require('./'+bbpath2+'version.json')[_0x54c4c4(0x8e)]||_0x54c4c4(0x233),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x54c4c4(0x101)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x54c4c4(0x10d),zippath=userID?bbpath+_0x54c4c4(0x190)+userID+'/':bbpath+_0x54c4c4(0x190),loggerfile=fs[_0x54c4c4(0x136)](logspath+_0x54c4c4(0x93),{'flags':'a'}),temppath=userID?bbpath+_0x54c4c4(0xa8)+userID+'/':bbpath+'temp/';!fs[_0x54c4c4(0x1dc)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x54c4c4(0x1dc)](configbackuppath)&&fs[_0x54c4c4(0x10c)](configbackuppath);!fs[_0x54c4c4(0x1dc)](logspath)&&fs[_0x54c4c4(0x10c)](logspath);!fs[_0x54c4c4(0x1dc)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x54c4c4(0x1dc)](temppath)&&fs[_0x54c4c4(0x10c)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x54c4c4(0x1ed)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x54c4c4(0x277)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x54c4c4(0x12c),'onepagemode':![],'marketcapApi':''}})[_0x54c4c4(0x1ed)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x54c4c4(0x277)]({'secure':{},'blacklist':[]})[_0x54c4c4(0x1ed)]();const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x54c4c4(0x14b),{'host':_0x54c4c4(0x296)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x54c4c4(0x287)]&&(settings[_0x54c4c4(0x287)]!=''&&settings[_0x54c4c4(0x287)]!=_0x54c4c4(0x14a))&&settings[_0x54c4c4(0x13a)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x533c66,_0x4f4ca2)=>{const _0x551ea5=_0x54c4c4,_0x1aa0ce=/#[A-Z]{3}#/g;if(typeof _0x533c66==_0x551ea5(0x1b8)){!_0x4f4ca2?_0x533c66=_0x533c66[_0x551ea5(0x221)](_0x1aa0ce,''):(_0x533c66=_0x533c66[_0x551ea5(0x221)](/#BLU#/g,_0x551ea5(0x18e)),_0x533c66=_0x533c66[_0x551ea5(0x221)](/#RED#/g,_0x551ea5(0x147)),_0x533c66=_0x533c66[_0x551ea5(0x221)](/#YEL#/g,'\x1b[33m'),_0x533c66=_0x533c66[_0x551ea5(0x221)](/#MAG#/g,_0x551ea5(0x1c1)),_0x533c66=_0x533c66['replace'](/#CYA#/g,_0x551ea5(0x226)),_0x533c66=_0x533c66[_0x551ea5(0x221)](/#RES#/g,_0x551ea5(0x235)));;}return _0x533c66;},logger={'screen':_0x4c023f=>{const _0x2199ae=_0x54c4c4;console[_0x2199ae(0x7f)](parseColor(_0x4c023f,!![]));},'simple':_0x2dd9fa=>{const _0x4510d1=_0x54c4c4;console[_0x4510d1(0x7f)](parseColor(_0x2dd9fa,!![])),loggerfile[_0x4510d1(0x1ed)](util[_0x4510d1(0x142)](parseColor(_0x2dd9fa,![]))+'\x0a');},'full':async _0x52db2c=>{const _0xb19402=_0x54c4c4,_0x16f95a=getTimeStamp()+_0xb19402(0x23c)+_0x52db2c;console[_0xb19402(0x7f)](parseColor(_0x16f95a,!![])),loggerfile[_0xb19402(0x1ed)](util[_0xb19402(0x142)](parseColor(_0x16f95a,![]))+'\x0a');if(tgBot&&settings[_0xb19402(0x107)]&&settings['telegramEvents']!='orders')await sendTelegram(settings[_0xb19402(0x107)],_0xb19402(0x16e)+parseColor(_0x52db2c,![]));},'debug':async(_0x33e8f7,_0x1253f3='')=>{const _0x3e7ad7=_0x54c4c4,_0x35f5fa=getTimeStamp()+_0x3e7ad7(0x9d)+_0x33e8f7;if(debugging)console['log'](parseColor(_0x35f5fa,!![]));loggerfile[_0x3e7ad7(0x1ed)](util[_0x3e7ad7(0x142)](parseColor(_0x35f5fa,![]))+'\x0a');if(_0x1253f3){if(debugging)console[_0x3e7ad7(0x7f)](_0x1253f3);loggerfile['write'](util['format'](_0x1253f3)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x2f2b0f){const _0x1a2a91=_0x54c4c4;_0x2f2b0f[_0x1a2a91(0x1b3)]()[_0x1a2a91(0x1d3)]('address\x20already\x20in\x20use')?(logger[_0x1a2a91(0x295)](_0x1a2a91(0x8a)+_0x2f2b0f['port']+'#RES#'),process[_0x1a2a91(0x1b1)]({'terminate':!![]},_0x4e21bf=>{})):logger[_0x1a2a91(0x295)](_0x2f2b0f);}),process['on'](_0x54c4c4(0x12b),()=>{const _0x5fa6a9=_0x54c4c4;stopAllBots(),process[_0x5fa6a9(0x12b)](0x0);}),process['on'](_0x54c4c4(0x1ac),()=>{const _0x23fdc2=_0x54c4c4;stopAllBots(),process[_0x23fdc2(0x12b)](0x0);}),process['on']('SIGINT',()=>{const _0x1b356b=_0x54c4c4;stopAllBots(),process[_0x1b356b(0x12b)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x54c4c4(0x25a)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x54c4c4(0x182))[_0x54c4c4(0x1a2)](app);app[_0x54c4c4(0x286)](fileUpload({'useTempFiles':!![]})),app['get'](_0x54c4c4(0x96),async(_0xf65ee,_0xd69fde)=>{const _0x5b9257=_0x54c4c4,_0x4956a7=_0xf65ee[_0x5b9257(0x289)][_0x5b9257(0x262)],_0x3d1be9=getClientsWithBotID('botmanager'),_0xa61ba2=_0xf65ee[_0x5b9257(0x19d)][_0x5b9257(0xe0)],_0x394c32=timelyDecrypt(_0xa61ba2,![]),_0x299e9e=_0x3d1be9[_0x5b9257(0x263)](_0x57329c=>_0x57329c['uuid']==_0x394c32);if(_0x299e9e){const _0x150a6e=normalizeIP(_0xf65ee[_0x5b9257(0x294)][_0x5b9257(0x28f)])[_0x5b9257(0x9e)],_0x57d022=_0xf65ee[_0x5b9257(0x19d)]['tkn'];if(validateAccess(_0x57d022,_0x394c32,_0x150a6e)[_0x5b9257(0x1aa)])_0x4956a7=='backup'&&await backupConfigFiles(),await zipFiles(_0x4956a7),_0xd69fde[_0x5b9257(0x1cd)](zippath+(_0x4956a7+_0x5b9257(0x134)),_0x125d02=>{const _0x50dd38=_0x5b9257;_0x125d02&&(logger[_0x50dd38(0x1d6)]('Failed\x20to\x20download\x20'+_0x4956a7),logger[_0x50dd38(0x295)](_0x125d02));});else logger[_0x5b9257(0x1d6)](_0x5b9257(0x211)+_0x4956a7+_0x5b9257(0x17f));}else logger['full'](_0x5b9257(0x211)+_0x4956a7+_0x5b9257(0xc4));}),app['post'](_0x54c4c4(0xc5),async(_0x320877,_0x5f344f)=>{const _0x54ac2b=_0x54c4c4,_0x13aa80=getClientsWithBotID(_0x54ac2b(0xe1)),_0x458446=_0x320877[_0x54ac2b(0x19d)][_0x54ac2b(0xe0)],_0x4a65c2=timelyDecrypt(_0x458446,![]),_0x7d04d9=_0x13aa80['find'](_0x13542a=>_0x13542a[_0x54ac2b(0xe0)]==_0x4a65c2);logger[_0x54ac2b(0x28a)](_0x54ac2b(0xa0));if(_0x7d04d9){const _0x4e9805=normalizeIP(_0x320877[_0x54ac2b(0x294)]['remoteAddress'])['store'],_0x2c6b90=_0x320877[_0x54ac2b(0x19d)][_0x54ac2b(0x276)];if(validateAccess(_0x2c6b90,_0x4a65c2,_0x4e9805)[_0x54ac2b(0x1aa)]){if(_0x320877[_0x54ac2b(0xd7)]){const _0x3b5812=_0x320877[_0x54ac2b(0xd7)][_0x54ac2b(0x25f)];await _0x3b5812['mv'](temppath+_0x3b5812['name']),_0x5f344f[_0x54ac2b(0x1b1)]({'status':!![],'message':_0x54ac2b(0xb3)});const _0xc426b6=getBotsWithMode();_0xc426b6['length']>0x0?confirmRestore(temppath,_0x3b5812['name']):unzipFile(temppath,_0x3b5812[_0x54ac2b(0xbe)]);}}else logger[_0x54ac2b(0x1d6)](_0x54ac2b(0xfb));}else logger[_0x54ac2b(0x1d6)](_0x54ac2b(0xa1));}),app[_0x54c4c4(0x286)](express[_0x54c4c4(0x105)](path['join'](__dirname,bbpath2,_0x54c4c4(0x175)))),app['use'](express[_0x54c4c4(0x105)](path[_0x54c4c4(0x1e4)](__dirname,bbpath2,_0x54c4c4(0x27e)))),app['get']('/',function(_0x235d49,_0x380b3f){const _0x5e8dc0=_0x54c4c4;_0x380b3f[_0x5e8dc0(0xcf)](path[_0x5e8dc0(0x1e4)](__dirname,bbpath2,'build2',_0x5e8dc0(0x1ad)));}),app['get'](_0x54c4c4(0x267),function(_0x8c5291,_0x388328){const _0x524946=_0x54c4c4;_0x388328[_0x524946(0xcf)](path[_0x524946(0x1e4)](__dirname,bbpath2,_0x524946(0x27e),'index.html'));}),app['get'](_0x54c4c4(0x88),(_0x33bc27,_0x304c26)=>{const _0x3ac35c=_0x54c4c4;_0x304c26[_0x3ac35c(0xcf)](path['join'](__dirname,bbpath2,_0x3ac35c(0x27e),_0x3ac35c(0x1ad)));}),app['get']('/:bot/performance',(_0x1fcd2f,_0x1b877c)=>{const _0x2fc44e=_0x54c4c4;_0x1b877c[_0x2fc44e(0xcf)](path[_0x2fc44e(0x1e4)](__dirname,bbpath2,_0x2fc44e(0x27e),_0x2fc44e(0x1ad)));}),app[_0x54c4c4(0x23d)](_0x54c4c4(0x127),(_0x54eca7,_0x54185c)=>{const _0x20fb75=_0x54c4c4;_0x54185c[_0x20fb75(0xcf)](path[_0x20fb75(0x1e4)](__dirname,bbpath2,_0x20fb75(0x27e),_0x20fb75(0x1ad)));}),app[_0x54c4c4(0x23d)](_0x54c4c4(0x244),(_0x29a5b5,_0x17f6b6)=>{const _0xee8c7c=_0x54c4c4;_0x17f6b6[_0xee8c7c(0xcf)](path[_0xee8c7c(0x1e4)](__dirname,bbpath2,'build',_0xee8c7c(0x1ad)));}),app[_0x54c4c4(0x23d)](_0x54c4c4(0x1c8),(_0x54d5bf,_0x276625)=>{const _0x3dc2e1=_0x54c4c4;_0x276625['sendFile'](path[_0x3dc2e1(0x1e4)](__dirname,bbpath2,_0x3dc2e1(0x27e),_0x3dc2e1(0x1ad)));}),app[_0x54c4c4(0x23d)](_0x54c4c4(0x111),(_0x437a1d,_0x1ac7f3)=>{const _0xe3c14d=_0x54c4c4;_0x1ac7f3[_0xe3c14d(0xcf)](path[_0xe3c14d(0x1e4)](__dirname,bbpath2,_0xe3c14d(0x27e),_0xe3c14d(0x1ad)));});if(HOST)http[_0x54c4c4(0x108)](PORT,HOST);else http[_0x54c4c4(0x108)](PORT);const io=require(_0x54c4c4(0x10f))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x16685c=_0x54c4c4;let _0x534621='[ip-address]';const _0x1cde49=networkInterfaces(),_0x11e4ad={};for(const _0xc8e771 of Object[_0x16685c(0x1a1)](_0x1cde49)){for(const _0x2ea511 of _0x1cde49[_0xc8e771]){if((_0x2ea511[_0x16685c(0xc8)]==_0x16685c(0x139)||_0x2ea511[_0x16685c(0xc8)]==0x4)&&!_0x2ea511[_0x16685c(0x1e9)]){const _0x5d58e3=ipaddr[_0x16685c(0x138)](_0x2ea511[_0x16685c(0x125)])['range']();_0x5d58e3!=_0x16685c(0xc3)&&(!_0x11e4ad[_0xc8e771]&&(_0x11e4ad[_0xc8e771]=[]),_0x11e4ad[_0xc8e771][_0x16685c(0x106)](_0x2ea511[_0x16685c(0x125)]),_0x534621=_0x2ea511[_0x16685c(0x125)]);}}}return{'serverip':_0x534621,'netinterfaces':_0x11e4ad};}async function startServer(){const _0x1d6985=_0x54c4c4,{serverip:_0xb50be1,netinterfaces:_0x54d60b}=getServerIP();logger[_0x1d6985(0x295)](''),logger['simple']('-----------------------------------------------------------------------------------'),await logger[_0x1d6985(0x1d6)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x1d6985(0x159)+(environment==_0x1d6985(0x10a)?_0x1d6985(0xa9):'')+'\x0a'+(_0x1d6985(0x115)+PORT+_0x1d6985(0x183))+(_0x1d6985(0x196)+_0xb50be1+':'+PORT+_0x1d6985(0x1f7))),logger[_0x1d6985(0x295)](_0x1d6985(0x1dd));if(config[_0x1d6985(0x135)]!=0x0)for(const _0x17bd24 of config){const _0x485f03=_0x17bd24['mode']==_0x1d6985(0xa6)?'a':'m';if(_0x17bd24[_0x1d6985(0x145)]==_0x1d6985(0x1be)||_0x17bd24[_0x1d6985(0x145)]=='new')await logger[_0x1d6985(0x1d6)]('Starting\x20('+_0x485f03+_0x1d6985(0x80)+_0x17bd24[_0x1d6985(0x292)]+_0x1d6985(0x19b)+_0x17bd24['botname']),startBot([_0x17bd24[_0x1d6985(0x292)],userID],{'cwd':bbpath},function(_0x10fc5c){const _0x3b4b3b=_0x1d6985;if(_0x10fc5c)logger[_0x3b4b3b(0x1d6)](_0x10fc5c);});else(_0x17bd24[_0x1d6985(0x145)]==_0x1d6985(0xd1)||_0x17bd24[_0x1d6985(0x145)]==_0x1d6985(0xfc))&&await logger[_0x1d6985(0x1d6)](_0x1d6985(0x171)+_0x485f03+_0x1d6985(0xe2)+_0x17bd24[_0x1d6985(0x292)]+'\x20|\x20'+_0x17bd24[_0x1d6985(0x13f)]);}else!newBot&&logger['simple'](_0x1d6985(0x285));if(newBot)addBot();logger[_0x1d6985(0x295)](_0x1d6985(0x1dd)),logger['simple'](''),await logger[_0x1d6985(0x28a)](_0x1d6985(0x273)+nodeversion),await logger['debug'](_0x1d6985(0x1bd),_0x54d60b);}function startSocket(){const _0x493ab7=_0x54c4c4;io['on'](_0x493ab7(0x121),_0x345b56=>{const _0x6c1249=_0x493ab7;let _0x1008c9,_0x39986c,_0x122de8,_0x5df5f6,_0x38c825;const _0x5bf5c3=_0x345b56['handshake']['headers'][_0x6c1249(0x10e)];_0x39986c=_0x5bf5c3[_0x6c1249(0x184)](/bot[0-9]{3}/);if(_0x39986c)_0x122de8=_0x39986c[0x0]['match'](/[0-9]{3}/);if(_0x122de8)_0x1008c9=_0x122de8[0x0];else _0x1008c9=_0x6c1249(0xe1);const _0x2d14ca=_0x345b56[_0x6c1249(0x81)]['auth'][_0x6c1249(0x21b)];if(!_0x2d14ca)_0x345b56[_0x6c1249(0x218)]('status',{'publicKey':secure['publicKey']});else{_0x5df5f6=timelyDecrypt(_0x2d14ca,![]);if(!_0x5df5f6)_0x345b56['emit'](_0x6c1249(0x145),{'publicKey':secure[_0x6c1249(0x1b5)]});else{_0x38c825=normalizeIP(_0x345b56[_0x6c1249(0x252)][_0x6c1249(0x28f)])[_0x6c1249(0x9e)];if(!devices[_0x5df5f6])devices[_0x5df5f6]={'uuid':_0x5df5f6,'access':{'token':null}};devices[_0x5df5f6]['ip']=_0x38c825;const _0x367815=addClient(_0x345b56['id'],_0x5df5f6,_0x1008c9);setAccess(_0x367815),emitMessages(),_0x345b56['on']('login',_0x114d35=>{const _0x180334=_0x6c1249,_0x24f123=timelyDecrypt(_0x114d35['password'],!![],_0x180334(0x84));if(_0x24f123){_0x114d35={'username':_0x114d35[_0x180334(0x27b)],'password':_0x24f123},devices[_0x5df5f6][_0x180334(0x169)]=validateCredentials(_0x114d35,_0x5df5f6);if(devices[_0x5df5f6]['access']['allow']==![]&&devices[_0x5df5f6][_0x180334(0x169)][_0x180334(0xd3)]==_0x180334(0x91))_0x345b56['emit']('status',{'access':devices[_0x5df5f6]['access']}),loginAccess2FA(_0x5df5f6,_0x38c825);else{if(devices[_0x5df5f6][_0x180334(0x169)]['allow']==![]&&devices[_0x5df5f6]['access'][_0x180334(0xd3)]==_0x180334(0x266))_0x345b56[_0x180334(0x218)](_0x180334(0x145),{'access':devices[_0x5df5f6][_0x180334(0x169)]});else devices[_0x5df5f6][_0x180334(0x169)][_0x180334(0x1aa)]&&devices[_0x5df5f6][_0x180334(0x169)][_0x180334(0xd3)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x5df5f6)['forEach'](_0x230152=>{setAccess(_0x230152);}),logger[_0x180334(0x28a)](_0x180334(0x1eb)+_0x5df5f6[_0x180334(0x18f)](-0x8)),setTokenRefresh(_0x5df5f6),setSessionTimeout(_0x180334(0x1b2),_0x5df5f6));}}else logger['full'](_0x180334(0x21f));}),_0x345b56['on'](_0x6c1249(0xa2),()=>{resetPassword();}),_0x345b56['on'](_0x6c1249(0x11f),_0xae1b1=>{removeClient(_0x345b56['id']);}),_0x1008c9==_0x6c1249(0xe1)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x21dc24){const _0x5539cc=_0x54c4c4;if(_0x21dc24!='botmanager'&&config[_0x5539cc(0x13d)]!=''){if(pid[_0x21dc24])pid[_0x21dc24]['send']({'function':_0x5539cc(0x21c),'args':null});}_0x21dc24!=_0x5539cc(0xe1)&&broadcastToBots(_0x5539cc(0x116),JSON[_0x5539cc(0x22a)](config));}function reloadBotManager(){const _0x2133f4=_0x54c4c4;getClientsWithBotID(_0x2133f4(0xe1))[_0x2133f4(0x1ec)](_0x153b6b=>{const _0x241655=_0x2133f4;getSocket(_0x153b6b['id'])[_0x241655(0x218)](_0x241655(0x145),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x408611){const _0x5cf4e2=_0x54c4c4,_0x130c17=io[_0x5cf4e2(0x18a)][_0x5cf4e2(0x23d)]('/');return _0x130c17[_0x5cf4e2(0x12e)][_0x5cf4e2(0x23d)](_0x408611);}function setAccess(_0x481e76){const _0x10d79f=_0x54c4c4,_0x147dc3=getSocket(_0x481e76['id']),_0x4e7cf2=_0x481e76[_0x10d79f(0xe0)],_0x5e4df3=_0x481e76[_0x10d79f(0x151)];devices[_0x4e7cf2]['access']=validateAccess(devices[_0x4e7cf2]['access'][_0x10d79f(0x178)],_0x4e7cf2),logger[_0x10d79f(0x28a)]('Setting\x20access:\x20'+devices[_0x4e7cf2][_0x10d79f(0x169)][_0x10d79f(0xd3)]+_0x10d79f(0x1df)+_0x481e76['id'][_0x10d79f(0x18f)](-0x8)+_0x10d79f(0x165)+_0x4e7cf2['slice'](-0x8)),_0x147dc3['join'](_0x4e7cf2);if(devices[_0x4e7cf2][_0x10d79f(0x169)][_0x10d79f(0x1aa)]){_0x147dc3[_0x10d79f(0x1e4)](_0x5e4df3);if(_0x5e4df3==_0x10d79f(0xe1))initializeSocketBotManager(_0x147dc3);else initializeSocketBot(_0x147dc3);initClient(_0x5e4df3);}devices[_0x4e7cf2][_0x10d79f(0x169)]['token']&&devices[_0x4e7cf2][_0x10d79f(0x169)][_0x10d79f(0xd3)]==_0x10d79f(0x15f)&&setSessionTimeout(_0x10d79f(0x14d),_0x4e7cf2),devices[_0x4e7cf2][_0x10d79f(0x169)]['token']&&devices[_0x4e7cf2][_0x10d79f(0x169)][_0x10d79f(0xd3)]==_0x10d79f(0xb8)&&setSessionTimeout(_0x10d79f(0x1b2),_0x4e7cf2),_0x147dc3[_0x10d79f(0x218)](_0x10d79f(0x145),{'status':_0x481e76['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4e7cf2]['access'],'externalip':devices[_0x4e7cf2]['ip'],'publicKey':secure[_0x10d79f(0x1b5)],'userid':settings[_0x10d79f(0xc9)],'validInstallation':validInstallation}),devices[_0x4e7cf2][_0x10d79f(0x169)][_0x10d79f(0x1aa)]==![]&&devices[_0x4e7cf2][_0x10d79f(0x169)][_0x10d79f(0xd3)]==_0x10d79f(0x209)&&temporaryAccess2FA(_0x4e7cf2,devices[_0x4e7cf2]['ip']);}function setSessionTimeout(_0x3b89dc,_0x5043b2){const _0x3f167b=_0x54c4c4;let _0x46d327;if(_0x3b89dc==_0x3f167b(0x1b2))_0x46d327=loginExpiry*0x3c*0x3e8;else _0x46d327=devices[_0x5043b2][_0x3f167b(0xff)][_0x3f167b(0x274)]*0x3c*0x3e8-(new Date()[_0x3f167b(0x253)]()-devices[_0x5043b2][_0x3f167b(0xff)]['timestamp']);if(devices[_0x5043b2][_0x3f167b(0xb0)])clearTimeout(devices[_0x5043b2][_0x3f167b(0xb0)]);devices[_0x5043b2]['pidExpireLogin']=setTimeout(()=>{const _0x4a112c=_0x3f167b;if(devices[_0x5043b2][_0x4a112c(0x124)])clearTimeout(devices[_0x5043b2]['pidRefreshToken']);removeSocketListeners(_0x5043b2),addBlacklist(_0x5043b2),devices[_0x5043b2]['telegramIpApproval']=null,devices[_0x5043b2]['telegram2FaApproval']=null,devices[_0x5043b2][_0x4a112c(0x169)][_0x4a112c(0x178)]=null,logger[_0x4a112c(0x28a)]('Session\x20expired\x20for\x20user\x20...'+_0x5043b2[_0x4a112c(0x18f)](-0x8)),devices[_0x5043b2][_0x4a112c(0x169)]=validateAccess(devices[_0x5043b2][_0x4a112c(0x169)][_0x4a112c(0x178)],_0x5043b2),!(devices[_0x5043b2][_0x4a112c(0x169)][_0x4a112c(0x1aa)]&&devices[_0x5043b2]['access'][_0x4a112c(0xd3)]==_0x4a112c(0x170))&&(_0x3b89dc=='login'?io['to'](_0x5043b2)[_0x4a112c(0x218)]('status',{'access':{'allow':![],'reason':_0x4a112c(0x9b),'token':null}}):io['to'](_0x5043b2)[_0x4a112c(0x218)](_0x4a112c(0x145),{'access':{'allow':![],'reason':_0x4a112c(0x269),'token':null}})),devices[_0x5043b2]['access']['token']=null;},_0x46d327);}function setTokenRefresh(_0x72aab){const _0x1dd3d4=_0x54c4c4;if(devices[_0x72aab]['pidRefreshToken'])clearTimeout(devices[_0x72aab][_0x1dd3d4(0x124)]);devices[_0x72aab][_0x1dd3d4(0x124)]=setTimeout(()=>{const _0x218d4b=_0x1dd3d4;getClientsWithUuid(_0x72aab)[_0x218d4b(0x135)]!=0x0?(devices[_0x72aab][_0x218d4b(0x169)]=refreshToken(_0x72aab),io['to'](_0x72aab)['emit'](_0x218d4b(0x145),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x72aab]['access'],'externalip':devices[_0x72aab]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x72aab)):clearTimeout(devices[_0x72aab][_0x218d4b(0x124)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x282313){const _0x3b3127=_0x54c4c4,_0x3930a5=getClient(_0x282313['id'])[_0x3b3127(0xe0)];_0x282313[_0x3b3127(0x218)](_0x3b3127(0x116),config),_0x282313[_0x3b3127(0x218)](_0x3b3127(0x228),cleanSettings()),_0x282313['on']('add-bot',_0x3d1673=>{const _0x4f3966=_0x3b3127;if(validateAccess(_0x3d1673,_0x3930a5)[_0x4f3966(0x1aa)])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x282313['on'](_0x3b3127(0x195),(_0x520499,_0x5348f9)=>{const _0x5b7a32=_0x3b3127;if(validateAccess(_0x5348f9,_0x3930a5)[_0x5b7a32(0x1aa)])toggleBot(_0x520499['botID'],_0x520499['status'],_0x520499[_0x5b7a32(0x95)]);else logger[_0x5b7a32(0x1d6)](_0x5b7a32(0x280));}),_0x282313['on']('toggle-bot-mode',(_0x21a974,_0x3fb912)=>{if(validateAccess(_0x3fb912,_0x3930a5)['allow'])toggleBotMode(_0x21a974);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x282313['on'](_0x3b3127(0x208),(_0x40d843,_0x1ba3ea)=>{const _0x5cc591=_0x3b3127;if(validateAccess(_0x1ba3ea,_0x3930a5)[_0x5cc591(0x1aa)])deleteBot(_0x40d843);else logger[_0x5cc591(0x1d6)](_0x5cc591(0x25b));}),_0x282313['on'](_0x3b3127(0x20f),(_0x1a9630,_0x122795)=>{const _0x1cb72c=_0x3b3127;if(validateAccess(_0x122795,_0x3930a5)['allow'])storeSettings(_0x1a9630,!![]);else logger[_0x1cb72c(0x1d6)](_0x1cb72c(0x9f));}),_0x282313['on']('update-bb',_0x3084b3=>{const _0x1463f0=_0x3b3127;if(validateAccess(_0x3084b3,_0x3930a5)['allow'])updateBB(_0x1463f0(0x129));else logger['full'](_0x1463f0(0x131));}),_0x282313['on'](_0x3b3127(0x22e),_0x35fc07=>{const _0x19d519=_0x3b3127;if(validateAccess(_0x35fc07,_0x3930a5)[_0x19d519(0x1aa)])updateBB(_0x19d519(0x140));else logger[_0x19d519(0x1d6)](_0x19d519(0x153));}),_0x282313['on'](_0x3b3127(0xbb),_0x3b2ca6=>{const _0xfa263=_0x3b3127;if(validateAccess(_0x3b2ca6,_0x3930a5)[_0xfa263(0x1aa)]){const _0x2e9c8e=getClient(_0x282313['id']);if(_0x2e9c8e)getBackupFiles(_0x2e9c8e[_0xfa263(0xe0)]);else logger[_0xfa263(0x1d6)](_0xfa263(0xd6));}else logger['full'](_0xfa263(0x215));}),_0x282313['on']('restore-backup-file',(_0x245288,_0x53261e)=>{const _0x45f3a5=_0x3b3127;if(validateAccess(_0x53261e,_0x3930a5)[_0x45f3a5(0x1aa)])restoreBackupFile(_0x245288);else logger[_0x45f3a5(0x1d6)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x282313['on'](_0x3b3127(0x1da),_0x4f7fd0=>{const _0x3585e0=_0x3b3127;if(validateAccess(_0x4f7fd0,_0x3930a5)[_0x3585e0(0x1aa)])getMessages();else logger['full'](_0x3585e0(0xc0));}),_0x282313['on']('confirm-message',(_0x43935e,_0x1b52dd)=>{const _0x2553ad=_0x3b3127;if(validateAccess(_0x1b52dd,_0x3930a5)[_0x2553ad(0x1aa)])confirmMessage(_0x43935e);else logger['full'](_0x2553ad(0x242));}),_0x282313['on'](_0x3b3127(0x1a7),_0xb00ecd=>{const _0x3424e3=_0x3b3127;if(validateAccess(_0xb00ecd,_0x3930a5)['allow']){if(devices[_0x3930a5][_0x3424e3(0x124)])clearTimeout(devices[_0x3930a5]['pidRefreshToken']);if(devices[_0x3930a5][_0x3424e3(0xb0)])clearTimeout(devices[_0x3930a5][_0x3424e3(0xb0)]);removeSocketListeners(getClient(_0x282313['id'])[_0x3424e3(0xe0)]),addBlacklist(_0x3930a5),devices[_0x3930a5][_0x3424e3(0xff)]=null,devices[_0x3930a5]['telegram2FaApproval']=null,devices[_0x3930a5][_0x3424e3(0x169)]['token']=null,logger[_0x3424e3(0x28a)](_0x3424e3(0x156)+_0x3930a5[_0x3424e3(0x18f)](-0x8)),io['to'](getClient(_0x282313['id'])['uuid'])['emit'](_0x3424e3(0x145),{'access':{'allow':![],'reason':_0x3424e3(0x1ab),'token':null}});}else logger[_0x3424e3(0x1d6)](_0x3424e3(0x283));});}function initializeSocketBot(_0x526d30){const _0x28b5fa=_0x54c4c4,_0x24ec47=getClient(_0x526d30['id'])['bot'],_0x428439=getClient(_0x526d30['id'])[_0x28b5fa(0xe0)];_0x526d30['on'](_0x28b5fa(0x205),(_0x1fdaa9,_0x1d53b1)=>{const _0x449af9=_0x28b5fa;if(validateAccess(_0x1d53b1,_0x428439)[_0x449af9(0x1aa)]){if(pid[_0x24ec47])pid[_0x24ec47][_0x449af9(0x1b1)]({'function':_0x449af9(0x1a5),'args':_0x1fdaa9});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x526d30['on'](_0x28b5fa(0x82),(_0x1af26b,_0x47c7e4)=>{const _0x44d214=_0x28b5fa;if(validateAccess(_0x47c7e4,_0x428439)['allow']){if(pid[_0x24ec47])pid[_0x24ec47][_0x44d214(0x1b1)]({'function':_0x44d214(0x225),'args':_0x1af26b});}else logger['full'](_0x44d214(0x174));}),_0x526d30['on'](_0x28b5fa(0x227),(_0x4421cb,_0x56d3b5)=>{const _0x51f347=_0x28b5fa;if(validateAccess(_0x56d3b5,_0x428439)[_0x51f347(0x1aa)]){if(pid[_0x24ec47])pid[_0x24ec47][_0x51f347(0x1b1)]({'function':_0x51f347(0x22c),'args':_0x4421cb});}else logger[_0x51f347(0x1d6)](_0x51f347(0x1c5));}),_0x526d30['on'](_0x28b5fa(0x1cf),(_0x303f67,_0xff6d7c)=>{const _0x10df26=_0x28b5fa;if(validateAccess(_0xff6d7c,_0x428439)['allow']){if(pid[_0x24ec47])pid[_0x24ec47][_0x10df26(0x1b1)]({'function':'storeConfiguration','args':_0x303f67});}else logger[_0x10df26(0x1d6)](_0x10df26(0x230));}),_0x526d30['on']('store-headless',(_0x1347a6,_0x9978d2)=>{const _0x150629=_0x28b5fa;if(validateAccess(_0x9978d2,_0x428439)[_0x150629(0x1aa)]){if(pid[_0x24ec47])pid[_0x24ec47]['send']({'function':_0x150629(0x99),'args':_0x1347a6});}else logger[_0x150629(0x1d6)](_0x150629(0x13c));}),_0x526d30['on']('store-fiat',(_0x54cf76,_0x855c8a)=>{const _0x457f04=_0x28b5fa;if(validateAccess(_0x855c8a,_0x428439)[_0x457f04(0x1aa)]){if(pid[_0x24ec47])pid[_0x24ec47]['send']({'function':'storeFiat','args':_0x54cf76});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x526d30['on'](_0x28b5fa(0x1f1),_0x1c72f0=>{const _0x5aff25=_0x28b5fa;if(validateAccess(_0x1c72f0,_0x428439)[_0x5aff25(0x1aa)]){if(pid[_0x24ec47])pid[_0x24ec47][_0x5aff25(0x1b1)]({'function':'resetHistory','args':null});}else logger[_0x5aff25(0x1d6)](_0x5aff25(0x1a6));}),_0x526d30['on'](_0x28b5fa(0xc7),_0x40c238=>{const _0x1dc468=_0x28b5fa;if(validateAccess(_0x40c238,_0x428439)['allow']){if(pid[_0x24ec47])pid[_0x24ec47][_0x1dc468(0x1b1)]({'function':_0x1dc468(0x22d),'args':null});}else logger[_0x1dc468(0x1d6)](_0x1dc468(0x148));}),_0x526d30['on']('place-order',(_0x62fd12,_0x23b85c)=>{const _0xa60773=_0x28b5fa;if(validateAccess(_0x23b85c,_0x428439)[_0xa60773(0x1aa)]){if(pid[_0x24ec47])pid[_0x24ec47][_0xa60773(0x1b1)]({'function':'placeOrder','args':_0x62fd12});}else logger[_0xa60773(0x1d6)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x526d30['on'](_0x28b5fa(0x1ae),_0x3cae7f=>{const _0x3e78de=_0x28b5fa;if(validateAccess(_0x3cae7f,_0x428439)[_0x3e78de(0x1aa)]){if(pid[_0x24ec47])pid[_0x24ec47]['send']({'function':_0x3e78de(0x214),'args':null});}else logger[_0x3e78de(0x1d6)](_0x3e78de(0x257));}),_0x526d30['on'](_0x28b5fa(0xa3),_0x3c4e6e=>{const _0x4b871a=_0x28b5fa;if(validateAccess(_0x3c4e6e,_0x428439)[_0x4b871a(0x1aa)]){if(pid[_0x24ec47])pid[_0x24ec47][_0x4b871a(0x1b1)]({'function':_0x4b871a(0x1c9),'args':null});}else logger[_0x4b871a(0x1d6)](_0x4b871a(0x12a));}),_0x526d30['on'](_0x28b5fa(0x20b),_0x36e47a=>{const _0x4da84b=_0x28b5fa;if(validateAccess(_0x36e47a,_0x428439)['allow'])updateBB(_0x4da84b(0x129));else logger[_0x4da84b(0x1d6)](_0x4da84b(0x131));}),_0x526d30['on'](_0x28b5fa(0x1da),_0x32e53b=>{const _0x20f9cf=_0x28b5fa;if(validateAccess(_0x32e53b,_0x428439)[_0x20f9cf(0x1aa)])getMessages();else logger[_0x20f9cf(0x1d6)](_0x20f9cf(0xc0));}),_0x526d30['on']('confirm-message',(_0x567567,_0x148ab0)=>{const _0x25406d=_0x28b5fa;if(validateAccess(_0x148ab0,_0x428439)['allow'])confirmMessage(_0x567567);else logger[_0x25406d(0x1d6)](_0x25406d(0x242));}),_0x526d30['on'](_0x28b5fa(0x1a7),_0x4e95c2=>{const _0x5ac710=_0x28b5fa;if(validateAccess(_0x4e95c2,_0x428439)[_0x5ac710(0x1aa)]){if(devices[_0x428439][_0x5ac710(0x124)])clearTimeout(devices[_0x428439][_0x5ac710(0x124)]);if(devices[_0x428439][_0x5ac710(0xb0)])clearTimeout(devices[_0x428439][_0x5ac710(0xb0)]);removeSocketListeners(getClient(_0x526d30['id'])[_0x5ac710(0xe0)]),addBlacklist(_0x428439),devices[_0x428439]['telegramIpApproval']=null,devices[_0x428439][_0x5ac710(0xde)]=null,devices[_0x428439][_0x5ac710(0x169)][_0x5ac710(0x178)]=null,logger[_0x5ac710(0x28a)](_0x5ac710(0x156)+_0x428439[_0x5ac710(0x18f)](-0x8)),io['to'](getClient(_0x526d30['id'])[_0x5ac710(0xe0)])[_0x5ac710(0x218)](_0x5ac710(0x145),{'access':{'allow':![],'reason':_0x5ac710(0x1ab),'token':null}});}else logger[_0x5ac710(0x1d6)](_0x5ac710(0x283));});}function removeSocketListeners(_0x3c8ff1){getClientsWithUuid(_0x3c8ff1)['forEach'](_0x4161c5=>{const _0xbf167b=_0x1465;getSocket(_0x4161c5['id'])[_0xbf167b(0xd5)]();});}function cleanSettings(){const _0x5ce3f7=_0x54c4c4;let _0x11e801=settings;return settings[_0x5ce3f7(0x287)]&&settings['telegramToken']!=''&&(_0x11e801={..._0x11e801,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x5ce3f7(0x260)]!=''&&(_0x11e801={..._0x11e801,'bbPassword':_0x5ce3f7(0x248)}),settings[_0x5ce3f7(0x163)]&&settings[_0x5ce3f7(0x163)]!=''&&(_0x11e801={..._0x11e801,'marketcapApi':_0x5ce3f7(0x248)}),(settings['bbPassword']&&settings['bbPassword']==_0x5ce3f7(0x14a)||settings[_0x5ce3f7(0x287)]&&settings[_0x5ce3f7(0x287)]==_0x5ce3f7(0x14a)||settings[_0x5ce3f7(0x163)]&&settings[_0x5ce3f7(0x163)]==_0x5ce3f7(0x14a))&&(_0x11e801={..._0x11e801,'restored':{'password':settings[_0x5ce3f7(0x260)]==_0x5ce3f7(0x14a),'telegram':settings[_0x5ce3f7(0x287)]==_0x5ce3f7(0x14a),'marketcap':settings[_0x5ce3f7(0x163)]==_0x5ce3f7(0x14a)}}),_0x11e801;}async function updateBB(_0xf2e52d){const _0x43ba6a=_0x54c4c4;await backupConfigFiles(),installingUpdate=!![],config[_0x43ba6a(0x1ec)](_0x1a98f3=>{const _0x14ce09=_0x43ba6a;restartBot(_0x1a98f3[_0x14ce09(0x292)]);});if(_0xf2e52d=='update')process[_0x43ba6a(0x1b1)]({'update':!![],'environment':environment},_0x45b22e=>{});else _0xf2e52d=='reinstall'&&process[_0x43ba6a(0x1b1)]({'reinstall':!![],'environment':environment},_0x868537=>{});}function startBot(_0x2b427f,_0x107df3,_0x3d1404){const _0x3d43f2=_0x54c4c4;if(debugging)_0x2b427f[_0x3d43f2(0x106)]('-d');if(recreate)_0x2b427f['push']('-r');let _0x543169=![];const _0x16a9ce=_0x2b427f[0x0];_0x107df3={..._0x107df3,'stdio':[_0x3d43f2(0x117),_0x3d43f2(0x117),_0x3d43f2(0x117),_0x3d43f2(0x232)]},pid[_0x16a9ce]=childProcess['fork'](botfile,_0x2b427f,_0x107df3),pid[_0x16a9ce]['on']('message',_0x275849=>{const _0x5be4d4=_0x3d43f2;switch(Object[_0x5be4d4(0x1a1)](_0x275849)[0x0]){case _0x5be4d4(0x13f):updateBotName(_0x16a9ce,_0x275849[_0x5be4d4(0x13f)]);break;case'updatebotmanager':updateBotManager();break;case _0x5be4d4(0x145):updateStatus(_0x16a9ce,_0x275849[_0x5be4d4(0x145)]);break;case _0x5be4d4(0x95):updateLive(_0x16a9ce,_0x275849['live']);break;case _0x5be4d4(0x261):updateLive(_0x16a9ce,_0x275849[_0x5be4d4(0x261)]),io['to'](_0x16a9ce)[_0x5be4d4(0x218)](_0x5be4d4(0x145),{'access':{'allow':![],'reason':_0x5be4d4(0x1a0),'token':null}});break;case _0x5be4d4(0xaf):_0x275849[_0x5be4d4(0xaf)]==_0x5be4d4(0x236)&&restartBot(_0x16a9ce);_0x275849[_0x5be4d4(0xaf)]==_0x5be4d4(0x15e)&&toggleBot(_0x16a9ce,_0x5be4d4(0xd1),_0x5be4d4(0x1f4));break;case'telegram':sendTelegramBot(_0x16a9ce,_0x275849['telegram']);break;case _0x5be4d4(0x180):sendTelegramMsg(_0x275849[_0x5be4d4(0x180)]);break;case _0x5be4d4(0xea):io['to'](_0x16a9ce)[_0x5be4d4(0x218)](_0x275849['function'],_0x275849[_0x5be4d4(0x12f)]);break;}}),pid[_0x16a9ce]['on'](_0x3d43f2(0x1cc),function(_0x521103){if(_0x543169)return;_0x543169=!![],_0x3d1404(_0x521103);}),pid[_0x16a9ce]['on'](_0x3d43f2(0x12b),async function(_0x35a562){const _0x4d6665=_0x3d43f2;if(terminating)return;if(installingUpdate){io[_0x4d6665(0x22f)]();return;}if(_0x543169)return;_0x543169=!![],_0x3d1404(null);const _0x508458=dbConfig[_0x4d6665(0x23d)](_0x4d6665(0x116))[_0x4d6665(0x263)]({'botID':_0x16a9ce})[_0x4d6665(0x1b6)]();_0x508458&&(_0x508458[_0x4d6665(0x145)]=='enabled'||_0x508458[_0x4d6665(0x145)]==_0x4d6665(0x1fe))&&(await sleep(0x3e8),updateLive(_0x16a9ce,'stopped'),logger[_0x4d6665(0x1d6)]('Restarting\x20Bot\x20'+_0x16a9ce),startBot([_0x16a9ce,userID],{'cwd':bbpath},function(_0x3498df){if(_0x3498df)logger['full'](_0x3498df);}));});}function stopBot(_0x39f8f2){const _0x2a3351=_0x54c4c4;getClientsWithBotID(_0x39f8f2)[_0x2a3351(0x1ec)](_0x71850c=>{const _0x60bb41=_0x2a3351;getSocket(_0x71850c['id'])[_0x60bb41(0x11f)](!![]),removeClient(_0x71850c['id']);}),pid[_0x39f8f2]&&(pid[_0x39f8f2][_0x2a3351(0x15e)](),pid[_0x39f8f2]=null);}function stopAllBots(){const _0x170a8d=_0x54c4c4;terminating=!![];const _0x14fe46=getEnabledBots();_0x14fe46[_0x170a8d(0x1ec)](_0x5ed393=>{const _0x402962=_0x170a8d;stopBot(_0x5ed393[_0x402962(0x292)]);});}function restartBot(_0x5c3520){const _0x49290d=_0x54c4c4;if(pid[_0x5c3520])pid[_0x5c3520][_0x49290d(0x15e)]();}function addBot(){const _0x38973c=_0x54c4c4;let _0x24dbef;for(let _0x39c506=0x1;_0x39c506<0x3e9;_0x39c506++){_0x24dbef=_0x39c506['toString']()[_0x38973c(0x26f)](0x3,'0');let _0x25a838=config['find'](_0x6d1482=>_0x6d1482[_0x38973c(0x292)]==_0x24dbef);if(!_0x25a838)break;}if(_0x24dbef===_0x38973c(0x206)){logger[_0x38973c(0x1d6)](_0x38973c(0x256));return;}logger[_0x38973c(0x1d6)](_0x38973c(0xda)+_0x24dbef),dbConfig['get'](_0x38973c(0x116))['push']({'botID':_0x24dbef,'botname':_0x38973c(0x19f)+_0x24dbef,'status':_0x38973c(0x1fe),'live':''})[_0x38973c(0x1ed)](),startBot([_0x24dbef,userID],{'cwd':bbpath},function(_0x574111){if(_0x574111)logger['full'](_0x574111);}),config=getConfiguration(),io['to'](_0x38973c(0xe1))['emit'](_0x38973c(0x116),config),broadcastToBots(_0x38973c(0x116),JSON[_0x38973c(0x22a)](config));}function deleteBot(_0x292ea0){const _0x3add46=_0x54c4c4;getClientsWithBotID(_0x292ea0)['forEach'](_0x146e9f=>{getSocket(_0x146e9f['id'])['disconnect'](!![]),removeClient(_0x146e9f['id']);}),dbConfig[_0x3add46(0x23d)](_0x3add46(0x116))[_0x3add46(0x16c)]({'botID':_0x292ea0})[_0x3add46(0x1ed)](),logger[_0x3add46(0x1d6)](_0x3add46(0x28d)+_0x292ea0),stopBot(_0x292ea0);try{if(fs[_0x3add46(0x1dc)](path[_0x3add46(0x1e4)](configpath,'bot-'+_0x292ea0+_0x3add46(0x1c6))))fs[_0x3add46(0x17d)](path[_0x3add46(0x1e4)](configpath,_0x3add46(0x15d)+_0x292ea0+_0x3add46(0x1c6)));if(fs['existsSync'](path['join'](configpath,'bot-'+_0x292ea0+_0x3add46(0x26c))))fs['unlinkSync'](path[_0x3add46(0x1e4)](configpath,_0x3add46(0x15d)+_0x292ea0+'-events.json'));if(fs[_0x3add46(0x1dc)](path['join'](configpath,'bot-'+_0x292ea0+'-performance.json')))fs[_0x3add46(0x17d)](path['join'](configpath,_0x3add46(0x15d)+_0x292ea0+_0x3add46(0x1e7)));if(fs['existsSync'](path[_0x3add46(0x1e4)](configpath,_0x3add46(0x15d)+_0x292ea0+_0x3add46(0xd4))))fs[_0x3add46(0x17d)](path[_0x3add46(0x1e4)](configpath,_0x3add46(0x15d)+_0x292ea0+_0x3add46(0xd4)));}catch(_0x18c84c){if(_0x18c84c)logger[_0x3add46(0x1d6)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x18c84c);}config=getConfiguration(),io['to'](_0x3add46(0xe1))[_0x3add46(0x218)]('bots',config),broadcastToBots(_0x3add46(0x116),JSON[_0x3add46(0x22a)](config));}function toggleBot(_0x2ce0b8,_0x129ec4,_0x1ea401){const _0x5163eb=_0x54c4c4;dbConfig['get'](_0x5163eb(0x116))[_0x5163eb(0x263)]({'botID':_0x2ce0b8})[_0x5163eb(0x19c)]({'status':_0x129ec4})[_0x5163eb(0x19c)]({'live':_0x1ea401})[_0x5163eb(0x1ed)]();if(_0x129ec4=='enabled'||_0x129ec4=='new')logger[_0x5163eb(0x1d6)](_0x5163eb(0xb4)+_0x2ce0b8),startBot([_0x2ce0b8,userID],{'cwd':bbpath},function(_0x3a758e){const _0x4ecda9=_0x5163eb;if(_0x3a758e)logger[_0x4ecda9(0x1d6)](_0x3a758e);});else(_0x129ec4==_0x5163eb(0xd1)||_0x129ec4==_0x5163eb(0xfc))&&(logger['full'](_0x5163eb(0x21e)+_0x2ce0b8),stopBot(_0x2ce0b8));config=getConfiguration(),io['to'](_0x5163eb(0xe1))[_0x5163eb(0x218)](_0x5163eb(0x116),config),broadcastToBots(_0x5163eb(0x116),JSON[_0x5163eb(0x22a)](config));}function toggleStatus(_0x39c7d2){const _0x4b9f43=_0x54c4c4;let _0x28ff21=dbConfig[_0x4b9f43(0x23d)](_0x4b9f43(0x116))[_0x4b9f43(0x263)]({'botID':_0x39c7d2})[_0x4b9f43(0x1b6)](),_0x1ca246;if(_0x28ff21[_0x4b9f43(0x145)]===_0x4b9f43(0x1be))_0x1ca246=_0x4b9f43(0xd1);else{if(_0x28ff21['status']==='new')_0x1ca246=_0x4b9f43(0xfc);else{if(_0x28ff21[_0x4b9f43(0x145)]===_0x4b9f43(0xfc))_0x1ca246='new';else{if(_0x28ff21['status']==='disabled')_0x1ca246=_0x4b9f43(0x1be);}}}return _0x1ca246;}function updateStatus(_0x545a0c,_0xf8340f){const _0x39d61f=_0x54c4c4;dbConfig['get'](_0x39d61f(0x116))[_0x39d61f(0x263)]({'botID':_0x545a0c})[_0x39d61f(0x19c)]({'status':_0xf8340f})[_0x39d61f(0x1ed)](),config=getConfiguration(),io['to'](_0x39d61f(0xe1))[_0x39d61f(0x218)](_0x39d61f(0x116),config),broadcastToBots('bots',JSON[_0x39d61f(0x22a)](config));}function updateLive(_0x18cd03,_0x48aa98){const _0x3d6105=_0x54c4c4;dbConfig[_0x3d6105(0x23d)](_0x3d6105(0x116))[_0x3d6105(0x263)]({'botID':_0x18cd03})[_0x3d6105(0x19c)]({'live':_0x48aa98})[_0x3d6105(0x1ed)](),config=getConfiguration(),io['to'](_0x3d6105(0xe1))[_0x3d6105(0x218)](_0x3d6105(0x116),config),broadcastToBots(_0x3d6105(0x116),JSON['stringify'](config));}function updateBotName(_0x519e16,_0x3e0b84){const _0x1d370e=_0x54c4c4;dbConfig[_0x1d370e(0x23d)](_0x1d370e(0x116))[_0x1d370e(0x263)]({'botID':_0x519e16})[_0x1d370e(0x19c)]({'botname':_0x3e0b84})['write'](),config=getConfiguration(),io['to'](_0x1d370e(0xe1))[_0x1d370e(0x218)](_0x1d370e(0x116),config),broadcastToBots('bots',JSON[_0x1d370e(0x22a)](config));}function updateBotManager(){const _0x5f6b06=_0x54c4c4;config=getConfiguration(),io['to'](_0x5f6b06(0xe1))[_0x5f6b06(0x218)](_0x5f6b06(0x116),config),broadcastToBots('bots',JSON[_0x5f6b06(0x22a)](config));}function toggleBotMode(_0x345dd1){const _0x41cf5a=_0x54c4c4;if(pid[_0x345dd1])pid[_0x345dd1][_0x41cf5a(0x1b1)]({'function':_0x41cf5a(0x224),'args':null});else{const _0x2f87bd=configpath+'bot-'+_0x345dd1+'-config.json',_0x76ed61=fs['readFileSync'](_0x2f87bd),_0x56e022=JSON[_0x41cf5a(0x138)](_0x76ed61),_0x42bdb0=_0x56e022[_0x41cf5a(0x151)][0x0][_0x41cf5a(0x219)];_0x56e022[_0x41cf5a(0x151)][0x0][_0x41cf5a(0x219)]=!_0x42bdb0;const _0x143326=JSON[_0x41cf5a(0x22a)](_0x56e022,null,0x2);fs[_0x41cf5a(0x189)](_0x2f87bd,_0x143326),config=getConfiguration(),io['to'](_0x41cf5a(0xe1))[_0x41cf5a(0x218)](_0x41cf5a(0x116),config),broadcastToBots(_0x41cf5a(0x116),JSON[_0x41cf5a(0x22a)](config));}}function validateTelegram(_0x348c4e){const _0x303238=_0x54c4c4;if(_0x348c4e[_0x303238(0x1a8)][_0x303238(0x27b)]!=settings[_0x303238(0x13a)]&&'@'+_0x348c4e['from'][_0x303238(0x27b)]!=settings[_0x303238(0x13a)]||_0x348c4e[_0x303238(0x92)]['id']!=settings['telegramChatId'])return sendTelegram(_0x348c4e[_0x303238(0x92)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x303238(0x173)}),![];return!![];}async function initTelegram(){const _0x3c8305=_0x54c4c4;tgBot&&(await tgBot[_0x3c8305(0xaf)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x3c8305(0x287)]);let _0x49e999='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x49e999+='\x0a',_0x49e999+='/enable\x20-\x20enable\x20notifications\x0a',_0x49e999+=_0x3c8305(0x1a4),_0x49e999+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x49e999+=_0x3c8305(0x14c),_0x49e999+=_0x3c8305(0x1b9),_0x49e999+='/off\x20-\x20stop\x20bot(s)\x0a',_0x49e999+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x49e999+=_0x3c8305(0x1f2),_0x49e999+=_0x3c8305(0x90),_0x49e999+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x49e999+=_0x3c8305(0x1bc),_0x49e999+=_0x3c8305(0x27c),_0x49e999+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0x49e999+=_0x3c8305(0x1d4),_0x49e999+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x49e999+=_0x3c8305(0xc1);let _0x1285c5=_0x3c8305(0x21d);_0x1285c5+='\x0a',_0x1285c5+=_0x49e999,tgBot['catch']((_0x501d9d,_0x4b9112)=>{const _0x1b4b65=_0x3c8305;logger['simple'](getTimeStamp()+_0x1b4b65(0x264)),logger[_0x1b4b65(0x28a)](_0x1b4b65(0x200),_0x501d9d);}),tgBot['use'](async(_0x306dff,_0x5c5527)=>{const _0x1d2f20=_0x3c8305;if(settings[_0x1d2f20(0x107)]||_0x306dff[_0x1d2f20(0x129)]['message'][_0x1d2f20(0x240)]!=_0x1d2f20(0xc2)){if(!validateTelegram(_0x306dff))return;}_0x5c5527();}),tgBot['command']('start',async _0xfc4bff=>{const _0x30512d=_0x3c8305;if(_0xfc4bff[_0x30512d(0x1a8)][_0x30512d(0x27b)]==settings[_0x30512d(0x13a)]||'@'+_0xfc4bff[_0x30512d(0x1a8)]['username']==settings[_0x30512d(0x13a)]){if(!settings[_0x30512d(0x107)])updateSetting(_0x30512d(0x107),_0xfc4bff[_0x30512d(0x92)]['id']);else{if(!validateTelegram(_0xfc4bff))return;}}else{if(!validateTelegram(_0xfc4bff))return;}updateSetting(_0x30512d(0x22b),!![]),await sendTelegram(_0xfc4bff[_0x30512d(0x92)]['id'],_0x1285c5);}),tgBot['command'](_0x3c8305(0x1ee),async _0x42724b=>{const _0x2866c0=_0x3c8305;updateSetting(_0x2866c0(0x22b),!![]),await sendTelegram(_0x42724b[_0x2866c0(0x92)]['id'],_0x2866c0(0xa5));}),tgBot[_0x3c8305(0xf2)](_0x3c8305(0xe4),async _0x3a3f73=>{const _0x151815=_0x3c8305;await sendTelegram(_0x3a3f73['chat']['id'],_0x151815(0x1c4)),updateSetting('telegramEnabled',![]);}),tgBot[_0x3c8305(0xf2)]('config',async _0x2eb326=>{const _0x314e6e=_0x3c8305,_0x36a40d=Markup['inlineKeyboard']([Markup[_0x314e6e(0x203)]['callback']('Orders',_0x314e6e(0x20d)),Markup[_0x314e6e(0x203)][_0x314e6e(0x28b)](_0x314e6e(0x270),_0x314e6e(0x188)),Markup[_0x314e6e(0x203)][_0x314e6e(0x28b)]('All',_0x314e6e(0x268))]);_0x2eb326[_0x314e6e(0x17a)](_0x314e6e(0x1af),_0x36a40d);}),tgBot[_0x3c8305(0x15b)](_0x3c8305(0x20d),async _0x4eb16a=>{const _0x58d739=_0x3c8305;_0x4eb16a[_0x58d739(0x103)](),updateSetting(_0x58d739(0x11e),'orders'),updateSetting(_0x58d739(0x22b),!![]),await sendTelegram(_0x4eb16a[_0x58d739(0x92)]['id'],_0x58d739(0xf9));}),tgBot[_0x3c8305(0x15b)]('config_alerts',async _0x55c2d0=>{const _0x2c44e2=_0x3c8305;_0x55c2d0[_0x2c44e2(0x103)](),updateSetting(_0x2c44e2(0x11e),_0x2c44e2(0x86)),updateSetting(_0x2c44e2(0x22b),!![]),await sendTelegram(_0x55c2d0['chat']['id'],_0x2c44e2(0x1e8));}),tgBot[_0x3c8305(0x15b)]('config_all',async _0x332070=>{const _0x3b1318=_0x3c8305;_0x332070[_0x3b1318(0x103)](),updateSetting(_0x3b1318(0x11e),_0x3b1318(0x1b0)),updateSetting(_0x3b1318(0x22b),!![]),await sendTelegram(_0x332070[_0x3b1318(0x92)]['id'],_0x3b1318(0xed));}),tgBot[_0x3c8305(0xf2)](_0x3c8305(0x145),async _0x109067=>{const _0x281894=_0x3c8305,_0x4f348d=getBotsWithMode();let _0x2e79b6=_0x281894(0xe8);config['forEach'](_0xc14562=>{const _0x253d7e=_0x281894,_0x56fd48=_0x4f348d[_0x253d7e(0x263)](_0x25928c=>_0x25928c['botID']==_0xc14562['botID'])[_0x253d7e(0x17e)];_0x2e79b6+=_0x253d7e(0x19f)+_0xc14562['botID']+':\x20'+_0xc14562[_0x253d7e(0x145)]+_0x253d7e(0x19b)+_0x56fd48+'\x20|\x20'+_0xc14562[_0x253d7e(0x95)]+'\x0a';}),_0x2e79b6+='\x0a',_0x2e79b6+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x2e79b6+=!settings[_0x281894(0x22b)]?_0x281894(0x26a):_0x281894(0x26d),_0x2e79b6+=settings[_0x281894(0x22b)]?settings['telegramEvents']=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings['telegramEvents']+'\x20only\x0a':'',await sendTelegram(_0x109067['chat']['id'],_0x2e79b6,{'parse_mode':'HTML'});}),tgBot[_0x3c8305(0xf2)]('restart',async _0x12b1b9=>{const _0x514b75=_0x3c8305,_0x4feaef=getEnabledBots();if(_0x4feaef[_0x514b75(0x135)]==0x0)await sendTelegram(_0x12b1b9['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x4feaef[_0x514b75(0x135)]>0x1)_0x4feaef[_0x514b75(0x106)]({'botID':_0x514b75(0x1b0)});let _0x17a531=[],_0x2d5758=[];const _0x5c4404=_0x4feaef[_0x514b75(0x135)]%0x4==0x0||_0x4feaef[_0x514b75(0x135)]%0x4==0x3||_0x4feaef[_0x514b75(0x135)]%0x3==0x1?0x4:0x3;let _0x52b76e=0x0;_0x4feaef[_0x514b75(0x1ec)]((_0x45d289,_0x4e3ab2)=>{const _0x58cdb0=_0x514b75;if(_0x4e3ab2%_0x5c4404==0x0)_0x2d5758=[];_0x2d5758[_0x58cdb0(0x106)](Markup[_0x58cdb0(0x203)][_0x58cdb0(0x28b)](_0x45d289['botID']==_0x58cdb0(0x1b0)?_0x58cdb0(0x1f8):_0x58cdb0(0x19f)+_0x45d289['botID'],_0x58cdb0(0x229)+_0x45d289[_0x58cdb0(0x292)])),_0x4e3ab2%_0x5c4404==0x0&&(_0x17a531[_0x52b76e]=_0x2d5758,_0x52b76e++);});const _0x569ba4=Markup[_0x514b75(0x239)](_0x17a531);_0x12b1b9[_0x514b75(0x17a)](_0x514b75(0xb7),_0x569ba4);}}),tgBot[_0x3c8305(0x15b)](/restart_(.+)/,async _0x33e965=>{const _0x1da88e=_0x3c8305,_0x5e4c69=_0x33e965[_0x1da88e(0x184)][0x1];_0x33e965[_0x1da88e(0x103)](),_0x5e4c69=='all'?config[_0x1da88e(0x1ec)](_0x279170=>{const _0x15a0a9=_0x1da88e;restartBot(_0x279170[_0x15a0a9(0x292)]);}):restartBot(_0x5e4c69);}),tgBot[_0x3c8305(0xf2)]('on',async _0x5cd130=>{const _0x2d6bf8=_0x3c8305,_0x36af33=getDisabledBots();if(_0x36af33[_0x2d6bf8(0x135)]==0x0)await sendTelegram(_0x5cd130[_0x2d6bf8(0x92)]['id'],_0x2d6bf8(0x19a));else{if(_0x36af33[_0x2d6bf8(0x135)]>0x1)_0x36af33[_0x2d6bf8(0x106)]({'botID':'all'});let _0x10f154=[],_0x5d93c4=[];const _0x2731c7=_0x36af33[_0x2d6bf8(0x135)]%0x4==0x0||_0x36af33['length']%0x4==0x3||_0x36af33[_0x2d6bf8(0x135)]%0x3==0x1?0x4:0x3;let _0x3b4099=0x0;_0x36af33[_0x2d6bf8(0x1ec)]((_0xbeb4c7,_0x1a5376)=>{const _0x16efb0=_0x2d6bf8;if(_0x1a5376%_0x2731c7==0x0)_0x5d93c4=[];_0x5d93c4[_0x16efb0(0x106)](Markup['button'][_0x16efb0(0x28b)](_0xbeb4c7[_0x16efb0(0x292)]=='all'?'All\x20bots':_0x16efb0(0x19f)+_0xbeb4c7[_0x16efb0(0x292)],_0x16efb0(0x7e)+_0xbeb4c7[_0x16efb0(0x292)])),_0x1a5376%_0x2731c7==0x0&&(_0x10f154[_0x3b4099]=_0x5d93c4,_0x3b4099++);});const _0x5559fa=Markup[_0x2d6bf8(0x239)](_0x10f154);_0x5cd130[_0x2d6bf8(0x17a)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x5559fa);}}),tgBot[_0x3c8305(0x15b)](/on_(.+)/,async _0x1291d4=>{const _0x142023=_0x3c8305,_0x41089a=_0x1291d4[_0x142023(0x184)][0x1];_0x1291d4[_0x142023(0x103)]();if(_0x41089a==_0x142023(0x1b0)){const _0xe82650=getDisabledBots();await sendTelegram(_0x1291d4[_0x142023(0x92)]['id'],_0x142023(0x1db)),_0xe82650[_0x142023(0x1ec)](_0x5c5547=>{const _0x1dcd3a=_0x142023;if(_0x5c5547[_0x1dcd3a(0x292)]!=_0x1dcd3a(0x1b0))toggleBot(_0x5c5547[_0x1dcd3a(0x292)],toggleStatus(_0x5c5547[_0x1dcd3a(0x292)]),'stopped');});}else await sendTelegram(_0x1291d4['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x41089a),toggleBot(_0x41089a,toggleStatus(_0x41089a),_0x142023(0x1f4));}),tgBot[_0x3c8305(0xf2)](_0x3c8305(0x11a),async _0x35e6ee=>{const _0x4cd15e=_0x3c8305,_0xfc3441=getEnabledBots();if(_0xfc3441[_0x4cd15e(0x135)]==0x0)await sendTelegram(_0x35e6ee['chat']['id'],_0x4cd15e(0xfe));else{if(_0xfc3441[_0x4cd15e(0x135)]>0x1)_0xfc3441['push']({'botID':_0x4cd15e(0x1b0)});let _0x3de2f5=[],_0x461b98=[];const _0x317743=_0xfc3441['length']%0x4==0x0||_0xfc3441[_0x4cd15e(0x135)]%0x4==0x3||_0xfc3441[_0x4cd15e(0x135)]%0x3==0x1?0x4:0x3;let _0x528e68=0x0;_0xfc3441[_0x4cd15e(0x1ec)]((_0x514a8a,_0xc548c1)=>{const _0x247cb5=_0x4cd15e;if(_0xc548c1%_0x317743==0x0)_0x461b98=[];_0x461b98[_0x247cb5(0x106)](Markup[_0x247cb5(0x203)][_0x247cb5(0x28b)](_0x514a8a[_0x247cb5(0x292)]==_0x247cb5(0x1b0)?_0x247cb5(0x1f8):_0x247cb5(0x19f)+_0x514a8a['botID'],_0x247cb5(0x15a)+_0x514a8a[_0x247cb5(0x292)])),_0xc548c1%_0x317743==0x0&&(_0x3de2f5[_0x528e68]=_0x461b98,_0x528e68++);});const _0xd74ea4=Markup[_0x4cd15e(0x239)](_0x3de2f5);_0x35e6ee['reply'](_0x4cd15e(0x1ef),_0xd74ea4);}}),tgBot[_0x3c8305(0x15b)](/off_(.+)/,async _0xcaf540=>{const _0x155a17=_0x3c8305,_0x543ace=_0xcaf540[_0x155a17(0x184)][0x1];_0xcaf540[_0x155a17(0x103)]();if(_0x543ace=='all'){const _0x1d0f5e=getEnabledBots();await sendTelegram(_0xcaf540['chat']['id'],_0x155a17(0x1b7)),_0x1d0f5e[_0x155a17(0x1ec)](_0x19b2cd=>{const _0x472e93=_0x155a17;if(_0x19b2cd['botID']!=_0x472e93(0x1b0))toggleBot(_0x19b2cd[_0x472e93(0x292)],toggleStatus(_0x19b2cd['botID']),_0x472e93(0x1f4));});}else await sendTelegram(_0xcaf540['chat']['id'],_0x155a17(0x162)+_0x543ace),toggleBot(_0x543ace,toggleStatus(_0x543ace),_0x155a17(0x1f4));}),tgBot['command'](_0x3c8305(0x85),async _0x256910=>{const _0x68dd3a=_0x3c8305,_0x41dbd2=getEnabledBots();if(_0x41dbd2[_0x68dd3a(0x135)]==0x0)await sendTelegram(_0x256910[_0x68dd3a(0x92)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x41dbd2[_0x68dd3a(0x135)]>0x1){let _0x152680=[],_0x569c4=[];const _0x2a2e1c=_0x41dbd2[_0x68dd3a(0x135)]%0x4==0x0||_0x41dbd2[_0x68dd3a(0x135)]%0x4==0x3||_0x41dbd2[_0x68dd3a(0x135)]%0x3==0x1?0x4:0x3;let _0x5d6342=0x0;_0x41dbd2[_0x68dd3a(0x1ec)]((_0xd46c69,_0x200c20)=>{const _0x58e8a3=_0x68dd3a;if(_0x200c20%_0x2a2e1c==0x0)_0x569c4=[];_0x569c4['push'](Markup['button'][_0x58e8a3(0x28b)](_0x58e8a3(0x19f)+_0xd46c69[_0x58e8a3(0x292)],'metrics_'+_0xd46c69[_0x58e8a3(0x292)])),_0x200c20%_0x2a2e1c==0x0&&(_0x152680[_0x5d6342]=_0x569c4,_0x5d6342++);});const _0x111014=Markup[_0x68dd3a(0x239)](_0x152680);_0x256910[_0x68dd3a(0x17a)](_0x68dd3a(0x1e2),_0x111014);}else{const _0x3a0272=_0x41dbd2[0x0]['botID'];if(pid[_0x3a0272])pid[_0x3a0272][_0x68dd3a(0x1b1)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x51beba=>{const _0x7cd0af=_0x3c8305,_0x721fd3=_0x51beba['match'][0x1];_0x51beba['editMessageReplyMarkup']();if(pid[_0x721fd3])pid[_0x721fd3][_0x7cd0af(0x1b1)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x3c8305(0xf2)]('portfolio',async _0x4e8882=>{const _0x5344f0=_0x3c8305,_0x15697c=getEnabledBots();if(_0x15697c[_0x5344f0(0x135)]==0x0)await sendTelegram(_0x4e8882[_0x5344f0(0x92)]['id'],_0x5344f0(0xfe));else{if(_0x15697c['length']>0x1){let _0x2f608b=[],_0xa97a3d=[];const _0x36edaa=_0x15697c[_0x5344f0(0x135)]%0x4==0x0||_0x15697c[_0x5344f0(0x135)]%0x4==0x3||_0x15697c[_0x5344f0(0x135)]%0x3==0x1?0x4:0x3;let _0x3d2a0a=0x0;_0x15697c[_0x5344f0(0x1ec)]((_0x4d3a52,_0xca0de3)=>{const _0x401057=_0x5344f0;if(_0xca0de3%_0x36edaa==0x0)_0xa97a3d=[];_0xa97a3d['push'](Markup[_0x401057(0x203)][_0x401057(0x28b)](_0x401057(0x19f)+_0x4d3a52['botID'],_0x401057(0xec)+_0x4d3a52[_0x401057(0x292)])),_0xca0de3%_0x36edaa==0x0&&(_0x2f608b[_0x3d2a0a]=_0xa97a3d,_0x3d2a0a++);});const _0x494311=Markup[_0x5344f0(0x239)](_0x2f608b);_0x4e8882[_0x5344f0(0x17a)](_0x5344f0(0x199),_0x494311);}else{const _0x2af0ec=_0x15697c[0x0][_0x5344f0(0x292)];if(pid[_0x2af0ec])pid[_0x2af0ec]['send']({'function':_0x5344f0(0x231),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x578c75=>{const _0x241091=_0x3c8305,_0x23b8ff=_0x578c75[_0x241091(0x184)][0x1];_0x578c75['editMessageReplyMarkup']();if(pid[_0x23b8ff])pid[_0x23b8ff][_0x241091(0x1b1)]({'function':_0x241091(0x231),'args':null});}),tgBot[_0x3c8305(0xf2)]('logs',async _0x676664=>{const _0x2784db=_0x3c8305,_0x3dc221=_0x2784db(0xb5);await zipFiles(_0x3dc221);const _0x366d23=zippath+(_0x3dc221+'.zip');_0x676664[_0x2784db(0x1fa)]({'source':_0x366d23})[_0x2784db(0x113)](()=>{})[_0x2784db(0x25e)](_0x328a9a=>logger[_0x2784db(0x28a)](_0x2784db(0x8d)+_0x3dc221+_0x2784db(0x20a),_0x328a9a));}),tgBot[_0x3c8305(0xf2)](_0x3c8305(0x25d),async _0x985581=>{const _0x316dd4=_0x3c8305,_0x43a589='backup';await backupConfigFiles(),await zipFiles(_0x43a589);const _0x500e93=zippath+(_0x43a589+'.zip');_0x985581['replyWithDocument']({'source':_0x500e93})['then'](()=>{})[_0x316dd4(0x25e)](_0x405dfd=>logger['debug'](_0x316dd4(0x8d)+_0x43a589+_0x316dd4(0x20a),_0x405dfd));}),tgBot[_0x3c8305(0xf2)](_0x3c8305(0x129),async _0x49c882=>{const _0x4d0f04=_0x3c8305;await getMessages();if(!updateAvailable)await sendTelegram(_0x49c882['chat']['id'],_0x4d0f04(0x192));else{if(!validInstallation)await sendTelegram(_0x49c882['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x1fe1c0=Markup[_0x4d0f04(0x239)]([Markup['button']['callback'](_0x4d0f04(0x181),'update_yes'),Markup[_0x4d0f04(0x203)][_0x4d0f04(0x28b)]('No','update_no')]);_0x49c882[_0x4d0f04(0x17a)](_0x4d0f04(0x118),_0x1fe1c0);}}}),tgBot[_0x3c8305(0x15b)](/update_(.+)/,async _0x311133=>{const _0x32003e=_0x3c8305,_0x377487=_0x311133[_0x32003e(0x184)][0x1];_0x311133['editMessageReplyMarkup'](),_0x377487==_0x32003e(0x1bf)&&(await sendTelegram(_0x311133[_0x32003e(0x92)]['id'],_0x32003e(0x243)),updateBB(_0x32003e(0x129))),_0x377487=='no'&&await sendTelegram(_0x311133[_0x32003e(0x92)]['id'],_0x32003e(0x119));}),tgBot['command'](_0x3c8305(0x140),async _0x3a6c48=>{const _0x2e178e=_0x3c8305;if(!validInstallation)await sendTelegram(_0x3a6c48[_0x2e178e(0x92)]['id'],_0x2e178e(0x161));else{const _0x2ef10f=Markup[_0x2e178e(0x239)]([Markup[_0x2e178e(0x203)]['callback']('Yes',_0x2e178e(0x109)),Markup[_0x2e178e(0x203)][_0x2e178e(0x28b)]('No',_0x2e178e(0x18b))]);_0x3a6c48[_0x2e178e(0x17a)](_0x2e178e(0x20e),_0x2ef10f);}}),tgBot['action'](/reinstall_(.+)/,async _0x6bffa1=>{const _0x13791d=_0x3c8305,_0xe27001=_0x6bffa1[_0x13791d(0x184)][0x1];_0x6bffa1[_0x13791d(0x103)](),_0xe27001=='yes'&&(await sendTelegram(_0x6bffa1[_0x13791d(0x92)]['id'],_0x13791d(0xf1)),updateBB(_0x13791d(0x140))),_0xe27001=='no'&&await sendTelegram(_0x6bffa1[_0x13791d(0x92)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x3c8305(0xf2)](_0x3c8305(0xe5),async _0x415780=>{const _0x123c7f=_0x3c8305,_0x237c54=getBotsWithMode();if(_0x237c54[_0x123c7f(0x135)]==0x0)await sendTelegram(_0x415780['chat']['id'],_0x123c7f(0xfe));else{let _0x5c5cdf=[],_0x46f90a=[];const _0xbdc88a=0x2;let _0xf4355=0x0;_0x237c54[_0x123c7f(0x1ec)]((_0x5c0fd4,_0x244dac)=>{const _0x1d221c=_0x123c7f;if(_0x244dac%_0xbdc88a==0x0)_0x46f90a=[];_0x46f90a[_0x1d221c(0x106)](Markup[_0x1d221c(0x203)][_0x1d221c(0x28b)]('Bot\x20'+_0x5c0fd4[_0x1d221c(0x292)]+'\x20('+_0x5c0fd4[_0x1d221c(0x17e)]+')','toggle_'+_0x5c0fd4[_0x1d221c(0x292)])),_0x244dac%_0xbdc88a==0x0&&(_0x5c5cdf[_0xf4355]=_0x46f90a,_0xf4355++);});const _0x160029=Markup[_0x123c7f(0x239)](_0x5c5cdf);_0x415780['reply'](_0x123c7f(0x11b),_0x160029);}}),tgBot[_0x3c8305(0x15b)](/toggle_(.+)/,async _0x27b9a5=>{const _0x188ce0=_0x3c8305,_0x3845d9=_0x27b9a5[_0x188ce0(0x184)][0x1];_0x27b9a5['editMessageReplyMarkup']();const _0x1db35f=getBotsWithMode(),_0xe1e1f4=_0x1db35f[_0x188ce0(0x263)](_0x389886=>_0x389886[_0x188ce0(0x292)]==_0x3845d9),_0x569178=_0xe1e1f4[_0x188ce0(0x17e)]==_0x188ce0(0xa6)?_0x188ce0(0xbc):_0x188ce0(0xa6);await sendTelegram(_0x27b9a5['chat']['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x3845d9+_0x188ce0(0x112)+_0x569178+_0x188ce0(0xe7)),toggleBotMode(_0x3845d9);}),tgBot[_0x3c8305(0xf2)](_0x3c8305(0x128),async _0x42c619=>{let _0x3da089='';config['forEach'](_0x584aad=>{const _0x220969=_0x1465;_0x3da089+=_0x220969(0x19f)+_0x584aad[_0x220969(0x292)]+':\x20'+_0x584aad[_0x220969(0x13f)]+'\x0a';}),await sendTelegram(_0x42c619['chat']['id'],_0x3da089,{'parse_mode':'HTML'});}),tgBot[_0x3c8305(0xf2)](_0x3c8305(0xe3),async _0x135a0a=>{const _0x1ae2a6=_0x3c8305;await sendTelegram(_0x135a0a[_0x1ae2a6(0x92)]['id'],_0x49e999);}),process[_0x3c8305(0x193)]('SIGINT',()=>tgBot[_0x3c8305(0xaf)](_0x3c8305(0x194))),process[_0x3c8305(0x193)](_0x3c8305(0x1ac),()=>tgBot[_0x3c8305(0xaf)](_0x3c8305(0x1ac))),tgBot[_0x3c8305(0x1de)]();}function disableTelegram(){const _0x1077a2=_0x54c4c4;tgBot&&tgBot[_0x1077a2(0xaf)]();}async function sendTelegram(_0x2fb47f,_0x334c92,_0x31ec0a){const _0x61410b=_0x54c4c4;_0x31ec0a={..._0x31ec0a,'disable_web_page_preview':!![]};try{await tgBot[_0x61410b(0x20c)][_0x61410b(0x26e)](_0x2fb47f,_0x334c92,_0x31ec0a);}catch(_0x3fc944){logger[_0x61410b(0x28a)](_0x61410b(0x198),_0x3fc944);}}async function sendTelegramBot(_0x10960a,_0x1896e2){const _0x1080ea=_0x54c4c4;if(settings[_0x1080ea(0x22b)]){if(settings[_0x1080ea(0x11e)]==_0x1080ea(0x1b0)||(_0x1896e2[_0x1080ea(0x262)]=='error'||_0x1896e2[_0x1080ea(0x262)]==_0x1080ea(0x160)||_0x1896e2[_0x1080ea(0x262)]==_0x1080ea(0x1e6))&&settings[_0x1080ea(0x11e)]==_0x1080ea(0x86)||_0x1896e2[_0x1080ea(0x262)]==_0x1080ea(0xeb)&&settings[_0x1080ea(0x11e)]=='orders'){if(tgBot&&settings[_0x1080ea(0x107)]){if(_0x1896e2[_0x1080ea(0x24b)])await sendTelegram(settings['telegramChatId'],_0x1896e2['botname']+'\x20>\x20'+_0x1896e2[_0x1080ea(0x291)]);else await sendTelegram(settings[_0x1080ea(0x107)],_0x1080ea(0x19f)+_0x10960a+_0x1080ea(0x1b4)+_0x1896e2['event']);}}}}async function sendTelegramMsg(_0x1bba18,_0x49045f=_0x54c4c4(0x173)){const _0x269a6a=_0x54c4c4;return settings[_0x269a6a(0x22b)]&&tgBot&&settings[_0x269a6a(0x107)]?(await sendTelegram(settings[_0x269a6a(0x107)],_0x1bba18,{'parse_mode':_0x49045f}),!![]):![];}function getDeviceWithIp(_0x35e57c){const _0x50e214=_0x54c4c4;return devices[_0x50e214(0x263)](_0x57c340=>_0x57c340['ip']===_0x35e57c);}async function temporaryAccess2FA(_0x6ec1a0,_0x54c6d2){const _0x25c426=_0x54c4c4;let _0x40690a=new Date(),_0x103af0=![];if(lastIpApproval){if(_0x40690a-lastIpApproval<0x1388)_0x103af0=!![];}lastIpApproval=new Date();if(_0x103af0)return;if(tgBot&&settings[_0x25c426(0x107)]){const _0x5b3e23=uuidRandom();tmpStorage[_0x5b3e23]={'uuid':_0x6ec1a0,'externalip':_0x54c6d2};const _0x13a129=Markup[_0x25c426(0x239)]([Markup[_0x25c426(0x203)]['callback'](_0x25c426(0x137),_0x25c426(0x114)+_0x5b3e23),Markup[_0x25c426(0x203)][_0x25c426(0x28b)](_0x25c426(0xfd),_0x25c426(0x166)+_0x5b3e23),Markup[_0x25c426(0x203)][_0x25c426(0x28b)]('30\x20min',_0x25c426(0x1ea)+_0x5b3e23),Markup[_0x25c426(0x203)][_0x25c426(0x28b)](_0x25c426(0x152),_0x25c426(0x1c7)+_0x5b3e23)]);await sendTelegram(settings[_0x25c426(0x107)],_0x25c426(0x213)+normalizeIP(_0x54c6d2)[_0x25c426(0x297)]+'\x20?',_0x13a129),tgBot[_0x25c426(0x15b)](/tempaccess_(.+)_(.+)/,async _0x40b44c=>{const _0x3b2991=_0x25c426,_0x5c7085=_0x40b44c['match'][0x1],_0x137563=_0x40b44c[_0x3b2991(0x184)][0x2],{uuid:_0x1e25fa,externalip:_0x4f24f0}=tmpStorage[_0x137563];delete tmpStorage[_0x137563],_0x40b44c['editMessageReplyMarkup'](),devices[_0x1e25fa][_0x3b2991(0xff)]={'clientip':_0x4f24f0,'timestamp':new Date()['getTime'](),'expiry':_0x5c7085},_0x5c7085!=_0x3b2991(0x152)?(await sendTelegram(_0x40b44c[_0x3b2991(0x92)]['id'],_0x3b2991(0x11c)+_0x5c7085+_0x3b2991(0x220),{'parse_mode':_0x3b2991(0x173)}),io['to'](_0x1e25fa)['emit'](_0x3b2991(0x145),{'access':{'allow':![],'reason':_0x3b2991(0x1a0),'token':null}})):(await sendTelegram(_0x40b44c[_0x3b2991(0x92)]['id'],_0x3b2991(0x246)),io['to'](_0x1e25fa)[_0x3b2991(0x218)]('status',{'access':{'allow':![],'reason':_0x3b2991(0xb9),'token':null}}));});}}async function loginAccess2FA(_0x263b16,_0x44e485){const _0x289b2e=_0x54c4c4;if(tgBot&&settings[_0x289b2e(0x107)]){const _0x498639=uuidRandom();tmpStorage[_0x498639]={'uuid':_0x263b16,'externalip':_0x44e485};const _0x1b2744=Markup[_0x289b2e(0x239)]([Markup['button'][_0x289b2e(0x28b)](_0x289b2e(0xf4),_0x289b2e(0xbf)+loginExpiry+'_'+_0x498639),Markup[_0x289b2e(0x203)]['callback'](_0x289b2e(0x152),'login2fa_reject_'+_0x498639)]);await sendTelegram(settings[_0x289b2e(0x107)],_0x289b2e(0x19e)+normalizeIP(_0x44e485)['show']+'\x20?',_0x1b2744),tgBot[_0x289b2e(0x15b)](/login2fa_(.+)_(.+)/,async _0x536a35=>{const _0x1235d8=_0x289b2e,_0x530df6=_0x536a35['match'][0x1],_0x549ac3=_0x536a35[_0x1235d8(0x184)][0x2],{uuid:_0x950fe5,externalip:_0x3c4c1c}=tmpStorage[_0x549ac3];delete tmpStorage[_0x549ac3],_0x536a35[_0x1235d8(0x103)](),devices[_0x950fe5][_0x1235d8(0xde)]={'clientip':_0x3c4c1c,'timestamp':new Date()[_0x1235d8(0x253)](),'expiry':_0x530df6},_0x530df6!=_0x1235d8(0x152)?(await sendTelegram(_0x536a35[_0x1235d8(0x92)]['id'],_0x1235d8(0x144),{'parse_mode':'HTML'}),io['to'](_0x950fe5)[_0x1235d8(0x218)]('status',{'access':{'allow':![],'reason':_0x1235d8(0x1a0),'token':null}})):(await sendTelegram(_0x536a35[_0x1235d8(0x92)]['id'],_0x1235d8(0xfa)),io['to'](_0x950fe5)[_0x1235d8(0x218)]('status',{'access':{'allow':![],'reason':_0x1235d8(0x185),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3f868b=_0x54c4c4;return dbConfig['get'](_0x3f868b(0x116))[_0x3f868b(0x1fc)](_0x3f868b(0x292))[_0x3f868b(0x27d)]({'status':_0x3f868b(0x1be)})['value']()||[];}function getDisabledBots(){const _0x56a3b4=_0x54c4c4;return dbConfig['get']('bots')[_0x56a3b4(0x1fc)](_0x56a3b4(0x292))[_0x56a3b4(0x27d)]({'status':_0x56a3b4(0xd1)})[_0x56a3b4(0x1b6)]()||[];}function getBotAttributes(_0x2cde34){const _0x299610=_0x54c4c4;let _0x4668ee={};const _0x217b18=configpath+'bot-'+_0x2cde34+_0x299610(0x1c6),_0x18d354=fs['existsSync'](_0x217b18);if(_0x18d354){const _0x1217ea=fs[_0x299610(0x217)](_0x217b18);try{const _0x4366ac=JSON[_0x299610(0x138)](_0x1217ea),_0x3ac12d=_0x4366ac?_0x4366ac[_0x299610(0x151)][0x0][_0x299610(0x219)]:![];_0x4668ee[_0x299610(0x17e)]=_0x3ac12d?'auto':_0x299610(0xbc),_0x4668ee['botname']=_0x4366ac?_0x4366ac[_0x299610(0x151)][0x0][_0x299610(0x13f)]:_0x299610(0x19f)+_0x2cde34;}catch(_0x3d1c23){_0x4668ee[_0x299610(0x17e)]='manual',_0x4668ee['botname']='Bot\x20'+_0x2cde34;}}else _0x4668ee[_0x299610(0x17e)]='manual',_0x4668ee['botname']='Bot\x20'+_0x2cde34;return _0x4668ee;}function getBotsWithMode(){const _0x216910=_0x54c4c4,_0x44c736=dbConfig[_0x216910(0x23d)](_0x216910(0x116))[_0x216910(0x1fc)](_0x216910(0x292))['value']()||[];return _0x44c736[_0x216910(0x1ec)](_0x3560c5=>{const _0x2372e4=_0x216910;let _0xe3d17b=getBotAttributes(_0x3560c5[_0x2372e4(0x292)]);_0x3560c5[_0x2372e4(0x17e)]=_0xe3d17b[_0x2372e4(0x17e)];}),_0x44c736;}function getBotExchanges(){const _0x1420c7=_0x54c4c4;let _0x4f9288=[];const _0x1f147e=dbConfig[_0x1420c7(0x23d)]('bots')[_0x1420c7(0x1fc)](_0x1420c7(0x292))[_0x1420c7(0x1b6)]()||[];_0x1f147e[_0x1420c7(0x1ec)](_0x6b214d=>{const _0x929e08=_0x1420c7;if(_0x6b214d[_0x929e08(0x145)]==_0x929e08(0x1be)){const _0xb13f6d=configpath+_0x929e08(0x15d)+_0x6b214d[_0x929e08(0x292)]+_0x929e08(0x1c6),_0x12fbce=fs[_0x929e08(0x1dc)](_0xb13f6d);let _0x504830;if(_0x12fbce){const _0x306bdb=fs[_0x929e08(0x217)](_0xb13f6d);try{const _0x5efaa1=JSON['parse'](_0x306bdb);_0x504830=_0x5efaa1?_0x5efaa1['bot'][0x0][_0x929e08(0xa7)]:null;}catch(_0x1e36bc){}}if(_0x504830)_0x4f9288[_0x929e08(0x106)](_0x504830);}});const _0x764072=[...new Set(_0x4f9288)][_0x1420c7(0x104)]();return _0x764072;}async function initUser(){const _0x169bf3=_0x54c4c4;if(!settings[_0x169bf3(0xc9)]){const _0x350d18=uuidRandom();mixpanel[_0x169bf3(0x281)](_0x350d18),updateSetting(_0x169bf3(0xc9),_0x350d18);}}async function initSecure(){const _0x5cbb25=_0x54c4c4;let _0x41cfbe=getSecure();if(!_0x41cfbe[_0x5cbb25(0x1d9)](_0x5cbb25(0x122))){let _0x414c2f=await generateKeys();_0x41cfbe[_0x5cbb25(0x1b5)]=_0x414c2f[_0x5cbb25(0x1b5)],_0x41cfbe[_0x5cbb25(0x130)]=_0x414c2f[_0x5cbb25(0x130)],_0x41cfbe[_0x5cbb25(0x122)]=crypto[_0x5cbb25(0x13b)](0x20)[_0x5cbb25(0x1b3)](_0x5cbb25(0x83));;storeSecure(_0x41cfbe);}}function getSettings(){const _0x57c5db=_0x54c4c4;return dbSettings[_0x57c5db(0x23d)](_0x57c5db(0x228))[_0x57c5db(0x1b6)]()||{};}function getSecure(){const _0x30b0d0=_0x54c4c4;return dbSecure[_0x30b0d0(0x23d)](_0x30b0d0(0xce))[_0x30b0d0(0x1b6)]()||{};}function getBlacklist(){const _0x5b680b=_0x54c4c4;return dbSecure['get'](_0x5b680b(0x241))[_0x5b680b(0x1b6)]()||[];}function broadcastToBots(_0x34afb8,_0x15456b){config['forEach'](_0x5b6a05=>{const _0x324c30=_0x1465;if(_0x5b6a05[_0x324c30(0x145)]=='enabled'&&_0x5b6a05['live']=='running'||_0x5b6a05[_0x324c30(0x145)]==_0x324c30(0x1fe)&&_0x5b6a05[_0x324c30(0x95)]=='running'){if(pid[_0x5b6a05[_0x324c30(0x292)]])pid[_0x5b6a05[_0x324c30(0x292)]][_0x324c30(0x1b1)]({[_0x34afb8]:_0x15456b});}});}async function storeSettings(_0x35503d,_0x105f91=![]){const _0x1bebc9=_0x54c4c4;_0x35503d={...settings,..._0x35503d};if(_0x105f91&&_0x35503d[_0x1bebc9(0x260)]!='************'&&_0x35503d[_0x1bebc9(0x260)]!=_0x1bebc9(0x14a)&&_0x35503d[_0x1bebc9(0x260)]!=''){const _0x1bfab2=decryptRSA(secure[_0x1bebc9(0x130)],_0x35503d[_0x1bebc9(0x260)])[_0x1bebc9(0x271)]('|@|')[0x0],_0x2d33c5=bcrypt['hashSync'](_0x1bfab2,saltRounds);_0x35503d={..._0x35503d,'bbPassword':_0x2d33c5};}if(_0x105f91&&_0x35503d[_0x1bebc9(0x287)]!='************'&&_0x35503d['telegramToken']!=_0x1bebc9(0x14a)&&_0x35503d[_0x1bebc9(0x287)]!=''){const _0x3d7eb7=decryptRSA(secure[_0x1bebc9(0x130)],_0x35503d[_0x1bebc9(0x287)])[_0x1bebc9(0x271)](_0x1bebc9(0x84))[0x0];_0x35503d={..._0x35503d,'telegramToken':_0x3d7eb7};}if(_0x105f91&&_0x35503d[_0x1bebc9(0x163)]!='************'&&_0x35503d['marketcapApi']!=_0x1bebc9(0x14a)&&_0x35503d[_0x1bebc9(0x163)]!=''){const _0x47bd3e=decryptRSA(secure[_0x1bebc9(0x130)],_0x35503d['marketcapApi'])[_0x1bebc9(0x271)](_0x1bebc9(0x84))[0x0];_0x35503d={..._0x35503d,'marketcapApi':_0x47bd3e};}const _0x2eea8c=_0x35503d['telegramToken']!=_0x1bebc9(0x248)&&_0x35503d['telegramToken']!=settings[_0x1bebc9(0x287)]||_0x35503d[_0x1bebc9(0x13a)]!=settings[_0x1bebc9(0x13a)],_0xded923=_0x35503d['telegramToken']==''||_0x35503d[_0x1bebc9(0x13a)]=='',_0x227915=_0x35503d[_0x1bebc9(0x163)]&&_0x35503d[_0x1bebc9(0x163)]!=_0x1bebc9(0x248)&&_0x35503d['marketcapApi']!=settings[_0x1bebc9(0x163)];_0x2eea8c&&(_0x35503d[_0x1bebc9(0x107)]=null,_0x35503d[_0x1bebc9(0x11e)]='all');for(const [_0x3f5e6c,_0x59760b]of Object[_0x1bebc9(0xad)](_0x35503d)){if(_0x3f5e6c==_0x1bebc9(0x287)&&_0x59760b==_0x1bebc9(0x248)){_0x35503d['telegramToken']=settings[_0x1bebc9(0x287)];continue;};if(_0x3f5e6c==_0x1bebc9(0x260)&&_0x59760b==_0x1bebc9(0x248)){_0x35503d[_0x1bebc9(0x260)]=settings[_0x1bebc9(0x260)];continue;};if(_0x3f5e6c==_0x1bebc9(0x163)&&_0x59760b==_0x1bebc9(0x248)){_0x35503d[_0x1bebc9(0x163)]=settings['marketcapApi'];continue;};dbSettings[_0x1bebc9(0x24a)](_0x1bebc9(0x1d7)+_0x3f5e6c,_0x59760b)[_0x1bebc9(0x1ed)]();}settings=_0x35503d,io['to'](_0x1bebc9(0xe1))['emit'](_0x1bebc9(0x228),cleanSettings()),broadcastToBots(_0x1bebc9(0x284),settings[_0x1bebc9(0x284)]),broadcastToBots(_0x1bebc9(0xef),settings[_0x1bebc9(0xef)]),broadcastToBots('marketcapApi',settings[_0x1bebc9(0x163)]);if(_0x2eea8c&&!_0xded923)initTelegram();_0x2eea8c&&_0xded923&&(updateSetting(_0x1bebc9(0x107),null),disableTelegram()),getAllClients()[_0x1bebc9(0x1ec)](_0x539652=>{const _0x2245f4=_0x1bebc9;getSocket(_0x539652['id'])[_0x2245f4(0x218)]('status',{'access':{'allow':![],'reason':'reload','token':null}});}),_0x227915&&(await sleep(0xbb8),testMarketcapApi(_0x35503d[_0x1bebc9(0x163)]));}async function testMarketcapApi(_0x5e5390){const _0xe589f=_0x54c4c4,_0x5074aa=[_0xe589f(0xab),_0xe589f(0x16f)];try{await axios[_0xe589f(0x23d)](_0xe589f(0x13e),{'headers':{'X-CMC_PRO_API_KEY':_0x5e5390},'params':{'symbol':_0x5074aa['toString']()}});}catch(_0x5a87f9){_0x5a87f9[_0xe589f(0x1b3)]()[_0xe589f(0x1d3)](_0xe589f(0x23e))?(io['to'](_0xe589f(0xe1))[_0xe589f(0x218)](_0xe589f(0x16d),_0xe589f(0x23b)),logger[_0xe589f(0x1d6)](_0xe589f(0x23b))):(io['to'](_0xe589f(0xe1))[_0xe589f(0x218)]('notification',_0xe589f(0x141)),logger[_0xe589f(0x1d6)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger['debug']('Error\x20details:',_0x5a87f9[_0xe589f(0x1b3)]()+'\x20-\x20'+_0x5a87f9['code']));return;}logger['debug'](_0xe589f(0x258));}function updateSetting(_0x16b464,_0x5260c5){const _0x38f733=_0x54c4c4;dbSettings[_0x38f733(0x24a)](_0x38f733(0x1d7)+_0x16b464,_0x5260c5)[_0x38f733(0x1ed)](),settings=getSettings(),io['to'](_0x38f733(0xe1))[_0x38f733(0x218)](_0x38f733(0x228),cleanSettings());}function storeSecure(_0x44ab83){const _0x4ecd6e=_0x54c4c4;dbSecure[_0x4ecd6e(0x23d)](_0x4ecd6e(0xce))['push'](_0x44ab83)['write'](),secure=_0x44ab83;}function addBlacklist(_0x41196e){const _0x1a508e=_0x54c4c4;cleanBlacklist();let _0x16a694;devices[_0x41196e][_0x1a508e(0xff)]?_0x16a694=Math[_0x1a508e(0xb2)](devices[_0x41196e][_0x1a508e(0xff)][_0x1a508e(0x274)],loginExpiry):_0x16a694=loginExpiry,dbSecure[_0x1a508e(0x23d)]('blacklist')['push']({'expiry':new Date()[_0x1a508e(0x253)]()+_0x16a694*0x3c*0x3e8,'token':devices[_0x41196e]['access']['token']})[_0x1a508e(0x1ed)](),blacklist=dbSecure[_0x1a508e(0x23d)](_0x1a508e(0x241))['value']();}function cleanBlacklist(){const _0x14c840=_0x54c4c4;let _0x37bbd9=dbSecure['get'](_0x14c840(0x241))[_0x14c840(0x1ca)]()['value'](),_0x2cdc9f=new Date()[_0x14c840(0x253)]();_0x37bbd9['forEach'](_0x3a21c3=>{const _0x209baf=_0x14c840;_0x3a21c3['expiry']<_0x2cdc9f&&dbSecure[_0x209baf(0x23d)](_0x209baf(0x241))[_0x209baf(0x16c)]({'expiry':_0x3a21c3[_0x209baf(0x274)]})[_0x209baf(0x1ed)]();});}function initStates(){const _0x266255=_0x54c4c4;let _0x1d243f=getConfiguration();_0x1d243f[_0x266255(0x1ec)](_0x1cc625=>{const _0xa50a06=_0x266255;_0x1cc625[_0xa50a06(0x95)]='stopped';}),storeConfiguration(_0x1d243f);}async function generateKeys(){const _0x5f0eb3=_0x54c4c4,_0x3ee071=forge[_0x5f0eb3(0x15c)]['rsa'][_0x5f0eb3(0x28e)]({'bits':0x1000,'e':0x10001}),_0x6073dc=forge[_0x5f0eb3(0x15c)][_0x5f0eb3(0x288)](_0x3ee071[_0x5f0eb3(0x130)]),_0x28e2ca=forge[_0x5f0eb3(0x15c)][_0x5f0eb3(0x1c2)](_0x3ee071['publicKey']);return{'privateKey':_0x6073dc,'publicKey':_0x28e2ca};}async function oneTimeMigration(){const _0x1ab7ca=_0x54c4c4;let _0x211cf4=getSettings(),_0x421281=![];!_0x211cf4[_0x1ab7ca(0x1d9)]('lastmsgtelegram')&&(_0x211cf4['lastmsgtelegram']=0x0,_0x421281=!![]);!_0x211cf4[_0x1ab7ca(0x1d9)]('lastmsgemitted')&&(_0x211cf4[_0x1ab7ca(0x1d0)]=0x0,_0x421281=!![]);!_0x211cf4[_0x1ab7ca(0x1d9)](_0x1ab7ca(0x179))&&(_0x211cf4['latestversion']='0.0.0',_0x421281=!![]);!_0x211cf4['hasOwnProperty'](_0x1ab7ca(0xef))&&(_0x211cf4[_0x1ab7ca(0xef)]=![],_0x421281=!![]);!_0x211cf4[_0x1ab7ca(0x1d9)](_0x1ab7ca(0x163))&&(_0x211cf4[_0x1ab7ca(0x163)]='',_0x421281=!![]);if(_0x421281)storeSettings(_0x211cf4);try{fs[_0x1ab7ca(0x290)](configbackuppath,{'withFileTypes':!![]})[_0x1ab7ca(0x1ec)](_0x25393c=>{const _0x2ad59b=_0x1ab7ca;if(!_0x25393c['isDirectory']()){if(!_0x25393c['name'][_0x2ad59b(0xca)](_0x2ad59b(0x265)))fs[_0x2ad59b(0x17d)](configbackuppath+_0x25393c[_0x2ad59b(0xbe)]);}else fs[_0x2ad59b(0xb1)](configbackuppath+_0x25393c[_0x2ad59b(0xbe)],{'recursive':!![]});});}catch(_0x1b8ea5){logger[_0x1ab7ca(0x28a)](_0x1ab7ca(0x17b),_0x1b8ea5);}}function storeConfiguration(_0x4e5184){const _0x99b40d=_0x54c4c4;dbConfig[_0x99b40d(0x23d)](_0x99b40d(0x116))['remove']()['write'](),dbConfig['get'](_0x99b40d(0x116))['push'](..._0x4e5184)[_0x99b40d(0x1ed)](),config=_0x4e5184;}async function resetPassword(){const _0x2e498a=_0x54c4c4;if(tgBot&&settings[_0x2e498a(0x107)]){const _0xa79c5f=Markup[_0x2e498a(0x239)]([Markup[_0x2e498a(0x203)][_0x2e498a(0x28b)](_0x2e498a(0x1bf),_0x2e498a(0x126)),Markup['button']['callback']('no',_0x2e498a(0xf3))]);await sendTelegram(settings['telegramChatId'],_0x2e498a(0x1e0),_0xa79c5f),tgBot[_0x2e498a(0x15b)](/resetpw_(.+)/,async _0x4d8b97=>{const _0x875f14=_0x2e498a,_0x15d278=_0x4d8b97[_0x875f14(0x184)][0x1];_0x4d8b97['editMessageReplyMarkup']();if(_0x15d278!='no'){const _0x101a5f=0xf,_0x5820c7=_0x875f14(0x27a),_0x20d835=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x101a5f)))[_0x875f14(0x237)](_0xdf59fb=>_0x5820c7[_0xdf59fb%_0x5820c7[_0x875f14(0x135)]])['join'](''),_0x34aeac=bcrypt[_0x875f14(0xf7)](_0x20d835,saltRounds);storeSettings({'bbPassword':_0x34aeac}),await sendTelegram(_0x4d8b97[_0x875f14(0x92)]['id'],_0x875f14(0xc6)+_0x20d835,{'parse_mode':_0x875f14(0x173)});}else await sendTelegram(_0x4d8b97[_0x875f14(0x92)]['id'],_0x875f14(0xe9));});}}async function confirmRestore(_0x275d39,_0x2a0efa){const _0x2e257c=_0x54c4c4;io['to'](_0x2e257c(0xe1))[_0x2e257c(0x218)](_0x2e257c(0x16d),_0x2e257c(0x27f),_0x2e257c(0x1e6));if(tgBot&&settings[_0x2e257c(0x107)]){const _0x172da1=uuidRandom();tmpStorage[_0x172da1]={'path':_0x275d39,'filename':_0x2a0efa};const _0x59ef8e=Markup[_0x2e257c(0x239)]([Markup[_0x2e257c(0x203)]['callback']('yes','restore_yes_'+_0x172da1),Markup[_0x2e257c(0x203)][_0x2e257c(0x28b)]('no','restore_no_'+_0x172da1)]);await sendTelegram(settings['telegramChatId'],_0x2e257c(0x251),_0x59ef8e),tgBot[_0x2e257c(0x15b)](/restore_(.+)_(.+)/,async _0x55dbb5=>{const _0x3efb4d=_0x2e257c,_0x1c51d8=_0x55dbb5[_0x3efb4d(0x184)][0x1],_0x437ea9=_0x55dbb5[_0x3efb4d(0x184)][0x2],{path:_0x3b868d,filename:_0x46f3d0}=tmpStorage[_0x437ea9];delete tmpStorage[_0x437ea9],_0x55dbb5[_0x3efb4d(0x103)](),_0x1c51d8==_0x3efb4d(0x1bf)?(logger[_0x3efb4d(0x28a)](_0x3efb4d(0x9a)),await sendTelegram(_0x55dbb5[_0x3efb4d(0x92)]['id'],_0x3efb4d(0x157),{'parse_mode':_0x3efb4d(0x173)}),unzipFile(_0x3b868d,_0x46f3d0)):(logger['debug']('Restore\x20process\x20aborted'),await sendTelegram(_0x55dbb5['chat']['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x2f8a26=_0x54c4c4,_0x36cdff=new Date();return _0x36cdff[_0x2f8a26(0x120)]()+'/'+(_0x36cdff[_0x2f8a26(0xee)]()+0x1)[_0x2f8a26(0x1b3)]()[_0x2f8a26(0x26f)](0x2,'0')+'/'+_0x36cdff[_0x2f8a26(0x16a)]()['toString']()[_0x2f8a26(0x26f)](0x2,'0')+'\x20'+_0x36cdff[_0x2f8a26(0x11d)]()['toString']()[_0x2f8a26(0x26f)](0x2,'0')+':'+_0x36cdff[_0x2f8a26(0x275)]()['toString']()[_0x2f8a26(0x26f)](0x2,'0')+':'+_0x36cdff['getSeconds']()[_0x2f8a26(0x1b3)]()[_0x2f8a26(0x26f)](0x2,'0');}function getTimeStamp(){const _0xad7024=_0x54c4c4,_0x26a458=shiftedTime();return _0x26a458[_0xad7024(0x120)]()+'/'+(_0x26a458[_0xad7024(0xee)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x26a458[_0xad7024(0x16a)]()[_0xad7024(0x1b3)]()[_0xad7024(0x26f)](0x2,'0')+'\x20'+_0x26a458[_0xad7024(0x11d)]()[_0xad7024(0x1b3)]()[_0xad7024(0x26f)](0x2,'0')+':'+_0x26a458[_0xad7024(0x275)]()[_0xad7024(0x1b3)]()[_0xad7024(0x26f)](0x2,'0')+':'+_0x26a458['getSeconds']()[_0xad7024(0x1b3)]()[_0xad7024(0x26f)](0x2,'0');}function getCleanTimeStamp(){const _0x4c47c1=_0x54c4c4,_0x148a6c=shiftedTime();return _0x148a6c[_0x4c47c1(0x120)]()+(_0x148a6c[_0x4c47c1(0xee)]()+0x1)[_0x4c47c1(0x1b3)]()[_0x4c47c1(0x26f)](0x2,'0')+_0x148a6c[_0x4c47c1(0x16a)]()[_0x4c47c1(0x1b3)]()[_0x4c47c1(0x26f)](0x2,'0')+'-'+_0x148a6c['getHours']()[_0x4c47c1(0x1b3)]()['padStart'](0x2,'0')+_0x148a6c[_0x4c47c1(0x275)]()['toString']()[_0x4c47c1(0x26f)](0x2,'0')+_0x148a6c[_0x4c47c1(0x18c)]()[_0x4c47c1(0x1b3)]()[_0x4c47c1(0x26f)](0x2,'0');}function shiftedTime(){const _0x41605f=_0x54c4c4,_0x558127=new Date();let _0x1826ab=_0x558127;if(settings[_0x41605f(0x284)]&&settings['timeshift']!==0x0)_0x1826ab=fns[_0x41605f(0x186)](_0x558127,{'hours':settings[_0x41605f(0x284)]});return _0x1826ab;}async function startScheduler(){const _0x11a283=_0x54c4c4,_0xb769da=new Date()[_0x11a283(0x279)](),_0x278e44=shiftedTime()[_0x11a283(0x11d)]();_0x278e44==0x4&&backupConfigFiles(),_0x278e44==0x0&&(rotateLogFiles(),logger['debug'](_0x11a283(0x149)),logger['debug'](_0x11a283(0x255)+serverversion+_0x11a283(0x159)+(environment==_0x11a283(0x10a)?'(staging)':'')),logger['debug']('--------------------------------------')),_0xb769da%0x6==0x0&&triggerAnalytics(),_0xb769da%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x5ccb4e){const _0x2b0865=_0x54c4c4;logger['debug']('Restore\x20backup\x20file\x20'+_0x5ccb4e);const _0x129040=getBotsWithMode();_0x129040[_0x2b0865(0x135)]>0x0?confirmRestore(configbackuppath,_0x5ccb4e):unzipFile(configbackuppath,_0x5ccb4e);}function _0x32e8(){const _0x320682=['logs/','referer','socket.io','min','/:bot/support','\x20to\x20','then','tempaccess_5_','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','bots','inherit','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','off','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Access\x20enabled\x20for\x20','getHours','telegramEvents','disconnect','getFullYear','connection','secret','date-fns','pidRefreshToken','address','resetpw_yes','/:bot/coins','names','update','Unauthorized\x20attempt\x20to\x20show\x20configuration','exit','0.0.0','*$1*','sockets','args','privateKey','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Invalid\x20IP\x20address','3000','.zip','length','createWriteStream','5\x20min','parse','IPv4','telegramUsername','randomBytes','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','apiKey','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','botname','reinstall','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','format','output-003.log','Login\x20accepted','status','mixpanel','\x1b[31m','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','--------------------------------------','***','6b67f3d61ee94b8f5c80b4affef4c4d9','/restart\x20-\x20restart\x20bot(s)\x0a','2FA','bbUsername','file','mtime','bot','reject','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','axios','apply','Logged\x20out\x20user\x20...','Restoring\x20bot(s)\x20from\x20backup','Markdown','#RES#\x20','off_','action','pki','bot-','kill','temporary\x20token\x20generated','warning','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','marketcapApi','login\x20token\x20generated','\x20|\x20user:\x20...','tempaccess_15_','child_process','11062818DBxOQC','access','getDate','decode64','remove','notification','Bot\x20Mgr\x20>\x20','ETH','login\x20not\x20required','Idling\x20(','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','HTML','Unauthorized\x20attempt\x20to\x20delete\x20alerts','build2','statSync','$1_$2_$3','token','latestversion','reply','Error\x20removing\x20old\x20backup\x20files:','test','unlinkSync','mode','\x20(1)','telegrammsg','Yes','http','#RES#\x20if\x20running\x20locally\x0a','match','2FA\x20login\x20rejected','add','bbvNew','config_alerts','writeFileSync','_nsps','reinstall_no','getSeconds','117318eMYJCG','\x1b[34m','slice','zip/','whitelist','Your\x20installation\x20is\x20already\x20up\x20to\x20date','once','SIGINT','update-bot','=>\x20Go\x20to\x20#CYA#http://','3733807QFQscj','Telegram\x20error:','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','All\x20bots\x20running\x20right\x20now','\x20|\x20','assign','headers','Allow\x20login\x20from\x20IP\x20address\x20','Bot\x20','reload','keys','createServer','1003082ZTawpq','/disable\x20-\x20disable\x20notifications\x0a','emitHistory','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','logout','from','isValid','allow','logged\x20out','SIGTERM','index.html','cancel-loading','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','all','send','login','toString','\x20>\x20','publicKey','value','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','string','/on\x20-\x20start\x20bot(s)\x0a','track','(((.+)+)+)+$','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Network\x20Interfaces:','enabled','yes','9398vwHUKp','\x1b[35m','publicKeyToPem','bot.js','Notifications\x20disabled','Unauthorized\x20attempt\x20to\x20get\x20portfolio','-config.json','tempaccess_reject_','/:bot/configuration','showConfig','cloneDeep','bb-secure.json','error','download','https://api.ipify.org?format=json','store-configuration','lastmsgemitted','endsWith','user','includes','/update\x20-\x20update\x20Balance\x20Bot\x0a','clientip','full','settings.','output-002.log','hasOwnProperty','get-messages','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','existsSync','-----------------------------------------------------------------------------------','launch','\x20|\x20client:\x20...','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','isIPv4MappedAddress','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','uuid-random','join','No\x20authentication\x20token','success','-performance.json','Ok,\x20will\x20send\x20alert\x20notifications\x20only','internal','tempaccess_30_','Logged\x20in\x20user\x20...','forEach','write','enable','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','sha256','reset-history','/names\x20-\x20show\x20bot\x20names\x0a','env','stopped','bb-config.json','lowdb','#RES#\x20if\x20running\x20on\x20server','All\x20bots','Invalid\x20username\x20or\x20IP\x20address','replyWithDocument','crypto','sortBy','Token\x20blacklisted','new','Invalid\x20authentication\x20token\x20(1)','Telegraf\x20error:','140nBkfxo','host','button','6463984tKsyJN','get-logs','1000','node-forge','delete-bot','2FA\x20required','\x20files\x20over\x20Telegram:','update-bb','telegram','config_orders','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','store-settings','argv','Unauthorized\x20attempt\x20to\x20download\x20','express-fileupload','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','cancelLoading','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','toIPv4Address','readFileSync','emit','headless','lowdb/adapters/FileSync','encryptedUuid','initclient','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Disabled\x20Bot\x20','Unauthorized\x20login\x20attempt\x20(timeout)','\x20minutes','replace','create','sign','toggleBotMode','deleteHistoryAlerts','\x1b[36m','get-portfolio','settings','restart_','stringify','telegramEnabled','getPortfolio','getStartingBalances','reinstall-bb','close','Unauthorized\x20attempt\x20to\x20store\x20configuration','sendPortfolioTelegram','ipc','production','toIPv4MappedAddress','\x1b[0m','restart','map','node','inlineKeyboard',',\x20must\x20be\x20a\x204\x20digit\x20number','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager',':\x20Bot\x20Mgr\x20>\x20','get','status\x20code\x20401','telegraf','text','blacklist','Unauthorized\x20attempt\x20to\x20confirm\x20message','Starting\x20Balance\x20Bot\x20update','/:bot/history','321256UMTyvN','Temporary\x20access\x20rejected','port','************','binary','set','showname','number','data','isDirectory','ipv6','password','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','conn','getTime','55XsGyZg','Running\x20#RED#Balance\x20Bot\x20v','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','CoinMarketCap\x20API\x20key\x20validated','title','version','Unauthorized\x20attempt\x20to\x20delete\x20bot','User\x20has\x20been\x20validated','backup','catch','backupfile','bbPassword','started','type','find',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','backup-full@','invalid\x20credentials','/:bot','config_all','temporary\x20access\x20timeout','Notifications\x20disabled\x0a','decrypt','-events.json','Notifications\x20enabled\x0a','sendMessage','padStart','Alerts','split','f2aRequired','Node.js\x20v','expiry','getMinutes','tkn','defaults','105lqkfZp','getUTCHours','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','username','/logs\x20-\x20receive\x20log\x20files\x0a','filter','build','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Unauthorized\x20attempt\x20to\x20update\x20bot','alias','graphql-request','Unauthorized\x20attempt\x20to\x20log\x20out','timeshift','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','use','telegramToken','privateKeyToPem','params','debug','callback','async','Deleted\x20Bot\x20','generateKeyPair','remoteAddress','readdirSync','event','botID','bcryptjs','socket','simple','api-eu.mixpanel.com','show','apiSecret','on_','log',')\x20|\x20Bot\x20','handshake','delete-alerts','hex','|@|','metrics','alerts','ipaddr.js','/:bot/portfolio','messages','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','exp','Backup\x20file\x20unzipped\x20and\x20stored','Error\x20sending\x20','environment','temporary\x20access\x20not\x20allowed','/status\x20-\x20show\x20bot(s)\x20status\x0a','2FA\x20login\x20required','chat','/output-000.log','login\x20token\x20valid','live','/download/:type','backup-full','bb/','storeHeadless','Restore\x20process\x20confirmed','access\x20timeout','versions',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','store','Unauthorized\x20attempt\x20to\x20update\x20settings','Backup\x20file\x20uploaded','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','reset-password','show-config','privateKeyFromPem','Notifications\x20enabled','auto','exchange','temp/','(staging)','49fQZHui','BCT','copyFileSync','entries','lastmsgtelegram','stop','pidExpireLogin','rmSync','max','File\x20uploaded','Enabled\x20Bot\x20','logs','apiPassword','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','2FA\x20login\x20token\x20generated','temporary\x20access\x20rejected','exec','get-backup-files','manual','request','name','login2fa_','Unauthorized\x20attempt\x20to\x20get\x20messages','/help\x20-\x20show\x20available\x20commands\x0a','/start','private','\x20(2)','/upload-backup','Password\x20has\x20been\x20reset\x20to:\x20','get-starting-balances','family','userid','startsWith','constructor','DEFLATE','timestamp','secure','sendFile','Server','disabled','login\x20required','reason','-results.json','removeAllListeners','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','files','path','NTBA_FIX_319','Starting\x20new\x20bot\x20|\x20Bot\x20','message','127.0.0.1','output-001.log','telegram2FaApproval','loginRequired','uuid','botmanager',')\x20\x20\x20|\x20Bot\x20','help','disable','toggle','generateAsync','\x20mode','<b>Balance\x20Bot\x20Status:</b>\x0a','Password\x20reset\x20rejected','function','order','portfolio_','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','getMonth','onepagemode','util','Starting\x20Balance\x20Bot\x20reinstallation','command','resetpw_no','accept','bbvReceive','jsonwebtoken','hashSync','whitelistEnabled','Ok,\x20will\x20send\x20order\x20notifications\x20only','Login\x20rejected','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','new-disabled','15\x20min','No\x20bots\x20running\x20right\x20now','telegramIpApproval','bb-settings.json','clients','RSA-OAEP','editMessageReplyMarkup','sort','static','push','telegramChatId','listen','reinstall_yes','staging','temporaryAccessAllowed','mkdirSync'];_0x32e8=function(){return _0x320682;};return _0x32e8();}async function getBackupFiles(_0x113c15=null){const _0x143897=_0x54c4c4;let _0x46f1be=[],_0x20c00e=fs[_0x143897(0x290)](configbackuppath,{'withFileTypes':!![]});_0x20c00e[_0x143897(0x104)]((_0x33e3d1,_0x28cd3b)=>_0x33e3d1[_0x143897(0xbe)]<_0x28cd3b['name']?0x1:_0x28cd3b[_0x143897(0xbe)]<_0x33e3d1['name']?-0x1:0x0),_0x20c00e[_0x143897(0x1ec)](_0x359a43=>{const _0x112f58=_0x143897;if(!_0x359a43['isDirectory']()&&_0x359a43[_0x112f58(0xbe)][_0x112f58(0xca)]('backup-full@')&&_0x359a43[_0x112f58(0xbe)][_0x112f58(0x1d1)](_0x112f58(0x134))){const _0x55f91d=formatDate(fs[_0x112f58(0x176)](configbackuppath+_0x359a43[_0x112f58(0xbe)])[_0x112f58(0x150)]);_0x46f1be[_0x112f58(0x106)]({'name':_0x359a43[_0x112f58(0xbe)],'mtime':_0x55f91d});}});if(_0x113c15)io['to'](_0x113c15)[_0x143897(0x218)]('backup-files',_0x46f1be);else return _0x46f1be;}async function backupConfigFiles(){const _0x18e906=_0x54c4c4;await zipFiles(_0x18e906(0x97));const _0x535d92=getCleanTimeStamp();fs[_0x18e906(0xac)](zippath+'backup-full.zip',configbackuppath+(_0x18e906(0x265)+_0x535d92+_0x18e906(0x134)));let _0x2fa245=fs[_0x18e906(0x290)](configbackuppath,{'withFileTypes':!![]});_0x2fa245[_0x18e906(0x104)]((_0x39ce17,_0x4d2b72)=>_0x39ce17[_0x18e906(0xbe)]<_0x4d2b72['name']?0x1:_0x4d2b72[_0x18e906(0xbe)]<_0x39ce17[_0x18e906(0xbe)]?-0x1:0x0),_0x2fa245[_0x18e906(0x135)]>maxBackups&&fs[_0x18e906(0x17d)](configbackuppath+_0x2fa245[_0x2fa245['length']-0x1]['name']);}function rotateLogFiles(){const _0x2f56bc=_0x54c4c4,_0x4c70c2=fs[_0x2f56bc(0x176)](logspath+'output-000.log'),_0x164eff=_0x4c70c2['size']/0x400;if(_0x164eff>0x64){let _0x336d6d=fs[_0x2f56bc(0x290)](logspath,{'withFileTypes':!![]});_0x336d6d[_0x2f56bc(0x104)]((_0xaafb15,_0x5d4269)=>_0xaafb15['name']<_0x5d4269[_0x2f56bc(0xbe)]?0x1:_0x5d4269[_0x2f56bc(0xbe)]<_0xaafb15[_0x2f56bc(0xbe)]?-0x1:0x0),_0x336d6d['forEach'](_0x23de39=>{const _0x39ccac=_0x2f56bc;if(_0x23de39[_0x39ccac(0xbe)]=='output-002.log')fs[_0x39ccac(0xac)](logspath+_0x23de39[_0x39ccac(0xbe)],logspath+_0x39ccac(0x143));if(_0x23de39[_0x39ccac(0xbe)]==_0x39ccac(0xdd))fs[_0x39ccac(0xac)](logspath+_0x23de39[_0x39ccac(0xbe)],logspath+_0x39ccac(0x1d8));_0x23de39[_0x39ccac(0xbe)]=='output-000.log'&&(fs[_0x39ccac(0xac)](logspath+_0x23de39[_0x39ccac(0xbe)],logspath+_0x39ccac(0xdd)),fs[_0x39ccac(0x189)](logspath+_0x23de39[_0x39ccac(0xbe)],''));});}}async function zipFiles(_0x469909){const _0x5b0784=_0x54c4c4;let _0x138278;if(_0x469909=='logs')_0x138278=logspath;if(_0x469909==_0x5b0784(0x25d))_0x138278=configpath;if(_0x469909==_0x5b0784(0x97))_0x138278=configpath;let _0x438b25=fs[_0x5b0784(0x290)](_0x138278,{'withFileTypes':!![]});const _0x594993=new JSZip();_0x438b25[_0x5b0784(0x1ec)](_0xe987ff=>{const _0x12714a=_0x5b0784;if(!_0xe987ff[_0x12714a(0x24e)]()){let _0x125175=fs[_0x12714a(0x217)](_0x138278+_0xe987ff[_0x12714a(0xbe)]);if(_0x469909==_0x12714a(0x25d)){const _0x3fbde2=/^bot-[0-9]{3}-config.json$/,_0x3bbfe9=_0x3fbde2['test'](_0xe987ff[_0x12714a(0xbe)]);if(_0x3bbfe9){const _0x2421b0=JSON['parse'](_0x125175);if(_0x2421b0[_0x12714a(0x151)][0x0]){_0x2421b0[_0x12714a(0x151)][0x0]['apiKey']=_0x12714a(0x14a),_0x2421b0[_0x12714a(0x151)][0x0][_0x12714a(0x298)]=_0x12714a(0x14a);if(_0x2421b0[_0x12714a(0x151)][0x0][_0x12714a(0xb6)])_0x2421b0[_0x12714a(0x151)][0x0][_0x12714a(0xb6)]='***';}_0x125175=JSON[_0x12714a(0x22a)](_0x2421b0,null,0x2);}if(_0xe987ff['name']==_0x12714a(0x100)){const _0x50e5d7=JSON['parse'](_0x125175);if(_0x50e5d7[_0x12714a(0x228)][_0x12714a(0xdf)])_0x50e5d7[_0x12714a(0x228)][_0x12714a(0xdf)]=![];if(_0x50e5d7['settings']['bbPassword'])_0x50e5d7[_0x12714a(0x228)][_0x12714a(0x260)]=_0x12714a(0x14a);if(_0x50e5d7[_0x12714a(0x228)]['telegramToken'])_0x50e5d7[_0x12714a(0x228)][_0x12714a(0x287)]=_0x12714a(0x14a);if(_0x50e5d7[_0x12714a(0x228)][_0x12714a(0x107)])_0x50e5d7['settings'][_0x12714a(0x107)]=null;if(_0x50e5d7[_0x12714a(0x228)][_0x12714a(0x163)])_0x50e5d7[_0x12714a(0x228)][_0x12714a(0x163)]=_0x12714a(0x14a);_0x125175=JSON[_0x12714a(0x22a)](_0x50e5d7,null,0x2);}if(_0xe987ff[_0x12714a(0xbe)]!=_0x12714a(0x1cb))_0x594993[_0x12714a(0x14f)](_0xe987ff['name'],_0x125175);}else _0x594993['file'](_0xe987ff['name'],_0x125175);}});const _0x30daa5=await _0x594993[_0x5b0784(0xe6)]({'type':_0x5b0784(0x1b8),'base64':![],'compression':_0x5b0784(0xcc)});fs['writeFileSync'](zippath+(_0x469909+'.zip'),_0x30daa5,_0x5b0784(0x249));}async function unzipFile(_0x75dd6c,_0x3bf7aa){const _0x180355=_0x54c4c4;fs[_0x180355(0x290)](configpath,{'withFileTypes':!![]})['forEach'](_0x470088=>{const _0x54654f=_0x180355;if(!_0x470088[_0x54654f(0x24e)]())fs[_0x54654f(0xb1)](configpath+_0x470088['name']);});const _0x55c483=fs[_0x180355(0x217)](_0x75dd6c+_0x3bf7aa,_0x180355(0x249)),_0x1215a8=await JSZip['loadAsync'](_0x55c483,{'base64':![],'checkCRC32':!![]});for(const _0x522dc4 of Object['keys'](_0x1215a8[_0x180355(0xd7)])){const _0x44bc2c=_0x1215a8['files'][_0x522dc4],_0x19c144=await _0x44bc2c[_0x180355(0x28c)](_0x180355(0x1b8));fs[_0x180355(0x189)](configpath+_0x44bc2c['name'],_0x19c144);}fs[_0x180355(0x290)](temppath,{'withFileTypes':!![]})[_0x180355(0x1ec)](_0x40e022=>{const _0x397a45=_0x180355;if(!_0x40e022[_0x397a45(0x24e)]())fs[_0x397a45(0xb1)](temppath+_0x40e022[_0x397a45(0xbe)]);}),logger['debug'](_0x180355(0x8c)),process[_0x180355(0x1b1)]({'restore':!![]},_0x530291=>{});}async function getPublicIp(){const _0x2afe13=_0x54c4c4;try{const _0x535be0=await axios[_0x2afe13(0x23d)](_0x2afe13(0x1ce));publicip=_0x535be0[_0x2afe13(0x24d)]['ip'];}catch(_0x71c971){}}async function triggerAnalytics(){const _0x19c19c=_0x54c4c4;if(!publicip)await getPublicIp();const _0x1da2f4=getBotsWithMode();let _0x5580b3=0x0;_0x1da2f4['forEach'](_0x3d8624=>{const _0x16827d=_0x1465;if(_0x3d8624['status']===_0x16827d(0x1be))_0x5580b3++;});const _0x122433=getBotExchanges();mixpanel[_0x19c19c(0x1ba)](_0x19c19c(0xd0),{'distinct_id':settings[_0x19c19c(0xc9)],'ip':publicip,'version':serverversion,'numbots':_0x1da2f4[_0x19c19c(0x135)],'numbotsenabled':_0x5580b3,'exchanges':_0x122433,'environment':environment});}async function getMessages(){const _0x181f2c=_0x54c4c4,_0x1eedb2=_0x181f2c(0x172),_0x47624e=new GraphQLClient(_0x1eedb2),_0x25dd0d={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x39d482=serverversion[_0x181f2c(0x271)]('.'),_0x63e96=_0x39d482[0x0]+'.'+_0x39d482[0x1],_0x4f5a3c=Math[_0x181f2c(0x110)](settings[_0x181f2c(0xae)],settings['lastmsgemitted']),_0x51b0f5={'last':parseInt(_0x4f5a3c),'bbm':_0x63e96},_0x1eaf02=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x3963cd;try{_0x3963cd=await _0x47624e[_0x181f2c(0xbd)](_0x1eaf02,_0x51b0f5,_0x25dd0d);}catch(_0x57a6a5){}if(_0x3963cd&&_0x3963cd['messages']){let _0x5d42f9=settings[_0x181f2c(0xae)];newMessages=[];for(const _0x48b72e of _0x3963cd[_0x181f2c(0x89)]){newMessages[_0x181f2c(0x106)](_0x48b72e);let _0xa4a69f=![];_0x48b72e[_0x181f2c(0x187)]&&(updateSetting(_0x181f2c(0x179),_0x48b72e['bbvNew']),_0xa4a69f=isNewerVersion(serverversion,_0x48b72e[_0x181f2c(0x187)])||serverversion==_0x48b72e['bbvNew']);if(!_0xa4a69f&&_0x48b72e[_0x181f2c(0x24c)]>_0x5d42f9){if(_0x48b72e[_0x181f2c(0xf5)]==='any'||serverversion['startsWith'](_0x48b72e[_0x181f2c(0xf5)])){let _0x4aaca3=''+_0x48b72e[_0x181f2c(0x259)]+'\x0a\x0a'+_0x48b72e[_0x181f2c(0xdb)];const _0x2a9fae=await sendTelegramMsg(toTelegramMarkdown(_0x4aaca3),_0x181f2c(0x158));if(_0x2a9fae)_0x5d42f9=_0x48b72e[_0x181f2c(0x24c)];}}}updateAvailable=isNewerVersion(settings[_0x181f2c(0x179)],serverversion),updateSetting(_0x181f2c(0xae),_0x5d42f9),emitMessages();}}function emitMessages(){const _0x49bd1e=_0x54c4c4,_0x3f9ebc=settings[_0x49bd1e(0x1d0)];let _0x357679=[];newMessages[_0x49bd1e(0x1ec)](_0x329951=>{const _0x3765bb=_0x49bd1e;_0x329951[_0x3765bb(0x24c)]>_0x3f9ebc&&_0x357679[_0x3765bb(0x106)](_0x329951);}),_0x357679['length']>0x0&&getAllClients()[_0x49bd1e(0x1ec)](_0x522ebd=>{const _0x1955a5=_0x49bd1e;getSocket(_0x522ebd['id'])[_0x1955a5(0x218)]('message',_0x357679);});}function confirmMessage(_0x2ca2a3){updateSetting('lastmsgemitted',Number(_0x2ca2a3));}function isNewerVersion(_0x3f4079,_0x515aad){const _0x3112d9=_0x54c4c4,_0x56a131=_0x515aad[_0x3112d9(0x271)]('.'),_0x754838=_0x3f4079['split']('.');for(var _0x4f0a00=0x0;_0x4f0a00<_0x754838[_0x3112d9(0x135)];_0x4f0a00++){const _0xa1c96c=~~_0x754838[_0x4f0a00],_0x5b5804=~~_0x56a131[_0x4f0a00];if(_0xa1c96c>_0x5b5804)return!![];if(_0xa1c96c<_0x5b5804)return![];}return![];}function toTelegramMarkdown(_0x3529a0){const _0x5c9c7c=_0x54c4c4,_0x3f5446=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x1ac711=/\*{2}(.+?)\*{2}/gim;return _0x3529a0=_0x3529a0[_0x5c9c7c(0x221)](_0x3f5446,_0x5c9c7c(0x177))[_0x5c9c7c(0x221)](_0x1ac711,_0x5c9c7c(0x12d)),_0x3529a0;}async function validateConfigFile(){const _0x4f152c=_0x54c4c4,_0x3a95d7=dbConfig[_0x4f152c(0x23d)](_0x4f152c(0x116))[_0x4f152c(0x1fc)](_0x4f152c(0x292))[_0x4f152c(0x1b6)]()||[];if(_0x3a95d7['length']==0x0){let _0x5d1a70=0x0,_0x33a894=[];const _0x14e6c2=/^bot-([0-9]{3})-config.json$/,_0x577df4=fs['readdirSync'](configpath);_0x577df4[_0x4f152c(0x1ec)](_0x1592e5=>{const _0x499bbe=_0x4f152c,_0x194fc4=_0x14e6c2[_0x499bbe(0xba)](_0x1592e5);if(_0x194fc4){const _0x377a3c=_0x194fc4[0x1];let _0x134ba2=getBotAttributes(_0x377a3c);_0x33a894[_0x499bbe(0x106)]({'botID':_0x377a3c,'botname':_0x134ba2['botname'],'status':'disabled','live':_0x499bbe(0x1f4)}),_0x5d1a70++;}}),_0x5d1a70!=0x0&&(dbConfig[_0x4f152c(0x23d)](_0x4f152c(0x116))[_0x4f152c(0x19c)](_0x33a894)['write'](),config=_0x33a894,restoredConfigFile=_0x5d1a70);}}async function restoreConfigNotify(_0xc8000e){const _0x409f1d=_0x54c4c4;let _0x31ef9c;if(restoredConfigFile==0x1)_0x31ef9c='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x31ef9c='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0xc8000e)io['to'](_0x409f1d(0xe1))[_0x409f1d(0x218)](_0x409f1d(0x16d),_0x31ef9c);else{logger[_0x409f1d(0x295)](_0x409f1d(0x1dd)),logger[_0x409f1d(0x295)](_0x31ef9c),logger[_0x409f1d(0x295)]('-----------------------------------------------------------------------------------'),logger[_0x409f1d(0x295)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x409f1d(0x11e)]!='orders')await sendTelegram(settings[_0x409f1d(0x107)],_0x409f1d(0x16e)+_0x31ef9c);}}function decryptRSA(_0x279b41,_0x2202e5){const _0x13a7cc=_0x54c4c4,_0x98a355=forge[_0x13a7cc(0x15c)][_0x13a7cc(0xa4)](_0x279b41),_0x4953d7=_0x98a355[_0x13a7cc(0x26b)](forge[_0x13a7cc(0xf0)][_0x13a7cc(0x16b)](_0x2202e5),_0x13a7cc(0x102),{'md':forge['md'][_0x13a7cc(0x1f0)][_0x13a7cc(0x222)](),'mgf1':{'md':forge['md']['sha256'][_0x13a7cc(0x222)]()}});return _0x4953d7;}function validateCredentials(_0x9b66b6,_0x118dcb){const _0x3c4303=_0x54c4c4;if(_0x9b66b6[_0x3c4303(0x27b)]==settings[_0x3c4303(0x14e)]&&bcrypt['compareSync'](_0x9b66b6[_0x3c4303(0x250)],settings[_0x3c4303(0x260)])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x4ed7b2=generateLoginToken(_0x118dcb);return{'allow':!![],'reason':_0x3c4303(0x164),'token':_0x4ed7b2};}}else return{'allow':![],'reason':_0x3c4303(0x266),'token':null};}function refreshToken(_0x1b26a2){const _0x1c6c61=_0x54c4c4,_0x55af73=generateLoginToken(_0x1b26a2);return{'allow':!![],'reason':_0x1c6c61(0x164),'token':_0x55af73};}function _0x1465(_0x2646c3,_0x50befb){const _0x4ae14d=_0x32e8();return _0x1465=function(_0x505aed,_0x2b738a){_0x505aed=_0x505aed-0x7e;let _0x32e8bb=_0x4ae14d[_0x505aed];return _0x32e8bb;},_0x1465(_0x2646c3,_0x50befb);}function validateAccess(_0x369e9d,_0x5bbb8f,_0x375485){const _0x3320bb=_0x54c4c4,_0x3da84a=_0x375485?_0x375485:devices[_0x5bbb8f]['ip'];let _0x27e402;const _0x87c299=_0x4b55e5=>{const _0x45d56b=_0x1465;if(settings[_0x45d56b(0xdf)]){if(settings[_0x45d56b(0x272)]){if(telegram2FaApproved(_0x5bbb8f)){const _0x93d85b=generateLoginToken(_0x5bbb8f);return{'allow':!![],'reason':_0x45d56b(0xb8),'token':_0x93d85b};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x27e402=validToken(_0x4b55e5,_0x5bbb8f),_0x27e402['hasOwnProperty'](_0x45d56b(0x1e6))?{'allow':!![],'reason':_0x45d56b(0x94),'token':_0x4b55e5}:{'allow':![],'reason':_0x45d56b(0xd2),'token':null};}else return{'allow':!![],'reason':_0x45d56b(0x170),'token':null};};if(settings[_0x3320bb(0xf8)]){let _0x16f0d3=[...settings[_0x3320bb(0x191)],'::1','::ffff:127.0.0.1',_0x3320bb(0xdc)];if(_0x16f0d3[_0x3320bb(0x1d3)](_0x3da84a))return _0x87c299(_0x369e9d);else{_0x27e402=validToken(_0x369e9d,_0x5bbb8f);if(_0x27e402[_0x3320bb(0x1d9)](_0x3320bb(0x1e6)))return _0x87c299(_0x369e9d);else{if(telegramIpApproved(_0x5bbb8f)){const _0x1fabbc=generateToken(_0x5bbb8f);return _0x27e402=_0x87c299(_0x369e9d),_0x27e402[_0x3320bb(0x1aa)]?{'allow':!![],'reason':_0x3320bb(0x15f),'token':_0x1fabbc}:_0x27e402;}else return settings[_0x3320bb(0x10b)]?{'allow':![],'reason':_0x3320bb(0x209),'token':null}:{'allow':![],'reason':_0x3320bb(0x8f),'token':null};}}}else return _0x87c299(_0x369e9d);}function timelyDecrypt(_0x2cbf90,_0x2c34f3,_0x38503c='@'){const _0x3083c7=_0x54c4c4;if(_0x2cbf90)try{const _0x63967a=decryptRSA(secure[_0x3083c7(0x130)],_0x2cbf90),_0x6c42e6=_0x63967a[_0x3083c7(0x271)](_0x38503c)[0x0],_0x2cd2c1=_0x63967a[_0x3083c7(0x271)](_0x38503c)[0x1],_0x4d127e=new Date()['getTime']();if(_0x2c34f3){if(_0x4d127e-_0x2cd2c1<maxSecretAge*0x3e8)return _0x6c42e6;else return![];}else return _0x6c42e6;}catch(_0x18e4d4){return![];}else return![];}const validToken=(_0x3abb48,_0x170d81)=>{const _0xed99ed=_0x54c4c4,_0x429294=devices[_0x170d81]['ip'];if(!_0x3abb48)return{'error':_0xed99ed(0x1e5)};for(let _0x2e1063 of blacklist){if(_0x2e1063[_0xed99ed(0x178)]==_0x3abb48)return{'error':_0xed99ed(0x1fd)};}let _0x1b4c06;try{_0x1b4c06=jwt['verify'](_0x3abb48,secure[_0xed99ed(0x122)]+_0x170d81);}catch{return{'error':_0xed99ed(0x1ff)};}if(!_0x1b4c06[_0xed99ed(0x1d9)](_0xed99ed(0x1d5))&&!_0x1b4c06[_0xed99ed(0x1d9)](_0xed99ed(0x27b))||!_0x1b4c06[_0xed99ed(0x1d9)](_0xed99ed(0x8b)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x1b4c06[_0xed99ed(0x1d9)]('username')&&_0x1b4c06['hasOwnProperty']('clientip')){const {clientip:_0x1550ad}=_0x1b4c06;return _0x429294==_0x1550ad?{'success':_0xed99ed(0x25c)}:{'error':_0xed99ed(0x132)};}else{if(_0x1b4c06[_0xed99ed(0x1d9)]('username')&&_0x1b4c06[_0xed99ed(0x1d9)](_0xed99ed(0x1d5))){const {username:_0x446ead,clientip:_0x28f1b1}=_0x1b4c06;return settings[_0xed99ed(0x14e)]==_0x446ead&&_0x429294==_0x28f1b1?{'success':_0xed99ed(0x25c)}:{'error':_0xed99ed(0x1f9)};}}},generateLoginToken=_0x5cfd66=>{const _0x3d330d=_0x54c4c4;if(_0x5cfd66){const _0x165715=devices[_0x5cfd66]['ip'];return jwt[_0x3d330d(0x223)]({'username':settings[_0x3d330d(0x14e)],'clientip':_0x165715},secure[_0x3d330d(0x122)]+_0x5cfd66,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x51210e=>{const _0x37a3ed=_0x54c4c4;if(_0x51210e){const _0x448b09=devices[_0x51210e]['ip'];return jwt[_0x37a3ed(0x223)]({'clientip':_0x448b09},secure[_0x37a3ed(0x122)]+_0x51210e,{'expiresIn':devices[_0x51210e][_0x37a3ed(0xff)][_0x37a3ed(0x274)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x32a28c=>{const _0x1fe4ea=_0x54c4c4;let _0xb16e92=![];return devices[_0x32a28c]['telegramIpApproval']&&devices[_0x32a28c][_0x1fe4ea(0xff)][_0x1fe4ea(0x274)]!=_0x1fe4ea(0x152)&&(_0xb16e92=devices[_0x32a28c][_0x1fe4ea(0xff)][_0x1fe4ea(0x1d5)]==devices[_0x32a28c]['ip']&&new Date()[_0x1fe4ea(0x253)]()-devices[_0x32a28c]['telegramIpApproval']['timestamp']<devices[_0x32a28c]['telegramIpApproval'][_0x1fe4ea(0x274)]*0x3c*0x3e8),_0xb16e92;},telegram2FaApproved=_0x5a553f=>{const _0x3d82a5=_0x54c4c4;let _0x32dd9e=![];return devices[_0x5a553f][_0x3d82a5(0xde)]&&devices[_0x5a553f]['telegram2FaApproval'][_0x3d82a5(0x274)]!=_0x3d82a5(0x152)&&(_0x32dd9e=devices[_0x5a553f][_0x3d82a5(0xde)][_0x3d82a5(0x1d5)]==devices[_0x5a553f]['ip']&&new Date()[_0x3d82a5(0x253)]()-devices[_0x5a553f][_0x3d82a5(0xde)][_0x3d82a5(0xcd)]<devices[_0x5a553f][_0x3d82a5(0xde)][_0x3d82a5(0x274)]*0x3c*0x3e8),_0x32dd9e;},normalizeIP=_0x2f8110=>{const _0x332eb4=_0x54c4c4;let _0x218e9a=null,_0xff827c=null;if(ipaddr[_0x332eb4(0x1a9)](_0x2f8110)){const _0x319a75=ipaddr[_0x332eb4(0x138)](_0x2f8110);_0x319a75['kind']()===_0x332eb4(0x24f)?(_0x319a75[_0x332eb4(0x1e1)]()&&(_0x218e9a=_0x319a75[_0x332eb4(0x216)]()[_0x332eb4(0x1b3)]()),_0xff827c=_0x319a75[_0x332eb4(0x1b3)]()):(_0x218e9a=_0x319a75['toString'](),_0xff827c=_0x319a75[_0x332eb4(0x234)]()[_0x332eb4(0x1b3)]());}return{'show':_0x218e9a?_0x218e9a:_0xff827c,'store':_0xff827c};};function formatDate(_0x51e39d){const _0x4e0e19=_0x54c4c4;return _0x51e39d[_0x4e0e19(0x120)]()+'/'+(_0x51e39d[_0x4e0e19(0xee)]()+0x1)['toString']()[_0x4e0e19(0x26f)](0x2,'0')+'/'+_0x51e39d[_0x4e0e19(0x16a)]()[_0x4e0e19(0x1b3)]()[_0x4e0e19(0x26f)](0x2,'0')+'\x20'+_0x51e39d[_0x4e0e19(0x11d)]()[_0x4e0e19(0x1b3)]()['padStart'](0x2,'0')+':'+_0x51e39d['getMinutes']()[_0x4e0e19(0x1b3)]()[_0x4e0e19(0x26f)](0x2,'0')+':'+_0x51e39d[_0x4e0e19(0x18c)]()[_0x4e0e19(0x1b3)]()['padStart'](0x2,'0');}function sleep(_0x17d2c8){return new Promise(_0x56a97a=>setTimeout(_0x56a97a,_0x17d2c8));}