const _0x97b7c0=_0x24ce;(function(_0x352c6a,_0x3b600f){const _0x1d4d3d=_0x24ce,_0x2b8213=_0x352c6a();while(!![]){try{const _0x11ad17=parseInt(_0x1d4d3d(0x317))/0x1*(-parseInt(_0x1d4d3d(0x361))/0x2)+-parseInt(_0x1d4d3d(0x2c9))/0x3+-parseInt(_0x1d4d3d(0x204))/0x4*(parseInt(_0x1d4d3d(0x1d7))/0x5)+parseInt(_0x1d4d3d(0x1cc))/0x6*(-parseInt(_0x1d4d3d(0x2ee))/0x7)+-parseInt(_0x1d4d3d(0x2a5))/0x8+-parseInt(_0x1d4d3d(0x369))/0x9*(-parseInt(_0x1d4d3d(0x387))/0xa)+parseInt(_0x1d4d3d(0x352))/0xb;if(_0x11ad17===_0x3b600f)break;else _0x2b8213['push'](_0x2b8213['shift']());}catch(_0x4e6b6e){_0x2b8213['push'](_0x2b8213['shift']());}}}(_0x490d,0x4bca3));const _0x1a73a6=function(){let _0x12418c=!![];return function(_0x2a7128,_0x4ec08d){const _0x1c6319=_0x12418c?function(){const _0x342dae=_0x24ce;if(_0x4ec08d){const _0x243f90=_0x4ec08d[_0x342dae(0x36c)](_0x2a7128,arguments);return _0x4ec08d=null,_0x243f90;}}:function(){};return _0x12418c=![],_0x1c6319;};}(),_0x16202d=_0x1a73a6(this,function(){const _0xd7b1bc=_0x24ce;return _0x16202d[_0xd7b1bc(0x2c5)]()[_0xd7b1bc(0x232)](_0xd7b1bc(0x399))[_0xd7b1bc(0x2c5)]()[_0xd7b1bc(0x222)](_0x16202d)[_0xd7b1bc(0x232)]('(((.+)+)+)+$');});_0x16202d();'use strict';process[_0x97b7c0(0x2bb)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x97b7c0(0x18d)),fs=require('fs'),fns=require(_0x97b7c0(0x237)),low=require('lowdb'),FileSync=require(_0x97b7c0(0x2d4)),path=require('path'),crypto=require(_0x97b7c0(0x36b)),forge=require(_0x97b7c0(0x2b0)),bcrypt=require('bcryptjs'),jwt=require(_0x97b7c0(0x269)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x97b7c0(0x254)][_0x97b7c0(0x1ee)](0x2))[_0x97b7c0(0x254)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x97b7c0(0x1d0)),Mixpanel=require(_0x97b7c0(0x194)),axios=require(_0x97b7c0(0x2f6)),{GraphQLClient,gql}=require(_0x97b7c0(0x364)),util=require(_0x97b7c0(0x243)),fileUpload=require(_0x97b7c0(0x1ad)),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv[_0x97b7c0(0x2a4)]||_0x97b7c0(0x30f),pattern=/^[0-9]{2,4}$/;!pattern[_0x97b7c0(0x1d3)](PORT)&&(console[_0x97b7c0(0x187)](_0x97b7c0(0x28d)+PORT+_0x97b7c0(0x355)),process[_0x97b7c0(0x326)](0x1));const HOST=argv[_0x97b7c0(0x277)]||null,userID=argv[_0x97b7c0(0x22e)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x97b7c0(0x240)][_0x97b7c0(0x322)];let bbpath=_0x97b7c0(0x1e9),bbpath2='';const botfile='bot.js',configfile=_0x97b7c0(0x214),settingsfile='bb-settings.json',securefile=_0x97b7c0(0x3a1),environment=require('./'+bbpath2+'version.json')['environment']||_0x97b7c0(0x385),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x97b7c0(0x1cf)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x97b7c0(0x344)),configpath=userID?bbpath+_0x97b7c0(0x36d)+userID+'/':bbpath+_0x97b7c0(0x36d),configbackuppath=configpath+_0x97b7c0(0x2e0),logspath=userID?bbpath+_0x97b7c0(0x1a1)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x97b7c0(0x201)+userID+'/':bbpath+_0x97b7c0(0x201),loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+'temp/';!fs['existsSync'](configpath)&&fs[_0x97b7c0(0x32b)](configpath);!fs[_0x97b7c0(0x1cf)](configbackuppath)&&fs[_0x97b7c0(0x32b)](configbackuppath);!fs[_0x97b7c0(0x1cf)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x97b7c0(0x1cf)](zippath)&&fs[_0x97b7c0(0x32b)](zippath);!fs[_0x97b7c0(0x1cf)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x97b7c0(0x1dd)]({'bots':[]})[_0x97b7c0(0x2c0)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x97b7c0(0x1dd)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x97b7c0(0x21d),'onepagemode':![],'marketcapApi':''}})['write']();function _0x490d(){const _0x2c7f4d=['remoteAddress','node','pidRefreshToken','mtime','settings.','exit','\x20|\x20user:\x20...','Markdown','cancel-loading','files','mkdirSync','bots','/off\x20-\x20stop\x20bot(s)\x0a','auth','Unauthorized\x20attempt\x20to\x20confirm\x20message','Logged\x20out\x20user\x20...','ipc','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','botID','storeConfiguration','bbvNew','max','Invalid\x20authentication\x20token\x20(2)','post','size','build2','alerts','message','Network\x20Interfaces:','value','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','started','reject','stop','status\x20code\x20401','clients','lastmsgtelegram','store-fiat','file','bot','/download/:type','referer','invalid\x20credentials','Notifications\x20enabled\x0a','Unauthorized\x20attempt\x20to\x20get\x20events','button','update-bot','add','/restart\x20-\x20restart\x20bot(s)\x0a','19115833RJykcK','sendMessage','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',',\x20must\x20be\x20a\x204\x20digit\x20number','Temporary\x20access\x20rejected','on_','handshake','reset-history','createServer','BCT','Invalid\x20username\x20or\x20IP\x20address','version','debug','pki','Telegraf\x20error:','2kRmXzy','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','getUTCHours','graphql-request','telegramToken','reinstall_yes','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','deleteHistoryAlerts','9279VDOKfv','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','crypto','apply','config/','password','exp','Starting\x20Balance\x20Bot\x20reinstallation','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','\x20to\x20','alias','reset-password','reply','clientip','title','version.json','All\x20bots\x20running\x20right\x20now','Starting\x20(','/on\x20-\x20start\x20bot(s)\x0a','get-starting-balances','<b>Balance\x20Bot\x20Status:</b>\x0a','sockets','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','restore_yes_','Restore\x20process\x20aborted','update_no','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','/disable\x20-\x20disable\x20notifications\x0a','production','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','1130UQNbJz','order','SIGTERM','resetpw_no','RSA-OAEP','length','botmanager','#RES#\x20','-performance.json','/:bot/performance','uuid','Ok,\x20will\x20send\x20order\x20notifications\x20only','Login\x20accepted','[ip-address]','new','padStart','\x1b[33m','internal','(((.+)+)+)+$','Unauthorized\x20attempt\x20to\x20log\x20out','join','HTML','sort','push','Unauthorized\x20login\x20attempt\x20(timeout)','logged\x20out','bb-secure.json','Login\x20rejected','Yes','<b>Telegram\x20Bot\x20Status:</b>\x0a','telegram2FaApproval','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','log','sortBy','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','token','connection','Restore\x20process\x20confirmed','child_process','string','api-eu.mixpanel.com','socket.io','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','bbUsername','telegram','mixpanel','build','enabled','getHours','toggle_','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','secret','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','username','forEach','enable','statSync','simple','logs/','/enable\x20-\x20enable\x20notifications\x0a','tkn','toIPv4Address','address','off','https://api.ipify.org?format=json','getPortfolio','bbvReceive','(staging)','\x20files\x20over\x20Telegram:','************','express-fileupload','Notifications\x20disabled','expiry','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','login','private','readdirSync','args','backup-files','-events.json','place-order','sign','apiKey','File\x20uploaded','/:bot/configuration','add-bot','=>\x20Go\x20to\x20#CYA#http://','--------------------------------------','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','ETH','showname','\x20>\x20','notification','store','tempaccess_reject_','getFullYear','config_all','hashSync','\x20(1)','temporary\x20access\x20timeout','secure','6840OiwmVX','stringify','Bot\x20Mgr\x20>\x20Stopping\x20','existsSync','telegraf','/:bot/history','::ffff:127.0.0.1','test','onepagemode','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','All\x20bots','76315cmYBcI','15\x20min','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','timestamp','auto','off_','defaults','launch','kind','Session\x20expired\x20for\x20user\x20...','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Node.js\x20v','privateKey','toggleBotMode','from','event','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','bb/','close','filter','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','bot-','slice','disable','randomBytes','connected','min','Unauthorized\x20attempt\x20to\x20delete\x20alerts','/backup\x20-\x20receive\x20backup\x20files\x0a','delete-alerts','Bot\x20','getSeconds','placeOrder','command','catch','Invalid\x20IP\x20address','stopped','confirm-message','code','config_alerts','match','zip/','conn','index.html','132awWpiC','range','Unauthorized\x20attempt\x20to\x20download\x20','Backup\x20file\x20unzipped\x20and\x20stored','telegramChatId','6b67f3d61ee94b8f5c80b4affef4c4d9','timeshift','new-disabled','yes','static','emit','all','isDirectory','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','exchange','|@|','bb-config.json','pidExpireLogin','store-settings','restore_no_','Error\x20while\x20deleting\x20config\x20files:\x20','restart_','temporary\x20token\x20generated','config','logs','0.0.0','update','2FA\x20login\x20rejected','get-messages','compareSync','constructor','Deleted\x20Bot\x20','chat','cloneDeep','\x20(2)','binary','SIGINT','rmSync','whitelistEnabled','params','parse','Notifications\x20disabled\x0a','user','latestversion','Notifications\x20enabled','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','search','resetpw_yes','DEFLATE','copyFileSync','storeFiat','date-fns','backupfile','error','Server','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','reinstall-bb','exec','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Disabled\x20','versions','2FA\x20required','/metrics\x20-\x20show\x20bot\x20performance\x0a','util','disabled','server','botname','privateKeyToPem','/update\x20-\x20update\x20Balance\x20Bot\x0a','1000','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','includes','\x20mode','action','Unauthorized\x20attempt\x20to\x20show\x20configuration','/:bot/portfolio','Ok,\x20will\x20send\x20alert\x20notifications\x20only','reload','temporary\x20access\x20rejected','::1','argv','http','Starting\x20Balance\x20Bot\x20update','store-configuration','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','getMonth','once','Error\x20sending\x20','number','backup-full','*$1*','send','/:bot','get-portfolio','running','access\x20timeout','portfolio','headers','data','\x20|\x20client:\x20...','Unauthorized\x20attempt\x20to\x20get\x20portfolio','jsonwebtoken','bb-settings.json','backup-full@','Your\x20installation\x20is\x20already\x20up\x20to\x20date','store-headless','use','warning','emitHistory','loadAsync','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','2FA\x20login\x20token\x20generated','accept','keys','Backup\x20file\x20uploaded','host','-----------------------------------------------------------------------------------','sha256','-config.json','telegramEvents','User\x20has\x20been\x20validated','publicKey','any','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','privateKeyFromPem','generateAsync','portfolio_','/status\x20-\x20show\x20bot(s)\x20status\x0a','manual','-results.json','ipv6','split','login\x20token\x20generated','\x1b[36m','writeFileSync','blacklist','Password\x20has\x20been\x20reset\x20to:\x20','Error:\x20Invalid\x20argument\x20','$1_$2_$3','login\x20token\x20valid','help','cancelLoading','Setting\x20access:\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','backup','Failed\x20to\x20download\x20','restore-backup-file','find','Invalid\x20authentication\x20token\x20(1)','updatebotmanager','CoinMarketCap\x20API\x20key\x20validated','output-000.log','No\x20authentication\x20token','\x20-\x20','reinstall','kill','family','status','orders','port','2296888VLIwMc','/logs\x20-\x20receive\x20log\x20files\x0a','login\x20required','\x20|\x20','lastmsgemitted','Unauthorized\x20attempt\x20to\x20update\x20bot','showConfig','verify','getStartingBalances','logout','config_orders','node-forge','allow','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','initclient','sendPortfolioTelegram','#RES#\x20if\x20running\x20locally\x0a','toggle-bot-mode','2FA\x20login\x20required','telegramUsername','name','download','env','temporaryAccessAllowed','Restore\x20backup\x20file\x20','readFileSync','loginRequired','write','resetHistory','.zip','backup-full.zip','No\x20bots\x20running\x20right\x20now','toString','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','access','live','614586DiwVrL','reinstall_no','update-bb','apiPassword','assign','inlineKeyboard','login2fa_reject_','full','Starting\x20#RED#Balance\x20Bot\x20v','_nsps','Unauthorized\x20attempt\x20to\x20get\x20messages','lowdb/adapters/FileSync','login\x20not\x20required','restart','/start','127.0.0.1','All','bbPassword','publicKeyToPem','telegramEnabled','tempaccess_15_','settings','/:bot/support','backup/','decode64','telegramIpApproval','show','Restarting\x20','map','type','telegrammsg','output-003.log','output-002.log','editMessageReplyMarkup','reason','replace','headless','2905XEulFc','unlinkSync','Telegram\x20error:','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','startsWith','getDate','Error\x20removing\x20old\x20backup\x20files:','sendMetricsTelegram','axios','mode','then','replyWithDocument','inherit','encryptedUuid','socket','metrics','names','Access\x20enabled\x20for\x20','getTime','Unauthorized\x20attempt\x20to\x20store\x20configuration','uncaughtException','getMinutes','messages','decrypt','Enabled\x20','userid','***','sendFile','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',')\x20\x20\x20|\x20Bot\x20','disconnect','\x1b[0m','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','3000','2FA','f2aRequired','Unauthorized\x20attempt\x20to\x20delete\x20bot','success','output-001.log','format','callback','75119eeVtxI','get','#RES#','remove','marketcapApi','Bot\x20Mgr\x20>\x20','express','hasOwnProperty','function','tempaccess_30_'];_0x490d=function(){return _0x2c7f4d;};return _0x490d();}const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x97b7c0(0x1dd)]({'secure':{},'blacklist':[]})[_0x97b7c0(0x2c0)]();const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x97b7c0(0x209),{'host':_0x97b7c0(0x18f)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x97b7c0(0x365)]&&(settings[_0x97b7c0(0x365)]!=''&&settings[_0x97b7c0(0x365)]!='***')&&settings[_0x97b7c0(0x2b8)]&&settings[_0x97b7c0(0x2b8)]!='')initTelegram();const parseColor=(_0x4c8745,_0x5c90f3)=>{const _0x230f02=_0x97b7c0,_0x1338ce=/#[A-Z]{3}#/g;if(typeof _0x4c8745==_0x230f02(0x18e)){!_0x5c90f3?_0x4c8745=_0x4c8745[_0x230f02(0x2ec)](_0x1338ce,''):(_0x4c8745=_0x4c8745['replace'](/#BLU#/g,'\x1b[34m'),_0x4c8745=_0x4c8745[_0x230f02(0x2ec)](/#RED#/g,'\x1b[31m'),_0x4c8745=_0x4c8745[_0x230f02(0x2ec)](/#YEL#/g,_0x230f02(0x397)),_0x4c8745=_0x4c8745[_0x230f02(0x2ec)](/#MAG#/g,'\x1b[35m'),_0x4c8745=_0x4c8745['replace'](/#CYA#/g,_0x230f02(0x289)),_0x4c8745=_0x4c8745[_0x230f02(0x2ec)](/#RES#/g,_0x230f02(0x30d)));;}return _0x4c8745;},logger={'screen':_0x18cefd=>{console['log'](parseColor(_0x18cefd,!![]));},'simple':_0x4bb00e=>{const _0x1c33af=_0x97b7c0;console[_0x1c33af(0x187)](parseColor(_0x4bb00e,!![])),loggerfile[_0x1c33af(0x2c0)](util[_0x1c33af(0x315)](parseColor(_0x4bb00e,![]))+'\x0a');},'full':async _0x14010c=>{const _0x1f1649=_0x97b7c0,_0x15ebe1=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x14010c;console['log'](parseColor(_0x15ebe1,!![])),loggerfile[_0x1f1649(0x2c0)](util['format'](parseColor(_0x15ebe1,![]))+'\x0a');if(tgBot&&settings[_0x1f1649(0x208)]&&settings['telegramEvents']!='orders')await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+parseColor(_0x14010c,![]));},'debug':async(_0x24b25e,_0x2802f5='')=>{const _0x2ed84e=_0x97b7c0,_0x425b6a=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x24b25e;if(debugging)console[_0x2ed84e(0x187)](parseColor(_0x425b6a,!![]));loggerfile['write'](util[_0x2ed84e(0x315)](parseColor(_0x425b6a,![]))+'\x0a');if(_0x2802f5){if(debugging)console[_0x2ed84e(0x187)](_0x2802f5);loggerfile['write'](util['format'](_0x2802f5)+'\x0a');}}};function _0x24ce(_0x2ceee4,_0x1dbc0c){const _0x45ac16=_0x490d();return _0x24ce=function(_0x16202d,_0x1a73a6){_0x16202d=_0x16202d-0x187;let _0x490dd5=_0x45ac16[_0x16202d];return _0x490dd5;},_0x24ce(_0x2ceee4,_0x1dbc0c);}let terminating=![];process['on'](_0x97b7c0(0x302),function(_0x222f35){const _0xc122c5=_0x97b7c0;_0x222f35[_0xc122c5(0x2c5)]()[_0xc122c5(0x24b)]('address\x20already\x20in\x20use')?(logger['simple'](_0xc122c5(0x33f)+_0x222f35['port']+_0xc122c5(0x319)),process[_0xc122c5(0x25f)]({'terminate':!![]},_0x1d5106=>{})):logger[_0xc122c5(0x1a0)](_0x222f35);}),process['on']('exit',()=>{const _0x3c2def=_0x97b7c0;stopAllBots(),process[_0x3c2def(0x326)](0x0);}),process['on'](_0x97b7c0(0x389),()=>{const _0x1f0e6d=_0x97b7c0;stopAllBots(),process[_0x1f0e6d(0x326)](0x0);}),process['on'](_0x97b7c0(0x228),()=>{const _0x4953a7=_0x97b7c0;stopAllBots(),process[_0x4953a7(0x326)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x97b7c0(0x378))[_0x97b7c0(0x35d)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x97b7c0(0x31d)),app=express(),http=require(_0x97b7c0(0x255))[_0x97b7c0(0x35a)](app);app[_0x97b7c0(0x26e)](fileUpload({'useTempFiles':!![]})),app['get'](_0x97b7c0(0x349),async(_0x240405,_0x18b82b)=>{const _0x321d51=_0x97b7c0,_0xa5a7d3=_0x240405[_0x321d51(0x22b)]['type'],_0x176b28=getClientsWithBotID(_0x321d51(0x38d)),_0x36e0da=_0x240405[_0x321d51(0x265)]['uuid'],_0x341d7d=timelyDecrypt(_0x36e0da,![]),_0x5c1ce0=_0x176b28[_0x321d51(0x298)](_0xf12ac3=>_0xf12ac3[_0x321d51(0x391)]==_0x341d7d);if(_0x5c1ce0){const _0x5a1f35=normalizeIP(_0x240405[_0x321d51(0x2fc)][_0x321d51(0x321)])[_0x321d51(0x1c4)],_0x5c9238=_0x240405[_0x321d51(0x265)]['tkn'];if(validateAccess(_0x5c9238,_0x341d7d,_0x5a1f35)['allow'])_0xa5a7d3==_0x321d51(0x295)&&await backupConfigFiles(),await zipFiles(_0xa5a7d3),_0x18b82b[_0x321d51(0x2ba)](zippath+(_0xa5a7d3+_0x321d51(0x2c2)),_0x5de089=>{const _0x2a3dba=_0x321d51;_0x5de089&&(logger[_0x2a3dba(0x2d0)](_0x2a3dba(0x296)+_0xa5a7d3),logger['simple'](_0x5de089));});else logger[_0x321d51(0x2d0)](_0x321d51(0x206)+_0xa5a7d3+_0x321d51(0x1c9));}else logger[_0x321d51(0x2d0)](_0x321d51(0x206)+_0xa5a7d3+_0x321d51(0x226));}),app[_0x97b7c0(0x338)]('/upload-backup',async(_0x57ca52,_0x2f04f9)=>{const _0x55fee5=_0x97b7c0,_0x57f216=getClientsWithBotID(_0x55fee5(0x38d)),_0x25f36e=_0x57ca52[_0x55fee5(0x265)]['uuid'],_0x6496cc=timelyDecrypt(_0x25f36e,![]),_0x5c6996=_0x57f216['find'](_0x5236a7=>_0x5236a7[_0x55fee5(0x391)]==_0x6496cc);logger[_0x55fee5(0x35e)](_0x55fee5(0x276));if(_0x5c6996){const _0x4f859f=normalizeIP(_0x57ca52[_0x55fee5(0x2fc)][_0x55fee5(0x321)])[_0x55fee5(0x1c4)],_0x4d7b2a=_0x57ca52[_0x55fee5(0x265)][_0x55fee5(0x1a3)];if(validateAccess(_0x4d7b2a,_0x6496cc,_0x4f859f)['allow']){if(_0x57ca52[_0x55fee5(0x32a)]){const _0x26b728=_0x57ca52[_0x55fee5(0x32a)][_0x55fee5(0x238)];await _0x26b728['mv'](temppath+_0x26b728[_0x55fee5(0x2b9)]),_0x2f04f9['send']({'status':!![],'message':_0x55fee5(0x1ba)});const _0x59ead9=getBotsWithMode();_0x59ead9[_0x55fee5(0x38c)]>0x0?confirmRestore(temppath,_0x26b728['name']):unzipFile(temppath,_0x26b728[_0x55fee5(0x2b9)]);}}else logger[_0x55fee5(0x2d0)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x55fee5(0x2d0)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x97b7c0(0x26e)](express[_0x97b7c0(0x20d)](path[_0x97b7c0(0x39b)](__dirname,bbpath2,_0x97b7c0(0x33a)))),app['use'](express['static'](path[_0x97b7c0(0x39b)](__dirname,bbpath2,_0x97b7c0(0x195)))),app[_0x97b7c0(0x318)]('/',function(_0x10c4dc,_0x4bf8d5){const _0x71d76c=_0x97b7c0;_0x4bf8d5[_0x71d76c(0x309)](path[_0x71d76c(0x39b)](__dirname,bbpath2,_0x71d76c(0x33a),_0x71d76c(0x203)));}),app[_0x97b7c0(0x318)](_0x97b7c0(0x260),function(_0x5ac2dd,_0x29549f){const _0xec04c2=_0x97b7c0;_0x29549f[_0xec04c2(0x309)](path['join'](__dirname,bbpath2,_0xec04c2(0x195),_0xec04c2(0x203)));}),app[_0x97b7c0(0x318)](_0x97b7c0(0x24f),(_0x250736,_0x5474a0)=>{const _0x5a16cc=_0x97b7c0;_0x5474a0[_0x5a16cc(0x309)](path[_0x5a16cc(0x39b)](__dirname,bbpath2,'build','index.html'));}),app[_0x97b7c0(0x318)](_0x97b7c0(0x390),(_0x2b4b14,_0x5e45a7)=>{const _0x4d75c7=_0x97b7c0;_0x5e45a7[_0x4d75c7(0x309)](path[_0x4d75c7(0x39b)](__dirname,bbpath2,_0x4d75c7(0x195),_0x4d75c7(0x203)));}),app[_0x97b7c0(0x318)]('/:bot/coins',(_0x2cec30,_0x140822)=>{const _0xfde0f7=_0x97b7c0;_0x140822[_0xfde0f7(0x309)](path[_0xfde0f7(0x39b)](__dirname,bbpath2,_0xfde0f7(0x195),_0xfde0f7(0x203)));}),app['get'](_0x97b7c0(0x1d1),(_0x59d88b,_0x20e06f)=>{const _0x568445=_0x97b7c0;_0x20e06f[_0x568445(0x309)](path['join'](__dirname,bbpath2,_0x568445(0x195),_0x568445(0x203)));}),app[_0x97b7c0(0x318)](_0x97b7c0(0x1bb),(_0x5848b4,_0x4b131e)=>{const _0x3d2f79=_0x97b7c0;_0x4b131e[_0x3d2f79(0x309)](path[_0x3d2f79(0x39b)](__dirname,bbpath2,'build',_0x3d2f79(0x203)));}),app[_0x97b7c0(0x318)](_0x97b7c0(0x2df),(_0x53a22b,_0x37de08)=>{const _0x35140e=_0x97b7c0;_0x37de08[_0x35140e(0x309)](path[_0x35140e(0x39b)](__dirname,bbpath2,_0x35140e(0x195),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http['listen'](PORT);const io=require(_0x97b7c0(0x190))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x3d24b4=_0x97b7c0;let _0x2e26e6=_0x3d24b4(0x394);const _0x14885b=networkInterfaces(),_0x3960db={};for(const _0xb250b8 of Object['keys'](_0x14885b)){for(const _0x4e4ce4 of _0x14885b[_0xb250b8]){if((_0x4e4ce4[_0x3d24b4(0x2a1)]=='IPv4'||_0x4e4ce4[_0x3d24b4(0x2a1)]==0x4)&&!_0x4e4ce4[_0x3d24b4(0x398)]){const _0x314c75=ipaddr[_0x3d24b4(0x22c)](_0x4e4ce4[_0x3d24b4(0x1a5)])[_0x3d24b4(0x205)]();_0x314c75!=_0x3d24b4(0x1b2)&&(!_0x3960db[_0xb250b8]&&(_0x3960db[_0xb250b8]=[]),_0x3960db[_0xb250b8][_0x3d24b4(0x39e)](_0x4e4ce4['address']),_0x2e26e6=_0x4e4ce4[_0x3d24b4(0x1a5)]);}}}return{'serverip':_0x2e26e6,'netinterfaces':_0x3960db};}async function startServer(){const _0x2f98df=_0x97b7c0,{serverip:_0xfb3996,netinterfaces:_0x250c1a}=getServerIP();logger['simple'](''),logger[_0x2f98df(0x1a0)](_0x2f98df(0x278)),await logger[_0x2f98df(0x2d0)](_0x2f98df(0x2d1)+serverversion+_0x2f98df(0x38e)+(environment=='staging'?'(staging)':'')+'\x0a'+(_0x2f98df(0x371)+PORT+_0x2f98df(0x2b5))+(_0x2f98df(0x1bd)+_0xfb3996+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x2f98df(0x1a0)](_0x2f98df(0x278));if(config[_0x2f98df(0x38c)]!=0x0)for(const _0x5e518b of config){const _0x5c278b=_0x5e518b[_0x2f98df(0x2f7)]==_0x2f98df(0x1db)?'a':'m';if(_0x5e518b[_0x2f98df(0x2a2)]==_0x2f98df(0x196)||_0x5e518b[_0x2f98df(0x2a2)]==_0x2f98df(0x395))await logger[_0x2f98df(0x2d0)](_0x2f98df(0x37a)+_0x5c278b+')\x20|\x20Bot\x20'+_0x5e518b[_0x2f98df(0x333)]+'\x20|\x20'+_0x5e518b['botname']),startBot([_0x5e518b[_0x2f98df(0x333)],userID],{'cwd':bbpath},function(_0x4a1bfb){if(_0x4a1bfb)logger['full'](_0x4a1bfb);});else(_0x5e518b[_0x2f98df(0x2a2)]=='disabled'||_0x5e518b['status']==_0x2f98df(0x20b))&&await logger[_0x2f98df(0x2d0)]('Idling\x20('+_0x5c278b+_0x2f98df(0x30b)+_0x5e518b[_0x2f98df(0x333)]+_0x2f98df(0x2a8)+_0x5e518b[_0x2f98df(0x246)]);}else!newBot&&logger[_0x2f98df(0x1a0)](_0x2f98df(0x1e1));if(newBot)addBot();logger[_0x2f98df(0x1a0)](_0x2f98df(0x278)),logger[_0x2f98df(0x1a0)](''),await logger['debug'](_0x2f98df(0x1e3)+nodeversion),await logger[_0x2f98df(0x35e)](_0x2f98df(0x33d),_0x250c1a);}function startSocket(){const _0x43633b=_0x97b7c0;io['on'](_0x43633b(0x18b),_0x9f73df=>{const _0x432e59=_0x43633b;let _0x46a254,_0x486801,_0x471a23,_0x16258f,_0x57cd4a;const _0x7ebe57=_0x9f73df[_0x432e59(0x358)][_0x432e59(0x265)][_0x432e59(0x34a)];_0x486801=_0x7ebe57[_0x432e59(0x200)](/bot[0-9]{3}/);if(_0x486801)_0x471a23=_0x486801[0x0][_0x432e59(0x200)](/[0-9]{3}/);if(_0x471a23)_0x46a254=_0x471a23[0x0];else _0x46a254='botmanager';const _0x303ad7=_0x9f73df[_0x432e59(0x358)][_0x432e59(0x32e)][_0x432e59(0x2fb)];if(!_0x303ad7)_0x9f73df[_0x432e59(0x20e)](_0x432e59(0x2a2),{'publicKey':secure[_0x432e59(0x27d)]});else{_0x16258f=timelyDecrypt(_0x303ad7,![]);if(!_0x16258f)_0x9f73df[_0x432e59(0x20e)](_0x432e59(0x2a2),{'publicKey':secure[_0x432e59(0x27d)]});else{_0x57cd4a=normalizeIP(_0x9f73df[_0x432e59(0x202)][_0x432e59(0x321)])['store'];if(!devices[_0x16258f])devices[_0x16258f]={'uuid':_0x16258f,'access':{'token':null}};devices[_0x16258f]['ip']=_0x57cd4a;const _0x18ad3b=addClient(_0x9f73df['id'],_0x16258f,_0x46a254);setAccess(_0x18ad3b),emitMessages(),_0x9f73df['on']('login',_0x5de6b1=>{const _0x306209=_0x432e59,_0x414a0b=timelyDecrypt(_0x5de6b1['password'],!![],_0x306209(0x213));if(_0x414a0b){_0x5de6b1={'username':_0x5de6b1[_0x306209(0x19c)],'password':_0x414a0b},devices[_0x16258f][_0x306209(0x2c7)]=validateCredentials(_0x5de6b1,_0x16258f);if(devices[_0x16258f][_0x306209(0x2c7)]['allow']==![]&&devices[_0x16258f]['access'][_0x306209(0x2eb)]==_0x306209(0x2b7))_0x9f73df[_0x306209(0x20e)](_0x306209(0x2a2),{'access':devices[_0x16258f][_0x306209(0x2c7)]}),loginAccess2FA(_0x16258f,_0x57cd4a);else{if(devices[_0x16258f][_0x306209(0x2c7)][_0x306209(0x2b1)]==![]&&devices[_0x16258f][_0x306209(0x2c7)][_0x306209(0x2eb)]==_0x306209(0x34b))_0x9f73df['emit']('status',{'access':devices[_0x16258f][_0x306209(0x2c7)]});else devices[_0x16258f][_0x306209(0x2c7)]['allow']&&devices[_0x16258f][_0x306209(0x2c7)][_0x306209(0x2eb)]==_0x306209(0x288)&&(getClientsWithUuid(_0x16258f)[_0x306209(0x19d)](_0x580ca6=>{setAccess(_0x580ca6);}),logger[_0x306209(0x35e)]('Logged\x20in\x20user\x20...'+_0x16258f[_0x306209(0x1ee)](-0x8)),setTokenRefresh(_0x16258f),setSessionTimeout(_0x306209(0x1b1),_0x16258f));}}else logger[_0x306209(0x2d0)](_0x306209(0x39f));}),_0x9f73df['on'](_0x432e59(0x374),()=>{resetPassword();}),_0x9f73df['on']('disconnect',_0x34b2da=>{removeClient(_0x9f73df['id']);}),_0x46a254==_0x432e59(0x38d)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x11a06e){const _0xd940cf=_0x97b7c0;if(_0x11a06e!='botmanager'&&config[_0xd940cf(0x1b9)]!=''){if(pid[_0x11a06e])pid[_0x11a06e][_0xd940cf(0x25f)]({'function':_0xd940cf(0x2b3),'args':null});}_0x11a06e!='botmanager'&&broadcastToBots(_0xd940cf(0x32c),JSON[_0xd940cf(0x1cd)](config));}function reloadBotManager(){const _0x40b4d2=_0x97b7c0;getClientsWithBotID(_0x40b4d2(0x38d))[_0x40b4d2(0x19d)](_0xca368b=>{const _0x326aca=_0x40b4d2;getSocket(_0xca368b['id'])[_0x326aca(0x20e)](_0x326aca(0x2a2),{'access':{'allow':![],'reason':_0x326aca(0x251),'token':null}});});}function getSocket(_0x5f054b){const _0x4b128=_0x97b7c0,_0x314500=io[_0x4b128(0x2d2)][_0x4b128(0x318)]('/');return _0x314500[_0x4b128(0x37e)][_0x4b128(0x318)](_0x5f054b);}function setAccess(_0x14361e){const _0xf88245=_0x97b7c0,_0x1298f0=getSocket(_0x14361e['id']),_0x51fc7c=_0x14361e[_0xf88245(0x391)],_0x3fb7ed=_0x14361e['bot'];devices[_0x51fc7c][_0xf88245(0x2c7)]=validateAccess(devices[_0x51fc7c][_0xf88245(0x2c7)][_0xf88245(0x18a)],_0x51fc7c),logger[_0xf88245(0x35e)](_0xf88245(0x292)+devices[_0x51fc7c][_0xf88245(0x2c7)][_0xf88245(0x2eb)]+_0xf88245(0x267)+_0x14361e['id'][_0xf88245(0x1ee)](-0x8)+_0xf88245(0x327)+_0x51fc7c['slice'](-0x8)),_0x1298f0[_0xf88245(0x39b)](_0x51fc7c);if(devices[_0x51fc7c][_0xf88245(0x2c7)][_0xf88245(0x2b1)]){_0x1298f0['join'](_0x3fb7ed);if(_0x3fb7ed=='botmanager')initializeSocketBotManager(_0x1298f0);else initializeSocketBot(_0x1298f0);initClient(_0x3fb7ed);}devices[_0x51fc7c][_0xf88245(0x2c7)][_0xf88245(0x18a)]&&devices[_0x51fc7c]['access'][_0xf88245(0x2eb)]==_0xf88245(0x21a)&&setSessionTimeout(_0xf88245(0x310),_0x51fc7c),devices[_0x51fc7c][_0xf88245(0x2c7)][_0xf88245(0x18a)]&&devices[_0x51fc7c][_0xf88245(0x2c7)][_0xf88245(0x2eb)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0x51fc7c),_0x1298f0[_0xf88245(0x20e)](_0xf88245(0x2a2),{'status':_0x14361e[_0xf88245(0x245)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x51fc7c][_0xf88245(0x2c7)],'externalip':devices[_0x51fc7c]['ip'],'publicKey':secure[_0xf88245(0x27d)],'userid':settings[_0xf88245(0x307)],'validInstallation':validInstallation}),devices[_0x51fc7c][_0xf88245(0x2c7)][_0xf88245(0x2b1)]==![]&&devices[_0x51fc7c][_0xf88245(0x2c7)][_0xf88245(0x2eb)]==_0xf88245(0x241)&&temporaryAccess2FA(_0x51fc7c,devices[_0x51fc7c]['ip']);}function setSessionTimeout(_0x577b25,_0x86902a){const _0x4e2fbc=_0x97b7c0;let _0x12210a;if(_0x577b25==_0x4e2fbc(0x1b1))_0x12210a=loginExpiry*0x3c*0x3e8;else _0x12210a=devices[_0x86902a][_0x4e2fbc(0x2e2)]['expiry']*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x86902a][_0x4e2fbc(0x2e2)][_0x4e2fbc(0x1da)]);if(devices[_0x86902a][_0x4e2fbc(0x215)])clearTimeout(devices[_0x86902a][_0x4e2fbc(0x215)]);devices[_0x86902a]['pidExpireLogin']=setTimeout(()=>{const _0x35f016=_0x4e2fbc;if(devices[_0x86902a][_0x35f016(0x323)])clearTimeout(devices[_0x86902a][_0x35f016(0x323)]);removeSocketListeners(_0x86902a),addBlacklist(_0x86902a),devices[_0x86902a][_0x35f016(0x2e2)]=null,devices[_0x86902a][_0x35f016(0x3a5)]=null,devices[_0x86902a][_0x35f016(0x2c7)][_0x35f016(0x18a)]=null,logger['debug'](_0x35f016(0x1e0)+_0x86902a[_0x35f016(0x1ee)](-0x8)),devices[_0x86902a][_0x35f016(0x2c7)]=validateAccess(devices[_0x86902a][_0x35f016(0x2c7)]['token'],_0x86902a),!(devices[_0x86902a][_0x35f016(0x2c7)][_0x35f016(0x2b1)]&&devices[_0x86902a]['access'][_0x35f016(0x2eb)]==_0x35f016(0x2d5))&&(_0x577b25==_0x35f016(0x1b1)?io['to'](_0x86902a)[_0x35f016(0x20e)]('status',{'access':{'allow':![],'reason':_0x35f016(0x263),'token':null}}):io['to'](_0x86902a)[_0x35f016(0x20e)](_0x35f016(0x2a2),{'access':{'allow':![],'reason':_0x35f016(0x1ca),'token':null}})),devices[_0x86902a][_0x35f016(0x2c7)]['token']=null;},_0x12210a);}function setTokenRefresh(_0x4f10b4){const _0x22fde9=_0x97b7c0;if(devices[_0x4f10b4][_0x22fde9(0x323)])clearTimeout(devices[_0x4f10b4][_0x22fde9(0x323)]);devices[_0x4f10b4][_0x22fde9(0x323)]=setTimeout(()=>{const _0x5349c4=_0x22fde9;getClientsWithUuid(_0x4f10b4)['length']!=0x0?(devices[_0x4f10b4]['access']=refreshToken(_0x4f10b4),io['to'](_0x4f10b4)[_0x5349c4(0x20e)](_0x5349c4(0x2a2),{'status':_0x5349c4(0x1f1),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4f10b4][_0x5349c4(0x2c7)],'externalip':devices[_0x4f10b4]['ip'],'publicKey':secure[_0x5349c4(0x27d)],'validInstallation':validInstallation}),setTokenRefresh(_0x4f10b4)):clearTimeout(devices[_0x4f10b4][_0x5349c4(0x323)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x320a90){const _0x1d1585=_0x97b7c0,_0x59cf32=getClient(_0x320a90['id'])[_0x1d1585(0x391)];_0x320a90[_0x1d1585(0x20e)]('bots',config),_0x320a90['emit'](_0x1d1585(0x2de),cleanSettings()),_0x320a90['on'](_0x1d1585(0x1bc),_0x35f347=>{const _0x5093fa=_0x1d1585;if(validateAccess(_0x35f347,_0x59cf32)[_0x5093fa(0x2b1)])addBot();else logger[_0x5093fa(0x2d0)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x320a90['on'](_0x1d1585(0x34f),(_0x294ddb,_0x301046)=>{const _0xa279e5=_0x1d1585;if(validateAccess(_0x301046,_0x59cf32)[_0xa279e5(0x2b1)])toggleBot(_0x294ddb[_0xa279e5(0x333)],_0x294ddb[_0xa279e5(0x2a2)],_0x294ddb['live']);else logger[_0xa279e5(0x2d0)](_0xa279e5(0x2aa));}),_0x320a90['on'](_0x1d1585(0x2b6),(_0x452e9b,_0x4b0831)=>{const _0x2155cb=_0x1d1585;if(validateAccess(_0x4b0831,_0x59cf32)[_0x2155cb(0x2b1)])toggleBotMode(_0x452e9b);else logger[_0x2155cb(0x2d0)](_0x2155cb(0x2aa));}),_0x320a90['on']('delete-bot',(_0x335848,_0x596085)=>{const _0x2e4987=_0x1d1585;if(validateAccess(_0x596085,_0x59cf32)['allow'])deleteBot(_0x335848);else logger[_0x2e4987(0x2d0)](_0x2e4987(0x312));}),_0x320a90['on'](_0x1d1585(0x216),(_0x6c5dff,_0x2d1f02)=>{const _0x1ef807=_0x1d1585;if(validateAccess(_0x2d1f02,_0x59cf32)[_0x1ef807(0x2b1)])storeSettings(_0x6c5dff,!![]);else logger[_0x1ef807(0x2d0)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x320a90['on'](_0x1d1585(0x2cb),_0x3d8c75=>{const _0x376576=_0x1d1585;if(validateAccess(_0x3d8c75,_0x59cf32)[_0x376576(0x2b1)])updateBB(_0x376576(0x21e));else logger[_0x376576(0x2d0)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x320a90['on'](_0x1d1585(0x23c),_0x27440d=>{const _0x2aa58a=_0x1d1585;if(validateAccess(_0x27440d,_0x59cf32)[_0x2aa58a(0x2b1)])updateBB('reinstall');else logger[_0x2aa58a(0x2d0)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x320a90['on']('get-backup-files',_0x4033b3=>{const _0x10cb36=_0x1d1585;if(validateAccess(_0x4033b3,_0x59cf32)[_0x10cb36(0x2b1)]){const _0x487a06=getClient(_0x320a90['id']);if(_0x487a06)getBackupFiles(_0x487a06[_0x10cb36(0x391)]);else logger['full'](_0x10cb36(0x258));}else logger[_0x10cb36(0x2d0)](_0x10cb36(0x19b));}),_0x320a90['on'](_0x1d1585(0x297),(_0x34d583,_0x30093d)=>{const _0x2ea278=_0x1d1585;if(validateAccess(_0x30093d,_0x59cf32)['allow'])restoreBackupFile(_0x34d583);else logger[_0x2ea278(0x2d0)](_0x2ea278(0x383));}),_0x320a90['on'](_0x1d1585(0x220),_0x3ed623=>{const _0x41f578=_0x1d1585;if(validateAccess(_0x3ed623,_0x59cf32)[_0x41f578(0x2b1)])getMessages();else logger[_0x41f578(0x2d0)](_0x41f578(0x2d3));}),_0x320a90['on'](_0x1d1585(0x1fd),(_0x392b8f,_0x144d82)=>{const _0x31bfc1=_0x1d1585;if(validateAccess(_0x144d82,_0x59cf32)[_0x31bfc1(0x2b1)])confirmMessage(_0x392b8f);else logger[_0x31bfc1(0x2d0)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x320a90['on'](_0x1d1585(0x2ae),_0x8abdfa=>{const _0x26e8ae=_0x1d1585;if(validateAccess(_0x8abdfa,_0x59cf32)[_0x26e8ae(0x2b1)]){if(devices[_0x59cf32][_0x26e8ae(0x323)])clearTimeout(devices[_0x59cf32][_0x26e8ae(0x323)]);if(devices[_0x59cf32]['pidExpireLogin'])clearTimeout(devices[_0x59cf32][_0x26e8ae(0x215)]);removeSocketListeners(getClient(_0x320a90['id'])['uuid']),addBlacklist(_0x59cf32),devices[_0x59cf32][_0x26e8ae(0x2e2)]=null,devices[_0x59cf32][_0x26e8ae(0x3a5)]=null,devices[_0x59cf32][_0x26e8ae(0x2c7)][_0x26e8ae(0x18a)]=null,logger[_0x26e8ae(0x35e)](_0x26e8ae(0x330)+_0x59cf32[_0x26e8ae(0x1ee)](-0x8)),io['to'](getClient(_0x320a90['id'])[_0x26e8ae(0x391)])[_0x26e8ae(0x20e)](_0x26e8ae(0x2a2),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x26e8ae(0x39a));});}function initializeSocketBot(_0x4157b0){const _0x12b6c5=_0x97b7c0,_0xc06067=getClient(_0x4157b0['id'])[_0x12b6c5(0x348)],_0x177884=getClient(_0x4157b0['id'])[_0x12b6c5(0x391)];_0x4157b0['on']('get-logs',(_0x1bb51e,_0x5f39f6)=>{const _0x26b144=_0x12b6c5;if(validateAccess(_0x5f39f6,_0x177884)['allow']){if(pid[_0xc06067])pid[_0xc06067][_0x26b144(0x25f)]({'function':_0x26b144(0x270),'args':_0x1bb51e});}else logger['full'](_0x26b144(0x34d));}),_0x4157b0['on'](_0x12b6c5(0x1f5),(_0xf3aca4,_0x4e7b72)=>{const _0x1e80ba=_0x12b6c5;if(validateAccess(_0x4e7b72,_0x177884)[_0x1e80ba(0x2b1)]){if(pid[_0xc06067])pid[_0xc06067][_0x1e80ba(0x25f)]({'function':_0x1e80ba(0x368),'args':_0xf3aca4});}else logger[_0x1e80ba(0x2d0)](_0x1e80ba(0x1f3));}),_0x4157b0['on'](_0x12b6c5(0x261),(_0x49a44a,_0x45f90b)=>{const _0x3fc05a=_0x12b6c5;if(validateAccess(_0x45f90b,_0x177884)[_0x3fc05a(0x2b1)]){if(pid[_0xc06067])pid[_0xc06067][_0x3fc05a(0x25f)]({'function':_0x3fc05a(0x1a8),'args':_0x49a44a});}else logger['full'](_0x3fc05a(0x268));}),_0x4157b0['on'](_0x12b6c5(0x257),(_0x16a290,_0x5852f1)=>{const _0x1a437c=_0x12b6c5;if(validateAccess(_0x5852f1,_0x177884)[_0x1a437c(0x2b1)]){if(pid[_0xc06067])pid[_0xc06067][_0x1a437c(0x25f)]({'function':_0x1a437c(0x334),'args':_0x16a290});}else logger[_0x1a437c(0x2d0)](_0x1a437c(0x301));}),_0x4157b0['on'](_0x12b6c5(0x26d),(_0x115f5a,_0x29c146)=>{const _0x14fd3b=_0x12b6c5;if(validateAccess(_0x29c146,_0x177884)[_0x14fd3b(0x2b1)]){if(pid[_0xc06067])pid[_0xc06067][_0x14fd3b(0x25f)]({'function':'storeHeadless','args':_0x115f5a});}else logger[_0x14fd3b(0x2d0)](_0x14fd3b(0x27f));}),_0x4157b0['on'](_0x12b6c5(0x346),(_0xce50e5,_0x3397d5)=>{const _0x2aaa31=_0x12b6c5;if(validateAccess(_0x3397d5,_0x177884)[_0x2aaa31(0x2b1)]){if(pid[_0xc06067])pid[_0xc06067]['send']({'function':_0x2aaa31(0x236),'args':_0xce50e5});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x4157b0['on'](_0x12b6c5(0x359),_0x4de911=>{const _0x12fd7d=_0x12b6c5;if(validateAccess(_0x4de911,_0x177884)[_0x12fd7d(0x2b1)]){if(pid[_0xc06067])pid[_0xc06067][_0x12fd7d(0x25f)]({'function':_0x12fd7d(0x2c1),'args':null});}else logger[_0x12fd7d(0x2d0)](_0x12fd7d(0x332));}),_0x4157b0['on'](_0x12b6c5(0x37c),_0x3f0395=>{const _0x1285b9=_0x12b6c5;if(validateAccess(_0x3f0395,_0x177884)['allow']){if(pid[_0xc06067])pid[_0xc06067][_0x1285b9(0x25f)]({'function':_0x1285b9(0x2ad),'args':null});}else logger[_0x1285b9(0x2d0)](_0x1285b9(0x1bf));}),_0x4157b0['on'](_0x12b6c5(0x1b7),(_0x1dc3f0,_0x3dbf21)=>{const _0xd0c26e=_0x12b6c5;if(validateAccess(_0x3dbf21,_0x177884)['allow']){if(pid[_0xc06067])pid[_0xc06067]['send']({'function':_0xd0c26e(0x1f8),'args':_0x1dc3f0});}else logger[_0xd0c26e(0x2d0)](_0xd0c26e(0x231));}),_0x4157b0['on'](_0x12b6c5(0x329),_0x4506d9=>{const _0x3c0964=_0x12b6c5;if(validateAccess(_0x4506d9,_0x177884)[_0x3c0964(0x2b1)]){if(pid[_0xc06067])pid[_0xc06067][_0x3c0964(0x25f)]({'function':_0x3c0964(0x291),'args':null});}else logger[_0x3c0964(0x2d0)](_0x3c0964(0x36a));}),_0x4157b0['on']('show-config',_0x310f61=>{const _0x567489=_0x12b6c5;if(validateAccess(_0x310f61,_0x177884)[_0x567489(0x2b1)]){if(pid[_0xc06067])pid[_0xc06067][_0x567489(0x25f)]({'function':_0x567489(0x2ab),'args':null});}else logger[_0x567489(0x2d0)](_0x567489(0x24e));}),_0x4157b0['on']('update-bb',_0x46cef9=>{const _0x677b0c=_0x12b6c5;if(validateAccess(_0x46cef9,_0x177884)['allow'])updateBB(_0x677b0c(0x21e));else logger[_0x677b0c(0x2d0)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x4157b0['on'](_0x12b6c5(0x220),_0x408119=>{const _0xfc18bd=_0x12b6c5;if(validateAccess(_0x408119,_0x177884)[_0xfc18bd(0x2b1)])getMessages();else logger[_0xfc18bd(0x2d0)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x4157b0['on'](_0x12b6c5(0x1fd),(_0x440a41,_0x289c6f)=>{const _0x4fcbf4=_0x12b6c5;if(validateAccess(_0x289c6f,_0x177884)[_0x4fcbf4(0x2b1)])confirmMessage(_0x440a41);else logger[_0x4fcbf4(0x2d0)](_0x4fcbf4(0x32f));}),_0x4157b0['on']('logout',_0x38b1ac=>{const _0x147450=_0x12b6c5;if(validateAccess(_0x38b1ac,_0x177884)[_0x147450(0x2b1)]){if(devices[_0x177884][_0x147450(0x323)])clearTimeout(devices[_0x177884][_0x147450(0x323)]);if(devices[_0x177884]['pidExpireLogin'])clearTimeout(devices[_0x177884][_0x147450(0x215)]);removeSocketListeners(getClient(_0x4157b0['id'])[_0x147450(0x391)]),addBlacklist(_0x177884),devices[_0x177884]['telegramIpApproval']=null,devices[_0x177884][_0x147450(0x3a5)]=null,devices[_0x177884][_0x147450(0x2c7)][_0x147450(0x18a)]=null,logger[_0x147450(0x35e)](_0x147450(0x330)+_0x177884[_0x147450(0x1ee)](-0x8)),io['to'](getClient(_0x4157b0['id'])['uuid'])[_0x147450(0x20e)](_0x147450(0x2a2),{'access':{'allow':![],'reason':_0x147450(0x3a0),'token':null}});}else logger[_0x147450(0x2d0)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x38a570){getClientsWithUuid(_0x38a570)['forEach'](_0x50d36d=>{getSocket(_0x50d36d['id'])['removeAllListeners']();});}function cleanSettings(){const _0x41bb38=_0x97b7c0;let _0x117328=settings;return settings[_0x41bb38(0x365)]&&settings[_0x41bb38(0x365)]!=''&&(_0x117328={..._0x117328,'telegramToken':'************'}),settings[_0x41bb38(0x2da)]&&settings[_0x41bb38(0x2da)]!=''&&(_0x117328={..._0x117328,'bbPassword':'************'}),settings[_0x41bb38(0x31b)]&&settings[_0x41bb38(0x31b)]!=''&&(_0x117328={..._0x117328,'marketcapApi':'************'}),(settings['bbPassword']&&settings[_0x41bb38(0x2da)]==_0x41bb38(0x308)||settings[_0x41bb38(0x365)]&&settings[_0x41bb38(0x365)]=='***'||settings[_0x41bb38(0x31b)]&&settings['marketcapApi']=='***')&&(_0x117328={..._0x117328,'restored':{'password':settings[_0x41bb38(0x2da)]==_0x41bb38(0x308),'telegram':settings[_0x41bb38(0x365)]==_0x41bb38(0x308),'marketcap':settings[_0x41bb38(0x31b)]==_0x41bb38(0x308)}}),_0x117328;}async function updateBB(_0x280fb7){const _0x348819=_0x97b7c0;await backupConfigFiles(),installingUpdate=!![],config[_0x348819(0x19d)](_0x558b8c=>{const _0x35646b=_0x348819;restartBot(_0x558b8c[_0x35646b(0x333)]);});if(_0x280fb7=='update')process[_0x348819(0x25f)]({'update':!![],'environment':environment},_0x1882cd=>{});else _0x280fb7==_0x348819(0x29f)&&process[_0x348819(0x25f)]({'reinstall':!![],'environment':environment},_0x262eda=>{});}function startBot(_0x3ea036,_0x110205,_0x5ceca2){const _0x2774eb=_0x97b7c0;if(debugging)_0x3ea036['push']('-d');if(recreate)_0x3ea036[_0x2774eb(0x39e)]('-r');let _0x29ed6e=![];const _0x43fc54=_0x3ea036[0x0];_0x110205={..._0x110205,'stdio':[_0x2774eb(0x2fa),_0x2774eb(0x2fa),'inherit',_0x2774eb(0x331)]},pid[_0x43fc54]=childProcess['fork'](botfile,_0x3ea036,_0x110205),pid[_0x43fc54]['on'](_0x2774eb(0x33c),_0xe8876c=>{const _0x54781b=_0x2774eb;switch(Object[_0x54781b(0x275)](_0xe8876c)[0x0]){case _0x54781b(0x246):updateBotName(_0x43fc54,_0xe8876c['botname']);break;case _0x54781b(0x29a):updateBotManager();break;case'status':updateStatus(_0x43fc54,_0xe8876c[_0x54781b(0x2a2)]);break;case _0x54781b(0x2c8):updateLive(_0x43fc54,_0xe8876c[_0x54781b(0x2c8)]);break;case _0x54781b(0x340):updateLive(_0x43fc54,_0xe8876c[_0x54781b(0x340)]),io['to'](_0x43fc54)[_0x54781b(0x20e)]('status',{'access':{'allow':![],'reason':_0x54781b(0x251),'token':null}});break;case _0x54781b(0x342):_0xe8876c[_0x54781b(0x342)]==_0x54781b(0x2d6)&&restartBot(_0x43fc54);_0xe8876c[_0x54781b(0x342)]==_0x54781b(0x2a0)&&toggleBot(_0x43fc54,_0x54781b(0x244),_0x54781b(0x1fc));break;case _0x54781b(0x193):sendTelegramBot(_0x43fc54,_0xe8876c[_0x54781b(0x193)]);break;case _0x54781b(0x2e7):sendTelegramMsg(_0xe8876c[_0x54781b(0x2e7)]);break;case'function':io['to'](_0x43fc54)[_0x54781b(0x20e)](_0xe8876c[_0x54781b(0x31f)],_0xe8876c[_0x54781b(0x1b4)]);break;}}),pid[_0x43fc54]['on'](_0x2774eb(0x239),function(_0x49258d){if(_0x29ed6e)return;_0x29ed6e=!![],_0x5ceca2(_0x49258d);}),pid[_0x43fc54]['on'](_0x2774eb(0x326),async function(_0x540ee7){const _0x2dc974=_0x2774eb;if(terminating)return;if(installingUpdate){io[_0x2dc974(0x1ea)]();return;}if(_0x29ed6e)return;_0x29ed6e=!![],_0x5ceca2(null);const _0x230eee=dbConfig[_0x2dc974(0x318)](_0x2dc974(0x32c))[_0x2dc974(0x298)]({'botID':_0x43fc54})[_0x2dc974(0x33e)]();_0x230eee&&(_0x230eee[_0x2dc974(0x2a2)]==_0x2dc974(0x196)||_0x230eee[_0x2dc974(0x2a2)]==_0x2dc974(0x395))&&(await sleep(0x3e8),updateLive(_0x43fc54,_0x2dc974(0x1fc)),logger[_0x2dc974(0x2d0)](_0x2dc974(0x2e4)+botRef(_0x43fc54)),startBot([_0x43fc54,userID],{'cwd':bbpath},function(_0x1650ae){if(_0x1650ae)logger['full'](_0x1650ae);}));});}function stopBot(_0x376ea7){const _0x4e523c=_0x97b7c0;getClientsWithBotID(_0x376ea7)[_0x4e523c(0x19d)](_0x319dba=>{getSocket(_0x319dba['id'])['disconnect'](!![]),removeClient(_0x319dba['id']);}),pid[_0x376ea7]&&(pid[_0x376ea7]['kill'](),pid[_0x376ea7]=null);}function stopAllBots(){const _0x5c00c1=_0x97b7c0;terminating=!![];const _0x458906=getEnabledBots();_0x458906[_0x5c00c1(0x19d)](_0x1f32ff=>{const _0x5973a3=_0x5c00c1;stopBot(_0x1f32ff[_0x5973a3(0x333)]);});}function restartBot(_0x44c240){const _0x385747=_0x97b7c0;if(pid[_0x44c240])pid[_0x44c240][_0x385747(0x2a0)]();}function addBot(){const _0x28d776=_0x97b7c0;let _0x455766;for(let _0xc05ff0=0x1;_0xc05ff0<0x3e9;_0xc05ff0++){_0x455766=_0xc05ff0['toString']()[_0x28d776(0x396)](0x3,'0');let _0x345ba2=config[_0x28d776(0x298)](_0x352dcd=>_0x352dcd[_0x28d776(0x333)]==_0x455766);if(!_0x345ba2)break;}if(_0x455766===_0x28d776(0x249)){logger[_0x28d776(0x2d0)](_0x28d776(0x211));return;}logger['full']('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x455766),dbConfig[_0x28d776(0x318)](_0x28d776(0x32c))[_0x28d776(0x39e)]({'botID':_0x455766,'botname':_0x28d776(0x1f6)+_0x455766,'status':_0x28d776(0x395),'live':''})[_0x28d776(0x2c0)](),startBot([_0x455766,userID],{'cwd':bbpath},function(_0x53368f){const _0x2c5b80=_0x28d776;if(_0x53368f)logger[_0x2c5b80(0x2d0)](_0x53368f);}),config=getConfiguration(),io['to'](_0x28d776(0x38d))[_0x28d776(0x20e)](_0x28d776(0x32c),config),broadcastToBots(_0x28d776(0x32c),JSON[_0x28d776(0x1cd)](config));}function deleteBot(_0x58eda2){const _0x42ef15=_0x97b7c0;getClientsWithBotID(_0x58eda2)[_0x42ef15(0x19d)](_0x2b568d=>{const _0x1028c2=_0x42ef15;getSocket(_0x2b568d['id'])[_0x1028c2(0x30c)](!![]),removeClient(_0x2b568d['id']);}),dbConfig[_0x42ef15(0x318)](_0x42ef15(0x32c))[_0x42ef15(0x31a)]({'botID':_0x58eda2})[_0x42ef15(0x2c0)](),logger[_0x42ef15(0x2d0)](_0x42ef15(0x223)+_0x58eda2),stopBot(_0x58eda2);try{if(fs['existsSync'](path['join'](configpath,_0x42ef15(0x1ed)+_0x58eda2+_0x42ef15(0x27a))))fs[_0x42ef15(0x2ef)](path[_0x42ef15(0x39b)](configpath,_0x42ef15(0x1ed)+_0x58eda2+'-config.json'));if(fs[_0x42ef15(0x1cf)](path['join'](configpath,_0x42ef15(0x1ed)+_0x58eda2+'-events.json')))fs[_0x42ef15(0x2ef)](path[_0x42ef15(0x39b)](configpath,_0x42ef15(0x1ed)+_0x58eda2+_0x42ef15(0x1b6)));if(fs[_0x42ef15(0x1cf)](path[_0x42ef15(0x39b)](configpath,_0x42ef15(0x1ed)+_0x58eda2+_0x42ef15(0x38f))))fs[_0x42ef15(0x2ef)](path[_0x42ef15(0x39b)](configpath,_0x42ef15(0x1ed)+_0x58eda2+_0x42ef15(0x38f)));if(fs[_0x42ef15(0x1cf)](path['join'](configpath,'bot-'+_0x58eda2+_0x42ef15(0x285))))fs[_0x42ef15(0x2ef)](path[_0x42ef15(0x39b)](configpath,_0x42ef15(0x1ed)+_0x58eda2+_0x42ef15(0x285)));}catch(_0x4f910b){if(_0x4f910b)logger['full'](_0x42ef15(0x218),_0x4f910b);}config=getConfiguration(),io['to'](_0x42ef15(0x38d))[_0x42ef15(0x20e)](_0x42ef15(0x32c),config),broadcastToBots(_0x42ef15(0x32c),JSON['stringify'](config));}function toggleBot(_0x2c1568,_0x208ba0,_0x126db2){const _0x1b069b=_0x97b7c0;dbConfig[_0x1b069b(0x318)](_0x1b069b(0x32c))[_0x1b069b(0x298)]({'botID':_0x2c1568})['assign']({'status':_0x208ba0})['assign']({'live':_0x126db2})[_0x1b069b(0x2c0)]();const _0x5c0124=botRef(_0x2c1568);if(_0x208ba0=='enabled'||_0x208ba0==_0x1b069b(0x395))logger[_0x1b069b(0x2d0)](_0x1b069b(0x306)+_0x5c0124),startBot([_0x2c1568,userID],{'cwd':bbpath},function(_0x2260ae){const _0x2fe682=_0x1b069b;if(_0x2260ae)logger[_0x2fe682(0x2d0)](_0x2260ae);});else(_0x208ba0==_0x1b069b(0x244)||_0x208ba0==_0x1b069b(0x20b))&&(logger[_0x1b069b(0x2d0)](_0x1b069b(0x23f)+_0x5c0124),stopBot(_0x2c1568));config=getConfiguration(),io['to']('botmanager')[_0x1b069b(0x20e)](_0x1b069b(0x32c),config),broadcastToBots(_0x1b069b(0x32c),JSON[_0x1b069b(0x1cd)](config));}function toggleStatus(_0x4ecb1e){const _0x1f5a40=_0x97b7c0;let _0x1a42be=dbConfig[_0x1f5a40(0x318)](_0x1f5a40(0x32c))['find']({'botID':_0x4ecb1e})[_0x1f5a40(0x33e)](),_0x3b8a26;if(_0x1a42be[_0x1f5a40(0x2a2)]==='enabled')_0x3b8a26=_0x1f5a40(0x244);else{if(_0x1a42be[_0x1f5a40(0x2a2)]===_0x1f5a40(0x395))_0x3b8a26=_0x1f5a40(0x20b);else{if(_0x1a42be[_0x1f5a40(0x2a2)]==='new-disabled')_0x3b8a26=_0x1f5a40(0x395);else{if(_0x1a42be[_0x1f5a40(0x2a2)]==='disabled')_0x3b8a26=_0x1f5a40(0x196);}}}return _0x3b8a26;}function updateStatus(_0x30275c,_0x4192b8){const _0x3de3ae=_0x97b7c0;dbConfig[_0x3de3ae(0x318)](_0x3de3ae(0x32c))[_0x3de3ae(0x298)]({'botID':_0x30275c})[_0x3de3ae(0x2cd)]({'status':_0x4192b8})[_0x3de3ae(0x2c0)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x3de3ae(0x32c),config),broadcastToBots(_0x3de3ae(0x32c),JSON[_0x3de3ae(0x1cd)](config));}function updateLive(_0x450e4a,_0x9ac883){const _0x2f02c6=_0x97b7c0;dbConfig[_0x2f02c6(0x318)]('bots')[_0x2f02c6(0x298)]({'botID':_0x450e4a})[_0x2f02c6(0x2cd)]({'live':_0x9ac883})['write'](),config=getConfiguration(),io['to'](_0x2f02c6(0x38d))[_0x2f02c6(0x20e)](_0x2f02c6(0x32c),config),broadcastToBots('bots',JSON[_0x2f02c6(0x1cd)](config));}function updateBotName(_0x4a0818,_0x23bb7d){const _0x2fe13e=_0x97b7c0;dbConfig['get']('bots')[_0x2fe13e(0x298)]({'botID':_0x4a0818})[_0x2fe13e(0x2cd)]({'botname':_0x23bb7d})[_0x2fe13e(0x2c0)](),config=getConfiguration(),io['to'](_0x2fe13e(0x38d))[_0x2fe13e(0x20e)](_0x2fe13e(0x32c),config),broadcastToBots(_0x2fe13e(0x32c),JSON['stringify'](config));}function updateBotManager(){const _0x461815=_0x97b7c0;config=getConfiguration(),io['to'](_0x461815(0x38d))[_0x461815(0x20e)]('bots',config),broadcastToBots('bots',JSON[_0x461815(0x1cd)](config));}function toggleBotMode(_0x1a90d7){const _0x3c2714=_0x97b7c0;if(pid[_0x1a90d7])pid[_0x1a90d7]['send']({'function':_0x3c2714(0x1e5),'args':null});else{const _0xa28e6=configpath+_0x3c2714(0x1ed)+_0x1a90d7+_0x3c2714(0x27a),_0x85223e=fs[_0x3c2714(0x2be)](_0xa28e6),_0x40ef0c=JSON[_0x3c2714(0x22c)](_0x85223e),_0x35b7fd=_0x40ef0c['bot'][0x0]['headless'];_0x40ef0c[_0x3c2714(0x348)][0x0][_0x3c2714(0x2ed)]=!_0x35b7fd;const _0x2a77ea=JSON[_0x3c2714(0x1cd)](_0x40ef0c,null,0x2);fs['writeFileSync'](_0xa28e6,_0x2a77ea),config=getConfiguration(),io['to'](_0x3c2714(0x38d))[_0x3c2714(0x20e)]('bots',config),broadcastToBots(_0x3c2714(0x32c),JSON[_0x3c2714(0x1cd)](config));}}function validateTelegram(_0x45e3a7){const _0x1298dc=_0x97b7c0;if(_0x45e3a7[_0x1298dc(0x1e6)][_0x1298dc(0x19c)]!=settings[_0x1298dc(0x2b8)]&&'@'+_0x45e3a7['from'][_0x1298dc(0x19c)]!=settings['telegramUsername']||_0x45e3a7['chat']['id']!=settings['telegramChatId'])return sendTelegram(_0x45e3a7['chat']['id'],_0x1298dc(0x30a),{'parse_mode':_0x1298dc(0x39c)}),![];return!![];}function botRef(_0x21c20f){const _0x2a8650=_0x97b7c0,_0x3f9d35=getBotAttributes(_0x21c20f),_0x3e5917=_0x3f9d35['showname']?_0x3f9d35[_0x2a8650(0x246)]:_0x2a8650(0x1f6)+_0x21c20f;return _0x3e5917;}async function initTelegram(){const _0x13ab47=_0x97b7c0;tgBot&&(await tgBot[_0x13ab47(0x342)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x13ab47(0x365)]);let _0x4343ba=_0x13ab47(0x23e);_0x4343ba+='\x0a',_0x4343ba+=_0x13ab47(0x1a2),_0x4343ba+=_0x13ab47(0x384),_0x4343ba+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x4343ba+=_0x13ab47(0x351),_0x4343ba+=_0x13ab47(0x37b),_0x4343ba+=_0x13ab47(0x32d),_0x4343ba+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x4343ba+='/names\x20-\x20show\x20bot\x20names\x0a',_0x4343ba+=_0x13ab47(0x283),_0x4343ba+=_0x13ab47(0x242),_0x4343ba+=_0x13ab47(0x189),_0x4343ba+=_0x13ab47(0x2a6),_0x4343ba+=_0x13ab47(0x1f4),_0x4343ba+=_0x13ab47(0x248),_0x4343ba+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x4343ba+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x2a0a85=_0x13ab47(0x3a6);_0x2a0a85+='\x0a',_0x2a0a85+=_0x4343ba,tgBot[_0x13ab47(0x1fa)]((_0x4f50ac,_0x17d367)=>{const _0xbea2d3=_0x13ab47;logger[_0xbea2d3(0x1a0)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0xbea2d3(0x35e)](_0xbea2d3(0x360),_0x4f50ac);}),tgBot[_0x13ab47(0x26e)](async(_0x2077ef,_0xcf809f)=>{const _0x2fb6be=_0x13ab47;if(settings[_0x2fb6be(0x208)]||_0x2077ef[_0x2fb6be(0x21e)]['message']['text']!=_0x2fb6be(0x2d7)){if(!validateTelegram(_0x2077ef))return;}_0xcf809f();}),tgBot[_0x13ab47(0x1f9)]('start',async _0x353171=>{const _0x435a3b=_0x13ab47;if(_0x353171[_0x435a3b(0x1e6)][_0x435a3b(0x19c)]==settings[_0x435a3b(0x2b8)]||'@'+_0x353171[_0x435a3b(0x1e6)][_0x435a3b(0x19c)]==settings[_0x435a3b(0x2b8)]){if(!settings['telegramChatId'])updateSetting('telegramChatId',_0x353171[_0x435a3b(0x224)]['id']);else{if(!validateTelegram(_0x353171))return;}}else{if(!validateTelegram(_0x353171))return;}updateSetting(_0x435a3b(0x2dc),!![]),await sendTelegram(_0x353171[_0x435a3b(0x224)]['id'],_0x2a0a85);}),tgBot[_0x13ab47(0x1f9)](_0x13ab47(0x19e),async _0x34b651=>{const _0x4f89f0=_0x13ab47;updateSetting(_0x4f89f0(0x2dc),!![]),await sendTelegram(_0x34b651[_0x4f89f0(0x224)]['id'],_0x4f89f0(0x230));}),tgBot[_0x13ab47(0x1f9)](_0x13ab47(0x1ef),async _0x45217e=>{const _0x3a7e0d=_0x13ab47;await sendTelegram(_0x45217e['chat']['id'],_0x3a7e0d(0x1ae)),updateSetting(_0x3a7e0d(0x2dc),![]);}),tgBot[_0x13ab47(0x1f9)](_0x13ab47(0x21b),async _0x20c521=>{const _0x4a6cda=_0x13ab47,_0x21b41d=Markup[_0x4a6cda(0x2ce)]([Markup['button'][_0x4a6cda(0x316)]('Orders',_0x4a6cda(0x2af)),Markup[_0x4a6cda(0x34e)][_0x4a6cda(0x316)]('Alerts',_0x4a6cda(0x1ff)),Markup[_0x4a6cda(0x34e)][_0x4a6cda(0x316)](_0x4a6cda(0x2d9),_0x4a6cda(0x1c7))]);_0x20c521['reply'](_0x4a6cda(0x1e2),_0x21b41d);}),tgBot['action'](_0x13ab47(0x2af),async _0x389b87=>{const _0x4b8a0f=_0x13ab47;_0x389b87[_0x4b8a0f(0x2ea)](),updateSetting(_0x4b8a0f(0x27b),'orders'),updateSetting(_0x4b8a0f(0x2dc),!![]),await sendTelegram(_0x389b87['chat']['id'],_0x4b8a0f(0x392));}),tgBot[_0x13ab47(0x24d)](_0x13ab47(0x1ff),async _0x32fbf0=>{const _0x2fbe2e=_0x13ab47;_0x32fbf0[_0x2fbe2e(0x2ea)](),updateSetting(_0x2fbe2e(0x27b),_0x2fbe2e(0x33b)),updateSetting(_0x2fbe2e(0x2dc),!![]),await sendTelegram(_0x32fbf0[_0x2fbe2e(0x224)]['id'],_0x2fbe2e(0x250));}),tgBot[_0x13ab47(0x24d)](_0x13ab47(0x1c7),async _0xca4b9d=>{const _0xf6884d=_0x13ab47;_0xca4b9d[_0xf6884d(0x2ea)](),updateSetting(_0xf6884d(0x27b),_0xf6884d(0x20f)),updateSetting(_0xf6884d(0x2dc),!![]),await sendTelegram(_0xca4b9d['chat']['id'],_0xf6884d(0x191));}),tgBot['command'](_0x13ab47(0x2a2),async _0x3b81be=>{const _0x1fa49b=_0x13ab47,_0x43da6a=getBotsWithMode();let _0x4df055=_0x1fa49b(0x37d);config[_0x1fa49b(0x19d)](_0x35b0d7=>{const _0x116696=_0x1fa49b,_0x5d10d6=_0x43da6a[_0x116696(0x298)](_0x4c916f=>_0x4c916f['botID']==_0x35b0d7[_0x116696(0x333)])[_0x116696(0x2f7)];_0x4df055+=_0x116696(0x1f6)+_0x35b0d7[_0x116696(0x333)]+':\x20'+_0x35b0d7[_0x116696(0x2a2)]+_0x116696(0x2a8)+_0x5d10d6+_0x116696(0x2a8)+_0x35b0d7['live']+'\x0a';}),_0x4df055+='\x0a',_0x4df055+=_0x1fa49b(0x3a4),_0x4df055+=!settings['telegramEnabled']?_0x1fa49b(0x22d):_0x1fa49b(0x34c),_0x4df055+=settings['telegramEnabled']?settings[_0x1fa49b(0x27b)]==_0x1fa49b(0x20f)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings['telegramEvents']+'\x20only\x0a':'',await sendTelegram(_0x3b81be[_0x1fa49b(0x224)]['id'],_0x4df055,{'parse_mode':_0x1fa49b(0x39c)});}),tgBot[_0x13ab47(0x1f9)](_0x13ab47(0x2d6),async _0x4cf583=>{const _0x50b2e2=_0x13ab47,_0x4e0fec=getEnabledBots();if(_0x4e0fec[_0x50b2e2(0x38c)]==0x0)await sendTelegram(_0x4cf583['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x4e0fec['length']>0x1)_0x4e0fec[_0x50b2e2(0x39e)]({'botID':_0x50b2e2(0x20f)});let _0x14bdd7=[],_0x33b103=[];const _0x31059c=_0x4e0fec[_0x50b2e2(0x38c)]%0x4==0x0||_0x4e0fec['length']%0x4==0x3||_0x4e0fec[_0x50b2e2(0x38c)]%0x3==0x1?0x4:0x3;let _0x48dc66=0x0;_0x4e0fec[_0x50b2e2(0x19d)]((_0x4a72a8,_0xa82847)=>{const _0x1c06ab=_0x50b2e2;if(_0xa82847%_0x31059c==0x0)_0x33b103=[];_0x33b103[_0x1c06ab(0x39e)](Markup['button'][_0x1c06ab(0x316)](_0x4a72a8[_0x1c06ab(0x333)]==_0x1c06ab(0x20f)?_0x1c06ab(0x1d6):botRef(_0x4a72a8[_0x1c06ab(0x333)]),_0x1c06ab(0x219)+_0x4a72a8[_0x1c06ab(0x333)])),_0xa82847%_0x31059c==0x0&&(_0x14bdd7[_0x48dc66]=_0x33b103,_0x48dc66++);});const _0x5b9a42=Markup[_0x50b2e2(0x2ce)](_0x14bdd7);_0x4cf583[_0x50b2e2(0x375)](_0x50b2e2(0x1ec),_0x5b9a42);}}),tgBot[_0x13ab47(0x24d)](/restart_(.+)/,async _0x574889=>{const _0x4410c6=_0x13ab47,_0x20c71e=_0x574889[_0x4410c6(0x200)][0x1];_0x574889['editMessageReplyMarkup'](),_0x20c71e=='all'?config[_0x4410c6(0x19d)](_0x184162=>{restartBot(_0x184162['botID']);}):restartBot(_0x20c71e);}),tgBot['command']('on',async _0x2323de=>{const _0x36858b=_0x13ab47,_0x195186=getDisabledBots();if(_0x195186[_0x36858b(0x38c)]==0x0)await sendTelegram(_0x2323de[_0x36858b(0x224)]['id'],_0x36858b(0x379));else{if(_0x195186['length']>0x1)_0x195186['push']({'botID':'all'});let _0x5a6648=[],_0x5ba61e=[];const _0x34cda6=_0x195186['length']%0x4==0x0||_0x195186[_0x36858b(0x38c)]%0x4==0x3||_0x195186[_0x36858b(0x38c)]%0x3==0x1?0x4:0x3;let _0x23678a=0x0;_0x195186[_0x36858b(0x19d)]((_0x1a8b9c,_0x5a6e26)=>{const _0x323911=_0x36858b;if(_0x5a6e26%_0x34cda6==0x0)_0x5ba61e=[];_0x5ba61e['push'](Markup[_0x323911(0x34e)][_0x323911(0x316)](_0x1a8b9c[_0x323911(0x333)]==_0x323911(0x20f)?_0x323911(0x1d6):botRef(_0x1a8b9c[_0x323911(0x333)]),_0x323911(0x357)+_0x1a8b9c['botID'])),_0x5a6e26%_0x34cda6==0x0&&(_0x5a6648[_0x23678a]=_0x5ba61e,_0x23678a++);});const _0x385985=Markup[_0x36858b(0x2ce)](_0x5a6648);_0x2323de[_0x36858b(0x375)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x385985);}}),tgBot[_0x13ab47(0x24d)](/on_(.+)/,async _0x1251ec=>{const _0x36dfba=_0x13ab47,_0x5cbaf6=_0x1251ec[_0x36dfba(0x200)][0x1];_0x1251ec[_0x36dfba(0x2ea)]();if(_0x5cbaf6==_0x36dfba(0x20f)){const _0x58c86d=getDisabledBots();await sendTelegram(_0x1251ec['chat']['id'],_0x36dfba(0x1d9)),_0x58c86d[_0x36dfba(0x19d)](_0x459471=>{const _0x299f41=_0x36dfba;if(_0x459471[_0x299f41(0x333)]!=_0x299f41(0x20f))toggleBot(_0x459471[_0x299f41(0x333)],toggleStatus(_0x459471[_0x299f41(0x333)]),_0x299f41(0x1fc));});}else await sendTelegram(_0x1251ec[_0x36dfba(0x224)]['id'],'Bot\x20Mgr\x20>\x20Starting\x20'+botRef(_0x5cbaf6)),toggleBot(_0x5cbaf6,toggleStatus(_0x5cbaf6),_0x36dfba(0x1fc));}),tgBot['command'](_0x13ab47(0x1a6),async _0x1efa99=>{const _0x54800e=_0x13ab47,_0x2e733a=getEnabledBots();if(_0x2e733a['length']==0x0)await sendTelegram(_0x1efa99['chat']['id'],_0x54800e(0x2c4));else{if(_0x2e733a[_0x54800e(0x38c)]>0x1)_0x2e733a[_0x54800e(0x39e)]({'botID':_0x54800e(0x20f)});let _0x641596=[],_0x1b1206=[];const _0x154f43=_0x2e733a[_0x54800e(0x38c)]%0x4==0x0||_0x2e733a[_0x54800e(0x38c)]%0x4==0x3||_0x2e733a[_0x54800e(0x38c)]%0x3==0x1?0x4:0x3;let _0x64a758=0x0;_0x2e733a[_0x54800e(0x19d)]((_0x504214,_0x109671)=>{const _0x4961bb=_0x54800e;if(_0x109671%_0x154f43==0x0)_0x1b1206=[];_0x1b1206[_0x4961bb(0x39e)](Markup['button'][_0x4961bb(0x316)](_0x504214[_0x4961bb(0x333)]==_0x4961bb(0x20f)?_0x4961bb(0x1d6):botRef(_0x504214[_0x4961bb(0x333)]),_0x4961bb(0x1dc)+_0x504214[_0x4961bb(0x333)])),_0x109671%_0x154f43==0x0&&(_0x641596[_0x64a758]=_0x1b1206,_0x64a758++);});const _0x145664=Markup[_0x54800e(0x2ce)](_0x641596);_0x1efa99[_0x54800e(0x375)](_0x54800e(0x272),_0x145664);}}),tgBot['action'](/off_(.+)/,async _0x1f45dd=>{const _0x9860aa=_0x13ab47,_0x5624ad=_0x1f45dd[_0x9860aa(0x200)][0x1];_0x1f45dd[_0x9860aa(0x2ea)]();if(_0x5624ad==_0x9860aa(0x20f)){const _0x15275d=getEnabledBots();await sendTelegram(_0x1f45dd[_0x9860aa(0x224)]['id'],_0x9860aa(0x2c6)),_0x15275d['forEach'](_0x20c0a0=>{const _0x3f5947=_0x9860aa;if(_0x20c0a0['botID']!=_0x3f5947(0x20f))toggleBot(_0x20c0a0[_0x3f5947(0x333)],toggleStatus(_0x20c0a0[_0x3f5947(0x333)]),_0x3f5947(0x1fc));});}else await sendTelegram(_0x1f45dd[_0x9860aa(0x224)]['id'],_0x9860aa(0x1ce)+botRef(_0x5624ad)),toggleBot(_0x5624ad,toggleStatus(_0x5624ad),_0x9860aa(0x1fc));}),tgBot['command'](_0x13ab47(0x2fd),async _0x2dadfd=>{const _0x141056=_0x13ab47,_0x22910a=getEnabledBots();if(_0x22910a[_0x141056(0x38c)]==0x0)await sendTelegram(_0x2dadfd[_0x141056(0x224)]['id'],_0x141056(0x2c4));else{if(_0x22910a[_0x141056(0x38c)]>0x1){let _0xe767cf=[],_0x447f24=[];const _0xd7fea5=_0x22910a['length']%0x4==0x0||_0x22910a[_0x141056(0x38c)]%0x4==0x3||_0x22910a[_0x141056(0x38c)]%0x3==0x1?0x4:0x3;let _0x10ce4c=0x0;_0x22910a[_0x141056(0x19d)]((_0x32306f,_0x440282)=>{const _0x21d1a5=_0x141056;if(_0x440282%_0xd7fea5==0x0)_0x447f24=[];_0x447f24[_0x21d1a5(0x39e)](Markup['button'][_0x21d1a5(0x316)](botRef(_0x32306f['botID']),'metrics_'+_0x32306f[_0x21d1a5(0x333)])),_0x440282%_0xd7fea5==0x0&&(_0xe767cf[_0x10ce4c]=_0x447f24,_0x10ce4c++);});const _0xab17f5=Markup[_0x141056(0x2ce)](_0xe767cf);_0x2dadfd[_0x141056(0x375)](_0x141056(0x23b),_0xab17f5);}else{const _0x38f1c6=_0x22910a[0x0][_0x141056(0x333)];if(pid[_0x38f1c6])pid[_0x38f1c6][_0x141056(0x25f)]({'function':_0x141056(0x2f5),'args':null});}}}),tgBot[_0x13ab47(0x24d)](/metrics_(.+)/,async _0x101384=>{const _0x2a856a=_0x13ab47,_0x493d5d=_0x101384[_0x2a856a(0x200)][0x1];_0x101384[_0x2a856a(0x2ea)]();if(pid[_0x493d5d])pid[_0x493d5d][_0x2a856a(0x25f)]({'function':_0x2a856a(0x2f5),'args':null});}),tgBot[_0x13ab47(0x1f9)](_0x13ab47(0x264),async _0x515dd5=>{const _0x2f0003=_0x13ab47,_0x55e34a=getEnabledBots();if(_0x55e34a[_0x2f0003(0x38c)]==0x0)await sendTelegram(_0x515dd5['chat']['id'],_0x2f0003(0x2c4));else{if(_0x55e34a[_0x2f0003(0x38c)]>0x1){let _0x482a83=[],_0x4dba57=[];const _0x31e320=_0x55e34a[_0x2f0003(0x38c)]%0x4==0x0||_0x55e34a['length']%0x4==0x3||_0x55e34a['length']%0x3==0x1?0x4:0x3;let _0x174609=0x0;_0x55e34a[_0x2f0003(0x19d)]((_0x446531,_0x564903)=>{const _0xd288d6=_0x2f0003;if(_0x564903%_0x31e320==0x0)_0x4dba57=[];_0x4dba57[_0xd288d6(0x39e)](Markup['button'][_0xd288d6(0x316)](botRef(_0x446531[_0xd288d6(0x333)]),_0xd288d6(0x282)+_0x446531[_0xd288d6(0x333)])),_0x564903%_0x31e320==0x0&&(_0x482a83[_0x174609]=_0x4dba57,_0x174609++);});const _0x35e8ff=Markup[_0x2f0003(0x2ce)](_0x482a83);_0x515dd5[_0x2f0003(0x375)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x35e8ff);}else{const _0x2302e9=_0x55e34a[0x0][_0x2f0003(0x333)];if(pid[_0x2302e9])pid[_0x2302e9][_0x2f0003(0x25f)]({'function':_0x2f0003(0x2b4),'args':null});}}}),tgBot[_0x13ab47(0x24d)](/portfolio_(.+)/,async _0x4db32a=>{const _0x200001=_0x13ab47,_0x2ee5ea=_0x4db32a[_0x200001(0x200)][0x1];_0x4db32a['editMessageReplyMarkup']();if(pid[_0x2ee5ea])pid[_0x2ee5ea][_0x200001(0x25f)]({'function':_0x200001(0x2b4),'args':null});}),tgBot[_0x13ab47(0x1f9)](_0x13ab47(0x21c),async _0x3992c7=>{const _0xb7effc=_0x13ab47,_0x1f7e68=_0xb7effc(0x21c);await zipFiles(_0x1f7e68);const _0x240fb1=zippath+(_0x1f7e68+'.zip');_0x3992c7['replyWithDocument']({'source':_0x240fb1})[_0xb7effc(0x2f8)](()=>{})[_0xb7effc(0x1fa)](_0x3b3729=>logger[_0xb7effc(0x35e)](_0xb7effc(0x25b)+_0x1f7e68+_0xb7effc(0x1ab),_0x3b3729));}),tgBot[_0x13ab47(0x1f9)](_0x13ab47(0x295),async _0x550bd1=>{const _0x3f3691=_0x13ab47,_0x66209d=_0x3f3691(0x295);await backupConfigFiles(),await zipFiles(_0x66209d);const _0x5e712e=zippath+(_0x66209d+_0x3f3691(0x2c2));_0x550bd1[_0x3f3691(0x2f9)]({'source':_0x5e712e})[_0x3f3691(0x2f8)](()=>{})['catch'](_0x4a9ff1=>logger[_0x3f3691(0x35e)](_0x3f3691(0x25b)+_0x66209d+_0x3f3691(0x1ab),_0x4a9ff1));}),tgBot[_0x13ab47(0x1f9)](_0x13ab47(0x21e),async _0x3684ea=>{const _0x3760bd=_0x13ab47;await getMessages();if(!updateAvailable)await sendTelegram(_0x3684ea[_0x3760bd(0x224)]['id'],_0x3760bd(0x26c));else{if(!validInstallation)await sendTelegram(_0x3684ea[_0x3760bd(0x224)]['id'],_0x3760bd(0x30e));else{const _0x4645fc=Markup[_0x3760bd(0x2ce)]([Markup['button'][_0x3760bd(0x316)](_0x3760bd(0x3a3),'update_yes'),Markup[_0x3760bd(0x34e)][_0x3760bd(0x316)]('No',_0x3760bd(0x382))]);_0x3684ea[_0x3760bd(0x375)](_0x3760bd(0x37f),_0x4645fc);}}}),tgBot[_0x13ab47(0x24d)](/update_(.+)/,async _0x2926d1=>{const _0x558600=_0x13ab47,_0x172dfe=_0x2926d1[_0x558600(0x200)][0x1];_0x2926d1[_0x558600(0x2ea)](),_0x172dfe==_0x558600(0x20c)&&(await sendTelegram(_0x2926d1[_0x558600(0x224)]['id'],_0x558600(0x256)),updateBB(_0x558600(0x21e))),_0x172dfe=='no'&&await sendTelegram(_0x2926d1[_0x558600(0x224)]['id'],_0x558600(0x362));}),tgBot['command'](_0x13ab47(0x29f),async _0x487fb9=>{const _0x22c23c=_0x13ab47;if(!validInstallation)await sendTelegram(_0x487fb9[_0x22c23c(0x224)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x5b4f5d=Markup[_0x22c23c(0x2ce)]([Markup[_0x22c23c(0x34e)]['callback']('Yes',_0x22c23c(0x366)),Markup[_0x22c23c(0x34e)][_0x22c23c(0x316)]('No',_0x22c23c(0x2ca))]);_0x487fb9[_0x22c23c(0x375)](_0x22c23c(0x24a),_0x5b4f5d);}}),tgBot[_0x13ab47(0x24d)](/reinstall_(.+)/,async _0x52fcca=>{const _0x1ffcca=_0x13ab47,_0x366b2b=_0x52fcca[_0x1ffcca(0x200)][0x1];_0x52fcca[_0x1ffcca(0x2ea)](),_0x366b2b==_0x1ffcca(0x20c)&&(await sendTelegram(_0x52fcca[_0x1ffcca(0x224)]['id'],_0x1ffcca(0x370)),updateBB(_0x1ffcca(0x29f))),_0x366b2b=='no'&&await sendTelegram(_0x52fcca[_0x1ffcca(0x224)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x13ab47(0x1f9)]('toggle',async _0x48084c=>{const _0x3bd547=_0x13ab47,_0x457683=getBotsWithMode();if(_0x457683['length']==0x0)await sendTelegram(_0x48084c[_0x3bd547(0x224)]['id'],_0x3bd547(0x2c4));else{let _0x587a39=[],_0x5cdd26=[];const _0x40312a=0x2;let _0x28d3e5=0x0;_0x457683['forEach']((_0xda029a,_0x32d098)=>{const _0x586806=_0x3bd547;if(_0x32d098%_0x40312a==0x0)_0x5cdd26=[];_0x5cdd26[_0x586806(0x39e)](Markup['button'][_0x586806(0x316)](botRef(_0xda029a[_0x586806(0x333)])+'\x20('+_0xda029a[_0x586806(0x2f7)]+')',_0x586806(0x198)+_0xda029a[_0x586806(0x333)])),_0x32d098%_0x40312a==0x0&&(_0x587a39[_0x28d3e5]=_0x5cdd26,_0x28d3e5++);});const _0x372daf=Markup['inlineKeyboard'](_0x587a39);_0x48084c[_0x3bd547(0x375)](_0x3bd547(0x354),_0x372daf);}}),tgBot[_0x13ab47(0x24d)](/toggle_(.+)/,async _0x29c221=>{const _0x12cf3f=_0x13ab47,_0x5bec45=_0x29c221['match'][0x1];_0x29c221[_0x12cf3f(0x2ea)]();const _0x57eeb6=getBotsWithMode(),_0x487a00=_0x57eeb6[_0x12cf3f(0x298)](_0x1ad5b0=>_0x1ad5b0[_0x12cf3f(0x333)]==_0x5bec45),_0x5c7866=_0x487a00[_0x12cf3f(0x2f7)]==_0x12cf3f(0x1db)?_0x12cf3f(0x284):'auto';await sendTelegram(_0x29c221['chat']['id'],'Bot\x20Mgr\x20>\x20Toggling\x20'+botRef(_0x487a00[_0x12cf3f(0x333)])+_0x12cf3f(0x372)+_0x5c7866+_0x12cf3f(0x24c)),toggleBotMode(_0x5bec45);}),tgBot[_0x13ab47(0x1f9)](_0x13ab47(0x2fe),async _0x4c901e=>{const _0x137504=_0x13ab47;let _0x1e607e='';config[_0x137504(0x19d)](_0x5a5284=>{const _0x3f8eb3=_0x137504;_0x1e607e+=_0x3f8eb3(0x1f6)+_0x5a5284[_0x3f8eb3(0x333)]+':\x20'+_0x5a5284[_0x3f8eb3(0x246)]+'\x0a';}),await sendTelegram(_0x4c901e[_0x137504(0x224)]['id'],_0x1e607e,{'parse_mode':_0x137504(0x39c)});}),tgBot['command'](_0x13ab47(0x290),async _0x18c580=>{await sendTelegram(_0x18c580['chat']['id'],_0x4343ba);}),process[_0x13ab47(0x25a)](_0x13ab47(0x228),()=>tgBot[_0x13ab47(0x342)](_0x13ab47(0x228))),process[_0x13ab47(0x25a)](_0x13ab47(0x389),()=>tgBot[_0x13ab47(0x342)](_0x13ab47(0x389))),tgBot[_0x13ab47(0x1de)]();}function disableTelegram(){const _0x4be2ae=_0x97b7c0;tgBot&&tgBot[_0x4be2ae(0x342)]();}async function sendTelegram(_0x3e5372,_0x5015a8,_0x229849){const _0x843e41=_0x97b7c0;_0x229849={..._0x229849,'disable_web_page_preview':!![]};try{await tgBot[_0x843e41(0x193)][_0x843e41(0x353)](_0x3e5372,_0x5015a8,_0x229849);}catch(_0x143313){logger[_0x843e41(0x35e)](_0x843e41(0x2f0),_0x143313);}}async function sendTelegramBot(_0x392490,_0x252716){const _0x5375dd=_0x97b7c0;if(settings[_0x5375dd(0x2dc)]){if(settings[_0x5375dd(0x27b)]==_0x5375dd(0x20f)||(_0x252716[_0x5375dd(0x2e6)]==_0x5375dd(0x239)||_0x252716[_0x5375dd(0x2e6)]==_0x5375dd(0x26f)||_0x252716[_0x5375dd(0x2e6)]==_0x5375dd(0x313))&&settings['telegramEvents']==_0x5375dd(0x33b)||_0x252716[_0x5375dd(0x2e6)]==_0x5375dd(0x388)&&settings[_0x5375dd(0x27b)]==_0x5375dd(0x2a3)){if(tgBot&&settings[_0x5375dd(0x208)]){if(_0x252716[_0x5375dd(0x1c1)])await sendTelegram(settings[_0x5375dd(0x208)],_0x252716[_0x5375dd(0x246)]+_0x5375dd(0x1c2)+_0x252716[_0x5375dd(0x1e7)]);else await sendTelegram(settings['telegramChatId'],_0x5375dd(0x1f6)+_0x392490+_0x5375dd(0x1c2)+_0x252716['event']);}}}}async function sendTelegramMsg(_0x573888,_0x5a664c='HTML'){const _0x4e8e87=_0x97b7c0;return tgBot&&settings[_0x4e8e87(0x208)]?(await sendTelegram(settings[_0x4e8e87(0x208)],_0x573888,{'parse_mode':_0x5a664c}),!![]):![];}function getDeviceWithIp(_0x5985e6){const _0x1c817b=_0x97b7c0;return devices[_0x1c817b(0x298)](_0x5d083e=>_0x5d083e['ip']===_0x5985e6);}async function temporaryAccess2FA(_0x292533,_0x3272b2){const _0x2e2220=_0x97b7c0;let _0x2a1223=new Date(),_0xe06ea3=![];if(lastIpApproval){if(_0x2a1223-lastIpApproval<0x1388)_0xe06ea3=!![];}lastIpApproval=new Date();if(_0xe06ea3)return;if(tgBot&&settings[_0x2e2220(0x208)]){const _0x144340=uuidRandom();tmpStorage[_0x144340]={'uuid':_0x292533,'externalip':_0x3272b2};const _0x1c86b5=Markup['inlineKeyboard']([Markup[_0x2e2220(0x34e)][_0x2e2220(0x316)]('5\x20min','tempaccess_5_'+_0x144340),Markup[_0x2e2220(0x34e)][_0x2e2220(0x316)](_0x2e2220(0x1d8),_0x2e2220(0x2dd)+_0x144340),Markup[_0x2e2220(0x34e)][_0x2e2220(0x316)]('30\x20min',_0x2e2220(0x320)+_0x144340),Markup['button'][_0x2e2220(0x316)](_0x2e2220(0x341),_0x2e2220(0x1c5)+_0x144340)]);await sendTelegram(settings['telegramChatId'],_0x2e2220(0x2b2)+normalizeIP(_0x3272b2)[_0x2e2220(0x2e3)]+'\x20?',_0x1c86b5),tgBot[_0x2e2220(0x24d)](/tempaccess_(.+)_(.+)/,async _0x3d1ea1=>{const _0x56acd0=_0x2e2220,_0x38ca86=_0x3d1ea1[_0x56acd0(0x200)][0x1],_0x48cbc1=_0x3d1ea1['match'][0x2],{uuid:_0x58527f,externalip:_0x6bf0e1}=tmpStorage[_0x48cbc1];delete tmpStorage[_0x48cbc1],_0x3d1ea1[_0x56acd0(0x2ea)](),devices[_0x58527f]['telegramIpApproval']={'clientip':_0x6bf0e1,'timestamp':new Date()['getTime'](),'expiry':_0x38ca86},_0x38ca86!=_0x56acd0(0x341)?(await sendTelegram(_0x3d1ea1[_0x56acd0(0x224)]['id'],_0x56acd0(0x2ff)+_0x38ca86+'\x20minutes',{'parse_mode':'HTML'}),io['to'](_0x58527f)[_0x56acd0(0x20e)](_0x56acd0(0x2a2),{'access':{'allow':![],'reason':_0x56acd0(0x251),'token':null}})):(await sendTelegram(_0x3d1ea1[_0x56acd0(0x224)]['id'],_0x56acd0(0x356)),io['to'](_0x58527f)[_0x56acd0(0x20e)](_0x56acd0(0x2a2),{'access':{'allow':![],'reason':_0x56acd0(0x252),'token':null}}));});}}async function loginAccess2FA(_0x13a9e0,_0x38ec7c){const _0x6eb891=_0x97b7c0;if(tgBot&&settings[_0x6eb891(0x208)]){const _0x3ab8f9=uuidRandom();tmpStorage[_0x3ab8f9]={'uuid':_0x13a9e0,'externalip':_0x38ec7c};const _0x61a4ea=Markup[_0x6eb891(0x2ce)]([Markup[_0x6eb891(0x34e)][_0x6eb891(0x316)](_0x6eb891(0x274),'login2fa_'+loginExpiry+'_'+_0x3ab8f9),Markup[_0x6eb891(0x34e)]['callback'](_0x6eb891(0x341),_0x6eb891(0x2cf)+_0x3ab8f9)]);await sendTelegram(settings[_0x6eb891(0x208)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x38ec7c)[_0x6eb891(0x2e3)]+'\x20?',_0x61a4ea),tgBot[_0x6eb891(0x24d)](/login2fa_(.+)_(.+)/,async _0x57e982=>{const _0x23fa1d=_0x6eb891,_0x4e6ff7=_0x57e982[_0x23fa1d(0x200)][0x1],_0xd7dda=_0x57e982[_0x23fa1d(0x200)][0x2],{uuid:_0x5ab8cb,externalip:_0x66b67}=tmpStorage[_0xd7dda];delete tmpStorage[_0xd7dda],_0x57e982['editMessageReplyMarkup'](),devices[_0x5ab8cb][_0x23fa1d(0x3a5)]={'clientip':_0x66b67,'timestamp':new Date()[_0x23fa1d(0x300)](),'expiry':_0x4e6ff7},_0x4e6ff7!=_0x23fa1d(0x341)?(await sendTelegram(_0x57e982[_0x23fa1d(0x224)]['id'],_0x23fa1d(0x393),{'parse_mode':_0x23fa1d(0x39c)}),io['to'](_0x5ab8cb)[_0x23fa1d(0x20e)]('status',{'access':{'allow':![],'reason':_0x23fa1d(0x251),'token':null}})):(await sendTelegram(_0x57e982['chat']['id'],_0x23fa1d(0x3a2)),io['to'](_0x5ab8cb)[_0x23fa1d(0x20e)](_0x23fa1d(0x2a2),{'access':{'allow':![],'reason':_0x23fa1d(0x21f),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x328421=_0x97b7c0;return dbConfig[_0x328421(0x318)]('bots')[_0x328421(0x188)]('botID')[_0x328421(0x1eb)]({'status':_0x328421(0x196)})[_0x328421(0x33e)]()||[];}function getDisabledBots(){const _0x1c5c13=_0x97b7c0;return dbConfig[_0x1c5c13(0x318)]('bots')[_0x1c5c13(0x188)](_0x1c5c13(0x333))['filter']({'status':_0x1c5c13(0x244)})[_0x1c5c13(0x33e)]()||[];}function getBotAttributes(_0x43a5ad){const _0x30a80b=_0x97b7c0;let _0x3fd760={};const _0x5412ef=configpath+_0x30a80b(0x1ed)+_0x43a5ad+_0x30a80b(0x27a),_0x4887db=fs['existsSync'](_0x5412ef);if(_0x4887db){const _0x1d39ea=fs[_0x30a80b(0x2be)](_0x5412ef);try{const _0x35c5cf=JSON[_0x30a80b(0x22c)](_0x1d39ea),_0x66d7dc=_0x35c5cf?_0x35c5cf[_0x30a80b(0x348)][0x0][_0x30a80b(0x2ed)]:![];_0x3fd760['mode']=_0x66d7dc?_0x30a80b(0x1db):_0x30a80b(0x284),_0x3fd760[_0x30a80b(0x246)]=_0x35c5cf?_0x35c5cf[_0x30a80b(0x348)][0x0]['botname']:'Bot\x20'+_0x43a5ad,_0x3fd760[_0x30a80b(0x1c1)]=_0x35c5cf?_0x35c5cf[_0x30a80b(0x348)][0x0][_0x30a80b(0x1c1)]:![];}catch(_0x184c6c){_0x3fd760[_0x30a80b(0x2f7)]=_0x30a80b(0x284),_0x3fd760[_0x30a80b(0x246)]=_0x30a80b(0x1f6)+_0x43a5ad,_0x3fd760[_0x30a80b(0x1c1)]=![];}}else _0x3fd760[_0x30a80b(0x2f7)]='manual',_0x3fd760[_0x30a80b(0x246)]='Bot\x20'+_0x43a5ad,_0x3fd760[_0x30a80b(0x1c1)]=![];return _0x3fd760;}function getBotsWithMode(){const _0x54c23f=_0x97b7c0,_0x3d89d8=dbConfig[_0x54c23f(0x318)](_0x54c23f(0x32c))['sortBy']('botID')['value']()||[];return _0x3d89d8['forEach'](_0x30f179=>{const _0x46b729=_0x54c23f;let _0x6d90e1=getBotAttributes(_0x30f179['botID']);_0x30f179[_0x46b729(0x2f7)]=_0x6d90e1['mode'];}),_0x3d89d8;}function getBotExchanges(){const _0x58f5d7=_0x97b7c0;let _0x5ee41f=[];const _0x59c684=dbConfig[_0x58f5d7(0x318)](_0x58f5d7(0x32c))[_0x58f5d7(0x188)](_0x58f5d7(0x333))[_0x58f5d7(0x33e)]()||[];_0x59c684['forEach'](_0x347b71=>{const _0x39c28f=_0x58f5d7;if(_0x347b71[_0x39c28f(0x2a2)]==_0x39c28f(0x196)){const _0x4e9201=configpath+_0x39c28f(0x1ed)+_0x347b71['botID']+_0x39c28f(0x27a),_0x302c03=fs[_0x39c28f(0x1cf)](_0x4e9201);let _0x5e8483;if(_0x302c03){const _0x509efa=fs[_0x39c28f(0x2be)](_0x4e9201);try{const _0x80f492=JSON[_0x39c28f(0x22c)](_0x509efa);_0x5e8483=_0x80f492?_0x80f492[_0x39c28f(0x348)][0x0][_0x39c28f(0x212)]:null;}catch(_0x2f01fe){}}if(_0x5e8483)_0x5ee41f['push'](_0x5e8483);}});const _0xe3d911=[...new Set(_0x5ee41f)][_0x58f5d7(0x39d)]();return _0xe3d911;}async function initUser(){const _0x597c44=_0x97b7c0;if(!settings['userid']){const _0xeec0bf=uuidRandom();mixpanel[_0x597c44(0x373)](_0xeec0bf),updateSetting('userid',_0xeec0bf);}}async function initSecure(){const _0x14f6cf=_0x97b7c0;let _0x5de472=getSecure();if(!_0x5de472[_0x14f6cf(0x31e)](_0x14f6cf(0x19a))){let _0x18f111=await generateKeys();_0x5de472[_0x14f6cf(0x27d)]=_0x18f111[_0x14f6cf(0x27d)],_0x5de472[_0x14f6cf(0x1e4)]=_0x18f111[_0x14f6cf(0x1e4)],_0x5de472['secret']=crypto[_0x14f6cf(0x1f0)](0x20)[_0x14f6cf(0x2c5)]('hex');;storeSecure(_0x5de472);}}function getSettings(){const _0xb4395=_0x97b7c0;return dbSettings[_0xb4395(0x318)](_0xb4395(0x2de))[_0xb4395(0x33e)]()||{};}function getSecure(){const _0x153379=_0x97b7c0;return dbSecure[_0x153379(0x318)](_0x153379(0x1cb))['value']()||{};}function getBlacklist(){const _0x19087d=_0x97b7c0;return dbSecure[_0x19087d(0x318)](_0x19087d(0x28b))[_0x19087d(0x33e)]()||[];}function broadcastToBots(_0x404967,_0x1a304c){const _0x1dced8=_0x97b7c0;config[_0x1dced8(0x19d)](_0x20bd59=>{const _0x34001f=_0x1dced8;if(_0x20bd59[_0x34001f(0x2a2)]==_0x34001f(0x196)&&_0x20bd59[_0x34001f(0x2c8)]=='running'||_0x20bd59[_0x34001f(0x2a2)]==_0x34001f(0x395)&&_0x20bd59[_0x34001f(0x2c8)]==_0x34001f(0x262)){if(pid[_0x20bd59['botID']])pid[_0x20bd59[_0x34001f(0x333)]]['send']({[_0x404967]:_0x1a304c});}});}async function storeSettings(_0x12e675,_0x64e9a9=![]){const _0x4a0f5b=_0x97b7c0;_0x12e675={...settings,..._0x12e675};if(_0x64e9a9&&_0x12e675['bbPassword']!=_0x4a0f5b(0x1ac)&&_0x12e675[_0x4a0f5b(0x2da)]!=_0x4a0f5b(0x308)&&_0x12e675[_0x4a0f5b(0x2da)]!=''){const _0x5a9351=decryptRSA(secure[_0x4a0f5b(0x1e4)],_0x12e675[_0x4a0f5b(0x2da)])['split']('|@|')[0x0],_0x565cb4=bcrypt[_0x4a0f5b(0x1c8)](_0x5a9351,saltRounds);_0x12e675={..._0x12e675,'bbPassword':_0x565cb4};}if(_0x64e9a9&&_0x12e675[_0x4a0f5b(0x365)]!=_0x4a0f5b(0x1ac)&&_0x12e675[_0x4a0f5b(0x365)]!='***'&&_0x12e675[_0x4a0f5b(0x365)]!=''){const _0x4d70a8=decryptRSA(secure[_0x4a0f5b(0x1e4)],_0x12e675[_0x4a0f5b(0x365)])[_0x4a0f5b(0x287)](_0x4a0f5b(0x213))[0x0];_0x12e675={..._0x12e675,'telegramToken':_0x4d70a8};}if(_0x64e9a9&&_0x12e675[_0x4a0f5b(0x31b)]!='************'&&_0x12e675[_0x4a0f5b(0x31b)]!=_0x4a0f5b(0x308)&&_0x12e675['marketcapApi']!=''){const _0x3ff26a=decryptRSA(secure[_0x4a0f5b(0x1e4)],_0x12e675['marketcapApi'])[_0x4a0f5b(0x287)](_0x4a0f5b(0x213))[0x0];_0x12e675={..._0x12e675,'marketcapApi':_0x3ff26a};}const _0x371c27=_0x12e675['telegramToken']!='************'&&_0x12e675[_0x4a0f5b(0x365)]!=settings[_0x4a0f5b(0x365)]||_0x12e675[_0x4a0f5b(0x2b8)]!=settings[_0x4a0f5b(0x2b8)],_0x1e8af5=_0x12e675[_0x4a0f5b(0x365)]==''||_0x12e675[_0x4a0f5b(0x2b8)]=='',_0x47836f=_0x12e675[_0x4a0f5b(0x31b)]&&_0x12e675['marketcapApi']!='************'&&_0x12e675['marketcapApi']!=settings['marketcapApi'];_0x371c27&&(_0x12e675['telegramChatId']=null,_0x12e675['telegramEvents']=_0x4a0f5b(0x20f));for(const [_0x105e20,_0x3fd66f]of Object['entries'](_0x12e675)){if(_0x105e20==_0x4a0f5b(0x365)&&_0x3fd66f==_0x4a0f5b(0x1ac)){_0x12e675[_0x4a0f5b(0x365)]=settings['telegramToken'];continue;};if(_0x105e20==_0x4a0f5b(0x2da)&&_0x3fd66f==_0x4a0f5b(0x1ac)){_0x12e675['bbPassword']=settings['bbPassword'];continue;};if(_0x105e20==_0x4a0f5b(0x31b)&&_0x3fd66f==_0x4a0f5b(0x1ac)){_0x12e675[_0x4a0f5b(0x31b)]=settings[_0x4a0f5b(0x31b)];continue;};dbSettings['set'](_0x4a0f5b(0x325)+_0x105e20,_0x3fd66f)[_0x4a0f5b(0x2c0)]();}settings=_0x12e675,io['to']('botmanager')[_0x4a0f5b(0x20e)](_0x4a0f5b(0x2de),cleanSettings()),broadcastToBots(_0x4a0f5b(0x20a),settings[_0x4a0f5b(0x20a)]),broadcastToBots('onepagemode',settings[_0x4a0f5b(0x1d4)]),broadcastToBots(_0x4a0f5b(0x31b),settings['marketcapApi']);if(_0x371c27&&!_0x1e8af5)initTelegram();_0x371c27&&_0x1e8af5&&(updateSetting(_0x4a0f5b(0x208),null),disableTelegram()),getAllClients()[_0x4a0f5b(0x19d)](_0x1d32f8=>{const _0x4842a4=_0x4a0f5b;getSocket(_0x1d32f8['id'])['emit']('status',{'access':{'allow':![],'reason':_0x4842a4(0x251),'token':null}});}),_0x47836f&&(await sleep(0xbb8),testMarketcapApi(_0x12e675[_0x4a0f5b(0x31b)]));}async function testMarketcapApi(_0xc5871b){const _0x3ef882=_0x97b7c0,_0x597732=[_0x3ef882(0x35b),_0x3ef882(0x1c0)];try{await axios[_0x3ef882(0x318)](_0x3ef882(0x1d5),{'headers':{'X-CMC_PRO_API_KEY':_0xc5871b},'params':{'symbol':_0x597732[_0x3ef882(0x2c5)]()}});}catch(_0x144afc){_0x144afc[_0x3ef882(0x2c5)]()[_0x3ef882(0x24b)](_0x3ef882(0x343))?(io['to'](_0x3ef882(0x38d))[_0x3ef882(0x20e)](_0x3ef882(0x1c3),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x3ef882(0x2d0)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to']('botmanager')[_0x3ef882(0x20e)](_0x3ef882(0x1c3),_0x3ef882(0x199)),logger[_0x3ef882(0x2d0)](_0x3ef882(0x199)),logger[_0x3ef882(0x35e)]('Error\x20details:',_0x144afc[_0x3ef882(0x2c5)]()+_0x3ef882(0x29e)+_0x144afc[_0x3ef882(0x1fe)]));return;}logger[_0x3ef882(0x35e)](_0x3ef882(0x29b));}function updateSetting(_0x4e3253,_0xee8f6b){const _0x1ba178=_0x97b7c0;dbSettings['set'](_0x1ba178(0x325)+_0x4e3253,_0xee8f6b)[_0x1ba178(0x2c0)](),settings=getSettings(),io['to'](_0x1ba178(0x38d))[_0x1ba178(0x20e)](_0x1ba178(0x2de),cleanSettings());}function storeSecure(_0x807e02){const _0x17c726=_0x97b7c0;dbSecure[_0x17c726(0x318)]('secure')['push'](_0x807e02)[_0x17c726(0x2c0)](),secure=_0x807e02;}function addBlacklist(_0x3ff391){const _0x4e6f03=_0x97b7c0;cleanBlacklist();let _0x7fb149;devices[_0x3ff391][_0x4e6f03(0x2e2)]?_0x7fb149=Math[_0x4e6f03(0x336)](devices[_0x3ff391][_0x4e6f03(0x2e2)]['expiry'],loginExpiry):_0x7fb149=loginExpiry,dbSecure[_0x4e6f03(0x318)](_0x4e6f03(0x28b))[_0x4e6f03(0x39e)]({'expiry':new Date()['getTime']()+_0x7fb149*0x3c*0x3e8,'token':devices[_0x3ff391]['access'][_0x4e6f03(0x18a)]})[_0x4e6f03(0x2c0)](),blacklist=dbSecure['get'](_0x4e6f03(0x28b))[_0x4e6f03(0x33e)]();}function cleanBlacklist(){const _0x149e3c=_0x97b7c0;let _0x43bd83=dbSecure[_0x149e3c(0x318)](_0x149e3c(0x28b))[_0x149e3c(0x225)]()[_0x149e3c(0x33e)](),_0x321439=new Date()[_0x149e3c(0x300)]();_0x43bd83[_0x149e3c(0x19d)](_0x2af7a0=>{const _0x3dabcd=_0x149e3c;_0x2af7a0[_0x3dabcd(0x1af)]<_0x321439&&dbSecure[_0x3dabcd(0x318)](_0x3dabcd(0x28b))[_0x3dabcd(0x31a)]({'expiry':_0x2af7a0[_0x3dabcd(0x1af)]})[_0x3dabcd(0x2c0)]();});}function initStates(){let _0x11810a=getConfiguration();_0x11810a['forEach'](_0x4c6719=>{const _0x32a6fd=_0x24ce;_0x4c6719[_0x32a6fd(0x2c8)]=_0x32a6fd(0x1fc);}),storeConfiguration(_0x11810a);}async function generateKeys(){const _0x31a1d5=_0x97b7c0,_0x42b2af=forge[_0x31a1d5(0x35f)]['rsa']['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x2cafc0=forge[_0x31a1d5(0x35f)][_0x31a1d5(0x247)](_0x42b2af[_0x31a1d5(0x1e4)]),_0x4a722a=forge[_0x31a1d5(0x35f)][_0x31a1d5(0x2db)](_0x42b2af[_0x31a1d5(0x27d)]);return{'privateKey':_0x2cafc0,'publicKey':_0x4a722a};}async function oneTimeMigration(){const _0x2e4eb2=_0x97b7c0;let _0x5e17b0=getSettings(),_0x388929=![];!_0x5e17b0[_0x2e4eb2(0x31e)](_0x2e4eb2(0x345))&&(_0x5e17b0[_0x2e4eb2(0x345)]=0x0,_0x388929=!![]);!_0x5e17b0['hasOwnProperty']('lastmsgemitted')&&(_0x5e17b0[_0x2e4eb2(0x2a9)]=0x0,_0x388929=!![]);!_0x5e17b0[_0x2e4eb2(0x31e)](_0x2e4eb2(0x22f))&&(_0x5e17b0['latestversion']=_0x2e4eb2(0x21d),_0x388929=!![]);!_0x5e17b0[_0x2e4eb2(0x31e)]('onepagemode')&&(_0x5e17b0[_0x2e4eb2(0x1d4)]=![],_0x388929=!![]);!_0x5e17b0[_0x2e4eb2(0x31e)]('marketcapApi')&&(_0x5e17b0[_0x2e4eb2(0x31b)]='',_0x388929=!![]);if(_0x388929)storeSettings(_0x5e17b0);try{fs[_0x2e4eb2(0x1b3)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x224159=>{const _0x2ec767=_0x2e4eb2;if(!_0x224159['isDirectory']()){if(!_0x224159['name'][_0x2ec767(0x2f2)](_0x2ec767(0x26b)))fs[_0x2ec767(0x2ef)](configbackuppath+_0x224159[_0x2ec767(0x2b9)]);}else fs[_0x2ec767(0x229)](configbackuppath+_0x224159[_0x2ec767(0x2b9)],{'recursive':!![]});});}catch(_0x5d4c27){logger[_0x2e4eb2(0x35e)](_0x2e4eb2(0x2f4),_0x5d4c27);}}function storeConfiguration(_0x1fb607){const _0x4d9046=_0x97b7c0;dbConfig[_0x4d9046(0x318)](_0x4d9046(0x32c))[_0x4d9046(0x31a)]()['write'](),dbConfig[_0x4d9046(0x318)](_0x4d9046(0x32c))[_0x4d9046(0x39e)](..._0x1fb607)[_0x4d9046(0x2c0)](),config=_0x1fb607;}async function resetPassword(){const _0x29fd4c=_0x97b7c0;if(tgBot&&settings[_0x29fd4c(0x208)]){const _0x4d6307=Markup['inlineKeyboard']([Markup['button'][_0x29fd4c(0x316)](_0x29fd4c(0x20c),_0x29fd4c(0x233)),Markup[_0x29fd4c(0x34e)]['callback']('no',_0x29fd4c(0x38a))]);await sendTelegram(settings[_0x29fd4c(0x208)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x4d6307),tgBot[_0x29fd4c(0x24d)](/resetpw_(.+)/,async _0x55068f=>{const _0x4179df=_0x29fd4c,_0xf6bb51=_0x55068f[_0x4179df(0x200)][0x1];_0x55068f[_0x4179df(0x2ea)]();if(_0xf6bb51!='no'){const _0x166c5e=0xf,_0x204da6=_0x4179df(0x293),_0x4360f6=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x166c5e)))[_0x4179df(0x2e5)](_0x2af034=>_0x204da6[_0x2af034%_0x204da6[_0x4179df(0x38c)]])[_0x4179df(0x39b)](''),_0x47c9c5=bcrypt[_0x4179df(0x1c8)](_0x4360f6,saltRounds);storeSettings({'bbPassword':_0x47c9c5}),await sendTelegram(_0x55068f[_0x4179df(0x224)]['id'],_0x4179df(0x28c)+_0x4360f6,{'parse_mode':'HTML'});}else await sendTelegram(_0x55068f[_0x4179df(0x224)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x16f891,_0x55534a){const _0x548b7e=_0x97b7c0;io['to'](_0x548b7e(0x38d))[_0x548b7e(0x20e)](_0x548b7e(0x1c3),_0x548b7e(0x367),_0x548b7e(0x313));if(tgBot&&settings[_0x548b7e(0x208)]){const _0x5b0a69=uuidRandom();tmpStorage[_0x5b0a69]={'path':_0x16f891,'filename':_0x55534a};const _0x1c977a=Markup['inlineKeyboard']([Markup[_0x548b7e(0x34e)][_0x548b7e(0x316)]('yes',_0x548b7e(0x380)+_0x5b0a69),Markup[_0x548b7e(0x34e)][_0x548b7e(0x316)]('no',_0x548b7e(0x217)+_0x5b0a69)]);await sendTelegram(settings['telegramChatId'],_0x548b7e(0x1e8),_0x1c977a),tgBot['action'](/restore_(.+)_(.+)/,async _0x303e97=>{const _0x162999=_0x548b7e,_0x4af0ac=_0x303e97[_0x162999(0x200)][0x1],_0xcaae15=_0x303e97[_0x162999(0x200)][0x2],{path:_0xe140f8,filename:_0x511d6b}=tmpStorage[_0xcaae15];delete tmpStorage[_0xcaae15],_0x303e97[_0x162999(0x2ea)](),_0x4af0ac==_0x162999(0x20c)?(logger[_0x162999(0x35e)](_0x162999(0x18c)),await sendTelegram(_0x303e97[_0x162999(0x224)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x162999(0x39c)}),unzipFile(_0xe140f8,_0x511d6b)):(logger['debug'](_0x162999(0x381)),await sendTelegram(_0x303e97[_0x162999(0x224)]['id'],_0x162999(0x381)));});}}function getServerTime(){const _0x571d15=_0x97b7c0,_0x25dcda=new Date();return _0x25dcda[_0x571d15(0x1c6)]()+'/'+(_0x25dcda[_0x571d15(0x259)]()+0x1)['toString']()[_0x571d15(0x396)](0x2,'0')+'/'+_0x25dcda[_0x571d15(0x2f3)]()[_0x571d15(0x2c5)]()[_0x571d15(0x396)](0x2,'0')+'\x20'+_0x25dcda[_0x571d15(0x197)]()[_0x571d15(0x2c5)]()['padStart'](0x2,'0')+':'+_0x25dcda[_0x571d15(0x303)]()[_0x571d15(0x2c5)]()[_0x571d15(0x396)](0x2,'0')+':'+_0x25dcda[_0x571d15(0x1f7)]()[_0x571d15(0x2c5)]()[_0x571d15(0x396)](0x2,'0');}function getTimeStamp(){const _0x1d7732=_0x97b7c0,_0x201232=shiftedTime();return _0x201232['getFullYear']()+'/'+(_0x201232[_0x1d7732(0x259)]()+0x1)['toString']()[_0x1d7732(0x396)](0x2,'0')+'/'+_0x201232[_0x1d7732(0x2f3)]()[_0x1d7732(0x2c5)]()[_0x1d7732(0x396)](0x2,'0')+'\x20'+_0x201232[_0x1d7732(0x197)]()['toString']()['padStart'](0x2,'0')+':'+_0x201232['getMinutes']()[_0x1d7732(0x2c5)]()[_0x1d7732(0x396)](0x2,'0')+':'+_0x201232[_0x1d7732(0x1f7)]()[_0x1d7732(0x2c5)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x248204=_0x97b7c0,_0x18a527=shiftedTime();return _0x18a527[_0x248204(0x1c6)]()+(_0x18a527[_0x248204(0x259)]()+0x1)[_0x248204(0x2c5)]()[_0x248204(0x396)](0x2,'0')+_0x18a527['getDate']()[_0x248204(0x2c5)]()[_0x248204(0x396)](0x2,'0')+'-'+_0x18a527[_0x248204(0x197)]()[_0x248204(0x2c5)]()[_0x248204(0x396)](0x2,'0')+_0x18a527[_0x248204(0x303)]()[_0x248204(0x2c5)]()[_0x248204(0x396)](0x2,'0')+_0x18a527[_0x248204(0x1f7)]()[_0x248204(0x2c5)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x9b130b=_0x97b7c0,_0x2a8ba0=new Date();let _0x273f71=_0x2a8ba0;if(settings[_0x9b130b(0x20a)]&&settings[_0x9b130b(0x20a)]!==0x0)_0x273f71=fns[_0x9b130b(0x350)](_0x2a8ba0,{'hours':settings['timeshift']});return _0x273f71;}async function startScheduler(){const _0x22096f=_0x97b7c0,_0x2ce817=new Date()[_0x22096f(0x363)](),_0xac9590=shiftedTime()[_0x22096f(0x197)]();_0xac9590==0x4&&backupConfigFiles(),_0xac9590==0x0&&(rotateLogFiles(),logger['debug']('--------------------------------------'),logger[_0x22096f(0x35e)]('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x22096f(0x38e)+(environment=='staging'?_0x22096f(0x1aa):'')),logger[_0x22096f(0x35e)](_0x22096f(0x1be))),_0x2ce817%0x6==0x0&&triggerAnalytics(),_0x2ce817%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x58a236){const _0x4ee030=_0x97b7c0;logger[_0x4ee030(0x35e)](_0x4ee030(0x2bd)+_0x58a236);const _0x4a728=getBotsWithMode();_0x4a728[_0x4ee030(0x38c)]>0x0?confirmRestore(configbackuppath,_0x58a236):unzipFile(configbackuppath,_0x58a236);}async function getBackupFiles(_0x52b1c6=null){const _0x9284d3=_0x97b7c0;let _0x283333=[],_0x45644a=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x45644a[_0x9284d3(0x39d)]((_0xe803e4,_0x4864fb)=>_0xe803e4[_0x9284d3(0x2b9)]<_0x4864fb[_0x9284d3(0x2b9)]?0x1:_0x4864fb['name']<_0xe803e4[_0x9284d3(0x2b9)]?-0x1:0x0),_0x45644a[_0x9284d3(0x19d)](_0xc26e2b=>{const _0x5dc5a4=_0x9284d3;if(!_0xc26e2b[_0x5dc5a4(0x210)]()&&_0xc26e2b[_0x5dc5a4(0x2b9)][_0x5dc5a4(0x2f2)]('backup-full@')&&_0xc26e2b[_0x5dc5a4(0x2b9)]['endsWith'](_0x5dc5a4(0x2c2))){const _0x2e784e=formatDate(fs[_0x5dc5a4(0x19f)](configbackuppath+_0xc26e2b[_0x5dc5a4(0x2b9)])[_0x5dc5a4(0x324)]);_0x283333['push']({'name':_0xc26e2b[_0x5dc5a4(0x2b9)],'mtime':_0x2e784e});}});if(_0x52b1c6)io['to'](_0x52b1c6)[_0x9284d3(0x20e)](_0x9284d3(0x1b5),_0x283333);else return _0x283333;}async function backupConfigFiles(){const _0x5a0019=_0x97b7c0;await zipFiles('backup-full');const _0x50bfae=getCleanTimeStamp();fs[_0x5a0019(0x235)](zippath+_0x5a0019(0x2c3),configbackuppath+(_0x5a0019(0x26b)+_0x50bfae+'.zip'));let _0x1ae0be=fs[_0x5a0019(0x1b3)](configbackuppath,{'withFileTypes':!![]});_0x1ae0be[_0x5a0019(0x39d)]((_0xf256ae,_0x4ff695)=>_0xf256ae[_0x5a0019(0x2b9)]<_0x4ff695[_0x5a0019(0x2b9)]?0x1:_0x4ff695[_0x5a0019(0x2b9)]<_0xf256ae[_0x5a0019(0x2b9)]?-0x1:0x0),_0x1ae0be[_0x5a0019(0x38c)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x1ae0be[_0x1ae0be[_0x5a0019(0x38c)]-0x1]['name']);}function rotateLogFiles(){const _0x41365c=_0x97b7c0,_0x373008=fs[_0x41365c(0x19f)](logspath+'output-000.log'),_0x400c9d=_0x373008[_0x41365c(0x339)]/0x400;if(_0x400c9d>0x64){let _0x4baf35=fs[_0x41365c(0x1b3)](logspath,{'withFileTypes':!![]});_0x4baf35[_0x41365c(0x39d)]((_0x16bacb,_0x4c5b39)=>_0x16bacb[_0x41365c(0x2b9)]<_0x4c5b39[_0x41365c(0x2b9)]?0x1:_0x4c5b39[_0x41365c(0x2b9)]<_0x16bacb[_0x41365c(0x2b9)]?-0x1:0x0),_0x4baf35[_0x41365c(0x19d)](_0x3161b6=>{const _0x3f88c7=_0x41365c;if(_0x3161b6['name']=='output-002.log')fs[_0x3f88c7(0x235)](logspath+_0x3161b6[_0x3f88c7(0x2b9)],logspath+_0x3f88c7(0x2e8));if(_0x3161b6[_0x3f88c7(0x2b9)]==_0x3f88c7(0x314))fs[_0x3f88c7(0x235)](logspath+_0x3161b6[_0x3f88c7(0x2b9)],logspath+_0x3f88c7(0x2e9));_0x3161b6[_0x3f88c7(0x2b9)]==_0x3f88c7(0x29c)&&(fs[_0x3f88c7(0x235)](logspath+_0x3161b6[_0x3f88c7(0x2b9)],logspath+'output-001.log'),fs[_0x3f88c7(0x28a)](logspath+_0x3161b6['name'],''));});}}async function zipFiles(_0xb4a6fb){const _0x4be1c0=_0x97b7c0;let _0x3ffcc9;if(_0xb4a6fb==_0x4be1c0(0x21c))_0x3ffcc9=logspath;if(_0xb4a6fb==_0x4be1c0(0x295))_0x3ffcc9=configpath;if(_0xb4a6fb==_0x4be1c0(0x25d))_0x3ffcc9=configpath;let _0x5084b6=fs[_0x4be1c0(0x1b3)](_0x3ffcc9,{'withFileTypes':!![]});const _0x2234b3=new JSZip();_0x5084b6[_0x4be1c0(0x19d)](_0x2fc1fe=>{const _0x23c364=_0x4be1c0;if(!_0x2fc1fe[_0x23c364(0x210)]()){let _0x157ef2=fs[_0x23c364(0x2be)](_0x3ffcc9+_0x2fc1fe['name']);if(_0xb4a6fb==_0x23c364(0x295)){const _0x166c8f=/^bot-[0-9]{3}-config.json$/,_0x5dafd3=_0x166c8f[_0x23c364(0x1d3)](_0x2fc1fe[_0x23c364(0x2b9)]);if(_0x5dafd3){const _0x160a9b=JSON['parse'](_0x157ef2);if(_0x160a9b[_0x23c364(0x348)][0x0]){_0x160a9b[_0x23c364(0x348)][0x0][_0x23c364(0x1b9)]=_0x23c364(0x308),_0x160a9b[_0x23c364(0x348)][0x0]['apiSecret']='***';if(_0x160a9b[_0x23c364(0x348)][0x0][_0x23c364(0x2cc)])_0x160a9b['bot'][0x0][_0x23c364(0x2cc)]=_0x23c364(0x308);}_0x157ef2=JSON[_0x23c364(0x1cd)](_0x160a9b,null,0x2);}if(_0x2fc1fe['name']==_0x23c364(0x26a)){const _0x5dcb27=JSON[_0x23c364(0x22c)](_0x157ef2);if(_0x5dcb27['settings'][_0x23c364(0x2bf)])_0x5dcb27[_0x23c364(0x2de)]['loginRequired']=![];if(_0x5dcb27[_0x23c364(0x2de)][_0x23c364(0x2da)])_0x5dcb27['settings']['bbPassword']=_0x23c364(0x308);if(_0x5dcb27[_0x23c364(0x2de)][_0x23c364(0x365)])_0x5dcb27[_0x23c364(0x2de)]['telegramToken']='***';if(_0x5dcb27['settings']['telegramChatId'])_0x5dcb27[_0x23c364(0x2de)][_0x23c364(0x208)]=null;if(_0x5dcb27[_0x23c364(0x2de)][_0x23c364(0x31b)])_0x5dcb27['settings'][_0x23c364(0x31b)]='***';_0x157ef2=JSON[_0x23c364(0x1cd)](_0x5dcb27,null,0x2);}if(_0x2fc1fe['name']!=_0x23c364(0x3a1))_0x2234b3[_0x23c364(0x347)](_0x2fc1fe[_0x23c364(0x2b9)],_0x157ef2);}else _0x2234b3[_0x23c364(0x347)](_0x2fc1fe[_0x23c364(0x2b9)],_0x157ef2);}});const _0x5398d0=await _0x2234b3[_0x4be1c0(0x281)]({'type':'string','base64':![],'compression':_0x4be1c0(0x234)});fs[_0x4be1c0(0x28a)](zippath+(_0xb4a6fb+_0x4be1c0(0x2c2)),_0x5398d0,_0x4be1c0(0x227));}async function unzipFile(_0xc8cf4b,_0x23317c){const _0x10273c=_0x97b7c0;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x10273c(0x19d)](_0x25ea29=>{const _0x31aacb=_0x10273c;if(!_0x25ea29['isDirectory']())fs[_0x31aacb(0x229)](configpath+_0x25ea29['name']);});const _0x387542=fs[_0x10273c(0x2be)](_0xc8cf4b+_0x23317c,_0x10273c(0x227)),_0x2762f0=await JSZip[_0x10273c(0x271)](_0x387542,{'base64':![],'checkCRC32':!![]});for(const _0x1dfc27 of Object[_0x10273c(0x275)](_0x2762f0[_0x10273c(0x32a)])){const _0x1412a3=_0x2762f0[_0x10273c(0x32a)][_0x1dfc27],_0x2322c8=await _0x1412a3['async'](_0x10273c(0x18e));fs['writeFileSync'](configpath+_0x1412a3[_0x10273c(0x2b9)],_0x2322c8);}fs[_0x10273c(0x1b3)](temppath,{'withFileTypes':!![]})[_0x10273c(0x19d)](_0x46c862=>{const _0x4bdcf2=_0x10273c;if(!_0x46c862[_0x4bdcf2(0x210)]())fs[_0x4bdcf2(0x229)](temppath+_0x46c862['name']);}),logger['debug'](_0x10273c(0x207)),process['send']({'restore':!![]},_0x4500e3=>{});}async function getPublicIp(){const _0xc4a56d=_0x97b7c0;try{const _0x18fba3=await axios[_0xc4a56d(0x318)](_0xc4a56d(0x1a7));publicip=_0x18fba3[_0xc4a56d(0x266)]['ip'];}catch(_0x3391cc){}}async function triggerAnalytics(){const _0x3f5f6c=_0x97b7c0;if(!publicip)await getPublicIp();const _0x8f574a=getBotsWithMode();let _0x2ed229=0x0;_0x8f574a[_0x3f5f6c(0x19d)](_0x3dd131=>{const _0xca7c87=_0x3f5f6c;if(_0x3dd131[_0xca7c87(0x2a2)]==='enabled')_0x2ed229++;});const _0x167831=getBotExchanges();mixpanel['track'](_0x3f5f6c(0x23a),{'distinct_id':settings[_0x3f5f6c(0x307)],'ip':publicip,'version':serverversion,'numbots':_0x8f574a[_0x3f5f6c(0x38c)],'numbotsenabled':_0x2ed229,'exchanges':_0x167831,'environment':environment});}async function getMessages(){const _0x362e48=_0x97b7c0,_0x2416ab=_0x362e48(0x2f1),_0x56463b=new GraphQLClient(_0x2416ab),_0x2bccac={'authorization':_0x362e48(0x294)},_0x184325=serverversion[_0x362e48(0x287)]('.'),_0x43456c=_0x184325[0x0]+'.'+_0x184325[0x1],_0x279660=Math[_0x362e48(0x1f2)](settings['lastmsgtelegram'],settings[_0x362e48(0x2a9)]),_0x17a1aa={'last':parseInt(_0x279660),'bbm':_0x43456c},_0x4800e3=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4cf231;try{_0x4cf231=await _0x56463b['request'](_0x4800e3,_0x17a1aa,_0x2bccac);}catch(_0x677817){}if(_0x4cf231&&_0x4cf231['messages']){let _0x559250=settings['lastmsgtelegram'],_0x3262e1=settings[_0x362e48(0x345)];newMessages=[];for(const _0x1b9064 of _0x4cf231[_0x362e48(0x304)]){newMessages[_0x362e48(0x39e)](_0x1b9064);let _0x4b0894=![];_0x1b9064[_0x362e48(0x335)]&&(updateSetting('latestversion',_0x1b9064[_0x362e48(0x335)]),_0x4b0894=isNewerVersion(serverversion,_0x1b9064[_0x362e48(0x335)])||serverversion==_0x1b9064[_0x362e48(0x335)]);if(!_0x4b0894&&_0x1b9064[_0x362e48(0x25c)]>_0x559250){if(_0x1b9064[_0x362e48(0x1a9)]===_0x362e48(0x27e)||serverversion['startsWith'](_0x1b9064[_0x362e48(0x1a9)])){let _0x56b097=''+_0x1b9064[_0x362e48(0x377)]+'\x0a\x0a'+_0x1b9064[_0x362e48(0x33c)];const _0x42c35d=await sendTelegramMsg(toTelegramMarkdown(_0x56b097),_0x362e48(0x328));_0x559250=_0x1b9064['number'];}}_0x3262e1=_0x1b9064[_0x362e48(0x25c)];}updateAvailable=isNewerVersion(settings[_0x362e48(0x22f)],serverversion),updateSetting('lastmsgtelegram',_0x3262e1),emitMessages();}}function emitMessages(){const _0x2a0230=_0x97b7c0,_0x1b45ef=settings[_0x2a0230(0x2a9)];let _0x2ed16b=[];newMessages[_0x2a0230(0x19d)](_0xc2843=>{const _0x1d305c=_0x2a0230;_0xc2843[_0x1d305c(0x25c)]>_0x1b45ef&&_0x2ed16b[_0x1d305c(0x39e)](_0xc2843);}),_0x2ed16b[_0x2a0230(0x38c)]>0x0&&getAllClients()[_0x2a0230(0x19d)](_0xb60377=>{const _0x568417=_0x2a0230;getSocket(_0xb60377['id'])[_0x568417(0x20e)]('message',_0x2ed16b);});}function confirmMessage(_0x1350e2){const _0x50946f=_0x97b7c0;updateSetting(_0x50946f(0x2a9),Number(_0x1350e2));}function isNewerVersion(_0xb7fe7a,_0x4efc09){const _0x3305b6=_0x97b7c0,_0x18d8ff=_0x4efc09[_0x3305b6(0x287)]('.'),_0x27efa6=_0xb7fe7a[_0x3305b6(0x287)]('.');for(var _0x1bbff5=0x0;_0x1bbff5<_0x27efa6['length'];_0x1bbff5++){const _0x36bc0c=~~_0x27efa6[_0x1bbff5],_0x437bf0=~~_0x18d8ff[_0x1bbff5];if(_0x36bc0c>_0x437bf0)return!![];if(_0x36bc0c<_0x437bf0)return![];}return![];}function toTelegramMarkdown(_0x191394){const _0x3d744b=_0x97b7c0,_0xfe0d3a=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x184138=/\*{2}(.+?)\*{2}/gim;return _0x191394=_0x191394[_0x3d744b(0x2ec)](_0xfe0d3a,_0x3d744b(0x28e))[_0x3d744b(0x2ec)](_0x184138,_0x3d744b(0x25e)),_0x191394;}async function validateConfigFile(){const _0x20bcfb=_0x97b7c0,_0x4e34e2=dbConfig[_0x20bcfb(0x318)](_0x20bcfb(0x32c))[_0x20bcfb(0x188)](_0x20bcfb(0x333))['value']()||[];if(_0x4e34e2[_0x20bcfb(0x38c)]==0x0){let _0x42fd08=0x0,_0x47a421=[];const _0x4a5ab3=/^bot-([0-9]{3})-config.json$/,_0x51390a=fs[_0x20bcfb(0x1b3)](configpath);_0x51390a[_0x20bcfb(0x19d)](_0x1aa573=>{const _0x166a14=_0x20bcfb,_0x4ec63b=_0x4a5ab3[_0x166a14(0x23d)](_0x1aa573);if(_0x4ec63b){const _0x5a1d53=_0x4ec63b[0x1];let _0x3fa8cd=getBotAttributes(_0x5a1d53);_0x47a421[_0x166a14(0x39e)]({'botID':_0x5a1d53,'botname':_0x3fa8cd[_0x166a14(0x246)],'status':'disabled','live':_0x166a14(0x1fc)}),_0x42fd08++;}}),_0x42fd08!=0x0&&(dbConfig['get'](_0x20bcfb(0x32c))[_0x20bcfb(0x2cd)](_0x47a421)[_0x20bcfb(0x2c0)](),config=_0x47a421,restoredConfigFile=_0x42fd08);}}async function restoreConfigNotify(_0x204442){const _0x487015=_0x97b7c0;let _0x339e8a;if(restoredConfigFile==0x1)_0x339e8a=_0x487015(0x386);else _0x339e8a=_0x487015(0x1b0);if(_0x204442)io['to'](_0x487015(0x38d))[_0x487015(0x20e)]('notification',_0x339e8a);else{logger[_0x487015(0x1a0)](_0x487015(0x278)),logger[_0x487015(0x1a0)](_0x339e8a),logger[_0x487015(0x1a0)](_0x487015(0x278)),logger['simple']('');if(tgBot&&settings[_0x487015(0x208)]&&settings[_0x487015(0x27b)]!=_0x487015(0x2a3))await sendTelegram(settings[_0x487015(0x208)],_0x487015(0x31c)+_0x339e8a);}}function decryptRSA(_0x60ad32,_0x1841c3){const _0x7b3e77=_0x97b7c0,_0x1e7200=forge['pki'][_0x7b3e77(0x280)](_0x60ad32),_0x5494ab=_0x1e7200[_0x7b3e77(0x305)](forge[_0x7b3e77(0x243)][_0x7b3e77(0x2e1)](_0x1841c3),_0x7b3e77(0x38b),{'md':forge['md']['sha256']['create'](),'mgf1':{'md':forge['md'][_0x7b3e77(0x279)]['create']()}});return _0x5494ab;}function validateCredentials(_0x113a61,_0x4643a0){const _0x4a6a2c=_0x97b7c0;if(_0x113a61[_0x4a6a2c(0x19c)]==settings[_0x4a6a2c(0x192)]&&bcrypt[_0x4a6a2c(0x221)](_0x113a61[_0x4a6a2c(0x36e)],settings['bbPassword'])){if(settings[_0x4a6a2c(0x311)])return{'allow':![],'reason':_0x4a6a2c(0x2b7),'token':null};else{const _0x2c8713=generateLoginToken(_0x4643a0);return{'allow':!![],'reason':_0x4a6a2c(0x288),'token':_0x2c8713};}}else return{'allow':![],'reason':_0x4a6a2c(0x34b),'token':null};}function refreshToken(_0x26f4a9){const _0x3bce89=_0x97b7c0,_0x3b3246=generateLoginToken(_0x26f4a9);return{'allow':!![],'reason':_0x3bce89(0x288),'token':_0x3b3246};}function validateAccess(_0x322263,_0x123e29,_0x4d6530){const _0x46b72=_0x97b7c0,_0x2d2775=_0x4d6530?_0x4d6530:devices[_0x123e29]['ip'];let _0x42a2f3;const _0x275e21=_0x4fcded=>{const _0x537bae=_0x24ce;if(settings[_0x537bae(0x2bf)]){if(settings[_0x537bae(0x311)]){if(telegram2FaApproved(_0x123e29)){const _0x2e3a62=generateLoginToken(_0x123e29);return{'allow':!![],'reason':_0x537bae(0x273),'token':_0x2e3a62};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x42a2f3=validToken(_0x4fcded,_0x123e29),_0x42a2f3[_0x537bae(0x31e)](_0x537bae(0x313))?{'allow':!![],'reason':_0x537bae(0x28f),'token':_0x4fcded}:{'allow':![],'reason':_0x537bae(0x2a7),'token':null};}else return{'allow':!![],'reason':_0x537bae(0x2d5),'token':null};};if(settings[_0x46b72(0x22a)]){let _0xb88e80=[...settings['whitelist'],_0x46b72(0x253),_0x46b72(0x1d2),_0x46b72(0x2d8)];if(_0xb88e80[_0x46b72(0x24b)](_0x2d2775))return _0x275e21(_0x322263);else{_0x42a2f3=validToken(_0x322263,_0x123e29);if(_0x42a2f3[_0x46b72(0x31e)](_0x46b72(0x313)))return _0x275e21(_0x322263);else{if(telegramIpApproved(_0x123e29)){const _0x2a5ba4=generateToken(_0x123e29);return _0x42a2f3=_0x275e21(_0x322263),_0x42a2f3[_0x46b72(0x2b1)]?{'allow':!![],'reason':_0x46b72(0x21a),'token':_0x2a5ba4}:_0x42a2f3;}else return settings[_0x46b72(0x2bc)]?{'allow':![],'reason':_0x46b72(0x241),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x275e21(_0x322263);}function timelyDecrypt(_0xd8b517,_0x365258,_0x3d55a6='@'){const _0x51f8d2=_0x97b7c0;if(_0xd8b517)try{const _0x2fa71d=decryptRSA(secure['privateKey'],_0xd8b517),_0x25a291=_0x2fa71d['split'](_0x3d55a6)[0x0],_0x50b49b=_0x2fa71d[_0x51f8d2(0x287)](_0x3d55a6)[0x1],_0xced7cb=new Date()[_0x51f8d2(0x300)]();if(_0x365258){if(_0xced7cb-_0x50b49b<maxSecretAge*0x3e8)return _0x25a291;else return![];}else return _0x25a291;}catch(_0x1dd1df){return![];}else return![];}const validToken=(_0x1d58e1,_0x45a14e)=>{const _0x7ee050=_0x97b7c0,_0x1e1762=devices[_0x45a14e]['ip'];if(!_0x1d58e1)return{'error':_0x7ee050(0x29d)};for(let _0x2f5d21 of blacklist){if(_0x2f5d21[_0x7ee050(0x18a)]==_0x1d58e1)return{'error':'Token\x20blacklisted'};}let _0x2da2d4;try{_0x2da2d4=jwt[_0x7ee050(0x2ac)](_0x1d58e1,secure['secret']+_0x45a14e);}catch{return{'error':_0x7ee050(0x299)};}if(!_0x2da2d4['hasOwnProperty'](_0x7ee050(0x376))&&!_0x2da2d4['hasOwnProperty'](_0x7ee050(0x19c))||!_0x2da2d4[_0x7ee050(0x31e)](_0x7ee050(0x36f)))return{'error':_0x7ee050(0x337)};if(!_0x2da2d4[_0x7ee050(0x31e)](_0x7ee050(0x19c))&&_0x2da2d4[_0x7ee050(0x31e)](_0x7ee050(0x376))){const {clientip:_0x327a37}=_0x2da2d4;return _0x1e1762==_0x327a37?{'success':_0x7ee050(0x27c)}:{'error':_0x7ee050(0x1fb)};}else{if(_0x2da2d4[_0x7ee050(0x31e)]('username')&&_0x2da2d4[_0x7ee050(0x31e)]('clientip')){const {username:_0x39393a,clientip:_0x435bc3}=_0x2da2d4;return settings[_0x7ee050(0x192)]==_0x39393a&&_0x1e1762==_0x435bc3?{'success':_0x7ee050(0x27c)}:{'error':_0x7ee050(0x35c)};}}},generateLoginToken=_0x1efaaf=>{const _0x3f6701=_0x97b7c0;if(_0x1efaaf){const _0x37edeb=devices[_0x1efaaf]['ip'];return jwt[_0x3f6701(0x1b8)]({'username':settings[_0x3f6701(0x192)],'clientip':_0x37edeb},secure[_0x3f6701(0x19a)]+_0x1efaaf,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x36430d=>{const _0x459805=_0x97b7c0;if(_0x36430d){const _0x196d2c=devices[_0x36430d]['ip'];return jwt[_0x459805(0x1b8)]({'clientip':_0x196d2c},secure[_0x459805(0x19a)]+_0x36430d,{'expiresIn':devices[_0x36430d][_0x459805(0x2e2)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x48a3f2=>{const _0x4ce5ce=_0x97b7c0;let _0x384e39=![];return devices[_0x48a3f2][_0x4ce5ce(0x2e2)]&&devices[_0x48a3f2][_0x4ce5ce(0x2e2)][_0x4ce5ce(0x1af)]!='reject'&&(_0x384e39=devices[_0x48a3f2][_0x4ce5ce(0x2e2)][_0x4ce5ce(0x376)]==devices[_0x48a3f2]['ip']&&new Date()['getTime']()-devices[_0x48a3f2][_0x4ce5ce(0x2e2)][_0x4ce5ce(0x1da)]<devices[_0x48a3f2][_0x4ce5ce(0x2e2)]['expiry']*0x3c*0x3e8),_0x384e39;},telegram2FaApproved=_0x41aaeb=>{const _0x1d75de=_0x97b7c0;let _0x53d8d5=![];return devices[_0x41aaeb]['telegram2FaApproval']&&devices[_0x41aaeb][_0x1d75de(0x3a5)][_0x1d75de(0x1af)]!=_0x1d75de(0x341)&&(_0x53d8d5=devices[_0x41aaeb][_0x1d75de(0x3a5)][_0x1d75de(0x376)]==devices[_0x41aaeb]['ip']&&new Date()[_0x1d75de(0x300)]()-devices[_0x41aaeb][_0x1d75de(0x3a5)][_0x1d75de(0x1da)]<devices[_0x41aaeb][_0x1d75de(0x3a5)]['expiry']*0x3c*0x3e8),_0x53d8d5;},normalizeIP=_0x5cd1b0=>{const _0x519b30=_0x97b7c0;let _0x39f95c=null,_0x3980ea=null;if(ipaddr['isValid'](_0x5cd1b0)){const _0x1771be=ipaddr[_0x519b30(0x22c)](_0x5cd1b0);_0x1771be[_0x519b30(0x1df)]()===_0x519b30(0x286)?(_0x1771be['isIPv4MappedAddress']()&&(_0x39f95c=_0x1771be[_0x519b30(0x1a4)]()[_0x519b30(0x2c5)]()),_0x3980ea=_0x1771be[_0x519b30(0x2c5)]()):(_0x39f95c=_0x1771be[_0x519b30(0x2c5)](),_0x3980ea=_0x1771be['toIPv4MappedAddress']()['toString']());}return{'show':_0x39f95c?_0x39f95c:_0x3980ea,'store':_0x3980ea};};function formatDate(_0x1207e8){const _0x4a5bdf=_0x97b7c0;return _0x1207e8[_0x4a5bdf(0x1c6)]()+'/'+(_0x1207e8[_0x4a5bdf(0x259)]()+0x1)[_0x4a5bdf(0x2c5)]()[_0x4a5bdf(0x396)](0x2,'0')+'/'+_0x1207e8[_0x4a5bdf(0x2f3)]()[_0x4a5bdf(0x2c5)]()[_0x4a5bdf(0x396)](0x2,'0')+'\x20'+_0x1207e8[_0x4a5bdf(0x197)]()[_0x4a5bdf(0x2c5)]()[_0x4a5bdf(0x396)](0x2,'0')+':'+_0x1207e8['getMinutes']()[_0x4a5bdf(0x2c5)]()[_0x4a5bdf(0x396)](0x2,'0')+':'+_0x1207e8[_0x4a5bdf(0x1f7)]()[_0x4a5bdf(0x2c5)]()[_0x4a5bdf(0x396)](0x2,'0');}function sleep(_0x20168c){return new Promise(_0x31dd2c=>setTimeout(_0x31dd2c,_0x20168c));}