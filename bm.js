const _0x2cf39b=_0x3e11;(function(_0x1e24b4,_0x46e50d){const _0x31901f=_0x3e11,_0x59e12c=_0x1e24b4();while(!![]){try{const _0x331a0f=parseInt(_0x31901f(0x339))/0x1+-parseInt(_0x31901f(0x264))/0x2*(-parseInt(_0x31901f(0x393))/0x3)+-parseInt(_0x31901f(0x3b2))/0x4*(-parseInt(_0x31901f(0x32e))/0x5)+-parseInt(_0x31901f(0x24b))/0x6*(parseInt(_0x31901f(0x341))/0x7)+parseInt(_0x31901f(0x220))/0x8*(parseInt(_0x31901f(0x348))/0x9)+-parseInt(_0x31901f(0x35b))/0xa*(-parseInt(_0x31901f(0x22b))/0xb)+parseInt(_0x31901f(0x20f))/0xc*(-parseInt(_0x31901f(0x1e2))/0xd);if(_0x331a0f===_0x46e50d)break;else _0x59e12c['push'](_0x59e12c['shift']());}catch(_0x1a71dc){_0x59e12c['push'](_0x59e12c['shift']());}}}(_0x29f5,0x26af1));const _0x4e7632=function(){let _0x1aab56=!![];return function(_0x3ac265,_0x3fc317){const _0x414eeb=_0x1aab56?function(){const _0x30f813=_0x3e11;if(_0x3fc317){const _0x14de7b=_0x3fc317[_0x30f813(0x1b7)](_0x3ac265,arguments);return _0x3fc317=null,_0x14de7b;}}:function(){};return _0x1aab56=![],_0x414eeb;};}(),_0x2677eb=_0x4e7632(this,function(){const _0x22bbf4=_0x3e11;return _0x2677eb[_0x22bbf4(0x2c5)]()['search'](_0x22bbf4(0x298))[_0x22bbf4(0x2c5)]()[_0x22bbf4(0x394)](_0x2677eb)[_0x22bbf4(0x274)](_0x22bbf4(0x298));});_0x2677eb();'use strict';process['env'][_0x2cf39b(0x37f)]=0x1;const childProcess=require(_0x2cf39b(0x1fa)),fs=require('fs'),fns=require(_0x2cf39b(0x273)),low=require(_0x2cf39b(0x1e4)),FileSync=require(_0x2cf39b(0x387)),path=require(_0x2cf39b(0x1f8)),crypto=require(_0x2cf39b(0x1ab)),forge=require(_0x2cf39b(0x266)),bcrypt=require(_0x2cf39b(0x2ce)),jwt=require(_0x2cf39b(0x2bb)),ipaddr=require(_0x2cf39b(0x345)),argv=require('yargs/yargs')(process[_0x2cf39b(0x3b6)][_0x2cf39b(0x1aa)](0x2))['argv'],uuidRandom=require(_0x2cf39b(0x247)),{Telegraf,Markup}=require(_0x2cf39b(0x2c4)),Mixpanel=require(_0x2cf39b(0x3bc)),axios=require(_0x2cf39b(0x284)),{GraphQLClient,gql}=require(_0x2cf39b(0x2c8)),util=require(_0x2cf39b(0x252)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x2cf39b(0x1dd)),PORT=argv[_0x2cf39b(0x1b0)]||_0x2cf39b(0x303),pattern=/^[0-9]{2,4}$/;!pattern[_0x2cf39b(0x2d3)](PORT)&&(console[_0x2cf39b(0x301)](_0x2cf39b(0x29a)+PORT+_0x2cf39b(0x350)),process['exit'](0x1));const HOST=argv['host']||null,userID=argv[_0x2cf39b(0x1b4)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process['versions'][_0x2cf39b(0x326)];let bbpath=_0x2cf39b(0x254),bbpath2='';const botfile='bot.js',configfile=_0x2cf39b(0x375),settingsfile=_0x2cf39b(0x2ab),securefile=_0x2cf39b(0x2e8),environment=require('./'+bbpath2+_0x2cf39b(0x362))['environment']||_0x2cf39b(0x2f0),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x2cf39b(0x268)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2cf39b(0x31a)),configpath=userID?bbpath+_0x2cf39b(0x1f5)+userID+'/':bbpath+_0x2cf39b(0x1f5),configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x2cf39b(0x2a3),zippath=userID?bbpath+_0x2cf39b(0x1a8)+userID+'/':bbpath+_0x2cf39b(0x1a8),loggerfile=fs['createWriteStream'](logspath+_0x2cf39b(0x212),{'flags':'a'}),temppath=userID?bbpath+_0x2cf39b(0x1fc)+userID+'/':bbpath+'temp/';!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x2cf39b(0x268)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x2cf39b(0x268)](zippath)&&fs[_0x2cf39b(0x294)](zippath);!fs[_0x2cf39b(0x268)](temppath)&&fs[_0x2cf39b(0x294)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2cf39b(0x2b4)]({'bots':[]})[_0x2cf39b(0x1c2)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2cf39b(0x2b4)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2cf39b(0x325),'onepagemode':![],'marketcapApi':''}})[_0x2cf39b(0x1c2)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2cf39b(0x2b4)]({'secure':{},'blacklist':[]})[_0x2cf39b(0x1c2)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x2cf39b(0x2ee)](_0x2cf39b(0x340),{'host':_0x2cf39b(0x215)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings['telegramToken']!=''&&settings[_0x2cf39b(0x233)]!=_0x2cf39b(0x3b4))&&settings['telegramUsername']&&settings[_0x2cf39b(0x1bb)]!='')initTelegram();const parseColor=(_0x433be0,_0x33c1d1)=>{const _0x405ab7=_0x2cf39b,_0x4a4b57=/#[A-Z]{3}#/g;if(typeof _0x433be0==_0x405ab7(0x2b2)){!_0x33c1d1?_0x433be0=_0x433be0['replace'](_0x4a4b57,''):(_0x433be0=_0x433be0[_0x405ab7(0x2b9)](/#BLU#/g,'\x1b[34m'),_0x433be0=_0x433be0[_0x405ab7(0x2b9)](/#RED#/g,_0x405ab7(0x1bf)),_0x433be0=_0x433be0[_0x405ab7(0x2b9)](/#YEL#/g,_0x405ab7(0x30d)),_0x433be0=_0x433be0[_0x405ab7(0x2b9)](/#MAG#/g,_0x405ab7(0x2db)),_0x433be0=_0x433be0['replace'](/#CYA#/g,_0x405ab7(0x22c)),_0x433be0=_0x433be0[_0x405ab7(0x2b9)](/#RES#/g,_0x405ab7(0x1c9)));;}return _0x433be0;},logger={'screen':_0x31edbd=>{console['log'](parseColor(_0x31edbd,!![]));},'simple':_0x2e320f=>{const _0xf64ecd=_0x2cf39b;console[_0xf64ecd(0x301)](parseColor(_0x2e320f,!![])),loggerfile[_0xf64ecd(0x1c2)](util[_0xf64ecd(0x211)](parseColor(_0x2e320f,![]))+'\x0a');},'full':async _0x23e95d=>{const _0x3ae5d4=_0x2cf39b,_0x472464=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x23e95d;console[_0x3ae5d4(0x301)](parseColor(_0x472464,!![])),loggerfile[_0x3ae5d4(0x1c2)](util[_0x3ae5d4(0x211)](parseColor(_0x472464,![]))+'\x0a');if(tgBot&&settings[_0x3ae5d4(0x201)]&&settings['telegramEvents']!='orders')await sendTelegram(settings[_0x3ae5d4(0x201)],_0x3ae5d4(0x2e9)+parseColor(_0x23e95d,![]));},'debug':async(_0x320d72,_0x267d1b='')=>{const _0x3b177c=_0x2cf39b,_0x2cac62=getTimeStamp()+_0x3b177c(0x2e5)+_0x320d72;if(debugging)console[_0x3b177c(0x301)](parseColor(_0x2cac62,!![]));loggerfile[_0x3b177c(0x1c2)](util[_0x3b177c(0x211)](parseColor(_0x2cac62,![]))+'\x0a');if(_0x267d1b){if(debugging)console[_0x3b177c(0x301)](_0x267d1b);loggerfile[_0x3b177c(0x1c2)](util[_0x3b177c(0x211)](_0x267d1b)+'\x0a');}}};let terminating=![];process['on'](_0x2cf39b(0x1e7),function(_0x2b4f2d){const _0x4a7cdf=_0x2cf39b;_0x2b4f2d['toString']()[_0x4a7cdf(0x352)]('address\x20already\x20in\x20use')?(logger[_0x4a7cdf(0x32f)](_0x4a7cdf(0x2b8)+_0x2b4f2d[_0x4a7cdf(0x1b0)]+_0x4a7cdf(0x1d7)),process[_0x4a7cdf(0x2bd)]({'terminate':!![]},_0x2e59de=>{})):logger['simple'](_0x2b4f2d);}),process['on'](_0x2cf39b(0x1ec),()=>{const _0x524da5=_0x2cf39b;stopAllBots(),process[_0x524da5(0x1ec)](0x0);}),process['on'](_0x2cf39b(0x24d),()=>{const _0x5774a=_0x2cf39b;stopAllBots(),process[_0x5774a(0x1ec)](0x0);}),process['on'](_0x2cf39b(0x249),()=>{const _0x3c5d18=_0x2cf39b;stopAllBots(),process[_0x3c5d18(0x1ec)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x2cf39b(0x244)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2cf39b(0x38a)),app=express(),http=require(_0x2cf39b(0x2a5))[_0x2cf39b(0x21e)](app);app[_0x2cf39b(0x26b)](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x14a693,_0xe465d2)=>{const _0x2d8e66=_0x2cf39b,_0x2b623a=_0x14a693[_0x2d8e66(0x25c)][_0x2d8e66(0x1e8)],_0x4b5e97=getClientsWithBotID(_0x2d8e66(0x2b3)),_0x3e777e=_0x14a693['headers'][_0x2d8e66(0x320)],_0xecd387=timelyDecrypt(_0x3e777e,![]),_0x24158a=_0x4b5e97[_0x2d8e66(0x398)](_0x49c404=>_0x49c404['uuid']==_0xecd387);if(_0x24158a){const _0x575a40=normalizeIP(_0x14a693[_0x2d8e66(0x1b8)][_0x2d8e66(0x2a2)])[_0x2d8e66(0x3c2)],_0x4203f9=_0x14a693['headers']['tkn'];if(validateAccess(_0x4203f9,_0xecd387,_0x575a40)[_0x2d8e66(0x39c)])_0x2b623a==_0x2d8e66(0x36a)&&await backupConfigFiles(),await zipFiles(_0x2b623a),_0xe465d2[_0x2d8e66(0x29e)](zippath+(_0x2b623a+_0x2d8e66(0x33d)),_0x4c1cc7=>{const _0x1a72b3=_0x2d8e66;_0x4c1cc7&&(logger[_0x1a72b3(0x262)](_0x1a72b3(0x225)+_0x2b623a),logger[_0x1a72b3(0x32f)](_0x4c1cc7));});else logger[_0x2d8e66(0x262)](_0x2d8e66(0x39a)+_0x2b623a+_0x2d8e66(0x289));}else logger[_0x2d8e66(0x262)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x2b623a+_0x2d8e66(0x305));}),app[_0x2cf39b(0x35d)](_0x2cf39b(0x1f6),async(_0x522648,_0x3c999d)=>{const _0x3cfe6c=_0x2cf39b,_0x3b4202=getClientsWithBotID(_0x3cfe6c(0x2b3)),_0x4f0970=_0x522648['headers'][_0x3cfe6c(0x320)],_0x4fbd09=timelyDecrypt(_0x4f0970,![]),_0xcfffb=_0x3b4202['find'](_0x11102e=>_0x11102e[_0x3cfe6c(0x320)]==_0x4fbd09);logger[_0x3cfe6c(0x315)](_0x3cfe6c(0x37a));if(_0xcfffb){const _0x399e5d=normalizeIP(_0x522648['socket']['remoteAddress'])[_0x3cfe6c(0x3c2)],_0xc46fdb=_0x522648[_0x3cfe6c(0x337)]['tkn'];if(validateAccess(_0xc46fdb,_0x4fbd09,_0x399e5d)[_0x3cfe6c(0x39c)]){if(_0x522648['files']){const _0x3e1e27=_0x522648['files'][_0x3cfe6c(0x27c)];await _0x3e1e27['mv'](temppath+_0x3e1e27[_0x3cfe6c(0x331)]),_0x3c999d[_0x3cfe6c(0x2bd)]({'status':!![],'message':_0x3cfe6c(0x299)});const _0x2a5070=getBotsWithMode();_0x2a5070['length']>0x0?confirmRestore(temppath,_0x3e1e27[_0x3cfe6c(0x331)]):unzipFile(temppath,_0x3e1e27[_0x3cfe6c(0x331)]);}}else logger[_0x3cfe6c(0x262)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger['full'](_0x3cfe6c(0x224));}),app[_0x2cf39b(0x26b)](express[_0x2cf39b(0x29b)](path[_0x2cf39b(0x385)](__dirname,bbpath2,_0x2cf39b(0x26e)))),app[_0x2cf39b(0x26b)](express['static'](path['join'](__dirname,bbpath2,'build'))),app['get']('/',function(_0x5e5bf3,_0x27fe3e){const _0x18dae2=_0x2cf39b;_0x27fe3e[_0x18dae2(0x2f9)](path[_0x18dae2(0x385)](__dirname,bbpath2,'build2',_0x18dae2(0x28d)));}),app[_0x2cf39b(0x1fb)](_0x2cf39b(0x356),function(_0x59f0a6,_0x4cdee7){const _0x51ae46=_0x2cf39b;_0x4cdee7['sendFile'](path['join'](__dirname,bbpath2,_0x51ae46(0x265),_0x51ae46(0x28d)));}),app['get']('/:bot/portfolio',(_0x52c199,_0x485728)=>{const _0x2cb1e2=_0x2cf39b;_0x485728[_0x2cb1e2(0x2f9)](path[_0x2cb1e2(0x385)](__dirname,bbpath2,_0x2cb1e2(0x265),_0x2cb1e2(0x28d)));}),app[_0x2cf39b(0x1fb)]('/:bot/performance',(_0x2fc9fa,_0x1d1551)=>{const _0x476772=_0x2cf39b;_0x1d1551['sendFile'](path[_0x476772(0x385)](__dirname,bbpath2,_0x476772(0x265),_0x476772(0x28d)));}),app[_0x2cf39b(0x1fb)](_0x2cf39b(0x277),(_0x58d36d,_0x3d0bb5)=>{const _0x8788d0=_0x2cf39b;_0x3d0bb5[_0x8788d0(0x2f9)](path[_0x8788d0(0x385)](__dirname,bbpath2,_0x8788d0(0x265),_0x8788d0(0x28d)));}),app['get'](_0x2cf39b(0x209),(_0x20a671,_0x5e627b)=>{const _0x36bb4e=_0x2cf39b;_0x5e627b['sendFile'](path[_0x36bb4e(0x385)](__dirname,bbpath2,'build',_0x36bb4e(0x28d)));}),app[_0x2cf39b(0x1fb)](_0x2cf39b(0x1e1),(_0x804012,_0x42f0ff)=>{const _0x38adb0=_0x2cf39b;_0x42f0ff['sendFile'](path[_0x38adb0(0x385)](__dirname,bbpath2,_0x38adb0(0x265),_0x38adb0(0x28d)));}),app[_0x2cf39b(0x1fb)](_0x2cf39b(0x2cb),(_0x8b94c9,_0x3d7856)=>{const _0x337705=_0x2cf39b;_0x3d7856['sendFile'](path[_0x337705(0x385)](__dirname,bbpath2,_0x337705(0x265),_0x337705(0x28d)));});if(HOST)http[_0x2cf39b(0x34e)](PORT,HOST);else http['listen'](PORT);const io=require(_0x2cf39b(0x1f9))(http,{});init();function _0x29f5(){const _0x5582c5=['Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','filter','backupfile','timeshift','sockets','status\x20code\x20401','store-settings','size','cloneDeep','reset-history','axios','<b>Telegram\x20Bot\x20Status:</b>\x0a','\x20|\x20client:\x20...','/disable\x20-\x20disable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','\x20(1)','getMonth','Starting\x20#RED#Balance\x20Bot\x20v','reject','index.html','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','isDirectory','restart_','secret','confirm-message','Allow\x20login\x20from\x20IP\x20address\x20','mkdirSync','place-order','isValid','Token\x20blacklisted','(((.+)+)+)+$','File\x20uploaded','Error:\x20Invalid\x20argument\x20','static','Invalid\x20authentication\x20token\x20(1)','access\x20timeout','download','temporaryAccessAllowed','Login\x20rejected','-events.json','remoteAddress','logs/','Unauthorized\x20attempt\x20to\x20update\x20settings','http','emit','fork','restore_yes_','logged\x20out','config','bb-settings.json','reset-password','-----------------------------------------------------------------------------------','disable','telegram','Logged\x20in\x20user\x20...','code','string','botmanager','defaults',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','\x20minutes','update','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','replace','Running\x20#RED#Balance\x20Bot\x20v','jsonwebtoken','temporary\x20access\x20not\x20allowed','send','/enable\x20-\x20enable\x20notifications\x0a','cancelLoading','lastmsgemitted','timestamp','forEach','then','telegraf','toString','messages','|@|','graphql-request','temporary\x20access\x20timeout','Notifications\x20enabled\x0a','/:bot/support','show','Unauthorized\x20attempt\x20to\x20log\x20out','bcryptjs','function','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','address','toggleBotMode','test','headless','kill','login\x20required','split','-results.json','login\x20not\x20required','set','\x1b[35m','sha256','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','output-000.log','once','toIPv4MappedAddress','delete-bot','Unauthorized\x20attempt\x20to\x20update\x20bot','editMessageReplyMarkup','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','chat','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','bb-secure.json','Bot\x20Mgr\x20>\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','resetpw_no','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','connected','init','reply','production','disconnect','bot','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','getFullYear','statSync','whitelist','Node.js\x20v','getHours','sendFile','settings.','get-logs','update-bb','getSeconds','bbvReceive','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','title','log','start','3000','\x20|\x20','\x20(2)','/restart\x20-\x20restart\x20bot(s)\x0a','sign','telegrammsg','Error\x20sending\x20','encryptedUuid','reason','event','\x1b[33m',')\x20\x20\x20|\x20Bot\x20','manual','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','sendPortfolioTelegram','Starting\x20Balance\x20Bot\x20update','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','getDate','debug','Orders','IPv4','5\x20min','disabled','clients','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','login','pidRefreshToken','exec','Your\x20installation\x20is\x20already\x20up\x20to\x20date','uuid','toggle-bot-mode','reinstall-bb','on_','restart','0.0.0','node','stop','getTime','output-002.log','command','entries','-config.json','Unauthorized\x20attempt\x20to\x20get\x20events','270ipCrky','simple','sortBy','name','Restore\x20process\x20aborted','Login\x20accepted','metrics','publicKey','generateKeyPair','headers','=>\x20Go\x20to\x20#CYA#http://','192170JDEkjG','Restoring\x20bot(s)\x20from\x20backup','telegramEvents','readdirSync','.zip','mode','sendMetricsTelegram','6b67f3d61ee94b8f5c80b4affef4c4d9','7hdQxhY','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Notifications\x20enabled','any','ipaddr.js','Unauthorized\x20attempt\x20to\x20confirm\x20message','Bot\x20','141309KkfovV','yes','remove','rmSync','orders','\x20mode','listen','mtime',',\x20must\x20be\x20a\x204\x20digit\x20number','clientip','includes','from','hex','auth','/:bot','Server','Backup\x20file\x20unzipped\x20and\x20stored','stringify','catch','1558130HnVEKw','get-portfolio','post','Starting\x20Balance\x20Bot\x20reinstallation','access','family','inlineKeyboard','version.json','showname','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','message','replyWithDocument','login\x20token\x20valid','rsa','alerts','backup','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','initclient','toggle_','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','apiSecret','args','publicKeyToPem','verify','showConfig','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','bb-config.json','tempaccess_5_','toIPv4Address','off','tempaccess_reject_','Backup\x20file\x20uploaded','botname','f2aRequired','pidExpireLogin','help','NTBA_FIX_319','resetHistory','get-messages','User\x20has\x20been\x20validated','map','login\x20token\x20generated','join','started','lowdb/adapters/FileSync','number','order','express','padStart','max','reload','BCT','cancel-loading','inherit','bbUsername','/backup\x20-\x20receive\x20backup\x20files\x0a','22434nKzuBi','constructor','parse','https://api.ipify.org?format=json','<b>Balance\x20Bot\x20Status:</b>\x0a','find','handshake','Unauthorized\x20attempt\x20to\x20download\x20','privateKeyFromPem','allow','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','portfolio_','No\x20bots\x20running\x20right\x20now','ipc','2FA','names','apiPassword','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','token','bots','logs','restore_no_','callback','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20get\x20messages','error','hashSync','status','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','toggle','stopped','104QKgxrA','exchange','***','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','argv','Enabled\x20Bot\x20','#RES#\x20if\x20running\x20on\x20server','Disabled\x20Bot\x20','success','min','mixpanel','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','sort','ipv6','new','async','store','/update\x20-\x20update\x20Balance\x20Bot\x0a','Logged\x20out\x20user\x20...','add-bot','sendMessage','zip/','referer','slice','crypto','1000','randomFillSync','secure','Error\x20details:','port','Unauthorized\x20attempt\x20to\x20delete\x20bot','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','#RES#\x20','user','assign','getStartingBalances','apply','socket','Access\x20enabled\x20for\x20','enabled','telegramUsername','isIPv4MappedAddress','Setting\x20access:\x20','Yes','\x1b[31m','blacklist','Telegraf\x20error:','write','\x20to\x20','decode64','Session\x20expired\x20for\x20user\x20...','backup-full@','Unauthorized\x20login\x20attempt\x20(timeout)','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','\x1b[0m','/status\x20-\x20show\x20bot(s)\x20status\x0a','live','connection','/logs\x20-\x20receive\x20log\x20files\x0a','binary','\x20-\x20','storeConfiguration','lastmsgtelegram','username','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','2FA\x20login\x20rejected','Password\x20reset\x20rejected','Error\x20while\x20deleting\x20config\x20files:\x20','#RES#','Invalid\x20IP\x20address','Error\x20removing\x20old\x20backup\x20files:','value','telegram2FaApproval','DEFLATE','jszip','2FA\x20required','running','push','/:bot/configuration','39ZaXkXI','All\x20bots','lowdb','onepagemode','invalid\x20credentials','uncaughtException','type','Alerts','/start','botID','exit','telegramEnabled','reinstall_no','::1','HTML','length','track','writeFileSync','bbPassword','config/','/upload-backup','\x20|\x20user:\x20...','path','socket.io','child_process','get','temp/','\x20files\x20over\x20Telegram:','file','backup-full','(staging)','telegramChatId','::ffff:127.0.0.1','-performance.json','startsWith','loginRequired','tempaccess_30_','************','button','/:bot/history','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Ok,\x20will\x20send\x20alert\x20notifications\x20only','apiKey','readFileSync','update_no','2260548dWlHVM','output-003.log','format','/output-000.log','Starting\x20new\x20bot\x20|\x20Bot\x20','RSA-OAEP','api-eu.mixpanel.com','getUTCHours','/off\x20-\x20stop\x20bot(s)\x0a','removeAllListeners',')\x20|\x20Bot\x20','marketcapApi','auto','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','create','createServer','login2fa_reject_','88EhaWkN','*$1*','latestversion','new-disabled','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Failed\x20to\x20download\x20','conn','config_all','alias','reinstall','action','22yCByie','\x1b[36m','All','30\x20min','Deleted\x20Bot\x20','backup-files','notification','settings','telegramToken','keys','copyFileSync','unlinkSync','internal','expiry','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','hasOwnProperty','match','kind','temporary\x20token\x20generated','Idling\x20(','bbvNew','15\x20min','privateKey','getMinutes','version','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','warning','uuid-random','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','SIGINT','pki','892518HQJLED','tempaccess_15_','SIGTERM','show-config','compareSync','enable','staging','util','randomBytes','bb/','launch','range','bot-','emitHistory','userid','deleteHistoryAlerts','generateAsync','params','$1_$2_$3','get-starting-balances','2FA\x20login\x20required','config_alerts','getPortfolio','full','Password\x20has\x20been\x20reset\x20to:\x20','52CdGYSJ','build','node-forge','telegramIpApproval','existsSync','Invalid\x20username\x20or\x20IP\x20address','\x20>\x20','use','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','resetpw_yes','build2','Starting\x20(','temporary\x20access\x20rejected','updatebotmanager','Unauthorized\x20attempt\x20to\x20delete\x20alerts','date-fns','search','password','all','/:bot/coins','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Unauthorized\x20attempt\x20to\x20store\x20configuration'];_0x29f5=function(){return _0x5582c5;};return _0x29f5();}async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x348e83=_0x2cf39b;let _0x857fbf='[ip-address]';const _0x32861c=networkInterfaces(),_0x3cc9d4={};for(const _0x164a8a of Object['keys'](_0x32861c)){for(const _0x5092d9 of _0x32861c[_0x164a8a]){if((_0x5092d9[_0x348e83(0x360)]==_0x348e83(0x317)||_0x5092d9['family']==0x4)&&!_0x5092d9[_0x348e83(0x237)]){const _0x4f923b=ipaddr[_0x348e83(0x395)](_0x5092d9[_0x348e83(0x2d1)])[_0x348e83(0x256)]();_0x4f923b!='private'&&(!_0x3cc9d4[_0x164a8a]&&(_0x3cc9d4[_0x164a8a]=[]),_0x3cc9d4[_0x164a8a][_0x348e83(0x1e0)](_0x5092d9['address']),_0x857fbf=_0x5092d9[_0x348e83(0x2d1)]);}}}return{'serverip':_0x857fbf,'netinterfaces':_0x3cc9d4};}async function startServer(){const _0x5941ee=_0x2cf39b,{serverip:_0x471639,netinterfaces:_0x4502f2}=getServerIP();logger[_0x5941ee(0x32f)](''),logger[_0x5941ee(0x32f)]('-----------------------------------------------------------------------------------'),await logger['full'](_0x5941ee(0x28b)+serverversion+_0x5941ee(0x1b3)+(environment=='staging'?_0x5941ee(0x200):'')+'\x0a'+(_0x5941ee(0x31b)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x5941ee(0x338)+_0x471639+':'+PORT+_0x5941ee(0x3b8))),logger[_0x5941ee(0x32f)](_0x5941ee(0x2ad));if(config['length']!=0x0)for(const _0x357961 of config){const _0x59a2b4=_0x357961[_0x5941ee(0x33e)]==_0x5941ee(0x21b)?'a':'m';if(_0x357961[_0x5941ee(0x3ae)]=='enabled'||_0x357961[_0x5941ee(0x3ae)]==_0x5941ee(0x3c0))await logger[_0x5941ee(0x262)](_0x5941ee(0x26f)+_0x59a2b4+_0x5941ee(0x219)+_0x357961[_0x5941ee(0x1eb)]+_0x5941ee(0x304)+_0x357961['botname']),startBot([_0x357961[_0x5941ee(0x1eb)],userID],{'cwd':bbpath},function(_0x4b082d){const _0x92914f=_0x5941ee;if(_0x4b082d)logger[_0x92914f(0x262)](_0x4b082d);});else(_0x357961[_0x5941ee(0x3ae)]==_0x5941ee(0x319)||_0x357961[_0x5941ee(0x3ae)]==_0x5941ee(0x223))&&await logger['full'](_0x5941ee(0x23f)+_0x59a2b4+_0x5941ee(0x30e)+_0x357961['botID']+'\x20|\x20'+_0x357961[_0x5941ee(0x37b)]);}else!newBot&&logger['simple'](_0x5941ee(0x1b2));if(newBot)addBot();logger[_0x5941ee(0x32f)](_0x5941ee(0x2ad)),logger[_0x5941ee(0x32f)](''),await logger[_0x5941ee(0x315)](_0x5941ee(0x2f7)+nodeversion),await logger[_0x5941ee(0x315)]('Network\x20Interfaces:',_0x4502f2);}function startSocket(){const _0x5bf501=_0x2cf39b;io['on'](_0x5bf501(0x1cc),_0x286ecc=>{const _0xb58b56=_0x5bf501;let _0x58d02f,_0x4d60c0,_0x27fb4f,_0x1a53be,_0x44b6f1;const _0x3f192d=_0x286ecc[_0xb58b56(0x399)][_0xb58b56(0x337)][_0xb58b56(0x1a9)];_0x4d60c0=_0x3f192d[_0xb58b56(0x23c)](/bot[0-9]{3}/);if(_0x4d60c0)_0x27fb4f=_0x4d60c0[0x0]['match'](/[0-9]{3}/);if(_0x27fb4f)_0x58d02f=_0x27fb4f[0x0];else _0x58d02f=_0xb58b56(0x2b3);const _0xe96dc2=_0x286ecc['handshake'][_0xb58b56(0x355)][_0xb58b56(0x30a)];if(!_0xe96dc2)_0x286ecc[_0xb58b56(0x2a6)](_0xb58b56(0x3ae),{'publicKey':secure[_0xb58b56(0x335)]});else{_0x1a53be=timelyDecrypt(_0xe96dc2,![]);if(!_0x1a53be)_0x286ecc['emit'](_0xb58b56(0x3ae),{'publicKey':secure['publicKey']});else{_0x44b6f1=normalizeIP(_0x286ecc[_0xb58b56(0x226)][_0xb58b56(0x2a2)])[_0xb58b56(0x3c2)];if(!devices[_0x1a53be])devices[_0x1a53be]={'uuid':_0x1a53be,'access':{'token':null}};devices[_0x1a53be]['ip']=_0x44b6f1;const _0x3c510c=addClient(_0x286ecc['id'],_0x1a53be,_0x58d02f);setAccess(_0x3c510c),emitMessages(),_0x286ecc['on'](_0xb58b56(0x31c),_0x17a73f=>{const _0x4f2da9=_0xb58b56,_0x492d87=timelyDecrypt(_0x17a73f['password'],!![],_0x4f2da9(0x2c7));if(_0x492d87){_0x17a73f={'username':_0x17a73f[_0x4f2da9(0x1d2)],'password':_0x492d87},devices[_0x1a53be][_0x4f2da9(0x35f)]=validateCredentials(_0x17a73f,_0x1a53be);if(devices[_0x1a53be][_0x4f2da9(0x35f)][_0x4f2da9(0x39c)]==![]&&devices[_0x1a53be][_0x4f2da9(0x35f)]['reason']==_0x4f2da9(0x25f))_0x286ecc[_0x4f2da9(0x2a6)](_0x4f2da9(0x3ae),{'access':devices[_0x1a53be][_0x4f2da9(0x35f)]}),loginAccess2FA(_0x1a53be,_0x44b6f1);else{if(devices[_0x1a53be]['access'][_0x4f2da9(0x39c)]==![]&&devices[_0x1a53be][_0x4f2da9(0x35f)]['reason']==_0x4f2da9(0x1e6))_0x286ecc[_0x4f2da9(0x2a6)](_0x4f2da9(0x3ae),{'access':devices[_0x1a53be][_0x4f2da9(0x35f)]});else devices[_0x1a53be]['access'][_0x4f2da9(0x39c)]&&devices[_0x1a53be][_0x4f2da9(0x35f)]['reason']==_0x4f2da9(0x384)&&(getClientsWithUuid(_0x1a53be)[_0x4f2da9(0x2c2)](_0x20cd2b=>{setAccess(_0x20cd2b);}),logger[_0x4f2da9(0x315)](_0x4f2da9(0x2b0)+_0x1a53be[_0x4f2da9(0x1aa)](-0x8)),setTokenRefresh(_0x1a53be),setSessionTimeout('login',_0x1a53be));}}else logger[_0x4f2da9(0x262)](_0x4f2da9(0x1c7));}),_0x286ecc['on'](_0xb58b56(0x2ac),()=>{resetPassword();}),_0x286ecc['on']('disconnect',_0x31ab1f=>{removeClient(_0x286ecc['id']);}),_0x58d02f==_0xb58b56(0x2b3)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xc20dd8){const _0x32664=_0x2cf39b;if(_0xc20dd8!=_0x32664(0x2b3)&&config[_0x32664(0x20c)]!=''){if(pid[_0xc20dd8])pid[_0xc20dd8]['send']({'function':_0x32664(0x36c),'args':null});}_0xc20dd8!=_0x32664(0x2b3)&&broadcastToBots('bots',JSON['stringify'](config));}function reloadBotManager(){const _0x3492ae=_0x2cf39b;getClientsWithBotID(_0x3492ae(0x2b3))[_0x3492ae(0x2c2)](_0x43ee54=>{const _0x5ada89=_0x3492ae;getSocket(_0x43ee54['id'])[_0x5ada89(0x2a6)]('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x3b3dfd){const _0xc033c1=_0x2cf39b,_0x43a514=io['_nsps'][_0xc033c1(0x1fb)]('/');return _0x43a514[_0xc033c1(0x27e)]['get'](_0x3b3dfd);}function setAccess(_0x76e8d4){const _0x6f5cbe=_0x2cf39b,_0x15fd62=getSocket(_0x76e8d4['id']),_0x423321=_0x76e8d4[_0x6f5cbe(0x320)],_0x5a08ed=_0x76e8d4[_0x6f5cbe(0x2f2)];devices[_0x423321]['access']=validateAccess(devices[_0x423321][_0x6f5cbe(0x35f)]['token'],_0x423321),logger[_0x6f5cbe(0x315)](_0x6f5cbe(0x1bd)+devices[_0x423321][_0x6f5cbe(0x35f)][_0x6f5cbe(0x30b)]+_0x6f5cbe(0x286)+_0x76e8d4['id'][_0x6f5cbe(0x1aa)](-0x8)+_0x6f5cbe(0x1f7)+_0x423321[_0x6f5cbe(0x1aa)](-0x8)),_0x15fd62['join'](_0x423321);if(devices[_0x423321]['access'][_0x6f5cbe(0x39c)]){_0x15fd62['join'](_0x5a08ed);if(_0x5a08ed==_0x6f5cbe(0x2b3))initializeSocketBotManager(_0x15fd62);else initializeSocketBot(_0x15fd62);initClient(_0x5a08ed);}devices[_0x423321][_0x6f5cbe(0x35f)][_0x6f5cbe(0x3a5)]&&devices[_0x423321][_0x6f5cbe(0x35f)][_0x6f5cbe(0x30b)]==_0x6f5cbe(0x23e)&&setSessionTimeout(_0x6f5cbe(0x3a1),_0x423321),devices[_0x423321][_0x6f5cbe(0x35f)]['token']&&devices[_0x423321]['access']['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x6f5cbe(0x31c),_0x423321),_0x15fd62[_0x6f5cbe(0x2a6)](_0x6f5cbe(0x3ae),{'status':_0x76e8d4['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x423321]['access'],'externalip':devices[_0x423321]['ip'],'publicKey':secure[_0x6f5cbe(0x335)],'userid':settings[_0x6f5cbe(0x259)],'validInstallation':validInstallation}),devices[_0x423321][_0x6f5cbe(0x35f)][_0x6f5cbe(0x39c)]==![]&&devices[_0x423321][_0x6f5cbe(0x35f)][_0x6f5cbe(0x30b)]==_0x6f5cbe(0x1de)&&temporaryAccess2FA(_0x423321,devices[_0x423321]['ip']);}function setSessionTimeout(_0x213e30,_0x159978){const _0x26fa3c=_0x2cf39b;let _0x1e4652;if(_0x213e30==_0x26fa3c(0x31c))_0x1e4652=loginExpiry*0x3c*0x3e8;else _0x1e4652=devices[_0x159978][_0x26fa3c(0x267)][_0x26fa3c(0x238)]*0x3c*0x3e8-(new Date()[_0x26fa3c(0x328)]()-devices[_0x159978][_0x26fa3c(0x267)][_0x26fa3c(0x2c1)]);if(devices[_0x159978][_0x26fa3c(0x37d)])clearTimeout(devices[_0x159978][_0x26fa3c(0x37d)]);devices[_0x159978]['pidExpireLogin']=setTimeout(()=>{const _0x2160f7=_0x26fa3c;if(devices[_0x159978][_0x2160f7(0x31d)])clearTimeout(devices[_0x159978]['pidRefreshToken']);removeSocketListeners(_0x159978),addBlacklist(_0x159978),devices[_0x159978]['telegramIpApproval']=null,devices[_0x159978][_0x2160f7(0x1db)]=null,devices[_0x159978][_0x2160f7(0x35f)][_0x2160f7(0x3a5)]=null,logger[_0x2160f7(0x315)](_0x2160f7(0x1c5)+_0x159978[_0x2160f7(0x1aa)](-0x8)),devices[_0x159978]['access']=validateAccess(devices[_0x159978][_0x2160f7(0x35f)][_0x2160f7(0x3a5)],_0x159978),!(devices[_0x159978]['access'][_0x2160f7(0x39c)]&&devices[_0x159978][_0x2160f7(0x35f)][_0x2160f7(0x30b)]=='login\x20not\x20required')&&(_0x213e30==_0x2160f7(0x31c)?io['to'](_0x159978)[_0x2160f7(0x2a6)](_0x2160f7(0x3ae),{'access':{'allow':![],'reason':_0x2160f7(0x29d),'token':null}}):io['to'](_0x159978)[_0x2160f7(0x2a6)](_0x2160f7(0x3ae),{'access':{'allow':![],'reason':_0x2160f7(0x2c9),'token':null}})),devices[_0x159978]['access']['token']=null;},_0x1e4652);}function setTokenRefresh(_0xfba355){const _0x393331=_0x2cf39b;if(devices[_0xfba355]['pidRefreshToken'])clearTimeout(devices[_0xfba355]['pidRefreshToken']);devices[_0xfba355][_0x393331(0x31d)]=setTimeout(()=>{const _0xa498a7=_0x393331;getClientsWithUuid(_0xfba355)['length']!=0x0?(devices[_0xfba355]['access']=refreshToken(_0xfba355),io['to'](_0xfba355)[_0xa498a7(0x2a6)](_0xa498a7(0x3ae),{'status':_0xa498a7(0x2ed),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xfba355][_0xa498a7(0x35f)],'externalip':devices[_0xfba355]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0xfba355)):clearTimeout(devices[_0xfba355]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x47328b){const _0x30ac4e=_0x2cf39b,_0xb8904e=getClient(_0x47328b['id'])[_0x30ac4e(0x320)];_0x47328b[_0x30ac4e(0x2a6)](_0x30ac4e(0x3a6),config),_0x47328b['emit'](_0x30ac4e(0x232),cleanSettings()),_0x47328b['on'](_0x30ac4e(0x1a6),_0x3da121=>{const _0x311a76=_0x30ac4e;if(validateAccess(_0x3da121,_0xb8904e)[_0x311a76(0x39c)])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x47328b['on']('update-bot',(_0x1f8515,_0x19dd8b)=>{const _0x30276b=_0x30ac4e;if(validateAccess(_0x19dd8b,_0xb8904e)[_0x30276b(0x39c)])toggleBot(_0x1f8515['botID'],_0x1f8515['status'],_0x1f8515[_0x30276b(0x1cb)]);else logger['full'](_0x30276b(0x2e2));}),_0x47328b['on'](_0x30ac4e(0x321),(_0x13d8fb,_0x5813ad)=>{const _0x504ef0=_0x30ac4e;if(validateAccess(_0x5813ad,_0xb8904e)[_0x504ef0(0x39c)])toggleBotMode(_0x13d8fb);else logger[_0x504ef0(0x262)](_0x504ef0(0x2e2));}),_0x47328b['on'](_0x30ac4e(0x2e1),(_0x2084d9,_0x3076d1)=>{const _0x51a69b=_0x30ac4e;if(validateAccess(_0x3076d1,_0xb8904e)['allow'])deleteBot(_0x2084d9);else logger['full'](_0x51a69b(0x1b1));}),_0x47328b['on'](_0x30ac4e(0x280),(_0x2d3ce4,_0x1ec926)=>{const _0x1e3abf=_0x30ac4e;if(validateAccess(_0x1ec926,_0xb8904e)['allow'])storeSettings(_0x2d3ce4,!![]);else logger[_0x1e3abf(0x262)](_0x1e3abf(0x2a4));}),_0x47328b['on'](_0x30ac4e(0x2fc),_0x3bb03c=>{const _0x36f735=_0x30ac4e;if(validateAccess(_0x3bb03c,_0xb8904e)[_0x36f735(0x39c)])updateBB('update');else logger['full'](_0x36f735(0x36e));}),_0x47328b['on'](_0x30ac4e(0x322),_0x359748=>{const _0x23af46=_0x30ac4e;if(validateAccess(_0x359748,_0xb8904e)[_0x23af46(0x39c)])updateBB(_0x23af46(0x229));else logger['full']('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x47328b['on']('get-backup-files',_0x24ee56=>{const _0xe85a70=_0x30ac4e;if(validateAccess(_0x24ee56,_0xb8904e)[_0xe85a70(0x39c)]){const _0x4f8070=getClient(_0x47328b['id']);if(_0x4f8070)getBackupFiles(_0x4f8070[_0xe85a70(0x320)]);else logger['full'](_0xe85a70(0x3aa));}else logger[_0xe85a70(0x262)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x47328b['on']('restore-backup-file',(_0x43b78d,_0x25858c)=>{const _0x3f5f6a=_0x30ac4e;if(validateAccess(_0x25858c,_0xb8904e)[_0x3f5f6a(0x39c)])restoreBackupFile(_0x43b78d);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x47328b['on']('get-messages',_0x4550de=>{const _0x4d4270=_0x30ac4e;if(validateAccess(_0x4550de,_0xb8904e)[_0x4d4270(0x39c)])getMessages();else logger[_0x4d4270(0x262)](_0x4d4270(0x3ab));}),_0x47328b['on'](_0x30ac4e(0x292),(_0x4bb3fe,_0xa2bc4f)=>{const _0x1ac507=_0x30ac4e;if(validateAccess(_0xa2bc4f,_0xb8904e)[_0x1ac507(0x39c)])confirmMessage(_0x4bb3fe);else logger[_0x1ac507(0x262)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x47328b['on']('logout',_0x3390c6=>{const _0xd49f5a=_0x30ac4e;if(validateAccess(_0x3390c6,_0xb8904e)[_0xd49f5a(0x39c)]){if(devices[_0xb8904e]['pidRefreshToken'])clearTimeout(devices[_0xb8904e][_0xd49f5a(0x31d)]);if(devices[_0xb8904e][_0xd49f5a(0x37d)])clearTimeout(devices[_0xb8904e][_0xd49f5a(0x37d)]);removeSocketListeners(getClient(_0x47328b['id'])[_0xd49f5a(0x320)]),addBlacklist(_0xb8904e),devices[_0xb8904e][_0xd49f5a(0x267)]=null,devices[_0xb8904e]['telegram2FaApproval']=null,devices[_0xb8904e]['access'][_0xd49f5a(0x3a5)]=null,logger[_0xd49f5a(0x315)](_0xd49f5a(0x3c4)+_0xb8904e[_0xd49f5a(0x1aa)](-0x8)),io['to'](getClient(_0x47328b['id'])[_0xd49f5a(0x320)])['emit'](_0xd49f5a(0x3ae),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0xd49f5a(0x262)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x4949df){const _0x4bfdbd=_0x2cf39b,_0xfc2b48=getClient(_0x4949df['id'])[_0x4bfdbd(0x2f2)],_0x315e29=getClient(_0x4949df['id'])[_0x4bfdbd(0x320)];_0x4949df['on'](_0x4bfdbd(0x2fb),(_0xb2080e,_0xe2e1ab)=>{const _0x284b29=_0x4bfdbd;if(validateAccess(_0xe2e1ab,_0x315e29)[_0x284b29(0x39c)]){if(pid[_0xfc2b48])pid[_0xfc2b48][_0x284b29(0x2bd)]({'function':_0x284b29(0x258),'args':_0xb2080e});}else logger[_0x284b29(0x262)](_0x284b29(0x32d));}),_0x4949df['on']('delete-alerts',(_0x50a9cf,_0xcf891)=>{const _0x8a2e8=_0x4bfdbd;if(validateAccess(_0xcf891,_0x315e29)['allow']){if(pid[_0xfc2b48])pid[_0xfc2b48][_0x8a2e8(0x2bd)]({'function':_0x8a2e8(0x25a),'args':_0x50a9cf});}else logger[_0x8a2e8(0x262)](_0x8a2e8(0x272));}),_0x4949df['on'](_0x4bfdbd(0x35c),(_0x3b27a0,_0x15b5cf)=>{const _0x2a6140=_0x4bfdbd;if(validateAccess(_0x15b5cf,_0x315e29)[_0x2a6140(0x39c)]){if(pid[_0xfc2b48])pid[_0xfc2b48]['send']({'function':_0x2a6140(0x261),'args':_0x3b27a0});}else logger[_0x2a6140(0x262)](_0x2a6140(0x2ea));}),_0x4949df['on']('store-configuration',(_0xcb9d1a,_0x50dc90)=>{const _0x5b7ca5=_0x4bfdbd;if(validateAccess(_0x50dc90,_0x315e29)[_0x5b7ca5(0x39c)]){if(pid[_0xfc2b48])pid[_0xfc2b48][_0x5b7ca5(0x2bd)]({'function':_0x5b7ca5(0x1d0),'args':_0xcb9d1a});}else logger[_0x5b7ca5(0x262)](_0x5b7ca5(0x279));}),_0x4949df['on']('store-headless',(_0xe46e1d,_0x547be6)=>{const _0x3c62b8=_0x4bfdbd;if(validateAccess(_0x547be6,_0x315e29)['allow']){if(pid[_0xfc2b48])pid[_0xfc2b48]['send']({'function':'storeHeadless','args':_0xe46e1d});}else logger[_0x3c62b8(0x262)](_0x3c62b8(0x288));}),_0x4949df['on']('store-fiat',(_0xc76696,_0x4ac7aa)=>{const _0xa11251=_0x4bfdbd;if(validateAccess(_0x4ac7aa,_0x315e29)[_0xa11251(0x39c)]){if(pid[_0xfc2b48])pid[_0xfc2b48][_0xa11251(0x2bd)]({'function':'storeFiat','args':_0xc76696});}else logger[_0xa11251(0x262)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x4949df['on'](_0x4bfdbd(0x283),_0x281bcd=>{const _0x4eca86=_0x4bfdbd;if(validateAccess(_0x281bcd,_0x315e29)['allow']){if(pid[_0xfc2b48])pid[_0xfc2b48]['send']({'function':_0x4eca86(0x380),'args':null});}else logger[_0x4eca86(0x262)](_0x4eca86(0x364));}),_0x4949df['on'](_0x4bfdbd(0x25e),_0x49d3f0=>{const _0x4d9c31=_0x4bfdbd;if(validateAccess(_0x49d3f0,_0x315e29)[_0x4d9c31(0x39c)]){if(pid[_0xfc2b48])pid[_0xfc2b48][_0x4d9c31(0x2bd)]({'function':_0x4d9c31(0x1b6),'args':null});}else logger[_0x4d9c31(0x262)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x4949df['on'](_0x4bfdbd(0x295),(_0x42dedb,_0x7993a5)=>{const _0x59bc46=_0x4bfdbd;if(validateAccess(_0x7993a5,_0x315e29)[_0x59bc46(0x39c)]){if(pid[_0xfc2b48])pid[_0xfc2b48][_0x59bc46(0x2bd)]({'function':'placeOrder','args':_0x42dedb});}else logger[_0x59bc46(0x262)](_0x59bc46(0x3af));}),_0x4949df['on'](_0x4bfdbd(0x38f),_0x230042=>{const _0x55134d=_0x4bfdbd;if(validateAccess(_0x230042,_0x315e29)[_0x55134d(0x39c)]){if(pid[_0xfc2b48])pid[_0xfc2b48][_0x55134d(0x2bd)]({'function':_0x55134d(0x2bf),'args':null});}else logger[_0x55134d(0x262)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x4949df['on'](_0x4bfdbd(0x24e),_0x4a0280=>{const _0x4c8808=_0x4bfdbd;if(validateAccess(_0x4a0280,_0x315e29)[_0x4c8808(0x39c)]){if(pid[_0xfc2b48])pid[_0xfc2b48][_0x4c8808(0x2bd)]({'function':_0x4c8808(0x373),'args':null});}else logger[_0x4c8808(0x262)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x4949df['on'](_0x4bfdbd(0x2fc),_0x57db04=>{const _0x150722=_0x4bfdbd;if(validateAccess(_0x57db04,_0x315e29)[_0x150722(0x39c)])updateBB(_0x150722(0x2b7));else logger[_0x150722(0x262)](_0x150722(0x36e));}),_0x4949df['on'](_0x4bfdbd(0x381),_0x458f14=>{const _0x45a832=_0x4bfdbd;if(validateAccess(_0x458f14,_0x315e29)[_0x45a832(0x39c)])getMessages();else logger[_0x45a832(0x262)](_0x45a832(0x3ab));}),_0x4949df['on'](_0x4bfdbd(0x292),(_0x514d24,_0x4911c4)=>{const _0x508889=_0x4bfdbd;if(validateAccess(_0x4911c4,_0x315e29)[_0x508889(0x39c)])confirmMessage(_0x514d24);else logger[_0x508889(0x262)](_0x508889(0x346));}),_0x4949df['on']('logout',_0x1b4953=>{const _0x5f80fc=_0x4bfdbd;if(validateAccess(_0x1b4953,_0x315e29)['allow']){if(devices[_0x315e29][_0x5f80fc(0x31d)])clearTimeout(devices[_0x315e29][_0x5f80fc(0x31d)]);if(devices[_0x315e29]['pidExpireLogin'])clearTimeout(devices[_0x315e29][_0x5f80fc(0x37d)]);removeSocketListeners(getClient(_0x4949df['id'])[_0x5f80fc(0x320)]),addBlacklist(_0x315e29),devices[_0x315e29][_0x5f80fc(0x267)]=null,devices[_0x315e29][_0x5f80fc(0x1db)]=null,devices[_0x315e29]['access'][_0x5f80fc(0x3a5)]=null,logger[_0x5f80fc(0x315)](_0x5f80fc(0x3c4)+_0x315e29[_0x5f80fc(0x1aa)](-0x8)),io['to'](getClient(_0x4949df['id'])[_0x5f80fc(0x320)])['emit'](_0x5f80fc(0x3ae),{'access':{'allow':![],'reason':_0x5f80fc(0x2a9),'token':null}});}else logger[_0x5f80fc(0x262)](_0x5f80fc(0x2cd));});}function removeSocketListeners(_0x6a2cda){const _0x2ceae1=_0x2cf39b;getClientsWithUuid(_0x6a2cda)[_0x2ceae1(0x2c2)](_0x2bc84b=>{const _0xcdd59a=_0x2ceae1;getSocket(_0x2bc84b['id'])[_0xcdd59a(0x218)]();});}function cleanSettings(){const _0x17536f=_0x2cf39b;let _0xef38cd=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0xef38cd={..._0xef38cd,'telegramToken':_0x17536f(0x207)}),settings[_0x17536f(0x1f4)]&&settings['bbPassword']!=''&&(_0xef38cd={..._0xef38cd,'bbPassword':'************'}),settings[_0x17536f(0x21a)]&&settings['marketcapApi']!=''&&(_0xef38cd={..._0xef38cd,'marketcapApi':_0x17536f(0x207)}),(settings[_0x17536f(0x1f4)]&&settings[_0x17536f(0x1f4)]==_0x17536f(0x3b4)||settings['telegramToken']&&settings[_0x17536f(0x233)]==_0x17536f(0x3b4)||settings[_0x17536f(0x21a)]&&settings['marketcapApi']==_0x17536f(0x3b4))&&(_0xef38cd={..._0xef38cd,'restored':{'password':settings[_0x17536f(0x1f4)]==_0x17536f(0x3b4),'telegram':settings[_0x17536f(0x233)]==_0x17536f(0x3b4),'marketcap':settings['marketcapApi']=='***'}}),_0xef38cd;}async function updateBB(_0x7b9f08){const _0x4c7d78=_0x2cf39b;await backupConfigFiles(),installingUpdate=!![],config[_0x4c7d78(0x2c2)](_0x52682d=>{restartBot(_0x52682d['botID']);});if(_0x7b9f08=='update')process[_0x4c7d78(0x2bd)]({'update':!![],'environment':environment},_0x362cd7=>{});else _0x7b9f08==_0x4c7d78(0x229)&&process[_0x4c7d78(0x2bd)]({'reinstall':!![],'environment':environment},_0x2f8381=>{});}function startBot(_0x1376f6,_0x147afe,_0x3edbd7){const _0x356fcd=_0x2cf39b;if(debugging)_0x1376f6[_0x356fcd(0x1e0)]('-d');if(recreate)_0x1376f6[_0x356fcd(0x1e0)]('-r');let _0x549762=![];const _0xbad4b5=_0x1376f6[0x0];_0x147afe={..._0x147afe,'stdio':['inherit',_0x356fcd(0x390),_0x356fcd(0x390),_0x356fcd(0x3a0)]},pid[_0xbad4b5]=childProcess[_0x356fcd(0x2a7)](botfile,_0x1376f6,_0x147afe),pid[_0xbad4b5]['on'](_0x356fcd(0x365),_0x54d412=>{const _0x1b66e3=_0x356fcd;switch(Object['keys'](_0x54d412)[0x0]){case _0x1b66e3(0x37b):updateBotName(_0xbad4b5,_0x54d412[_0x1b66e3(0x37b)]);break;case _0x1b66e3(0x271):updateBotManager();break;case _0x1b66e3(0x3ae):updateStatus(_0xbad4b5,_0x54d412['status']);break;case _0x1b66e3(0x1cb):updateLive(_0xbad4b5,_0x54d412[_0x1b66e3(0x1cb)]);break;case _0x1b66e3(0x386):updateLive(_0xbad4b5,_0x54d412[_0x1b66e3(0x386)]),io['to'](_0xbad4b5)['emit'](_0x1b66e3(0x3ae),{'access':{'allow':![],'reason':_0x1b66e3(0x38d),'token':null}});break;case'stop':_0x54d412['stop']==_0x1b66e3(0x324)&&restartBot(_0xbad4b5);_0x54d412[_0x1b66e3(0x327)]==_0x1b66e3(0x2d5)&&toggleBot(_0xbad4b5,'disabled','stopped');break;case _0x1b66e3(0x2af):sendTelegramBot(_0xbad4b5,_0x54d412[_0x1b66e3(0x2af)]);break;case _0x1b66e3(0x308):sendTelegramMsg(_0x54d412[_0x1b66e3(0x308)]);break;case _0x1b66e3(0x2cf):io['to'](_0xbad4b5)[_0x1b66e3(0x2a6)](_0x54d412[_0x1b66e3(0x2cf)],_0x54d412[_0x1b66e3(0x370)]);break;}}),pid[_0xbad4b5]['on'](_0x356fcd(0x3ac),function(_0xf96179){if(_0x549762)return;_0x549762=!![],_0x3edbd7(_0xf96179);}),pid[_0xbad4b5]['on'](_0x356fcd(0x1ec),async function(_0xcd8562){const _0x1c4ec4=_0x356fcd;if(terminating)return;if(installingUpdate){io['close']();return;}if(_0x549762)return;_0x549762=!![],_0x3edbd7(null);const _0x3c5b8f=dbConfig[_0x1c4ec4(0x1fb)](_0x1c4ec4(0x3a6))[_0x1c4ec4(0x398)]({'botID':_0xbad4b5})[_0x1c4ec4(0x1da)]();_0x3c5b8f&&(_0x3c5b8f[_0x1c4ec4(0x3ae)]==_0x1c4ec4(0x1ba)||_0x3c5b8f[_0x1c4ec4(0x3ae)]==_0x1c4ec4(0x3c0))&&(await sleep(0x3e8),updateLive(_0xbad4b5,'stopped'),logger[_0x1c4ec4(0x262)]('Restarting\x20Bot\x20'+_0xbad4b5),startBot([_0xbad4b5,userID],{'cwd':bbpath},function(_0x53d115){const _0xd2fbe0=_0x1c4ec4;if(_0x53d115)logger[_0xd2fbe0(0x262)](_0x53d115);}));});}function stopBot(_0x368a72){const _0x3e84dd=_0x2cf39b;getClientsWithBotID(_0x368a72)[_0x3e84dd(0x2c2)](_0x1f727b=>{getSocket(_0x1f727b['id'])['disconnect'](!![]),removeClient(_0x1f727b['id']);}),pid[_0x368a72]&&(pid[_0x368a72]['kill'](),pid[_0x368a72]=null);}function stopAllBots(){const _0x15bf0d=_0x2cf39b;terminating=!![];const _0x4cc165=getEnabledBots();_0x4cc165[_0x15bf0d(0x2c2)](_0x3ea4a4=>{const _0x16157c=_0x15bf0d;stopBot(_0x3ea4a4[_0x16157c(0x1eb)]);});}function restartBot(_0x20b9e0){if(pid[_0x20b9e0])pid[_0x20b9e0]['kill']();}function addBot(){const _0x1682c0=_0x2cf39b;let _0x1a2ed1;for(let _0x1cdc73=0x1;_0x1cdc73<0x3e9;_0x1cdc73++){_0x1a2ed1=_0x1cdc73['toString']()[_0x1682c0(0x38b)](0x3,'0');let _0x5a860f=config[_0x1682c0(0x398)](_0x460fe2=>_0x460fe2[_0x1682c0(0x1eb)]==_0x1a2ed1);if(!_0x5a860f)break;}if(_0x1a2ed1===_0x1682c0(0x1ac)){logger[_0x1682c0(0x262)](_0x1682c0(0x39d));return;}logger['full'](_0x1682c0(0x213)+_0x1a2ed1),dbConfig[_0x1682c0(0x1fb)](_0x1682c0(0x3a6))[_0x1682c0(0x1e0)]({'botID':_0x1a2ed1,'botname':_0x1682c0(0x347)+_0x1a2ed1,'status':_0x1682c0(0x3c0),'live':''})[_0x1682c0(0x1c2)](),startBot([_0x1a2ed1,userID],{'cwd':bbpath},function(_0x31d2e4){if(_0x31d2e4)logger['full'](_0x31d2e4);}),config=getConfiguration(),io['to'](_0x1682c0(0x2b3))[_0x1682c0(0x2a6)](_0x1682c0(0x3a6),config),broadcastToBots(_0x1682c0(0x3a6),JSON['stringify'](config));}function deleteBot(_0x3d40d4){const _0x30cdf4=_0x2cf39b;getClientsWithBotID(_0x3d40d4)['forEach'](_0xdacda2=>{const _0x1ad11a=_0x3e11;getSocket(_0xdacda2['id'])[_0x1ad11a(0x2f1)](!![]),removeClient(_0xdacda2['id']);}),dbConfig[_0x30cdf4(0x1fb)](_0x30cdf4(0x3a6))[_0x30cdf4(0x34a)]({'botID':_0x3d40d4})[_0x30cdf4(0x1c2)](),logger[_0x30cdf4(0x262)](_0x30cdf4(0x22f)+_0x3d40d4),stopBot(_0x3d40d4);try{if(fs[_0x30cdf4(0x268)](path[_0x30cdf4(0x385)](configpath,_0x30cdf4(0x257)+_0x3d40d4+_0x30cdf4(0x32c))))fs[_0x30cdf4(0x236)](path[_0x30cdf4(0x385)](configpath,'bot-'+_0x3d40d4+'-config.json'));if(fs['existsSync'](path[_0x30cdf4(0x385)](configpath,'bot-'+_0x3d40d4+_0x30cdf4(0x2a1))))fs[_0x30cdf4(0x236)](path[_0x30cdf4(0x385)](configpath,_0x30cdf4(0x257)+_0x3d40d4+_0x30cdf4(0x2a1)));if(fs[_0x30cdf4(0x268)](path[_0x30cdf4(0x385)](configpath,_0x30cdf4(0x257)+_0x3d40d4+_0x30cdf4(0x203))))fs['unlinkSync'](path[_0x30cdf4(0x385)](configpath,'bot-'+_0x3d40d4+_0x30cdf4(0x203)));if(fs[_0x30cdf4(0x268)](path['join'](configpath,_0x30cdf4(0x257)+_0x3d40d4+_0x30cdf4(0x2d8))))fs[_0x30cdf4(0x236)](path[_0x30cdf4(0x385)](configpath,_0x30cdf4(0x257)+_0x3d40d4+_0x30cdf4(0x2d8)));}catch(_0x194bfe){if(_0x194bfe)logger['full'](_0x30cdf4(0x1d6),_0x194bfe);}config=getConfiguration(),io['to'](_0x30cdf4(0x2b3))[_0x30cdf4(0x2a6)](_0x30cdf4(0x3a6),config),broadcastToBots(_0x30cdf4(0x3a6),JSON[_0x30cdf4(0x359)](config));}function _0x3e11(_0x1d0a63,_0xf202a){const _0x1a6356=_0x29f5();return _0x3e11=function(_0x2677eb,_0x4e7632){_0x2677eb=_0x2677eb-0x1a6;let _0x29f5e4=_0x1a6356[_0x2677eb];return _0x29f5e4;},_0x3e11(_0x1d0a63,_0xf202a);}function toggleBot(_0x5cfdec,_0x53079c,_0x56e470){const _0x20073d=_0x2cf39b;dbConfig['get'](_0x20073d(0x3a6))[_0x20073d(0x398)]({'botID':_0x5cfdec})[_0x20073d(0x1b5)]({'status':_0x53079c})[_0x20073d(0x1b5)]({'live':_0x56e470})[_0x20073d(0x1c2)]();if(_0x53079c=='enabled'||_0x53079c==_0x20073d(0x3c0))logger[_0x20073d(0x262)](_0x20073d(0x3b7)+_0x5cfdec),startBot([_0x5cfdec,userID],{'cwd':bbpath},function(_0x13cb80){const _0x4fd0a4=_0x20073d;if(_0x13cb80)logger[_0x4fd0a4(0x262)](_0x13cb80);});else(_0x53079c==_0x20073d(0x319)||_0x53079c=='new-disabled')&&(logger[_0x20073d(0x262)](_0x20073d(0x3b9)+_0x5cfdec),stopBot(_0x5cfdec));config=getConfiguration(),io['to'](_0x20073d(0x2b3))[_0x20073d(0x2a6)]('bots',config),broadcastToBots(_0x20073d(0x3a6),JSON[_0x20073d(0x359)](config));}function toggleStatus(_0x1d993b){const _0x2262c9=_0x2cf39b;let _0x31415f=dbConfig['get'](_0x2262c9(0x3a6))['find']({'botID':_0x1d993b})['value'](),_0x2f5bda;if(_0x31415f['status']===_0x2262c9(0x1ba))_0x2f5bda=_0x2262c9(0x319);else{if(_0x31415f[_0x2262c9(0x3ae)]===_0x2262c9(0x3c0))_0x2f5bda=_0x2262c9(0x223);else{if(_0x31415f[_0x2262c9(0x3ae)]==='new-disabled')_0x2f5bda=_0x2262c9(0x3c0);else{if(_0x31415f[_0x2262c9(0x3ae)]===_0x2262c9(0x319))_0x2f5bda='enabled';}}}return _0x2f5bda;}function updateStatus(_0x24224d,_0x3f69ce){const _0x19c54c=_0x2cf39b;dbConfig[_0x19c54c(0x1fb)]('bots')['find']({'botID':_0x24224d})[_0x19c54c(0x1b5)]({'status':_0x3f69ce})[_0x19c54c(0x1c2)](),config=getConfiguration(),io['to'](_0x19c54c(0x2b3))[_0x19c54c(0x2a6)](_0x19c54c(0x3a6),config),broadcastToBots(_0x19c54c(0x3a6),JSON[_0x19c54c(0x359)](config));}function updateLive(_0x340218,_0x225638){const _0x601813=_0x2cf39b;dbConfig[_0x601813(0x1fb)](_0x601813(0x3a6))[_0x601813(0x398)]({'botID':_0x340218})[_0x601813(0x1b5)]({'live':_0x225638})[_0x601813(0x1c2)](),config=getConfiguration(),io['to'](_0x601813(0x2b3))[_0x601813(0x2a6)]('bots',config),broadcastToBots(_0x601813(0x3a6),JSON[_0x601813(0x359)](config));}function updateBotName(_0x5b9c31,_0x3d8d0c){const _0x37aa2e=_0x2cf39b;dbConfig['get']('bots')['find']({'botID':_0x5b9c31})[_0x37aa2e(0x1b5)]({'botname':_0x3d8d0c})[_0x37aa2e(0x1c2)](),config=getConfiguration(),io['to'](_0x37aa2e(0x2b3))[_0x37aa2e(0x2a6)]('bots',config),broadcastToBots(_0x37aa2e(0x3a6),JSON[_0x37aa2e(0x359)](config));}function updateBotManager(){const _0x3f6a50=_0x2cf39b;config=getConfiguration(),io['to'](_0x3f6a50(0x2b3))[_0x3f6a50(0x2a6)](_0x3f6a50(0x3a6),config),broadcastToBots(_0x3f6a50(0x3a6),JSON[_0x3f6a50(0x359)](config));}function toggleBotMode(_0x15db01){const _0x50b659=_0x2cf39b;if(pid[_0x15db01])pid[_0x15db01][_0x50b659(0x2bd)]({'function':_0x50b659(0x2d2),'args':null});else{const _0x349d83=configpath+_0x50b659(0x257)+_0x15db01+_0x50b659(0x32c),_0x32f579=fs[_0x50b659(0x20d)](_0x349d83),_0x2a774b=JSON[_0x50b659(0x395)](_0x32f579),_0x41b890=_0x2a774b['bot'][0x0][_0x50b659(0x2d4)];_0x2a774b[_0x50b659(0x2f2)][0x0]['headless']=!_0x41b890;const _0x246a4b=JSON[_0x50b659(0x359)](_0x2a774b,null,0x2);fs[_0x50b659(0x1f3)](_0x349d83,_0x246a4b),config=getConfiguration(),io['to'](_0x50b659(0x2b3))[_0x50b659(0x2a6)](_0x50b659(0x3a6),config),broadcastToBots(_0x50b659(0x3a6),JSON[_0x50b659(0x359)](config));}}function validateTelegram(_0x1f938c){const _0x58f3bb=_0x2cf39b;if(_0x1f938c['from'][_0x58f3bb(0x1d2)]!=settings[_0x58f3bb(0x1bb)]&&'@'+_0x1f938c[_0x58f3bb(0x353)]['username']!=settings[_0x58f3bb(0x1bb)]||_0x1f938c[_0x58f3bb(0x2e6)]['id']!=settings['telegramChatId'])return sendTelegram(_0x1f938c[_0x58f3bb(0x2e6)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x58f3bb(0x1f0)}),![];return!![];}async function initTelegram(){const _0x10ce36=_0x2cf39b;tgBot&&(await tgBot[_0x10ce36(0x327)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x10ce36(0x233)]);let _0x34d85d='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x34d85d+='\x0a',_0x34d85d+=_0x10ce36(0x2be),_0x34d85d+=_0x10ce36(0x287),_0x34d85d+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x34d85d+=_0x10ce36(0x306),_0x34d85d+='/on\x20-\x20start\x20bot(s)\x0a',_0x34d85d+=_0x10ce36(0x217),_0x34d85d+=_0x10ce36(0x3bd),_0x34d85d+='/names\x20-\x20show\x20bot\x20names\x0a',_0x34d85d+=_0x10ce36(0x1ca),_0x34d85d+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x34d85d+=_0x10ce36(0x2f3),_0x34d85d+=_0x10ce36(0x1cd),_0x34d85d+=_0x10ce36(0x392),_0x34d85d+=_0x10ce36(0x3c3),_0x34d85d+=_0x10ce36(0x2e4),_0x34d85d+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x51ba99='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x51ba99+='\x0a',_0x51ba99+=_0x34d85d,tgBot[_0x10ce36(0x35a)]((_0x402bae,_0x4c55fc)=>{const _0xa0a543=_0x10ce36;logger['simple'](getTimeStamp()+_0xa0a543(0x2b5)),logger['debug'](_0xa0a543(0x1c1),_0x402bae);}),tgBot[_0x10ce36(0x26b)](async(_0x53d002,_0x5bc978)=>{const _0x566457=_0x10ce36;if(settings[_0x566457(0x201)]||_0x53d002[_0x566457(0x2b7)][_0x566457(0x365)]['text']!=_0x566457(0x1ea)){if(!validateTelegram(_0x53d002))return;}_0x5bc978();}),tgBot['command'](_0x10ce36(0x302),async _0x2f7bd0=>{const _0x1683a4=_0x10ce36;if(_0x2f7bd0[_0x1683a4(0x353)][_0x1683a4(0x1d2)]==settings[_0x1683a4(0x1bb)]||'@'+_0x2f7bd0[_0x1683a4(0x353)][_0x1683a4(0x1d2)]==settings[_0x1683a4(0x1bb)]){if(!settings['telegramChatId'])updateSetting(_0x1683a4(0x201),_0x2f7bd0[_0x1683a4(0x2e6)]['id']);else{if(!validateTelegram(_0x2f7bd0))return;}}else{if(!validateTelegram(_0x2f7bd0))return;}updateSetting('telegramEnabled',!![]),await sendTelegram(_0x2f7bd0['chat']['id'],_0x51ba99);}),tgBot[_0x10ce36(0x32a)](_0x10ce36(0x250),async _0x3bcfbe=>{const _0x4346c6=_0x10ce36;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x3bcfbe[_0x4346c6(0x2e6)]['id'],_0x4346c6(0x343));}),tgBot[_0x10ce36(0x32a)](_0x10ce36(0x2ae),async _0x397c81=>{const _0x3973ea=_0x10ce36;await sendTelegram(_0x397c81[_0x3973ea(0x2e6)]['id'],'Notifications\x20disabled'),updateSetting('telegramEnabled',![]);}),tgBot[_0x10ce36(0x32a)](_0x10ce36(0x2aa),async _0x3b6316=>{const _0x58d5e2=_0x10ce36,_0x1905e4=Markup[_0x58d5e2(0x361)]([Markup[_0x58d5e2(0x208)][_0x58d5e2(0x3a9)](_0x58d5e2(0x316),'config_orders'),Markup[_0x58d5e2(0x208)][_0x58d5e2(0x3a9)](_0x58d5e2(0x1e9),_0x58d5e2(0x260)),Markup['button'][_0x58d5e2(0x3a9)](_0x58d5e2(0x22d),_0x58d5e2(0x227))]);_0x3b6316[_0x58d5e2(0x2ef)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x1905e4);}),tgBot[_0x10ce36(0x22a)]('config_orders',async _0x14868b=>{const _0x1778ed=_0x10ce36;_0x14868b[_0x1778ed(0x2e3)](),updateSetting(_0x1778ed(0x33b),_0x1778ed(0x34c)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x14868b[_0x1778ed(0x2e6)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot['action'](_0x10ce36(0x260),async _0x29931c=>{const _0xde4358=_0x10ce36;_0x29931c[_0xde4358(0x2e3)](),updateSetting(_0xde4358(0x33b),_0xde4358(0x369)),updateSetting(_0xde4358(0x1ed),!![]),await sendTelegram(_0x29931c[_0xde4358(0x2e6)]['id'],_0xde4358(0x20b));}),tgBot[_0x10ce36(0x22a)]('config_all',async _0x1ad40c=>{const _0x292d0e=_0x10ce36;_0x1ad40c['editMessageReplyMarkup'](),updateSetting(_0x292d0e(0x33b),_0x292d0e(0x276)),updateSetting(_0x292d0e(0x1ed),!![]),await sendTelegram(_0x1ad40c[_0x292d0e(0x2e6)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x10ce36(0x32a)]('status',async _0x3d4168=>{const _0x338571=_0x10ce36,_0x138dcf=getBotsWithMode();let _0x3d2434=_0x338571(0x397);config['forEach'](_0x1fe922=>{const _0x5e4273=_0x338571,_0xf4c517=_0x138dcf[_0x5e4273(0x398)](_0xb9e879=>_0xb9e879[_0x5e4273(0x1eb)]==_0x1fe922[_0x5e4273(0x1eb)])[_0x5e4273(0x33e)];_0x3d2434+=_0x5e4273(0x347)+_0x1fe922[_0x5e4273(0x1eb)]+':\x20'+_0x1fe922[_0x5e4273(0x3ae)]+_0x5e4273(0x304)+_0xf4c517+_0x5e4273(0x304)+_0x1fe922[_0x5e4273(0x1cb)]+'\x0a';}),_0x3d2434+='\x0a',_0x3d2434+=_0x338571(0x285),_0x3d2434+=!settings['telegramEnabled']?'Notifications\x20disabled\x0a':_0x338571(0x2ca),_0x3d2434+=settings[_0x338571(0x1ed)]?settings[_0x338571(0x33b)]==_0x338571(0x276)?_0x338571(0x239):'Notifications\x20types:\x20'+settings[_0x338571(0x33b)]+'\x20only\x0a':'',await sendTelegram(_0x3d4168['chat']['id'],_0x3d2434,{'parse_mode':_0x338571(0x1f0)});}),tgBot[_0x10ce36(0x32a)]('restart',async _0x2fe3f6=>{const _0x4ccbf1=_0x10ce36,_0x4c0513=getEnabledBots();if(_0x4c0513[_0x4ccbf1(0x1f1)]==0x0)await sendTelegram(_0x2fe3f6[_0x4ccbf1(0x2e6)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x4c0513[_0x4ccbf1(0x1f1)]>0x1)_0x4c0513[_0x4ccbf1(0x1e0)]({'botID':'all'});let _0x1f7e1c=[],_0x3e1e85=[];const _0x64618d=_0x4c0513[_0x4ccbf1(0x1f1)]%0x4==0x0||_0x4c0513['length']%0x4==0x3||_0x4c0513[_0x4ccbf1(0x1f1)]%0x3==0x1?0x4:0x3;let _0x23c692=0x0;_0x4c0513[_0x4ccbf1(0x2c2)]((_0x3e3f35,_0x2ed427)=>{const _0x38faaa=_0x4ccbf1;if(_0x2ed427%_0x64618d==0x0)_0x3e1e85=[];_0x3e1e85['push'](Markup[_0x38faaa(0x208)][_0x38faaa(0x3a9)](_0x3e3f35[_0x38faaa(0x1eb)]==_0x38faaa(0x276)?'All\x20bots':'Bot\x20'+_0x3e3f35[_0x38faaa(0x1eb)],_0x38faaa(0x290)+_0x3e3f35[_0x38faaa(0x1eb)])),_0x2ed427%_0x64618d==0x0&&(_0x1f7e1c[_0x23c692]=_0x3e1e85,_0x23c692++);});const _0x2c3c5d=Markup[_0x4ccbf1(0x361)](_0x1f7e1c);_0x2fe3f6[_0x4ccbf1(0x2ef)](_0x4ccbf1(0x342),_0x2c3c5d);}}),tgBot[_0x10ce36(0x22a)](/restart_(.+)/,async _0x4038cf=>{const _0x278ace=_0x10ce36,_0xe9e929=_0x4038cf[_0x278ace(0x23c)][0x1];_0x4038cf[_0x278ace(0x2e3)](),_0xe9e929=='all'?config['forEach'](_0x509c61=>{const _0x1d7044=_0x278ace;restartBot(_0x509c61[_0x1d7044(0x1eb)]);}):restartBot(_0xe9e929);}),tgBot[_0x10ce36(0x32a)]('on',async _0x709ff8=>{const _0x123695=_0x10ce36,_0x556a56=getDisabledBots();if(_0x556a56['length']==0x0)await sendTelegram(_0x709ff8['chat']['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x556a56[_0x123695(0x1f1)]>0x1)_0x556a56[_0x123695(0x1e0)]({'botID':_0x123695(0x276)});let _0x513b8f=[],_0x2a8fc8=[];const _0x16d9ba=_0x556a56['length']%0x4==0x0||_0x556a56[_0x123695(0x1f1)]%0x4==0x3||_0x556a56[_0x123695(0x1f1)]%0x3==0x1?0x4:0x3;let _0x14e6b1=0x0;_0x556a56[_0x123695(0x2c2)]((_0x1e1ada,_0x19ae80)=>{const _0x17bcd0=_0x123695;if(_0x19ae80%_0x16d9ba==0x0)_0x2a8fc8=[];_0x2a8fc8[_0x17bcd0(0x1e0)](Markup[_0x17bcd0(0x208)][_0x17bcd0(0x3a9)](_0x1e1ada[_0x17bcd0(0x1eb)]==_0x17bcd0(0x276)?'All\x20bots':_0x17bcd0(0x347)+_0x1e1ada[_0x17bcd0(0x1eb)],_0x17bcd0(0x323)+_0x1e1ada[_0x17bcd0(0x1eb)])),_0x19ae80%_0x16d9ba==0x0&&(_0x513b8f[_0x14e6b1]=_0x2a8fc8,_0x14e6b1++);});const _0x1c5f68=Markup['inlineKeyboard'](_0x513b8f);_0x709ff8[_0x123695(0x2ef)](_0x123695(0x21c),_0x1c5f68);}}),tgBot['action'](/on_(.+)/,async _0x4ad060=>{const _0x42f61e=_0x10ce36,_0x85fbd7=_0x4ad060[_0x42f61e(0x23c)][0x1];_0x4ad060[_0x42f61e(0x2e3)]();if(_0x85fbd7==_0x42f61e(0x276)){const _0x555fe5=getDisabledBots();await sendTelegram(_0x4ad060[_0x42f61e(0x2e6)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x555fe5[_0x42f61e(0x2c2)](_0xfce22=>{const _0x1a634c=_0x42f61e;if(_0xfce22[_0x1a634c(0x1eb)]!=_0x1a634c(0x276))toggleBot(_0xfce22[_0x1a634c(0x1eb)],toggleStatus(_0xfce22[_0x1a634c(0x1eb)]),_0x1a634c(0x3b1));});}else await sendTelegram(_0x4ad060[_0x42f61e(0x2e6)]['id'],_0x42f61e(0x2dd)+_0x85fbd7),toggleBot(_0x85fbd7,toggleStatus(_0x85fbd7),_0x42f61e(0x3b1));}),tgBot['command'](_0x10ce36(0x378),async _0x2b78a9=>{const _0x2ce2aa=_0x10ce36,_0x1c5cdf=getEnabledBots();if(_0x1c5cdf[_0x2ce2aa(0x1f1)]==0x0)await sendTelegram(_0x2b78a9[_0x2ce2aa(0x2e6)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1c5cdf['length']>0x1)_0x1c5cdf['push']({'botID':'all'});let _0x3c2b2a=[],_0x35c19d=[];const _0x5234fb=_0x1c5cdf[_0x2ce2aa(0x1f1)]%0x4==0x0||_0x1c5cdf[_0x2ce2aa(0x1f1)]%0x4==0x3||_0x1c5cdf[_0x2ce2aa(0x1f1)]%0x3==0x1?0x4:0x3;let _0x2e9dda=0x0;_0x1c5cdf[_0x2ce2aa(0x2c2)]((_0x56e98f,_0x2ff347)=>{const _0x985b45=_0x2ce2aa;if(_0x2ff347%_0x5234fb==0x0)_0x35c19d=[];_0x35c19d[_0x985b45(0x1e0)](Markup[_0x985b45(0x208)][_0x985b45(0x3a9)](_0x56e98f[_0x985b45(0x1eb)]==_0x985b45(0x276)?_0x985b45(0x1e3):_0x985b45(0x347)+_0x56e98f['botID'],'off_'+_0x56e98f[_0x985b45(0x1eb)])),_0x2ff347%_0x5234fb==0x0&&(_0x3c2b2a[_0x2e9dda]=_0x35c19d,_0x2e9dda++);});const _0x2a3969=Markup[_0x2ce2aa(0x361)](_0x3c2b2a);_0x2b78a9[_0x2ce2aa(0x2ef)](_0x2ce2aa(0x278),_0x2a3969);}}),tgBot[_0x10ce36(0x22a)](/off_(.+)/,async _0x30e670=>{const _0x29958d=_0x10ce36,_0x1b348a=_0x30e670[_0x29958d(0x23c)][0x1];_0x30e670[_0x29958d(0x2e3)]();if(_0x1b348a==_0x29958d(0x276)){const _0x2c5a5a=getEnabledBots();await sendTelegram(_0x30e670['chat']['id'],_0x29958d(0x2d0)),_0x2c5a5a[_0x29958d(0x2c2)](_0x38c6fa=>{const _0x2746bd=_0x29958d;if(_0x38c6fa[_0x2746bd(0x1eb)]!=_0x2746bd(0x276))toggleBot(_0x38c6fa[_0x2746bd(0x1eb)],toggleStatus(_0x38c6fa[_0x2746bd(0x1eb)]),_0x2746bd(0x3b1));});}else await sendTelegram(_0x30e670[_0x29958d(0x2e6)]['id'],_0x29958d(0x3b5)+_0x1b348a),toggleBot(_0x1b348a,toggleStatus(_0x1b348a),'stopped');}),tgBot[_0x10ce36(0x32a)](_0x10ce36(0x334),async _0x596bb1=>{const _0x35c61a=_0x10ce36,_0x525eb5=getEnabledBots();if(_0x525eb5[_0x35c61a(0x1f1)]==0x0)await sendTelegram(_0x596bb1['chat']['id'],_0x35c61a(0x39f));else{if(_0x525eb5['length']>0x1){let _0x21069f=[],_0x455fc2=[];const _0x2b5ae1=_0x525eb5[_0x35c61a(0x1f1)]%0x4==0x0||_0x525eb5['length']%0x4==0x3||_0x525eb5['length']%0x3==0x1?0x4:0x3;let _0x3d1db7=0x0;_0x525eb5['forEach']((_0x300e09,_0x304ad7)=>{const _0x12cf42=_0x35c61a;if(_0x304ad7%_0x2b5ae1==0x0)_0x455fc2=[];_0x455fc2[_0x12cf42(0x1e0)](Markup[_0x12cf42(0x208)][_0x12cf42(0x3a9)](_0x12cf42(0x347)+_0x300e09[_0x12cf42(0x1eb)],'metrics_'+_0x300e09[_0x12cf42(0x1eb)])),_0x304ad7%_0x2b5ae1==0x0&&(_0x21069f[_0x3d1db7]=_0x455fc2,_0x3d1db7++);});const _0x1622eb=Markup['inlineKeyboard'](_0x21069f);_0x596bb1[_0x35c61a(0x2ef)](_0x35c61a(0x23a),_0x1622eb);}else{const _0x4d7960=_0x525eb5[0x0]['botID'];if(pid[_0x4d7960])pid[_0x4d7960][_0x35c61a(0x2bd)]({'function':_0x35c61a(0x33f),'args':null});}}}),tgBot[_0x10ce36(0x22a)](/metrics_(.+)/,async _0x536e1f=>{const _0x43401d=_0x10ce36,_0x1b05b4=_0x536e1f[_0x43401d(0x23c)][0x1];_0x536e1f[_0x43401d(0x2e3)]();if(pid[_0x1b05b4])pid[_0x1b05b4]['send']({'function':_0x43401d(0x33f),'args':null});}),tgBot[_0x10ce36(0x32a)]('portfolio',async _0xedac=>{const _0x1b0b28=_0x10ce36,_0x3f4413=getEnabledBots();if(_0x3f4413[_0x1b0b28(0x1f1)]==0x0)await sendTelegram(_0xedac[_0x1b0b28(0x2e6)]['id'],_0x1b0b28(0x39f));else{if(_0x3f4413[_0x1b0b28(0x1f1)]>0x1){let _0x1a660f=[],_0x125974=[];const _0xbd3646=_0x3f4413[_0x1b0b28(0x1f1)]%0x4==0x0||_0x3f4413[_0x1b0b28(0x1f1)]%0x4==0x3||_0x3f4413[_0x1b0b28(0x1f1)]%0x3==0x1?0x4:0x3;let _0x276864=0x0;_0x3f4413[_0x1b0b28(0x2c2)]((_0x5aafdd,_0x4fc43f)=>{const _0x448aab=_0x1b0b28;if(_0x4fc43f%_0xbd3646==0x0)_0x125974=[];_0x125974[_0x448aab(0x1e0)](Markup[_0x448aab(0x208)][_0x448aab(0x3a9)](_0x448aab(0x347)+_0x5aafdd[_0x448aab(0x1eb)],_0x448aab(0x39e)+_0x5aafdd[_0x448aab(0x1eb)])),_0x4fc43f%_0xbd3646==0x0&&(_0x1a660f[_0x276864]=_0x125974,_0x276864++);});const _0x28e0ff=Markup[_0x1b0b28(0x361)](_0x1a660f);_0xedac[_0x1b0b28(0x2ef)](_0x1b0b28(0x374),_0x28e0ff);}else{const _0x4644e8=_0x3f4413[0x0]['botID'];if(pid[_0x4644e8])pid[_0x4644e8][_0x1b0b28(0x2bd)]({'function':_0x1b0b28(0x311),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x3b2133=>{const _0x2365ef=_0x10ce36,_0x32333e=_0x3b2133[_0x2365ef(0x23c)][0x1];_0x3b2133[_0x2365ef(0x2e3)]();if(pid[_0x32333e])pid[_0x32333e][_0x2365ef(0x2bd)]({'function':_0x2365ef(0x311),'args':null});}),tgBot['command'](_0x10ce36(0x3a7),async _0x5ca45c=>{const _0x37acd9=_0x10ce36,_0x47ba7b=_0x37acd9(0x3a7);await zipFiles(_0x47ba7b);const _0x20bc76=zippath+(_0x47ba7b+_0x37acd9(0x33d));_0x5ca45c[_0x37acd9(0x366)]({'source':_0x20bc76})[_0x37acd9(0x2c3)](()=>{})[_0x37acd9(0x35a)](_0x195750=>logger[_0x37acd9(0x315)](_0x37acd9(0x309)+_0x47ba7b+_0x37acd9(0x1fd),_0x195750));}),tgBot[_0x10ce36(0x32a)]('backup',async _0x1d84f5=>{const _0x2de478=_0x10ce36,_0x45e255=_0x2de478(0x36a);await backupConfigFiles(),await zipFiles(_0x45e255);const _0x2f55c5=zippath+(_0x45e255+_0x2de478(0x33d));_0x1d84f5[_0x2de478(0x366)]({'source':_0x2f55c5})[_0x2de478(0x2c3)](()=>{})[_0x2de478(0x35a)](_0x39c40c=>logger['debug'](_0x2de478(0x309)+_0x45e255+_0x2de478(0x1fd),_0x39c40c));}),tgBot[_0x10ce36(0x32a)](_0x10ce36(0x2b7),async _0x15e46e=>{const _0x497ad3=_0x10ce36;await getMessages();if(!updateAvailable)await sendTelegram(_0x15e46e[_0x497ad3(0x2e6)]['id'],_0x497ad3(0x31f));else{if(!validInstallation)await sendTelegram(_0x15e46e[_0x497ad3(0x2e6)]['id'],_0x497ad3(0x36b));else{const _0x8462e5=Markup[_0x497ad3(0x361)]([Markup[_0x497ad3(0x208)][_0x497ad3(0x3a9)](_0x497ad3(0x1be),'update_yes'),Markup['button']['callback']('No',_0x497ad3(0x20e))]);_0x15e46e[_0x497ad3(0x2ef)](_0x497ad3(0x28e),_0x8462e5);}}}),tgBot[_0x10ce36(0x22a)](/update_(.+)/,async _0xec8b4=>{const _0x5f25ee=_0x10ce36,_0x2756be=_0xec8b4[_0x5f25ee(0x23c)][0x1];_0xec8b4[_0x5f25ee(0x2e3)](),_0x2756be==_0x5f25ee(0x349)&&(await sendTelegram(_0xec8b4[_0x5f25ee(0x2e6)]['id'],_0x5f25ee(0x312)),updateBB('update')),_0x2756be=='no'&&await sendTelegram(_0xec8b4['chat']['id'],_0x5f25ee(0x245));}),tgBot[_0x10ce36(0x32a)](_0x10ce36(0x229),async _0x5f4902=>{const _0xa5111c=_0x10ce36;if(!validInstallation)await sendTelegram(_0x5f4902[_0xa5111c(0x2e6)]['id'],_0xa5111c(0x26c));else{const _0x2beafd=Markup[_0xa5111c(0x361)]([Markup[_0xa5111c(0x208)][_0xa5111c(0x3a9)]('Yes','reinstall_yes'),Markup[_0xa5111c(0x208)][_0xa5111c(0x3a9)]('No',_0xa5111c(0x1ee))]);_0x5f4902[_0xa5111c(0x2ef)](_0xa5111c(0x27a),_0x2beafd);}}),tgBot[_0x10ce36(0x22a)](/reinstall_(.+)/,async _0x3ea7b5=>{const _0x203d59=_0x10ce36,_0x871d7a=_0x3ea7b5[_0x203d59(0x23c)][0x1];_0x3ea7b5[_0x203d59(0x2e3)](),_0x871d7a==_0x203d59(0x349)&&(await sendTelegram(_0x3ea7b5[_0x203d59(0x2e6)]['id'],_0x203d59(0x35e)),updateBB(_0x203d59(0x229))),_0x871d7a=='no'&&await sendTelegram(_0x3ea7b5['chat']['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x10ce36(0x32a)](_0x10ce36(0x3b0),async _0x4a306f=>{const _0x314c2e=_0x10ce36,_0xc555fc=getBotsWithMode();if(_0xc555fc[_0x314c2e(0x1f1)]==0x0)await sendTelegram(_0x4a306f[_0x314c2e(0x2e6)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x3898ff=[],_0x394c75=[];const _0x129e0f=0x2;let _0x46fd75=0x0;_0xc555fc[_0x314c2e(0x2c2)]((_0x398c36,_0x1d3850)=>{const _0x577c00=_0x314c2e;if(_0x1d3850%_0x129e0f==0x0)_0x394c75=[];_0x394c75[_0x577c00(0x1e0)](Markup[_0x577c00(0x208)][_0x577c00(0x3a9)](_0x577c00(0x347)+_0x398c36[_0x577c00(0x1eb)]+'\x20('+_0x398c36[_0x577c00(0x33e)]+')',_0x577c00(0x36d)+_0x398c36['botID'])),_0x1d3850%_0x129e0f==0x0&&(_0x3898ff[_0x46fd75]=_0x394c75,_0x46fd75++);});const _0x41244d=Markup[_0x314c2e(0x361)](_0x3898ff);_0x4a306f[_0x314c2e(0x2ef)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x41244d);}}),tgBot[_0x10ce36(0x22a)](/toggle_(.+)/,async _0x47ef02=>{const _0xa74a42=_0x10ce36,_0x132a59=_0x47ef02[_0xa74a42(0x23c)][0x1];_0x47ef02[_0xa74a42(0x2e3)]();const _0x3b9b8b=getBotsWithMode(),_0x1307f0=_0x3b9b8b[_0xa74a42(0x398)](_0x2ec286=>_0x2ec286[_0xa74a42(0x1eb)]==_0x132a59),_0x686f49=_0x1307f0[_0xa74a42(0x33e)]==_0xa74a42(0x21b)?_0xa74a42(0x30f):_0xa74a42(0x21b);await sendTelegram(_0x47ef02[_0xa74a42(0x2e6)]['id'],_0xa74a42(0x1c8)+_0x132a59+_0xa74a42(0x1c3)+_0x686f49+_0xa74a42(0x34d)),toggleBotMode(_0x132a59);}),tgBot[_0x10ce36(0x32a)](_0x10ce36(0x3a2),async _0x549e4e=>{const _0x4ef4ff=_0x10ce36;let _0x4ffe2f='';config['forEach'](_0xaf1459=>{const _0x398606=_0x3e11;_0x4ffe2f+='Bot\x20'+_0xaf1459[_0x398606(0x1eb)]+':\x20'+_0xaf1459[_0x398606(0x37b)]+'\x0a';}),await sendTelegram(_0x549e4e[_0x4ef4ff(0x2e6)]['id'],_0x4ffe2f,{'parse_mode':_0x4ef4ff(0x1f0)});}),tgBot[_0x10ce36(0x32a)](_0x10ce36(0x37e),async _0x390370=>{const _0x4f7fee=_0x10ce36;await sendTelegram(_0x390370[_0x4f7fee(0x2e6)]['id'],_0x34d85d);}),process[_0x10ce36(0x2df)]('SIGINT',()=>tgBot[_0x10ce36(0x327)](_0x10ce36(0x249))),process['once'](_0x10ce36(0x24d),()=>tgBot[_0x10ce36(0x327)](_0x10ce36(0x24d))),tgBot[_0x10ce36(0x255)]();}function disableTelegram(){const _0x2abbda=_0x2cf39b;tgBot&&tgBot[_0x2abbda(0x327)]();}async function sendTelegram(_0x32796a,_0x1cc12c,_0xf84a8){const _0x3a35d6=_0x2cf39b;_0xf84a8={..._0xf84a8,'disable_web_page_preview':!![]};try{await tgBot[_0x3a35d6(0x2af)][_0x3a35d6(0x1a7)](_0x32796a,_0x1cc12c,_0xf84a8);}catch(_0x3c8220){logger[_0x3a35d6(0x315)]('Telegram\x20error:',_0x3c8220);}}async function sendTelegramBot(_0x4fec5,_0x1e36f7){const _0x2cc450=_0x2cf39b;if(settings[_0x2cc450(0x1ed)]){if(settings['telegramEvents']==_0x2cc450(0x276)||(_0x1e36f7[_0x2cc450(0x1e8)]==_0x2cc450(0x3ac)||_0x1e36f7[_0x2cc450(0x1e8)]==_0x2cc450(0x246)||_0x1e36f7[_0x2cc450(0x1e8)]==_0x2cc450(0x3ba))&&settings[_0x2cc450(0x33b)]==_0x2cc450(0x369)||_0x1e36f7[_0x2cc450(0x1e8)]==_0x2cc450(0x389)&&settings[_0x2cc450(0x33b)]==_0x2cc450(0x34c)){if(tgBot&&settings[_0x2cc450(0x201)]){if(_0x1e36f7[_0x2cc450(0x363)])await sendTelegram(settings[_0x2cc450(0x201)],_0x1e36f7[_0x2cc450(0x37b)]+_0x2cc450(0x26a)+_0x1e36f7[_0x2cc450(0x30c)]);else await sendTelegram(settings['telegramChatId'],'Bot\x20'+_0x4fec5+'\x20>\x20'+_0x1e36f7[_0x2cc450(0x30c)]);}}}}async function sendTelegramMsg(_0xb77dba,_0x332041='HTML'){const _0x77ee8b=_0x2cf39b;return settings[_0x77ee8b(0x1ed)]&&tgBot&&settings[_0x77ee8b(0x201)]?(await sendTelegram(settings[_0x77ee8b(0x201)],_0xb77dba,{'parse_mode':_0x332041}),!![]):![];}function getDeviceWithIp(_0x33be87){const _0x338a08=_0x2cf39b;return devices[_0x338a08(0x398)](_0x3465ec=>_0x3465ec['ip']===_0x33be87);}async function temporaryAccess2FA(_0x14c504,_0xc84458){const _0x2adf70=_0x2cf39b;let _0x1a38d6=new Date(),_0x375fe8=![];if(lastIpApproval){if(_0x1a38d6-lastIpApproval<0x1388)_0x375fe8=!![];}lastIpApproval=new Date();if(_0x375fe8)return;if(tgBot&&settings[_0x2adf70(0x201)]){const _0x9416da=uuidRandom();tmpStorage[_0x9416da]={'uuid':_0x14c504,'externalip':_0xc84458};const _0x334190=Markup[_0x2adf70(0x361)]([Markup[_0x2adf70(0x208)][_0x2adf70(0x3a9)](_0x2adf70(0x318),_0x2adf70(0x376)+_0x9416da),Markup[_0x2adf70(0x208)][_0x2adf70(0x3a9)](_0x2adf70(0x241),_0x2adf70(0x24c)+_0x9416da),Markup[_0x2adf70(0x208)][_0x2adf70(0x3a9)](_0x2adf70(0x22e),_0x2adf70(0x206)+_0x9416da),Markup[_0x2adf70(0x208)][_0x2adf70(0x3a9)](_0x2adf70(0x28c),_0x2adf70(0x379)+_0x9416da)]);await sendTelegram(settings[_0x2adf70(0x201)],_0x2adf70(0x2ff)+normalizeIP(_0xc84458)[_0x2adf70(0x2cc)]+'\x20?',_0x334190),tgBot[_0x2adf70(0x22a)](/tempaccess_(.+)_(.+)/,async _0x5e96e1=>{const _0x351e04=_0x2adf70,_0x20030f=_0x5e96e1[_0x351e04(0x23c)][0x1],_0x4b075d=_0x5e96e1[_0x351e04(0x23c)][0x2],{uuid:_0x1ad662,externalip:_0x59e66c}=tmpStorage[_0x4b075d];delete tmpStorage[_0x4b075d],_0x5e96e1['editMessageReplyMarkup'](),devices[_0x1ad662][_0x351e04(0x267)]={'clientip':_0x59e66c,'timestamp':new Date()['getTime'](),'expiry':_0x20030f},_0x20030f!=_0x351e04(0x28c)?(await sendTelegram(_0x5e96e1['chat']['id'],_0x351e04(0x1b9)+_0x20030f+_0x351e04(0x2b6),{'parse_mode':_0x351e04(0x1f0)}),io['to'](_0x1ad662)[_0x351e04(0x2a6)](_0x351e04(0x3ae),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x5e96e1[_0x351e04(0x2e6)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x1ad662)[_0x351e04(0x2a6)]('status',{'access':{'allow':![],'reason':_0x351e04(0x270),'token':null}}));});}}async function loginAccess2FA(_0x1a5ded,_0x49b51c){const _0x3e562b=_0x2cf39b;if(tgBot&&settings[_0x3e562b(0x201)]){const _0x5ddba7=uuidRandom();tmpStorage[_0x5ddba7]={'uuid':_0x1a5ded,'externalip':_0x49b51c};const _0xda450=Markup[_0x3e562b(0x361)]([Markup[_0x3e562b(0x208)][_0x3e562b(0x3a9)]('accept','login2fa_'+loginExpiry+'_'+_0x5ddba7),Markup[_0x3e562b(0x208)][_0x3e562b(0x3a9)](_0x3e562b(0x28c),_0x3e562b(0x21f)+_0x5ddba7)]);await sendTelegram(settings[_0x3e562b(0x201)],_0x3e562b(0x293)+normalizeIP(_0x49b51c)[_0x3e562b(0x2cc)]+'\x20?',_0xda450),tgBot[_0x3e562b(0x22a)](/login2fa_(.+)_(.+)/,async _0x48f8a2=>{const _0x2ecf20=_0x3e562b,_0x3e3baa=_0x48f8a2[_0x2ecf20(0x23c)][0x1],_0x70a6c2=_0x48f8a2[_0x2ecf20(0x23c)][0x2],{uuid:_0x512720,externalip:_0x41c501}=tmpStorage[_0x70a6c2];delete tmpStorage[_0x70a6c2],_0x48f8a2[_0x2ecf20(0x2e3)](),devices[_0x512720][_0x2ecf20(0x1db)]={'clientip':_0x41c501,'timestamp':new Date()[_0x2ecf20(0x328)](),'expiry':_0x3e3baa},_0x3e3baa!=_0x2ecf20(0x28c)?(await sendTelegram(_0x48f8a2[_0x2ecf20(0x2e6)]['id'],_0x2ecf20(0x333),{'parse_mode':'HTML'}),io['to'](_0x512720)[_0x2ecf20(0x2a6)](_0x2ecf20(0x3ae),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x48f8a2['chat']['id'],_0x2ecf20(0x2a0)),io['to'](_0x512720)['emit']('status',{'access':{'allow':![],'reason':_0x2ecf20(0x1d4),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x471c0d=_0x2cf39b;return dbConfig['get'](_0x471c0d(0x3a6))[_0x471c0d(0x330)](_0x471c0d(0x1eb))[_0x471c0d(0x27b)]({'status':'enabled'})[_0x471c0d(0x1da)]()||[];}function getDisabledBots(){const _0x2a3ffc=_0x2cf39b;return dbConfig[_0x2a3ffc(0x1fb)]('bots')['sortBy'](_0x2a3ffc(0x1eb))[_0x2a3ffc(0x27b)]({'status':_0x2a3ffc(0x319)})['value']()||[];}function getBotAttributes(_0x182109){const _0x519252=_0x2cf39b;let _0x539eec={};const _0x1a851b=configpath+_0x519252(0x257)+_0x182109+_0x519252(0x32c),_0x17f261=fs[_0x519252(0x268)](_0x1a851b);if(_0x17f261){const _0x42978b=fs[_0x519252(0x20d)](_0x1a851b);try{const _0xbc2acd=JSON['parse'](_0x42978b),_0x56a241=_0xbc2acd?_0xbc2acd['bot'][0x0][_0x519252(0x2d4)]:![];_0x539eec[_0x519252(0x33e)]=_0x56a241?_0x519252(0x21b):_0x519252(0x30f),_0x539eec[_0x519252(0x37b)]=_0xbc2acd?_0xbc2acd['bot'][0x0][_0x519252(0x37b)]:'Bot\x20'+_0x182109;}catch(_0x2a444c){_0x539eec[_0x519252(0x33e)]=_0x519252(0x30f),_0x539eec[_0x519252(0x37b)]='Bot\x20'+_0x182109;}}else _0x539eec[_0x519252(0x33e)]='manual',_0x539eec[_0x519252(0x37b)]=_0x519252(0x347)+_0x182109;return _0x539eec;}function getBotsWithMode(){const _0x3dee19=_0x2cf39b,_0x46585e=dbConfig[_0x3dee19(0x1fb)](_0x3dee19(0x3a6))['sortBy'](_0x3dee19(0x1eb))['value']()||[];return _0x46585e[_0x3dee19(0x2c2)](_0x5704f2=>{const _0x33a1ad=_0x3dee19;let _0x3df084=getBotAttributes(_0x5704f2[_0x33a1ad(0x1eb)]);_0x5704f2[_0x33a1ad(0x33e)]=_0x3df084[_0x33a1ad(0x33e)];}),_0x46585e;}function getBotExchanges(){const _0x391070=_0x2cf39b;let _0x175d06=[];const _0x5eae6f=dbConfig[_0x391070(0x1fb)](_0x391070(0x3a6))['sortBy'](_0x391070(0x1eb))[_0x391070(0x1da)]()||[];_0x5eae6f[_0x391070(0x2c2)](_0x2209dd=>{const _0x98239a=_0x391070;if(_0x2209dd[_0x98239a(0x3ae)]==_0x98239a(0x1ba)){const _0x328f14=configpath+_0x98239a(0x257)+_0x2209dd[_0x98239a(0x1eb)]+_0x98239a(0x32c),_0x53d841=fs[_0x98239a(0x268)](_0x328f14);let _0x1580e2;if(_0x53d841){const _0x4acaff=fs[_0x98239a(0x20d)](_0x328f14);try{const _0x3ff5b7=JSON[_0x98239a(0x395)](_0x4acaff);_0x1580e2=_0x3ff5b7?_0x3ff5b7['bot'][0x0][_0x98239a(0x3b3)]:null;}catch(_0x2423ff){}}if(_0x1580e2)_0x175d06['push'](_0x1580e2);}});const _0x3c168d=[...new Set(_0x175d06)]['sort']();return _0x3c168d;}async function initUser(){const _0x2ddc30=_0x2cf39b;if(!settings[_0x2ddc30(0x259)]){const _0x9ab06d=uuidRandom();mixpanel[_0x2ddc30(0x228)](_0x9ab06d),updateSetting(_0x2ddc30(0x259),_0x9ab06d);}}async function initSecure(){const _0x491da4=_0x2cf39b;let _0x445bc1=getSecure();if(!_0x445bc1[_0x491da4(0x23b)](_0x491da4(0x291))){let _0x5eb63f=await generateKeys();_0x445bc1[_0x491da4(0x335)]=_0x5eb63f[_0x491da4(0x335)],_0x445bc1[_0x491da4(0x242)]=_0x5eb63f['privateKey'],_0x445bc1[_0x491da4(0x291)]=crypto[_0x491da4(0x253)](0x20)['toString'](_0x491da4(0x354));;storeSecure(_0x445bc1);}}function getSettings(){const _0x2057fa=_0x2cf39b;return dbSettings['get'](_0x2057fa(0x232))[_0x2057fa(0x1da)]()||{};}function getSecure(){const _0x13a128=_0x2cf39b;return dbSecure[_0x13a128(0x1fb)](_0x13a128(0x1ae))[_0x13a128(0x1da)]()||{};}function getBlacklist(){const _0x17c84e=_0x2cf39b;return dbSecure[_0x17c84e(0x1fb)](_0x17c84e(0x1c0))['value']()||[];}function broadcastToBots(_0x2a8d7b,_0x1aa4ff){config['forEach'](_0x3395d9=>{const _0x31770a=_0x3e11;if(_0x3395d9[_0x31770a(0x3ae)]==_0x31770a(0x1ba)&&_0x3395d9['live']==_0x31770a(0x1df)||_0x3395d9[_0x31770a(0x3ae)]=='new'&&_0x3395d9[_0x31770a(0x1cb)]==_0x31770a(0x1df)){if(pid[_0x3395d9['botID']])pid[_0x3395d9[_0x31770a(0x1eb)]][_0x31770a(0x2bd)]({[_0x2a8d7b]:_0x1aa4ff});}});}async function storeSettings(_0x227c0f,_0x47bcc3=![]){const _0x4ff6f6=_0x2cf39b;_0x227c0f={...settings,..._0x227c0f};if(_0x47bcc3&&_0x227c0f['bbPassword']!=_0x4ff6f6(0x207)&&_0x227c0f['bbPassword']!='***'&&_0x227c0f[_0x4ff6f6(0x1f4)]!=''){const _0xcea631=decryptRSA(secure['privateKey'],_0x227c0f[_0x4ff6f6(0x1f4)])['split'](_0x4ff6f6(0x2c7))[0x0],_0x322499=bcrypt[_0x4ff6f6(0x3ad)](_0xcea631,saltRounds);_0x227c0f={..._0x227c0f,'bbPassword':_0x322499};}if(_0x47bcc3&&_0x227c0f['telegramToken']!=_0x4ff6f6(0x207)&&_0x227c0f[_0x4ff6f6(0x233)]!=_0x4ff6f6(0x3b4)&&_0x227c0f[_0x4ff6f6(0x233)]!=''){const _0x24ef6d=decryptRSA(secure[_0x4ff6f6(0x242)],_0x227c0f[_0x4ff6f6(0x233)])[_0x4ff6f6(0x2d7)](_0x4ff6f6(0x2c7))[0x0];_0x227c0f={..._0x227c0f,'telegramToken':_0x24ef6d};}if(_0x47bcc3&&_0x227c0f[_0x4ff6f6(0x21a)]!='************'&&_0x227c0f[_0x4ff6f6(0x21a)]!=_0x4ff6f6(0x3b4)&&_0x227c0f[_0x4ff6f6(0x21a)]!=''){const _0x564697=decryptRSA(secure[_0x4ff6f6(0x242)],_0x227c0f['marketcapApi'])[_0x4ff6f6(0x2d7)](_0x4ff6f6(0x2c7))[0x0];_0x227c0f={..._0x227c0f,'marketcapApi':_0x564697};}const _0x18dc37=_0x227c0f[_0x4ff6f6(0x233)]!=_0x4ff6f6(0x207)&&_0x227c0f['telegramToken']!=settings[_0x4ff6f6(0x233)]||_0x227c0f[_0x4ff6f6(0x1bb)]!=settings[_0x4ff6f6(0x1bb)],_0x362121=_0x227c0f[_0x4ff6f6(0x233)]==''||_0x227c0f[_0x4ff6f6(0x1bb)]=='',_0xd7369a=_0x227c0f[_0x4ff6f6(0x21a)]&&_0x227c0f[_0x4ff6f6(0x21a)]!=_0x4ff6f6(0x207)&&_0x227c0f[_0x4ff6f6(0x21a)]!=settings[_0x4ff6f6(0x21a)];_0x18dc37&&(_0x227c0f['telegramChatId']=null,_0x227c0f['telegramEvents']=_0x4ff6f6(0x276));for(const [_0x249daf,_0xbb25]of Object[_0x4ff6f6(0x32b)](_0x227c0f)){if(_0x249daf==_0x4ff6f6(0x233)&&_0xbb25==_0x4ff6f6(0x207)){_0x227c0f[_0x4ff6f6(0x233)]=settings[_0x4ff6f6(0x233)];continue;};if(_0x249daf=='bbPassword'&&_0xbb25==_0x4ff6f6(0x207)){_0x227c0f[_0x4ff6f6(0x1f4)]=settings[_0x4ff6f6(0x1f4)];continue;};if(_0x249daf==_0x4ff6f6(0x21a)&&_0xbb25=='************'){_0x227c0f[_0x4ff6f6(0x21a)]=settings[_0x4ff6f6(0x21a)];continue;};dbSettings[_0x4ff6f6(0x2da)](_0x4ff6f6(0x2fa)+_0x249daf,_0xbb25)[_0x4ff6f6(0x1c2)]();}settings=_0x227c0f,io['to'](_0x4ff6f6(0x2b3))[_0x4ff6f6(0x2a6)](_0x4ff6f6(0x232),cleanSettings()),broadcastToBots('timeshift',settings['timeshift']),broadcastToBots(_0x4ff6f6(0x1e5),settings['onepagemode']),broadcastToBots(_0x4ff6f6(0x21a),settings[_0x4ff6f6(0x21a)]);if(_0x18dc37&&!_0x362121)initTelegram();_0x18dc37&&_0x362121&&(updateSetting('telegramChatId',null),disableTelegram()),getAllClients()['forEach'](_0x3dfec6=>{const _0x239e4b=_0x4ff6f6;getSocket(_0x3dfec6['id'])[_0x239e4b(0x2a6)](_0x239e4b(0x3ae),{'access':{'allow':![],'reason':'reload','token':null}});}),_0xd7369a&&(await sleep(0xbb8),testMarketcapApi(_0x227c0f['marketcapApi']));}async function testMarketcapApi(_0x3872d2){const _0x35561f=_0x2cf39b,_0x298347=[_0x35561f(0x38e),'ETH'];try{await axios[_0x35561f(0x1fb)](_0x35561f(0x2e7),{'headers':{'X-CMC_PRO_API_KEY':_0x3872d2},'params':{'symbol':_0x298347['toString']()}});}catch(_0x427641){_0x427641[_0x35561f(0x2c5)]()['includes'](_0x35561f(0x27f))?(io['to'](_0x35561f(0x2b3))['emit'](_0x35561f(0x231),_0x35561f(0x310)),logger[_0x35561f(0x262)](_0x35561f(0x310))):(io['to'](_0x35561f(0x2b3))[_0x35561f(0x2a6)](_0x35561f(0x231),_0x35561f(0x313)),logger['full'](_0x35561f(0x313)),logger[_0x35561f(0x315)](_0x35561f(0x1af),_0x427641[_0x35561f(0x2c5)]()+_0x35561f(0x1cf)+_0x427641[_0x35561f(0x2b1)]));return;}logger[_0x35561f(0x315)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x1cb759,_0x556f15){const _0xd0ed90=_0x2cf39b;dbSettings[_0xd0ed90(0x2da)]('settings.'+_0x1cb759,_0x556f15)[_0xd0ed90(0x1c2)](),settings=getSettings(),io['to']('botmanager')[_0xd0ed90(0x2a6)]('settings',cleanSettings());}function storeSecure(_0x463e20){const _0x32f9a1=_0x2cf39b;dbSecure[_0x32f9a1(0x1fb)](_0x32f9a1(0x1ae))[_0x32f9a1(0x1e0)](_0x463e20)['write'](),secure=_0x463e20;}function addBlacklist(_0x34e1de){const _0x5e65be=_0x2cf39b;cleanBlacklist();let _0x529865;devices[_0x34e1de][_0x5e65be(0x267)]?_0x529865=Math[_0x5e65be(0x38c)](devices[_0x34e1de][_0x5e65be(0x267)][_0x5e65be(0x238)],loginExpiry):_0x529865=loginExpiry,dbSecure[_0x5e65be(0x1fb)](_0x5e65be(0x1c0))[_0x5e65be(0x1e0)]({'expiry':new Date()['getTime']()+_0x529865*0x3c*0x3e8,'token':devices[_0x34e1de][_0x5e65be(0x35f)][_0x5e65be(0x3a5)]})[_0x5e65be(0x1c2)](),blacklist=dbSecure['get']('blacklist')[_0x5e65be(0x1da)]();}function cleanBlacklist(){const _0x530f64=_0x2cf39b;let _0x3cf527=dbSecure[_0x530f64(0x1fb)](_0x530f64(0x1c0))[_0x530f64(0x282)]()[_0x530f64(0x1da)](),_0x3fbf47=new Date()[_0x530f64(0x328)]();_0x3cf527[_0x530f64(0x2c2)](_0x4e50a2=>{const _0x535662=_0x530f64;_0x4e50a2[_0x535662(0x238)]<_0x3fbf47&&dbSecure[_0x535662(0x1fb)](_0x535662(0x1c0))[_0x535662(0x34a)]({'expiry':_0x4e50a2['expiry']})[_0x535662(0x1c2)]();});}function initStates(){const _0x5cb6e9=_0x2cf39b;let _0x5e9ee8=getConfiguration();_0x5e9ee8[_0x5cb6e9(0x2c2)](_0x51ef50=>{const _0x4e01b7=_0x5cb6e9;_0x51ef50[_0x4e01b7(0x1cb)]=_0x4e01b7(0x3b1);}),storeConfiguration(_0x5e9ee8);}async function generateKeys(){const _0x4bae4e=_0x2cf39b,_0x479840=forge[_0x4bae4e(0x24a)][_0x4bae4e(0x368)][_0x4bae4e(0x336)]({'bits':0x1000,'e':0x10001}),_0x368bd1=forge[_0x4bae4e(0x24a)]['privateKeyToPem'](_0x479840[_0x4bae4e(0x242)]),_0x337c91=forge[_0x4bae4e(0x24a)][_0x4bae4e(0x371)](_0x479840['publicKey']);return{'privateKey':_0x368bd1,'publicKey':_0x337c91};}async function oneTimeMigration(){const _0x379570=_0x2cf39b;let _0x59ff10=getSettings(),_0x15f824=![];!_0x59ff10[_0x379570(0x23b)](_0x379570(0x1d1))&&(_0x59ff10[_0x379570(0x1d1)]=0x0,_0x15f824=!![]);!_0x59ff10[_0x379570(0x23b)](_0x379570(0x2c0))&&(_0x59ff10[_0x379570(0x2c0)]=0x0,_0x15f824=!![]);!_0x59ff10['hasOwnProperty'](_0x379570(0x222))&&(_0x59ff10[_0x379570(0x222)]=_0x379570(0x325),_0x15f824=!![]);!_0x59ff10[_0x379570(0x23b)](_0x379570(0x1e5))&&(_0x59ff10['onepagemode']=![],_0x15f824=!![]);!_0x59ff10[_0x379570(0x23b)]('marketcapApi')&&(_0x59ff10[_0x379570(0x21a)]='',_0x15f824=!![]);if(_0x15f824)storeSettings(_0x59ff10);try{fs[_0x379570(0x33c)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x4f270a=>{const _0x570d9b=_0x379570;if(!_0x4f270a['isDirectory']()){if(!_0x4f270a[_0x570d9b(0x331)]['startsWith'](_0x570d9b(0x1c6)))fs[_0x570d9b(0x236)](configbackuppath+_0x4f270a[_0x570d9b(0x331)]);}else fs[_0x570d9b(0x34b)](configbackuppath+_0x4f270a[_0x570d9b(0x331)],{'recursive':!![]});});}catch(_0x487b28){logger[_0x379570(0x315)](_0x379570(0x1d9),_0x487b28);}}function storeConfiguration(_0x3b98cb){const _0x4fa739=_0x2cf39b;dbConfig[_0x4fa739(0x1fb)](_0x4fa739(0x3a6))['remove']()['write'](),dbConfig[_0x4fa739(0x1fb)](_0x4fa739(0x3a6))['push'](..._0x3b98cb)['write'](),config=_0x3b98cb;}async function resetPassword(){const _0x2c5366=_0x2cf39b;if(tgBot&&settings['telegramChatId']){const _0x2fb1b1=Markup['inlineKeyboard']([Markup[_0x2c5366(0x208)][_0x2c5366(0x3a9)](_0x2c5366(0x349),_0x2c5366(0x26d)),Markup[_0x2c5366(0x208)][_0x2c5366(0x3a9)]('no',_0x2c5366(0x2eb))]);await sendTelegram(settings[_0x2c5366(0x201)],_0x2c5366(0x3a4),_0x2fb1b1),tgBot['action'](/resetpw_(.+)/,async _0x26d74c=>{const _0x2f2c79=_0x2c5366,_0x23dd7e=_0x26d74c['match'][0x1];_0x26d74c[_0x2f2c79(0x2e3)]();if(_0x23dd7e!='no'){const _0xec04de=0xf,_0x420cd2='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x3e4280=Array[_0x2f2c79(0x353)](crypto[_0x2f2c79(0x1ad)](new Uint32Array(_0xec04de)))[_0x2f2c79(0x383)](_0x229c36=>_0x420cd2[_0x229c36%_0x420cd2[_0x2f2c79(0x1f1)]])[_0x2f2c79(0x385)](''),_0x16f5e1=bcrypt[_0x2f2c79(0x3ad)](_0x3e4280,saltRounds);storeSettings({'bbPassword':_0x16f5e1}),await sendTelegram(_0x26d74c[_0x2f2c79(0x2e6)]['id'],_0x2f2c79(0x263)+_0x3e4280,{'parse_mode':_0x2f2c79(0x1f0)});}else await sendTelegram(_0x26d74c[_0x2f2c79(0x2e6)]['id'],_0x2f2c79(0x1d5));});}}async function confirmRestore(_0x1e7728,_0x188bfd){const _0x1d5eb8=_0x2cf39b;io['to'](_0x1d5eb8(0x2b3))[_0x1d5eb8(0x2a6)](_0x1d5eb8(0x231),_0x1d5eb8(0x2ec),_0x1d5eb8(0x3ba));if(tgBot&&settings[_0x1d5eb8(0x201)]){const _0x2e5e00=uuidRandom();tmpStorage[_0x2e5e00]={'path':_0x1e7728,'filename':_0x188bfd};const _0x42300f=Markup[_0x1d5eb8(0x361)]([Markup[_0x1d5eb8(0x208)]['callback'](_0x1d5eb8(0x349),_0x1d5eb8(0x2a8)+_0x2e5e00),Markup[_0x1d5eb8(0x208)][_0x1d5eb8(0x3a9)]('no',_0x1d5eb8(0x3a8)+_0x2e5e00)]);await sendTelegram(settings['telegramChatId'],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x42300f),tgBot[_0x1d5eb8(0x22a)](/restore_(.+)_(.+)/,async _0x2e3d6f=>{const _0x22e8e9=_0x1d5eb8,_0x1263d3=_0x2e3d6f[_0x22e8e9(0x23c)][0x1],_0x4a0305=_0x2e3d6f['match'][0x2],{path:_0x486197,filename:_0xfaa954}=tmpStorage[_0x4a0305];delete tmpStorage[_0x4a0305],_0x2e3d6f[_0x22e8e9(0x2e3)](),_0x1263d3==_0x22e8e9(0x349)?(logger['debug']('Restore\x20process\x20confirmed'),await sendTelegram(_0x2e3d6f['chat']['id'],_0x22e8e9(0x33a),{'parse_mode':'HTML'}),unzipFile(_0x486197,_0xfaa954)):(logger['debug'](_0x22e8e9(0x332)),await sendTelegram(_0x2e3d6f[_0x22e8e9(0x2e6)]['id'],_0x22e8e9(0x332)));});}}function getServerTime(){const _0x298988=_0x2cf39b,_0x3fbfea=new Date();return _0x3fbfea[_0x298988(0x2f4)]()+'/'+(_0x3fbfea['getMonth']()+0x1)[_0x298988(0x2c5)]()[_0x298988(0x38b)](0x2,'0')+'/'+_0x3fbfea[_0x298988(0x314)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x3fbfea[_0x298988(0x2f8)]()[_0x298988(0x2c5)]()[_0x298988(0x38b)](0x2,'0')+':'+_0x3fbfea[_0x298988(0x243)]()[_0x298988(0x2c5)]()[_0x298988(0x38b)](0x2,'0')+':'+_0x3fbfea['getSeconds']()[_0x298988(0x2c5)]()[_0x298988(0x38b)](0x2,'0');}function getTimeStamp(){const _0x530324=_0x2cf39b,_0x2d2981=shiftedTime();return _0x2d2981[_0x530324(0x2f4)]()+'/'+(_0x2d2981['getMonth']()+0x1)[_0x530324(0x2c5)]()['padStart'](0x2,'0')+'/'+_0x2d2981[_0x530324(0x314)]()[_0x530324(0x2c5)]()[_0x530324(0x38b)](0x2,'0')+'\x20'+_0x2d2981[_0x530324(0x2f8)]()[_0x530324(0x2c5)]()[_0x530324(0x38b)](0x2,'0')+':'+_0x2d2981['getMinutes']()[_0x530324(0x2c5)]()[_0x530324(0x38b)](0x2,'0')+':'+_0x2d2981[_0x530324(0x2fd)]()[_0x530324(0x2c5)]()[_0x530324(0x38b)](0x2,'0');}function getCleanTimeStamp(){const _0x54f7f9=_0x2cf39b,_0x1a132d=shiftedTime();return _0x1a132d[_0x54f7f9(0x2f4)]()+(_0x1a132d[_0x54f7f9(0x28a)]()+0x1)['toString']()[_0x54f7f9(0x38b)](0x2,'0')+_0x1a132d[_0x54f7f9(0x314)]()[_0x54f7f9(0x2c5)]()[_0x54f7f9(0x38b)](0x2,'0')+'-'+_0x1a132d[_0x54f7f9(0x2f8)]()['toString']()[_0x54f7f9(0x38b)](0x2,'0')+_0x1a132d[_0x54f7f9(0x243)]()[_0x54f7f9(0x2c5)]()[_0x54f7f9(0x38b)](0x2,'0')+_0x1a132d[_0x54f7f9(0x2fd)]()['toString']()[_0x54f7f9(0x38b)](0x2,'0');}function shiftedTime(){const _0x5f26d5=_0x2cf39b,_0x670dd3=new Date();let _0x242170=_0x670dd3;if(settings[_0x5f26d5(0x27d)]&&settings[_0x5f26d5(0x27d)]!==0x0)_0x242170=fns['add'](_0x670dd3,{'hours':settings[_0x5f26d5(0x27d)]});return _0x242170;}async function startScheduler(){const _0x4e2cf9=_0x2cf39b,_0x557ace=new Date()[_0x4e2cf9(0x216)](),_0x57b25e=shiftedTime()[_0x4e2cf9(0x2f8)]();_0x57b25e==0x4&&backupConfigFiles(),_0x57b25e==0x0&&(rotateLogFiles(),logger[_0x4e2cf9(0x315)]('--------------------------------------'),logger['debug'](_0x4e2cf9(0x2ba)+serverversion+'#RES#\x20'+(environment==_0x4e2cf9(0x251)?'(staging)':'')),logger['debug']('--------------------------------------')),_0x557ace%0x6==0x0&&triggerAnalytics(),_0x557ace%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0xbb6f59){const _0x49b66e=_0x2cf39b;logger[_0x49b66e(0x315)]('Restore\x20backup\x20file\x20'+_0xbb6f59);const _0x1abe13=getBotsWithMode();_0x1abe13['length']>0x0?confirmRestore(configbackuppath,_0xbb6f59):unzipFile(configbackuppath,_0xbb6f59);}async function getBackupFiles(_0x2dd870=null){const _0x5aeafa=_0x2cf39b;let _0x4854cf=[],_0x5b29df=fs[_0x5aeafa(0x33c)](configbackuppath,{'withFileTypes':!![]});_0x5b29df[_0x5aeafa(0x3be)]((_0x49debc,_0x308871)=>_0x49debc['name']<_0x308871[_0x5aeafa(0x331)]?0x1:_0x308871[_0x5aeafa(0x331)]<_0x49debc[_0x5aeafa(0x331)]?-0x1:0x0),_0x5b29df[_0x5aeafa(0x2c2)](_0x53c4df=>{const _0x285649=_0x5aeafa;if(!_0x53c4df[_0x285649(0x28f)]()&&_0x53c4df[_0x285649(0x331)][_0x285649(0x204)]('backup-full@')&&_0x53c4df[_0x285649(0x331)]['endsWith']('.zip')){const _0x1a2d82=formatDate(fs['statSync'](configbackuppath+_0x53c4df[_0x285649(0x331)])[_0x285649(0x34f)]);_0x4854cf[_0x285649(0x1e0)]({'name':_0x53c4df[_0x285649(0x331)],'mtime':_0x1a2d82});}});if(_0x2dd870)io['to'](_0x2dd870)[_0x5aeafa(0x2a6)](_0x5aeafa(0x230),_0x4854cf);else return _0x4854cf;}async function backupConfigFiles(){const _0x5e92a7=_0x2cf39b;await zipFiles(_0x5e92a7(0x1ff));const _0x5a573c=getCleanTimeStamp();fs[_0x5e92a7(0x235)](zippath+'backup-full.zip',configbackuppath+(_0x5e92a7(0x1c6)+_0x5a573c+_0x5e92a7(0x33d)));let _0x4c6a7d=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x4c6a7d[_0x5e92a7(0x3be)]((_0xd2968a,_0x19d345)=>_0xd2968a[_0x5e92a7(0x331)]<_0x19d345[_0x5e92a7(0x331)]?0x1:_0x19d345['name']<_0xd2968a['name']?-0x1:0x0),_0x4c6a7d[_0x5e92a7(0x1f1)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x4c6a7d[_0x4c6a7d[_0x5e92a7(0x1f1)]-0x1][_0x5e92a7(0x331)]);}function rotateLogFiles(){const _0x15e754=_0x2cf39b,_0x59d9d0=fs[_0x15e754(0x2f5)](logspath+_0x15e754(0x2de)),_0x4cdf4e=_0x59d9d0[_0x15e754(0x281)]/0x400;if(_0x4cdf4e>0x64){let _0x135059=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x135059[_0x15e754(0x3be)]((_0x339655,_0x21c3c2)=>_0x339655['name']<_0x21c3c2['name']?0x1:_0x21c3c2[_0x15e754(0x331)]<_0x339655[_0x15e754(0x331)]?-0x1:0x0),_0x135059[_0x15e754(0x2c2)](_0x2f7a07=>{const _0x18fbb0=_0x15e754;if(_0x2f7a07[_0x18fbb0(0x331)]==_0x18fbb0(0x329))fs[_0x18fbb0(0x235)](logspath+_0x2f7a07[_0x18fbb0(0x331)],logspath+_0x18fbb0(0x210));if(_0x2f7a07[_0x18fbb0(0x331)]=='output-001.log')fs[_0x18fbb0(0x235)](logspath+_0x2f7a07[_0x18fbb0(0x331)],logspath+'output-002.log');_0x2f7a07[_0x18fbb0(0x331)]=='output-000.log'&&(fs['copyFileSync'](logspath+_0x2f7a07[_0x18fbb0(0x331)],logspath+'output-001.log'),fs[_0x18fbb0(0x1f3)](logspath+_0x2f7a07[_0x18fbb0(0x331)],''));});}}async function zipFiles(_0xd38bab){const _0x527f3b=_0x2cf39b;let _0x37bd21;if(_0xd38bab==_0x527f3b(0x3a7))_0x37bd21=logspath;if(_0xd38bab==_0x527f3b(0x36a))_0x37bd21=configpath;if(_0xd38bab=='backup-full')_0x37bd21=configpath;let _0x276dbb=fs['readdirSync'](_0x37bd21,{'withFileTypes':!![]});const _0x5ccbb2=new JSZip();_0x276dbb[_0x527f3b(0x2c2)](_0x41ecab=>{const _0x2d135f=_0x527f3b;if(!_0x41ecab[_0x2d135f(0x28f)]()){let _0x54952e=fs['readFileSync'](_0x37bd21+_0x41ecab[_0x2d135f(0x331)]);if(_0xd38bab==_0x2d135f(0x36a)){const _0x99fc22=/^bot-[0-9]{3}-config.json$/,_0x43f400=_0x99fc22['test'](_0x41ecab['name']);if(_0x43f400){const _0x4972a1=JSON[_0x2d135f(0x395)](_0x54952e);if(_0x4972a1[_0x2d135f(0x2f2)][0x0]){_0x4972a1[_0x2d135f(0x2f2)][0x0]['apiKey']=_0x2d135f(0x3b4),_0x4972a1[_0x2d135f(0x2f2)][0x0][_0x2d135f(0x36f)]=_0x2d135f(0x3b4);if(_0x4972a1[_0x2d135f(0x2f2)][0x0][_0x2d135f(0x3a3)])_0x4972a1[_0x2d135f(0x2f2)][0x0]['apiPassword']='***';}_0x54952e=JSON[_0x2d135f(0x359)](_0x4972a1,null,0x2);}if(_0x41ecab[_0x2d135f(0x331)]==_0x2d135f(0x2ab)){const _0x3cf308=JSON[_0x2d135f(0x395)](_0x54952e);if(_0x3cf308[_0x2d135f(0x232)][_0x2d135f(0x205)])_0x3cf308[_0x2d135f(0x232)][_0x2d135f(0x205)]=![];if(_0x3cf308[_0x2d135f(0x232)][_0x2d135f(0x1f4)])_0x3cf308['settings']['bbPassword']=_0x2d135f(0x3b4);if(_0x3cf308[_0x2d135f(0x232)][_0x2d135f(0x233)])_0x3cf308[_0x2d135f(0x232)][_0x2d135f(0x233)]=_0x2d135f(0x3b4);if(_0x3cf308[_0x2d135f(0x232)]['telegramChatId'])_0x3cf308[_0x2d135f(0x232)][_0x2d135f(0x201)]=null;if(_0x3cf308['settings'][_0x2d135f(0x21a)])_0x3cf308[_0x2d135f(0x232)][_0x2d135f(0x21a)]='***';_0x54952e=JSON[_0x2d135f(0x359)](_0x3cf308,null,0x2);}if(_0x41ecab[_0x2d135f(0x331)]!=_0x2d135f(0x2e8))_0x5ccbb2[_0x2d135f(0x1fe)](_0x41ecab[_0x2d135f(0x331)],_0x54952e);}else _0x5ccbb2['file'](_0x41ecab[_0x2d135f(0x331)],_0x54952e);}});const _0x29255c=await _0x5ccbb2[_0x527f3b(0x25b)]({'type':_0x527f3b(0x2b2),'base64':![],'compression':_0x527f3b(0x1dc)});fs['writeFileSync'](zippath+(_0xd38bab+'.zip'),_0x29255c,_0x527f3b(0x1ce));}async function unzipFile(_0x484517,_0x5c7bb6){const _0x1837c3=_0x2cf39b;fs[_0x1837c3(0x33c)](configpath,{'withFileTypes':!![]})[_0x1837c3(0x2c2)](_0x2abb71=>{const _0x24af4e=_0x1837c3;if(!_0x2abb71[_0x24af4e(0x28f)]())fs[_0x24af4e(0x34b)](configpath+_0x2abb71[_0x24af4e(0x331)]);});const _0x5d67e6=fs[_0x1837c3(0x20d)](_0x484517+_0x5c7bb6,'binary'),_0x137f81=await JSZip['loadAsync'](_0x5d67e6,{'base64':![],'checkCRC32':!![]});for(const _0x548e66 of Object[_0x1837c3(0x234)](_0x137f81['files'])){const _0x59a4d3=_0x137f81['files'][_0x548e66],_0x4ff345=await _0x59a4d3[_0x1837c3(0x3c1)]('string');fs[_0x1837c3(0x1f3)](configpath+_0x59a4d3[_0x1837c3(0x331)],_0x4ff345);}fs[_0x1837c3(0x33c)](temppath,{'withFileTypes':!![]})[_0x1837c3(0x2c2)](_0x5d00c2=>{const _0x20cc84=_0x1837c3;if(!_0x5d00c2[_0x20cc84(0x28f)]())fs[_0x20cc84(0x34b)](temppath+_0x5d00c2[_0x20cc84(0x331)]);}),logger['debug'](_0x1837c3(0x358)),process[_0x1837c3(0x2bd)]({'restore':!![]},_0x142319=>{});}async function getPublicIp(){const _0x40e9ee=_0x2cf39b;try{const _0x59b3c6=await axios[_0x40e9ee(0x1fb)](_0x40e9ee(0x396));publicip=_0x59b3c6['data']['ip'];}catch(_0xd2cd4b){}}async function triggerAnalytics(){const _0xf5b57f=_0x2cf39b;if(!publicip)await getPublicIp();const _0x10eca7=getBotsWithMode();let _0x35c2ba=0x0;_0x10eca7[_0xf5b57f(0x2c2)](_0x1d4742=>{const _0x1a0037=_0xf5b57f;if(_0x1d4742[_0x1a0037(0x3ae)]===_0x1a0037(0x1ba))_0x35c2ba++;});const _0x457c5e=getBotExchanges();mixpanel[_0xf5b57f(0x1f2)](_0xf5b57f(0x357),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x10eca7[_0xf5b57f(0x1f1)],'numbotsenabled':_0x35c2ba,'exchanges':_0x457c5e,'environment':environment});}async function getMessages(){const _0x156569=_0x2cf39b,_0x3cb8f2='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x45c4d1=new GraphQLClient(_0x3cb8f2),_0x58f727={'authorization':_0x156569(0x248)},_0x5aefae=serverversion[_0x156569(0x2d7)]('.'),_0x4221df=_0x5aefae[0x0]+'.'+_0x5aefae[0x1],_0x3b8884=Math[_0x156569(0x3bb)](settings['lastmsgtelegram'],settings['lastmsgemitted']),_0x59622a={'last':parseInt(_0x3b8884),'bbm':_0x4221df},_0x4b0ead=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x28ff15;try{_0x28ff15=await _0x45c4d1['request'](_0x4b0ead,_0x59622a,_0x58f727);}catch(_0x53b240){}if(_0x28ff15&&_0x28ff15[_0x156569(0x2c6)]){let _0x1f842b=settings[_0x156569(0x1d1)];newMessages=[];for(const _0x50b2c2 of _0x28ff15[_0x156569(0x2c6)]){newMessages['push'](_0x50b2c2);let _0x2cf3b6=![];_0x50b2c2[_0x156569(0x240)]&&(updateSetting('latestversion',_0x50b2c2['bbvNew']),_0x2cf3b6=isNewerVersion(serverversion,_0x50b2c2[_0x156569(0x240)])||serverversion==_0x50b2c2[_0x156569(0x240)]);if(!_0x2cf3b6&&_0x50b2c2[_0x156569(0x388)]>_0x1f842b){if(_0x50b2c2[_0x156569(0x2fe)]===_0x156569(0x344)||serverversion[_0x156569(0x204)](_0x50b2c2[_0x156569(0x2fe)])){let _0x854699=''+_0x50b2c2[_0x156569(0x300)]+'\x0a\x0a'+_0x50b2c2[_0x156569(0x365)];const _0x5e5120=await sendTelegramMsg(toTelegramMarkdown(_0x854699),'Markdown');if(_0x5e5120)_0x1f842b=_0x50b2c2[_0x156569(0x388)];}}}updateAvailable=isNewerVersion(settings[_0x156569(0x222)],serverversion),updateSetting('lastmsgtelegram',_0x1f842b),emitMessages();}}function emitMessages(){const _0x31572a=_0x2cf39b,_0xfe0ae4=settings[_0x31572a(0x2c0)];let _0x5c734c=[];newMessages[_0x31572a(0x2c2)](_0x2455d6=>{const _0x56581b=_0x31572a;_0x2455d6[_0x56581b(0x388)]>_0xfe0ae4&&_0x5c734c[_0x56581b(0x1e0)](_0x2455d6);}),_0x5c734c[_0x31572a(0x1f1)]>0x0&&getAllClients()[_0x31572a(0x2c2)](_0x3dcf9e=>{const _0x2ecc8d=_0x31572a;getSocket(_0x3dcf9e['id'])[_0x2ecc8d(0x2a6)](_0x2ecc8d(0x365),_0x5c734c);});}function confirmMessage(_0x20fbc2){const _0x135c09=_0x2cf39b;updateSetting(_0x135c09(0x2c0),Number(_0x20fbc2));}function isNewerVersion(_0x4de7a9,_0x25b9ae){const _0x5484b4=_0x2cf39b,_0x5eedde=_0x25b9ae['split']('.'),_0x22771d=_0x4de7a9[_0x5484b4(0x2d7)]('.');for(var _0x3821bd=0x0;_0x3821bd<_0x22771d['length'];_0x3821bd++){const _0x1e6b24=~~_0x22771d[_0x3821bd],_0x20c2c3=~~_0x5eedde[_0x3821bd];if(_0x1e6b24>_0x20c2c3)return!![];if(_0x1e6b24<_0x20c2c3)return![];}return![];}function toTelegramMarkdown(_0x29454b){const _0x599c3d=_0x2cf39b,_0x31f05c=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x140705=/\*{2}(.+?)\*{2}/gim;return _0x29454b=_0x29454b['replace'](_0x31f05c,_0x599c3d(0x25d))[_0x599c3d(0x2b9)](_0x140705,_0x599c3d(0x221)),_0x29454b;}async function validateConfigFile(){const _0x4e839e=_0x2cf39b,_0x10584b=dbConfig[_0x4e839e(0x1fb)](_0x4e839e(0x3a6))[_0x4e839e(0x330)](_0x4e839e(0x1eb))['value']()||[];if(_0x10584b[_0x4e839e(0x1f1)]==0x0){let _0xa8ba4e=0x0,_0x518f69=[];const _0x1b7193=/^bot-([0-9]{3})-config.json$/,_0x54f10b=fs['readdirSync'](configpath);_0x54f10b['forEach'](_0x4332df=>{const _0x27cfb8=_0x4e839e,_0x1a98eb=_0x1b7193[_0x27cfb8(0x31e)](_0x4332df);if(_0x1a98eb){const _0x28407e=_0x1a98eb[0x1];let _0x217a9c=getBotAttributes(_0x28407e);_0x518f69[_0x27cfb8(0x1e0)]({'botID':_0x28407e,'botname':_0x217a9c[_0x27cfb8(0x37b)],'status':_0x27cfb8(0x319),'live':_0x27cfb8(0x3b1)}),_0xa8ba4e++;}}),_0xa8ba4e!=0x0&&(dbConfig[_0x4e839e(0x1fb)](_0x4e839e(0x3a6))[_0x4e839e(0x1b5)](_0x518f69)['write'](),config=_0x518f69,restoredConfigFile=_0xa8ba4e);}}async function restoreConfigNotify(_0x44e531){const _0x53c07b=_0x2cf39b;let _0x4ba067;if(restoredConfigFile==0x1)_0x4ba067=_0x53c07b(0x1d3);else _0x4ba067=_0x53c07b(0x20a);if(_0x44e531)io['to'](_0x53c07b(0x2b3))[_0x53c07b(0x2a6)](_0x53c07b(0x231),_0x4ba067);else{logger[_0x53c07b(0x32f)](_0x53c07b(0x2ad)),logger[_0x53c07b(0x32f)](_0x4ba067),logger['simple'](_0x53c07b(0x2ad)),logger[_0x53c07b(0x32f)]('');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x53c07b(0x34c))await sendTelegram(settings['telegramChatId'],_0x53c07b(0x2e9)+_0x4ba067);}}function decryptRSA(_0x188b5b,_0x39e661){const _0x50472a=_0x2cf39b,_0xd68c9c=forge['pki'][_0x50472a(0x39b)](_0x188b5b),_0x1d4b23=_0xd68c9c['decrypt'](forge[_0x50472a(0x252)][_0x50472a(0x1c4)](_0x39e661),_0x50472a(0x214),{'md':forge['md'][_0x50472a(0x2dc)][_0x50472a(0x21d)](),'mgf1':{'md':forge['md']['sha256'][_0x50472a(0x21d)]()}});return _0x1d4b23;}function validateCredentials(_0x22c088,_0x56002c){const _0x179246=_0x2cf39b;if(_0x22c088['username']==settings[_0x179246(0x391)]&&bcrypt[_0x179246(0x24f)](_0x22c088[_0x179246(0x275)],settings['bbPassword'])){if(settings[_0x179246(0x37c)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x2a7ead=generateLoginToken(_0x56002c);return{'allow':!![],'reason':_0x179246(0x384),'token':_0x2a7ead};}}else return{'allow':![],'reason':_0x179246(0x1e6),'token':null};}function refreshToken(_0x3d3123){const _0x2549ee=_0x2cf39b,_0x130953=generateLoginToken(_0x3d3123);return{'allow':!![],'reason':_0x2549ee(0x384),'token':_0x130953};}function validateAccess(_0x906d07,_0x21f4b8,_0x28e703){const _0x580847=_0x2cf39b,_0x274293=_0x28e703?_0x28e703:devices[_0x21f4b8]['ip'];let _0x180998;const _0x5bd7e3=_0x2664ba=>{const _0x2800e1=_0x3e11;if(settings[_0x2800e1(0x205)]){if(settings[_0x2800e1(0x37c)]){if(telegram2FaApproved(_0x21f4b8)){const _0x1e84ea=generateLoginToken(_0x21f4b8);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x1e84ea};}else return{'allow':![],'reason':_0x2800e1(0x2d6),'token':null};}else return _0x180998=validToken(_0x2664ba,_0x21f4b8),_0x180998[_0x2800e1(0x23b)](_0x2800e1(0x3ba))?{'allow':!![],'reason':_0x2800e1(0x367),'token':_0x2664ba}:{'allow':![],'reason':_0x2800e1(0x2d6),'token':null};}else return{'allow':!![],'reason':_0x2800e1(0x2d9),'token':null};};if(settings['whitelistEnabled']){let _0x593d59=[...settings[_0x580847(0x2f6)],_0x580847(0x1ef),_0x580847(0x202),'127.0.0.1'];if(_0x593d59[_0x580847(0x352)](_0x274293))return _0x5bd7e3(_0x906d07);else{_0x180998=validToken(_0x906d07,_0x21f4b8);if(_0x180998['hasOwnProperty'](_0x580847(0x3ba)))return _0x5bd7e3(_0x906d07);else{if(telegramIpApproved(_0x21f4b8)){const _0x2901a4=generateToken(_0x21f4b8);return _0x180998=_0x5bd7e3(_0x906d07),_0x180998[_0x580847(0x39c)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x2901a4}:_0x180998;}else return settings[_0x580847(0x29f)]?{'allow':![],'reason':_0x580847(0x1de),'token':null}:{'allow':![],'reason':_0x580847(0x2bc),'token':null};}}}else return _0x5bd7e3(_0x906d07);}function timelyDecrypt(_0x1c517f,_0x303132,_0x2fbbfa='@'){const _0x5326ae=_0x2cf39b;if(_0x1c517f)try{const _0xf7880=decryptRSA(secure[_0x5326ae(0x242)],_0x1c517f),_0xa46c0c=_0xf7880[_0x5326ae(0x2d7)](_0x2fbbfa)[0x0],_0x1d8cb9=_0xf7880['split'](_0x2fbbfa)[0x1],_0x308395=new Date()[_0x5326ae(0x328)]();if(_0x303132){if(_0x308395-_0x1d8cb9<maxSecretAge*0x3e8)return _0xa46c0c;else return![];}else return _0xa46c0c;}catch(_0x2a7c75){return![];}else return![];}const validToken=(_0xfcf4f9,_0x3f9725)=>{const _0x24224c=_0x2cf39b,_0x93f609=devices[_0x3f9725]['ip'];if(!_0xfcf4f9)return{'error':'No\x20authentication\x20token'};for(let _0x4142c6 of blacklist){if(_0x4142c6[_0x24224c(0x3a5)]==_0xfcf4f9)return{'error':_0x24224c(0x297)};}let _0x11e98b;try{_0x11e98b=jwt[_0x24224c(0x372)](_0xfcf4f9,secure[_0x24224c(0x291)]+_0x3f9725);}catch{return{'error':_0x24224c(0x29c)};}if(!_0x11e98b[_0x24224c(0x23b)](_0x24224c(0x351))&&!_0x11e98b[_0x24224c(0x23b)](_0x24224c(0x1d2))||!_0x11e98b[_0x24224c(0x23b)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x11e98b[_0x24224c(0x23b)]('username')&&_0x11e98b[_0x24224c(0x23b)](_0x24224c(0x351))){const {clientip:_0xa5e4e4}=_0x11e98b;return _0x93f609==_0xa5e4e4?{'success':_0x24224c(0x382)}:{'error':_0x24224c(0x1d8)};}else{if(_0x11e98b[_0x24224c(0x23b)](_0x24224c(0x1d2))&&_0x11e98b[_0x24224c(0x23b)](_0x24224c(0x351))){const {username:_0x3cd26a,clientip:_0x17b55a}=_0x11e98b;return settings[_0x24224c(0x391)]==_0x3cd26a&&_0x93f609==_0x17b55a?{'success':_0x24224c(0x382)}:{'error':_0x24224c(0x269)};}}},generateLoginToken=_0x2adcc4=>{const _0x3bf437=_0x2cf39b;if(_0x2adcc4){const _0x146874=devices[_0x2adcc4]['ip'];return jwt[_0x3bf437(0x307)]({'username':settings[_0x3bf437(0x391)],'clientip':_0x146874},secure[_0x3bf437(0x291)]+_0x2adcc4,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x51f3b5=>{const _0x428093=_0x2cf39b;if(_0x51f3b5){const _0x36d5d6=devices[_0x51f3b5]['ip'];return jwt['sign']({'clientip':_0x36d5d6},secure[_0x428093(0x291)]+_0x51f3b5,{'expiresIn':devices[_0x51f3b5]['telegramIpApproval'][_0x428093(0x238)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x34423b=>{const _0x59b45e=_0x2cf39b;let _0x26c92b=![];return devices[_0x34423b][_0x59b45e(0x267)]&&devices[_0x34423b][_0x59b45e(0x267)][_0x59b45e(0x238)]!=_0x59b45e(0x28c)&&(_0x26c92b=devices[_0x34423b][_0x59b45e(0x267)][_0x59b45e(0x351)]==devices[_0x34423b]['ip']&&new Date()[_0x59b45e(0x328)]()-devices[_0x34423b][_0x59b45e(0x267)][_0x59b45e(0x2c1)]<devices[_0x34423b]['telegramIpApproval'][_0x59b45e(0x238)]*0x3c*0x3e8),_0x26c92b;},telegram2FaApproved=_0x9607b9=>{const _0x44882c=_0x2cf39b;let _0x28b2f9=![];return devices[_0x9607b9]['telegram2FaApproval']&&devices[_0x9607b9]['telegram2FaApproval'][_0x44882c(0x238)]!=_0x44882c(0x28c)&&(_0x28b2f9=devices[_0x9607b9]['telegram2FaApproval']['clientip']==devices[_0x9607b9]['ip']&&new Date()[_0x44882c(0x328)]()-devices[_0x9607b9]['telegram2FaApproval'][_0x44882c(0x2c1)]<devices[_0x9607b9][_0x44882c(0x1db)][_0x44882c(0x238)]*0x3c*0x3e8),_0x28b2f9;},normalizeIP=_0xb67a4=>{const _0x36f470=_0x2cf39b;let _0x4815b5=null,_0x2f809a=null;if(ipaddr[_0x36f470(0x296)](_0xb67a4)){const _0x223822=ipaddr['parse'](_0xb67a4);_0x223822[_0x36f470(0x23d)]()===_0x36f470(0x3bf)?(_0x223822[_0x36f470(0x1bc)]()&&(_0x4815b5=_0x223822[_0x36f470(0x377)]()[_0x36f470(0x2c5)]()),_0x2f809a=_0x223822[_0x36f470(0x2c5)]()):(_0x4815b5=_0x223822[_0x36f470(0x2c5)](),_0x2f809a=_0x223822[_0x36f470(0x2e0)]()[_0x36f470(0x2c5)]());}return{'show':_0x4815b5?_0x4815b5:_0x2f809a,'store':_0x2f809a};};function formatDate(_0x3996ac){const _0x34916e=_0x2cf39b;return _0x3996ac[_0x34916e(0x2f4)]()+'/'+(_0x3996ac[_0x34916e(0x28a)]()+0x1)[_0x34916e(0x2c5)]()[_0x34916e(0x38b)](0x2,'0')+'/'+_0x3996ac[_0x34916e(0x314)]()[_0x34916e(0x2c5)]()['padStart'](0x2,'0')+'\x20'+_0x3996ac[_0x34916e(0x2f8)]()[_0x34916e(0x2c5)]()[_0x34916e(0x38b)](0x2,'0')+':'+_0x3996ac[_0x34916e(0x243)]()['toString']()[_0x34916e(0x38b)](0x2,'0')+':'+_0x3996ac[_0x34916e(0x2fd)]()[_0x34916e(0x2c5)]()[_0x34916e(0x38b)](0x2,'0');}function sleep(_0x208066){return new Promise(_0x3f0ea8=>setTimeout(_0x3f0ea8,_0x208066));}