const _0x480a86=_0x55da;(function(_0xf44b79,_0xbc06f9){const _0x57373d=_0x55da,_0x1f7225=_0xf44b79();while(!![]){try{const _0x1861ac=parseInt(_0x57373d(0x351))/0x1+parseInt(_0x57373d(0x316))/0x2+parseInt(_0x57373d(0x339))/0x3+parseInt(_0x57373d(0x2e7))/0x4+-parseInt(_0x57373d(0x318))/0x5+-parseInt(_0x57373d(0x3c3))/0x6*(parseInt(_0x57373d(0x285))/0x7)+-parseInt(_0x57373d(0x25d))/0x8;if(_0x1861ac===_0xbc06f9)break;else _0x1f7225['push'](_0x1f7225['shift']());}catch(_0x474cc0){_0x1f7225['push'](_0x1f7225['shift']());}}}(_0x20eb,0x8eee5));const _0x567318=function(){let _0x246cef=!![];return function(_0xe3f19a,_0x14fe3f){const _0x3f2491=_0x246cef?function(){const _0x4b1389=_0x55da;if(_0x14fe3f){const _0x4b4ab0=_0x14fe3f[_0x4b1389(0x3ed)](_0xe3f19a,arguments);return _0x14fe3f=null,_0x4b4ab0;}}:function(){};return _0x246cef=![],_0x3f2491;};}(),_0x45e004=_0x567318(this,function(){const _0x1cef01=_0x55da;return _0x45e004['toString']()[_0x1cef01(0x350)](_0x1cef01(0x319))[_0x1cef01(0x209)]()['constructor'](_0x45e004)[_0x1cef01(0x350)](_0x1cef01(0x319));});_0x45e004();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require('date-fns'),low=require(_0x480a86(0x379)),FileSync=require(_0x480a86(0x200)),path=require(_0x480a86(0x33a)),crypto=require(_0x480a86(0x1f9)),forge=require(_0x480a86(0x34d)),bcrypt=require(_0x480a86(0x34f)),jwt=require('jsonwebtoken'),ipaddr=require('ipaddr.js'),argv=require(_0x480a86(0x36c))(process['argv'][_0x480a86(0x313)](0x2))[_0x480a86(0x21d)],uuidRandom=require(_0x480a86(0x33e)),{Telegraf,Markup}=require(_0x480a86(0x3c1)),Mixpanel=require(_0x480a86(0x21e)),axios=require(_0x480a86(0x297)),{GraphQLClient,gql}=require(_0x480a86(0x35e)),util=require('util'),fileUpload=require(_0x480a86(0x278)),{networkInterfaces}=require('os'),JSZip=require(_0x480a86(0x328)),PORT=argv[_0x480a86(0x25e)]||_0x480a86(0x3de),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x480a86(0x3a2)](_0x480a86(0x30b)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x480a86(0x22f)](0x1));const HOST=argv[_0x480a86(0x34b)]||null,userID=argv[_0x480a86(0x39c)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process['versions'][_0x480a86(0x385)];let bbpath=_0x480a86(0x23a),bbpath2='';const botfile=_0x480a86(0x226),configfile=_0x480a86(0x3a4),settingsfile=_0x480a86(0x2e4),securefile=_0x480a86(0x207),environment=require('./'+bbpath2+_0x480a86(0x30a))[_0x480a86(0x35c)]||_0x480a86(0x24a),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x480a86(0x230)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x480a86(0x221)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x480a86(0x201),configbackuppath=configpath+_0x480a86(0x234),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x480a86(0x270),zippath=userID?bbpath+_0x480a86(0x348)+userID+'/':bbpath+_0x480a86(0x348),loggerfile=fs[_0x480a86(0x375)](logspath+_0x480a86(0x1fc),{'flags':'a'}),temppath=userID?bbpath+_0x480a86(0x376)+userID+'/':bbpath+_0x480a86(0x376);!fs[_0x480a86(0x230)](configpath)&&fs[_0x480a86(0x364)](configpath);!fs[_0x480a86(0x230)](configbackuppath)&&fs[_0x480a86(0x364)](configbackuppath);!fs[_0x480a86(0x230)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x480a86(0x230)](zippath)&&fs[_0x480a86(0x364)](zippath);!fs[_0x480a86(0x230)](temppath)&&fs[_0x480a86(0x364)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x480a86(0x3dd)]({'bots':[]})[_0x480a86(0x2ed)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x480a86(0x3dd)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x480a86(0x2f8),'onepagemode':![],'marketcapApi':''}})[_0x480a86(0x2ed)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x480a86(0x3dd)]({'secure':{},'blacklist':[]})[_0x480a86(0x2ed)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x480a86(0x310)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x480a86(0x3e2)]&&(settings[_0x480a86(0x3e2)]!=''&&settings['telegramToken']!=_0x480a86(0x308))&&settings[_0x480a86(0x2cb)]&&settings[_0x480a86(0x2cb)]!='')initTelegram();const parseColor=(_0x46e15a,_0xbba945)=>{const _0xc37d5f=_0x480a86,_0x398283=/#[A-Z]{3}#/g;if(typeof _0x46e15a==_0xc37d5f(0x204)){!_0xbba945?_0x46e15a=_0x46e15a['replace'](_0x398283,''):(_0x46e15a=_0x46e15a[_0xc37d5f(0x382)](/#BLU#/g,_0xc37d5f(0x346)),_0x46e15a=_0x46e15a[_0xc37d5f(0x382)](/#RED#/g,_0xc37d5f(0x25c)),_0x46e15a=_0x46e15a[_0xc37d5f(0x382)](/#YEL#/g,_0xc37d5f(0x331)),_0x46e15a=_0x46e15a[_0xc37d5f(0x382)](/#MAG#/g,_0xc37d5f(0x340)),_0x46e15a=_0x46e15a[_0xc37d5f(0x382)](/#CYA#/g,'\x1b[36m'),_0x46e15a=_0x46e15a['replace'](/#RES#/g,_0xc37d5f(0x315)));;}return _0x46e15a;},logger={'screen':_0xe87124=>{const _0x42fa52=_0x480a86;console[_0x42fa52(0x3a2)](parseColor(_0xe87124,!![]));},'simple':_0xa460ea=>{const _0x144f25=_0x480a86;console[_0x144f25(0x3a2)](parseColor(_0xa460ea,!![])),loggerfile[_0x144f25(0x2ed)](util[_0x144f25(0x335)](parseColor(_0xa460ea,![]))+'\x0a');},'full':async _0xa23cd2=>{const _0x1c71b8=_0x480a86,_0x3633f7=getTimeStamp()+_0x1c71b8(0x2f5)+_0xa23cd2;console['log'](parseColor(_0x3633f7,!![])),loggerfile[_0x1c71b8(0x2ed)](util[_0x1c71b8(0x335)](parseColor(_0x3633f7,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x1c71b8(0x35a))await sendTelegram(settings[_0x1c71b8(0x28f)],_0x1c71b8(0x27c)+parseColor(_0xa23cd2,![]));},'debug':async(_0x293fa4,_0x481984='')=>{const _0x1bb88d=_0x480a86,_0x43425c=getTimeStamp()+_0x1bb88d(0x3d1)+_0x293fa4;if(debugging)console[_0x1bb88d(0x3a2)](parseColor(_0x43425c,!![]));loggerfile[_0x1bb88d(0x2ed)](util[_0x1bb88d(0x335)](parseColor(_0x43425c,![]))+'\x0a');if(_0x481984){if(debugging)console['log'](_0x481984);loggerfile[_0x1bb88d(0x2ed)](util[_0x1bb88d(0x335)](_0x481984)+'\x0a');}}};let terminating=![];process['on'](_0x480a86(0x24d),function(_0x2c4de9){const _0x577465=_0x480a86;_0x2c4de9['toString']()[_0x577465(0x39b)](_0x577465(0x394))?(logger[_0x577465(0x377)]('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x2c4de9[_0x577465(0x25e)]+_0x577465(0x279)),process[_0x577465(0x1d4)]({'terminate':!![]},_0x5907ff=>{})):logger[_0x577465(0x377)](_0x2c4de9);}),process['on'](_0x480a86(0x22f),()=>{const _0x837850=_0x480a86;stopAllBots(),process[_0x837850(0x22f)](0x0);}),process['on'](_0x480a86(0x1ec),()=>{const _0x35c7ec=_0x480a86;stopAllBots(),process[_0x35c7ec(0x22f)](0x0);}),process['on'](_0x480a86(0x237),()=>{const _0x131bd7=_0x480a86;stopAllBots(),process[_0x131bd7(0x22f)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x480a86(0x30a))[_0x480a86(0x2ef)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x480a86(0x3b6)),app=express(),http=require('http')[_0x480a86(0x249)](app);app[_0x480a86(0x2d9)](fileUpload({'useTempFiles':!![]})),app[_0x480a86(0x29c)]('/download/:type',async(_0x28a5cb,_0x14c246)=>{const _0x433b7b=_0x480a86,_0x38a21b=_0x28a5cb[_0x433b7b(0x359)][_0x433b7b(0x25b)],_0x185688=getClientsWithBotID(_0x433b7b(0x288)),_0x442b4d=_0x28a5cb[_0x433b7b(0x3f2)][_0x433b7b(0x23b)],_0x22c637=timelyDecrypt(_0x442b4d,![]),_0x3ac147=_0x185688[_0x433b7b(0x343)](_0x1b56fb=>_0x1b56fb[_0x433b7b(0x23b)]==_0x22c637);if(_0x3ac147){const _0x2888b0=normalizeIP(_0x28a5cb[_0x433b7b(0x2ab)]['remoteAddress'])[_0x433b7b(0x2de)],_0xdd7edd=_0x28a5cb['headers'][_0x433b7b(0x3ad)];if(validateAccess(_0xdd7edd,_0x22c637,_0x2888b0)[_0x433b7b(0x26e)])_0x38a21b==_0x433b7b(0x33f)&&await backupConfigFiles(),await zipFiles(_0x38a21b),_0x14c246[_0x433b7b(0x39e)](zippath+(_0x38a21b+'.zip'),_0x577f91=>{const _0x2af0db=_0x433b7b;_0x577f91&&(logger['full'](_0x2af0db(0x3ab)+_0x38a21b),logger[_0x2af0db(0x377)](_0x577f91));});else logger[_0x433b7b(0x31b)](_0x433b7b(0x3bb)+_0x38a21b+'\x20(1)');}else logger[_0x433b7b(0x31b)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x38a21b+_0x433b7b(0x2e5));}),app['post'](_0x480a86(0x263),async(_0x4daed8,_0x193d3b)=>{const _0x4632af=_0x480a86,_0x3eea1e=getClientsWithBotID(_0x4632af(0x288)),_0x3b5eb4=_0x4daed8[_0x4632af(0x3f2)][_0x4632af(0x23b)],_0x1ad818=timelyDecrypt(_0x3b5eb4,![]),_0x509871=_0x3eea1e[_0x4632af(0x343)](_0x1d7e65=>_0x1d7e65[_0x4632af(0x23b)]==_0x1ad818);logger['debug'](_0x4632af(0x30f));if(_0x509871){const _0x4ddf59=normalizeIP(_0x4daed8[_0x4632af(0x2ab)][_0x4632af(0x2da)])['store'],_0xddec6=_0x4daed8[_0x4632af(0x3f2)]['tkn'];if(validateAccess(_0xddec6,_0x1ad818,_0x4ddf59)[_0x4632af(0x26e)]){if(_0x4daed8[_0x4632af(0x202)]){const _0x160658=_0x4daed8['files'][_0x4632af(0x1f0)];await _0x160658['mv'](temppath+_0x160658[_0x4632af(0x330)]),_0x193d3b[_0x4632af(0x1d4)]({'status':!![],'message':_0x4632af(0x25a)});const _0x1def64=getBotsWithMode();_0x1def64[_0x4632af(0x2bc)]>0x0?confirmRestore(temppath,_0x160658[_0x4632af(0x330)]):unzipFile(temppath,_0x160658[_0x4632af(0x330)]);}}else logger[_0x4632af(0x31b)](_0x4632af(0x36d));}else logger[_0x4632af(0x31b)](_0x4632af(0x2c5));}),app[_0x480a86(0x2d9)](express['static'](path['join'](__dirname,bbpath2,_0x480a86(0x3b8)))),app['use'](express['static'](path[_0x480a86(0x2ae)](__dirname,bbpath2,_0x480a86(0x250)))),app['get']('/',function(_0x3df8d9,_0x28ed99){const _0x591865=_0x480a86;_0x28ed99[_0x591865(0x323)](path[_0x591865(0x2ae)](__dirname,bbpath2,_0x591865(0x3b8),_0x591865(0x1d6)));}),app['get'](_0x480a86(0x3e9),function(_0x38507d,_0x2de083){const _0x4d9335=_0x480a86;_0x2de083[_0x4d9335(0x323)](path[_0x4d9335(0x2ae)](__dirname,bbpath2,_0x4d9335(0x250),_0x4d9335(0x1d6)));}),app[_0x480a86(0x29c)](_0x480a86(0x338),(_0x2abd71,_0x33e83d)=>{const _0x213b09=_0x480a86;_0x33e83d['sendFile'](path[_0x213b09(0x2ae)](__dirname,bbpath2,_0x213b09(0x250),_0x213b09(0x1d6)));}),app[_0x480a86(0x29c)](_0x480a86(0x283),(_0xaf5a6f,_0x227a0c)=>{const _0x527034=_0x480a86;_0x227a0c[_0x527034(0x323)](path[_0x527034(0x2ae)](__dirname,bbpath2,_0x527034(0x250),'index.html'));}),app[_0x480a86(0x29c)](_0x480a86(0x27e),(_0x4cff0a,_0x2ea07b)=>{const _0x108e1a=_0x480a86;_0x2ea07b[_0x108e1a(0x323)](path[_0x108e1a(0x2ae)](__dirname,bbpath2,_0x108e1a(0x250),_0x108e1a(0x1d6)));}),app[_0x480a86(0x29c)](_0x480a86(0x21b),(_0xacbf0d,_0x5e7429)=>{const _0x58a79d=_0x480a86;_0x5e7429['sendFile'](path[_0x58a79d(0x2ae)](__dirname,bbpath2,_0x58a79d(0x250),_0x58a79d(0x1d6)));}),app[_0x480a86(0x29c)]('/:bot/configuration',(_0x167909,_0x194773)=>{const _0x2e9803=_0x480a86;_0x194773[_0x2e9803(0x323)](path[_0x2e9803(0x2ae)](__dirname,bbpath2,'build',_0x2e9803(0x1d6)));}),app['get'](_0x480a86(0x246),(_0xe6aa4,_0x320310)=>{const _0x3c196d=_0x480a86;_0x320310[_0x3c196d(0x323)](path[_0x3c196d(0x2ae)](__dirname,bbpath2,_0x3c196d(0x250),_0x3c196d(0x1d6)));});if(HOST)http[_0x480a86(0x2dc)](PORT,HOST);else http['listen'](PORT);const io=require(_0x480a86(0x3a9))(http,{});openBrowser&&(async()=>{const _0x66376f=_0x480a86,_0xcd8981=(await import(_0x66376f(0x31f)))[_0x66376f(0x314)];await _0xcd8981(_0x66376f(0x205)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x258031=_0x480a86;let _0xaaf16e='[ip-address]';const _0xb0fbc2=networkInterfaces(),_0x1df4e8={};for(const _0x5585bf of Object[_0x258031(0x22b)](_0xb0fbc2)){for(const _0x1de354 of _0xb0fbc2[_0x5585bf]){if((_0x1de354[_0x258031(0x2f4)]==_0x258031(0x3a7)||_0x1de354[_0x258031(0x2f4)]==0x4)&&!_0x1de354['internal']){const _0x201a14=ipaddr['parse'](_0x1de354[_0x258031(0x33b)])[_0x258031(0x3a3)]();_0x201a14!=_0x258031(0x281)&&(!_0x1df4e8[_0x5585bf]&&(_0x1df4e8[_0x5585bf]=[]),_0x1df4e8[_0x5585bf][_0x258031(0x358)](_0x1de354['address']),_0xaaf16e=_0x1de354[_0x258031(0x33b)]);}}}return{'serverip':_0xaaf16e,'netinterfaces':_0x1df4e8};}async function startServer(){const _0x4c1480=_0x480a86,{serverip:_0x196f3c,netinterfaces:_0x2da674}=getServerIP();logger[_0x4c1480(0x377)](''),logger[_0x4c1480(0x377)](_0x4c1480(0x33c)),await logger[_0x4c1480(0x31b)](_0x4c1480(0x3f0)+serverversion+'#RES#\x20'+(environment==_0x4c1480(0x1e3)?_0x4c1480(0x264):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x4c1480(0x266))+(_0x4c1480(0x2e6)+_0x196f3c+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x4c1480(0x377)](_0x4c1480(0x33c));if(config[_0x4c1480(0x2bc)]!=0x0)for(const _0x31dd5a of config){const _0x2d5d2b=_0x31dd5a[_0x4c1480(0x362)]==_0x4c1480(0x305)?'a':'m';if(_0x31dd5a['status']==_0x4c1480(0x1cf)||_0x31dd5a[_0x4c1480(0x3dc)]==_0x4c1480(0x29b))await logger[_0x4c1480(0x31b)]('Starting\x20('+_0x2d5d2b+_0x4c1480(0x282)+_0x31dd5a[_0x4c1480(0x386)]+_0x4c1480(0x2b8)+_0x31dd5a[_0x4c1480(0x26a)]),startBot([_0x31dd5a['botID'],userID],{'cwd':bbpath},function(_0x20c999){const _0x537716=_0x4c1480;if(_0x20c999)logger[_0x537716(0x31b)](_0x20c999);});else(_0x31dd5a[_0x4c1480(0x3dc)]==_0x4c1480(0x326)||_0x31dd5a['status']==_0x4c1480(0x3b1))&&await logger[_0x4c1480(0x31b)](_0x4c1480(0x2a5)+_0x2d5d2b+')\x20\x20\x20|\x20Bot\x20'+_0x31dd5a['botID']+_0x4c1480(0x2b8)+_0x31dd5a['botname']);}else!newBot&&logger['simple'](_0x4c1480(0x236));if(newBot)addBot();logger['simple'](_0x4c1480(0x33c)),logger[_0x4c1480(0x377)](''),await logger[_0x4c1480(0x235)]('Node.js\x20v'+nodeversion),await logger['debug']('Network\x20Interfaces:',_0x2da674);}function startSocket(){const _0x339556=_0x480a86;io['on'](_0x339556(0x37e),_0x4bf773=>{const _0x3a6421=_0x339556;let _0x4b1cb9,_0x3d9c7e,_0x3ac0bd,_0x1c4950,_0xddf7ca;const _0x5db603=_0x4bf773[_0x3a6421(0x374)]['headers'][_0x3a6421(0x21a)];_0x3d9c7e=_0x5db603[_0x3a6421(0x29a)](/bot[0-9]{3}/);if(_0x3d9c7e)_0x3ac0bd=_0x3d9c7e[0x0]['match'](/[0-9]{3}/);if(_0x3ac0bd)_0x4b1cb9=_0x3ac0bd[0x0];else _0x4b1cb9=_0x3a6421(0x288);const _0x40edaa=_0x4bf773[_0x3a6421(0x374)]['auth'][_0x3a6421(0x2df)];if(!_0x40edaa)_0x4bf773['emit'](_0x3a6421(0x3dc),{'publicKey':secure[_0x3a6421(0x32e)]});else{_0x1c4950=timelyDecrypt(_0x40edaa,![]);if(!_0x1c4950)_0x4bf773[_0x3a6421(0x336)](_0x3a6421(0x3dc),{'publicKey':secure[_0x3a6421(0x32e)]});else{_0xddf7ca=normalizeIP(_0x4bf773['conn'][_0x3a6421(0x2da)])[_0x3a6421(0x2de)];if(!devices[_0x1c4950])devices[_0x1c4950]={'uuid':_0x1c4950,'access':{'token':null}};devices[_0x1c4950]['ip']=_0xddf7ca;const _0x3973cf=addClient(_0x4bf773['id'],_0x1c4950,_0x4b1cb9);setAccess(_0x3973cf),emitMessages(),_0x4bf773['on'](_0x3a6421(0x356),_0x51645a=>{const _0x159d10=_0x3a6421,_0x6fc3e8=timelyDecrypt(_0x51645a[_0x159d10(0x2aa)],!![],_0x159d10(0x299));if(_0x6fc3e8){_0x51645a={'username':_0x51645a[_0x159d10(0x3ef)],'password':_0x6fc3e8},devices[_0x1c4950][_0x159d10(0x3c5)]=validateCredentials(_0x51645a,_0x1c4950);if(devices[_0x1c4950][_0x159d10(0x3c5)]['allow']==![]&&devices[_0x1c4950][_0x159d10(0x3c5)][_0x159d10(0x3c8)]==_0x159d10(0x320))_0x4bf773[_0x159d10(0x336)](_0x159d10(0x3dc),{'access':devices[_0x1c4950][_0x159d10(0x3c5)]}),loginAccess2FA(_0x1c4950,_0xddf7ca);else{if(devices[_0x1c4950][_0x159d10(0x3c5)][_0x159d10(0x26e)]==![]&&devices[_0x1c4950][_0x159d10(0x3c5)][_0x159d10(0x3c8)]==_0x159d10(0x218))_0x4bf773[_0x159d10(0x336)]('status',{'access':devices[_0x1c4950][_0x159d10(0x3c5)]});else devices[_0x1c4950][_0x159d10(0x3c5)][_0x159d10(0x26e)]&&devices[_0x1c4950]['access'][_0x159d10(0x3c8)]==_0x159d10(0x3bd)&&(getClientsWithUuid(_0x1c4950)[_0x159d10(0x233)](_0x2f0af9=>{setAccess(_0x2f0af9);}),logger['debug'](_0x159d10(0x353)+_0x1c4950[_0x159d10(0x313)](-0x8)),setTokenRefresh(_0x1c4950),setSessionTimeout(_0x159d10(0x356),_0x1c4950));}}else logger[_0x159d10(0x31b)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x4bf773['on'](_0x3a6421(0x322),()=>{resetPassword();}),_0x4bf773['on']('disconnect',_0x1fe428=>{removeClient(_0x4bf773['id']);}),_0x4b1cb9==_0x3a6421(0x288)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x2eabca){const _0x12fd82=_0x480a86;if(_0x2eabca!=_0x12fd82(0x288)&&config[_0x12fd82(0x2b9)]!=''){if(pid[_0x2eabca])pid[_0x2eabca][_0x12fd82(0x1d4)]({'function':_0x12fd82(0x1eb),'args':null});}_0x2eabca!=_0x12fd82(0x288)&&broadcastToBots(_0x12fd82(0x354),JSON[_0x12fd82(0x2eb)](config));}function reloadBotManager(){const _0x3a212b=_0x480a86;getClientsWithBotID(_0x3a212b(0x288))[_0x3a212b(0x233)](_0x3886b5=>{const _0x188b32=_0x3a212b;getSocket(_0x3886b5['id'])[_0x188b32(0x336)]('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function _0x20eb(){const _0x413975=['mkdirSync','telegrammsg','\x20>\x20','Allow\x20login\x20from\x20IP\x20address\x20','set','running','emitHistory','isValid','yargs/yargs','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Restore\x20process\x20aborted','No\x20bots\x20running\x20right\x20now','fork','/disable\x20-\x20disable\x20notifications\x0a','getUTCHours','Login\x20rejected','handshake','createWriteStream','temp/','simple','ipv6','lowdb','userid','bbPassword','Notifications\x20disabled','<b>Telegram\x20Bot\x20Status:</b>\x0a','connection','decrypt','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','replace','accept','2FA','node','botID','close','Token\x20blacklisted','Error\x20removing\x20old\x20backup\x20files:','hashSync','delete-alerts','Alerts','Unauthorized\x20attempt\x20to\x20delete\x20alerts','update-bot','apiSecret','All','unlinkSync','getTime','isIPv4MappedAddress','address\x20already\x20in\x20use','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','CoinMarketCap\x20API\x20key\x20validated','storeFiat','timestamp','launch','User\x20has\x20been\x20validated','includes','user','loadAsync','download','2FA\x20required','restart','DEFLATE','log','range','bb-config.json','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','/status\x20-\x20show\x20bot(s)\x20status\x0a','IPv4','Bot\x20Mgr\x20>\x20Starting\x20','socket.io','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Failed\x20to\x20download\x20','settings','tkn','verify','temporary\x20token\x20generated','args','new-disabled','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','update_no','storeConfiguration','exec','express','No\x20authentication\x20token','build2','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','--------------------------------------','Unauthorized\x20attempt\x20to\x20download\x20','confirm-message','login\x20token\x20generated','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','output-002.log','chat','telegraf','tempaccess_30_','1815078rJttpc','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','access','number','isDirectory','reason','timeshift','sockets','callback','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','lastmsgemitted','Orders','resetpw_no','Bot\x20Mgr\x20>\x20Stopping\x20',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','ipc','Unauthorized\x20attempt\x20to\x20update\x20settings','config','Notifications\x20disabled\x0a','tempaccess_5_','message','startsWith','toggle-bot-mode','publicKeyToPem','getMinutes','status','defaults','3000','telegram','min','button','telegramToken','getPortfolio','enable','showConfig','function','code','Notifications\x20enabled\x0a','/:bot','getStartingBalances','Server','names','apply','sign','username','Starting\x20#RED#Balance\x20Bot\x20v','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','headers','off_','get-portfolio','enabled','update_yes','Session\x20expired\x20for\x20user\x20...','max','Unauthorized\x20attempt\x20to\x20store\x20configuration','send','then','index.html','/restart\x20-\x20restart\x20bot(s)\x0a','/start','telegramEnabled','error','get-logs','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','getFullYear','reinstall_yes','latestversion','Bot\x20','notification','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','staging','sendMessage','order','expiry','\x20|\x20user:\x20...','toggleBotMode','Notifications\x20types:\x20','bbvNew','initclient','SIGTERM','Error\x20while\x20deleting\x20config\x20files:\x20','generateAsync','show','backupfile','Ok,\x20will\x20send\x20alert\x20notifications\x20only','live','*$1*','/enable\x20-\x20enable\x20notifications\x0a','kind','show-config','-performance.json','telegram2FaApproval','crypto','secure','/logs\x20-\x20receive\x20log\x20files\x0a','/output-000.log','copyFileSync','restart_','data','lowdb/adapters/FileSync','config/','files','yes','string','http://localhost:','logout','bb-secure.json','config_all','toString','/off\x20-\x20stop\x20bot(s)\x0a','backup-full','https://api.ipify.org?format=json','loginRequired','backup-full@','whitelist','telegramEvents','output-001.log','writeFileSync','Invalid\x20authentication\x20token\x20(2)','padStart','parse','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','login\x20not\x20required','invalid\x20credentials','-results.json','referer','/:bot/history','showname','argv','mixpanel','config_alerts','getDate','clients','async','Enabled\x20','sortBy','once','bot.js','statSync','endsWith','blacklist','resetHistory','keys','backup-full.zip','onepagemode','sendMetricsTelegram','exit','existsSync','map','help','forEach','backup/','debug','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','SIGINT','cancelLoading','BCT','bb/','uuid','whitelistEnabled','remove','.zip','************','ETH','logs','Unauthorized\x20attempt\x20to\x20get\x20messages','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','2FA\x20login\x20rejected','binary','/:bot/support','get-starting-balances','Invalid\x20authentication\x20token\x20(1)','createServer','production','\x20-\x20','HTML','uncaughtException','Setting\x20access:\x20','store-settings','build','Unauthorized\x20attempt\x20to\x20confirm\x20message','Deleted\x20Bot\x20','bbvReceive','privateKey','Login\x20accepted','5\x20min','split','\x20to\x20','getHours','File\x20uploaded','type','\x1b[31m','7152712awMtGH','port','/names\x20-\x20show\x20bot\x20names\x0a','toggle','catch','Unauthorized\x20attempt\x20to\x20log\x20out','/upload-backup','(staging)','connected','#RES#\x20if\x20running\x20locally\x0a','logged\x20out','portfolio','rmSync','botname','sendPortfolioTelegram','command','add-bot','allow','value','logs/','manual','server','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','reply','\x20files\x20over\x20Telegram:','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','express-fileupload','#RES#','warning','disconnect','Bot\x20Mgr\x20>\x20','place-order','/:bot/coins','size','reinstall-bb','private',')\x20|\x20Bot\x20','/:bot/performance','pidExpireLogin','7PGAGmz','Password\x20has\x20been\x20reset\x20to:\x20','editMessageReplyMarkup','botmanager','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','event','hasOwnProperty','Telegraf\x20error:','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','login\x20required','telegramChatId','$1_$2_$3','placeOrder','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','track','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','alerts','exchange','axios','test','|@|','match','new','get','backup-files','\x20only\x0a','telegramIpApproval','hex','-events.json','on_','tempaccess_reject_','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','Idling\x20(','compareSync','settings.','messages','Temporary\x20access\x20rejected','password','socket','started','request','join','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','rsa','Starting\x20Balance\x20Bot\x20reinstallation','replyWithDocument','Error\x20sending\x20','pidRefreshToken','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','update-bb','\x20|\x20','apiKey','success','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','length','clientip','/metrics\x20-\x20show\x20bot\x20performance\x0a','Logged\x20out\x20user\x20...','Password\x20reset\x20rejected','bot-','Restarting\x20','temporary\x20access\x20timeout','deleteHistoryAlerts','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','getSeconds','from','config_orders','randomBytes','telegramUsername','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','You\x20can\x20use\x20the\x20following\x20commands:\x0a','token','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','get-messages','privateKeyToPem','sha256','cloneDeep','all','pki','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','action','use','remoteAddress','headless','listen','Unauthorized\x20attempt\x20to\x20get\x20events','store','encryptedUuid','cancel-loading','login2fa_','assign','Bot\x20Mgr\x20>\x20Toggling\x20','bb-settings.json','\x20(2)','=>\x20Go\x20to\x20#CYA#http://','2505468ZjmVKd','update','Unauthorized\x20attempt\x20to\x20show\x20configuration','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','stringify','All\x20bots','write','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','version','metrics_','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Restore\x20process\x20confirmed','kill','family',':\x20Bot\x20Mgr\x20>\x20','Access\x20enabled\x20for\x20','get-backup-files','0.0.0','lastmsgtelegram','randomFillSync','title','Invalid\x20IP\x20address','/update\x20-\x20update\x20Balance\x20Bot\x0a','sort','readdirSync','bbUsername','output-003.log','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','toggle_','file','auto','::ffff:127.0.0.1','bot','***','reject','version.json','Error:\x20Invalid\x20argument\x20','start','readFileSync','output-000.log','Backup\x20file\x20uploaded','init','/backup\x20-\x20receive\x20backup\x20files\x0a','\x20minutes','slice','default','\x1b[0m','433616TyRKdr','inlineKeyboard','4897960iFwBPv','(((.+)+)+)+$','resetpw_yes','full','Invalid\x20username\x20or\x20IP\x20address','inherit','text','open','2FA\x20login\x20required','access\x20timeout','reset-password','sendFile','Running\x20#RED#Balance\x20Bot\x20v','reload','disabled','status\x20code\x20401','jszip','apiPassword','filter','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','getMonth','publicKey','stop','name','\x1b[33m','f2aRequired','privateKeyFromPem','<b>Balance\x20Bot\x20Status:</b>\x0a','format','emit','restore_no_','/:bot/portfolio','3472725OwlYWm','path','address','-----------------------------------------------------------------------------------','Unauthorized\x20attempt\x20to\x20update\x20bot','uuid-random','backup','\x1b[35m','-config.json','create','find','toIPv4Address','Starting\x20Balance\x20Bot\x20update','\x1b[34m','marketcapApi','zip/','reinstall','secret','host','Your\x20installation\x20is\x20already\x20up\x20to\x20date','node-forge','temporary\x20access\x20rejected','bcryptjs','search','760889BPVBjZ','store-fiat','Logged\x20in\x20user\x20...','bots','store-headless','login','util','push','params','orders','restore-backup-file','environment','reinstall_no','graphql-request','stopped','1000','exp','mode','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?'];_0x20eb=function(){return _0x413975;};return _0x20eb();}function getSocket(_0x5321d9){const _0x42ecc6=_0x480a86,_0x2af9ed=io['_nsps'][_0x42ecc6(0x29c)]('/');return _0x2af9ed[_0x42ecc6(0x3ca)]['get'](_0x5321d9);}function setAccess(_0x4b1b1f){const _0x3cd8fd=_0x480a86,_0x50256c=getSocket(_0x4b1b1f['id']),_0x39e6b5=_0x4b1b1f[_0x3cd8fd(0x23b)],_0x480d48=_0x4b1b1f[_0x3cd8fd(0x307)];devices[_0x39e6b5][_0x3cd8fd(0x3c5)]=validateAccess(devices[_0x39e6b5][_0x3cd8fd(0x3c5)][_0x3cd8fd(0x2ce)],_0x39e6b5),logger[_0x3cd8fd(0x235)](_0x3cd8fd(0x24e)+devices[_0x39e6b5]['access'][_0x3cd8fd(0x3c8)]+'\x20|\x20client:\x20...'+_0x4b1b1f['id']['slice'](-0x8)+_0x3cd8fd(0x1e7)+_0x39e6b5[_0x3cd8fd(0x313)](-0x8)),_0x50256c['join'](_0x39e6b5);if(devices[_0x39e6b5][_0x3cd8fd(0x3c5)][_0x3cd8fd(0x26e)]){_0x50256c['join'](_0x480d48);if(_0x480d48==_0x3cd8fd(0x288))initializeSocketBotManager(_0x50256c);else initializeSocketBot(_0x50256c);initClient(_0x480d48);}devices[_0x39e6b5]['access'][_0x3cd8fd(0x2ce)]&&devices[_0x39e6b5][_0x3cd8fd(0x3c5)][_0x3cd8fd(0x3c8)]==_0x3cd8fd(0x3af)&&setSessionTimeout(_0x3cd8fd(0x384),_0x39e6b5),devices[_0x39e6b5][_0x3cd8fd(0x3c5)][_0x3cd8fd(0x2ce)]&&devices[_0x39e6b5]['access'][_0x3cd8fd(0x3c8)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x3cd8fd(0x356),_0x39e6b5),_0x50256c[_0x3cd8fd(0x336)]('status',{'status':_0x4b1b1f[_0x3cd8fd(0x272)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x39e6b5][_0x3cd8fd(0x3c5)],'externalip':devices[_0x39e6b5]['ip'],'publicKey':secure[_0x3cd8fd(0x32e)],'userid':settings[_0x3cd8fd(0x37a)],'validInstallation':validInstallation}),devices[_0x39e6b5][_0x3cd8fd(0x3c5)][_0x3cd8fd(0x26e)]==![]&&devices[_0x39e6b5][_0x3cd8fd(0x3c5)]['reason']==_0x3cd8fd(0x39f)&&temporaryAccess2FA(_0x39e6b5,devices[_0x39e6b5]['ip']);}function setSessionTimeout(_0x2f9131,_0x19ea8a){const _0x599b60=_0x480a86;let _0x2a799a;if(_0x2f9131==_0x599b60(0x356))_0x2a799a=loginExpiry*0x3c*0x3e8;else _0x2a799a=devices[_0x19ea8a][_0x599b60(0x29f)][_0x599b60(0x1e6)]*0x3c*0x3e8-(new Date()[_0x599b60(0x392)]()-devices[_0x19ea8a]['telegramIpApproval'][_0x599b60(0x398)]);if(devices[_0x19ea8a][_0x599b60(0x284)])clearTimeout(devices[_0x19ea8a][_0x599b60(0x284)]);devices[_0x19ea8a][_0x599b60(0x284)]=setTimeout(()=>{const _0x2d7930=_0x599b60;if(devices[_0x19ea8a][_0x2d7930(0x2b5)])clearTimeout(devices[_0x19ea8a][_0x2d7930(0x2b5)]);removeSocketListeners(_0x19ea8a),addBlacklist(_0x19ea8a),devices[_0x19ea8a][_0x2d7930(0x29f)]=null,devices[_0x19ea8a][_0x2d7930(0x1f8)]=null,devices[_0x19ea8a][_0x2d7930(0x3c5)][_0x2d7930(0x2ce)]=null,logger[_0x2d7930(0x235)](_0x2d7930(0x1d1)+_0x19ea8a[_0x2d7930(0x313)](-0x8)),devices[_0x19ea8a][_0x2d7930(0x3c5)]=validateAccess(devices[_0x19ea8a][_0x2d7930(0x3c5)]['token'],_0x19ea8a),!(devices[_0x19ea8a][_0x2d7930(0x3c5)]['allow']&&devices[_0x19ea8a]['access'][_0x2d7930(0x3c8)]==_0x2d7930(0x217))&&(_0x2f9131==_0x2d7930(0x356)?io['to'](_0x19ea8a)[_0x2d7930(0x336)](_0x2d7930(0x3dc),{'access':{'allow':![],'reason':_0x2d7930(0x321),'token':null}}):io['to'](_0x19ea8a)[_0x2d7930(0x336)](_0x2d7930(0x3dc),{'access':{'allow':![],'reason':_0x2d7930(0x2c3),'token':null}})),devices[_0x19ea8a][_0x2d7930(0x3c5)][_0x2d7930(0x2ce)]=null;},_0x2a799a);}function setTokenRefresh(_0x41e1b5){const _0x52e030=_0x480a86;if(devices[_0x41e1b5]['pidRefreshToken'])clearTimeout(devices[_0x41e1b5][_0x52e030(0x2b5)]);devices[_0x41e1b5][_0x52e030(0x2b5)]=setTimeout(()=>{const _0x124f76=_0x52e030;getClientsWithUuid(_0x41e1b5)[_0x124f76(0x2bc)]!=0x0?(devices[_0x41e1b5][_0x124f76(0x3c5)]=refreshToken(_0x41e1b5),io['to'](_0x41e1b5)[_0x124f76(0x336)]('status',{'status':_0x124f76(0x265),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x41e1b5][_0x124f76(0x3c5)],'externalip':devices[_0x41e1b5]['ip'],'publicKey':secure[_0x124f76(0x32e)],'validInstallation':validInstallation}),setTokenRefresh(_0x41e1b5)):clearTimeout(devices[_0x41e1b5][_0x124f76(0x2b5)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1d8cbe){const _0x1d5c4a=_0x480a86,_0x38e9b2=getClient(_0x1d8cbe['id'])[_0x1d5c4a(0x23b)];_0x1d8cbe[_0x1d5c4a(0x336)]('bots',config),_0x1d8cbe[_0x1d5c4a(0x336)](_0x1d5c4a(0x3ac),cleanSettings()),_0x1d8cbe['on'](_0x1d5c4a(0x26d),_0x3e0c1f=>{const _0x4d0d85=_0x1d5c4a;if(validateAccess(_0x3e0c1f,_0x38e9b2)[_0x4d0d85(0x26e)])addBot();else logger[_0x4d0d85(0x31b)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x1d8cbe['on'](_0x1d5c4a(0x38e),(_0x3f4932,_0x41d1fc)=>{const _0x4cd78d=_0x1d5c4a;if(validateAccess(_0x41d1fc,_0x38e9b2)[_0x4cd78d(0x26e)])toggleBot(_0x3f4932[_0x4cd78d(0x386)],_0x3f4932[_0x4cd78d(0x3dc)],_0x3f4932[_0x4cd78d(0x1f2)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x1d8cbe['on'](_0x1d5c4a(0x3d9),(_0x4442c7,_0x3bcfb7)=>{const _0x42b2aa=_0x1d5c4a;if(validateAccess(_0x3bcfb7,_0x38e9b2)[_0x42b2aa(0x26e)])toggleBotMode(_0x4442c7);else logger['full'](_0x42b2aa(0x33d));}),_0x1d8cbe['on']('delete-bot',(_0x124f1c,_0x368866)=>{const _0x325d8d=_0x1d5c4a;if(validateAccess(_0x368866,_0x38e9b2)[_0x325d8d(0x26e)])deleteBot(_0x124f1c);else logger[_0x325d8d(0x31b)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x1d8cbe['on'](_0x1d5c4a(0x24f),(_0x49b057,_0x512167)=>{const _0x4971e6=_0x1d5c4a;if(validateAccess(_0x512167,_0x38e9b2)[_0x4971e6(0x26e)])storeSettings(_0x49b057,!![]);else logger[_0x4971e6(0x31b)](_0x4971e6(0x3d3));}),_0x1d8cbe['on'](_0x1d5c4a(0x2b7),_0x4f2ff0=>{const _0x289cc1=_0x1d5c4a;if(validateAccess(_0x4f2ff0,_0x38e9b2)[_0x289cc1(0x26e)])updateBB(_0x289cc1(0x2e8));else logger[_0x289cc1(0x31b)](_0x289cc1(0x395));}),_0x1d8cbe['on'](_0x1d5c4a(0x280),_0x2d2fcc=>{const _0x239c73=_0x1d5c4a;if(validateAccess(_0x2d2fcc,_0x38e9b2)[_0x239c73(0x26e)])updateBB(_0x239c73(0x349));else logger[_0x239c73(0x31b)](_0x239c73(0x2f1));}),_0x1d8cbe['on'](_0x1d5c4a(0x2f7),_0x45d7d2=>{const _0x3d3c8e=_0x1d5c4a;if(validateAccess(_0x45d7d2,_0x38e9b2)[_0x3d3c8e(0x26e)]){const _0x14d4d6=getClient(_0x1d8cbe['id']);if(_0x14d4d6)getBackupFiles(_0x14d4d6[_0x3d3c8e(0x23b)]);else logger['full'](_0x3d3c8e(0x32c));}else logger['full'](_0x3d3c8e(0x243));}),_0x1d8cbe['on'](_0x1d5c4a(0x35b),(_0x3d4cef,_0x2247e9)=>{if(validateAccess(_0x2247e9,_0x38e9b2)['allow'])restoreBackupFile(_0x3d4cef);else logger['full']('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x1d8cbe['on']('get-messages',_0x45ae9d=>{const _0x5442a7=_0x1d5c4a;if(validateAccess(_0x45ae9d,_0x38e9b2)[_0x5442a7(0x26e)])getMessages();else logger[_0x5442a7(0x31b)](_0x5442a7(0x242));}),_0x1d8cbe['on'](_0x1d5c4a(0x3bc),(_0x447a90,_0x4bc5ad)=>{const _0x5ade96=_0x1d5c4a;if(validateAccess(_0x4bc5ad,_0x38e9b2)[_0x5ade96(0x26e)])confirmMessage(_0x447a90);else logger[_0x5ade96(0x31b)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x1d8cbe['on']('logout',_0x35b867=>{const _0x489dea=_0x1d5c4a;if(validateAccess(_0x35b867,_0x38e9b2)['allow']){if(devices[_0x38e9b2][_0x489dea(0x2b5)])clearTimeout(devices[_0x38e9b2][_0x489dea(0x2b5)]);if(devices[_0x38e9b2][_0x489dea(0x284)])clearTimeout(devices[_0x38e9b2][_0x489dea(0x284)]);removeSocketListeners(getClient(_0x1d8cbe['id'])[_0x489dea(0x23b)]),addBlacklist(_0x38e9b2),devices[_0x38e9b2][_0x489dea(0x29f)]=null,devices[_0x38e9b2][_0x489dea(0x1f8)]=null,devices[_0x38e9b2]['access'][_0x489dea(0x2ce)]=null,logger[_0x489dea(0x235)](_0x489dea(0x2bf)+_0x38e9b2[_0x489dea(0x313)](-0x8)),io['to'](getClient(_0x1d8cbe['id'])[_0x489dea(0x23b)])[_0x489dea(0x336)](_0x489dea(0x3dc),{'access':{'allow':![],'reason':_0x489dea(0x267),'token':null}});}else logger[_0x489dea(0x31b)](_0x489dea(0x262));});}function initializeSocketBot(_0x3e46af){const _0x15a610=_0x480a86,_0x552a16=getClient(_0x3e46af['id'])[_0x15a610(0x307)],_0x2fe57f=getClient(_0x3e46af['id'])['uuid'];_0x3e46af['on'](_0x15a610(0x1db),(_0x43510a,_0x5a0186)=>{const _0xb1eeae=_0x15a610;if(validateAccess(_0x5a0186,_0x2fe57f)[_0xb1eeae(0x26e)]){if(pid[_0x552a16])pid[_0x552a16][_0xb1eeae(0x1d4)]({'function':_0xb1eeae(0x36a),'args':_0x43510a});}else logger[_0xb1eeae(0x31b)](_0xb1eeae(0x2dd));}),_0x3e46af['on'](_0x15a610(0x38b),(_0x3c6b03,_0x558c11)=>{const _0x7094c=_0x15a610;if(validateAccess(_0x558c11,_0x2fe57f)[_0x7094c(0x26e)]){if(pid[_0x552a16])pid[_0x552a16]['send']({'function':_0x7094c(0x2c4),'args':_0x3c6b03});}else logger[_0x7094c(0x31b)](_0x7094c(0x38d));}),_0x3e46af['on'](_0x15a610(0x1ce),(_0x3230a3,_0x4efb7a)=>{const _0xaa92c6=_0x15a610;if(validateAccess(_0x4efb7a,_0x2fe57f)[_0xaa92c6(0x26e)]){if(pid[_0x552a16])pid[_0x552a16][_0xaa92c6(0x1d4)]({'function':_0xaa92c6(0x3e3),'args':_0x3230a3});}else logger[_0xaa92c6(0x31b)](_0xaa92c6(0x2d6));}),_0x3e46af['on']('store-configuration',(_0x3f0d97,_0x4a9ded)=>{const _0x3cfb5f=_0x15a610;if(validateAccess(_0x4a9ded,_0x2fe57f)['allow']){if(pid[_0x552a16])pid[_0x552a16][_0x3cfb5f(0x1d4)]({'function':_0x3cfb5f(0x3b4),'args':_0x3f0d97});}else logger[_0x3cfb5f(0x31b)](_0x3cfb5f(0x1d3));}),_0x3e46af['on'](_0x15a610(0x355),(_0x16bb09,_0x490d43)=>{const _0xcd1cdc=_0x15a610;if(validateAccess(_0x490d43,_0x2fe57f)['allow']){if(pid[_0x552a16])pid[_0x552a16]['send']({'function':'storeHeadless','args':_0x16bb09});}else logger[_0xcd1cdc(0x31b)](_0xcd1cdc(0x2ee));}),_0x3e46af['on'](_0x15a610(0x352),(_0x193df5,_0x55e915)=>{const _0x391114=_0x15a610;if(validateAccess(_0x55e915,_0x2fe57f)['allow']){if(pid[_0x552a16])pid[_0x552a16][_0x391114(0x1d4)]({'function':_0x391114(0x397),'args':_0x193df5});}else logger[_0x391114(0x31b)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x3e46af['on']('reset-history',_0x5c13fd=>{const _0x1203d2=_0x15a610;if(validateAccess(_0x5c13fd,_0x2fe57f)[_0x1203d2(0x26e)]){if(pid[_0x552a16])pid[_0x552a16]['send']({'function':_0x1203d2(0x22a),'args':null});}else logger[_0x1203d2(0x31b)](_0x1203d2(0x292));}),_0x3e46af['on'](_0x15a610(0x247),_0x4fec38=>{const _0x2ac6d7=_0x15a610;if(validateAccess(_0x4fec38,_0x2fe57f)[_0x2ac6d7(0x26e)]){if(pid[_0x552a16])pid[_0x552a16][_0x2ac6d7(0x1d4)]({'function':_0x2ac6d7(0x3ea),'args':null});}else logger[_0x2ac6d7(0x31b)](_0x2ac6d7(0x2ea));}),_0x3e46af['on'](_0x15a610(0x27d),(_0x5b7f53,_0x2647ab)=>{const _0x1046ac=_0x15a610;if(validateAccess(_0x2647ab,_0x2fe57f)[_0x1046ac(0x26e)]){if(pid[_0x552a16])pid[_0x552a16][_0x1046ac(0x1d4)]({'function':_0x1046ac(0x291),'args':_0x5b7f53});}else logger[_0x1046ac(0x31b)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x3e46af['on'](_0x15a610(0x2e0),_0x581943=>{const _0x3a9cf5=_0x15a610;if(validateAccess(_0x581943,_0x2fe57f)[_0x3a9cf5(0x26e)]){if(pid[_0x552a16])pid[_0x552a16][_0x3a9cf5(0x1d4)]({'function':_0x3a9cf5(0x238),'args':null});}else logger[_0x3a9cf5(0x31b)](_0x3a9cf5(0x3a5));}),_0x3e46af['on'](_0x15a610(0x1f6),_0xea8dc4=>{const _0x28d0d4=_0x15a610;if(validateAccess(_0xea8dc4,_0x2fe57f)['allow']){if(pid[_0x552a16])pid[_0x552a16][_0x28d0d4(0x1d4)]({'function':_0x28d0d4(0x3e5),'args':null});}else logger[_0x28d0d4(0x31b)](_0x28d0d4(0x2e9));}),_0x3e46af['on'](_0x15a610(0x2b7),_0x3cccee=>{const _0x186028=_0x15a610;if(validateAccess(_0x3cccee,_0x2fe57f)[_0x186028(0x26e)])updateBB('update');else logger[_0x186028(0x31b)](_0x186028(0x395));}),_0x3e46af['on'](_0x15a610(0x2d0),_0x5c59d5=>{const _0x39c971=_0x15a610;if(validateAccess(_0x5c59d5,_0x2fe57f)[_0x39c971(0x26e)])getMessages();else logger[_0x39c971(0x31b)](_0x39c971(0x242));}),_0x3e46af['on']('confirm-message',(_0x557424,_0x2141c7)=>{const _0x56b821=_0x15a610;if(validateAccess(_0x2141c7,_0x2fe57f)[_0x56b821(0x26e)])confirmMessage(_0x557424);else logger[_0x56b821(0x31b)](_0x56b821(0x251));}),_0x3e46af['on'](_0x15a610(0x206),_0xeaf73d=>{const _0x37b582=_0x15a610;if(validateAccess(_0xeaf73d,_0x2fe57f)[_0x37b582(0x26e)]){if(devices[_0x2fe57f][_0x37b582(0x2b5)])clearTimeout(devices[_0x2fe57f][_0x37b582(0x2b5)]);if(devices[_0x2fe57f][_0x37b582(0x284)])clearTimeout(devices[_0x2fe57f]['pidExpireLogin']);removeSocketListeners(getClient(_0x3e46af['id'])['uuid']),addBlacklist(_0x2fe57f),devices[_0x2fe57f][_0x37b582(0x29f)]=null,devices[_0x2fe57f][_0x37b582(0x1f8)]=null,devices[_0x2fe57f][_0x37b582(0x3c5)][_0x37b582(0x2ce)]=null,logger[_0x37b582(0x235)](_0x37b582(0x2bf)+_0x2fe57f[_0x37b582(0x313)](-0x8)),io['to'](getClient(_0x3e46af['id'])['uuid'])[_0x37b582(0x336)](_0x37b582(0x3dc),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x37b582(0x31b)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x45420a){const _0x59dcb0=_0x480a86;getClientsWithUuid(_0x45420a)[_0x59dcb0(0x233)](_0x163816=>{getSocket(_0x163816['id'])['removeAllListeners']();});}function cleanSettings(){const _0x5970d3=_0x480a86;let _0x47f67b=settings;return settings[_0x5970d3(0x3e2)]&&settings[_0x5970d3(0x3e2)]!=''&&(_0x47f67b={..._0x47f67b,'telegramToken':'************'}),settings[_0x5970d3(0x37b)]&&settings[_0x5970d3(0x37b)]!=''&&(_0x47f67b={..._0x47f67b,'bbPassword':_0x5970d3(0x23f)}),settings[_0x5970d3(0x347)]&&settings[_0x5970d3(0x347)]!=''&&(_0x47f67b={..._0x47f67b,'marketcapApi':_0x5970d3(0x23f)}),(settings['bbPassword']&&settings[_0x5970d3(0x37b)]==_0x5970d3(0x308)||settings['telegramToken']&&settings[_0x5970d3(0x3e2)]==_0x5970d3(0x308)||settings[_0x5970d3(0x347)]&&settings[_0x5970d3(0x347)]=='***')&&(_0x47f67b={..._0x47f67b,'restored':{'password':settings['bbPassword']=='***','telegram':settings['telegramToken']==_0x5970d3(0x308),'marketcap':settings[_0x5970d3(0x347)]==_0x5970d3(0x308)}}),_0x47f67b;}async function updateBB(_0x545d43){const _0x95a101=_0x480a86;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x47771b=>{restartBot(_0x47771b['botID']);});if(_0x545d43==_0x95a101(0x2e8))process[_0x95a101(0x1d4)]({'update':!![],'environment':environment},_0x22fe60=>{});else _0x545d43==_0x95a101(0x349)&&process[_0x95a101(0x1d4)]({'reinstall':!![],'environment':environment},_0x50f3f4=>{});}function startBot(_0x52689e,_0x3a2aa0,_0xd9048){const _0x4c3c19=_0x480a86;if(debugging)_0x52689e[_0x4c3c19(0x358)]('-d');if(recreate)_0x52689e[_0x4c3c19(0x358)]('-r');let _0x496593=![];const _0xa92daa=_0x52689e[0x0];_0x3a2aa0={..._0x3a2aa0,'stdio':[_0x4c3c19(0x31d),_0x4c3c19(0x31d),'inherit',_0x4c3c19(0x3d2)]},pid[_0xa92daa]=childProcess[_0x4c3c19(0x370)](botfile,_0x52689e,_0x3a2aa0),pid[_0xa92daa]['on'](_0x4c3c19(0x3d7),_0x1ffa9b=>{const _0x234097=_0x4c3c19;switch(Object['keys'](_0x1ffa9b)[0x0]){case _0x234097(0x26a):updateBotName(_0xa92daa,_0x1ffa9b['botname']);break;case'updatebotmanager':updateBotManager();break;case _0x234097(0x3dc):updateStatus(_0xa92daa,_0x1ffa9b['status']);break;case _0x234097(0x1f2):updateLive(_0xa92daa,_0x1ffa9b[_0x234097(0x1f2)]);break;case'started':updateLive(_0xa92daa,_0x1ffa9b[_0x234097(0x2ac)]),io['to'](_0xa92daa)[_0x234097(0x336)]('status',{'access':{'allow':![],'reason':_0x234097(0x325),'token':null}});break;case _0x234097(0x32f):_0x1ffa9b['stop']==_0x234097(0x3a0)&&restartBot(_0xa92daa);_0x1ffa9b[_0x234097(0x32f)]==_0x234097(0x2f3)&&toggleBot(_0xa92daa,'disabled',_0x234097(0x35f));break;case _0x234097(0x3df):sendTelegramBot(_0xa92daa,_0x1ffa9b[_0x234097(0x3df)]);break;case'telegrammsg':sendTelegramMsg(_0x1ffa9b[_0x234097(0x365)]);break;case _0x234097(0x3e6):io['to'](_0xa92daa)[_0x234097(0x336)](_0x1ffa9b[_0x234097(0x3e6)],_0x1ffa9b[_0x234097(0x3b0)]);break;}}),pid[_0xa92daa]['on'](_0x4c3c19(0x1da),function(_0x69deb4){if(_0x496593)return;_0x496593=!![],_0xd9048(_0x69deb4);}),pid[_0xa92daa]['on'](_0x4c3c19(0x22f),async function(_0x421349){const _0x17afd6=_0x4c3c19;if(terminating)return;if(installingUpdate){io[_0x17afd6(0x387)]();return;}if(_0x496593)return;_0x496593=!![],_0xd9048(null);const _0x52881e=dbConfig[_0x17afd6(0x29c)](_0x17afd6(0x354))[_0x17afd6(0x343)]({'botID':_0xa92daa})[_0x17afd6(0x26f)]();_0x52881e&&(_0x52881e[_0x17afd6(0x3dc)]==_0x17afd6(0x1cf)||_0x52881e[_0x17afd6(0x3dc)]=='new')&&(await sleep(0x3e8),updateLive(_0xa92daa,_0x17afd6(0x35f)),logger[_0x17afd6(0x31b)](_0x17afd6(0x2c2)+botRef(_0xa92daa)),startBot([_0xa92daa,userID],{'cwd':bbpath},function(_0x1ae1ff){const _0x3b2b3a=_0x17afd6;if(_0x1ae1ff)logger[_0x3b2b3a(0x31b)](_0x1ae1ff);}));});}function stopBot(_0x2f1da0){const _0x2e7d41=_0x480a86;getClientsWithBotID(_0x2f1da0)[_0x2e7d41(0x233)](_0x474005=>{const _0x4dd805=_0x2e7d41;getSocket(_0x474005['id'])[_0x4dd805(0x27b)](!![]),removeClient(_0x474005['id']);}),pid[_0x2f1da0]&&(pid[_0x2f1da0][_0x2e7d41(0x2f3)](),pid[_0x2f1da0]=null);}function stopAllBots(){terminating=!![];const _0x37fd3f=getEnabledBots();_0x37fd3f['forEach'](_0x299226=>{const _0x4051ae=_0x55da;stopBot(_0x299226[_0x4051ae(0x386)]);});}function restartBot(_0x2ae5d9){const _0x2ecaed=_0x480a86;if(pid[_0x2ae5d9])pid[_0x2ae5d9][_0x2ecaed(0x2f3)]();}function addBot(){const _0x5e36ce=_0x480a86;let _0x329f7b;for(let _0x380d80=0x1;_0x380d80<0x3e9;_0x380d80++){_0x329f7b=_0x380d80[_0x5e36ce(0x209)]()[_0x5e36ce(0x214)](0x3,'0');let _0x1db66c=config[_0x5e36ce(0x343)](_0x5c69ab=>_0x5c69ab[_0x5e36ce(0x386)]==_0x329f7b);if(!_0x1db66c)break;}if(_0x329f7b===_0x5e36ce(0x360)){logger[_0x5e36ce(0x31b)](_0x5e36ce(0x3be));return;}logger[_0x5e36ce(0x31b)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x329f7b),dbConfig[_0x5e36ce(0x29c)](_0x5e36ce(0x354))['push']({'botID':_0x329f7b,'botname':_0x5e36ce(0x1e0)+_0x329f7b,'status':_0x5e36ce(0x29b),'live':''})[_0x5e36ce(0x2ed)](),startBot([_0x329f7b,userID],{'cwd':bbpath},function(_0xfc3ecf){const _0x4490df=_0x5e36ce;if(_0xfc3ecf)logger[_0x4490df(0x31b)](_0xfc3ecf);}),config=getConfiguration(),io['to'](_0x5e36ce(0x288))[_0x5e36ce(0x336)](_0x5e36ce(0x354),config),broadcastToBots(_0x5e36ce(0x354),JSON[_0x5e36ce(0x2eb)](config));}function deleteBot(_0x50fed5){const _0x556593=_0x480a86;getClientsWithBotID(_0x50fed5)[_0x556593(0x233)](_0x1dd880=>{const _0x10fb77=_0x556593;getSocket(_0x1dd880['id'])[_0x10fb77(0x27b)](!![]),removeClient(_0x1dd880['id']);}),dbConfig[_0x556593(0x29c)](_0x556593(0x354))[_0x556593(0x23d)]({'botID':_0x50fed5})['write'](),logger[_0x556593(0x31b)](_0x556593(0x252)+_0x50fed5),stopBot(_0x50fed5);try{if(fs[_0x556593(0x230)](path[_0x556593(0x2ae)](configpath,_0x556593(0x2c1)+_0x50fed5+_0x556593(0x341))))fs[_0x556593(0x391)](path['join'](configpath,_0x556593(0x2c1)+_0x50fed5+_0x556593(0x341)));if(fs['existsSync'](path['join'](configpath,_0x556593(0x2c1)+_0x50fed5+_0x556593(0x2a1))))fs['unlinkSync'](path[_0x556593(0x2ae)](configpath,_0x556593(0x2c1)+_0x50fed5+'-events.json'));if(fs[_0x556593(0x230)](path[_0x556593(0x2ae)](configpath,_0x556593(0x2c1)+_0x50fed5+_0x556593(0x1f7))))fs['unlinkSync'](path[_0x556593(0x2ae)](configpath,'bot-'+_0x50fed5+_0x556593(0x1f7)));if(fs['existsSync'](path[_0x556593(0x2ae)](configpath,_0x556593(0x2c1)+_0x50fed5+_0x556593(0x219))))fs['unlinkSync'](path[_0x556593(0x2ae)](configpath,'bot-'+_0x50fed5+'-results.json'));}catch(_0x375654){if(_0x375654)logger[_0x556593(0x31b)](_0x556593(0x1ed),_0x375654);}config=getConfiguration(),io['to'](_0x556593(0x288))[_0x556593(0x336)](_0x556593(0x354),config),broadcastToBots(_0x556593(0x354),JSON[_0x556593(0x2eb)](config));}function _0x55da(_0x5c22be,_0x5d9393){const _0x5b233f=_0x20eb();return _0x55da=function(_0x45e004,_0x567318){_0x45e004=_0x45e004-0x1ce;let _0x20eb79=_0x5b233f[_0x45e004];return _0x20eb79;},_0x55da(_0x5c22be,_0x5d9393);}function toggleBot(_0x5543f0,_0x22db35,_0x5a3c25){const _0xc2a540=_0x480a86;dbConfig[_0xc2a540(0x29c)](_0xc2a540(0x354))[_0xc2a540(0x343)]({'botID':_0x5543f0})[_0xc2a540(0x2e2)]({'status':_0x22db35})[_0xc2a540(0x2e2)]({'live':_0x5a3c25})['write']();const _0x4bfaa3=botRef(_0x5543f0);if(_0x22db35==_0xc2a540(0x1cf)||_0x22db35==_0xc2a540(0x29b))logger['full'](_0xc2a540(0x223)+_0x4bfaa3),startBot([_0x5543f0,userID],{'cwd':bbpath},function(_0x13ca3e){const _0x49adce=_0xc2a540;if(_0x13ca3e)logger[_0x49adce(0x31b)](_0x13ca3e);});else(_0x22db35=='disabled'||_0x22db35==_0xc2a540(0x3b1))&&(logger[_0xc2a540(0x31b)]('Disabled\x20'+_0x4bfaa3),stopBot(_0x5543f0));config=getConfiguration(),io['to'](_0xc2a540(0x288))[_0xc2a540(0x336)]('bots',config),broadcastToBots(_0xc2a540(0x354),JSON[_0xc2a540(0x2eb)](config));}function toggleStatus(_0x295c1b){const _0x1cad55=_0x480a86;let _0x593e61=dbConfig['get'](_0x1cad55(0x354))[_0x1cad55(0x343)]({'botID':_0x295c1b})[_0x1cad55(0x26f)](),_0x93d6;if(_0x593e61[_0x1cad55(0x3dc)]===_0x1cad55(0x1cf))_0x93d6=_0x1cad55(0x326);else{if(_0x593e61[_0x1cad55(0x3dc)]===_0x1cad55(0x29b))_0x93d6='new-disabled';else{if(_0x593e61['status']===_0x1cad55(0x3b1))_0x93d6='new';else{if(_0x593e61[_0x1cad55(0x3dc)]===_0x1cad55(0x326))_0x93d6=_0x1cad55(0x1cf);}}}return _0x93d6;}function updateStatus(_0xa0e67a,_0x126f97){const _0x2845be=_0x480a86;dbConfig[_0x2845be(0x29c)](_0x2845be(0x354))[_0x2845be(0x343)]({'botID':_0xa0e67a})[_0x2845be(0x2e2)]({'status':_0x126f97})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x2845be(0x336)](_0x2845be(0x354),config),broadcastToBots('bots',JSON[_0x2845be(0x2eb)](config));}function updateLive(_0x592738,_0x4ad28e){const _0x1f5fd7=_0x480a86;dbConfig[_0x1f5fd7(0x29c)](_0x1f5fd7(0x354))[_0x1f5fd7(0x343)]({'botID':_0x592738})[_0x1f5fd7(0x2e2)]({'live':_0x4ad28e})[_0x1f5fd7(0x2ed)](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots(_0x1f5fd7(0x354),JSON['stringify'](config));}function updateBotName(_0x25552e,_0x54e46d){const _0x422966=_0x480a86;dbConfig[_0x422966(0x29c)]('bots')[_0x422966(0x343)]({'botID':_0x25552e})['assign']({'botname':_0x54e46d})[_0x422966(0x2ed)](),config=getConfiguration(),io['to'](_0x422966(0x288))[_0x422966(0x336)](_0x422966(0x354),config),broadcastToBots(_0x422966(0x354),JSON[_0x422966(0x2eb)](config));}function updateBotManager(){const _0x3169be=_0x480a86;config=getConfiguration(),io['to'](_0x3169be(0x288))[_0x3169be(0x336)]('bots',config),broadcastToBots(_0x3169be(0x354),JSON[_0x3169be(0x2eb)](config));}function toggleBotMode(_0x362a95){const _0x1a8a82=_0x480a86;if(pid[_0x362a95])pid[_0x362a95][_0x1a8a82(0x1d4)]({'function':_0x1a8a82(0x1e8),'args':null});else{const _0x21bc10=configpath+_0x1a8a82(0x2c1)+_0x362a95+'-config.json',_0x493910=fs['readFileSync'](_0x21bc10),_0x2fc3c3=JSON[_0x1a8a82(0x215)](_0x493910),_0x1df94c=_0x2fc3c3[_0x1a8a82(0x307)][0x0][_0x1a8a82(0x2db)];_0x2fc3c3[_0x1a8a82(0x307)][0x0][_0x1a8a82(0x2db)]=!_0x1df94c;const _0x10eef7=JSON['stringify'](_0x2fc3c3,null,0x2);fs[_0x1a8a82(0x212)](_0x21bc10,_0x10eef7),config=getConfiguration(),io['to'](_0x1a8a82(0x288))['emit'](_0x1a8a82(0x354),config),broadcastToBots('bots',JSON[_0x1a8a82(0x2eb)](config));}}function validateTelegram(_0x1b956f){const _0xb7b0ab=_0x480a86;if(_0x1b956f[_0xb7b0ab(0x2c8)][_0xb7b0ab(0x3ef)]!=settings[_0xb7b0ab(0x2cb)]&&'@'+_0x1b956f[_0xb7b0ab(0x2c8)][_0xb7b0ab(0x3ef)]!=settings['telegramUsername']||_0x1b956f[_0xb7b0ab(0x3c0)]['id']!=settings[_0xb7b0ab(0x28f)])return sendTelegram(_0x1b956f[_0xb7b0ab(0x3c0)]['id'],_0xb7b0ab(0x1dc),{'parse_mode':'HTML'}),![];return!![];}function botRef(_0x31acf1){const _0x3d405a=_0x480a86,_0x30b832=getBotAttributes(_0x31acf1),_0x184657=_0x30b832[_0x3d405a(0x21c)]?_0x30b832[_0x3d405a(0x26a)]:'Bot\x20'+_0x31acf1;return _0x184657;}async function initTelegram(){const _0x668e14=_0x480a86;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x668e14(0x3e2)]);let _0x21a163=_0x668e14(0x2cd);_0x21a163+='\x0a',_0x21a163+=_0x668e14(0x1f4),_0x21a163+=_0x668e14(0x371),_0x21a163+=_0x668e14(0x381),_0x21a163+=_0x668e14(0x1d7),_0x21a163+='/on\x20-\x20start\x20bot(s)\x0a',_0x21a163+=_0x668e14(0x20a),_0x21a163+=_0x668e14(0x276),_0x21a163+=_0x668e14(0x25f),_0x21a163+=_0x668e14(0x3a6),_0x21a163+=_0x668e14(0x2be),_0x21a163+=_0x668e14(0x2af),_0x21a163+=_0x668e14(0x1fb),_0x21a163+=_0x668e14(0x311),_0x21a163+=_0x668e14(0x2fd),_0x21a163+=_0x668e14(0x3b9),_0x21a163+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x3b0241=_0x668e14(0x216);_0x3b0241+='\x0a',_0x3b0241+=_0x21a163,tgBot[_0x668e14(0x261)]((_0x21892f,_0x1ab971)=>{const _0xe51c01=_0x668e14;logger[_0xe51c01(0x377)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger['debug'](_0xe51c01(0x28c),_0x21892f);}),tgBot['use'](async(_0x4be8f6,_0x425e1a)=>{const _0x276e37=_0x668e14;if(settings[_0x276e37(0x28f)]||_0x4be8f6[_0x276e37(0x2e8)][_0x276e37(0x3d7)][_0x276e37(0x31e)]!=_0x276e37(0x1d8)){if(!validateTelegram(_0x4be8f6))return;}_0x425e1a();}),tgBot['command'](_0x668e14(0x30c),async _0x2bbb8d=>{const _0x3b7ced=_0x668e14;if(_0x2bbb8d[_0x3b7ced(0x2c8)][_0x3b7ced(0x3ef)]==settings[_0x3b7ced(0x2cb)]||'@'+_0x2bbb8d[_0x3b7ced(0x2c8)][_0x3b7ced(0x3ef)]==settings[_0x3b7ced(0x2cb)]){if(!settings[_0x3b7ced(0x28f)])updateSetting(_0x3b7ced(0x28f),_0x2bbb8d['chat']['id']);else{if(!validateTelegram(_0x2bbb8d))return;}}else{if(!validateTelegram(_0x2bbb8d))return;}updateSetting(_0x3b7ced(0x1d9),!![]),await sendTelegram(_0x2bbb8d[_0x3b7ced(0x3c0)]['id'],_0x3b0241);}),tgBot['command'](_0x668e14(0x3e4),async _0x20b497=>{const _0x490a74=_0x668e14;updateSetting(_0x490a74(0x1d9),!![]),await sendTelegram(_0x20b497[_0x490a74(0x3c0)]['id'],'Notifications\x20enabled');}),tgBot[_0x668e14(0x26c)]('disable',async _0x4ecc96=>{const _0x3140fb=_0x668e14;await sendTelegram(_0x4ecc96[_0x3140fb(0x3c0)]['id'],_0x3140fb(0x37c)),updateSetting(_0x3140fb(0x1d9),![]);}),tgBot[_0x668e14(0x26c)](_0x668e14(0x3d4),async _0x27dd9b=>{const _0x3bc21a=_0x668e14,_0x187712=Markup[_0x3bc21a(0x317)]([Markup['button']['callback'](_0x3bc21a(0x3ce),'config_orders'),Markup[_0x3bc21a(0x3e1)][_0x3bc21a(0x3cb)](_0x3bc21a(0x38c),_0x3bc21a(0x21f)),Markup[_0x3bc21a(0x3e1)][_0x3bc21a(0x3cb)](_0x3bc21a(0x390),_0x3bc21a(0x208))]);_0x27dd9b[_0x3bc21a(0x274)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x187712);}),tgBot[_0x668e14(0x2d8)](_0x668e14(0x2c9),async _0x115ff7=>{const _0x28206f=_0x668e14;_0x115ff7[_0x28206f(0x287)](),updateSetting(_0x28206f(0x210),_0x28206f(0x35a)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x115ff7[_0x28206f(0x3c0)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x668e14(0x2d8)]('config_alerts',async _0x381b82=>{const _0x701983=_0x668e14;_0x381b82[_0x701983(0x287)](),updateSetting(_0x701983(0x210),_0x701983(0x295)),updateSetting(_0x701983(0x1d9),!![]),await sendTelegram(_0x381b82[_0x701983(0x3c0)]['id'],_0x701983(0x1f1));}),tgBot[_0x668e14(0x2d8)](_0x668e14(0x208),async _0x40f4d7=>{const _0x1a3b0d=_0x668e14;_0x40f4d7['editMessageReplyMarkup'](),updateSetting(_0x1a3b0d(0x210),_0x1a3b0d(0x2d4)),updateSetting(_0x1a3b0d(0x1d9),!![]),await sendTelegram(_0x40f4d7[_0x1a3b0d(0x3c0)]['id'],_0x1a3b0d(0x380));}),tgBot[_0x668e14(0x26c)](_0x668e14(0x3dc),async _0x15b91b=>{const _0x48a953=_0x668e14,_0x48a778=getBotsWithMode();let _0x4fd498=_0x48a953(0x334);config[_0x48a953(0x233)](_0xef024f=>{const _0x568810=_0x48a953,_0x135827=_0x48a778[_0x568810(0x343)](_0x9f82f2=>_0x9f82f2['botID']==_0xef024f[_0x568810(0x386)])['mode'];_0x4fd498+='Bot\x20'+_0xef024f[_0x568810(0x386)]+':\x20'+_0xef024f['status']+_0x568810(0x2b8)+_0x135827+_0x568810(0x2b8)+_0xef024f['live']+'\x0a';}),_0x4fd498+='\x0a',_0x4fd498+=_0x48a953(0x37d),_0x4fd498+=!settings[_0x48a953(0x1d9)]?_0x48a953(0x3d5):_0x48a953(0x3e8),_0x4fd498+=settings[_0x48a953(0x1d9)]?settings[_0x48a953(0x210)]=='all'?_0x48a953(0x2d7):_0x48a953(0x1e9)+settings[_0x48a953(0x210)]+_0x48a953(0x29e):'',await sendTelegram(_0x15b91b[_0x48a953(0x3c0)]['id'],_0x4fd498,{'parse_mode':_0x48a953(0x24c)});}),tgBot[_0x668e14(0x26c)](_0x668e14(0x3a0),async _0x25910c=>{const _0x2b6d57=_0x668e14,_0x178c93=getEnabledBots();if(_0x178c93[_0x2b6d57(0x2bc)]==0x0)await sendTelegram(_0x25910c[_0x2b6d57(0x3c0)]['id'],_0x2b6d57(0x36f));else{if(_0x178c93['length']>0x1)_0x178c93[_0x2b6d57(0x358)]({'botID':'all'});let _0x125bf9=[],_0x1f0bf6=[];const _0x328787=_0x178c93[_0x2b6d57(0x2bc)]%0x4==0x0||_0x178c93[_0x2b6d57(0x2bc)]%0x4==0x3||_0x178c93['length']%0x3==0x1?0x4:0x3;let _0xdd0d2e=0x0;_0x178c93['forEach']((_0x21307d,_0x4bb005)=>{const _0x443cdb=_0x2b6d57;if(_0x4bb005%_0x328787==0x0)_0x1f0bf6=[];_0x1f0bf6[_0x443cdb(0x358)](Markup[_0x443cdb(0x3e1)][_0x443cdb(0x3cb)](_0x21307d['botID']==_0x443cdb(0x2d4)?'All\x20bots':botRef(_0x21307d[_0x443cdb(0x386)]),_0x443cdb(0x1fe)+_0x21307d['botID'])),_0x4bb005%_0x328787==0x0&&(_0x125bf9[_0xdd0d2e]=_0x1f0bf6,_0xdd0d2e++);});const _0x2d1727=Markup[_0x2b6d57(0x317)](_0x125bf9);_0x25910c[_0x2b6d57(0x274)](_0x2b6d57(0x289),_0x2d1727);}}),tgBot[_0x668e14(0x2d8)](/restart_(.+)/,async _0x26d79b=>{const _0x21d477=_0x668e14,_0x4def9e=_0x26d79b[_0x21d477(0x29a)][0x1];_0x26d79b['editMessageReplyMarkup'](),_0x4def9e==_0x21d477(0x2d4)?config[_0x21d477(0x233)](_0x3b3d0b=>{const _0x869539=_0x21d477;restartBot(_0x3b3d0b[_0x869539(0x386)]);}):restartBot(_0x4def9e);}),tgBot['command']('on',async _0x1e9a32=>{const _0x1d39ba=_0x668e14,_0x28697b=getDisabledBots();if(_0x28697b[_0x1d39ba(0x2bc)]==0x0)await sendTelegram(_0x1e9a32[_0x1d39ba(0x3c0)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x28697b[_0x1d39ba(0x2bc)]>0x1)_0x28697b[_0x1d39ba(0x358)]({'botID':_0x1d39ba(0x2d4)});let _0x1c8de9=[],_0x3b5a99=[];const _0x309611=_0x28697b[_0x1d39ba(0x2bc)]%0x4==0x0||_0x28697b['length']%0x4==0x3||_0x28697b[_0x1d39ba(0x2bc)]%0x3==0x1?0x4:0x3;let _0x5a3d9a=0x0;_0x28697b[_0x1d39ba(0x233)]((_0x5844de,_0xa91021)=>{const _0x32b287=_0x1d39ba;if(_0xa91021%_0x309611==0x0)_0x3b5a99=[];_0x3b5a99[_0x32b287(0x358)](Markup[_0x32b287(0x3e1)][_0x32b287(0x3cb)](_0x5844de[_0x32b287(0x386)]==_0x32b287(0x2d4)?_0x32b287(0x2ec):botRef(_0x5844de[_0x32b287(0x386)]),_0x32b287(0x2a2)+_0x5844de[_0x32b287(0x386)])),_0xa91021%_0x309611==0x0&&(_0x1c8de9[_0x5a3d9a]=_0x3b5a99,_0x5a3d9a++);});const _0x1f3963=Markup['inlineKeyboard'](_0x1c8de9);_0x1e9a32['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x1f3963);}}),tgBot['action'](/on_(.+)/,async _0x206661=>{const _0x4d4a51=_0x668e14,_0x214321=_0x206661['match'][0x1];_0x206661[_0x4d4a51(0x287)]();if(_0x214321==_0x4d4a51(0x2d4)){const _0x2d5e0a=getDisabledBots();await sendTelegram(_0x206661[_0x4d4a51(0x3c0)]['id'],_0x4d4a51(0x2cc)),_0x2d5e0a[_0x4d4a51(0x233)](_0x407c38=>{const _0x41fc4e=_0x4d4a51;if(_0x407c38[_0x41fc4e(0x386)]!='all')toggleBot(_0x407c38[_0x41fc4e(0x386)],toggleStatus(_0x407c38[_0x41fc4e(0x386)]),'stopped');});}else await sendTelegram(_0x206661[_0x4d4a51(0x3c0)]['id'],_0x4d4a51(0x3a8)+botRef(_0x214321)),toggleBot(_0x214321,toggleStatus(_0x214321),_0x4d4a51(0x35f));}),tgBot[_0x668e14(0x26c)]('off',async _0x3939ba=>{const _0x12e939=_0x668e14,_0x46ab5f=getEnabledBots();if(_0x46ab5f[_0x12e939(0x2bc)]==0x0)await sendTelegram(_0x3939ba[_0x12e939(0x3c0)]['id'],_0x12e939(0x36f));else{if(_0x46ab5f[_0x12e939(0x2bc)]>0x1)_0x46ab5f[_0x12e939(0x358)]({'botID':_0x12e939(0x2d4)});let _0x5485af=[],_0x4d5da7=[];const _0x46dc6d=_0x46ab5f[_0x12e939(0x2bc)]%0x4==0x0||_0x46ab5f[_0x12e939(0x2bc)]%0x4==0x3||_0x46ab5f[_0x12e939(0x2bc)]%0x3==0x1?0x4:0x3;let _0xe85ffe=0x0;_0x46ab5f[_0x12e939(0x233)]((_0x402470,_0x5019e4)=>{const _0x2cb4d9=_0x12e939;if(_0x5019e4%_0x46dc6d==0x0)_0x4d5da7=[];_0x4d5da7[_0x2cb4d9(0x358)](Markup['button']['callback'](_0x402470[_0x2cb4d9(0x386)]==_0x2cb4d9(0x2d4)?_0x2cb4d9(0x2ec):botRef(_0x402470[_0x2cb4d9(0x386)]),_0x2cb4d9(0x3f3)+_0x402470[_0x2cb4d9(0x386)])),_0x5019e4%_0x46dc6d==0x0&&(_0x5485af[_0xe85ffe]=_0x4d5da7,_0xe85ffe++);});const _0x162f85=Markup[_0x12e939(0x317)](_0x5485af);_0x3939ba['reply'](_0x12e939(0x277),_0x162f85);}}),tgBot['action'](/off_(.+)/,async _0x50b70d=>{const _0x30ef86=_0x668e14,_0x113091=_0x50b70d[_0x30ef86(0x29a)][0x1];_0x50b70d[_0x30ef86(0x287)]();if(_0x113091==_0x30ef86(0x2d4)){const _0x1600c7=getEnabledBots();await sendTelegram(_0x50b70d[_0x30ef86(0x3c0)]['id'],_0x30ef86(0x3cc)),_0x1600c7['forEach'](_0x5dce5a=>{const _0x1d0c98=_0x30ef86;if(_0x5dce5a['botID']!='all')toggleBot(_0x5dce5a[_0x1d0c98(0x386)],toggleStatus(_0x5dce5a[_0x1d0c98(0x386)]),_0x1d0c98(0x35f));});}else await sendTelegram(_0x50b70d[_0x30ef86(0x3c0)]['id'],_0x30ef86(0x3d0)+botRef(_0x113091)),toggleBot(_0x113091,toggleStatus(_0x113091),'stopped');}),tgBot['command']('metrics',async _0x5a490e=>{const _0xc62fec=_0x668e14,_0x1deea0=getEnabledBots();if(_0x1deea0[_0xc62fec(0x2bc)]==0x0)await sendTelegram(_0x5a490e['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1deea0[_0xc62fec(0x2bc)]>0x1){let _0x2b6501=[],_0x4dcf50=[];const _0x47dd74=_0x1deea0[_0xc62fec(0x2bc)]%0x4==0x0||_0x1deea0[_0xc62fec(0x2bc)]%0x4==0x3||_0x1deea0[_0xc62fec(0x2bc)]%0x3==0x1?0x4:0x3;let _0xf161c9=0x0;_0x1deea0['forEach']((_0x317a53,_0x509f07)=>{const _0x5d4502=_0xc62fec;if(_0x509f07%_0x47dd74==0x0)_0x4dcf50=[];_0x4dcf50['push'](Markup[_0x5d4502(0x3e1)][_0x5d4502(0x3cb)](botRef(_0x317a53[_0x5d4502(0x386)]),_0x5d4502(0x2f0)+_0x317a53[_0x5d4502(0x386)])),_0x509f07%_0x47dd74==0x0&&(_0x2b6501[_0xf161c9]=_0x4dcf50,_0xf161c9++);});const _0x2c346e=Markup[_0xc62fec(0x317)](_0x2b6501);_0x5a490e[_0xc62fec(0x274)](_0xc62fec(0x363),_0x2c346e);}else{const _0x25c809=_0x1deea0[0x0][_0xc62fec(0x386)];if(pid[_0x25c809])pid[_0x25c809]['send']({'function':_0xc62fec(0x22e),'args':null});}}}),tgBot[_0x668e14(0x2d8)](/metrics_(.+)/,async _0x44f160=>{const _0x305dd7=_0x668e14,_0x2e8697=_0x44f160[_0x305dd7(0x29a)][0x1];_0x44f160[_0x305dd7(0x287)]();if(pid[_0x2e8697])pid[_0x2e8697][_0x305dd7(0x1d4)]({'function':_0x305dd7(0x22e),'args':null});}),tgBot[_0x668e14(0x26c)](_0x668e14(0x268),async _0x47325a=>{const _0xca061a=_0x668e14,_0x1b810f=getEnabledBots();if(_0x1b810f[_0xca061a(0x2bc)]==0x0)await sendTelegram(_0x47325a['chat']['id'],_0xca061a(0x36f));else{if(_0x1b810f['length']>0x1){let _0x5d4f0d=[],_0x37043f=[];const _0x20e2e2=_0x1b810f[_0xca061a(0x2bc)]%0x4==0x0||_0x1b810f[_0xca061a(0x2bc)]%0x4==0x3||_0x1b810f[_0xca061a(0x2bc)]%0x3==0x1?0x4:0x3;let _0x5530e1=0x0;_0x1b810f['forEach']((_0x526840,_0x216302)=>{const _0x5c67eb=_0xca061a;if(_0x216302%_0x20e2e2==0x0)_0x37043f=[];_0x37043f[_0x5c67eb(0x358)](Markup[_0x5c67eb(0x3e1)][_0x5c67eb(0x3cb)](botRef(_0x526840[_0x5c67eb(0x386)]),'portfolio_'+_0x526840[_0x5c67eb(0x386)])),_0x216302%_0x20e2e2==0x0&&(_0x5d4f0d[_0x5530e1]=_0x37043f,_0x5530e1++);});const _0x330b4f=Markup[_0xca061a(0x317)](_0x5d4f0d);_0x47325a[_0xca061a(0x274)](_0xca061a(0x3b2),_0x330b4f);}else{const _0x129998=_0x1b810f[0x0][_0xca061a(0x386)];if(pid[_0x129998])pid[_0x129998][_0xca061a(0x1d4)]({'function':_0xca061a(0x26b),'args':null});}}}),tgBot[_0x668e14(0x2d8)](/portfolio_(.+)/,async _0x2a6e44=>{const _0x5dfffb=_0x668e14,_0x23f59f=_0x2a6e44['match'][0x1];_0x2a6e44[_0x5dfffb(0x287)]();if(pid[_0x23f59f])pid[_0x23f59f][_0x5dfffb(0x1d4)]({'function':_0x5dfffb(0x26b),'args':null});}),tgBot['command']('logs',async _0x250a48=>{const _0x2877dd=_0x668e14,_0x43ea33=_0x2877dd(0x241);await zipFiles(_0x43ea33);const _0x49aafd=zippath+(_0x43ea33+_0x2877dd(0x23e));_0x250a48[_0x2877dd(0x2b3)]({'source':_0x49aafd})[_0x2877dd(0x1d5)](()=>{})['catch'](_0x490e99=>logger['debug'](_0x2877dd(0x2b4)+_0x43ea33+_0x2877dd(0x275),_0x490e99));}),tgBot[_0x668e14(0x26c)](_0x668e14(0x33f),async _0x1705a5=>{const _0x58f124=_0x668e14,_0x1bdff3=_0x58f124(0x33f);await backupConfigFiles(),await zipFiles(_0x1bdff3);const _0x14303a=zippath+(_0x1bdff3+_0x58f124(0x23e));_0x1705a5[_0x58f124(0x2b3)]({'source':_0x14303a})['then'](()=>{})[_0x58f124(0x261)](_0x17d236=>logger[_0x58f124(0x235)](_0x58f124(0x2b4)+_0x1bdff3+_0x58f124(0x275),_0x17d236));}),tgBot['command'](_0x668e14(0x2e8),async _0x48f21f=>{const _0x22bd55=_0x668e14;await getMessages();if(!updateAvailable)await sendTelegram(_0x48f21f['chat']['id'],_0x22bd55(0x34c));else{if(!validInstallation)await sendTelegram(_0x48f21f[_0x22bd55(0x3c0)]['id'],_0x22bd55(0x3aa));else{const _0x226f34=Markup[_0x22bd55(0x317)]([Markup[_0x22bd55(0x3e1)]['callback']('Yes',_0x22bd55(0x1d0)),Markup['button'][_0x22bd55(0x3cb)]('No',_0x22bd55(0x3b3))]);_0x48f21f[_0x22bd55(0x274)](_0x22bd55(0x2c6),_0x226f34);}}}),tgBot['action'](/update_(.+)/,async _0x4ea0da=>{const _0x322543=_0x668e14,_0x59efe1=_0x4ea0da[_0x322543(0x29a)][0x1];_0x4ea0da[_0x322543(0x287)](),_0x59efe1==_0x322543(0x203)&&(await sendTelegram(_0x4ea0da[_0x322543(0x3c0)]['id'],_0x322543(0x345)),updateBB(_0x322543(0x2e8))),_0x59efe1=='no'&&await sendTelegram(_0x4ea0da['chat']['id'],_0x322543(0x3c4));}),tgBot[_0x668e14(0x26c)](_0x668e14(0x349),async _0x507753=>{const _0x133eb4=_0x668e14;if(!validInstallation)await sendTelegram(_0x507753[_0x133eb4(0x3c0)]['id'],_0x133eb4(0x2b0));else{const _0x306d53=Markup[_0x133eb4(0x317)]([Markup['button'][_0x133eb4(0x3cb)]('Yes',_0x133eb4(0x1de)),Markup[_0x133eb4(0x3e1)][_0x133eb4(0x3cb)]('No',_0x133eb4(0x35d))]);_0x507753[_0x133eb4(0x274)](_0x133eb4(0x294),_0x306d53);}}),tgBot['action'](/reinstall_(.+)/,async _0x849bd5=>{const _0x23c7ac=_0x668e14,_0xce6d8=_0x849bd5[_0x23c7ac(0x29a)][0x1];_0x849bd5['editMessageReplyMarkup'](),_0xce6d8=='yes'&&(await sendTelegram(_0x849bd5['chat']['id'],_0x23c7ac(0x2b2)),updateBB(_0x23c7ac(0x349))),_0xce6d8=='no'&&await sendTelegram(_0x849bd5[_0x23c7ac(0x3c0)]['id'],_0x23c7ac(0x3f1));}),tgBot[_0x668e14(0x26c)](_0x668e14(0x260),async _0x544a26=>{const _0x10c296=_0x668e14,_0x4236f8=getBotsWithMode();if(_0x4236f8[_0x10c296(0x2bc)]==0x0)await sendTelegram(_0x544a26[_0x10c296(0x3c0)]['id'],_0x10c296(0x36f));else{let _0x4f0f6f=[],_0x9cf29=[];const _0x55238e=0x2;let _0x319978=0x0;_0x4236f8['forEach']((_0x2b61f1,_0x5e5b3f)=>{const _0x2fa81e=_0x10c296;if(_0x5e5b3f%_0x55238e==0x0)_0x9cf29=[];_0x9cf29[_0x2fa81e(0x358)](Markup[_0x2fa81e(0x3e1)][_0x2fa81e(0x3cb)](botRef(_0x2b61f1[_0x2fa81e(0x386)])+'\x20('+_0x2b61f1[_0x2fa81e(0x362)]+')',_0x2fa81e(0x303)+_0x2b61f1[_0x2fa81e(0x386)])),_0x5e5b3f%_0x55238e==0x0&&(_0x4f0f6f[_0x319978]=_0x9cf29,_0x319978++);});const _0x86e893=Markup[_0x10c296(0x317)](_0x4f0f6f);_0x544a26[_0x10c296(0x274)](_0x10c296(0x2b6),_0x86e893);}}),tgBot[_0x668e14(0x2d8)](/toggle_(.+)/,async _0x1e103f=>{const _0x5759d2=_0x668e14,_0x360905=_0x1e103f[_0x5759d2(0x29a)][0x1];_0x1e103f[_0x5759d2(0x287)]();const _0x27f484=getBotsWithMode(),_0x216212=_0x27f484[_0x5759d2(0x343)](_0x2ea594=>_0x2ea594['botID']==_0x360905),_0x5e911d=_0x216212[_0x5759d2(0x362)]==_0x5759d2(0x305)?_0x5759d2(0x271):_0x5759d2(0x305);await sendTelegram(_0x1e103f['chat']['id'],_0x5759d2(0x2e3)+botRef(_0x216212[_0x5759d2(0x386)])+_0x5759d2(0x258)+_0x5e911d+'\x20mode'),toggleBotMode(_0x360905);}),tgBot[_0x668e14(0x26c)](_0x668e14(0x3ec),async _0x193a97=>{const _0x3c2580=_0x668e14;let _0x5e215e='';config[_0x3c2580(0x233)](_0x2f4c9b=>{const _0x4c88e1=_0x3c2580;_0x5e215e+='Bot\x20'+_0x2f4c9b[_0x4c88e1(0x386)]+':\x20'+_0x2f4c9b[_0x4c88e1(0x26a)]+'\x0a';}),await sendTelegram(_0x193a97['chat']['id'],_0x5e215e,{'parse_mode':'HTML'});}),tgBot[_0x668e14(0x26c)](_0x668e14(0x232),async _0x18f616=>{const _0x569a96=_0x668e14;await sendTelegram(_0x18f616[_0x569a96(0x3c0)]['id'],_0x21a163);}),process[_0x668e14(0x225)](_0x668e14(0x237),()=>tgBot[_0x668e14(0x32f)](_0x668e14(0x237))),process[_0x668e14(0x225)](_0x668e14(0x1ec),()=>tgBot[_0x668e14(0x32f)]('SIGTERM')),tgBot[_0x668e14(0x399)]();}function disableTelegram(){const _0x6bda33=_0x480a86;tgBot&&tgBot[_0x6bda33(0x32f)]();}async function sendTelegram(_0xca825f,_0x32ae4b,_0xb5dea3){const _0xd85a1f=_0x480a86;_0xb5dea3={..._0xb5dea3,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0xd85a1f(0x1e4)](_0xca825f,_0x32ae4b,_0xb5dea3);}catch(_0x5d3c9b){logger[_0xd85a1f(0x235)]('Telegram\x20error:',_0x5d3c9b);}}async function sendTelegramBot(_0x32ad7c,_0x92ddc7){const _0x2d8357=_0x480a86;if(settings[_0x2d8357(0x1d9)]){if(settings[_0x2d8357(0x210)]==_0x2d8357(0x2d4)||(_0x92ddc7[_0x2d8357(0x25b)]==_0x2d8357(0x1da)||_0x92ddc7[_0x2d8357(0x25b)]==_0x2d8357(0x27a)||_0x92ddc7[_0x2d8357(0x25b)]=='success')&&settings[_0x2d8357(0x210)]==_0x2d8357(0x295)||_0x92ddc7[_0x2d8357(0x25b)]==_0x2d8357(0x1e5)&&settings[_0x2d8357(0x210)]==_0x2d8357(0x35a)){if(tgBot&&settings[_0x2d8357(0x28f)]){if(_0x92ddc7[_0x2d8357(0x21c)])await sendTelegram(settings[_0x2d8357(0x28f)],_0x92ddc7['botname']+_0x2d8357(0x366)+_0x92ddc7[_0x2d8357(0x28a)]);else await sendTelegram(settings[_0x2d8357(0x28f)],_0x2d8357(0x1e0)+_0x32ad7c+_0x2d8357(0x366)+_0x92ddc7[_0x2d8357(0x28a)]);}}}}async function sendTelegramMsg(_0x26b6cb,_0x1618bb=_0x480a86(0x24c)){const _0x535990=_0x480a86;return tgBot&&settings[_0x535990(0x28f)]?(await sendTelegram(settings['telegramChatId'],_0x26b6cb,{'parse_mode':_0x1618bb}),!![]):![];}function getDeviceWithIp(_0x19dd87){const _0x5534f8=_0x480a86;return devices[_0x5534f8(0x343)](_0x4557c9=>_0x4557c9['ip']===_0x19dd87);}async function temporaryAccess2FA(_0x358d92,_0x5223d0){const _0x2f59eb=_0x480a86;let _0x348774=new Date(),_0x26b12e=![];if(lastIpApproval){if(_0x348774-lastIpApproval<0x1388)_0x26b12e=!![];}lastIpApproval=new Date();if(_0x26b12e)return;if(tgBot&&settings['telegramChatId']){const _0x31041a=uuidRandom();tmpStorage[_0x31041a]={'uuid':_0x358d92,'externalip':_0x5223d0};const _0x24e68e=Markup[_0x2f59eb(0x317)]([Markup[_0x2f59eb(0x3e1)][_0x2f59eb(0x3cb)](_0x2f59eb(0x256),_0x2f59eb(0x3d6)+_0x31041a),Markup[_0x2f59eb(0x3e1)]['callback']('15\x20min','tempaccess_15_'+_0x31041a),Markup['button'][_0x2f59eb(0x3cb)]('30\x20min',_0x2f59eb(0x3c2)+_0x31041a),Markup[_0x2f59eb(0x3e1)]['callback']('reject',_0x2f59eb(0x2a3)+_0x31041a)]);await sendTelegram(settings[_0x2f59eb(0x28f)],_0x2f59eb(0x1e2)+normalizeIP(_0x5223d0)[_0x2f59eb(0x1ef)]+'\x20?',_0x24e68e),tgBot[_0x2f59eb(0x2d8)](/tempaccess_(.+)_(.+)/,async _0xd9568d=>{const _0x200225=_0x2f59eb,_0x5a0712=_0xd9568d['match'][0x1],_0x3b0655=_0xd9568d[_0x200225(0x29a)][0x2],{uuid:_0x488243,externalip:_0x1b1460}=tmpStorage[_0x3b0655];delete tmpStorage[_0x3b0655],_0xd9568d[_0x200225(0x287)](),devices[_0x488243][_0x200225(0x29f)]={'clientip':_0x1b1460,'timestamp':new Date()[_0x200225(0x392)](),'expiry':_0x5a0712},_0x5a0712!='reject'?(await sendTelegram(_0xd9568d[_0x200225(0x3c0)]['id'],_0x200225(0x2f6)+_0x5a0712+_0x200225(0x312),{'parse_mode':_0x200225(0x24c)}),io['to'](_0x488243)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0xd9568d[_0x200225(0x3c0)]['id'],_0x200225(0x2a9)),io['to'](_0x488243)[_0x200225(0x336)](_0x200225(0x3dc),{'access':{'allow':![],'reason':_0x200225(0x34e),'token':null}}));});}}async function loginAccess2FA(_0x37102a,_0x5246e6){const _0x3e25f5=_0x480a86;if(tgBot&&settings['telegramChatId']){const _0x216801=uuidRandom();tmpStorage[_0x216801]={'uuid':_0x37102a,'externalip':_0x5246e6};const _0x199679=Markup[_0x3e25f5(0x317)]([Markup[_0x3e25f5(0x3e1)][_0x3e25f5(0x3cb)](_0x3e25f5(0x383),_0x3e25f5(0x2e1)+loginExpiry+'_'+_0x216801),Markup[_0x3e25f5(0x3e1)][_0x3e25f5(0x3cb)]('reject','login2fa_reject_'+_0x216801)]);await sendTelegram(settings[_0x3e25f5(0x28f)],_0x3e25f5(0x367)+normalizeIP(_0x5246e6)[_0x3e25f5(0x1ef)]+'\x20?',_0x199679),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x49b579=>{const _0x3a6a60=_0x3e25f5,_0x149817=_0x49b579['match'][0x1],_0x12148c=_0x49b579['match'][0x2],{uuid:_0x88d8cd,externalip:_0x73b7c0}=tmpStorage[_0x12148c];delete tmpStorage[_0x12148c],_0x49b579[_0x3a6a60(0x287)](),devices[_0x88d8cd][_0x3a6a60(0x1f8)]={'clientip':_0x73b7c0,'timestamp':new Date()['getTime'](),'expiry':_0x149817},_0x149817!='reject'?(await sendTelegram(_0x49b579[_0x3a6a60(0x3c0)]['id'],_0x3a6a60(0x255),{'parse_mode':_0x3a6a60(0x24c)}),io['to'](_0x88d8cd)[_0x3a6a60(0x336)]('status',{'access':{'allow':![],'reason':_0x3a6a60(0x325),'token':null}})):(await sendTelegram(_0x49b579[_0x3a6a60(0x3c0)]['id'],_0x3a6a60(0x373)),io['to'](_0x88d8cd)[_0x3a6a60(0x336)](_0x3a6a60(0x3dc),{'access':{'allow':![],'reason':_0x3a6a60(0x244),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x37408e=_0x480a86;return dbConfig[_0x37408e(0x29c)](_0x37408e(0x354))['sortBy'](_0x37408e(0x386))[_0x37408e(0x32a)]({'status':_0x37408e(0x1cf)})['value']()||[];}function getDisabledBots(){const _0x4dd57b=_0x480a86;return dbConfig[_0x4dd57b(0x29c)]('bots')['sortBy'](_0x4dd57b(0x386))[_0x4dd57b(0x32a)]({'status':'disabled'})['value']()||[];}function getBotAttributes(_0x2a26e4){const _0xbc456d=_0x480a86;let _0x420bdb={};const _0x4d083c=configpath+_0xbc456d(0x2c1)+_0x2a26e4+'-config.json',_0xc4e59d=fs[_0xbc456d(0x230)](_0x4d083c);if(_0xc4e59d){const _0x5195fc=fs['readFileSync'](_0x4d083c);try{const _0x7c7480=JSON['parse'](_0x5195fc),_0x9e0428=_0x7c7480?_0x7c7480[_0xbc456d(0x307)][0x0]['headless']:![];_0x420bdb['mode']=_0x9e0428?_0xbc456d(0x305):_0xbc456d(0x271),_0x420bdb[_0xbc456d(0x26a)]=_0x7c7480?_0x7c7480[_0xbc456d(0x307)][0x0][_0xbc456d(0x26a)]:_0xbc456d(0x1e0)+_0x2a26e4,_0x420bdb[_0xbc456d(0x21c)]=_0x7c7480?_0x7c7480[_0xbc456d(0x307)][0x0][_0xbc456d(0x21c)]:![];}catch(_0x4ea677){_0x420bdb[_0xbc456d(0x362)]=_0xbc456d(0x271),_0x420bdb[_0xbc456d(0x26a)]=_0xbc456d(0x1e0)+_0x2a26e4,_0x420bdb[_0xbc456d(0x21c)]=![];}}else _0x420bdb[_0xbc456d(0x362)]=_0xbc456d(0x271),_0x420bdb['botname']=_0xbc456d(0x1e0)+_0x2a26e4,_0x420bdb[_0xbc456d(0x21c)]=![];return _0x420bdb;}function getBotsWithMode(){const _0x539482=_0x480a86,_0x56cf61=dbConfig[_0x539482(0x29c)]('bots')[_0x539482(0x224)](_0x539482(0x386))[_0x539482(0x26f)]()||[];return _0x56cf61['forEach'](_0x51982a=>{const _0x135262=_0x539482;let _0x3066a7=getBotAttributes(_0x51982a['botID']);_0x51982a[_0x135262(0x362)]=_0x3066a7[_0x135262(0x362)];}),_0x56cf61;}function getBotExchanges(){const _0x4df638=_0x480a86;let _0x1771e3=[];const _0x3f57cd=dbConfig['get'](_0x4df638(0x354))[_0x4df638(0x224)](_0x4df638(0x386))[_0x4df638(0x26f)]()||[];_0x3f57cd[_0x4df638(0x233)](_0x194fe4=>{const _0x51d225=_0x4df638;if(_0x194fe4[_0x51d225(0x3dc)]==_0x51d225(0x1cf)){const _0x2bab1b=configpath+_0x51d225(0x2c1)+_0x194fe4[_0x51d225(0x386)]+_0x51d225(0x341),_0x5a6998=fs[_0x51d225(0x230)](_0x2bab1b);let _0x373a18;if(_0x5a6998){const _0x5da8d5=fs[_0x51d225(0x30d)](_0x2bab1b);try{const _0x384e33=JSON[_0x51d225(0x215)](_0x5da8d5);_0x373a18=_0x384e33?_0x384e33[_0x51d225(0x307)][0x0][_0x51d225(0x296)]:null;}catch(_0x1b4be5){}}if(_0x373a18)_0x1771e3['push'](_0x373a18);}});const _0x19860e=[...new Set(_0x1771e3)]['sort']();return _0x19860e;}async function initUser(){const _0x3f880e=_0x480a86;if(!settings['userid']){const _0xd12ad9=uuidRandom();mixpanel['alias'](_0xd12ad9),updateSetting(_0x3f880e(0x37a),_0xd12ad9);}}async function initSecure(){const _0x267807=_0x480a86;let _0x159013=getSecure();if(!_0x159013[_0x267807(0x28b)](_0x267807(0x34a))){let _0x4f2d75=await generateKeys();_0x159013[_0x267807(0x32e)]=_0x4f2d75[_0x267807(0x32e)],_0x159013[_0x267807(0x254)]=_0x4f2d75[_0x267807(0x254)],_0x159013[_0x267807(0x34a)]=crypto[_0x267807(0x2ca)](0x20)[_0x267807(0x209)](_0x267807(0x2a0));;storeSecure(_0x159013);}}function getSettings(){const _0xb23bea=_0x480a86;return dbSettings[_0xb23bea(0x29c)](_0xb23bea(0x3ac))['value']()||{};}function getSecure(){const _0x3d9f10=_0x480a86;return dbSecure['get'](_0x3d9f10(0x1fa))[_0x3d9f10(0x26f)]()||{};}function getBlacklist(){const _0x19138f=_0x480a86;return dbSecure['get'](_0x19138f(0x229))[_0x19138f(0x26f)]()||[];}function broadcastToBots(_0x583f9d,_0x1c701f){const _0x53e6f2=_0x480a86;config[_0x53e6f2(0x233)](_0x41a11d=>{const _0x4c9f76=_0x53e6f2;if(_0x41a11d[_0x4c9f76(0x3dc)]==_0x4c9f76(0x1cf)&&_0x41a11d[_0x4c9f76(0x1f2)]==_0x4c9f76(0x369)||_0x41a11d['status']=='new'&&_0x41a11d['live']==_0x4c9f76(0x369)){if(pid[_0x41a11d[_0x4c9f76(0x386)]])pid[_0x41a11d[_0x4c9f76(0x386)]][_0x4c9f76(0x1d4)]({[_0x583f9d]:_0x1c701f});}});}async function storeSettings(_0x31aba9,_0x2a1b8c=![]){const _0xa2f793=_0x480a86;_0x31aba9={...settings,..._0x31aba9};if(_0x2a1b8c&&_0x31aba9[_0xa2f793(0x37b)]!='************'&&_0x31aba9['bbPassword']!='***'&&_0x31aba9[_0xa2f793(0x37b)]!=''){const _0x33ff4e=decryptRSA(secure[_0xa2f793(0x254)],_0x31aba9[_0xa2f793(0x37b)])['split'](_0xa2f793(0x299))[0x0],_0x130f84=bcrypt[_0xa2f793(0x38a)](_0x33ff4e,saltRounds);_0x31aba9={..._0x31aba9,'bbPassword':_0x130f84};}if(_0x2a1b8c&&_0x31aba9[_0xa2f793(0x3e2)]!=_0xa2f793(0x23f)&&_0x31aba9[_0xa2f793(0x3e2)]!=_0xa2f793(0x308)&&_0x31aba9[_0xa2f793(0x3e2)]!=''){const _0x17f201=decryptRSA(secure[_0xa2f793(0x254)],_0x31aba9[_0xa2f793(0x3e2)])[_0xa2f793(0x257)](_0xa2f793(0x299))[0x0];_0x31aba9={..._0x31aba9,'telegramToken':_0x17f201};}if(_0x2a1b8c&&_0x31aba9[_0xa2f793(0x347)]!='************'&&_0x31aba9[_0xa2f793(0x347)]!=_0xa2f793(0x308)&&_0x31aba9[_0xa2f793(0x347)]!=''){const _0x2986b6=decryptRSA(secure[_0xa2f793(0x254)],_0x31aba9[_0xa2f793(0x347)])[_0xa2f793(0x257)]('|@|')[0x0];_0x31aba9={..._0x31aba9,'marketcapApi':_0x2986b6};}const _0x1f948e=_0x31aba9[_0xa2f793(0x3e2)]!=_0xa2f793(0x23f)&&_0x31aba9[_0xa2f793(0x3e2)]!=settings[_0xa2f793(0x3e2)]||_0x31aba9[_0xa2f793(0x2cb)]!=settings['telegramUsername'],_0x5157ef=_0x31aba9[_0xa2f793(0x3e2)]==''||_0x31aba9[_0xa2f793(0x2cb)]=='',_0x84863f=_0x31aba9[_0xa2f793(0x347)]&&_0x31aba9[_0xa2f793(0x347)]!=_0xa2f793(0x23f)&&_0x31aba9[_0xa2f793(0x347)]!=settings[_0xa2f793(0x347)];_0x1f948e&&(_0x31aba9[_0xa2f793(0x28f)]=null,_0x31aba9[_0xa2f793(0x210)]=_0xa2f793(0x2d4));for(const [_0x3dcb08,_0x3d7394]of Object['entries'](_0x31aba9)){if(_0x3dcb08==_0xa2f793(0x3e2)&&_0x3d7394==_0xa2f793(0x23f)){_0x31aba9[_0xa2f793(0x3e2)]=settings[_0xa2f793(0x3e2)];continue;};if(_0x3dcb08==_0xa2f793(0x37b)&&_0x3d7394==_0xa2f793(0x23f)){_0x31aba9[_0xa2f793(0x37b)]=settings['bbPassword'];continue;};if(_0x3dcb08==_0xa2f793(0x347)&&_0x3d7394=='************'){_0x31aba9['marketcapApi']=settings[_0xa2f793(0x347)];continue;};dbSettings[_0xa2f793(0x368)](_0xa2f793(0x2a7)+_0x3dcb08,_0x3d7394)['write']();}settings=_0x31aba9,io['to'](_0xa2f793(0x288))['emit'](_0xa2f793(0x3ac),cleanSettings()),broadcastToBots('timeshift',settings['timeshift']),broadcastToBots(_0xa2f793(0x22d),settings[_0xa2f793(0x22d)]),broadcastToBots('marketcapApi',settings['marketcapApi']);if(_0x1f948e&&!_0x5157ef)initTelegram();_0x1f948e&&_0x5157ef&&(updateSetting(_0xa2f793(0x28f),null),disableTelegram()),getAllClients()[_0xa2f793(0x233)](_0x5b987f=>{const _0x10c6e8=_0xa2f793;getSocket(_0x5b987f['id'])[_0x10c6e8(0x336)](_0x10c6e8(0x3dc),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x84863f&&(await sleep(0xbb8),testMarketcapApi(_0x31aba9[_0xa2f793(0x347)]));}async function testMarketcapApi(_0xbe2b0f){const _0x3b8edd=_0x480a86,_0xe0306e=[_0x3b8edd(0x239),_0x3b8edd(0x240)];try{await axios[_0x3b8edd(0x29c)](_0x3b8edd(0x2a4),{'headers':{'X-CMC_PRO_API_KEY':_0xbe2b0f},'params':{'symbol':_0xe0306e['toString']()}});}catch(_0x5643dc){_0x5643dc[_0x3b8edd(0x209)]()['includes'](_0x3b8edd(0x327))?(io['to'](_0x3b8edd(0x288))[_0x3b8edd(0x336)](_0x3b8edd(0x1e1),_0x3b8edd(0x32b)),logger[_0x3b8edd(0x31b)](_0x3b8edd(0x32b))):(io['to']('botmanager')['emit']('notification',_0x3b8edd(0x302)),logger[_0x3b8edd(0x31b)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x3b8edd(0x235)]('Error\x20details:',_0x5643dc[_0x3b8edd(0x209)]()+_0x3b8edd(0x24b)+_0x5643dc[_0x3b8edd(0x3e7)]));return;}logger['debug'](_0x3b8edd(0x396));}function updateSetting(_0x137600,_0x5e0bf5){const _0x3fa9c9=_0x480a86;dbSettings[_0x3fa9c9(0x368)](_0x3fa9c9(0x2a7)+_0x137600,_0x5e0bf5)['write'](),settings=getSettings(),io['to'](_0x3fa9c9(0x288))['emit']('settings',cleanSettings());}function storeSecure(_0x109937){const _0x2cf7fc=_0x480a86;dbSecure[_0x2cf7fc(0x29c)](_0x2cf7fc(0x1fa))['push'](_0x109937)[_0x2cf7fc(0x2ed)](),secure=_0x109937;}function addBlacklist(_0x4fc16b){const _0x5a0815=_0x480a86;cleanBlacklist();let _0x400123;devices[_0x4fc16b][_0x5a0815(0x29f)]?_0x400123=Math[_0x5a0815(0x1d2)](devices[_0x4fc16b][_0x5a0815(0x29f)][_0x5a0815(0x1e6)],loginExpiry):_0x400123=loginExpiry,dbSecure[_0x5a0815(0x29c)]('blacklist')[_0x5a0815(0x358)]({'expiry':new Date()[_0x5a0815(0x392)]()+_0x400123*0x3c*0x3e8,'token':devices[_0x4fc16b]['access'][_0x5a0815(0x2ce)]})[_0x5a0815(0x2ed)](),blacklist=dbSecure[_0x5a0815(0x29c)](_0x5a0815(0x229))[_0x5a0815(0x26f)]();}function cleanBlacklist(){const _0x5b6657=_0x480a86;let _0x2ca655=dbSecure['get'](_0x5b6657(0x229))[_0x5b6657(0x2d3)]()[_0x5b6657(0x26f)](),_0x3a606e=new Date()['getTime']();_0x2ca655['forEach'](_0x40a4d0=>{const _0x228b35=_0x5b6657;_0x40a4d0['expiry']<_0x3a606e&&dbSecure['get'](_0x228b35(0x229))[_0x228b35(0x23d)]({'expiry':_0x40a4d0[_0x228b35(0x1e6)]})[_0x228b35(0x2ed)]();});}function initStates(){const _0x5dd581=_0x480a86;let _0x3cea08=getConfiguration();_0x3cea08[_0x5dd581(0x233)](_0x52fdbc=>{const _0x2b4289=_0x5dd581;_0x52fdbc[_0x2b4289(0x1f2)]='stopped';}),storeConfiguration(_0x3cea08);}async function generateKeys(){const _0x284871=_0x480a86,_0x527a64=forge['pki'][_0x284871(0x2b1)]['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0xa588ae=forge[_0x284871(0x2d5)][_0x284871(0x2d1)](_0x527a64['privateKey']),_0x4bf0ca=forge['pki'][_0x284871(0x3da)](_0x527a64[_0x284871(0x32e)]);return{'privateKey':_0xa588ae,'publicKey':_0x4bf0ca};}async function oneTimeMigration(){const _0x126f8b=_0x480a86;let _0x110403=getSettings(),_0x5dc6c3=![];!_0x110403[_0x126f8b(0x28b)](_0x126f8b(0x2f9))&&(_0x110403[_0x126f8b(0x2f9)]=0x0,_0x5dc6c3=!![]);!_0x110403[_0x126f8b(0x28b)](_0x126f8b(0x3cd))&&(_0x110403[_0x126f8b(0x3cd)]=0x0,_0x5dc6c3=!![]);!_0x110403[_0x126f8b(0x28b)]('latestversion')&&(_0x110403[_0x126f8b(0x1df)]=_0x126f8b(0x2f8),_0x5dc6c3=!![]);!_0x110403[_0x126f8b(0x28b)](_0x126f8b(0x22d))&&(_0x110403[_0x126f8b(0x22d)]=![],_0x5dc6c3=!![]);!_0x110403[_0x126f8b(0x28b)](_0x126f8b(0x347))&&(_0x110403[_0x126f8b(0x347)]='',_0x5dc6c3=!![]);if(_0x5dc6c3)storeSettings(_0x110403);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x126f8b(0x233)](_0x259468=>{const _0x39b276=_0x126f8b;if(!_0x259468[_0x39b276(0x3c7)]()){if(!_0x259468['name'][_0x39b276(0x3d8)](_0x39b276(0x20e)))fs[_0x39b276(0x391)](configbackuppath+_0x259468['name']);}else fs[_0x39b276(0x269)](configbackuppath+_0x259468[_0x39b276(0x330)],{'recursive':!![]});});}catch(_0x33be78){logger['debug'](_0x126f8b(0x389),_0x33be78);}}function storeConfiguration(_0x1c7291){const _0x27ece5=_0x480a86;dbConfig[_0x27ece5(0x29c)](_0x27ece5(0x354))[_0x27ece5(0x23d)]()[_0x27ece5(0x2ed)](),dbConfig[_0x27ece5(0x29c)](_0x27ece5(0x354))[_0x27ece5(0x358)](..._0x1c7291)['write'](),config=_0x1c7291;}async function resetPassword(){const _0x5bf9b0=_0x480a86;if(tgBot&&settings[_0x5bf9b0(0x28f)]){const _0x42bc7a=Markup[_0x5bf9b0(0x317)]([Markup[_0x5bf9b0(0x3e1)][_0x5bf9b0(0x3cb)]('yes',_0x5bf9b0(0x31a)),Markup[_0x5bf9b0(0x3e1)][_0x5bf9b0(0x3cb)]('no',_0x5bf9b0(0x3cf))]);await sendTelegram(settings[_0x5bf9b0(0x28f)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x42bc7a),tgBot[_0x5bf9b0(0x2d8)](/resetpw_(.+)/,async _0x54a2ad=>{const _0x8cf736=_0x5bf9b0,_0x17a652=_0x54a2ad[_0x8cf736(0x29a)][0x1];_0x54a2ad[_0x8cf736(0x287)]();if(_0x17a652!='no'){const _0x3b19d8=0xf,_0x491495=_0x8cf736(0x28d),_0x2e528d=Array[_0x8cf736(0x2c8)](crypto[_0x8cf736(0x2fa)](new Uint32Array(_0x3b19d8)))[_0x8cf736(0x231)](_0x2eeadc=>_0x491495[_0x2eeadc%_0x491495[_0x8cf736(0x2bc)]])[_0x8cf736(0x2ae)](''),_0x20aaf4=bcrypt[_0x8cf736(0x38a)](_0x2e528d,saltRounds);storeSettings({'bbPassword':_0x20aaf4}),await sendTelegram(_0x54a2ad[_0x8cf736(0x3c0)]['id'],_0x8cf736(0x286)+_0x2e528d,{'parse_mode':_0x8cf736(0x24c)});}else await sendTelegram(_0x54a2ad[_0x8cf736(0x3c0)]['id'],_0x8cf736(0x2c0));});}}async function confirmRestore(_0x4d5ccf,_0x2afb6f){const _0x28297d=_0x480a86;io['to'](_0x28297d(0x288))[_0x28297d(0x336)]('notification','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x28297d(0x2ba));if(tgBot&&settings[_0x28297d(0x28f)]){const _0x38bcce=uuidRandom();tmpStorage[_0x38bcce]={'path':_0x4d5ccf,'filename':_0x2afb6f};const _0x1e243b=Markup['inlineKeyboard']([Markup[_0x28297d(0x3e1)][_0x28297d(0x3cb)]('yes','restore_yes_'+_0x38bcce),Markup['button']['callback']('no',_0x28297d(0x337)+_0x38bcce)]);await sendTelegram(settings[_0x28297d(0x28f)],_0x28297d(0x2cf),_0x1e243b),tgBot[_0x28297d(0x2d8)](/restore_(.+)_(.+)/,async _0x9e4d0b=>{const _0x2a5db6=_0x28297d,_0x5675cc=_0x9e4d0b[_0x2a5db6(0x29a)][0x1],_0x247e6e=_0x9e4d0b[_0x2a5db6(0x29a)][0x2],{path:_0x3d7a2f,filename:_0x1af954}=tmpStorage[_0x247e6e];delete tmpStorage[_0x247e6e],_0x9e4d0b[_0x2a5db6(0x287)](),_0x5675cc==_0x2a5db6(0x203)?(logger['debug'](_0x2a5db6(0x2f2)),await sendTelegram(_0x9e4d0b['chat']['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':'HTML'}),unzipFile(_0x3d7a2f,_0x1af954)):(logger[_0x2a5db6(0x235)](_0x2a5db6(0x36e)),await sendTelegram(_0x9e4d0b[_0x2a5db6(0x3c0)]['id'],_0x2a5db6(0x36e)));});}}function getServerTime(){const _0x1fe855=_0x480a86,_0x1cffc5=new Date();return _0x1cffc5[_0x1fe855(0x1dd)]()+'/'+(_0x1cffc5[_0x1fe855(0x32d)]()+0x1)['toString']()[_0x1fe855(0x214)](0x2,'0')+'/'+_0x1cffc5[_0x1fe855(0x220)]()[_0x1fe855(0x209)]()['padStart'](0x2,'0')+'\x20'+_0x1cffc5[_0x1fe855(0x259)]()[_0x1fe855(0x209)]()['padStart'](0x2,'0')+':'+_0x1cffc5['getMinutes']()[_0x1fe855(0x209)]()[_0x1fe855(0x214)](0x2,'0')+':'+_0x1cffc5[_0x1fe855(0x2c7)]()['toString']()[_0x1fe855(0x214)](0x2,'0');}function getTimeStamp(){const _0x522515=_0x480a86,_0x5956d4=shiftedTime();return _0x5956d4[_0x522515(0x1dd)]()+'/'+(_0x5956d4[_0x522515(0x32d)]()+0x1)[_0x522515(0x209)]()[_0x522515(0x214)](0x2,'0')+'/'+_0x5956d4[_0x522515(0x220)]()['toString']()[_0x522515(0x214)](0x2,'0')+'\x20'+_0x5956d4[_0x522515(0x259)]()[_0x522515(0x209)]()[_0x522515(0x214)](0x2,'0')+':'+_0x5956d4[_0x522515(0x3db)]()[_0x522515(0x209)]()[_0x522515(0x214)](0x2,'0')+':'+_0x5956d4[_0x522515(0x2c7)]()[_0x522515(0x209)]()[_0x522515(0x214)](0x2,'0');}function getCleanTimeStamp(){const _0x14c45d=_0x480a86,_0x1d52b4=shiftedTime();return _0x1d52b4[_0x14c45d(0x1dd)]()+(_0x1d52b4[_0x14c45d(0x32d)]()+0x1)[_0x14c45d(0x209)]()[_0x14c45d(0x214)](0x2,'0')+_0x1d52b4[_0x14c45d(0x220)]()[_0x14c45d(0x209)]()['padStart'](0x2,'0')+'-'+_0x1d52b4[_0x14c45d(0x259)]()[_0x14c45d(0x209)]()[_0x14c45d(0x214)](0x2,'0')+_0x1d52b4[_0x14c45d(0x3db)]()[_0x14c45d(0x209)]()[_0x14c45d(0x214)](0x2,'0')+_0x1d52b4['getSeconds']()[_0x14c45d(0x209)]()[_0x14c45d(0x214)](0x2,'0');}function shiftedTime(){const _0x45a018=_0x480a86,_0x160ec0=new Date();let _0x454b7c=_0x160ec0;if(settings[_0x45a018(0x3c9)]&&settings[_0x45a018(0x3c9)]!==0x0)_0x454b7c=fns['add'](_0x160ec0,{'hours':settings[_0x45a018(0x3c9)]});return _0x454b7c;}async function startScheduler(){const _0x371d96=_0x480a86,_0x3abfee=new Date()[_0x371d96(0x372)](),_0x28936c=shiftedTime()['getHours']();_0x28936c==0x4&&backupConfigFiles(),_0x28936c==0x0&&(rotateLogFiles(),logger[_0x371d96(0x235)](_0x371d96(0x3ba)),logger['debug'](_0x371d96(0x324)+serverversion+'#RES#\x20'+(environment==_0x371d96(0x1e3)?_0x371d96(0x264):'')),logger[_0x371d96(0x235)](_0x371d96(0x3ba))),_0x3abfee%0x6==0x0&&triggerAnalytics(),_0x3abfee%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x4bcc4d){const _0xeba479=_0x480a86;logger[_0xeba479(0x235)]('Restore\x20backup\x20file\x20'+_0x4bcc4d);const _0x371ffd=getBotsWithMode();_0x371ffd['length']>0x0?confirmRestore(configbackuppath,_0x4bcc4d):unzipFile(configbackuppath,_0x4bcc4d);}async function getBackupFiles(_0x117da6=null){const _0x47df1b=_0x480a86;let _0x169a12=[],_0x1eab35=fs[_0x47df1b(0x2ff)](configbackuppath,{'withFileTypes':!![]});_0x1eab35[_0x47df1b(0x2fe)]((_0x258b13,_0xaeffc8)=>_0x258b13['name']<_0xaeffc8[_0x47df1b(0x330)]?0x1:_0xaeffc8['name']<_0x258b13[_0x47df1b(0x330)]?-0x1:0x0),_0x1eab35[_0x47df1b(0x233)](_0x506b1d=>{const _0x382222=_0x47df1b;if(!_0x506b1d['isDirectory']()&&_0x506b1d[_0x382222(0x330)][_0x382222(0x3d8)](_0x382222(0x20e))&&_0x506b1d[_0x382222(0x330)][_0x382222(0x228)](_0x382222(0x23e))){const _0x5b7eb8=formatDate(fs[_0x382222(0x227)](configbackuppath+_0x506b1d['name'])['mtime']);_0x169a12[_0x382222(0x358)]({'name':_0x506b1d['name'],'mtime':_0x5b7eb8});}});if(_0x117da6)io['to'](_0x117da6)[_0x47df1b(0x336)](_0x47df1b(0x29d),_0x169a12);else return _0x169a12;}async function backupConfigFiles(){const _0xed3e65=_0x480a86;await zipFiles(_0xed3e65(0x20b));const _0x2fc1ed=getCleanTimeStamp();fs[_0xed3e65(0x1fd)](zippath+_0xed3e65(0x22c),configbackuppath+('backup-full@'+_0x2fc1ed+_0xed3e65(0x23e)));let _0x51b098=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x51b098['sort']((_0x4cca85,_0x4e37e3)=>_0x4cca85['name']<_0x4e37e3[_0xed3e65(0x330)]?0x1:_0x4e37e3[_0xed3e65(0x330)]<_0x4cca85[_0xed3e65(0x330)]?-0x1:0x0),_0x51b098[_0xed3e65(0x2bc)]>maxBackups&&fs[_0xed3e65(0x391)](configbackuppath+_0x51b098[_0x51b098['length']-0x1]['name']);}function rotateLogFiles(){const _0x31d733=_0x480a86,_0x58f739=fs[_0x31d733(0x227)](logspath+_0x31d733(0x30e)),_0x631542=_0x58f739[_0x31d733(0x27f)]/0x400;if(_0x631542>0x64){let _0x1d77b8=fs[_0x31d733(0x2ff)](logspath,{'withFileTypes':!![]});_0x1d77b8[_0x31d733(0x2fe)]((_0x4f47f5,_0x51c9c2)=>_0x4f47f5[_0x31d733(0x330)]<_0x51c9c2['name']?0x1:_0x51c9c2[_0x31d733(0x330)]<_0x4f47f5['name']?-0x1:0x0),_0x1d77b8[_0x31d733(0x233)](_0x186bff=>{const _0x5177a4=_0x31d733;if(_0x186bff['name']==_0x5177a4(0x3bf))fs[_0x5177a4(0x1fd)](logspath+_0x186bff[_0x5177a4(0x330)],logspath+_0x5177a4(0x301));if(_0x186bff[_0x5177a4(0x330)]==_0x5177a4(0x211))fs[_0x5177a4(0x1fd)](logspath+_0x186bff['name'],logspath+'output-002.log');_0x186bff[_0x5177a4(0x330)]==_0x5177a4(0x30e)&&(fs['copyFileSync'](logspath+_0x186bff[_0x5177a4(0x330)],logspath+_0x5177a4(0x211)),fs[_0x5177a4(0x212)](logspath+_0x186bff[_0x5177a4(0x330)],''));});}}async function zipFiles(_0x5451e0){const _0x1033ee=_0x480a86;let _0x3c5ea5;if(_0x5451e0=='logs')_0x3c5ea5=logspath;if(_0x5451e0==_0x1033ee(0x33f))_0x3c5ea5=configpath;if(_0x5451e0=='backup-full')_0x3c5ea5=configpath;let _0x2c18d8=fs[_0x1033ee(0x2ff)](_0x3c5ea5,{'withFileTypes':!![]});const _0x99a519=new JSZip();_0x2c18d8[_0x1033ee(0x233)](_0x123268=>{const _0x230646=_0x1033ee;if(!_0x123268[_0x230646(0x3c7)]()){let _0x3cba9e=fs[_0x230646(0x30d)](_0x3c5ea5+_0x123268['name']);if(_0x5451e0==_0x230646(0x33f)){const _0x57b1e1=/^bot-[0-9]{3}-config.json$/,_0x455ecc=_0x57b1e1[_0x230646(0x298)](_0x123268[_0x230646(0x330)]);if(_0x455ecc){const _0x4eb0b3=JSON['parse'](_0x3cba9e);if(_0x4eb0b3[_0x230646(0x307)][0x0]){_0x4eb0b3[_0x230646(0x307)][0x0][_0x230646(0x2b9)]=_0x230646(0x308),_0x4eb0b3[_0x230646(0x307)][0x0][_0x230646(0x38f)]=_0x230646(0x308);if(_0x4eb0b3[_0x230646(0x307)][0x0][_0x230646(0x329)])_0x4eb0b3[_0x230646(0x307)][0x0][_0x230646(0x329)]=_0x230646(0x308);}_0x3cba9e=JSON[_0x230646(0x2eb)](_0x4eb0b3,null,0x2);}if(_0x123268[_0x230646(0x330)]==_0x230646(0x2e4)){const _0x138294=JSON[_0x230646(0x215)](_0x3cba9e);if(_0x138294[_0x230646(0x3ac)][_0x230646(0x20d)])_0x138294[_0x230646(0x3ac)][_0x230646(0x20d)]=![];if(_0x138294[_0x230646(0x3ac)][_0x230646(0x37b)])_0x138294['settings'][_0x230646(0x37b)]=_0x230646(0x308);if(_0x138294['settings']['telegramToken'])_0x138294['settings']['telegramToken']='***';if(_0x138294[_0x230646(0x3ac)][_0x230646(0x28f)])_0x138294[_0x230646(0x3ac)][_0x230646(0x28f)]=null;if(_0x138294[_0x230646(0x3ac)][_0x230646(0x347)])_0x138294[_0x230646(0x3ac)][_0x230646(0x347)]=_0x230646(0x308);_0x3cba9e=JSON[_0x230646(0x2eb)](_0x138294,null,0x2);}if(_0x123268['name']!=_0x230646(0x207))_0x99a519[_0x230646(0x304)](_0x123268[_0x230646(0x330)],_0x3cba9e);}else _0x99a519[_0x230646(0x304)](_0x123268['name'],_0x3cba9e);}});const _0x204042=await _0x99a519[_0x1033ee(0x1ee)]({'type':_0x1033ee(0x204),'base64':![],'compression':_0x1033ee(0x3a1)});fs['writeFileSync'](zippath+(_0x5451e0+_0x1033ee(0x23e)),_0x204042,_0x1033ee(0x245));}async function unzipFile(_0x5a530d,_0x15981b){const _0xc30e14=_0x480a86;fs[_0xc30e14(0x2ff)](configpath,{'withFileTypes':!![]})['forEach'](_0x4835ad=>{const _0x1fabfb=_0xc30e14;if(!_0x4835ad[_0x1fabfb(0x3c7)]())fs[_0x1fabfb(0x269)](configpath+_0x4835ad[_0x1fabfb(0x330)]);});const _0x356817=fs['readFileSync'](_0x5a530d+_0x15981b,_0xc30e14(0x245)),_0x1c838d=await JSZip[_0xc30e14(0x39d)](_0x356817,{'base64':![],'checkCRC32':!![]});for(const _0x3cd4b2 of Object[_0xc30e14(0x22b)](_0x1c838d[_0xc30e14(0x202)])){const _0x564f6b=_0x1c838d[_0xc30e14(0x202)][_0x3cd4b2],_0x868ac8=await _0x564f6b[_0xc30e14(0x222)](_0xc30e14(0x204));fs[_0xc30e14(0x212)](configpath+_0x564f6b[_0xc30e14(0x330)],_0x868ac8);}fs[_0xc30e14(0x2ff)](temppath,{'withFileTypes':!![]})['forEach'](_0x32bf09=>{const _0x52d896=_0xc30e14;if(!_0x32bf09[_0x52d896(0x3c7)]())fs[_0x52d896(0x269)](temppath+_0x32bf09[_0x52d896(0x330)]);}),logger[_0xc30e14(0x235)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0xc30e14(0x1d4)]({'restore':!![]},_0x3418c9=>{});}async function getPublicIp(){const _0x152552=_0x480a86;try{const _0x137846=await axios[_0x152552(0x29c)](_0x152552(0x20c));publicip=_0x137846[_0x152552(0x1ff)]['ip'];}catch(_0x207520){}}async function triggerAnalytics(){const _0x4834d9=_0x480a86;if(!publicip)await getPublicIp();const _0x9869cb=getBotsWithMode();let _0x5183c3=0x0;_0x9869cb['forEach'](_0x2aae66=>{const _0x51883a=_0x55da;if(_0x2aae66[_0x51883a(0x3dc)]===_0x51883a(0x1cf))_0x5183c3++;});const _0xd0d37f=getBotExchanges();mixpanel[_0x4834d9(0x293)](_0x4834d9(0x3eb),{'distinct_id':settings[_0x4834d9(0x37a)],'ip':publicip,'version':serverversion,'numbots':_0x9869cb['length'],'numbotsenabled':_0x5183c3,'exchanges':_0xd0d37f,'environment':environment});}async function getMessages(){const _0x275467=_0x480a86,_0x4a5593=_0x275467(0x2bb),_0x4ffa8e=new GraphQLClient(_0x4a5593),_0x2bcdd1={'authorization':_0x275467(0x273)},_0x465105=serverversion[_0x275467(0x257)]('.'),_0x5333f4=_0x465105[0x0]+'.'+_0x465105[0x1],_0x39ae59=Math[_0x275467(0x3e0)](settings[_0x275467(0x2f9)],settings[_0x275467(0x3cd)]),_0x4c7b7b={'last':parseInt(_0x39ae59),'bbm':_0x5333f4},_0x47ea88=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x52ba80;try{_0x52ba80=await _0x4ffa8e[_0x275467(0x2ad)](_0x47ea88,_0x4c7b7b,_0x2bcdd1);}catch(_0x2496f9){}if(_0x52ba80&&_0x52ba80[_0x275467(0x2a8)]){let _0x49c4f6=settings[_0x275467(0x2f9)],_0xe4f61=settings[_0x275467(0x2f9)];newMessages=[];for(const _0x4ccb26 of _0x52ba80[_0x275467(0x2a8)]){newMessages[_0x275467(0x358)](_0x4ccb26);let _0x33660a=![];_0x4ccb26[_0x275467(0x1ea)]&&(updateSetting(_0x275467(0x1df),_0x4ccb26[_0x275467(0x1ea)]),_0x33660a=isNewerVersion(serverversion,_0x4ccb26[_0x275467(0x1ea)])||serverversion==_0x4ccb26[_0x275467(0x1ea)]);if(!_0x33660a&&_0x4ccb26[_0x275467(0x3c6)]>_0x49c4f6){if(_0x4ccb26[_0x275467(0x253)]==='any'||serverversion['startsWith'](_0x4ccb26['bbvReceive'])){let _0x4eb08f=''+_0x4ccb26[_0x275467(0x2fb)]+'\x0a\x0a'+_0x4ccb26[_0x275467(0x3d7)];const _0x3bf1c3=await sendTelegramMsg(toTelegramMarkdown(_0x4eb08f),'Markdown');_0x49c4f6=_0x4ccb26[_0x275467(0x3c6)];}}_0xe4f61=_0x4ccb26[_0x275467(0x3c6)];}updateAvailable=isNewerVersion(settings[_0x275467(0x1df)],serverversion),updateSetting(_0x275467(0x2f9),_0xe4f61),emitMessages();}}function emitMessages(){const _0x28f422=_0x480a86,_0x72ea5e=settings[_0x28f422(0x3cd)];let _0x118e15=[];newMessages[_0x28f422(0x233)](_0x6a7651=>{const _0x3e0eee=_0x28f422;_0x6a7651[_0x3e0eee(0x3c6)]>_0x72ea5e&&_0x118e15[_0x3e0eee(0x358)](_0x6a7651);}),_0x118e15[_0x28f422(0x2bc)]>0x0&&getAllClients()[_0x28f422(0x233)](_0x2bc14f=>{const _0x2b1188=_0x28f422;getSocket(_0x2bc14f['id'])[_0x2b1188(0x336)](_0x2b1188(0x3d7),_0x118e15);});}function confirmMessage(_0x465c3b){updateSetting('lastmsgemitted',Number(_0x465c3b));}function isNewerVersion(_0x460a4f,_0x556e32){const _0x541612=_0x480a86,_0x1d806d=_0x556e32['split']('.'),_0x5996b2=_0x460a4f[_0x541612(0x257)]('.');for(var _0x55fd52=0x0;_0x55fd52<_0x5996b2[_0x541612(0x2bc)];_0x55fd52++){const _0x2395c4=~~_0x5996b2[_0x55fd52],_0x7dc8fe=~~_0x1d806d[_0x55fd52];if(_0x2395c4>_0x7dc8fe)return!![];if(_0x2395c4<_0x7dc8fe)return![];}return![];}function toTelegramMarkdown(_0x4aeb68){const _0x25f118=_0x480a86,_0x4e0f4b=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x240317=/\*{2}(.+?)\*{2}/gim;return _0x4aeb68=_0x4aeb68[_0x25f118(0x382)](_0x4e0f4b,_0x25f118(0x290))[_0x25f118(0x382)](_0x240317,_0x25f118(0x1f3)),_0x4aeb68;}async function validateConfigFile(){const _0x535853=_0x480a86,_0x6813f6=dbConfig[_0x535853(0x29c)](_0x535853(0x354))[_0x535853(0x224)](_0x535853(0x386))[_0x535853(0x26f)]()||[];if(_0x6813f6[_0x535853(0x2bc)]==0x0){let _0x2897ad=0x0,_0x31224b=[];const _0x46aa12=/^bot-([0-9]{3})-config.json$/,_0x551cb0=fs['readdirSync'](configpath);_0x551cb0[_0x535853(0x233)](_0x1b15ff=>{const _0x37cd64=_0x535853,_0x952071=_0x46aa12[_0x37cd64(0x3b5)](_0x1b15ff);if(_0x952071){const _0x2d797a=_0x952071[0x1];let _0x1a7457=getBotAttributes(_0x2d797a);_0x31224b[_0x37cd64(0x358)]({'botID':_0x2d797a,'botname':_0x1a7457[_0x37cd64(0x26a)],'status':_0x37cd64(0x326),'live':_0x37cd64(0x35f)}),_0x2897ad++;}}),_0x2897ad!=0x0&&(dbConfig[_0x535853(0x29c)](_0x535853(0x354))[_0x535853(0x2e2)](_0x31224b)['write'](),config=_0x31224b,restoredConfigFile=_0x2897ad);}}async function restoreConfigNotify(_0x23c9c6){const _0x4afcd5=_0x480a86;let _0x4d729b;if(restoredConfigFile==0x1)_0x4d729b='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x4d729b='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x23c9c6)io['to'](_0x4afcd5(0x288))[_0x4afcd5(0x336)]('notification',_0x4d729b);else{logger[_0x4afcd5(0x377)](_0x4afcd5(0x33c)),logger['simple'](_0x4d729b),logger[_0x4afcd5(0x377)](_0x4afcd5(0x33c)),logger['simple']('');if(tgBot&&settings[_0x4afcd5(0x28f)]&&settings[_0x4afcd5(0x210)]!=_0x4afcd5(0x35a))await sendTelegram(settings['telegramChatId'],_0x4afcd5(0x27c)+_0x4d729b);}}function decryptRSA(_0x269c3f,_0x3862b2){const _0xa5194d=_0x480a86,_0x4cfad1=forge[_0xa5194d(0x2d5)][_0xa5194d(0x333)](_0x269c3f),_0x68dcba=_0x4cfad1[_0xa5194d(0x37f)](forge[_0xa5194d(0x357)]['decode64'](_0x3862b2),'RSA-OAEP',{'md':forge['md'][_0xa5194d(0x2d2)][_0xa5194d(0x342)](),'mgf1':{'md':forge['md'][_0xa5194d(0x2d2)]['create']()}});return _0x68dcba;}function validateCredentials(_0x326cbd,_0x4e62e8){const _0x6d2592=_0x480a86;if(_0x326cbd['username']==settings['bbUsername']&&bcrypt[_0x6d2592(0x2a6)](_0x326cbd[_0x6d2592(0x2aa)],settings[_0x6d2592(0x37b)])){if(settings[_0x6d2592(0x332)])return{'allow':![],'reason':_0x6d2592(0x320),'token':null};else{const _0x500528=generateLoginToken(_0x4e62e8);return{'allow':!![],'reason':_0x6d2592(0x3bd),'token':_0x500528};}}else return{'allow':![],'reason':_0x6d2592(0x218),'token':null};}function refreshToken(_0xeb7ef8){const _0x4ab3d7=_0x480a86,_0x2f6b6f=generateLoginToken(_0xeb7ef8);return{'allow':!![],'reason':_0x4ab3d7(0x3bd),'token':_0x2f6b6f};}function validateAccess(_0x326261,_0x1ab708,_0x3e2de3){const _0x653f00=_0x480a86,_0x18af1d=_0x3e2de3?_0x3e2de3:devices[_0x1ab708]['ip'];let _0x16fd70;const _0xdfafa0=_0x59cc27=>{const _0xff7285=_0x55da;if(settings[_0xff7285(0x20d)]){if(settings[_0xff7285(0x332)]){if(telegram2FaApproved(_0x1ab708)){const _0x13a43d=generateLoginToken(_0x1ab708);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x13a43d};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x16fd70=validToken(_0x59cc27,_0x1ab708),_0x16fd70[_0xff7285(0x28b)](_0xff7285(0x2ba))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x59cc27}:{'allow':![],'reason':_0xff7285(0x28e),'token':null};}else return{'allow':!![],'reason':_0xff7285(0x217),'token':null};};if(settings[_0x653f00(0x23c)]){let _0x2b5d87=[...settings[_0x653f00(0x20f)],'::1',_0x653f00(0x306),'127.0.0.1','::ffff:7f00:1'];if(_0x2b5d87['includes'](_0x18af1d))return _0xdfafa0(_0x326261);else{_0x16fd70=validToken(_0x326261,_0x1ab708);if(_0x16fd70['hasOwnProperty']('success'))return _0xdfafa0(_0x326261);else{if(telegramIpApproved(_0x1ab708)){const _0x88c44b=generateToken(_0x1ab708);return _0x16fd70=_0xdfafa0(_0x326261),_0x16fd70[_0x653f00(0x26e)]?{'allow':!![],'reason':_0x653f00(0x3af),'token':_0x88c44b}:_0x16fd70;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x653f00(0x39f),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0xdfafa0(_0x326261);}function timelyDecrypt(_0x18e9ea,_0x58c8f9,_0x312446='@'){const _0x3241d1=_0x480a86;if(_0x18e9ea)try{const _0x15207f=decryptRSA(secure['privateKey'],_0x18e9ea),_0x44086d=_0x15207f[_0x3241d1(0x257)](_0x312446)[0x0],_0xe27c14=_0x15207f[_0x3241d1(0x257)](_0x312446)[0x1],_0x3ad01e=new Date()['getTime']();if(_0x58c8f9){if(_0x3ad01e-_0xe27c14<maxSecretAge*0x3e8)return _0x44086d;else return![];}else return _0x44086d;}catch(_0x50a4fe){return![];}else return![];}const validToken=(_0x1bd8a7,_0xf84a54)=>{const _0x150f6c=_0x480a86,_0x4d6d64=devices[_0xf84a54]['ip'];if(!_0x1bd8a7)return{'error':_0x150f6c(0x3b7)};for(let _0x47f896 of blacklist){if(_0x47f896[_0x150f6c(0x2ce)]==_0x1bd8a7)return{'error':_0x150f6c(0x388)};}let _0x4c5492;try{_0x4c5492=jwt[_0x150f6c(0x3ae)](_0x1bd8a7,secure['secret']+_0xf84a54);}catch{return{'error':_0x150f6c(0x248)};}if(!_0x4c5492[_0x150f6c(0x28b)]('clientip')&&!_0x4c5492[_0x150f6c(0x28b)]('username')||!_0x4c5492[_0x150f6c(0x28b)](_0x150f6c(0x361)))return{'error':_0x150f6c(0x213)};if(!_0x4c5492['hasOwnProperty'](_0x150f6c(0x3ef))&&_0x4c5492[_0x150f6c(0x28b)](_0x150f6c(0x2bd))){const {clientip:_0x314a9f}=_0x4c5492;return _0x4d6d64==_0x314a9f?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x150f6c(0x2fc)};}else{if(_0x4c5492[_0x150f6c(0x28b)](_0x150f6c(0x3ef))&&_0x4c5492['hasOwnProperty'](_0x150f6c(0x2bd))){const {username:_0x20a339,clientip:_0x3d12aa}=_0x4c5492;return settings[_0x150f6c(0x300)]==_0x20a339&&_0x4d6d64==_0x3d12aa?{'success':_0x150f6c(0x39a)}:{'error':_0x150f6c(0x31c)};}}},generateLoginToken=_0x54bdaf=>{const _0x5224e5=_0x480a86;if(_0x54bdaf){const _0x18bd45=devices[_0x54bdaf]['ip'];return jwt[_0x5224e5(0x3ee)]({'username':settings[_0x5224e5(0x300)],'clientip':_0x18bd45},secure[_0x5224e5(0x34a)]+_0x54bdaf,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x5a9cef=>{const _0x514df7=_0x480a86;if(_0x5a9cef){const _0x4d84f6=devices[_0x5a9cef]['ip'];return jwt[_0x514df7(0x3ee)]({'clientip':_0x4d84f6},secure[_0x514df7(0x34a)]+_0x5a9cef,{'expiresIn':devices[_0x5a9cef][_0x514df7(0x29f)][_0x514df7(0x1e6)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x192b19=>{const _0x3609e2=_0x480a86;let _0x237f99=![];return devices[_0x192b19][_0x3609e2(0x29f)]&&devices[_0x192b19][_0x3609e2(0x29f)][_0x3609e2(0x1e6)]!=_0x3609e2(0x309)&&(_0x237f99=devices[_0x192b19]['telegramIpApproval']['clientip']==devices[_0x192b19]['ip']&&new Date()['getTime']()-devices[_0x192b19]['telegramIpApproval']['timestamp']<devices[_0x192b19][_0x3609e2(0x29f)][_0x3609e2(0x1e6)]*0x3c*0x3e8),_0x237f99;},telegram2FaApproved=_0x16e9fe=>{const _0x3ccc04=_0x480a86;let _0x8dff6b=![];return devices[_0x16e9fe]['telegram2FaApproval']&&devices[_0x16e9fe][_0x3ccc04(0x1f8)][_0x3ccc04(0x1e6)]!=_0x3ccc04(0x309)&&(_0x8dff6b=devices[_0x16e9fe]['telegram2FaApproval'][_0x3ccc04(0x2bd)]==devices[_0x16e9fe]['ip']&&new Date()[_0x3ccc04(0x392)]()-devices[_0x16e9fe]['telegram2FaApproval'][_0x3ccc04(0x398)]<devices[_0x16e9fe][_0x3ccc04(0x1f8)]['expiry']*0x3c*0x3e8),_0x8dff6b;},normalizeIP=_0x3c1d68=>{const _0x8056a4=_0x480a86;let _0x5d2340=null,_0x31efc2=null;if(ipaddr[_0x8056a4(0x36b)](_0x3c1d68)){const _0x427ac2=ipaddr['parse'](_0x3c1d68);_0x427ac2[_0x8056a4(0x1f5)]()===_0x8056a4(0x378)?(_0x427ac2[_0x8056a4(0x393)]()&&(_0x5d2340=_0x427ac2[_0x8056a4(0x344)]()[_0x8056a4(0x209)]()),_0x31efc2=_0x427ac2[_0x8056a4(0x209)]()):(_0x5d2340=_0x427ac2[_0x8056a4(0x209)](),_0x31efc2=_0x427ac2['toIPv4MappedAddress']()['toString']());}return{'show':_0x5d2340?_0x5d2340:_0x31efc2,'store':_0x31efc2};};function formatDate(_0x2574e5){const _0x5ab4f6=_0x480a86;return _0x2574e5[_0x5ab4f6(0x1dd)]()+'/'+(_0x2574e5[_0x5ab4f6(0x32d)]()+0x1)['toString']()[_0x5ab4f6(0x214)](0x2,'0')+'/'+_0x2574e5[_0x5ab4f6(0x220)]()['toString']()[_0x5ab4f6(0x214)](0x2,'0')+'\x20'+_0x2574e5[_0x5ab4f6(0x259)]()[_0x5ab4f6(0x209)]()[_0x5ab4f6(0x214)](0x2,'0')+':'+_0x2574e5['getMinutes']()[_0x5ab4f6(0x209)]()['padStart'](0x2,'0')+':'+_0x2574e5[_0x5ab4f6(0x2c7)]()[_0x5ab4f6(0x209)]()[_0x5ab4f6(0x214)](0x2,'0');}function sleep(_0x5035c){return new Promise(_0x2bcc72=>setTimeout(_0x2bcc72,_0x5035c));}