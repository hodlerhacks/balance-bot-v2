const _0x261552=_0x382d;(function(_0x468081,_0x8351aa){const _0xa57fbb=_0x382d,_0x238d55=_0x468081();while(!![]){try{const _0x37ffb0=parseInt(_0xa57fbb(0x23b))/0x1+parseInt(_0xa57fbb(0x96))/0x2+parseInt(_0xa57fbb(0x24a))/0x3+-parseInt(_0xa57fbb(0x22b))/0x4*(parseInt(_0xa57fbb(0x255))/0x5)+-parseInt(_0xa57fbb(0x279))/0x6*(-parseInt(_0xa57fbb(0x1dc))/0x7)+-parseInt(_0xa57fbb(0x1df))/0x8+parseInt(_0xa57fbb(0xb3))/0x9*(-parseInt(_0xa57fbb(0x15c))/0xa);if(_0x37ffb0===_0x8351aa)break;else _0x238d55['push'](_0x238d55['shift']());}catch(_0x5bb643){_0x238d55['push'](_0x238d55['shift']());}}}(_0x128b,0xd4dfd));const _0x166884=function(){let _0x5a8ebb=!![];return function(_0x5f488c,_0x48e57b){const _0x16b0af=_0x5a8ebb?function(){const _0x9d7dea=_0x382d;if(_0x48e57b){const _0x516135=_0x48e57b[_0x9d7dea(0xa3)](_0x5f488c,arguments);return _0x48e57b=null,_0x516135;}}:function(){};return _0x5a8ebb=![],_0x16b0af;};}(),_0x26d103=_0x166884(this,function(){const _0x412b23=_0x382d;return _0x26d103[_0x412b23(0x239)]()[_0x412b23(0x18e)](_0x412b23(0xf2))[_0x412b23(0x239)]()[_0x412b23(0x15b)](_0x26d103)['search'](_0x412b23(0xf2));});_0x26d103();'use strict';process[_0x261552(0xe2)][_0x261552(0x1bf)]=0x1;const childProcess=require(_0x261552(0x97)),fs=require('fs'),fns=require(_0x261552(0x269)),low=require(_0x261552(0xff)),FileSync=require(_0x261552(0x13d)),path=require(_0x261552(0x16a)),crypto=require(_0x261552(0x130)),forge=require(_0x261552(0x277)),bcrypt=require('bcryptjs'),jwt=require(_0x261552(0x10b)),ipaddr=require(_0x261552(0x1a4)),yargs=require(_0x261552(0x232)),uuidRandom=require(_0x261552(0x23f)),{Telegraf,Markup}=require(_0x261552(0x1e0)),Mixpanel=require(_0x261552(0x209)),axios=require(_0x261552(0x12e)),{GraphQLClient,gql}=require(_0x261552(0xe9)),util=require(_0x261552(0x85)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x261552(0x153)),argv=yargs(process[_0x261552(0x26b)]['slice'](0x2))['argv'],PORT=argv[_0x261552(0x1d0)]||_0x261552(0xdf),pattern=/^[0-9]{2,4}$/;!pattern[_0x261552(0xa5)](PORT)&&(console['log'](_0x261552(0x284)+PORT+_0x261552(0xc1)),process['exit'](0x1));const HOST=argv[_0x261552(0x1fd)]||null,userID=argv[_0x261552(0x1e8)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process['versions'][_0x261552(0x166)];let bbpath=_0x261552(0x138),bbpath2='';const botfile=_0x261552(0x1b4),configfile=_0x261552(0x110),settingsfile=_0x261552(0x1fa),securefile=_0x261552(0x121),environment=require('./'+bbpath2+'version.json')['environment']||_0x261552(0xea),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x261552(0x1dd)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x261552(0x22d)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x261552(0x293),logspath=userID?bbpath+_0x261552(0x7c)+userID+'/':bbpath+_0x261552(0x7c),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x261552(0x20f),loggerfile=fs[_0x261552(0x228)](logspath+_0x261552(0xcd),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+'temp/';!fs[_0x261552(0x1dd)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x261552(0x1dd)](configbackuppath)&&fs[_0x261552(0x8b)](configbackuppath);function _0x128b(){const _0x4f0a94=['get-backup-files','orders','Restoring\x20bot(s)\x20from\x20backup','::ffff:7f00:1','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','access','Starting\x20#RED#Balance\x20Bot\x20v','start','latestversion','apiPassword','NTBA_FIX_319','bot','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','resetpw_yes','stringify','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Notifications\x20types:\x20','showname','Unauthorized\x20attempt\x20to\x20download\x20','Restore\x20backup\x20file\x20','Login\x20accepted','http','sendMetricsTelegram','output-000.log','Deleted\x20Bot\x20','backup-full.zip','port','backup-full@','/enable\x20-\x20enable\x20notifications\x0a','bbPassword','new-disabled','size','settings.','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','0.0.0','endsWith','privateKey','1258026fQXPxq','existsSync','output-002.log','441104cgxbmd','telegraf','temporary\x20access\x20rejected','alias','/logs\x20-\x20receive\x20log\x20files\x0a','manual','status\x20code\x20401','simple','apiSecret','user','startsWith','private','Restarting\x20','Session\x20expired\x20for\x20user\x20...','metrics','uuid','placeOrder','getMinutes','backup','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','help','track','lastmsgemitted','yes','Restore\x20process\x20confirmed','number','show-config','bb-settings.json','Unauthorized\x20attempt\x20to\x20confirm\x20message','No\x20authentication\x20token','host','store-settings','/on\x20-\x20start\x20bot(s)\x0a','toggle_','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','#RES#\x20','telegramChatId','logout','version','Bot\x20Mgr\x20>\x20Stopping\x20','socket','success','mixpanel','then','parse','Orders','internal','Ok,\x20will\x20send\x20alert\x20notifications\x20only','zip/','off_','login\x20required','All\x20bots\x20running\x20right\x20now','update','tempaccess_30_','/metrics\x20-\x20show\x20bot\x20performance\x0a','emit','staging','logged\x20out','restore_yes_','settings','index.html','uncaughtException','getStartingBalances','/status\x20-\x20show\x20bot(s)\x20status\x0a','backup-full','userid','launch','started','padStart','loadAsync','Unauthorized\x20attempt\x20to\x20update\x20bot','getHours','DEFLATE','createWriteStream','2FA\x20login\x20required','reinstall_no','16hCJDzM','/backup\x20-\x20receive\x20backup\x20files\x0a','config/','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','disabled','telegrammsg','unlinkSync','yargs','15\x20min','reason','decrypt','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','bots','forEach','toString',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','1524672wBDZtA','login\x20token\x20generated','createServer','temporaryAccessAllowed','uuid-random','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','portfolio','temporary\x20token\x20generated','allow','getFullYear','stop','format','/:bot','f2aRequired','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','1114368URzVjS','\x20(2)','telegramEnabled','randomFillSync','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','2FA\x20login\x20rejected','pidExpireLogin','-events.json','rsa','secure','RSA-OAEP','899075KTyMWF','entries','ipc','inherit','toggle-bot-mode','Notifications\x20disabled','blacklist','SIGTERM','telegramIpApproval','init','log','backupfile','includes','messages','callback','chat','-performance.json','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','max','add','date-fns','address','argv','compareSync','login2fa_','status','store-headless','decode64','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','debug','replyWithDocument','toggleBotMode','restart_','-results.json','node-forge','whitelist','42lTMdIP','apiKey','request','telegramUsername','Unauthorized\x20attempt\x20to\x20show\x20configuration','disconnect','headless','\x20to\x20','onepagemode','2FA\x20required','sign','Error:\x20Invalid\x20argument\x20','telegramToken','logs','username','version.json','Bot\x20','function','Error\x20removing\x20old\x20backup\x20files:','Allow\x20login\x20from\x20IP\x20address\x20','generateKeyPair','Alerts','Unauthorized\x20attempt\x20to\x20log\x20out','delete-alerts','live','build','backup/','getMonth','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','referer','update_yes','Unauthorized\x20attempt\x20to\x20get\x20portfolio','logs/','removeAllListeners','update-bb','http://localhost:','readdirSync','***','text','2FA\x20login\x20token\x20generated','Ok,\x20will\x20send\x20order\x20notifications\x20only','util','copyFileSync','2FA','sha256','replace','editMessageReplyMarkup','mkdirSync','family','catch','toggle','find','api-eu.mixpanel.com','IPv4','#RES#\x20if\x20running\x20on\x20server','reinstall-bb','--------------------------------------','\x20|\x20','2290438BSpILO','child_process','Unauthorized\x20attempt\x20to\x20store\x20configuration','\x1b[0m','botmanager','cancel-loading','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','getSeconds','match','::ffff:127.0.0.1','Notifications\x20enabled','notification','deleteHistoryAlerts','apply','loginRequired','test','Token\x20blacklisted','exec','auth','tempaccess_reject_','on_','command','login','push','*$1*','portfolio_','reinstall','cloneDeep','Login\x20rejected','63vquYPo','pki','password','slice','botname','HTML','reset-history','botID','All\x20bots','bot-','Invalid\x20username\x20or\x20IP\x20address','All','socket.io','mtime',',\x20must\x20be\x20a\x204\x20digit\x20number','post','127.0.0.1','data','\x1b[31m','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','exit','kill','keys','\x1b[34m','Bot\x20Mgr\x20>\x20Starting\x20','clientip','/output-000.log','Server','Password\x20has\x20been\x20reset\x20to:\x20','/download/:type','generateAsync','initclient','isIPv4MappedAddress','\x20mode','isDirectory','lastmsgtelegram','Unauthorized\x20attempt\x20to\x20update\x20settings','length','::1','once','temporary\x20access\x20timeout','toIPv4Address','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','binary','3000','sendFile','Markdown','env','inlineKeyboard','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','telegram','running','ETH','remove','graphql-request','production','static','writeFileSync','5\x20min','readFileSync','tempaccess_5_','warning','Logged\x20out\x20user\x20...','(((.+)+)+)+$','Starting\x20(','bbvNew','token','/:bot/portfolio','action','Unauthorized\x20attempt\x20to\x20get\x20messages','code','type','[ip-address]','Idling\x20(','rmSync','(staging)','lowdb','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','SIGINT','string','toIPv4MappedAddress','create','output-003.log','telegramEvents','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Your\x20installation\x20is\x20already\x20up\x20to\x20date','access\x20timeout','temporary\x20access\x20not\x20allowed','jsonwebtoken','get','User\x20has\x20been\x20validated','tempaccess_15_','sockets','bb-config.json','event','************','publicKey','split','Telegraf\x20error:','BCT','express','update_no','sendPortfolioTelegram','restart','getTime','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','mode','/help\x20-\x20show\x20available\x20commands\x0a',')\x20|\x20Bot\x20','reload','bb-secure.json','store','encryptedUuid','telegram2FaApproval','Error\x20sending\x20','-config.json','headers','connected','store-fiat','login\x20not\x20required','Restore\x20process\x20aborted','all','stopped','axios','_nsps','crypto','resetpw_no','/:bot/configuration','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','file','-----------------------------------------------------------------------------------','config_alerts','send','bb/','use','Yes','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','=>\x20Go\x20to\x20#CYA#http://','lowdb/adapters/FileSync','Node.js\x20v','output-001.log','exchange','set','download','statSync','timeshift','Enabled\x20','Backup\x20file\x20unzipped\x20and\x20stored','enabled','bbvReceive','auto','getPortfolio','files','secret','get-messages','min','place-order','/:bot/support','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','jszip','alerts','\x1b[36m','File\x20uploaded','build2','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Network\x20Interfaces:','constructor','3790060qePMRl','Unauthorized\x20login\x20attempt\x20(timeout)','\x1b[33m','30\x20min','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','bbUsername','No\x20bots\x20running\x20right\x20now','Starting\x20Balance\x20Bot\x20update','error','getDate','node','pidRefreshToken','\x20files\x20over\x20Telegram:','hashSync','path','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Notifications\x20disabled\x0a','assign','.zip','from','full','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','CoinMarketCap\x20API\x20key\x20validated','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','hex','\x20minutes','login\x20token\x20valid','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','/upload-backup','get-portfolio','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Notifications\x20enabled\x0a','new','getUTCHours','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','handshake','name','/:bot/coins','emitHistory','Invalid\x20IP\x20address','<b>Telegram\x20Bot\x20Status:</b>\x0a','remoteAddress','params','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Disabled\x20','expiry','sort','show','marketcapApi','search','off','config','\x20|\x20user:\x20...','button','\x20(1)','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','confirm-message','join','config_all','hasOwnProperty','Bot\x20Mgr\x20>\x20','whitelistEnabled','message','args','reset-password','storeHeadless','config_orders','tkn','backup-files','write','value','ipaddr.js','defaults','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','order','restore-backup-file','disable','sortBy','|@|','reject',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','add-bot','map','kind','reply','listen','bot.js'];_0x128b=function(){return _0x4f0a94;};return _0x128b();}!fs['existsSync'](logspath)&&fs[_0x261552(0x8b)](logspath);!fs['existsSync'](zippath)&&fs[_0x261552(0x8b)](zippath);!fs['existsSync'](temppath)&&fs[_0x261552(0x8b)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x261552(0x1a5)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x261552(0x1d9),'onepagemode':![],'marketcapApi':''}})[_0x261552(0x1a2)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x261552(0x1a5)]({'secure':{},'blacklist':[]})[_0x261552(0x1a2)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x261552(0x25e)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x261552(0x90)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x261552(0x285)]&&(settings['telegramToken']!=''&&settings[_0x261552(0x285)]!=_0x261552(0x81))&&settings['telegramUsername']&&settings[_0x261552(0x27c)]!='')initTelegram();const parseColor=(_0x4f77e9,_0x1b1fd2)=>{const _0x49ed94=_0x261552,_0x4b12ca=/#[A-Z]{3}#/g;if(typeof _0x4f77e9==_0x49ed94(0x102)){!_0x1b1fd2?_0x4f77e9=_0x4f77e9['replace'](_0x4b12ca,''):(_0x4f77e9=_0x4f77e9['replace'](/#BLU#/g,_0x49ed94(0xca)),_0x4f77e9=_0x4f77e9[_0x49ed94(0x89)](/#RED#/g,_0x49ed94(0xc5)),_0x4f77e9=_0x4f77e9[_0x49ed94(0x89)](/#YEL#/g,_0x49ed94(0x15e)),_0x4f77e9=_0x4f77e9[_0x49ed94(0x89)](/#MAG#/g,'\x1b[35m'),_0x4f77e9=_0x4f77e9['replace'](/#CYA#/g,_0x49ed94(0x155)),_0x4f77e9=_0x4f77e9['replace'](/#RES#/g,_0x49ed94(0x99)));;}return _0x4f77e9;},logger={'screen':_0x37a737=>{const _0x4a4747=_0x261552;console[_0x4a4747(0x25f)](parseColor(_0x37a737,!![]));},'simple':_0x40717a=>{console['log'](parseColor(_0x40717a,!![])),loggerfile['write'](util['format'](parseColor(_0x40717a,![]))+'\x0a');},'full':async _0x49a098=>{const _0x529126=_0x261552,_0x1e6bb4=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x49a098;console['log'](parseColor(_0x1e6bb4,!![])),loggerfile['write'](util[_0x529126(0x246)](parseColor(_0x1e6bb4,![]))+'\x0a');if(tgBot&&settings[_0x529126(0x203)]&&settings[_0x529126(0x106)]!='orders')await sendTelegram(settings[_0x529126(0x203)],_0x529126(0x199)+parseColor(_0x49a098,![]));},'debug':async(_0x41b408,_0x46ed38='')=>{const _0x1404c8=_0x261552,_0x32d5b0=getTimeStamp()+_0x1404c8(0x23a)+_0x41b408;if(debugging)console[_0x1404c8(0x25f)](parseColor(_0x32d5b0,!![]));loggerfile[_0x1404c8(0x1a2)](util[_0x1404c8(0x246)](parseColor(_0x32d5b0,![]))+'\x0a');if(_0x46ed38){if(debugging)console[_0x1404c8(0x25f)](_0x46ed38);loggerfile[_0x1404c8(0x1a2)](util[_0x1404c8(0x246)](_0x46ed38)+'\x0a');}}};let terminating=![];process['on'](_0x261552(0x21c),function(_0x20d707){const _0x362880=_0x261552;_0x20d707['toString']()[_0x362880(0x261)]('address\x20already\x20in\x20use')?(logger['simple'](_0x362880(0x171)+_0x20d707[_0x362880(0x1d0)]+'#RES#'),process[_0x362880(0x137)]({'terminate':!![]},_0x56ea80=>{})):logger[_0x362880(0x1e6)](_0x20d707);}),process['on'](_0x261552(0xc7),()=>{const _0x3b8a48=_0x261552;stopAllBots(),process[_0x3b8a48(0xc7)](0x0);}),process['on'](_0x261552(0x25c),()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGINT',()=>{const _0x4b655c=_0x261552;stopAllBots(),process[_0x4b655c(0xc7)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x261552(0x288))[_0x261552(0x205)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x261552(0x117)),app=express(),http=require(_0x261552(0x1cb))[_0x261552(0x23d)](app);app[_0x261552(0x139)](fileUpload({'useTempFiles':!![]})),app[_0x261552(0x10c)](_0x261552(0xd0),async(_0x293703,_0x54ba9c)=>{const _0x4cee2a=_0x261552,_0x282603=_0x293703[_0x4cee2a(0x187)]['type'],_0x3f9fc2=getClientsWithBotID(_0x4cee2a(0x9a)),_0x4db4b2=_0x293703[_0x4cee2a(0x127)][_0x4cee2a(0x1ee)],_0x31de67=timelyDecrypt(_0x4db4b2,![]),_0x4ffea4=_0x3f9fc2[_0x4cee2a(0x8f)](_0x2d95d8=>_0x2d95d8['uuid']==_0x31de67);if(_0x4ffea4){const _0xeb729d=normalizeIP(_0x293703[_0x4cee2a(0x207)][_0x4cee2a(0x186)])['store'],_0x5eebd3=_0x293703['headers'][_0x4cee2a(0x1a0)];if(validateAccess(_0x5eebd3,_0x31de67,_0xeb729d)['allow'])_0x282603=='backup'&&await backupConfigFiles(),await zipFiles(_0x282603),_0x54ba9c[_0x4cee2a(0x142)](zippath+(_0x282603+_0x4cee2a(0x16e)),_0x157024=>{const _0x16e0f0=_0x4cee2a;_0x157024&&(logger[_0x16e0f0(0x170)]('Failed\x20to\x20download\x20'+_0x282603),logger[_0x16e0f0(0x1e6)](_0x157024));});else logger[_0x4cee2a(0x170)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x282603+_0x4cee2a(0x193));}else logger[_0x4cee2a(0x170)](_0x4cee2a(0x1c8)+_0x282603+_0x4cee2a(0x24b));}),app[_0x261552(0xc2)](_0x261552(0x179),async(_0x5ddcee,_0x3e3ed3)=>{const _0x58cef5=_0x261552,_0x1a157e=getClientsWithBotID(_0x58cef5(0x9a)),_0x5442cf=_0x5ddcee[_0x58cef5(0x127)][_0x58cef5(0x1ee)],_0xa7867c=timelyDecrypt(_0x5442cf,![]),_0x41200b=_0x1a157e[_0x58cef5(0x8f)](_0x31cb3b=>_0x31cb3b['uuid']==_0xa7867c);logger[_0x58cef5(0x272)]('Backup\x20file\x20uploaded');if(_0x41200b){const _0x32bafb=normalizeIP(_0x5ddcee['socket'][_0x58cef5(0x186)])[_0x58cef5(0x122)],_0x21368a=_0x5ddcee[_0x58cef5(0x127)][_0x58cef5(0x1a0)];if(validateAccess(_0x21368a,_0xa7867c,_0x32bafb)[_0x58cef5(0x243)]){if(_0x5ddcee['files']){const _0x3ee6a7=_0x5ddcee[_0x58cef5(0x14b)][_0x58cef5(0x260)];await _0x3ee6a7['mv'](temppath+_0x3ee6a7[_0x58cef5(0x181)]),_0x3e3ed3['send']({'status':!![],'message':_0x58cef5(0x156)});const _0xd25105=getBotsWithMode();_0xd25105[_0x58cef5(0xd8)]>0x0?confirmRestore(temppath,_0x3ee6a7[_0x58cef5(0x181)]):unzipFile(temppath,_0x3ee6a7['name']);}}else logger[_0x58cef5(0x170)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger['full'](_0x58cef5(0x201));}),app[_0x261552(0x139)](express[_0x261552(0xeb)](path[_0x261552(0x196)](__dirname,bbpath2,_0x261552(0x157)))),app[_0x261552(0x139)](express[_0x261552(0xeb)](path[_0x261552(0x196)](__dirname,bbpath2,'build'))),app[_0x261552(0x10c)]('/',function(_0x10f858,_0x2fe86c){const _0x2fb781=_0x261552;_0x2fe86c[_0x2fb781(0xe0)](path['join'](__dirname,bbpath2,_0x2fb781(0x157),_0x2fb781(0x21b)));}),app[_0x261552(0x10c)](_0x261552(0x247),function(_0x5e285a,_0xb03764){const _0x202915=_0x261552;_0xb03764['sendFile'](path[_0x202915(0x196)](__dirname,bbpath2,_0x202915(0x292),_0x202915(0x21b)));}),app[_0x261552(0x10c)](_0x261552(0xf6),(_0x3b50ff,_0x54f73b)=>{const _0x2584f5=_0x261552;_0x54f73b[_0x2584f5(0xe0)](path[_0x2584f5(0x196)](__dirname,bbpath2,'build',_0x2584f5(0x21b)));}),app[_0x261552(0x10c)]('/:bot/performance',(_0x183abf,_0xd17a11)=>{const _0x54539=_0x261552;_0xd17a11[_0x54539(0xe0)](path[_0x54539(0x196)](__dirname,bbpath2,'build',_0x54539(0x21b)));}),app[_0x261552(0x10c)](_0x261552(0x182),(_0x24309a,_0x223438)=>{const _0x2161d5=_0x261552;_0x223438[_0x2161d5(0xe0)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x261552(0x10c)]('/:bot/history',(_0x49a2e3,_0x1cacb6)=>{const _0x57a8c4=_0x261552;_0x1cacb6['sendFile'](path[_0x57a8c4(0x196)](__dirname,bbpath2,_0x57a8c4(0x292),_0x57a8c4(0x21b)));}),app['get'](_0x261552(0x132),(_0x1c9143,_0xa1c3a9)=>{const _0xe00f62=_0x261552;_0xa1c3a9[_0xe00f62(0xe0)](path['join'](__dirname,bbpath2,_0xe00f62(0x292),_0xe00f62(0x21b)));}),app[_0x261552(0x10c)](_0x261552(0x150),(_0xf0feb1,_0x2870fc)=>{const _0x2dd1e9=_0x261552;_0x2870fc[_0x2dd1e9(0xe0)](path['join'](__dirname,bbpath2,_0x2dd1e9(0x292),_0x2dd1e9(0x21b)));});if(HOST)http['listen'](PORT,HOST);else http[_0x261552(0x1b3)](PORT);const io=require(_0x261552(0xbf))(http,{});openBrowser&&(async()=>{const _0x387d29=_0x261552,{default:_0x527c2f}=await import('open');await _0x527c2f(_0x387d29(0x7f)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x319cc8=_0x261552;let _0x31dd0a=_0x319cc8(0xfb);const _0x54b39d=networkInterfaces(),_0x2283e2={};for(const _0x24b75c of Object['keys'](_0x54b39d)){for(const _0x29251e of _0x54b39d[_0x24b75c]){if((_0x29251e['family']==_0x319cc8(0x91)||_0x29251e[_0x319cc8(0x8c)]==0x4)&&!_0x29251e[_0x319cc8(0x20d)]){const _0x3e838e=ipaddr[_0x319cc8(0x20b)](_0x29251e[_0x319cc8(0x26a)])['range']();_0x3e838e!=_0x319cc8(0x1ea)&&(!_0x2283e2[_0x24b75c]&&(_0x2283e2[_0x24b75c]=[]),_0x2283e2[_0x24b75c][_0x319cc8(0xad)](_0x29251e[_0x319cc8(0x26a)]),_0x31dd0a=_0x29251e[_0x319cc8(0x26a)]);}}}return{'serverip':_0x31dd0a,'netinterfaces':_0x2283e2};}async function startServer(){const _0x433ad7=_0x261552,{serverip:_0xf36135,netinterfaces:_0x4a220b}=getServerIP();logger[_0x433ad7(0x1e6)](''),logger[_0x433ad7(0x1e6)](_0x433ad7(0x135)),await logger[_0x433ad7(0x170)](_0x433ad7(0x1bb)+serverversion+_0x433ad7(0x202)+(environment=='staging'?_0x433ad7(0xfe):'')+'\x0a'+(_0x433ad7(0x174)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x433ad7(0x13c)+_0xf36135+':'+PORT+_0x433ad7(0x92))),logger[_0x433ad7(0x1e6)](_0x433ad7(0x135));if(config[_0x433ad7(0xd8)]!=0x0)for(const _0x55f2de of config){const _0x61fe75=_0x55f2de['mode']==_0x433ad7(0x149)?'a':'m';if(_0x55f2de[_0x433ad7(0x26e)]==_0x433ad7(0x147)||_0x55f2de[_0x433ad7(0x26e)]==_0x433ad7(0x17d))await logger[_0x433ad7(0x170)](_0x433ad7(0xf3)+_0x61fe75+_0x433ad7(0x11f)+_0x55f2de[_0x433ad7(0xba)]+_0x433ad7(0x95)+_0x55f2de[_0x433ad7(0xb7)]),startBot([_0x55f2de[_0x433ad7(0xba)],userID],{'cwd':bbpath},function(_0x23c778){const _0x56914d=_0x433ad7;if(_0x23c778)logger[_0x56914d(0x170)](_0x23c778);});else(_0x55f2de['status']=='disabled'||_0x55f2de[_0x433ad7(0x26e)]==_0x433ad7(0x1d4))&&await logger[_0x433ad7(0x170)](_0x433ad7(0xfc)+_0x61fe75+')\x20\x20\x20|\x20Bot\x20'+_0x55f2de[_0x433ad7(0xba)]+'\x20|\x20'+_0x55f2de['botname']);}else!newBot&&logger[_0x433ad7(0x1e6)](_0x433ad7(0x133));if(newBot)addBot();logger[_0x433ad7(0x1e6)](_0x433ad7(0x135)),logger['simple'](''),await logger[_0x433ad7(0x272)](_0x433ad7(0x13e)+nodeversion),await logger[_0x433ad7(0x272)](_0x433ad7(0x15a),_0x4a220b);}function startSocket(){io['on']('connection',_0x1bbd80=>{const _0x4da932=_0x382d;let _0x3cac52,_0x50b884,_0x315ab0,_0x28041f,_0x180ebd;const _0xba7dbf=_0x1bbd80['handshake']['headers'][_0x4da932(0x296)];_0x50b884=_0xba7dbf[_0x4da932(0x9e)](/bot[0-9]{3}/);if(_0x50b884)_0x315ab0=_0x50b884[0x0]['match'](/[0-9]{3}/);if(_0x315ab0)_0x3cac52=_0x315ab0[0x0];else _0x3cac52=_0x4da932(0x9a);const _0x5dd231=_0x1bbd80[_0x4da932(0x180)][_0x4da932(0xa8)][_0x4da932(0x123)];if(!_0x5dd231)_0x1bbd80[_0x4da932(0x216)]('status',{'publicKey':secure['publicKey']});else{_0x28041f=timelyDecrypt(_0x5dd231,![]);if(!_0x28041f)_0x1bbd80[_0x4da932(0x216)](_0x4da932(0x26e),{'publicKey':secure[_0x4da932(0x113)]});else{_0x180ebd=normalizeIP(_0x1bbd80['conn'][_0x4da932(0x186)])[_0x4da932(0x122)];if(!devices[_0x28041f])devices[_0x28041f]={'uuid':_0x28041f,'access':{'token':null}};devices[_0x28041f]['ip']=_0x180ebd;const _0x1c822=addClient(_0x1bbd80['id'],_0x28041f,_0x3cac52);setAccess(_0x1c822),emitMessages(),_0x1bbd80['on'](_0x4da932(0xac),_0x37a9fa=>{const _0x527a6b=_0x4da932,_0x5accc4=timelyDecrypt(_0x37a9fa[_0x527a6b(0xb5)],!![],'|@|');if(_0x5accc4){_0x37a9fa={'username':_0x37a9fa[_0x527a6b(0x287)],'password':_0x5accc4},devices[_0x28041f]['access']=validateCredentials(_0x37a9fa,_0x28041f);if(devices[_0x28041f][_0x527a6b(0x1ba)][_0x527a6b(0x243)]==![]&&devices[_0x28041f][_0x527a6b(0x1ba)][_0x527a6b(0x234)]==_0x527a6b(0x229))_0x1bbd80['emit'](_0x527a6b(0x26e),{'access':devices[_0x28041f][_0x527a6b(0x1ba)]}),loginAccess2FA(_0x28041f,_0x180ebd);else{if(devices[_0x28041f][_0x527a6b(0x1ba)][_0x527a6b(0x243)]==![]&&devices[_0x28041f]['access']['reason']=='invalid\x20credentials')_0x1bbd80[_0x527a6b(0x216)](_0x527a6b(0x26e),{'access':devices[_0x28041f][_0x527a6b(0x1ba)]});else devices[_0x28041f][_0x527a6b(0x1ba)][_0x527a6b(0x243)]&&devices[_0x28041f][_0x527a6b(0x1ba)][_0x527a6b(0x234)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x28041f)[_0x527a6b(0x238)](_0x47eb40=>{setAccess(_0x47eb40);}),logger[_0x527a6b(0x272)]('Logged\x20in\x20user\x20...'+_0x28041f[_0x527a6b(0xb6)](-0x8)),setTokenRefresh(_0x28041f),setSessionTimeout(_0x527a6b(0xac),_0x28041f));}}else logger[_0x527a6b(0x170)](_0x527a6b(0x15d));}),_0x1bbd80['on'](_0x4da932(0x19d),()=>{resetPassword();}),_0x1bbd80['on'](_0x4da932(0x27e),_0x2824d0=>{removeClient(_0x1bbd80['id']);}),_0x3cac52=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1d8db2){const _0x486085=_0x261552;if(_0x1d8db2!=_0x486085(0x9a)&&config[_0x486085(0x27a)]!=''){if(pid[_0x1d8db2])pid[_0x1d8db2][_0x486085(0x137)]({'function':_0x486085(0xd2),'args':null});}_0x1d8db2!=_0x486085(0x9a)&&broadcastToBots(_0x486085(0x237),JSON['stringify'](config));}function reloadBotManager(){const _0x59ee5d=_0x261552;getClientsWithBotID(_0x59ee5d(0x9a))['forEach'](_0x3af0e6=>{const _0x494ae5=_0x59ee5d;getSocket(_0x3af0e6['id'])['emit'](_0x494ae5(0x26e),{'access':{'allow':![],'reason':_0x494ae5(0x120),'token':null}});});}function getSocket(_0x38a1d8){const _0x30f1f0=_0x261552,_0x47a8b4=io[_0x30f1f0(0x12f)][_0x30f1f0(0x10c)]('/');return _0x47a8b4[_0x30f1f0(0x10f)][_0x30f1f0(0x10c)](_0x38a1d8);}function setAccess(_0x4e0186){const _0x566168=_0x261552,_0x549692=getSocket(_0x4e0186['id']),_0x1f12a3=_0x4e0186['uuid'],_0x46e86c=_0x4e0186[_0x566168(0x1c0)];devices[_0x1f12a3][_0x566168(0x1ba)]=validateAccess(devices[_0x1f12a3][_0x566168(0x1ba)][_0x566168(0xf5)],_0x1f12a3),logger['debug']('Setting\x20access:\x20'+devices[_0x1f12a3][_0x566168(0x1ba)][_0x566168(0x234)]+'\x20|\x20client:\x20...'+_0x4e0186['id'][_0x566168(0xb6)](-0x8)+_0x566168(0x191)+_0x1f12a3[_0x566168(0xb6)](-0x8)),_0x549692['join'](_0x1f12a3);if(devices[_0x1f12a3][_0x566168(0x1ba)][_0x566168(0x243)]){_0x549692['join'](_0x46e86c);if(_0x46e86c==_0x566168(0x9a))initializeSocketBotManager(_0x549692);else initializeSocketBot(_0x549692);initClient(_0x46e86c);}devices[_0x1f12a3][_0x566168(0x1ba)][_0x566168(0xf5)]&&devices[_0x1f12a3][_0x566168(0x1ba)][_0x566168(0x234)]==_0x566168(0x242)&&setSessionTimeout(_0x566168(0x87),_0x1f12a3),devices[_0x1f12a3][_0x566168(0x1ba)][_0x566168(0xf5)]&&devices[_0x1f12a3][_0x566168(0x1ba)]['reason']==_0x566168(0x83)&&setSessionTimeout(_0x566168(0xac),_0x1f12a3),_0x549692[_0x566168(0x216)](_0x566168(0x26e),{'status':_0x4e0186['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1f12a3][_0x566168(0x1ba)],'externalip':devices[_0x1f12a3]['ip'],'publicKey':secure[_0x566168(0x113)],'userid':settings[_0x566168(0x220)],'validInstallation':validInstallation}),devices[_0x1f12a3]['access']['allow']==![]&&devices[_0x1f12a3][_0x566168(0x1ba)][_0x566168(0x234)]==_0x566168(0x282)&&temporaryAccess2FA(_0x1f12a3,devices[_0x1f12a3]['ip']);}function setSessionTimeout(_0x404f4e,_0x1af8df){const _0xc35dcd=_0x261552;let _0x4145f5;if(_0x404f4e==_0xc35dcd(0xac))_0x4145f5=loginExpiry*0x3c*0x3e8;else _0x4145f5=devices[_0x1af8df][_0xc35dcd(0x25d)][_0xc35dcd(0x18a)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x1af8df][_0xc35dcd(0x25d)]['timestamp']);if(devices[_0x1af8df][_0xc35dcd(0x250)])clearTimeout(devices[_0x1af8df][_0xc35dcd(0x250)]);devices[_0x1af8df][_0xc35dcd(0x250)]=setTimeout(()=>{const _0x3ba76b=_0xc35dcd;if(devices[_0x1af8df][_0x3ba76b(0x167)])clearTimeout(devices[_0x1af8df][_0x3ba76b(0x167)]);removeSocketListeners(_0x1af8df),addBlacklist(_0x1af8df),devices[_0x1af8df]['telegramIpApproval']=null,devices[_0x1af8df][_0x3ba76b(0x124)]=null,devices[_0x1af8df][_0x3ba76b(0x1ba)][_0x3ba76b(0xf5)]=null,logger[_0x3ba76b(0x272)](_0x3ba76b(0x1ec)+_0x1af8df[_0x3ba76b(0xb6)](-0x8)),devices[_0x1af8df][_0x3ba76b(0x1ba)]=validateAccess(devices[_0x1af8df][_0x3ba76b(0x1ba)][_0x3ba76b(0xf5)],_0x1af8df),!(devices[_0x1af8df]['access'][_0x3ba76b(0x243)]&&devices[_0x1af8df]['access']['reason']==_0x3ba76b(0x12a))&&(_0x404f4e==_0x3ba76b(0xac)?io['to'](_0x1af8df)[_0x3ba76b(0x216)](_0x3ba76b(0x26e),{'access':{'allow':![],'reason':_0x3ba76b(0x109),'token':null}}):io['to'](_0x1af8df)['emit'](_0x3ba76b(0x26e),{'access':{'allow':![],'reason':_0x3ba76b(0xdb),'token':null}})),devices[_0x1af8df][_0x3ba76b(0x1ba)][_0x3ba76b(0xf5)]=null;},_0x4145f5);}function setTokenRefresh(_0x391db1){const _0xc2c51a=_0x261552;if(devices[_0x391db1][_0xc2c51a(0x167)])clearTimeout(devices[_0x391db1]['pidRefreshToken']);devices[_0x391db1][_0xc2c51a(0x167)]=setTimeout(()=>{const _0xd3fbf1=_0xc2c51a;getClientsWithUuid(_0x391db1)[_0xd3fbf1(0xd8)]!=0x0?(devices[_0x391db1][_0xd3fbf1(0x1ba)]=refreshToken(_0x391db1),io['to'](_0x391db1)[_0xd3fbf1(0x216)](_0xd3fbf1(0x26e),{'status':_0xd3fbf1(0x128),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x391db1][_0xd3fbf1(0x1ba)],'externalip':devices[_0x391db1]['ip'],'publicKey':secure[_0xd3fbf1(0x113)],'validInstallation':validInstallation}),setTokenRefresh(_0x391db1)):clearTimeout(devices[_0x391db1][_0xd3fbf1(0x167)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x681ab8){const _0x227a1d=_0x261552,_0x2aea46=getClient(_0x681ab8['id'])[_0x227a1d(0x1ee)];_0x681ab8[_0x227a1d(0x216)]('bots',config),_0x681ab8[_0x227a1d(0x216)](_0x227a1d(0x21a),cleanSettings()),_0x681ab8['on'](_0x227a1d(0x1af),_0x416b95=>{const _0x2a2da4=_0x227a1d;if(validateAccess(_0x416b95,_0x2aea46)[_0x2a2da4(0x243)])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x681ab8['on']('update-bot',(_0x5ac276,_0x35dab3)=>{const _0x2b3216=_0x227a1d;if(validateAccess(_0x35dab3,_0x2aea46)['allow'])toggleBot(_0x5ac276['botID'],_0x5ac276[_0x2b3216(0x26e)],_0x5ac276[_0x2b3216(0x291)]);else logger[_0x2b3216(0x170)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x681ab8['on'](_0x227a1d(0x259),(_0x1fe8a9,_0x17bf22)=>{const _0x5d8ff6=_0x227a1d;if(validateAccess(_0x17bf22,_0x2aea46)[_0x5d8ff6(0x243)])toggleBotMode(_0x1fe8a9);else logger['full'](_0x5d8ff6(0x225));}),_0x681ab8['on']('delete-bot',(_0x214c03,_0x362879)=>{const _0x2f0953=_0x227a1d;if(validateAccess(_0x362879,_0x2aea46)[_0x2f0953(0x243)])deleteBot(_0x214c03);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x681ab8['on'](_0x227a1d(0x1fe),(_0x505c39,_0x17244b)=>{const _0x5bf3da=_0x227a1d;if(validateAccess(_0x17244b,_0x2aea46)[_0x5bf3da(0x243)])storeSettings(_0x505c39,!![]);else logger['full'](_0x5bf3da(0xd7));}),_0x681ab8['on'](_0x227a1d(0x7e),_0x3c6070=>{const _0x7ab19f=_0x227a1d;if(validateAccess(_0x3c6070,_0x2aea46)['allow'])updateBB(_0x7ab19f(0x213));else logger['full'](_0x7ab19f(0x24e));}),_0x681ab8['on'](_0x227a1d(0x93),_0x308013=>{const _0x328e1c=_0x227a1d;if(validateAccess(_0x308013,_0x2aea46)[_0x328e1c(0x243)])updateBB(_0x328e1c(0xb0));else logger[_0x328e1c(0x170)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x681ab8['on'](_0x227a1d(0x1b5),_0x393bff=>{const _0x203864=_0x227a1d;if(validateAccess(_0x393bff,_0x2aea46)[_0x203864(0x243)]){const _0x51e739=getClient(_0x681ab8['id']);if(_0x51e739)getBackupFiles(_0x51e739[_0x203864(0x1ee)]);else logger[_0x203864(0x170)](_0x203864(0x236));}else logger[_0x203864(0x170)](_0x203864(0x16b));}),_0x681ab8['on'](_0x227a1d(0x1a8),(_0x4cd19b,_0x49aeeb)=>{const _0x25bb07=_0x227a1d;if(validateAccess(_0x49aeeb,_0x2aea46)['allow'])restoreBackupFile(_0x4cd19b);else logger[_0x25bb07(0x170)](_0x25bb07(0x1c2));}),_0x681ab8['on'](_0x227a1d(0x14d),_0x4c22c7=>{const _0x32b820=_0x227a1d;if(validateAccess(_0x4c22c7,_0x2aea46)[_0x32b820(0x243)])getMessages();else logger['full'](_0x32b820(0xf8));}),_0x681ab8['on']('confirm-message',(_0x451722,_0x265c69)=>{const _0x43b347=_0x227a1d;if(validateAccess(_0x265c69,_0x2aea46)[_0x43b347(0x243)])confirmMessage(_0x451722);else logger[_0x43b347(0x170)](_0x43b347(0x1fb));}),_0x681ab8['on'](_0x227a1d(0x204),_0x5a899b=>{const _0x17d6d5=_0x227a1d;if(validateAccess(_0x5a899b,_0x2aea46)[_0x17d6d5(0x243)]){if(devices[_0x2aea46][_0x17d6d5(0x167)])clearTimeout(devices[_0x2aea46][_0x17d6d5(0x167)]);if(devices[_0x2aea46][_0x17d6d5(0x250)])clearTimeout(devices[_0x2aea46][_0x17d6d5(0x250)]);removeSocketListeners(getClient(_0x681ab8['id'])[_0x17d6d5(0x1ee)]),addBlacklist(_0x2aea46),devices[_0x2aea46][_0x17d6d5(0x25d)]=null,devices[_0x2aea46][_0x17d6d5(0x124)]=null,devices[_0x2aea46][_0x17d6d5(0x1ba)][_0x17d6d5(0xf5)]=null,logger['debug'](_0x17d6d5(0xf1)+_0x2aea46[_0x17d6d5(0xb6)](-0x8)),io['to'](getClient(_0x681ab8['id'])['uuid'])[_0x17d6d5(0x216)](_0x17d6d5(0x26e),{'access':{'allow':![],'reason':_0x17d6d5(0x218),'token':null}});}else logger['full'](_0x17d6d5(0x28f));});}function initializeSocketBot(_0xa3a1fa){const _0x6dc9ed=_0x261552,_0x31ad11=getClient(_0xa3a1fa['id'])['bot'],_0x15668c=getClient(_0xa3a1fa['id'])[_0x6dc9ed(0x1ee)];_0xa3a1fa['on']('get-logs',(_0x41bd4e,_0x5d156d)=>{const _0x205103=_0x6dc9ed;if(validateAccess(_0x5d156d,_0x15668c)[_0x205103(0x243)]){if(pid[_0x31ad11])pid[_0x31ad11][_0x205103(0x137)]({'function':_0x205103(0x183),'args':_0x41bd4e});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0xa3a1fa['on'](_0x6dc9ed(0x290),(_0x428156,_0x365983)=>{const _0x2a2afa=_0x6dc9ed;if(validateAccess(_0x365983,_0x15668c)[_0x2a2afa(0x243)]){if(pid[_0x31ad11])pid[_0x31ad11][_0x2a2afa(0x137)]({'function':_0x2a2afa(0xa2),'args':_0x428156});}else logger[_0x2a2afa(0x170)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0xa3a1fa['on'](_0x6dc9ed(0x17a),(_0x5cb66f,_0xa9d73f)=>{const _0x5da05c=_0x6dc9ed;if(validateAccess(_0xa9d73f,_0x15668c)['allow']){if(pid[_0x31ad11])pid[_0x31ad11][_0x5da05c(0x137)]({'function':_0x5da05c(0x14a),'args':_0x5cb66f});}else logger[_0x5da05c(0x170)](_0x5da05c(0x7b));}),_0xa3a1fa['on']('store-configuration',(_0xb41bf8,_0x3838a1)=>{const _0xe8d755=_0x6dc9ed;if(validateAccess(_0x3838a1,_0x15668c)[_0xe8d755(0x243)]){if(pid[_0x31ad11])pid[_0x31ad11][_0xe8d755(0x137)]({'function':'storeConfiguration','args':_0xb41bf8});}else logger['full'](_0xe8d755(0x98));}),_0xa3a1fa['on'](_0x6dc9ed(0x26f),(_0x1f8ecf,_0x43bb4c)=>{const _0xc62a3d=_0x6dc9ed;if(validateAccess(_0x43bb4c,_0x15668c)[_0xc62a3d(0x243)]){if(pid[_0x31ad11])pid[_0x31ad11]['send']({'function':_0xc62a3d(0x19e),'args':_0x1f8ecf});}else logger[_0xc62a3d(0x170)](_0xc62a3d(0x266));}),_0xa3a1fa['on'](_0x6dc9ed(0x129),(_0x1e4ff8,_0xb2c2a1)=>{const _0xa0c29b=_0x6dc9ed;if(validateAccess(_0xb2c2a1,_0x15668c)[_0xa0c29b(0x243)]){if(pid[_0x31ad11])pid[_0x31ad11]['send']({'function':'storeFiat','args':_0x1e4ff8});}else logger[_0xa0c29b(0x170)](_0xa0c29b(0x188));}),_0xa3a1fa['on'](_0x6dc9ed(0xb9),_0x9b0726=>{const _0x2e45df=_0x6dc9ed;if(validateAccess(_0x9b0726,_0x15668c)[_0x2e45df(0x243)]){if(pid[_0x31ad11])pid[_0x31ad11]['send']({'function':'resetHistory','args':null});}else logger[_0x2e45df(0x170)](_0x2e45df(0x107));}),_0xa3a1fa['on']('get-starting-balances',_0x42382b=>{const _0x56abd2=_0x6dc9ed;if(validateAccess(_0x42382b,_0x15668c)[_0x56abd2(0x243)]){if(pid[_0x31ad11])pid[_0x31ad11][_0x56abd2(0x137)]({'function':_0x56abd2(0x21d),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0xa3a1fa['on'](_0x6dc9ed(0x14f),(_0x2e589e,_0x167ceb)=>{const _0x32e7ae=_0x6dc9ed;if(validateAccess(_0x167ceb,_0x15668c)['allow']){if(pid[_0x31ad11])pid[_0x31ad11][_0x32e7ae(0x137)]({'function':_0x32e7ae(0x1ef),'args':_0x2e589e});}else logger['full'](_0x32e7ae(0x100));}),_0xa3a1fa['on'](_0x6dc9ed(0x9b),_0x188ced=>{const _0x4b913e=_0x6dc9ed;if(validateAccess(_0x188ced,_0x15668c)[_0x4b913e(0x243)]){if(pid[_0x31ad11])pid[_0x31ad11]['send']({'function':'cancelLoading','args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0xa3a1fa['on'](_0x6dc9ed(0x1f9),_0x10bade=>{const _0x16283b=_0x6dc9ed;if(validateAccess(_0x10bade,_0x15668c)['allow']){if(pid[_0x31ad11])pid[_0x31ad11][_0x16283b(0x137)]({'function':'showConfig','args':null});}else logger['full'](_0x16283b(0x27d));}),_0xa3a1fa['on'](_0x6dc9ed(0x7e),_0x4a8b0=>{const _0x50504d=_0x6dc9ed;if(validateAccess(_0x4a8b0,_0x15668c)[_0x50504d(0x243)])updateBB('update');else logger[_0x50504d(0x170)](_0x50504d(0x24e));}),_0xa3a1fa['on'](_0x6dc9ed(0x14d),_0x16d3d2=>{const _0x9afd17=_0x6dc9ed;if(validateAccess(_0x16d3d2,_0x15668c)[_0x9afd17(0x243)])getMessages();else logger[_0x9afd17(0x170)](_0x9afd17(0xf8));}),_0xa3a1fa['on'](_0x6dc9ed(0x195),(_0x1b43ba,_0xc4524b)=>{const _0x5495ed=_0x6dc9ed;if(validateAccess(_0xc4524b,_0x15668c)['allow'])confirmMessage(_0x1b43ba);else logger[_0x5495ed(0x170)](_0x5495ed(0x1fb));}),_0xa3a1fa['on']('logout',_0x49c8cb=>{const _0x4c0c44=_0x6dc9ed;if(validateAccess(_0x49c8cb,_0x15668c)[_0x4c0c44(0x243)]){if(devices[_0x15668c][_0x4c0c44(0x167)])clearTimeout(devices[_0x15668c]['pidRefreshToken']);if(devices[_0x15668c][_0x4c0c44(0x250)])clearTimeout(devices[_0x15668c][_0x4c0c44(0x250)]);removeSocketListeners(getClient(_0xa3a1fa['id'])[_0x4c0c44(0x1ee)]),addBlacklist(_0x15668c),devices[_0x15668c][_0x4c0c44(0x25d)]=null,devices[_0x15668c][_0x4c0c44(0x124)]=null,devices[_0x15668c][_0x4c0c44(0x1ba)][_0x4c0c44(0xf5)]=null,logger[_0x4c0c44(0x272)](_0x4c0c44(0xf1)+_0x15668c['slice'](-0x8)),io['to'](getClient(_0xa3a1fa['id'])[_0x4c0c44(0x1ee)])[_0x4c0c44(0x216)]('status',{'access':{'allow':![],'reason':_0x4c0c44(0x218),'token':null}});}else logger[_0x4c0c44(0x170)](_0x4c0c44(0x28f));});}function removeSocketListeners(_0x1d69d2){getClientsWithUuid(_0x1d69d2)['forEach'](_0x32d436=>{const _0x52f372=_0x382d;getSocket(_0x32d436['id'])[_0x52f372(0x7d)]();});}function cleanSettings(){const _0x355f37=_0x261552;let _0x574236=settings;return settings[_0x355f37(0x285)]&&settings['telegramToken']!=''&&(_0x574236={..._0x574236,'telegramToken':_0x355f37(0x112)}),settings['bbPassword']&&settings[_0x355f37(0x1d3)]!=''&&(_0x574236={..._0x574236,'bbPassword':_0x355f37(0x112)}),settings['marketcapApi']&&settings['marketcapApi']!=''&&(_0x574236={..._0x574236,'marketcapApi':_0x355f37(0x112)}),(settings[_0x355f37(0x1d3)]&&settings[_0x355f37(0x1d3)]==_0x355f37(0x81)||settings[_0x355f37(0x285)]&&settings[_0x355f37(0x285)]==_0x355f37(0x81)||settings[_0x355f37(0x18d)]&&settings[_0x355f37(0x18d)]==_0x355f37(0x81))&&(_0x574236={..._0x574236,'restored':{'password':settings[_0x355f37(0x1d3)]=='***','telegram':settings['telegramToken']==_0x355f37(0x81),'marketcap':settings[_0x355f37(0x18d)]=='***'}}),_0x574236;}async function updateBB(_0x523354){const _0x3ed272=_0x261552;await backupConfigFiles(),installingUpdate=!![],config[_0x3ed272(0x238)](_0x2df188=>{const _0x1f3814=_0x3ed272;restartBot(_0x2df188[_0x1f3814(0xba)]);});if(_0x523354==_0x3ed272(0x213))process[_0x3ed272(0x137)]({'update':!![],'environment':environment},_0x19faef=>{});else _0x523354==_0x3ed272(0xb0)&&process[_0x3ed272(0x137)]({'reinstall':!![],'environment':environment},_0x2c68f0=>{});}function startBot(_0x5782c4,_0x35348d,_0x101cdc){const _0x42db15=_0x261552;if(debugging)_0x5782c4[_0x42db15(0xad)]('-d');if(recreate)_0x5782c4[_0x42db15(0xad)]('-r');let _0x3789f0=![];const _0x197a5c=_0x5782c4[0x0];_0x35348d={..._0x35348d,'stdio':[_0x42db15(0x258),'inherit',_0x42db15(0x258),_0x42db15(0x257)]},pid[_0x197a5c]=childProcess['fork'](botfile,_0x5782c4,_0x35348d),pid[_0x197a5c]['on'](_0x42db15(0x19b),_0xebf5ec=>{const _0x392799=_0x42db15;switch(Object[_0x392799(0xc9)](_0xebf5ec)[0x0]){case'botname':updateBotName(_0x197a5c,_0xebf5ec[_0x392799(0xb7)]);break;case'updatebotmanager':updateBotManager();break;case _0x392799(0x26e):updateStatus(_0x197a5c,_0xebf5ec['status']);break;case _0x392799(0x291):updateLive(_0x197a5c,_0xebf5ec[_0x392799(0x291)]);break;case _0x392799(0x222):updateLive(_0x197a5c,_0xebf5ec[_0x392799(0x222)]),io['to'](_0x197a5c)[_0x392799(0x216)](_0x392799(0x26e),{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0xebf5ec[_0x392799(0x245)]=='restart'&&restartBot(_0x197a5c);_0xebf5ec[_0x392799(0x245)]==_0x392799(0xc8)&&toggleBot(_0x197a5c,_0x392799(0x22f),_0x392799(0x12d));break;case'telegram':sendTelegramBot(_0x197a5c,_0xebf5ec[_0x392799(0xe5)]);break;case _0x392799(0x230):sendTelegramMsg(_0xebf5ec[_0x392799(0x230)]);break;case _0x392799(0x28a):io['to'](_0x197a5c)[_0x392799(0x216)](_0xebf5ec[_0x392799(0x28a)],_0xebf5ec[_0x392799(0x19c)]);break;}}),pid[_0x197a5c]['on'](_0x42db15(0x164),function(_0x4d7def){if(_0x3789f0)return;_0x3789f0=!![],_0x101cdc(_0x4d7def);}),pid[_0x197a5c]['on'](_0x42db15(0xc7),async function(_0x14a402){const _0x47cbbe=_0x42db15;if(terminating)return;if(installingUpdate){io['close']();return;}if(_0x3789f0)return;_0x3789f0=!![],_0x101cdc(null);const _0x4c5b54=dbConfig[_0x47cbbe(0x10c)](_0x47cbbe(0x237))[_0x47cbbe(0x8f)]({'botID':_0x197a5c})[_0x47cbbe(0x1a3)]();_0x4c5b54&&(_0x4c5b54[_0x47cbbe(0x26e)]==_0x47cbbe(0x147)||_0x4c5b54[_0x47cbbe(0x26e)]==_0x47cbbe(0x17d))&&(await sleep(0x3e8),updateLive(_0x197a5c,_0x47cbbe(0x12d)),logger[_0x47cbbe(0x170)](_0x47cbbe(0x1eb)+botRef(_0x197a5c)),startBot([_0x197a5c,userID],{'cwd':bbpath},function(_0x1bfe3a){const _0x217bc9=_0x47cbbe;if(_0x1bfe3a)logger[_0x217bc9(0x170)](_0x1bfe3a);}));});}function stopBot(_0x4242d9){getClientsWithBotID(_0x4242d9)['forEach'](_0x4ff978=>{const _0x14fd33=_0x382d;getSocket(_0x4ff978['id'])[_0x14fd33(0x27e)](!![]),removeClient(_0x4ff978['id']);}),pid[_0x4242d9]&&(pid[_0x4242d9]['kill'](),pid[_0x4242d9]=null);}function stopAllBots(){const _0x59509a=_0x261552;terminating=!![];const _0x50bdf5=getEnabledBots();_0x50bdf5[_0x59509a(0x238)](_0x3bc2d4=>{stopBot(_0x3bc2d4['botID']);});}function restartBot(_0x5616e1){const _0xfd68f2=_0x261552;if(pid[_0x5616e1])pid[_0x5616e1][_0xfd68f2(0xc8)]();}function addBot(){const _0x239a91=_0x261552;let _0x580b0e;for(let _0x42fb63=0x1;_0x42fb63<0x3e9;_0x42fb63++){_0x580b0e=_0x42fb63[_0x239a91(0x239)]()[_0x239a91(0x223)](0x3,'0');let _0x36d28c=config[_0x239a91(0x8f)](_0x568e39=>_0x568e39[_0x239a91(0xba)]==_0x580b0e);if(!_0x36d28c)break;}if(_0x580b0e==='1000'){logger[_0x239a91(0x170)](_0x239a91(0x1c5));return;}logger[_0x239a91(0x170)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x580b0e),dbConfig[_0x239a91(0x10c)](_0x239a91(0x237))[_0x239a91(0xad)]({'botID':_0x580b0e,'botname':'Bot\x20'+_0x580b0e,'status':_0x239a91(0x17d),'live':''})[_0x239a91(0x1a2)](),startBot([_0x580b0e,userID],{'cwd':bbpath},function(_0x598d6e){const _0x169478=_0x239a91;if(_0x598d6e)logger[_0x169478(0x170)](_0x598d6e);}),config=getConfiguration(),io['to'](_0x239a91(0x9a))['emit'](_0x239a91(0x237),config),broadcastToBots(_0x239a91(0x237),JSON[_0x239a91(0x1c4)](config));}function deleteBot(_0x4e5192){const _0x4733ff=_0x261552;getClientsWithBotID(_0x4e5192)[_0x4733ff(0x238)](_0x2a8051=>{const _0x3f89ad=_0x4733ff;getSocket(_0x2a8051['id'])[_0x3f89ad(0x27e)](!![]),removeClient(_0x2a8051['id']);}),dbConfig[_0x4733ff(0x10c)](_0x4733ff(0x237))[_0x4733ff(0xe8)]({'botID':_0x4e5192})[_0x4733ff(0x1a2)](),logger['full'](_0x4733ff(0x1ce)+_0x4e5192),stopBot(_0x4e5192);try{if(fs[_0x4733ff(0x1dd)](path[_0x4733ff(0x196)](configpath,_0x4733ff(0xbc)+_0x4e5192+_0x4733ff(0x126))))fs['unlinkSync'](path[_0x4733ff(0x196)](configpath,_0x4733ff(0xbc)+_0x4e5192+_0x4733ff(0x126)));if(fs['existsSync'](path[_0x4733ff(0x196)](configpath,_0x4733ff(0xbc)+_0x4e5192+_0x4733ff(0x251))))fs[_0x4733ff(0x231)](path['join'](configpath,_0x4733ff(0xbc)+_0x4e5192+_0x4733ff(0x251)));if(fs[_0x4733ff(0x1dd)](path['join'](configpath,_0x4733ff(0xbc)+_0x4e5192+_0x4733ff(0x265))))fs['unlinkSync'](path['join'](configpath,'bot-'+_0x4e5192+_0x4733ff(0x265)));if(fs[_0x4733ff(0x1dd)](path['join'](configpath,_0x4733ff(0xbc)+_0x4e5192+_0x4733ff(0x276))))fs[_0x4733ff(0x231)](path['join'](configpath,_0x4733ff(0xbc)+_0x4e5192+'-results.json'));}catch(_0x39183d){if(_0x39183d)logger[_0x4733ff(0x170)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x39183d);}config=getConfiguration(),io['to'](_0x4733ff(0x9a))[_0x4733ff(0x216)](_0x4733ff(0x237),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBot(_0x27b37c,_0x5785d9,_0x5d2e46){const _0x3b398c=_0x261552;dbConfig[_0x3b398c(0x10c)](_0x3b398c(0x237))[_0x3b398c(0x8f)]({'botID':_0x27b37c})['assign']({'status':_0x5785d9})[_0x3b398c(0x16d)]({'live':_0x5d2e46})[_0x3b398c(0x1a2)]();const _0xc90f8d=botRef(_0x27b37c);if(_0x5785d9==_0x3b398c(0x147)||_0x5785d9==_0x3b398c(0x17d))logger[_0x3b398c(0x170)](_0x3b398c(0x145)+_0xc90f8d),startBot([_0x27b37c,userID],{'cwd':bbpath},function(_0x806c8a){if(_0x806c8a)logger['full'](_0x806c8a);});else(_0x5785d9==_0x3b398c(0x22f)||_0x5785d9==_0x3b398c(0x1d4))&&(logger['full'](_0x3b398c(0x189)+_0xc90f8d),stopBot(_0x27b37c));config=getConfiguration(),io['to'](_0x3b398c(0x9a))['emit'](_0x3b398c(0x237),config),broadcastToBots(_0x3b398c(0x237),JSON[_0x3b398c(0x1c4)](config));}function toggleStatus(_0x18f566){const _0x1871e0=_0x261552;let _0x1a698a=dbConfig['get']('bots')[_0x1871e0(0x8f)]({'botID':_0x18f566})[_0x1871e0(0x1a3)](),_0x4e2974;if(_0x1a698a[_0x1871e0(0x26e)]===_0x1871e0(0x147))_0x4e2974=_0x1871e0(0x22f);else{if(_0x1a698a['status']==='new')_0x4e2974=_0x1871e0(0x1d4);else{if(_0x1a698a[_0x1871e0(0x26e)]===_0x1871e0(0x1d4))_0x4e2974='new';else{if(_0x1a698a['status']===_0x1871e0(0x22f))_0x4e2974='enabled';}}}return _0x4e2974;}function updateStatus(_0x579e28,_0x16c65c){const _0x261f73=_0x261552;dbConfig[_0x261f73(0x10c)]('bots')[_0x261f73(0x8f)]({'botID':_0x579e28})[_0x261f73(0x16d)]({'status':_0x16c65c})[_0x261f73(0x1a2)](),config=getConfiguration(),io['to'](_0x261f73(0x9a))[_0x261f73(0x216)]('bots',config),broadcastToBots(_0x261f73(0x237),JSON[_0x261f73(0x1c4)](config));}function updateLive(_0x5eb1bb,_0xf03c93){const _0x5e3855=_0x261552;dbConfig['get'](_0x5e3855(0x237))[_0x5e3855(0x8f)]({'botID':_0x5eb1bb})[_0x5e3855(0x16d)]({'live':_0xf03c93})[_0x5e3855(0x1a2)](),config=getConfiguration(),io['to'](_0x5e3855(0x9a))['emit'](_0x5e3855(0x237),config),broadcastToBots('bots',JSON[_0x5e3855(0x1c4)](config));}function updateBotName(_0x4ddad9,_0xe41048){const _0x3f4b40=_0x261552;dbConfig[_0x3f4b40(0x10c)](_0x3f4b40(0x237))[_0x3f4b40(0x8f)]({'botID':_0x4ddad9})[_0x3f4b40(0x16d)]({'botname':_0xe41048})['write'](),config=getConfiguration(),io['to'](_0x3f4b40(0x9a))[_0x3f4b40(0x216)](_0x3f4b40(0x237),config),broadcastToBots(_0x3f4b40(0x237),JSON[_0x3f4b40(0x1c4)](config));}function updateBotManager(){const _0x28c6dd=_0x261552;config=getConfiguration(),io['to'](_0x28c6dd(0x9a))[_0x28c6dd(0x216)](_0x28c6dd(0x237),config),broadcastToBots(_0x28c6dd(0x237),JSON['stringify'](config));}function toggleBotMode(_0x5b35bc){const _0x4c9545=_0x261552;if(pid[_0x5b35bc])pid[_0x5b35bc][_0x4c9545(0x137)]({'function':_0x4c9545(0x274),'args':null});else{const _0x5c45e8=configpath+'bot-'+_0x5b35bc+_0x4c9545(0x126),_0x50c08a=fs[_0x4c9545(0xee)](_0x5c45e8),_0x1d2c04=JSON[_0x4c9545(0x20b)](_0x50c08a),_0x31f331=_0x1d2c04[_0x4c9545(0x1c0)][0x0][_0x4c9545(0x27f)];_0x1d2c04[_0x4c9545(0x1c0)][0x0][_0x4c9545(0x27f)]=!_0x31f331;const _0x41e374=JSON['stringify'](_0x1d2c04,null,0x2);fs[_0x4c9545(0xec)](_0x5c45e8,_0x41e374),config=getConfiguration(),io['to']('botmanager')['emit'](_0x4c9545(0x237),config),broadcastToBots(_0x4c9545(0x237),JSON['stringify'](config));}}function validateTelegram(_0x23491d){const _0x3555df=_0x261552;if(_0x23491d[_0x3555df(0x16f)]['username']!=settings[_0x3555df(0x27c)]&&'@'+_0x23491d[_0x3555df(0x16f)]['username']!=settings[_0x3555df(0x27c)]||_0x23491d[_0x3555df(0x264)]['id']!=settings[_0x3555df(0x203)])return sendTelegram(_0x23491d['chat']['id'],_0x3555df(0x158),{'parse_mode':'HTML'}),![];return!![];}function botRef(_0x1859bd){const _0x582e68=_0x261552,_0x4dceef=getBotAttributes(_0x1859bd),_0x3c9451=_0x4dceef[_0x582e68(0x1c7)]?_0x4dceef[_0x582e68(0xb7)]:'Bot\x20'+_0x1859bd;return _0x3c9451;}async function initTelegram(){const _0x10467c=_0x261552;tgBot&&(await tgBot[_0x10467c(0x245)](),await sleep(0x7d0));tgBot=new Telegraf(settings['telegramToken']);let _0x12f1c4='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x12f1c4+='\x0a',_0x12f1c4+=_0x10467c(0x1d2),_0x12f1c4+='/disable\x20-\x20disable\x20notifications\x0a',_0x12f1c4+=_0x10467c(0x13b),_0x12f1c4+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x12f1c4+=_0x10467c(0x1ff),_0x12f1c4+='/off\x20-\x20stop\x20bot(s)\x0a',_0x12f1c4+=_0x10467c(0x271),_0x12f1c4+='/names\x20-\x20show\x20bot\x20names\x0a',_0x12f1c4+=_0x10467c(0x21e),_0x12f1c4+=_0x10467c(0x215),_0x12f1c4+=_0x10467c(0x295),_0x12f1c4+=_0x10467c(0x1e3),_0x12f1c4+=_0x10467c(0x22c),_0x12f1c4+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x12f1c4+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x12f1c4+=_0x10467c(0x11e);let _0x4ee2d4=_0x10467c(0x159);_0x4ee2d4+='\x0a',_0x4ee2d4+=_0x12f1c4,tgBot[_0x10467c(0x8d)]((_0x4fcc67,_0x10eba5)=>{const _0x2fe155=_0x10467c;logger[_0x2fe155(0x1e6)](getTimeStamp()+_0x2fe155(0x1ad)),logger[_0x2fe155(0x272)](_0x2fe155(0x115),_0x4fcc67);}),tgBot[_0x10467c(0x139)](async(_0x331e2d,_0xdad576)=>{const _0x5e8242=_0x10467c;if(settings['telegramChatId']||_0x331e2d[_0x5e8242(0x213)]['message'][_0x5e8242(0x82)]!='/start'){if(!validateTelegram(_0x331e2d))return;}_0xdad576();}),tgBot[_0x10467c(0xab)](_0x10467c(0x1bc),async _0x2bb8ab=>{const _0x41b30d=_0x10467c;if(_0x2bb8ab[_0x41b30d(0x16f)][_0x41b30d(0x287)]==settings[_0x41b30d(0x27c)]||'@'+_0x2bb8ab[_0x41b30d(0x16f)]['username']==settings[_0x41b30d(0x27c)]){if(!settings[_0x41b30d(0x203)])updateSetting(_0x41b30d(0x203),_0x2bb8ab['chat']['id']);else{if(!validateTelegram(_0x2bb8ab))return;}}else{if(!validateTelegram(_0x2bb8ab))return;}updateSetting(_0x41b30d(0x24c),!![]),await sendTelegram(_0x2bb8ab['chat']['id'],_0x4ee2d4);}),tgBot[_0x10467c(0xab)]('enable',async _0x55e6ae=>{const _0x1cc824=_0x10467c;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x55e6ae[_0x1cc824(0x264)]['id'],_0x1cc824(0xa0));}),tgBot[_0x10467c(0xab)](_0x10467c(0x1a9),async _0x49e965=>{const _0x4ba37a=_0x10467c;await sendTelegram(_0x49e965[_0x4ba37a(0x264)]['id'],_0x4ba37a(0x25a)),updateSetting(_0x4ba37a(0x24c),![]);}),tgBot['command'](_0x10467c(0x190),async _0x4bfc34=>{const _0x468848=_0x10467c,_0x2e774f=Markup[_0x468848(0xe3)]([Markup[_0x468848(0x192)][_0x468848(0x263)](_0x468848(0x20c),_0x468848(0x19f)),Markup['button']['callback'](_0x468848(0x28e),_0x468848(0x136)),Markup[_0x468848(0x192)][_0x468848(0x263)](_0x468848(0xbe),_0x468848(0x197))]);_0x4bfc34['reply'](_0x468848(0x22e),_0x2e774f);}),tgBot[_0x10467c(0xf7)](_0x10467c(0x19f),async _0x32aa63=>{const _0x21ca59=_0x10467c;_0x32aa63[_0x21ca59(0x8a)](),updateSetting(_0x21ca59(0x106),_0x21ca59(0x1b6)),updateSetting(_0x21ca59(0x24c),!![]),await sendTelegram(_0x32aa63[_0x21ca59(0x264)]['id'],_0x21ca59(0x84));}),tgBot[_0x10467c(0xf7)](_0x10467c(0x136),async _0x592492=>{const _0x59202e=_0x10467c;_0x592492['editMessageReplyMarkup'](),updateSetting(_0x59202e(0x106),_0x59202e(0x154)),updateSetting(_0x59202e(0x24c),!![]),await sendTelegram(_0x592492['chat']['id'],_0x59202e(0x20e));}),tgBot[_0x10467c(0xf7)]('config_all',async _0x1a283e=>{const _0x4ec6bb=_0x10467c;_0x1a283e['editMessageReplyMarkup'](),updateSetting(_0x4ec6bb(0x106),_0x4ec6bb(0x12c)),updateSetting(_0x4ec6bb(0x24c),!![]),await sendTelegram(_0x1a283e['chat']['id'],_0x4ec6bb(0x1c1));}),tgBot['command'](_0x10467c(0x26e),async _0x51e332=>{const _0x1ba0ae=_0x10467c,_0x4b9a5a=getBotsWithMode();let _0x583148='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x1ba0ae(0x238)](_0x6e151e=>{const _0x4efe3c=_0x1ba0ae,_0x5bfa7a=_0x4b9a5a['find'](_0x16e4d4=>_0x16e4d4['botID']==_0x6e151e[_0x4efe3c(0xba)])[_0x4efe3c(0x11d)];_0x583148+=_0x4efe3c(0x289)+_0x6e151e[_0x4efe3c(0xba)]+':\x20'+_0x6e151e[_0x4efe3c(0x26e)]+_0x4efe3c(0x95)+_0x5bfa7a+'\x20|\x20'+_0x6e151e[_0x4efe3c(0x291)]+'\x0a';}),_0x583148+='\x0a',_0x583148+=_0x1ba0ae(0x185),_0x583148+=!settings[_0x1ba0ae(0x24c)]?_0x1ba0ae(0x16c):_0x1ba0ae(0x17c),_0x583148+=settings['telegramEnabled']?settings[_0x1ba0ae(0x106)]==_0x1ba0ae(0x12c)?_0x1ba0ae(0x151):_0x1ba0ae(0x1c6)+settings[_0x1ba0ae(0x106)]+'\x20only\x0a':'',await sendTelegram(_0x51e332[_0x1ba0ae(0x264)]['id'],_0x583148,{'parse_mode':_0x1ba0ae(0xb8)});}),tgBot['command'](_0x10467c(0x11a),async _0x810940=>{const _0x1b7c58=_0x10467c,_0x7410d=getEnabledBots();if(_0x7410d[_0x1b7c58(0xd8)]==0x0)await sendTelegram(_0x810940[_0x1b7c58(0x264)]['id'],_0x1b7c58(0x162));else{if(_0x7410d['length']>0x1)_0x7410d[_0x1b7c58(0xad)]({'botID':_0x1b7c58(0x12c)});let _0x1625da=[],_0x32125e=[];const _0x1f6ffd=_0x7410d[_0x1b7c58(0xd8)]%0x4==0x0||_0x7410d[_0x1b7c58(0xd8)]%0x4==0x3||_0x7410d[_0x1b7c58(0xd8)]%0x3==0x1?0x4:0x3;let _0xb34b2e=0x0;_0x7410d['forEach']((_0x58b9a3,_0x277941)=>{const _0x522c50=_0x1b7c58;if(_0x277941%_0x1f6ffd==0x0)_0x32125e=[];_0x32125e[_0x522c50(0xad)](Markup[_0x522c50(0x192)]['callback'](_0x58b9a3['botID']==_0x522c50(0x12c)?'All\x20bots':botRef(_0x58b9a3[_0x522c50(0xba)]),_0x522c50(0x275)+_0x58b9a3[_0x522c50(0xba)])),_0x277941%_0x1f6ffd==0x0&&(_0x1625da[_0xb34b2e]=_0x32125e,_0xb34b2e++);});const _0x292409=Markup[_0x1b7c58(0xe3)](_0x1625da);_0x810940['reply'](_0x1b7c58(0x11c),_0x292409);}}),tgBot[_0x10467c(0xf7)](/restart_(.+)/,async _0x4da1e4=>{const _0x480d1a=_0x10467c,_0x2eb68f=_0x4da1e4['match'][0x1];_0x4da1e4['editMessageReplyMarkup'](),_0x2eb68f==_0x480d1a(0x12c)?config[_0x480d1a(0x238)](_0x346b5c=>{const _0x1f62c4=_0x480d1a;restartBot(_0x346b5c[_0x1f62c4(0xba)]);}):restartBot(_0x2eb68f);}),tgBot[_0x10467c(0xab)]('on',async _0x22ae81=>{const _0x11fbdf=_0x10467c,_0x5b0e56=getDisabledBots();if(_0x5b0e56[_0x11fbdf(0xd8)]==0x0)await sendTelegram(_0x22ae81[_0x11fbdf(0x264)]['id'],_0x11fbdf(0x212));else{if(_0x5b0e56['length']>0x1)_0x5b0e56[_0x11fbdf(0xad)]({'botID':'all'});let _0x47cbea=[],_0x4f7747=[];const _0x3b4a2f=_0x5b0e56[_0x11fbdf(0xd8)]%0x4==0x0||_0x5b0e56[_0x11fbdf(0xd8)]%0x4==0x3||_0x5b0e56[_0x11fbdf(0xd8)]%0x3==0x1?0x4:0x3;let _0x307e30=0x0;_0x5b0e56[_0x11fbdf(0x238)]((_0x2a84ca,_0x34e402)=>{const _0x547e8a=_0x11fbdf;if(_0x34e402%_0x3b4a2f==0x0)_0x4f7747=[];_0x4f7747[_0x547e8a(0xad)](Markup['button'][_0x547e8a(0x263)](_0x2a84ca['botID']==_0x547e8a(0x12c)?_0x547e8a(0xbb):botRef(_0x2a84ca[_0x547e8a(0xba)]),_0x547e8a(0xaa)+_0x2a84ca[_0x547e8a(0xba)])),_0x34e402%_0x3b4a2f==0x0&&(_0x47cbea[_0x307e30]=_0x4f7747,_0x307e30++);});const _0x36b15f=Markup[_0x11fbdf(0xe3)](_0x47cbea);_0x22ae81[_0x11fbdf(0x1b2)](_0x11fbdf(0x17f),_0x36b15f);}}),tgBot[_0x10467c(0xf7)](/on_(.+)/,async _0x546d53=>{const _0x59461e=_0x10467c,_0x58b853=_0x546d53['match'][0x1];_0x546d53[_0x59461e(0x8a)]();if(_0x58b853==_0x59461e(0x12c)){const _0x5474cf=getDisabledBots();await sendTelegram(_0x546d53[_0x59461e(0x264)]['id'],_0x59461e(0x160)),_0x5474cf[_0x59461e(0x238)](_0x40e2a5=>{const _0x54abdb=_0x59461e;if(_0x40e2a5['botID']!=_0x54abdb(0x12c))toggleBot(_0x40e2a5[_0x54abdb(0xba)],toggleStatus(_0x40e2a5[_0x54abdb(0xba)]),_0x54abdb(0x12d));});}else await sendTelegram(_0x546d53[_0x59461e(0x264)]['id'],_0x59461e(0xcb)+botRef(_0x58b853)),toggleBot(_0x58b853,toggleStatus(_0x58b853),_0x59461e(0x12d));}),tgBot[_0x10467c(0xab)](_0x10467c(0x18f),async _0x198976=>{const _0xde434e=_0x10467c,_0x6d9422=getEnabledBots();if(_0x6d9422[_0xde434e(0xd8)]==0x0)await sendTelegram(_0x198976[_0xde434e(0x264)]['id'],_0xde434e(0x162));else{if(_0x6d9422[_0xde434e(0xd8)]>0x1)_0x6d9422[_0xde434e(0xad)]({'botID':_0xde434e(0x12c)});let _0x2b6482=[],_0x32c1f2=[];const _0x4338fd=_0x6d9422[_0xde434e(0xd8)]%0x4==0x0||_0x6d9422[_0xde434e(0xd8)]%0x4==0x3||_0x6d9422[_0xde434e(0xd8)]%0x3==0x1?0x4:0x3;let _0x555fba=0x0;_0x6d9422[_0xde434e(0x238)]((_0x59befc,_0x328768)=>{const _0x2bf691=_0xde434e;if(_0x328768%_0x4338fd==0x0)_0x32c1f2=[];_0x32c1f2[_0x2bf691(0xad)](Markup['button'][_0x2bf691(0x263)](_0x59befc[_0x2bf691(0xba)]=='all'?'All\x20bots':botRef(_0x59befc[_0x2bf691(0xba)]),_0x2bf691(0x210)+_0x59befc['botID'])),_0x328768%_0x4338fd==0x0&&(_0x2b6482[_0x555fba]=_0x32c1f2,_0x555fba++);});const _0x4269a3=Markup['inlineKeyboard'](_0x2b6482);_0x198976[_0xde434e(0x1b2)](_0xde434e(0x249),_0x4269a3);}}),tgBot[_0x10467c(0xf7)](/off_(.+)/,async _0x21fe0d=>{const _0x4e4704=_0x10467c,_0x36f169=_0x21fe0d[_0x4e4704(0x9e)][0x1];_0x21fe0d[_0x4e4704(0x8a)]();if(_0x36f169==_0x4e4704(0x12c)){const _0x4678dd=getEnabledBots();await sendTelegram(_0x21fe0d[_0x4e4704(0x264)]['id'],_0x4e4704(0x1d8)),_0x4678dd['forEach'](_0x492400=>{const _0x25766d=_0x4e4704;if(_0x492400[_0x25766d(0xba)]!=_0x25766d(0x12c))toggleBot(_0x492400[_0x25766d(0xba)],toggleStatus(_0x492400['botID']),'stopped');});}else await sendTelegram(_0x21fe0d[_0x4e4704(0x264)]['id'],_0x4e4704(0x206)+botRef(_0x36f169)),toggleBot(_0x36f169,toggleStatus(_0x36f169),_0x4e4704(0x12d));}),tgBot[_0x10467c(0xab)](_0x10467c(0x1ed),async _0x53f76f=>{const _0x5b455e=_0x10467c,_0x92e43d=getEnabledBots();if(_0x92e43d[_0x5b455e(0xd8)]==0x0)await sendTelegram(_0x53f76f[_0x5b455e(0x264)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x92e43d[_0x5b455e(0xd8)]>0x1){let _0xcc945c=[],_0x1d386c=[];const _0xe4ac8=_0x92e43d['length']%0x4==0x0||_0x92e43d[_0x5b455e(0xd8)]%0x4==0x3||_0x92e43d['length']%0x3==0x1?0x4:0x3;let _0x24aa17=0x0;_0x92e43d[_0x5b455e(0x238)]((_0x2e1eba,_0x651096)=>{const _0x73436=_0x5b455e;if(_0x651096%_0xe4ac8==0x0)_0x1d386c=[];_0x1d386c[_0x73436(0xad)](Markup[_0x73436(0x192)]['callback'](botRef(_0x2e1eba[_0x73436(0xba)]),'metrics_'+_0x2e1eba[_0x73436(0xba)])),_0x651096%_0xe4ac8==0x0&&(_0xcc945c[_0x24aa17]=_0x1d386c,_0x24aa17++);});const _0x106fa8=Markup[_0x5b455e(0xe3)](_0xcc945c);_0x53f76f[_0x5b455e(0x1b2)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x106fa8);}else{const _0xe870e3=_0x92e43d[0x0][_0x5b455e(0xba)];if(pid[_0xe870e3])pid[_0xe870e3][_0x5b455e(0x137)]({'function':_0x5b455e(0x1cc),'args':null});}}}),tgBot[_0x10467c(0xf7)](/metrics_(.+)/,async _0x3dab89=>{const _0x7a8558=_0x10467c,_0x159adb=_0x3dab89[_0x7a8558(0x9e)][0x1];_0x3dab89[_0x7a8558(0x8a)]();if(pid[_0x159adb])pid[_0x159adb][_0x7a8558(0x137)]({'function':_0x7a8558(0x1cc),'args':null});}),tgBot[_0x10467c(0xab)](_0x10467c(0x241),async _0x3c4eff=>{const _0x2b932f=_0x10467c,_0xea1cb3=getEnabledBots();if(_0xea1cb3[_0x2b932f(0xd8)]==0x0)await sendTelegram(_0x3c4eff[_0x2b932f(0x264)]['id'],_0x2b932f(0x162));else{if(_0xea1cb3[_0x2b932f(0xd8)]>0x1){let _0x85f408=[],_0x4bf4e1=[];const _0x59b140=_0xea1cb3[_0x2b932f(0xd8)]%0x4==0x0||_0xea1cb3[_0x2b932f(0xd8)]%0x4==0x3||_0xea1cb3[_0x2b932f(0xd8)]%0x3==0x1?0x4:0x3;let _0x38c5fe=0x0;_0xea1cb3[_0x2b932f(0x238)]((_0x2366bf,_0x2818b2)=>{const _0x421c05=_0x2b932f;if(_0x2818b2%_0x59b140==0x0)_0x4bf4e1=[];_0x4bf4e1[_0x421c05(0xad)](Markup['button'][_0x421c05(0x263)](botRef(_0x2366bf['botID']),_0x421c05(0xaf)+_0x2366bf[_0x421c05(0xba)])),_0x2818b2%_0x59b140==0x0&&(_0x85f408[_0x38c5fe]=_0x4bf4e1,_0x38c5fe++);});const _0x2a56d6=Markup[_0x2b932f(0xe3)](_0x85f408);_0x3c4eff['reply'](_0x2b932f(0x1a6),_0x2a56d6);}else{const _0x28630e=_0xea1cb3[0x0][_0x2b932f(0xba)];if(pid[_0x28630e])pid[_0x28630e]['send']({'function':_0x2b932f(0x119),'args':null});}}}),tgBot[_0x10467c(0xf7)](/portfolio_(.+)/,async _0x8e0928=>{const _0x3a08e7=_0x10467c,_0x9c51c0=_0x8e0928['match'][0x1];_0x8e0928[_0x3a08e7(0x8a)]();if(pid[_0x9c51c0])pid[_0x9c51c0][_0x3a08e7(0x137)]({'function':_0x3a08e7(0x119),'args':null});}),tgBot[_0x10467c(0xab)](_0x10467c(0x286),async _0x2b8f72=>{const _0x32f0cb=_0x10467c,_0x5d70d3=_0x32f0cb(0x286);await zipFiles(_0x5d70d3);const _0x4db4fe=zippath+(_0x5d70d3+'.zip');_0x2b8f72[_0x32f0cb(0x273)]({'source':_0x4db4fe})[_0x32f0cb(0x20a)](()=>{})[_0x32f0cb(0x8d)](_0x415516=>logger[_0x32f0cb(0x272)](_0x32f0cb(0x125)+_0x5d70d3+_0x32f0cb(0x168),_0x415516));}),tgBot[_0x10467c(0xab)]('backup',async _0xa5bec2=>{const _0x15e9d5=_0x10467c,_0x40b13d=_0x15e9d5(0x1f1);await backupConfigFiles(),await zipFiles(_0x40b13d);const _0x55fbc4=zippath+(_0x40b13d+_0x15e9d5(0x16e));_0xa5bec2[_0x15e9d5(0x273)]({'source':_0x55fbc4})['then'](()=>{})[_0x15e9d5(0x8d)](_0x5286ce=>logger[_0x15e9d5(0x272)]('Error\x20sending\x20'+_0x40b13d+_0x15e9d5(0x168),_0x5286ce));}),tgBot[_0x10467c(0xab)](_0x10467c(0x213),async _0xf0e952=>{const _0x4999eb=_0x10467c;await getMessages();if(!updateAvailable)await sendTelegram(_0xf0e952[_0x4999eb(0x264)]['id'],_0x4999eb(0x108));else{if(!validInstallation)await sendTelegram(_0xf0e952[_0x4999eb(0x264)]['id'],_0x4999eb(0x172));else{const _0x236435=Markup['inlineKeyboard']([Markup[_0x4999eb(0x192)][_0x4999eb(0x263)](_0x4999eb(0x13a),_0x4999eb(0x297)),Markup['button'][_0x4999eb(0x263)]('No',_0x4999eb(0x118))]);_0xf0e952[_0x4999eb(0x1b2)](_0x4999eb(0x1b9),_0x236435);}}}),tgBot[_0x10467c(0xf7)](/update_(.+)/,async _0xde6fca=>{const _0x56e72c=_0x10467c,_0x9db850=_0xde6fca['match'][0x1];_0xde6fca[_0x56e72c(0x8a)](),_0x9db850==_0x56e72c(0x1f6)&&(await sendTelegram(_0xde6fca[_0x56e72c(0x264)]['id'],_0x56e72c(0x163)),updateBB(_0x56e72c(0x213))),_0x9db850=='no'&&await sendTelegram(_0xde6fca[_0x56e72c(0x264)]['id'],_0x56e72c(0x1f2));}),tgBot[_0x10467c(0xab)](_0x10467c(0xb0),async _0x4d830b=>{const _0x5017bf=_0x10467c;if(!validInstallation)await sendTelegram(_0x4d830b[_0x5017bf(0x264)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x53f25f=Markup[_0x5017bf(0xe3)]([Markup['button'][_0x5017bf(0x263)](_0x5017bf(0x13a),'reinstall_yes'),Markup['button']['callback']('No',_0x5017bf(0x22a))]);_0x4d830b[_0x5017bf(0x1b2)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x53f25f);}}),tgBot['action'](/reinstall_(.+)/,async _0x4fb3b4=>{const _0x156861=_0x10467c,_0x9a1952=_0x4fb3b4[_0x156861(0x9e)][0x1];_0x4fb3b4['editMessageReplyMarkup'](),_0x9a1952==_0x156861(0x1f6)&&(await sendTelegram(_0x4fb3b4[_0x156861(0x264)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x156861(0xb0))),_0x9a1952=='no'&&await sendTelegram(_0x4fb3b4[_0x156861(0x264)]['id'],_0x156861(0x178));}),tgBot[_0x10467c(0xab)](_0x10467c(0x8e),async _0x20a1f0=>{const _0x3512ff=_0x10467c,_0x366b1d=getBotsWithMode();if(_0x366b1d['length']==0x0)await sendTelegram(_0x20a1f0[_0x3512ff(0x264)]['id'],_0x3512ff(0x162));else{let _0x293dd8=[],_0x4b1726=[];const _0x342716=0x2;let _0x567a66=0x0;_0x366b1d[_0x3512ff(0x238)]((_0x1064e2,_0x6501df)=>{const _0x40e999=_0x3512ff;if(_0x6501df%_0x342716==0x0)_0x4b1726=[];_0x4b1726['push'](Markup[_0x40e999(0x192)][_0x40e999(0x263)](botRef(_0x1064e2[_0x40e999(0xba)])+'\x20('+_0x1064e2[_0x40e999(0x11d)]+')',_0x40e999(0x200)+_0x1064e2[_0x40e999(0xba)])),_0x6501df%_0x342716==0x0&&(_0x293dd8[_0x567a66]=_0x4b1726,_0x567a66++);});const _0x13aa4c=Markup[_0x3512ff(0xe3)](_0x293dd8);_0x20a1f0[_0x3512ff(0x1b2)](_0x3512ff(0x152),_0x13aa4c);}}),tgBot[_0x10467c(0xf7)](/toggle_(.+)/,async _0x38625c=>{const _0x24e423=_0x10467c,_0xcaf470=_0x38625c[_0x24e423(0x9e)][0x1];_0x38625c['editMessageReplyMarkup']();const _0xf0a692=getBotsWithMode(),_0x4f37e3=_0xf0a692['find'](_0x274b00=>_0x274b00[_0x24e423(0xba)]==_0xcaf470),_0x5f5ce7=_0x4f37e3['mode']==_0x24e423(0x149)?_0x24e423(0x1e4):_0x24e423(0x149);await sendTelegram(_0x38625c[_0x24e423(0x264)]['id'],'Bot\x20Mgr\x20>\x20Toggling\x20'+botRef(_0x4f37e3['botID'])+_0x24e423(0x280)+_0x5f5ce7+_0x24e423(0xd4)),toggleBotMode(_0xcaf470);}),tgBot[_0x10467c(0xab)]('names',async _0x38af53=>{const _0x282ddd=_0x10467c;let _0x5e8709='';config[_0x282ddd(0x238)](_0x25370a=>{const _0x2a5bc1=_0x282ddd;_0x5e8709+=_0x2a5bc1(0x289)+_0x25370a['botID']+':\x20'+_0x25370a[_0x2a5bc1(0xb7)]+'\x0a';}),await sendTelegram(_0x38af53[_0x282ddd(0x264)]['id'],_0x5e8709,{'parse_mode':_0x282ddd(0xb8)});}),tgBot[_0x10467c(0xab)](_0x10467c(0x1f3),async _0x183b47=>{const _0x489e2c=_0x10467c;await sendTelegram(_0x183b47[_0x489e2c(0x264)]['id'],_0x12f1c4);}),process[_0x10467c(0xda)](_0x10467c(0x101),()=>tgBot['stop']('SIGINT')),process[_0x10467c(0xda)]('SIGTERM',()=>tgBot[_0x10467c(0x245)](_0x10467c(0x25c))),tgBot[_0x10467c(0x221)]();}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x3da210,_0x2aec90,_0x4d1ce5){const _0x567919=_0x261552;_0x4d1ce5={..._0x4d1ce5,'disable_web_page_preview':!![]};try{await tgBot['telegram']['sendMessage'](_0x3da210,_0x2aec90,_0x4d1ce5);}catch(_0x1625e4){logger[_0x567919(0x272)]('Telegram\x20error:',_0x1625e4);}}async function sendTelegramBot(_0x20f84c,_0xa23766){const _0x18dfde=_0x261552;if(settings[_0x18dfde(0x24c)]){if(settings[_0x18dfde(0x106)]==_0x18dfde(0x12c)||(_0xa23766[_0x18dfde(0xfa)]==_0x18dfde(0x164)||_0xa23766[_0x18dfde(0xfa)]==_0x18dfde(0xf0)||_0xa23766[_0x18dfde(0xfa)]==_0x18dfde(0x208))&&settings['telegramEvents']==_0x18dfde(0x154)||_0xa23766[_0x18dfde(0xfa)]==_0x18dfde(0x1a7)&&settings[_0x18dfde(0x106)]==_0x18dfde(0x1b6)){if(tgBot&&settings[_0x18dfde(0x203)]){if(_0xa23766[_0x18dfde(0x1c7)])await sendTelegram(settings[_0x18dfde(0x203)],_0xa23766[_0x18dfde(0xb7)]+'\x20>\x20'+_0xa23766[_0x18dfde(0x111)]);else await sendTelegram(settings['telegramChatId'],_0x18dfde(0x289)+_0x20f84c+'\x20>\x20'+_0xa23766[_0x18dfde(0x111)]);}}}}async function sendTelegramMsg(_0xe4eccf,_0x25844e=_0x261552(0xb8)){const _0x4802d9=_0x261552;return tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x4802d9(0x203)],_0xe4eccf,{'parse_mode':_0x25844e}),!![]):![];}function getDeviceWithIp(_0x21fc07){const _0x31d64b=_0x261552;return devices[_0x31d64b(0x8f)](_0x2213b3=>_0x2213b3['ip']===_0x21fc07);}async function temporaryAccess2FA(_0x231d7b,_0x381d08){const _0x2f7998=_0x261552;let _0x5df102=new Date(),_0x1c348a=![];if(lastIpApproval){if(_0x5df102-lastIpApproval<0x1388)_0x1c348a=!![];}lastIpApproval=new Date();if(_0x1c348a)return;if(tgBot&&settings[_0x2f7998(0x203)]){const _0x1afedb=uuidRandom();tmpStorage[_0x1afedb]={'uuid':_0x231d7b,'externalip':_0x381d08};const _0x437d98=Markup[_0x2f7998(0xe3)]([Markup[_0x2f7998(0x192)][_0x2f7998(0x263)](_0x2f7998(0xed),_0x2f7998(0xef)+_0x1afedb),Markup[_0x2f7998(0x192)][_0x2f7998(0x263)](_0x2f7998(0x233),_0x2f7998(0x10e)+_0x1afedb),Markup[_0x2f7998(0x192)][_0x2f7998(0x263)](_0x2f7998(0x15f),_0x2f7998(0x214)+_0x1afedb),Markup[_0x2f7998(0x192)][_0x2f7998(0x263)](_0x2f7998(0x1ac),_0x2f7998(0xa9)+_0x1afedb)]);await sendTelegram(settings[_0x2f7998(0x203)],_0x2f7998(0x17b)+normalizeIP(_0x381d08)['show']+'\x20?',_0x437d98),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x4666ba=>{const _0x44274e=_0x2f7998,_0x211587=_0x4666ba[_0x44274e(0x9e)][0x1],_0xbe98f9=_0x4666ba[_0x44274e(0x9e)][0x2],{uuid:_0x5e656d,externalip:_0x27fd7d}=tmpStorage[_0xbe98f9];delete tmpStorage[_0xbe98f9],_0x4666ba[_0x44274e(0x8a)](),devices[_0x5e656d][_0x44274e(0x25d)]={'clientip':_0x27fd7d,'timestamp':new Date()['getTime'](),'expiry':_0x211587},_0x211587!=_0x44274e(0x1ac)?(await sendTelegram(_0x4666ba['chat']['id'],'Access\x20enabled\x20for\x20'+_0x211587+_0x44274e(0x176),{'parse_mode':'HTML'}),io['to'](_0x5e656d)[_0x44274e(0x216)](_0x44274e(0x26e),{'access':{'allow':![],'reason':_0x44274e(0x120),'token':null}})):(await sendTelegram(_0x4666ba['chat']['id'],'Temporary\x20access\x20rejected'),io['to'](_0x5e656d)[_0x44274e(0x216)]('status',{'access':{'allow':![],'reason':_0x44274e(0x1e1),'token':null}}));});}}async function loginAccess2FA(_0xc2092b,_0x5bb018){const _0x1f6785=_0x261552;if(tgBot&&settings['telegramChatId']){const _0x5eb519=uuidRandom();tmpStorage[_0x5eb519]={'uuid':_0xc2092b,'externalip':_0x5bb018};const _0x211700=Markup['inlineKeyboard']([Markup['button'][_0x1f6785(0x263)]('accept',_0x1f6785(0x26d)+loginExpiry+'_'+_0x5eb519),Markup['button'][_0x1f6785(0x263)](_0x1f6785(0x1ac),'login2fa_reject_'+_0x5eb519)]);await sendTelegram(settings['telegramChatId'],_0x1f6785(0x28c)+normalizeIP(_0x5bb018)[_0x1f6785(0x18c)]+'\x20?',_0x211700),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x27ac05=>{const _0x59ecaf=_0x1f6785,_0x2ab064=_0x27ac05[_0x59ecaf(0x9e)][0x1],_0x272c0f=_0x27ac05[_0x59ecaf(0x9e)][0x2],{uuid:_0x1fe05f,externalip:_0x4a80d7}=tmpStorage[_0x272c0f];delete tmpStorage[_0x272c0f],_0x27ac05[_0x59ecaf(0x8a)](),devices[_0x1fe05f][_0x59ecaf(0x124)]={'clientip':_0x4a80d7,'timestamp':new Date()['getTime'](),'expiry':_0x2ab064},_0x2ab064!=_0x59ecaf(0x1ac)?(await sendTelegram(_0x27ac05[_0x59ecaf(0x264)]['id'],_0x59ecaf(0x1ca),{'parse_mode':_0x59ecaf(0xb8)}),io['to'](_0x1fe05f)[_0x59ecaf(0x216)](_0x59ecaf(0x26e),{'access':{'allow':![],'reason':_0x59ecaf(0x120),'token':null}})):(await sendTelegram(_0x27ac05[_0x59ecaf(0x264)]['id'],_0x59ecaf(0xb2)),io['to'](_0x1fe05f)['emit'](_0x59ecaf(0x26e),{'access':{'allow':![],'reason':_0x59ecaf(0x24f),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1522d2=_0x261552;return dbConfig[_0x1522d2(0x10c)](_0x1522d2(0x237))[_0x1522d2(0x1aa)](_0x1522d2(0xba))['filter']({'status':_0x1522d2(0x147)})[_0x1522d2(0x1a3)]()||[];}function getDisabledBots(){const _0x594295=_0x261552;return dbConfig[_0x594295(0x10c)](_0x594295(0x237))['sortBy']('botID')['filter']({'status':'disabled'})[_0x594295(0x1a3)]()||[];}function getBotAttributes(_0x2fc220){const _0x4d490f=_0x261552;let _0x1b6d19={};const _0x48ab72=configpath+_0x4d490f(0xbc)+_0x2fc220+_0x4d490f(0x126),_0x1497ea=fs['existsSync'](_0x48ab72);if(_0x1497ea){const _0x2e967f=fs[_0x4d490f(0xee)](_0x48ab72);try{const _0x443993=JSON['parse'](_0x2e967f),_0x99bd63=_0x443993?_0x443993[_0x4d490f(0x1c0)][0x0][_0x4d490f(0x27f)]:![];_0x1b6d19[_0x4d490f(0x11d)]=_0x99bd63?_0x4d490f(0x149):'manual',_0x1b6d19['botname']=_0x443993?_0x443993[_0x4d490f(0x1c0)][0x0][_0x4d490f(0xb7)]:_0x4d490f(0x289)+_0x2fc220,_0x1b6d19['showname']=_0x443993?_0x443993[_0x4d490f(0x1c0)][0x0][_0x4d490f(0x1c7)]:![];}catch(_0x5292c4){_0x1b6d19['mode']=_0x4d490f(0x1e4),_0x1b6d19[_0x4d490f(0xb7)]='Bot\x20'+_0x2fc220,_0x1b6d19['showname']=![];}}else _0x1b6d19['mode']=_0x4d490f(0x1e4),_0x1b6d19['botname']=_0x4d490f(0x289)+_0x2fc220,_0x1b6d19[_0x4d490f(0x1c7)]=![];return _0x1b6d19;}function getBotsWithMode(){const _0xe6f74f=_0x261552,_0x493b04=dbConfig['get'](_0xe6f74f(0x237))[_0xe6f74f(0x1aa)](_0xe6f74f(0xba))[_0xe6f74f(0x1a3)]()||[];return _0x493b04[_0xe6f74f(0x238)](_0x5bb5b7=>{const _0x23637f=_0xe6f74f;let _0x37ebbd=getBotAttributes(_0x5bb5b7['botID']);_0x5bb5b7[_0x23637f(0x11d)]=_0x37ebbd['mode'];}),_0x493b04;}function getBotExchanges(){const _0x4804e1=_0x261552;let _0x3c64cc=[];const _0x919b9c=dbConfig[_0x4804e1(0x10c)](_0x4804e1(0x237))[_0x4804e1(0x1aa)]('botID')['value']()||[];_0x919b9c[_0x4804e1(0x238)](_0x3aa43f=>{const _0x2ba342=_0x4804e1;if(_0x3aa43f['status']=='enabled'){const _0x2b551f=configpath+_0x2ba342(0xbc)+_0x3aa43f['botID']+_0x2ba342(0x126),_0xfd5d25=fs[_0x2ba342(0x1dd)](_0x2b551f);let _0x4aa47e;if(_0xfd5d25){const _0x54803a=fs['readFileSync'](_0x2b551f);try{const _0x5c9e3f=JSON['parse'](_0x54803a);_0x4aa47e=_0x5c9e3f?_0x5c9e3f['bot'][0x0][_0x2ba342(0x140)]:null;}catch(_0x4c42e6){}}if(_0x4aa47e)_0x3c64cc[_0x2ba342(0xad)](_0x4aa47e);}});const _0x18fefe=[...new Set(_0x3c64cc)]['sort']();return _0x18fefe;}async function initUser(){const _0x1cbddc=_0x261552;if(!settings[_0x1cbddc(0x220)]){const _0x5a5c1b=uuidRandom();mixpanel[_0x1cbddc(0x1e2)](_0x5a5c1b),updateSetting('userid',_0x5a5c1b);}}async function initSecure(){const _0x251018=_0x261552;let _0x2295bb=getSecure();if(!_0x2295bb[_0x251018(0x198)]('secret')){let _0x28f6fe=await generateKeys();_0x2295bb['publicKey']=_0x28f6fe[_0x251018(0x113)],_0x2295bb[_0x251018(0x1db)]=_0x28f6fe[_0x251018(0x1db)],_0x2295bb[_0x251018(0x14c)]=crypto['randomBytes'](0x20)[_0x251018(0x239)](_0x251018(0x175));;storeSecure(_0x2295bb);}}function getSettings(){const _0x22ed3a=_0x261552;return dbSettings['get']('settings')[_0x22ed3a(0x1a3)]()||{};}function getSecure(){const _0x3fb4fc=_0x261552;return dbSecure['get']('secure')[_0x3fb4fc(0x1a3)]()||{};}function getBlacklist(){const _0xb702f5=_0x261552;return dbSecure[_0xb702f5(0x10c)](_0xb702f5(0x25b))[_0xb702f5(0x1a3)]()||[];}function broadcastToBots(_0xbccf68,_0x26fdcb){config['forEach'](_0x4b6c18=>{const _0x1fba22=_0x382d;if(_0x4b6c18[_0x1fba22(0x26e)]=='enabled'&&_0x4b6c18[_0x1fba22(0x291)]=='running'||_0x4b6c18[_0x1fba22(0x26e)]==_0x1fba22(0x17d)&&_0x4b6c18[_0x1fba22(0x291)]==_0x1fba22(0xe6)){if(pid[_0x4b6c18[_0x1fba22(0xba)]])pid[_0x4b6c18[_0x1fba22(0xba)]][_0x1fba22(0x137)]({[_0xbccf68]:_0x26fdcb});}});}async function storeSettings(_0x3fa155,_0x3b82de=![]){const _0x48d867=_0x261552;_0x3fa155={...settings,..._0x3fa155};if(_0x3b82de&&_0x3fa155[_0x48d867(0x1d3)]!=_0x48d867(0x112)&&_0x3fa155[_0x48d867(0x1d3)]!='***'&&_0x3fa155['bbPassword']!=''){const _0x1acff1=decryptRSA(secure['privateKey'],_0x3fa155[_0x48d867(0x1d3)])[_0x48d867(0x114)](_0x48d867(0x1ab))[0x0],_0x5cb40e=bcrypt[_0x48d867(0x169)](_0x1acff1,saltRounds);_0x3fa155={..._0x3fa155,'bbPassword':_0x5cb40e};}if(_0x3b82de&&_0x3fa155[_0x48d867(0x285)]!=_0x48d867(0x112)&&_0x3fa155[_0x48d867(0x285)]!=_0x48d867(0x81)&&_0x3fa155[_0x48d867(0x285)]!=''){const _0x398a96=decryptRSA(secure[_0x48d867(0x1db)],_0x3fa155[_0x48d867(0x285)])[_0x48d867(0x114)](_0x48d867(0x1ab))[0x0];_0x3fa155={..._0x3fa155,'telegramToken':_0x398a96};}if(_0x3b82de&&_0x3fa155[_0x48d867(0x18d)]!=_0x48d867(0x112)&&_0x3fa155[_0x48d867(0x18d)]!=_0x48d867(0x81)&&_0x3fa155[_0x48d867(0x18d)]!=''){const _0x402fc8=decryptRSA(secure[_0x48d867(0x1db)],_0x3fa155[_0x48d867(0x18d)])['split'](_0x48d867(0x1ab))[0x0];_0x3fa155={..._0x3fa155,'marketcapApi':_0x402fc8};}const _0xa7e06d=_0x3fa155[_0x48d867(0x285)]!='************'&&_0x3fa155[_0x48d867(0x285)]!=settings['telegramToken']||_0x3fa155[_0x48d867(0x27c)]!=settings[_0x48d867(0x27c)],_0x2adf9f=_0x3fa155[_0x48d867(0x285)]==''||_0x3fa155[_0x48d867(0x27c)]=='',_0x453ef2=_0x3fa155[_0x48d867(0x18d)]&&_0x3fa155[_0x48d867(0x18d)]!='************'&&_0x3fa155[_0x48d867(0x18d)]!=settings[_0x48d867(0x18d)];_0xa7e06d&&(_0x3fa155[_0x48d867(0x203)]=null,_0x3fa155[_0x48d867(0x106)]=_0x48d867(0x12c));for(const [_0x135c22,_0x5ac4e6]of Object[_0x48d867(0x256)](_0x3fa155)){if(_0x135c22==_0x48d867(0x285)&&_0x5ac4e6=='************'){_0x3fa155[_0x48d867(0x285)]=settings[_0x48d867(0x285)];continue;};if(_0x135c22==_0x48d867(0x1d3)&&_0x5ac4e6=='************'){_0x3fa155[_0x48d867(0x1d3)]=settings[_0x48d867(0x1d3)];continue;};if(_0x135c22==_0x48d867(0x18d)&&_0x5ac4e6==_0x48d867(0x112)){_0x3fa155['marketcapApi']=settings[_0x48d867(0x18d)];continue;};dbSettings[_0x48d867(0x141)](_0x48d867(0x1d6)+_0x135c22,_0x5ac4e6)[_0x48d867(0x1a2)]();}settings=_0x3fa155,io['to'](_0x48d867(0x9a))[_0x48d867(0x216)](_0x48d867(0x21a),cleanSettings()),broadcastToBots('timeshift',settings[_0x48d867(0x144)]),broadcastToBots(_0x48d867(0x281),settings[_0x48d867(0x281)]),broadcastToBots('marketcapApi',settings[_0x48d867(0x18d)]);if(_0xa7e06d&&!_0x2adf9f)initTelegram();_0xa7e06d&&_0x2adf9f&&(updateSetting(_0x48d867(0x203),null),disableTelegram()),getAllClients()[_0x48d867(0x238)](_0x5114bc=>{const _0x32d246=_0x48d867;getSocket(_0x5114bc['id'])[_0x32d246(0x216)](_0x32d246(0x26e),{'access':{'allow':![],'reason':_0x32d246(0x120),'token':null}});}),_0x453ef2&&(await sleep(0xbb8),testMarketcapApi(_0x3fa155[_0x48d867(0x18d)]));}async function testMarketcapApi(_0x25e2a3){const _0x1f86b3=_0x261552,_0xbe94f6=[_0x1f86b3(0x116),_0x1f86b3(0xe7)];try{await axios[_0x1f86b3(0x10c)]('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x25e2a3},'params':{'symbol':_0xbe94f6[_0x1f86b3(0x239)]()}});}catch(_0x1c1cc4){_0x1c1cc4[_0x1f86b3(0x239)]()[_0x1f86b3(0x261)](_0x1f86b3(0x1e5))?(io['to'](_0x1f86b3(0x9a))[_0x1f86b3(0x216)](_0x1f86b3(0xa1),_0x1f86b3(0xdd)),logger[_0x1f86b3(0x170)](_0x1f86b3(0xdd))):(io['to'](_0x1f86b3(0x9a))['emit'](_0x1f86b3(0xa1),'CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x1f86b3(0x170)](_0x1f86b3(0xc6)),logger['debug']('Error\x20details:',_0x1c1cc4[_0x1f86b3(0x239)]()+'\x20-\x20'+_0x1c1cc4[_0x1f86b3(0xf9)]));return;}logger['debug'](_0x1f86b3(0x173));}function updateSetting(_0x526ff7,_0x48d0a9){const _0x4e4824=_0x261552;dbSettings['set'](_0x4e4824(0x1d6)+_0x526ff7,_0x48d0a9)['write'](),settings=getSettings(),io['to'](_0x4e4824(0x9a))['emit']('settings',cleanSettings());}function storeSecure(_0x2c3e5d){const _0x46547f=_0x261552;dbSecure[_0x46547f(0x10c)](_0x46547f(0x253))[_0x46547f(0xad)](_0x2c3e5d)['write'](),secure=_0x2c3e5d;}function addBlacklist(_0x2b99e1){const _0x50c860=_0x261552;cleanBlacklist();let _0x1191ba;devices[_0x2b99e1][_0x50c860(0x25d)]?_0x1191ba=Math[_0x50c860(0x267)](devices[_0x2b99e1][_0x50c860(0x25d)]['expiry'],loginExpiry):_0x1191ba=loginExpiry,dbSecure[_0x50c860(0x10c)](_0x50c860(0x25b))[_0x50c860(0xad)]({'expiry':new Date()[_0x50c860(0x11b)]()+_0x1191ba*0x3c*0x3e8,'token':devices[_0x2b99e1][_0x50c860(0x1ba)][_0x50c860(0xf5)]})['write'](),blacklist=dbSecure[_0x50c860(0x10c)]('blacklist')[_0x50c860(0x1a3)]();}function cleanBlacklist(){const _0x579f60=_0x261552;let _0x145513=dbSecure[_0x579f60(0x10c)](_0x579f60(0x25b))[_0x579f60(0xb1)]()[_0x579f60(0x1a3)](),_0x1ca8b8=new Date()['getTime']();_0x145513[_0x579f60(0x238)](_0x23c49e=>{const _0x3dc45a=_0x579f60;_0x23c49e['expiry']<_0x1ca8b8&&dbSecure[_0x3dc45a(0x10c)](_0x3dc45a(0x25b))[_0x3dc45a(0xe8)]({'expiry':_0x23c49e[_0x3dc45a(0x18a)]})['write']();});}function initStates(){const _0x53cacc=_0x261552;let _0x4d30ae=getConfiguration();_0x4d30ae[_0x53cacc(0x238)](_0x4edd50=>{const _0x180eca=_0x53cacc;_0x4edd50[_0x180eca(0x291)]=_0x180eca(0x12d);}),storeConfiguration(_0x4d30ae);}async function generateKeys(){const _0x5cf293=_0x261552,_0x3034f5=forge['pki'][_0x5cf293(0x252)][_0x5cf293(0x28d)]({'bits':0x1000,'e':0x10001}),_0x5ad29e=forge[_0x5cf293(0xb4)]['privateKeyToPem'](_0x3034f5[_0x5cf293(0x1db)]),_0x19e124=forge['pki']['publicKeyToPem'](_0x3034f5[_0x5cf293(0x113)]);return{'privateKey':_0x5ad29e,'publicKey':_0x19e124};}async function oneTimeMigration(){const _0x834be6=_0x261552;let _0x35b5af=getSettings(),_0x2e666a=![];!_0x35b5af[_0x834be6(0x198)](_0x834be6(0xd6))&&(_0x35b5af[_0x834be6(0xd6)]=0x0,_0x2e666a=!![]);!_0x35b5af[_0x834be6(0x198)](_0x834be6(0x1f5))&&(_0x35b5af[_0x834be6(0x1f5)]=0x0,_0x2e666a=!![]);!_0x35b5af[_0x834be6(0x198)]('latestversion')&&(_0x35b5af[_0x834be6(0x1bd)]=_0x834be6(0x1d9),_0x2e666a=!![]);!_0x35b5af['hasOwnProperty']('onepagemode')&&(_0x35b5af[_0x834be6(0x281)]=![],_0x2e666a=!![]);!_0x35b5af[_0x834be6(0x198)]('marketcapApi')&&(_0x35b5af[_0x834be6(0x18d)]='',_0x2e666a=!![]);if(_0x2e666a)storeSettings(_0x35b5af);try{fs[_0x834be6(0x80)](configbackuppath,{'withFileTypes':!![]})[_0x834be6(0x238)](_0x2a1034=>{const _0x31cb5c=_0x834be6;if(!_0x2a1034[_0x31cb5c(0xd5)]()){if(!_0x2a1034[_0x31cb5c(0x181)][_0x31cb5c(0x1e9)](_0x31cb5c(0x1d1)))fs[_0x31cb5c(0x231)](configbackuppath+_0x2a1034[_0x31cb5c(0x181)]);}else fs['rmSync'](configbackuppath+_0x2a1034[_0x31cb5c(0x181)],{'recursive':!![]});});}catch(_0xa29eb8){logger[_0x834be6(0x272)](_0x834be6(0x28b),_0xa29eb8);}}function storeConfiguration(_0x1d4948){const _0x15b6ed=_0x261552;dbConfig[_0x15b6ed(0x10c)](_0x15b6ed(0x237))[_0x15b6ed(0xe8)]()[_0x15b6ed(0x1a2)](),dbConfig[_0x15b6ed(0x10c)](_0x15b6ed(0x237))[_0x15b6ed(0xad)](..._0x1d4948)[_0x15b6ed(0x1a2)](),config=_0x1d4948;}async function resetPassword(){const _0x596103=_0x261552;if(tgBot&&settings[_0x596103(0x203)]){const _0x7c3510=Markup[_0x596103(0xe3)]([Markup['button']['callback'](_0x596103(0x1f6),_0x596103(0x1c3)),Markup[_0x596103(0x192)][_0x596103(0x263)]('no',_0x596103(0x131))]);await sendTelegram(settings[_0x596103(0x203)],_0x596103(0x1d7),_0x7c3510),tgBot[_0x596103(0xf7)](/resetpw_(.+)/,async _0x7b77eb=>{const _0x28eaf6=_0x596103,_0x24f9e0=_0x7b77eb[_0x28eaf6(0x9e)][0x1];_0x7b77eb[_0x28eaf6(0x8a)]();if(_0x24f9e0!='no'){const _0xff3622=0xf,_0x4e097e=_0x28eaf6(0x9c),_0x4f6e24=Array[_0x28eaf6(0x16f)](crypto[_0x28eaf6(0x24d)](new Uint32Array(_0xff3622)))[_0x28eaf6(0x1b0)](_0x457fe8=>_0x4e097e[_0x457fe8%_0x4e097e[_0x28eaf6(0xd8)]])[_0x28eaf6(0x196)](''),_0x4f4e35=bcrypt[_0x28eaf6(0x169)](_0x4f6e24,saltRounds);storeSettings({'bbPassword':_0x4f4e35}),await sendTelegram(_0x7b77eb[_0x28eaf6(0x264)]['id'],_0x28eaf6(0xcf)+_0x4f6e24,{'parse_mode':_0x28eaf6(0xb8)});}else await sendTelegram(_0x7b77eb[_0x28eaf6(0x264)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0xcc079c,_0x1cccb5){const _0x387c5a=_0x261552;io['to'](_0x387c5a(0x9a))['emit'](_0x387c5a(0xa1),_0x387c5a(0xe4),_0x387c5a(0x208));if(tgBot&&settings['telegramChatId']){const _0x4b9378=uuidRandom();tmpStorage[_0x4b9378]={'path':_0xcc079c,'filename':_0x1cccb5};const _0x4fddab=Markup[_0x387c5a(0xe3)]([Markup[_0x387c5a(0x192)][_0x387c5a(0x263)](_0x387c5a(0x1f6),_0x387c5a(0x219)+_0x4b9378),Markup[_0x387c5a(0x192)][_0x387c5a(0x263)]('no','restore_no_'+_0x4b9378)]);await sendTelegram(settings[_0x387c5a(0x203)],_0x387c5a(0x240),_0x4fddab),tgBot[_0x387c5a(0xf7)](/restore_(.+)_(.+)/,async _0x175515=>{const _0x4152f3=_0x387c5a,_0x3cf460=_0x175515[_0x4152f3(0x9e)][0x1],_0x123cd0=_0x175515[_0x4152f3(0x9e)][0x2],{path:_0x2ea846,filename:_0x2c916e}=tmpStorage[_0x123cd0];delete tmpStorage[_0x123cd0],_0x175515[_0x4152f3(0x8a)](),_0x3cf460==_0x4152f3(0x1f6)?(logger['debug'](_0x4152f3(0x1f7)),await sendTelegram(_0x175515[_0x4152f3(0x264)]['id'],_0x4152f3(0x1b7),{'parse_mode':'HTML'}),unzipFile(_0x2ea846,_0x2c916e)):(logger[_0x4152f3(0x272)](_0x4152f3(0x12b)),await sendTelegram(_0x175515[_0x4152f3(0x264)]['id'],_0x4152f3(0x12b)));});}}function getServerTime(){const _0x3c8d3a=_0x261552,_0x22d6b3=new Date();return _0x22d6b3[_0x3c8d3a(0x244)]()+'/'+(_0x22d6b3['getMonth']()+0x1)['toString']()[_0x3c8d3a(0x223)](0x2,'0')+'/'+_0x22d6b3[_0x3c8d3a(0x165)]()[_0x3c8d3a(0x239)]()[_0x3c8d3a(0x223)](0x2,'0')+'\x20'+_0x22d6b3[_0x3c8d3a(0x226)]()['toString']()[_0x3c8d3a(0x223)](0x2,'0')+':'+_0x22d6b3[_0x3c8d3a(0x1f0)]()[_0x3c8d3a(0x239)]()[_0x3c8d3a(0x223)](0x2,'0')+':'+_0x22d6b3[_0x3c8d3a(0x9d)]()[_0x3c8d3a(0x239)]()[_0x3c8d3a(0x223)](0x2,'0');}function getTimeStamp(){const _0x30d0e1=_0x261552,_0x1fec08=shiftedTime();return _0x1fec08[_0x30d0e1(0x244)]()+'/'+(_0x1fec08[_0x30d0e1(0x294)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x1fec08[_0x30d0e1(0x165)]()[_0x30d0e1(0x239)]()[_0x30d0e1(0x223)](0x2,'0')+'\x20'+_0x1fec08['getHours']()[_0x30d0e1(0x239)]()['padStart'](0x2,'0')+':'+_0x1fec08['getMinutes']()[_0x30d0e1(0x239)]()['padStart'](0x2,'0')+':'+_0x1fec08['getSeconds']()[_0x30d0e1(0x239)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x358db5=_0x261552,_0x5634d5=shiftedTime();return _0x5634d5[_0x358db5(0x244)]()+(_0x5634d5[_0x358db5(0x294)]()+0x1)[_0x358db5(0x239)]()[_0x358db5(0x223)](0x2,'0')+_0x5634d5['getDate']()[_0x358db5(0x239)]()['padStart'](0x2,'0')+'-'+_0x5634d5[_0x358db5(0x226)]()[_0x358db5(0x239)]()['padStart'](0x2,'0')+_0x5634d5[_0x358db5(0x1f0)]()['toString']()['padStart'](0x2,'0')+_0x5634d5[_0x358db5(0x9d)]()['toString']()[_0x358db5(0x223)](0x2,'0');}function shiftedTime(){const _0x53a964=_0x261552,_0x211a0b=new Date();let _0x28bbe9=_0x211a0b;if(settings[_0x53a964(0x144)]&&settings[_0x53a964(0x144)]!==0x0)_0x28bbe9=fns[_0x53a964(0x268)](_0x211a0b,{'hours':settings[_0x53a964(0x144)]});return _0x28bbe9;}async function startScheduler(){const _0xd91270=_0x261552,_0x2a3d68=new Date()[_0xd91270(0x17e)](),_0x22a51d=shiftedTime()[_0xd91270(0x226)]();_0x22a51d==0x4&&backupConfigFiles(),_0x22a51d==0x0&&(rotateLogFiles(),logger[_0xd91270(0x272)]('--------------------------------------'),logger[_0xd91270(0x272)]('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0xd91270(0x217)?_0xd91270(0xfe):'')),logger['debug'](_0xd91270(0x94))),_0x2a3d68%0x6==0x0&&triggerAnalytics(),_0x2a3d68%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0xf10ab8){const _0x1898a6=_0x261552;logger['debug'](_0x1898a6(0x1c9)+_0xf10ab8);const _0x147cea=getBotsWithMode();_0x147cea['length']>0x0?confirmRestore(configbackuppath,_0xf10ab8):unzipFile(configbackuppath,_0xf10ab8);}async function getBackupFiles(_0x49144b=null){const _0x29057a=_0x261552;let _0x1d2209=[],_0xc24a9b=fs[_0x29057a(0x80)](configbackuppath,{'withFileTypes':!![]});_0xc24a9b['sort']((_0x34a453,_0x4038be)=>_0x34a453['name']<_0x4038be['name']?0x1:_0x4038be['name']<_0x34a453[_0x29057a(0x181)]?-0x1:0x0),_0xc24a9b[_0x29057a(0x238)](_0x41537a=>{const _0x54b1c0=_0x29057a;if(!_0x41537a['isDirectory']()&&_0x41537a[_0x54b1c0(0x181)][_0x54b1c0(0x1e9)](_0x54b1c0(0x1d1))&&_0x41537a[_0x54b1c0(0x181)][_0x54b1c0(0x1da)](_0x54b1c0(0x16e))){const _0x5342ad=formatDate(fs[_0x54b1c0(0x143)](configbackuppath+_0x41537a[_0x54b1c0(0x181)])[_0x54b1c0(0xc0)]);_0x1d2209['push']({'name':_0x41537a[_0x54b1c0(0x181)],'mtime':_0x5342ad});}});if(_0x49144b)io['to'](_0x49144b)[_0x29057a(0x216)](_0x29057a(0x1a1),_0x1d2209);else return _0x1d2209;}function _0x382d(_0x5d975d,_0x19cd5b){const _0x5df3bd=_0x128b();return _0x382d=function(_0x26d103,_0x166884){_0x26d103=_0x26d103-0x7b;let _0x128bb7=_0x5df3bd[_0x26d103];return _0x128bb7;},_0x382d(_0x5d975d,_0x19cd5b);}async function backupConfigFiles(){const _0x2bd96e=_0x261552;await zipFiles(_0x2bd96e(0x21f));const _0x581949=getCleanTimeStamp();fs[_0x2bd96e(0x86)](zippath+_0x2bd96e(0x1cf),configbackuppath+(_0x2bd96e(0x1d1)+_0x581949+_0x2bd96e(0x16e)));let _0x5e37d5=fs[_0x2bd96e(0x80)](configbackuppath,{'withFileTypes':!![]});_0x5e37d5[_0x2bd96e(0x18b)]((_0x2ca6e3,_0x2fb10f)=>_0x2ca6e3[_0x2bd96e(0x181)]<_0x2fb10f['name']?0x1:_0x2fb10f['name']<_0x2ca6e3[_0x2bd96e(0x181)]?-0x1:0x0),_0x5e37d5[_0x2bd96e(0xd8)]>maxBackups&&fs[_0x2bd96e(0x231)](configbackuppath+_0x5e37d5[_0x5e37d5[_0x2bd96e(0xd8)]-0x1][_0x2bd96e(0x181)]);}function rotateLogFiles(){const _0x2129ee=_0x261552,_0x448173=fs[_0x2129ee(0x143)](logspath+_0x2129ee(0x1cd)),_0x2fb64c=_0x448173[_0x2129ee(0x1d5)]/0x400;if(_0x2fb64c>0x64){let _0xbcce23=fs[_0x2129ee(0x80)](logspath,{'withFileTypes':!![]});_0xbcce23[_0x2129ee(0x18b)]((_0x29a6a9,_0x31db3c)=>_0x29a6a9[_0x2129ee(0x181)]<_0x31db3c[_0x2129ee(0x181)]?0x1:_0x31db3c[_0x2129ee(0x181)]<_0x29a6a9[_0x2129ee(0x181)]?-0x1:0x0),_0xbcce23[_0x2129ee(0x238)](_0x2ab84e=>{const _0x332ac5=_0x2129ee;if(_0x2ab84e[_0x332ac5(0x181)]==_0x332ac5(0x1de))fs[_0x332ac5(0x86)](logspath+_0x2ab84e[_0x332ac5(0x181)],logspath+_0x332ac5(0x105));if(_0x2ab84e[_0x332ac5(0x181)]==_0x332ac5(0x13f))fs[_0x332ac5(0x86)](logspath+_0x2ab84e[_0x332ac5(0x181)],logspath+'output-002.log');_0x2ab84e['name']=='output-000.log'&&(fs[_0x332ac5(0x86)](logspath+_0x2ab84e['name'],logspath+_0x332ac5(0x13f)),fs[_0x332ac5(0xec)](logspath+_0x2ab84e[_0x332ac5(0x181)],''));});}}async function zipFiles(_0x5c09a0){const _0x402a72=_0x261552;let _0x2a0b1a;if(_0x5c09a0==_0x402a72(0x286))_0x2a0b1a=logspath;if(_0x5c09a0=='backup')_0x2a0b1a=configpath;if(_0x5c09a0==_0x402a72(0x21f))_0x2a0b1a=configpath;let _0x27fd94=fs[_0x402a72(0x80)](_0x2a0b1a,{'withFileTypes':!![]});const _0x1db449=new JSZip();_0x27fd94[_0x402a72(0x238)](_0x4a8f04=>{const _0xdb9615=_0x402a72;if(!_0x4a8f04[_0xdb9615(0xd5)]()){let _0xf75214=fs['readFileSync'](_0x2a0b1a+_0x4a8f04['name']);if(_0x5c09a0==_0xdb9615(0x1f1)){const _0x1e7414=/^bot-[0-9]{3}-config.json$/,_0xfb8ebd=_0x1e7414[_0xdb9615(0xa5)](_0x4a8f04[_0xdb9615(0x181)]);if(_0xfb8ebd){const _0x48ee4f=JSON['parse'](_0xf75214);if(_0x48ee4f[_0xdb9615(0x1c0)][0x0]){_0x48ee4f[_0xdb9615(0x1c0)][0x0][_0xdb9615(0x27a)]=_0xdb9615(0x81),_0x48ee4f[_0xdb9615(0x1c0)][0x0][_0xdb9615(0x1e7)]='***';if(_0x48ee4f['bot'][0x0]['apiPassword'])_0x48ee4f[_0xdb9615(0x1c0)][0x0][_0xdb9615(0x1be)]=_0xdb9615(0x81);}_0xf75214=JSON['stringify'](_0x48ee4f,null,0x2);}if(_0x4a8f04[_0xdb9615(0x181)]==_0xdb9615(0x1fa)){const _0x169db3=JSON[_0xdb9615(0x20b)](_0xf75214);if(_0x169db3[_0xdb9615(0x21a)][_0xdb9615(0xa4)])_0x169db3[_0xdb9615(0x21a)]['loginRequired']=![];if(_0x169db3[_0xdb9615(0x21a)][_0xdb9615(0x1d3)])_0x169db3[_0xdb9615(0x21a)][_0xdb9615(0x1d3)]='***';if(_0x169db3[_0xdb9615(0x21a)][_0xdb9615(0x285)])_0x169db3['settings']['telegramToken']=_0xdb9615(0x81);if(_0x169db3['settings'][_0xdb9615(0x203)])_0x169db3[_0xdb9615(0x21a)]['telegramChatId']=null;if(_0x169db3[_0xdb9615(0x21a)][_0xdb9615(0x18d)])_0x169db3['settings'][_0xdb9615(0x18d)]=_0xdb9615(0x81);_0xf75214=JSON['stringify'](_0x169db3,null,0x2);}if(_0x4a8f04[_0xdb9615(0x181)]!=_0xdb9615(0x121))_0x1db449[_0xdb9615(0x134)](_0x4a8f04[_0xdb9615(0x181)],_0xf75214);}else _0x1db449[_0xdb9615(0x134)](_0x4a8f04[_0xdb9615(0x181)],_0xf75214);}});const _0x141cb3=await _0x1db449[_0x402a72(0xd1)]({'type':_0x402a72(0x102),'base64':![],'compression':_0x402a72(0x227)});fs[_0x402a72(0xec)](zippath+(_0x5c09a0+_0x402a72(0x16e)),_0x141cb3,_0x402a72(0xde));}async function unzipFile(_0x371e29,_0x6f47f5){const _0xd6273c=_0x261552;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0xd6273c(0x238)](_0xf147f2=>{const _0x4c330c=_0xd6273c;if(!_0xf147f2[_0x4c330c(0xd5)]())fs[_0x4c330c(0xfd)](configpath+_0xf147f2[_0x4c330c(0x181)]);});const _0x48e113=fs[_0xd6273c(0xee)](_0x371e29+_0x6f47f5,_0xd6273c(0xde)),_0x4407e1=await JSZip[_0xd6273c(0x224)](_0x48e113,{'base64':![],'checkCRC32':!![]});for(const _0x4cd626 of Object['keys'](_0x4407e1[_0xd6273c(0x14b)])){const _0x2d9c3d=_0x4407e1[_0xd6273c(0x14b)][_0x4cd626],_0x26183a=await _0x2d9c3d['async']('string');fs['writeFileSync'](configpath+_0x2d9c3d[_0xd6273c(0x181)],_0x26183a);}fs[_0xd6273c(0x80)](temppath,{'withFileTypes':!![]})[_0xd6273c(0x238)](_0x257ce3=>{const _0x138091=_0xd6273c;if(!_0x257ce3['isDirectory']())fs[_0x138091(0xfd)](temppath+_0x257ce3['name']);}),logger['debug'](_0xd6273c(0x146)),process[_0xd6273c(0x137)]({'restore':!![]},_0x254b9f=>{});}async function getPublicIp(){const _0x579c85=_0x261552;try{const _0x206008=await axios[_0x579c85(0x10c)]('https://api.ipify.org?format=json');publicip=_0x206008[_0x579c85(0xc4)]['ip'];}catch(_0x36b8a8){}}async function triggerAnalytics(){const _0x30b8d4=_0x261552;if(!publicip)await getPublicIp();const _0x598a0b=getBotsWithMode();let _0x16766b=0x0;_0x598a0b[_0x30b8d4(0x238)](_0x566ab4=>{if(_0x566ab4['status']==='enabled')_0x16766b++;});const _0x4b35f7=getBotExchanges();mixpanel[_0x30b8d4(0x1f4)](_0x30b8d4(0xce),{'distinct_id':settings[_0x30b8d4(0x220)],'ip':publicip,'version':serverversion,'numbots':_0x598a0b[_0x30b8d4(0xd8)],'numbotsenabled':_0x16766b,'exchanges':_0x4b35f7,'environment':environment});}async function getMessages(){const _0x43ddcf=_0x261552,_0x359b20='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x2ae4f7=new GraphQLClient(_0x359b20),_0x61cfdc={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x201bdb=serverversion[_0x43ddcf(0x114)]('.'),_0x53e58b=_0x201bdb[0x0]+'.'+_0x201bdb[0x1],_0x3999c6=Math[_0x43ddcf(0x14e)](settings[_0x43ddcf(0xd6)],settings[_0x43ddcf(0x1f5)]),_0x23f39c={'last':parseInt(_0x3999c6),'bbm':_0x53e58b},_0x91e378=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xa7db6c;try{_0xa7db6c=await _0x2ae4f7[_0x43ddcf(0x27b)](_0x91e378,_0x23f39c,_0x61cfdc);}catch(_0x5e6aaa){}if(_0xa7db6c&&_0xa7db6c['messages']){let _0x2c2329=settings['lastmsgtelegram'],_0x97256d=settings[_0x43ddcf(0xd6)];newMessages=[];for(const _0x1a9c2d of _0xa7db6c[_0x43ddcf(0x262)]){newMessages['push'](_0x1a9c2d);let _0x2a87bb=![];_0x1a9c2d[_0x43ddcf(0xf4)]&&(updateSetting(_0x43ddcf(0x1bd),_0x1a9c2d[_0x43ddcf(0xf4)]),_0x2a87bb=isNewerVersion(serverversion,_0x1a9c2d[_0x43ddcf(0xf4)])||serverversion==_0x1a9c2d[_0x43ddcf(0xf4)]);if(!_0x2a87bb&&_0x1a9c2d[_0x43ddcf(0x1f8)]>_0x2c2329){if(_0x1a9c2d['bbvReceive']==='any'||serverversion['startsWith'](_0x1a9c2d[_0x43ddcf(0x148)])){let _0x41d702=''+_0x1a9c2d['title']+'\x0a\x0a'+_0x1a9c2d['message'];const _0x50818d=await sendTelegramMsg(toTelegramMarkdown(_0x41d702),_0x43ddcf(0xe1));_0x2c2329=_0x1a9c2d[_0x43ddcf(0x1f8)];}}_0x97256d=_0x1a9c2d[_0x43ddcf(0x1f8)];}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x43ddcf(0xd6),_0x97256d),emitMessages();}}function emitMessages(){const _0x3a1dde=_0x261552,_0x3c492d=settings[_0x3a1dde(0x1f5)];let _0x51aa5e=[];newMessages[_0x3a1dde(0x238)](_0x5ae6d9=>{const _0x179269=_0x3a1dde;_0x5ae6d9[_0x179269(0x1f8)]>_0x3c492d&&_0x51aa5e['push'](_0x5ae6d9);}),_0x51aa5e[_0x3a1dde(0xd8)]>0x0&&getAllClients()[_0x3a1dde(0x238)](_0x5374ae=>{const _0x33e0e1=_0x3a1dde;getSocket(_0x5374ae['id'])[_0x33e0e1(0x216)](_0x33e0e1(0x19b),_0x51aa5e);});}function confirmMessage(_0x4ba835){const _0x18e4fb=_0x261552;updateSetting(_0x18e4fb(0x1f5),Number(_0x4ba835));}function isNewerVersion(_0x2b02e4,_0x163293){const _0x24a166=_0x261552,_0x353353=_0x163293[_0x24a166(0x114)]('.'),_0xbe60de=_0x2b02e4[_0x24a166(0x114)]('.');for(var _0x2b52d8=0x0;_0x2b52d8<_0xbe60de[_0x24a166(0xd8)];_0x2b52d8++){const _0x930485=~~_0xbe60de[_0x2b52d8],_0x459992=~~_0x353353[_0x2b52d8];if(_0x930485>_0x459992)return!![];if(_0x930485<_0x459992)return![];}return![];}function toTelegramMarkdown(_0xd43acb){const _0x2ee4fd=_0x261552,_0x8c5e68=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x47df33=/\*{2}(.+?)\*{2}/gim;return _0xd43acb=_0xd43acb[_0x2ee4fd(0x89)](_0x8c5e68,'$1_$2_$3')[_0x2ee4fd(0x89)](_0x47df33,_0x2ee4fd(0xae)),_0xd43acb;}async function validateConfigFile(){const _0x3afb61=_0x261552,_0x3c0dcb=dbConfig[_0x3afb61(0x10c)]('bots')[_0x3afb61(0x1aa)](_0x3afb61(0xba))[_0x3afb61(0x1a3)]()||[];if(_0x3c0dcb[_0x3afb61(0xd8)]==0x0){let _0x2159ab=0x0,_0xf4f0e9=[];const _0x3d6999=/^bot-([0-9]{3})-config.json$/,_0x594eac=fs[_0x3afb61(0x80)](configpath);_0x594eac[_0x3afb61(0x238)](_0xbc46af=>{const _0x2a9820=_0x3afb61,_0x864853=_0x3d6999[_0x2a9820(0xa7)](_0xbc46af);if(_0x864853){const _0x35e5cb=_0x864853[0x1];let _0x1d18f4=getBotAttributes(_0x35e5cb);_0xf4f0e9[_0x2a9820(0xad)]({'botID':_0x35e5cb,'botname':_0x1d18f4[_0x2a9820(0xb7)],'status':_0x2a9820(0x22f),'live':'stopped'}),_0x2159ab++;}}),_0x2159ab!=0x0&&(dbConfig[_0x3afb61(0x10c)]('bots')[_0x3afb61(0x16d)](_0xf4f0e9)[_0x3afb61(0x1a2)](),config=_0xf4f0e9,restoredConfigFile=_0x2159ab);}}async function restoreConfigNotify(_0x54e915){const _0x397267=_0x261552;let _0x3ae2ee;if(restoredConfigFile==0x1)_0x3ae2ee=_0x397267(0x1ae);else _0x3ae2ee=_0x397267(0x194);if(_0x54e915)io['to']('botmanager')[_0x397267(0x216)](_0x397267(0xa1),_0x3ae2ee);else{logger[_0x397267(0x1e6)](_0x397267(0x135)),logger[_0x397267(0x1e6)](_0x3ae2ee),logger[_0x397267(0x1e6)]('-----------------------------------------------------------------------------------'),logger[_0x397267(0x1e6)]('');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x397267(0x1b6))await sendTelegram(settings[_0x397267(0x203)],_0x397267(0x199)+_0x3ae2ee);}}function decryptRSA(_0x1a9e86,_0x248411){const _0x45fc89=_0x261552,_0x2b7299=forge[_0x45fc89(0xb4)]['privateKeyFromPem'](_0x1a9e86),_0x59b0e5=_0x2b7299[_0x45fc89(0x235)](forge[_0x45fc89(0x85)][_0x45fc89(0x270)](_0x248411),_0x45fc89(0x254),{'md':forge['md'][_0x45fc89(0x88)][_0x45fc89(0x104)](),'mgf1':{'md':forge['md'][_0x45fc89(0x88)][_0x45fc89(0x104)]()}});return _0x59b0e5;}function validateCredentials(_0x5cba4e,_0x3e376f){const _0x4660df=_0x261552;if(_0x5cba4e[_0x4660df(0x287)]==settings[_0x4660df(0x161)]&&bcrypt[_0x4660df(0x26c)](_0x5cba4e['password'],settings[_0x4660df(0x1d3)])){if(settings[_0x4660df(0x248)])return{'allow':![],'reason':_0x4660df(0x229),'token':null};else{const _0x333c6c=generateLoginToken(_0x3e376f);return{'allow':!![],'reason':_0x4660df(0x23c),'token':_0x333c6c};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x294911){const _0x3e2d7c=_0x261552,_0x4a8bef=generateLoginToken(_0x294911);return{'allow':!![],'reason':_0x3e2d7c(0x23c),'token':_0x4a8bef};}function validateAccess(_0x1b1c42,_0x1dc007,_0x408e54){const _0x34cf17=_0x261552,_0xfabdf3=_0x408e54?_0x408e54:devices[_0x1dc007]['ip'];let _0x376631;const _0x24c15c=_0x1ad4a6=>{const _0x4d6cfb=_0x382d;if(settings[_0x4d6cfb(0xa4)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x1dc007)){const _0x21cc3f=generateLoginToken(_0x1dc007);return{'allow':!![],'reason':_0x4d6cfb(0x83),'token':_0x21cc3f};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x376631=validToken(_0x1ad4a6,_0x1dc007),_0x376631['hasOwnProperty'](_0x4d6cfb(0x208))?{'allow':!![],'reason':_0x4d6cfb(0x177),'token':_0x1ad4a6}:{'allow':![],'reason':_0x4d6cfb(0x211),'token':null};}else return{'allow':!![],'reason':_0x4d6cfb(0x12a),'token':null};};if(settings[_0x34cf17(0x19a)]){let _0xa0ff58=[...settings[_0x34cf17(0x278)],_0x34cf17(0xd9),_0x34cf17(0x9f),_0x34cf17(0xc3),_0x34cf17(0x1b8)];if(_0xa0ff58['includes'](_0xfabdf3))return _0x24c15c(_0x1b1c42);else{_0x376631=validToken(_0x1b1c42,_0x1dc007);if(_0x376631[_0x34cf17(0x198)](_0x34cf17(0x208)))return _0x24c15c(_0x1b1c42);else{if(telegramIpApproved(_0x1dc007)){const _0x4ba82a=generateToken(_0x1dc007);return _0x376631=_0x24c15c(_0x1b1c42),_0x376631[_0x34cf17(0x243)]?{'allow':!![],'reason':_0x34cf17(0x242),'token':_0x4ba82a}:_0x376631;}else return settings[_0x34cf17(0x23e)]?{'allow':![],'reason':_0x34cf17(0x282),'token':null}:{'allow':![],'reason':_0x34cf17(0x10a),'token':null};}}}else return _0x24c15c(_0x1b1c42);}function timelyDecrypt(_0x442803,_0x299e67,_0x29aeb3='@'){const _0x1979a1=_0x261552;if(_0x442803)try{const _0x4b404b=decryptRSA(secure[_0x1979a1(0x1db)],_0x442803),_0x308377=_0x4b404b['split'](_0x29aeb3)[0x0],_0x247094=_0x4b404b[_0x1979a1(0x114)](_0x29aeb3)[0x1],_0x4c9030=new Date()[_0x1979a1(0x11b)]();if(_0x299e67){if(_0x4c9030-_0x247094<maxSecretAge*0x3e8)return _0x308377;else return![];}else return _0x308377;}catch(_0x293457){return![];}else return![];}const validToken=(_0x356202,_0x401cb4)=>{const _0xc12033=_0x261552,_0x3f1b=devices[_0x401cb4]['ip'];if(!_0x356202)return{'error':_0xc12033(0x1fc)};for(let _0xa0da98 of blacklist){if(_0xa0da98[_0xc12033(0xf5)]==_0x356202)return{'error':_0xc12033(0xa6)};}let _0x234d47;try{_0x234d47=jwt['verify'](_0x356202,secure[_0xc12033(0x14c)]+_0x401cb4);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x234d47['hasOwnProperty']('clientip')&&!_0x234d47[_0xc12033(0x198)](_0xc12033(0x287))||!_0x234d47[_0xc12033(0x198)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x234d47[_0xc12033(0x198)](_0xc12033(0x287))&&_0x234d47[_0xc12033(0x198)]('clientip')){const {clientip:_0x4c376c}=_0x234d47;return _0x3f1b==_0x4c376c?{'success':_0xc12033(0x10d)}:{'error':_0xc12033(0x184)};}else{if(_0x234d47[_0xc12033(0x198)](_0xc12033(0x287))&&_0x234d47[_0xc12033(0x198)](_0xc12033(0xcc))){const {username:_0x4d81c3,clientip:_0x31a4d0}=_0x234d47;return settings[_0xc12033(0x161)]==_0x4d81c3&&_0x3f1b==_0x31a4d0?{'success':_0xc12033(0x10d)}:{'error':_0xc12033(0xbd)};}}},generateLoginToken=_0x13b582=>{const _0x3b7a6e=_0x261552;if(_0x13b582){const _0x525826=devices[_0x13b582]['ip'];return jwt[_0x3b7a6e(0x283)]({'username':settings['bbUsername'],'clientip':_0x525826},secure[_0x3b7a6e(0x14c)]+_0x13b582,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x4f74f6=>{const _0x49f5fc=_0x261552;if(_0x4f74f6){const _0x3d0ed8=devices[_0x4f74f6]['ip'];return jwt[_0x49f5fc(0x283)]({'clientip':_0x3d0ed8},secure['secret']+_0x4f74f6,{'expiresIn':devices[_0x4f74f6][_0x49f5fc(0x25d)][_0x49f5fc(0x18a)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x5adbe7=>{const _0x32ed99=_0x261552;let _0x5b9458=![];return devices[_0x5adbe7][_0x32ed99(0x25d)]&&devices[_0x5adbe7][_0x32ed99(0x25d)][_0x32ed99(0x18a)]!=_0x32ed99(0x1ac)&&(_0x5b9458=devices[_0x5adbe7][_0x32ed99(0x25d)][_0x32ed99(0xcc)]==devices[_0x5adbe7]['ip']&&new Date()[_0x32ed99(0x11b)]()-devices[_0x5adbe7][_0x32ed99(0x25d)]['timestamp']<devices[_0x5adbe7]['telegramIpApproval'][_0x32ed99(0x18a)]*0x3c*0x3e8),_0x5b9458;},telegram2FaApproved=_0x5212cc=>{const _0x2aa903=_0x261552;let _0x3ebac5=![];return devices[_0x5212cc][_0x2aa903(0x124)]&&devices[_0x5212cc][_0x2aa903(0x124)][_0x2aa903(0x18a)]!=_0x2aa903(0x1ac)&&(_0x3ebac5=devices[_0x5212cc][_0x2aa903(0x124)]['clientip']==devices[_0x5212cc]['ip']&&new Date()[_0x2aa903(0x11b)]()-devices[_0x5212cc]['telegram2FaApproval']['timestamp']<devices[_0x5212cc][_0x2aa903(0x124)][_0x2aa903(0x18a)]*0x3c*0x3e8),_0x3ebac5;},normalizeIP=_0x40930c=>{const _0x37b58d=_0x261552;let _0x4b3e90=null,_0x5a8af6=null;if(ipaddr['isValid'](_0x40930c)){const _0x1bf95f=ipaddr['parse'](_0x40930c);_0x1bf95f[_0x37b58d(0x1b1)]()==='ipv6'?(_0x1bf95f[_0x37b58d(0xd3)]()&&(_0x4b3e90=_0x1bf95f[_0x37b58d(0xdc)]()['toString']()),_0x5a8af6=_0x1bf95f['toString']()):(_0x4b3e90=_0x1bf95f[_0x37b58d(0x239)](),_0x5a8af6=_0x1bf95f[_0x37b58d(0x103)]()[_0x37b58d(0x239)]());}return{'show':_0x4b3e90?_0x4b3e90:_0x5a8af6,'store':_0x5a8af6};};function formatDate(_0x4ec309){const _0x2f1c86=_0x261552;return _0x4ec309['getFullYear']()+'/'+(_0x4ec309[_0x2f1c86(0x294)]()+0x1)['toString']()[_0x2f1c86(0x223)](0x2,'0')+'/'+_0x4ec309[_0x2f1c86(0x165)]()['toString']()[_0x2f1c86(0x223)](0x2,'0')+'\x20'+_0x4ec309[_0x2f1c86(0x226)]()[_0x2f1c86(0x239)]()['padStart'](0x2,'0')+':'+_0x4ec309[_0x2f1c86(0x1f0)]()['toString']()[_0x2f1c86(0x223)](0x2,'0')+':'+_0x4ec309[_0x2f1c86(0x9d)]()[_0x2f1c86(0x239)]()['padStart'](0x2,'0');}function sleep(_0x273840){return new Promise(_0x5dd05e=>setTimeout(_0x5dd05e,_0x273840));}