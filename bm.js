const _0x332cff=_0x556d;(function(_0x22b458,_0x549d87){const _0x4612a7=_0x556d,_0x1dafcb=_0x22b458();while(!![]){try{const _0x391a86=parseInt(_0x4612a7(0x1a8))/0x1+parseInt(_0x4612a7(0x16c))/0x2+-parseInt(_0x4612a7(0x159))/0x3+-parseInt(_0x4612a7(0x1a7))/0x4*(-parseInt(_0x4612a7(0x197))/0x5)+parseInt(_0x4612a7(0x2de))/0x6+-parseInt(_0x4612a7(0x1bc))/0x7*(parseInt(_0x4612a7(0x27f))/0x8)+-parseInt(_0x4612a7(0x114))/0x9*(-parseInt(_0x4612a7(0x193))/0xa);if(_0x391a86===_0x549d87)break;else _0x1dafcb['push'](_0x1dafcb['shift']());}catch(_0x2f5b51){_0x1dafcb['push'](_0x1dafcb['shift']());}}}(_0x3f5a,0xc7704));const _0x37dbcd=function(){let _0x3a6c91=!![];return function(_0x363f5c,_0x2b5f78){const _0x4a6b55=_0x3a6c91?function(){const _0x2d8e93=_0x556d;if(_0x2b5f78){const _0x2d7dca=_0x2b5f78[_0x2d8e93(0x210)](_0x363f5c,arguments);return _0x2b5f78=null,_0x2d7dca;}}:function(){};return _0x3a6c91=![],_0x4a6b55;};}(),_0x44a4ad=_0x37dbcd(this,function(){const _0xfc8350=_0x556d;return _0x44a4ad[_0xfc8350(0x23f)]()[_0xfc8350(0x1ef)](_0xfc8350(0x29e))[_0xfc8350(0x23f)]()[_0xfc8350(0x10a)](_0x44a4ad)[_0xfc8350(0x1ef)](_0xfc8350(0x29e));});_0x44a4ad();'use strict';process[_0x332cff(0x19f)][_0x332cff(0x2a0)]=0x1;const childProcess=require(_0x332cff(0x2b0)),fs=require('fs'),fns=require(_0x332cff(0x18c)),low=require(_0x332cff(0x29f)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x332cff(0x130)),crypto=require(_0x332cff(0x1fa)),forge=require(_0x332cff(0x1b9)),bcrypt=require(_0x332cff(0x166)),jwt=require(_0x332cff(0x146)),ipaddr=require(_0x332cff(0x16d)),yargs=require('yargs'),uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x332cff(0x173)),Mixpanel=require(_0x332cff(0x24b)),axios=require(_0x332cff(0x233)),{GraphQLClient,gql}=require(_0x332cff(0x2df)),util=require(_0x332cff(0x2a8)),fileUpload=require(_0x332cff(0x2b3)),{networkInterfaces}=require('os'),JSZip=require(_0x332cff(0x161)),argv=yargs(process[_0x332cff(0xdc)][_0x332cff(0x1c8)](0x2))[_0x332cff(0xdc)],PORT=argv[_0x332cff(0x1d1)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x332cff(0x133)](PORT)&&(console[_0x332cff(0x27a)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0x332cff(0x2af)]||null,userID=argv[_0x332cff(0x25e)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process[_0x332cff(0x2a6)]['node'];let bbpath='bb/',bbpath2='';const botfile=_0x332cff(0xd7),configfile=_0x332cff(0x1cb),settingsfile=_0x332cff(0xe7),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x332cff(0x184))[_0x332cff(0x10d)]||_0x332cff(0x1ae),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x332cff(0x268)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x332cff(0x1b1)),configpath=userID?bbpath+_0x332cff(0x27e)+userID+'/':bbpath+_0x332cff(0x27e),configbackuppath=configpath+_0x332cff(0x24e),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x332cff(0x229),zippath=userID?bbpath+_0x332cff(0x1b0)+userID+'/':bbpath+_0x332cff(0x1b0),loggerfile=fs[_0x332cff(0x2d9)](logspath+_0x332cff(0x105),{'flags':'a'}),temppath=userID?bbpath+_0x332cff(0x222)+userID+'/':bbpath+'temp/';!fs[_0x332cff(0x268)](configpath)&&fs[_0x332cff(0x160)](configpath);!fs[_0x332cff(0x268)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x332cff(0x268)](logspath)&&fs[_0x332cff(0x160)](logspath);!fs[_0x332cff(0x268)](zippath)&&fs[_0x332cff(0x160)](zippath);!fs['existsSync'](temppath)&&fs[_0x332cff(0x160)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x332cff(0x2be)]({'bots':[]})[_0x332cff(0x167)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x332cff(0x2be)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x332cff(0x2c6),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x332cff(0x167)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x332cff(0x151)](_0x332cff(0x263),{'host':_0x332cff(0x11b)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x332cff(0x1f4)]&&(settings[_0x332cff(0x1f4)]!=''&&settings[_0x332cff(0x1f4)]!=_0x332cff(0xe5))&&settings[_0x332cff(0x28f)]&&settings[_0x332cff(0x28f)]!='')initTelegram();const parseColor=(_0x5cec4b,_0x2f821)=>{const _0x541713=_0x332cff,_0x5451ee=/#[A-Z]{3}#/g;if(typeof _0x5cec4b==_0x541713(0x2c4)){!_0x2f821?_0x5cec4b=_0x5cec4b[_0x541713(0x1c5)](_0x5451ee,''):(_0x5cec4b=_0x5cec4b['replace'](/#BLU#/g,'\x1b[34m'),_0x5cec4b=_0x5cec4b['replace'](/#RED#/g,'\x1b[31m'),_0x5cec4b=_0x5cec4b[_0x541713(0x1c5)](/#YEL#/g,_0x541713(0x211)),_0x5cec4b=_0x5cec4b[_0x541713(0x1c5)](/#MAG#/g,_0x541713(0x2b2)),_0x5cec4b=_0x5cec4b[_0x541713(0x1c5)](/#CYA#/g,_0x541713(0x24c)),_0x5cec4b=_0x5cec4b[_0x541713(0x1c5)](/#RES#/g,'\x1b[0m'));;}return _0x5cec4b;},logger={'screen':_0x550a8b=>{console['log'](parseColor(_0x550a8b,!![]));},'simple':_0x3992bd=>{const _0x3e36ed=_0x332cff;console[_0x3e36ed(0x27a)](parseColor(_0x3992bd,!![])),loggerfile[_0x3e36ed(0x167)](util[_0x3e36ed(0x1e3)](parseColor(_0x3992bd,![]))+'\x0a');},'full':async _0x1682d5=>{const _0x2491a5=_0x332cff,_0xf5b9a=getTimeStamp()+_0x2491a5(0xe3)+_0x1682d5;console[_0x2491a5(0x27a)](parseColor(_0xf5b9a,!![])),loggerfile[_0x2491a5(0x167)](util[_0x2491a5(0x1e3)](parseColor(_0xf5b9a,![]))+'\x0a');if(tgBot&&settings[_0x2491a5(0x188)]&&settings['telegramEvents']!=_0x2491a5(0x129))await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+parseColor(_0x1682d5,![]));},'debug':async(_0x55ebea,_0x28b10a='')=>{const _0x543f6f=_0x332cff,_0x4711ae=getTimeStamp()+_0x543f6f(0x2d5)+_0x55ebea;if(debugging)console[_0x543f6f(0x27a)](parseColor(_0x4711ae,!![]));loggerfile[_0x543f6f(0x167)](util[_0x543f6f(0x1e3)](parseColor(_0x4711ae,![]))+'\x0a');if(_0x28b10a){if(debugging)console[_0x543f6f(0x27a)](_0x28b10a);loggerfile[_0x543f6f(0x167)](util[_0x543f6f(0x1e3)](_0x28b10a)+'\x0a');}}};let terminating=![];process['on'](_0x332cff(0xdf),function(_0x3c9332){const _0x366b8f=_0x332cff;_0x3c9332[_0x366b8f(0x23f)]()['includes'](_0x366b8f(0x203))?(logger[_0x366b8f(0x16f)](_0x366b8f(0xef)+_0x3c9332[_0x366b8f(0x1d1)]+'#RES#'),process[_0x366b8f(0x23c)]({'terminate':!![]},_0x325921=>{})):logger[_0x366b8f(0x16f)](_0x3c9332);}),process['on'](_0x332cff(0x1d4),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x332cff(0x2a7),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x332cff(0x259),()=>{const _0x187e0e=_0x332cff;stopAllBots(),process[_0x187e0e(0x1d4)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x332cff(0x1fc)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x332cff(0x190))[_0x332cff(0x14e)](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get'](_0x332cff(0x1aa),async(_0x1ac853,_0x27ff49)=>{const _0x1f0a88=_0x332cff,_0x169199=_0x1ac853[_0x1f0a88(0x2d6)][_0x1f0a88(0x2db)],_0x1a3b86=getClientsWithBotID(_0x1f0a88(0x2b5)),_0x143415=_0x1ac853[_0x1f0a88(0xfd)][_0x1f0a88(0x215)],_0xf9a7f0=timelyDecrypt(_0x143415,![]),_0x2e6d5d=_0x1a3b86[_0x1f0a88(0x124)](_0x156f3b=>_0x156f3b['uuid']==_0xf9a7f0);if(_0x2e6d5d){const _0x1ab293=normalizeIP(_0x1ac853['socket'][_0x1f0a88(0x261)])[_0x1f0a88(0x2a9)],_0x149bfa=_0x1ac853[_0x1f0a88(0xfd)]['tkn'];if(validateAccess(_0x149bfa,_0xf9a7f0,_0x1ab293)[_0x1f0a88(0x28e)])_0x169199==_0x1f0a88(0x11a)&&await backupConfigFiles(),await zipFiles(_0x169199),_0x27ff49['download'](zippath+(_0x169199+_0x1f0a88(0x186)),_0x2a4e71=>{const _0x199b2d=_0x1f0a88;_0x2a4e71&&(logger['full'](_0x199b2d(0x28d)+_0x169199),logger[_0x199b2d(0x16f)](_0x2a4e71));});else logger[_0x1f0a88(0x291)](_0x1f0a88(0x175)+_0x169199+_0x1f0a88(0x143));}else logger[_0x1f0a88(0x291)](_0x1f0a88(0x175)+_0x169199+_0x1f0a88(0x253));}),app[_0x332cff(0x1f2)](_0x332cff(0x10f),async(_0x1326ac,_0x431c90)=>{const _0x23ae27=_0x332cff,_0x380e3b=getClientsWithBotID(_0x23ae27(0x2b5)),_0x19b8f2=_0x1326ac['headers'][_0x23ae27(0x215)],_0x3d5612=timelyDecrypt(_0x19b8f2,![]),_0xde7d6a=_0x380e3b[_0x23ae27(0x124)](_0x3ddc4b=>_0x3ddc4b[_0x23ae27(0x215)]==_0x3d5612);logger[_0x23ae27(0x1f7)](_0x23ae27(0x15d));if(_0xde7d6a){const _0x398546=normalizeIP(_0x1326ac[_0x23ae27(0x1ca)]['remoteAddress'])['store'],_0xe1fd3c=_0x1326ac[_0x23ae27(0xfd)][_0x23ae27(0x12d)];if(validateAccess(_0xe1fd3c,_0x3d5612,_0x398546)[_0x23ae27(0x28e)]){if(_0x1326ac['files']){const _0x20e743=_0x1326ac[_0x23ae27(0x1f5)]['backupfile'];await _0x20e743['mv'](temppath+_0x20e743[_0x23ae27(0x179)]),_0x431c90[_0x23ae27(0x23c)]({'status':!![],'message':_0x23ae27(0x1df)});const _0x21552c=getBotsWithMode();_0x21552c[_0x23ae27(0x178)]>0x0?confirmRestore(temppath,_0x20e743['name']):unzipFile(temppath,_0x20e743[_0x23ae27(0x179)]);}}else logger[_0x23ae27(0x291)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x23ae27(0x291)](_0x23ae27(0x112));}),app['use'](express[_0x332cff(0x157)](path[_0x332cff(0xd0)](__dirname,bbpath2,'build2'))),app[_0x332cff(0x1db)](express[_0x332cff(0x157)](path['join'](__dirname,bbpath2,_0x332cff(0x26b)))),app[_0x332cff(0x1b3)]('/',function(_0x138db2,_0x2d8d7c){const _0x12b7f9=_0x332cff;_0x2d8d7c[_0x12b7f9(0x240)](path['join'](__dirname,bbpath2,_0x12b7f9(0x29b),_0x12b7f9(0x278)));}),app[_0x332cff(0x1b3)](_0x332cff(0xf6),function(_0x11bb1c,_0x3c2030){const _0x20ed13=_0x332cff;_0x3c2030[_0x20ed13(0x240)](path['join'](__dirname,bbpath2,_0x20ed13(0x26b),_0x20ed13(0x278)));}),app[_0x332cff(0x1b3)](_0x332cff(0x20f),(_0xd78a7f,_0x38e813)=>{const _0x46bdda=_0x332cff;_0x38e813[_0x46bdda(0x240)](path['join'](__dirname,bbpath2,_0x46bdda(0x26b),'index.html'));}),app[_0x332cff(0x1b3)](_0x332cff(0x14b),(_0xb405ab,_0x3b152a)=>{const _0x43bcae=_0x332cff;_0x3b152a[_0x43bcae(0x240)](path[_0x43bcae(0xd0)](__dirname,bbpath2,'build','index.html'));}),app[_0x332cff(0x1b3)](_0x332cff(0x12a),(_0xbc71f1,_0x58baae)=>{const _0xb8380f=_0x332cff;_0x58baae['sendFile'](path['join'](__dirname,bbpath2,_0xb8380f(0x26b),'index.html'));}),app[_0x332cff(0x1b3)](_0x332cff(0x174),(_0x2dd5f6,_0x5da460)=>{const _0x55d8c3=_0x332cff;_0x5da460[_0x55d8c3(0x240)](path[_0x55d8c3(0xd0)](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x332cff(0x17c),(_0x1432b3,_0x492519)=>{const _0x4bb4f7=_0x332cff;_0x492519['sendFile'](path['join'](__dirname,bbpath2,_0x4bb4f7(0x26b),'index.html'));}),app[_0x332cff(0x1b3)](_0x332cff(0x1a2),(_0x402e64,_0x37a05f)=>{const _0x26cf76=_0x332cff;_0x37a05f['sendFile'](path['join'](__dirname,bbpath2,_0x26cf76(0x26b),_0x26cf76(0x278)));});if(HOST)http[_0x332cff(0x11d)](PORT,HOST);else http[_0x332cff(0x11d)](PORT);const io=require(_0x332cff(0x1fe))(http,{});openBrowser&&(async()=>{const _0x547460=_0x332cff,{default:_0x18f95a}=await import('open');await _0x18f95a(_0x547460(0x202)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x149db9=_0x332cff;let _0x563349='[ip-address]';const _0x168694=networkInterfaces(),_0x143664={};for(const _0x18b8f1 of Object[_0x149db9(0x2dd)](_0x168694)){for(const _0x2e02b8 of _0x168694[_0x18b8f1]){if((_0x2e02b8[_0x149db9(0x28c)]==_0x149db9(0x198)||_0x2e02b8[_0x149db9(0x28c)]==0x4)&&!_0x2e02b8['internal']){const _0x57a4e0=ipaddr[_0x149db9(0x238)](_0x2e02b8[_0x149db9(0x232)])['range']();_0x57a4e0!=_0x149db9(0x252)&&(!_0x143664[_0x18b8f1]&&(_0x143664[_0x18b8f1]=[]),_0x143664[_0x18b8f1][_0x149db9(0x235)](_0x2e02b8[_0x149db9(0x232)]),_0x563349=_0x2e02b8[_0x149db9(0x232)]);}}}return{'serverip':_0x563349,'netinterfaces':_0x143664};}async function startServer(){const _0x2bfc05=_0x332cff,{serverip:_0x332b88,netinterfaces:_0x3ef3e8}=getServerIP();logger[_0x2bfc05(0x16f)](''),logger['simple']('-----------------------------------------------------------------------------------'),await logger[_0x2bfc05(0x291)](_0x2bfc05(0x212)+serverversion+'#RES#\x20'+(environment==_0x2bfc05(0x21d)?_0x2bfc05(0x295):'')+'\x0a'+(_0x2bfc05(0x1ea)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x2bfc05(0x20c)+_0x332b88+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x2bfc05(0x16f)](_0x2bfc05(0x242));if(config[_0x2bfc05(0x178)]!=0x0)for(const _0x34df0f of config){const _0x2131ab=_0x34df0f['mode']==_0x2bfc05(0x206)?'a':'m';if(_0x34df0f[_0x2bfc05(0x169)]==_0x2bfc05(0x168)||_0x34df0f[_0x2bfc05(0x169)]==_0x2bfc05(0x195))await logger['full'](_0x2bfc05(0x2a2)+_0x2131ab+_0x2bfc05(0x16a)+_0x34df0f[_0x2bfc05(0x23e)]+_0x2bfc05(0xff)+_0x34df0f[_0x2bfc05(0x237)]),startBot([_0x34df0f[_0x2bfc05(0x23e)],userID],{'cwd':bbpath},function(_0xb20ff8){if(_0xb20ff8)logger['full'](_0xb20ff8);});else(_0x34df0f[_0x2bfc05(0x169)]==_0x2bfc05(0x26c)||_0x34df0f['status']==_0x2bfc05(0x1c0))&&await logger[_0x2bfc05(0x291)](_0x2bfc05(0x1b4)+_0x2131ab+')\x20\x20\x20|\x20Bot\x20'+_0x34df0f['botID']+'\x20|\x20'+_0x34df0f[_0x2bfc05(0x237)]);}else!newBot&&logger[_0x2bfc05(0x16f)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x2bfc05(0x16f)](_0x2bfc05(0x242)),logger['simple'](''),await logger[_0x2bfc05(0x1f7)](_0x2bfc05(0x225)+nodeversion),await logger[_0x2bfc05(0x1f7)]('Network\x20Interfaces:',_0x3ef3e8);}function startSocket(){const _0x595c6d=_0x332cff;io['on'](_0x595c6d(0x286),_0x2fd3ed=>{const _0x3ea397=_0x595c6d;let _0x1caf8d,_0x49a549,_0x54b736,_0x4b3eef,_0x1388bc;const _0x35e544=_0x2fd3ed[_0x3ea397(0x158)][_0x3ea397(0xfd)][_0x3ea397(0x2d3)];_0x49a549=_0x35e544[_0x3ea397(0x1b7)](/bot[0-9]{3}/);if(_0x49a549)_0x54b736=_0x49a549[0x0][_0x3ea397(0x1b7)](/[0-9]{3}/);if(_0x54b736)_0x1caf8d=_0x54b736[0x0];else _0x1caf8d=_0x3ea397(0x2b5);const _0x26f3c1=_0x2fd3ed[_0x3ea397(0x158)]['auth'][_0x3ea397(0x294)];if(!_0x26f3c1)_0x2fd3ed[_0x3ea397(0x22e)](_0x3ea397(0x169),{'publicKey':secure[_0x3ea397(0x2c0)]});else{_0x4b3eef=timelyDecrypt(_0x26f3c1,![]);if(!_0x4b3eef)_0x2fd3ed[_0x3ea397(0x22e)]('status',{'publicKey':secure[_0x3ea397(0x2c0)]});else{_0x1388bc=normalizeIP(_0x2fd3ed[_0x3ea397(0x2aa)][_0x3ea397(0x261)])[_0x3ea397(0x2a9)];if(!devices[_0x4b3eef])devices[_0x4b3eef]={'uuid':_0x4b3eef,'access':{'token':null}};devices[_0x4b3eef]['ip']=_0x1388bc;const _0x54a33c=addClient(_0x2fd3ed['id'],_0x4b3eef,_0x1caf8d);setAccess(_0x54a33c),emitMessages(),_0x2fd3ed['on']('login',_0x342897=>{const _0x183e43=_0x3ea397,_0x5ba086=timelyDecrypt(_0x342897[_0x183e43(0xfa)],!![],_0x183e43(0x2da));if(_0x5ba086){_0x342897={'username':_0x342897[_0x183e43(0x1cc)],'password':_0x5ba086},devices[_0x4b3eef]['access']=validateCredentials(_0x342897,_0x4b3eef);if(devices[_0x4b3eef][_0x183e43(0x298)][_0x183e43(0x28e)]==![]&&devices[_0x4b3eef][_0x183e43(0x298)][_0x183e43(0x22c)]==_0x183e43(0x1cf))_0x2fd3ed[_0x183e43(0x22e)](_0x183e43(0x169),{'access':devices[_0x4b3eef][_0x183e43(0x298)]}),loginAccess2FA(_0x4b3eef,_0x1388bc);else{if(devices[_0x4b3eef][_0x183e43(0x298)]['allow']==![]&&devices[_0x4b3eef][_0x183e43(0x298)][_0x183e43(0x22c)]=='invalid\x20credentials')_0x2fd3ed[_0x183e43(0x22e)](_0x183e43(0x169),{'access':devices[_0x4b3eef][_0x183e43(0x298)]});else devices[_0x4b3eef][_0x183e43(0x298)][_0x183e43(0x28e)]&&devices[_0x4b3eef][_0x183e43(0x298)][_0x183e43(0x22c)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x4b3eef)[_0x183e43(0x1d5)](_0x14d122=>{setAccess(_0x14d122);}),logger[_0x183e43(0x1f7)](_0x183e43(0x108)+_0x4b3eef[_0x183e43(0x1c8)](-0x8)),setTokenRefresh(_0x4b3eef),setSessionTimeout(_0x183e43(0x2c8),_0x4b3eef));}}else logger[_0x183e43(0x291)](_0x183e43(0x101));}),_0x2fd3ed['on'](_0x3ea397(0xee),()=>{resetPassword();}),_0x2fd3ed['on'](_0x3ea397(0x274),_0x327bbb=>{removeClient(_0x2fd3ed['id']);}),_0x1caf8d==_0x3ea397(0x2b5)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x50fc71){const _0x359859=_0x332cff;if(_0x50fc71!=_0x359859(0x2b5)&&config['apiKey']!=''){if(pid[_0x50fc71])pid[_0x50fc71][_0x359859(0x23c)]({'function':_0x359859(0x27d),'args':null});}_0x50fc71!=_0x359859(0x2b5)&&broadcastToBots('bots',JSON[_0x359859(0xf4)](config));}function reloadBotManager(){const _0x485014=_0x332cff;getClientsWithBotID(_0x485014(0x2b5))[_0x485014(0x1d5)](_0x4456d0=>{const _0x1c1b05=_0x485014;getSocket(_0x4456d0['id'])[_0x1c1b05(0x22e)](_0x1c1b05(0x169),{'access':{'allow':![],'reason':_0x1c1b05(0x264),'token':null}});});}function getSocket(_0x216655){const _0x2c08f1=_0x332cff,_0x4f028a=io[_0x2c08f1(0x2cb)][_0x2c08f1(0x1b3)]('/');return _0x4f028a[_0x2c08f1(0x117)]['get'](_0x216655);}function setAccess(_0x3076b2){const _0x333a83=_0x332cff,_0x95a1e0=getSocket(_0x3076b2['id']),_0x4f36e5=_0x3076b2[_0x333a83(0x215)],_0x32ec5f=_0x3076b2['bot'];devices[_0x4f36e5][_0x333a83(0x298)]=validateAccess(devices[_0x4f36e5]['access'][_0x333a83(0x23d)],_0x4f36e5),logger[_0x333a83(0x1f7)](_0x333a83(0x192)+devices[_0x4f36e5][_0x333a83(0x298)][_0x333a83(0x22c)]+_0x333a83(0x126)+_0x3076b2['id'][_0x333a83(0x1c8)](-0x8)+'\x20|\x20user:\x20...'+_0x4f36e5[_0x333a83(0x1c8)](-0x8)),_0x95a1e0['join'](_0x4f36e5);if(devices[_0x4f36e5]['access'][_0x333a83(0x28e)]){_0x95a1e0[_0x333a83(0xd0)](_0x32ec5f);if(_0x32ec5f=='botmanager')initializeSocketBotManager(_0x95a1e0);else initializeSocketBot(_0x95a1e0);initClient(_0x32ec5f);}devices[_0x4f36e5]['access'][_0x333a83(0x23d)]&&devices[_0x4f36e5][_0x333a83(0x298)][_0x333a83(0x22c)]==_0x333a83(0x1b5)&&setSessionTimeout('2FA',_0x4f36e5),devices[_0x4f36e5]['access']['token']&&devices[_0x4f36e5][_0x333a83(0x298)][_0x333a83(0x22c)]==_0x333a83(0x209)&&setSessionTimeout('login',_0x4f36e5),_0x95a1e0[_0x333a83(0x22e)](_0x333a83(0x169),{'status':_0x3076b2[_0x333a83(0x1a9)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4f36e5]['access'],'externalip':devices[_0x4f36e5]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x333a83(0x18f)],'validInstallation':validInstallation}),devices[_0x4f36e5][_0x333a83(0x298)][_0x333a83(0x28e)]==![]&&devices[_0x4f36e5]['access'][_0x333a83(0x22c)]==_0x333a83(0x102)&&temporaryAccess2FA(_0x4f36e5,devices[_0x4f36e5]['ip']);}function _0x556d(_0x60f7ad,_0xd7d54a){const _0x32e405=_0x3f5a();return _0x556d=function(_0x44a4ad,_0x37dbcd){_0x44a4ad=_0x44a4ad-0xcd;let _0x3f5a2b=_0x32e405[_0x44a4ad];return _0x3f5a2b;},_0x556d(_0x60f7ad,_0xd7d54a);}function setSessionTimeout(_0x4d7756,_0x345624){const _0x63c9c5=_0x332cff;let _0x12babb;if(_0x4d7756=='login')_0x12babb=loginExpiry*0x3c*0x3e8;else _0x12babb=devices[_0x345624][_0x63c9c5(0x29a)][_0x63c9c5(0x1c9)]*0x3c*0x3e8-(new Date()[_0x63c9c5(0x1dd)]()-devices[_0x345624][_0x63c9c5(0x29a)][_0x63c9c5(0x27b)]);if(devices[_0x345624][_0x63c9c5(0x19b)])clearTimeout(devices[_0x345624][_0x63c9c5(0x19b)]);devices[_0x345624][_0x63c9c5(0x19b)]=setTimeout(()=>{const _0xd1dbc6=_0x63c9c5;if(devices[_0x345624]['pidRefreshToken'])clearTimeout(devices[_0x345624][_0xd1dbc6(0x150)]);removeSocketListeners(_0x345624),addBlacklist(_0x345624),devices[_0x345624][_0xd1dbc6(0x29a)]=null,devices[_0x345624][_0xd1dbc6(0x1a0)]=null,devices[_0x345624][_0xd1dbc6(0x298)][_0xd1dbc6(0x23d)]=null,logger[_0xd1dbc6(0x1f7)]('Session\x20expired\x20for\x20user\x20...'+_0x345624[_0xd1dbc6(0x1c8)](-0x8)),devices[_0x345624][_0xd1dbc6(0x298)]=validateAccess(devices[_0x345624]['access'][_0xd1dbc6(0x23d)],_0x345624),!(devices[_0x345624]['access']['allow']&&devices[_0x345624][_0xd1dbc6(0x298)][_0xd1dbc6(0x22c)]=='login\x20not\x20required')&&(_0x4d7756==_0xd1dbc6(0x2c8)?io['to'](_0x345624)[_0xd1dbc6(0x22e)]('status',{'access':{'allow':![],'reason':_0xd1dbc6(0x269),'token':null}}):io['to'](_0x345624)[_0xd1dbc6(0x22e)]('status',{'access':{'allow':![],'reason':_0xd1dbc6(0x284),'token':null}})),devices[_0x345624][_0xd1dbc6(0x298)][_0xd1dbc6(0x23d)]=null;},_0x12babb);}function setTokenRefresh(_0x746e6a){const _0x1af10b=_0x332cff;if(devices[_0x746e6a][_0x1af10b(0x150)])clearTimeout(devices[_0x746e6a][_0x1af10b(0x150)]);devices[_0x746e6a]['pidRefreshToken']=setTimeout(()=>{const _0x2f7ed4=_0x1af10b;getClientsWithUuid(_0x746e6a)[_0x2f7ed4(0x178)]!=0x0?(devices[_0x746e6a][_0x2f7ed4(0x298)]=refreshToken(_0x746e6a),io['to'](_0x746e6a)[_0x2f7ed4(0x22e)](_0x2f7ed4(0x169),{'status':_0x2f7ed4(0x128),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x746e6a][_0x2f7ed4(0x298)],'externalip':devices[_0x746e6a]['ip'],'publicKey':secure[_0x2f7ed4(0x2c0)],'validInstallation':validInstallation}),setTokenRefresh(_0x746e6a)):clearTimeout(devices[_0x746e6a][_0x2f7ed4(0x150)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3fcb4f){const _0x19f695=_0x332cff,_0x5b0714=getClient(_0x3fcb4f['id'])[_0x19f695(0x215)];_0x3fcb4f[_0x19f695(0x22e)]('bots',config),_0x3fcb4f['emit'](_0x19f695(0x116),cleanSettings()),_0x3fcb4f['on']('add-bot',_0x580eac=>{const _0x3b0053=_0x19f695;if(validateAccess(_0x580eac,_0x5b0714)[_0x3b0053(0x28e)])addBot();else logger['full'](_0x3b0053(0x110));}),_0x3fcb4f['on']('update-bot',(_0x5afb9a,_0x18f401)=>{const _0x2d4672=_0x19f695;if(validateAccess(_0x18f401,_0x5b0714)['allow'])toggleBot(_0x5afb9a[_0x2d4672(0x23e)],_0x5afb9a[_0x2d4672(0x169)],_0x5afb9a[_0x2d4672(0x1c2)]);else logger[_0x2d4672(0x291)](_0x2d4672(0x1c3));}),_0x3fcb4f['on'](_0x19f695(0x2d2),(_0x514d1b,_0x11dcdb)=>{const _0x5c2d34=_0x19f695;if(validateAccess(_0x11dcdb,_0x5b0714)[_0x5c2d34(0x28e)])toggleBotMode(_0x514d1b);else logger[_0x5c2d34(0x291)](_0x5c2d34(0x1c3));}),_0x3fcb4f['on']('delete-bot',(_0xd3e7bd,_0x2bf993)=>{const _0x3960a1=_0x19f695;if(validateAccess(_0x2bf993,_0x5b0714)['allow'])deleteBot(_0xd3e7bd);else logger[_0x3960a1(0x291)](_0x3960a1(0x247));}),_0x3fcb4f['on'](_0x19f695(0x138),(_0x18adf1,_0x12b00a)=>{const _0x5adc9a=_0x19f695;if(validateAccess(_0x12b00a,_0x5b0714)[_0x5adc9a(0x28e)])storeSettings(_0x18adf1,!![]);else logger[_0x5adc9a(0x291)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x3fcb4f['on']('update-bb',_0x3e3181=>{const _0x1d8229=_0x19f695;if(validateAccess(_0x3e3181,_0x5b0714)[_0x1d8229(0x28e)])updateBB(_0x1d8229(0xd9));else logger[_0x1d8229(0x291)](_0x1d8229(0x123));}),_0x3fcb4f['on']('reinstall-bb',_0x2e5bac=>{const _0x5b5ea5=_0x19f695;if(validateAccess(_0x2e5bac,_0x5b0714)[_0x5b5ea5(0x28e)])updateBB(_0x5b5ea5(0x134));else logger[_0x5b5ea5(0x291)](_0x5b5ea5(0x182));}),_0x3fcb4f['on'](_0x19f695(0x11e),_0x2f0034=>{const _0xaa01f=_0x19f695;if(validateAccess(_0x2f0034,_0x5b0714)[_0xaa01f(0x28e)]){const _0x1abbc4=getClient(_0x3fcb4f['id']);if(_0x1abbc4)getBackupFiles(_0x1abbc4['uuid']);else logger[_0xaa01f(0x291)](_0xaa01f(0x119));}else logger[_0xaa01f(0x291)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x3fcb4f['on']('restore-backup-file',(_0x265317,_0x1233c9)=>{const _0x1e5197=_0x19f695;if(validateAccess(_0x1233c9,_0x5b0714)[_0x1e5197(0x28e)])restoreBackupFile(_0x265317);else logger[_0x1e5197(0x291)](_0x1e5197(0x1e5));}),_0x3fcb4f['on'](_0x19f695(0x20a),_0x525ff5=>{const _0x5383b7=_0x19f695;if(validateAccess(_0x525ff5,_0x5b0714)[_0x5383b7(0x28e)])getMessages();else logger[_0x5383b7(0x291)](_0x5383b7(0x127));}),_0x3fcb4f['on'](_0x19f695(0x1f0),(_0x453d92,_0x4e8cd1)=>{const _0x1a60ba=_0x19f695;if(validateAccess(_0x4e8cd1,_0x5b0714)[_0x1a60ba(0x28e)])confirmMessage(_0x453d92);else logger[_0x1a60ba(0x291)](_0x1a60ba(0x12f));}),_0x3fcb4f['on'](_0x19f695(0x18d),_0x4abd93=>{const _0x54edd2=_0x19f695;if(validateAccess(_0x4abd93,_0x5b0714)[_0x54edd2(0x28e)]){if(devices[_0x5b0714][_0x54edd2(0x150)])clearTimeout(devices[_0x5b0714][_0x54edd2(0x150)]);if(devices[_0x5b0714][_0x54edd2(0x19b)])clearTimeout(devices[_0x5b0714]['pidExpireLogin']);removeSocketListeners(getClient(_0x3fcb4f['id'])[_0x54edd2(0x215)]),addBlacklist(_0x5b0714),devices[_0x5b0714][_0x54edd2(0x29a)]=null,devices[_0x5b0714][_0x54edd2(0x1a0)]=null,devices[_0x5b0714][_0x54edd2(0x298)][_0x54edd2(0x23d)]=null,logger[_0x54edd2(0x1f7)](_0x54edd2(0x2a1)+_0x5b0714[_0x54edd2(0x1c8)](-0x8)),io['to'](getClient(_0x3fcb4f['id'])['uuid'])['emit'](_0x54edd2(0x169),{'access':{'allow':![],'reason':_0x54edd2(0x1bf),'token':null}});}else logger[_0x54edd2(0x291)](_0x54edd2(0xed));});}function initializeSocketBot(_0x34dbb5){const _0x1ab732=_0x332cff,_0x5bb561=getClient(_0x34dbb5['id'])[_0x1ab732(0x10c)],_0x2d1710=getClient(_0x34dbb5['id'])['uuid'];_0x34dbb5['on'](_0x1ab732(0x2ad),(_0x5239ce,_0x1f4bff)=>{const _0x3c6561=_0x1ab732;if(validateAccess(_0x1f4bff,_0x2d1710)[_0x3c6561(0x28e)]){if(pid[_0x5bb561])pid[_0x5bb561][_0x3c6561(0x23c)]({'function':_0x3c6561(0xf8),'args':_0x5239ce});}else logger[_0x3c6561(0x291)](_0x3c6561(0x1a4));}),_0x34dbb5['on'](_0x1ab732(0x2d8),(_0x8ee7b,_0x3bd343)=>{const _0x162d70=_0x1ab732;if(validateAccess(_0x3bd343,_0x2d1710)[_0x162d70(0x28e)]){if(pid[_0x5bb561])pid[_0x5bb561][_0x162d70(0x23c)]({'function':'deleteHistoryAlerts','args':_0x8ee7b});}else logger[_0x162d70(0x291)](_0x162d70(0x12b));}),_0x34dbb5['on'](_0x1ab732(0x115),(_0x227998,_0x1e3d23)=>{const _0x62acdc=_0x1ab732;if(validateAccess(_0x1e3d23,_0x2d1710)[_0x62acdc(0x28e)]){if(pid[_0x5bb561])pid[_0x5bb561]['send']({'function':'getPortfolio','args':_0x227998});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x34dbb5['on'](_0x1ab732(0x224),(_0x2addec,_0x443966)=>{const _0x89fced=_0x1ab732;if(validateAccess(_0x443966,_0x2d1710)[_0x89fced(0x28e)]){if(pid[_0x5bb561])pid[_0x5bb561][_0x89fced(0x23c)]({'function':'storeConfiguration','args':_0x2addec});}else logger[_0x89fced(0x291)](_0x89fced(0x1e7));}),_0x34dbb5['on'](_0x1ab732(0x1ad),(_0x3353f2,_0x2474bb)=>{const _0x2a1173=_0x1ab732;if(validateAccess(_0x2474bb,_0x2d1710)[_0x2a1173(0x28e)]){if(pid[_0x5bb561])pid[_0x5bb561][_0x2a1173(0x23c)]({'function':'storeHeadless','args':_0x3353f2});}else logger[_0x2a1173(0x291)](_0x2a1173(0x194));}),_0x34dbb5['on']('store-fiat',(_0x134f10,_0x87eb4d)=>{const _0x550ecd=_0x1ab732;if(validateAccess(_0x87eb4d,_0x2d1710)[_0x550ecd(0x28e)]){if(pid[_0x5bb561])pid[_0x5bb561][_0x550ecd(0x23c)]({'function':_0x550ecd(0x140),'args':_0x134f10});}else logger['full'](_0x550ecd(0x196));}),_0x34dbb5['on'](_0x1ab732(0x223),_0x2fe66a=>{const _0x3a1e6a=_0x1ab732;if(validateAccess(_0x2fe66a,_0x2d1710)[_0x3a1e6a(0x28e)]){if(pid[_0x5bb561])pid[_0x5bb561][_0x3a1e6a(0x23c)]({'function':'resetHistory','args':null});}else logger[_0x3a1e6a(0x291)](_0x3a1e6a(0x18b));}),_0x34dbb5['on'](_0x1ab732(0x26d),_0xc474a0=>{const _0x115d25=_0x1ab732;if(validateAccess(_0xc474a0,_0x2d1710)[_0x115d25(0x28e)]){if(pid[_0x5bb561])pid[_0x5bb561]['send']({'function':_0x115d25(0x156),'args':null});}else logger['full'](_0x115d25(0x24a));}),_0x34dbb5['on'](_0x1ab732(0x164),(_0x2f483d,_0x2247d9)=>{const _0x165e51=_0x1ab732;if(validateAccess(_0x2247d9,_0x2d1710)[_0x165e51(0x28e)]){if(pid[_0x5bb561])pid[_0x5bb561][_0x165e51(0x23c)]({'function':_0x165e51(0x1cd),'args':_0x2f483d});}else logger[_0x165e51(0x291)](_0x165e51(0x219));}),_0x34dbb5['on'](_0x1ab732(0x171),_0xbe758b=>{const _0x205b42=_0x1ab732;if(validateAccess(_0xbe758b,_0x2d1710)[_0x205b42(0x28e)]){if(pid[_0x5bb561])pid[_0x5bb561][_0x205b42(0x23c)]({'function':_0x205b42(0x132),'args':null});}else logger['full'](_0x205b42(0x2c7));}),_0x34dbb5['on'](_0x1ab732(0x19c),_0x4e3ced=>{const _0xf3c58b=_0x1ab732;if(validateAccess(_0x4e3ced,_0x2d1710)[_0xf3c58b(0x28e)]){if(pid[_0x5bb561])pid[_0x5bb561]['send']({'function':_0xf3c58b(0xd4),'args':null});}else logger[_0xf3c58b(0x291)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x34dbb5['on']('update-bb',_0x48c54f=>{const _0x3a0195=_0x1ab732;if(validateAccess(_0x48c54f,_0x2d1710)[_0x3a0195(0x28e)])updateBB(_0x3a0195(0xd9));else logger[_0x3a0195(0x291)](_0x3a0195(0x123));}),_0x34dbb5['on'](_0x1ab732(0x20a),_0x140bf6=>{const _0x5afa77=_0x1ab732;if(validateAccess(_0x140bf6,_0x2d1710)[_0x5afa77(0x28e)])getMessages();else logger[_0x5afa77(0x291)](_0x5afa77(0x127));}),_0x34dbb5['on'](_0x1ab732(0x1f0),(_0x425739,_0xc8b2e2)=>{const _0x299e8f=_0x1ab732;if(validateAccess(_0xc8b2e2,_0x2d1710)['allow'])confirmMessage(_0x425739);else logger['full'](_0x299e8f(0x12f));}),_0x34dbb5['on'](_0x1ab732(0x18d),_0x16d051=>{const _0x47ff67=_0x1ab732;if(validateAccess(_0x16d051,_0x2d1710)['allow']){if(devices[_0x2d1710][_0x47ff67(0x150)])clearTimeout(devices[_0x2d1710]['pidRefreshToken']);if(devices[_0x2d1710][_0x47ff67(0x19b)])clearTimeout(devices[_0x2d1710]['pidExpireLogin']);removeSocketListeners(getClient(_0x34dbb5['id'])[_0x47ff67(0x215)]),addBlacklist(_0x2d1710),devices[_0x2d1710]['telegramIpApproval']=null,devices[_0x2d1710][_0x47ff67(0x1a0)]=null,devices[_0x2d1710][_0x47ff67(0x298)][_0x47ff67(0x23d)]=null,logger[_0x47ff67(0x1f7)](_0x47ff67(0x2a1)+_0x2d1710[_0x47ff67(0x1c8)](-0x8)),io['to'](getClient(_0x34dbb5['id'])[_0x47ff67(0x215)])[_0x47ff67(0x22e)]('status',{'access':{'allow':![],'reason':_0x47ff67(0x1bf),'token':null}});}else logger['full'](_0x47ff67(0xed));});}function removeSocketListeners(_0x1efa64){const _0x14a7f8=_0x332cff;getClientsWithUuid(_0x1efa64)[_0x14a7f8(0x1d5)](_0xf55ee0=>{const _0x1dc09c=_0x14a7f8;getSocket(_0xf55ee0['id'])[_0x1dc09c(0x153)]();});}function cleanSettings(){const _0x1b901a=_0x332cff;let _0x49ba60=settings;return settings[_0x1b901a(0x1f4)]&&settings[_0x1b901a(0x1f4)]!=''&&(_0x49ba60={..._0x49ba60,'telegramToken':_0x1b901a(0x1d9)}),settings[_0x1b901a(0x12c)]&&settings['bbPassword']!=''&&(_0x49ba60={..._0x49ba60,'bbPassword':_0x1b901a(0x1d9)}),settings[_0x1b901a(0x245)]&&settings[_0x1b901a(0x245)]!=''&&(_0x49ba60={..._0x49ba60,'marketcapApi':'************'}),(settings[_0x1b901a(0x12c)]&&settings[_0x1b901a(0x12c)]=='***'||settings[_0x1b901a(0x1f4)]&&settings['telegramToken']=='***'||settings['marketcapApi']&&settings[_0x1b901a(0x245)]==_0x1b901a(0xe5))&&(_0x49ba60={..._0x49ba60,'restored':{'password':settings[_0x1b901a(0x12c)]==_0x1b901a(0xe5),'telegram':settings[_0x1b901a(0x1f4)]==_0x1b901a(0xe5),'marketcap':settings['marketcapApi']=='***'}}),_0x49ba60;}async function updateBB(_0xf29047){const _0x440b45=_0x332cff;await backupConfigFiles(),installingUpdate=!![],config[_0x440b45(0x1d5)](_0xb71628=>{const _0x1c0477=_0x440b45;restartBot(_0xb71628[_0x1c0477(0x23e)]);});if(_0xf29047==_0x440b45(0xd9))process[_0x440b45(0x23c)]({'update':!![],'environment':environment},_0x42e97e=>{});else _0xf29047==_0x440b45(0x134)&&process['send']({'reinstall':!![],'environment':environment},_0x56f04e=>{});}function startBot(_0x371f00,_0x4bd254,_0x464a63){const _0x55061b=_0x332cff;if(debugging)_0x371f00[_0x55061b(0x235)]('-d');if(recreate)_0x371f00[_0x55061b(0x235)]('-r');let _0x5c65a1=![];const _0x44e43c=_0x371f00[0x0];_0x4bd254={..._0x4bd254,'stdio':[_0x55061b(0x2cf),_0x55061b(0x2cf),_0x55061b(0x2cf),_0x55061b(0x199)]},pid[_0x44e43c]=childProcess['fork'](botfile,_0x371f00,_0x4bd254),pid[_0x44e43c]['on'](_0x55061b(0x113),_0x35c24a=>{const _0x4db9c8=_0x55061b;switch(Object['keys'](_0x35c24a)[0x0]){case _0x4db9c8(0x237):updateBotName(_0x44e43c,_0x35c24a[_0x4db9c8(0x237)]);break;case _0x4db9c8(0x2a3):updateBotManager();break;case _0x4db9c8(0x169):updateStatus(_0x44e43c,_0x35c24a[_0x4db9c8(0x169)]);break;case _0x4db9c8(0x1c2):updateLive(_0x44e43c,_0x35c24a[_0x4db9c8(0x1c2)]);break;case _0x4db9c8(0x250):updateLive(_0x44e43c,_0x35c24a[_0x4db9c8(0x250)]),io['to'](_0x44e43c)[_0x4db9c8(0x22e)](_0x4db9c8(0x169),{'access':{'allow':![],'reason':_0x4db9c8(0x264),'token':null}});break;case _0x4db9c8(0x244):_0x35c24a[_0x4db9c8(0x244)]==_0x4db9c8(0x2c3)&&restartBot(_0x44e43c);_0x35c24a[_0x4db9c8(0x244)]==_0x4db9c8(0x254)&&toggleBot(_0x44e43c,'disabled','stopped');break;case _0x4db9c8(0xf3):sendTelegramBot(_0x44e43c,_0x35c24a['telegram']);break;case _0x4db9c8(0x21a):sendTelegramMsg(_0x35c24a[_0x4db9c8(0x21a)]);break;case _0x4db9c8(0x246):io['to'](_0x44e43c)[_0x4db9c8(0x22e)](_0x35c24a[_0x4db9c8(0x246)],_0x35c24a[_0x4db9c8(0x241)]);break;}}),pid[_0x44e43c]['on'](_0x55061b(0x260),function(_0x1c32fe){if(_0x5c65a1)return;_0x5c65a1=!![],_0x464a63(_0x1c32fe);}),pid[_0x44e43c]['on'](_0x55061b(0x1d4),async function(_0x3ebd38){const _0x313c08=_0x55061b;if(terminating)return;if(installingUpdate){io['close']();return;}if(_0x5c65a1)return;_0x5c65a1=!![],_0x464a63(null);const _0x32b1c=dbConfig[_0x313c08(0x1b3)]('bots')[_0x313c08(0x124)]({'botID':_0x44e43c})[_0x313c08(0x2bb)]();_0x32b1c&&(_0x32b1c[_0x313c08(0x169)]==_0x313c08(0x168)||_0x32b1c[_0x313c08(0x169)]==_0x313c08(0x195))&&(await sleep(0x3e8),updateLive(_0x44e43c,'stopped'),logger[_0x313c08(0x291)](_0x313c08(0xe6)+botRef(_0x44e43c)),startBot([_0x44e43c,userID],{'cwd':bbpath},function(_0x1b859d){const _0x228aa0=_0x313c08;if(_0x1b859d)logger[_0x228aa0(0x291)](_0x1b859d);}));});}function stopBot(_0x2085d4){const _0x170a94=_0x332cff;getClientsWithBotID(_0x2085d4)['forEach'](_0x1b217d=>{const _0x40712c=_0x556d;getSocket(_0x1b217d['id'])[_0x40712c(0x274)](!![]),removeClient(_0x1b217d['id']);}),pid[_0x2085d4]&&(pid[_0x2085d4][_0x170a94(0x254)](),pid[_0x2085d4]=null);}function stopAllBots(){const _0x34e8e1=_0x332cff;terminating=!![];const _0x561dd7=getEnabledBots();_0x561dd7[_0x34e8e1(0x1d5)](_0xc338eb=>{const _0x49bc24=_0x34e8e1;stopBot(_0xc338eb[_0x49bc24(0x23e)]);});}function restartBot(_0x39b8ab){const _0x4a0d4c=_0x332cff;if(pid[_0x39b8ab])pid[_0x39b8ab][_0x4a0d4c(0x254)]();}function addBot(){const _0xce9768=_0x332cff;let _0x1443ab;for(let _0x2770b9=0x1;_0x2770b9<0x3e9;_0x2770b9++){_0x1443ab=_0x2770b9[_0xce9768(0x23f)]()[_0xce9768(0x271)](0x3,'0');let _0x41309d=config['find'](_0x3e9c81=>_0x3e9c81[_0xce9768(0x23e)]==_0x1443ab);if(!_0x41309d)break;}if(_0x1443ab===_0xce9768(0x139)){logger['full']('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0xce9768(0x291)](_0xce9768(0x154)+_0x1443ab),dbConfig[_0xce9768(0x1b3)](_0xce9768(0x18a))[_0xce9768(0x235)]({'botID':_0x1443ab,'botname':_0xce9768(0x1a3)+_0x1443ab,'status':_0xce9768(0x195),'live':''})['write'](),startBot([_0x1443ab,userID],{'cwd':bbpath},function(_0x8c18ad){if(_0x8c18ad)logger['full'](_0x8c18ad);}),config=getConfiguration(),io['to'](_0xce9768(0x2b5))['emit'](_0xce9768(0x18a),config),broadcastToBots(_0xce9768(0x18a),JSON['stringify'](config));}function deleteBot(_0x4c2923){const _0xb41fa8=_0x332cff;getClientsWithBotID(_0x4c2923)[_0xb41fa8(0x1d5)](_0x40c53f=>{getSocket(_0x40c53f['id'])['disconnect'](!![]),removeClient(_0x40c53f['id']);}),dbConfig[_0xb41fa8(0x1b3)](_0xb41fa8(0x18a))['remove']({'botID':_0x4c2923})[_0xb41fa8(0x167)](),logger[_0xb41fa8(0x291)](_0xb41fa8(0x2c2)+_0x4c2923),stopBot(_0x4c2923);try{if(fs['existsSync'](path[_0xb41fa8(0xd0)](configpath,'bot-'+_0x4c2923+_0xb41fa8(0x14f))))fs['unlinkSync'](path['join'](configpath,_0xb41fa8(0x1f8)+_0x4c2923+_0xb41fa8(0x14f)));if(fs[_0xb41fa8(0x268)](path[_0xb41fa8(0xd0)](configpath,_0xb41fa8(0x1f8)+_0x4c2923+_0xb41fa8(0x144))))fs[_0xb41fa8(0xeb)](path[_0xb41fa8(0xd0)](configpath,_0xb41fa8(0x1f8)+_0x4c2923+_0xb41fa8(0x144)));if(fs[_0xb41fa8(0x268)](path[_0xb41fa8(0xd0)](configpath,_0xb41fa8(0x1f8)+_0x4c2923+_0xb41fa8(0x135))))fs['unlinkSync'](path['join'](configpath,_0xb41fa8(0x1f8)+_0x4c2923+'-performance.json'));if(fs[_0xb41fa8(0x268)](path[_0xb41fa8(0xd0)](configpath,_0xb41fa8(0x1f8)+_0x4c2923+_0xb41fa8(0x216))))fs[_0xb41fa8(0xeb)](path[_0xb41fa8(0xd0)](configpath,_0xb41fa8(0x1f8)+_0x4c2923+_0xb41fa8(0x216)));}catch(_0x56f6c8){if(_0x56f6c8)logger['full'](_0xb41fa8(0x275),_0x56f6c8);}config=getConfiguration(),io['to']('botmanager')[_0xb41fa8(0x22e)]('bots',config),broadcastToBots(_0xb41fa8(0x18a),JSON['stringify'](config));}function toggleBot(_0x129239,_0x123b10,_0x5e9de3){const _0x18d268=_0x332cff;dbConfig[_0x18d268(0x1b3)](_0x18d268(0x18a))[_0x18d268(0x124)]({'botID':_0x129239})[_0x18d268(0x236)]({'status':_0x123b10})[_0x18d268(0x236)]({'live':_0x5e9de3})[_0x18d268(0x167)]();const _0x40227b=botRef(_0x129239);if(_0x123b10==_0x18d268(0x168)||_0x123b10=='new')logger[_0x18d268(0x291)](_0x18d268(0x1e1)+_0x40227b),startBot([_0x129239,userID],{'cwd':bbpath},function(_0x174215){const _0x59606e=_0x18d268;if(_0x174215)logger[_0x59606e(0x291)](_0x174215);});else(_0x123b10==_0x18d268(0x26c)||_0x123b10=='new-disabled')&&(logger[_0x18d268(0x291)](_0x18d268(0x13d)+_0x40227b),stopBot(_0x129239));config=getConfiguration(),io['to'](_0x18d268(0x2b5))[_0x18d268(0x22e)](_0x18d268(0x18a),config),broadcastToBots(_0x18d268(0x18a),JSON['stringify'](config));}function toggleStatus(_0x1af257){const _0x20d037=_0x332cff;let _0x3d6537=dbConfig['get']('bots')[_0x20d037(0x124)]({'botID':_0x1af257})[_0x20d037(0x2bb)](),_0x2fc712;if(_0x3d6537['status']===_0x20d037(0x168))_0x2fc712=_0x20d037(0x26c);else{if(_0x3d6537[_0x20d037(0x169)]===_0x20d037(0x195))_0x2fc712=_0x20d037(0x1c0);else{if(_0x3d6537[_0x20d037(0x169)]===_0x20d037(0x1c0))_0x2fc712='new';else{if(_0x3d6537['status']===_0x20d037(0x26c))_0x2fc712=_0x20d037(0x168);}}}return _0x2fc712;}function updateStatus(_0x175fe1,_0x4797e0){const _0x1da52f=_0x332cff;dbConfig['get']('bots')['find']({'botID':_0x175fe1})[_0x1da52f(0x236)]({'status':_0x4797e0})[_0x1da52f(0x167)](),config=getConfiguration(),io['to'](_0x1da52f(0x2b5))['emit'](_0x1da52f(0x18a),config),broadcastToBots(_0x1da52f(0x18a),JSON[_0x1da52f(0xf4)](config));}function updateLive(_0x21b4f8,_0x46e81e){const _0x2e71ca=_0x332cff;dbConfig[_0x2e71ca(0x1b3)](_0x2e71ca(0x18a))[_0x2e71ca(0x124)]({'botID':_0x21b4f8})[_0x2e71ca(0x236)]({'live':_0x46e81e})['write'](),config=getConfiguration(),io['to'](_0x2e71ca(0x2b5))[_0x2e71ca(0x22e)](_0x2e71ca(0x18a),config),broadcastToBots(_0x2e71ca(0x18a),JSON[_0x2e71ca(0xf4)](config));}function updateBotName(_0x4a06ed,_0x12ee9c){const _0x5f273c=_0x332cff;dbConfig[_0x5f273c(0x1b3)](_0x5f273c(0x18a))[_0x5f273c(0x124)]({'botID':_0x4a06ed})[_0x5f273c(0x236)]({'botname':_0x12ee9c})[_0x5f273c(0x167)](),config=getConfiguration(),io['to'](_0x5f273c(0x2b5))['emit'](_0x5f273c(0x18a),config),broadcastToBots(_0x5f273c(0x18a),JSON[_0x5f273c(0xf4)](config));}function updateBotManager(){const _0x47fd0f=_0x332cff;config=getConfiguration(),io['to'](_0x47fd0f(0x2b5))[_0x47fd0f(0x22e)](_0x47fd0f(0x18a),config),broadcastToBots('bots',JSON[_0x47fd0f(0xf4)](config));}function toggleBotMode(_0x12368f){const _0x181ba3=_0x332cff;if(pid[_0x12368f])pid[_0x12368f][_0x181ba3(0x23c)]({'function':'toggleBotMode','args':null});else{const _0x360eb5=configpath+_0x181ba3(0x1f8)+_0x12368f+'-config.json',_0x588b27=fs['readFileSync'](_0x360eb5),_0x37436a=JSON[_0x181ba3(0x238)](_0x588b27),_0x52c2b9=_0x37436a[_0x181ba3(0x10c)][0x0][_0x181ba3(0x13c)];_0x37436a[_0x181ba3(0x10c)][0x0][_0x181ba3(0x13c)]=!_0x52c2b9;const _0x5b4a06=JSON[_0x181ba3(0xf4)](_0x37436a,null,0x2);fs[_0x181ba3(0x290)](_0x360eb5,_0x5b4a06),config=getConfiguration(),io['to']('botmanager')[_0x181ba3(0x22e)](_0x181ba3(0x18a),config),broadcastToBots(_0x181ba3(0x18a),JSON['stringify'](config));}}function validateTelegram(_0x4588ce){const _0x4951d0=_0x332cff;if(_0x4588ce['from'][_0x4951d0(0x1cc)]!=settings['telegramUsername']&&'@'+_0x4588ce[_0x4951d0(0x200)][_0x4951d0(0x1cc)]!=settings[_0x4951d0(0x28f)]||_0x4588ce[_0x4951d0(0x2c1)]['id']!=settings[_0x4951d0(0x188)])return sendTelegram(_0x4588ce[_0x4951d0(0x2c1)]['id'],_0x4951d0(0x118),{'parse_mode':_0x4951d0(0x19e)}),![];return!![];}function botRef(_0x42d74d){const _0x51c2b0=_0x332cff,_0x29ea86=getBotAttributes(_0x42d74d),_0x4aac38=_0x29ea86[_0x51c2b0(0x221)]?_0x29ea86['botname']:_0x51c2b0(0x1a3)+_0x42d74d;return _0x4aac38;}async function initTelegram(){const _0x375a50=_0x332cff;tgBot&&(await tgBot[_0x375a50(0x244)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x375a50(0x1f4)]);let _0x8ef7b6=_0x375a50(0x2ab);_0x8ef7b6+='\x0a',_0x8ef7b6+=_0x375a50(0x2b4),_0x8ef7b6+=_0x375a50(0x1f9),_0x8ef7b6+=_0x375a50(0xd8),_0x8ef7b6+=_0x375a50(0x255),_0x8ef7b6+=_0x375a50(0x1e9),_0x8ef7b6+='/off\x20-\x20stop\x20bot(s)\x0a',_0x8ef7b6+=_0x375a50(0xfb),_0x8ef7b6+=_0x375a50(0xe0),_0x8ef7b6+=_0x375a50(0x2d1),_0x8ef7b6+=_0x375a50(0x1fd),_0x8ef7b6+=_0x375a50(0x270),_0x8ef7b6+='/logs\x20-\x20receive\x20log\x20files\x0a',_0x8ef7b6+=_0x375a50(0x25c),_0x8ef7b6+=_0x375a50(0x17a),_0x8ef7b6+=_0x375a50(0x1e4),_0x8ef7b6+=_0x375a50(0x276);let _0x2a2a5e=_0x375a50(0x2ca);_0x2a2a5e+='\x0a',_0x2a2a5e+=_0x8ef7b6,tgBot[_0x375a50(0x208)]((_0x599c3f,_0x10ddbf)=>{const _0x9b47da=_0x375a50;logger[_0x9b47da(0x16f)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x9b47da(0x1f7)](_0x9b47da(0x16b),_0x599c3f);}),tgBot[_0x375a50(0x1db)](async(_0x320221,_0x82d693)=>{const _0x33b228=_0x375a50;if(settings[_0x33b228(0x188)]||_0x320221[_0x33b228(0xd9)][_0x33b228(0x113)]['text']!=_0x33b228(0x23a)){if(!validateTelegram(_0x320221))return;}_0x82d693();}),tgBot['command'](_0x375a50(0x13e),async _0x2dcbd1=>{const _0x456d95=_0x375a50;if(_0x2dcbd1[_0x456d95(0x200)][_0x456d95(0x1cc)]==settings['telegramUsername']||'@'+_0x2dcbd1[_0x456d95(0x200)][_0x456d95(0x1cc)]==settings['telegramUsername']){if(!settings[_0x456d95(0x188)])updateSetting('telegramChatId',_0x2dcbd1['chat']['id']);else{if(!validateTelegram(_0x2dcbd1))return;}}else{if(!validateTelegram(_0x2dcbd1))return;}updateSetting('telegramEnabled',!![]),await sendTelegram(_0x2dcbd1[_0x456d95(0x2c1)]['id'],_0x2a2a5e);}),tgBot['command']('enable',async _0xa89d4e=>{const _0x319038=_0x375a50;updateSetting('telegramEnabled',!![]),await sendTelegram(_0xa89d4e[_0x319038(0x2c1)]['id'],'Notifications\x20enabled');}),tgBot[_0x375a50(0xe2)](_0x375a50(0x180),async _0x5a4a72=>{const _0x142897=_0x375a50;await sendTelegram(_0x5a4a72[_0x142897(0x2c1)]['id'],'Notifications\x20disabled'),updateSetting(_0x142897(0x1ba),![]);}),tgBot[_0x375a50(0xe2)](_0x375a50(0x183),async _0xe0cd07=>{const _0x4c6c47=_0x375a50,_0x17539a=Markup[_0x4c6c47(0x26e)]([Markup['button'][_0x4c6c47(0x15f)]('Orders','config_orders'),Markup[_0x4c6c47(0x13f)]['callback'](_0x4c6c47(0x288),'config_alerts'),Markup['button'][_0x4c6c47(0x15f)](_0x4c6c47(0x201),_0x4c6c47(0x14a))]);_0xe0cd07['reply']('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x17539a);}),tgBot[_0x375a50(0x1d6)](_0x375a50(0x1ec),async _0x116e55=>{const _0x1c3b66=_0x375a50;_0x116e55[_0x1c3b66(0x109)](),updateSetting(_0x1c3b66(0x262),'orders'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x116e55[_0x1c3b66(0x2c1)]['id'],_0x1c3b66(0x141));}),tgBot[_0x375a50(0x1d6)](_0x375a50(0x282),async _0x3a7e7e=>{const _0x4e3304=_0x375a50;_0x3a7e7e[_0x4e3304(0x109)](),updateSetting(_0x4e3304(0x262),_0x4e3304(0x131)),updateSetting(_0x4e3304(0x1ba),!![]),await sendTelegram(_0x3a7e7e['chat']['id'],_0x4e3304(0x1c6));}),tgBot[_0x375a50(0x1d6)](_0x375a50(0x14a),async _0x18bc80=>{const _0x245e3f=_0x375a50;_0x18bc80[_0x245e3f(0x109)](),updateSetting(_0x245e3f(0x262),_0x245e3f(0xd1)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x18bc80[_0x245e3f(0x2c1)]['id'],_0x245e3f(0x152));}),tgBot['command']('status',async _0x36b9d4=>{const _0x5b9291=_0x375a50,_0x18d18d=getBotsWithMode();let _0x57d37b=_0x5b9291(0x14c);config[_0x5b9291(0x1d5)](_0x2014cf=>{const _0x1b5bd7=_0x5b9291,_0x3f517b=_0x18d18d[_0x1b5bd7(0x124)](_0x3b60d4=>_0x3b60d4[_0x1b5bd7(0x23e)]==_0x2014cf['botID'])[_0x1b5bd7(0x25f)];_0x57d37b+='Bot\x20'+_0x2014cf[_0x1b5bd7(0x23e)]+':\x20'+_0x2014cf['status']+_0x1b5bd7(0xff)+_0x3f517b+_0x1b5bd7(0xff)+_0x2014cf[_0x1b5bd7(0x1c2)]+'\x0a';}),_0x57d37b+='\x0a',_0x57d37b+=_0x5b9291(0xfe),_0x57d37b+=!settings[_0x5b9291(0x1ba)]?_0x5b9291(0x165):'Notifications\x20enabled\x0a',_0x57d37b+=settings[_0x5b9291(0x1ba)]?settings[_0x5b9291(0x262)]==_0x5b9291(0xd1)?_0x5b9291(0x10e):_0x5b9291(0x213)+settings[_0x5b9291(0x262)]+_0x5b9291(0x1ed):'',await sendTelegram(_0x36b9d4['chat']['id'],_0x57d37b,{'parse_mode':'HTML'});}),tgBot[_0x375a50(0xe2)]('restart',async _0xd08bea=>{const _0x103bdb=_0x375a50,_0x359c05=getEnabledBots();if(_0x359c05[_0x103bdb(0x178)]==0x0)await sendTelegram(_0xd08bea[_0x103bdb(0x2c1)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x359c05[_0x103bdb(0x178)]>0x1)_0x359c05['push']({'botID':_0x103bdb(0xd1)});let _0x13c4d8=[],_0xdaf649=[];const _0x2e4bfd=_0x359c05[_0x103bdb(0x178)]%0x4==0x0||_0x359c05[_0x103bdb(0x178)]%0x4==0x3||_0x359c05['length']%0x3==0x1?0x4:0x3;let _0x3f7412=0x0;_0x359c05['forEach']((_0x397b29,_0x4e307c)=>{const _0x4e831a=_0x103bdb;if(_0x4e307c%_0x2e4bfd==0x0)_0xdaf649=[];_0xdaf649[_0x4e831a(0x235)](Markup[_0x4e831a(0x13f)][_0x4e831a(0x15f)](_0x397b29[_0x4e831a(0x23e)]=='all'?_0x4e831a(0x17e):botRef(_0x397b29['botID']),'restart_'+_0x397b29[_0x4e831a(0x23e)])),_0x4e307c%_0x2e4bfd==0x0&&(_0x13c4d8[_0x3f7412]=_0xdaf649,_0x3f7412++);});const _0x575ef1=Markup['inlineKeyboard'](_0x13c4d8);_0xd08bea['reply'](_0x103bdb(0x149),_0x575ef1);}}),tgBot[_0x375a50(0x1d6)](/restart_(.+)/,async _0x494036=>{const _0x419802=_0x375a50,_0x729ce9=_0x494036[_0x419802(0x1b7)][0x1];_0x494036[_0x419802(0x109)](),_0x729ce9=='all'?config[_0x419802(0x1d5)](_0x1cf867=>{const _0xd80e74=_0x419802;restartBot(_0x1cf867[_0xd80e74(0x23e)]);}):restartBot(_0x729ce9);}),tgBot[_0x375a50(0xe2)]('on',async _0x355bca=>{const _0x34f5d7=_0x375a50,_0x2c661c=getDisabledBots();if(_0x2c661c[_0x34f5d7(0x178)]==0x0)await sendTelegram(_0x355bca[_0x34f5d7(0x2c1)]['id'],_0x34f5d7(0x243));else{if(_0x2c661c['length']>0x1)_0x2c661c[_0x34f5d7(0x235)]({'botID':_0x34f5d7(0xd1)});let _0x34c4e2=[],_0x3c9362=[];const _0x47844c=_0x2c661c[_0x34f5d7(0x178)]%0x4==0x0||_0x2c661c[_0x34f5d7(0x178)]%0x4==0x3||_0x2c661c['length']%0x3==0x1?0x4:0x3;let _0x240886=0x0;_0x2c661c[_0x34f5d7(0x1d5)]((_0x41f0f6,_0x32acc1)=>{const _0x7f3836=_0x34f5d7;if(_0x32acc1%_0x47844c==0x0)_0x3c9362=[];_0x3c9362['push'](Markup[_0x7f3836(0x13f)][_0x7f3836(0x15f)](_0x41f0f6[_0x7f3836(0x23e)]=='all'?_0x7f3836(0x17e):botRef(_0x41f0f6[_0x7f3836(0x23e)]),_0x7f3836(0x280)+_0x41f0f6[_0x7f3836(0x23e)])),_0x32acc1%_0x47844c==0x0&&(_0x34c4e2[_0x240886]=_0x3c9362,_0x240886++);});const _0x49d3ba=Markup[_0x34f5d7(0x26e)](_0x34c4e2);_0x355bca[_0x34f5d7(0x2bf)](_0x34f5d7(0xfc),_0x49d3ba);}}),tgBot['action'](/on_(.+)/,async _0x1cd078=>{const _0x1d2e29=_0x375a50,_0x12197c=_0x1cd078[_0x1d2e29(0x1b7)][0x1];_0x1cd078[_0x1d2e29(0x109)]();if(_0x12197c==_0x1d2e29(0xd1)){const _0x332cf4=getDisabledBots();await sendTelegram(_0x1cd078['chat']['id'],'Bot\x20Mgr\x20>\x20Starting\x20all\x20bots'),_0x332cf4[_0x1d2e29(0x1d5)](_0x3ef16a=>{const _0x2be885=_0x1d2e29;if(_0x3ef16a[_0x2be885(0x23e)]!=_0x2be885(0xd1))toggleBot(_0x3ef16a[_0x2be885(0x23e)],toggleStatus(_0x3ef16a[_0x2be885(0x23e)]),_0x2be885(0x2cc));});}else await sendTelegram(_0x1cd078[_0x1d2e29(0x2c1)]['id'],_0x1d2e29(0xf1)+botRef(_0x12197c)),toggleBot(_0x12197c,toggleStatus(_0x12197c),'stopped');}),tgBot[_0x375a50(0xe2)]('off',async _0x3d81d4=>{const _0x37d58f=_0x375a50,_0x2276b2=getEnabledBots();if(_0x2276b2['length']==0x0)await sendTelegram(_0x3d81d4[_0x37d58f(0x2c1)]['id'],_0x37d58f(0xce));else{if(_0x2276b2[_0x37d58f(0x178)]>0x1)_0x2276b2['push']({'botID':_0x37d58f(0xd1)});let _0x4fe44b=[],_0x164265=[];const _0x2b33a8=_0x2276b2[_0x37d58f(0x178)]%0x4==0x0||_0x2276b2['length']%0x4==0x3||_0x2276b2['length']%0x3==0x1?0x4:0x3;let _0x36914f=0x0;_0x2276b2['forEach']((_0x1c1961,_0x128024)=>{const _0x2ea0de=_0x37d58f;if(_0x128024%_0x2b33a8==0x0)_0x164265=[];_0x164265[_0x2ea0de(0x235)](Markup[_0x2ea0de(0x13f)]['callback'](_0x1c1961[_0x2ea0de(0x23e)]=='all'?'All\x20bots':botRef(_0x1c1961[_0x2ea0de(0x23e)]),'off_'+_0x1c1961[_0x2ea0de(0x23e)])),_0x128024%_0x2b33a8==0x0&&(_0x4fe44b[_0x36914f]=_0x164265,_0x36914f++);});const _0x1a0dc1=Markup[_0x37d58f(0x26e)](_0x4fe44b);_0x3d81d4[_0x37d58f(0x2bf)](_0x37d58f(0x2ba),_0x1a0dc1);}}),tgBot[_0x375a50(0x1d6)](/off_(.+)/,async _0x45cc27=>{const _0x5e0a10=_0x375a50,_0x504149=_0x45cc27[_0x5e0a10(0x1b7)][0x1];_0x45cc27['editMessageReplyMarkup']();if(_0x504149==_0x5e0a10(0xd1)){const _0xcf3e18=getEnabledBots();await sendTelegram(_0x45cc27[_0x5e0a10(0x2c1)]['id'],_0x5e0a10(0x103)),_0xcf3e18[_0x5e0a10(0x1d5)](_0x181dde=>{const _0x1a7d41=_0x5e0a10;if(_0x181dde[_0x1a7d41(0x23e)]!=_0x1a7d41(0xd1))toggleBot(_0x181dde[_0x1a7d41(0x23e)],toggleStatus(_0x181dde['botID']),_0x1a7d41(0x2cc));});}else await sendTelegram(_0x45cc27[_0x5e0a10(0x2c1)]['id'],_0x5e0a10(0xf0)+botRef(_0x504149)),toggleBot(_0x504149,toggleStatus(_0x504149),_0x5e0a10(0x2cc));}),tgBot[_0x375a50(0xe2)](_0x375a50(0x145),async _0x240785=>{const _0x5aaff3=_0x375a50,_0x13b0ef=getEnabledBots();if(_0x13b0ef['length']==0x0)await sendTelegram(_0x240785[_0x5aaff3(0x2c1)]['id'],_0x5aaff3(0xce));else{if(_0x13b0ef[_0x5aaff3(0x178)]>0x1){let _0x11c496=[],_0x1243e2=[];const _0x278575=_0x13b0ef[_0x5aaff3(0x178)]%0x4==0x0||_0x13b0ef[_0x5aaff3(0x178)]%0x4==0x3||_0x13b0ef['length']%0x3==0x1?0x4:0x3;let _0x4b7609=0x0;_0x13b0ef['forEach']((_0x24555c,_0xc5a328)=>{const _0x3f4c67=_0x5aaff3;if(_0xc5a328%_0x278575==0x0)_0x1243e2=[];_0x1243e2['push'](Markup['button'][_0x3f4c67(0x15f)](botRef(_0x24555c['botID']),_0x3f4c67(0xf5)+_0x24555c[_0x3f4c67(0x23e)])),_0xc5a328%_0x278575==0x0&&(_0x11c496[_0x4b7609]=_0x1243e2,_0x4b7609++);});const _0x3ba28e=Markup[_0x5aaff3(0x26e)](_0x11c496);_0x240785[_0x5aaff3(0x2bf)](_0x5aaff3(0xea),_0x3ba28e);}else{const _0x1cdf1c=_0x13b0ef[0x0][_0x5aaff3(0x23e)];if(pid[_0x1cdf1c])pid[_0x1cdf1c][_0x5aaff3(0x23c)]({'function':_0x5aaff3(0xdb),'args':null});}}}),tgBot[_0x375a50(0x1d6)](/metrics_(.+)/,async _0x4b1548=>{const _0x4b9737=_0x375a50,_0x25e327=_0x4b1548[_0x4b9737(0x1b7)][0x1];_0x4b1548['editMessageReplyMarkup']();if(pid[_0x25e327])pid[_0x25e327][_0x4b9737(0x23c)]({'function':'sendMetricsTelegram','args':null});}),tgBot['command'](_0x375a50(0x272),async _0x328de4=>{const _0x279136=_0x375a50,_0x22ba84=getEnabledBots();if(_0x22ba84[_0x279136(0x178)]==0x0)await sendTelegram(_0x328de4['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x22ba84['length']>0x1){let _0x4d28a3=[],_0x3a3e19=[];const _0x4d7d9d=_0x22ba84[_0x279136(0x178)]%0x4==0x0||_0x22ba84[_0x279136(0x178)]%0x4==0x3||_0x22ba84[_0x279136(0x178)]%0x3==0x1?0x4:0x3;let _0x550a0b=0x0;_0x22ba84[_0x279136(0x1d5)]((_0x582360,_0xfc9a93)=>{const _0x238ebb=_0x279136;if(_0xfc9a93%_0x4d7d9d==0x0)_0x3a3e19=[];_0x3a3e19[_0x238ebb(0x235)](Markup[_0x238ebb(0x13f)]['callback'](botRef(_0x582360[_0x238ebb(0x23e)]),_0x238ebb(0x230)+_0x582360[_0x238ebb(0x23e)])),_0xfc9a93%_0x4d7d9d==0x0&&(_0x4d28a3[_0x550a0b]=_0x3a3e19,_0x550a0b++);});const _0x489820=Markup[_0x279136(0x26e)](_0x4d28a3);_0x328de4[_0x279136(0x2bf)](_0x279136(0x258),_0x489820);}else{const _0x47d252=_0x22ba84[0x0]['botID'];if(pid[_0x47d252])pid[_0x47d252]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x375a50(0x1d6)](/portfolio_(.+)/,async _0x3c7403=>{const _0x17459f=_0x375a50,_0x38f89e=_0x3c7403[_0x17459f(0x1b7)][0x1];_0x3c7403['editMessageReplyMarkup']();if(pid[_0x38f89e])pid[_0x38f89e][_0x17459f(0x23c)]({'function':_0x17459f(0x11c),'args':null});}),tgBot['command'](_0x375a50(0x1d3),async _0x1a60cd=>{const _0x595350=_0x375a50,_0xba91fe=_0x595350(0x1d3);await zipFiles(_0xba91fe);const _0x126b22=zippath+(_0xba91fe+_0x595350(0x186));_0x1a60cd[_0x595350(0x147)]({'source':_0x126b22})[_0x595350(0x26a)](()=>{})[_0x595350(0x208)](_0x37fb3f=>logger[_0x595350(0x1f7)](_0x595350(0xd6)+_0xba91fe+_0x595350(0x28b),_0x37fb3f));}),tgBot['command'](_0x375a50(0x11a),async _0x625f8f=>{const _0x418411=_0x375a50,_0x60c3e2='backup';await backupConfigFiles(),await zipFiles(_0x60c3e2);const _0x3fbfd5=zippath+(_0x60c3e2+_0x418411(0x186));_0x625f8f[_0x418411(0x147)]({'source':_0x3fbfd5})[_0x418411(0x26a)](()=>{})[_0x418411(0x208)](_0x55d446=>logger['debug'](_0x418411(0xd6)+_0x60c3e2+'\x20files\x20over\x20Telegram:',_0x55d446));}),tgBot[_0x375a50(0xe2)](_0x375a50(0xd9),async _0x1ca26d=>{const _0x120e75=_0x375a50;await getMessages();if(!updateAvailable)await sendTelegram(_0x1ca26d[_0x120e75(0x2c1)]['id'],_0x120e75(0x181));else{if(!validInstallation)await sendTelegram(_0x1ca26d['chat']['id'],_0x120e75(0x2dc));else{const _0x2599c7=Markup[_0x120e75(0x26e)]([Markup[_0x120e75(0x13f)]['callback'](_0x120e75(0x1e6),'update_yes'),Markup[_0x120e75(0x13f)][_0x120e75(0x15f)]('No','update_no')]);_0x1ca26d[_0x120e75(0x2bf)](_0x120e75(0x17b),_0x2599c7);}}}),tgBot[_0x375a50(0x1d6)](/update_(.+)/,async _0x45b7a9=>{const _0xe8ac35=_0x375a50,_0x469ec4=_0x45b7a9['match'][0x1];_0x45b7a9[_0xe8ac35(0x109)](),_0x469ec4==_0xe8ac35(0x26f)&&(await sendTelegram(_0x45b7a9[_0xe8ac35(0x2c1)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0xe8ac35(0xd9))),_0x469ec4=='no'&&await sendTelegram(_0x45b7a9['chat']['id'],_0xe8ac35(0x1e8));}),tgBot[_0x375a50(0xe2)](_0x375a50(0x134),async _0x15df39=>{const _0xbec511=_0x375a50;if(!validInstallation)await sendTelegram(_0x15df39['chat']['id'],_0xbec511(0x19a));else{const _0x49e69d=Markup[_0xbec511(0x26e)]([Markup[_0xbec511(0x13f)][_0xbec511(0x15f)](_0xbec511(0x1e6),'reinstall_yes'),Markup[_0xbec511(0x13f)][_0xbec511(0x15f)]('No',_0xbec511(0x19d))]);_0x15df39[_0xbec511(0x2bf)](_0xbec511(0x1a1),_0x49e69d);}}),tgBot['action'](/reinstall_(.+)/,async _0x590542=>{const _0x514861=_0x375a50,_0x545ee6=_0x590542[_0x514861(0x1b7)][0x1];_0x590542[_0x514861(0x109)](),_0x545ee6==_0x514861(0x26f)&&(await sendTelegram(_0x590542['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x514861(0x134))),_0x545ee6=='no'&&await sendTelegram(_0x590542[_0x514861(0x2c1)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x375a50(0xe2)](_0x375a50(0x20e),async _0x107ee0=>{const _0x6b1ec=_0x375a50,_0x2076cb=getBotsWithMode();if(_0x2076cb[_0x6b1ec(0x178)]==0x0)await sendTelegram(_0x107ee0[_0x6b1ec(0x2c1)]['id'],_0x6b1ec(0xce));else{let _0x591d82=[],_0x3a02c5=[];const _0x360591=0x2;let _0x5728b0=0x0;_0x2076cb[_0x6b1ec(0x1d5)]((_0x275959,_0x728030)=>{const _0x1df0fd=_0x6b1ec;if(_0x728030%_0x360591==0x0)_0x3a02c5=[];_0x3a02c5['push'](Markup[_0x1df0fd(0x13f)][_0x1df0fd(0x15f)](botRef(_0x275959[_0x1df0fd(0x23e)])+'\x20('+_0x275959['mode']+')',_0x1df0fd(0x1c4)+_0x275959['botID'])),_0x728030%_0x360591==0x0&&(_0x591d82[_0x5728b0]=_0x3a02c5,_0x5728b0++);});const _0x154ba5=Markup['inlineKeyboard'](_0x591d82);_0x107ee0[_0x6b1ec(0x2bf)](_0x6b1ec(0x1f1),_0x154ba5);}}),tgBot[_0x375a50(0x1d6)](/toggle_(.+)/,async _0x4472b9=>{const _0x50a2b2=_0x375a50,_0x250076=_0x4472b9[_0x50a2b2(0x1b7)][0x1];_0x4472b9[_0x50a2b2(0x109)]();const _0x4ce5f9=getBotsWithMode(),_0x17c8c2=_0x4ce5f9['find'](_0x244f71=>_0x244f71['botID']==_0x250076),_0x90547=_0x17c8c2[_0x50a2b2(0x25f)]=='auto'?_0x50a2b2(0x249):_0x50a2b2(0x206);await sendTelegram(_0x4472b9[_0x50a2b2(0x2c1)]['id'],'Bot\x20Mgr\x20>\x20Toggling\x20'+botRef(_0x17c8c2[_0x50a2b2(0x23e)])+'\x20to\x20'+_0x90547+_0x50a2b2(0x2a5)),toggleBotMode(_0x250076);}),tgBot[_0x375a50(0xe2)]('names',async _0x479062=>{const _0x2184ba=_0x375a50;let _0x57defa='';config[_0x2184ba(0x1d5)](_0xa67eaf=>{const _0x3d42d5=_0x2184ba;_0x57defa+=_0x3d42d5(0x1a3)+_0xa67eaf[_0x3d42d5(0x23e)]+':\x20'+_0xa67eaf[_0x3d42d5(0x237)]+'\x0a';}),await sendTelegram(_0x479062[_0x2184ba(0x2c1)]['id'],_0x57defa,{'parse_mode':_0x2184ba(0x19e)});}),tgBot[_0x375a50(0xe2)]('help',async _0x5e44ea=>{const _0x532e32=_0x375a50;await sendTelegram(_0x5e44ea[_0x532e32(0x2c1)]['id'],_0x8ef7b6);}),process['once']('SIGINT',()=>tgBot[_0x375a50(0x244)](_0x375a50(0x259))),process['once']('SIGTERM',()=>tgBot[_0x375a50(0x244)](_0x375a50(0x2a7))),tgBot['launch']();}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x2102da,_0x59708b,_0x4eb869){const _0x312bfb=_0x332cff;_0x4eb869={..._0x4eb869,'disable_web_page_preview':!![]};try{await tgBot[_0x312bfb(0xf3)][_0x312bfb(0x176)](_0x2102da,_0x59708b,_0x4eb869);}catch(_0x49e651){logger['debug'](_0x312bfb(0x2b7),_0x49e651);}}function _0x3f5a(){const _0x10d8d7=['/start','login2fa_reject_','send','token','botID','toString','sendFile','args','-----------------------------------------------------------------------------------','All\x20bots\x20running\x20right\x20now','stop','marketcapApi','function','Unauthorized\x20attempt\x20to\x20delete\x20bot','readdirSync','manual','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','mixpanel','\x1b[36m','verify','backup/','split','started','login\x20not\x20required','private','\x20(2)','kill','/restart\x20-\x20restart\x20bot(s)\x0a','Invalid\x20username\x20or\x20IP\x20address','privateKeyFromPem','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','SIGINT','resetpw_no','secure','/backup\x20-\x20receive\x20backup\x20files\x0a','set','user','mode','error','remoteAddress','telegramEvents','6b67f3d61ee94b8f5c80b4affef4c4d9','reload','endsWith','15\x20min','temporary\x20access\x20not\x20allowed','existsSync','access\x20timeout','then','build','disabled','get-starting-balances','inlineKeyboard','yes','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','padStart','portfolio','notification','disconnect','Error\x20while\x20deleting\x20config\x20files:\x20','/help\x20-\x20show\x20available\x20commands\x0a','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','index.html','5\x20min','log','timestamp','rmSync','initclient','config/','43920XyJLFX','on_','kind','config_alerts','127.0.0.1','temporary\x20access\x20timeout','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','connection','clientip','Alerts','randomBytes','request','\x20files\x20over\x20Telegram:','family','Failed\x20to\x20download\x20','allow','telegramUsername','writeFileSync','full','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','generateKeyPair','encryptedUuid','(staging)','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','temporaryAccessAllowed','access','sort','telegramIpApproval','build2','entries','--------------------------------------','(((.+)+)+)+$','lowdb','NTBA_FIX_319','Logged\x20out\x20user\x20...','Starting\x20(','updatebotmanager','Restore\x20process\x20aborted','\x20mode','versions','SIGTERM','util','store','conn','You\x20can\x20use\x20the\x20following\x20commands:\x0a','tempaccess_reject_','get-logs','sign','host','child_process','invalid\x20credentials','\x1b[35m','express-fileupload','/enable\x20-\x20enable\x20notifications\x0a','botmanager','filter','Telegram\x20error:','max','blacklist','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','value','getSeconds','startsWith','defaults','reply','publicKey','chat','Deleted\x20Bot\x20','restart','string','bbvReceive','0.0.0','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','login','Token\x20blacklisted','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','_nsps','stopped','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','::1','inherit','Markdown','/status\x20-\x20show\x20bot(s)\x20status\x0a','toggle-bot-mode','referer','add',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','params','isDirectory','delete-alerts','createWriteStream','|@|','type','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','keys','4377084qpMtur','graphql-request','\x20minutes','No\x20bots\x20running\x20right\x20now','\x20>\x20','join','all','bbUsername','rsa','showConfig','number','Error\x20sending\x20','bot.js','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','update','$1_$2_$3','sendMetricsTelegram','argv','onepagemode','remove','uncaughtException','/names\x20-\x20show\x20bot\x20names\x0a','settings.','command',':\x20Bot\x20Mgr\x20>\x20','login\x20token\x20generated','***','Restarting\x20','bb-settings.json','backup-full.zip','Invalid\x20authentication\x20token\x20(1)','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','unlinkSync','*$1*','Unauthorized\x20attempt\x20to\x20log\x20out','reset-password','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','Bot\x20Mgr\x20>\x20Stopping\x20','Bot\x20Mgr\x20>\x20Starting\x20','latestversion','telegram','stringify','metrics_','/:bot','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','emitHistory','https://api.ipify.org?format=json','password','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','headers','<b>Telegram\x20Bot\x20Status:</b>\x0a','\x20|\x20','Login\x20accepted','Unauthorized\x20login\x20attempt\x20(timeout)','2FA\x20required','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','whitelist','/output-000.log','data','generateAsync','Logged\x20in\x20user\x20...','editMessageReplyMarkup','constructor','secret','bot','environment','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','/upload-backup','Unauthorized\x20attempt\x20to\x20add\x20bot','Running\x20#RED#Balance\x20Bot\x20v','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','message','1683jKeOil','get-portfolio','settings','sockets','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','backup','api-eu.mixpanel.com','sendPortfolioTelegram','listen','get-backup-files','getHours','temporary\x20access\x20rejected','sortBy','whitelistEnabled','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','find','output-001.log','\x20|\x20client:\x20...','Unauthorized\x20attempt\x20to\x20get\x20messages','connected','orders','/:bot/coins','Unauthorized\x20attempt\x20to\x20delete\x20alerts','bbPassword','tkn','Password\x20has\x20been\x20reset\x20to:\x20','Unauthorized\x20attempt\x20to\x20confirm\x20message','path','alerts','cancelLoading','test','reinstall','-performance.json','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','output-000.log','store-settings','1000','binary','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','headless','Disabled\x20','start','button','storeFiat','Ok,\x20will\x20send\x20order\x20notifications\x20only','resetpw_yes','\x20(1)','-events.json','metrics','jsonwebtoken','replyWithDocument','DEFLATE','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','config_all','/:bot/performance','<b>Balance\x20Bot\x20Status:</b>\x0a','min','createServer','-config.json','pidRefreshToken','init','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','removeAllListeners','Starting\x20new\x20bot\x20|\x20Bot\x20','ETH','getStartingBalances','static','handshake','509646VFJEhK','decrypt','apiSecret','create','Backup\x20file\x20uploaded','warning','callback','mkdirSync','jszip','publicKeyToPem','isValid','place-order','Notifications\x20disabled\x0a','bcryptjs','write','enabled','status',')\x20|\x20Bot\x20','Telegraf\x20error:','823460EMCnxX','ipaddr.js','running','simple','event','cancel-loading','sha256','telegraf','/:bot/history','Unauthorized\x20attempt\x20to\x20download\x20','sendMessage','login\x20required','length','name','/update\x20-\x20update\x20Balance\x20Bot\x0a','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','/:bot/configuration','apiKey','All\x20bots','tempaccess_5_','disable','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','config','version.json','backup-full@','.zip','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','telegramChatId','messages','bots','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','date-fns','logout','Invalid\x20authentication\x20token\x20(2)','userid','http','pki','Setting\x20access:\x20','22160hJIKEq','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','new','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','89965AsRPTa','IPv4','ipc','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','pidExpireLogin','show-config','reinstall_no','HTML','env','telegram2FaApproval','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','/:bot/support','Bot\x20','Unauthorized\x20attempt\x20to\x20get\x20events','loadAsync','lastmsgtelegram','172ZGOQiT','189157TKiFrv','server','/download/:type','timeshift','getMonth','store-headless','production','lastmsgemitted','zip/','clients','apiPassword','get','Idling\x20(','temporary\x20token\x20generated','getMinutes','match','privateKey','node-forge','telegramEnabled','restore_no_','1953SfIDKA','file','success','logged\x20out','new-disabled','backup-full','live','Unauthorized\x20attempt\x20to\x20update\x20bot','toggle_','replace','Ok,\x20will\x20send\x20alert\x20notifications\x20only','getFullYear','slice','expiry','socket','bb-config.json','username','placeOrder','size','2FA\x20login\x20required','getDate','port','exec','logs','exit','forEach','action','Access\x20enabled\x20for\x20','isIPv4MappedAddress','************','bbvNew','use','copyFileSync','getTime','f2aRequired','File\x20uploaded','track','Enabled\x20','privateKeyToPem','format','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Yes','Unauthorized\x20attempt\x20to\x20store\x20configuration','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','/on\x20-\x20start\x20bot(s)\x0a','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Password\x20reset\x20rejected','config_orders','\x20only\x0a','compareSync','search','confirm-message','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','post','Error\x20removing\x20old\x20backup\x20files:','telegramToken','files','toIPv4Address','debug','bot-','/disable\x20-\x20disable\x20notifications\x0a','crypto','hex','version','/metrics\x20-\x20show\x20bot\x20performance\x0a','socket.io','#RES#\x20','from','All','http://localhost:','address\x20already\x20in\x20use','::ffff:7f00:1','Error\x20details:','auto','\x20-\x20','catch','2FA\x20login\x20token\x20generated','get-messages','hasOwnProperty','=>\x20Go\x20to\x20#CYA#http://','Bot\x20Mgr\x20>\x20','toggle','/:bot/portfolio','apply','\x1b[33m','Starting\x20#RED#Balance\x20Bot\x20v','Notifications\x20types:\x20','exchange','uuid','-results.json','login\x20token\x20valid','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','telegrammsg','toIPv4MappedAddress','loginRequired','staging','includes','User\x20has\x20been\x20validated','readFileSync','showname','temp/','reset-history','store-configuration','Node.js\x20v','reject','Backup\x20file\x20unzipped\x20and\x20stored','RSA-OAEP','logs/','hashSync','::ffff:127.0.0.1','reason','mtime','emit','bb-secure.json','portfolio_','cloneDeep','address','axios','randomFillSync','push','assign','botname','parse','tempaccess_15_'];_0x3f5a=function(){return _0x10d8d7;};return _0x3f5a();}async function sendTelegramBot(_0x41ba80,_0x1eef09){const _0x172070=_0x332cff;if(settings[_0x172070(0x1ba)]){if(settings['telegramEvents']==_0x172070(0xd1)||(_0x1eef09[_0x172070(0x2db)]==_0x172070(0x260)||_0x1eef09[_0x172070(0x2db)]==_0x172070(0x15e)||_0x1eef09['type']==_0x172070(0x1be))&&settings[_0x172070(0x262)]==_0x172070(0x131)||_0x1eef09['type']=='order'&&settings[_0x172070(0x262)]==_0x172070(0x129)){if(tgBot&&settings['telegramChatId']){if(_0x1eef09[_0x172070(0x221)])await sendTelegram(settings[_0x172070(0x188)],_0x1eef09[_0x172070(0x237)]+_0x172070(0xcf)+_0x1eef09[_0x172070(0x170)]);else await sendTelegram(settings[_0x172070(0x188)],_0x172070(0x1a3)+_0x41ba80+'\x20>\x20'+_0x1eef09[_0x172070(0x170)]);}}}}async function sendTelegramMsg(_0x15ba2a,_0x1a4b7f=_0x332cff(0x19e)){const _0x29fb40=_0x332cff;return tgBot&&settings[_0x29fb40(0x188)]?(await sendTelegram(settings[_0x29fb40(0x188)],_0x15ba2a,{'parse_mode':_0x1a4b7f}),!![]):![];}function getDeviceWithIp(_0x21803b){const _0x17feff=_0x332cff;return devices[_0x17feff(0x124)](_0x95e05=>_0x95e05['ip']===_0x21803b);}async function temporaryAccess2FA(_0x51624e,_0x3a665c){const _0x4b5f7d=_0x332cff;let _0x5096e9=new Date(),_0x26f407=![];if(lastIpApproval){if(_0x5096e9-lastIpApproval<0x1388)_0x26f407=!![];}lastIpApproval=new Date();if(_0x26f407)return;if(tgBot&&settings['telegramChatId']){const _0x52c284=uuidRandom();tmpStorage[_0x52c284]={'uuid':_0x51624e,'externalip':_0x3a665c};const _0x182709=Markup[_0x4b5f7d(0x26e)]([Markup['button'][_0x4b5f7d(0x15f)](_0x4b5f7d(0x279),_0x4b5f7d(0x17f)+_0x52c284),Markup[_0x4b5f7d(0x13f)][_0x4b5f7d(0x15f)](_0x4b5f7d(0x266),_0x4b5f7d(0x239)+_0x52c284),Markup[_0x4b5f7d(0x13f)][_0x4b5f7d(0x15f)]('30\x20min','tempaccess_30_'+_0x52c284),Markup[_0x4b5f7d(0x13f)][_0x4b5f7d(0x15f)](_0x4b5f7d(0x226),_0x4b5f7d(0x2ac)+_0x52c284)]);await sendTelegram(settings[_0x4b5f7d(0x188)],_0x4b5f7d(0x285)+normalizeIP(_0x3a665c)['show']+'\x20?',_0x182709),tgBot[_0x4b5f7d(0x1d6)](/tempaccess_(.+)_(.+)/,async _0x20e449=>{const _0xd61a37=_0x4b5f7d,_0x23b439=_0x20e449[_0xd61a37(0x1b7)][0x1],_0x200246=_0x20e449[_0xd61a37(0x1b7)][0x2],{uuid:_0x9ead5c,externalip:_0x206811}=tmpStorage[_0x200246];delete tmpStorage[_0x200246],_0x20e449[_0xd61a37(0x109)](),devices[_0x9ead5c][_0xd61a37(0x29a)]={'clientip':_0x206811,'timestamp':new Date()[_0xd61a37(0x1dd)](),'expiry':_0x23b439},_0x23b439!=_0xd61a37(0x226)?(await sendTelegram(_0x20e449['chat']['id'],_0xd61a37(0x1d7)+_0x23b439+_0xd61a37(0xcd),{'parse_mode':_0xd61a37(0x19e)}),io['to'](_0x9ead5c)[_0xd61a37(0x22e)](_0xd61a37(0x169),{'access':{'allow':![],'reason':_0xd61a37(0x264),'token':null}})):(await sendTelegram(_0x20e449[_0xd61a37(0x2c1)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x9ead5c)[_0xd61a37(0x22e)](_0xd61a37(0x169),{'access':{'allow':![],'reason':_0xd61a37(0x120),'token':null}}));});}}async function loginAccess2FA(_0x38252c,_0x2b9bc1){const _0x3510b6=_0x332cff;if(tgBot&&settings['telegramChatId']){const _0x3c59f7=uuidRandom();tmpStorage[_0x3c59f7]={'uuid':_0x38252c,'externalip':_0x2b9bc1};const _0x417212=Markup['inlineKeyboard']([Markup[_0x3510b6(0x13f)][_0x3510b6(0x15f)]('accept','login2fa_'+loginExpiry+'_'+_0x3c59f7),Markup['button'][_0x3510b6(0x15f)](_0x3510b6(0x226),_0x3510b6(0x23b)+_0x3c59f7)]);await sendTelegram(settings[_0x3510b6(0x188)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x2b9bc1)['show']+'\x20?',_0x417212),tgBot[_0x3510b6(0x1d6)](/login2fa_(.+)_(.+)/,async _0x1214c4=>{const _0xb5c218=_0x3510b6,_0x2ef10c=_0x1214c4['match'][0x1],_0x5d0ce1=_0x1214c4[_0xb5c218(0x1b7)][0x2],{uuid:_0x5ff2a0,externalip:_0xa18892}=tmpStorage[_0x5d0ce1];delete tmpStorage[_0x5d0ce1],_0x1214c4[_0xb5c218(0x109)](),devices[_0x5ff2a0][_0xb5c218(0x1a0)]={'clientip':_0xa18892,'timestamp':new Date()[_0xb5c218(0x1dd)](),'expiry':_0x2ef10c},_0x2ef10c!=_0xb5c218(0x226)?(await sendTelegram(_0x1214c4[_0xb5c218(0x2c1)]['id'],_0xb5c218(0x100),{'parse_mode':_0xb5c218(0x19e)}),io['to'](_0x5ff2a0)[_0xb5c218(0x22e)]('status',{'access':{'allow':![],'reason':_0xb5c218(0x264),'token':null}})):(await sendTelegram(_0x1214c4[_0xb5c218(0x2c1)]['id'],'Login\x20rejected'),io['to'](_0x5ff2a0)[_0xb5c218(0x22e)](_0xb5c218(0x169),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x201623=_0x332cff;return dbConfig[_0x201623(0x1b3)]('bots')[_0x201623(0x121)](_0x201623(0x23e))[_0x201623(0x2b6)]({'status':_0x201623(0x168)})[_0x201623(0x2bb)]()||[];}function getDisabledBots(){const _0x587c1c=_0x332cff;return dbConfig[_0x587c1c(0x1b3)](_0x587c1c(0x18a))['sortBy']('botID')['filter']({'status':'disabled'})[_0x587c1c(0x2bb)]()||[];}function getBotAttributes(_0x749659){const _0x5d53b7=_0x332cff;let _0x2883dc={};const _0x5062cd=configpath+_0x5d53b7(0x1f8)+_0x749659+_0x5d53b7(0x14f),_0x58cc3a=fs['existsSync'](_0x5062cd);if(_0x58cc3a){const _0x5b89a2=fs[_0x5d53b7(0x220)](_0x5062cd);try{const _0x18d00f=JSON[_0x5d53b7(0x238)](_0x5b89a2),_0x469d8e=_0x18d00f?_0x18d00f[_0x5d53b7(0x10c)][0x0]['headless']:![];_0x2883dc[_0x5d53b7(0x25f)]=_0x469d8e?_0x5d53b7(0x206):_0x5d53b7(0x249),_0x2883dc[_0x5d53b7(0x237)]=_0x18d00f?_0x18d00f[_0x5d53b7(0x10c)][0x0][_0x5d53b7(0x237)]:'Bot\x20'+_0x749659,_0x2883dc[_0x5d53b7(0x221)]=_0x18d00f?_0x18d00f['bot'][0x0][_0x5d53b7(0x221)]:![];}catch(_0x90acf7){_0x2883dc[_0x5d53b7(0x25f)]=_0x5d53b7(0x249),_0x2883dc[_0x5d53b7(0x237)]='Bot\x20'+_0x749659,_0x2883dc[_0x5d53b7(0x221)]=![];}}else _0x2883dc['mode']=_0x5d53b7(0x249),_0x2883dc[_0x5d53b7(0x237)]=_0x5d53b7(0x1a3)+_0x749659,_0x2883dc[_0x5d53b7(0x221)]=![];return _0x2883dc;}function getBotsWithMode(){const _0x3845bb=_0x332cff,_0x2c313d=dbConfig['get'](_0x3845bb(0x18a))[_0x3845bb(0x121)]('botID')[_0x3845bb(0x2bb)]()||[];return _0x2c313d[_0x3845bb(0x1d5)](_0x4bfd68=>{const _0x2d95b6=_0x3845bb;let _0x38e881=getBotAttributes(_0x4bfd68['botID']);_0x4bfd68[_0x2d95b6(0x25f)]=_0x38e881[_0x2d95b6(0x25f)];}),_0x2c313d;}function getBotExchanges(){const _0x282683=_0x332cff;let _0x431ea1=[];const _0x3595b4=dbConfig[_0x282683(0x1b3)](_0x282683(0x18a))[_0x282683(0x121)](_0x282683(0x23e))[_0x282683(0x2bb)]()||[];_0x3595b4[_0x282683(0x1d5)](_0x19d612=>{const _0x8d1741=_0x282683;if(_0x19d612['status']==_0x8d1741(0x168)){const _0x3d1920=configpath+'bot-'+_0x19d612['botID']+_0x8d1741(0x14f),_0xbb5366=fs[_0x8d1741(0x268)](_0x3d1920);let _0x5451c6;if(_0xbb5366){const _0xc1a36a=fs['readFileSync'](_0x3d1920);try{const _0x493735=JSON['parse'](_0xc1a36a);_0x5451c6=_0x493735?_0x493735['bot'][0x0][_0x8d1741(0x214)]:null;}catch(_0x463835){}}if(_0x5451c6)_0x431ea1[_0x8d1741(0x235)](_0x5451c6);}});const _0x25d5a8=[...new Set(_0x431ea1)][_0x282683(0x299)]();return _0x25d5a8;}async function initUser(){const _0x55a259=_0x332cff;if(!settings['userid']){const _0x2f175c=uuidRandom();mixpanel['alias'](_0x2f175c),updateSetting(_0x55a259(0x18f),_0x2f175c);}}async function initSecure(){const _0x532ea1=_0x332cff;let _0x4a0e63=getSecure();if(!_0x4a0e63[_0x532ea1(0x20b)](_0x532ea1(0x10b))){let _0x5cc6a1=await generateKeys();_0x4a0e63[_0x532ea1(0x2c0)]=_0x5cc6a1[_0x532ea1(0x2c0)],_0x4a0e63[_0x532ea1(0x1b8)]=_0x5cc6a1[_0x532ea1(0x1b8)],_0x4a0e63['secret']=crypto[_0x532ea1(0x289)](0x20)[_0x532ea1(0x23f)](_0x532ea1(0x1fb));;storeSecure(_0x4a0e63);}}function getSettings(){const _0x5bb8d4=_0x332cff;return dbSettings['get'](_0x5bb8d4(0x116))[_0x5bb8d4(0x2bb)]()||{};}function getSecure(){const _0x1ae751=_0x332cff;return dbSecure['get'](_0x1ae751(0x25b))[_0x1ae751(0x2bb)]()||{};}function getBlacklist(){const _0x16c6bc=_0x332cff;return dbSecure['get'](_0x16c6bc(0x2b9))[_0x16c6bc(0x2bb)]()||[];}function broadcastToBots(_0x5568a6,_0x503ee3){const _0x5562f4=_0x332cff;config[_0x5562f4(0x1d5)](_0x2d3143=>{const _0x258f9a=_0x5562f4;if(_0x2d3143[_0x258f9a(0x169)]=='enabled'&&_0x2d3143[_0x258f9a(0x1c2)]=='running'||_0x2d3143[_0x258f9a(0x169)]=='new'&&_0x2d3143[_0x258f9a(0x1c2)]==_0x258f9a(0x16e)){if(pid[_0x2d3143['botID']])pid[_0x2d3143[_0x258f9a(0x23e)]][_0x258f9a(0x23c)]({[_0x5568a6]:_0x503ee3});}});}async function storeSettings(_0x56b4d7,_0x4039d9=![]){const _0x2007c1=_0x332cff;_0x56b4d7={...settings,..._0x56b4d7};if(_0x4039d9&&_0x56b4d7['bbPassword']!=_0x2007c1(0x1d9)&&_0x56b4d7['bbPassword']!='***'&&_0x56b4d7[_0x2007c1(0x12c)]!=''){const _0x4e5fbd=decryptRSA(secure['privateKey'],_0x56b4d7[_0x2007c1(0x12c)])['split']('|@|')[0x0],_0x12c87e=bcrypt[_0x2007c1(0x22a)](_0x4e5fbd,saltRounds);_0x56b4d7={..._0x56b4d7,'bbPassword':_0x12c87e};}if(_0x4039d9&&_0x56b4d7[_0x2007c1(0x1f4)]!='************'&&_0x56b4d7[_0x2007c1(0x1f4)]!=_0x2007c1(0xe5)&&_0x56b4d7['telegramToken']!=''){const _0x3861a8=decryptRSA(secure[_0x2007c1(0x1b8)],_0x56b4d7[_0x2007c1(0x1f4)])[_0x2007c1(0x24f)](_0x2007c1(0x2da))[0x0];_0x56b4d7={..._0x56b4d7,'telegramToken':_0x3861a8};}if(_0x4039d9&&_0x56b4d7[_0x2007c1(0x245)]!=_0x2007c1(0x1d9)&&_0x56b4d7[_0x2007c1(0x245)]!=_0x2007c1(0xe5)&&_0x56b4d7[_0x2007c1(0x245)]!=''){const _0x1414f2=decryptRSA(secure['privateKey'],_0x56b4d7[_0x2007c1(0x245)])[_0x2007c1(0x24f)](_0x2007c1(0x2da))[0x0];_0x56b4d7={..._0x56b4d7,'marketcapApi':_0x1414f2};}const _0x4de869=_0x56b4d7[_0x2007c1(0x1f4)]!=_0x2007c1(0x1d9)&&_0x56b4d7[_0x2007c1(0x1f4)]!=settings[_0x2007c1(0x1f4)]||_0x56b4d7[_0x2007c1(0x28f)]!=settings[_0x2007c1(0x28f)],_0x1fbb2a=_0x56b4d7[_0x2007c1(0x1f4)]==''||_0x56b4d7[_0x2007c1(0x28f)]=='',_0x54b3c1=_0x56b4d7['marketcapApi']&&_0x56b4d7[_0x2007c1(0x245)]!=_0x2007c1(0x1d9)&&_0x56b4d7[_0x2007c1(0x245)]!=settings[_0x2007c1(0x245)];_0x4de869&&(_0x56b4d7['telegramChatId']=null,_0x56b4d7[_0x2007c1(0x262)]=_0x2007c1(0xd1));for(const [_0x3064aa,_0x4f7a6a]of Object[_0x2007c1(0x29c)](_0x56b4d7)){if(_0x3064aa==_0x2007c1(0x1f4)&&_0x4f7a6a==_0x2007c1(0x1d9)){_0x56b4d7[_0x2007c1(0x1f4)]=settings[_0x2007c1(0x1f4)];continue;};if(_0x3064aa==_0x2007c1(0x12c)&&_0x4f7a6a=='************'){_0x56b4d7[_0x2007c1(0x12c)]=settings[_0x2007c1(0x12c)];continue;};if(_0x3064aa=='marketcapApi'&&_0x4f7a6a==_0x2007c1(0x1d9)){_0x56b4d7['marketcapApi']=settings[_0x2007c1(0x245)];continue;};dbSettings[_0x2007c1(0x25d)]('settings.'+_0x3064aa,_0x4f7a6a)['write']();}settings=_0x56b4d7,io['to'](_0x2007c1(0x2b5))[_0x2007c1(0x22e)](_0x2007c1(0x116),cleanSettings()),broadcastToBots(_0x2007c1(0x1ab),settings[_0x2007c1(0x1ab)]),broadcastToBots('onepagemode',settings[_0x2007c1(0xdd)]),broadcastToBots(_0x2007c1(0x245),settings[_0x2007c1(0x245)]);if(_0x4de869&&!_0x1fbb2a)initTelegram();_0x4de869&&_0x1fbb2a&&(updateSetting(_0x2007c1(0x188),null),disableTelegram()),getAllClients()[_0x2007c1(0x1d5)](_0x11e568=>{const _0x2c182a=_0x2007c1;getSocket(_0x11e568['id'])['emit'](_0x2c182a(0x169),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x54b3c1&&(await sleep(0xbb8),testMarketcapApi(_0x56b4d7['marketcapApi']));}async function testMarketcapApi(_0x1effba){const _0x56f7a6=_0x332cff,_0x3edc72=['BCT',_0x56f7a6(0x155)];try{await axios['get'](_0x56f7a6(0x13b),{'headers':{'X-CMC_PRO_API_KEY':_0x1effba},'params':{'symbol':_0x3edc72['toString']()}});}catch(_0x5ad82b){_0x5ad82b[_0x56f7a6(0x23f)]()[_0x56f7a6(0x21e)]('status\x20code\x20401')?(io['to'](_0x56f7a6(0x2b5))[_0x56f7a6(0x22e)]('notification',_0x56f7a6(0xf7)),logger[_0x56f7a6(0x291)](_0x56f7a6(0xf7))):(io['to'](_0x56f7a6(0x2b5))[_0x56f7a6(0x22e)]('notification',_0x56f7a6(0x2cd)),logger['full']('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x56f7a6(0x1f7)](_0x56f7a6(0x205),_0x5ad82b[_0x56f7a6(0x23f)]()+_0x56f7a6(0x207)+_0x5ad82b['code']));return;}logger[_0x56f7a6(0x1f7)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x11122d,_0x343a34){const _0x44b49e=_0x332cff;dbSettings['set'](_0x44b49e(0xe1)+_0x11122d,_0x343a34)[_0x44b49e(0x167)](),settings=getSettings(),io['to'](_0x44b49e(0x2b5))['emit'](_0x44b49e(0x116),cleanSettings());}function storeSecure(_0x594ce2){const _0x207a17=_0x332cff;dbSecure[_0x207a17(0x1b3)]('secure')[_0x207a17(0x235)](_0x594ce2)['write'](),secure=_0x594ce2;}function addBlacklist(_0xda5e4d){const _0x576f21=_0x332cff;cleanBlacklist();let _0x1ed1fb;devices[_0xda5e4d][_0x576f21(0x29a)]?_0x1ed1fb=Math[_0x576f21(0x2b8)](devices[_0xda5e4d][_0x576f21(0x29a)][_0x576f21(0x1c9)],loginExpiry):_0x1ed1fb=loginExpiry,dbSecure[_0x576f21(0x1b3)](_0x576f21(0x2b9))[_0x576f21(0x235)]({'expiry':new Date()[_0x576f21(0x1dd)]()+_0x1ed1fb*0x3c*0x3e8,'token':devices[_0xda5e4d][_0x576f21(0x298)]['token']})[_0x576f21(0x167)](),blacklist=dbSecure[_0x576f21(0x1b3)]('blacklist')[_0x576f21(0x2bb)]();}function cleanBlacklist(){const _0x4a4bc5=_0x332cff;let _0x45eca6=dbSecure[_0x4a4bc5(0x1b3)](_0x4a4bc5(0x2b9))[_0x4a4bc5(0x231)]()['value'](),_0x39069f=new Date()[_0x4a4bc5(0x1dd)]();_0x45eca6[_0x4a4bc5(0x1d5)](_0x3b9902=>{const _0x4347d6=_0x4a4bc5;_0x3b9902['expiry']<_0x39069f&&dbSecure[_0x4347d6(0x1b3)](_0x4347d6(0x2b9))[_0x4347d6(0xde)]({'expiry':_0x3b9902[_0x4347d6(0x1c9)]})[_0x4347d6(0x167)]();});}function initStates(){const _0x50c64a=_0x332cff;let _0x11632a=getConfiguration();_0x11632a[_0x50c64a(0x1d5)](_0x3a12ba=>{const _0x47dcf5=_0x50c64a;_0x3a12ba[_0x47dcf5(0x1c2)]=_0x47dcf5(0x2cc);}),storeConfiguration(_0x11632a);}async function generateKeys(){const _0x17b2cc=_0x332cff,_0x5af395=forge[_0x17b2cc(0x191)][_0x17b2cc(0xd3)][_0x17b2cc(0x293)]({'bits':0x1000,'e':0x10001}),_0x1827af=forge[_0x17b2cc(0x191)][_0x17b2cc(0x1e2)](_0x5af395[_0x17b2cc(0x1b8)]),_0x23c07d=forge[_0x17b2cc(0x191)][_0x17b2cc(0x162)](_0x5af395[_0x17b2cc(0x2c0)]);return{'privateKey':_0x1827af,'publicKey':_0x23c07d};}async function oneTimeMigration(){const _0x4825ec=_0x332cff;let _0x1c98c5=getSettings(),_0xa9f9ff=![];!_0x1c98c5[_0x4825ec(0x20b)](_0x4825ec(0x1a6))&&(_0x1c98c5[_0x4825ec(0x1a6)]=0x0,_0xa9f9ff=!![]);!_0x1c98c5[_0x4825ec(0x20b)](_0x4825ec(0x1af))&&(_0x1c98c5[_0x4825ec(0x1af)]=0x0,_0xa9f9ff=!![]);!_0x1c98c5[_0x4825ec(0x20b)](_0x4825ec(0xf2))&&(_0x1c98c5['latestversion']=_0x4825ec(0x2c6),_0xa9f9ff=!![]);!_0x1c98c5['hasOwnProperty'](_0x4825ec(0xdd))&&(_0x1c98c5[_0x4825ec(0xdd)]=![],_0xa9f9ff=!![]);!_0x1c98c5[_0x4825ec(0x20b)]('marketcapApi')&&(_0x1c98c5[_0x4825ec(0x245)]='',_0xa9f9ff=!![]);if(_0xa9f9ff)storeSettings(_0x1c98c5);try{fs[_0x4825ec(0x248)](configbackuppath,{'withFileTypes':!![]})[_0x4825ec(0x1d5)](_0x3f2160=>{const _0x47598d=_0x4825ec;if(!_0x3f2160[_0x47598d(0x2d7)]()){if(!_0x3f2160[_0x47598d(0x179)][_0x47598d(0x2bd)](_0x47598d(0x185)))fs[_0x47598d(0xeb)](configbackuppath+_0x3f2160[_0x47598d(0x179)]);}else fs[_0x47598d(0x27c)](configbackuppath+_0x3f2160[_0x47598d(0x179)],{'recursive':!![]});});}catch(_0x1dbf1c){logger[_0x4825ec(0x1f7)](_0x4825ec(0x1f3),_0x1dbf1c);}}function storeConfiguration(_0x9ad441){const _0x3fa413=_0x332cff;dbConfig[_0x3fa413(0x1b3)](_0x3fa413(0x18a))['remove']()[_0x3fa413(0x167)](),dbConfig[_0x3fa413(0x1b3)](_0x3fa413(0x18a))[_0x3fa413(0x235)](..._0x9ad441)[_0x3fa413(0x167)](),config=_0x9ad441;}async function resetPassword(){const _0x40b512=_0x332cff;if(tgBot&&settings[_0x40b512(0x188)]){const _0x4be6dc=Markup[_0x40b512(0x26e)]([Markup['button']['callback'](_0x40b512(0x26f),_0x40b512(0x142)),Markup[_0x40b512(0x13f)]['callback']('no',_0x40b512(0x25a))]);await sendTelegram(settings[_0x40b512(0x188)],_0x40b512(0x296),_0x4be6dc),tgBot['action'](/resetpw_(.+)/,async _0x28b08f=>{const _0x64456=_0x40b512,_0x5a1a5a=_0x28b08f[_0x64456(0x1b7)][0x1];_0x28b08f[_0x64456(0x109)]();if(_0x5a1a5a!='no'){const _0x1b15bb=0xf,_0x500091='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x5c3ac3=Array[_0x64456(0x200)](crypto[_0x64456(0x234)](new Uint32Array(_0x1b15bb)))['map'](_0x11fbaa=>_0x500091[_0x11fbaa%_0x500091[_0x64456(0x178)]])[_0x64456(0xd0)](''),_0x3b5c4c=bcrypt[_0x64456(0x22a)](_0x5c3ac3,saltRounds);storeSettings({'bbPassword':_0x3b5c4c}),await sendTelegram(_0x28b08f[_0x64456(0x2c1)]['id'],_0x64456(0x12e)+_0x5c3ac3,{'parse_mode':_0x64456(0x19e)});}else await sendTelegram(_0x28b08f[_0x64456(0x2c1)]['id'],_0x64456(0x1eb));});}}async function confirmRestore(_0x4a5aa8,_0x387b9d){const _0x384401=_0x332cff;io['to'](_0x384401(0x2b5))[_0x384401(0x22e)](_0x384401(0x273),_0x384401(0x277),_0x384401(0x1be));if(tgBot&&settings['telegramChatId']){const _0x17db68=uuidRandom();tmpStorage[_0x17db68]={'path':_0x4a5aa8,'filename':_0x387b9d};const _0x1ab317=Markup[_0x384401(0x26e)]([Markup[_0x384401(0x13f)][_0x384401(0x15f)](_0x384401(0x26f),'restore_yes_'+_0x17db68),Markup[_0x384401(0x13f)]['callback']('no',_0x384401(0x1bb)+_0x17db68)]);await sendTelegram(settings['telegramChatId'],_0x384401(0x136),_0x1ab317),tgBot[_0x384401(0x1d6)](/restore_(.+)_(.+)/,async _0x550844=>{const _0x2c4511=_0x384401,_0x27836d=_0x550844[_0x2c4511(0x1b7)][0x1],_0x7f1f9b=_0x550844[_0x2c4511(0x1b7)][0x2],{path:_0x297ac8,filename:_0x385e61}=tmpStorage[_0x7f1f9b];delete tmpStorage[_0x7f1f9b],_0x550844[_0x2c4511(0x109)](),_0x27836d==_0x2c4511(0x26f)?(logger[_0x2c4511(0x1f7)]('Restore\x20process\x20confirmed'),await sendTelegram(_0x550844[_0x2c4511(0x2c1)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':'HTML'}),unzipFile(_0x297ac8,_0x385e61)):(logger['debug']('Restore\x20process\x20aborted'),await sendTelegram(_0x550844[_0x2c4511(0x2c1)]['id'],_0x2c4511(0x2a4)));});}}function getServerTime(){const _0x1450ef=_0x332cff,_0x29f1f9=new Date();return _0x29f1f9['getFullYear']()+'/'+(_0x29f1f9['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x29f1f9[_0x1450ef(0x1d0)]()[_0x1450ef(0x23f)]()[_0x1450ef(0x271)](0x2,'0')+'\x20'+_0x29f1f9[_0x1450ef(0x11f)]()[_0x1450ef(0x23f)]()[_0x1450ef(0x271)](0x2,'0')+':'+_0x29f1f9['getMinutes']()[_0x1450ef(0x23f)]()['padStart'](0x2,'0')+':'+_0x29f1f9[_0x1450ef(0x2bc)]()[_0x1450ef(0x23f)]()[_0x1450ef(0x271)](0x2,'0');}function getTimeStamp(){const _0x291103=_0x332cff,_0x138a6b=shiftedTime();return _0x138a6b[_0x291103(0x1c7)]()+'/'+(_0x138a6b[_0x291103(0x1ac)]()+0x1)[_0x291103(0x23f)]()[_0x291103(0x271)](0x2,'0')+'/'+_0x138a6b[_0x291103(0x1d0)]()['toString']()[_0x291103(0x271)](0x2,'0')+'\x20'+_0x138a6b[_0x291103(0x11f)]()[_0x291103(0x23f)]()[_0x291103(0x271)](0x2,'0')+':'+_0x138a6b[_0x291103(0x1b6)]()[_0x291103(0x23f)]()[_0x291103(0x271)](0x2,'0')+':'+_0x138a6b[_0x291103(0x2bc)]()[_0x291103(0x23f)]()[_0x291103(0x271)](0x2,'0');}function getCleanTimeStamp(){const _0x119818=_0x332cff,_0x36f4d1=shiftedTime();return _0x36f4d1[_0x119818(0x1c7)]()+(_0x36f4d1[_0x119818(0x1ac)]()+0x1)[_0x119818(0x23f)]()[_0x119818(0x271)](0x2,'0')+_0x36f4d1[_0x119818(0x1d0)]()[_0x119818(0x23f)]()[_0x119818(0x271)](0x2,'0')+'-'+_0x36f4d1[_0x119818(0x11f)]()[_0x119818(0x23f)]()[_0x119818(0x271)](0x2,'0')+_0x36f4d1[_0x119818(0x1b6)]()[_0x119818(0x23f)]()[_0x119818(0x271)](0x2,'0')+_0x36f4d1[_0x119818(0x2bc)]()[_0x119818(0x23f)]()[_0x119818(0x271)](0x2,'0');}function shiftedTime(){const _0x4efd9e=_0x332cff,_0x4e05c7=new Date();let _0x1b52ce=_0x4e05c7;if(settings[_0x4efd9e(0x1ab)]&&settings[_0x4efd9e(0x1ab)]!==0x0)_0x1b52ce=fns[_0x4efd9e(0x2d4)](_0x4e05c7,{'hours':settings[_0x4efd9e(0x1ab)]});return _0x1b52ce;}async function startScheduler(){const _0x5517ca=_0x332cff,_0x156e87=new Date()['getUTCHours'](),_0x49cec2=shiftedTime()['getHours']();_0x49cec2==0x4&&backupConfigFiles(),_0x49cec2==0x0&&(rotateLogFiles(),logger[_0x5517ca(0x1f7)](_0x5517ca(0x29d)),logger[_0x5517ca(0x1f7)](_0x5517ca(0x111)+serverversion+_0x5517ca(0x1ff)+(environment=='staging'?_0x5517ca(0x295):'')),logger[_0x5517ca(0x1f7)](_0x5517ca(0x29d))),_0x156e87%0x6==0x0&&triggerAnalytics(),_0x156e87%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x2d024d){const _0x47ec78=_0x332cff;logger[_0x47ec78(0x1f7)]('Restore\x20backup\x20file\x20'+_0x2d024d);const _0x5efdf7=getBotsWithMode();_0x5efdf7['length']>0x0?confirmRestore(configbackuppath,_0x2d024d):unzipFile(configbackuppath,_0x2d024d);}async function getBackupFiles(_0x2f8f4d=null){const _0x4942e0=_0x332cff;let _0x1d652e=[],_0x49bcea=fs[_0x4942e0(0x248)](configbackuppath,{'withFileTypes':!![]});_0x49bcea[_0x4942e0(0x299)]((_0x23081b,_0x6228e4)=>_0x23081b['name']<_0x6228e4[_0x4942e0(0x179)]?0x1:_0x6228e4[_0x4942e0(0x179)]<_0x23081b[_0x4942e0(0x179)]?-0x1:0x0),_0x49bcea[_0x4942e0(0x1d5)](_0x42a791=>{const _0x2dea8d=_0x4942e0;if(!_0x42a791[_0x2dea8d(0x2d7)]()&&_0x42a791['name'][_0x2dea8d(0x2bd)](_0x2dea8d(0x185))&&_0x42a791[_0x2dea8d(0x179)][_0x2dea8d(0x265)](_0x2dea8d(0x186))){const _0x152b81=formatDate(fs['statSync'](configbackuppath+_0x42a791['name'])[_0x2dea8d(0x22d)]);_0x1d652e[_0x2dea8d(0x235)]({'name':_0x42a791['name'],'mtime':_0x152b81});}});if(_0x2f8f4d)io['to'](_0x2f8f4d)[_0x4942e0(0x22e)]('backup-files',_0x1d652e);else return _0x1d652e;}async function backupConfigFiles(){const _0x5e7fba=_0x332cff;await zipFiles(_0x5e7fba(0x1c1));const _0x4ffdd3=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x5e7fba(0xe8),configbackuppath+(_0x5e7fba(0x185)+_0x4ffdd3+_0x5e7fba(0x186)));let _0x90a456=fs[_0x5e7fba(0x248)](configbackuppath,{'withFileTypes':!![]});_0x90a456[_0x5e7fba(0x299)]((_0x24e564,_0x5dd87f)=>_0x24e564[_0x5e7fba(0x179)]<_0x5dd87f[_0x5e7fba(0x179)]?0x1:_0x5dd87f[_0x5e7fba(0x179)]<_0x24e564[_0x5e7fba(0x179)]?-0x1:0x0),_0x90a456[_0x5e7fba(0x178)]>maxBackups&&fs[_0x5e7fba(0xeb)](configbackuppath+_0x90a456[_0x90a456[_0x5e7fba(0x178)]-0x1]['name']);}function rotateLogFiles(){const _0x22d3f1=_0x332cff,_0x4df801=fs['statSync'](logspath+_0x22d3f1(0x137)),_0x47c97e=_0x4df801[_0x22d3f1(0x1ce)]/0x400;if(_0x47c97e>0x64){let _0x5f3bfe=fs[_0x22d3f1(0x248)](logspath,{'withFileTypes':!![]});_0x5f3bfe['sort']((_0x5e9c96,_0x269260)=>_0x5e9c96[_0x22d3f1(0x179)]<_0x269260[_0x22d3f1(0x179)]?0x1:_0x269260[_0x22d3f1(0x179)]<_0x5e9c96['name']?-0x1:0x0),_0x5f3bfe['forEach'](_0x2033a1=>{const _0x49adf1=_0x22d3f1;if(_0x2033a1[_0x49adf1(0x179)]=='output-002.log')fs[_0x49adf1(0x1dc)](logspath+_0x2033a1[_0x49adf1(0x179)],logspath+'output-003.log');if(_0x2033a1[_0x49adf1(0x179)]==_0x49adf1(0x125))fs['copyFileSync'](logspath+_0x2033a1[_0x49adf1(0x179)],logspath+'output-002.log');_0x2033a1[_0x49adf1(0x179)]==_0x49adf1(0x137)&&(fs[_0x49adf1(0x1dc)](logspath+_0x2033a1[_0x49adf1(0x179)],logspath+_0x49adf1(0x125)),fs['writeFileSync'](logspath+_0x2033a1[_0x49adf1(0x179)],''));});}}async function zipFiles(_0x3ca2da){const _0x7a87f0=_0x332cff;let _0x424f66;if(_0x3ca2da==_0x7a87f0(0x1d3))_0x424f66=logspath;if(_0x3ca2da==_0x7a87f0(0x11a))_0x424f66=configpath;if(_0x3ca2da==_0x7a87f0(0x1c1))_0x424f66=configpath;let _0x579e8a=fs[_0x7a87f0(0x248)](_0x424f66,{'withFileTypes':!![]});const _0x2c922e=new JSZip();_0x579e8a[_0x7a87f0(0x1d5)](_0x2441b8=>{const _0x861668=_0x7a87f0;if(!_0x2441b8[_0x861668(0x2d7)]()){let _0x4952b2=fs[_0x861668(0x220)](_0x424f66+_0x2441b8[_0x861668(0x179)]);if(_0x3ca2da==_0x861668(0x11a)){const _0x6129fb=/^bot-[0-9]{3}-config.json$/,_0x43df7d=_0x6129fb[_0x861668(0x133)](_0x2441b8['name']);if(_0x43df7d){const _0x93f920=JSON[_0x861668(0x238)](_0x4952b2);if(_0x93f920[_0x861668(0x10c)][0x0]){_0x93f920[_0x861668(0x10c)][0x0][_0x861668(0x17d)]=_0x861668(0xe5),_0x93f920[_0x861668(0x10c)][0x0][_0x861668(0x15b)]='***';if(_0x93f920[_0x861668(0x10c)][0x0][_0x861668(0x1b2)])_0x93f920[_0x861668(0x10c)][0x0][_0x861668(0x1b2)]=_0x861668(0xe5);}_0x4952b2=JSON[_0x861668(0xf4)](_0x93f920,null,0x2);}if(_0x2441b8[_0x861668(0x179)]==_0x861668(0xe7)){const _0x45168f=JSON[_0x861668(0x238)](_0x4952b2);if(_0x45168f[_0x861668(0x116)]['loginRequired'])_0x45168f[_0x861668(0x116)][_0x861668(0x21c)]=![];if(_0x45168f[_0x861668(0x116)]['bbPassword'])_0x45168f[_0x861668(0x116)][_0x861668(0x12c)]=_0x861668(0xe5);if(_0x45168f[_0x861668(0x116)]['telegramToken'])_0x45168f['settings'][_0x861668(0x1f4)]=_0x861668(0xe5);if(_0x45168f[_0x861668(0x116)][_0x861668(0x188)])_0x45168f[_0x861668(0x116)][_0x861668(0x188)]=null;if(_0x45168f[_0x861668(0x116)][_0x861668(0x245)])_0x45168f[_0x861668(0x116)]['marketcapApi']=_0x861668(0xe5);_0x4952b2=JSON[_0x861668(0xf4)](_0x45168f,null,0x2);}if(_0x2441b8['name']!=_0x861668(0x22f))_0x2c922e['file'](_0x2441b8['name'],_0x4952b2);}else _0x2c922e[_0x861668(0x1bd)](_0x2441b8[_0x861668(0x179)],_0x4952b2);}});const _0x292a20=await _0x2c922e[_0x7a87f0(0x107)]({'type':_0x7a87f0(0x2c4),'base64':![],'compression':_0x7a87f0(0x148)});fs[_0x7a87f0(0x290)](zippath+(_0x3ca2da+_0x7a87f0(0x186)),_0x292a20,_0x7a87f0(0x13a));}async function unzipFile(_0x2c8227,_0x6104c3){const _0x5a636f=_0x332cff;fs[_0x5a636f(0x248)](configpath,{'withFileTypes':!![]})[_0x5a636f(0x1d5)](_0x58ff7f=>{const _0x321870=_0x5a636f;if(!_0x58ff7f['isDirectory']())fs[_0x321870(0x27c)](configpath+_0x58ff7f[_0x321870(0x179)]);});const _0x2a9435=fs['readFileSync'](_0x2c8227+_0x6104c3,'binary'),_0x282b1b=await JSZip[_0x5a636f(0x1a5)](_0x2a9435,{'base64':![],'checkCRC32':!![]});for(const _0x110f8b of Object['keys'](_0x282b1b[_0x5a636f(0x1f5)])){const _0x3b6a41=_0x282b1b[_0x5a636f(0x1f5)][_0x110f8b],_0x293a1e=await _0x3b6a41['async'](_0x5a636f(0x2c4));fs[_0x5a636f(0x290)](configpath+_0x3b6a41[_0x5a636f(0x179)],_0x293a1e);}fs[_0x5a636f(0x248)](temppath,{'withFileTypes':!![]})[_0x5a636f(0x1d5)](_0x346467=>{const _0x4df4d7=_0x5a636f;if(!_0x346467[_0x4df4d7(0x2d7)]())fs[_0x4df4d7(0x27c)](temppath+_0x346467[_0x4df4d7(0x179)]);}),logger[_0x5a636f(0x1f7)](_0x5a636f(0x227)),process[_0x5a636f(0x23c)]({'restore':!![]},_0x50de9a=>{});}async function getPublicIp(){const _0x51f240=_0x332cff;try{const _0x19366c=await axios[_0x51f240(0x1b3)](_0x51f240(0xf9));publicip=_0x19366c[_0x51f240(0x106)]['ip'];}catch(_0x2cd82e){}}async function triggerAnalytics(){const _0x20578e=_0x332cff;if(!publicip)await getPublicIp();const _0x21d354=getBotsWithMode();let _0x1a5f12=0x0;_0x21d354['forEach'](_0x5097ed=>{const _0x3cd158=_0x556d;if(_0x5097ed['status']===_0x3cd158(0x168))_0x1a5f12++;});const _0x3426a1=getBotExchanges();mixpanel[_0x20578e(0x1e0)]('Server',{'distinct_id':settings[_0x20578e(0x18f)],'ip':publicip,'version':serverversion,'numbots':_0x21d354[_0x20578e(0x178)],'numbotsenabled':_0x1a5f12,'exchanges':_0x3426a1,'environment':environment});}async function getMessages(){const _0x5e57e3=_0x332cff,_0x30e1dc='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x37d377=new GraphQLClient(_0x30e1dc),_0x38835e={'authorization':_0x5e57e3(0x187)},_0x800de8=serverversion[_0x5e57e3(0x24f)]('.'),_0x16163d=_0x800de8[0x0]+'.'+_0x800de8[0x1],_0x3191b7=Math[_0x5e57e3(0x14d)](settings['lastmsgtelegram'],settings[_0x5e57e3(0x1af)]),_0x53c81e={'last':parseInt(_0x3191b7),'bbm':_0x16163d},_0xaf96b8=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xa046c6;try{_0xa046c6=await _0x37d377[_0x5e57e3(0x28a)](_0xaf96b8,_0x53c81e,_0x38835e);}catch(_0x121a0f){}if(_0xa046c6&&_0xa046c6[_0x5e57e3(0x189)]){let _0x27d729=settings[_0x5e57e3(0x1a6)],_0x4c4cf6=settings[_0x5e57e3(0x1a6)];newMessages=[];for(const _0x36df36 of _0xa046c6[_0x5e57e3(0x189)]){newMessages[_0x5e57e3(0x235)](_0x36df36);let _0x2d37e9=![];_0x36df36[_0x5e57e3(0x1da)]&&(updateSetting(_0x5e57e3(0xf2),_0x36df36[_0x5e57e3(0x1da)]),_0x2d37e9=isNewerVersion(serverversion,_0x36df36[_0x5e57e3(0x1da)])||serverversion==_0x36df36[_0x5e57e3(0x1da)]);if(!_0x2d37e9&&_0x36df36[_0x5e57e3(0xd5)]>_0x27d729){if(_0x36df36[_0x5e57e3(0x2c5)]==='any'||serverversion['startsWith'](_0x36df36[_0x5e57e3(0x2c5)])){let _0x39db58=''+_0x36df36['title']+'\x0a\x0a'+_0x36df36['message'];const _0x3fdde7=await sendTelegramMsg(toTelegramMarkdown(_0x39db58),_0x5e57e3(0x2d0));_0x27d729=_0x36df36[_0x5e57e3(0xd5)];}}_0x4c4cf6=_0x36df36['number'];}updateAvailable=isNewerVersion(settings[_0x5e57e3(0xf2)],serverversion),updateSetting(_0x5e57e3(0x1a6),_0x4c4cf6),emitMessages();}}function emitMessages(){const _0x24ff9e=_0x332cff,_0x29068c=settings[_0x24ff9e(0x1af)];let _0x1f08db=[];newMessages[_0x24ff9e(0x1d5)](_0x9cc0db=>{const _0x31effc=_0x24ff9e;_0x9cc0db[_0x31effc(0xd5)]>_0x29068c&&_0x1f08db[_0x31effc(0x235)](_0x9cc0db);}),_0x1f08db[_0x24ff9e(0x178)]>0x0&&getAllClients()[_0x24ff9e(0x1d5)](_0x33e9e1=>{const _0x25f3a1=_0x24ff9e;getSocket(_0x33e9e1['id'])[_0x25f3a1(0x22e)](_0x25f3a1(0x113),_0x1f08db);});}function confirmMessage(_0x35a8eb){const _0x3742f8=_0x332cff;updateSetting(_0x3742f8(0x1af),Number(_0x35a8eb));}function isNewerVersion(_0x299982,_0x29e9a9){const _0x20fcbf=_0x332cff,_0x8b3e61=_0x29e9a9['split']('.'),_0x3fc969=_0x299982[_0x20fcbf(0x24f)]('.');for(var _0x1c492f=0x0;_0x1c492f<_0x3fc969[_0x20fcbf(0x178)];_0x1c492f++){const _0x31fbf9=~~_0x3fc969[_0x1c492f],_0x16c3f3=~~_0x8b3e61[_0x1c492f];if(_0x31fbf9>_0x16c3f3)return!![];if(_0x31fbf9<_0x16c3f3)return![];}return![];}function toTelegramMarkdown(_0x2a77af){const _0x3617ef=_0x332cff,_0x507567=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x5a44d2=/\*{2}(.+?)\*{2}/gim;return _0x2a77af=_0x2a77af[_0x3617ef(0x1c5)](_0x507567,_0x3617ef(0xda))[_0x3617ef(0x1c5)](_0x5a44d2,_0x3617ef(0xec)),_0x2a77af;}async function validateConfigFile(){const _0x3518f4=_0x332cff,_0x417264=dbConfig[_0x3518f4(0x1b3)](_0x3518f4(0x18a))[_0x3518f4(0x121)](_0x3518f4(0x23e))['value']()||[];if(_0x417264['length']==0x0){let _0x43d845=0x0,_0x4c5606=[];const _0x3f6990=/^bot-([0-9]{3})-config.json$/,_0x345384=fs[_0x3518f4(0x248)](configpath);_0x345384['forEach'](_0x361096=>{const _0xc8aa7a=_0x3518f4,_0x24ece5=_0x3f6990[_0xc8aa7a(0x1d2)](_0x361096);if(_0x24ece5){const _0x1d2949=_0x24ece5[0x1];let _0x446289=getBotAttributes(_0x1d2949);_0x4c5606[_0xc8aa7a(0x235)]({'botID':_0x1d2949,'botname':_0x446289[_0xc8aa7a(0x237)],'status':'disabled','live':_0xc8aa7a(0x2cc)}),_0x43d845++;}}),_0x43d845!=0x0&&(dbConfig[_0x3518f4(0x1b3)](_0x3518f4(0x18a))[_0x3518f4(0x236)](_0x4c5606)[_0x3518f4(0x167)](),config=_0x4c5606,restoredConfigFile=_0x43d845);}}async function restoreConfigNotify(_0x54935e){const _0xa90ab0=_0x332cff;let _0x299148;if(restoredConfigFile==0x1)_0x299148=_0xa90ab0(0x218);else _0x299148=_0xa90ab0(0x292);if(_0x54935e)io['to'](_0xa90ab0(0x2b5))[_0xa90ab0(0x22e)](_0xa90ab0(0x273),_0x299148);else{logger[_0xa90ab0(0x16f)](_0xa90ab0(0x242)),logger[_0xa90ab0(0x16f)](_0x299148),logger[_0xa90ab0(0x16f)]('-----------------------------------------------------------------------------------'),logger[_0xa90ab0(0x16f)]('');if(tgBot&&settings[_0xa90ab0(0x188)]&&settings['telegramEvents']!=_0xa90ab0(0x129))await sendTelegram(settings[_0xa90ab0(0x188)],_0xa90ab0(0x20d)+_0x299148);}}function decryptRSA(_0x43c8a6,_0x568f8e){const _0x261606=_0x332cff,_0x183941=forge[_0x261606(0x191)][_0x261606(0x257)](_0x43c8a6),_0x4c9272=_0x183941[_0x261606(0x15a)](forge['util']['decode64'](_0x568f8e),_0x261606(0x228),{'md':forge['md'][_0x261606(0x172)][_0x261606(0x15c)](),'mgf1':{'md':forge['md'][_0x261606(0x172)][_0x261606(0x15c)]()}});return _0x4c9272;}function validateCredentials(_0x150cee,_0x2ce8b9){const _0x2da03a=_0x332cff;if(_0x150cee[_0x2da03a(0x1cc)]==settings['bbUsername']&&bcrypt[_0x2da03a(0x1ee)](_0x150cee[_0x2da03a(0xfa)],settings['bbPassword'])){if(settings[_0x2da03a(0x1de)])return{'allow':![],'reason':_0x2da03a(0x1cf),'token':null};else{const _0x12b870=generateLoginToken(_0x2ce8b9);return{'allow':!![],'reason':_0x2da03a(0xe4),'token':_0x12b870};}}else return{'allow':![],'reason':_0x2da03a(0x2b1),'token':null};}function refreshToken(_0x2cf5bc){const _0x4b7e46=generateLoginToken(_0x2cf5bc);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x4b7e46};}function validateAccess(_0x4f9853,_0x37daf0,_0x43ac0a){const _0x34afba=_0x332cff,_0x5cdec1=_0x43ac0a?_0x43ac0a:devices[_0x37daf0]['ip'];let _0x1217de;const _0x50414f=_0x2c13c6=>{const _0x2080c7=_0x556d;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0x37daf0)){const _0x240a54=generateLoginToken(_0x37daf0);return{'allow':!![],'reason':_0x2080c7(0x209),'token':_0x240a54};}else return{'allow':![],'reason':_0x2080c7(0x177),'token':null};}else return _0x1217de=validToken(_0x2c13c6,_0x37daf0),_0x1217de['hasOwnProperty'](_0x2080c7(0x1be))?{'allow':!![],'reason':_0x2080c7(0x217),'token':_0x2c13c6}:{'allow':![],'reason':_0x2080c7(0x177),'token':null};}else return{'allow':!![],'reason':_0x2080c7(0x251),'token':null};};if(settings[_0x34afba(0x122)]){let _0x44034c=[...settings[_0x34afba(0x104)],_0x34afba(0x2ce),_0x34afba(0x22b),_0x34afba(0x283),_0x34afba(0x204)];if(_0x44034c[_0x34afba(0x21e)](_0x5cdec1))return _0x50414f(_0x4f9853);else{_0x1217de=validToken(_0x4f9853,_0x37daf0);if(_0x1217de[_0x34afba(0x20b)](_0x34afba(0x1be)))return _0x50414f(_0x4f9853);else{if(telegramIpApproved(_0x37daf0)){const _0x125c00=generateToken(_0x37daf0);return _0x1217de=_0x50414f(_0x4f9853),_0x1217de[_0x34afba(0x28e)]?{'allow':!![],'reason':_0x34afba(0x1b5),'token':_0x125c00}:_0x1217de;}else return settings[_0x34afba(0x297)]?{'allow':![],'reason':_0x34afba(0x102),'token':null}:{'allow':![],'reason':_0x34afba(0x267),'token':null};}}}else return _0x50414f(_0x4f9853);}function timelyDecrypt(_0x200fc2,_0x2de561,_0x1d1f81='@'){const _0x4d3d34=_0x332cff;if(_0x200fc2)try{const _0x53849d=decryptRSA(secure[_0x4d3d34(0x1b8)],_0x200fc2),_0x2516f0=_0x53849d[_0x4d3d34(0x24f)](_0x1d1f81)[0x0],_0x21423d=_0x53849d[_0x4d3d34(0x24f)](_0x1d1f81)[0x1],_0x1d635c=new Date()[_0x4d3d34(0x1dd)]();if(_0x2de561){if(_0x1d635c-_0x21423d<maxSecretAge*0x3e8)return _0x2516f0;else return![];}else return _0x2516f0;}catch(_0xe30760){return![];}else return![];}const validToken=(_0x372e35,_0x5c12e0)=>{const _0x1d9216=_0x332cff,_0x31fe0a=devices[_0x5c12e0]['ip'];if(!_0x372e35)return{'error':'No\x20authentication\x20token'};for(let _0x4b8db7 of blacklist){if(_0x4b8db7['token']==_0x372e35)return{'error':_0x1d9216(0x2c9)};}let _0x5bd729;try{_0x5bd729=jwt[_0x1d9216(0x24d)](_0x372e35,secure[_0x1d9216(0x10b)]+_0x5c12e0);}catch{return{'error':_0x1d9216(0xe9)};}if(!_0x5bd729[_0x1d9216(0x20b)]('clientip')&&!_0x5bd729[_0x1d9216(0x20b)](_0x1d9216(0x1cc))||!_0x5bd729[_0x1d9216(0x20b)]('exp'))return{'error':_0x1d9216(0x18e)};if(!_0x5bd729[_0x1d9216(0x20b)](_0x1d9216(0x1cc))&&_0x5bd729['hasOwnProperty'](_0x1d9216(0x287))){const {clientip:_0x55b08a}=_0x5bd729;return _0x31fe0a==_0x55b08a?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x5bd729[_0x1d9216(0x20b)](_0x1d9216(0x1cc))&&_0x5bd729[_0x1d9216(0x20b)](_0x1d9216(0x287))){const {username:_0x48ad56,clientip:_0x50158a}=_0x5bd729;return settings[_0x1d9216(0xd2)]==_0x48ad56&&_0x31fe0a==_0x50158a?{'success':_0x1d9216(0x21f)}:{'error':_0x1d9216(0x256)};}}},generateLoginToken=_0x21b50f=>{const _0x56394e=_0x332cff;if(_0x21b50f){const _0x2b21ab=devices[_0x21b50f]['ip'];return jwt[_0x56394e(0x2ae)]({'username':settings[_0x56394e(0xd2)],'clientip':_0x2b21ab},secure[_0x56394e(0x10b)]+_0x21b50f,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x1fd9fc=>{const _0x2b416f=_0x332cff;if(_0x1fd9fc){const _0x194594=devices[_0x1fd9fc]['ip'];return jwt[_0x2b416f(0x2ae)]({'clientip':_0x194594},secure[_0x2b416f(0x10b)]+_0x1fd9fc,{'expiresIn':devices[_0x1fd9fc][_0x2b416f(0x29a)][_0x2b416f(0x1c9)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x24e7cc=>{const _0x115cf3=_0x332cff;let _0x36f13c=![];return devices[_0x24e7cc]['telegramIpApproval']&&devices[_0x24e7cc][_0x115cf3(0x29a)][_0x115cf3(0x1c9)]!='reject'&&(_0x36f13c=devices[_0x24e7cc]['telegramIpApproval'][_0x115cf3(0x287)]==devices[_0x24e7cc]['ip']&&new Date()[_0x115cf3(0x1dd)]()-devices[_0x24e7cc]['telegramIpApproval'][_0x115cf3(0x27b)]<devices[_0x24e7cc][_0x115cf3(0x29a)][_0x115cf3(0x1c9)]*0x3c*0x3e8),_0x36f13c;},telegram2FaApproved=_0x454bf9=>{const _0x4ffdea=_0x332cff;let _0x44de0d=![];return devices[_0x454bf9][_0x4ffdea(0x1a0)]&&devices[_0x454bf9][_0x4ffdea(0x1a0)][_0x4ffdea(0x1c9)]!=_0x4ffdea(0x226)&&(_0x44de0d=devices[_0x454bf9][_0x4ffdea(0x1a0)][_0x4ffdea(0x287)]==devices[_0x454bf9]['ip']&&new Date()[_0x4ffdea(0x1dd)]()-devices[_0x454bf9][_0x4ffdea(0x1a0)][_0x4ffdea(0x27b)]<devices[_0x454bf9][_0x4ffdea(0x1a0)][_0x4ffdea(0x1c9)]*0x3c*0x3e8),_0x44de0d;},normalizeIP=_0x11960e=>{const _0x4e020d=_0x332cff;let _0x1743f4=null,_0x12d304=null;if(ipaddr[_0x4e020d(0x163)](_0x11960e)){const _0x3db69e=ipaddr[_0x4e020d(0x238)](_0x11960e);_0x3db69e[_0x4e020d(0x281)]()==='ipv6'?(_0x3db69e[_0x4e020d(0x1d8)]()&&(_0x1743f4=_0x3db69e[_0x4e020d(0x1f6)]()[_0x4e020d(0x23f)]()),_0x12d304=_0x3db69e[_0x4e020d(0x23f)]()):(_0x1743f4=_0x3db69e[_0x4e020d(0x23f)](),_0x12d304=_0x3db69e[_0x4e020d(0x21b)]()[_0x4e020d(0x23f)]());}return{'show':_0x1743f4?_0x1743f4:_0x12d304,'store':_0x12d304};};function formatDate(_0x4f13ec){const _0xd245fd=_0x332cff;return _0x4f13ec[_0xd245fd(0x1c7)]()+'/'+(_0x4f13ec[_0xd245fd(0x1ac)]()+0x1)[_0xd245fd(0x23f)]()['padStart'](0x2,'0')+'/'+_0x4f13ec[_0xd245fd(0x1d0)]()['toString']()[_0xd245fd(0x271)](0x2,'0')+'\x20'+_0x4f13ec[_0xd245fd(0x11f)]()['toString']()[_0xd245fd(0x271)](0x2,'0')+':'+_0x4f13ec[_0xd245fd(0x1b6)]()[_0xd245fd(0x23f)]()[_0xd245fd(0x271)](0x2,'0')+':'+_0x4f13ec['getSeconds']()[_0xd245fd(0x23f)]()[_0xd245fd(0x271)](0x2,'0');}function sleep(_0x521316){return new Promise(_0x500460=>setTimeout(_0x500460,_0x521316));}