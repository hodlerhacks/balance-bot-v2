const _0x1354cc=_0x4878;(function(_0x3f5b91,_0x10a301){const _0x3ae871=_0x4878,_0x32a51d=_0x3f5b91();while(!![]){try{const _0x6c615b=-parseInt(_0x3ae871(0x355))/0x1+-parseInt(_0x3ae871(0x1e5))/0x2*(parseInt(_0x3ae871(0x27e))/0x3)+parseInt(_0x3ae871(0x2fa))/0x4+parseInt(_0x3ae871(0x352))/0x5+-parseInt(_0x3ae871(0x34f))/0x6*(-parseInt(_0x3ae871(0x1e1))/0x7)+parseInt(_0x3ae871(0x217))/0x8+parseInt(_0x3ae871(0x196))/0x9*(parseInt(_0x3ae871(0x233))/0xa);if(_0x6c615b===_0x10a301)break;else _0x32a51d['push'](_0x32a51d['shift']());}catch(_0x1b159f){_0x32a51d['push'](_0x32a51d['shift']());}}}(_0x5022,0x24a17));const _0x3dec2a=function(){let _0x1b9b10=!![];return function(_0x2073a2,_0x138493){const _0x11b6f7=_0x1b9b10?function(){const _0x391f5e=_0x4878;if(_0x138493){const _0x5c6a75=_0x138493[_0x391f5e(0x351)](_0x2073a2,arguments);return _0x138493=null,_0x5c6a75;}}:function(){};return _0x1b9b10=![],_0x11b6f7;};}(),_0x597d08=_0x3dec2a(this,function(){const _0x1ea4bb=_0x4878;return _0x597d08['toString']()[_0x1ea4bb(0x2f4)](_0x1ea4bb(0x366))['toString']()[_0x1ea4bb(0x346)](_0x597d08)[_0x1ea4bb(0x2f4)](_0x1ea4bb(0x366));});_0x597d08();'use strict';process['env'][_0x1354cc(0x26b)]=0x1;const childProcess=require(_0x1354cc(0x315)),fs=require('fs'),fns=require(_0x1354cc(0x21a)),low=require(_0x1354cc(0x30e)),FileSync=require(_0x1354cc(0x1e7)),path=require(_0x1354cc(0x350)),crypto=require('crypto'),forge=require(_0x1354cc(0x38e)),bcrypt=require('bcryptjs'),jwt=require(_0x1354cc(0x206)),ipaddr=require(_0x1354cc(0x287)),yargs=require(_0x1354cc(0x259)),uuidRandom=require(_0x1354cc(0x271)),{Telegraf,Markup}=require(_0x1354cc(0x199)),Mixpanel=require(_0x1354cc(0x2f9)),axios=require(_0x1354cc(0x38a)),{GraphQLClient,gql}=require(_0x1354cc(0x203)),util=require(_0x1354cc(0x1bc)),fileUpload=require(_0x1354cc(0x1f2)),{networkInterfaces}=require('os'),JSZip=require(_0x1354cc(0x329)),argv=yargs(process[_0x1354cc(0x268)]['slice'](0x2))['argv'],PORT=argv[_0x1354cc(0x1a2)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x1354cc(0x2b5)](PORT)&&(console[_0x1354cc(0x31d)](_0x1354cc(0x26a)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv['host']||null,userID=argv[_0x1354cc(0x34d)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process['versions'][_0x1354cc(0x1d9)];let bbpath='bb/',bbpath2='';const botfile=_0x1354cc(0x269),configfile='bb-config.json',settingsfile=_0x1354cc(0x1d1),securefile=_0x1354cc(0x258),environment=require('./'+bbpath2+_0x1354cc(0x289))[_0x1354cc(0x37e)]||_0x1354cc(0x1ca),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x1354cc(0x313)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x1354cc(0x283)),configpath=userID?bbpath+_0x1354cc(0x321)+userID+'/':bbpath+_0x1354cc(0x321),configbackuppath=configpath+_0x1354cc(0x363),logspath=userID?bbpath+_0x1354cc(0x2c8)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x1354cc(0x34b)+userID+'/':bbpath+_0x1354cc(0x34b),loggerfile=fs[_0x1354cc(0x1c8)](logspath+_0x1354cc(0x27b),{'flags':'a'}),temppath=userID?bbpath+_0x1354cc(0x331)+userID+'/':bbpath+_0x1354cc(0x331);!fs[_0x1354cc(0x313)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x1354cc(0x313)](configbackuppath)&&fs[_0x1354cc(0x35e)](configbackuppath);!fs[_0x1354cc(0x313)](logspath)&&fs[_0x1354cc(0x35e)](logspath);!fs[_0x1354cc(0x313)](zippath)&&fs[_0x1354cc(0x35e)](zippath);!fs[_0x1354cc(0x313)](temppath)&&fs[_0x1354cc(0x35e)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x1354cc(0x18c)]({'bots':[]})[_0x1354cc(0x36c)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x1354cc(0x18c)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x1354cc(0x371),'onepagemode':![],'marketcapApi':''}})[_0x1354cc(0x36c)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x1354cc(0x18c)]({'secure':{},'blacklist':[]})[_0x1354cc(0x36c)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x1354cc(0x212)](_0x1354cc(0x368),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x1354cc(0x2a8)]&&(settings['telegramToken']!=''&&settings[_0x1354cc(0x2a8)]!=_0x1354cc(0x241))&&settings[_0x1354cc(0x1c6)]&&settings[_0x1354cc(0x1c6)]!='')initTelegram();const parseColor=(_0x4c56b0,_0x2c471c)=>{const _0xe3c40=_0x1354cc,_0x40749b=/#[A-Z]{3}#/g;if(typeof _0x4c56b0==_0xe3c40(0x344)){!_0x2c471c?_0x4c56b0=_0x4c56b0[_0xe3c40(0x29c)](_0x40749b,''):(_0x4c56b0=_0x4c56b0[_0xe3c40(0x29c)](/#BLU#/g,'\x1b[34m'),_0x4c56b0=_0x4c56b0[_0xe3c40(0x29c)](/#RED#/g,_0xe3c40(0x29d)),_0x4c56b0=_0x4c56b0['replace'](/#YEL#/g,_0xe3c40(0x1b4)),_0x4c56b0=_0x4c56b0[_0xe3c40(0x29c)](/#MAG#/g,_0xe3c40(0x299)),_0x4c56b0=_0x4c56b0['replace'](/#CYA#/g,_0xe3c40(0x337)),_0x4c56b0=_0x4c56b0[_0xe3c40(0x29c)](/#RES#/g,_0xe3c40(0x373)));;}return _0x4c56b0;},logger={'screen':_0x3c0a5d=>{const _0x1d5969=_0x1354cc;console[_0x1d5969(0x31d)](parseColor(_0x3c0a5d,!![]));},'simple':_0x150720=>{const _0x266093=_0x1354cc;console[_0x266093(0x31d)](parseColor(_0x150720,!![])),loggerfile['write'](util[_0x266093(0x2d3)](parseColor(_0x150720,![]))+'\x0a');},'full':async _0x5439c7=>{const _0x26b22f=_0x1354cc,_0x1a60af=getTimeStamp()+_0x26b22f(0x33f)+_0x5439c7;console[_0x26b22f(0x31d)](parseColor(_0x1a60af,!![])),loggerfile[_0x26b22f(0x36c)](util['format'](parseColor(_0x1a60af,![]))+'\x0a');if(tgBot&&settings[_0x26b22f(0x22d)]&&settings['telegramEvents']!=_0x26b22f(0x2e0))await sendTelegram(settings['telegramChatId'],_0x26b22f(0x295)+parseColor(_0x5439c7,![]));},'debug':async(_0x38db26,_0xb7ef3='')=>{const _0x2a570e=_0x1354cc,_0x1b9092=getTimeStamp()+_0x2a570e(0x2fb)+_0x38db26;if(debugging)console['log'](parseColor(_0x1b9092,!![]));loggerfile[_0x2a570e(0x36c)](util[_0x2a570e(0x2d3)](parseColor(_0x1b9092,![]))+'\x0a');if(_0xb7ef3){if(debugging)console[_0x2a570e(0x31d)](_0xb7ef3);loggerfile['write'](util[_0x2a570e(0x2d3)](_0xb7ef3)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0xcdd11d){const _0x4bacab=_0x1354cc;_0xcdd11d[_0x4bacab(0x2e7)]()['includes']('address\x20already\x20in\x20use')?(logger['simple'](_0x4bacab(0x2f6)+_0xcdd11d['port']+_0x4bacab(0x1ae)),process[_0x4bacab(0x1a5)]({'terminate':!![]},_0x48ba49=>{})):logger[_0x4bacab(0x308)](_0xcdd11d);}),process['on'](_0x1354cc(0x215),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x1354cc(0x26c),()=>{const _0x4d62d5=_0x1354cc;stopAllBots(),process[_0x4d62d5(0x215)](0x0);}),process['on'](_0x1354cc(0x365),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x1354cc(0x289))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x1354cc(0x381)),app=express(),http=require(_0x1354cc(0x32a))['createServer'](app);app[_0x1354cc(0x360)](fileUpload({'useTempFiles':!![]})),app[_0x1354cc(0x1bb)]('/download/:type',async(_0x1f0114,_0x2fbfd1)=>{const _0x1a7f82=_0x1354cc,_0x44de5a=_0x1f0114['params'][_0x1a7f82(0x2fd)],_0x167e86=getClientsWithBotID(_0x1a7f82(0x1b9)),_0x4bd366=_0x1f0114[_0x1a7f82(0x1c3)][_0x1a7f82(0x359)],_0x222034=timelyDecrypt(_0x4bd366,![]),_0x4df722=_0x167e86[_0x1a7f82(0x1b2)](_0x37aeaa=>_0x37aeaa[_0x1a7f82(0x359)]==_0x222034);if(_0x4df722){const _0xab107=normalizeIP(_0x1f0114['socket']['remoteAddress'])[_0x1a7f82(0x323)],_0x1418bf=_0x1f0114['headers']['tkn'];if(validateAccess(_0x1418bf,_0x222034,_0xab107)[_0x1a7f82(0x24e)])_0x44de5a==_0x1a7f82(0x33b)&&await backupConfigFiles(),await zipFiles(_0x44de5a),_0x2fbfd1['download'](zippath+(_0x44de5a+_0x1a7f82(0x1d2)),_0x2f87b0=>{const _0x4568ac=_0x1a7f82;_0x2f87b0&&(logger[_0x4568ac(0x1ad)](_0x4568ac(0x1f9)+_0x44de5a),logger[_0x4568ac(0x308)](_0x2f87b0));});else logger[_0x1a7f82(0x1ad)](_0x1a7f82(0x2b4)+_0x44de5a+_0x1a7f82(0x36b));}else logger['full'](_0x1a7f82(0x2b4)+_0x44de5a+'\x20(2)');}),app[_0x1354cc(0x1ff)](_0x1354cc(0x28e),async(_0x13328f,_0x5e9e77)=>{const _0x394ee3=_0x1354cc,_0x356a16=getClientsWithBotID(_0x394ee3(0x1b9)),_0xebee=_0x13328f[_0x394ee3(0x1c3)][_0x394ee3(0x359)],_0x138516=timelyDecrypt(_0xebee,![]),_0x28b23a=_0x356a16[_0x394ee3(0x1b2)](_0x2b59f9=>_0x2b59f9[_0x394ee3(0x359)]==_0x138516);logger[_0x394ee3(0x386)]('Backup\x20file\x20uploaded');if(_0x28b23a){const _0x3f5fd4=normalizeIP(_0x13328f[_0x394ee3(0x369)]['remoteAddress'])[_0x394ee3(0x323)],_0x5a5185=_0x13328f[_0x394ee3(0x1c3)][_0x394ee3(0x25e)];if(validateAccess(_0x5a5185,_0x138516,_0x3f5fd4)[_0x394ee3(0x24e)]){if(_0x13328f[_0x394ee3(0x1be)]){const _0xce5094=_0x13328f['files']['backupfile'];await _0xce5094['mv'](temppath+_0xce5094[_0x394ee3(0x201)]),_0x5e9e77['send']({'status':!![],'message':_0x394ee3(0x2c5)});const _0x3fc9e2=getBotsWithMode();_0x3fc9e2[_0x394ee3(0x34e)]>0x0?confirmRestore(temppath,_0xce5094['name']):unzipFile(temppath,_0xce5094['name']);}}else logger[_0x394ee3(0x1ad)](_0x394ee3(0x2db));}else logger[_0x394ee3(0x1ad)](_0x394ee3(0x189));}),app[_0x1354cc(0x360)](express[_0x1354cc(0x242)](path[_0x1354cc(0x2c6)](__dirname,bbpath2,_0x1354cc(0x19c)))),app[_0x1354cc(0x360)](express[_0x1354cc(0x242)](path[_0x1354cc(0x2c6)](__dirname,bbpath2,'build'))),app[_0x1354cc(0x1bb)]('/',function(_0x23358f,_0x3e677b){const _0x56399d=_0x1354cc;_0x3e677b[_0x56399d(0x264)](path[_0x56399d(0x2c6)](__dirname,bbpath2,_0x56399d(0x19c),_0x56399d(0x263)));}),app[_0x1354cc(0x1bb)](_0x1354cc(0x1d8),function(_0x29a461,_0x13e655){const _0x166e2e=_0x1354cc;_0x13e655[_0x166e2e(0x264)](path[_0x166e2e(0x2c6)](__dirname,bbpath2,_0x166e2e(0x333),_0x166e2e(0x263)));}),app[_0x1354cc(0x1bb)](_0x1354cc(0x208),(_0x2c438c,_0x3cec4a)=>{const _0x22793f=_0x1354cc;_0x3cec4a[_0x22793f(0x264)](path[_0x22793f(0x2c6)](__dirname,bbpath2,_0x22793f(0x333),_0x22793f(0x263)));}),app['get']('/:bot/performance',(_0x3163fb,_0x49fa18)=>{const _0x554315=_0x1354cc;_0x49fa18[_0x554315(0x264)](path['join'](__dirname,bbpath2,_0x554315(0x333),'index.html'));}),app[_0x1354cc(0x1bb)](_0x1354cc(0x262),(_0x141187,_0x24a760)=>{const _0x5bcd5e=_0x1354cc;_0x24a760[_0x5bcd5e(0x264)](path['join'](__dirname,bbpath2,_0x5bcd5e(0x333),_0x5bcd5e(0x263)));}),app[_0x1354cc(0x1bb)](_0x1354cc(0x2ce),(_0x5812ec,_0x5aeb48)=>{const _0x3cb9bc=_0x1354cc;_0x5aeb48[_0x3cb9bc(0x264)](path[_0x3cb9bc(0x2c6)](__dirname,bbpath2,_0x3cb9bc(0x333),'index.html'));}),app['get']('/:bot/configuration',(_0x4b3126,_0x204781)=>{const _0x551c3e=_0x1354cc;_0x204781['sendFile'](path[_0x551c3e(0x2c6)](__dirname,bbpath2,_0x551c3e(0x333),_0x551c3e(0x263)));}),app[_0x1354cc(0x1bb)](_0x1354cc(0x2a7),(_0x3b93bd,_0x414b34)=>{const _0x4a1ce6=_0x1354cc;_0x414b34[_0x4a1ce6(0x264)](path[_0x4a1ce6(0x2c6)](__dirname,bbpath2,'build',_0x4a1ce6(0x263)));});if(HOST)http['listen'](PORT,HOST);else http[_0x1354cc(0x284)](PORT);const io=require('socket.io')(http,{});openBrowser&&(async()=>{const _0x380932=_0x1354cc,{default:_0x2d0318}=await import(_0x380932(0x1eb));await _0x2d0318('http://localhost:'+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x230ec1=_0x1354cc;let _0x1ed6f8=_0x230ec1(0x2f0);const _0x392184=networkInterfaces(),_0x469908={};for(const _0x555528 of Object['keys'](_0x392184)){for(const _0x2b8b66 of _0x392184[_0x555528]){if((_0x2b8b66[_0x230ec1(0x377)]==_0x230ec1(0x193)||_0x2b8b66[_0x230ec1(0x377)]==0x4)&&!_0x2b8b66[_0x230ec1(0x2e1)]){const _0x9a7d12=ipaddr[_0x230ec1(0x250)](_0x2b8b66[_0x230ec1(0x1f8)])[_0x230ec1(0x2bc)]();_0x9a7d12!=_0x230ec1(0x22e)&&(!_0x469908[_0x555528]&&(_0x469908[_0x555528]=[]),_0x469908[_0x555528]['push'](_0x2b8b66[_0x230ec1(0x1f8)]),_0x1ed6f8=_0x2b8b66[_0x230ec1(0x1f8)]);}}}return{'serverip':_0x1ed6f8,'netinterfaces':_0x469908};}async function startServer(){const _0x406d6a=_0x1354cc,{serverip:_0x5f4874,netinterfaces:_0x2ecddc}=getServerIP();logger[_0x406d6a(0x308)](''),logger['simple'](_0x406d6a(0x17e)),await logger[_0x406d6a(0x1ad)](_0x406d6a(0x18e)+serverversion+'#RES#\x20'+(environment==_0x406d6a(0x195)?_0x406d6a(0x21b):'')+'\x0a'+(_0x406d6a(0x18a)+PORT+_0x406d6a(0x325))+(_0x406d6a(0x2f7)+_0x5f4874+':'+PORT+_0x406d6a(0x1c9))),logger[_0x406d6a(0x308)]('-----------------------------------------------------------------------------------');if(config[_0x406d6a(0x34e)]!=0x0)for(const _0x1035d4 of config){const _0x5d0eca=_0x1035d4[_0x406d6a(0x19b)]==_0x406d6a(0x1f6)?'a':'m';if(_0x1035d4['status']==_0x406d6a(0x2be)||_0x1035d4[_0x406d6a(0x1e4)]==_0x406d6a(0x305))await logger['full'](_0x406d6a(0x2d0)+_0x5d0eca+_0x406d6a(0x285)+_0x1035d4[_0x406d6a(0x22c)]+_0x406d6a(0x296)+_0x1035d4[_0x406d6a(0x320)]),startBot([_0x1035d4['botID'],userID],{'cwd':bbpath},function(_0x20bb22){if(_0x20bb22)logger['full'](_0x20bb22);});else(_0x1035d4['status']==_0x406d6a(0x23e)||_0x1035d4[_0x406d6a(0x1e4)]=='new-disabled')&&await logger[_0x406d6a(0x1ad)](_0x406d6a(0x302)+_0x5d0eca+_0x406d6a(0x341)+_0x1035d4[_0x406d6a(0x22c)]+'\x20|\x20'+_0x1035d4[_0x406d6a(0x320)]);}else!newBot&&logger['simple'](_0x406d6a(0x358));if(newBot)addBot();logger[_0x406d6a(0x308)](_0x406d6a(0x17e)),logger[_0x406d6a(0x308)](''),await logger[_0x406d6a(0x386)](_0x406d6a(0x210)+nodeversion),await logger['debug']('Network\x20Interfaces:',_0x2ecddc);}function startSocket(){io['on']('connection',_0x57863f=>{const _0xefdf04=_0x4878;let _0x5a163b,_0x5951e0,_0x147fab,_0x154e1a,_0x3eba51;const _0x4fa0e6=_0x57863f[_0xefdf04(0x2e9)][_0xefdf04(0x1c3)]['referer'];_0x5951e0=_0x4fa0e6[_0xefdf04(0x26e)](/bot[0-9]{3}/);if(_0x5951e0)_0x147fab=_0x5951e0[0x0][_0xefdf04(0x26e)](/[0-9]{3}/);if(_0x147fab)_0x5a163b=_0x147fab[0x0];else _0x5a163b=_0xefdf04(0x1b9);const _0x2a72b4=_0x57863f[_0xefdf04(0x2e9)][_0xefdf04(0x1b7)]['encryptedUuid'];if(!_0x2a72b4)_0x57863f[_0xefdf04(0x370)](_0xefdf04(0x1e4),{'publicKey':secure['publicKey']});else{_0x154e1a=timelyDecrypt(_0x2a72b4,![]);if(!_0x154e1a)_0x57863f['emit'](_0xefdf04(0x1e4),{'publicKey':secure['publicKey']});else{_0x3eba51=normalizeIP(_0x57863f['conn']['remoteAddress'])['store'];if(!devices[_0x154e1a])devices[_0x154e1a]={'uuid':_0x154e1a,'access':{'token':null}};devices[_0x154e1a]['ip']=_0x3eba51;const _0x362b31=addClient(_0x57863f['id'],_0x154e1a,_0x5a163b);setAccess(_0x362b31),emitMessages(),_0x57863f['on'](_0xefdf04(0x1ef),_0x551d5f=>{const _0x3bf51d=_0xefdf04,_0x1df473=timelyDecrypt(_0x551d5f['password'],!![],_0x3bf51d(0x324));if(_0x1df473){_0x551d5f={'username':_0x551d5f[_0x3bf51d(0x1dd)],'password':_0x1df473},devices[_0x154e1a]['access']=validateCredentials(_0x551d5f,_0x154e1a);if(devices[_0x154e1a][_0x3bf51d(0x32b)]['allow']==![]&&devices[_0x154e1a]['access']['reason']==_0x3bf51d(0x364))_0x57863f[_0x3bf51d(0x370)]('status',{'access':devices[_0x154e1a][_0x3bf51d(0x32b)]}),loginAccess2FA(_0x154e1a,_0x3eba51);else{if(devices[_0x154e1a][_0x3bf51d(0x32b)][_0x3bf51d(0x24e)]==![]&&devices[_0x154e1a][_0x3bf51d(0x32b)][_0x3bf51d(0x1aa)]==_0x3bf51d(0x38c))_0x57863f[_0x3bf51d(0x370)](_0x3bf51d(0x1e4),{'access':devices[_0x154e1a][_0x3bf51d(0x32b)]});else devices[_0x154e1a]['access'][_0x3bf51d(0x24e)]&&devices[_0x154e1a][_0x3bf51d(0x32b)][_0x3bf51d(0x1aa)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x154e1a)[_0x3bf51d(0x182)](_0xeac19a=>{setAccess(_0xeac19a);}),logger[_0x3bf51d(0x386)](_0x3bf51d(0x294)+_0x154e1a[_0x3bf51d(0x30b)](-0x8)),setTokenRefresh(_0x154e1a),setSessionTimeout(_0x3bf51d(0x1ef),_0x154e1a));}}else logger[_0x3bf51d(0x1ad)](_0x3bf51d(0x37d));}),_0x57863f['on'](_0xefdf04(0x266),()=>{resetPassword();}),_0x57863f['on']('disconnect',_0x185019=>{removeClient(_0x57863f['id']);}),_0x5a163b==_0xefdf04(0x1b9)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x14e18f){const _0x2fc3c6=_0x1354cc;if(_0x14e18f!=_0x2fc3c6(0x1b9)&&config[_0x2fc3c6(0x2ff)]!=''){if(pid[_0x14e18f])pid[_0x14e18f][_0x2fc3c6(0x1a5)]({'function':_0x2fc3c6(0x213),'args':null});}_0x14e18f!=_0x2fc3c6(0x1b9)&&broadcastToBots('bots',JSON[_0x2fc3c6(0x232)](config));}function reloadBotManager(){const _0x2af75f=_0x1354cc;getClientsWithBotID(_0x2af75f(0x1b9))[_0x2af75f(0x182)](_0x295679=>{const _0x14abcd=_0x2af75f;getSocket(_0x295679['id'])[_0x14abcd(0x370)]('status',{'access':{'allow':![],'reason':_0x14abcd(0x2dc),'token':null}});});}function getSocket(_0x1a2315){const _0x40c658=_0x1354cc,_0x13b4e7=io[_0x40c658(0x383)]['get']('/');return _0x13b4e7[_0x40c658(0x384)][_0x40c658(0x1bb)](_0x1a2315);}function setAccess(_0x405902){const _0xc9aaa9=_0x1354cc,_0x366cb0=getSocket(_0x405902['id']),_0x3197df=_0x405902[_0xc9aaa9(0x359)],_0x332ffe=_0x405902[_0xc9aaa9(0x270)];devices[_0x3197df][_0xc9aaa9(0x32b)]=validateAccess(devices[_0x3197df][_0xc9aaa9(0x32b)][_0xc9aaa9(0x1df)],_0x3197df),logger[_0xc9aaa9(0x386)](_0xc9aaa9(0x180)+devices[_0x3197df][_0xc9aaa9(0x32b)]['reason']+_0xc9aaa9(0x2ba)+_0x405902['id']['slice'](-0x8)+_0xc9aaa9(0x1a4)+_0x3197df[_0xc9aaa9(0x30b)](-0x8)),_0x366cb0[_0xc9aaa9(0x2c6)](_0x3197df);if(devices[_0x3197df][_0xc9aaa9(0x32b)][_0xc9aaa9(0x24e)]){_0x366cb0['join'](_0x332ffe);if(_0x332ffe=='botmanager')initializeSocketBotManager(_0x366cb0);else initializeSocketBot(_0x366cb0);initClient(_0x332ffe);}devices[_0x3197df][_0xc9aaa9(0x32b)][_0xc9aaa9(0x1df)]&&devices[_0x3197df]['access'][_0xc9aaa9(0x1aa)]==_0xc9aaa9(0x29f)&&setSessionTimeout(_0xc9aaa9(0x31e),_0x3197df),devices[_0x3197df]['access'][_0xc9aaa9(0x1df)]&&devices[_0x3197df]['access'][_0xc9aaa9(0x1aa)]==_0xc9aaa9(0x281)&&setSessionTimeout(_0xc9aaa9(0x1ef),_0x3197df),_0x366cb0[_0xc9aaa9(0x370)]('status',{'status':_0x405902[_0xc9aaa9(0x24f)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3197df][_0xc9aaa9(0x32b)],'externalip':devices[_0x3197df]['ip'],'publicKey':secure[_0xc9aaa9(0x1cb)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x3197df][_0xc9aaa9(0x32b)][_0xc9aaa9(0x24e)]==![]&&devices[_0x3197df][_0xc9aaa9(0x32b)][_0xc9aaa9(0x1aa)]==_0xc9aaa9(0x26d)&&temporaryAccess2FA(_0x3197df,devices[_0x3197df]['ip']);}function setSessionTimeout(_0x4e4c4b,_0x4ad3e5){const _0x542d32=_0x1354cc;let _0x2d26a7;if(_0x4e4c4b==_0x542d32(0x1ef))_0x2d26a7=loginExpiry*0x3c*0x3e8;else _0x2d26a7=devices[_0x4ad3e5][_0x542d32(0x23b)][_0x542d32(0x306)]*0x3c*0x3e8-(new Date()[_0x542d32(0x2b7)]()-devices[_0x4ad3e5][_0x542d32(0x23b)]['timestamp']);if(devices[_0x4ad3e5]['pidExpireLogin'])clearTimeout(devices[_0x4ad3e5][_0x542d32(0x227)]);devices[_0x4ad3e5]['pidExpireLogin']=setTimeout(()=>{const _0x1e3699=_0x542d32;if(devices[_0x4ad3e5]['pidRefreshToken'])clearTimeout(devices[_0x4ad3e5]['pidRefreshToken']);removeSocketListeners(_0x4ad3e5),addBlacklist(_0x4ad3e5),devices[_0x4ad3e5][_0x1e3699(0x23b)]=null,devices[_0x4ad3e5][_0x1e3699(0x35b)]=null,devices[_0x4ad3e5][_0x1e3699(0x32b)]['token']=null,logger[_0x1e3699(0x386)](_0x1e3699(0x312)+_0x4ad3e5[_0x1e3699(0x30b)](-0x8)),devices[_0x4ad3e5]['access']=validateAccess(devices[_0x4ad3e5]['access']['token'],_0x4ad3e5),!(devices[_0x4ad3e5][_0x1e3699(0x32b)][_0x1e3699(0x24e)]&&devices[_0x4ad3e5]['access'][_0x1e3699(0x1aa)]==_0x1e3699(0x181))&&(_0x4e4c4b==_0x1e3699(0x1ef)?io['to'](_0x4ad3e5)['emit'](_0x1e3699(0x1e4),{'access':{'allow':![],'reason':_0x1e3699(0x2ab),'token':null}}):io['to'](_0x4ad3e5)['emit'](_0x1e3699(0x1e4),{'access':{'allow':![],'reason':_0x1e3699(0x21e),'token':null}})),devices[_0x4ad3e5][_0x1e3699(0x32b)][_0x1e3699(0x1df)]=null;},_0x2d26a7);}function setTokenRefresh(_0x4c0dea){const _0x3a1671=_0x1354cc;if(devices[_0x4c0dea][_0x3a1671(0x319)])clearTimeout(devices[_0x4c0dea][_0x3a1671(0x319)]);devices[_0x4c0dea][_0x3a1671(0x319)]=setTimeout(()=>{const _0x5b8560=_0x3a1671;getClientsWithUuid(_0x4c0dea)[_0x5b8560(0x34e)]!=0x0?(devices[_0x4c0dea][_0x5b8560(0x32b)]=refreshToken(_0x4c0dea),io['to'](_0x4c0dea)[_0x5b8560(0x370)](_0x5b8560(0x1e4),{'status':_0x5b8560(0x328),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4c0dea]['access'],'externalip':devices[_0x4c0dea]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x4c0dea)):clearTimeout(devices[_0x4c0dea][_0x5b8560(0x319)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x296deb){const _0x1fc11e=_0x1354cc,_0x4de1c2=getClient(_0x296deb['id'])[_0x1fc11e(0x359)];_0x296deb['emit']('bots',config),_0x296deb[_0x1fc11e(0x370)]('settings',cleanSettings()),_0x296deb['on'](_0x1fc11e(0x300),_0x3544d4=>{const _0x14d4d9=_0x1fc11e;if(validateAccess(_0x3544d4,_0x4de1c2)[_0x14d4d9(0x24e)])addBot();else logger[_0x14d4d9(0x1ad)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x296deb['on']('update-bot',(_0x1c7f28,_0x2d8c33)=>{const _0x48a735=_0x1fc11e;if(validateAccess(_0x2d8c33,_0x4de1c2)[_0x48a735(0x24e)])toggleBot(_0x1c7f28[_0x48a735(0x22c)],_0x1c7f28['status'],_0x1c7f28[_0x48a735(0x2de)]);else logger[_0x48a735(0x1ad)](_0x48a735(0x28d));}),_0x296deb['on'](_0x1fc11e(0x2fe),(_0x2e151e,_0x374f14)=>{const _0x288aaa=_0x1fc11e;if(validateAccess(_0x374f14,_0x4de1c2)['allow'])toggleBotMode(_0x2e151e);else logger[_0x288aaa(0x1ad)](_0x288aaa(0x28d));}),_0x296deb['on'](_0x1fc11e(0x2c7),(_0x17d3ab,_0x4c5108)=>{const _0x2061a7=_0x1fc11e;if(validateAccess(_0x4c5108,_0x4de1c2)['allow'])deleteBot(_0x17d3ab);else logger['full'](_0x2061a7(0x396));}),_0x296deb['on'](_0x1fc11e(0x1a7),(_0x198fb2,_0x2cf4c1)=>{const _0x265768=_0x1fc11e;if(validateAccess(_0x2cf4c1,_0x4de1c2)[_0x265768(0x24e)])storeSettings(_0x198fb2,!![]);else logger['full'](_0x265768(0x20e));}),_0x296deb['on'](_0x1fc11e(0x1c4),_0x382dd6=>{const _0xfc8605=_0x1fc11e;if(validateAccess(_0x382dd6,_0x4de1c2)[_0xfc8605(0x24e)])updateBB(_0xfc8605(0x2d1));else logger[_0xfc8605(0x1ad)](_0xfc8605(0x2a2));}),_0x296deb['on'](_0x1fc11e(0x1a9),_0x909c65=>{const _0x2c3410=_0x1fc11e;if(validateAccess(_0x909c65,_0x4de1c2)[_0x2c3410(0x24e)])updateBB(_0x2c3410(0x267));else logger[_0x2c3410(0x1ad)](_0x2c3410(0x2ac));}),_0x296deb['on'](_0x1fc11e(0x345),_0x1c6759=>{const _0x377670=_0x1fc11e;if(validateAccess(_0x1c6759,_0x4de1c2)['allow']){const _0x171fc0=getClient(_0x296deb['id']);if(_0x171fc0)getBackupFiles(_0x171fc0[_0x377670(0x359)]);else logger[_0x377670(0x1ad)](_0x377670(0x290));}else logger[_0x377670(0x1ad)](_0x377670(0x33d));}),_0x296deb['on'](_0x1fc11e(0x385),(_0x2c29f5,_0x459104)=>{const _0x13113c=_0x1fc11e;if(validateAccess(_0x459104,_0x4de1c2)[_0x13113c(0x24e)])restoreBackupFile(_0x2c29f5);else logger['full'](_0x13113c(0x336));}),_0x296deb['on'](_0x1fc11e(0x202),_0x55ffb3=>{const _0x1fad43=_0x1fc11e;if(validateAccess(_0x55ffb3,_0x4de1c2)[_0x1fad43(0x24e)])getMessages();else logger[_0x1fad43(0x1ad)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x296deb['on'](_0x1fc11e(0x2c2),(_0x304ead,_0x5132c3)=>{const _0x5beba7=_0x1fc11e;if(validateAccess(_0x5132c3,_0x4de1c2)[_0x5beba7(0x24e)])confirmMessage(_0x304ead);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x296deb['on'](_0x1fc11e(0x31f),_0x5c52f9=>{const _0x49b0d6=_0x1fc11e;if(validateAccess(_0x5c52f9,_0x4de1c2)['allow']){if(devices[_0x4de1c2]['pidRefreshToken'])clearTimeout(devices[_0x4de1c2]['pidRefreshToken']);if(devices[_0x4de1c2][_0x49b0d6(0x227)])clearTimeout(devices[_0x4de1c2][_0x49b0d6(0x227)]);removeSocketListeners(getClient(_0x296deb['id'])[_0x49b0d6(0x359)]),addBlacklist(_0x4de1c2),devices[_0x4de1c2][_0x49b0d6(0x23b)]=null,devices[_0x4de1c2]['telegram2FaApproval']=null,devices[_0x4de1c2][_0x49b0d6(0x32b)][_0x49b0d6(0x1df)]=null,logger[_0x49b0d6(0x386)](_0x49b0d6(0x293)+_0x4de1c2['slice'](-0x8)),io['to'](getClient(_0x296deb['id'])[_0x49b0d6(0x359)])[_0x49b0d6(0x370)](_0x49b0d6(0x1e4),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x49b0d6(0x1ad)](_0x49b0d6(0x347));});}function initializeSocketBot(_0xeacee2){const _0xcfef60=_0x1354cc,_0x4f725b=getClient(_0xeacee2['id'])['bot'],_0x2c78b1=getClient(_0xeacee2['id'])[_0xcfef60(0x359)];_0xeacee2['on']('get-logs',(_0x42e27e,_0x150d02)=>{const _0x3b590b=_0xcfef60;if(validateAccess(_0x150d02,_0x2c78b1)['allow']){if(pid[_0x4f725b])pid[_0x4f725b][_0x3b590b(0x1a5)]({'function':_0x3b590b(0x19e),'args':_0x42e27e});}else logger['full'](_0x3b590b(0x29e));}),_0xeacee2['on'](_0xcfef60(0x38d),(_0x3541d4,_0x3f4fdb)=>{const _0xf323b6=_0xcfef60;if(validateAccess(_0x3f4fdb,_0x2c78b1)['allow']){if(pid[_0x4f725b])pid[_0x4f725b][_0xf323b6(0x1a5)]({'function':_0xf323b6(0x253),'args':_0x3541d4});}else logger[_0xf323b6(0x1ad)](_0xf323b6(0x255));}),_0xeacee2['on'](_0xcfef60(0x28b),(_0x5e3fc4,_0x4f3dd0)=>{const _0x6f71a4=_0xcfef60;if(validateAccess(_0x4f3dd0,_0x2c78b1)[_0x6f71a4(0x24e)]){if(pid[_0x4f725b])pid[_0x4f725b][_0x6f71a4(0x1a5)]({'function':_0x6f71a4(0x223),'args':_0x5e3fc4});}else logger['full'](_0x6f71a4(0x24d));}),_0xeacee2['on'](_0xcfef60(0x229),(_0x16e989,_0xdc1d9)=>{const _0xbd60da=_0xcfef60;if(validateAccess(_0xdc1d9,_0x2c78b1)[_0xbd60da(0x24e)]){if(pid[_0x4f725b])pid[_0x4f725b]['send']({'function':_0xbd60da(0x2dd),'args':_0x16e989});}else logger['full'](_0xbd60da(0x32d));}),_0xeacee2['on'](_0xcfef60(0x190),(_0x581431,_0x30e70d)=>{const _0x115fe7=_0xcfef60;if(validateAccess(_0x30e70d,_0x2c78b1)[_0x115fe7(0x24e)]){if(pid[_0x4f725b])pid[_0x4f725b][_0x115fe7(0x1a5)]({'function':'storeHeadless','args':_0x581431});}else logger['full'](_0x115fe7(0x239));}),_0xeacee2['on']('store-fiat',(_0x3ad476,_0x2d670d)=>{const _0x3046cd=_0xcfef60;if(validateAccess(_0x2d670d,_0x2c78b1)[_0x3046cd(0x24e)]){if(pid[_0x4f725b])pid[_0x4f725b]['send']({'function':_0x3046cd(0x17f),'args':_0x3ad476});}else logger[_0x3046cd(0x1ad)](_0x3046cd(0x1a1));}),_0xeacee2['on']('reset-history',_0x215351=>{const _0x340a55=_0xcfef60;if(validateAccess(_0x215351,_0x2c78b1)[_0x340a55(0x24e)]){if(pid[_0x4f725b])pid[_0x4f725b][_0x340a55(0x1a5)]({'function':'resetHistory','args':null});}else logger[_0x340a55(0x1ad)](_0x340a55(0x36a));}),_0xeacee2['on']('get-starting-balances',_0x4a71d5=>{const _0x10aac4=_0xcfef60;if(validateAccess(_0x4a71d5,_0x2c78b1)[_0x10aac4(0x24e)]){if(pid[_0x4f725b])pid[_0x4f725b][_0x10aac4(0x1a5)]({'function':'getStartingBalances','args':null});}else logger[_0x10aac4(0x1ad)](_0x10aac4(0x246));}),_0xeacee2['on'](_0xcfef60(0x1d0),(_0x629782,_0x228c8e)=>{const _0xcab678=_0xcfef60;if(validateAccess(_0x228c8e,_0x2c78b1)[_0xcab678(0x24e)]){if(pid[_0x4f725b])pid[_0x4f725b][_0xcab678(0x1a5)]({'function':_0xcab678(0x332),'args':_0x629782});}else logger['full'](_0xcab678(0x2ae));}),_0xeacee2['on'](_0xcfef60(0x2f5),_0x2d0523=>{const _0xd5d85a=_0xcfef60;if(validateAccess(_0x2d0523,_0x2c78b1)[_0xd5d85a(0x24e)]){if(pid[_0x4f725b])pid[_0x4f725b][_0xd5d85a(0x1a5)]({'function':_0xd5d85a(0x1e6),'args':null});}else logger[_0xd5d85a(0x1ad)](_0xd5d85a(0x184));}),_0xeacee2['on']('show-config',_0x21879d=>{const _0x383ce8=_0xcfef60;if(validateAccess(_0x21879d,_0x2c78b1)[_0x383ce8(0x24e)]){if(pid[_0x4f725b])pid[_0x4f725b][_0x383ce8(0x1a5)]({'function':'showConfig','args':null});}else logger[_0x383ce8(0x1ad)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0xeacee2['on']('update-bb',_0x28b7e3=>{const _0x2ddfec=_0xcfef60;if(validateAccess(_0x28b7e3,_0x2c78b1)['allow'])updateBB(_0x2ddfec(0x2d1));else logger['full'](_0x2ddfec(0x2a2));}),_0xeacee2['on'](_0xcfef60(0x202),_0x11244c=>{const _0x2e4778=_0xcfef60;if(validateAccess(_0x11244c,_0x2c78b1)['allow'])getMessages();else logger[_0x2e4778(0x1ad)](_0x2e4778(0x1fd));}),_0xeacee2['on'](_0xcfef60(0x2c2),(_0x10cfcf,_0x461f46)=>{const _0x23e9cb=_0xcfef60;if(validateAccess(_0x461f46,_0x2c78b1)[_0x23e9cb(0x24e)])confirmMessage(_0x10cfcf);else logger[_0x23e9cb(0x1ad)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0xeacee2['on'](_0xcfef60(0x31f),_0x2bacc2=>{const _0x3de0c5=_0xcfef60;if(validateAccess(_0x2bacc2,_0x2c78b1)['allow']){if(devices[_0x2c78b1]['pidRefreshToken'])clearTimeout(devices[_0x2c78b1][_0x3de0c5(0x319)]);if(devices[_0x2c78b1]['pidExpireLogin'])clearTimeout(devices[_0x2c78b1]['pidExpireLogin']);removeSocketListeners(getClient(_0xeacee2['id'])[_0x3de0c5(0x359)]),addBlacklist(_0x2c78b1),devices[_0x2c78b1]['telegramIpApproval']=null,devices[_0x2c78b1][_0x3de0c5(0x35b)]=null,devices[_0x2c78b1][_0x3de0c5(0x32b)][_0x3de0c5(0x1df)]=null,logger['debug'](_0x3de0c5(0x293)+_0x2c78b1[_0x3de0c5(0x30b)](-0x8)),io['to'](getClient(_0xeacee2['id'])[_0x3de0c5(0x359)])[_0x3de0c5(0x370)]('status',{'access':{'allow':![],'reason':_0x3de0c5(0x2eb),'token':null}});}else logger[_0x3de0c5(0x1ad)](_0x3de0c5(0x347));});}function removeSocketListeners(_0x35cc06){const _0x3364e2=_0x1354cc;getClientsWithUuid(_0x35cc06)[_0x3364e2(0x182)](_0x14873e=>{const _0x20ccfa=_0x3364e2;getSocket(_0x14873e['id'])[_0x20ccfa(0x36e)]();});}function cleanSettings(){const _0x1390fd=_0x1354cc;let _0x41f52d=settings;return settings[_0x1390fd(0x2a8)]&&settings['telegramToken']!=''&&(_0x41f52d={..._0x41f52d,'telegramToken':'************'}),settings[_0x1390fd(0x2ad)]&&settings[_0x1390fd(0x2ad)]!=''&&(_0x41f52d={..._0x41f52d,'bbPassword':'************'}),settings['marketcapApi']&&settings[_0x1390fd(0x356)]!=''&&(_0x41f52d={..._0x41f52d,'marketcapApi':_0x1390fd(0x261)}),(settings[_0x1390fd(0x2ad)]&&settings[_0x1390fd(0x2ad)]==_0x1390fd(0x241)||settings['telegramToken']&&settings[_0x1390fd(0x2a8)]==_0x1390fd(0x241)||settings[_0x1390fd(0x356)]&&settings[_0x1390fd(0x356)]==_0x1390fd(0x241))&&(_0x41f52d={..._0x41f52d,'restored':{'password':settings[_0x1390fd(0x2ad)]==_0x1390fd(0x241),'telegram':settings[_0x1390fd(0x2a8)]=='***','marketcap':settings[_0x1390fd(0x356)]==_0x1390fd(0x241)}}),_0x41f52d;}async function updateBB(_0x326a92){const _0x567459=_0x1354cc;await backupConfigFiles(),installingUpdate=!![],config[_0x567459(0x182)](_0x55a0de=>{const _0x71e4b8=_0x567459;restartBot(_0x55a0de[_0x71e4b8(0x22c)]);});if(_0x326a92==_0x567459(0x2d1))process['send']({'update':!![],'environment':environment},_0x307cff=>{});else _0x326a92=='reinstall'&&process[_0x567459(0x1a5)]({'reinstall':!![],'environment':environment},_0x6a51b3=>{});}function startBot(_0x3071a3,_0x45a456,_0x3cdd2e){const _0x8c0eb2=_0x1354cc;if(debugging)_0x3071a3[_0x8c0eb2(0x2d5)]('-d');if(recreate)_0x3071a3['push']('-r');let _0x7c0d9a=![];const _0x2b6d4e=_0x3071a3[0x0];_0x45a456={..._0x45a456,'stdio':['inherit',_0x8c0eb2(0x27d),'inherit',_0x8c0eb2(0x279)]},pid[_0x2b6d4e]=childProcess[_0x8c0eb2(0x1c0)](botfile,_0x3071a3,_0x45a456),pid[_0x2b6d4e]['on']('message',_0x504614=>{const _0x16d07c=_0x8c0eb2;switch(Object['keys'](_0x504614)[0x0]){case'botname':updateBotName(_0x2b6d4e,_0x504614[_0x16d07c(0x320)]);break;case _0x16d07c(0x18f):updateBotManager();break;case _0x16d07c(0x1e4):updateStatus(_0x2b6d4e,_0x504614[_0x16d07c(0x1e4)]);break;case _0x16d07c(0x2de):updateLive(_0x2b6d4e,_0x504614['live']);break;case _0x16d07c(0x30a):updateLive(_0x2b6d4e,_0x504614['started']),io['to'](_0x2b6d4e)['emit'](_0x16d07c(0x1e4),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x16d07c(0x2cc):_0x504614[_0x16d07c(0x2cc)]=='restart'&&restartBot(_0x2b6d4e);_0x504614['stop']==_0x16d07c(0x20a)&&toggleBot(_0x2b6d4e,'disabled',_0x16d07c(0x1f7));break;case'telegram':sendTelegramBot(_0x2b6d4e,_0x504614[_0x16d07c(0x276)]);break;case _0x16d07c(0x1cd):sendTelegramMsg(_0x504614[_0x16d07c(0x1cd)]);break;case _0x16d07c(0x29b):io['to'](_0x2b6d4e)['emit'](_0x504614[_0x16d07c(0x29b)],_0x504614[_0x16d07c(0x2c0)]);break;}}),pid[_0x2b6d4e]['on'](_0x8c0eb2(0x277),function(_0x16b1fb){if(_0x7c0d9a)return;_0x7c0d9a=!![],_0x3cdd2e(_0x16b1fb);}),pid[_0x2b6d4e]['on'](_0x8c0eb2(0x215),async function(_0xd26ada){const _0x312fac=_0x8c0eb2;if(terminating)return;if(installingUpdate){io[_0x312fac(0x33e)]();return;}if(_0x7c0d9a)return;_0x7c0d9a=!![],_0x3cdd2e(null);const _0x3a0bd8=dbConfig[_0x312fac(0x1bb)](_0x312fac(0x342))[_0x312fac(0x1b2)]({'botID':_0x2b6d4e})[_0x312fac(0x33a)]();_0x3a0bd8&&(_0x3a0bd8[_0x312fac(0x1e4)]==_0x312fac(0x2be)||_0x3a0bd8[_0x312fac(0x1e4)]==_0x312fac(0x305))&&(await sleep(0x3e8),updateLive(_0x2b6d4e,_0x312fac(0x1f7)),logger['full'](_0x312fac(0x205)+botRef(_0x2b6d4e)),startBot([_0x2b6d4e,userID],{'cwd':bbpath},function(_0x1e9219){const _0x4a0589=_0x312fac;if(_0x1e9219)logger[_0x4a0589(0x1ad)](_0x1e9219);}));});}function _0x5022(){const _0x1224a3=['Bot\x20Mgr\x20>\x20','\x20|\x20','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','\x1b[35m','statSync','function','replace','\x1b[31m','Unauthorized\x20attempt\x20to\x20get\x20events','temporary\x20token\x20generated','number','clientip','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Enabled\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','track','/:bot/support','telegramToken','Notifications\x20enabled\x0a','\x20files\x20over\x20Telegram:','access\x20timeout','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','bbPassword','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','warning','/restart\x20-\x20restart\x20bot(s)\x0a','getMinutes','update_yes','::ffff:7f00:1','Unauthorized\x20attempt\x20to\x20download\x20','test','assign','getTime','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Restoring\x20bot(s)\x20from\x20backup','\x20|\x20client:\x20...','sign','range','max','enabled','filter','args','entries','confirm-message','hex','getSeconds','File\x20uploaded','join','delete-bot','logs/','config_all','Token\x20blacklisted','userid','stop','backup-full@','/:bot/history','mtime','Starting\x20(','update','bbvNew','format','isValid','push','file','includes','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','getUTCHours','login\x20token\x20generated','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','reload','storeConfiguration','live','<b>Telegram\x20Bot\x20Status:</b>\x0a','orders','internal','decrypt','getMonth','bbvReceive','hashSync','inlineKeyboard','toString','onepagemode','handshake','copyFileSync','logged\x20out','tempaccess_5_','All','loadAsync','temporary\x20access\x20rejected','[ip-address]','metrics','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','exp','search','cancel-loading','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','=>\x20Go\x20to\x20#CYA#http://','blacklist','mixpanel','964208IHMSye',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Starting\x20Balance\x20Bot\x20update','type','toggle-bot-mode','apiKey','add-bot','127.0.0.1','Idling\x20(','getFullYear','You\x20can\x20use\x20the\x20following\x20commands:\x0a','new','expiry','User\x20has\x20been\x20validated','simple','all','started','slice','backup-full.zip','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','lowdb','start','Server','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Session\x20expired\x20for\x20user\x20...','existsSync','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','child_process','enable','Notifications\x20disabled','CoinMarketCap\x20API\x20key\x20validated','pidRefreshToken','\x20-\x20','/off\x20-\x20stop\x20bot(s)\x0a','reject','log','2FA','logout','botname','config/','pki','store','|@|','#RES#\x20if\x20running\x20locally\x0a','privateKey','launch','connected','jszip','http','access','Bot\x20Mgr\x20>\x20Toggling\x20','Unauthorized\x20attempt\x20to\x20store\x20configuration','showname','getHours','Ok,\x20will\x20send\x20alert\x20notifications\x20only','temp/','placeOrder','build','-results.json','\x20only\x0a','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','\x1b[36m','toggleBotMode','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','value','backup','rmSync','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','close',':\x20Bot\x20Mgr\x20>\x20','sendPortfolioTelegram',')\x20\x20\x20|\x20Bot\x20','bots','Your\x20installation\x20is\x20already\x20up\x20to\x20date','string','get-backup-files','constructor','Unauthorized\x20attempt\x20to\x20log\x20out','running','/help\x20-\x20show\x20available\x20commands\x0a','Login\x20rejected','zip/','show','user','length','8124fAyeEI','path','apply','156595mmhUDJ','any','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','198490QOQwPE','marketcapApi','exec','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','uuid','isIPv4MappedAddress','telegram2FaApproval','telegramEvents','restart','mkdirSync','randomFillSync','use','accept','temporaryAccessAllowed','backup/','2FA\x20login\x20required','SIGINT','(((.+)+)+)+$','event','6b67f3d61ee94b8f5c80b4affef4c4d9','socket','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','\x20(1)','write','sha256','removeAllListeners','order','emit','0.0.0','\x20to\x20','\x1b[0m','startsWith','names','Invalid\x20username\x20or\x20IP\x20address','family','getDate','-config.json','timeshift','replyWithDocument','privateKeyToPem','Unauthorized\x20login\x20attempt\x20(timeout)','environment','update_no','button','express','config_alerts','_nsps','sockets','restore-backup-file','debug','command','tempaccess_reject_','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','axios','yes','invalid\x20credentials','delete-alerts','node-forge','/disable\x20-\x20disable\x20notifications\x0a','alias','lastmsgemitted','new-disabled','DEFLATE','#RES#\x20','padStart','Unauthorized\x20attempt\x20to\x20delete\x20bot','sendMessage','-----------------------------------------------------------------------------------','storeFiat','Setting\x20access:\x20','login\x20not\x20required','forEach','off_','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','split','async','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','sortBy','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','All\x20bots','defaults','output-000.log','Starting\x20#RED#Balance\x20Bot\x20v','updatebotmanager','store-headless','Restore\x20backup\x20file\x20','Error\x20sending\x20','IPv4','*$1*','staging','65979ydGtBD','hasOwnProperty','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','telegraf','code','mode','build2','writeFileSync','emitHistory','timestamp','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','port','generateAsync','\x20|\x20user:\x20...','send','Error\x20while\x20deleting\x20config\x20files:\x20','store-settings','sendMetricsTelegram','reinstall-bb','reason','Password\x20has\x20been\x20reset\x20to:\x20','toggle_','full','#RES#','metrics_','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','then','find','bbUsername','\x1b[33m','-events.json','/metrics\x20-\x20show\x20bot\x20performance\x0a','auth','catch','botmanager','from','get','util','readFileSync','files','notification','fork','15\x20min','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','headers','update-bb','kind','telegramUsername','bot-','createWriteStream','#RES#\x20if\x20running\x20on\x20server','production','publicKey','remove','telegrammsg','reply','HTML','place-order','bb-settings.json','.zip','Starting\x20Balance\x20Bot\x20reinstallation','headless','Temporary\x20access\x20rejected','/on\x20-\x20start\x20bot(s)\x0a','Notifications\x20enabled','/:bot','node','callback','/enable\x20-\x20enable\x20notifications\x0a','disconnect','username','--------------------------------------','token','config_orders','287JluxXN','Notifications\x20disabled\x0a','logs','status','26riaGKe','cancelLoading','lowdb/adapters/FileSync','reinstall_no','Error\x20details:','min','open','temporary\x20access\x20not\x20allowed','/logs\x20-\x20receive\x20log\x20files\x0a','compareSync','login','Invalid\x20authentication\x20token\x20(2)','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','express-fileupload','f2aRequired','add','5\x20min','auto','stopped','address','Failed\x20to\x20download\x20','RSA-OAEP','Notifications\x20types:\x20','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Unauthorized\x20attempt\x20to\x20get\x20messages','https://api.ipify.org?format=json','post','alerts','name','get-messages','graphql-request','loginRequired','Restarting\x20','jsonwebtoken','restore_yes_','/:bot/portfolio','Orders','kill','size','off','Restore\x20process\x20aborted','Unauthorized\x20attempt\x20to\x20update\x20settings',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','Node.js\x20v','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','init','initclient','Telegraf\x20error:','exit','toggle','796784pEquRC','2FA\x20login\x20rejected','password','date-fns','(staging)','messages','Deleted\x20Bot\x20','temporary\x20access\x20timeout','whitelist','/status\x20-\x20show\x20bot(s)\x20status\x0a','-performance.json','secret','getPortfolio','publicKeyToPem','toIPv4Address','readdirSync','pidExpireLogin','Bot\x20','store-configuration','output-002.log','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','botID','telegramChatId','private','editMessageReplyMarkup','apiSecret','exchange','stringify','50XbfyHd','Telegram\x20error:','Invalid\x20IP\x20address','BCT','chat','cloneDeep','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','lastmsgtelegram','telegramIpApproval','on_','isDirectory','disabled','No\x20bots\x20running\x20right\x20now','backup-full','***','static','restore_no_','keys','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','manual','output-003.log','success','portfolio_','latestversion','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Unauthorized\x20attempt\x20to\x20get\x20portfolio','allow','server','parse','Yes','settings','deleteHistoryAlerts','Backup\x20file\x20unzipped\x20and\x20stored','Unauthorized\x20attempt\x20to\x20delete\x20alerts','/backup\x20-\x20receive\x20backup\x20files\x0a','sort','bb-secure.json','yargs','Ok,\x20will\x20send\x20order\x20notifications\x20only','unlinkSync','help','action','tkn','login\x20required','backup-files','************','/:bot/coins','index.html','sendFile','/update\x20-\x20update\x20Balance\x20Bot\x0a','reset-password','reinstall','argv','bot.js','Error:\x20Invalid\x20argument\x20','NTBA_FIX_319','SIGTERM','2FA\x20required','match','toIPv4MappedAddress','bot','uuid-random','telegramEnabled','Allow\x20login\x20from\x20IP\x20address\x20','set','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','telegram','error','secure','ipc','30\x20min','/output-000.log','Password\x20reset\x20rejected','inherit','26679fhdLiY','portfolio','binary','2FA\x20login\x20token\x20generated','$1_$2_$3','clients','listen',')\x20|\x20Bot\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','ipaddr.js','message','version.json','<b>Balance\x20Bot\x20Status:</b>\x0a','get-portfolio','apiPassword','Unauthorized\x20attempt\x20to\x20update\x20bot','/upload-backup','create','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','output-001.log','Logged\x20out\x20user\x20...','Logged\x20in\x20user\x20...'];_0x5022=function(){return _0x1224a3;};return _0x5022();}function stopBot(_0x2a133d){const _0x2fd1d7=_0x1354cc;getClientsWithBotID(_0x2a133d)[_0x2fd1d7(0x182)](_0x4d3972=>{const _0x48b331=_0x2fd1d7;getSocket(_0x4d3972['id'])[_0x48b331(0x1dc)](!![]),removeClient(_0x4d3972['id']);}),pid[_0x2a133d]&&(pid[_0x2a133d][_0x2fd1d7(0x20a)](),pid[_0x2a133d]=null);}function stopAllBots(){const _0x2cbf48=_0x1354cc;terminating=!![];const _0x3598c8=getEnabledBots();_0x3598c8[_0x2cbf48(0x182)](_0x2ece71=>{const _0x29b0be=_0x2cbf48;stopBot(_0x2ece71[_0x29b0be(0x22c)]);});}function restartBot(_0x103df0){const _0x42f276=_0x1354cc;if(pid[_0x103df0])pid[_0x103df0][_0x42f276(0x20a)]();}function addBot(){const _0xd201b2=_0x1354cc;let _0x54dbbc;for(let _0x1cc4db=0x1;_0x1cc4db<0x3e9;_0x1cc4db++){_0x54dbbc=_0x1cc4db[_0xd201b2(0x2e7)]()[_0xd201b2(0x395)](0x3,'0');let _0x367ce7=config['find'](_0x3ed029=>_0x3ed029[_0xd201b2(0x22c)]==_0x54dbbc);if(!_0x367ce7)break;}if(_0x54dbbc==='1000'){logger[_0xd201b2(0x1ad)](_0xd201b2(0x291));return;}logger['full']('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x54dbbc),dbConfig['get'](_0xd201b2(0x342))[_0xd201b2(0x2d5)]({'botID':_0x54dbbc,'botname':'Bot\x20'+_0x54dbbc,'status':_0xd201b2(0x305),'live':''})['write'](),startBot([_0x54dbbc,userID],{'cwd':bbpath},function(_0x360ba3){const _0x1314fb=_0xd201b2;if(_0x360ba3)logger[_0x1314fb(0x1ad)](_0x360ba3);}),config=getConfiguration(),io['to'](_0xd201b2(0x1b9))[_0xd201b2(0x370)](_0xd201b2(0x342),config),broadcastToBots(_0xd201b2(0x342),JSON[_0xd201b2(0x232)](config));}function deleteBot(_0x30aad9){const _0x116d29=_0x1354cc;getClientsWithBotID(_0x30aad9)['forEach'](_0x4c4f4d=>{const _0x2bfb27=_0x4878;getSocket(_0x4c4f4d['id'])[_0x2bfb27(0x1dc)](!![]),removeClient(_0x4c4f4d['id']);}),dbConfig[_0x116d29(0x1bb)]('bots')[_0x116d29(0x1cc)]({'botID':_0x30aad9})['write'](),logger[_0x116d29(0x1ad)](_0x116d29(0x21d)+_0x30aad9),stopBot(_0x30aad9);try{if(fs[_0x116d29(0x313)](path[_0x116d29(0x2c6)](configpath,_0x116d29(0x1c7)+_0x30aad9+'-config.json')))fs[_0x116d29(0x25b)](path[_0x116d29(0x2c6)](configpath,_0x116d29(0x1c7)+_0x30aad9+'-config.json'));if(fs[_0x116d29(0x313)](path[_0x116d29(0x2c6)](configpath,_0x116d29(0x1c7)+_0x30aad9+_0x116d29(0x1b5))))fs[_0x116d29(0x25b)](path[_0x116d29(0x2c6)](configpath,_0x116d29(0x1c7)+_0x30aad9+'-events.json'));if(fs[_0x116d29(0x313)](path[_0x116d29(0x2c6)](configpath,_0x116d29(0x1c7)+_0x30aad9+'-performance.json')))fs[_0x116d29(0x25b)](path[_0x116d29(0x2c6)](configpath,'bot-'+_0x30aad9+_0x116d29(0x221)));if(fs[_0x116d29(0x313)](path['join'](configpath,_0x116d29(0x1c7)+_0x30aad9+_0x116d29(0x334))))fs[_0x116d29(0x25b)](path[_0x116d29(0x2c6)](configpath,_0x116d29(0x1c7)+_0x30aad9+'-results.json'));}catch(_0xd64502){if(_0xd64502)logger[_0x116d29(0x1ad)](_0x116d29(0x1a6),_0xd64502);}config=getConfiguration(),io['to'](_0x116d29(0x1b9))['emit'](_0x116d29(0x342),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBot(_0x3a1480,_0x322a2c,_0xa80900){const _0x3f43e3=_0x1354cc;dbConfig['get'](_0x3f43e3(0x342))[_0x3f43e3(0x1b2)]({'botID':_0x3a1480})[_0x3f43e3(0x2b6)]({'status':_0x322a2c})[_0x3f43e3(0x2b6)]({'live':_0xa80900})[_0x3f43e3(0x36c)]();const _0x21f4cb=botRef(_0x3a1480);if(_0x322a2c==_0x3f43e3(0x2be)||_0x322a2c==_0x3f43e3(0x305))logger[_0x3f43e3(0x1ad)](_0x3f43e3(0x2a3)+_0x21f4cb),startBot([_0x3a1480,userID],{'cwd':bbpath},function(_0x307d8d){if(_0x307d8d)logger['full'](_0x307d8d);});else(_0x322a2c==_0x3f43e3(0x23e)||_0x322a2c==_0x3f43e3(0x392))&&(logger['full']('Disabled\x20'+_0x21f4cb),stopBot(_0x3a1480));config=getConfiguration(),io['to'](_0x3f43e3(0x1b9))['emit']('bots',config),broadcastToBots(_0x3f43e3(0x342),JSON[_0x3f43e3(0x232)](config));}function toggleStatus(_0x139cf0){const _0x155edd=_0x1354cc;let _0x43a783=dbConfig[_0x155edd(0x1bb)](_0x155edd(0x342))[_0x155edd(0x1b2)]({'botID':_0x139cf0})[_0x155edd(0x33a)](),_0x1c487f;if(_0x43a783['status']==='enabled')_0x1c487f=_0x155edd(0x23e);else{if(_0x43a783['status']==='new')_0x1c487f='new-disabled';else{if(_0x43a783[_0x155edd(0x1e4)]===_0x155edd(0x392))_0x1c487f=_0x155edd(0x305);else{if(_0x43a783[_0x155edd(0x1e4)]==='disabled')_0x1c487f=_0x155edd(0x2be);}}}return _0x1c487f;}function updateStatus(_0x572a1a,_0x2cf787){const _0x36244c=_0x1354cc;dbConfig[_0x36244c(0x1bb)](_0x36244c(0x342))[_0x36244c(0x1b2)]({'botID':_0x572a1a})[_0x36244c(0x2b6)]({'status':_0x2cf787})[_0x36244c(0x36c)](),config=getConfiguration(),io['to'](_0x36244c(0x1b9))[_0x36244c(0x370)](_0x36244c(0x342),config),broadcastToBots(_0x36244c(0x342),JSON['stringify'](config));}function updateLive(_0x3aa84f,_0x56c066){const _0x27a7f1=_0x1354cc;dbConfig[_0x27a7f1(0x1bb)](_0x27a7f1(0x342))[_0x27a7f1(0x1b2)]({'botID':_0x3aa84f})[_0x27a7f1(0x2b6)]({'live':_0x56c066})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x27a7f1(0x370)](_0x27a7f1(0x342),config),broadcastToBots(_0x27a7f1(0x342),JSON['stringify'](config));}function updateBotName(_0x147e01,_0x1169b5){const _0x4b72b3=_0x1354cc;dbConfig[_0x4b72b3(0x1bb)](_0x4b72b3(0x342))[_0x4b72b3(0x1b2)]({'botID':_0x147e01})[_0x4b72b3(0x2b6)]({'botname':_0x1169b5})[_0x4b72b3(0x36c)](),config=getConfiguration(),io['to'](_0x4b72b3(0x1b9))[_0x4b72b3(0x370)](_0x4b72b3(0x342),config),broadcastToBots(_0x4b72b3(0x342),JSON[_0x4b72b3(0x232)](config));}function updateBotManager(){const _0x123909=_0x1354cc;config=getConfiguration(),io['to'](_0x123909(0x1b9))[_0x123909(0x370)]('bots',config),broadcastToBots('bots',JSON[_0x123909(0x232)](config));}function toggleBotMode(_0x441bf7){const _0x284dcc=_0x1354cc;if(pid[_0x441bf7])pid[_0x441bf7]['send']({'function':_0x284dcc(0x338),'args':null});else{const _0x364061=configpath+_0x284dcc(0x1c7)+_0x441bf7+_0x284dcc(0x379),_0x5ec1f1=fs[_0x284dcc(0x1bd)](_0x364061),_0x4a3984=JSON['parse'](_0x5ec1f1),_0x208c6b=_0x4a3984[_0x284dcc(0x270)][0x0][_0x284dcc(0x1d4)];_0x4a3984[_0x284dcc(0x270)][0x0][_0x284dcc(0x1d4)]=!_0x208c6b;const _0x34e591=JSON[_0x284dcc(0x232)](_0x4a3984,null,0x2);fs['writeFileSync'](_0x364061,_0x34e591),config=getConfiguration(),io['to'](_0x284dcc(0x1b9))['emit']('bots',config),broadcastToBots(_0x284dcc(0x342),JSON[_0x284dcc(0x232)](config));}}function validateTelegram(_0x499535){const _0x1690b3=_0x1354cc;if(_0x499535['from'][_0x1690b3(0x1dd)]!=settings['telegramUsername']&&'@'+_0x499535[_0x1690b3(0x1ba)][_0x1690b3(0x1dd)]!=settings[_0x1690b3(0x1c6)]||_0x499535['chat']['id']!=settings[_0x1690b3(0x22d)])return sendTelegram(_0x499535[_0x1690b3(0x237)]['id'],_0x1690b3(0x1fc),{'parse_mode':_0x1690b3(0x1cf)}),![];return!![];}function botRef(_0x532e6a){const _0x453a87=_0x1354cc,_0x27ad06=getBotAttributes(_0x532e6a),_0x8503e4=_0x27ad06[_0x453a87(0x32e)]?_0x27ad06[_0x453a87(0x320)]:'Bot\x20'+_0x532e6a;return _0x8503e4;}async function initTelegram(){const _0x137e83=_0x1354cc;tgBot&&(await tgBot[_0x137e83(0x2cc)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x137e83(0x2a8)]);let _0x3e147c=_0x137e83(0x304);_0x3e147c+='\x0a',_0x3e147c+=_0x137e83(0x1db),_0x3e147c+=_0x137e83(0x38f),_0x3e147c+=_0x137e83(0x275),_0x3e147c+=_0x137e83(0x2b0),_0x3e147c+=_0x137e83(0x1d6),_0x3e147c+=_0x137e83(0x31b),_0x3e147c+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x3e147c+='/names\x20-\x20show\x20bot\x20names\x0a',_0x3e147c+=_0x137e83(0x220),_0x3e147c+=_0x137e83(0x1b6),_0x3e147c+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x3e147c+=_0x137e83(0x1ed),_0x3e147c+=_0x137e83(0x256),_0x3e147c+=_0x137e83(0x265),_0x3e147c+=_0x137e83(0x198),_0x3e147c+=_0x137e83(0x349);let _0x300c87=_0x137e83(0x1b0);_0x300c87+='\x0a',_0x300c87+=_0x3e147c,tgBot['catch']((_0x42fe3e,_0x28fc74)=>{const _0x43b2ed=_0x137e83;logger[_0x43b2ed(0x308)](getTimeStamp()+_0x43b2ed(0x20f)),logger[_0x43b2ed(0x386)](_0x43b2ed(0x214),_0x42fe3e);}),tgBot[_0x137e83(0x360)](async(_0x5877a8,_0x21f86a)=>{const _0x5cce75=_0x137e83;if(settings[_0x5cce75(0x22d)]||_0x5877a8[_0x5cce75(0x2d1)][_0x5cce75(0x288)]['text']!='/start'){if(!validateTelegram(_0x5877a8))return;}_0x21f86a();}),tgBot[_0x137e83(0x387)](_0x137e83(0x30f),async _0x382611=>{const _0x155897=_0x137e83;if(_0x382611[_0x155897(0x1ba)][_0x155897(0x1dd)]==settings[_0x155897(0x1c6)]||'@'+_0x382611[_0x155897(0x1ba)][_0x155897(0x1dd)]==settings['telegramUsername']){if(!settings[_0x155897(0x22d)])updateSetting('telegramChatId',_0x382611[_0x155897(0x237)]['id']);else{if(!validateTelegram(_0x382611))return;}}else{if(!validateTelegram(_0x382611))return;}updateSetting(_0x155897(0x272),!![]),await sendTelegram(_0x382611['chat']['id'],_0x300c87);}),tgBot[_0x137e83(0x387)](_0x137e83(0x316),async _0x590c31=>{const _0x48305f=_0x137e83;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x590c31[_0x48305f(0x237)]['id'],_0x48305f(0x1d7));}),tgBot['command']('disable',async _0x17a8d3=>{const _0x2a48d8=_0x137e83;await sendTelegram(_0x17a8d3[_0x2a48d8(0x237)]['id'],_0x2a48d8(0x317)),updateSetting(_0x2a48d8(0x272),![]);}),tgBot['command']('config',async _0xac581d=>{const _0x5cfb1e=_0x137e83,_0x4e51dd=Markup[_0x5cfb1e(0x2e6)]([Markup[_0x5cfb1e(0x380)][_0x5cfb1e(0x1da)](_0x5cfb1e(0x209),_0x5cfb1e(0x1e0)),Markup[_0x5cfb1e(0x380)][_0x5cfb1e(0x1da)]('Alerts',_0x5cfb1e(0x382)),Markup['button'][_0x5cfb1e(0x1da)](_0x5cfb1e(0x2ed),_0x5cfb1e(0x2c9))]);_0xac581d[_0x5cfb1e(0x1ce)](_0x5cfb1e(0x1f1),_0x4e51dd);}),tgBot['action'](_0x137e83(0x1e0),async _0x21e9eb=>{const _0x4bc844=_0x137e83;_0x21e9eb[_0x4bc844(0x22f)](),updateSetting('telegramEvents',_0x4bc844(0x2e0)),updateSetting(_0x4bc844(0x272),!![]),await sendTelegram(_0x21e9eb[_0x4bc844(0x237)]['id'],_0x4bc844(0x25a));}),tgBot[_0x137e83(0x25d)](_0x137e83(0x382),async _0x15d9bc=>{const _0x129f6c=_0x137e83;_0x15d9bc[_0x129f6c(0x22f)](),updateSetting(_0x129f6c(0x35c),_0x129f6c(0x200)),updateSetting(_0x129f6c(0x272),!![]),await sendTelegram(_0x15d9bc[_0x129f6c(0x237)]['id'],_0x129f6c(0x330));}),tgBot[_0x137e83(0x25d)]('config_all',async _0x267318=>{const _0x5366fe=_0x137e83;_0x267318[_0x5366fe(0x22f)](),updateSetting(_0x5366fe(0x35c),'all'),updateSetting(_0x5366fe(0x272),!![]),await sendTelegram(_0x267318['chat']['id'],_0x5366fe(0x298));}),tgBot['command']('status',async _0x4fa3b9=>{const _0x1ecce9=_0x137e83,_0x4487e8=getBotsWithMode();let _0x3bdb38=_0x1ecce9(0x28a);config[_0x1ecce9(0x182)](_0x1d31cc=>{const _0x202f1e=_0x1ecce9,_0x3fecfa=_0x4487e8[_0x202f1e(0x1b2)](_0x5ce544=>_0x5ce544[_0x202f1e(0x22c)]==_0x1d31cc[_0x202f1e(0x22c)])[_0x202f1e(0x19b)];_0x3bdb38+='Bot\x20'+_0x1d31cc[_0x202f1e(0x22c)]+':\x20'+_0x1d31cc[_0x202f1e(0x1e4)]+_0x202f1e(0x296)+_0x3fecfa+_0x202f1e(0x296)+_0x1d31cc[_0x202f1e(0x2de)]+'\x0a';}),_0x3bdb38+='\x0a',_0x3bdb38+=_0x1ecce9(0x2df),_0x3bdb38+=!settings[_0x1ecce9(0x272)]?_0x1ecce9(0x1e2):_0x1ecce9(0x2a9),_0x3bdb38+=settings[_0x1ecce9(0x272)]?settings['telegramEvents']==_0x1ecce9(0x309)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x1ecce9(0x1fb)+settings[_0x1ecce9(0x35c)]+_0x1ecce9(0x335):'',await sendTelegram(_0x4fa3b9['chat']['id'],_0x3bdb38,{'parse_mode':_0x1ecce9(0x1cf)});}),tgBot[_0x137e83(0x387)](_0x137e83(0x35d),async _0xb959f2=>{const _0x4e5f56=_0x137e83,_0x257d6e=getEnabledBots();if(_0x257d6e[_0x4e5f56(0x34e)]==0x0)await sendTelegram(_0xb959f2[_0x4e5f56(0x237)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x257d6e[_0x4e5f56(0x34e)]>0x1)_0x257d6e[_0x4e5f56(0x2d5)]({'botID':_0x4e5f56(0x309)});let _0x20ceca=[],_0x410a0c=[];const _0x1e6f29=_0x257d6e[_0x4e5f56(0x34e)]%0x4==0x0||_0x257d6e[_0x4e5f56(0x34e)]%0x4==0x3||_0x257d6e[_0x4e5f56(0x34e)]%0x3==0x1?0x4:0x3;let _0x41200b=0x0;_0x257d6e[_0x4e5f56(0x182)]((_0x1b4c0e,_0x2d0505)=>{const _0x30314d=_0x4e5f56;if(_0x2d0505%_0x1e6f29==0x0)_0x410a0c=[];_0x410a0c[_0x30314d(0x2d5)](Markup[_0x30314d(0x380)][_0x30314d(0x1da)](_0x1b4c0e[_0x30314d(0x22c)]==_0x30314d(0x309)?'All\x20bots':botRef(_0x1b4c0e[_0x30314d(0x22c)]),'restart_'+_0x1b4c0e[_0x30314d(0x22c)])),_0x2d0505%_0x1e6f29==0x0&&(_0x20ceca[_0x41200b]=_0x410a0c,_0x41200b++);});const _0x3997dc=Markup['inlineKeyboard'](_0x20ceca);_0xb959f2['reply'](_0x4e5f56(0x2a4),_0x3997dc);}}),tgBot['action'](/restart_(.+)/,async _0x5e0279=>{const _0x10a9b3=_0x137e83,_0x2cc58d=_0x5e0279[_0x10a9b3(0x26e)][0x1];_0x5e0279[_0x10a9b3(0x22f)](),_0x2cc58d==_0x10a9b3(0x309)?config[_0x10a9b3(0x182)](_0x3a0961=>{const _0x42d7f8=_0x10a9b3;restartBot(_0x3a0961[_0x42d7f8(0x22c)]);}):restartBot(_0x2cc58d);}),tgBot[_0x137e83(0x387)]('on',async _0x336210=>{const _0x1e36ac=_0x137e83,_0x2b78ef=getDisabledBots();if(_0x2b78ef[_0x1e36ac(0x34e)]==0x0)await sendTelegram(_0x336210[_0x1e36ac(0x237)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x2b78ef[_0x1e36ac(0x34e)]>0x1)_0x2b78ef['push']({'botID':'all'});let _0x54ddf5=[],_0x5c373e=[];const _0xc58fb9=_0x2b78ef[_0x1e36ac(0x34e)]%0x4==0x0||_0x2b78ef[_0x1e36ac(0x34e)]%0x4==0x3||_0x2b78ef['length']%0x3==0x1?0x4:0x3;let _0x41ded6=0x0;_0x2b78ef[_0x1e36ac(0x182)]((_0x5b05f0,_0x3a682f)=>{const _0x5da7f9=_0x1e36ac;if(_0x3a682f%_0xc58fb9==0x0)_0x5c373e=[];_0x5c373e['push'](Markup['button'][_0x5da7f9(0x1da)](_0x5b05f0['botID']==_0x5da7f9(0x309)?_0x5da7f9(0x18b):botRef(_0x5b05f0[_0x5da7f9(0x22c)]),_0x5da7f9(0x23c)+_0x5b05f0[_0x5da7f9(0x22c)])),_0x3a682f%_0xc58fb9==0x0&&(_0x54ddf5[_0x41ded6]=_0x5c373e,_0x41ded6++);});const _0x7c01a5=Markup[_0x1e36ac(0x2e6)](_0x54ddf5);_0x336210[_0x1e36ac(0x1ce)](_0x1e36ac(0x22b),_0x7c01a5);}}),tgBot[_0x137e83(0x25d)](/on_(.+)/,async _0x4b4dd3=>{const _0x3ba22d=_0x137e83,_0x331b29=_0x4b4dd3['match'][0x1];_0x4b4dd3['editMessageReplyMarkup']();if(_0x331b29==_0x3ba22d(0x309)){const _0x1d65d1=getDisabledBots();await sendTelegram(_0x4b4dd3[_0x3ba22d(0x237)]['id'],_0x3ba22d(0x1a0)),_0x1d65d1['forEach'](_0x449e55=>{const _0xda5a23=_0x3ba22d;if(_0x449e55[_0xda5a23(0x22c)]!=_0xda5a23(0x309))toggleBot(_0x449e55[_0xda5a23(0x22c)],toggleStatus(_0x449e55['botID']),_0xda5a23(0x1f7));});}else await sendTelegram(_0x4b4dd3[_0x3ba22d(0x237)]['id'],'Bot\x20Mgr\x20>\x20Starting\x20'+botRef(_0x331b29)),toggleBot(_0x331b29,toggleStatus(_0x331b29),'stopped');}),tgBot[_0x137e83(0x387)](_0x137e83(0x20c),async _0x32bdb5=>{const _0x3e1c98=_0x137e83,_0x472a90=getEnabledBots();if(_0x472a90['length']==0x0)await sendTelegram(_0x32bdb5[_0x3e1c98(0x237)]['id'],_0x3e1c98(0x23f));else{if(_0x472a90[_0x3e1c98(0x34e)]>0x1)_0x472a90['push']({'botID':'all'});let _0x2f468c=[],_0x210cdd=[];const _0x3effa7=_0x472a90['length']%0x4==0x0||_0x472a90[_0x3e1c98(0x34e)]%0x4==0x3||_0x472a90[_0x3e1c98(0x34e)]%0x3==0x1?0x4:0x3;let _0xdf7a4f=0x0;_0x472a90[_0x3e1c98(0x182)]((_0x2d9422,_0x518c42)=>{const _0x4f4ed0=_0x3e1c98;if(_0x518c42%_0x3effa7==0x0)_0x210cdd=[];_0x210cdd[_0x4f4ed0(0x2d5)](Markup['button'][_0x4f4ed0(0x1da)](_0x2d9422[_0x4f4ed0(0x22c)]==_0x4f4ed0(0x309)?'All\x20bots':botRef(_0x2d9422[_0x4f4ed0(0x22c)]),_0x4f4ed0(0x183)+_0x2d9422['botID'])),_0x518c42%_0x3effa7==0x0&&(_0x2f468c[_0xdf7a4f]=_0x210cdd,_0xdf7a4f++);});const _0x5150be=Markup[_0x3e1c98(0x2e6)](_0x2f468c);_0x32bdb5['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x5150be);}}),tgBot[_0x137e83(0x25d)](/off_(.+)/,async _0x20f877=>{const _0x29b954=_0x137e83,_0x5eb0f2=_0x20f877['match'][0x1];_0x20f877[_0x29b954(0x22f)]();if(_0x5eb0f2==_0x29b954(0x309)){const _0x2ec54a=getEnabledBots();await sendTelegram(_0x20f877[_0x29b954(0x237)]['id'],_0x29b954(0x2f2)),_0x2ec54a[_0x29b954(0x182)](_0x2ee7f4=>{const _0x5720ff=_0x29b954;if(_0x2ee7f4[_0x5720ff(0x22c)]!=_0x5720ff(0x309))toggleBot(_0x2ee7f4['botID'],toggleStatus(_0x2ee7f4[_0x5720ff(0x22c)]),_0x5720ff(0x1f7));});}else await sendTelegram(_0x20f877[_0x29b954(0x237)]['id'],'Bot\x20Mgr\x20>\x20Stopping\x20'+botRef(_0x5eb0f2)),toggleBot(_0x5eb0f2,toggleStatus(_0x5eb0f2),_0x29b954(0x1f7));}),tgBot[_0x137e83(0x387)](_0x137e83(0x2f1),async _0x83fd47=>{const _0x3be12f=_0x137e83,_0x1cc7e7=getEnabledBots();if(_0x1cc7e7['length']==0x0)await sendTelegram(_0x83fd47[_0x3be12f(0x237)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1cc7e7[_0x3be12f(0x34e)]>0x1){let _0x8697a7=[],_0x2f7213=[];const _0x18e646=_0x1cc7e7[_0x3be12f(0x34e)]%0x4==0x0||_0x1cc7e7[_0x3be12f(0x34e)]%0x4==0x3||_0x1cc7e7[_0x3be12f(0x34e)]%0x3==0x1?0x4:0x3;let _0x3bf7a9=0x0;_0x1cc7e7['forEach']((_0x374ed8,_0x1bf582)=>{const _0x1f3e10=_0x3be12f;if(_0x1bf582%_0x18e646==0x0)_0x2f7213=[];_0x2f7213['push'](Markup[_0x1f3e10(0x380)][_0x1f3e10(0x1da)](botRef(_0x374ed8['botID']),_0x1f3e10(0x1af)+_0x374ed8[_0x1f3e10(0x22c)])),_0x1bf582%_0x18e646==0x0&&(_0x8697a7[_0x3bf7a9]=_0x2f7213,_0x3bf7a9++);});const _0x231bf6=Markup[_0x3be12f(0x2e6)](_0x8697a7);_0x83fd47[_0x3be12f(0x1ce)](_0x3be12f(0x354),_0x231bf6);}else{const _0x23eaf2=_0x1cc7e7[0x0]['botID'];if(pid[_0x23eaf2])pid[_0x23eaf2][_0x3be12f(0x1a5)]({'function':_0x3be12f(0x1a8),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x52d620=>{const _0xcc27ac=_0x137e83,_0x3bd0c3=_0x52d620[_0xcc27ac(0x26e)][0x1];_0x52d620[_0xcc27ac(0x22f)]();if(pid[_0x3bd0c3])pid[_0x3bd0c3]['send']({'function':'sendMetricsTelegram','args':null});}),tgBot['command'](_0x137e83(0x27f),async _0x26038c=>{const _0x554011=_0x137e83,_0x509024=getEnabledBots();if(_0x509024[_0x554011(0x34e)]==0x0)await sendTelegram(_0x26038c[_0x554011(0x237)]['id'],_0x554011(0x23f));else{if(_0x509024[_0x554011(0x34e)]>0x1){let _0x475a64=[],_0x4fb372=[];const _0x3b5528=_0x509024['length']%0x4==0x0||_0x509024['length']%0x4==0x3||_0x509024['length']%0x3==0x1?0x4:0x3;let _0x1ae4e5=0x0;_0x509024[_0x554011(0x182)]((_0x2db375,_0x5ad3af)=>{const _0x44328d=_0x554011;if(_0x5ad3af%_0x3b5528==0x0)_0x4fb372=[];_0x4fb372[_0x44328d(0x2d5)](Markup[_0x44328d(0x380)][_0x44328d(0x1da)](botRef(_0x2db375[_0x44328d(0x22c)]),_0x44328d(0x24a)+_0x2db375[_0x44328d(0x22c)])),_0x5ad3af%_0x3b5528==0x0&&(_0x475a64[_0x1ae4e5]=_0x4fb372,_0x1ae4e5++);});const _0x5abc45=Markup[_0x554011(0x2e6)](_0x475a64);_0x26038c[_0x554011(0x1ce)](_0x554011(0x24c),_0x5abc45);}else{const _0x5c29f4=_0x509024[0x0][_0x554011(0x22c)];if(pid[_0x5c29f4])pid[_0x5c29f4][_0x554011(0x1a5)]({'function':_0x554011(0x340),'args':null});}}}),tgBot[_0x137e83(0x25d)](/portfolio_(.+)/,async _0x455017=>{const _0xfb52d5=_0x137e83,_0x4520e3=_0x455017[_0xfb52d5(0x26e)][0x1];_0x455017['editMessageReplyMarkup']();if(pid[_0x4520e3])pid[_0x4520e3]['send']({'function':_0xfb52d5(0x340),'args':null});}),tgBot[_0x137e83(0x387)](_0x137e83(0x1e3),async _0x341b1b=>{const _0x1b45ba=_0x137e83,_0x39ffa0=_0x1b45ba(0x1e3);await zipFiles(_0x39ffa0);const _0x4b9e88=zippath+(_0x39ffa0+'.zip');_0x341b1b['replyWithDocument']({'source':_0x4b9e88})[_0x1b45ba(0x1b1)](()=>{})[_0x1b45ba(0x1b8)](_0x370598=>logger[_0x1b45ba(0x386)](_0x1b45ba(0x192)+_0x39ffa0+'\x20files\x20over\x20Telegram:',_0x370598));}),tgBot[_0x137e83(0x387)](_0x137e83(0x33b),async _0x176a0d=>{const _0x1fc232=_0x137e83,_0x476d5b=_0x1fc232(0x33b);await backupConfigFiles(),await zipFiles(_0x476d5b);const _0x9f39c6=zippath+(_0x476d5b+'.zip');_0x176a0d[_0x1fc232(0x37b)]({'source':_0x9f39c6})['then'](()=>{})[_0x1fc232(0x1b8)](_0x227a45=>logger[_0x1fc232(0x386)]('Error\x20sending\x20'+_0x476d5b+_0x1fc232(0x2aa),_0x227a45));}),tgBot['command'](_0x137e83(0x2d1),async _0x2b4fb3=>{const _0x1929c9=_0x137e83;await getMessages();if(!updateAvailable)await sendTelegram(_0x2b4fb3['chat']['id'],_0x1929c9(0x343));else{if(!validInstallation)await sendTelegram(_0x2b4fb3[_0x1929c9(0x237)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x2e0319=Markup['inlineKeyboard']([Markup[_0x1929c9(0x380)]['callback']('Yes',_0x1929c9(0x2b2)),Markup[_0x1929c9(0x380)][_0x1929c9(0x1da)]('No',_0x1929c9(0x37f))]);_0x2b4fb3[_0x1929c9(0x1ce)](_0x1929c9(0x2b8),_0x2e0319);}}}),tgBot[_0x137e83(0x25d)](/update_(.+)/,async _0x2f862f=>{const _0x5609c0=_0x137e83,_0x9993c=_0x2f862f[_0x5609c0(0x26e)][0x1];_0x2f862f[_0x5609c0(0x22f)](),_0x9993c=='yes'&&(await sendTelegram(_0x2f862f[_0x5609c0(0x237)]['id'],_0x5609c0(0x2fc)),updateBB('update')),_0x9993c=='no'&&await sendTelegram(_0x2f862f[_0x5609c0(0x237)]['id'],_0x5609c0(0x2a5));}),tgBot['command'](_0x137e83(0x267),async _0x3b70cf=>{const _0x3cf8cc=_0x137e83;if(!validInstallation)await sendTelegram(_0x3b70cf[_0x3cf8cc(0x237)]['id'],_0x3cf8cc(0x187));else{const _0x465725=Markup[_0x3cf8cc(0x2e6)]([Markup['button'][_0x3cf8cc(0x1da)](_0x3cf8cc(0x251),'reinstall_yes'),Markup['button'][_0x3cf8cc(0x1da)]('No',_0x3cf8cc(0x1e8))]);_0x3b70cf[_0x3cf8cc(0x1ce)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x465725);}}),tgBot[_0x137e83(0x25d)](/reinstall_(.+)/,async _0x4f312a=>{const _0x23c781=_0x137e83,_0x1be910=_0x4f312a[_0x23c781(0x26e)][0x1];_0x4f312a[_0x23c781(0x22f)](),_0x1be910==_0x23c781(0x38b)&&(await sendTelegram(_0x4f312a[_0x23c781(0x237)]['id'],_0x23c781(0x1d3)),updateBB(_0x23c781(0x267))),_0x1be910=='no'&&await sendTelegram(_0x4f312a[_0x23c781(0x237)]['id'],_0x23c781(0x339));}),tgBot[_0x137e83(0x387)](_0x137e83(0x216),async _0x4ec604=>{const _0x42a505=_0x137e83,_0xcd91e9=getBotsWithMode();if(_0xcd91e9['length']==0x0)await sendTelegram(_0x4ec604[_0x42a505(0x237)]['id'],_0x42a505(0x23f));else{let _0x3d45f6=[],_0x26bebe=[];const _0x3dd41d=0x2;let _0x4832d8=0x0;_0xcd91e9['forEach']((_0x49c16e,_0x1bc10c)=>{const _0x2d8769=_0x42a505;if(_0x1bc10c%_0x3dd41d==0x0)_0x26bebe=[];_0x26bebe['push'](Markup[_0x2d8769(0x380)]['callback'](botRef(_0x49c16e[_0x2d8769(0x22c)])+'\x20('+_0x49c16e[_0x2d8769(0x19b)]+')',_0x2d8769(0x1ac)+_0x49c16e['botID'])),_0x1bc10c%_0x3dd41d==0x0&&(_0x3d45f6[_0x4832d8]=_0x26bebe,_0x4832d8++);});const _0x19bc1d=Markup[_0x42a505(0x2e6)](_0x3d45f6);_0x4ec604[_0x42a505(0x1ce)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x19bc1d);}}),tgBot[_0x137e83(0x25d)](/toggle_(.+)/,async _0x825837=>{const _0x20e016=_0x137e83,_0x3e8cdb=_0x825837[_0x20e016(0x26e)][0x1];_0x825837[_0x20e016(0x22f)]();const _0x362fc7=getBotsWithMode(),_0x40a556=_0x362fc7[_0x20e016(0x1b2)](_0x51edb7=>_0x51edb7[_0x20e016(0x22c)]==_0x3e8cdb),_0x583aad=_0x40a556[_0x20e016(0x19b)]=='auto'?_0x20e016(0x247):_0x20e016(0x1f6);await sendTelegram(_0x825837['chat']['id'],_0x20e016(0x32c)+botRef(_0x40a556[_0x20e016(0x22c)])+_0x20e016(0x372)+_0x583aad+'\x20mode'),toggleBotMode(_0x3e8cdb);}),tgBot[_0x137e83(0x387)](_0x137e83(0x375),async _0x2083f5=>{const _0x5ace4f=_0x137e83;let _0x12b9f7='';config[_0x5ace4f(0x182)](_0xa06603=>{const _0xeb96b7=_0x5ace4f;_0x12b9f7+='Bot\x20'+_0xa06603[_0xeb96b7(0x22c)]+':\x20'+_0xa06603[_0xeb96b7(0x320)]+'\x0a';}),await sendTelegram(_0x2083f5[_0x5ace4f(0x237)]['id'],_0x12b9f7,{'parse_mode':_0x5ace4f(0x1cf)});}),tgBot['command'](_0x137e83(0x25c),async _0x5a9a23=>{const _0xf215b6=_0x137e83;await sendTelegram(_0x5a9a23[_0xf215b6(0x237)]['id'],_0x3e147c);}),process['once'](_0x137e83(0x365),()=>tgBot[_0x137e83(0x2cc)]('SIGINT')),process['once'](_0x137e83(0x26c),()=>tgBot[_0x137e83(0x2cc)](_0x137e83(0x26c))),tgBot[_0x137e83(0x327)]();}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x307690,_0x37a06e,_0x3df6e4){const _0x235c91=_0x1354cc;_0x3df6e4={..._0x3df6e4,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0x235c91(0x17d)](_0x307690,_0x37a06e,_0x3df6e4);}catch(_0x1c9777){logger[_0x235c91(0x386)](_0x235c91(0x234),_0x1c9777);}}async function sendTelegramBot(_0x3570f3,_0x1fa556){const _0x212d9f=_0x1354cc;if(settings[_0x212d9f(0x272)]){if(settings[_0x212d9f(0x35c)]==_0x212d9f(0x309)||(_0x1fa556['type']==_0x212d9f(0x277)||_0x1fa556[_0x212d9f(0x2fd)]==_0x212d9f(0x2af)||_0x1fa556[_0x212d9f(0x2fd)]==_0x212d9f(0x249))&&settings[_0x212d9f(0x35c)]==_0x212d9f(0x200)||_0x1fa556['type']==_0x212d9f(0x36f)&&settings[_0x212d9f(0x35c)]=='orders'){if(tgBot&&settings[_0x212d9f(0x22d)]){if(_0x1fa556[_0x212d9f(0x32e)])await sendTelegram(settings[_0x212d9f(0x22d)],_0x1fa556[_0x212d9f(0x320)]+'\x20>\x20'+_0x1fa556[_0x212d9f(0x367)]);else await sendTelegram(settings['telegramChatId'],_0x212d9f(0x228)+_0x3570f3+'\x20>\x20'+_0x1fa556['event']);}}}}async function sendTelegramMsg(_0x5714e7,_0x3b9187='HTML'){const _0x53873e=_0x1354cc;return tgBot&&settings[_0x53873e(0x22d)]?(await sendTelegram(settings[_0x53873e(0x22d)],_0x5714e7,{'parse_mode':_0x3b9187}),!![]):![];}function getDeviceWithIp(_0x586d34){return devices['find'](_0x1e2b5c=>_0x1e2b5c['ip']===_0x586d34);}async function temporaryAccess2FA(_0x34e18c,_0x45a4c9){const _0x3af157=_0x1354cc;let _0x1f2d91=new Date(),_0x41f908=![];if(lastIpApproval){if(_0x1f2d91-lastIpApproval<0x1388)_0x41f908=!![];}lastIpApproval=new Date();if(_0x41f908)return;if(tgBot&&settings['telegramChatId']){const _0x567047=uuidRandom();tmpStorage[_0x567047]={'uuid':_0x34e18c,'externalip':_0x45a4c9};const _0x3f8d2e=Markup['inlineKeyboard']([Markup['button'][_0x3af157(0x1da)](_0x3af157(0x1f5),_0x3af157(0x2ec)+_0x567047),Markup['button'][_0x3af157(0x1da)](_0x3af157(0x1c1),'tempaccess_15_'+_0x567047),Markup[_0x3af157(0x380)][_0x3af157(0x1da)](_0x3af157(0x27a),'tempaccess_30_'+_0x567047),Markup[_0x3af157(0x380)][_0x3af157(0x1da)](_0x3af157(0x31c),_0x3af157(0x388)+_0x567047)]);await sendTelegram(settings['telegramChatId'],_0x3af157(0x245)+normalizeIP(_0x45a4c9)['show']+'\x20?',_0x3f8d2e),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x27afa5=>{const _0x22205d=_0x3af157,_0x40177c=_0x27afa5[_0x22205d(0x26e)][0x1],_0x276345=_0x27afa5['match'][0x2],{uuid:_0x4e9802,externalip:_0x3cb6e4}=tmpStorage[_0x276345];delete tmpStorage[_0x276345],_0x27afa5[_0x22205d(0x22f)](),devices[_0x4e9802][_0x22205d(0x23b)]={'clientip':_0x3cb6e4,'timestamp':new Date()[_0x22205d(0x2b7)](),'expiry':_0x40177c},_0x40177c!=_0x22205d(0x31c)?(await sendTelegram(_0x27afa5['chat']['id'],'Access\x20enabled\x20for\x20'+_0x40177c+'\x20minutes',{'parse_mode':_0x22205d(0x1cf)}),io['to'](_0x4e9802)[_0x22205d(0x370)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x27afa5[_0x22205d(0x237)]['id'],_0x22205d(0x1d5)),io['to'](_0x4e9802)[_0x22205d(0x370)]('status',{'access':{'allow':![],'reason':_0x22205d(0x2ef),'token':null}}));});}}async function loginAccess2FA(_0x375199,_0x35505){const _0x387710=_0x1354cc;if(tgBot&&settings[_0x387710(0x22d)]){const _0x1c7fcd=uuidRandom();tmpStorage[_0x1c7fcd]={'uuid':_0x375199,'externalip':_0x35505};const _0x33a9e7=Markup[_0x387710(0x2e6)]([Markup[_0x387710(0x380)][_0x387710(0x1da)](_0x387710(0x361),'login2fa_'+loginExpiry+'_'+_0x1c7fcd),Markup[_0x387710(0x380)]['callback'](_0x387710(0x31c),'login2fa_reject_'+_0x1c7fcd)]);await sendTelegram(settings[_0x387710(0x22d)],_0x387710(0x273)+normalizeIP(_0x35505)[_0x387710(0x34c)]+'\x20?',_0x33a9e7),tgBot[_0x387710(0x25d)](/login2fa_(.+)_(.+)/,async _0x56334c=>{const _0x16580d=_0x387710,_0x5eb006=_0x56334c[_0x16580d(0x26e)][0x1],_0x37f0d2=_0x56334c[_0x16580d(0x26e)][0x2],{uuid:_0x51b35e,externalip:_0x4ce7cc}=tmpStorage[_0x37f0d2];delete tmpStorage[_0x37f0d2],_0x56334c[_0x16580d(0x22f)](),devices[_0x51b35e][_0x16580d(0x35b)]={'clientip':_0x4ce7cc,'timestamp':new Date()[_0x16580d(0x2b7)](),'expiry':_0x5eb006},_0x5eb006!=_0x16580d(0x31c)?(await sendTelegram(_0x56334c[_0x16580d(0x237)]['id'],'Login\x20accepted',{'parse_mode':_0x16580d(0x1cf)}),io['to'](_0x51b35e)[_0x16580d(0x370)](_0x16580d(0x1e4),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x56334c['chat']['id'],_0x16580d(0x34a)),io['to'](_0x51b35e)[_0x16580d(0x370)](_0x16580d(0x1e4),{'access':{'allow':![],'reason':_0x16580d(0x218),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x552272=_0x1354cc;return dbConfig[_0x552272(0x1bb)](_0x552272(0x342))[_0x552272(0x188)]('botID')[_0x552272(0x2bf)]({'status':_0x552272(0x2be)})[_0x552272(0x33a)]()||[];}function getDisabledBots(){const _0x2342ac=_0x1354cc;return dbConfig[_0x2342ac(0x1bb)](_0x2342ac(0x342))[_0x2342ac(0x188)]('botID')[_0x2342ac(0x2bf)]({'status':'disabled'})[_0x2342ac(0x33a)]()||[];}function getBotAttributes(_0x222d4c){const _0x1295b7=_0x1354cc;let _0x3778a4={};const _0x27df8b=configpath+_0x1295b7(0x1c7)+_0x222d4c+_0x1295b7(0x379),_0x5a610f=fs[_0x1295b7(0x313)](_0x27df8b);if(_0x5a610f){const _0x2487d7=fs[_0x1295b7(0x1bd)](_0x27df8b);try{const _0x376c36=JSON[_0x1295b7(0x250)](_0x2487d7),_0x3d6973=_0x376c36?_0x376c36[_0x1295b7(0x270)][0x0][_0x1295b7(0x1d4)]:![];_0x3778a4[_0x1295b7(0x19b)]=_0x3d6973?_0x1295b7(0x1f6):_0x1295b7(0x247),_0x3778a4[_0x1295b7(0x320)]=_0x376c36?_0x376c36[_0x1295b7(0x270)][0x0][_0x1295b7(0x320)]:'Bot\x20'+_0x222d4c,_0x3778a4['showname']=_0x376c36?_0x376c36['bot'][0x0][_0x1295b7(0x32e)]:![];}catch(_0x33f723){_0x3778a4[_0x1295b7(0x19b)]='manual',_0x3778a4['botname']='Bot\x20'+_0x222d4c,_0x3778a4[_0x1295b7(0x32e)]=![];}}else _0x3778a4[_0x1295b7(0x19b)]='manual',_0x3778a4[_0x1295b7(0x320)]='Bot\x20'+_0x222d4c,_0x3778a4[_0x1295b7(0x32e)]=![];return _0x3778a4;}function getBotsWithMode(){const _0x2cb0a0=_0x1354cc,_0xcf4a82=dbConfig[_0x2cb0a0(0x1bb)](_0x2cb0a0(0x342))[_0x2cb0a0(0x188)](_0x2cb0a0(0x22c))[_0x2cb0a0(0x33a)]()||[];return _0xcf4a82['forEach'](_0x46840b=>{const _0x4baa8b=_0x2cb0a0;let _0x3bd841=getBotAttributes(_0x46840b[_0x4baa8b(0x22c)]);_0x46840b[_0x4baa8b(0x19b)]=_0x3bd841[_0x4baa8b(0x19b)];}),_0xcf4a82;}function getBotExchanges(){const _0x4a230a=_0x1354cc;let _0x54a756=[];const _0x1479f9=dbConfig['get']('bots')[_0x4a230a(0x188)](_0x4a230a(0x22c))['value']()||[];_0x1479f9[_0x4a230a(0x182)](_0x38294f=>{const _0x1e1760=_0x4a230a;if(_0x38294f[_0x1e1760(0x1e4)]==_0x1e1760(0x2be)){const _0x420087=configpath+'bot-'+_0x38294f[_0x1e1760(0x22c)]+_0x1e1760(0x379),_0x47758a=fs[_0x1e1760(0x313)](_0x420087);let _0x539544;if(_0x47758a){const _0x35be57=fs['readFileSync'](_0x420087);try{const _0x492305=JSON[_0x1e1760(0x250)](_0x35be57);_0x539544=_0x492305?_0x492305['bot'][0x0][_0x1e1760(0x231)]:null;}catch(_0x37f8f9){}}if(_0x539544)_0x54a756['push'](_0x539544);}});const _0x42c178=[...new Set(_0x54a756)]['sort']();return _0x42c178;}async function initUser(){const _0x41a011=_0x1354cc;if(!settings['userid']){const _0x36c709=uuidRandom();mixpanel[_0x41a011(0x390)](_0x36c709),updateSetting(_0x41a011(0x2cb),_0x36c709);}}async function initSecure(){const _0x2d23be=_0x1354cc;let _0x3c8930=getSecure();if(!_0x3c8930[_0x2d23be(0x197)](_0x2d23be(0x222))){let _0x3647ce=await generateKeys();_0x3c8930[_0x2d23be(0x1cb)]=_0x3647ce[_0x2d23be(0x1cb)],_0x3c8930['privateKey']=_0x3647ce[_0x2d23be(0x326)],_0x3c8930[_0x2d23be(0x222)]=crypto['randomBytes'](0x20)['toString'](_0x2d23be(0x2c3));;storeSecure(_0x3c8930);}}function getSettings(){const _0x2f3fee=_0x1354cc;return dbSettings['get'](_0x2f3fee(0x252))[_0x2f3fee(0x33a)]()||{};}function getSecure(){const _0x491704=_0x1354cc;return dbSecure[_0x491704(0x1bb)](_0x491704(0x278))[_0x491704(0x33a)]()||{};}function getBlacklist(){const _0x43f3b2=_0x1354cc;return dbSecure[_0x43f3b2(0x1bb)](_0x43f3b2(0x2f8))[_0x43f3b2(0x33a)]()||[];}function broadcastToBots(_0x4cb792,_0x427e47){config['forEach'](_0x493592=>{const _0x3b593b=_0x4878;if(_0x493592[_0x3b593b(0x1e4)]=='enabled'&&_0x493592['live']==_0x3b593b(0x348)||_0x493592['status']==_0x3b593b(0x305)&&_0x493592[_0x3b593b(0x2de)]=='running'){if(pid[_0x493592[_0x3b593b(0x22c)]])pid[_0x493592['botID']][_0x3b593b(0x1a5)]({[_0x4cb792]:_0x427e47});}});}async function storeSettings(_0x35fc2b,_0x5307ef=![]){const _0x426c8c=_0x1354cc;_0x35fc2b={...settings,..._0x35fc2b};if(_0x5307ef&&_0x35fc2b[_0x426c8c(0x2ad)]!=_0x426c8c(0x261)&&_0x35fc2b[_0x426c8c(0x2ad)]!=_0x426c8c(0x241)&&_0x35fc2b[_0x426c8c(0x2ad)]!=''){const _0x379042=decryptRSA(secure['privateKey'],_0x35fc2b['bbPassword'])[_0x426c8c(0x185)](_0x426c8c(0x324))[0x0],_0x41d924=bcrypt[_0x426c8c(0x2e5)](_0x379042,saltRounds);_0x35fc2b={..._0x35fc2b,'bbPassword':_0x41d924};}if(_0x5307ef&&_0x35fc2b[_0x426c8c(0x2a8)]!=_0x426c8c(0x261)&&_0x35fc2b[_0x426c8c(0x2a8)]!=_0x426c8c(0x241)&&_0x35fc2b['telegramToken']!=''){const _0x3ec806=decryptRSA(secure[_0x426c8c(0x326)],_0x35fc2b[_0x426c8c(0x2a8)])[_0x426c8c(0x185)](_0x426c8c(0x324))[0x0];_0x35fc2b={..._0x35fc2b,'telegramToken':_0x3ec806};}if(_0x5307ef&&_0x35fc2b[_0x426c8c(0x356)]!=_0x426c8c(0x261)&&_0x35fc2b['marketcapApi']!=_0x426c8c(0x241)&&_0x35fc2b['marketcapApi']!=''){const _0x172df0=decryptRSA(secure[_0x426c8c(0x326)],_0x35fc2b[_0x426c8c(0x356)])['split'](_0x426c8c(0x324))[0x0];_0x35fc2b={..._0x35fc2b,'marketcapApi':_0x172df0};}const _0x11a1f9=_0x35fc2b[_0x426c8c(0x2a8)]!=_0x426c8c(0x261)&&_0x35fc2b[_0x426c8c(0x2a8)]!=settings[_0x426c8c(0x2a8)]||_0x35fc2b[_0x426c8c(0x1c6)]!=settings[_0x426c8c(0x1c6)],_0x21179e=_0x35fc2b[_0x426c8c(0x2a8)]==''||_0x35fc2b[_0x426c8c(0x1c6)]=='',_0x3f2ba0=_0x35fc2b[_0x426c8c(0x356)]&&_0x35fc2b['marketcapApi']!=_0x426c8c(0x261)&&_0x35fc2b[_0x426c8c(0x356)]!=settings[_0x426c8c(0x356)];_0x11a1f9&&(_0x35fc2b[_0x426c8c(0x22d)]=null,_0x35fc2b[_0x426c8c(0x35c)]=_0x426c8c(0x309));for(const [_0x4349fe,_0x201592]of Object[_0x426c8c(0x2c1)](_0x35fc2b)){if(_0x4349fe==_0x426c8c(0x2a8)&&_0x201592==_0x426c8c(0x261)){_0x35fc2b[_0x426c8c(0x2a8)]=settings[_0x426c8c(0x2a8)];continue;};if(_0x4349fe==_0x426c8c(0x2ad)&&_0x201592==_0x426c8c(0x261)){_0x35fc2b['bbPassword']=settings[_0x426c8c(0x2ad)];continue;};if(_0x4349fe==_0x426c8c(0x356)&&_0x201592==_0x426c8c(0x261)){_0x35fc2b[_0x426c8c(0x356)]=settings['marketcapApi'];continue;};dbSettings[_0x426c8c(0x274)]('settings.'+_0x4349fe,_0x201592)[_0x426c8c(0x36c)]();}settings=_0x35fc2b,io['to'](_0x426c8c(0x1b9))[_0x426c8c(0x370)](_0x426c8c(0x252),cleanSettings()),broadcastToBots(_0x426c8c(0x37a),settings[_0x426c8c(0x37a)]),broadcastToBots(_0x426c8c(0x2e8),settings[_0x426c8c(0x2e8)]),broadcastToBots('marketcapApi',settings[_0x426c8c(0x356)]);if(_0x11a1f9&&!_0x21179e)initTelegram();_0x11a1f9&&_0x21179e&&(updateSetting(_0x426c8c(0x22d),null),disableTelegram()),getAllClients()['forEach'](_0xe3b835=>{const _0x4764e1=_0x426c8c;getSocket(_0xe3b835['id'])[_0x4764e1(0x370)](_0x4764e1(0x1e4),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x3f2ba0&&(await sleep(0xbb8),testMarketcapApi(_0x35fc2b['marketcapApi']));}async function testMarketcapApi(_0x1b8cd9){const _0x1f2534=_0x1354cc,_0x6191d=[_0x1f2534(0x236),'ETH'];try{await axios[_0x1f2534(0x1bb)](_0x1f2534(0x389),{'headers':{'X-CMC_PRO_API_KEY':_0x1b8cd9},'params':{'symbol':_0x6191d[_0x1f2534(0x2e7)]()}});}catch(_0x36b9e4){_0x36b9e4[_0x1f2534(0x2e7)]()[_0x1f2534(0x2d7)]('status\x20code\x20401')?(io['to'](_0x1f2534(0x1b9))[_0x1f2534(0x370)](_0x1f2534(0x1bf),_0x1f2534(0x2d8)),logger[_0x1f2534(0x1ad)](_0x1f2534(0x2d8))):(io['to'](_0x1f2534(0x1b9))[_0x1f2534(0x370)](_0x1f2534(0x1bf),_0x1f2534(0x211)),logger['full'](_0x1f2534(0x211)),logger[_0x1f2534(0x386)](_0x1f2534(0x1e9),_0x36b9e4[_0x1f2534(0x2e7)]()+_0x1f2534(0x31a)+_0x36b9e4[_0x1f2534(0x19a)]));return;}logger[_0x1f2534(0x386)](_0x1f2534(0x318));}function updateSetting(_0x55264a,_0x12386a){const _0x4898cc=_0x1354cc;dbSettings[_0x4898cc(0x274)]('settings.'+_0x55264a,_0x12386a)[_0x4898cc(0x36c)](),settings=getSettings(),io['to'](_0x4898cc(0x1b9))[_0x4898cc(0x370)](_0x4898cc(0x252),cleanSettings());}function storeSecure(_0x146578){const _0x444faa=_0x1354cc;dbSecure[_0x444faa(0x1bb)](_0x444faa(0x278))[_0x444faa(0x2d5)](_0x146578)[_0x444faa(0x36c)](),secure=_0x146578;}function addBlacklist(_0x4f747a){const _0x272d22=_0x1354cc;cleanBlacklist();let _0x3fb30f;devices[_0x4f747a][_0x272d22(0x23b)]?_0x3fb30f=Math[_0x272d22(0x2bd)](devices[_0x4f747a][_0x272d22(0x23b)][_0x272d22(0x306)],loginExpiry):_0x3fb30f=loginExpiry,dbSecure['get']('blacklist')[_0x272d22(0x2d5)]({'expiry':new Date()[_0x272d22(0x2b7)]()+_0x3fb30f*0x3c*0x3e8,'token':devices[_0x4f747a][_0x272d22(0x32b)][_0x272d22(0x1df)]})[_0x272d22(0x36c)](),blacklist=dbSecure[_0x272d22(0x1bb)]('blacklist')['value']();}function cleanBlacklist(){const _0x469957=_0x1354cc;let _0xd5ebe9=dbSecure[_0x469957(0x1bb)](_0x469957(0x2f8))[_0x469957(0x238)]()[_0x469957(0x33a)](),_0x46527d=new Date()[_0x469957(0x2b7)]();_0xd5ebe9[_0x469957(0x182)](_0x37e1b5=>{const _0x193c58=_0x469957;_0x37e1b5[_0x193c58(0x306)]<_0x46527d&&dbSecure['get'](_0x193c58(0x2f8))[_0x193c58(0x1cc)]({'expiry':_0x37e1b5[_0x193c58(0x306)]})[_0x193c58(0x36c)]();});}function initStates(){const _0x2c0943=_0x1354cc;let _0x646d07=getConfiguration();_0x646d07[_0x2c0943(0x182)](_0x34ad44=>{const _0x63cdc9=_0x2c0943;_0x34ad44[_0x63cdc9(0x2de)]=_0x63cdc9(0x1f7);}),storeConfiguration(_0x646d07);}async function generateKeys(){const _0x47a8c0=_0x1354cc,_0xd863=forge[_0x47a8c0(0x322)]['rsa']['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x4884da=forge[_0x47a8c0(0x322)][_0x47a8c0(0x37c)](_0xd863[_0x47a8c0(0x326)]),_0x4675ad=forge[_0x47a8c0(0x322)][_0x47a8c0(0x224)](_0xd863[_0x47a8c0(0x1cb)]);return{'privateKey':_0x4884da,'publicKey':_0x4675ad};}async function oneTimeMigration(){const _0x552835=_0x1354cc;let _0x2c3add=getSettings(),_0x12e56d=![];!_0x2c3add['hasOwnProperty']('lastmsgtelegram')&&(_0x2c3add[_0x552835(0x23a)]=0x0,_0x12e56d=!![]);!_0x2c3add[_0x552835(0x197)](_0x552835(0x391))&&(_0x2c3add[_0x552835(0x391)]=0x0,_0x12e56d=!![]);!_0x2c3add['hasOwnProperty'](_0x552835(0x24b))&&(_0x2c3add[_0x552835(0x24b)]='0.0.0',_0x12e56d=!![]);!_0x2c3add['hasOwnProperty'](_0x552835(0x2e8))&&(_0x2c3add[_0x552835(0x2e8)]=![],_0x12e56d=!![]);!_0x2c3add[_0x552835(0x197)](_0x552835(0x356))&&(_0x2c3add[_0x552835(0x356)]='',_0x12e56d=!![]);if(_0x12e56d)storeSettings(_0x2c3add);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x552835(0x182)](_0xcad970=>{const _0xebe011=_0x552835;if(!_0xcad970[_0xebe011(0x23d)]()){if(!_0xcad970[_0xebe011(0x201)]['startsWith'](_0xebe011(0x2cd)))fs[_0xebe011(0x25b)](configbackuppath+_0xcad970[_0xebe011(0x201)]);}else fs[_0xebe011(0x33c)](configbackuppath+_0xcad970[_0xebe011(0x201)],{'recursive':!![]});});}catch(_0x463826){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x463826);}}function storeConfiguration(_0x2453ce){const _0x1a95fc=_0x1354cc;dbConfig['get'](_0x1a95fc(0x342))[_0x1a95fc(0x1cc)]()[_0x1a95fc(0x36c)](),dbConfig[_0x1a95fc(0x1bb)](_0x1a95fc(0x342))['push'](..._0x2453ce)[_0x1a95fc(0x36c)](),config=_0x2453ce;}async function resetPassword(){const _0xeb611=_0x1354cc;if(tgBot&&settings[_0xeb611(0x22d)]){const _0x143882=Markup['inlineKeyboard']([Markup[_0xeb611(0x380)]['callback'](_0xeb611(0x38b),'resetpw_yes'),Markup[_0xeb611(0x380)][_0xeb611(0x1da)]('no','resetpw_no')]);await sendTelegram(settings[_0xeb611(0x22d)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x143882),tgBot[_0xeb611(0x25d)](/resetpw_(.+)/,async _0x5abd29=>{const _0x22be23=_0xeb611,_0x1f8d63=_0x5abd29[_0x22be23(0x26e)][0x1];_0x5abd29['editMessageReplyMarkup']();if(_0x1f8d63!='no'){const _0x5263e0=0xf,_0x1e0811=_0x22be23(0x286),_0x1103ef=Array['from'](crypto[_0x22be23(0x35f)](new Uint32Array(_0x5263e0)))['map'](_0x4de6d6=>_0x1e0811[_0x4de6d6%_0x1e0811[_0x22be23(0x34e)]])['join'](''),_0x52d5ca=bcrypt[_0x22be23(0x2e5)](_0x1103ef,saltRounds);storeSettings({'bbPassword':_0x52d5ca}),await sendTelegram(_0x5abd29['chat']['id'],_0x22be23(0x1ab)+_0x1103ef,{'parse_mode':'HTML'});}else await sendTelegram(_0x5abd29['chat']['id'],_0x22be23(0x27c));});}}async function confirmRestore(_0x3af54f,_0x516d79){const _0x49d9b8=_0x1354cc;io['to'](_0x49d9b8(0x1b9))[_0x49d9b8(0x370)]('notification',_0x49d9b8(0x30d),'success');if(tgBot&&settings['telegramChatId']){const _0xbeb792=uuidRandom();tmpStorage[_0xbeb792]={'path':_0x3af54f,'filename':_0x516d79};const _0x246b41=Markup[_0x49d9b8(0x2e6)]([Markup[_0x49d9b8(0x380)][_0x49d9b8(0x1da)](_0x49d9b8(0x38b),_0x49d9b8(0x207)+_0xbeb792),Markup[_0x49d9b8(0x380)][_0x49d9b8(0x1da)]('no',_0x49d9b8(0x243)+_0xbeb792)]);await sendTelegram(settings['telegramChatId'],_0x49d9b8(0x1c2),_0x246b41),tgBot['action'](/restore_(.+)_(.+)/,async _0x381679=>{const _0x435073=_0x49d9b8,_0x5cfd86=_0x381679[_0x435073(0x26e)][0x1],_0x39f504=_0x381679[_0x435073(0x26e)][0x2],{path:_0x4802ca,filename:_0x2d1885}=tmpStorage[_0x39f504];delete tmpStorage[_0x39f504],_0x381679[_0x435073(0x22f)](),_0x5cfd86==_0x435073(0x38b)?(logger[_0x435073(0x386)]('Restore\x20process\x20confirmed'),await sendTelegram(_0x381679[_0x435073(0x237)]['id'],_0x435073(0x2b9),{'parse_mode':_0x435073(0x1cf)}),unzipFile(_0x4802ca,_0x2d1885)):(logger[_0x435073(0x386)]('Restore\x20process\x20aborted'),await sendTelegram(_0x381679[_0x435073(0x237)]['id'],_0x435073(0x20d)));});}}function getServerTime(){const _0x44dc27=_0x1354cc,_0x3f21c5=new Date();return _0x3f21c5[_0x44dc27(0x303)]()+'/'+(_0x3f21c5['getMonth']()+0x1)[_0x44dc27(0x2e7)]()[_0x44dc27(0x395)](0x2,'0')+'/'+_0x3f21c5[_0x44dc27(0x378)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x3f21c5[_0x44dc27(0x32f)]()[_0x44dc27(0x2e7)]()[_0x44dc27(0x395)](0x2,'0')+':'+_0x3f21c5[_0x44dc27(0x2b1)]()[_0x44dc27(0x2e7)]()[_0x44dc27(0x395)](0x2,'0')+':'+_0x3f21c5[_0x44dc27(0x2c4)]()[_0x44dc27(0x2e7)]()[_0x44dc27(0x395)](0x2,'0');}function getTimeStamp(){const _0x45f56c=_0x1354cc,_0x53cd47=shiftedTime();return _0x53cd47['getFullYear']()+'/'+(_0x53cd47[_0x45f56c(0x2e3)]()+0x1)[_0x45f56c(0x2e7)]()[_0x45f56c(0x395)](0x2,'0')+'/'+_0x53cd47[_0x45f56c(0x378)]()['toString']()[_0x45f56c(0x395)](0x2,'0')+'\x20'+_0x53cd47[_0x45f56c(0x32f)]()[_0x45f56c(0x2e7)]()[_0x45f56c(0x395)](0x2,'0')+':'+_0x53cd47[_0x45f56c(0x2b1)]()['toString']()[_0x45f56c(0x395)](0x2,'0')+':'+_0x53cd47[_0x45f56c(0x2c4)]()[_0x45f56c(0x2e7)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x5463e9=_0x1354cc,_0x2c9536=shiftedTime();return _0x2c9536[_0x5463e9(0x303)]()+(_0x2c9536[_0x5463e9(0x2e3)]()+0x1)[_0x5463e9(0x2e7)]()[_0x5463e9(0x395)](0x2,'0')+_0x2c9536['getDate']()['toString']()[_0x5463e9(0x395)](0x2,'0')+'-'+_0x2c9536[_0x5463e9(0x32f)]()[_0x5463e9(0x2e7)]()[_0x5463e9(0x395)](0x2,'0')+_0x2c9536[_0x5463e9(0x2b1)]()[_0x5463e9(0x2e7)]()[_0x5463e9(0x395)](0x2,'0')+_0x2c9536[_0x5463e9(0x2c4)]()[_0x5463e9(0x2e7)]()[_0x5463e9(0x395)](0x2,'0');}function shiftedTime(){const _0x25c9fc=_0x1354cc,_0x23856a=new Date();let _0x44fd76=_0x23856a;if(settings[_0x25c9fc(0x37a)]&&settings['timeshift']!==0x0)_0x44fd76=fns[_0x25c9fc(0x1f4)](_0x23856a,{'hours':settings[_0x25c9fc(0x37a)]});return _0x44fd76;}async function startScheduler(){const _0x5aabc2=_0x1354cc,_0x1075aa=new Date()[_0x5aabc2(0x2d9)](),_0x146ce7=shiftedTime()['getHours']();_0x146ce7==0x4&&backupConfigFiles(),_0x146ce7==0x0&&(rotateLogFiles(),logger[_0x5aabc2(0x386)](_0x5aabc2(0x1de)),logger[_0x5aabc2(0x386)]('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x5aabc2(0x394)+(environment==_0x5aabc2(0x195)?_0x5aabc2(0x21b):'')),logger[_0x5aabc2(0x386)]('--------------------------------------')),_0x1075aa%0x6==0x0&&triggerAnalytics(),_0x1075aa%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x26e7ff){const _0x35bf6a=_0x1354cc;logger['debug'](_0x35bf6a(0x191)+_0x26e7ff);const _0x3e6907=getBotsWithMode();_0x3e6907[_0x35bf6a(0x34e)]>0x0?confirmRestore(configbackuppath,_0x26e7ff):unzipFile(configbackuppath,_0x26e7ff);}async function getBackupFiles(_0x30cd6a=null){const _0x250108=_0x1354cc;let _0x18d44d=[],_0x542019=fs[_0x250108(0x226)](configbackuppath,{'withFileTypes':!![]});_0x542019[_0x250108(0x257)]((_0x39a02b,_0x49b1d2)=>_0x39a02b[_0x250108(0x201)]<_0x49b1d2[_0x250108(0x201)]?0x1:_0x49b1d2[_0x250108(0x201)]<_0x39a02b[_0x250108(0x201)]?-0x1:0x0),_0x542019['forEach'](_0x32e781=>{const _0x302a72=_0x250108;if(!_0x32e781[_0x302a72(0x23d)]()&&_0x32e781[_0x302a72(0x201)][_0x302a72(0x374)](_0x302a72(0x2cd))&&_0x32e781[_0x302a72(0x201)]['endsWith']('.zip')){const _0x47b6cc=formatDate(fs[_0x302a72(0x29a)](configbackuppath+_0x32e781[_0x302a72(0x201)])[_0x302a72(0x2cf)]);_0x18d44d[_0x302a72(0x2d5)]({'name':_0x32e781[_0x302a72(0x201)],'mtime':_0x47b6cc});}});if(_0x30cd6a)io['to'](_0x30cd6a)[_0x250108(0x370)](_0x250108(0x260),_0x18d44d);else return _0x18d44d;}async function backupConfigFiles(){const _0x4bf35f=_0x1354cc;await zipFiles(_0x4bf35f(0x240));const _0x29985b=getCleanTimeStamp();fs[_0x4bf35f(0x2ea)](zippath+_0x4bf35f(0x30c),configbackuppath+(_0x4bf35f(0x2cd)+_0x29985b+_0x4bf35f(0x1d2)));let _0x5751a2=fs[_0x4bf35f(0x226)](configbackuppath,{'withFileTypes':!![]});_0x5751a2[_0x4bf35f(0x257)]((_0x4aa77d,_0x24ddc0)=>_0x4aa77d[_0x4bf35f(0x201)]<_0x24ddc0[_0x4bf35f(0x201)]?0x1:_0x24ddc0['name']<_0x4aa77d['name']?-0x1:0x0),_0x5751a2[_0x4bf35f(0x34e)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x5751a2[_0x5751a2[_0x4bf35f(0x34e)]-0x1][_0x4bf35f(0x201)]);}function rotateLogFiles(){const _0x12ae68=_0x1354cc,_0x1b82c1=fs[_0x12ae68(0x29a)](logspath+_0x12ae68(0x18d)),_0x564b3d=_0x1b82c1[_0x12ae68(0x20b)]/0x400;if(_0x564b3d>0x64){let _0x169629=fs[_0x12ae68(0x226)](logspath,{'withFileTypes':!![]});_0x169629[_0x12ae68(0x257)]((_0x31e4c7,_0x46dde4)=>_0x31e4c7[_0x12ae68(0x201)]<_0x46dde4[_0x12ae68(0x201)]?0x1:_0x46dde4[_0x12ae68(0x201)]<_0x31e4c7[_0x12ae68(0x201)]?-0x1:0x0),_0x169629['forEach'](_0x2bd7a7=>{const _0x334272=_0x12ae68;if(_0x2bd7a7[_0x334272(0x201)]==_0x334272(0x22a))fs[_0x334272(0x2ea)](logspath+_0x2bd7a7[_0x334272(0x201)],logspath+_0x334272(0x248));if(_0x2bd7a7[_0x334272(0x201)]==_0x334272(0x292))fs[_0x334272(0x2ea)](logspath+_0x2bd7a7[_0x334272(0x201)],logspath+_0x334272(0x22a));_0x2bd7a7[_0x334272(0x201)]==_0x334272(0x18d)&&(fs['copyFileSync'](logspath+_0x2bd7a7[_0x334272(0x201)],logspath+_0x334272(0x292)),fs[_0x334272(0x19d)](logspath+_0x2bd7a7['name'],''));});}}function _0x4878(_0x3dff89,_0x40950c){const _0x5db237=_0x5022();return _0x4878=function(_0x597d08,_0x3dec2a){_0x597d08=_0x597d08-0x17d;let _0x50225e=_0x5db237[_0x597d08];return _0x50225e;},_0x4878(_0x3dff89,_0x40950c);}async function zipFiles(_0x321094){const _0xe501cb=_0x1354cc;let _0x4400f3;if(_0x321094==_0xe501cb(0x1e3))_0x4400f3=logspath;if(_0x321094==_0xe501cb(0x33b))_0x4400f3=configpath;if(_0x321094=='backup-full')_0x4400f3=configpath;let _0x260402=fs[_0xe501cb(0x226)](_0x4400f3,{'withFileTypes':!![]});const _0x342064=new JSZip();_0x260402[_0xe501cb(0x182)](_0x14f66a=>{const _0x46b262=_0xe501cb;if(!_0x14f66a[_0x46b262(0x23d)]()){let _0x223506=fs[_0x46b262(0x1bd)](_0x4400f3+_0x14f66a['name']);if(_0x321094==_0x46b262(0x33b)){const _0x3191f0=/^bot-[0-9]{3}-config.json$/,_0x20e74c=_0x3191f0[_0x46b262(0x2b5)](_0x14f66a[_0x46b262(0x201)]);if(_0x20e74c){const _0x27a692=JSON[_0x46b262(0x250)](_0x223506);if(_0x27a692[_0x46b262(0x270)][0x0]){_0x27a692[_0x46b262(0x270)][0x0][_0x46b262(0x2ff)]=_0x46b262(0x241),_0x27a692[_0x46b262(0x270)][0x0][_0x46b262(0x230)]=_0x46b262(0x241);if(_0x27a692[_0x46b262(0x270)][0x0][_0x46b262(0x28c)])_0x27a692[_0x46b262(0x270)][0x0][_0x46b262(0x28c)]=_0x46b262(0x241);}_0x223506=JSON[_0x46b262(0x232)](_0x27a692,null,0x2);}if(_0x14f66a['name']=='bb-settings.json'){const _0x25c9b0=JSON[_0x46b262(0x250)](_0x223506);if(_0x25c9b0[_0x46b262(0x252)][_0x46b262(0x204)])_0x25c9b0[_0x46b262(0x252)][_0x46b262(0x204)]=![];if(_0x25c9b0[_0x46b262(0x252)][_0x46b262(0x2ad)])_0x25c9b0[_0x46b262(0x252)][_0x46b262(0x2ad)]=_0x46b262(0x241);if(_0x25c9b0[_0x46b262(0x252)][_0x46b262(0x2a8)])_0x25c9b0[_0x46b262(0x252)][_0x46b262(0x2a8)]=_0x46b262(0x241);if(_0x25c9b0[_0x46b262(0x252)]['telegramChatId'])_0x25c9b0[_0x46b262(0x252)][_0x46b262(0x22d)]=null;if(_0x25c9b0['settings'][_0x46b262(0x356)])_0x25c9b0[_0x46b262(0x252)][_0x46b262(0x356)]=_0x46b262(0x241);_0x223506=JSON[_0x46b262(0x232)](_0x25c9b0,null,0x2);}if(_0x14f66a[_0x46b262(0x201)]!=_0x46b262(0x258))_0x342064[_0x46b262(0x2d6)](_0x14f66a['name'],_0x223506);}else _0x342064[_0x46b262(0x2d6)](_0x14f66a[_0x46b262(0x201)],_0x223506);}});const _0x2a8693=await _0x342064[_0xe501cb(0x1a3)]({'type':'string','base64':![],'compression':_0xe501cb(0x393)});fs[_0xe501cb(0x19d)](zippath+(_0x321094+_0xe501cb(0x1d2)),_0x2a8693,_0xe501cb(0x280));}async function unzipFile(_0x14f4cc,_0x2a9826){const _0x244f9c=_0x1354cc;fs[_0x244f9c(0x226)](configpath,{'withFileTypes':!![]})[_0x244f9c(0x182)](_0x823cd6=>{const _0x4a9de7=_0x244f9c;if(!_0x823cd6['isDirectory']())fs[_0x4a9de7(0x33c)](configpath+_0x823cd6[_0x4a9de7(0x201)]);});const _0xe0159d=fs[_0x244f9c(0x1bd)](_0x14f4cc+_0x2a9826,'binary'),_0x34702e=await JSZip[_0x244f9c(0x2ee)](_0xe0159d,{'base64':![],'checkCRC32':!![]});for(const _0x3d5989 of Object[_0x244f9c(0x244)](_0x34702e['files'])){const _0x309937=_0x34702e[_0x244f9c(0x1be)][_0x3d5989],_0x1ad2b6=await _0x309937[_0x244f9c(0x186)]('string');fs[_0x244f9c(0x19d)](configpath+_0x309937[_0x244f9c(0x201)],_0x1ad2b6);}fs[_0x244f9c(0x226)](temppath,{'withFileTypes':!![]})[_0x244f9c(0x182)](_0x149e14=>{const _0x2c7de9=_0x244f9c;if(!_0x149e14[_0x2c7de9(0x23d)]())fs[_0x2c7de9(0x33c)](temppath+_0x149e14[_0x2c7de9(0x201)]);}),logger[_0x244f9c(0x386)](_0x244f9c(0x254)),process[_0x244f9c(0x1a5)]({'restore':!![]},_0x20f806=>{});}async function getPublicIp(){const _0x17cab7=_0x1354cc;try{const _0x2dd937=await axios[_0x17cab7(0x1bb)](_0x17cab7(0x1fe));publicip=_0x2dd937['data']['ip'];}catch(_0x3a7b31){}}async function triggerAnalytics(){const _0x4b0457=_0x1354cc;if(!publicip)await getPublicIp();const _0x228d4b=getBotsWithMode();let _0xc3e3c1=0x0;_0x228d4b['forEach'](_0x33e694=>{const _0x1478f5=_0x4878;if(_0x33e694['status']===_0x1478f5(0x2be))_0xc3e3c1++;});const _0x295573=getBotExchanges();mixpanel[_0x4b0457(0x2a6)](_0x4b0457(0x310),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x228d4b[_0x4b0457(0x34e)],'numbotsenabled':_0xc3e3c1,'exchanges':_0x295573,'environment':environment});}async function getMessages(){const _0x452cd3=_0x1354cc,_0x171a9d=_0x452cd3(0x314),_0x1e9a5a=new GraphQLClient(_0x171a9d),_0x91b3b9={'authorization':_0x452cd3(0x311)},_0x415c3a=serverversion[_0x452cd3(0x185)]('.'),_0xd44e7e=_0x415c3a[0x0]+'.'+_0x415c3a[0x1],_0x20f017=Math[_0x452cd3(0x1ea)](settings[_0x452cd3(0x23a)],settings[_0x452cd3(0x391)]),_0x33894f={'last':parseInt(_0x20f017),'bbm':_0xd44e7e},_0x23a231=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x594436;try{_0x594436=await _0x1e9a5a['request'](_0x23a231,_0x33894f,_0x91b3b9);}catch(_0x138b5e){}if(_0x594436&&_0x594436[_0x452cd3(0x21c)]){let _0x2409b4=settings[_0x452cd3(0x23a)],_0x188e38=settings['lastmsgtelegram'];newMessages=[];for(const _0x12f4f1 of _0x594436[_0x452cd3(0x21c)]){newMessages['push'](_0x12f4f1);let _0x4dd720=![];_0x12f4f1['bbvNew']&&(updateSetting(_0x452cd3(0x24b),_0x12f4f1[_0x452cd3(0x2d2)]),_0x4dd720=isNewerVersion(serverversion,_0x12f4f1[_0x452cd3(0x2d2)])||serverversion==_0x12f4f1[_0x452cd3(0x2d2)]);if(!_0x4dd720&&_0x12f4f1[_0x452cd3(0x2a0)]>_0x2409b4){if(_0x12f4f1[_0x452cd3(0x2e4)]===_0x452cd3(0x353)||serverversion['startsWith'](_0x12f4f1[_0x452cd3(0x2e4)])){let _0x150019=''+_0x12f4f1['title']+'\x0a\x0a'+_0x12f4f1[_0x452cd3(0x288)];const _0x5b5ac2=await sendTelegramMsg(toTelegramMarkdown(_0x150019),'Markdown');_0x2409b4=_0x12f4f1[_0x452cd3(0x2a0)];}}_0x188e38=_0x12f4f1['number'];}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x452cd3(0x23a),_0x188e38),emitMessages();}}function emitMessages(){const _0x375918=_0x1354cc,_0x260eeb=settings[_0x375918(0x391)];let _0x4bf628=[];newMessages[_0x375918(0x182)](_0x43b53a=>{const _0x28cf1a=_0x375918;_0x43b53a[_0x28cf1a(0x2a0)]>_0x260eeb&&_0x4bf628[_0x28cf1a(0x2d5)](_0x43b53a);}),_0x4bf628['length']>0x0&&getAllClients()[_0x375918(0x182)](_0x4de708=>{const _0x3c238e=_0x375918;getSocket(_0x4de708['id'])['emit'](_0x3c238e(0x288),_0x4bf628);});}function confirmMessage(_0x2defd3){const _0x924612=_0x1354cc;updateSetting(_0x924612(0x391),Number(_0x2defd3));}function isNewerVersion(_0x5f58ec,_0xec0bce){const _0x2b8cdb=_0x1354cc,_0x358b87=_0xec0bce[_0x2b8cdb(0x185)]('.'),_0x1b6ca8=_0x5f58ec[_0x2b8cdb(0x185)]('.');for(var _0x19363f=0x0;_0x19363f<_0x1b6ca8[_0x2b8cdb(0x34e)];_0x19363f++){const _0x336f9b=~~_0x1b6ca8[_0x19363f],_0x191b01=~~_0x358b87[_0x19363f];if(_0x336f9b>_0x191b01)return!![];if(_0x336f9b<_0x191b01)return![];}return![];}function toTelegramMarkdown(_0x480152){const _0x4b6f04=_0x1354cc,_0x1235df=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x165338=/\*{2}(.+?)\*{2}/gim;return _0x480152=_0x480152['replace'](_0x1235df,_0x4b6f04(0x282))[_0x4b6f04(0x29c)](_0x165338,_0x4b6f04(0x194)),_0x480152;}async function validateConfigFile(){const _0x22c926=_0x1354cc,_0x528f29=dbConfig[_0x22c926(0x1bb)](_0x22c926(0x342))[_0x22c926(0x188)]('botID')['value']()||[];if(_0x528f29[_0x22c926(0x34e)]==0x0){let _0x517b90=0x0,_0x5870f7=[];const _0x181e9d=/^bot-([0-9]{3})-config.json$/,_0x52b0a8=fs['readdirSync'](configpath);_0x52b0a8[_0x22c926(0x182)](_0x2b8d12=>{const _0x455e89=_0x22c926,_0x3360da=_0x181e9d[_0x455e89(0x357)](_0x2b8d12);if(_0x3360da){const _0x37d487=_0x3360da[0x1];let _0x4eeae1=getBotAttributes(_0x37d487);_0x5870f7[_0x455e89(0x2d5)]({'botID':_0x37d487,'botname':_0x4eeae1[_0x455e89(0x320)],'status':_0x455e89(0x23e),'live':'stopped'}),_0x517b90++;}}),_0x517b90!=0x0&&(dbConfig[_0x22c926(0x1bb)](_0x22c926(0x342))[_0x22c926(0x2b6)](_0x5870f7)['write'](),config=_0x5870f7,restoredConfigFile=_0x517b90);}}async function restoreConfigNotify(_0x2f7f15){const _0x3bd644=_0x1354cc;let _0x58f790;if(restoredConfigFile==0x1)_0x58f790='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x58f790=_0x3bd644(0x297);if(_0x2f7f15)io['to'](_0x3bd644(0x1b9))[_0x3bd644(0x370)](_0x3bd644(0x1bf),_0x58f790);else{logger[_0x3bd644(0x308)]('-----------------------------------------------------------------------------------'),logger['simple'](_0x58f790),logger[_0x3bd644(0x308)]('-----------------------------------------------------------------------------------'),logger[_0x3bd644(0x308)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x3bd644(0x35c)]!=_0x3bd644(0x2e0))await sendTelegram(settings[_0x3bd644(0x22d)],_0x3bd644(0x295)+_0x58f790);}}function decryptRSA(_0xd8840d,_0xa5ef3f){const _0x4be981=_0x1354cc,_0x251e2b=forge['pki']['privateKeyFromPem'](_0xd8840d),_0x5a6bc3=_0x251e2b[_0x4be981(0x2e2)](forge[_0x4be981(0x1bc)]['decode64'](_0xa5ef3f),_0x4be981(0x1fa),{'md':forge['md'][_0x4be981(0x36d)][_0x4be981(0x28f)](),'mgf1':{'md':forge['md']['sha256'][_0x4be981(0x28f)]()}});return _0x5a6bc3;}function validateCredentials(_0x186481,_0x3ef73b){const _0x314a40=_0x1354cc;if(_0x186481[_0x314a40(0x1dd)]==settings[_0x314a40(0x1b3)]&&bcrypt[_0x314a40(0x1ee)](_0x186481[_0x314a40(0x219)],settings['bbPassword'])){if(settings[_0x314a40(0x1f3)])return{'allow':![],'reason':_0x314a40(0x364),'token':null};else{const _0x2ded02=generateLoginToken(_0x3ef73b);return{'allow':!![],'reason':_0x314a40(0x2da),'token':_0x2ded02};}}else return{'allow':![],'reason':_0x314a40(0x38c),'token':null};}function refreshToken(_0x3c06ee){const _0x2fcbf8=_0x1354cc,_0x50b632=generateLoginToken(_0x3c06ee);return{'allow':!![],'reason':_0x2fcbf8(0x2da),'token':_0x50b632};}function validateAccess(_0x543a50,_0x5b2355,_0x14a640){const _0x26a641=_0x1354cc,_0xb0d2bb=_0x14a640?_0x14a640:devices[_0x5b2355]['ip'];let _0x5c6dc9;const _0x12b115=_0x4fc6fa=>{const _0x138600=_0x4878;if(settings[_0x138600(0x204)]){if(settings[_0x138600(0x1f3)]){if(telegram2FaApproved(_0x5b2355)){const _0x888da0=generateLoginToken(_0x5b2355);return{'allow':!![],'reason':_0x138600(0x281),'token':_0x888da0};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x5c6dc9=validToken(_0x4fc6fa,_0x5b2355),_0x5c6dc9[_0x138600(0x197)](_0x138600(0x249))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x4fc6fa}:{'allow':![],'reason':_0x138600(0x25f),'token':null};}else return{'allow':!![],'reason':_0x138600(0x181),'token':null};};if(settings['whitelistEnabled']){let _0x3eb3e5=[...settings[_0x26a641(0x21f)],'::1','::ffff:127.0.0.1',_0x26a641(0x301),_0x26a641(0x2b3)];if(_0x3eb3e5[_0x26a641(0x2d7)](_0xb0d2bb))return _0x12b115(_0x543a50);else{_0x5c6dc9=validToken(_0x543a50,_0x5b2355);if(_0x5c6dc9[_0x26a641(0x197)](_0x26a641(0x249)))return _0x12b115(_0x543a50);else{if(telegramIpApproved(_0x5b2355)){const _0x145d85=generateToken(_0x5b2355);return _0x5c6dc9=_0x12b115(_0x543a50),_0x5c6dc9[_0x26a641(0x24e)]?{'allow':!![],'reason':_0x26a641(0x29f),'token':_0x145d85}:_0x5c6dc9;}else return settings[_0x26a641(0x362)]?{'allow':![],'reason':_0x26a641(0x26d),'token':null}:{'allow':![],'reason':_0x26a641(0x1ec),'token':null};}}}else return _0x12b115(_0x543a50);}function timelyDecrypt(_0x1c0001,_0x3d54ed,_0xf0744b='@'){const _0x3ba975=_0x1354cc;if(_0x1c0001)try{const _0xe98289=decryptRSA(secure[_0x3ba975(0x326)],_0x1c0001),_0x35f278=_0xe98289['split'](_0xf0744b)[0x0],_0x2db27f=_0xe98289[_0x3ba975(0x185)](_0xf0744b)[0x1],_0x258883=new Date()[_0x3ba975(0x2b7)]();if(_0x3d54ed){if(_0x258883-_0x2db27f<maxSecretAge*0x3e8)return _0x35f278;else return![];}else return _0x35f278;}catch(_0x48610a){return![];}else return![];}const validToken=(_0x3c0229,_0x4add83)=>{const _0x1904af=_0x1354cc,_0xe474fe=devices[_0x4add83]['ip'];if(!_0x3c0229)return{'error':'No\x20authentication\x20token'};for(let _0x21682a of blacklist){if(_0x21682a['token']==_0x3c0229)return{'error':_0x1904af(0x2ca)};}let _0x3a31dd;try{_0x3a31dd=jwt['verify'](_0x3c0229,secure['secret']+_0x4add83);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x3a31dd['hasOwnProperty'](_0x1904af(0x2a1))&&!_0x3a31dd[_0x1904af(0x197)](_0x1904af(0x1dd))||!_0x3a31dd[_0x1904af(0x197)](_0x1904af(0x2f3)))return{'error':_0x1904af(0x1f0)};if(!_0x3a31dd[_0x1904af(0x197)]('username')&&_0x3a31dd[_0x1904af(0x197)](_0x1904af(0x2a1))){const {clientip:_0x3cf373}=_0x3a31dd;return _0xe474fe==_0x3cf373?{'success':_0x1904af(0x307)}:{'error':_0x1904af(0x235)};}else{if(_0x3a31dd[_0x1904af(0x197)]('username')&&_0x3a31dd[_0x1904af(0x197)]('clientip')){const {username:_0x1b8232,clientip:_0x5da3b3}=_0x3a31dd;return settings[_0x1904af(0x1b3)]==_0x1b8232&&_0xe474fe==_0x5da3b3?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x1904af(0x376)};}}},generateLoginToken=_0xf11ea7=>{const _0x336292=_0x1354cc;if(_0xf11ea7){const _0x5f17ff=devices[_0xf11ea7]['ip'];return jwt[_0x336292(0x2bb)]({'username':settings[_0x336292(0x1b3)],'clientip':_0x5f17ff},secure[_0x336292(0x222)]+_0xf11ea7,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x393530=>{const _0x201f8c=_0x1354cc;if(_0x393530){const _0xc9bfa6=devices[_0x393530]['ip'];return jwt[_0x201f8c(0x2bb)]({'clientip':_0xc9bfa6},secure['secret']+_0x393530,{'expiresIn':devices[_0x393530][_0x201f8c(0x23b)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x22625a=>{const _0x1c0fad=_0x1354cc;let _0x6409c4=![];return devices[_0x22625a][_0x1c0fad(0x23b)]&&devices[_0x22625a][_0x1c0fad(0x23b)][_0x1c0fad(0x306)]!=_0x1c0fad(0x31c)&&(_0x6409c4=devices[_0x22625a]['telegramIpApproval'][_0x1c0fad(0x2a1)]==devices[_0x22625a]['ip']&&new Date()[_0x1c0fad(0x2b7)]()-devices[_0x22625a][_0x1c0fad(0x23b)]['timestamp']<devices[_0x22625a][_0x1c0fad(0x23b)]['expiry']*0x3c*0x3e8),_0x6409c4;},telegram2FaApproved=_0x31de89=>{const _0x2ec492=_0x1354cc;let _0x48c04e=![];return devices[_0x31de89][_0x2ec492(0x35b)]&&devices[_0x31de89][_0x2ec492(0x35b)][_0x2ec492(0x306)]!='reject'&&(_0x48c04e=devices[_0x31de89][_0x2ec492(0x35b)][_0x2ec492(0x2a1)]==devices[_0x31de89]['ip']&&new Date()['getTime']()-devices[_0x31de89]['telegram2FaApproval'][_0x2ec492(0x19f)]<devices[_0x31de89][_0x2ec492(0x35b)][_0x2ec492(0x306)]*0x3c*0x3e8),_0x48c04e;},normalizeIP=_0x1ab6f5=>{const _0x46a40a=_0x1354cc;let _0x2dc9db=null,_0x48903b=null;if(ipaddr[_0x46a40a(0x2d4)](_0x1ab6f5)){const _0x34c65c=ipaddr[_0x46a40a(0x250)](_0x1ab6f5);_0x34c65c[_0x46a40a(0x1c5)]()==='ipv6'?(_0x34c65c[_0x46a40a(0x35a)]()&&(_0x2dc9db=_0x34c65c[_0x46a40a(0x225)]()['toString']()),_0x48903b=_0x34c65c['toString']()):(_0x2dc9db=_0x34c65c[_0x46a40a(0x2e7)](),_0x48903b=_0x34c65c[_0x46a40a(0x26f)]()[_0x46a40a(0x2e7)]());}return{'show':_0x2dc9db?_0x2dc9db:_0x48903b,'store':_0x48903b};};function formatDate(_0xc44076){const _0xaeeb4=_0x1354cc;return _0xc44076[_0xaeeb4(0x303)]()+'/'+(_0xc44076[_0xaeeb4(0x2e3)]()+0x1)[_0xaeeb4(0x2e7)]()[_0xaeeb4(0x395)](0x2,'0')+'/'+_0xc44076['getDate']()[_0xaeeb4(0x2e7)]()['padStart'](0x2,'0')+'\x20'+_0xc44076[_0xaeeb4(0x32f)]()[_0xaeeb4(0x2e7)]()[_0xaeeb4(0x395)](0x2,'0')+':'+_0xc44076[_0xaeeb4(0x2b1)]()[_0xaeeb4(0x2e7)]()[_0xaeeb4(0x395)](0x2,'0')+':'+_0xc44076['getSeconds']()[_0xaeeb4(0x2e7)]()[_0xaeeb4(0x395)](0x2,'0');}function sleep(_0x52af5c){return new Promise(_0x3a2035=>setTimeout(_0x3a2035,_0x52af5c));}