const _0x59c681=_0x1941;(function(_0x3fc4eb,_0x1468d6){const _0x1c3676=_0x1941,_0x10f6f0=_0x3fc4eb();while(!![]){try{const _0x1a8ca6=-parseInt(_0x1c3676(0x1cc))/0x1+-parseInt(_0x1c3676(0x2f8))/0x2*(parseInt(_0x1c3676(0x1fb))/0x3)+parseInt(_0x1c3676(0x190))/0x4+-parseInt(_0x1c3676(0x249))/0x5+parseInt(_0x1c3676(0x20d))/0x6*(-parseInt(_0x1c3676(0x1a6))/0x7)+parseInt(_0x1c3676(0x1dc))/0x8*(-parseInt(_0x1c3676(0x214))/0x9)+-parseInt(_0x1c3676(0x191))/0xa*(-parseInt(_0x1c3676(0x353))/0xb);if(_0x1a8ca6===_0x1468d6)break;else _0x10f6f0['push'](_0x10f6f0['shift']());}catch(_0x2f6cd9){_0x10f6f0['push'](_0x10f6f0['shift']());}}}(_0x4b58,0x89fbb));const _0x5ebdf7=function(){let _0x4ac13a=!![];return function(_0xbe92ce,_0x4049b8){const _0x40bdc3=_0x4ac13a?function(){const _0x3b26d0=_0x1941;if(_0x4049b8){const _0x51095c=_0x4049b8[_0x3b26d0(0x31b)](_0xbe92ce,arguments);return _0x4049b8=null,_0x51095c;}}:function(){};return _0x4ac13a=![],_0x40bdc3;};}(),_0x2cf04d=_0x5ebdf7(this,function(){const _0x426281=_0x1941;return _0x2cf04d[_0x426281(0x22a)]()['search'](_0x426281(0x268))['toString']()[_0x426281(0x1e3)](_0x2cf04d)[_0x426281(0x302)](_0x426281(0x268));});_0x2cf04d();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require(_0x59c681(0x30e)),fs=require('fs'),fns=require(_0x59c681(0x345)),low=require(_0x59c681(0x387)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x59c681(0x2ce)),crypto=require(_0x59c681(0x2a9)),forge=require('node-forge'),bcrypt=require(_0x59c681(0x2b7)),jwt=require(_0x59c681(0x39b)),ipaddr=require(_0x59c681(0x2d5)),argv=require('yargs/yargs')(process['argv']['slice'](0x2))[_0x59c681(0x17f)],uuidRandom=require(_0x59c681(0x29a)),{Telegraf,Markup}=require(_0x59c681(0x33f)),Mixpanel=require(_0x59c681(0x1ca)),axios=require('axios'),{GraphQLClient,gql}=require(_0x59c681(0x1d4)),util=require('util'),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x59c681(0x339)),PORT=argv[_0x59c681(0x2b9)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x59c681(0x283)](PORT)&&(console[_0x59c681(0x272)](_0x59c681(0x310)+PORT+_0x59c681(0x24c)),process[_0x59c681(0x2f5)](0x1));const HOST=argv[_0x59c681(0x2d6)]||null,userID=argv[_0x59c681(0x285)]||'',debugging=argv['d']||![],nodeversion=process[_0x59c681(0x393)][_0x59c681(0x258)];let bbpath=_0x59c681(0x1d8),bbpath2='';const botfile=_0x59c681(0x19d),configfile=_0x59c681(0x186),settingsfile=_0x59c681(0x1e2),securefile=_0x59c681(0x198),environment=require('./'+bbpath2+_0x59c681(0x2ea))[_0x59c681(0x2c6)]||_0x59c681(0x37c),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x59c681(0x244)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x59c681(0x259)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x59c681(0x333),configbackuppath=configpath+_0x59c681(0x1eb),logspath=userID?bbpath+_0x59c681(0x33c)+userID+'/':bbpath+_0x59c681(0x33c),zippath=userID?bbpath+_0x59c681(0x25e)+userID+'/':bbpath+'zip/',loggerfile=fs['createWriteStream'](logspath+_0x59c681(0x37a),{'flags':'a'}),temppath=userID?bbpath+_0x59c681(0x2e8)+userID+'/':bbpath+_0x59c681(0x2e8);!fs[_0x59c681(0x244)](configpath)&&fs[_0x59c681(0x2e4)](configpath);!fs[_0x59c681(0x244)](configbackuppath)&&fs[_0x59c681(0x2e4)](configbackuppath);!fs[_0x59c681(0x244)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x59c681(0x244)](zippath)&&fs[_0x59c681(0x2e4)](zippath);!fs[_0x59c681(0x244)](temppath)&&fs[_0x59c681(0x2e4)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x59c681(0x327)]({'bots':[]})[_0x59c681(0x193)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x59c681(0x327)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x59c681(0x378),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x59c681(0x193)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x59c681(0x26f)](_0x59c681(0x2f2),{'host':_0x59c681(0x2cb)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x59c681(0x2c0)]!=''&&settings[_0x59c681(0x2c0)]!=_0x59c681(0x23f))&&settings[_0x59c681(0x29c)]&&settings[_0x59c681(0x29c)]!='')initTelegram();const parseColor=(_0x41100e,_0x5b54c3)=>{const _0x4a4312=_0x59c681,_0x1a4b1b=/#[A-Z]{3}#/g;if(typeof _0x41100e==_0x4a4312(0x296)){!_0x5b54c3?_0x41100e=_0x41100e['replace'](_0x1a4b1b,''):(_0x41100e=_0x41100e[_0x4a4312(0x1fd)](/#BLU#/g,_0x4a4312(0x398)),_0x41100e=_0x41100e['replace'](/#RED#/g,_0x4a4312(0x1b7)),_0x41100e=_0x41100e['replace'](/#YEL#/g,_0x4a4312(0x230)),_0x41100e=_0x41100e[_0x4a4312(0x1fd)](/#MAG#/g,_0x4a4312(0x295)),_0x41100e=_0x41100e['replace'](/#CYA#/g,_0x4a4312(0x32d)),_0x41100e=_0x41100e['replace'](/#RES#/g,_0x4a4312(0x31f)));;}return _0x41100e;},logger={'screen':_0x3d3e73=>{const _0x3ecca5=_0x59c681;console[_0x3ecca5(0x272)](parseColor(_0x3d3e73,!![]));},'simple':_0x5b12e9=>{const _0x2ec467=_0x59c681;console['log'](parseColor(_0x5b12e9,!![])),loggerfile[_0x2ec467(0x193)](util[_0x2ec467(0x30a)](parseColor(_0x5b12e9,![]))+'\x0a');},'full':async _0x2c7e2f=>{const _0x4fa8bc=_0x59c681,_0x392cb8=getTimeStamp()+_0x4fa8bc(0x2b8)+_0x2c7e2f;console[_0x4fa8bc(0x272)](parseColor(_0x392cb8,!![])),loggerfile[_0x4fa8bc(0x193)](util[_0x4fa8bc(0x30a)](parseColor(_0x392cb8,![]))+'\x0a');if(tgBot&&settings[_0x4fa8bc(0x347)]&&settings[_0x4fa8bc(0x1c0)]!=_0x4fa8bc(0x31e))await sendTelegram(settings[_0x4fa8bc(0x347)],_0x4fa8bc(0x1fe)+parseColor(_0x2c7e2f,![]));},'debug':async(_0x206bb6,_0x14901d='')=>{const _0x53df09=_0x59c681,_0x391b48=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x206bb6;if(debugging)console[_0x53df09(0x272)](parseColor(_0x391b48,!![]));loggerfile['write'](util[_0x53df09(0x30a)](parseColor(_0x391b48,![]))+'\x0a');if(_0x14901d){if(debugging)console['log'](_0x14901d);loggerfile['write'](util[_0x53df09(0x30a)](_0x14901d)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x54c9b1){const _0x36c17c=_0x59c681;_0x54c9b1[_0x36c17c(0x22a)]()[_0x36c17c(0x1e6)](_0x36c17c(0x2dd))?(logger[_0x36c17c(0x2de)](_0x36c17c(0x17c)+_0x54c9b1[_0x36c17c(0x2b9)]+_0x36c17c(0x32b)),process[_0x36c17c(0x1b1)]({'terminate':!![]},_0x25fdd0=>{})):logger[_0x36c17c(0x2de)](_0x54c9b1);}),process['on'](_0x59c681(0x2f5),()=>{const _0x43c73c=_0x59c681;stopAllBots(),process[_0x43c73c(0x2f5)](0x0);}),process['on'](_0x59c681(0x349),()=>{const _0x3ec1b7=_0x59c681;stopAllBots(),process[_0x3ec1b7(0x2f5)](0x0);}),process['on']('SIGINT',()=>{const _0x57becc=_0x59c681;stopAllBots(),process[_0x57becc(0x2f5)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x59c681(0x2ea))[_0x59c681(0x1ad)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x59c681(0x2ab))[_0x59c681(0x2fc)](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x184c36,_0x2e9df6)=>{const _0x465d2b=_0x59c681,_0x368857=_0x184c36['params']['type'],_0x59891f=getClientsWithBotID(_0x465d2b(0x317)),_0x2017ac=_0x184c36['headers'][_0x465d2b(0x31d)],_0x321c6d=timelyDecrypt(_0x2017ac,![]),_0x49e127=_0x59891f[_0x465d2b(0x188)](_0x69ed6e=>_0x69ed6e[_0x465d2b(0x31d)]==_0x321c6d);if(_0x49e127){const _0x533a2c=normalizeIP(_0x184c36[_0x465d2b(0x220)][_0x465d2b(0x36a)])[_0x465d2b(0x196)],_0xcef241=_0x184c36[_0x465d2b(0x1aa)][_0x465d2b(0x340)];if(validateAccess(_0xcef241,_0x321c6d,_0x533a2c)[_0x465d2b(0x2f6)])_0x368857==_0x465d2b(0x343)&&await backupConfigFiles(),await zipFiles(_0x368857),_0x2e9df6[_0x465d2b(0x221)](zippath+(_0x368857+'.zip'),_0x54a3d8=>{const _0x5b035a=_0x465d2b;_0x54a3d8&&(logger[_0x5b035a(0x312)](_0x5b035a(0x307)+_0x368857),logger['simple'](_0x54a3d8));});else logger[_0x465d2b(0x312)](_0x465d2b(0x385)+_0x368857+'\x20(1)');}else logger[_0x465d2b(0x312)](_0x465d2b(0x385)+_0x368857+_0x465d2b(0x376));}),app[_0x59c681(0x294)](_0x59c681(0x1d6),async(_0x5bcb90,_0x11cc52)=>{const _0x133830=_0x59c681,_0x1867dd=getClientsWithBotID(_0x133830(0x317)),_0x4af358=_0x5bcb90[_0x133830(0x1aa)][_0x133830(0x31d)],_0x179dd=timelyDecrypt(_0x4af358,![]),_0xcb128a=_0x1867dd['find'](_0x5cbd6f=>_0x5cbd6f[_0x133830(0x31d)]==_0x179dd);logger[_0x133830(0x1d3)](_0x133830(0x330));if(_0xcb128a){const _0x457534=normalizeIP(_0x5bcb90['socket'][_0x133830(0x36a)])[_0x133830(0x196)],_0x414d10=_0x5bcb90[_0x133830(0x1aa)][_0x133830(0x340)];if(validateAccess(_0x414d10,_0x179dd,_0x457534)[_0x133830(0x2f6)]){if(_0x5bcb90[_0x133830(0x23a)]){const _0x5b6a18=_0x5bcb90[_0x133830(0x23a)]['backupfile'];await _0x5b6a18['mv'](temppath+_0x5b6a18[_0x133830(0x38e)]),_0x11cc52['send']({'status':!![],'message':_0x133830(0x1ef)});const _0xe17526=getBotsWithMode();_0xe17526[_0x133830(0x2a4)]>0x0?confirmRestore(temppath,_0x5b6a18[_0x133830(0x38e)]):unzipFile(temppath,_0x5b6a18['name']);}}else logger['full'](_0x133830(0x1d7));}else logger[_0x133830(0x312)](_0x133830(0x35e));}),app[_0x59c681(0x2d3)](express['static'](path[_0x59c681(0x28b)](__dirname,bbpath2,_0x59c681(0x311)))),app['use'](express[_0x59c681(0x36c)](path['join'](__dirname,bbpath2,'build'))),app['get']('/',function(_0x100a91,_0x46ae23){const _0x428fd9=_0x59c681;_0x46ae23[_0x428fd9(0x29b)](path[_0x428fd9(0x28b)](__dirname,bbpath2,_0x428fd9(0x311),_0x428fd9(0x228)));}),app['get']('/:bot',function(_0x47cea1,_0x3ca5f4){const _0x52df23=_0x59c681;_0x3ca5f4[_0x52df23(0x29b)](path['join'](__dirname,bbpath2,_0x52df23(0x379),_0x52df23(0x228)));}),app[_0x59c681(0x301)](_0x59c681(0x1cb),(_0x578d0f,_0x4c78e3)=>{const _0x1b95af=_0x59c681;_0x4c78e3['sendFile'](path[_0x1b95af(0x28b)](__dirname,bbpath2,'build',_0x1b95af(0x228)));}),app[_0x59c681(0x301)](_0x59c681(0x2dc),(_0x4b3a03,_0x32ae44)=>{const _0x1ac27a=_0x59c681;_0x32ae44[_0x1ac27a(0x29b)](path[_0x1ac27a(0x28b)](__dirname,bbpath2,_0x1ac27a(0x379),'index.html'));}),app[_0x59c681(0x301)](_0x59c681(0x1f4),(_0x44d7e3,_0x57654a)=>{const _0x283c67=_0x59c681;_0x57654a[_0x283c67(0x29b)](path['join'](__dirname,bbpath2,_0x283c67(0x379),_0x283c67(0x228)));}),app[_0x59c681(0x301)](_0x59c681(0x31a),(_0x173b71,_0x28981f)=>{const _0x405529=_0x59c681;_0x28981f[_0x405529(0x29b)](path[_0x405529(0x28b)](__dirname,bbpath2,_0x405529(0x379),_0x405529(0x228)));}),app[_0x59c681(0x301)](_0x59c681(0x182),(_0x50820c,_0x19d0c8)=>{const _0x3475e4=_0x59c681;_0x19d0c8['sendFile'](path[_0x3475e4(0x28b)](__dirname,bbpath2,_0x3475e4(0x379),'index.html'));}),app['get'](_0x59c681(0x2fa),(_0x2b4756,_0x45df2c)=>{const _0x431937=_0x59c681;_0x45df2c[_0x431937(0x29b)](path[_0x431937(0x28b)](__dirname,bbpath2,_0x431937(0x379),_0x431937(0x228)));});if(HOST)http[_0x59c681(0x19c)](PORT,HOST);else http['listen'](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x15edba=_0x59c681;let _0x1ab6d5='[ip-address]';const _0x140700=networkInterfaces(),_0x2ea4cc={};for(const _0x2e4686 of Object[_0x15edba(0x1c4)](_0x140700)){for(const _0x2dcda6 of _0x140700[_0x2e4686]){if((_0x2dcda6[_0x15edba(0x1db)]==_0x15edba(0x2c1)||_0x2dcda6[_0x15edba(0x1db)]==0x4)&&!_0x2dcda6[_0x15edba(0x1de)]){const _0xa555e8=ipaddr[_0x15edba(0x354)](_0x2dcda6[_0x15edba(0x1fa)])[_0x15edba(0x227)]();_0xa555e8!=_0x15edba(0x288)&&(!_0x2ea4cc[_0x2e4686]&&(_0x2ea4cc[_0x2e4686]=[]),_0x2ea4cc[_0x2e4686]['push'](_0x2dcda6[_0x15edba(0x1fa)]),_0x1ab6d5=_0x2dcda6['address']);}}}return{'serverip':_0x1ab6d5,'netinterfaces':_0x2ea4cc};}async function startServer(){const _0x1606e6=_0x59c681,{serverip:_0x515611,netinterfaces:_0x42de6d}=getServerIP();logger[_0x1606e6(0x2de)](''),logger[_0x1606e6(0x2de)](_0x1606e6(0x255)),await logger[_0x1606e6(0x312)](_0x1606e6(0x276)+serverversion+_0x1606e6(0x247)+(environment=='staging'?_0x1606e6(0x28c):'')+'\x0a'+(_0x1606e6(0x211)+PORT+_0x1606e6(0x2d0))+('=>\x20Go\x20to\x20#CYA#http://'+_0x515611+':'+PORT+_0x1606e6(0x1f5))),logger[_0x1606e6(0x2de)](_0x1606e6(0x255));if(config[_0x1606e6(0x2a4)]!=0x0)for(const _0x400829 of config){const _0x2095e5=_0x400829[_0x1606e6(0x192)]==_0x1606e6(0x33e)?'a':'m';if(_0x400829[_0x1606e6(0x1fc)]==_0x1606e6(0x2f0)||_0x400829['status']==_0x1606e6(0x36f))await logger[_0x1606e6(0x312)](_0x1606e6(0x248)+_0x2095e5+_0x1606e6(0x33d)+_0x400829['botID']+_0x1606e6(0x243)+_0x400829['botname']),startBot([_0x400829[_0x1606e6(0x189)],userID],{'cwd':bbpath},function(_0x42d740){const _0x359857=_0x1606e6;if(_0x42d740)logger[_0x359857(0x312)](_0x42d740);});else(_0x400829[_0x1606e6(0x1fc)]=='disabled'||_0x400829[_0x1606e6(0x1fc)]==_0x1606e6(0x27c))&&await logger['full'](_0x1606e6(0x239)+_0x2095e5+_0x1606e6(0x18a)+_0x400829[_0x1606e6(0x189)]+_0x1606e6(0x243)+_0x400829[_0x1606e6(0x226)]);}else!newBot&&logger[_0x1606e6(0x2de)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x1606e6(0x2de)](_0x1606e6(0x255)),logger[_0x1606e6(0x2de)](''),await logger[_0x1606e6(0x1d3)](_0x1606e6(0x342)+nodeversion),await logger[_0x1606e6(0x1d3)](_0x1606e6(0x210),_0x42de6d);}function startSocket(){const _0x1412e5=_0x59c681;io['on'](_0x1412e5(0x1ab),_0x49872b=>{const _0x43a4e3=_0x1412e5;let _0x57de60,_0x40947d,_0x8fe8bb,_0x297834,_0x2c9659;const _0xbaf7ed=_0x49872b[_0x43a4e3(0x201)]['headers'][_0x43a4e3(0x2aa)];_0x40947d=_0xbaf7ed[_0x43a4e3(0x289)](/bot[0-9]{3}/);if(_0x40947d)_0x8fe8bb=_0x40947d[0x0]['match'](/[0-9]{3}/);if(_0x8fe8bb)_0x57de60=_0x8fe8bb[0x0];else _0x57de60=_0x43a4e3(0x317);const _0x3f9bb8=_0x49872b[_0x43a4e3(0x201)][_0x43a4e3(0x218)][_0x43a4e3(0x318)];if(!_0x3f9bb8)_0x49872b[_0x43a4e3(0x240)]('status',{'publicKey':secure[_0x43a4e3(0x305)]});else{_0x297834=timelyDecrypt(_0x3f9bb8,![]);if(!_0x297834)_0x49872b[_0x43a4e3(0x240)](_0x43a4e3(0x1fc),{'publicKey':secure[_0x43a4e3(0x305)]});else{_0x2c9659=normalizeIP(_0x49872b[_0x43a4e3(0x1ce)][_0x43a4e3(0x36a)])['store'];if(!devices[_0x297834])devices[_0x297834]={'uuid':_0x297834,'access':{'token':null}};devices[_0x297834]['ip']=_0x2c9659;const _0x2ce4af=addClient(_0x49872b['id'],_0x297834,_0x57de60);setAccess(_0x2ce4af),emitMessages(),_0x49872b['on'](_0x43a4e3(0x23b),_0x57a2c2=>{const _0x2dd1f0=_0x43a4e3,_0x271e13=timelyDecrypt(_0x57a2c2[_0x2dd1f0(0x383)],!![],_0x2dd1f0(0x1c2));if(_0x271e13){_0x57a2c2={'username':_0x57a2c2[_0x2dd1f0(0x358)],'password':_0x271e13},devices[_0x297834]['access']=validateCredentials(_0x57a2c2,_0x297834);if(devices[_0x297834][_0x2dd1f0(0x21e)]['allow']==![]&&devices[_0x297834][_0x2dd1f0(0x21e)][_0x2dd1f0(0x194)]=='2FA\x20login\x20required')_0x49872b['emit'](_0x2dd1f0(0x1fc),{'access':devices[_0x297834][_0x2dd1f0(0x21e)]}),loginAccess2FA(_0x297834,_0x2c9659);else{if(devices[_0x297834][_0x2dd1f0(0x21e)][_0x2dd1f0(0x2f6)]==![]&&devices[_0x297834][_0x2dd1f0(0x21e)][_0x2dd1f0(0x194)]==_0x2dd1f0(0x1c7))_0x49872b[_0x2dd1f0(0x240)]('status',{'access':devices[_0x297834]['access']});else devices[_0x297834][_0x2dd1f0(0x21e)]['allow']&&devices[_0x297834]['access'][_0x2dd1f0(0x194)]==_0x2dd1f0(0x17e)&&(getClientsWithUuid(_0x297834)[_0x2dd1f0(0x2a8)](_0x2dfe8a=>{setAccess(_0x2dfe8a);}),logger['debug'](_0x2dd1f0(0x363)+_0x297834[_0x2dd1f0(0x334)](-0x8)),setTokenRefresh(_0x297834),setSessionTimeout(_0x2dd1f0(0x23b),_0x297834));}}else logger[_0x2dd1f0(0x312)](_0x2dd1f0(0x2b3));}),_0x49872b['on']('reset-password',()=>{resetPassword();}),_0x49872b['on'](_0x43a4e3(0x245),_0x34897d=>{removeClient(_0x49872b['id']);}),_0x57de60=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x116ccd){const _0x2c3b3b=_0x59c681;if(_0x116ccd!='botmanager'&&config[_0x2c3b3b(0x217)]!=''){if(pid[_0x116ccd])pid[_0x116ccd][_0x2c3b3b(0x1b1)]({'function':_0x2c3b3b(0x22c),'args':null});}_0x116ccd!='botmanager'&&broadcastToBots(_0x2c3b3b(0x2ba),JSON[_0x2c3b3b(0x1c3)](config));}function reloadBotManager(){const _0x120229=_0x59c681;getClientsWithBotID(_0x120229(0x317))[_0x120229(0x2a8)](_0x35d3c0=>{const _0x1d1626=_0x120229;getSocket(_0x35d3c0['id'])[_0x1d1626(0x240)]('status',{'access':{'allow':![],'reason':_0x1d1626(0x27b),'token':null}});});}function getSocket(_0x4e5265){const _0x1cad39=_0x59c681,_0x402ea8=io[_0x1cad39(0x344)][_0x1cad39(0x301)]('/');return _0x402ea8['sockets'][_0x1cad39(0x301)](_0x4e5265);}function setAccess(_0x4e335d){const _0x375f42=_0x59c681,_0x1dd162=getSocket(_0x4e335d['id']),_0x4f5e00=_0x4e335d[_0x375f42(0x31d)],_0x39037d=_0x4e335d[_0x375f42(0x356)];devices[_0x4f5e00][_0x375f42(0x21e)]=validateAccess(devices[_0x4f5e00][_0x375f42(0x21e)][_0x375f42(0x224)],_0x4f5e00),logger[_0x375f42(0x1d3)](_0x375f42(0x2ad)+devices[_0x4f5e00][_0x375f42(0x21e)][_0x375f42(0x194)]+_0x375f42(0x321)+_0x4e335d['id']['slice'](-0x8)+_0x375f42(0x200)+_0x4f5e00[_0x375f42(0x334)](-0x8)),_0x1dd162[_0x375f42(0x28b)](_0x4f5e00);if(devices[_0x4f5e00][_0x375f42(0x21e)][_0x375f42(0x2f6)]){_0x1dd162[_0x375f42(0x28b)](_0x39037d);if(_0x39037d==_0x375f42(0x317))initializeSocketBotManager(_0x1dd162);else initializeSocketBot(_0x1dd162);initClient(_0x39037d);}devices[_0x4f5e00][_0x375f42(0x21e)]['token']&&devices[_0x4f5e00][_0x375f42(0x21e)][_0x375f42(0x194)]==_0x375f42(0x1dd)&&setSessionTimeout('2FA',_0x4f5e00),devices[_0x4f5e00][_0x375f42(0x21e)][_0x375f42(0x224)]&&devices[_0x4f5e00][_0x375f42(0x21e)]['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x375f42(0x23b),_0x4f5e00),_0x1dd162[_0x375f42(0x240)]('status',{'status':_0x4e335d[_0x375f42(0x216)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4f5e00][_0x375f42(0x21e)],'externalip':devices[_0x4f5e00]['ip'],'publicKey':secure[_0x375f42(0x305)],'userid':settings[_0x375f42(0x2d4)],'validInstallation':validInstallation}),devices[_0x4f5e00]['access'][_0x375f42(0x2f6)]==![]&&devices[_0x4f5e00][_0x375f42(0x21e)]['reason']==_0x375f42(0x235)&&temporaryAccess2FA(_0x4f5e00,devices[_0x4f5e00]['ip']);}function setSessionTimeout(_0x453adc,_0x5639a3){const _0x253c80=_0x59c681;let _0x587458;if(_0x453adc==_0x253c80(0x23b))_0x587458=loginExpiry*0x3c*0x3e8;else _0x587458=devices[_0x5639a3][_0x253c80(0x21f)][_0x253c80(0x284)]*0x3c*0x3e8-(new Date()[_0x253c80(0x291)]()-devices[_0x5639a3]['telegramIpApproval']['timestamp']);if(devices[_0x5639a3][_0x253c80(0x2a2)])clearTimeout(devices[_0x5639a3][_0x253c80(0x2a2)]);devices[_0x5639a3][_0x253c80(0x2a2)]=setTimeout(()=>{const _0x43b898=_0x253c80;if(devices[_0x5639a3]['pidRefreshToken'])clearTimeout(devices[_0x5639a3][_0x43b898(0x229)]);removeSocketListeners(_0x5639a3),addBlacklist(_0x5639a3),devices[_0x5639a3][_0x43b898(0x21f)]=null,devices[_0x5639a3][_0x43b898(0x303)]=null,devices[_0x5639a3]['access'][_0x43b898(0x224)]=null,logger['debug'](_0x43b898(0x32e)+_0x5639a3[_0x43b898(0x334)](-0x8)),devices[_0x5639a3][_0x43b898(0x21e)]=validateAccess(devices[_0x5639a3][_0x43b898(0x21e)][_0x43b898(0x224)],_0x5639a3),!(devices[_0x5639a3][_0x43b898(0x21e)][_0x43b898(0x2f6)]&&devices[_0x5639a3][_0x43b898(0x21e)][_0x43b898(0x194)]==_0x43b898(0x246))&&(_0x453adc=='login'?io['to'](_0x5639a3)['emit'](_0x43b898(0x1fc),{'access':{'allow':![],'reason':_0x43b898(0x34a),'token':null}}):io['to'](_0x5639a3)[_0x43b898(0x240)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x5639a3][_0x43b898(0x21e)][_0x43b898(0x224)]=null;},_0x587458);}function setTokenRefresh(_0x5d195c){const _0x180f2a=_0x59c681;if(devices[_0x5d195c][_0x180f2a(0x229)])clearTimeout(devices[_0x5d195c][_0x180f2a(0x229)]);devices[_0x5d195c][_0x180f2a(0x229)]=setTimeout(()=>{const _0x11f3ee=_0x180f2a;getClientsWithUuid(_0x5d195c)[_0x11f3ee(0x2a4)]!=0x0?(devices[_0x5d195c][_0x11f3ee(0x21e)]=refreshToken(_0x5d195c),io['to'](_0x5d195c)[_0x11f3ee(0x240)](_0x11f3ee(0x1fc),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5d195c][_0x11f3ee(0x21e)],'externalip':devices[_0x5d195c]['ip'],'publicKey':secure[_0x11f3ee(0x305)],'validInstallation':validInstallation}),setTokenRefresh(_0x5d195c)):clearTimeout(devices[_0x5d195c][_0x11f3ee(0x229)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x11426c){const _0x3afbdb=_0x59c681,_0x12d2e0=getClient(_0x11426c['id'])[_0x3afbdb(0x31d)];_0x11426c[_0x3afbdb(0x240)](_0x3afbdb(0x2ba),config),_0x11426c[_0x3afbdb(0x240)](_0x3afbdb(0x21d),cleanSettings()),_0x11426c['on']('add-bot',_0x5402af=>{const _0x5a07f3=_0x3afbdb;if(validateAccess(_0x5402af,_0x12d2e0)[_0x5a07f3(0x2f6)])addBot();else logger[_0x5a07f3(0x312)](_0x5a07f3(0x370));}),_0x11426c['on'](_0x3afbdb(0x22b),(_0x22cac9,_0x4ce3de)=>{const _0x4f205c=_0x3afbdb;if(validateAccess(_0x4ce3de,_0x12d2e0)['allow'])toggleBot(_0x22cac9[_0x4f205c(0x189)],_0x22cac9[_0x4f205c(0x1fc)],_0x22cac9[_0x4f205c(0x29f)]);else logger[_0x4f205c(0x312)](_0x4f205c(0x332));}),_0x11426c['on'](_0x3afbdb(0x2ae),(_0x15e7e2,_0x2a62e6)=>{const _0x590b7a=_0x3afbdb;if(validateAccess(_0x2a62e6,_0x12d2e0)[_0x590b7a(0x2f6)])toggleBotMode(_0x15e7e2);else logger[_0x590b7a(0x312)](_0x590b7a(0x332));}),_0x11426c['on']('delete-bot',(_0x6084bd,_0x3a6ba7)=>{const _0x28dc10=_0x3afbdb;if(validateAccess(_0x3a6ba7,_0x12d2e0)[_0x28dc10(0x2f6)])deleteBot(_0x6084bd);else logger[_0x28dc10(0x312)](_0x28dc10(0x265));}),_0x11426c['on']('store-settings',(_0x1542c1,_0x51117f)=>{const _0x405a06=_0x3afbdb;if(validateAccess(_0x51117f,_0x12d2e0)[_0x405a06(0x2f6)])storeSettings(_0x1542c1,!![]);else logger[_0x405a06(0x312)](_0x405a06(0x27f));}),_0x11426c['on'](_0x3afbdb(0x2c4),_0x41a4ea=>{const _0xe62f44=_0x3afbdb;if(validateAccess(_0x41a4ea,_0x12d2e0)[_0xe62f44(0x2f6)])updateBB(_0xe62f44(0x1c1));else logger[_0xe62f44(0x312)](_0xe62f44(0x1c8));}),_0x11426c['on'](_0x3afbdb(0x25c),_0x5ceea2=>{const _0x53f4d8=_0x3afbdb;if(validateAccess(_0x5ceea2,_0x12d2e0)[_0x53f4d8(0x2f6)])updateBB(_0x53f4d8(0x2f9));else logger[_0x53f4d8(0x312)](_0x53f4d8(0x237));}),_0x11426c['on'](_0x3afbdb(0x2e0),_0x32eb35=>{const _0x58a2df=_0x3afbdb;if(validateAccess(_0x32eb35,_0x12d2e0)[_0x58a2df(0x2f6)]){const _0x161c48=getClient(_0x11426c['id']);if(_0x161c48)getBackupFiles(_0x161c48[_0x58a2df(0x31d)]);else logger[_0x58a2df(0x312)](_0x58a2df(0x2d8));}else logger[_0x58a2df(0x312)](_0x58a2df(0x2b1));}),_0x11426c['on'](_0x3afbdb(0x36d),(_0x31a337,_0xa95181)=>{const _0x227b9f=_0x3afbdb;if(validateAccess(_0xa95181,_0x12d2e0)['allow'])restoreBackupFile(_0x31a337);else logger[_0x227b9f(0x312)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x11426c['on'](_0x3afbdb(0x30c),_0x2ccf98=>{const _0x38d08d=_0x3afbdb;if(validateAccess(_0x2ccf98,_0x12d2e0)[_0x38d08d(0x2f6)])getMessages();else logger[_0x38d08d(0x312)](_0x38d08d(0x352));}),_0x11426c['on'](_0x3afbdb(0x362),(_0x2ceda6,_0x965500)=>{const _0x1a9333=_0x3afbdb;if(validateAccess(_0x965500,_0x12d2e0)[_0x1a9333(0x2f6)])confirmMessage(_0x2ceda6);else logger[_0x1a9333(0x312)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x11426c['on'](_0x3afbdb(0x2ee),_0x3e31e7=>{const _0x1fe04d=_0x3afbdb;if(validateAccess(_0x3e31e7,_0x12d2e0)[_0x1fe04d(0x2f6)]){if(devices[_0x12d2e0][_0x1fe04d(0x229)])clearTimeout(devices[_0x12d2e0]['pidRefreshToken']);if(devices[_0x12d2e0][_0x1fe04d(0x2a2)])clearTimeout(devices[_0x12d2e0][_0x1fe04d(0x2a2)]);removeSocketListeners(getClient(_0x11426c['id'])[_0x1fe04d(0x31d)]),addBlacklist(_0x12d2e0),devices[_0x12d2e0][_0x1fe04d(0x21f)]=null,devices[_0x12d2e0][_0x1fe04d(0x303)]=null,devices[_0x12d2e0][_0x1fe04d(0x21e)][_0x1fe04d(0x224)]=null,logger[_0x1fe04d(0x1d3)](_0x1fe04d(0x386)+_0x12d2e0[_0x1fe04d(0x334)](-0x8)),io['to'](getClient(_0x11426c['id'])[_0x1fe04d(0x31d)])[_0x1fe04d(0x240)]('status',{'access':{'allow':![],'reason':_0x1fe04d(0x287),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x40c7b0){const _0x19b08a=_0x59c681,_0x2f9140=getClient(_0x40c7b0['id'])[_0x19b08a(0x356)],_0x234a71=getClient(_0x40c7b0['id'])[_0x19b08a(0x31d)];_0x40c7b0['on'](_0x19b08a(0x346),(_0x35ab7e,_0x2ef3f1)=>{const _0x2e5443=_0x19b08a;if(validateAccess(_0x2ef3f1,_0x234a71)['allow']){if(pid[_0x2f9140])pid[_0x2f9140]['send']({'function':_0x2e5443(0x1ed),'args':_0x35ab7e});}else logger['full'](_0x2e5443(0x1a3));}),_0x40c7b0['on'](_0x19b08a(0x252),(_0xda0af4,_0x418290)=>{const _0x1e24e1=_0x19b08a;if(validateAccess(_0x418290,_0x234a71)[_0x1e24e1(0x2f6)]){if(pid[_0x2f9140])pid[_0x2f9140][_0x1e24e1(0x1b1)]({'function':_0x1e24e1(0x28a),'args':_0xda0af4});}else logger['full'](_0x1e24e1(0x2bd));}),_0x40c7b0['on'](_0x19b08a(0x390),(_0x26a677,_0x416d43)=>{const _0x575a42=_0x19b08a;if(validateAccess(_0x416d43,_0x234a71)['allow']){if(pid[_0x2f9140])pid[_0x2f9140][_0x575a42(0x1b1)]({'function':_0x575a42(0x234),'args':_0x26a677});}else logger['full'](_0x575a42(0x34d));}),_0x40c7b0['on'](_0x19b08a(0x2d1),(_0x3f6b59,_0x4ef326)=>{const _0x4f19ab=_0x19b08a;if(validateAccess(_0x4ef326,_0x234a71)['allow']){if(pid[_0x2f9140])pid[_0x2f9140][_0x4f19ab(0x1b1)]({'function':_0x4f19ab(0x22e),'args':_0x3f6b59});}else logger[_0x4f19ab(0x312)](_0x4f19ab(0x24a));}),_0x40c7b0['on']('store-headless',(_0x3d3da4,_0x43cc1a)=>{const _0x5273ca=_0x19b08a;if(validateAccess(_0x43cc1a,_0x234a71)[_0x5273ca(0x2f6)]){if(pid[_0x2f9140])pid[_0x2f9140][_0x5273ca(0x1b1)]({'function':_0x5273ca(0x2fe),'args':_0x3d3da4});}else logger[_0x5273ca(0x312)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x40c7b0['on']('store-fiat',(_0x3be05a,_0x343021)=>{const _0x4ecae6=_0x19b08a;if(validateAccess(_0x343021,_0x234a71)['allow']){if(pid[_0x2f9140])pid[_0x2f9140][_0x4ecae6(0x1b1)]({'function':_0x4ecae6(0x1ff),'args':_0x3be05a});}else logger[_0x4ecae6(0x312)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x40c7b0['on'](_0x19b08a(0x27a),_0x4c01da=>{const _0x132a3c=_0x19b08a;if(validateAccess(_0x4c01da,_0x234a71)[_0x132a3c(0x2f6)]){if(pid[_0x2f9140])pid[_0x2f9140][_0x132a3c(0x1b1)]({'function':_0x132a3c(0x329),'args':null});}else logger['full'](_0x132a3c(0x18e));}),_0x40c7b0['on'](_0x19b08a(0x2ec),_0x12585e=>{const _0x1ac12e=_0x19b08a;if(validateAccess(_0x12585e,_0x234a71)[_0x1ac12e(0x2f6)]){if(pid[_0x2f9140])pid[_0x2f9140][_0x1ac12e(0x1b1)]({'function':_0x1ac12e(0x24d),'args':null});}else logger['full'](_0x1ac12e(0x1a4));}),_0x40c7b0['on'](_0x19b08a(0x180),(_0x185feb,_0x377c9c)=>{const _0x45b862=_0x19b08a;if(validateAccess(_0x377c9c,_0x234a71)[_0x45b862(0x2f6)]){if(pid[_0x2f9140])pid[_0x2f9140][_0x45b862(0x1b1)]({'function':_0x45b862(0x1bd),'args':_0x185feb});}else logger[_0x45b862(0x312)](_0x45b862(0x36e));}),_0x40c7b0['on'](_0x19b08a(0x1b2),_0x5b784e=>{const _0x94a5c8=_0x19b08a;if(validateAccess(_0x5b784e,_0x234a71)[_0x94a5c8(0x2f6)]){if(pid[_0x2f9140])pid[_0x2f9140][_0x94a5c8(0x1b1)]({'function':_0x94a5c8(0x37d),'args':null});}else logger[_0x94a5c8(0x312)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x40c7b0['on']('show-config',_0x28c5ea=>{const _0x21c648=_0x19b08a;if(validateAccess(_0x28c5ea,_0x234a71)['allow']){if(pid[_0x2f9140])pid[_0x2f9140][_0x21c648(0x1b1)]({'function':_0x21c648(0x2cc),'args':null});}else logger['full'](_0x21c648(0x2c3));}),_0x40c7b0['on']('update-bb',_0x161b11=>{const _0x392420=_0x19b08a;if(validateAccess(_0x161b11,_0x234a71)[_0x392420(0x2f6)])updateBB('update');else logger[_0x392420(0x312)](_0x392420(0x1c8));}),_0x40c7b0['on'](_0x19b08a(0x30c),_0x1c4a3b=>{const _0x593d39=_0x19b08a;if(validateAccess(_0x1c4a3b,_0x234a71)['allow'])getMessages();else logger[_0x593d39(0x312)](_0x593d39(0x352));}),_0x40c7b0['on'](_0x19b08a(0x362),(_0x41b7d9,_0x145701)=>{const _0x5c680e=_0x19b08a;if(validateAccess(_0x145701,_0x234a71)[_0x5c680e(0x2f6)])confirmMessage(_0x41b7d9);else logger[_0x5c680e(0x312)](_0x5c680e(0x273));}),_0x40c7b0['on']('logout',_0x121241=>{const _0x4fc3e1=_0x19b08a;if(validateAccess(_0x121241,_0x234a71)[_0x4fc3e1(0x2f6)]){if(devices[_0x234a71][_0x4fc3e1(0x229)])clearTimeout(devices[_0x234a71]['pidRefreshToken']);if(devices[_0x234a71][_0x4fc3e1(0x2a2)])clearTimeout(devices[_0x234a71][_0x4fc3e1(0x2a2)]);removeSocketListeners(getClient(_0x40c7b0['id'])['uuid']),addBlacklist(_0x234a71),devices[_0x234a71][_0x4fc3e1(0x21f)]=null,devices[_0x234a71][_0x4fc3e1(0x303)]=null,devices[_0x234a71]['access'][_0x4fc3e1(0x224)]=null,logger[_0x4fc3e1(0x1d3)](_0x4fc3e1(0x386)+_0x234a71[_0x4fc3e1(0x334)](-0x8)),io['to'](getClient(_0x40c7b0['id'])['uuid'])[_0x4fc3e1(0x240)]('status',{'access':{'allow':![],'reason':_0x4fc3e1(0x287),'token':null}});}else logger[_0x4fc3e1(0x312)](_0x4fc3e1(0x384));});}function removeSocketListeners(_0x2d0c59){getClientsWithUuid(_0x2d0c59)['forEach'](_0x1596dc=>{const _0xa5c272=_0x1941;getSocket(_0x1596dc['id'])[_0xa5c272(0x254)]();});}function cleanSettings(){const _0x48bd49=_0x59c681;let _0x1b6643=settings;return settings['telegramToken']&&settings[_0x48bd49(0x2c0)]!=''&&(_0x1b6643={..._0x1b6643,'telegramToken':_0x48bd49(0x1cf)}),settings['bbPassword']&&settings[_0x48bd49(0x257)]!=''&&(_0x1b6643={..._0x1b6643,'bbPassword':'************'}),settings[_0x48bd49(0x337)]&&settings['marketcapApi']!=''&&(_0x1b6643={..._0x1b6643,'marketcapApi':_0x48bd49(0x1cf)}),(settings[_0x48bd49(0x257)]&&settings[_0x48bd49(0x257)]==_0x48bd49(0x23f)||settings[_0x48bd49(0x2c0)]&&settings[_0x48bd49(0x2c0)]==_0x48bd49(0x23f)||settings[_0x48bd49(0x337)]&&settings['marketcapApi']=='***')&&(_0x1b6643={..._0x1b6643,'restored':{'password':settings['bbPassword']==_0x48bd49(0x23f),'telegram':settings['telegramToken']==_0x48bd49(0x23f),'marketcap':settings[_0x48bd49(0x337)]==_0x48bd49(0x23f)}}),_0x1b6643;}async function updateBB(_0x3b676d){const _0xdf960b=_0x59c681;await backupConfigFiles(),installingUpdate=!![],config[_0xdf960b(0x2a8)](_0x186ff4=>{const _0x22f8b1=_0xdf960b;restartBot(_0x186ff4[_0x22f8b1(0x189)]);});if(_0x3b676d==_0xdf960b(0x1c1))process[_0xdf960b(0x1b1)]({'update':!![],'environment':environment},_0x4cac56=>{});else _0x3b676d==_0xdf960b(0x2f9)&&process['send']({'reinstall':!![],'environment':environment},_0x5dfb97=>{});}function startBot(_0x4e5ebb,_0x27c1a7,_0x569421){const _0x24df85=_0x59c681;if(debugging)_0x4e5ebb[_0x24df85(0x20a)]('-d');let _0x47f656=![];const _0x307247=_0x4e5ebb[0x0];_0x27c1a7={..._0x27c1a7,'stdio':[_0x24df85(0x1f9),_0x24df85(0x1f9),_0x24df85(0x1f9),_0x24df85(0x29d)]},pid[_0x307247]=childProcess[_0x24df85(0x322)](botfile,_0x4e5ebb,_0x27c1a7),pid[_0x307247]['on']('message',_0x4f014b=>{const _0x32d08d=_0x24df85;switch(Object[_0x32d08d(0x1c4)](_0x4f014b)[0x0]){case'botname':updateBotName(_0x307247,_0x4f014b[_0x32d08d(0x226)]);break;case _0x32d08d(0x1bb):updateBotManager();break;case'status':updateStatus(_0x307247,_0x4f014b[_0x32d08d(0x1fc)]);break;case _0x32d08d(0x29f):updateLive(_0x307247,_0x4f014b[_0x32d08d(0x29f)]);break;case _0x32d08d(0x1bc):updateLive(_0x307247,_0x4f014b[_0x32d08d(0x1bc)]),io['to'](_0x307247)[_0x32d08d(0x240)](_0x32d08d(0x1fc),{'access':{'allow':![],'reason':_0x32d08d(0x27b),'token':null}});break;case _0x32d08d(0x2cf):_0x4f014b[_0x32d08d(0x2cf)]==_0x32d08d(0x314)&&restartBot(_0x307247);_0x4f014b[_0x32d08d(0x2cf)]==_0x32d08d(0x184)&&toggleBot(_0x307247,'disabled',_0x32d08d(0x1e9));break;case _0x32d08d(0x1a1):sendTelegramBot(_0x307247,_0x4f014b['telegram']);break;case _0x32d08d(0x25d):sendTelegramMsg(_0x4f014b[_0x32d08d(0x25d)]);break;case _0x32d08d(0x197):io['to'](_0x307247)[_0x32d08d(0x240)](_0x4f014b[_0x32d08d(0x197)],_0x4f014b['args']);break;}}),pid[_0x307247]['on'](_0x24df85(0x187),function(_0x2e402f){if(_0x47f656)return;_0x47f656=!![],_0x569421(_0x2e402f);}),pid[_0x307247]['on'](_0x24df85(0x2f5),async function(_0x388321){const _0x120183=_0x24df85;if(terminating)return;if(installingUpdate){io['close']();return;}if(_0x47f656)return;_0x47f656=!![],_0x569421(null);const _0xf9c1e=dbConfig[_0x120183(0x301)](_0x120183(0x2ba))[_0x120183(0x188)]({'botID':_0x307247})['value']();_0xf9c1e&&(_0xf9c1e[_0x120183(0x1fc)]=='enabled'||_0xf9c1e[_0x120183(0x1fc)]=='new')&&(await sleep(0x3e8),updateLive(_0x307247,_0x120183(0x1e9)),logger[_0x120183(0x312)](_0x120183(0x395)+_0x307247),startBot([_0x307247,userID],{'cwd':bbpath},function(_0x49bae9){if(_0x49bae9)logger['full'](_0x49bae9);}));});}function stopBot(_0x4cdc27){const _0x150ab3=_0x59c681;getClientsWithBotID(_0x4cdc27)[_0x150ab3(0x2a8)](_0x332877=>{getSocket(_0x332877['id'])['disconnect'](!![]),removeClient(_0x332877['id']);}),pid[_0x4cdc27]&&(pid[_0x4cdc27][_0x150ab3(0x184)](),pid[_0x4cdc27]=null);}function stopAllBots(){terminating=!![];const _0x5e4a02=getEnabledBots();_0x5e4a02['forEach'](_0x47cc66=>{stopBot(_0x47cc66['botID']);});}function restartBot(_0x2687a9){if(pid[_0x2687a9])pid[_0x2687a9]['kill']();}function addBot(){const _0x4b5560=_0x59c681;let _0x5576d0;for(let _0x1a5fbe=0x1;_0x1a5fbe<0x3e9;_0x1a5fbe++){_0x5576d0=_0x1a5fbe[_0x4b5560(0x22a)]()[_0x4b5560(0x365)](0x3,'0');let _0x4ad46c=config['find'](_0x217e08=>_0x217e08[_0x4b5560(0x189)]==_0x5576d0);if(!_0x4ad46c)break;}if(_0x5576d0==='1000'){logger['full']('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x4b5560(0x312)](_0x4b5560(0x1c5)+_0x5576d0),dbConfig[_0x4b5560(0x301)](_0x4b5560(0x2ba))[_0x4b5560(0x20a)]({'botID':_0x5576d0,'botname':_0x4b5560(0x372)+_0x5576d0,'status':_0x4b5560(0x36f),'live':''})['write'](),startBot([_0x5576d0,userID],{'cwd':bbpath},function(_0xee30db){const _0x3f955d=_0x4b5560;if(_0xee30db)logger[_0x3f955d(0x312)](_0xee30db);}),config=getConfiguration(),io['to'](_0x4b5560(0x317))[_0x4b5560(0x240)](_0x4b5560(0x2ba),config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x404498){const _0x1b5543=_0x59c681;getClientsWithBotID(_0x404498)[_0x1b5543(0x2a8)](_0x50586c=>{const _0x219334=_0x1b5543;getSocket(_0x50586c['id'])[_0x219334(0x245)](!![]),removeClient(_0x50586c['id']);}),dbConfig[_0x1b5543(0x301)](_0x1b5543(0x2ba))[_0x1b5543(0x366)]({'botID':_0x404498})['write'](),logger['full'](_0x1b5543(0x231)+_0x404498),stopBot(_0x404498);try{if(fs['existsSync'](path[_0x1b5543(0x28b)](configpath,'bot-'+_0x404498+'-config.json')))fs[_0x1b5543(0x181)](path['join'](configpath,_0x1b5543(0x38b)+_0x404498+'-config.json'));if(fs[_0x1b5543(0x244)](path[_0x1b5543(0x28b)](configpath,_0x1b5543(0x38b)+_0x404498+'-events.json')))fs[_0x1b5543(0x181)](path[_0x1b5543(0x28b)](configpath,'bot-'+_0x404498+_0x1b5543(0x2b2)));if(fs['existsSync'](path['join'](configpath,_0x1b5543(0x38b)+_0x404498+_0x1b5543(0x253))))fs[_0x1b5543(0x181)](path[_0x1b5543(0x28b)](configpath,_0x1b5543(0x38b)+_0x404498+_0x1b5543(0x253)));if(fs[_0x1b5543(0x244)](path['join'](configpath,_0x1b5543(0x38b)+_0x404498+_0x1b5543(0x286))))fs['unlinkSync'](path[_0x1b5543(0x28b)](configpath,_0x1b5543(0x38b)+_0x404498+_0x1b5543(0x286)));}catch(_0x420b57){if(_0x420b57)logger[_0x1b5543(0x312)](_0x1b5543(0x213),_0x420b57);}config=getConfiguration(),io['to']('botmanager')['emit'](_0x1b5543(0x2ba),config),broadcastToBots(_0x1b5543(0x2ba),JSON[_0x1b5543(0x1c3)](config));}function toggleBot(_0x344363,_0x361ead,_0x405c18){const _0x397b60=_0x59c681;dbConfig[_0x397b60(0x301)](_0x397b60(0x2ba))[_0x397b60(0x188)]({'botID':_0x344363})['assign']({'status':_0x361ead})['assign']({'live':_0x405c18})[_0x397b60(0x193)]();if(_0x361ead==_0x397b60(0x2f0)||_0x361ead==_0x397b60(0x36f))logger[_0x397b60(0x312)](_0x397b60(0x206)+_0x344363),startBot([_0x344363,userID],{'cwd':bbpath},function(_0x3cd746){const _0x3bb086=_0x397b60;if(_0x3cd746)logger[_0x3bb086(0x312)](_0x3cd746);});else(_0x361ead==_0x397b60(0x26b)||_0x361ead==_0x397b60(0x27c))&&(logger[_0x397b60(0x312)](_0x397b60(0x300)+_0x344363),stopBot(_0x344363));config=getConfiguration(),io['to'](_0x397b60(0x317))[_0x397b60(0x240)](_0x397b60(0x2ba),config),broadcastToBots(_0x397b60(0x2ba),JSON[_0x397b60(0x1c3)](config));}function toggleStatus(_0x407267){const _0x394b7b=_0x59c681;let _0x4cbcb9=dbConfig[_0x394b7b(0x301)](_0x394b7b(0x2ba))[_0x394b7b(0x188)]({'botID':_0x407267})[_0x394b7b(0x22d)](),_0x2c1aa4;if(_0x4cbcb9[_0x394b7b(0x1fc)]===_0x394b7b(0x2f0))_0x2c1aa4=_0x394b7b(0x26b);else{if(_0x4cbcb9[_0x394b7b(0x1fc)]===_0x394b7b(0x36f))_0x2c1aa4='new-disabled';else{if(_0x4cbcb9[_0x394b7b(0x1fc)]===_0x394b7b(0x27c))_0x2c1aa4=_0x394b7b(0x36f);else{if(_0x4cbcb9['status']==='disabled')_0x2c1aa4=_0x394b7b(0x2f0);}}}return _0x2c1aa4;}function updateStatus(_0x2b10d3,_0x12c775){const _0x5a549f=_0x59c681;dbConfig['get'](_0x5a549f(0x2ba))[_0x5a549f(0x188)]({'botID':_0x2b10d3})[_0x5a549f(0x282)]({'status':_0x12c775})[_0x5a549f(0x193)](),config=getConfiguration(),io['to'](_0x5a549f(0x317))[_0x5a549f(0x240)](_0x5a549f(0x2ba),config),broadcastToBots(_0x5a549f(0x2ba),JSON[_0x5a549f(0x1c3)](config));}function updateLive(_0x314848,_0x4677e7){const _0x1532d2=_0x59c681;dbConfig[_0x1532d2(0x301)]('bots')[_0x1532d2(0x188)]({'botID':_0x314848})[_0x1532d2(0x282)]({'live':_0x4677e7})[_0x1532d2(0x193)](),config=getConfiguration(),io['to'](_0x1532d2(0x317))['emit']('bots',config),broadcastToBots('bots',JSON[_0x1532d2(0x1c3)](config));}function updateBotName(_0x26089b,_0x1220b8){const _0x1fd431=_0x59c681;dbConfig[_0x1fd431(0x301)](_0x1fd431(0x2ba))[_0x1fd431(0x188)]({'botID':_0x26089b})[_0x1fd431(0x282)]({'botname':_0x1220b8})['write'](),config=getConfiguration(),io['to'](_0x1fd431(0x317))[_0x1fd431(0x240)](_0x1fd431(0x2ba),config),broadcastToBots(_0x1fd431(0x2ba),JSON[_0x1fd431(0x1c3)](config));}function updateBotManager(){const _0x544dee=_0x59c681;config=getConfiguration(),io['to'](_0x544dee(0x317))[_0x544dee(0x240)](_0x544dee(0x2ba),config),broadcastToBots('bots',JSON[_0x544dee(0x1c3)](config));}function _0x4b58(){const _0x2bb969=['enabled','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','6b67f3d61ee94b8f5c80b4affef4c4d9','sendPortfolioTelegram','publicKeyToPem','exit','allow','yes','1206OWHrWX','reinstall','/:bot/support','start','createServer','-config.json','storeHeadless','telegramEnabled','Disabled\x20Bot\x20','get','search','telegram2FaApproval','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','publicKey','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Failed\x20to\x20download\x20','request','Orders','format','getMinutes','get-messages','No\x20authentication\x20token','child_process','Allow\x20login\x20from\x20IP\x20address\x20','Error:\x20Invalid\x20argument\x20','build2','full','button','restart','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','from','botmanager','encryptedUuid','DEFLATE','/:bot/history','apply','exec','uuid','orders','\x1b[0m','warning','\x20|\x20client:\x20...','fork','/status\x20-\x20show\x20bot(s)\x20status\x0a','/disable\x20-\x20disable\x20notifications\x0a','Invalid\x20authentication\x20token\x20(1)','Password\x20reset\x20rejected','defaults','Backup\x20file\x20unzipped\x20and\x20stored','resetHistory','SIGINT','#RES#','lastmsgemitted','\x1b[36m','Session\x20expired\x20for\x20user\x20...','backup-full.zip','Backup\x20file\x20uploaded','Invalid\x20username\x20or\x20IP\x20address','Unauthorized\x20attempt\x20to\x20update\x20bot','config/','slice','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','marketcapApi','privateKey','jszip','output-002.log','restore_no_','logs/',')\x20|\x20Bot\x20','auto','telegraf','tkn','Ok,\x20will\x20send\x20order\x20notifications\x20only','Node.js\x20v','backup','_nsps','date-fns','get-logs','telegramChatId','Temporary\x20access\x20rejected','SIGTERM','access\x20timeout','config_orders','User\x20has\x20been\x20validated','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Notifications\x20types:\x20','blacklist','HTML','help','Unauthorized\x20attempt\x20to\x20get\x20messages','4225573hBgJZM','parse','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','bot',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','username','statSync','status\x20code\x20401','order','copyFileSync','writeFileSync','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','lastmsgtelegram','file','confirm-message','Logged\x20in\x20user\x20...','secret','padStart','remove','Notifications\x20enabled','Markdown','alerts','remoteAddress','latestversion','static','restore-backup-file','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','new','Unauthorized\x20attempt\x20to\x20add\x20bot','loginRequired','Bot\x20','getHours','Alerts','bbvNew','\x20(2)','success','0.0.0','build','/output-000.log','2FA\x20login\x20required','production','cancelLoading','alias','BCT','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','create','hex','password','Unauthorized\x20attempt\x20to\x20log\x20out','Unauthorized\x20attempt\x20to\x20download\x20','Logged\x20out\x20user\x20...','lowdb','isValid','catch','resetpw_no','bot-','Notifications\x20enabled\x0a','Error\x20details:','name','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','get-portfolio','All\x20bots','pki','versions','sign','Restarting\x20Bot\x20','manual','temporary\x20access\x20rejected','\x1b[34m','messages','\x20to\x20','jsonwebtoken','sort','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','async','login\x20token\x20generated','argv','place-order','unlinkSync','/:bot/configuration','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','kill','config','bb-config.json','error','find','botID',')\x20\x20\x20|\x20Bot\x20','accept','backup-full','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','/off\x20-\x20stop\x20bot(s)\x0a','4068552rTlqeS','70lFWLNB','mode','write','reason','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','store','function','bb-secure.json','readFileSync','callback','2FA\x20login\x20rejected','listen','bot.js','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','loadAsync','apiSecret','telegram','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Unauthorized\x20attempt\x20to\x20get\x20events','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','disable','6423893AdRxft','<b>Telegram\x20Bot\x20Status:</b>\x0a','sortBy','portfolio_','headers','connection','/enable\x20-\x20enable\x20notifications\x0a','version','hashSync','title','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','send','cancel-loading','binary','message','2FA\x20login\x20token\x20generated','on_','\x1b[31m','randomBytes','/restart\x20-\x20restart\x20bot(s)\x0a','/backup\x20-\x20receive\x20backup\x20files\x0a','updatebotmanager','started','placeOrder','staging','endsWith','telegramEvents','update','|@|','stringify','keys','Starting\x20new\x20bot\x20|\x20Bot\x20','rmSync','invalid\x20credentials','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','No\x20bots\x20running\x20right\x20now','mixpanel','/:bot/portfolio','915713Iwztww','login2fa_','conn','************','Restore\x20process\x20aborted','Running\x20#RED#Balance\x20Bot\x20v','backup-files','debug','graphql-request','whitelist','/upload-backup','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','bb/','then','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','family','128tVzqOq','temporary\x20token\x20generated','internal','filter','login\x20required','reinstall_yes','bb-settings.json','constructor','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','\x20only\x0a','includes','tempaccess_30_','split','stopped','once','backup/','reinstall_no','emitHistory','ETH','File\x20uploaded','size','verify','all','sha256','/:bot/coins','#RES#\x20if\x20running\x20on\x20server','hasOwnProperty','Invalid\x20IP\x20address','entries','inherit','address','741JlzcUg','status','replace','Bot\x20Mgr\x20>\x20','storeFiat','\x20|\x20user:\x20...','handshake','onepagemode','util','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','timeshift','Enabled\x20Bot\x20','toggleBotMode','generateKeyPair','getDate','push','privateKeyFromPem','off_','6SnnCsC','type','exchange','Network\x20Interfaces:','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','command','Error\x20while\x20deleting\x20config\x20files:\x20','35325zGmIkz','getMonth','server','apiKey','auth','chat','toggle_','mtime','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','settings','access','telegramIpApproval','socket','download','portfolio','update_no','token','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','botname','range','index.html','pidRefreshToken','toString','update-bot','initclient','value','storeConfiguration','apiPassword','\x1b[33m','Deleted\x20Bot\x20','set','ipv6','getPortfolio','2FA\x20required','Password\x20has\x20been\x20reset\x20to:\x20','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','<b>Balance\x20Bot\x20Status:</b>\x0a','Idling\x20(','files','login','editMessageReplyMarkup','notification','$1_$2_$3','***','emit','show','number','\x20|\x20','existsSync','disconnect','login\x20not\x20required','#RES#\x20','Starting\x20(','5479035rTvXpA','Unauthorized\x20attempt\x20to\x20store\x20configuration','/help\x20-\x20show\x20available\x20commands\x0a',',\x20must\x20be\x20a\x204\x20digit\x20number','getStartingBalances','config_all','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','tempaccess_reject_','bbUsername','delete-alerts','-performance.json','removeAllListeners','-----------------------------------------------------------------------------------','\x20minutes','bbPassword','node','clients','decode64','Error\x20sending\x20','reinstall-bb','telegrammsg','zip/','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','readdirSync','getFullYear','headless','output-000.log','Invalid\x20authentication\x20token\x20(2)','Unauthorized\x20attempt\x20to\x20delete\x20bot','inlineKeyboard','event','(((.+)+)+)+$','/update\x20-\x20update\x20Balance\x20Bot\x0a','Starting\x20Balance\x20Bot\x20reinstallation','disabled','/start','/metrics\x20-\x20show\x20bot\x20performance\x0a','--------------------------------------','init','secure','isIPv4MappedAddress','log','Unauthorized\x20attempt\x20to\x20confirm\x20message','running','min','Starting\x20#RED#Balance\x20Bot\x20v','kind','sendMessage','sendMetricsTelegram','reset-history','reload','new-disabled','replyWithDocument','reply','Unauthorized\x20attempt\x20to\x20update\x20settings','update_yes','logs','assign','test','expiry','user','-results.json','logged\x20out','private','match','deleteHistoryAlerts','join','(staging)','Starting\x20Balance\x20Bot\x20update','15\x20min','\x20-\x20','config_alerts','getTime','timestamp','/names\x20-\x20show\x20bot\x20names\x0a','post','\x1b[35m','string','5\x20min','startsWith','Your\x20installation\x20is\x20already\x20up\x20to\x20date','uuid-random','sendFile','telegramUsername','ipc','Ok,\x20will\x20send\x20alert\x20notifications\x20only','live','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','restore_yes_','pidExpireLogin','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','length','https://api.ipify.org?format=json','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','/on\x20-\x20start\x20bot(s)\x0a','forEach','crypto','referer','http','login2fa_reject_','Setting\x20access:\x20','toggle-bot-mode','.zip','getSeconds','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','-events.json','Unauthorized\x20login\x20attempt\x20(timeout)','\x20>\x20','settings.','map','bcryptjs',':\x20Bot\x20Mgr\x20>\x20','port','bots','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','launch','Unauthorized\x20attempt\x20to\x20delete\x20alerts','f2aRequired','::1','telegramToken','IPv4','clientip','Unauthorized\x20attempt\x20to\x20show\x20configuration','update-bb','toIPv4MappedAddress','environment','tempaccess_5_','/logs\x20-\x20receive\x20log\x20files\x0a','Login\x20rejected','Restoring\x20bot(s)\x20from\x20backup','api-eu.mixpanel.com','showConfig','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','path','stop','#RES#\x20if\x20running\x20locally\x0a','store-configuration','bbvReceive','use','userid','ipaddr.js','host','temporary\x20access\x20not\x20allowed','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Error\x20removing\x20old\x20backup\x20files:','Server','exp','/:bot/performance','address\x20already\x20in\x20use','simple','privateKeyToPem','get-backup-files','any','*$1*','Restore\x20backup\x20file\x20','mkdirSync','Token\x20blacklisted','tempaccess_15_','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','temp/','isDirectory','version.json','action','get-starting-balances','reject','logout','::ffff:127.0.0.1'];_0x4b58=function(){return _0x2bb969;};return _0x4b58();}function toggleBotMode(_0x5cfbd7){const _0x163eb7=_0x59c681;if(pid[_0x5cfbd7])pid[_0x5cfbd7][_0x163eb7(0x1b1)]({'function':_0x163eb7(0x207),'args':null});else{const _0x47478f=configpath+'bot-'+_0x5cfbd7+_0x163eb7(0x2fd),_0x5e0273=fs['readFileSync'](_0x47478f),_0x566c83=JSON[_0x163eb7(0x354)](_0x5e0273),_0x4df9f6=_0x566c83[_0x163eb7(0x356)][0x0]['headless'];_0x566c83[_0x163eb7(0x356)][0x0][_0x163eb7(0x262)]=!_0x4df9f6;const _0x93fad6=JSON['stringify'](_0x566c83,null,0x2);fs[_0x163eb7(0x35d)](_0x47478f,_0x93fad6),config=getConfiguration(),io['to'](_0x163eb7(0x317))[_0x163eb7(0x240)](_0x163eb7(0x2ba),config),broadcastToBots(_0x163eb7(0x2ba),JSON[_0x163eb7(0x1c3)](config));}}function validateTelegram(_0x18af15){const _0x5d715e=_0x59c681;if(_0x18af15[_0x5d715e(0x316)][_0x5d715e(0x358)]!=settings[_0x5d715e(0x29c)]&&'@'+_0x18af15[_0x5d715e(0x316)]['username']!=settings[_0x5d715e(0x29c)]||_0x18af15[_0x5d715e(0x219)]['id']!=settings['telegramChatId'])return sendTelegram(_0x18af15[_0x5d715e(0x219)]['id'],_0x5d715e(0x1da),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0xe89355=_0x59c681;tgBot&&(await tgBot[_0xe89355(0x2cf)](),await sleep(0x7d0));tgBot=new Telegraf(settings['telegramToken']);let _0x31a1f6='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x31a1f6+='\x0a',_0x31a1f6+=_0xe89355(0x1ac),_0x31a1f6+=_0xe89355(0x324),_0x31a1f6+=_0xe89355(0x38f),_0x31a1f6+=_0xe89355(0x1b9),_0x31a1f6+=_0xe89355(0x2a7),_0x31a1f6+=_0xe89355(0x18f),_0x31a1f6+=_0xe89355(0x380),_0x31a1f6+=_0xe89355(0x293),_0x31a1f6+=_0xe89355(0x323),_0x31a1f6+=_0xe89355(0x26d),_0x31a1f6+=_0xe89355(0x315),_0x31a1f6+=_0xe89355(0x2c8),_0x31a1f6+=_0xe89355(0x1ba),_0x31a1f6+=_0xe89355(0x269),_0x31a1f6+=_0xe89355(0x2cd),_0x31a1f6+=_0xe89355(0x24b);let _0x42ec5b=_0xe89355(0x35f);_0x42ec5b+='\x0a',_0x42ec5b+=_0x31a1f6,tgBot[_0xe89355(0x389)]((_0x312db4,_0x1c1642)=>{const _0x3c68d8=_0xe89355;logger[_0x3c68d8(0x2de)](getTimeStamp()+_0x3c68d8(0x357)),logger[_0x3c68d8(0x1d3)]('Telegraf\x20error:',_0x312db4);}),tgBot['use'](async(_0x5dd9c9,_0x4dce5d)=>{const _0xa11be1=_0xe89355;if(!(!settings[_0xa11be1(0x347)]&&_0x5dd9c9['update']['message']['text']==_0xa11be1(0x26c))){if(!validateTelegram(_0x5dd9c9))return;}_0x4dce5d();}),tgBot['command'](_0xe89355(0x2fb),async _0x2037df=>{const _0x46f741=_0xe89355;if(_0x2037df[_0x46f741(0x316)][_0x46f741(0x358)]==settings[_0x46f741(0x29c)]||'@'+_0x2037df['from'][_0x46f741(0x358)]==settings[_0x46f741(0x29c)]){if(!settings['telegramChatId'])updateSetting(_0x46f741(0x347),_0x2037df[_0x46f741(0x219)]['id']);}if(!validateTelegram(_0x2037df))return;updateSetting(_0x46f741(0x2ff),!![]),await sendTelegram(_0x2037df['chat']['id'],_0x42ec5b);}),tgBot[_0xe89355(0x212)]('enable',async _0x26e7b2=>{const _0x4cedd1=_0xe89355;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x26e7b2['chat']['id'],_0x4cedd1(0x367));}),tgBot['command'](_0xe89355(0x1a5),async _0x28a400=>{const _0x267a1c=_0xe89355;await sendTelegram(_0x28a400[_0x267a1c(0x219)]['id'],'Notifications\x20disabled'),updateSetting(_0x267a1c(0x2ff),![]);}),tgBot[_0xe89355(0x212)](_0xe89355(0x185),async _0x2246d1=>{const _0x435c5b=_0xe89355,_0xbbc6f4=Markup['inlineKeyboard']([Markup[_0x435c5b(0x313)][_0x435c5b(0x19a)](_0x435c5b(0x309),_0x435c5b(0x34b)),Markup[_0x435c5b(0x313)]['callback'](_0x435c5b(0x374),_0x435c5b(0x290)),Markup[_0x435c5b(0x313)][_0x435c5b(0x19a)]('All',_0x435c5b(0x24e))]);_0x2246d1[_0x435c5b(0x27e)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0xbbc6f4);}),tgBot[_0xe89355(0x2eb)](_0xe89355(0x34b),async _0xc9975c=>{const _0x2b0776=_0xe89355;_0xc9975c['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x2b0776(0x31e)),updateSetting(_0x2b0776(0x2ff),!![]),await sendTelegram(_0xc9975c[_0x2b0776(0x219)]['id'],_0x2b0776(0x341));}),tgBot[_0xe89355(0x2eb)](_0xe89355(0x290),async _0x33598c=>{const _0x5ee939=_0xe89355;_0x33598c[_0x5ee939(0x23c)](),updateSetting(_0x5ee939(0x1c0),_0x5ee939(0x369)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x33598c[_0x5ee939(0x219)]['id'],_0x5ee939(0x29e));}),tgBot[_0xe89355(0x2eb)](_0xe89355(0x24e),async _0x179bfa=>{const _0x2ed452=_0xe89355;_0x179bfa['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x2ed452(0x1f2)),updateSetting(_0x2ed452(0x2ff),!![]),await sendTelegram(_0x179bfa[_0x2ed452(0x219)]['id'],_0x2ed452(0x183));}),tgBot[_0xe89355(0x212)]('status',async _0x27768b=>{const _0x19837f=_0xe89355,_0x295332=getBotsWithMode();let _0x38437c=_0x19837f(0x238);config[_0x19837f(0x2a8)](_0x38673d=>{const _0x4e8b27=_0x19837f,_0x31eed1=_0x295332[_0x4e8b27(0x188)](_0x2d6aca=>_0x2d6aca['botID']==_0x38673d[_0x4e8b27(0x189)])['mode'];_0x38437c+=_0x4e8b27(0x372)+_0x38673d[_0x4e8b27(0x189)]+':\x20'+_0x38673d[_0x4e8b27(0x1fc)]+'\x20|\x20'+_0x31eed1+'\x20|\x20'+_0x38673d[_0x4e8b27(0x29f)]+'\x0a';}),_0x38437c+='\x0a',_0x38437c+=_0x19837f(0x1a7),_0x38437c+=!settings[_0x19837f(0x2ff)]?'Notifications\x20disabled\x0a':_0x19837f(0x38c),_0x38437c+=settings[_0x19837f(0x2ff)]?settings[_0x19837f(0x1c0)]==_0x19837f(0x1f2)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x19837f(0x34e)+settings['telegramEvents']+_0x19837f(0x1e5):'',await sendTelegram(_0x27768b[_0x19837f(0x219)]['id'],_0x38437c,{'parse_mode':_0x19837f(0x350)});}),tgBot[_0xe89355(0x212)](_0xe89355(0x314),async _0x1e1c8a=>{const _0x15ffe3=_0xe89355,_0x426549=getEnabledBots();if(_0x426549[_0x15ffe3(0x2a4)]==0x0)await sendTelegram(_0x1e1c8a[_0x15ffe3(0x219)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x426549[_0x15ffe3(0x2a4)]>0x1)_0x426549[_0x15ffe3(0x20a)]({'botID':_0x15ffe3(0x1f2)});let _0x57e28b=[],_0x154aff=[];const _0x520dab=_0x426549[_0x15ffe3(0x2a4)]%0x4==0x0||_0x426549[_0x15ffe3(0x2a4)]%0x4==0x3||_0x426549[_0x15ffe3(0x2a4)]%0x3==0x1?0x4:0x3;let _0x1cd18a=0x0;_0x426549[_0x15ffe3(0x2a8)]((_0x1962b0,_0x4f5f45)=>{const _0x178621=_0x15ffe3;if(_0x4f5f45%_0x520dab==0x0)_0x154aff=[];_0x154aff['push'](Markup[_0x178621(0x313)][_0x178621(0x19a)](_0x1962b0[_0x178621(0x189)]==_0x178621(0x1f2)?'All\x20bots':_0x178621(0x372)+_0x1962b0[_0x178621(0x189)],'restart_'+_0x1962b0['botID'])),_0x4f5f45%_0x520dab==0x0&&(_0x57e28b[_0x1cd18a]=_0x154aff,_0x1cd18a++);});const _0x45794f=Markup[_0x15ffe3(0x266)](_0x57e28b);_0x1e1c8a[_0x15ffe3(0x27e)](_0x15ffe3(0x195),_0x45794f);}}),tgBot[_0xe89355(0x2eb)](/restart_(.+)/,async _0xe072a6=>{const _0x41c1ad=_0xe89355,_0x252427=_0xe072a6[_0x41c1ad(0x289)][0x1];_0xe072a6[_0x41c1ad(0x23c)](),_0x252427==_0x41c1ad(0x1f2)?config[_0x41c1ad(0x2a8)](_0x41d13e=>{restartBot(_0x41d13e['botID']);}):restartBot(_0x252427);}),tgBot[_0xe89355(0x212)]('on',async _0x159002=>{const _0x5eb040=_0xe89355,_0x48d7d4=getDisabledBots();if(_0x48d7d4['length']==0x0)await sendTelegram(_0x159002[_0x5eb040(0x219)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x48d7d4[_0x5eb040(0x2a4)]>0x1)_0x48d7d4[_0x5eb040(0x20a)]({'botID':_0x5eb040(0x1f2)});let _0xfbc69a=[],_0x30ffb2=[];const _0x66e58d=_0x48d7d4[_0x5eb040(0x2a4)]%0x4==0x0||_0x48d7d4['length']%0x4==0x3||_0x48d7d4[_0x5eb040(0x2a4)]%0x3==0x1?0x4:0x3;let _0x686107=0x0;_0x48d7d4[_0x5eb040(0x2a8)]((_0x3addd9,_0x309c57)=>{const _0x3b1b76=_0x5eb040;if(_0x309c57%_0x66e58d==0x0)_0x30ffb2=[];_0x30ffb2[_0x3b1b76(0x20a)](Markup[_0x3b1b76(0x313)][_0x3b1b76(0x19a)](_0x3addd9[_0x3b1b76(0x189)]=='all'?_0x3b1b76(0x391):'Bot\x20'+_0x3addd9[_0x3b1b76(0x189)],_0x3b1b76(0x1b6)+_0x3addd9['botID'])),_0x309c57%_0x66e58d==0x0&&(_0xfbc69a[_0x686107]=_0x30ffb2,_0x686107++);});const _0x458a40=Markup['inlineKeyboard'](_0xfbc69a);_0x159002[_0x5eb040(0x27e)](_0x5eb040(0x355),_0x458a40);}}),tgBot[_0xe89355(0x2eb)](/on_(.+)/,async _0x2d0994=>{const _0x290e4a=_0xe89355,_0x55d68b=_0x2d0994['match'][0x1];_0x2d0994[_0x290e4a(0x23c)]();if(_0x55d68b==_0x290e4a(0x1f2)){const _0x3a593d=getDisabledBots();await sendTelegram(_0x2d0994[_0x290e4a(0x219)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x3a593d[_0x290e4a(0x2a8)](_0x54ea1b=>{const _0x41af29=_0x290e4a;if(_0x54ea1b['botID']!=_0x41af29(0x1f2))toggleBot(_0x54ea1b[_0x41af29(0x189)],toggleStatus(_0x54ea1b[_0x41af29(0x189)]),_0x41af29(0x1e9));});}else await sendTelegram(_0x2d0994['chat']['id'],_0x290e4a(0x2e7)+_0x55d68b),toggleBot(_0x55d68b,toggleStatus(_0x55d68b),_0x290e4a(0x1e9));}),tgBot[_0xe89355(0x212)]('off',async _0x272020=>{const _0x33332b=_0xe89355,_0x4d1d17=getEnabledBots();if(_0x4d1d17[_0x33332b(0x2a4)]==0x0)await sendTelegram(_0x272020[_0x33332b(0x219)]['id'],_0x33332b(0x1c9));else{if(_0x4d1d17['length']>0x1)_0x4d1d17[_0x33332b(0x20a)]({'botID':'all'});let _0x216a82=[],_0x1a1b58=[];const _0x57c8a9=_0x4d1d17[_0x33332b(0x2a4)]%0x4==0x0||_0x4d1d17[_0x33332b(0x2a4)]%0x4==0x3||_0x4d1d17[_0x33332b(0x2a4)]%0x3==0x1?0x4:0x3;let _0x5c568a=0x0;_0x4d1d17[_0x33332b(0x2a8)]((_0x2dbf82,_0x531026)=>{const _0x37bdc3=_0x33332b;if(_0x531026%_0x57c8a9==0x0)_0x1a1b58=[];_0x1a1b58['push'](Markup[_0x37bdc3(0x313)][_0x37bdc3(0x19a)](_0x2dbf82[_0x37bdc3(0x189)]==_0x37bdc3(0x1f2)?_0x37bdc3(0x391):'Bot\x20'+_0x2dbf82[_0x37bdc3(0x189)],_0x37bdc3(0x20c)+_0x2dbf82[_0x37bdc3(0x189)])),_0x531026%_0x57c8a9==0x0&&(_0x216a82[_0x5c568a]=_0x1a1b58,_0x5c568a++);});const _0x3325c0=Markup[_0x33332b(0x266)](_0x216a82);_0x272020['reply'](_0x33332b(0x1a2),_0x3325c0);}}),tgBot[_0xe89355(0x2eb)](/off_(.+)/,async _0x52af6f=>{const _0x34c375=_0xe89355,_0x49ee18=_0x52af6f['match'][0x1];_0x52af6f['editMessageReplyMarkup']();if(_0x49ee18==_0x34c375(0x1f2)){const _0x12733b=getEnabledBots();await sendTelegram(_0x52af6f[_0x34c375(0x219)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x12733b[_0x34c375(0x2a8)](_0x27735b=>{const _0x22ce74=_0x34c375;if(_0x27735b[_0x22ce74(0x189)]!='all')toggleBot(_0x27735b[_0x22ce74(0x189)],toggleStatus(_0x27735b[_0x22ce74(0x189)]),'stopped');});}else await sendTelegram(_0x52af6f[_0x34c375(0x219)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x49ee18),toggleBot(_0x49ee18,toggleStatus(_0x49ee18),'stopped');}),tgBot[_0xe89355(0x212)]('metrics',async _0x1ced23=>{const _0x43aa18=_0xe89355,_0x263104=getEnabledBots();if(_0x263104[_0x43aa18(0x2a4)]==0x0)await sendTelegram(_0x1ced23[_0x43aa18(0x219)]['id'],_0x43aa18(0x1c9));else{if(_0x263104[_0x43aa18(0x2a4)]>0x1){let _0x422e61=[],_0x8f73b1=[];const _0xe9a256=_0x263104['length']%0x4==0x0||_0x263104['length']%0x4==0x3||_0x263104[_0x43aa18(0x2a4)]%0x3==0x1?0x4:0x3;let _0x3ef194=0x0;_0x263104[_0x43aa18(0x2a8)]((_0x56c9df,_0x332bce)=>{const _0x14a85a=_0x43aa18;if(_0x332bce%_0xe9a256==0x0)_0x8f73b1=[];_0x8f73b1[_0x14a85a(0x20a)](Markup[_0x14a85a(0x313)][_0x14a85a(0x19a)](_0x14a85a(0x372)+_0x56c9df[_0x14a85a(0x189)],'metrics_'+_0x56c9df[_0x14a85a(0x189)])),_0x332bce%_0xe9a256==0x0&&(_0x422e61[_0x3ef194]=_0x8f73b1,_0x3ef194++);});const _0x2889c0=Markup[_0x43aa18(0x266)](_0x422e61);_0x1ced23['reply'](_0x43aa18(0x1e4),_0x2889c0);}else{const _0xe90190=_0x263104[0x0][_0x43aa18(0x189)];if(pid[_0xe90190])pid[_0xe90190][_0x43aa18(0x1b1)]({'function':_0x43aa18(0x279),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x56cdad=>{const _0x1f4c8b=_0xe89355,_0x13872c=_0x56cdad[_0x1f4c8b(0x289)][0x1];_0x56cdad['editMessageReplyMarkup']();if(pid[_0x13872c])pid[_0x13872c]['send']({'function':_0x1f4c8b(0x279),'args':null});}),tgBot['command'](_0xe89355(0x222),async _0x5d4d46=>{const _0x4b1352=_0xe89355,_0x5d596e=getEnabledBots();if(_0x5d596e[_0x4b1352(0x2a4)]==0x0)await sendTelegram(_0x5d4d46['chat']['id'],_0x4b1352(0x1c9));else{if(_0x5d596e[_0x4b1352(0x2a4)]>0x1){let _0x3dc0e0=[],_0xc72c90=[];const _0x6807b6=_0x5d596e[_0x4b1352(0x2a4)]%0x4==0x0||_0x5d596e[_0x4b1352(0x2a4)]%0x4==0x3||_0x5d596e[_0x4b1352(0x2a4)]%0x3==0x1?0x4:0x3;let _0x4bc2aa=0x0;_0x5d596e[_0x4b1352(0x2a8)]((_0x701a4c,_0x5bcc34)=>{const _0x5623a3=_0x4b1352;if(_0x5bcc34%_0x6807b6==0x0)_0xc72c90=[];_0xc72c90[_0x5623a3(0x20a)](Markup[_0x5623a3(0x313)][_0x5623a3(0x19a)]('Bot\x20'+_0x701a4c[_0x5623a3(0x189)],_0x5623a3(0x1a9)+_0x701a4c[_0x5623a3(0x189)])),_0x5bcc34%_0x6807b6==0x0&&(_0x3dc0e0[_0x4bc2aa]=_0xc72c90,_0x4bc2aa++);});const _0x2da8a2=Markup['inlineKeyboard'](_0x3dc0e0);_0x5d4d46[_0x4b1352(0x27e)](_0x4b1352(0x204),_0x2da8a2);}else{const _0x559952=_0x5d596e[0x0][_0x4b1352(0x189)];if(pid[_0x559952])pid[_0x559952]['send']({'function':_0x4b1352(0x2f3),'args':null});}}}),tgBot[_0xe89355(0x2eb)](/portfolio_(.+)/,async _0x297e40=>{const _0x2ee8aa=_0xe89355,_0xb2b792=_0x297e40[_0x2ee8aa(0x289)][0x1];_0x297e40['editMessageReplyMarkup']();if(pid[_0xb2b792])pid[_0xb2b792][_0x2ee8aa(0x1b1)]({'function':_0x2ee8aa(0x2f3),'args':null});}),tgBot[_0xe89355(0x212)]('logs',async _0x569312=>{const _0x20518f=_0xe89355,_0x10187f=_0x20518f(0x281);await zipFiles(_0x10187f);const _0x504288=zippath+(_0x10187f+_0x20518f(0x2af));_0x569312[_0x20518f(0x27d)]({'source':_0x504288})[_0x20518f(0x1d9)](()=>{})[_0x20518f(0x389)](_0x2ade05=>logger[_0x20518f(0x1d3)]('Error\x20sending\x20'+_0x10187f+'\x20files\x20over\x20Telegram:',_0x2ade05));}),tgBot['command']('backup',async _0x4f5531=>{const _0x3c21e9=_0xe89355,_0x5749dc=_0x3c21e9(0x343);await backupConfigFiles(),await zipFiles(_0x5749dc);const _0xab3398=zippath+(_0x5749dc+_0x3c21e9(0x2af));_0x4f5531[_0x3c21e9(0x27d)]({'source':_0xab3398})[_0x3c21e9(0x1d9)](()=>{})[_0x3c21e9(0x389)](_0x2abe2b=>logger[_0x3c21e9(0x1d3)](_0x3c21e9(0x25b)+_0x5749dc+'\x20files\x20over\x20Telegram:',_0x2abe2b));}),tgBot[_0xe89355(0x212)]('update',async _0x5d9aad=>{const _0x65c15d=_0xe89355;await getMessages();if(!updateAvailable)await sendTelegram(_0x5d9aad[_0x65c15d(0x219)]['id'],_0x65c15d(0x299));else{if(!validInstallation)await sendTelegram(_0x5d9aad['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x5248c7=Markup[_0x65c15d(0x266)]([Markup[_0x65c15d(0x313)][_0x65c15d(0x19a)]('Yes',_0x65c15d(0x280)),Markup[_0x65c15d(0x313)][_0x65c15d(0x19a)]('No',_0x65c15d(0x223))]);_0x5d9aad[_0x65c15d(0x27e)](_0x65c15d(0x24f),_0x5248c7);}}}),tgBot[_0xe89355(0x2eb)](/update_(.+)/,async _0x16b3c1=>{const _0x592fd3=_0xe89355,_0x458f68=_0x16b3c1[_0x592fd3(0x289)][0x1];_0x16b3c1['editMessageReplyMarkup'](),_0x458f68=='yes'&&(await sendTelegram(_0x16b3c1[_0x592fd3(0x219)]['id'],_0x592fd3(0x28d)),updateBB(_0x592fd3(0x1c1))),_0x458f68=='no'&&await sendTelegram(_0x16b3c1[_0x592fd3(0x219)]['id'],_0x592fd3(0x18d));}),tgBot[_0xe89355(0x212)](_0xe89355(0x2f9),async _0x5c1896=>{const _0x55563a=_0xe89355;if(!validInstallation)await sendTelegram(_0x5c1896[_0x55563a(0x219)]['id'],_0x55563a(0x336));else{const _0x35505b=Markup[_0x55563a(0x266)]([Markup[_0x55563a(0x313)]['callback']('Yes',_0x55563a(0x1e1)),Markup[_0x55563a(0x313)][_0x55563a(0x19a)]('No',_0x55563a(0x1ec))]);_0x5c1896[_0x55563a(0x27e)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x35505b);}}),tgBot['action'](/reinstall_(.+)/,async _0x1ed6e7=>{const _0x1358e9=_0xe89355,_0x1446ac=_0x1ed6e7['match'][0x1];_0x1ed6e7['editMessageReplyMarkup'](),_0x1446ac==_0x1358e9(0x2f7)&&(await sendTelegram(_0x1ed6e7[_0x1358e9(0x219)]['id'],_0x1358e9(0x26a)),updateBB(_0x1358e9(0x2f9))),_0x1446ac=='no'&&await sendTelegram(_0x1ed6e7[_0x1358e9(0x219)]['id'],_0x1358e9(0x19e));}),tgBot[_0xe89355(0x212)]('toggle',async _0x22be88=>{const _0x4ff731=_0xe89355,_0x2d7e35=getBotsWithMode();if(_0x2d7e35[_0x4ff731(0x2a4)]==0x0)await sendTelegram(_0x22be88[_0x4ff731(0x219)]['id'],_0x4ff731(0x1c9));else{let _0x47d695=[],_0x42c932=[];const _0x11d100=0x2;let _0x148d9e=0x0;_0x2d7e35[_0x4ff731(0x2a8)]((_0x5aa241,_0x297884)=>{const _0xd55f3b=_0x4ff731;if(_0x297884%_0x11d100==0x0)_0x42c932=[];_0x42c932['push'](Markup[_0xd55f3b(0x313)][_0xd55f3b(0x19a)](_0xd55f3b(0x372)+_0x5aa241[_0xd55f3b(0x189)]+'\x20('+_0x5aa241[_0xd55f3b(0x192)]+')',_0xd55f3b(0x21a)+_0x5aa241[_0xd55f3b(0x189)])),_0x297884%_0x11d100==0x0&&(_0x47d695[_0x148d9e]=_0x42c932,_0x148d9e++);});const _0xfded0e=Markup[_0x4ff731(0x266)](_0x47d695);_0x22be88['reply'](_0x4ff731(0x21c),_0xfded0e);}}),tgBot[_0xe89355(0x2eb)](/toggle_(.+)/,async _0x271d08=>{const _0x420e9f=_0xe89355,_0x8d8f24=_0x271d08['match'][0x1];_0x271d08[_0x420e9f(0x23c)]();const _0x3189f5=getBotsWithMode(),_0x9546cf=_0x3189f5['find'](_0x49e080=>_0x49e080[_0x420e9f(0x189)]==_0x8d8f24),_0x34ba25=_0x9546cf[_0x420e9f(0x192)]==_0x420e9f(0x33e)?_0x420e9f(0x396):_0x420e9f(0x33e);await sendTelegram(_0x271d08['chat']['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x8d8f24+_0x420e9f(0x39a)+_0x34ba25+'\x20mode'),toggleBotMode(_0x8d8f24);}),tgBot[_0xe89355(0x212)]('names',async _0x285229=>{const _0xbc84bb=_0xe89355;let _0x3b723a='';config['forEach'](_0x50a5c3=>{const _0x319e72=_0x1941;_0x3b723a+=_0x319e72(0x372)+_0x50a5c3[_0x319e72(0x189)]+':\x20'+_0x50a5c3[_0x319e72(0x226)]+'\x0a';}),await sendTelegram(_0x285229[_0xbc84bb(0x219)]['id'],_0x3b723a,{'parse_mode':'HTML'});}),tgBot[_0xe89355(0x212)](_0xe89355(0x351),async _0x4a8e40=>{const _0x969662=_0xe89355;await sendTelegram(_0x4a8e40[_0x969662(0x219)]['id'],_0x31a1f6);}),process[_0xe89355(0x1ea)](_0xe89355(0x32a),()=>tgBot[_0xe89355(0x2cf)]('SIGINT')),process[_0xe89355(0x1ea)]('SIGTERM',()=>tgBot[_0xe89355(0x2cf)]('SIGTERM')),tgBot[_0xe89355(0x2bc)]();}function disableTelegram(){const _0x53840a=_0x59c681;tgBot&&tgBot[_0x53840a(0x2cf)]();}async function sendTelegram(_0x2d8610,_0x5d21d5,_0x5a9db8){const _0x16ca3b=_0x59c681;_0x5a9db8={..._0x5a9db8,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0x16ca3b(0x278)](_0x2d8610,_0x5d21d5,_0x5a9db8);}catch(_0x217534){logger[_0x16ca3b(0x1d3)]('Telegram\x20error:',_0x217534);}}async function sendTelegramBot(_0x4c39a6,_0x4ac6d5){const _0x222a98=_0x59c681;if(settings['telegramEnabled']){if(settings[_0x222a98(0x1c0)]==_0x222a98(0x1f2)||(_0x4ac6d5[_0x222a98(0x20e)]==_0x222a98(0x187)||_0x4ac6d5[_0x222a98(0x20e)]==_0x222a98(0x320)||_0x4ac6d5[_0x222a98(0x20e)]=='success')&&settings[_0x222a98(0x1c0)]==_0x222a98(0x369)||_0x4ac6d5[_0x222a98(0x20e)]==_0x222a98(0x35b)&&settings['telegramEvents']==_0x222a98(0x31e)){if(tgBot&&settings[_0x222a98(0x347)]){if(_0x4ac6d5['showname'])await sendTelegram(settings[_0x222a98(0x347)],_0x4ac6d5['botname']+_0x222a98(0x2b4)+_0x4ac6d5[_0x222a98(0x267)]);else await sendTelegram(settings[_0x222a98(0x347)],_0x222a98(0x372)+_0x4c39a6+_0x222a98(0x2b4)+_0x4ac6d5[_0x222a98(0x267)]);}}}}async function sendTelegramMsg(_0x52851a,_0x356203=_0x59c681(0x350)){const _0x2aecc6=_0x59c681;return settings[_0x2aecc6(0x2ff)]&&tgBot&&settings[_0x2aecc6(0x347)]?(await sendTelegram(settings[_0x2aecc6(0x347)],_0x52851a,{'parse_mode':_0x356203}),!![]):![];}function getDeviceWithIp(_0x46bdfe){return devices['find'](_0xb7c34c=>_0xb7c34c['ip']===_0x46bdfe);}async function temporaryAccess2FA(_0x2c1463,_0x55543a){const _0x440517=_0x59c681;let _0x2a1d11=new Date(),_0x332f61=![];if(lastIpApproval){if(_0x2a1d11-lastIpApproval<0x1388)_0x332f61=!![];}lastIpApproval=new Date();if(_0x332f61)return;if(tgBot&&settings['telegramChatId']){const _0x52e140=uuidRandom();tmpStorage[_0x52e140]={'uuid':_0x2c1463,'externalip':_0x55543a};const _0x4704c6=Markup[_0x440517(0x266)]([Markup['button'][_0x440517(0x19a)](_0x440517(0x297),_0x440517(0x2c7)+_0x52e140),Markup[_0x440517(0x313)][_0x440517(0x19a)](_0x440517(0x28e),_0x440517(0x2e6)+_0x52e140),Markup[_0x440517(0x313)][_0x440517(0x19a)]('30\x20min',_0x440517(0x1e7)+_0x52e140),Markup[_0x440517(0x313)][_0x440517(0x19a)](_0x440517(0x2ed),_0x440517(0x250)+_0x52e140)]);await sendTelegram(settings[_0x440517(0x347)],_0x440517(0x306)+normalizeIP(_0x55543a)['show']+'\x20?',_0x4704c6),tgBot[_0x440517(0x2eb)](/tempaccess_(.+)_(.+)/,async _0xad0b7f=>{const _0x413a49=_0x440517,_0x542edf=_0xad0b7f['match'][0x1],_0x85250a=_0xad0b7f[_0x413a49(0x289)][0x2],{uuid:_0x28855c,externalip:_0x521a64}=tmpStorage[_0x85250a];delete tmpStorage[_0x85250a],_0xad0b7f['editMessageReplyMarkup'](),devices[_0x28855c][_0x413a49(0x21f)]={'clientip':_0x521a64,'timestamp':new Date()[_0x413a49(0x291)](),'expiry':_0x542edf},_0x542edf!=_0x413a49(0x2ed)?(await sendTelegram(_0xad0b7f[_0x413a49(0x219)]['id'],'Access\x20enabled\x20for\x20'+_0x542edf+_0x413a49(0x256),{'parse_mode':_0x413a49(0x350)}),io['to'](_0x28855c)[_0x413a49(0x240)](_0x413a49(0x1fc),{'access':{'allow':![],'reason':_0x413a49(0x27b),'token':null}})):(await sendTelegram(_0xad0b7f[_0x413a49(0x219)]['id'],_0x413a49(0x348)),io['to'](_0x28855c)[_0x413a49(0x240)]('status',{'access':{'allow':![],'reason':_0x413a49(0x397),'token':null}}));});}}async function loginAccess2FA(_0x4b1277,_0x330364){const _0x13c0c3=_0x59c681;if(tgBot&&settings[_0x13c0c3(0x347)]){const _0x385f2b=uuidRandom();tmpStorage[_0x385f2b]={'uuid':_0x4b1277,'externalip':_0x330364};const _0x4b7caa=Markup[_0x13c0c3(0x266)]([Markup[_0x13c0c3(0x313)][_0x13c0c3(0x19a)](_0x13c0c3(0x18b),_0x13c0c3(0x1cd)+loginExpiry+'_'+_0x385f2b),Markup[_0x13c0c3(0x313)][_0x13c0c3(0x19a)](_0x13c0c3(0x2ed),_0x13c0c3(0x2ac)+_0x385f2b)]);await sendTelegram(settings['telegramChatId'],_0x13c0c3(0x30f)+normalizeIP(_0x330364)[_0x13c0c3(0x241)]+'\x20?',_0x4b7caa),tgBot[_0x13c0c3(0x2eb)](/login2fa_(.+)_(.+)/,async _0x55ad48=>{const _0x4f8d5e=_0x13c0c3,_0x12b3bc=_0x55ad48[_0x4f8d5e(0x289)][0x1],_0x514fd8=_0x55ad48['match'][0x2],{uuid:_0x4e1320,externalip:_0x151fdc}=tmpStorage[_0x514fd8];delete tmpStorage[_0x514fd8],_0x55ad48['editMessageReplyMarkup'](),devices[_0x4e1320][_0x4f8d5e(0x303)]={'clientip':_0x151fdc,'timestamp':new Date()['getTime'](),'expiry':_0x12b3bc},_0x12b3bc!=_0x4f8d5e(0x2ed)?(await sendTelegram(_0x55ad48[_0x4f8d5e(0x219)]['id'],'Login\x20accepted',{'parse_mode':_0x4f8d5e(0x350)}),io['to'](_0x4e1320)['emit'](_0x4f8d5e(0x1fc),{'access':{'allow':![],'reason':_0x4f8d5e(0x27b),'token':null}})):(await sendTelegram(_0x55ad48[_0x4f8d5e(0x219)]['id'],_0x4f8d5e(0x2c9)),io['to'](_0x4e1320)[_0x4f8d5e(0x240)](_0x4f8d5e(0x1fc),{'access':{'allow':![],'reason':_0x4f8d5e(0x19b),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x465c78=_0x59c681;return dbConfig[_0x465c78(0x301)]('bots')['sortBy']('botID')[_0x465c78(0x1df)]({'status':_0x465c78(0x2f0)})[_0x465c78(0x22d)]()||[];}function getDisabledBots(){const _0x2b1151=_0x59c681;return dbConfig[_0x2b1151(0x301)](_0x2b1151(0x2ba))[_0x2b1151(0x1a8)](_0x2b1151(0x189))[_0x2b1151(0x1df)]({'status':_0x2b1151(0x26b)})[_0x2b1151(0x22d)]()||[];}function getBotAttributes(_0x3de711){const _0x1997e6=_0x59c681;let _0x11891c={};const _0x1080aa=configpath+_0x1997e6(0x38b)+_0x3de711+'-config.json',_0x213b54=fs[_0x1997e6(0x244)](_0x1080aa);if(_0x213b54){const _0x18f7c8=fs['readFileSync'](_0x1080aa);try{const _0x3df6ff=JSON[_0x1997e6(0x354)](_0x18f7c8),_0x1c3856=_0x3df6ff?_0x3df6ff[_0x1997e6(0x356)][0x0][_0x1997e6(0x262)]:![];_0x11891c[_0x1997e6(0x192)]=_0x1c3856?_0x1997e6(0x33e):_0x1997e6(0x396),_0x11891c['botname']=_0x3df6ff?_0x3df6ff['bot'][0x0][_0x1997e6(0x226)]:_0x1997e6(0x372)+_0x3de711;}catch(_0x59abf2){_0x11891c[_0x1997e6(0x192)]='manual',_0x11891c[_0x1997e6(0x226)]=_0x1997e6(0x372)+_0x3de711;}}else _0x11891c[_0x1997e6(0x192)]='manual',_0x11891c[_0x1997e6(0x226)]=_0x1997e6(0x372)+_0x3de711;return _0x11891c;}function getBotsWithMode(){const _0x42771d=_0x59c681,_0x2bbd4c=dbConfig[_0x42771d(0x301)]('bots')[_0x42771d(0x1a8)](_0x42771d(0x189))[_0x42771d(0x22d)]()||[];return _0x2bbd4c['forEach'](_0x573391=>{const _0xe5416d=_0x42771d;let _0x5d893c=getBotAttributes(_0x573391['botID']);_0x573391[_0xe5416d(0x192)]=_0x5d893c['mode'];}),_0x2bbd4c;}function getBotExchanges(){const _0x40df0e=_0x59c681;let _0x414b9a=[];const _0x268a6e=dbConfig[_0x40df0e(0x301)](_0x40df0e(0x2ba))['sortBy'](_0x40df0e(0x189))[_0x40df0e(0x22d)]()||[];_0x268a6e[_0x40df0e(0x2a8)](_0x55386a=>{const _0x356beb=_0x40df0e;if(_0x55386a[_0x356beb(0x1fc)]==_0x356beb(0x2f0)){const _0x5eb78a=configpath+_0x356beb(0x38b)+_0x55386a[_0x356beb(0x189)]+_0x356beb(0x2fd),_0x4b8c0c=fs[_0x356beb(0x244)](_0x5eb78a);let _0x325ea8;if(_0x4b8c0c){const _0x16996c=fs[_0x356beb(0x199)](_0x5eb78a);try{const _0x559881=JSON['parse'](_0x16996c);_0x325ea8=_0x559881?_0x559881[_0x356beb(0x356)][0x0][_0x356beb(0x20f)]:null;}catch(_0x2b0bd1){}}if(_0x325ea8)_0x414b9a[_0x356beb(0x20a)](_0x325ea8);}});const _0x15635e=[...new Set(_0x414b9a)][_0x40df0e(0x17b)]();return _0x15635e;}async function initUser(){const _0x392398=_0x59c681;if(!settings[_0x392398(0x2d4)]){const _0x116c34=uuidRandom();mixpanel[_0x392398(0x37e)](_0x116c34),updateSetting('userid',_0x116c34);}}async function initSecure(){const _0x6effc8=_0x59c681;let _0x4143e4=getSecure();if(!_0x4143e4[_0x6effc8(0x1f6)]('secret')){let _0x53ddc0=await generateKeys();_0x4143e4[_0x6effc8(0x305)]=_0x53ddc0[_0x6effc8(0x305)],_0x4143e4['privateKey']=_0x53ddc0[_0x6effc8(0x338)],_0x4143e4[_0x6effc8(0x364)]=crypto[_0x6effc8(0x1b8)](0x20)[_0x6effc8(0x22a)](_0x6effc8(0x382));;storeSecure(_0x4143e4);}}function getSettings(){const _0x42e44c=_0x59c681;return dbSettings[_0x42e44c(0x301)](_0x42e44c(0x21d))[_0x42e44c(0x22d)]()||{};}function getSecure(){const _0x34ae5a=_0x59c681;return dbSecure[_0x34ae5a(0x301)](_0x34ae5a(0x270))[_0x34ae5a(0x22d)]()||{};}function getBlacklist(){const _0x5b02b9=_0x59c681;return dbSecure[_0x5b02b9(0x301)](_0x5b02b9(0x34f))[_0x5b02b9(0x22d)]()||[];}function broadcastToBots(_0x5e66e0,_0x4bab28){config['forEach'](_0x592626=>{const _0x36a05c=_0x1941;if(_0x592626['status']==_0x36a05c(0x2f0)&&_0x592626[_0x36a05c(0x29f)]=='running'||_0x592626[_0x36a05c(0x1fc)]==_0x36a05c(0x36f)&&_0x592626[_0x36a05c(0x29f)]==_0x36a05c(0x274)){if(pid[_0x592626[_0x36a05c(0x189)]])pid[_0x592626[_0x36a05c(0x189)]][_0x36a05c(0x1b1)]({[_0x5e66e0]:_0x4bab28});}});}async function storeSettings(_0x8f6cc,_0x5b00e8=![]){const _0x34726a=_0x59c681;_0x8f6cc={...settings,..._0x8f6cc};if(_0x5b00e8&&_0x8f6cc[_0x34726a(0x257)]!='************'&&_0x8f6cc[_0x34726a(0x257)]!='***'&&_0x8f6cc[_0x34726a(0x257)]!=''){const _0x3232c8=decryptRSA(secure[_0x34726a(0x338)],_0x8f6cc[_0x34726a(0x257)])[_0x34726a(0x1e8)]('|@|')[0x0],_0x33ae81=bcrypt['hashSync'](_0x3232c8,saltRounds);_0x8f6cc={..._0x8f6cc,'bbPassword':_0x33ae81};}if(_0x5b00e8&&_0x8f6cc[_0x34726a(0x2c0)]!=_0x34726a(0x1cf)&&_0x8f6cc[_0x34726a(0x2c0)]!=_0x34726a(0x23f)&&_0x8f6cc['telegramToken']!=''){const _0x21ba91=decryptRSA(secure[_0x34726a(0x338)],_0x8f6cc[_0x34726a(0x2c0)])[_0x34726a(0x1e8)](_0x34726a(0x1c2))[0x0];_0x8f6cc={..._0x8f6cc,'telegramToken':_0x21ba91};}if(_0x5b00e8&&_0x8f6cc[_0x34726a(0x337)]!=_0x34726a(0x1cf)&&_0x8f6cc[_0x34726a(0x337)]!='***'&&_0x8f6cc[_0x34726a(0x337)]!=''){const _0x53b6d2=decryptRSA(secure[_0x34726a(0x338)],_0x8f6cc[_0x34726a(0x337)])[_0x34726a(0x1e8)]('|@|')[0x0];_0x8f6cc={..._0x8f6cc,'marketcapApi':_0x53b6d2};}const _0x1f7cb8=_0x8f6cc[_0x34726a(0x2c0)]!=_0x34726a(0x1cf)&&_0x8f6cc[_0x34726a(0x2c0)]!=settings[_0x34726a(0x2c0)]||_0x8f6cc[_0x34726a(0x29c)]!=settings['telegramUsername'],_0x43dc24=_0x8f6cc[_0x34726a(0x2c0)]==''||_0x8f6cc[_0x34726a(0x29c)]=='',_0x4b2e87=_0x8f6cc[_0x34726a(0x337)]&&_0x8f6cc['marketcapApi']!='************'&&_0x8f6cc[_0x34726a(0x337)]!=settings[_0x34726a(0x2c0)];_0x1f7cb8&&(_0x8f6cc[_0x34726a(0x347)]=null,_0x8f6cc[_0x34726a(0x1c0)]=_0x34726a(0x1f2));for(const [_0x317c77,_0x17baf6]of Object[_0x34726a(0x1f8)](_0x8f6cc)){if(_0x317c77==_0x34726a(0x2c0)&&_0x17baf6==_0x34726a(0x1cf)){_0x8f6cc[_0x34726a(0x2c0)]=settings[_0x34726a(0x2c0)];continue;};if(_0x317c77==_0x34726a(0x257)&&_0x17baf6=='************'){_0x8f6cc[_0x34726a(0x257)]=settings[_0x34726a(0x257)];continue;};if(_0x317c77=='marketcapApi'&&_0x17baf6=='************'){_0x8f6cc[_0x34726a(0x337)]=settings[_0x34726a(0x337)];continue;};dbSettings[_0x34726a(0x232)](_0x34726a(0x2b5)+_0x317c77,_0x17baf6)[_0x34726a(0x193)]();}settings=_0x8f6cc,io['to']('botmanager')['emit'](_0x34726a(0x21d),cleanSettings()),broadcastToBots('timeshift',settings['timeshift']),broadcastToBots('onepagemode',settings[_0x34726a(0x202)]),broadcastToBots(_0x34726a(0x337),settings['marketcapApi']);if(_0x1f7cb8&&!_0x43dc24)initTelegram();if(_0x1f7cb8&&_0x43dc24)disableTelegram();getAllClients()[_0x34726a(0x2a8)](_0x4a4bac=>{const _0x4b6719=_0x34726a;getSocket(_0x4a4bac['id'])[_0x4b6719(0x240)]('status',{'access':{'allow':![],'reason':_0x4b6719(0x27b),'token':null}});}),_0x4b2e87&&(await sleep(0xbb8),testMarketcapApi(_0x8f6cc[_0x34726a(0x337)]));}async function testMarketcapApi(_0x5909ed){const _0x5add1b=_0x59c681,_0x33966c=[_0x5add1b(0x37f),_0x5add1b(0x1ee)];try{await axios[_0x5add1b(0x301)](_0x5add1b(0x2a3),{'headers':{'X-CMC_PRO_API_KEY':_0x5909ed},'params':{'symbol':_0x33966c[_0x5add1b(0x22a)]()}});}catch(_0x3a9e6c){_0x3a9e6c[_0x5add1b(0x22a)]()[_0x5add1b(0x1e6)](_0x5add1b(0x35a))?(io['to'](_0x5add1b(0x317))[_0x5add1b(0x240)](_0x5add1b(0x23d),_0x5add1b(0x2a6)),logger['full'](_0x5add1b(0x2a6))):(io['to'](_0x5add1b(0x317))['emit'](_0x5add1b(0x23d),_0x5add1b(0x335)),logger[_0x5add1b(0x312)](_0x5add1b(0x335)),logger['debug'](_0x5add1b(0x38d),_0x3a9e6c[_0x5add1b(0x22a)]()+_0x5add1b(0x28f)+_0x3a9e6c['code']));return;}logger[_0x5add1b(0x1d3)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x9d45a4,_0x749353){const _0x330269=_0x59c681;dbSettings['set']('settings.'+_0x9d45a4,_0x749353)[_0x330269(0x193)](),settings=getSettings(),io['to'](_0x330269(0x317))[_0x330269(0x240)]('settings',cleanSettings());}function storeSecure(_0x483aeb){const _0x3b5c2a=_0x59c681;dbSecure[_0x3b5c2a(0x301)](_0x3b5c2a(0x270))[_0x3b5c2a(0x20a)](_0x483aeb)['write'](),secure=_0x483aeb;}function addBlacklist(_0x33d301){const _0x2cc06b=_0x59c681;cleanBlacklist();let _0x2f3102;devices[_0x33d301]['telegramIpApproval']?_0x2f3102=Math['max'](devices[_0x33d301][_0x2cc06b(0x21f)]['expiry'],loginExpiry):_0x2f3102=loginExpiry,dbSecure[_0x2cc06b(0x301)](_0x2cc06b(0x34f))[_0x2cc06b(0x20a)]({'expiry':new Date()[_0x2cc06b(0x291)]()+_0x2f3102*0x3c*0x3e8,'token':devices[_0x33d301][_0x2cc06b(0x21e)][_0x2cc06b(0x224)]})['write'](),blacklist=dbSecure[_0x2cc06b(0x301)](_0x2cc06b(0x34f))['value']();}function cleanBlacklist(){const _0x4272df=_0x59c681;let _0x570484=dbSecure[_0x4272df(0x301)]('blacklist')['cloneDeep']()['value'](),_0x423cb6=new Date()[_0x4272df(0x291)]();_0x570484['forEach'](_0x31e033=>{const _0x49a0cc=_0x4272df;_0x31e033[_0x49a0cc(0x284)]<_0x423cb6&&dbSecure[_0x49a0cc(0x301)](_0x49a0cc(0x34f))[_0x49a0cc(0x366)]({'expiry':_0x31e033[_0x49a0cc(0x284)]})['write']();});}function initStates(){const _0x116acc=_0x59c681;let _0x45ba7d=getConfiguration();_0x45ba7d[_0x116acc(0x2a8)](_0x1beaed=>{const _0xb0fc56=_0x116acc;_0x1beaed['live']=_0xb0fc56(0x1e9);}),storeConfiguration(_0x45ba7d);}async function generateKeys(){const _0x5b3308=_0x59c681,_0x1786ea=forge[_0x5b3308(0x392)]['rsa'][_0x5b3308(0x208)]({'bits':0x1000,'e':0x10001}),_0x62ef6c=forge[_0x5b3308(0x392)][_0x5b3308(0x2df)](_0x1786ea[_0x5b3308(0x338)]),_0x136332=forge[_0x5b3308(0x392)][_0x5b3308(0x2f4)](_0x1786ea['publicKey']);return{'privateKey':_0x62ef6c,'publicKey':_0x136332};}async function oneTimeMigration(){const _0x132236=_0x59c681;let _0xc87156=getSettings(),_0x1ab3c0=![];!_0xc87156[_0x132236(0x1f6)]('lastmsgtelegram')&&(_0xc87156[_0x132236(0x360)]=0x0,_0x1ab3c0=!![]);!_0xc87156['hasOwnProperty']('lastmsgemitted')&&(_0xc87156[_0x132236(0x32c)]=0x0,_0x1ab3c0=!![]);!_0xc87156[_0x132236(0x1f6)](_0x132236(0x36b))&&(_0xc87156[_0x132236(0x36b)]='0.0.0',_0x1ab3c0=!![]);!_0xc87156['hasOwnProperty']('onepagemode')&&(_0xc87156[_0x132236(0x202)]=![],_0x1ab3c0=!![]);!_0xc87156[_0x132236(0x1f6)](_0x132236(0x337))&&(_0xc87156[_0x132236(0x337)]='',_0x1ab3c0=!![]);if(_0x1ab3c0)storeSettings(_0xc87156);try{fs[_0x132236(0x260)](configbackuppath,{'withFileTypes':!![]})[_0x132236(0x2a8)](_0x583544=>{const _0x384076=_0x132236;if(!_0x583544['isDirectory']()){if(!_0x583544[_0x384076(0x38e)][_0x384076(0x298)]('backup-full@'))fs[_0x384076(0x181)](configbackuppath+_0x583544[_0x384076(0x38e)]);}else fs[_0x384076(0x1c6)](configbackuppath+_0x583544['name'],{'recursive':!![]});});}catch(_0x277547){logger['debug'](_0x132236(0x2d9),_0x277547);}}function storeConfiguration(_0x5eae87){const _0x5aa271=_0x59c681;dbConfig[_0x5aa271(0x301)]('bots')['remove']()['write'](),dbConfig[_0x5aa271(0x301)]('bots')[_0x5aa271(0x20a)](..._0x5eae87)[_0x5aa271(0x193)](),config=_0x5eae87;}async function resetPassword(){const _0x5b4c43=_0x59c681;if(tgBot&&settings['telegramChatId']){const _0x3b7a69=Markup[_0x5b4c43(0x266)]([Markup['button'][_0x5b4c43(0x19a)](_0x5b4c43(0x2f7),'resetpw_yes'),Markup[_0x5b4c43(0x313)][_0x5b4c43(0x19a)]('no',_0x5b4c43(0x38a))]);await sendTelegram(settings[_0x5b4c43(0x347)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x3b7a69),tgBot[_0x5b4c43(0x2eb)](/resetpw_(.+)/,async _0x1f3465=>{const _0x2c9ba9=_0x5b4c43,_0x56f9fb=_0x1f3465['match'][0x1];_0x1f3465[_0x2c9ba9(0x23c)]();if(_0x56f9fb!='no'){const _0x177007=0xf,_0x2eac07=_0x2c9ba9(0x304),_0x55255b=Array[_0x2c9ba9(0x316)](crypto['randomFillSync'](new Uint32Array(_0x177007)))[_0x2c9ba9(0x2b6)](_0x32eb4e=>_0x2eac07[_0x32eb4e%_0x2eac07[_0x2c9ba9(0x2a4)]])['join'](''),_0x5cca36=bcrypt[_0x2c9ba9(0x1ae)](_0x55255b,saltRounds);storeSettings({'bbPassword':_0x5cca36}),await sendTelegram(_0x1f3465[_0x2c9ba9(0x219)]['id'],_0x2c9ba9(0x236)+_0x55255b,{'parse_mode':'HTML'});}else await sendTelegram(_0x1f3465['chat']['id'],_0x2c9ba9(0x326));});}}async function confirmRestore(_0x1316bc,_0x117e17){const _0x3d74b7=_0x59c681;io['to'](_0x3d74b7(0x317))[_0x3d74b7(0x240)](_0x3d74b7(0x23d),_0x3d74b7(0x2f1),'success');if(tgBot&&settings[_0x3d74b7(0x347)]){const _0x159109=uuidRandom();tmpStorage[_0x159109]={'path':_0x1316bc,'filename':_0x117e17};const _0x303d69=Markup[_0x3d74b7(0x266)]([Markup[_0x3d74b7(0x313)][_0x3d74b7(0x19a)](_0x3d74b7(0x2f7),_0x3d74b7(0x2a1)+_0x159109),Markup[_0x3d74b7(0x313)]['callback']('no',_0x3d74b7(0x33b)+_0x159109)]);await sendTelegram(settings[_0x3d74b7(0x347)],_0x3d74b7(0x2a0),_0x303d69),tgBot[_0x3d74b7(0x2eb)](/restore_(.+)_(.+)/,async _0x39be9f=>{const _0x4790a3=_0x3d74b7,_0x839f39=_0x39be9f[_0x4790a3(0x289)][0x1],_0x51a44a=_0x39be9f[_0x4790a3(0x289)][0x2],{path:_0x1a61a7,filename:_0x353340}=tmpStorage[_0x51a44a];delete tmpStorage[_0x51a44a],_0x39be9f[_0x4790a3(0x23c)](),_0x839f39=='yes'?(logger['debug']('Restore\x20process\x20confirmed'),await sendTelegram(_0x39be9f[_0x4790a3(0x219)]['id'],_0x4790a3(0x2ca),{'parse_mode':_0x4790a3(0x350)}),unzipFile(_0x1a61a7,_0x353340)):(logger[_0x4790a3(0x1d3)]('Restore\x20process\x20aborted'),await sendTelegram(_0x39be9f[_0x4790a3(0x219)]['id'],_0x4790a3(0x1d0)));});}}function getServerTime(){const _0xcc4dfc=_0x59c681,_0xc963fe=new Date();return _0xc963fe[_0xcc4dfc(0x261)]()+'/'+(_0xc963fe[_0xcc4dfc(0x215)]()+0x1)[_0xcc4dfc(0x22a)]()['padStart'](0x2,'0')+'/'+_0xc963fe['getDate']()[_0xcc4dfc(0x22a)]()[_0xcc4dfc(0x365)](0x2,'0')+'\x20'+_0xc963fe[_0xcc4dfc(0x373)]()[_0xcc4dfc(0x22a)]()[_0xcc4dfc(0x365)](0x2,'0')+':'+_0xc963fe['getMinutes']()[_0xcc4dfc(0x22a)]()['padStart'](0x2,'0')+':'+_0xc963fe[_0xcc4dfc(0x2b0)]()['toString']()[_0xcc4dfc(0x365)](0x2,'0');}function getTimeStamp(){const _0x788f8a=_0x59c681,_0x410108=shiftedTime();return _0x410108[_0x788f8a(0x261)]()+'/'+(_0x410108[_0x788f8a(0x215)]()+0x1)['toString']()[_0x788f8a(0x365)](0x2,'0')+'/'+_0x410108[_0x788f8a(0x209)]()['toString']()[_0x788f8a(0x365)](0x2,'0')+'\x20'+_0x410108['getHours']()['toString']()[_0x788f8a(0x365)](0x2,'0')+':'+_0x410108[_0x788f8a(0x30b)]()[_0x788f8a(0x22a)]()[_0x788f8a(0x365)](0x2,'0')+':'+_0x410108[_0x788f8a(0x2b0)]()[_0x788f8a(0x22a)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x3c0df5=_0x59c681,_0x4b3b24=shiftedTime();return _0x4b3b24[_0x3c0df5(0x261)]()+(_0x4b3b24[_0x3c0df5(0x215)]()+0x1)['toString']()[_0x3c0df5(0x365)](0x2,'0')+_0x4b3b24[_0x3c0df5(0x209)]()[_0x3c0df5(0x22a)]()['padStart'](0x2,'0')+'-'+_0x4b3b24[_0x3c0df5(0x373)]()['toString']()['padStart'](0x2,'0')+_0x4b3b24[_0x3c0df5(0x30b)]()['toString']()['padStart'](0x2,'0')+_0x4b3b24[_0x3c0df5(0x2b0)]()['toString']()[_0x3c0df5(0x365)](0x2,'0');}function shiftedTime(){const _0x43c484=_0x59c681,_0x1d364d=new Date();let _0x4e750c=_0x1d364d;if(settings[_0x43c484(0x205)]&&settings[_0x43c484(0x205)]!==0x0)_0x4e750c=fns['add'](_0x1d364d,{'hours':settings[_0x43c484(0x205)]});return _0x4e750c;}async function startScheduler(){const _0x433c28=_0x59c681,_0x4bc184=new Date()['getUTCHours'](),_0x1cbb59=shiftedTime()[_0x433c28(0x373)]();_0x1cbb59==0x4&&backupConfigFiles(),_0x1cbb59==0x0&&(rotateLogFiles(),logger[_0x433c28(0x1d3)]('--------------------------------------'),logger[_0x433c28(0x1d3)](_0x433c28(0x1d1)+serverversion+'#RES#\x20'+(environment==_0x433c28(0x1be)?_0x433c28(0x28c):'')),logger[_0x433c28(0x1d3)](_0x433c28(0x26e))),_0x4bc184%0x6==0x0&&triggerAnalytics(),_0x4bc184%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x345ac0){const _0x3824bb=_0x59c681;logger['debug'](_0x3824bb(0x2e3)+_0x345ac0);const _0x5ca4ae=getBotsWithMode();_0x5ca4ae['length']>0x0?confirmRestore(configbackuppath,_0x345ac0):unzipFile(configbackuppath,_0x345ac0);}async function getBackupFiles(_0x5e117f=null){const _0x41beda=_0x59c681;let _0x23a603=[],_0x16a639=fs[_0x41beda(0x260)](configbackuppath,{'withFileTypes':!![]});_0x16a639[_0x41beda(0x17b)]((_0x1a0ef4,_0x1ccd7c)=>_0x1a0ef4[_0x41beda(0x38e)]<_0x1ccd7c[_0x41beda(0x38e)]?0x1:_0x1ccd7c[_0x41beda(0x38e)]<_0x1a0ef4['name']?-0x1:0x0),_0x16a639[_0x41beda(0x2a8)](_0x31946f=>{const _0x2bb18a=_0x41beda;if(!_0x31946f[_0x2bb18a(0x2e9)]()&&_0x31946f['name'][_0x2bb18a(0x298)]('backup-full@')&&_0x31946f[_0x2bb18a(0x38e)][_0x2bb18a(0x1bf)](_0x2bb18a(0x2af))){const _0x28304a=formatDate(fs[_0x2bb18a(0x359)](configbackuppath+_0x31946f[_0x2bb18a(0x38e)])[_0x2bb18a(0x21b)]);_0x23a603[_0x2bb18a(0x20a)]({'name':_0x31946f[_0x2bb18a(0x38e)],'mtime':_0x28304a});}});if(_0x5e117f)io['to'](_0x5e117f)[_0x41beda(0x240)](_0x41beda(0x1d2),_0x23a603);else return _0x23a603;}async function backupConfigFiles(){const _0x39f342=_0x59c681;await zipFiles(_0x39f342(0x18c));const _0x5a19be=getCleanTimeStamp();fs[_0x39f342(0x35c)](zippath+_0x39f342(0x32f),configbackuppath+('backup-full@'+_0x5a19be+_0x39f342(0x2af)));let _0x1b40e4=fs[_0x39f342(0x260)](configbackuppath,{'withFileTypes':!![]});_0x1b40e4[_0x39f342(0x17b)]((_0x1f605c,_0x2ce1e1)=>_0x1f605c[_0x39f342(0x38e)]<_0x2ce1e1[_0x39f342(0x38e)]?0x1:_0x2ce1e1[_0x39f342(0x38e)]<_0x1f605c[_0x39f342(0x38e)]?-0x1:0x0),_0x1b40e4[_0x39f342(0x2a4)]>maxBackups&&fs[_0x39f342(0x181)](configbackuppath+_0x1b40e4[_0x1b40e4[_0x39f342(0x2a4)]-0x1][_0x39f342(0x38e)]);}function rotateLogFiles(){const _0x54ccc0=_0x59c681,_0x434a6e=fs[_0x54ccc0(0x359)](logspath+_0x54ccc0(0x263)),_0x5c3768=_0x434a6e[_0x54ccc0(0x1f0)]/0x400;if(_0x5c3768>0x64){let _0x554523=fs[_0x54ccc0(0x260)](logspath,{'withFileTypes':!![]});_0x554523[_0x54ccc0(0x17b)]((_0x308bd8,_0x4f4216)=>_0x308bd8[_0x54ccc0(0x38e)]<_0x4f4216[_0x54ccc0(0x38e)]?0x1:_0x4f4216[_0x54ccc0(0x38e)]<_0x308bd8['name']?-0x1:0x0),_0x554523[_0x54ccc0(0x2a8)](_0x5ab37e=>{const _0x17460c=_0x54ccc0;if(_0x5ab37e[_0x17460c(0x38e)]==_0x17460c(0x33a))fs[_0x17460c(0x35c)](logspath+_0x5ab37e[_0x17460c(0x38e)],logspath+'output-003.log');if(_0x5ab37e[_0x17460c(0x38e)]=='output-001.log')fs[_0x17460c(0x35c)](logspath+_0x5ab37e['name'],logspath+_0x17460c(0x33a));_0x5ab37e[_0x17460c(0x38e)]==_0x17460c(0x263)&&(fs[_0x17460c(0x35c)](logspath+_0x5ab37e['name'],logspath+'output-001.log'),fs[_0x17460c(0x35d)](logspath+_0x5ab37e[_0x17460c(0x38e)],''));});}}function _0x1941(_0x37c1bc,_0x413be1){const _0x2d2f49=_0x4b58();return _0x1941=function(_0x2cf04d,_0x5ebdf7){_0x2cf04d=_0x2cf04d-0x17b;let _0x4b586b=_0x2d2f49[_0x2cf04d];return _0x4b586b;},_0x1941(_0x37c1bc,_0x413be1);}async function zipFiles(_0x324313){const _0x39f3db=_0x59c681;let _0x3087cf;if(_0x324313=='logs')_0x3087cf=logspath;if(_0x324313=='backup')_0x3087cf=configpath;if(_0x324313==_0x39f3db(0x18c))_0x3087cf=configpath;let _0x43f9ce=fs[_0x39f3db(0x260)](_0x3087cf,{'withFileTypes':!![]});const _0x3eae65=new JSZip();_0x43f9ce['forEach'](_0x5c23e5=>{const _0x436cec=_0x39f3db;if(!_0x5c23e5['isDirectory']()){let _0x123607=fs['readFileSync'](_0x3087cf+_0x5c23e5['name']);if(_0x324313=='backup'){const _0x1c8192=/^bot-[0-9]{3}-config.json$/,_0x185243=_0x1c8192[_0x436cec(0x283)](_0x5c23e5[_0x436cec(0x38e)]);if(_0x185243){const _0x3dd6d7=JSON[_0x436cec(0x354)](_0x123607);if(_0x3dd6d7[_0x436cec(0x356)][0x0]){_0x3dd6d7[_0x436cec(0x356)][0x0]['apiKey']=_0x436cec(0x23f),_0x3dd6d7['bot'][0x0][_0x436cec(0x1a0)]='***';if(_0x3dd6d7[_0x436cec(0x356)][0x0][_0x436cec(0x22f)])_0x3dd6d7[_0x436cec(0x356)][0x0][_0x436cec(0x22f)]=_0x436cec(0x23f);}_0x123607=JSON[_0x436cec(0x1c3)](_0x3dd6d7,null,0x2);}if(_0x5c23e5['name']=='bb-settings.json'){const _0x44b958=JSON[_0x436cec(0x354)](_0x123607);if(_0x44b958[_0x436cec(0x21d)]['loginRequired'])_0x44b958[_0x436cec(0x21d)][_0x436cec(0x371)]=![];if(_0x44b958[_0x436cec(0x21d)][_0x436cec(0x257)])_0x44b958[_0x436cec(0x21d)][_0x436cec(0x257)]=_0x436cec(0x23f);if(_0x44b958[_0x436cec(0x21d)]['telegramToken'])_0x44b958['settings'][_0x436cec(0x2c0)]=_0x436cec(0x23f);if(_0x44b958[_0x436cec(0x21d)]['telegramChatId'])_0x44b958['settings'][_0x436cec(0x347)]=null;if(_0x44b958[_0x436cec(0x21d)]['marketcapApi'])_0x44b958['settings'][_0x436cec(0x337)]='***';_0x123607=JSON[_0x436cec(0x1c3)](_0x44b958,null,0x2);}if(_0x5c23e5['name']!=_0x436cec(0x198))_0x3eae65[_0x436cec(0x361)](_0x5c23e5['name'],_0x123607);}else _0x3eae65[_0x436cec(0x361)](_0x5c23e5[_0x436cec(0x38e)],_0x123607);}});const _0x524fab=await _0x3eae65['generateAsync']({'type':_0x39f3db(0x296),'base64':![],'compression':_0x39f3db(0x319)});fs['writeFileSync'](zippath+(_0x324313+_0x39f3db(0x2af)),_0x524fab,_0x39f3db(0x1b3));}async function unzipFile(_0x4ea126,_0x2f46ee){const _0x2bc933=_0x59c681;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x2bc933(0x2a8)](_0x36b20e=>{const _0x45afac=_0x2bc933;if(!_0x36b20e[_0x45afac(0x2e9)]())fs[_0x45afac(0x1c6)](configpath+_0x36b20e['name']);});const _0x52dec6=fs['readFileSync'](_0x4ea126+_0x2f46ee,_0x2bc933(0x1b3)),_0x44467c=await JSZip[_0x2bc933(0x19f)](_0x52dec6,{'base64':![],'checkCRC32':!![]});for(const _0x3672ee of Object['keys'](_0x44467c[_0x2bc933(0x23a)])){const _0x305c06=_0x44467c[_0x2bc933(0x23a)][_0x3672ee],_0x1194ae=await _0x305c06[_0x2bc933(0x17d)](_0x2bc933(0x296));fs[_0x2bc933(0x35d)](configpath+_0x305c06['name'],_0x1194ae);}fs['readdirSync'](temppath,{'withFileTypes':!![]})['forEach'](_0x1a8ed3=>{const _0x130c49=_0x2bc933;if(!_0x1a8ed3[_0x130c49(0x2e9)]())fs[_0x130c49(0x1c6)](temppath+_0x1a8ed3['name']);}),logger[_0x2bc933(0x1d3)](_0x2bc933(0x328)),process[_0x2bc933(0x1b1)]({'restore':!![]},_0x413963=>{});}async function getPublicIp(){const _0x19b6ca=_0x59c681;try{const _0x374310=await axios['get'](_0x19b6ca(0x2a5));publicip=_0x374310['data']['ip'];}catch(_0x385c79){}}async function triggerAnalytics(){const _0x240bff=_0x59c681;if(!publicip)await getPublicIp();const _0x4bc512=getBotsWithMode();let _0x4ea6cf=0x0;_0x4bc512['forEach'](_0x231ecf=>{const _0x4a2914=_0x1941;if(_0x231ecf['status']===_0x4a2914(0x2f0))_0x4ea6cf++;});const _0x29f141=getBotExchanges();mixpanel['track'](_0x240bff(0x2da),{'distinct_id':settings[_0x240bff(0x2d4)],'ip':publicip,'version':serverversion,'numbots':_0x4bc512[_0x240bff(0x2a4)],'numbotsenabled':_0x4ea6cf,'exchanges':_0x29f141,'environment':environment});}async function getMessages(){const _0x32f9bb=_0x59c681,_0x1733ac=_0x32f9bb(0x2bb),_0x4a56bb=new GraphQLClient(_0x1733ac),_0x45d4af={'authorization':_0x32f9bb(0x225)},_0x36da58=serverversion['split']('.'),_0x45c77b=_0x36da58[0x0]+'.'+_0x36da58[0x1],_0x5588a5=Math[_0x32f9bb(0x275)](settings[_0x32f9bb(0x360)],settings[_0x32f9bb(0x32c)]),_0x5f436b={'last':parseInt(_0x5588a5),'bbm':_0x45c77b},_0x1fc235=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4899e3;try{_0x4899e3=await _0x4a56bb[_0x32f9bb(0x308)](_0x1fc235,_0x5f436b,_0x45d4af);}catch(_0x3d2b69){}if(_0x4899e3&&_0x4899e3[_0x32f9bb(0x399)]){let _0x82f170=settings[_0x32f9bb(0x360)];newMessages=[];for(const _0x41d688 of _0x4899e3[_0x32f9bb(0x399)]){newMessages[_0x32f9bb(0x20a)](_0x41d688);let _0xefd400=![];_0x41d688[_0x32f9bb(0x375)]&&(updateSetting(_0x32f9bb(0x36b),_0x41d688['bbvNew']),_0xefd400=isNewerVersion(serverversion,_0x41d688[_0x32f9bb(0x375)])||serverversion==_0x41d688['bbvNew']);if(!_0xefd400&&_0x41d688['number']>_0x82f170){if(_0x41d688[_0x32f9bb(0x2d2)]===_0x32f9bb(0x2e1)||serverversion['startsWith'](_0x41d688[_0x32f9bb(0x2d2)])){let _0x2f1476=''+_0x41d688[_0x32f9bb(0x1af)]+'\x0a\x0a'+_0x41d688[_0x32f9bb(0x1b4)];const _0x491e32=await sendTelegramMsg(toTelegramMarkdown(_0x2f1476),_0x32f9bb(0x368));if(_0x491e32)_0x82f170=_0x41d688[_0x32f9bb(0x242)];}}}updateAvailable=isNewerVersion(settings[_0x32f9bb(0x36b)],serverversion),updateSetting(_0x32f9bb(0x360),_0x82f170),emitMessages();}}function emitMessages(){const _0x483ad4=_0x59c681,_0x17fdca=settings['lastmsgemitted'];let _0x553546=[];newMessages[_0x483ad4(0x2a8)](_0x107bd3=>{const _0x2b4cb9=_0x483ad4;_0x107bd3[_0x2b4cb9(0x242)]>_0x17fdca&&_0x553546[_0x2b4cb9(0x20a)](_0x107bd3);}),_0x553546[_0x483ad4(0x2a4)]>0x0&&getAllClients()[_0x483ad4(0x2a8)](_0x4f1b31=>{const _0x1b27f1=_0x483ad4;getSocket(_0x4f1b31['id'])[_0x1b27f1(0x240)](_0x1b27f1(0x1b4),_0x553546);});}function confirmMessage(_0x1fbc52){const _0x44dcf4=_0x59c681;updateSetting(_0x44dcf4(0x32c),Number(_0x1fbc52));}function isNewerVersion(_0x43c8f1,_0x4d69b7){const _0x54f13c=_0x59c681,_0x1079ee=_0x4d69b7[_0x54f13c(0x1e8)]('.'),_0x19ab19=_0x43c8f1['split']('.');for(var _0x1cbd4c=0x0;_0x1cbd4c<_0x19ab19[_0x54f13c(0x2a4)];_0x1cbd4c++){const _0x3cbd32=~~_0x19ab19[_0x1cbd4c],_0x4bffc1=~~_0x1079ee[_0x1cbd4c];if(_0x3cbd32>_0x4bffc1)return!![];if(_0x3cbd32<_0x4bffc1)return![];}return![];}function toTelegramMarkdown(_0x46cf47){const _0x31d5ac=_0x59c681,_0xd27f3a=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0xb8df6=/\*{2}(.+?)\*{2}/gim;return _0x46cf47=_0x46cf47[_0x31d5ac(0x1fd)](_0xd27f3a,_0x31d5ac(0x23e))[_0x31d5ac(0x1fd)](_0xb8df6,_0x31d5ac(0x2e2)),_0x46cf47;}async function validateConfigFile(){const _0x50e322=_0x59c681,_0xf82854=dbConfig[_0x50e322(0x301)]('bots')['sortBy'](_0x50e322(0x189))[_0x50e322(0x22d)]()||[];if(_0xf82854[_0x50e322(0x2a4)]==0x0){let _0x1a1e4e=0x0,_0x1fcc84=[];const _0x8cbaee=/^bot-([0-9]{3})-config.json$/,_0x522d94=fs[_0x50e322(0x260)](configpath);_0x522d94['forEach'](_0x3808eb=>{const _0xd5264a=_0x50e322,_0x13ef90=_0x8cbaee[_0xd5264a(0x31c)](_0x3808eb);if(_0x13ef90){const _0x1e8144=_0x13ef90[0x1];let _0x17ddfa=getBotAttributes(_0x1e8144);_0x1fcc84[_0xd5264a(0x20a)]({'botID':_0x1e8144,'botname':_0x17ddfa[_0xd5264a(0x226)],'status':'disabled','live':'stopped'}),_0x1a1e4e++;}}),_0x1a1e4e!=0x0&&(dbConfig['get']('bots')[_0x50e322(0x282)](_0x1fcc84)[_0x50e322(0x193)](),config=_0x1fcc84,restoredConfigFile=_0x1a1e4e);}}async function restoreConfigNotify(_0x2c05a3){const _0x2b4d58=_0x59c681;let _0x568727;if(restoredConfigFile==0x1)_0x568727=_0x2b4d58(0x1b0);else _0x568727=_0x2b4d58(0x25f);if(_0x2c05a3)io['to'](_0x2b4d58(0x317))['emit'](_0x2b4d58(0x23d),_0x568727);else{logger['simple'](_0x2b4d58(0x255)),logger[_0x2b4d58(0x2de)](_0x568727),logger['simple'](_0x2b4d58(0x255)),logger['simple']('');if(tgBot&&settings[_0x2b4d58(0x347)]&&settings[_0x2b4d58(0x1c0)]!=_0x2b4d58(0x31e))await sendTelegram(settings[_0x2b4d58(0x347)],_0x2b4d58(0x1fe)+_0x568727);}}function decryptRSA(_0x14bc04,_0x1c3c89){const _0x57fa8d=_0x59c681,_0x25aee6=forge[_0x57fa8d(0x392)][_0x57fa8d(0x20b)](_0x14bc04),_0x5c414b=_0x25aee6['decrypt'](forge[_0x57fa8d(0x203)][_0x57fa8d(0x25a)](_0x1c3c89),'RSA-OAEP',{'md':forge['md'][_0x57fa8d(0x1f3)][_0x57fa8d(0x381)](),'mgf1':{'md':forge['md'][_0x57fa8d(0x1f3)][_0x57fa8d(0x381)]()}});return _0x5c414b;}function validateCredentials(_0x34cf13,_0x81c0f7){const _0x12c249=_0x59c681;if(_0x34cf13[_0x12c249(0x358)]==settings['bbUsername']&&bcrypt['compareSync'](_0x34cf13['password'],settings[_0x12c249(0x257)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x12c249(0x37b),'token':null};else{const _0x42d1e5=generateLoginToken(_0x81c0f7);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x42d1e5};}}else return{'allow':![],'reason':_0x12c249(0x1c7),'token':null};}function refreshToken(_0x2e81c1){const _0xc04d44=_0x59c681,_0x26c696=generateLoginToken(_0x2e81c1);return{'allow':!![],'reason':_0xc04d44(0x17e),'token':_0x26c696};}function validateAccess(_0xefda82,_0x34f5f1,_0x4f4b92){const _0x598bb5=_0x59c681,_0x1749aa=_0x4f4b92?_0x4f4b92:devices[_0x34f5f1]['ip'];let _0x528cfc;const _0x2185df=_0x1f4108=>{const _0x56c22d=_0x1941;if(settings[_0x56c22d(0x371)]){if(settings[_0x56c22d(0x2be)]){if(telegram2FaApproved(_0x34f5f1)){const _0xa099f0=generateLoginToken(_0x34f5f1);return{'allow':!![],'reason':_0x56c22d(0x1b5),'token':_0xa099f0};}else return{'allow':![],'reason':_0x56c22d(0x1e0),'token':null};}else return _0x528cfc=validToken(_0x1f4108,_0x34f5f1),_0x528cfc['hasOwnProperty']('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x1f4108}:{'allow':![],'reason':_0x56c22d(0x1e0),'token':null};}else return{'allow':!![],'reason':_0x56c22d(0x246),'token':null};};if(settings['whitelistEnabled']){let _0x4e9182=[...settings[_0x598bb5(0x1d5)],_0x598bb5(0x2bf),_0x598bb5(0x2ef),'127.0.0.1'];if(_0x4e9182['includes'](_0x1749aa))return _0x2185df(_0xefda82);else{_0x528cfc=validToken(_0xefda82,_0x34f5f1);if(_0x528cfc[_0x598bb5(0x1f6)](_0x598bb5(0x377)))return _0x2185df(_0xefda82);else{if(telegramIpApproved(_0x34f5f1)){const _0x2fdec5=generateToken(_0x34f5f1);return _0x528cfc=_0x2185df(_0xefda82),_0x528cfc['allow']?{'allow':!![],'reason':_0x598bb5(0x1dd),'token':_0x2fdec5}:_0x528cfc;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x598bb5(0x235),'token':null}:{'allow':![],'reason':_0x598bb5(0x2d7),'token':null};}}}else return _0x2185df(_0xefda82);}function timelyDecrypt(_0x2cf3d7,_0x444d7b,_0x1363c0='@'){const _0x255304=_0x59c681;if(_0x2cf3d7)try{const _0x154217=decryptRSA(secure[_0x255304(0x338)],_0x2cf3d7),_0x5a91b1=_0x154217[_0x255304(0x1e8)](_0x1363c0)[0x0],_0x1116dc=_0x154217['split'](_0x1363c0)[0x1],_0x591805=new Date()[_0x255304(0x291)]();if(_0x444d7b){if(_0x591805-_0x1116dc<maxSecretAge*0x3e8)return _0x5a91b1;else return![];}else return _0x5a91b1;}catch(_0x30bfc6){return![];}else return![];}const validToken=(_0x4d09c5,_0x485ebc)=>{const _0xf44353=_0x59c681,_0x45de4c=devices[_0x485ebc]['ip'];if(!_0x4d09c5)return{'error':_0xf44353(0x30d)};for(let _0x1bfa56 of blacklist){if(_0x1bfa56[_0xf44353(0x224)]==_0x4d09c5)return{'error':_0xf44353(0x2e5)};}let _0x1fcd1a;try{_0x1fcd1a=jwt[_0xf44353(0x1f1)](_0x4d09c5,secure[_0xf44353(0x364)]+_0x485ebc);}catch{return{'error':_0xf44353(0x325)};}if(!_0x1fcd1a[_0xf44353(0x1f6)]('clientip')&&!_0x1fcd1a['hasOwnProperty']('username')||!_0x1fcd1a[_0xf44353(0x1f6)](_0xf44353(0x2db)))return{'error':_0xf44353(0x264)};if(!_0x1fcd1a[_0xf44353(0x1f6)](_0xf44353(0x358))&&_0x1fcd1a[_0xf44353(0x1f6)]('clientip')){const {clientip:_0x517837}=_0x1fcd1a;return _0x45de4c==_0x517837?{'success':'User\x20has\x20been\x20validated'}:{'error':_0xf44353(0x1f7)};}else{if(_0x1fcd1a[_0xf44353(0x1f6)](_0xf44353(0x358))&&_0x1fcd1a[_0xf44353(0x1f6)](_0xf44353(0x2c2))){const {username:_0x282180,clientip:_0x5c2302}=_0x1fcd1a;return settings[_0xf44353(0x251)]==_0x282180&&_0x45de4c==_0x5c2302?{'success':_0xf44353(0x34c)}:{'error':_0xf44353(0x331)};}}},generateLoginToken=_0x323aba=>{const _0x496356=_0x59c681;if(_0x323aba){const _0x2b3dce=devices[_0x323aba]['ip'];return jwt['sign']({'username':settings[_0x496356(0x251)],'clientip':_0x2b3dce},secure[_0x496356(0x364)]+_0x323aba,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x2cfda0=>{const _0x13448b=_0x59c681;if(_0x2cfda0){const _0x3a9d9f=devices[_0x2cfda0]['ip'];return jwt[_0x13448b(0x394)]({'clientip':_0x3a9d9f},secure[_0x13448b(0x364)]+_0x2cfda0,{'expiresIn':devices[_0x2cfda0][_0x13448b(0x21f)][_0x13448b(0x284)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x4bf690=>{const _0x3ef5df=_0x59c681;let _0x8c634e=![];return devices[_0x4bf690]['telegramIpApproval']&&devices[_0x4bf690][_0x3ef5df(0x21f)][_0x3ef5df(0x284)]!='reject'&&(_0x8c634e=devices[_0x4bf690][_0x3ef5df(0x21f)][_0x3ef5df(0x2c2)]==devices[_0x4bf690]['ip']&&new Date()[_0x3ef5df(0x291)]()-devices[_0x4bf690][_0x3ef5df(0x21f)][_0x3ef5df(0x292)]<devices[_0x4bf690][_0x3ef5df(0x21f)][_0x3ef5df(0x284)]*0x3c*0x3e8),_0x8c634e;},telegram2FaApproved=_0xbddffb=>{const _0x30d43b=_0x59c681;let _0x30a4cd=![];return devices[_0xbddffb][_0x30d43b(0x303)]&&devices[_0xbddffb]['telegram2FaApproval'][_0x30d43b(0x284)]!=_0x30d43b(0x2ed)&&(_0x30a4cd=devices[_0xbddffb]['telegram2FaApproval'][_0x30d43b(0x2c2)]==devices[_0xbddffb]['ip']&&new Date()['getTime']()-devices[_0xbddffb][_0x30d43b(0x303)]['timestamp']<devices[_0xbddffb][_0x30d43b(0x303)][_0x30d43b(0x284)]*0x3c*0x3e8),_0x30a4cd;},normalizeIP=_0x2807a7=>{const _0x580a1e=_0x59c681;let _0x536fb5=null,_0x290d18=null;if(ipaddr[_0x580a1e(0x388)](_0x2807a7)){const _0x3704a9=ipaddr[_0x580a1e(0x354)](_0x2807a7);_0x3704a9[_0x580a1e(0x277)]()===_0x580a1e(0x233)?(_0x3704a9[_0x580a1e(0x271)]()&&(_0x536fb5=_0x3704a9['toIPv4Address']()[_0x580a1e(0x22a)]()),_0x290d18=_0x3704a9[_0x580a1e(0x22a)]()):(_0x536fb5=_0x3704a9[_0x580a1e(0x22a)](),_0x290d18=_0x3704a9[_0x580a1e(0x2c5)]()[_0x580a1e(0x22a)]());}return{'show':_0x536fb5?_0x536fb5:_0x290d18,'store':_0x290d18};};function formatDate(_0xe3ea49){const _0x3d0afb=_0x59c681;return _0xe3ea49[_0x3d0afb(0x261)]()+'/'+(_0xe3ea49[_0x3d0afb(0x215)]()+0x1)[_0x3d0afb(0x22a)]()[_0x3d0afb(0x365)](0x2,'0')+'/'+_0xe3ea49[_0x3d0afb(0x209)]()[_0x3d0afb(0x22a)]()[_0x3d0afb(0x365)](0x2,'0')+'\x20'+_0xe3ea49[_0x3d0afb(0x373)]()[_0x3d0afb(0x22a)]()[_0x3d0afb(0x365)](0x2,'0')+':'+_0xe3ea49[_0x3d0afb(0x30b)]()[_0x3d0afb(0x22a)]()[_0x3d0afb(0x365)](0x2,'0')+':'+_0xe3ea49[_0x3d0afb(0x2b0)]()[_0x3d0afb(0x22a)]()[_0x3d0afb(0x365)](0x2,'0');}function sleep(_0x2d67f1){return new Promise(_0x4c88b5=>setTimeout(_0x4c88b5,_0x2d67f1));}