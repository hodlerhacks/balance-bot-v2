const _0x2c11d0=_0x998f;(function(_0x2fb750,_0x45c95b){const _0x1a2c00=_0x998f,_0x28d77a=_0x2fb750();while(!![]){try{const _0x9aa6f0=parseInt(_0x1a2c00(0x146))/0x1+-parseInt(_0x1a2c00(0xb1))/0x2*(parseInt(_0x1a2c00(0x13e))/0x3)+parseInt(_0x1a2c00(0x1bd))/0x4+-parseInt(_0x1a2c00(0x1ea))/0x5+-parseInt(_0x1a2c00(0x261))/0x6+parseInt(_0x1a2c00(0x230))/0x7*(parseInt(_0x1a2c00(0x139))/0x8)+parseInt(_0x1a2c00(0x147))/0x9*(parseInt(_0x1a2c00(0x19d))/0xa);if(_0x9aa6f0===_0x45c95b)break;else _0x28d77a['push'](_0x28d77a['shift']());}catch(_0x5b8673){_0x28d77a['push'](_0x28d77a['shift']());}}}(_0x5b6a,0x584f7));const _0x39f183=function(){let _0x5f5d4=!![];return function(_0x1d9d61,_0x3af3da){const _0x55ffbb=_0x5f5d4?function(){const _0x6f6a54=_0x998f;if(_0x3af3da){const _0x3906d0=_0x3af3da[_0x6f6a54(0x15c)](_0x1d9d61,arguments);return _0x3af3da=null,_0x3906d0;}}:function(){};return _0x5f5d4=![],_0x55ffbb;};}(),_0x52f613=_0x39f183(this,function(){const _0x423443=_0x998f;return _0x52f613['toString']()[_0x423443(0xc0)](_0x423443(0x248))[_0x423443(0x1a8)]()[_0x423443(0x1e1)](_0x52f613)[_0x423443(0xc0)](_0x423443(0x248));});_0x52f613();'use strict';process[_0x2c11d0(0xd4)][_0x2c11d0(0x1d1)]=0x1;const childProcess=require(_0x2c11d0(0x278)),fs=require('fs'),fns=require(_0x2c11d0(0x1ca)),low=require(_0x2c11d0(0x8c)),FileSync=require(_0x2c11d0(0x23c)),path=require(_0x2c11d0(0xe1)),crypto=require('crypto'),forge=require('node-forge'),bcrypt=require('bcryptjs'),jwt=require(_0x2c11d0(0x16d)),ipaddr=require('ipaddr.js'),argv=require(_0x2c11d0(0xc4))(process[_0x2c11d0(0x1eb)][_0x2c11d0(0x206)](0x2))[_0x2c11d0(0x1eb)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x2c11d0(0x216)),Mixpanel=require(_0x2c11d0(0x145)),axios=require(_0x2c11d0(0x25c)),{GraphQLClient,gql}=require(_0x2c11d0(0x199)),util=require(_0x2c11d0(0x198)),fileUpload=require(_0x2c11d0(0x13c)),{networkInterfaces}=require('os'),JSZip=require(_0x2c11d0(0x1f7)),PORT=argv[_0x2c11d0(0x23d)]||_0x2c11d0(0x1dd),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x2c11d0(0xc7)](_0x2c11d0(0x270)+PORT+_0x2c11d0(0x23a)),process[_0x2c11d0(0x13f)](0x1));const HOST=argv['host']||null,userID=argv[_0x2c11d0(0xd1)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x2c11d0(0x176)][_0x2c11d0(0x27d)];let bbpath=_0x2c11d0(0x16c),bbpath2='';const botfile=_0x2c11d0(0x26d),configfile=_0x2c11d0(0x115),settingsfile='bb-settings.json',securefile='bb-secure.json',environment=require('./'+bbpath2+_0x2c11d0(0x22e))[_0x2c11d0(0x91)]||_0x2c11d0(0xb3),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x2c11d0(0x1d6)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x2c11d0(0x11d),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x2c11d0(0x150)+userID+'/':bbpath+_0x2c11d0(0x150),zippath=userID?bbpath+_0x2c11d0(0xb4)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x2c11d0(0x1cf)](logspath+_0x2c11d0(0x272),{'flags':'a'}),temppath=userID?bbpath+_0x2c11d0(0x89)+userID+'/':bbpath+_0x2c11d0(0x89);!fs['existsSync'](configpath)&&fs[_0x2c11d0(0x283)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x2c11d0(0x283)](configbackuppath);!fs[_0x2c11d0(0x1d6)](logspath)&&fs[_0x2c11d0(0x283)](logspath);!fs[_0x2c11d0(0x1d6)](zippath)&&fs[_0x2c11d0(0x283)](zippath);!fs['existsSync'](temppath)&&fs[_0x2c11d0(0x283)](temppath);function _0x5b6a(){const _0x3ca6ea=['Allow\x20login\x20from\x20IP\x20address\x20','async','Password\x20reset\x20rejected',')\x20\x20\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20log\x20out','-results.json','Unauthorized\x20attempt\x20to\x20store\x20configuration','Login\x20accepted','lastmsgtelegram','Session\x20expired\x20for\x20user\x20...','create','|@|','/upload-backup','bb-config.json','bb-settings.json','restart','help','get-logs','alerts','Invalid\x20username\x20or\x20IP\x20address','show-config','config/','--------------------------------------','Idling\x20(','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Access\x20enabled\x20for\x20','access','telegramEnabled','copyFileSync','randomFillSync','temporary\x20access\x20not\x20allowed','Notifications\x20disabled','Backup\x20file\x20unzipped\x20and\x20stored','isDirectory','verify','Unauthorized\x20attempt\x20to\x20show\x20configuration','/enable\x20-\x20enable\x20notifications\x0a','restart_','Enabled\x20Bot\x20','\x20files\x20over\x20Telegram:','endsWith','secure','output-003.log','botmanager','apiSecret','0.0.0','build2','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','backup','8OsAEQb','socket','string','express-fileupload','warning','129IcIOFI','exit','add','No\x20bots\x20running\x20right\x20now','show','emit','restore_yes_','mixpanel','52616FLofxU','5837877XfUqaQ','expiry','/update\x20-\x20update\x20Balance\x20Bot\x0a','sendFile','reason','delete-alerts','telegrammsg','whitelistEnabled','update','logs/','Restore\x20backup\x20file\x20','split','push','All\x20bots','(staging)','Notifications\x20disabled\x0a','mode','button','writeFileSync','accept','rmSync','apply','on_','Orders','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Logged\x20in\x20user\x20...','placeOrder','temporary\x20token\x20generated','updatebotmanager','disabled','remove','request','tempaccess_reject_','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','login\x20token\x20valid','store','output-000.log','bb/','jsonwebtoken','pidRefreshToken','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','lastmsgemitted','\x1b[33m','\x20to\x20','createServer','username','bb-secure.json','versions','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','login','Error\x20details:','backup-files','toggle','sockets','sign','function','filter','includes',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','secret','exec','send','forEach','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','binary','pidExpireLogin','message','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','\x1b[36m','hashSync','allow','Error\x20sending\x20','sortBy','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','toIPv4MappedAddress','/disable\x20-\x20disable\x20notifications\x0a','Unauthorized\x20attempt\x20to\x20get\x20messages','reply','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','util','graphql-request','connected','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Error\x20while\x20deleting\x20config\x20files:\x20','10FxRcba','privateKeyToPem','Failed\x20to\x20download\x20','Your\x20installation\x20is\x20already\x20up\x20to\x20date','launch','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','replyWithDocument','BCT','Logged\x20out\x20user\x20...','any','Starting\x20#RED#Balance\x20Bot\x20v','toString','alias','Bot\x20Mgr\x20>\x20','order','config_orders','kind','Markdown','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','min','success','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','getSeconds','match','names','Notifications\x20enabled\x0a','find','SIGTERM','/download/:type','Setting\x20access:\x20','All\x20bots\x20running\x20right\x20now','metrics_','1360376WeGQNP','enable','Unauthorized\x20attempt\x20to\x20get\x20events','f2aRequired','login\x20required','settings','headers','compareSync','all','status','Restarting\x20Bot\x20','invalid\x20credentials','unlinkSync','date-fns','access\x20timeout','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','127.0.0.1','family','createWriteStream','cancelLoading','NTBA_FIX_319','Token\x20blacklisted','sendMetricsTelegram','confirm-message','sha256','existsSync','bbPassword','output-002.log','<b>Balance\x20Bot\x20Status:</b>\x0a','telegramEvents','start','handshake','3000','whitelist','login\x20not\x20required','mtime','constructor','Server','onepagemode','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','reject','config','readdirSync','exp','auto','1284715ZlwDUo','argv','telegramToken','Starting\x20new\x20bot\x20|\x20Bot\x20','apiPassword','getTime','\x20>\x20','/logs\x20-\x20receive\x20log\x20files\x0a','loginRequired','statSync','telegram2FaApproval','entries','address','jszip','botID','storeHeadless','size','bbUsername','server','1000','timeshift','use','/names\x20-\x20show\x20bot\x20names\x0a','tempaccess_15_','tkn','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','portfolio','range','slice','assign','\x20(2)','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','/:bot/history','bot-','password','getFullYear','getDate','config_all','get-starting-balances','track','get-messages','getStartingBalances','error','Running\x20#RED#Balance\x20Bot\x20v','telegraf','store-headless','loadAsync','Invalid\x20IP\x20address','delete-bot','stringify','simple','ipc','output-001.log','privateKey','new','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','showConfig','catch','bots','2FA\x20required','express','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','/restart\x20-\x20restart\x20bot(s)\x0a','randomBytes','User\x20has\x20been\x20validated','reinstall','version.json','login2fa_reject_','2467626CgkBcv','backup-full.zip','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','showname','fork','sendPortfolioTelegram','update_no','telegramIpApproval','running','encryptedUuid',',\x20must\x20be\x20a\x204\x20digit\x20number','event','lowdb/adapters/FileSync','port','Password\x20has\x20been\x20reset\x20to:\x20','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Unauthorized\x20attempt\x20to\x20update\x20bot','getMinutes','reinstall-bb','Temporary\x20access\x20rejected','callback','yes','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','editMessageReplyMarkup','(((.+)+)+)+$','startsWith','Notifications\x20enabled','inlineKeyboard','notification','get','storeConfiguration','type','pki','new-disabled','publicKey','version','telegramChatId','store-configuration','name','userid','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','/:bot/performance','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','init','axios','[ip-address]','then','sendMessage','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','3102282lRdDsj','clientip','conn','/:bot/support','resetHistory','command','value','messages','#RES#\x20','bbvNew','getHours','telegram','bot.js','\x20minutes','uncaughtException','Error:\x20Invalid\x20argument\x20','<b>Telegram\x20Bot\x20Status:</b>\x0a','/output-000.log','socket.io','live','off_','#RES#\x20if\x20running\x20locally\x0a','\x1b[31m','child_process','file','defaults','started','isIPv4MappedAddress','node','\x20(1)','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','post','telegramUsername','/on\x20-\x20start\x20bot(s)\x0a','mkdirSync','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','kill','getPortfolio','Telegraf\x20error:','token','number','headless','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','resetpw_no','staging','readFileSync','#RES#\x20if\x20running\x20on\x20server','write','chat','reload','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','2FA','keys','format','index.html','backup-full@','/metrics\x20-\x20show\x20bot\x20performance\x0a','close','/:bot/coins','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','isValid','temp/','Restore\x20process\x20aborted','login\x20token\x20generated','lowdb','latestversion','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','enabled','toIPv4Address','environment','File\x20uploaded','-----------------------------------------------------------------------------------','Invalid\x20authentication\x20token\x20(2)','stopped','config_alerts','marketcapApi','::ffff:127.0.0.1','30\x20min','***','Network\x20Interfaces:','reinstall_no','-config.json','debug','from','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Backup\x20file\x20uploaded','download','blacklist','logout','/backup\x20-\x20receive\x20backup\x20files\x0a','disconnect','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','.zip','listen','length','update-bb','\x20|\x20user:\x20...','Restoring\x20bot(s)\x20from\x20backup','sort','Notifications\x20types:\x20','12008aQtrwq','Unauthorized\x20attempt\x20to\x20download\x20','production','zip/','replace','/:bot/portfolio','15\x20min','Starting\x20Balance\x20Bot\x20update','inherit','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','files','static','************','decrypt','bbvReceive','search','params','botname','https://api.ipify.org?format=json','yargs/yargs','http','Unauthorized\x20attempt\x20to\x20get\x20portfolio','log','Alerts','$1_$2_$3','address\x20already\x20in\x20use',')\x20|\x20Bot\x20','parse','hasOwnProperty','get-portfolio','backup-full','Unauthorized\x20attempt\x20to\x20delete\x20bot','user','DEFLATE','Restore\x20process\x20confirmed','env','once','-events.json','HTML','timestamp','orders','update-bot','bot','stop','SIGINT','action','Error\x20removing\x20old\x20backup\x20files:','reset-history','path','logged\x20out','Telegram\x20error:','resetpw_yes','ETH','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','getMonth','Unauthorized\x20attempt\x20to\x20confirm\x20message','2FA\x20login\x20token\x20generated','logs','\x1b[35m','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','map','You\x20can\x20use\x20the\x20following\x20commands:\x0a','auth','set','join','Invalid\x20authentication\x20token\x20(1)','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','All','full','build','place-order','uuid','settings.','/off\x20-\x20stop\x20bot(s)\x0a','padStart','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','args','\x1b[0m','\x20|\x20client:\x20...','-performance.json','portfolio_','Bot\x20','\x20|\x20','referer','manual','Yes'];_0x5b6a=function(){return _0x3ca6ea;};return _0x5b6a();}const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x2c11d0(0x27a)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x2c11d0(0x27a)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x2c11d0(0x290)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x2c11d0(0x290)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x2c11d0(0x25b)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2c11d0(0x1ec)]&&(settings['telegramToken']!=''&&settings[_0x2c11d0(0x1ec)]!=_0x2c11d0(0x9a))&&settings['telegramUsername']&&settings[_0x2c11d0(0x281)]!='')initTelegram();const parseColor=(_0x257cb2,_0x1b4e29)=>{const _0x15b323=_0x2c11d0,_0x35559c=/#[A-Z]{3}#/g;if(typeof _0x257cb2==_0x15b323(0x13b)){!_0x1b4e29?_0x257cb2=_0x257cb2[_0x15b323(0xb5)](_0x35559c,''):(_0x257cb2=_0x257cb2[_0x15b323(0xb5)](/#BLU#/g,'\x1b[34m'),_0x257cb2=_0x257cb2[_0x15b323(0xb5)](/#RED#/g,_0x15b323(0x277)),_0x257cb2=_0x257cb2[_0x15b323(0xb5)](/#YEL#/g,_0x15b323(0x171)),_0x257cb2=_0x257cb2[_0x15b323(0xb5)](/#MAG#/g,_0x15b323(0xeb)),_0x257cb2=_0x257cb2[_0x15b323(0xb5)](/#CYA#/g,_0x15b323(0x18d)),_0x257cb2=_0x257cb2['replace'](/#RES#/g,_0x15b323(0xff)));;}return _0x257cb2;},logger={'screen':_0x4823be=>{const _0x46e76b=_0x2c11d0;console[_0x46e76b(0xc7)](parseColor(_0x4823be,!![]));},'simple':_0x208329=>{const _0x46bfc9=_0x2c11d0;console['log'](parseColor(_0x208329,!![])),loggerfile[_0x46bfc9(0x290)](util[_0x46bfc9(0x296)](parseColor(_0x208329,![]))+'\x0a');},'full':async _0x5878ed=>{const _0x3840dc=_0x2c11d0,_0x319123=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x5878ed;console[_0x3840dc(0xc7)](parseColor(_0x319123,!![])),loggerfile['write'](util[_0x3840dc(0x296)](parseColor(_0x319123,![]))+'\x0a');if(tgBot&&settings[_0x3840dc(0x254)]&&settings[_0x3840dc(0x1da)]!=_0x3840dc(0xd9))await sendTelegram(settings[_0x3840dc(0x254)],_0x3840dc(0x1aa)+parseColor(_0x5878ed,![]));},'debug':async(_0x18525a,_0xc74319='')=>{const _0x497489=_0x2c11d0,_0x8c0351=getTimeStamp()+_0x497489(0x181)+_0x18525a;if(debugging)console[_0x497489(0xc7)](parseColor(_0x8c0351,!![]));loggerfile[_0x497489(0x290)](util[_0x497489(0x296)](parseColor(_0x8c0351,![]))+'\x0a');if(_0xc74319){if(debugging)console[_0x497489(0xc7)](_0xc74319);loggerfile[_0x497489(0x290)](util[_0x497489(0x296)](_0xc74319)+'\x0a');}}};let terminating=![];process['on'](_0x2c11d0(0x26f),function(_0x263362){const _0x54544e=_0x2c11d0;_0x263362[_0x54544e(0x1a8)]()[_0x54544e(0x180)](_0x54544e(0xca))?(logger[_0x54544e(0x21c)](_0x54544e(0x203)+_0x263362[_0x54544e(0x23d)]+'#RES#'),process['send']({'terminate':!![]},_0x5e73e0=>{})):logger['simple'](_0x263362);}),process['on'](_0x2c11d0(0x13f),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x2c11d0(0x1b8),()=>{const _0x22750b=_0x2c11d0;stopAllBots(),process[_0x22750b(0x13f)](0x0);}),process['on'](_0x2c11d0(0xdd),()=>{const _0x1befba=_0x2c11d0;stopAllBots(),process[_0x1befba(0x13f)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x2c11d0(0x253)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2c11d0(0x228)),app=express(),http=require(_0x2c11d0(0xc5))[_0x2c11d0(0x173)](app);app[_0x2c11d0(0x1ff)](fileUpload({'useTempFiles':!![]})),app[_0x2c11d0(0x24d)](_0x2c11d0(0x1b9),async(_0x2b0939,_0x1f6681)=>{const _0x47ad4e=_0x2c11d0,_0x18901a=_0x2b0939[_0x47ad4e(0xc1)][_0x47ad4e(0x24f)],_0x1478fa=getClientsWithBotID(_0x47ad4e(0x133)),_0x214e4f=_0x2b0939[_0x47ad4e(0x1c3)][_0x47ad4e(0xf8)],_0x49fdf8=timelyDecrypt(_0x214e4f,![]),_0xc7153e=_0x1478fa[_0x47ad4e(0x1b7)](_0x2c4ce5=>_0x2c4ce5[_0x47ad4e(0xf8)]==_0x49fdf8);if(_0xc7153e){const _0x211522=normalizeIP(_0x2b0939[_0x47ad4e(0x13a)]['remoteAddress'])[_0x47ad4e(0x16a)],_0x1b6b21=_0x2b0939[_0x47ad4e(0x1c3)][_0x47ad4e(0x202)];if(validateAccess(_0x1b6b21,_0x49fdf8,_0x211522)[_0x47ad4e(0x18f)])_0x18901a==_0x47ad4e(0x138)&&await backupConfigFiles(),await zipFiles(_0x18901a),_0x1f6681[_0x47ad4e(0xa3)](zippath+(_0x18901a+_0x47ad4e(0xa9)),_0xc69d8d=>{const _0x2f2d08=_0x47ad4e;_0xc69d8d&&(logger[_0x2f2d08(0xf5)](_0x2f2d08(0x19f)+_0x18901a),logger[_0x2f2d08(0x21c)](_0xc69d8d));});else logger[_0x47ad4e(0xf5)](_0x47ad4e(0xb2)+_0x18901a+_0x47ad4e(0x27e));}else logger[_0x47ad4e(0xf5)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x18901a+_0x47ad4e(0x208));}),app[_0x2c11d0(0x280)](_0x2c11d0(0x114),async(_0x41275a,_0x3db5d9)=>{const _0x2dd6c5=_0x2c11d0,_0x24b43b=getClientsWithBotID('botmanager'),_0x3d9822=_0x41275a[_0x2dd6c5(0x1c3)]['uuid'],_0x4f6354=timelyDecrypt(_0x3d9822,![]),_0x5b3e9c=_0x24b43b['find'](_0x5a233f=>_0x5a233f[_0x2dd6c5(0xf8)]==_0x4f6354);logger[_0x2dd6c5(0x9e)](_0x2dd6c5(0xa2));if(_0x5b3e9c){const _0x182368=normalizeIP(_0x41275a['socket']['remoteAddress'])[_0x2dd6c5(0x16a)],_0x278d01=_0x41275a[_0x2dd6c5(0x1c3)][_0x2dd6c5(0x202)];if(validateAccess(_0x278d01,_0x4f6354,_0x182368)[_0x2dd6c5(0x18f)]){if(_0x41275a['files']){const _0x332838=_0x41275a[_0x2dd6c5(0xbb)]['backupfile'];await _0x332838['mv'](temppath+_0x332838[_0x2dd6c5(0x256)]),_0x3db5d9['send']({'status':!![],'message':_0x2dd6c5(0x92)});const _0x180c6c=getBotsWithMode();_0x180c6c[_0x2dd6c5(0xab)]>0x0?confirmRestore(temppath,_0x332838['name']):unzipFile(temppath,_0x332838['name']);}}else logger[_0x2dd6c5(0xf5)](_0x2dd6c5(0x258));}else logger['full'](_0x2dd6c5(0x221));}),app[_0x2c11d0(0x1ff)](express[_0x2c11d0(0xbc)](path[_0x2c11d0(0xf1)](__dirname,bbpath2,_0x2c11d0(0x136)))),app[_0x2c11d0(0x1ff)](express['static'](path['join'](__dirname,bbpath2,_0x2c11d0(0xf6)))),app[_0x2c11d0(0x24d)]('/',function(_0x21cc74,_0x22e121){const _0x495fff=_0x2c11d0;_0x22e121[_0x495fff(0x14a)](path[_0x495fff(0xf1)](__dirname,bbpath2,_0x495fff(0x136),'index.html'));}),app[_0x2c11d0(0x24d)]('/:bot',function(_0xe9307c,_0x1bfba9){const _0x28c572=_0x2c11d0;_0x1bfba9[_0x28c572(0x14a)](path[_0x28c572(0xf1)](__dirname,bbpath2,_0x28c572(0xf6),_0x28c572(0x297)));}),app[_0x2c11d0(0x24d)](_0x2c11d0(0xb6),(_0x19a1da,_0x1d1a1b)=>{const _0x4585a4=_0x2c11d0;_0x1d1a1b[_0x4585a4(0x14a)](path[_0x4585a4(0xf1)](__dirname,bbpath2,_0x4585a4(0xf6),_0x4585a4(0x297)));}),app[_0x2c11d0(0x24d)](_0x2c11d0(0x259),(_0x2ad72a,_0x4ebfc6)=>{const _0x557a1a=_0x2c11d0;_0x4ebfc6[_0x557a1a(0x14a)](path[_0x557a1a(0xf1)](__dirname,bbpath2,_0x557a1a(0xf6),_0x557a1a(0x297)));}),app['get'](_0x2c11d0(0x86),(_0x4bf481,_0x206c0a)=>{const _0x1d1435=_0x2c11d0;_0x206c0a[_0x1d1435(0x14a)](path['join'](__dirname,bbpath2,_0x1d1435(0xf6),_0x1d1435(0x297)));}),app[_0x2c11d0(0x24d)](_0x2c11d0(0x20a),(_0x5ce24d,_0x322c13)=>{const _0x17302b=_0x2c11d0;_0x322c13['sendFile'](path[_0x17302b(0xf1)](__dirname,bbpath2,_0x17302b(0xf6),_0x17302b(0x297)));}),app[_0x2c11d0(0x24d)]('/:bot/configuration',(_0x50fcbc,_0x32aa6b)=>{const _0x3c1be4=_0x2c11d0;_0x32aa6b['sendFile'](path['join'](__dirname,bbpath2,_0x3c1be4(0xf6),'index.html'));}),app[_0x2c11d0(0x24d)](_0x2c11d0(0x264),(_0x15d8ac,_0x2fdbc2)=>{const _0x50901f=_0x2c11d0;_0x2fdbc2[_0x50901f(0x14a)](path[_0x50901f(0xf1)](__dirname,bbpath2,_0x50901f(0xf6),_0x50901f(0x297)));});if(HOST)http[_0x2c11d0(0xaa)](PORT,HOST);else http[_0x2c11d0(0xaa)](PORT);const io=require(_0x2c11d0(0x273))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x58488b=_0x2c11d0;let _0xbd9cbd=_0x58488b(0x25d);const _0x384f2c=networkInterfaces(),_0x3a93e1={};for(const _0xbbcef4 of Object['keys'](_0x384f2c)){for(const _0x43a9e7 of _0x384f2c[_0xbbcef4]){if((_0x43a9e7[_0x58488b(0x1ce)]=='IPv4'||_0x43a9e7[_0x58488b(0x1ce)]==0x4)&&!_0x43a9e7['internal']){const _0x5a117b=ipaddr[_0x58488b(0xcc)](_0x43a9e7[_0x58488b(0x1f6)])[_0x58488b(0x205)]();_0x5a117b!='private'&&(!_0x3a93e1[_0xbbcef4]&&(_0x3a93e1[_0xbbcef4]=[]),_0x3a93e1[_0xbbcef4][_0x58488b(0x153)](_0x43a9e7[_0x58488b(0x1f6)]),_0xbd9cbd=_0x43a9e7['address']);}}}return{'serverip':_0xbd9cbd,'netinterfaces':_0x3a93e1};}async function startServer(){const _0x2b239a=_0x2c11d0,{serverip:_0xc935fc,netinterfaces:_0x15a70d}=getServerIP();logger[_0x2b239a(0x21c)](''),logger[_0x2b239a(0x21c)](_0x2b239a(0x93)),await logger[_0x2b239a(0xf5)](_0x2b239a(0x1a7)+serverversion+_0x2b239a(0x269)+(environment==_0x2b239a(0x28d)?'(staging)':'')+'\x0a'+(_0x2b239a(0x1af)+PORT+_0x2b239a(0x276))+('=>\x20Go\x20to\x20#CYA#http://'+_0xc935fc+':'+PORT+_0x2b239a(0x28f))),logger[_0x2b239a(0x21c)](_0x2b239a(0x93));if(config[_0x2b239a(0xab)]!=0x0)for(const _0x506f27 of config){const _0x4b5d4a=_0x506f27[_0x2b239a(0x157)]==_0x2b239a(0x1e9)?'a':'m';if(_0x506f27['status']==_0x2b239a(0x8f)||_0x506f27[_0x2b239a(0x1c6)]==_0x2b239a(0x220))await logger['full']('Starting\x20('+_0x4b5d4a+_0x2b239a(0xcb)+_0x506f27[_0x2b239a(0x1f8)]+_0x2b239a(0x104)+_0x506f27['botname']),startBot([_0x506f27['botID'],userID],{'cwd':bbpath},function(_0x545d85){const _0x421e7e=_0x2b239a;if(_0x545d85)logger[_0x421e7e(0xf5)](_0x545d85);});else(_0x506f27['status']==_0x2b239a(0x164)||_0x506f27[_0x2b239a(0x1c6)]==_0x2b239a(0x251))&&await logger[_0x2b239a(0xf5)](_0x2b239a(0x11f)+_0x4b5d4a+_0x2b239a(0x10b)+_0x506f27[_0x2b239a(0x1f8)]+_0x2b239a(0x104)+_0x506f27[_0x2b239a(0xc2)]);}else!newBot&&logger['simple'](_0x2b239a(0x260));if(newBot)addBot();logger[_0x2b239a(0x21c)](_0x2b239a(0x93)),logger[_0x2b239a(0x21c)](''),await logger['debug']('Node.js\x20v'+nodeversion),await logger[_0x2b239a(0x9e)](_0x2b239a(0x9b),_0x15a70d);}function _0x998f(_0x5d256a,_0xfea53a){const _0x4dae7d=_0x5b6a();return _0x998f=function(_0x52f613,_0x39f183){_0x52f613=_0x52f613-0x86;let _0x5b6a33=_0x4dae7d[_0x52f613];return _0x5b6a33;},_0x998f(_0x5d256a,_0xfea53a);}function startSocket(){io['on']('connection',_0x5718b1=>{const _0x283e59=_0x998f;let _0x17cc44,_0xc63ff2,_0xea876f,_0xfb2f6a,_0xfcbb88;const _0x4848ec=_0x5718b1['handshake'][_0x283e59(0x1c3)][_0x283e59(0x105)];_0xc63ff2=_0x4848ec[_0x283e59(0x1b4)](/bot[0-9]{3}/);if(_0xc63ff2)_0xea876f=_0xc63ff2[0x0][_0x283e59(0x1b4)](/[0-9]{3}/);if(_0xea876f)_0x17cc44=_0xea876f[0x0];else _0x17cc44=_0x283e59(0x133);const _0x5e45e7=_0x5718b1[_0x283e59(0x1dc)][_0x283e59(0xef)][_0x283e59(0x239)];if(!_0x5e45e7)_0x5718b1[_0x283e59(0x143)](_0x283e59(0x1c6),{'publicKey':secure['publicKey']});else{_0xfb2f6a=timelyDecrypt(_0x5e45e7,![]);if(!_0xfb2f6a)_0x5718b1[_0x283e59(0x143)]('status',{'publicKey':secure['publicKey']});else{_0xfcbb88=normalizeIP(_0x5718b1[_0x283e59(0x263)]['remoteAddress'])['store'];if(!devices[_0xfb2f6a])devices[_0xfb2f6a]={'uuid':_0xfb2f6a,'access':{'token':null}};devices[_0xfb2f6a]['ip']=_0xfcbb88;const _0x5a59a7=addClient(_0x5718b1['id'],_0xfb2f6a,_0x17cc44);setAccess(_0x5a59a7),emitMessages(),_0x5718b1['on']('login',_0x35dd2b=>{const _0x54d8cc=_0x283e59,_0xf1f26c=timelyDecrypt(_0x35dd2b['password'],!![],'|@|');if(_0xf1f26c){_0x35dd2b={'username':_0x35dd2b[_0x54d8cc(0x174)],'password':_0xf1f26c},devices[_0xfb2f6a][_0x54d8cc(0x122)]=validateCredentials(_0x35dd2b,_0xfb2f6a);if(devices[_0xfb2f6a][_0x54d8cc(0x122)][_0x54d8cc(0x18f)]==![]&&devices[_0xfb2f6a][_0x54d8cc(0x122)][_0x54d8cc(0x14b)]=='2FA\x20login\x20required')_0x5718b1['emit'](_0x54d8cc(0x1c6),{'access':devices[_0xfb2f6a][_0x54d8cc(0x122)]}),loginAccess2FA(_0xfb2f6a,_0xfcbb88);else{if(devices[_0xfb2f6a]['access']['allow']==![]&&devices[_0xfb2f6a][_0x54d8cc(0x122)][_0x54d8cc(0x14b)]==_0x54d8cc(0x1c8))_0x5718b1['emit'](_0x54d8cc(0x1c6),{'access':devices[_0xfb2f6a]['access']});else devices[_0xfb2f6a]['access'][_0x54d8cc(0x18f)]&&devices[_0xfb2f6a]['access'][_0x54d8cc(0x14b)]==_0x54d8cc(0x8b)&&(getClientsWithUuid(_0xfb2f6a)[_0x54d8cc(0x185)](_0x2113c9=>{setAccess(_0x2113c9);}),logger['debug'](_0x54d8cc(0x160)+_0xfb2f6a['slice'](-0x8)),setTokenRefresh(_0xfb2f6a),setSessionTimeout('login',_0xfb2f6a));}}else logger['full']('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x5718b1['on']('reset-password',()=>{resetPassword();}),_0x5718b1['on'](_0x283e59(0xa7),_0xd09ed3=>{removeClient(_0x5718b1['id']);}),_0x17cc44==_0x283e59(0x133)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x3f6391){const _0x20fef4=_0x2c11d0;if(_0x3f6391!=_0x20fef4(0x133)&&config['apiKey']!=''){if(pid[_0x3f6391])pid[_0x3f6391][_0x20fef4(0x184)]({'function':'initclient','args':null});}_0x3f6391!='botmanager'&&broadcastToBots(_0x20fef4(0x226),JSON[_0x20fef4(0x21b)](config));}function reloadBotManager(){const _0x5d0aa3=_0x2c11d0;getClientsWithBotID(_0x5d0aa3(0x133))[_0x5d0aa3(0x185)](_0x2a183f=>{const _0x283ed3=_0x5d0aa3;getSocket(_0x2a183f['id'])[_0x283ed3(0x143)](_0x283ed3(0x1c6),{'access':{'allow':![],'reason':_0x283ed3(0x292),'token':null}});});}function getSocket(_0x474d19){const _0x4eeb94=_0x2c11d0,_0x5c1abb=io['_nsps'][_0x4eeb94(0x24d)]('/');return _0x5c1abb[_0x4eeb94(0x17c)][_0x4eeb94(0x24d)](_0x474d19);}function setAccess(_0x189d6a){const _0x4bc7e3=_0x2c11d0,_0x1fac99=getSocket(_0x189d6a['id']),_0x4a6e7d=_0x189d6a[_0x4bc7e3(0xf8)],_0x18d019=_0x189d6a['bot'];devices[_0x4a6e7d][_0x4bc7e3(0x122)]=validateAccess(devices[_0x4a6e7d][_0x4bc7e3(0x122)][_0x4bc7e3(0x288)],_0x4a6e7d),logger[_0x4bc7e3(0x9e)](_0x4bc7e3(0x1ba)+devices[_0x4a6e7d][_0x4bc7e3(0x122)]['reason']+_0x4bc7e3(0x100)+_0x189d6a['id'][_0x4bc7e3(0x206)](-0x8)+_0x4bc7e3(0xad)+_0x4a6e7d[_0x4bc7e3(0x206)](-0x8)),_0x1fac99['join'](_0x4a6e7d);if(devices[_0x4a6e7d]['access']['allow']){_0x1fac99[_0x4bc7e3(0xf1)](_0x18d019);if(_0x18d019==_0x4bc7e3(0x133))initializeSocketBotManager(_0x1fac99);else initializeSocketBot(_0x1fac99);initClient(_0x18d019);}devices[_0x4a6e7d][_0x4bc7e3(0x122)]['token']&&devices[_0x4a6e7d][_0x4bc7e3(0x122)]['reason']==_0x4bc7e3(0x162)&&setSessionTimeout(_0x4bc7e3(0x294),_0x4a6e7d),devices[_0x4a6e7d][_0x4bc7e3(0x122)]['token']&&devices[_0x4a6e7d][_0x4bc7e3(0x122)][_0x4bc7e3(0x14b)]==_0x4bc7e3(0xe9)&&setSessionTimeout(_0x4bc7e3(0x178),_0x4a6e7d),_0x1fac99[_0x4bc7e3(0x143)]('status',{'status':_0x189d6a[_0x4bc7e3(0x1fc)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4a6e7d][_0x4bc7e3(0x122)],'externalip':devices[_0x4a6e7d]['ip'],'publicKey':secure[_0x4bc7e3(0x252)],'userid':settings[_0x4bc7e3(0x257)],'validInstallation':validInstallation}),devices[_0x4a6e7d][_0x4bc7e3(0x122)][_0x4bc7e3(0x18f)]==![]&&devices[_0x4a6e7d][_0x4bc7e3(0x122)][_0x4bc7e3(0x14b)]==_0x4bc7e3(0x227)&&temporaryAccess2FA(_0x4a6e7d,devices[_0x4a6e7d]['ip']);}function setSessionTimeout(_0x2e5abf,_0x2b9fbe){const _0x3ff515=_0x2c11d0;let _0x23a58e;if(_0x2e5abf=='login')_0x23a58e=loginExpiry*0x3c*0x3e8;else _0x23a58e=devices[_0x2b9fbe][_0x3ff515(0x237)][_0x3ff515(0x148)]*0x3c*0x3e8-(new Date()[_0x3ff515(0x1ef)]()-devices[_0x2b9fbe][_0x3ff515(0x237)][_0x3ff515(0xd8)]);if(devices[_0x2b9fbe][_0x3ff515(0x18a)])clearTimeout(devices[_0x2b9fbe][_0x3ff515(0x18a)]);devices[_0x2b9fbe][_0x3ff515(0x18a)]=setTimeout(()=>{const _0x6b24b4=_0x3ff515;if(devices[_0x2b9fbe]['pidRefreshToken'])clearTimeout(devices[_0x2b9fbe][_0x6b24b4(0x16e)]);removeSocketListeners(_0x2b9fbe),addBlacklist(_0x2b9fbe),devices[_0x2b9fbe][_0x6b24b4(0x237)]=null,devices[_0x2b9fbe]['telegram2FaApproval']=null,devices[_0x2b9fbe][_0x6b24b4(0x122)][_0x6b24b4(0x288)]=null,logger[_0x6b24b4(0x9e)](_0x6b24b4(0x111)+_0x2b9fbe['slice'](-0x8)),devices[_0x2b9fbe][_0x6b24b4(0x122)]=validateAccess(devices[_0x2b9fbe][_0x6b24b4(0x122)]['token'],_0x2b9fbe),!(devices[_0x2b9fbe]['access'][_0x6b24b4(0x18f)]&&devices[_0x2b9fbe][_0x6b24b4(0x122)][_0x6b24b4(0x14b)]==_0x6b24b4(0x1df))&&(_0x2e5abf==_0x6b24b4(0x178)?io['to'](_0x2b9fbe)[_0x6b24b4(0x143)](_0x6b24b4(0x1c6),{'access':{'allow':![],'reason':_0x6b24b4(0x1cb),'token':null}}):io['to'](_0x2b9fbe)[_0x6b24b4(0x143)](_0x6b24b4(0x1c6),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x2b9fbe][_0x6b24b4(0x122)][_0x6b24b4(0x288)]=null;},_0x23a58e);}function setTokenRefresh(_0x5d5e37){const _0x302c6f=_0x2c11d0;if(devices[_0x5d5e37]['pidRefreshToken'])clearTimeout(devices[_0x5d5e37][_0x302c6f(0x16e)]);devices[_0x5d5e37][_0x302c6f(0x16e)]=setTimeout(()=>{const _0x59598e=_0x302c6f;getClientsWithUuid(_0x5d5e37)[_0x59598e(0xab)]!=0x0?(devices[_0x5d5e37][_0x59598e(0x122)]=refreshToken(_0x5d5e37),io['to'](_0x5d5e37)[_0x59598e(0x143)](_0x59598e(0x1c6),{'status':_0x59598e(0x19a),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5d5e37][_0x59598e(0x122)],'externalip':devices[_0x5d5e37]['ip'],'publicKey':secure[_0x59598e(0x252)],'validInstallation':validInstallation}),setTokenRefresh(_0x5d5e37)):clearTimeout(devices[_0x5d5e37][_0x59598e(0x16e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4dcf25){const _0x2c3dc2=_0x2c11d0,_0x1f5bb5=getClient(_0x4dcf25['id'])[_0x2c3dc2(0xf8)];_0x4dcf25[_0x2c3dc2(0x143)](_0x2c3dc2(0x226),config),_0x4dcf25[_0x2c3dc2(0x143)](_0x2c3dc2(0x1c2),cleanSettings()),_0x4dcf25['on']('add-bot',_0x6e3a39=>{if(validateAccess(_0x6e3a39,_0x1f5bb5)['allow'])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x4dcf25['on'](_0x2c3dc2(0xda),(_0x189d72,_0x1dcbfa)=>{const _0x5a6438=_0x2c3dc2;if(validateAccess(_0x1dcbfa,_0x1f5bb5)[_0x5a6438(0x18f)])toggleBot(_0x189d72[_0x5a6438(0x1f8)],_0x189d72[_0x5a6438(0x1c6)],_0x189d72[_0x5a6438(0x274)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4dcf25['on']('toggle-bot-mode',(_0x2a4896,_0x25e710)=>{const _0x451021=_0x2c3dc2;if(validateAccess(_0x25e710,_0x1f5bb5)['allow'])toggleBotMode(_0x2a4896);else logger[_0x451021(0xf5)](_0x451021(0x240));}),_0x4dcf25['on'](_0x2c3dc2(0x21a),(_0x738eea,_0x5759db)=>{const _0x3c110e=_0x2c3dc2;if(validateAccess(_0x5759db,_0x1f5bb5)[_0x3c110e(0x18f)])deleteBot(_0x738eea);else logger[_0x3c110e(0xf5)](_0x3c110e(0xd0));}),_0x4dcf25['on']('store-settings',(_0x10046e,_0x102b29)=>{const _0x4c4659=_0x2c3dc2;if(validateAccess(_0x102b29,_0x1f5bb5)[_0x4c4659(0x18f)])storeSettings(_0x10046e,!![]);else logger[_0x4c4659(0xf5)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x4dcf25['on'](_0x2c3dc2(0xac),_0x508298=>{const _0xc9a7b2=_0x2c3dc2;if(validateAccess(_0x508298,_0x1f5bb5)[_0xc9a7b2(0x18f)])updateBB(_0xc9a7b2(0x14f));else logger[_0xc9a7b2(0xf5)](_0xc9a7b2(0xfc));}),_0x4dcf25['on'](_0x2c3dc2(0x242),_0x4d4a14=>{const _0x1574ec=_0x2c3dc2;if(validateAccess(_0x4d4a14,_0x1f5bb5)[_0x1574ec(0x18f)])updateBB(_0x1574ec(0x22d));else logger['full']('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x4dcf25['on']('get-backup-files',_0x152a12=>{const _0x274c14=_0x2c3dc2;if(validateAccess(_0x152a12,_0x1f5bb5)[_0x274c14(0x18f)]){const _0x85fce4=getClient(_0x4dcf25['id']);if(_0x85fce4)getBackupFiles(_0x85fce4[_0x274c14(0xf8)]);else logger[_0x274c14(0xf5)](_0x274c14(0xa1));}else logger['full'](_0x274c14(0x186));}),_0x4dcf25['on']('restore-backup-file',(_0x3d6884,_0x544fbc)=>{const _0x2bd0fa=_0x2c3dc2;if(validateAccess(_0x544fbc,_0x1f5bb5)['allow'])restoreBackupFile(_0x3d6884);else logger[_0x2bd0fa(0xf5)](_0x2bd0fa(0x1cc));}),_0x4dcf25['on'](_0x2c3dc2(0x212),_0x119d70=>{const _0x50fbe9=_0x2c3dc2;if(validateAccess(_0x119d70,_0x1f5bb5)[_0x50fbe9(0x18f)])getMessages();else logger[_0x50fbe9(0xf5)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x4dcf25['on']('confirm-message',(_0x55701b,_0x53b894)=>{const _0x1433bc=_0x2c3dc2;if(validateAccess(_0x53b894,_0x1f5bb5)[_0x1433bc(0x18f)])confirmMessage(_0x55701b);else logger[_0x1433bc(0xf5)](_0x1433bc(0xe8));}),_0x4dcf25['on'](_0x2c3dc2(0xa5),_0xa59aeb=>{const _0x153586=_0x2c3dc2;if(validateAccess(_0xa59aeb,_0x1f5bb5)['allow']){if(devices[_0x1f5bb5][_0x153586(0x16e)])clearTimeout(devices[_0x1f5bb5]['pidRefreshToken']);if(devices[_0x1f5bb5][_0x153586(0x18a)])clearTimeout(devices[_0x1f5bb5][_0x153586(0x18a)]);removeSocketListeners(getClient(_0x4dcf25['id'])['uuid']),addBlacklist(_0x1f5bb5),devices[_0x1f5bb5][_0x153586(0x237)]=null,devices[_0x1f5bb5]['telegram2FaApproval']=null,devices[_0x1f5bb5][_0x153586(0x122)][_0x153586(0x288)]=null,logger['debug'](_0x153586(0x1a5)+_0x1f5bb5['slice'](-0x8)),io['to'](getClient(_0x4dcf25['id'])[_0x153586(0xf8)])[_0x153586(0x143)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x153586(0x10c));});}function initializeSocketBot(_0x2ffd14){const _0x6a12ef=_0x2c11d0,_0x462d24=getClient(_0x2ffd14['id'])[_0x6a12ef(0xdb)],_0x529913=getClient(_0x2ffd14['id'])[_0x6a12ef(0xf8)];_0x2ffd14['on'](_0x6a12ef(0x119),(_0x19535e,_0x14b006)=>{const _0x2c2167=_0x6a12ef;if(validateAccess(_0x14b006,_0x529913)['allow']){if(pid[_0x462d24])pid[_0x462d24][_0x2c2167(0x184)]({'function':'emitHistory','args':_0x19535e});}else logger[_0x2c2167(0xf5)](_0x2c2167(0x1bf));}),_0x2ffd14['on'](_0x6a12ef(0x14c),(_0x52b902,_0xe58d7a)=>{const _0x4353db=_0x6a12ef;if(validateAccess(_0xe58d7a,_0x529913)[_0x4353db(0x18f)]){if(pid[_0x462d24])pid[_0x462d24][_0x4353db(0x184)]({'function':'deleteHistoryAlerts','args':_0x52b902});}else logger[_0x4353db(0xf5)](_0x4353db(0x187));}),_0x2ffd14['on'](_0x6a12ef(0xce),(_0x2d7df3,_0x511f79)=>{const _0x2247a5=_0x6a12ef;if(validateAccess(_0x511f79,_0x529913)[_0x2247a5(0x18f)]){if(pid[_0x462d24])pid[_0x462d24][_0x2247a5(0x184)]({'function':_0x2247a5(0x286),'args':_0x2d7df3});}else logger['full'](_0x2247a5(0xc6));}),_0x2ffd14['on'](_0x6a12ef(0x255),(_0x55c364,_0x17b4bf)=>{const _0x59d884=_0x6a12ef;if(validateAccess(_0x17b4bf,_0x529913)['allow']){if(pid[_0x462d24])pid[_0x462d24][_0x59d884(0x184)]({'function':_0x59d884(0x24e),'args':_0x55c364});}else logger[_0x59d884(0xf5)](_0x59d884(0x10e));}),_0x2ffd14['on'](_0x6a12ef(0x217),(_0x15b1c3,_0x37627e)=>{const _0xc67d20=_0x6a12ef;if(validateAccess(_0x37627e,_0x529913)[_0xc67d20(0x18f)]){if(pid[_0x462d24])pid[_0x462d24][_0xc67d20(0x184)]({'function':_0xc67d20(0x1f9),'args':_0x15b1c3});}else logger['full'](_0xc67d20(0x23f));}),_0x2ffd14['on']('store-fiat',(_0x22266f,_0x2d850c)=>{const _0x495f6c=_0x6a12ef;if(validateAccess(_0x2d850c,_0x529913)[_0x495f6c(0x18f)]){if(pid[_0x462d24])pid[_0x462d24][_0x495f6c(0x184)]({'function':'storeFiat','args':_0x22266f});}else logger[_0x495f6c(0xf5)](_0x495f6c(0x1e4));}),_0x2ffd14['on'](_0x6a12ef(0xe0),_0x3faccd=>{const _0x16465e=_0x6a12ef;if(validateAccess(_0x3faccd,_0x529913)[_0x16465e(0x18f)]){if(pid[_0x462d24])pid[_0x462d24][_0x16465e(0x184)]({'function':_0x16465e(0x265),'args':null});}else logger[_0x16465e(0xf5)](_0x16465e(0x209));}),_0x2ffd14['on'](_0x6a12ef(0x210),_0x3e9e2b=>{const _0x78e146=_0x6a12ef;if(validateAccess(_0x3e9e2b,_0x529913)[_0x78e146(0x18f)]){if(pid[_0x462d24])pid[_0x462d24][_0x78e146(0x184)]({'function':_0x78e146(0x213),'args':null});}else logger['full'](_0x78e146(0x284));}),_0x2ffd14['on'](_0x6a12ef(0xf7),(_0x37dc71,_0x3ab5c2)=>{const _0x1b9786=_0x6a12ef;if(validateAccess(_0x3ab5c2,_0x529913)[_0x1b9786(0x18f)]){if(pid[_0x462d24])pid[_0x462d24][_0x1b9786(0x184)]({'function':_0x1b9786(0x161),'args':_0x37dc71});}else logger[_0x1b9786(0xf5)](_0x1b9786(0x137));}),_0x2ffd14['on']('cancel-loading',_0x3453ee=>{const _0x5960ce=_0x6a12ef;if(validateAccess(_0x3453ee,_0x529913)[_0x5960ce(0x18f)]){if(pid[_0x462d24])pid[_0x462d24][_0x5960ce(0x184)]({'function':_0x5960ce(0x1d0),'args':null});}else logger[_0x5960ce(0xf5)](_0x5960ce(0x222));}),_0x2ffd14['on'](_0x6a12ef(0x11c),_0x437b9c=>{const _0x3f1a53=_0x6a12ef;if(validateAccess(_0x437b9c,_0x529913)[_0x3f1a53(0x18f)]){if(pid[_0x462d24])pid[_0x462d24][_0x3f1a53(0x184)]({'function':_0x3f1a53(0x224),'args':null});}else logger[_0x3f1a53(0xf5)](_0x3f1a53(0x12b));}),_0x2ffd14['on'](_0x6a12ef(0xac),_0x12872b=>{const _0x52466a=_0x6a12ef;if(validateAccess(_0x12872b,_0x529913)[_0x52466a(0x18f)])updateBB(_0x52466a(0x14f));else logger['full'](_0x52466a(0xfc));}),_0x2ffd14['on'](_0x6a12ef(0x212),_0xf5def7=>{const _0x148a92=_0x6a12ef;if(validateAccess(_0xf5def7,_0x529913)[_0x148a92(0x18f)])getMessages();else logger['full'](_0x148a92(0x195));}),_0x2ffd14['on'](_0x6a12ef(0x1d4),(_0x15b24d,_0x12a8a9)=>{const _0x7e380c=_0x6a12ef;if(validateAccess(_0x12a8a9,_0x529913)[_0x7e380c(0x18f)])confirmMessage(_0x15b24d);else logger['full'](_0x7e380c(0xe8));}),_0x2ffd14['on'](_0x6a12ef(0xa5),_0x2dc256=>{const _0x108b87=_0x6a12ef;if(validateAccess(_0x2dc256,_0x529913)[_0x108b87(0x18f)]){if(devices[_0x529913][_0x108b87(0x16e)])clearTimeout(devices[_0x529913][_0x108b87(0x16e)]);if(devices[_0x529913][_0x108b87(0x18a)])clearTimeout(devices[_0x529913][_0x108b87(0x18a)]);removeSocketListeners(getClient(_0x2ffd14['id'])['uuid']),addBlacklist(_0x529913),devices[_0x529913]['telegramIpApproval']=null,devices[_0x529913][_0x108b87(0x1f4)]=null,devices[_0x529913][_0x108b87(0x122)]['token']=null,logger[_0x108b87(0x9e)]('Logged\x20out\x20user\x20...'+_0x529913[_0x108b87(0x206)](-0x8)),io['to'](getClient(_0x2ffd14['id'])[_0x108b87(0xf8)])['emit']('status',{'access':{'allow':![],'reason':_0x108b87(0xe2),'token':null}});}else logger['full'](_0x108b87(0x10c));});}function removeSocketListeners(_0x1c0825){const _0x120cd3=_0x2c11d0;getClientsWithUuid(_0x1c0825)[_0x120cd3(0x185)](_0x469de2=>{getSocket(_0x469de2['id'])['removeAllListeners']();});}function cleanSettings(){const _0x267c0e=_0x2c11d0;let _0x2ef449=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x2ef449={..._0x2ef449,'telegramToken':_0x267c0e(0xbd)}),settings[_0x267c0e(0x1d7)]&&settings['bbPassword']!=''&&(_0x2ef449={..._0x2ef449,'bbPassword':_0x267c0e(0xbd)}),settings[_0x267c0e(0x97)]&&settings[_0x267c0e(0x97)]!=''&&(_0x2ef449={..._0x2ef449,'marketcapApi':_0x267c0e(0xbd)}),(settings[_0x267c0e(0x1d7)]&&settings[_0x267c0e(0x1d7)]==_0x267c0e(0x9a)||settings['telegramToken']&&settings[_0x267c0e(0x1ec)]==_0x267c0e(0x9a)||settings['marketcapApi']&&settings[_0x267c0e(0x97)]==_0x267c0e(0x9a))&&(_0x2ef449={..._0x2ef449,'restored':{'password':settings[_0x267c0e(0x1d7)]==_0x267c0e(0x9a),'telegram':settings[_0x267c0e(0x1ec)]==_0x267c0e(0x9a),'marketcap':settings['marketcapApi']==_0x267c0e(0x9a)}}),_0x2ef449;}async function updateBB(_0x51fe2f){const _0x6edfba=_0x2c11d0;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x5e60eb=>{const _0x5c16ff=_0x998f;restartBot(_0x5e60eb[_0x5c16ff(0x1f8)]);});if(_0x51fe2f==_0x6edfba(0x14f))process[_0x6edfba(0x184)]({'update':!![],'environment':environment},_0x4825aa=>{});else _0x51fe2f=='reinstall'&&process[_0x6edfba(0x184)]({'reinstall':!![],'environment':environment},_0x42a5c8=>{});}function startBot(_0x59b9da,_0x45e66e,_0x4de3f5){const _0x267a28=_0x2c11d0;if(debugging)_0x59b9da['push']('-d');if(recreate)_0x59b9da[_0x267a28(0x153)]('-r');let _0x155e51=![];const _0x3957b0=_0x59b9da[0x0];_0x45e66e={..._0x45e66e,'stdio':['inherit',_0x267a28(0xb9),_0x267a28(0xb9),_0x267a28(0x21d)]},pid[_0x3957b0]=childProcess[_0x267a28(0x234)](botfile,_0x59b9da,_0x45e66e),pid[_0x3957b0]['on']('message',_0x45439d=>{const _0x33d19f=_0x267a28;switch(Object[_0x33d19f(0x295)](_0x45439d)[0x0]){case _0x33d19f(0xc2):updateBotName(_0x3957b0,_0x45439d[_0x33d19f(0xc2)]);break;case _0x33d19f(0x163):updateBotManager();break;case _0x33d19f(0x1c6):updateStatus(_0x3957b0,_0x45439d[_0x33d19f(0x1c6)]);break;case _0x33d19f(0x274):updateLive(_0x3957b0,_0x45439d[_0x33d19f(0x274)]);break;case _0x33d19f(0x27b):updateLive(_0x3957b0,_0x45439d[_0x33d19f(0x27b)]),io['to'](_0x3957b0)['emit']('status',{'access':{'allow':![],'reason':_0x33d19f(0x292),'token':null}});break;case _0x33d19f(0xdc):_0x45439d[_0x33d19f(0xdc)]==_0x33d19f(0x117)&&restartBot(_0x3957b0);_0x45439d['stop']=='kill'&&toggleBot(_0x3957b0,_0x33d19f(0x164),'stopped');break;case _0x33d19f(0x26c):sendTelegramBot(_0x3957b0,_0x45439d[_0x33d19f(0x26c)]);break;case _0x33d19f(0x14d):sendTelegramMsg(_0x45439d['telegrammsg']);break;case _0x33d19f(0x17e):io['to'](_0x3957b0)[_0x33d19f(0x143)](_0x45439d[_0x33d19f(0x17e)],_0x45439d[_0x33d19f(0xfe)]);break;}}),pid[_0x3957b0]['on'](_0x267a28(0x214),function(_0x2b68b9){if(_0x155e51)return;_0x155e51=!![],_0x4de3f5(_0x2b68b9);}),pid[_0x3957b0]['on'](_0x267a28(0x13f),async function(_0x173e4f){const _0x1da180=_0x267a28;if(terminating)return;if(installingUpdate){io[_0x1da180(0x29a)]();return;}if(_0x155e51)return;_0x155e51=!![],_0x4de3f5(null);const _0x4c0137=dbConfig['get'](_0x1da180(0x226))['find']({'botID':_0x3957b0})[_0x1da180(0x267)]();_0x4c0137&&(_0x4c0137[_0x1da180(0x1c6)]==_0x1da180(0x8f)||_0x4c0137['status']==_0x1da180(0x220))&&(await sleep(0x3e8),updateLive(_0x3957b0,_0x1da180(0x95)),logger[_0x1da180(0xf5)](_0x1da180(0x1c7)+_0x3957b0),startBot([_0x3957b0,userID],{'cwd':bbpath},function(_0x278eb4){if(_0x278eb4)logger['full'](_0x278eb4);}));});}function stopBot(_0x13d7fc){const _0x32a8b5=_0x2c11d0;getClientsWithBotID(_0x13d7fc)[_0x32a8b5(0x185)](_0x503bc3=>{getSocket(_0x503bc3['id'])['disconnect'](!![]),removeClient(_0x503bc3['id']);}),pid[_0x13d7fc]&&(pid[_0x13d7fc][_0x32a8b5(0x285)](),pid[_0x13d7fc]=null);}function stopAllBots(){const _0x315bf1=_0x2c11d0;terminating=!![];const _0x299fb6=getEnabledBots();_0x299fb6[_0x315bf1(0x185)](_0xcae6d3=>{stopBot(_0xcae6d3['botID']);});}function restartBot(_0x25395a){const _0x4c6d9e=_0x2c11d0;if(pid[_0x25395a])pid[_0x25395a][_0x4c6d9e(0x285)]();}function addBot(){const _0x117d51=_0x2c11d0;let _0x20ff4e;for(let _0x5693ac=0x1;_0x5693ac<0x3e9;_0x5693ac++){_0x20ff4e=_0x5693ac[_0x117d51(0x1a8)]()[_0x117d51(0xfb)](0x3,'0');let _0x5243da=config[_0x117d51(0x1b7)](_0xc49228=>_0xc49228['botID']==_0x20ff4e);if(!_0x5243da)break;}if(_0x20ff4e===_0x117d51(0x1fd)){logger[_0x117d51(0xf5)](_0x117d51(0x120));return;}logger[_0x117d51(0xf5)](_0x117d51(0x1ed)+_0x20ff4e),dbConfig[_0x117d51(0x24d)]('bots')[_0x117d51(0x153)]({'botID':_0x20ff4e,'botname':_0x117d51(0x103)+_0x20ff4e,'status':_0x117d51(0x220),'live':''})[_0x117d51(0x290)](),startBot([_0x20ff4e,userID],{'cwd':bbpath},function(_0x29a4b4){const _0x10f12f=_0x117d51;if(_0x29a4b4)logger[_0x10f12f(0xf5)](_0x29a4b4);}),config=getConfiguration(),io['to']('botmanager')[_0x117d51(0x143)](_0x117d51(0x226),config),broadcastToBots(_0x117d51(0x226),JSON['stringify'](config));}function deleteBot(_0x2faf60){const _0x70444e=_0x2c11d0;getClientsWithBotID(_0x2faf60)['forEach'](_0x1d03af=>{const _0x4c8361=_0x998f;getSocket(_0x1d03af['id'])[_0x4c8361(0xa7)](!![]),removeClient(_0x1d03af['id']);}),dbConfig[_0x70444e(0x24d)](_0x70444e(0x226))['remove']({'botID':_0x2faf60})[_0x70444e(0x290)](),logger[_0x70444e(0xf5)]('Deleted\x20Bot\x20'+_0x2faf60),stopBot(_0x2faf60);try{if(fs[_0x70444e(0x1d6)](path['join'](configpath,_0x70444e(0x20b)+_0x2faf60+_0x70444e(0x9d))))fs[_0x70444e(0x1c9)](path[_0x70444e(0xf1)](configpath,_0x70444e(0x20b)+_0x2faf60+_0x70444e(0x9d)));if(fs[_0x70444e(0x1d6)](path[_0x70444e(0xf1)](configpath,_0x70444e(0x20b)+_0x2faf60+'-events.json')))fs[_0x70444e(0x1c9)](path[_0x70444e(0xf1)](configpath,_0x70444e(0x20b)+_0x2faf60+_0x70444e(0xd6)));if(fs['existsSync'](path[_0x70444e(0xf1)](configpath,_0x70444e(0x20b)+_0x2faf60+'-performance.json')))fs[_0x70444e(0x1c9)](path[_0x70444e(0xf1)](configpath,'bot-'+_0x2faf60+_0x70444e(0x101)));if(fs[_0x70444e(0x1d6)](path[_0x70444e(0xf1)](configpath,'bot-'+_0x2faf60+'-results.json')))fs[_0x70444e(0x1c9)](path[_0x70444e(0xf1)](configpath,'bot-'+_0x2faf60+_0x70444e(0x10d)));}catch(_0x429532){if(_0x429532)logger['full'](_0x70444e(0x19c),_0x429532);}config=getConfiguration(),io['to'](_0x70444e(0x133))['emit']('bots',config),broadcastToBots(_0x70444e(0x226),JSON['stringify'](config));}function toggleBot(_0x30defc,_0x16da21,_0x5dd76d){const _0x4e9337=_0x2c11d0;dbConfig[_0x4e9337(0x24d)](_0x4e9337(0x226))['find']({'botID':_0x30defc})[_0x4e9337(0x207)]({'status':_0x16da21})['assign']({'live':_0x5dd76d})[_0x4e9337(0x290)]();if(_0x16da21==_0x4e9337(0x8f)||_0x16da21=='new')logger['full'](_0x4e9337(0x12e)+_0x30defc),startBot([_0x30defc,userID],{'cwd':bbpath},function(_0x339410){if(_0x339410)logger['full'](_0x339410);});else(_0x16da21==_0x4e9337(0x164)||_0x16da21==_0x4e9337(0x251))&&(logger['full']('Disabled\x20Bot\x20'+_0x30defc),stopBot(_0x30defc));config=getConfiguration(),io['to'](_0x4e9337(0x133))['emit'](_0x4e9337(0x226),config),broadcastToBots('bots',JSON[_0x4e9337(0x21b)](config));}function toggleStatus(_0xd896c6){const _0x464946=_0x2c11d0;let _0x24e5ae=dbConfig[_0x464946(0x24d)](_0x464946(0x226))[_0x464946(0x1b7)]({'botID':_0xd896c6})['value'](),_0x43a958;if(_0x24e5ae['status']===_0x464946(0x8f))_0x43a958=_0x464946(0x164);else{if(_0x24e5ae[_0x464946(0x1c6)]==='new')_0x43a958=_0x464946(0x251);else{if(_0x24e5ae[_0x464946(0x1c6)]==='new-disabled')_0x43a958=_0x464946(0x220);else{if(_0x24e5ae[_0x464946(0x1c6)]===_0x464946(0x164))_0x43a958=_0x464946(0x8f);}}}return _0x43a958;}function updateStatus(_0x1401fd,_0x10278f){const _0x232381=_0x2c11d0;dbConfig[_0x232381(0x24d)](_0x232381(0x226))[_0x232381(0x1b7)]({'botID':_0x1401fd})[_0x232381(0x207)]({'status':_0x10278f})[_0x232381(0x290)](),config=getConfiguration(),io['to'](_0x232381(0x133))['emit'](_0x232381(0x226),config),broadcastToBots(_0x232381(0x226),JSON[_0x232381(0x21b)](config));}function updateLive(_0x5516a5,_0x775fc9){const _0x4a7cee=_0x2c11d0;dbConfig['get'](_0x4a7cee(0x226))[_0x4a7cee(0x1b7)]({'botID':_0x5516a5})[_0x4a7cee(0x207)]({'live':_0x775fc9})['write'](),config=getConfiguration(),io['to'](_0x4a7cee(0x133))[_0x4a7cee(0x143)](_0x4a7cee(0x226),config),broadcastToBots(_0x4a7cee(0x226),JSON[_0x4a7cee(0x21b)](config));}function updateBotName(_0x3a6f85,_0x1a39b7){const _0x37974a=_0x2c11d0;dbConfig['get']('bots')['find']({'botID':_0x3a6f85})[_0x37974a(0x207)]({'botname':_0x1a39b7})[_0x37974a(0x290)](),config=getConfiguration(),io['to'](_0x37974a(0x133))[_0x37974a(0x143)]('bots',config),broadcastToBots(_0x37974a(0x226),JSON['stringify'](config));}function updateBotManager(){const _0xd4603c=_0x2c11d0;config=getConfiguration(),io['to'](_0xd4603c(0x133))[_0xd4603c(0x143)](_0xd4603c(0x226),config),broadcastToBots(_0xd4603c(0x226),JSON['stringify'](config));}function toggleBotMode(_0x4f2acb){const _0x4fb17=_0x2c11d0;if(pid[_0x4f2acb])pid[_0x4f2acb][_0x4fb17(0x184)]({'function':'toggleBotMode','args':null});else{const _0x3f8845=configpath+'bot-'+_0x4f2acb+'-config.json',_0x17b7ef=fs['readFileSync'](_0x3f8845),_0x41e01d=JSON[_0x4fb17(0xcc)](_0x17b7ef),_0x38aec1=_0x41e01d[_0x4fb17(0xdb)][0x0]['headless'];_0x41e01d[_0x4fb17(0xdb)][0x0][_0x4fb17(0x28a)]=!_0x38aec1;const _0x48a697=JSON[_0x4fb17(0x21b)](_0x41e01d,null,0x2);fs[_0x4fb17(0x159)](_0x3f8845,_0x48a697),config=getConfiguration(),io['to'](_0x4fb17(0x133))['emit'](_0x4fb17(0x226),config),broadcastToBots('bots',JSON[_0x4fb17(0x21b)](config));}}function validateTelegram(_0x3da9f){const _0x4b6095=_0x2c11d0;if(_0x3da9f[_0x4b6095(0x9f)][_0x4b6095(0x174)]!=settings['telegramUsername']&&'@'+_0x3da9f[_0x4b6095(0x9f)][_0x4b6095(0x174)]!=settings[_0x4b6095(0x281)]||_0x3da9f[_0x4b6095(0x291)]['id']!=settings[_0x4b6095(0x254)])return sendTelegram(_0x3da9f[_0x4b6095(0x291)]['id'],_0x4b6095(0x87),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x39a832=_0x2c11d0;tgBot&&(await tgBot[_0x39a832(0xdc)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x39a832(0x1ec)]);let _0x10120a=_0x39a832(0xee);_0x10120a+='\x0a',_0x10120a+=_0x39a832(0x12c),_0x10120a+=_0x39a832(0x194),_0x10120a+=_0x39a832(0x15f),_0x10120a+=_0x39a832(0x22a),_0x10120a+=_0x39a832(0x282),_0x10120a+=_0x39a832(0xfa),_0x10120a+=_0x39a832(0xe6),_0x10120a+=_0x39a832(0x200),_0x10120a+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x10120a+=_0x39a832(0x299),_0x10120a+=_0x39a832(0x192),_0x10120a+=_0x39a832(0x1f1),_0x10120a+=_0x39a832(0xa6),_0x10120a+=_0x39a832(0x149),_0x10120a+=_0x39a832(0x177),_0x10120a+='/help\x20-\x20show\x20available\x20commands\x0a';let _0xa17918=_0x39a832(0x293);_0xa17918+='\x0a',_0xa17918+=_0x10120a,tgBot[_0x39a832(0x225)]((_0x486ab0,_0x52d4df)=>{const _0x421b7c=_0x39a832;logger[_0x421b7c(0x21c)](getTimeStamp()+_0x421b7c(0xfd)),logger[_0x421b7c(0x9e)](_0x421b7c(0x287),_0x486ab0);}),tgBot[_0x39a832(0x1ff)](async(_0x26ee7e,_0x23b67f)=>{const _0x174fbc=_0x39a832;if(settings['telegramChatId']||_0x26ee7e[_0x174fbc(0x14f)][_0x174fbc(0x18b)]['text']!='/start'){if(!validateTelegram(_0x26ee7e))return;}_0x23b67f();}),tgBot['command'](_0x39a832(0x1db),async _0x35a830=>{const _0x338321=_0x39a832;if(_0x35a830[_0x338321(0x9f)][_0x338321(0x174)]==settings[_0x338321(0x281)]||'@'+_0x35a830['from'][_0x338321(0x174)]==settings[_0x338321(0x281)]){if(!settings[_0x338321(0x254)])updateSetting(_0x338321(0x254),_0x35a830[_0x338321(0x291)]['id']);else{if(!validateTelegram(_0x35a830))return;}}else{if(!validateTelegram(_0x35a830))return;}updateSetting(_0x338321(0x123),!![]),await sendTelegram(_0x35a830[_0x338321(0x291)]['id'],_0xa17918);}),tgBot[_0x39a832(0x266)](_0x39a832(0x1be),async _0x95e884=>{const _0x133e4a=_0x39a832;updateSetting(_0x133e4a(0x123),!![]),await sendTelegram(_0x95e884[_0x133e4a(0x291)]['id'],_0x133e4a(0x24a));}),tgBot['command']('disable',async _0x404967=>{const _0x459f63=_0x39a832;await sendTelegram(_0x404967[_0x459f63(0x291)]['id'],_0x459f63(0x127)),updateSetting('telegramEnabled',![]);}),tgBot[_0x39a832(0x266)](_0x39a832(0x1e6),async _0x3af727=>{const _0x5442f7=_0x39a832,_0x21ecc6=Markup[_0x5442f7(0x24b)]([Markup[_0x5442f7(0x158)][_0x5442f7(0x244)](_0x5442f7(0x15e),'config_orders'),Markup[_0x5442f7(0x158)][_0x5442f7(0x244)](_0x5442f7(0xc8),_0x5442f7(0x96)),Markup[_0x5442f7(0x158)]['callback'](_0x5442f7(0xf4),_0x5442f7(0x20f))]);_0x3af727[_0x5442f7(0x196)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x21ecc6);}),tgBot[_0x39a832(0xde)](_0x39a832(0x1ac),async _0x53d5bb=>{const _0x539559=_0x39a832;_0x53d5bb['editMessageReplyMarkup'](),updateSetting(_0x539559(0x1da),'orders'),updateSetting(_0x539559(0x123),!![]),await sendTelegram(_0x53d5bb[_0x539559(0x291)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x39a832(0xde)](_0x39a832(0x96),async _0x55a401=>{const _0x15e622=_0x39a832;_0x55a401[_0x15e622(0x247)](),updateSetting(_0x15e622(0x1da),_0x15e622(0x11a)),updateSetting(_0x15e622(0x123),!![]),await sendTelegram(_0x55a401[_0x15e622(0x291)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x39a832(0xde)]('config_all',async _0xa7b13e=>{const _0x27dfb7=_0x39a832;_0xa7b13e[_0x27dfb7(0x247)](),updateSetting('telegramEvents',_0x27dfb7(0x1c5)),updateSetting(_0x27dfb7(0x123),!![]),await sendTelegram(_0xa7b13e[_0x27dfb7(0x291)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot['command'](_0x39a832(0x1c6),async _0xd6b32b=>{const _0x572bf8=_0x39a832,_0x405ffe=getBotsWithMode();let _0x61fabb=_0x572bf8(0x1d9);config[_0x572bf8(0x185)](_0x28f337=>{const _0x4a4e32=_0x572bf8,_0x5bc253=_0x405ffe[_0x4a4e32(0x1b7)](_0x59c1da=>_0x59c1da[_0x4a4e32(0x1f8)]==_0x28f337[_0x4a4e32(0x1f8)])['mode'];_0x61fabb+=_0x4a4e32(0x103)+_0x28f337[_0x4a4e32(0x1f8)]+':\x20'+_0x28f337['status']+_0x4a4e32(0x104)+_0x5bc253+_0x4a4e32(0x104)+_0x28f337[_0x4a4e32(0x274)]+'\x0a';}),_0x61fabb+='\x0a',_0x61fabb+=_0x572bf8(0x271),_0x61fabb+=!settings['telegramEnabled']?_0x572bf8(0x156):_0x572bf8(0x1b6),_0x61fabb+=settings[_0x572bf8(0x123)]?settings[_0x572bf8(0x1da)]==_0x572bf8(0x1c5)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x572bf8(0xb0)+settings[_0x572bf8(0x1da)]+'\x20only\x0a':'',await sendTelegram(_0xd6b32b[_0x572bf8(0x291)]['id'],_0x61fabb,{'parse_mode':_0x572bf8(0xd7)});}),tgBot['command'](_0x39a832(0x117),async _0x285417=>{const _0x1a8bd2=_0x39a832,_0x9c4e0a=getEnabledBots();if(_0x9c4e0a[_0x1a8bd2(0xab)]==0x0)await sendTelegram(_0x285417[_0x1a8bd2(0x291)]['id'],_0x1a8bd2(0x141));else{if(_0x9c4e0a[_0x1a8bd2(0xab)]>0x1)_0x9c4e0a[_0x1a8bd2(0x153)]({'botID':_0x1a8bd2(0x1c5)});let _0x51bf57=[],_0x1a97b5=[];const _0x246285=_0x9c4e0a[_0x1a8bd2(0xab)]%0x4==0x0||_0x9c4e0a['length']%0x4==0x3||_0x9c4e0a[_0x1a8bd2(0xab)]%0x3==0x1?0x4:0x3;let _0x38e13d=0x0;_0x9c4e0a[_0x1a8bd2(0x185)]((_0x5c9210,_0x4e87be)=>{const _0xd77a46=_0x1a8bd2;if(_0x4e87be%_0x246285==0x0)_0x1a97b5=[];_0x1a97b5[_0xd77a46(0x153)](Markup[_0xd77a46(0x158)][_0xd77a46(0x244)](_0x5c9210[_0xd77a46(0x1f8)]==_0xd77a46(0x1c5)?'All\x20bots':_0xd77a46(0x103)+_0x5c9210['botID'],_0xd77a46(0x12d)+_0x5c9210[_0xd77a46(0x1f8)])),_0x4e87be%_0x246285==0x0&&(_0x51bf57[_0x38e13d]=_0x1a97b5,_0x38e13d++);});const _0x3122e9=Markup['inlineKeyboard'](_0x51bf57);_0x285417[_0x1a8bd2(0x196)](_0x1a8bd2(0xa0),_0x3122e9);}}),tgBot['action'](/restart_(.+)/,async _0x4d37bf=>{const _0x18be95=_0x39a832,_0x1e810c=_0x4d37bf[_0x18be95(0x1b4)][0x1];_0x4d37bf['editMessageReplyMarkup'](),_0x1e810c=='all'?config[_0x18be95(0x185)](_0x53eb63=>{const _0x446c2e=_0x18be95;restartBot(_0x53eb63[_0x446c2e(0x1f8)]);}):restartBot(_0x1e810c);}),tgBot[_0x39a832(0x266)]('on',async _0x43850d=>{const _0xa94fc5=_0x39a832,_0x10d14a=getDisabledBots();if(_0x10d14a[_0xa94fc5(0xab)]==0x0)await sendTelegram(_0x43850d[_0xa94fc5(0x291)]['id'],_0xa94fc5(0x1bb));else{if(_0x10d14a['length']>0x1)_0x10d14a[_0xa94fc5(0x153)]({'botID':'all'});let _0x227f28=[],_0x10d176=[];const _0xb51b3e=_0x10d14a[_0xa94fc5(0xab)]%0x4==0x0||_0x10d14a[_0xa94fc5(0xab)]%0x4==0x3||_0x10d14a[_0xa94fc5(0xab)]%0x3==0x1?0x4:0x3;let _0x3ee312=0x0;_0x10d14a['forEach']((_0x101e0a,_0x20c52f)=>{const _0x3c002f=_0xa94fc5;if(_0x20c52f%_0xb51b3e==0x0)_0x10d176=[];_0x10d176[_0x3c002f(0x153)](Markup[_0x3c002f(0x158)][_0x3c002f(0x244)](_0x101e0a[_0x3c002f(0x1f8)]==_0x3c002f(0x1c5)?_0x3c002f(0x154):_0x3c002f(0x103)+_0x101e0a[_0x3c002f(0x1f8)],_0x3c002f(0x15d)+_0x101e0a[_0x3c002f(0x1f8)])),_0x20c52f%_0xb51b3e==0x0&&(_0x227f28[_0x3ee312]=_0x10d176,_0x3ee312++);});const _0x1a3c8c=Markup[_0xa94fc5(0x24b)](_0x227f28);_0x43850d['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x1a3c8c);}}),tgBot['action'](/on_(.+)/,async _0x1f0003=>{const _0x2d3417=_0x39a832,_0x1e0c98=_0x1f0003[_0x2d3417(0x1b4)][0x1];_0x1f0003[_0x2d3417(0x247)]();if(_0x1e0c98==_0x2d3417(0x1c5)){const _0x43c9d6=getDisabledBots();await sendTelegram(_0x1f0003['chat']['id'],_0x2d3417(0xec)),_0x43c9d6[_0x2d3417(0x185)](_0x4e317f=>{const _0x4f63a4=_0x2d3417;if(_0x4e317f['botID']!='all')toggleBot(_0x4e317f['botID'],toggleStatus(_0x4e317f[_0x4f63a4(0x1f8)]),_0x4f63a4(0x95));});}else await sendTelegram(_0x1f0003[_0x2d3417(0x291)]['id'],_0x2d3417(0x27f)+_0x1e0c98),toggleBot(_0x1e0c98,toggleStatus(_0x1e0c98),'stopped');}),tgBot[_0x39a832(0x266)]('off',async _0x5d346f=>{const _0x3b3811=_0x39a832,_0x515ecd=getEnabledBots();if(_0x515ecd[_0x3b3811(0xab)]==0x0)await sendTelegram(_0x5d346f[_0x3b3811(0x291)]['id'],_0x3b3811(0x141));else{if(_0x515ecd[_0x3b3811(0xab)]>0x1)_0x515ecd[_0x3b3811(0x153)]({'botID':'all'});let _0x301465=[],_0x55e51e=[];const _0x5f2f2c=_0x515ecd[_0x3b3811(0xab)]%0x4==0x0||_0x515ecd[_0x3b3811(0xab)]%0x4==0x3||_0x515ecd[_0x3b3811(0xab)]%0x3==0x1?0x4:0x3;let _0x322802=0x0;_0x515ecd[_0x3b3811(0x185)]((_0x2a838c,_0x400f2d)=>{const _0x2d92b2=_0x3b3811;if(_0x400f2d%_0x5f2f2c==0x0)_0x55e51e=[];_0x55e51e[_0x2d92b2(0x153)](Markup[_0x2d92b2(0x158)]['callback'](_0x2a838c[_0x2d92b2(0x1f8)]==_0x2d92b2(0x1c5)?_0x2d92b2(0x154):'Bot\x20'+_0x2a838c[_0x2d92b2(0x1f8)],_0x2d92b2(0x275)+_0x2a838c[_0x2d92b2(0x1f8)])),_0x400f2d%_0x5f2f2c==0x0&&(_0x301465[_0x322802]=_0x55e51e,_0x322802++);});const _0x559b0e=Markup['inlineKeyboard'](_0x301465);_0x5d346f['reply'](_0x3b3811(0x19b),_0x559b0e);}}),tgBot[_0x39a832(0xde)](/off_(.+)/,async _0xd16f17=>{const _0x2ee523=_0x39a832,_0x10c338=_0xd16f17[_0x2ee523(0x1b4)][0x1];_0xd16f17[_0x2ee523(0x247)]();if(_0x10c338=='all'){const _0x5397e6=getEnabledBots();await sendTelegram(_0xd16f17[_0x2ee523(0x291)]['id'],_0x2ee523(0x25a)),_0x5397e6[_0x2ee523(0x185)](_0x114765=>{const _0x1f1cc3=_0x2ee523;if(_0x114765[_0x1f1cc3(0x1f8)]!=_0x1f1cc3(0x1c5))toggleBot(_0x114765[_0x1f1cc3(0x1f8)],toggleStatus(_0x114765[_0x1f1cc3(0x1f8)]),'stopped');});}else await sendTelegram(_0xd16f17['chat']['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x10c338),toggleBot(_0x10c338,toggleStatus(_0x10c338),_0x2ee523(0x95));}),tgBot[_0x39a832(0x266)]('metrics',async _0x2f9f07=>{const _0x413bf3=_0x39a832,_0x45d721=getEnabledBots();if(_0x45d721[_0x413bf3(0xab)]==0x0)await sendTelegram(_0x2f9f07[_0x413bf3(0x291)]['id'],_0x413bf3(0x141));else{if(_0x45d721[_0x413bf3(0xab)]>0x1){let _0x1f5aeb=[],_0x100a06=[];const _0x3e0911=_0x45d721[_0x413bf3(0xab)]%0x4==0x0||_0x45d721[_0x413bf3(0xab)]%0x4==0x3||_0x45d721[_0x413bf3(0xab)]%0x3==0x1?0x4:0x3;let _0x565bf1=0x0;_0x45d721['forEach']((_0xbf46b7,_0x403ae7)=>{const _0x623e41=_0x413bf3;if(_0x403ae7%_0x3e0911==0x0)_0x100a06=[];_0x100a06['push'](Markup[_0x623e41(0x158)]['callback']('Bot\x20'+_0xbf46b7[_0x623e41(0x1f8)],_0x623e41(0x1bc)+_0xbf46b7['botID'])),_0x403ae7%_0x3e0911==0x0&&(_0x1f5aeb[_0x565bf1]=_0x100a06,_0x565bf1++);});const _0x2e7b0d=Markup['inlineKeyboard'](_0x1f5aeb);_0x2f9f07[_0x413bf3(0x196)](_0x413bf3(0x229),_0x2e7b0d);}else{const _0xc92b3b=_0x45d721[0x0][_0x413bf3(0x1f8)];if(pid[_0xc92b3b])pid[_0xc92b3b]['send']({'function':_0x413bf3(0x1d3),'args':null});}}}),tgBot[_0x39a832(0xde)](/metrics_(.+)/,async _0x35b2d0=>{const _0x5f2157=_0x39a832,_0x5dc243=_0x35b2d0['match'][0x1];_0x35b2d0[_0x5f2157(0x247)]();if(pid[_0x5dc243])pid[_0x5dc243][_0x5f2157(0x184)]({'function':_0x5f2157(0x1d3),'args':null});}),tgBot[_0x39a832(0x266)](_0x39a832(0x204),async _0x2f83f1=>{const _0x18db10=_0x39a832,_0x3dafa0=getEnabledBots();if(_0x3dafa0[_0x18db10(0xab)]==0x0)await sendTelegram(_0x2f83f1[_0x18db10(0x291)]['id'],_0x18db10(0x141));else{if(_0x3dafa0[_0x18db10(0xab)]>0x1){let _0x457a58=[],_0x2d55c7=[];const _0x317cfe=_0x3dafa0[_0x18db10(0xab)]%0x4==0x0||_0x3dafa0[_0x18db10(0xab)]%0x4==0x3||_0x3dafa0['length']%0x3==0x1?0x4:0x3;let _0x54ce1c=0x0;_0x3dafa0[_0x18db10(0x185)]((_0x3532eb,_0x5772ac)=>{const _0x10f748=_0x18db10;if(_0x5772ac%_0x317cfe==0x0)_0x2d55c7=[];_0x2d55c7[_0x10f748(0x153)](Markup[_0x10f748(0x158)][_0x10f748(0x244)]('Bot\x20'+_0x3532eb[_0x10f748(0x1f8)],_0x10f748(0x102)+_0x3532eb[_0x10f748(0x1f8)])),_0x5772ac%_0x317cfe==0x0&&(_0x457a58[_0x54ce1c]=_0x2d55c7,_0x54ce1c++);});const _0x2f2a4d=Markup['inlineKeyboard'](_0x457a58);_0x2f83f1[_0x18db10(0x196)](_0x18db10(0x1b2),_0x2f2a4d);}else{const _0x1ac25a=_0x3dafa0[0x0][_0x18db10(0x1f8)];if(pid[_0x1ac25a])pid[_0x1ac25a][_0x18db10(0x184)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0xc1b28a=>{const _0x1a73a3=_0x39a832,_0x146f7f=_0xc1b28a[_0x1a73a3(0x1b4)][0x1];_0xc1b28a[_0x1a73a3(0x247)]();if(pid[_0x146f7f])pid[_0x146f7f][_0x1a73a3(0x184)]({'function':_0x1a73a3(0x235),'args':null});}),tgBot[_0x39a832(0x266)](_0x39a832(0xea),async _0x2b4f24=>{const _0x2197a2=_0x39a832,_0x1dfeaf='logs';await zipFiles(_0x1dfeaf);const _0x2d6dcc=zippath+(_0x1dfeaf+_0x2197a2(0xa9));_0x2b4f24[_0x2197a2(0x1a3)]({'source':_0x2d6dcc})[_0x2197a2(0x25e)](()=>{})[_0x2197a2(0x225)](_0x3a4553=>logger['debug']('Error\x20sending\x20'+_0x1dfeaf+_0x2197a2(0x12f),_0x3a4553));}),tgBot[_0x39a832(0x266)]('backup',async _0x340275=>{const _0x51e38a=_0x39a832,_0xb5d5d1=_0x51e38a(0x138);await backupConfigFiles(),await zipFiles(_0xb5d5d1);const _0x3d3165=zippath+(_0xb5d5d1+_0x51e38a(0xa9));_0x340275['replyWithDocument']({'source':_0x3d3165})[_0x51e38a(0x25e)](()=>{})[_0x51e38a(0x225)](_0x22264c=>logger['debug'](_0x51e38a(0x190)+_0xb5d5d1+_0x51e38a(0x12f),_0x22264c));}),tgBot[_0x39a832(0x266)]('update',async _0x1c2d41=>{const _0x5cca79=_0x39a832;await getMessages();if(!updateAvailable)await sendTelegram(_0x1c2d41[_0x5cca79(0x291)]['id'],_0x5cca79(0x1a0));else{if(!validInstallation)await sendTelegram(_0x1c2d41[_0x5cca79(0x291)]['id'],_0x5cca79(0x28b));else{const _0x8952fe=Markup[_0x5cca79(0x24b)]([Markup['button'][_0x5cca79(0x244)](_0x5cca79(0x107),'update_yes'),Markup[_0x5cca79(0x158)][_0x5cca79(0x244)]('No',_0x5cca79(0x236))]);_0x1c2d41[_0x5cca79(0x196)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x8952fe);}}}),tgBot[_0x39a832(0xde)](/update_(.+)/,async _0xc8b623=>{const _0x28db6b=_0x39a832,_0x282ac6=_0xc8b623[_0x28db6b(0x1b4)][0x1];_0xc8b623[_0x28db6b(0x247)](),_0x282ac6==_0x28db6b(0x245)&&(await sendTelegram(_0xc8b623['chat']['id'],_0x28db6b(0xb8)),updateBB(_0x28db6b(0x14f))),_0x282ac6=='no'&&await sendTelegram(_0xc8b623['chat']['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x39a832(0x266)]('reinstall',async _0x56edcb=>{const _0x10a91c=_0x39a832;if(!validInstallation)await sendTelegram(_0x56edcb[_0x10a91c(0x291)]['id'],_0x10a91c(0x232));else{const _0x568942=Markup[_0x10a91c(0x24b)]([Markup['button']['callback'](_0x10a91c(0x107),'reinstall_yes'),Markup[_0x10a91c(0x158)]['callback']('No',_0x10a91c(0x9c))]);_0x56edcb[_0x10a91c(0x196)](_0x10a91c(0x223),_0x568942);}}),tgBot[_0x39a832(0xde)](/reinstall_(.+)/,async _0x3789c6=>{const _0x26fe35=_0x39a832,_0x2bdc67=_0x3789c6[_0x26fe35(0x1b4)][0x1];_0x3789c6[_0x26fe35(0x247)](),_0x2bdc67=='yes'&&(await sendTelegram(_0x3789c6['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB('reinstall')),_0x2bdc67=='no'&&await sendTelegram(_0x3789c6['chat']['id'],_0x26fe35(0x188));}),tgBot[_0x39a832(0x266)](_0x39a832(0x17b),async _0x4ba328=>{const _0x5402a5=_0x39a832,_0x1424ef=getBotsWithMode();if(_0x1424ef[_0x5402a5(0xab)]==0x0)await sendTelegram(_0x4ba328[_0x5402a5(0x291)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0xe1d360=[],_0x173a4f=[];const _0x55f115=0x2;let _0x5259b7=0x0;_0x1424ef['forEach']((_0x33564b,_0x54d221)=>{const _0x58701d=_0x5402a5;if(_0x54d221%_0x55f115==0x0)_0x173a4f=[];_0x173a4f['push'](Markup['button'][_0x58701d(0x244)](_0x58701d(0x103)+_0x33564b[_0x58701d(0x1f8)]+'\x20('+_0x33564b[_0x58701d(0x157)]+')','toggle_'+_0x33564b[_0x58701d(0x1f8)])),_0x54d221%_0x55f115==0x0&&(_0xe1d360[_0x5259b7]=_0x173a4f,_0x5259b7++);});const _0x4cdbbe=Markup[_0x5402a5(0x24b)](_0xe1d360);_0x4ba328[_0x5402a5(0x196)](_0x5402a5(0xba),_0x4cdbbe);}}),tgBot['action'](/toggle_(.+)/,async _0x17e8d6=>{const _0x5cd5b7=_0x39a832,_0x3c7737=_0x17e8d6['match'][0x1];_0x17e8d6[_0x5cd5b7(0x247)]();const _0x3598c7=getBotsWithMode(),_0x45fb04=_0x3598c7[_0x5cd5b7(0x1b7)](_0x462dbf=>_0x462dbf[_0x5cd5b7(0x1f8)]==_0x3c7737),_0x5deaab=_0x45fb04[_0x5cd5b7(0x157)]==_0x5cd5b7(0x1e9)?_0x5cd5b7(0x106):_0x5cd5b7(0x1e9);await sendTelegram(_0x17e8d6[_0x5cd5b7(0x291)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x3c7737+_0x5cd5b7(0x172)+_0x5deaab+'\x20mode'),toggleBotMode(_0x3c7737);}),tgBot[_0x39a832(0x266)](_0x39a832(0x1b5),async _0x2d2533=>{const _0x15870f=_0x39a832;let _0x1423b8='';config[_0x15870f(0x185)](_0x4bb2bb=>{const _0x262a26=_0x15870f;_0x1423b8+='Bot\x20'+_0x4bb2bb[_0x262a26(0x1f8)]+':\x20'+_0x4bb2bb[_0x262a26(0xc2)]+'\x0a';}),await sendTelegram(_0x2d2533[_0x15870f(0x291)]['id'],_0x1423b8,{'parse_mode':_0x15870f(0xd7)});}),tgBot[_0x39a832(0x266)](_0x39a832(0x118),async _0x3a99bb=>{const _0x3b83c4=_0x39a832;await sendTelegram(_0x3a99bb[_0x3b83c4(0x291)]['id'],_0x10120a);}),process['once']('SIGINT',()=>tgBot[_0x39a832(0xdc)](_0x39a832(0xdd))),process[_0x39a832(0xd5)]('SIGTERM',()=>tgBot[_0x39a832(0xdc)](_0x39a832(0x1b8))),tgBot[_0x39a832(0x1a1)]();}function disableTelegram(){const _0x5f1526=_0x2c11d0;tgBot&&tgBot[_0x5f1526(0xdc)]();}async function sendTelegram(_0x314679,_0x4fe88f,_0x3eca96){const _0x158054=_0x2c11d0;_0x3eca96={..._0x3eca96,'disable_web_page_preview':!![]};try{await tgBot[_0x158054(0x26c)][_0x158054(0x25f)](_0x314679,_0x4fe88f,_0x3eca96);}catch(_0x4021fb){logger[_0x158054(0x9e)](_0x158054(0xe3),_0x4021fb);}}async function sendTelegramBot(_0x170d12,_0x2a2540){const _0x3fbb86=_0x2c11d0;if(settings[_0x3fbb86(0x123)]){if(settings[_0x3fbb86(0x1da)]=='all'||(_0x2a2540[_0x3fbb86(0x24f)]==_0x3fbb86(0x214)||_0x2a2540[_0x3fbb86(0x24f)]==_0x3fbb86(0x13d)||_0x2a2540[_0x3fbb86(0x24f)]=='success')&&settings[_0x3fbb86(0x1da)]==_0x3fbb86(0x11a)||_0x2a2540['type']==_0x3fbb86(0x1ab)&&settings[_0x3fbb86(0x1da)]==_0x3fbb86(0xd9)){if(tgBot&&settings[_0x3fbb86(0x254)]){if(_0x2a2540[_0x3fbb86(0x233)])await sendTelegram(settings[_0x3fbb86(0x254)],_0x2a2540[_0x3fbb86(0xc2)]+'\x20>\x20'+_0x2a2540[_0x3fbb86(0x23b)]);else await sendTelegram(settings[_0x3fbb86(0x254)],_0x3fbb86(0x103)+_0x170d12+_0x3fbb86(0x1f0)+_0x2a2540[_0x3fbb86(0x23b)]);}}}}async function sendTelegramMsg(_0x84568f,_0x2d53d3=_0x2c11d0(0xd7)){const _0x21ba71=_0x2c11d0;return settings[_0x21ba71(0x123)]&&tgBot&&settings[_0x21ba71(0x254)]?(await sendTelegram(settings[_0x21ba71(0x254)],_0x84568f,{'parse_mode':_0x2d53d3}),!![]):![];}function getDeviceWithIp(_0x13b1d6){const _0x168ee0=_0x2c11d0;return devices[_0x168ee0(0x1b7)](_0x5f3a4f=>_0x5f3a4f['ip']===_0x13b1d6);}async function temporaryAccess2FA(_0x34e1a8,_0x4c877f){const _0xaf3bb1=_0x2c11d0;let _0x54c7cb=new Date(),_0x13b9d2=![];if(lastIpApproval){if(_0x54c7cb-lastIpApproval<0x1388)_0x13b9d2=!![];}lastIpApproval=new Date();if(_0x13b9d2)return;if(tgBot&&settings['telegramChatId']){const _0x2cbb3c=uuidRandom();tmpStorage[_0x2cbb3c]={'uuid':_0x34e1a8,'externalip':_0x4c877f};const _0x3862dd=Markup[_0xaf3bb1(0x24b)]([Markup[_0xaf3bb1(0x158)]['callback']('5\x20min','tempaccess_5_'+_0x2cbb3c),Markup['button'][_0xaf3bb1(0x244)](_0xaf3bb1(0xb7),_0xaf3bb1(0x201)+_0x2cbb3c),Markup[_0xaf3bb1(0x158)][_0xaf3bb1(0x244)](_0xaf3bb1(0x99),'tempaccess_30_'+_0x2cbb3c),Markup['button']['callback'](_0xaf3bb1(0x1e5),_0xaf3bb1(0x167)+_0x2cbb3c)]);await sendTelegram(settings[_0xaf3bb1(0x254)],_0xaf3bb1(0xf3)+normalizeIP(_0x4c877f)[_0xaf3bb1(0x142)]+'\x20?',_0x3862dd),tgBot[_0xaf3bb1(0xde)](/tempaccess_(.+)_(.+)/,async _0x11b9b2=>{const _0x4b3db8=_0xaf3bb1,_0x58a391=_0x11b9b2[_0x4b3db8(0x1b4)][0x1],_0x375e4e=_0x11b9b2[_0x4b3db8(0x1b4)][0x2],{uuid:_0x4c7ce8,externalip:_0x459e53}=tmpStorage[_0x375e4e];delete tmpStorage[_0x375e4e],_0x11b9b2[_0x4b3db8(0x247)](),devices[_0x4c7ce8][_0x4b3db8(0x237)]={'clientip':_0x459e53,'timestamp':new Date()[_0x4b3db8(0x1ef)](),'expiry':_0x58a391},_0x58a391!='reject'?(await sendTelegram(_0x11b9b2[_0x4b3db8(0x291)]['id'],_0x4b3db8(0x121)+_0x58a391+_0x4b3db8(0x26e),{'parse_mode':_0x4b3db8(0xd7)}),io['to'](_0x4c7ce8)[_0x4b3db8(0x143)](_0x4b3db8(0x1c6),{'access':{'allow':![],'reason':_0x4b3db8(0x292),'token':null}})):(await sendTelegram(_0x11b9b2['chat']['id'],_0x4b3db8(0x243)),io['to'](_0x4c7ce8)[_0x4b3db8(0x143)]('status',{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0xc899e5,_0x513e1b){const _0x53ac3b=_0x2c11d0;if(tgBot&&settings['telegramChatId']){const _0x47926e=uuidRandom();tmpStorage[_0x47926e]={'uuid':_0xc899e5,'externalip':_0x513e1b};const _0x16cb43=Markup[_0x53ac3b(0x24b)]([Markup[_0x53ac3b(0x158)]['callback'](_0x53ac3b(0x15a),'login2fa_'+loginExpiry+'_'+_0x47926e),Markup[_0x53ac3b(0x158)]['callback'](_0x53ac3b(0x1e5),_0x53ac3b(0x22f)+_0x47926e)]);await sendTelegram(settings[_0x53ac3b(0x254)],_0x53ac3b(0x108)+normalizeIP(_0x513e1b)[_0x53ac3b(0x142)]+'\x20?',_0x16cb43),tgBot[_0x53ac3b(0xde)](/login2fa_(.+)_(.+)/,async _0x49e825=>{const _0x5d95bd=_0x53ac3b,_0x5d6720=_0x49e825['match'][0x1],_0x52dc10=_0x49e825[_0x5d95bd(0x1b4)][0x2],{uuid:_0x54796d,externalip:_0x13577c}=tmpStorage[_0x52dc10];delete tmpStorage[_0x52dc10],_0x49e825[_0x5d95bd(0x247)](),devices[_0x54796d][_0x5d95bd(0x1f4)]={'clientip':_0x13577c,'timestamp':new Date()[_0x5d95bd(0x1ef)](),'expiry':_0x5d6720},_0x5d6720!=_0x5d95bd(0x1e5)?(await sendTelegram(_0x49e825[_0x5d95bd(0x291)]['id'],_0x5d95bd(0x10f),{'parse_mode':'HTML'}),io['to'](_0x54796d)['emit'](_0x5d95bd(0x1c6),{'access':{'allow':![],'reason':_0x5d95bd(0x292),'token':null}})):(await sendTelegram(_0x49e825['chat']['id'],'Login\x20rejected'),io['to'](_0x54796d)[_0x5d95bd(0x143)](_0x5d95bd(0x1c6),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3562cc=_0x2c11d0;return dbConfig['get']('bots')[_0x3562cc(0x191)](_0x3562cc(0x1f8))[_0x3562cc(0x17f)]({'status':_0x3562cc(0x8f)})['value']()||[];}function getDisabledBots(){const _0xab3aaa=_0x2c11d0;return dbConfig['get'](_0xab3aaa(0x226))['sortBy'](_0xab3aaa(0x1f8))[_0xab3aaa(0x17f)]({'status':_0xab3aaa(0x164)})[_0xab3aaa(0x267)]()||[];}function getBotAttributes(_0x3237d3){const _0x8ebbd6=_0x2c11d0;let _0x7d7ff={};const _0x3cdbca=configpath+_0x8ebbd6(0x20b)+_0x3237d3+_0x8ebbd6(0x9d),_0x8d6cce=fs['existsSync'](_0x3cdbca);if(_0x8d6cce){const _0x4be385=fs[_0x8ebbd6(0x28e)](_0x3cdbca);try{const _0x27398e=JSON[_0x8ebbd6(0xcc)](_0x4be385),_0x556972=_0x27398e?_0x27398e[_0x8ebbd6(0xdb)][0x0][_0x8ebbd6(0x28a)]:![];_0x7d7ff[_0x8ebbd6(0x157)]=_0x556972?_0x8ebbd6(0x1e9):_0x8ebbd6(0x106),_0x7d7ff[_0x8ebbd6(0xc2)]=_0x27398e?_0x27398e[_0x8ebbd6(0xdb)][0x0][_0x8ebbd6(0xc2)]:_0x8ebbd6(0x103)+_0x3237d3;}catch(_0x16a266){_0x7d7ff[_0x8ebbd6(0x157)]=_0x8ebbd6(0x106),_0x7d7ff['botname']=_0x8ebbd6(0x103)+_0x3237d3;}}else _0x7d7ff[_0x8ebbd6(0x157)]=_0x8ebbd6(0x106),_0x7d7ff[_0x8ebbd6(0xc2)]=_0x8ebbd6(0x103)+_0x3237d3;return _0x7d7ff;}function getBotsWithMode(){const _0x2b70a1=_0x2c11d0,_0x290746=dbConfig[_0x2b70a1(0x24d)]('bots')[_0x2b70a1(0x191)](_0x2b70a1(0x1f8))[_0x2b70a1(0x267)]()||[];return _0x290746[_0x2b70a1(0x185)](_0x3dfce3=>{const _0x3983ef=_0x2b70a1;let _0x19ed16=getBotAttributes(_0x3dfce3[_0x3983ef(0x1f8)]);_0x3dfce3[_0x3983ef(0x157)]=_0x19ed16['mode'];}),_0x290746;}function getBotExchanges(){const _0x86d635=_0x2c11d0;let _0x42aae2=[];const _0xde7474=dbConfig[_0x86d635(0x24d)](_0x86d635(0x226))[_0x86d635(0x191)](_0x86d635(0x1f8))[_0x86d635(0x267)]()||[];_0xde7474['forEach'](_0x3d9816=>{const _0xfbfd31=_0x86d635;if(_0x3d9816[_0xfbfd31(0x1c6)]=='enabled'){const _0x1e6e4c=configpath+_0xfbfd31(0x20b)+_0x3d9816[_0xfbfd31(0x1f8)]+'-config.json',_0x3925da=fs[_0xfbfd31(0x1d6)](_0x1e6e4c);let _0x3dd0ca;if(_0x3925da){const _0xe36f6=fs[_0xfbfd31(0x28e)](_0x1e6e4c);try{const _0x5294ee=JSON[_0xfbfd31(0xcc)](_0xe36f6);_0x3dd0ca=_0x5294ee?_0x5294ee[_0xfbfd31(0xdb)][0x0]['exchange']:null;}catch(_0x17144b){}}if(_0x3dd0ca)_0x42aae2[_0xfbfd31(0x153)](_0x3dd0ca);}});const _0x4f4c9c=[...new Set(_0x42aae2)][_0x86d635(0xaf)]();return _0x4f4c9c;}async function initUser(){const _0x3fd6b1=_0x2c11d0;if(!settings[_0x3fd6b1(0x257)]){const _0x46f49b=uuidRandom();mixpanel[_0x3fd6b1(0x1a9)](_0x46f49b),updateSetting(_0x3fd6b1(0x257),_0x46f49b);}}async function initSecure(){const _0x2417d3=_0x2c11d0;let _0x3905ae=getSecure();if(!_0x3905ae['hasOwnProperty'](_0x2417d3(0x182))){let _0x2d4dc5=await generateKeys();_0x3905ae[_0x2417d3(0x252)]=_0x2d4dc5[_0x2417d3(0x252)],_0x3905ae[_0x2417d3(0x21f)]=_0x2d4dc5[_0x2417d3(0x21f)],_0x3905ae['secret']=crypto[_0x2417d3(0x22b)](0x20)[_0x2417d3(0x1a8)]('hex');;storeSecure(_0x3905ae);}}function getSettings(){const _0x520615=_0x2c11d0;return dbSettings[_0x520615(0x24d)](_0x520615(0x1c2))['value']()||{};}function getSecure(){const _0xfd106b=_0x2c11d0;return dbSecure[_0xfd106b(0x24d)](_0xfd106b(0x131))[_0xfd106b(0x267)]()||{};}function getBlacklist(){const _0x5485ac=_0x2c11d0;return dbSecure[_0x5485ac(0x24d)](_0x5485ac(0xa4))[_0x5485ac(0x267)]()||[];}function broadcastToBots(_0x6020ef,_0x3170f4){const _0x2b51c1=_0x2c11d0;config[_0x2b51c1(0x185)](_0x5bd809=>{const _0x2bf71e=_0x2b51c1;if(_0x5bd809[_0x2bf71e(0x1c6)]==_0x2bf71e(0x8f)&&_0x5bd809[_0x2bf71e(0x274)]==_0x2bf71e(0x238)||_0x5bd809['status']==_0x2bf71e(0x220)&&_0x5bd809[_0x2bf71e(0x274)]==_0x2bf71e(0x238)){if(pid[_0x5bd809[_0x2bf71e(0x1f8)]])pid[_0x5bd809[_0x2bf71e(0x1f8)]][_0x2bf71e(0x184)]({[_0x6020ef]:_0x3170f4});}});}async function storeSettings(_0x5c82fd,_0x33ddc3=![]){const _0x368e2b=_0x2c11d0;_0x5c82fd={...settings,..._0x5c82fd};if(_0x33ddc3&&_0x5c82fd[_0x368e2b(0x1d7)]!='************'&&_0x5c82fd[_0x368e2b(0x1d7)]!='***'&&_0x5c82fd[_0x368e2b(0x1d7)]!=''){const _0x32659e=decryptRSA(secure[_0x368e2b(0x21f)],_0x5c82fd[_0x368e2b(0x1d7)])[_0x368e2b(0x152)](_0x368e2b(0x113))[0x0],_0x31aa00=bcrypt[_0x368e2b(0x18e)](_0x32659e,saltRounds);_0x5c82fd={..._0x5c82fd,'bbPassword':_0x31aa00};}if(_0x33ddc3&&_0x5c82fd[_0x368e2b(0x1ec)]!='************'&&_0x5c82fd[_0x368e2b(0x1ec)]!=_0x368e2b(0x9a)&&_0x5c82fd[_0x368e2b(0x1ec)]!=''){const _0x34012c=decryptRSA(secure[_0x368e2b(0x21f)],_0x5c82fd[_0x368e2b(0x1ec)])[_0x368e2b(0x152)](_0x368e2b(0x113))[0x0];_0x5c82fd={..._0x5c82fd,'telegramToken':_0x34012c};}if(_0x33ddc3&&_0x5c82fd[_0x368e2b(0x97)]!='************'&&_0x5c82fd[_0x368e2b(0x97)]!=_0x368e2b(0x9a)&&_0x5c82fd[_0x368e2b(0x97)]!=''){const _0x3b39c8=decryptRSA(secure[_0x368e2b(0x21f)],_0x5c82fd[_0x368e2b(0x97)])[_0x368e2b(0x152)](_0x368e2b(0x113))[0x0];_0x5c82fd={..._0x5c82fd,'marketcapApi':_0x3b39c8};}const _0x391f0a=_0x5c82fd['telegramToken']!=_0x368e2b(0xbd)&&_0x5c82fd['telegramToken']!=settings[_0x368e2b(0x1ec)]||_0x5c82fd[_0x368e2b(0x281)]!=settings[_0x368e2b(0x281)],_0x3defd2=_0x5c82fd[_0x368e2b(0x1ec)]==''||_0x5c82fd[_0x368e2b(0x281)]=='',_0x38f0d1=_0x5c82fd[_0x368e2b(0x97)]&&_0x5c82fd['marketcapApi']!='************'&&_0x5c82fd[_0x368e2b(0x97)]!=settings[_0x368e2b(0x97)];_0x391f0a&&(_0x5c82fd['telegramChatId']=null,_0x5c82fd[_0x368e2b(0x1da)]=_0x368e2b(0x1c5));for(const [_0x395b0c,_0xfb5b02]of Object[_0x368e2b(0x1f5)](_0x5c82fd)){if(_0x395b0c==_0x368e2b(0x1ec)&&_0xfb5b02==_0x368e2b(0xbd)){_0x5c82fd[_0x368e2b(0x1ec)]=settings[_0x368e2b(0x1ec)];continue;};if(_0x395b0c==_0x368e2b(0x1d7)&&_0xfb5b02=='************'){_0x5c82fd[_0x368e2b(0x1d7)]=settings[_0x368e2b(0x1d7)];continue;};if(_0x395b0c=='marketcapApi'&&_0xfb5b02==_0x368e2b(0xbd)){_0x5c82fd[_0x368e2b(0x97)]=settings[_0x368e2b(0x97)];continue;};dbSettings[_0x368e2b(0xf0)](_0x368e2b(0xf9)+_0x395b0c,_0xfb5b02)[_0x368e2b(0x290)]();}settings=_0x5c82fd,io['to'](_0x368e2b(0x133))[_0x368e2b(0x143)]('settings',cleanSettings()),broadcastToBots(_0x368e2b(0x1fe),settings[_0x368e2b(0x1fe)]),broadcastToBots(_0x368e2b(0x1e3),settings[_0x368e2b(0x1e3)]),broadcastToBots(_0x368e2b(0x97),settings[_0x368e2b(0x97)]);if(_0x391f0a&&!_0x3defd2)initTelegram();_0x391f0a&&_0x3defd2&&(updateSetting('telegramChatId',null),disableTelegram()),getAllClients()['forEach'](_0xe435c1=>{const _0x15f00b=_0x368e2b;getSocket(_0xe435c1['id'])['emit']('status',{'access':{'allow':![],'reason':_0x15f00b(0x292),'token':null}});}),_0x38f0d1&&(await sleep(0xbb8),testMarketcapApi(_0x5c82fd[_0x368e2b(0x97)]));}async function testMarketcapApi(_0xa179e8){const _0x4eb6cc=_0x2c11d0,_0x400da0=[_0x4eb6cc(0x1a4),_0x4eb6cc(0xe5)];try{await axios['get'](_0x4eb6cc(0x246),{'headers':{'X-CMC_PRO_API_KEY':_0xa179e8},'params':{'symbol':_0x400da0[_0x4eb6cc(0x1a8)]()}});}catch(_0x4900a4){_0x4900a4[_0x4eb6cc(0x1a8)]()[_0x4eb6cc(0x180)]('status\x20code\x20401')?(io['to'](_0x4eb6cc(0x133))[_0x4eb6cc(0x143)](_0x4eb6cc(0x24c),_0x4eb6cc(0x16f)),logger[_0x4eb6cc(0xf5)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x4eb6cc(0x133))[_0x4eb6cc(0x143)](_0x4eb6cc(0x24c),_0x4eb6cc(0x168)),logger['full'](_0x4eb6cc(0x168)),logger[_0x4eb6cc(0x9e)](_0x4eb6cc(0x179),_0x4900a4['toString']()+'\x20-\x20'+_0x4900a4['code']));return;}logger[_0x4eb6cc(0x9e)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x50b759,_0x50886f){const _0x3f718c=_0x2c11d0;dbSettings[_0x3f718c(0xf0)](_0x3f718c(0xf9)+_0x50b759,_0x50886f)['write'](),settings=getSettings(),io['to']('botmanager')[_0x3f718c(0x143)](_0x3f718c(0x1c2),cleanSettings());}function storeSecure(_0xe0113b){const _0xbbc788=_0x2c11d0;dbSecure[_0xbbc788(0x24d)](_0xbbc788(0x131))[_0xbbc788(0x153)](_0xe0113b)[_0xbbc788(0x290)](),secure=_0xe0113b;}function addBlacklist(_0x3fe579){const _0x1f8316=_0x2c11d0;cleanBlacklist();let _0x7dd20e;devices[_0x3fe579][_0x1f8316(0x237)]?_0x7dd20e=Math['max'](devices[_0x3fe579]['telegramIpApproval'][_0x1f8316(0x148)],loginExpiry):_0x7dd20e=loginExpiry,dbSecure[_0x1f8316(0x24d)]('blacklist')[_0x1f8316(0x153)]({'expiry':new Date()[_0x1f8316(0x1ef)]()+_0x7dd20e*0x3c*0x3e8,'token':devices[_0x3fe579][_0x1f8316(0x122)][_0x1f8316(0x288)]})[_0x1f8316(0x290)](),blacklist=dbSecure[_0x1f8316(0x24d)](_0x1f8316(0xa4))['value']();}function cleanBlacklist(){const _0x34511e=_0x2c11d0;let _0x309d50=dbSecure['get'](_0x34511e(0xa4))['cloneDeep']()[_0x34511e(0x267)](),_0x2995d1=new Date()[_0x34511e(0x1ef)]();_0x309d50[_0x34511e(0x185)](_0x2da9fd=>{const _0x4def86=_0x34511e;_0x2da9fd[_0x4def86(0x148)]<_0x2995d1&&dbSecure[_0x4def86(0x24d)](_0x4def86(0xa4))['remove']({'expiry':_0x2da9fd['expiry']})['write']();});}function initStates(){let _0x48d019=getConfiguration();_0x48d019['forEach'](_0x199f1d=>{const _0x595694=_0x998f;_0x199f1d[_0x595694(0x274)]=_0x595694(0x95);}),storeConfiguration(_0x48d019);}async function generateKeys(){const _0x2b4061=_0x2c11d0,_0x10a393=forge[_0x2b4061(0x250)]['rsa']['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x24d861=forge['pki'][_0x2b4061(0x19e)](_0x10a393[_0x2b4061(0x21f)]),_0xa3d0b0=forge['pki']['publicKeyToPem'](_0x10a393['publicKey']);return{'privateKey':_0x24d861,'publicKey':_0xa3d0b0};}async function oneTimeMigration(){const _0x233173=_0x2c11d0;let _0x2e08f1=getSettings(),_0x19fbaf=![];!_0x2e08f1[_0x233173(0xcd)](_0x233173(0x110))&&(_0x2e08f1[_0x233173(0x110)]=0x0,_0x19fbaf=!![]);!_0x2e08f1[_0x233173(0xcd)]('lastmsgemitted')&&(_0x2e08f1[_0x233173(0x170)]=0x0,_0x19fbaf=!![]);!_0x2e08f1[_0x233173(0xcd)](_0x233173(0x8d))&&(_0x2e08f1[_0x233173(0x8d)]=_0x233173(0x135),_0x19fbaf=!![]);!_0x2e08f1[_0x233173(0xcd)](_0x233173(0x1e3))&&(_0x2e08f1[_0x233173(0x1e3)]=![],_0x19fbaf=!![]);!_0x2e08f1['hasOwnProperty'](_0x233173(0x97))&&(_0x2e08f1['marketcapApi']='',_0x19fbaf=!![]);if(_0x19fbaf)storeSettings(_0x2e08f1);try{fs[_0x233173(0x1e7)](configbackuppath,{'withFileTypes':!![]})[_0x233173(0x185)](_0x5ebcd3=>{const _0x2d4ec1=_0x233173;if(!_0x5ebcd3[_0x2d4ec1(0x129)]()){if(!_0x5ebcd3[_0x2d4ec1(0x256)][_0x2d4ec1(0x249)](_0x2d4ec1(0x298)))fs[_0x2d4ec1(0x1c9)](configbackuppath+_0x5ebcd3[_0x2d4ec1(0x256)]);}else fs[_0x2d4ec1(0x15b)](configbackuppath+_0x5ebcd3[_0x2d4ec1(0x256)],{'recursive':!![]});});}catch(_0x5a074e){logger[_0x233173(0x9e)](_0x233173(0xdf),_0x5a074e);}}function storeConfiguration(_0x4071cb){const _0x2e446f=_0x2c11d0;dbConfig[_0x2e446f(0x24d)](_0x2e446f(0x226))[_0x2e446f(0x165)]()[_0x2e446f(0x290)](),dbConfig[_0x2e446f(0x24d)](_0x2e446f(0x226))[_0x2e446f(0x153)](..._0x4071cb)['write'](),config=_0x4071cb;}async function resetPassword(){const _0x2a6be6=_0x2c11d0;if(tgBot&&settings[_0x2a6be6(0x254)]){const _0x42d32c=Markup['inlineKeyboard']([Markup[_0x2a6be6(0x158)]['callback']('yes',_0x2a6be6(0xe4)),Markup[_0x2a6be6(0x158)][_0x2a6be6(0x244)]('no',_0x2a6be6(0x28c))]);await sendTelegram(settings[_0x2a6be6(0x254)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x42d32c),tgBot[_0x2a6be6(0xde)](/resetpw_(.+)/,async _0x304d74=>{const _0x937c01=_0x2a6be6,_0x57fceb=_0x304d74[_0x937c01(0x1b4)][0x1];_0x304d74['editMessageReplyMarkup']();if(_0x57fceb!='no'){const _0x54d2e6=0xf,_0x414831=_0x937c01(0xa8),_0x4ebb2a=Array[_0x937c01(0x9f)](crypto[_0x937c01(0x125)](new Uint32Array(_0x54d2e6)))[_0x937c01(0xed)](_0x210f7d=>_0x414831[_0x210f7d%_0x414831[_0x937c01(0xab)]])['join'](''),_0x4baa62=bcrypt[_0x937c01(0x18e)](_0x4ebb2a,saltRounds);storeSettings({'bbPassword':_0x4baa62}),await sendTelegram(_0x304d74[_0x937c01(0x291)]['id'],_0x937c01(0x23e)+_0x4ebb2a,{'parse_mode':_0x937c01(0xd7)});}else await sendTelegram(_0x304d74[_0x937c01(0x291)]['id'],_0x937c01(0x10a));});}}async function confirmRestore(_0x4815d8,_0x7c7fbe){const _0x176700=_0x2c11d0;io['to'](_0x176700(0x133))[_0x176700(0x143)](_0x176700(0x24c),_0x176700(0x18c),_0x176700(0x1b1));if(tgBot&&settings[_0x176700(0x254)]){const _0x173326=uuidRandom();tmpStorage[_0x173326]={'path':_0x4815d8,'filename':_0x7c7fbe};const _0x44f9f5=Markup[_0x176700(0x24b)]([Markup[_0x176700(0x158)][_0x176700(0x244)](_0x176700(0x245),_0x176700(0x144)+_0x173326),Markup[_0x176700(0x158)][_0x176700(0x244)]('no','restore_no_'+_0x173326)]);await sendTelegram(settings[_0x176700(0x254)],_0x176700(0x8e),_0x44f9f5),tgBot['action'](/restore_(.+)_(.+)/,async _0x29b8f6=>{const _0x32c18e=_0x176700,_0x188e8f=_0x29b8f6['match'][0x1],_0x2fba7a=_0x29b8f6[_0x32c18e(0x1b4)][0x2],{path:_0x510497,filename:_0x31edcf}=tmpStorage[_0x2fba7a];delete tmpStorage[_0x2fba7a],_0x29b8f6[_0x32c18e(0x247)](),_0x188e8f==_0x32c18e(0x245)?(logger['debug'](_0x32c18e(0xd3)),await sendTelegram(_0x29b8f6[_0x32c18e(0x291)]['id'],_0x32c18e(0xae),{'parse_mode':_0x32c18e(0xd7)}),unzipFile(_0x510497,_0x31edcf)):(logger[_0x32c18e(0x9e)](_0x32c18e(0x8a)),await sendTelegram(_0x29b8f6[_0x32c18e(0x291)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x3a2107=_0x2c11d0,_0x2238cf=new Date();return _0x2238cf['getFullYear']()+'/'+(_0x2238cf[_0x3a2107(0xe7)]()+0x1)['toString']()[_0x3a2107(0xfb)](0x2,'0')+'/'+_0x2238cf[_0x3a2107(0x20e)]()[_0x3a2107(0x1a8)]()['padStart'](0x2,'0')+'\x20'+_0x2238cf[_0x3a2107(0x26b)]()[_0x3a2107(0x1a8)]()[_0x3a2107(0xfb)](0x2,'0')+':'+_0x2238cf['getMinutes']()[_0x3a2107(0x1a8)]()[_0x3a2107(0xfb)](0x2,'0')+':'+_0x2238cf[_0x3a2107(0x1b3)]()['toString']()[_0x3a2107(0xfb)](0x2,'0');}function getTimeStamp(){const _0x2f00e8=_0x2c11d0,_0xd73740=shiftedTime();return _0xd73740[_0x2f00e8(0x20d)]()+'/'+(_0xd73740[_0x2f00e8(0xe7)]()+0x1)[_0x2f00e8(0x1a8)]()[_0x2f00e8(0xfb)](0x2,'0')+'/'+_0xd73740[_0x2f00e8(0x20e)]()['toString']()[_0x2f00e8(0xfb)](0x2,'0')+'\x20'+_0xd73740['getHours']()[_0x2f00e8(0x1a8)]()[_0x2f00e8(0xfb)](0x2,'0')+':'+_0xd73740[_0x2f00e8(0x241)]()[_0x2f00e8(0x1a8)]()[_0x2f00e8(0xfb)](0x2,'0')+':'+_0xd73740['getSeconds']()[_0x2f00e8(0x1a8)]()[_0x2f00e8(0xfb)](0x2,'0');}function getCleanTimeStamp(){const _0x1c8030=_0x2c11d0,_0x352a35=shiftedTime();return _0x352a35['getFullYear']()+(_0x352a35[_0x1c8030(0xe7)]()+0x1)['toString']()[_0x1c8030(0xfb)](0x2,'0')+_0x352a35[_0x1c8030(0x20e)]()[_0x1c8030(0x1a8)]()[_0x1c8030(0xfb)](0x2,'0')+'-'+_0x352a35[_0x1c8030(0x26b)]()[_0x1c8030(0x1a8)]()[_0x1c8030(0xfb)](0x2,'0')+_0x352a35[_0x1c8030(0x241)]()[_0x1c8030(0x1a8)]()[_0x1c8030(0xfb)](0x2,'0')+_0x352a35['getSeconds']()[_0x1c8030(0x1a8)]()[_0x1c8030(0xfb)](0x2,'0');}function shiftedTime(){const _0x33a9c0=_0x2c11d0,_0x56c712=new Date();let _0x44156e=_0x56c712;if(settings[_0x33a9c0(0x1fe)]&&settings[_0x33a9c0(0x1fe)]!==0x0)_0x44156e=fns[_0x33a9c0(0x140)](_0x56c712,{'hours':settings[_0x33a9c0(0x1fe)]});return _0x44156e;}async function startScheduler(){const _0x287be4=_0x2c11d0,_0x52d657=new Date()['getUTCHours'](),_0x466e3e=shiftedTime()[_0x287be4(0x26b)]();_0x466e3e==0x4&&backupConfigFiles(),_0x466e3e==0x0&&(rotateLogFiles(),logger[_0x287be4(0x9e)](_0x287be4(0x11e)),logger[_0x287be4(0x9e)](_0x287be4(0x215)+serverversion+_0x287be4(0x269)+(environment=='staging'?_0x287be4(0x155):'')),logger['debug'](_0x287be4(0x11e))),_0x52d657%0x6==0x0&&triggerAnalytics(),_0x52d657%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x587460){const _0x2f684b=_0x2c11d0;logger[_0x2f684b(0x9e)](_0x2f684b(0x151)+_0x587460);const _0x36b748=getBotsWithMode();_0x36b748['length']>0x0?confirmRestore(configbackuppath,_0x587460):unzipFile(configbackuppath,_0x587460);}async function getBackupFiles(_0x3b8c6d=null){const _0x244cca=_0x2c11d0;let _0x3e7aa2=[],_0x49cc56=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x49cc56[_0x244cca(0xaf)]((_0x25bf6d,_0x134921)=>_0x25bf6d[_0x244cca(0x256)]<_0x134921['name']?0x1:_0x134921['name']<_0x25bf6d[_0x244cca(0x256)]?-0x1:0x0),_0x49cc56[_0x244cca(0x185)](_0x53dda4=>{const _0xdd1f2e=_0x244cca;if(!_0x53dda4[_0xdd1f2e(0x129)]()&&_0x53dda4[_0xdd1f2e(0x256)][_0xdd1f2e(0x249)](_0xdd1f2e(0x298))&&_0x53dda4['name'][_0xdd1f2e(0x130)](_0xdd1f2e(0xa9))){const _0x2c09a0=formatDate(fs[_0xdd1f2e(0x1f3)](configbackuppath+_0x53dda4[_0xdd1f2e(0x256)])[_0xdd1f2e(0x1e0)]);_0x3e7aa2[_0xdd1f2e(0x153)]({'name':_0x53dda4['name'],'mtime':_0x2c09a0});}});if(_0x3b8c6d)io['to'](_0x3b8c6d)[_0x244cca(0x143)](_0x244cca(0x17a),_0x3e7aa2);else return _0x3e7aa2;}async function backupConfigFiles(){const _0x3ca1c6=_0x2c11d0;await zipFiles(_0x3ca1c6(0xcf));const _0x933c18=getCleanTimeStamp();fs[_0x3ca1c6(0x124)](zippath+_0x3ca1c6(0x231),configbackuppath+(_0x3ca1c6(0x298)+_0x933c18+_0x3ca1c6(0xa9)));let _0x242116=fs[_0x3ca1c6(0x1e7)](configbackuppath,{'withFileTypes':!![]});_0x242116[_0x3ca1c6(0xaf)]((_0x4381b0,_0x4ef658)=>_0x4381b0[_0x3ca1c6(0x256)]<_0x4ef658[_0x3ca1c6(0x256)]?0x1:_0x4ef658[_0x3ca1c6(0x256)]<_0x4381b0[_0x3ca1c6(0x256)]?-0x1:0x0),_0x242116[_0x3ca1c6(0xab)]>maxBackups&&fs[_0x3ca1c6(0x1c9)](configbackuppath+_0x242116[_0x242116[_0x3ca1c6(0xab)]-0x1][_0x3ca1c6(0x256)]);}function rotateLogFiles(){const _0x13d000=_0x2c11d0,_0x28fd2f=fs[_0x13d000(0x1f3)](logspath+_0x13d000(0x16b)),_0x55e0a4=_0x28fd2f[_0x13d000(0x1fa)]/0x400;if(_0x55e0a4>0x64){let _0x1aa48b=fs[_0x13d000(0x1e7)](logspath,{'withFileTypes':!![]});_0x1aa48b[_0x13d000(0xaf)]((_0x538b49,_0x5c64fa)=>_0x538b49[_0x13d000(0x256)]<_0x5c64fa['name']?0x1:_0x5c64fa['name']<_0x538b49[_0x13d000(0x256)]?-0x1:0x0),_0x1aa48b[_0x13d000(0x185)](_0x180021=>{const _0x38071f=_0x13d000;if(_0x180021[_0x38071f(0x256)]=='output-002.log')fs['copyFileSync'](logspath+_0x180021['name'],logspath+_0x38071f(0x132));if(_0x180021[_0x38071f(0x256)]==_0x38071f(0x21e))fs[_0x38071f(0x124)](logspath+_0x180021[_0x38071f(0x256)],logspath+_0x38071f(0x1d8));_0x180021[_0x38071f(0x256)]==_0x38071f(0x16b)&&(fs[_0x38071f(0x124)](logspath+_0x180021[_0x38071f(0x256)],logspath+'output-001.log'),fs[_0x38071f(0x159)](logspath+_0x180021[_0x38071f(0x256)],''));});}}async function zipFiles(_0x13a5fa){const _0x505593=_0x2c11d0;let _0x3aa67f;if(_0x13a5fa=='logs')_0x3aa67f=logspath;if(_0x13a5fa==_0x505593(0x138))_0x3aa67f=configpath;if(_0x13a5fa==_0x505593(0xcf))_0x3aa67f=configpath;let _0x5639c3=fs[_0x505593(0x1e7)](_0x3aa67f,{'withFileTypes':!![]});const _0x18d75f=new JSZip();_0x5639c3['forEach'](_0x2ba956=>{const _0x78163f=_0x505593;if(!_0x2ba956[_0x78163f(0x129)]()){let _0x579047=fs[_0x78163f(0x28e)](_0x3aa67f+_0x2ba956['name']);if(_0x13a5fa=='backup'){const _0x44ff94=/^bot-[0-9]{3}-config.json$/,_0x2a128b=_0x44ff94['test'](_0x2ba956[_0x78163f(0x256)]);if(_0x2a128b){const _0xf0ea0e=JSON[_0x78163f(0xcc)](_0x579047);if(_0xf0ea0e[_0x78163f(0xdb)][0x0]){_0xf0ea0e[_0x78163f(0xdb)][0x0]['apiKey']=_0x78163f(0x9a),_0xf0ea0e['bot'][0x0][_0x78163f(0x134)]=_0x78163f(0x9a);if(_0xf0ea0e[_0x78163f(0xdb)][0x0][_0x78163f(0x1ee)])_0xf0ea0e[_0x78163f(0xdb)][0x0][_0x78163f(0x1ee)]='***';}_0x579047=JSON[_0x78163f(0x21b)](_0xf0ea0e,null,0x2);}if(_0x2ba956[_0x78163f(0x256)]==_0x78163f(0x116)){const _0x39b02a=JSON[_0x78163f(0xcc)](_0x579047);if(_0x39b02a['settings']['loginRequired'])_0x39b02a[_0x78163f(0x1c2)][_0x78163f(0x1f2)]=![];if(_0x39b02a['settings'][_0x78163f(0x1d7)])_0x39b02a[_0x78163f(0x1c2)][_0x78163f(0x1d7)]='***';if(_0x39b02a['settings'][_0x78163f(0x1ec)])_0x39b02a[_0x78163f(0x1c2)][_0x78163f(0x1ec)]=_0x78163f(0x9a);if(_0x39b02a[_0x78163f(0x1c2)][_0x78163f(0x254)])_0x39b02a[_0x78163f(0x1c2)][_0x78163f(0x254)]=null;if(_0x39b02a[_0x78163f(0x1c2)]['marketcapApi'])_0x39b02a[_0x78163f(0x1c2)][_0x78163f(0x97)]='***';_0x579047=JSON[_0x78163f(0x21b)](_0x39b02a,null,0x2);}if(_0x2ba956['name']!=_0x78163f(0x175))_0x18d75f[_0x78163f(0x279)](_0x2ba956[_0x78163f(0x256)],_0x579047);}else _0x18d75f[_0x78163f(0x279)](_0x2ba956[_0x78163f(0x256)],_0x579047);}});const _0xad5bb4=await _0x18d75f['generateAsync']({'type':_0x505593(0x13b),'base64':![],'compression':_0x505593(0xd2)});fs[_0x505593(0x159)](zippath+(_0x13a5fa+'.zip'),_0xad5bb4,_0x505593(0x189));}async function unzipFile(_0x2f20e1,_0xf157c8){const _0x317392=_0x2c11d0;fs[_0x317392(0x1e7)](configpath,{'withFileTypes':!![]})[_0x317392(0x185)](_0x1d6013=>{const _0x340647=_0x317392;if(!_0x1d6013[_0x340647(0x129)]())fs[_0x340647(0x15b)](configpath+_0x1d6013[_0x340647(0x256)]);});const _0x46ef3e=fs['readFileSync'](_0x2f20e1+_0xf157c8,_0x317392(0x189)),_0x51a251=await JSZip[_0x317392(0x218)](_0x46ef3e,{'base64':![],'checkCRC32':!![]});for(const _0x39192b of Object['keys'](_0x51a251['files'])){const _0x41d704=_0x51a251['files'][_0x39192b],_0x3b0266=await _0x41d704[_0x317392(0x109)](_0x317392(0x13b));fs[_0x317392(0x159)](configpath+_0x41d704[_0x317392(0x256)],_0x3b0266);}fs[_0x317392(0x1e7)](temppath,{'withFileTypes':!![]})['forEach'](_0x52a21a=>{const _0x213a58=_0x317392;if(!_0x52a21a[_0x213a58(0x129)]())fs[_0x213a58(0x15b)](temppath+_0x52a21a[_0x213a58(0x256)]);}),logger['debug'](_0x317392(0x128)),process['send']({'restore':!![]},_0x5a23e0=>{});}async function getPublicIp(){const _0x100f54=_0x2c11d0;try{const _0x3d97c2=await axios[_0x100f54(0x24d)](_0x100f54(0xc3));publicip=_0x3d97c2['data']['ip'];}catch(_0x473c67){}}async function triggerAnalytics(){const _0x575724=_0x2c11d0;if(!publicip)await getPublicIp();const _0x214907=getBotsWithMode();let _0x3a31d8=0x0;_0x214907['forEach'](_0x4552d5=>{const _0x402c9b=_0x998f;if(_0x4552d5[_0x402c9b(0x1c6)]===_0x402c9b(0x8f))_0x3a31d8++;});const _0x1b178f=getBotExchanges();mixpanel[_0x575724(0x211)](_0x575724(0x1e2),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x214907[_0x575724(0xab)],'numbotsenabled':_0x3a31d8,'exchanges':_0x1b178f,'environment':environment});}async function getMessages(){const _0x5db306=_0x2c11d0,_0x164c2c='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x5aded7=new GraphQLClient(_0x164c2c),_0x39b1bf={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x10a7ba=serverversion['split']('.'),_0x2ad3f4=_0x10a7ba[0x0]+'.'+_0x10a7ba[0x1],_0xe327ad=Math[_0x5db306(0x1b0)](settings[_0x5db306(0x110)],settings[_0x5db306(0x170)]),_0x3a56f7={'last':parseInt(_0xe327ad),'bbm':_0x2ad3f4},_0x2783ac=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1a0152;try{_0x1a0152=await _0x5aded7[_0x5db306(0x166)](_0x2783ac,_0x3a56f7,_0x39b1bf);}catch(_0x1dadf2){}if(_0x1a0152&&_0x1a0152[_0x5db306(0x268)]){let _0x47f4e1=settings['lastmsgtelegram'],_0x4f07f4=settings['lastmsgtelegram'];newMessages=[];for(const _0x591397 of _0x1a0152[_0x5db306(0x268)]){newMessages[_0x5db306(0x153)](_0x591397);let _0x46fa0f=![];_0x591397[_0x5db306(0x26a)]&&(updateSetting(_0x5db306(0x8d),_0x591397['bbvNew']),_0x46fa0f=isNewerVersion(serverversion,_0x591397[_0x5db306(0x26a)])||serverversion==_0x591397['bbvNew']);if(!_0x46fa0f&&_0x591397[_0x5db306(0x289)]>_0x47f4e1){if(_0x591397[_0x5db306(0xbf)]===_0x5db306(0x1a6)||serverversion[_0x5db306(0x249)](_0x591397[_0x5db306(0xbf)])){let _0x25d94d=''+_0x591397['title']+'\x0a\x0a'+_0x591397[_0x5db306(0x18b)];const _0x173d27=await sendTelegramMsg(toTelegramMarkdown(_0x25d94d),_0x5db306(0x1ae));_0x47f4e1=_0x591397[_0x5db306(0x289)];}}_0x4f07f4=_0x591397[_0x5db306(0x289)];}updateAvailable=isNewerVersion(settings[_0x5db306(0x8d)],serverversion),updateSetting(_0x5db306(0x110),_0x4f07f4),emitMessages();}}function emitMessages(){const _0x42df56=_0x2c11d0,_0x3a2d3a=settings[_0x42df56(0x170)];let _0x15b4a2=[];newMessages[_0x42df56(0x185)](_0x488349=>{const _0x16a829=_0x42df56;_0x488349[_0x16a829(0x289)]>_0x3a2d3a&&_0x15b4a2[_0x16a829(0x153)](_0x488349);}),_0x15b4a2['length']>0x0&&getAllClients()[_0x42df56(0x185)](_0xc45168=>{const _0xde38ff=_0x42df56;getSocket(_0xc45168['id'])[_0xde38ff(0x143)](_0xde38ff(0x18b),_0x15b4a2);});}function confirmMessage(_0x40d7b8){updateSetting('lastmsgemitted',Number(_0x40d7b8));}function isNewerVersion(_0x204372,_0x1973fc){const _0x419da0=_0x2c11d0,_0x1f9444=_0x1973fc['split']('.'),_0x2287c0=_0x204372[_0x419da0(0x152)]('.');for(var _0x291876=0x0;_0x291876<_0x2287c0['length'];_0x291876++){const _0x6ca6cd=~~_0x2287c0[_0x291876],_0x4b2464=~~_0x1f9444[_0x291876];if(_0x6ca6cd>_0x4b2464)return!![];if(_0x6ca6cd<_0x4b2464)return![];}return![];}function toTelegramMarkdown(_0x1b2e6c){const _0x20bdce=_0x2c11d0,_0x26919e=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x46fbb8=/\*{2}(.+?)\*{2}/gim;return _0x1b2e6c=_0x1b2e6c['replace'](_0x26919e,_0x20bdce(0xc9))[_0x20bdce(0xb5)](_0x46fbb8,'*$1*'),_0x1b2e6c;}async function validateConfigFile(){const _0x4589a9=_0x2c11d0,_0x4f52d9=dbConfig['get'](_0x4589a9(0x226))[_0x4589a9(0x191)]('botID')[_0x4589a9(0x267)]()||[];if(_0x4f52d9[_0x4589a9(0xab)]==0x0){let _0xa7d4d1=0x0,_0x57499d=[];const _0x35b040=/^bot-([0-9]{3})-config.json$/,_0x200030=fs[_0x4589a9(0x1e7)](configpath);_0x200030[_0x4589a9(0x185)](_0x5d9a0c=>{const _0x3ab424=_0x4589a9,_0xdf9646=_0x35b040[_0x3ab424(0x183)](_0x5d9a0c);if(_0xdf9646){const _0x914121=_0xdf9646[0x1];let _0x1dbd09=getBotAttributes(_0x914121);_0x57499d[_0x3ab424(0x153)]({'botID':_0x914121,'botname':_0x1dbd09['botname'],'status':_0x3ab424(0x164),'live':'stopped'}),_0xa7d4d1++;}}),_0xa7d4d1!=0x0&&(dbConfig[_0x4589a9(0x24d)](_0x4589a9(0x226))[_0x4589a9(0x207)](_0x57499d)[_0x4589a9(0x290)](),config=_0x57499d,restoredConfigFile=_0xa7d4d1);}}async function restoreConfigNotify(_0x12de2b){const _0x5eb7e2=_0x2c11d0;let _0x35a383;if(restoredConfigFile==0x1)_0x35a383=_0x5eb7e2(0x1a2);else _0x35a383=_0x5eb7e2(0x197);if(_0x12de2b)io['to'](_0x5eb7e2(0x133))[_0x5eb7e2(0x143)]('notification',_0x35a383);else{logger['simple'](_0x5eb7e2(0x93)),logger[_0x5eb7e2(0x21c)](_0x35a383),logger[_0x5eb7e2(0x21c)]('-----------------------------------------------------------------------------------'),logger[_0x5eb7e2(0x21c)]('');if(tgBot&&settings[_0x5eb7e2(0x254)]&&settings[_0x5eb7e2(0x1da)]!='orders')await sendTelegram(settings[_0x5eb7e2(0x254)],_0x5eb7e2(0x1aa)+_0x35a383);}}function decryptRSA(_0x406007,_0x19d9a2){const _0x14ef63=_0x2c11d0,_0x448059=forge['pki']['privateKeyFromPem'](_0x406007),_0x2baffd=_0x448059[_0x14ef63(0xbe)](forge[_0x14ef63(0x198)]['decode64'](_0x19d9a2),'RSA-OAEP',{'md':forge['md'][_0x14ef63(0x1d5)][_0x14ef63(0x112)](),'mgf1':{'md':forge['md'][_0x14ef63(0x1d5)][_0x14ef63(0x112)]()}});return _0x2baffd;}function validateCredentials(_0x4e1901,_0x5a3ae6){const _0x176270=_0x2c11d0;if(_0x4e1901[_0x176270(0x174)]==settings['bbUsername']&&bcrypt[_0x176270(0x1c4)](_0x4e1901[_0x176270(0x20c)],settings['bbPassword'])){if(settings[_0x176270(0x1c0)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x499fa0=generateLoginToken(_0x5a3ae6);return{'allow':!![],'reason':_0x176270(0x8b),'token':_0x499fa0};}}else return{'allow':![],'reason':_0x176270(0x1c8),'token':null};}function refreshToken(_0x39905c){const _0x4a7540=_0x2c11d0,_0x128d9f=generateLoginToken(_0x39905c);return{'allow':!![],'reason':_0x4a7540(0x8b),'token':_0x128d9f};}function validateAccess(_0x3fef20,_0x1abc2e,_0x1cdf13){const _0x29261b=_0x2c11d0,_0x330fe1=_0x1cdf13?_0x1cdf13:devices[_0x1abc2e]['ip'];let _0x424aa8;const _0xcb46f2=_0x39e8a0=>{const _0x33d5b1=_0x998f;if(settings[_0x33d5b1(0x1f2)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x1abc2e)){const _0x294865=generateLoginToken(_0x1abc2e);return{'allow':!![],'reason':_0x33d5b1(0xe9),'token':_0x294865};}else return{'allow':![],'reason':_0x33d5b1(0x1c1),'token':null};}else return _0x424aa8=validToken(_0x39e8a0,_0x1abc2e),_0x424aa8[_0x33d5b1(0xcd)](_0x33d5b1(0x1b1))?{'allow':!![],'reason':_0x33d5b1(0x169),'token':_0x39e8a0}:{'allow':![],'reason':_0x33d5b1(0x1c1),'token':null};}else return{'allow':!![],'reason':_0x33d5b1(0x1df),'token':null};};if(settings[_0x29261b(0x14e)]){let _0x3e1bee=[...settings[_0x29261b(0x1de)],'::1',_0x29261b(0x98),_0x29261b(0x1cd)];if(_0x3e1bee[_0x29261b(0x180)](_0x330fe1))return _0xcb46f2(_0x3fef20);else{_0x424aa8=validToken(_0x3fef20,_0x1abc2e);if(_0x424aa8[_0x29261b(0xcd)](_0x29261b(0x1b1)))return _0xcb46f2(_0x3fef20);else{if(telegramIpApproved(_0x1abc2e)){const _0x311ffb=generateToken(_0x1abc2e);return _0x424aa8=_0xcb46f2(_0x3fef20),_0x424aa8[_0x29261b(0x18f)]?{'allow':!![],'reason':_0x29261b(0x162),'token':_0x311ffb}:_0x424aa8;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x29261b(0x227),'token':null}:{'allow':![],'reason':_0x29261b(0x126),'token':null};}}}else return _0xcb46f2(_0x3fef20);}function timelyDecrypt(_0xcc3799,_0x9f4f25,_0x4edcb4='@'){const _0x3e6796=_0x2c11d0;if(_0xcc3799)try{const _0x1f64cb=decryptRSA(secure['privateKey'],_0xcc3799),_0x1c569f=_0x1f64cb['split'](_0x4edcb4)[0x0],_0xa5b471=_0x1f64cb[_0x3e6796(0x152)](_0x4edcb4)[0x1],_0x407390=new Date()[_0x3e6796(0x1ef)]();if(_0x9f4f25){if(_0x407390-_0xa5b471<maxSecretAge*0x3e8)return _0x1c569f;else return![];}else return _0x1c569f;}catch(_0x3beb94){return![];}else return![];}const validToken=(_0x5c9ca5,_0x433591)=>{const _0x5f207a=_0x2c11d0,_0x4d982e=devices[_0x433591]['ip'];if(!_0x5c9ca5)return{'error':'No\x20authentication\x20token'};for(let _0x34f215 of blacklist){if(_0x34f215[_0x5f207a(0x288)]==_0x5c9ca5)return{'error':_0x5f207a(0x1d2)};}let _0x10b1e7;try{_0x10b1e7=jwt[_0x5f207a(0x12a)](_0x5c9ca5,secure[_0x5f207a(0x182)]+_0x433591);}catch{return{'error':_0x5f207a(0xf2)};}if(!_0x10b1e7['hasOwnProperty'](_0x5f207a(0x262))&&!_0x10b1e7['hasOwnProperty'](_0x5f207a(0x174))||!_0x10b1e7[_0x5f207a(0xcd)](_0x5f207a(0x1e8)))return{'error':_0x5f207a(0x94)};if(!_0x10b1e7[_0x5f207a(0xcd)](_0x5f207a(0x174))&&_0x10b1e7[_0x5f207a(0xcd)](_0x5f207a(0x262))){const {clientip:_0x2d3bab}=_0x10b1e7;return _0x4d982e==_0x2d3bab?{'success':_0x5f207a(0x22c)}:{'error':_0x5f207a(0x219)};}else{if(_0x10b1e7['hasOwnProperty'](_0x5f207a(0x174))&&_0x10b1e7[_0x5f207a(0xcd)]('clientip')){const {username:_0x8608ee,clientip:_0xa08924}=_0x10b1e7;return settings[_0x5f207a(0x1fb)]==_0x8608ee&&_0x4d982e==_0xa08924?{'success':_0x5f207a(0x22c)}:{'error':_0x5f207a(0x11b)};}}},generateLoginToken=_0x366728=>{const _0x4ce99e=_0x2c11d0;if(_0x366728){const _0x43cc53=devices[_0x366728]['ip'];return jwt[_0x4ce99e(0x17d)]({'username':settings[_0x4ce99e(0x1fb)],'clientip':_0x43cc53},secure['secret']+_0x366728,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x34039d=>{const _0x31f685=_0x2c11d0;if(_0x34039d){const _0x4f938f=devices[_0x34039d]['ip'];return jwt[_0x31f685(0x17d)]({'clientip':_0x4f938f},secure[_0x31f685(0x182)]+_0x34039d,{'expiresIn':devices[_0x34039d]['telegramIpApproval'][_0x31f685(0x148)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x883689=>{const _0x4fda81=_0x2c11d0;let _0x379f3c=![];return devices[_0x883689][_0x4fda81(0x237)]&&devices[_0x883689]['telegramIpApproval'][_0x4fda81(0x148)]!=_0x4fda81(0x1e5)&&(_0x379f3c=devices[_0x883689][_0x4fda81(0x237)][_0x4fda81(0x262)]==devices[_0x883689]['ip']&&new Date()['getTime']()-devices[_0x883689][_0x4fda81(0x237)][_0x4fda81(0xd8)]<devices[_0x883689][_0x4fda81(0x237)][_0x4fda81(0x148)]*0x3c*0x3e8),_0x379f3c;},telegram2FaApproved=_0x5523ea=>{const _0x4316b7=_0x2c11d0;let _0x2f32d0=![];return devices[_0x5523ea]['telegram2FaApproval']&&devices[_0x5523ea]['telegram2FaApproval'][_0x4316b7(0x148)]!='reject'&&(_0x2f32d0=devices[_0x5523ea][_0x4316b7(0x1f4)][_0x4316b7(0x262)]==devices[_0x5523ea]['ip']&&new Date()[_0x4316b7(0x1ef)]()-devices[_0x5523ea][_0x4316b7(0x1f4)][_0x4316b7(0xd8)]<devices[_0x5523ea][_0x4316b7(0x1f4)][_0x4316b7(0x148)]*0x3c*0x3e8),_0x2f32d0;},normalizeIP=_0x1a0b02=>{const _0xd58164=_0x2c11d0;let _0x85d94f=null,_0x585ded=null;if(ipaddr[_0xd58164(0x88)](_0x1a0b02)){const _0x4c47d4=ipaddr[_0xd58164(0xcc)](_0x1a0b02);_0x4c47d4[_0xd58164(0x1ad)]()==='ipv6'?(_0x4c47d4[_0xd58164(0x27c)]()&&(_0x85d94f=_0x4c47d4[_0xd58164(0x90)]()[_0xd58164(0x1a8)]()),_0x585ded=_0x4c47d4[_0xd58164(0x1a8)]()):(_0x85d94f=_0x4c47d4['toString'](),_0x585ded=_0x4c47d4[_0xd58164(0x193)]()[_0xd58164(0x1a8)]());}return{'show':_0x85d94f?_0x85d94f:_0x585ded,'store':_0x585ded};};function formatDate(_0x5b41c4){const _0x441dfd=_0x2c11d0;return _0x5b41c4[_0x441dfd(0x20d)]()+'/'+(_0x5b41c4[_0x441dfd(0xe7)]()+0x1)[_0x441dfd(0x1a8)]()[_0x441dfd(0xfb)](0x2,'0')+'/'+_0x5b41c4[_0x441dfd(0x20e)]()[_0x441dfd(0x1a8)]()[_0x441dfd(0xfb)](0x2,'0')+'\x20'+_0x5b41c4[_0x441dfd(0x26b)]()[_0x441dfd(0x1a8)]()[_0x441dfd(0xfb)](0x2,'0')+':'+_0x5b41c4[_0x441dfd(0x241)]()[_0x441dfd(0x1a8)]()[_0x441dfd(0xfb)](0x2,'0')+':'+_0x5b41c4[_0x441dfd(0x1b3)]()['toString']()[_0x441dfd(0xfb)](0x2,'0');}function sleep(_0x28836d){return new Promise(_0x31729d=>setTimeout(_0x31729d,_0x28836d));}