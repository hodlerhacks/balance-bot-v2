const _0x166ce5=_0x36d5;(function(_0x3596ae,_0x5ca4a4){const _0x17e493=_0x36d5,_0x14dc53=_0x3596ae();while(!![]){try{const _0x1a3b29=-parseInt(_0x17e493(0x2d5))/0x1+-parseInt(_0x17e493(0x13d))/0x2+-parseInt(_0x17e493(0x179))/0x3*(-parseInt(_0x17e493(0x259))/0x4)+parseInt(_0x17e493(0x25e))/0x5+parseInt(_0x17e493(0x14e))/0x6*(parseInt(_0x17e493(0x1cf))/0x7)+parseInt(_0x17e493(0x164))/0x8+-parseInt(_0x17e493(0xbe))/0x9;if(_0x1a3b29===_0x5ca4a4)break;else _0x14dc53['push'](_0x14dc53['shift']());}catch(_0x3a44dd){_0x14dc53['push'](_0x14dc53['shift']());}}}(_0x444e,0x38ce8));const _0x56329a=function(){let _0x3e4748=!![];return function(_0x36ff9b,_0x496952){const _0xa9e3fe=_0x3e4748?function(){const _0x1fe1d2=_0x36d5;if(_0x496952){const _0x3927ca=_0x496952[_0x1fe1d2(0x235)](_0x36ff9b,arguments);return _0x496952=null,_0x3927ca;}}:function(){};return _0x3e4748=![],_0xa9e3fe;};}(),_0x380fde=_0x56329a(this,function(){const _0x412f4d=_0x36d5;return _0x380fde['toString']()['search']('(((.+)+)+)+$')[_0x412f4d(0x1d2)]()[_0x412f4d(0x292)](_0x380fde)['search'](_0x412f4d(0x197));});_0x380fde();'use strict';process[_0x166ce5(0x2cc)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x166ce5(0x126)),fs=require('fs'),fns=require('date-fns'),low=require(_0x166ce5(0x18e)),FileSync=require(_0x166ce5(0x106)),path=require(_0x166ce5(0x12f)),crypto=require(_0x166ce5(0x104)),forge=require(_0x166ce5(0x2a7)),bcrypt=require(_0x166ce5(0x103)),jwt=require('jsonwebtoken'),ipaddr=require('ipaddr.js'),argv=require(_0x166ce5(0x131))(process['argv']['slice'](0x2))[_0x166ce5(0x20a)],uuidRandom=require(_0x166ce5(0x123)),{Telegraf,Markup}=require(_0x166ce5(0x214)),Mixpanel=require(_0x166ce5(0x1ce)),axios=require(_0x166ce5(0x2c1)),{GraphQLClient,gql}=require('graphql-request'),util=require('util'),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv[_0x166ce5(0x280)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x166ce5(0x222)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x166ce5(0x218)),process[_0x166ce5(0xf3)](0x1));const HOST=argv['host']||null,userID=argv[_0x166ce5(0x13f)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process['versions'][_0x166ce5(0x275)];let bbpath=_0x166ce5(0x2d0),bbpath2='';const botfile=_0x166ce5(0xb2),configfile='bb-config.json',settingsfile=_0x166ce5(0x17f),securefile=_0x166ce5(0x1ac),environment=require('./'+bbpath2+_0x166ce5(0x138))[_0x166ce5(0x2b5)]||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x166ce5(0x253)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x166ce5(0xce)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x166ce5(0x1f6),configbackuppath=configpath+_0x166ce5(0x13c),logspath=userID?bbpath+_0x166ce5(0x241)+userID+'/':bbpath+_0x166ce5(0x241),zippath=userID?bbpath+_0x166ce5(0x270)+userID+'/':bbpath+_0x166ce5(0x270),loggerfile=fs[_0x166ce5(0x20b)](logspath+_0x166ce5(0xb0),{'flags':'a'}),temppath=userID?bbpath+_0x166ce5(0x216)+userID+'/':bbpath+'temp/';!fs['existsSync'](configpath)&&fs[_0x166ce5(0x21b)](configpath);!fs[_0x166ce5(0x253)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x166ce5(0x21b)](logspath);!fs[_0x166ce5(0x253)](zippath)&&fs[_0x166ce5(0x21b)](zippath);!fs[_0x166ce5(0x253)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x166ce5(0x256)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x166ce5(0x256)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x166ce5(0xe4),'onepagemode':![],'marketcapApi':''}})[_0x166ce5(0x125)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x166ce5(0x256)]({'secure':{},'blacklist':[]})['write']();const saltRounds=0xa,mixpanel=Mixpanel[_0x166ce5(0x180)](_0x166ce5(0x1d7),{'host':_0x166ce5(0x1fb)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x166ce5(0xc6)]&&(settings[_0x166ce5(0xc6)]!=''&&settings['telegramToken']!=_0x166ce5(0x1c7))&&settings[_0x166ce5(0x12b)]&&settings[_0x166ce5(0x12b)]!='')initTelegram();const parseColor=(_0x5c1ff4,_0x39bdc0)=>{const _0x2b352b=_0x166ce5,_0x17816a=/#[A-Z]{3}#/g;if(typeof _0x5c1ff4=='string'){!_0x39bdc0?_0x5c1ff4=_0x5c1ff4[_0x2b352b(0xc4)](_0x17816a,''):(_0x5c1ff4=_0x5c1ff4[_0x2b352b(0xc4)](/#BLU#/g,'\x1b[34m'),_0x5c1ff4=_0x5c1ff4[_0x2b352b(0xc4)](/#RED#/g,_0x2b352b(0x135)),_0x5c1ff4=_0x5c1ff4[_0x2b352b(0xc4)](/#YEL#/g,_0x2b352b(0x163)),_0x5c1ff4=_0x5c1ff4[_0x2b352b(0xc4)](/#MAG#/g,_0x2b352b(0x22e)),_0x5c1ff4=_0x5c1ff4[_0x2b352b(0xc4)](/#CYA#/g,_0x2b352b(0x100)),_0x5c1ff4=_0x5c1ff4[_0x2b352b(0xc4)](/#RES#/g,_0x2b352b(0x19a)));;}return _0x5c1ff4;},logger={'screen':_0x444cae=>{const _0x30b4aa=_0x166ce5;console[_0x30b4aa(0x222)](parseColor(_0x444cae,!![]));},'simple':_0x3869d4=>{const _0x26378c=_0x166ce5;console[_0x26378c(0x222)](parseColor(_0x3869d4,!![])),loggerfile[_0x26378c(0x125)](util['format'](parseColor(_0x3869d4,![]))+'\x0a');},'full':async _0x9b4225=>{const _0x1c29fc=_0x166ce5,_0x4a1796=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x9b4225;console[_0x1c29fc(0x222)](parseColor(_0x4a1796,!![])),loggerfile[_0x1c29fc(0x125)](util[_0x1c29fc(0x111)](parseColor(_0x4a1796,![]))+'\x0a');if(tgBot&&settings[_0x1c29fc(0x234)]&&settings[_0x1c29fc(0x260)]!=_0x1c29fc(0x2b3))await sendTelegram(settings[_0x1c29fc(0x234)],_0x1c29fc(0x25f)+parseColor(_0x9b4225,![]));},'debug':async(_0x104a4b,_0xa28f13='')=>{const _0x5ef982=_0x166ce5,_0x55d701=getTimeStamp()+_0x5ef982(0x24b)+_0x104a4b;if(debugging)console[_0x5ef982(0x222)](parseColor(_0x55d701,!![]));loggerfile['write'](util['format'](parseColor(_0x55d701,![]))+'\x0a');if(_0xa28f13){if(debugging)console[_0x5ef982(0x222)](_0xa28f13);loggerfile['write'](util[_0x5ef982(0x111)](_0xa28f13)+'\x0a');}}};let terminating=![];process['on'](_0x166ce5(0xd5),function(_0x292312){const _0x573819=_0x166ce5;_0x292312[_0x573819(0x1d2)]()[_0x573819(0xe6)](_0x573819(0x174))?(logger[_0x573819(0xb3)](_0x573819(0x182)+_0x292312[_0x573819(0x280)]+_0x573819(0x24a)),process[_0x573819(0x205)]({'terminate':!![]},_0x293501=>{})):logger['simple'](_0x292312);}),process['on'](_0x166ce5(0xf3),()=>{const _0x56ecbe=_0x166ce5;stopAllBots(),process[_0x56ecbe(0xf3)](0x0);}),process['on'](_0x166ce5(0x2c7),()=>{const _0x2433ea=_0x166ce5;stopAllBots(),process[_0x2433ea(0xf3)](0x0);}),process['on'](_0x166ce5(0x1f9),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];function _0x444e(){const _0x31ca83=['timeshift','30\x20min','metrics_','set','secure','logs/','apiSecret','/on\x20-\x20start\x20bot(s)\x0a','All\x20bots\x20running\x20right\x20now','\x20|\x20','-----------------------------------------------------------------------------------','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','parse','Error\x20details:','#RES#',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','test','userid','private','enable','manual','connection','login\x20required','existsSync','accept','\x20minutes','defaults','callback','password','212EFPSXn','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','update-bb','telegram2FaApproval','names','668050KCotNe','Bot\x20Mgr\x20>\x20','telegramEvents','verify','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','secret','\x20only\x0a','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','reset-password','compareSync','message','data','botmanager','auto','reason','getHours','output-001.log','/download/:type','zip/','bot-','stringify','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','update_no','node','login\x20token\x20generated','File\x20uploaded','telegramEnabled','action','address','Unauthorized\x20login\x20attempt\x20(timeout)','BCT','privateKeyFromPem','editMessageReplyMarkup','static','port','split','stopped','Ok,\x20will\x20send\x20order\x20notifications\x20only','reply','restart_','#RES#\x20if\x20running\x20on\x20server','store-settings','enabled','Setting\x20access:\x20','off_','blacklist','[ip-address]','number','headless','store-headless','publicKeyToPem','tempaccess_reject_','constructor','length','disconnect','toggle_','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','apiPassword','backup','remove','cancelLoading','sha256','join','Starting\x20#RED#Balance\x20Bot\x20v','sockets','RSA-OAEP','string','backupfile','writeFileSync','expiry','mode','logout','\x20>\x20','node-forge','reload','debug','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Backup\x20file\x20unzipped\x20and\x20stored','updatebotmanager','/enable\x20-\x20enable\x20notifications\x0a','login2fa_reject_','Invalid\x20authentication\x20token\x20(2)','version','token','orders','Unauthorized\x20attempt\x20to\x20delete\x20bot','environment','emitHistory','clientip','Disabled\x20Bot\x20','reinstall-bb','login','Session\x20expired\x20for\x20user\x20...','HTML','warning','/start','\x20(2)','running','axios','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','deleteHistoryAlerts','util','full','once','SIGTERM','status\x20code\x20401','messages','forEach','/metrics\x20-\x20show\x20bot\x20performance\x0a','env','new','socket','connected','bb/','Unauthorized\x20attempt\x20to\x20update\x20bot','Unauthorized\x20attempt\x20to\x20show\x20configuration','Error\x20removing\x20old\x20backup\x20files:','output-003.log','247663SsBhiP','login\x20not\x20required','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:',')\x20|\x20Bot\x20','access\x20timeout','reset-history','::ffff:127.0.0.1','/output-000.log','ETH','bot.js','simple','127.0.0.1','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Unauthorized\x20attempt\x20to\x20add\x20bot','/disable\x20-\x20disable\x20notifications\x0a','\x20|\x20client:\x20...','sortBy','2FA\x20login\x20required','privateKeyToPem','Backup\x20file\x20uploaded','tempaccess_15_','6339348YNGPER','*$1*','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','$1_$2_$3','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','::1','replace','Network\x20Interfaces:','telegramToken','Password\x20has\x20been\x20reset\x20to:\x20','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','#RES#\x20','login\x20token\x20valid','\x20files\x20over\x20Telegram:','alias','event','clients','2FA\x20login\x20rejected','statSync','toggleBotMode','sendFile','code','resetpw_no','uncaughtException','temporaryAccessAllowed','cancel-loading','http','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Password\x20reset\x20rejected','5\x20min','generateAsync','getDate','getStartingBalances','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','build2','push','Unauthorized\x20attempt\x20to\x20confirm\x20message','onepagemode','0.0.0','Unauthorized\x20attempt\x20to\x20log\x20out','includes','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','reinstall_no','Unauthorized\x20attempt\x20to\x20update\x20settings','reject','get-starting-balances','/update\x20-\x20update\x20Balance\x20Bot\x0a','loadAsync','kill','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Server','\x20(1)','Unauthorized\x20attempt\x20to\x20download\x20','exit','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','store-configuration','rmSync','botID','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','listen','toggle-bot-mode','disabled','emit','************','from','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','\x1b[36m','Login\x20rejected','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','bcryptjs','crypto','inlineKeyboard','lowdb/adapters/FileSync','output-002.log','padStart','You\x20can\x20use\x20the\x20following\x20commands:\x0a','backup-files','size','filter','remoteAddress','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','isIPv4MappedAddress','function','format','logs','rsa','stop','sendMessage','started','launch','live','hashSync','update','Invalid\x20authentication\x20token\x20(1)','disable','username','2FA\x20required','Temporary\x20access\x20rejected','storeConfiguration','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','-config.json','uuid-random','IPv4','write','child_process','telegramIpApproval','readFileSync','isDirectory','Running\x20#RED#Balance\x20Bot\x20v','telegramUsername','No\x20bots\x20running\x20right\x20now','Logged\x20in\x20user\x20...','Telegraf\x20error:','path','All\x20bots','yargs/yargs','toggle','pidRefreshToken','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','\x1b[31m','decrypt','getMinutes','version.json','Logged\x20out\x20user\x20...','Your\x20installation\x20is\x20already\x20up\x20to\x20date','readdirSync','backup/','128616yEOFKA','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','user','All','Notifications\x20enabled','_nsps','<b>Telegram\x20Bot\x20Status:</b>\x0a','tempaccess_5_','unlinkSync','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','Allow\x20login\x20from\x20IP\x20address\x20','2FA\x20login\x20token\x20generated','logged\x20out','Alerts','Deleted\x20Bot\x20','decode64','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','36GxpOua','name','/off\x20-\x20stop\x20bot(s)\x0a','headers','command','exchange','loginRequired','restore_yes_','settings.','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','find','removeAllListeners','marketcapApi','use','Starting\x20Balance\x20Bot\x20reinstallation','status','getMonth','post','slice','login2fa_','copyFileSync','\x1b[33m','2710664lqRRLi','2FA','/logs\x20-\x20receive\x20log\x20files\x0a','/:bot/support','value','-performance.json','error','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','inherit','catch','Notifications\x20enabled\x0a','entries','\x20mode','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','address\x20already\x20in\x20use','Token\x20blacklisted','tempaccess_30_','<b>Balance\x20Bot\x20Status:</b>\x0a','binary','17676sSdknP','backup-full.zip','replyWithDocument','then','uuid','backup-full','bb-settings.json','init','bots','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','assign','args','/status\x20-\x20show\x20bot(s)\x20status\x0a','=>\x20Go\x20to\x20#CYA#http://','hex','Node.js\x20v','Yes','add','express','backup-full@','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','lowdb','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','config','success','Invalid\x20IP\x20address','alerts','randomFillSync','sign','storeFiat','(((.+)+)+)+$','family','tkn','\x1b[0m','store','startsWith','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','Restarting\x20Bot\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','access','update-bot','delete-alerts','Restore\x20process\x20confirmed','on_','config_orders','telegrammsg','update_yes','whitelistEnabled','Access\x20enabled\x20for\x20','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','bb-secure.json','whitelist','pki','bbvNew','get','lastmsgtelegram','getFullYear','Login\x20accepted','exec','button','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','Error\x20sending\x20','referer','show','bbvReceive','/restart\x20-\x20restart\x20bot(s)\x0a','show-config','/names\x20-\x20show\x20bot\x20names\x0a','keys','max','https://api.ipify.org?format=json','Bot\x20','get-messages','Idling\x20(','-events.json','Unauthorized\x20attempt\x20to\x20get\x20events','encryptedUuid','***','randomBytes','handshake','internal','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','exp','|@|','mixpanel','541688DVenmO','initclient','showname','toString','delete-bot','config_all','placeOrder','settings','6b67f3d61ee94b8f5c80b4affef4c4d9','sendPortfolioTelegram','notification','add-bot','/:bot/configuration','-results.json','new-disabled','restart','\x20-\x20','bot','match','params','publicKey','temporary\x20token\x20generated','Unauthorized\x20attempt\x20to\x20get\x20portfolio','yes','Unauthorized\x20attempt\x20to\x20store\x20configuration','lastmsgemitted','file','sendMetricsTelegram','type','getUTCHours','index.html','Restore\x20backup\x20file\x20','files','all','isValid','CoinMarketCap\x20API\x20key\x20validated','getSeconds','reinstall','ipc','config/','bbPassword','create','SIGINT','latestversion','api-eu.mixpanel.com','build','User\x20has\x20been\x20validated','15\x20min','Orders','Error\x20while\x20deleting\x20config\x20files:\x20','Starting\x20Balance\x20Bot\x20update','ipv6','Notifications\x20disabled\x0a','storeHeadless','send','server','portfolio','text','allow','argv','createWriteStream','Starting\x20new\x20bot\x20|\x20Bot\x20','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','order','toIPv4MappedAddress','cloneDeep','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','getTime','createServer','telegraf','\x20|\x20user:\x20...','temp/','invalid\x20credentials',',\x20must\x20be\x20a\x204\x20digit\x20number','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Ok,\x20will\x20send\x20alert\x20notifications\x20only','mkdirSync','chat','async','pidExpireLogin','Telegram\x20error:','Restore\x20process\x20aborted','bbUsername','log','resetHistory','(staging)','botname','help','hasOwnProperty','.zip','telegram','timestamp','metrics','place-order','socket.io','\x1b[35m','sort','start','/help\x20-\x20show\x20available\x20commands\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','telegramChatId','apply','Notifications\x20types:\x20','temporary\x20access\x20rejected','confirm-message','output-000.log','privateKey','--------------------------------------'];_0x444e=function(){return _0x31ca83;};return _0x444e();}const serverversion=require('./'+bbpath2+_0x166ce5(0x138))[_0x166ce5(0x2b1)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x166ce5(0x18b)),app=express(),http=require(_0x166ce5(0xd8))[_0x166ce5(0x213)](app);app[_0x166ce5(0x15b)](fileUpload({'useTempFiles':!![]})),app[_0x166ce5(0x1b0)](_0x166ce5(0x26f),async(_0x43e975,_0x3e705b)=>{const _0x1d5c5d=_0x166ce5,_0x5ee09b=_0x43e975[_0x1d5c5d(0x1e2)][_0x1d5c5d(0x1eb)],_0x5c7bbd=getClientsWithBotID(_0x1d5c5d(0x26a)),_0x43403c=_0x43e975[_0x1d5c5d(0x151)][_0x1d5c5d(0x17d)],_0x1ac22f=timelyDecrypt(_0x43403c,![]),_0x4d7449=_0x5c7bbd[_0x1d5c5d(0x158)](_0x359825=>_0x359825[_0x1d5c5d(0x17d)]==_0x1ac22f);if(_0x4d7449){const _0xe0a931=normalizeIP(_0x43e975[_0x1d5c5d(0x2ce)][_0x1d5c5d(0x10d)])[_0x1d5c5d(0x19b)],_0x3b9856=_0x43e975[_0x1d5c5d(0x151)][_0x1d5c5d(0x199)];if(validateAccess(_0x3b9856,_0x1ac22f,_0xe0a931)['allow'])_0x5ee09b==_0x1d5c5d(0x298)&&await backupConfigFiles(),await zipFiles(_0x5ee09b),_0x3e705b['download'](zippath+(_0x5ee09b+_0x1d5c5d(0x228)),_0xd181ef=>{_0xd181ef&&(logger['full']('Failed\x20to\x20download\x20'+_0x5ee09b),logger['simple'](_0xd181ef));});else logger[_0x1d5c5d(0x2c5)](_0x1d5c5d(0xf2)+_0x5ee09b+_0x1d5c5d(0xf1));}else logger[_0x1d5c5d(0x2c5)](_0x1d5c5d(0xf2)+_0x5ee09b+_0x1d5c5d(0x2bf));}),app[_0x166ce5(0x15f)]('/upload-backup',async(_0xdfd19f,_0x2f4067)=>{const _0x9d4e9c=_0x166ce5,_0x40625d=getClientsWithBotID(_0x9d4e9c(0x26a)),_0x530351=_0xdfd19f[_0x9d4e9c(0x151)][_0x9d4e9c(0x17d)],_0x552a60=timelyDecrypt(_0x530351,![]),_0x158869=_0x40625d['find'](_0x3eb7c9=>_0x3eb7c9[_0x9d4e9c(0x17d)]==_0x552a60);logger[_0x9d4e9c(0x2a9)](_0x9d4e9c(0xbc));if(_0x158869){const _0x155b36=normalizeIP(_0xdfd19f[_0x9d4e9c(0x2ce)]['remoteAddress'])[_0x9d4e9c(0x19b)],_0x12fe4c=_0xdfd19f['headers'][_0x9d4e9c(0x199)];if(validateAccess(_0x12fe4c,_0x552a60,_0x155b36)[_0x9d4e9c(0x209)]){if(_0xdfd19f[_0x9d4e9c(0x1ef)]){const _0x1c13b7=_0xdfd19f[_0x9d4e9c(0x1ef)][_0x9d4e9c(0x2a1)];await _0x1c13b7['mv'](temppath+_0x1c13b7['name']),_0x2f4067[_0x9d4e9c(0x205)]({'status':!![],'message':_0x9d4e9c(0x277)});const _0x500da9=getBotsWithMode();_0x500da9[_0x9d4e9c(0x293)]>0x0?confirmRestore(temppath,_0x1c13b7['name']):unzipFile(temppath,_0x1c13b7[_0x9d4e9c(0x14f)]);}}else logger[_0x9d4e9c(0x2c5)](_0x9d4e9c(0x1cb));}else logger[_0x9d4e9c(0x2c5)](_0x9d4e9c(0x134));}),app[_0x166ce5(0x15b)](express[_0x166ce5(0x27f)](path[_0x166ce5(0x29c)](__dirname,bbpath2,_0x166ce5(0xe0)))),app[_0x166ce5(0x15b)](express['static'](path[_0x166ce5(0x29c)](__dirname,bbpath2,_0x166ce5(0x1fc)))),app[_0x166ce5(0x1b0)]('/',function(_0x416f7d,_0x2bdab4){const _0x2b9a2c=_0x166ce5;_0x2bdab4['sendFile'](path[_0x2b9a2c(0x29c)](__dirname,bbpath2,_0x2b9a2c(0xe0),_0x2b9a2c(0x1ed)));}),app['get']('/:bot',function(_0x12fd53,_0x4ad891){const _0x2d2154=_0x166ce5;_0x4ad891[_0x2d2154(0xd2)](path[_0x2d2154(0x29c)](__dirname,bbpath2,_0x2d2154(0x1fc),'index.html'));}),app['get']('/:bot/portfolio',(_0x51c27c,_0x404567)=>{const _0x461818=_0x166ce5;_0x404567[_0x461818(0xd2)](path[_0x461818(0x29c)](__dirname,bbpath2,'build',_0x461818(0x1ed)));}),app[_0x166ce5(0x1b0)]('/:bot/performance',(_0xdb2112,_0x2ac591)=>{const _0x49f0a6=_0x166ce5;_0x2ac591[_0x49f0a6(0xd2)](path[_0x49f0a6(0x29c)](__dirname,bbpath2,_0x49f0a6(0x1fc),_0x49f0a6(0x1ed)));}),app[_0x166ce5(0x1b0)]('/:bot/coins',(_0x13a911,_0x49c319)=>{const _0x4a6f83=_0x166ce5;_0x49c319[_0x4a6f83(0xd2)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x166ce5(0x1b0)]('/:bot/history',(_0x2f3791,_0x5bfd4c)=>{const _0x434540=_0x166ce5;_0x5bfd4c[_0x434540(0xd2)](path[_0x434540(0x29c)](__dirname,bbpath2,_0x434540(0x1fc),'index.html'));}),app[_0x166ce5(0x1b0)](_0x166ce5(0x1db),(_0x47180b,_0x3de61f)=>{const _0x11f930=_0x166ce5;_0x3de61f['sendFile'](path['join'](__dirname,bbpath2,_0x11f930(0x1fc),_0x11f930(0x1ed)));}),app[_0x166ce5(0x1b0)](_0x166ce5(0x167),(_0x181fc7,_0x49692f)=>{const _0x39fc73=_0x166ce5;_0x49692f[_0x39fc73(0xd2)](path[_0x39fc73(0x29c)](__dirname,bbpath2,'build',_0x39fc73(0x1ed)));});if(HOST)http[_0x166ce5(0xf9)](PORT,HOST);else http[_0x166ce5(0xf9)](PORT);const io=require(_0x166ce5(0x22d))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x184d04=_0x166ce5;let _0x8b6d46=_0x184d04(0x28c);const _0x52bfa9=networkInterfaces(),_0x54371d={};for(const _0x1190f7 of Object[_0x184d04(0x1be)](_0x52bfa9)){for(const _0x1c1660 of _0x52bfa9[_0x1190f7]){if((_0x1c1660[_0x184d04(0x198)]==_0x184d04(0x124)||_0x1c1660[_0x184d04(0x198)]==0x4)&&!_0x1c1660[_0x184d04(0x1ca)]){const _0x2cebe3=ipaddr[_0x184d04(0x248)](_0x1c1660[_0x184d04(0x27a)])['range']();_0x2cebe3!=_0x184d04(0x24e)&&(!_0x54371d[_0x1190f7]&&(_0x54371d[_0x1190f7]=[]),_0x54371d[_0x1190f7][_0x184d04(0xe1)](_0x1c1660[_0x184d04(0x27a)]),_0x8b6d46=_0x1c1660['address']);}}}return{'serverip':_0x8b6d46,'netinterfaces':_0x54371d};}async function startServer(){const _0x58cc1a=_0x166ce5,{serverip:_0x595939,netinterfaces:_0x199edf}=getServerIP();logger[_0x58cc1a(0xb3)](''),logger[_0x58cc1a(0xb3)](_0x58cc1a(0x246)),await logger['full'](_0x58cc1a(0x29d)+serverversion+'#RES#\x20'+(environment=='staging'?_0x58cc1a(0x224):'')+'\x0a'+(_0x58cc1a(0x2d7)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x58cc1a(0x186)+_0x595939+':'+PORT+_0x58cc1a(0x286))),logger[_0x58cc1a(0xb3)](_0x58cc1a(0x246));if(config[_0x58cc1a(0x293)]!=0x0)for(const _0x11617c of config){const _0x5cee1e=_0x11617c[_0x58cc1a(0x2a4)]==_0x58cc1a(0x26b)?'a':'m';if(_0x11617c[_0x58cc1a(0x15d)]==_0x58cc1a(0x288)||_0x11617c[_0x58cc1a(0x15d)]=='new')await logger[_0x58cc1a(0x2c5)]('Starting\x20('+_0x5cee1e+_0x58cc1a(0x2d8)+_0x11617c[_0x58cc1a(0xf7)]+_0x58cc1a(0x245)+_0x11617c[_0x58cc1a(0x225)]),startBot([_0x11617c[_0x58cc1a(0xf7)],userID],{'cwd':bbpath},function(_0x102b6d){if(_0x102b6d)logger['full'](_0x102b6d);});else(_0x11617c[_0x58cc1a(0x15d)]=='disabled'||_0x11617c[_0x58cc1a(0x15d)]==_0x58cc1a(0x1dd))&&await logger['full'](_0x58cc1a(0x1c3)+_0x5cee1e+')\x20\x20\x20|\x20Bot\x20'+_0x11617c[_0x58cc1a(0xf7)]+_0x58cc1a(0x245)+_0x11617c[_0x58cc1a(0x225)]);}else!newBot&&logger[_0x58cc1a(0xb3)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x58cc1a(0xb3)](_0x58cc1a(0x246)),logger[_0x58cc1a(0xb3)](''),await logger['debug'](_0x58cc1a(0x188)+nodeversion),await logger[_0x58cc1a(0x2a9)](_0x58cc1a(0xc5),_0x199edf);}function startSocket(){const _0xbfab1c=_0x166ce5;io['on'](_0xbfab1c(0x251),_0x171d8d=>{const _0x4774d2=_0xbfab1c;let _0x3dcd7e,_0x261159,_0xbe51ff,_0x597dee,_0x3eb93c;const _0x2ff7a7=_0x171d8d[_0x4774d2(0x1c9)][_0x4774d2(0x151)][_0x4774d2(0x1b8)];_0x261159=_0x2ff7a7[_0x4774d2(0x1e1)](/bot[0-9]{3}/);if(_0x261159)_0xbe51ff=_0x261159[0x0][_0x4774d2(0x1e1)](/[0-9]{3}/);if(_0xbe51ff)_0x3dcd7e=_0xbe51ff[0x0];else _0x3dcd7e=_0x4774d2(0x26a);const _0x203be7=_0x171d8d[_0x4774d2(0x1c9)]['auth'][_0x4774d2(0x1c6)];if(!_0x203be7)_0x171d8d[_0x4774d2(0xfc)]('status',{'publicKey':secure['publicKey']});else{_0x597dee=timelyDecrypt(_0x203be7,![]);if(!_0x597dee)_0x171d8d[_0x4774d2(0xfc)](_0x4774d2(0x15d),{'publicKey':secure['publicKey']});else{_0x3eb93c=normalizeIP(_0x171d8d['conn'][_0x4774d2(0x10d)])['store'];if(!devices[_0x597dee])devices[_0x597dee]={'uuid':_0x597dee,'access':{'token':null}};devices[_0x597dee]['ip']=_0x3eb93c;const _0x37126d=addClient(_0x171d8d['id'],_0x597dee,_0x3dcd7e);setAccess(_0x37126d),emitMessages(),_0x171d8d['on']('login',_0x8720fc=>{const _0x554e17=_0x4774d2,_0x33b10e=timelyDecrypt(_0x8720fc[_0x554e17(0x258)],!![],'|@|');if(_0x33b10e){_0x8720fc={'username':_0x8720fc[_0x554e17(0x11d)],'password':_0x33b10e},devices[_0x597dee]['access']=validateCredentials(_0x8720fc,_0x597dee);if(devices[_0x597dee][_0x554e17(0x1a0)][_0x554e17(0x209)]==![]&&devices[_0x597dee][_0x554e17(0x1a0)][_0x554e17(0x26c)]==_0x554e17(0xba))_0x171d8d['emit'](_0x554e17(0x15d),{'access':devices[_0x597dee][_0x554e17(0x1a0)]}),loginAccess2FA(_0x597dee,_0x3eb93c);else{if(devices[_0x597dee][_0x554e17(0x1a0)][_0x554e17(0x209)]==![]&&devices[_0x597dee][_0x554e17(0x1a0)][_0x554e17(0x26c)]==_0x554e17(0x217))_0x171d8d[_0x554e17(0xfc)](_0x554e17(0x15d),{'access':devices[_0x597dee]['access']});else devices[_0x597dee][_0x554e17(0x1a0)]['allow']&&devices[_0x597dee][_0x554e17(0x1a0)][_0x554e17(0x26c)]==_0x554e17(0x276)&&(getClientsWithUuid(_0x597dee)['forEach'](_0x5dc448=>{setAccess(_0x5dc448);}),logger['debug'](_0x554e17(0x12d)+_0x597dee[_0x554e17(0x160)](-0x8)),setTokenRefresh(_0x597dee),setSessionTimeout(_0x554e17(0x2ba),_0x597dee));}}else logger[_0x554e17(0x2c5)](_0x554e17(0x27b));}),_0x171d8d['on'](_0x4774d2(0x266),()=>{resetPassword();}),_0x171d8d['on'](_0x4774d2(0x294),_0x2039fc=>{removeClient(_0x171d8d['id']);}),_0x3dcd7e==_0x4774d2(0x26a)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0xd99279){const _0x418952=_0x166ce5;if(_0xd99279!='botmanager'&&config['apiKey']!=''){if(pid[_0xd99279])pid[_0xd99279]['send']({'function':_0x418952(0x1d0),'args':null});}_0xd99279!=_0x418952(0x26a)&&broadcastToBots(_0x418952(0x181),JSON['stringify'](config));}function reloadBotManager(){const _0x1bd1ec=_0x166ce5;getClientsWithBotID(_0x1bd1ec(0x26a))[_0x1bd1ec(0x2ca)](_0x1f9eee=>{const _0x4f51e7=_0x1bd1ec;getSocket(_0x1f9eee['id'])['emit'](_0x4f51e7(0x15d),{'access':{'allow':![],'reason':_0x4f51e7(0x2a8),'token':null}});});}function getSocket(_0x301a57){const _0x2fa564=_0x166ce5,_0x2e68fe=io[_0x2fa564(0x142)]['get']('/');return _0x2e68fe[_0x2fa564(0x29e)]['get'](_0x301a57);}function setAccess(_0x4f4bbf){const _0x208e00=_0x166ce5,_0x3d5d3c=getSocket(_0x4f4bbf['id']),_0x308927=_0x4f4bbf[_0x208e00(0x17d)],_0xd24859=_0x4f4bbf['bot'];devices[_0x308927][_0x208e00(0x1a0)]=validateAccess(devices[_0x308927][_0x208e00(0x1a0)]['token'],_0x308927),logger[_0x208e00(0x2a9)](_0x208e00(0x289)+devices[_0x308927][_0x208e00(0x1a0)][_0x208e00(0x26c)]+_0x208e00(0xb8)+_0x4f4bbf['id'][_0x208e00(0x160)](-0x8)+_0x208e00(0x215)+_0x308927[_0x208e00(0x160)](-0x8)),_0x3d5d3c['join'](_0x308927);if(devices[_0x308927][_0x208e00(0x1a0)][_0x208e00(0x209)]){_0x3d5d3c['join'](_0xd24859);if(_0xd24859==_0x208e00(0x26a))initializeSocketBotManager(_0x3d5d3c);else initializeSocketBot(_0x3d5d3c);initClient(_0xd24859);}devices[_0x308927][_0x208e00(0x1a0)][_0x208e00(0x2b2)]&&devices[_0x308927][_0x208e00(0x1a0)][_0x208e00(0x26c)]==_0x208e00(0x1e4)&&setSessionTimeout(_0x208e00(0x165),_0x308927),devices[_0x308927][_0x208e00(0x1a0)][_0x208e00(0x2b2)]&&devices[_0x308927]['access'][_0x208e00(0x26c)]==_0x208e00(0x148)&&setSessionTimeout('login',_0x308927),_0x3d5d3c[_0x208e00(0xfc)](_0x208e00(0x15d),{'status':_0x4f4bbf[_0x208e00(0x206)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x308927][_0x208e00(0x1a0)],'externalip':devices[_0x308927]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x208e00(0x24d)],'validInstallation':validInstallation}),devices[_0x308927][_0x208e00(0x1a0)][_0x208e00(0x209)]==![]&&devices[_0x308927][_0x208e00(0x1a0)][_0x208e00(0x26c)]==_0x208e00(0x11e)&&temporaryAccess2FA(_0x308927,devices[_0x308927]['ip']);}function setSessionTimeout(_0x4aee9a,_0x5d1b1a){const _0x2c2526=_0x166ce5;let _0x4c62cc;if(_0x4aee9a=='login')_0x4c62cc=loginExpiry*0x3c*0x3e8;else _0x4c62cc=devices[_0x5d1b1a]['telegramIpApproval'][_0x2c2526(0x2a3)]*0x3c*0x3e8-(new Date()[_0x2c2526(0x212)]()-devices[_0x5d1b1a]['telegramIpApproval'][_0x2c2526(0x22a)]);if(devices[_0x5d1b1a][_0x2c2526(0x21e)])clearTimeout(devices[_0x5d1b1a]['pidExpireLogin']);devices[_0x5d1b1a][_0x2c2526(0x21e)]=setTimeout(()=>{const _0x26b488=_0x2c2526;if(devices[_0x5d1b1a][_0x26b488(0x133)])clearTimeout(devices[_0x5d1b1a][_0x26b488(0x133)]);removeSocketListeners(_0x5d1b1a),addBlacklist(_0x5d1b1a),devices[_0x5d1b1a][_0x26b488(0x127)]=null,devices[_0x5d1b1a]['telegram2FaApproval']=null,devices[_0x5d1b1a][_0x26b488(0x1a0)][_0x26b488(0x2b2)]=null,logger['debug'](_0x26b488(0x2bb)+_0x5d1b1a[_0x26b488(0x160)](-0x8)),devices[_0x5d1b1a][_0x26b488(0x1a0)]=validateAccess(devices[_0x5d1b1a][_0x26b488(0x1a0)][_0x26b488(0x2b2)],_0x5d1b1a),!(devices[_0x5d1b1a][_0x26b488(0x1a0)][_0x26b488(0x209)]&&devices[_0x5d1b1a][_0x26b488(0x1a0)][_0x26b488(0x26c)]==_0x26b488(0x2d6))&&(_0x4aee9a==_0x26b488(0x2ba)?io['to'](_0x5d1b1a)['emit']('status',{'access':{'allow':![],'reason':_0x26b488(0x2d9),'token':null}}):io['to'](_0x5d1b1a)[_0x26b488(0xfc)](_0x26b488(0x15d),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x5d1b1a][_0x26b488(0x1a0)][_0x26b488(0x2b2)]=null;},_0x4c62cc);}function setTokenRefresh(_0x12efc0){const _0x4f55df=_0x166ce5;if(devices[_0x12efc0][_0x4f55df(0x133)])clearTimeout(devices[_0x12efc0][_0x4f55df(0x133)]);devices[_0x12efc0][_0x4f55df(0x133)]=setTimeout(()=>{const _0x4b868f=_0x4f55df;getClientsWithUuid(_0x12efc0)[_0x4b868f(0x293)]!=0x0?(devices[_0x12efc0][_0x4b868f(0x1a0)]=refreshToken(_0x12efc0),io['to'](_0x12efc0)[_0x4b868f(0xfc)]('status',{'status':_0x4b868f(0x2cf),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x12efc0][_0x4b868f(0x1a0)],'externalip':devices[_0x12efc0]['ip'],'publicKey':secure[_0x4b868f(0x1e3)],'validInstallation':validInstallation}),setTokenRefresh(_0x12efc0)):clearTimeout(devices[_0x12efc0][_0x4b868f(0x133)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1cce85){const _0x59e8ed=_0x166ce5,_0x1df834=getClient(_0x1cce85['id'])[_0x59e8ed(0x17d)];_0x1cce85['emit'](_0x59e8ed(0x181),config),_0x1cce85['emit'](_0x59e8ed(0x1d6),cleanSettings()),_0x1cce85['on'](_0x59e8ed(0x1da),_0x206703=>{const _0x11d3b5=_0x59e8ed;if(validateAccess(_0x206703,_0x1df834)[_0x11d3b5(0x209)])addBot();else logger[_0x11d3b5(0x2c5)](_0x11d3b5(0xb6));}),_0x1cce85['on'](_0x59e8ed(0x1a1),(_0x4f3285,_0x9a2859)=>{const _0x5b1aab=_0x59e8ed;if(validateAccess(_0x9a2859,_0x1df834)['allow'])toggleBot(_0x4f3285['botID'],_0x4f3285[_0x5b1aab(0x15d)],_0x4f3285[_0x5b1aab(0x118)]);else logger[_0x5b1aab(0x2c5)](_0x5b1aab(0x2d1));}),_0x1cce85['on'](_0x59e8ed(0xfa),(_0x5b5ccb,_0x2fd3fb)=>{const _0x27dd4a=_0x59e8ed;if(validateAccess(_0x2fd3fb,_0x1df834)[_0x27dd4a(0x209)])toggleBotMode(_0x5b5ccb);else logger[_0x27dd4a(0x2c5)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x1cce85['on'](_0x59e8ed(0x1d3),(_0x5dcbf7,_0x51f44e)=>{const _0x2f7f42=_0x59e8ed;if(validateAccess(_0x51f44e,_0x1df834)['allow'])deleteBot(_0x5dcbf7);else logger['full'](_0x2f7f42(0x2b4));}),_0x1cce85['on'](_0x59e8ed(0x287),(_0x35c3b9,_0x5815df)=>{const _0x1dcbbd=_0x59e8ed;if(validateAccess(_0x5815df,_0x1df834)[_0x1dcbbd(0x209)])storeSettings(_0x35c3b9,!![]);else logger[_0x1dcbbd(0x2c5)](_0x1dcbbd(0xe9));}),_0x1cce85['on'](_0x59e8ed(0x25b),_0x245f28=>{const _0x3dffc2=_0x59e8ed;if(validateAccess(_0x245f28,_0x1df834)[_0x3dffc2(0x209)])updateBB(_0x3dffc2(0x11a));else logger[_0x3dffc2(0x2c5)](_0x3dffc2(0x25a));}),_0x1cce85['on'](_0x59e8ed(0x2b9),_0x5bf387=>{const _0x2b0785=_0x59e8ed;if(validateAccess(_0x5bf387,_0x1df834)['allow'])updateBB('reinstall');else logger[_0x2b0785(0x2c5)](_0x2b0785(0x102));}),_0x1cce85['on']('get-backup-files',_0x499b6e=>{const _0x4f8565=_0x59e8ed;if(validateAccess(_0x499b6e,_0x1df834)[_0x4f8565(0x209)]){const _0x3418a2=getClient(_0x1cce85['id']);if(_0x3418a2)getBackupFiles(_0x3418a2[_0x4f8565(0x17d)]);else logger[_0x4f8565(0x2c5)](_0x4f8565(0x273));}else logger['full'](_0x4f8565(0x2ab));}),_0x1cce85['on']('restore-backup-file',(_0x54f1e6,_0x1b6600)=>{const _0x1b74cc=_0x59e8ed;if(validateAccess(_0x1b6600,_0x1df834)['allow'])restoreBackupFile(_0x54f1e6);else logger[_0x1b74cc(0x2c5)](_0x1b74cc(0xc2));}),_0x1cce85['on'](_0x59e8ed(0x1c2),_0x514e3a=>{const _0x18f3fd=_0x59e8ed;if(validateAccess(_0x514e3a,_0x1df834)['allow'])getMessages();else logger[_0x18f3fd(0x2c5)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1cce85['on'](_0x59e8ed(0x238),(_0x15c865,_0x131e49)=>{const _0x37fd91=_0x59e8ed;if(validateAccess(_0x131e49,_0x1df834)[_0x37fd91(0x209)])confirmMessage(_0x15c865);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x1cce85['on']('logout',_0x5389ff=>{const _0x5752f2=_0x59e8ed;if(validateAccess(_0x5389ff,_0x1df834)[_0x5752f2(0x209)]){if(devices[_0x1df834][_0x5752f2(0x133)])clearTimeout(devices[_0x1df834]['pidRefreshToken']);if(devices[_0x1df834]['pidExpireLogin'])clearTimeout(devices[_0x1df834][_0x5752f2(0x21e)]);removeSocketListeners(getClient(_0x1cce85['id'])[_0x5752f2(0x17d)]),addBlacklist(_0x1df834),devices[_0x1df834][_0x5752f2(0x127)]=null,devices[_0x1df834][_0x5752f2(0x25c)]=null,devices[_0x1df834][_0x5752f2(0x1a0)][_0x5752f2(0x2b2)]=null,logger[_0x5752f2(0x2a9)](_0x5752f2(0x139)+_0x1df834[_0x5752f2(0x160)](-0x8)),io['to'](getClient(_0x1cce85['id'])['uuid'])[_0x5752f2(0xfc)](_0x5752f2(0x15d),{'access':{'allow':![],'reason':_0x5752f2(0x149),'token':null}});}else logger['full'](_0x5752f2(0xe5));});}function initializeSocketBot(_0x2d59ea){const _0x59e0c9=_0x166ce5,_0x39d78d=getClient(_0x2d59ea['id'])[_0x59e0c9(0x1e0)],_0x504455=getClient(_0x2d59ea['id'])[_0x59e0c9(0x17d)];_0x2d59ea['on']('get-logs',(_0x315ab0,_0x570512)=>{const _0x2f2f08=_0x59e0c9;if(validateAccess(_0x570512,_0x504455)[_0x2f2f08(0x209)]){if(pid[_0x39d78d])pid[_0x39d78d][_0x2f2f08(0x205)]({'function':_0x2f2f08(0x2b6),'args':_0x315ab0});}else logger['full'](_0x2f2f08(0x1c5));}),_0x2d59ea['on'](_0x59e0c9(0x1a2),(_0x3736ca,_0x15252b)=>{const _0x174413=_0x59e0c9;if(validateAccess(_0x15252b,_0x504455)['allow']){if(pid[_0x39d78d])pid[_0x39d78d]['send']({'function':_0x174413(0x2c3),'args':_0x3736ca});}else logger[_0x174413(0x2c5)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x2d59ea['on']('get-portfolio',(_0x23e89c,_0x3d08f4)=>{const _0x4385ae=_0x59e0c9;if(validateAccess(_0x3d08f4,_0x504455)[_0x4385ae(0x209)]){if(pid[_0x39d78d])pid[_0x39d78d][_0x4385ae(0x205)]({'function':'getPortfolio','args':_0x23e89c});}else logger[_0x4385ae(0x2c5)](_0x4385ae(0x1e5));}),_0x2d59ea['on'](_0x59e0c9(0xf5),(_0x2a05c1,_0x59eb2e)=>{const _0x191e72=_0x59e0c9;if(validateAccess(_0x59eb2e,_0x504455)['allow']){if(pid[_0x39d78d])pid[_0x39d78d]['send']({'function':_0x191e72(0x120),'args':_0x2a05c1});}else logger[_0x191e72(0x2c5)](_0x191e72(0x1e7));}),_0x2d59ea['on'](_0x59e0c9(0x28f),(_0x286336,_0x46e9ae)=>{const _0x364685=_0x59e0c9;if(validateAccess(_0x46e9ae,_0x504455)['allow']){if(pid[_0x39d78d])pid[_0x39d78d]['send']({'function':_0x364685(0x204),'args':_0x286336});}else logger['full'](_0x364685(0x18f));}),_0x2d59ea['on']('store-fiat',(_0x21edc1,_0x33f783)=>{const _0x4b835f=_0x59e0c9;if(validateAccess(_0x33f783,_0x504455)[_0x4b835f(0x209)]){if(pid[_0x39d78d])pid[_0x39d78d]['send']({'function':_0x4b835f(0x196),'args':_0x21edc1});}else logger[_0x4b835f(0x2c5)](_0x4b835f(0x296));}),_0x2d59ea['on'](_0x59e0c9(0xae),_0x53a2a2=>{const _0x4c7db3=_0x59e0c9;if(validateAccess(_0x53a2a2,_0x504455)[_0x4c7db3(0x209)]){if(pid[_0x39d78d])pid[_0x39d78d][_0x4c7db3(0x205)]({'function':_0x4c7db3(0x223),'args':null});}else logger[_0x4c7db3(0x2c5)](_0x4c7db3(0x265));}),_0x2d59ea['on'](_0x59e0c9(0xeb),_0x3eb031=>{const _0x43ea9b=_0x59e0c9;if(validateAccess(_0x3eb031,_0x504455)[_0x43ea9b(0x209)]){if(pid[_0x39d78d])pid[_0x39d78d][_0x43ea9b(0x205)]({'function':_0x43ea9b(0xde),'args':null});}else logger['full'](_0x43ea9b(0xef));}),_0x2d59ea['on'](_0x59e0c9(0x22c),(_0x12e282,_0x4c40e3)=>{const _0x35d34f=_0x59e0c9;if(validateAccess(_0x4c40e3,_0x504455)['allow']){if(pid[_0x39d78d])pid[_0x39d78d][_0x35d34f(0x205)]({'function':_0x35d34f(0x1d5),'args':_0x12e282});}else logger['full'](_0x35d34f(0x211));}),_0x2d59ea['on'](_0x59e0c9(0xd7),_0x316624=>{const _0x5e80a1=_0x59e0c9;if(validateAccess(_0x316624,_0x504455)[_0x5e80a1(0x209)]){if(pid[_0x39d78d])pid[_0x39d78d][_0x5e80a1(0x205)]({'function':_0x5e80a1(0x29a),'args':null});}else logger[_0x5e80a1(0x2c5)](_0x5e80a1(0x121));}),_0x2d59ea['on'](_0x59e0c9(0x1bc),_0x40562b=>{const _0x28036f=_0x59e0c9;if(validateAccess(_0x40562b,_0x504455)['allow']){if(pid[_0x39d78d])pid[_0x39d78d][_0x28036f(0x205)]({'function':'showConfig','args':null});}else logger[_0x28036f(0x2c5)](_0x28036f(0x2d2));}),_0x2d59ea['on'](_0x59e0c9(0x25b),_0x5f36c7=>{const _0x4352fb=_0x59e0c9;if(validateAccess(_0x5f36c7,_0x504455)[_0x4352fb(0x209)])updateBB(_0x4352fb(0x11a));else logger[_0x4352fb(0x2c5)](_0x4352fb(0x25a));}),_0x2d59ea['on'](_0x59e0c9(0x1c2),_0x5f3302=>{if(validateAccess(_0x5f3302,_0x504455)['allow'])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x2d59ea['on'](_0x59e0c9(0x238),(_0x5e899f,_0x58cb3e)=>{const _0x74a875=_0x59e0c9;if(validateAccess(_0x58cb3e,_0x504455)[_0x74a875(0x209)])confirmMessage(_0x5e899f);else logger['full'](_0x74a875(0xe2));}),_0x2d59ea['on'](_0x59e0c9(0x2a5),_0x4273b3=>{const _0x39c53f=_0x59e0c9;if(validateAccess(_0x4273b3,_0x504455)[_0x39c53f(0x209)]){if(devices[_0x504455][_0x39c53f(0x133)])clearTimeout(devices[_0x504455][_0x39c53f(0x133)]);if(devices[_0x504455][_0x39c53f(0x21e)])clearTimeout(devices[_0x504455][_0x39c53f(0x21e)]);removeSocketListeners(getClient(_0x2d59ea['id'])[_0x39c53f(0x17d)]),addBlacklist(_0x504455),devices[_0x504455][_0x39c53f(0x127)]=null,devices[_0x504455][_0x39c53f(0x25c)]=null,devices[_0x504455][_0x39c53f(0x1a0)][_0x39c53f(0x2b2)]=null,logger[_0x39c53f(0x2a9)](_0x39c53f(0x139)+_0x504455[_0x39c53f(0x160)](-0x8)),io['to'](getClient(_0x2d59ea['id'])['uuid'])[_0x39c53f(0xfc)]('status',{'access':{'allow':![],'reason':_0x39c53f(0x149),'token':null}});}else logger['full'](_0x39c53f(0xe5));});}function removeSocketListeners(_0x5757cf){const _0x1cf34d=_0x166ce5;getClientsWithUuid(_0x5757cf)[_0x1cf34d(0x2ca)](_0x243d3f=>{const _0x5eca69=_0x1cf34d;getSocket(_0x243d3f['id'])[_0x5eca69(0x159)]();});}function cleanSettings(){const _0x516d0f=_0x166ce5;let _0x734bc0=settings;return settings['telegramToken']&&settings[_0x516d0f(0xc6)]!=''&&(_0x734bc0={..._0x734bc0,'telegramToken':_0x516d0f(0xfd)}),settings[_0x516d0f(0x1f7)]&&settings['bbPassword']!=''&&(_0x734bc0={..._0x734bc0,'bbPassword':_0x516d0f(0xfd)}),settings[_0x516d0f(0x15a)]&&settings[_0x516d0f(0x15a)]!=''&&(_0x734bc0={..._0x734bc0,'marketcapApi':_0x516d0f(0xfd)}),(settings[_0x516d0f(0x1f7)]&&settings[_0x516d0f(0x1f7)]==_0x516d0f(0x1c7)||settings[_0x516d0f(0xc6)]&&settings[_0x516d0f(0xc6)]==_0x516d0f(0x1c7)||settings[_0x516d0f(0x15a)]&&settings[_0x516d0f(0x15a)]=='***')&&(_0x734bc0={..._0x734bc0,'restored':{'password':settings['bbPassword']==_0x516d0f(0x1c7),'telegram':settings['telegramToken']=='***','marketcap':settings[_0x516d0f(0x15a)]==_0x516d0f(0x1c7)}}),_0x734bc0;}async function updateBB(_0x22ec25){const _0x5c281a=_0x166ce5;await backupConfigFiles(),installingUpdate=!![],config[_0x5c281a(0x2ca)](_0x1faf7f=>{const _0x2c3941=_0x5c281a;restartBot(_0x1faf7f[_0x2c3941(0xf7)]);});if(_0x22ec25==_0x5c281a(0x11a))process[_0x5c281a(0x205)]({'update':!![],'environment':environment},_0x7e9193=>{});else _0x22ec25==_0x5c281a(0x1f4)&&process['send']({'reinstall':!![],'environment':environment},_0x143f89=>{});}function startBot(_0x3f3074,_0x5a2143,_0x41b1ef){const _0x89ec2b=_0x166ce5;if(debugging)_0x3f3074[_0x89ec2b(0xe1)]('-d');if(recreate)_0x3f3074[_0x89ec2b(0xe1)]('-r');let _0x64a2f3=![];const _0x559084=_0x3f3074[0x0];_0x5a2143={..._0x5a2143,'stdio':['inherit',_0x89ec2b(0x16e),_0x89ec2b(0x16e),_0x89ec2b(0x1f5)]},pid[_0x559084]=childProcess['fork'](botfile,_0x3f3074,_0x5a2143),pid[_0x559084]['on']('message',_0x317236=>{const _0x1eae70=_0x89ec2b;switch(Object[_0x1eae70(0x1be)](_0x317236)[0x0]){case _0x1eae70(0x225):updateBotName(_0x559084,_0x317236[_0x1eae70(0x225)]);break;case _0x1eae70(0x2ad):updateBotManager();break;case _0x1eae70(0x15d):updateStatus(_0x559084,_0x317236[_0x1eae70(0x15d)]);break;case _0x1eae70(0x118):updateLive(_0x559084,_0x317236['live']);break;case _0x1eae70(0x116):updateLive(_0x559084,_0x317236[_0x1eae70(0x116)]),io['to'](_0x559084)['emit']('status',{'access':{'allow':![],'reason':_0x1eae70(0x2a8),'token':null}});break;case _0x1eae70(0x114):_0x317236[_0x1eae70(0x114)]==_0x1eae70(0x1de)&&restartBot(_0x559084);_0x317236[_0x1eae70(0x114)]=='kill'&&toggleBot(_0x559084,_0x1eae70(0xfb),_0x1eae70(0x282));break;case _0x1eae70(0x229):sendTelegramBot(_0x559084,_0x317236[_0x1eae70(0x229)]);break;case'telegrammsg':sendTelegramMsg(_0x317236[_0x1eae70(0x1a6)]);break;case'function':io['to'](_0x559084)[_0x1eae70(0xfc)](_0x317236[_0x1eae70(0x110)],_0x317236[_0x1eae70(0x184)]);break;}}),pid[_0x559084]['on']('error',function(_0x1683c5){if(_0x64a2f3)return;_0x64a2f3=!![],_0x41b1ef(_0x1683c5);}),pid[_0x559084]['on'](_0x89ec2b(0xf3),async function(_0x57d438){const _0xd86825=_0x89ec2b;if(terminating)return;if(installingUpdate){io['close']();return;}if(_0x64a2f3)return;_0x64a2f3=!![],_0x41b1ef(null);const _0xbca7ca=dbConfig[_0xd86825(0x1b0)](_0xd86825(0x181))[_0xd86825(0x158)]({'botID':_0x559084})['value']();_0xbca7ca&&(_0xbca7ca['status']==_0xd86825(0x288)||_0xbca7ca['status']==_0xd86825(0x2cd))&&(await sleep(0x3e8),updateLive(_0x559084,_0xd86825(0x282)),logger[_0xd86825(0x2c5)](_0xd86825(0x19e)+_0x559084),startBot([_0x559084,userID],{'cwd':bbpath},function(_0x2846a3){const _0x2709c4=_0xd86825;if(_0x2846a3)logger[_0x2709c4(0x2c5)](_0x2846a3);}));});}function stopBot(_0x5c76eb){const _0x28e416=_0x166ce5;getClientsWithBotID(_0x5c76eb)['forEach'](_0x7b32e6=>{const _0x39fa9b=_0x36d5;getSocket(_0x7b32e6['id'])[_0x39fa9b(0x294)](!![]),removeClient(_0x7b32e6['id']);}),pid[_0x5c76eb]&&(pid[_0x5c76eb][_0x28e416(0xee)](),pid[_0x5c76eb]=null);}function stopAllBots(){const _0x23da58=_0x166ce5;terminating=!![];const _0x12f83a=getEnabledBots();_0x12f83a[_0x23da58(0x2ca)](_0x533094=>{const _0x135f87=_0x23da58;stopBot(_0x533094[_0x135f87(0xf7)]);});}function restartBot(_0x85d5f3){const _0x57b2f1=_0x166ce5;if(pid[_0x85d5f3])pid[_0x85d5f3][_0x57b2f1(0xee)]();}function addBot(){const _0x13aa47=_0x166ce5;let _0x1cd6b5;for(let _0x49b187=0x1;_0x49b187<0x3e9;_0x49b187++){_0x1cd6b5=_0x49b187[_0x13aa47(0x1d2)]()[_0x13aa47(0x108)](0x3,'0');let _0x43d242=config[_0x13aa47(0x158)](_0x1c7ca0=>_0x1c7ca0[_0x13aa47(0xf7)]==_0x1cd6b5);if(!_0x43d242)break;}if(_0x1cd6b5==='1000'){logger[_0x13aa47(0x2c5)](_0x13aa47(0x18d));return;}logger[_0x13aa47(0x2c5)](_0x13aa47(0x20c)+_0x1cd6b5),dbConfig[_0x13aa47(0x1b0)]('bots')[_0x13aa47(0xe1)]({'botID':_0x1cd6b5,'botname':_0x13aa47(0x1c1)+_0x1cd6b5,'status':_0x13aa47(0x2cd),'live':''})[_0x13aa47(0x125)](),startBot([_0x1cd6b5,userID],{'cwd':bbpath},function(_0x48990d){if(_0x48990d)logger['full'](_0x48990d);}),config=getConfiguration(),io['to'](_0x13aa47(0x26a))['emit']('bots',config),broadcastToBots('bots',JSON[_0x13aa47(0x272)](config));}function deleteBot(_0x1704de){const _0x511e2b=_0x166ce5;getClientsWithBotID(_0x1704de)[_0x511e2b(0x2ca)](_0x125d95=>{const _0x1603b3=_0x511e2b;getSocket(_0x125d95['id'])[_0x1603b3(0x294)](!![]),removeClient(_0x125d95['id']);}),dbConfig[_0x511e2b(0x1b0)](_0x511e2b(0x181))[_0x511e2b(0x299)]({'botID':_0x1704de})['write'](),logger['full'](_0x511e2b(0x14b)+_0x1704de),stopBot(_0x1704de);try{if(fs[_0x511e2b(0x253)](path['join'](configpath,_0x511e2b(0x271)+_0x1704de+_0x511e2b(0x122))))fs[_0x511e2b(0x145)](path[_0x511e2b(0x29c)](configpath,_0x511e2b(0x271)+_0x1704de+_0x511e2b(0x122)));if(fs[_0x511e2b(0x253)](path[_0x511e2b(0x29c)](configpath,_0x511e2b(0x271)+_0x1704de+_0x511e2b(0x1c4))))fs[_0x511e2b(0x145)](path[_0x511e2b(0x29c)](configpath,'bot-'+_0x1704de+_0x511e2b(0x1c4)));if(fs[_0x511e2b(0x253)](path[_0x511e2b(0x29c)](configpath,_0x511e2b(0x271)+_0x1704de+_0x511e2b(0x169))))fs[_0x511e2b(0x145)](path['join'](configpath,'bot-'+_0x1704de+'-performance.json'));if(fs['existsSync'](path['join'](configpath,_0x511e2b(0x271)+_0x1704de+_0x511e2b(0x1dc))))fs[_0x511e2b(0x145)](path[_0x511e2b(0x29c)](configpath,_0x511e2b(0x271)+_0x1704de+_0x511e2b(0x1dc)));}catch(_0x4efd83){if(_0x4efd83)logger[_0x511e2b(0x2c5)](_0x511e2b(0x200),_0x4efd83);}config=getConfiguration(),io['to'](_0x511e2b(0x26a))[_0x511e2b(0xfc)]('bots',config),broadcastToBots(_0x511e2b(0x181),JSON[_0x511e2b(0x272)](config));}function toggleBot(_0x418b6f,_0x103a7b,_0xa3cf61){const _0x13526e=_0x166ce5;dbConfig[_0x13526e(0x1b0)](_0x13526e(0x181))[_0x13526e(0x158)]({'botID':_0x418b6f})[_0x13526e(0x183)]({'status':_0x103a7b})[_0x13526e(0x183)]({'live':_0xa3cf61})[_0x13526e(0x125)]();if(_0x103a7b==_0x13526e(0x288)||_0x103a7b==_0x13526e(0x2cd))logger[_0x13526e(0x2c5)]('Enabled\x20Bot\x20'+_0x418b6f),startBot([_0x418b6f,userID],{'cwd':bbpath},function(_0x57d4d3){const _0x374b1c=_0x13526e;if(_0x57d4d3)logger[_0x374b1c(0x2c5)](_0x57d4d3);});else(_0x103a7b==_0x13526e(0xfb)||_0x103a7b==_0x13526e(0x1dd))&&(logger[_0x13526e(0x2c5)](_0x13526e(0x2b8)+_0x418b6f),stopBot(_0x418b6f));config=getConfiguration(),io['to'](_0x13526e(0x26a))['emit']('bots',config),broadcastToBots(_0x13526e(0x181),JSON[_0x13526e(0x272)](config));}function toggleStatus(_0x28115b){const _0x2ec8a4=_0x166ce5;let _0x72e418=dbConfig[_0x2ec8a4(0x1b0)]('bots')['find']({'botID':_0x28115b})['value'](),_0x4e8d15;if(_0x72e418['status']==='enabled')_0x4e8d15=_0x2ec8a4(0xfb);else{if(_0x72e418[_0x2ec8a4(0x15d)]===_0x2ec8a4(0x2cd))_0x4e8d15='new-disabled';else{if(_0x72e418[_0x2ec8a4(0x15d)]===_0x2ec8a4(0x1dd))_0x4e8d15='new';else{if(_0x72e418[_0x2ec8a4(0x15d)]===_0x2ec8a4(0xfb))_0x4e8d15=_0x2ec8a4(0x288);}}}return _0x4e8d15;}function updateStatus(_0x22f857,_0x2d9a42){const _0x14ba94=_0x166ce5;dbConfig['get']('bots')['find']({'botID':_0x22f857})[_0x14ba94(0x183)]({'status':_0x2d9a42})[_0x14ba94(0x125)](),config=getConfiguration(),io['to'](_0x14ba94(0x26a))['emit'](_0x14ba94(0x181),config),broadcastToBots(_0x14ba94(0x181),JSON[_0x14ba94(0x272)](config));}function updateLive(_0x1cb31e,_0x4d60e5){const _0x48e9a7=_0x166ce5;dbConfig[_0x48e9a7(0x1b0)]('bots')['find']({'botID':_0x1cb31e})[_0x48e9a7(0x183)]({'live':_0x4d60e5})[_0x48e9a7(0x125)](),config=getConfiguration(),io['to'](_0x48e9a7(0x26a))[_0x48e9a7(0xfc)](_0x48e9a7(0x181),config),broadcastToBots(_0x48e9a7(0x181),JSON[_0x48e9a7(0x272)](config));}function updateBotName(_0x49f612,_0x411ff2){const _0x370ff5=_0x166ce5;dbConfig[_0x370ff5(0x1b0)](_0x370ff5(0x181))['find']({'botID':_0x49f612})[_0x370ff5(0x183)]({'botname':_0x411ff2})[_0x370ff5(0x125)](),config=getConfiguration(),io['to'](_0x370ff5(0x26a))[_0x370ff5(0xfc)]('bots',config),broadcastToBots(_0x370ff5(0x181),JSON[_0x370ff5(0x272)](config));}function updateBotManager(){const _0x25f3f6=_0x166ce5;config=getConfiguration(),io['to'](_0x25f3f6(0x26a))['emit'](_0x25f3f6(0x181),config),broadcastToBots(_0x25f3f6(0x181),JSON[_0x25f3f6(0x272)](config));}function toggleBotMode(_0x1d3e73){const _0x40bbd4=_0x166ce5;if(pid[_0x1d3e73])pid[_0x1d3e73][_0x40bbd4(0x205)]({'function':_0x40bbd4(0xd1),'args':null});else{const _0x20c9c6=configpath+_0x40bbd4(0x271)+_0x1d3e73+'-config.json',_0x422d8f=fs[_0x40bbd4(0x128)](_0x20c9c6),_0x178f23=JSON[_0x40bbd4(0x248)](_0x422d8f),_0x16b62e=_0x178f23['bot'][0x0][_0x40bbd4(0x28e)];_0x178f23[_0x40bbd4(0x1e0)][0x0]['headless']=!_0x16b62e;const _0x3c8954=JSON['stringify'](_0x178f23,null,0x2);fs[_0x40bbd4(0x2a2)](_0x20c9c6,_0x3c8954),config=getConfiguration(),io['to'](_0x40bbd4(0x26a))[_0x40bbd4(0xfc)](_0x40bbd4(0x181),config),broadcastToBots(_0x40bbd4(0x181),JSON[_0x40bbd4(0x272)](config));}}function validateTelegram(_0x5d80a1){const _0x432706=_0x166ce5;if(_0x5d80a1[_0x432706(0xfe)][_0x432706(0x11d)]!=settings[_0x432706(0x12b)]&&'@'+_0x5d80a1[_0x432706(0xfe)]['username']!=settings['telegramUsername']||_0x5d80a1['chat']['id']!=settings[_0x432706(0x234)])return sendTelegram(_0x5d80a1['chat']['id'],_0x432706(0x1ab),{'parse_mode':_0x432706(0x2bc)}),![];return!![];}async function initTelegram(){const _0x2f9f8c=_0x166ce5;tgBot&&(await tgBot[_0x2f9f8c(0x114)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x2f9f8c(0xc6)]);let _0x3eeb2c=_0x2f9f8c(0x109);_0x3eeb2c+='\x0a',_0x3eeb2c+=_0x2f9f8c(0x2ae),_0x3eeb2c+=_0x2f9f8c(0xb7),_0x3eeb2c+=_0x2f9f8c(0x233),_0x3eeb2c+=_0x2f9f8c(0x1bb),_0x3eeb2c+=_0x2f9f8c(0x243),_0x3eeb2c+=_0x2f9f8c(0x150),_0x3eeb2c+=_0x2f9f8c(0xc0),_0x3eeb2c+=_0x2f9f8c(0x1bd),_0x3eeb2c+=_0x2f9f8c(0x185),_0x3eeb2c+=_0x2f9f8c(0x2cb),_0x3eeb2c+=_0x2f9f8c(0xb5),_0x3eeb2c+=_0x2f9f8c(0x166),_0x3eeb2c+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0x3eeb2c+=_0x2f9f8c(0xec),_0x3eeb2c+=_0x2f9f8c(0x16c),_0x3eeb2c+=_0x2f9f8c(0x231);let _0x5a3311=_0x2f9f8c(0x16b);_0x5a3311+='\x0a',_0x5a3311+=_0x3eeb2c,tgBot['catch']((_0x4ee7f4,_0x45824a)=>{const _0xdc7d38=_0x2f9f8c;logger[_0xdc7d38(0xb3)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0xdc7d38(0x2a9)](_0xdc7d38(0x12e),_0x4ee7f4);}),tgBot['use'](async(_0x2a9a89,_0x112af2)=>{const _0x6a0308=_0x2f9f8c;if(settings['telegramChatId']||_0x2a9a89[_0x6a0308(0x11a)][_0x6a0308(0x268)][_0x6a0308(0x208)]!=_0x6a0308(0x2be)){if(!validateTelegram(_0x2a9a89))return;}_0x112af2();}),tgBot[_0x2f9f8c(0x152)](_0x2f9f8c(0x230),async _0x372dc2=>{const _0x488c74=_0x2f9f8c;if(_0x372dc2[_0x488c74(0xfe)][_0x488c74(0x11d)]==settings[_0x488c74(0x12b)]||'@'+_0x372dc2[_0x488c74(0xfe)][_0x488c74(0x11d)]==settings[_0x488c74(0x12b)]){if(!settings[_0x488c74(0x234)])updateSetting(_0x488c74(0x234),_0x372dc2[_0x488c74(0x21c)]['id']);else{if(!validateTelegram(_0x372dc2))return;}}else{if(!validateTelegram(_0x372dc2))return;}updateSetting(_0x488c74(0x278),!![]),await sendTelegram(_0x372dc2[_0x488c74(0x21c)]['id'],_0x5a3311);}),tgBot[_0x2f9f8c(0x152)](_0x2f9f8c(0x24f),async _0x430942=>{const _0x36c889=_0x2f9f8c;updateSetting(_0x36c889(0x278),!![]),await sendTelegram(_0x430942[_0x36c889(0x21c)]['id'],_0x36c889(0x141));}),tgBot[_0x2f9f8c(0x152)](_0x2f9f8c(0x11c),async _0x1575f5=>{const _0x41dd9b=_0x2f9f8c;await sendTelegram(_0x1575f5[_0x41dd9b(0x21c)]['id'],'Notifications\x20disabled'),updateSetting(_0x41dd9b(0x278),![]);}),tgBot[_0x2f9f8c(0x152)](_0x2f9f8c(0x190),async _0x2e1393=>{const _0x3a14a0=_0x2f9f8c,_0x4f18c1=Markup[_0x3a14a0(0x105)]([Markup[_0x3a14a0(0x1b5)][_0x3a14a0(0x257)](_0x3a14a0(0x1ff),'config_orders'),Markup[_0x3a14a0(0x1b5)][_0x3a14a0(0x257)](_0x3a14a0(0x14a),'config_alerts'),Markup['button']['callback'](_0x3a14a0(0x140),_0x3a14a0(0x1d4))]);_0x2e1393[_0x3a14a0(0x284)](_0x3a14a0(0x10e),_0x4f18c1);}),tgBot['action'](_0x2f9f8c(0x1a5),async _0x43b331=>{const _0xed89a0=_0x2f9f8c;_0x43b331['editMessageReplyMarkup'](),updateSetting(_0xed89a0(0x260),_0xed89a0(0x2b3)),updateSetting(_0xed89a0(0x278),!![]),await sendTelegram(_0x43b331[_0xed89a0(0x21c)]['id'],_0xed89a0(0x283));}),tgBot[_0x2f9f8c(0x279)]('config_alerts',async _0x4d59fb=>{const _0x308490=_0x2f9f8c;_0x4d59fb['editMessageReplyMarkup'](),updateSetting(_0x308490(0x260),'alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x4d59fb[_0x308490(0x21c)]['id'],_0x308490(0x21a));}),tgBot['action'](_0x2f9f8c(0x1d4),async _0x5ac6c9=>{const _0x5d5436=_0x2f9f8c;_0x5ac6c9['editMessageReplyMarkup'](),updateSetting(_0x5d5436(0x260),_0x5d5436(0x1f0)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x5ac6c9[_0x5d5436(0x21c)]['id'],_0x5d5436(0xe7));}),tgBot[_0x2f9f8c(0x152)](_0x2f9f8c(0x15d),async _0x18348a=>{const _0x2f8c7=_0x2f9f8c,_0x280006=getBotsWithMode();let _0x2f3f46=_0x2f8c7(0x177);config[_0x2f8c7(0x2ca)](_0x5f0d33=>{const _0x49a1ac=_0x2f8c7,_0x321e89=_0x280006[_0x49a1ac(0x158)](_0x67a6e9=>_0x67a6e9[_0x49a1ac(0xf7)]==_0x5f0d33[_0x49a1ac(0xf7)])[_0x49a1ac(0x2a4)];_0x2f3f46+=_0x49a1ac(0x1c1)+_0x5f0d33[_0x49a1ac(0xf7)]+':\x20'+_0x5f0d33[_0x49a1ac(0x15d)]+_0x49a1ac(0x245)+_0x321e89+_0x49a1ac(0x245)+_0x5f0d33['live']+'\x0a';}),_0x2f3f46+='\x0a',_0x2f3f46+=_0x2f8c7(0x143),_0x2f3f46+=!settings[_0x2f8c7(0x278)]?_0x2f8c7(0x203):_0x2f8c7(0x170),_0x2f3f46+=settings[_0x2f8c7(0x278)]?settings[_0x2f8c7(0x260)]==_0x2f8c7(0x1f0)?_0x2f8c7(0x13e):_0x2f8c7(0x236)+settings[_0x2f8c7(0x260)]+_0x2f8c7(0x264):'',await sendTelegram(_0x18348a['chat']['id'],_0x2f3f46,{'parse_mode':_0x2f8c7(0x2bc)});}),tgBot['command'](_0x2f9f8c(0x1de),async _0x199850=>{const _0x246b4b=_0x2f9f8c,_0x354a59=getEnabledBots();if(_0x354a59['length']==0x0)await sendTelegram(_0x199850[_0x246b4b(0x21c)]['id'],_0x246b4b(0x12c));else{if(_0x354a59['length']>0x1)_0x354a59[_0x246b4b(0xe1)]({'botID':_0x246b4b(0x1f0)});let _0x88b450=[],_0x588f5a=[];const _0x596e1f=_0x354a59[_0x246b4b(0x293)]%0x4==0x0||_0x354a59[_0x246b4b(0x293)]%0x4==0x3||_0x354a59[_0x246b4b(0x293)]%0x3==0x1?0x4:0x3;let _0x14316d=0x0;_0x354a59['forEach']((_0x750f54,_0x2b15da)=>{const _0x554ec3=_0x246b4b;if(_0x2b15da%_0x596e1f==0x0)_0x588f5a=[];_0x588f5a[_0x554ec3(0xe1)](Markup[_0x554ec3(0x1b5)][_0x554ec3(0x257)](_0x750f54[_0x554ec3(0xf7)]==_0x554ec3(0x1f0)?_0x554ec3(0x130):'Bot\x20'+_0x750f54[_0x554ec3(0xf7)],_0x554ec3(0x285)+_0x750f54[_0x554ec3(0xf7)])),_0x2b15da%_0x596e1f==0x0&&(_0x88b450[_0x14316d]=_0x588f5a,_0x14316d++);});const _0x1773bf=Markup[_0x246b4b(0x105)](_0x88b450);_0x199850[_0x246b4b(0x284)](_0x246b4b(0x16d),_0x1773bf);}}),tgBot[_0x2f9f8c(0x279)](/restart_(.+)/,async _0x1bb99d=>{const _0x1251d6=_0x2f9f8c,_0x578e0d=_0x1bb99d['match'][0x1];_0x1bb99d[_0x1251d6(0x27e)](),_0x578e0d==_0x1251d6(0x1f0)?config[_0x1251d6(0x2ca)](_0x2cd8af=>{const _0x26041b=_0x1251d6;restartBot(_0x2cd8af[_0x26041b(0xf7)]);}):restartBot(_0x578e0d);}),tgBot[_0x2f9f8c(0x152)]('on',async _0x44c84c=>{const _0x531036=_0x2f9f8c,_0x3e1cfe=getDisabledBots();if(_0x3e1cfe[_0x531036(0x293)]==0x0)await sendTelegram(_0x44c84c[_0x531036(0x21c)]['id'],_0x531036(0x244));else{if(_0x3e1cfe[_0x531036(0x293)]>0x1)_0x3e1cfe['push']({'botID':_0x531036(0x1f0)});let _0x324afc=[],_0x92dfe2=[];const _0x471ad3=_0x3e1cfe[_0x531036(0x293)]%0x4==0x0||_0x3e1cfe[_0x531036(0x293)]%0x4==0x3||_0x3e1cfe[_0x531036(0x293)]%0x3==0x1?0x4:0x3;let _0x396fb0=0x0;_0x3e1cfe[_0x531036(0x2ca)]((_0x1ebe27,_0xf609d9)=>{const _0x5e64bd=_0x531036;if(_0xf609d9%_0x471ad3==0x0)_0x92dfe2=[];_0x92dfe2[_0x5e64bd(0xe1)](Markup[_0x5e64bd(0x1b5)]['callback'](_0x1ebe27['botID']=='all'?_0x5e64bd(0x130):_0x5e64bd(0x1c1)+_0x1ebe27[_0x5e64bd(0xf7)],_0x5e64bd(0x1a4)+_0x1ebe27['botID'])),_0xf609d9%_0x471ad3==0x0&&(_0x324afc[_0x396fb0]=_0x92dfe2,_0x396fb0++);});const _0x282b23=Markup[_0x531036(0x105)](_0x324afc);_0x44c84c[_0x531036(0x284)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x282b23);}}),tgBot[_0x2f9f8c(0x279)](/on_(.+)/,async _0x433030=>{const _0x96172e=_0x2f9f8c,_0x479543=_0x433030[_0x96172e(0x1e1)][0x1];_0x433030[_0x96172e(0x27e)]();if(_0x479543=='all'){const _0x3db200=getDisabledBots();await sendTelegram(_0x433030['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x3db200[_0x96172e(0x2ca)](_0x38e36f=>{const _0x375471=_0x96172e;if(_0x38e36f['botID']!='all')toggleBot(_0x38e36f['botID'],toggleStatus(_0x38e36f[_0x375471(0xf7)]),_0x375471(0x282));});}else await sendTelegram(_0x433030[_0x96172e(0x21c)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x479543),toggleBot(_0x479543,toggleStatus(_0x479543),'stopped');}),tgBot[_0x2f9f8c(0x152)]('off',async _0x1df798=>{const _0x320457=_0x2f9f8c,_0xbf1c33=getEnabledBots();if(_0xbf1c33[_0x320457(0x293)]==0x0)await sendTelegram(_0x1df798['chat']['id'],_0x320457(0x12c));else{if(_0xbf1c33[_0x320457(0x293)]>0x1)_0xbf1c33[_0x320457(0xe1)]({'botID':'all'});let _0x527064=[],_0x25ef8d=[];const _0x2689a2=_0xbf1c33[_0x320457(0x293)]%0x4==0x0||_0xbf1c33[_0x320457(0x293)]%0x4==0x3||_0xbf1c33[_0x320457(0x293)]%0x3==0x1?0x4:0x3;let _0x3f0c72=0x0;_0xbf1c33[_0x320457(0x2ca)]((_0x161110,_0x2e2fac)=>{const _0x542ad0=_0x320457;if(_0x2e2fac%_0x2689a2==0x0)_0x25ef8d=[];_0x25ef8d[_0x542ad0(0xe1)](Markup[_0x542ad0(0x1b5)]['callback'](_0x161110['botID']==_0x542ad0(0x1f0)?_0x542ad0(0x130):_0x542ad0(0x1c1)+_0x161110[_0x542ad0(0xf7)],_0x542ad0(0x28a)+_0x161110[_0x542ad0(0xf7)])),_0x2e2fac%_0x2689a2==0x0&&(_0x527064[_0x3f0c72]=_0x25ef8d,_0x3f0c72++);});const _0xcea86e=Markup['inlineKeyboard'](_0x527064);_0x1df798[_0x320457(0x284)](_0x320457(0x219),_0xcea86e);}}),tgBot['action'](/off_(.+)/,async _0x34fee1=>{const _0x40a31d=_0x2f9f8c,_0x59d691=_0x34fee1['match'][0x1];_0x34fee1[_0x40a31d(0x27e)]();if(_0x59d691==_0x40a31d(0x1f0)){const _0x12276b=getEnabledBots();await sendTelegram(_0x34fee1['chat']['id'],_0x40a31d(0xc8)),_0x12276b[_0x40a31d(0x2ca)](_0x250936=>{const _0x2cfdd5=_0x40a31d;if(_0x250936['botID']!=_0x2cfdd5(0x1f0))toggleBot(_0x250936['botID'],toggleStatus(_0x250936[_0x2cfdd5(0xf7)]),'stopped');});}else await sendTelegram(_0x34fee1[_0x40a31d(0x21c)]['id'],_0x40a31d(0x173)+_0x59d691),toggleBot(_0x59d691,toggleStatus(_0x59d691),_0x40a31d(0x282));}),tgBot['command'](_0x2f9f8c(0x22b),async _0x48246a=>{const _0x39261b=_0x2f9f8c,_0x3c413b=getEnabledBots();if(_0x3c413b[_0x39261b(0x293)]==0x0)await sendTelegram(_0x48246a['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x3c413b['length']>0x1){let _0x215077=[],_0x1fc430=[];const _0x4562e0=_0x3c413b['length']%0x4==0x0||_0x3c413b['length']%0x4==0x3||_0x3c413b[_0x39261b(0x293)]%0x3==0x1?0x4:0x3;let _0x2dfbf4=0x0;_0x3c413b[_0x39261b(0x2ca)]((_0x11b6e7,_0x1cb03c)=>{const _0x295bf4=_0x39261b;if(_0x1cb03c%_0x4562e0==0x0)_0x1fc430=[];_0x1fc430[_0x295bf4(0xe1)](Markup[_0x295bf4(0x1b5)][_0x295bf4(0x257)](_0x295bf4(0x1c1)+_0x11b6e7[_0x295bf4(0xf7)],_0x295bf4(0x23e)+_0x11b6e7[_0x295bf4(0xf7)])),_0x1cb03c%_0x4562e0==0x0&&(_0x215077[_0x2dfbf4]=_0x1fc430,_0x2dfbf4++);});const _0x266295=Markup['inlineKeyboard'](_0x215077);_0x48246a[_0x39261b(0x284)](_0x39261b(0x247),_0x266295);}else{const _0x414c0c=_0x3c413b[0x0][_0x39261b(0xf7)];if(pid[_0x414c0c])pid[_0x414c0c][_0x39261b(0x205)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x2f9f8c(0x279)](/metrics_(.+)/,async _0x52e599=>{const _0x2eb12d=_0x2f9f8c,_0x3a34a8=_0x52e599[_0x2eb12d(0x1e1)][0x1];_0x52e599['editMessageReplyMarkup']();if(pid[_0x3a34a8])pid[_0x3a34a8]['send']({'function':_0x2eb12d(0x1ea),'args':null});}),tgBot['command'](_0x2f9f8c(0x207),async _0x5a9c63=>{const _0x3898b1=_0x2f9f8c,_0x3b3301=getEnabledBots();if(_0x3b3301['length']==0x0)await sendTelegram(_0x5a9c63[_0x3898b1(0x21c)]['id'],_0x3898b1(0x12c));else{if(_0x3b3301['length']>0x1){let _0x51fc1c=[],_0x5010d4=[];const _0xed569=_0x3b3301[_0x3898b1(0x293)]%0x4==0x0||_0x3b3301[_0x3898b1(0x293)]%0x4==0x3||_0x3b3301['length']%0x3==0x1?0x4:0x3;let _0x1428f7=0x0;_0x3b3301['forEach']((_0x333cd0,_0x1592e0)=>{const _0x589263=_0x3898b1;if(_0x1592e0%_0xed569==0x0)_0x5010d4=[];_0x5010d4[_0x589263(0xe1)](Markup[_0x589263(0x1b5)]['callback'](_0x589263(0x1c1)+_0x333cd0[_0x589263(0xf7)],'portfolio_'+_0x333cd0[_0x589263(0xf7)])),_0x1592e0%_0xed569==0x0&&(_0x51fc1c[_0x1428f7]=_0x5010d4,_0x1428f7++);});const _0x4ab6d0=Markup[_0x3898b1(0x105)](_0x51fc1c);_0x5a9c63[_0x3898b1(0x284)](_0x3898b1(0x19f),_0x4ab6d0);}else{const _0x5197b7=_0x3b3301[0x0][_0x3898b1(0xf7)];if(pid[_0x5197b7])pid[_0x5197b7]['send']({'function':_0x3898b1(0x1d8),'args':null});}}}),tgBot[_0x2f9f8c(0x279)](/portfolio_(.+)/,async _0x2dc839=>{const _0xb2b9ae=_0x2f9f8c,_0x5903b7=_0x2dc839[_0xb2b9ae(0x1e1)][0x1];_0x2dc839[_0xb2b9ae(0x27e)]();if(pid[_0x5903b7])pid[_0x5903b7][_0xb2b9ae(0x205)]({'function':_0xb2b9ae(0x1d8),'args':null});}),tgBot[_0x2f9f8c(0x152)](_0x2f9f8c(0x112),async _0x4f1189=>{const _0x371d4c=_0x2f9f8c,_0x304b98=_0x371d4c(0x112);await zipFiles(_0x304b98);const _0x543bed=zippath+(_0x304b98+_0x371d4c(0x228));_0x4f1189[_0x371d4c(0x17b)]({'source':_0x543bed})[_0x371d4c(0x17c)](()=>{})[_0x371d4c(0x16f)](_0x30d846=>logger[_0x371d4c(0x2a9)](_0x371d4c(0x1b7)+_0x304b98+'\x20files\x20over\x20Telegram:',_0x30d846));}),tgBot[_0x2f9f8c(0x152)]('backup',async _0xef6ac9=>{const _0x552590=_0x2f9f8c,_0x355981=_0x552590(0x298);await backupConfigFiles(),await zipFiles(_0x355981);const _0x5ad0e5=zippath+(_0x355981+_0x552590(0x228));_0xef6ac9[_0x552590(0x17b)]({'source':_0x5ad0e5})[_0x552590(0x17c)](()=>{})['catch'](_0x15cc30=>logger['debug'](_0x552590(0x1b7)+_0x355981+_0x552590(0xcb),_0x15cc30));}),tgBot[_0x2f9f8c(0x152)](_0x2f9f8c(0x11a),async _0x323168=>{const _0x5b75c5=_0x2f9f8c;await getMessages();if(!updateAvailable)await sendTelegram(_0x323168[_0x5b75c5(0x21c)]['id'],_0x5b75c5(0x13a));else{if(!validInstallation)await sendTelegram(_0x323168[_0x5b75c5(0x21c)]['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x4c24ce=Markup[_0x5b75c5(0x105)]([Markup['button'][_0x5b75c5(0x257)](_0x5b75c5(0x189),_0x5b75c5(0x1a7)),Markup['button']['callback']('No',_0x5b75c5(0x274))]);_0x323168[_0x5b75c5(0x284)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x4c24ce);}}}),tgBot['action'](/update_(.+)/,async _0x22e153=>{const _0x1c60b2=_0x2f9f8c,_0x51851c=_0x22e153['match'][0x1];_0x22e153[_0x1c60b2(0x27e)](),_0x51851c==_0x1c60b2(0x1e6)&&(await sendTelegram(_0x22e153[_0x1c60b2(0x21c)]['id'],_0x1c60b2(0x201)),updateBB(_0x1c60b2(0x11a))),_0x51851c=='no'&&await sendTelegram(_0x22e153[_0x1c60b2(0x21c)]['id'],_0x1c60b2(0x14d));}),tgBot[_0x2f9f8c(0x152)](_0x2f9f8c(0x1f4),async _0xbb28e9=>{const _0x442b08=_0x2f9f8c;if(!validInstallation)await sendTelegram(_0xbb28e9['chat']['id'],_0x442b08(0x157));else{const _0x16a5da=Markup['inlineKeyboard']([Markup[_0x442b08(0x1b5)]['callback'](_0x442b08(0x189),'reinstall_yes'),Markup[_0x442b08(0x1b5)][_0x442b08(0x257)]('No',_0x442b08(0xe8))]);_0xbb28e9[_0x442b08(0x284)](_0x442b08(0xf4),_0x16a5da);}}),tgBot['action'](/reinstall_(.+)/,async _0x5cc476=>{const _0x187930=_0x2f9f8c,_0x225a71=_0x5cc476['match'][0x1];_0x5cc476[_0x187930(0x27e)](),_0x225a71=='yes'&&(await sendTelegram(_0x5cc476[_0x187930(0x21c)]['id'],_0x187930(0x15c)),updateBB('reinstall')),_0x225a71=='no'&&await sendTelegram(_0x5cc476[_0x187930(0x21c)]['id'],_0x187930(0xff));}),tgBot[_0x2f9f8c(0x152)](_0x2f9f8c(0x132),async _0x44e3c1=>{const _0x62be08=_0x2f9f8c,_0x4f4899=getBotsWithMode();if(_0x4f4899[_0x62be08(0x293)]==0x0)await sendTelegram(_0x44e3c1[_0x62be08(0x21c)]['id'],_0x62be08(0x12c));else{let _0xeb992b=[],_0x4a5943=[];const _0xa0f81c=0x2;let _0x150889=0x0;_0x4f4899[_0x62be08(0x2ca)]((_0x2f538a,_0x31d66d)=>{const _0x4e2f22=_0x62be08;if(_0x31d66d%_0xa0f81c==0x0)_0x4a5943=[];_0x4a5943[_0x4e2f22(0xe1)](Markup[_0x4e2f22(0x1b5)]['callback'](_0x4e2f22(0x1c1)+_0x2f538a[_0x4e2f22(0xf7)]+'\x20('+_0x2f538a[_0x4e2f22(0x2a4)]+')',_0x4e2f22(0x295)+_0x2f538a['botID'])),_0x31d66d%_0xa0f81c==0x0&&(_0xeb992b[_0x150889]=_0x4a5943,_0x150889++);});const _0x3a90bb=Markup[_0x62be08(0x105)](_0xeb992b);_0x44e3c1[_0x62be08(0x284)](_0x62be08(0x232),_0x3a90bb);}}),tgBot['action'](/toggle_(.+)/,async _0x13cd56=>{const _0xf0fab7=_0x2f9f8c,_0x55e9a8=_0x13cd56[_0xf0fab7(0x1e1)][0x1];_0x13cd56['editMessageReplyMarkup']();const _0x5a1bf8=getBotsWithMode(),_0x197f29=_0x5a1bf8[_0xf0fab7(0x158)](_0x3de494=>_0x3de494[_0xf0fab7(0xf7)]==_0x55e9a8),_0x14ab88=_0x197f29[_0xf0fab7(0x2a4)]==_0xf0fab7(0x26b)?'manual':'auto';await sendTelegram(_0x13cd56[_0xf0fab7(0x21c)]['id'],_0xf0fab7(0x20d)+_0x55e9a8+'\x20to\x20'+_0x14ab88+_0xf0fab7(0x172)),toggleBotMode(_0x55e9a8);}),tgBot['command'](_0x2f9f8c(0x25d),async _0x4c5a12=>{const _0x303c02=_0x2f9f8c;let _0x51e2c5='';config[_0x303c02(0x2ca)](_0x5bd34a=>{const _0x3f4aaf=_0x303c02;_0x51e2c5+=_0x3f4aaf(0x1c1)+_0x5bd34a[_0x3f4aaf(0xf7)]+':\x20'+_0x5bd34a[_0x3f4aaf(0x225)]+'\x0a';}),await sendTelegram(_0x4c5a12[_0x303c02(0x21c)]['id'],_0x51e2c5,{'parse_mode':_0x303c02(0x2bc)});}),tgBot[_0x2f9f8c(0x152)](_0x2f9f8c(0x226),async _0x3ac397=>{const _0x5988ef=_0x2f9f8c;await sendTelegram(_0x3ac397[_0x5988ef(0x21c)]['id'],_0x3eeb2c);}),process[_0x2f9f8c(0x2c6)](_0x2f9f8c(0x1f9),()=>tgBot[_0x2f9f8c(0x114)]('SIGINT')),process['once'](_0x2f9f8c(0x2c7),()=>tgBot['stop'](_0x2f9f8c(0x2c7))),tgBot[_0x2f9f8c(0x117)]();}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x20c3bc,_0x11ccb0,_0x313c83){const _0x6ce30b=_0x166ce5;_0x313c83={..._0x313c83,'disable_web_page_preview':!![]};try{await tgBot[_0x6ce30b(0x229)][_0x6ce30b(0x115)](_0x20c3bc,_0x11ccb0,_0x313c83);}catch(_0x5f15ef){logger['debug'](_0x6ce30b(0x21f),_0x5f15ef);}}async function sendTelegramBot(_0x52fe1b,_0x389825){const _0x5b297c=_0x166ce5;if(settings['telegramEnabled']){if(settings[_0x5b297c(0x260)]==_0x5b297c(0x1f0)||(_0x389825[_0x5b297c(0x1eb)]==_0x5b297c(0x16a)||_0x389825[_0x5b297c(0x1eb)]==_0x5b297c(0x2bd)||_0x389825['type']==_0x5b297c(0x191))&&settings[_0x5b297c(0x260)]==_0x5b297c(0x193)||_0x389825[_0x5b297c(0x1eb)]==_0x5b297c(0x20e)&&settings[_0x5b297c(0x260)]==_0x5b297c(0x2b3)){if(tgBot&&settings[_0x5b297c(0x234)]){if(_0x389825[_0x5b297c(0x1d1)])await sendTelegram(settings[_0x5b297c(0x234)],_0x389825[_0x5b297c(0x225)]+_0x5b297c(0x2a6)+_0x389825[_0x5b297c(0xcd)]);else await sendTelegram(settings[_0x5b297c(0x234)],_0x5b297c(0x1c1)+_0x52fe1b+_0x5b297c(0x2a6)+_0x389825['event']);}}}}async function sendTelegramMsg(_0x35fdcf,_0x495a32=_0x166ce5(0x2bc)){const _0x40fcca=_0x166ce5;return settings[_0x40fcca(0x278)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x40fcca(0x234)],_0x35fdcf,{'parse_mode':_0x495a32}),!![]):![];}function getDeviceWithIp(_0x371802){const _0x51db94=_0x166ce5;return devices[_0x51db94(0x158)](_0xc080a6=>_0xc080a6['ip']===_0x371802);}async function temporaryAccess2FA(_0x54e533,_0x1a94a5){const _0x129cc0=_0x166ce5;let _0x1092ad=new Date(),_0x2dcd92=![];if(lastIpApproval){if(_0x1092ad-lastIpApproval<0x1388)_0x2dcd92=!![];}lastIpApproval=new Date();if(_0x2dcd92)return;if(tgBot&&settings[_0x129cc0(0x234)]){const _0x124240=uuidRandom();tmpStorage[_0x124240]={'uuid':_0x54e533,'externalip':_0x1a94a5};const _0x59ca37=Markup['inlineKeyboard']([Markup[_0x129cc0(0x1b5)][_0x129cc0(0x257)](_0x129cc0(0xdb),_0x129cc0(0x144)+_0x124240),Markup[_0x129cc0(0x1b5)][_0x129cc0(0x257)](_0x129cc0(0x1fe),_0x129cc0(0xbd)+_0x124240),Markup['button']['callback'](_0x129cc0(0x23d),_0x129cc0(0x176)+_0x124240),Markup[_0x129cc0(0x1b5)]['callback'](_0x129cc0(0xea),_0x129cc0(0x291)+_0x124240)]);await sendTelegram(settings[_0x129cc0(0x234)],_0x129cc0(0x1aa)+normalizeIP(_0x1a94a5)[_0x129cc0(0x1b9)]+'\x20?',_0x59ca37),tgBot[_0x129cc0(0x279)](/tempaccess_(.+)_(.+)/,async _0x3c2d0f=>{const _0x39b1c3=_0x129cc0,_0x2b236c=_0x3c2d0f['match'][0x1],_0x2d5ed0=_0x3c2d0f['match'][0x2],{uuid:_0x453405,externalip:_0x509d9f}=tmpStorage[_0x2d5ed0];delete tmpStorage[_0x2d5ed0],_0x3c2d0f[_0x39b1c3(0x27e)](),devices[_0x453405][_0x39b1c3(0x127)]={'clientip':_0x509d9f,'timestamp':new Date()[_0x39b1c3(0x212)](),'expiry':_0x2b236c},_0x2b236c!='reject'?(await sendTelegram(_0x3c2d0f[_0x39b1c3(0x21c)]['id'],_0x39b1c3(0x1a9)+_0x2b236c+_0x39b1c3(0x255),{'parse_mode':_0x39b1c3(0x2bc)}),io['to'](_0x453405)[_0x39b1c3(0xfc)](_0x39b1c3(0x15d),{'access':{'allow':![],'reason':_0x39b1c3(0x2a8),'token':null}})):(await sendTelegram(_0x3c2d0f[_0x39b1c3(0x21c)]['id'],_0x39b1c3(0x11f)),io['to'](_0x453405)[_0x39b1c3(0xfc)](_0x39b1c3(0x15d),{'access':{'allow':![],'reason':_0x39b1c3(0x237),'token':null}}));});}}async function loginAccess2FA(_0x2dc958,_0x1d6911){const _0x32da1e=_0x166ce5;if(tgBot&&settings[_0x32da1e(0x234)]){const _0x1f1006=uuidRandom();tmpStorage[_0x1f1006]={'uuid':_0x2dc958,'externalip':_0x1d6911};const _0x39e930=Markup[_0x32da1e(0x105)]([Markup[_0x32da1e(0x1b5)][_0x32da1e(0x257)](_0x32da1e(0x254),_0x32da1e(0x161)+loginExpiry+'_'+_0x1f1006),Markup['button'][_0x32da1e(0x257)](_0x32da1e(0xea),_0x32da1e(0x2af)+_0x1f1006)]);await sendTelegram(settings['telegramChatId'],_0x32da1e(0x147)+normalizeIP(_0x1d6911)[_0x32da1e(0x1b9)]+'\x20?',_0x39e930),tgBot[_0x32da1e(0x279)](/login2fa_(.+)_(.+)/,async _0x2985b9=>{const _0x19d088=_0x32da1e,_0x4dc18f=_0x2985b9[_0x19d088(0x1e1)][0x1],_0x11e612=_0x2985b9[_0x19d088(0x1e1)][0x2],{uuid:_0x70267b,externalip:_0x964e15}=tmpStorage[_0x11e612];delete tmpStorage[_0x11e612],_0x2985b9['editMessageReplyMarkup'](),devices[_0x70267b][_0x19d088(0x25c)]={'clientip':_0x964e15,'timestamp':new Date()[_0x19d088(0x212)](),'expiry':_0x4dc18f},_0x4dc18f!=_0x19d088(0xea)?(await sendTelegram(_0x2985b9[_0x19d088(0x21c)]['id'],_0x19d088(0x1b3),{'parse_mode':_0x19d088(0x2bc)}),io['to'](_0x70267b)[_0x19d088(0xfc)](_0x19d088(0x15d),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x2985b9[_0x19d088(0x21c)]['id'],_0x19d088(0x101)),io['to'](_0x70267b)['emit'](_0x19d088(0x15d),{'access':{'allow':![],'reason':_0x19d088(0xcf),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2d30db=_0x166ce5;return dbConfig[_0x2d30db(0x1b0)]('bots')[_0x2d30db(0xb9)]('botID')[_0x2d30db(0x10c)]({'status':_0x2d30db(0x288)})[_0x2d30db(0x168)]()||[];}function getDisabledBots(){const _0x5419dd=_0x166ce5;return dbConfig[_0x5419dd(0x1b0)](_0x5419dd(0x181))['sortBy'](_0x5419dd(0xf7))[_0x5419dd(0x10c)]({'status':_0x5419dd(0xfb)})[_0x5419dd(0x168)]()||[];}function getBotAttributes(_0x598eb4){const _0x2f84a3=_0x166ce5;let _0x2b41bb={};const _0x1f5e5f=configpath+_0x2f84a3(0x271)+_0x598eb4+'-config.json',_0x4283bd=fs[_0x2f84a3(0x253)](_0x1f5e5f);if(_0x4283bd){const _0x17cbd4=fs[_0x2f84a3(0x128)](_0x1f5e5f);try{const _0x49b3db=JSON[_0x2f84a3(0x248)](_0x17cbd4),_0x2bc5ec=_0x49b3db?_0x49b3db[_0x2f84a3(0x1e0)][0x0][_0x2f84a3(0x28e)]:![];_0x2b41bb[_0x2f84a3(0x2a4)]=_0x2bc5ec?_0x2f84a3(0x26b):_0x2f84a3(0x250),_0x2b41bb[_0x2f84a3(0x225)]=_0x49b3db?_0x49b3db['bot'][0x0][_0x2f84a3(0x225)]:_0x2f84a3(0x1c1)+_0x598eb4;}catch(_0x1010ce){_0x2b41bb['mode']=_0x2f84a3(0x250),_0x2b41bb['botname']=_0x2f84a3(0x1c1)+_0x598eb4;}}else _0x2b41bb[_0x2f84a3(0x2a4)]=_0x2f84a3(0x250),_0x2b41bb['botname']='Bot\x20'+_0x598eb4;return _0x2b41bb;}function getBotsWithMode(){const _0x2b4578=_0x166ce5,_0x511de8=dbConfig[_0x2b4578(0x1b0)](_0x2b4578(0x181))[_0x2b4578(0xb9)](_0x2b4578(0xf7))['value']()||[];return _0x511de8['forEach'](_0x289b9b=>{const _0x321994=_0x2b4578;let _0x45264a=getBotAttributes(_0x289b9b[_0x321994(0xf7)]);_0x289b9b[_0x321994(0x2a4)]=_0x45264a[_0x321994(0x2a4)];}),_0x511de8;}function getBotExchanges(){const _0x3f83bf=_0x166ce5;let _0x5e0891=[];const _0x30990b=dbConfig[_0x3f83bf(0x1b0)](_0x3f83bf(0x181))[_0x3f83bf(0xb9)](_0x3f83bf(0xf7))[_0x3f83bf(0x168)]()||[];_0x30990b[_0x3f83bf(0x2ca)](_0x233feb=>{const _0x27b18b=_0x3f83bf;if(_0x233feb[_0x27b18b(0x15d)]==_0x27b18b(0x288)){const _0x244ef0=configpath+'bot-'+_0x233feb['botID']+'-config.json',_0x27ef0d=fs[_0x27b18b(0x253)](_0x244ef0);let _0x244502;if(_0x27ef0d){const _0x15599b=fs[_0x27b18b(0x128)](_0x244ef0);try{const _0x4a1fef=JSON['parse'](_0x15599b);_0x244502=_0x4a1fef?_0x4a1fef[_0x27b18b(0x1e0)][0x0][_0x27b18b(0x153)]:null;}catch(_0x1d53ec){}}if(_0x244502)_0x5e0891[_0x27b18b(0xe1)](_0x244502);}});const _0x1c26fd=[...new Set(_0x5e0891)][_0x3f83bf(0x22f)]();return _0x1c26fd;}async function initUser(){const _0x17d26c=_0x166ce5;if(!settings[_0x17d26c(0x24d)]){const _0x296964=uuidRandom();mixpanel[_0x17d26c(0xcc)](_0x296964),updateSetting(_0x17d26c(0x24d),_0x296964);}}async function initSecure(){const _0x407e20=_0x166ce5;let _0x5040c1=getSecure();if(!_0x5040c1['hasOwnProperty']('secret')){let _0x762f3b=await generateKeys();_0x5040c1[_0x407e20(0x1e3)]=_0x762f3b['publicKey'],_0x5040c1['privateKey']=_0x762f3b[_0x407e20(0x23a)],_0x5040c1[_0x407e20(0x263)]=crypto[_0x407e20(0x1c8)](0x20)[_0x407e20(0x1d2)](_0x407e20(0x187));;storeSecure(_0x5040c1);}}function getSettings(){const _0x5ee626=_0x166ce5;return dbSettings[_0x5ee626(0x1b0)](_0x5ee626(0x1d6))[_0x5ee626(0x168)]()||{};}function getSecure(){const _0x2c9e4b=_0x166ce5;return dbSecure[_0x2c9e4b(0x1b0)](_0x2c9e4b(0x240))[_0x2c9e4b(0x168)]()||{};}function getBlacklist(){const _0xc67e96=_0x166ce5;return dbSecure[_0xc67e96(0x1b0)](_0xc67e96(0x28b))[_0xc67e96(0x168)]()||[];}function broadcastToBots(_0x9dbca8,_0x197762){config['forEach'](_0x33ea14=>{const _0x52266f=_0x36d5;if(_0x33ea14['status']=='enabled'&&_0x33ea14[_0x52266f(0x118)]==_0x52266f(0x2c0)||_0x33ea14[_0x52266f(0x15d)]=='new'&&_0x33ea14[_0x52266f(0x118)]==_0x52266f(0x2c0)){if(pid[_0x33ea14[_0x52266f(0xf7)]])pid[_0x33ea14[_0x52266f(0xf7)]][_0x52266f(0x205)]({[_0x9dbca8]:_0x197762});}});}async function storeSettings(_0xe3d0e1,_0x281848=![]){const _0x2f8d33=_0x166ce5;_0xe3d0e1={...settings,..._0xe3d0e1};if(_0x281848&&_0xe3d0e1[_0x2f8d33(0x1f7)]!=_0x2f8d33(0xfd)&&_0xe3d0e1['bbPassword']!=_0x2f8d33(0x1c7)&&_0xe3d0e1[_0x2f8d33(0x1f7)]!=''){const _0xfca65c=decryptRSA(secure[_0x2f8d33(0x23a)],_0xe3d0e1[_0x2f8d33(0x1f7)])[_0x2f8d33(0x281)](_0x2f8d33(0x1cd))[0x0],_0x1165d7=bcrypt[_0x2f8d33(0x119)](_0xfca65c,saltRounds);_0xe3d0e1={..._0xe3d0e1,'bbPassword':_0x1165d7};}if(_0x281848&&_0xe3d0e1[_0x2f8d33(0xc6)]!=_0x2f8d33(0xfd)&&_0xe3d0e1[_0x2f8d33(0xc6)]!=_0x2f8d33(0x1c7)&&_0xe3d0e1[_0x2f8d33(0xc6)]!=''){const _0x5c56c1=decryptRSA(secure[_0x2f8d33(0x23a)],_0xe3d0e1[_0x2f8d33(0xc6)])[_0x2f8d33(0x281)]('|@|')[0x0];_0xe3d0e1={..._0xe3d0e1,'telegramToken':_0x5c56c1};}if(_0x281848&&_0xe3d0e1['marketcapApi']!=_0x2f8d33(0xfd)&&_0xe3d0e1[_0x2f8d33(0x15a)]!=_0x2f8d33(0x1c7)&&_0xe3d0e1[_0x2f8d33(0x15a)]!=''){const _0x2e5535=decryptRSA(secure[_0x2f8d33(0x23a)],_0xe3d0e1[_0x2f8d33(0x15a)])[_0x2f8d33(0x281)](_0x2f8d33(0x1cd))[0x0];_0xe3d0e1={..._0xe3d0e1,'marketcapApi':_0x2e5535};}const _0x23b71a=_0xe3d0e1[_0x2f8d33(0xc6)]!=_0x2f8d33(0xfd)&&_0xe3d0e1['telegramToken']!=settings[_0x2f8d33(0xc6)]||_0xe3d0e1[_0x2f8d33(0x12b)]!=settings['telegramUsername'],_0x36a0a8=_0xe3d0e1[_0x2f8d33(0xc6)]==''||_0xe3d0e1[_0x2f8d33(0x12b)]=='',_0x50a669=_0xe3d0e1[_0x2f8d33(0x15a)]&&_0xe3d0e1[_0x2f8d33(0x15a)]!=_0x2f8d33(0xfd)&&_0xe3d0e1[_0x2f8d33(0x15a)]!=settings[_0x2f8d33(0x15a)];_0x23b71a&&(_0xe3d0e1[_0x2f8d33(0x234)]=null,_0xe3d0e1[_0x2f8d33(0x260)]=_0x2f8d33(0x1f0));for(const [_0x207dcd,_0x107332]of Object[_0x2f8d33(0x171)](_0xe3d0e1)){if(_0x207dcd==_0x2f8d33(0xc6)&&_0x107332=='************'){_0xe3d0e1[_0x2f8d33(0xc6)]=settings['telegramToken'];continue;};if(_0x207dcd=='bbPassword'&&_0x107332=='************'){_0xe3d0e1['bbPassword']=settings[_0x2f8d33(0x1f7)];continue;};if(_0x207dcd==_0x2f8d33(0x15a)&&_0x107332==_0x2f8d33(0xfd)){_0xe3d0e1[_0x2f8d33(0x15a)]=settings[_0x2f8d33(0x15a)];continue;};dbSettings[_0x2f8d33(0x23f)](_0x2f8d33(0x156)+_0x207dcd,_0x107332)[_0x2f8d33(0x125)]();}settings=_0xe3d0e1,io['to'](_0x2f8d33(0x26a))[_0x2f8d33(0xfc)](_0x2f8d33(0x1d6),cleanSettings()),broadcastToBots(_0x2f8d33(0x23c),settings[_0x2f8d33(0x23c)]),broadcastToBots(_0x2f8d33(0xe3),settings[_0x2f8d33(0xe3)]),broadcastToBots('marketcapApi',settings[_0x2f8d33(0x15a)]);if(_0x23b71a&&!_0x36a0a8)initTelegram();_0x23b71a&&_0x36a0a8&&(updateSetting(_0x2f8d33(0x234),null),disableTelegram()),getAllClients()[_0x2f8d33(0x2ca)](_0x326a2f=>{const _0x197cef=_0x2f8d33;getSocket(_0x326a2f['id'])[_0x197cef(0xfc)](_0x197cef(0x15d),{'access':{'allow':![],'reason':_0x197cef(0x2a8),'token':null}});}),_0x50a669&&(await sleep(0xbb8),testMarketcapApi(_0xe3d0e1[_0x2f8d33(0x15a)]));}async function testMarketcapApi(_0x9278c6){const _0x309907=_0x166ce5,_0x33b9cb=[_0x309907(0x27c),_0x309907(0xb1)];try{await axios[_0x309907(0x1b0)](_0x309907(0x19d),{'headers':{'X-CMC_PRO_API_KEY':_0x9278c6},'params':{'symbol':_0x33b9cb[_0x309907(0x1d2)]()}});}catch(_0x1e6129){_0x1e6129[_0x309907(0x1d2)]()['includes'](_0x309907(0x2c8))?(io['to'](_0x309907(0x26a))[_0x309907(0xfc)](_0x309907(0x1d9),_0x309907(0x1b6)),logger['full'](_0x309907(0x1b6))):(io['to']('botmanager')[_0x309907(0xfc)](_0x309907(0x1d9),_0x309907(0x146)),logger[_0x309907(0x2c5)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x309907(0x2a9)](_0x309907(0x249),_0x1e6129[_0x309907(0x1d2)]()+_0x309907(0x1df)+_0x1e6129[_0x309907(0xd3)]));return;}logger['debug'](_0x309907(0x1f2));}function updateSetting(_0x4c4108,_0x23059e){const _0x17a471=_0x166ce5;dbSettings['set'](_0x17a471(0x156)+_0x4c4108,_0x23059e)[_0x17a471(0x125)](),settings=getSettings(),io['to'](_0x17a471(0x26a))[_0x17a471(0xfc)]('settings',cleanSettings());}function storeSecure(_0x4afdd6){const _0x24715a=_0x166ce5;dbSecure[_0x24715a(0x1b0)]('secure')[_0x24715a(0xe1)](_0x4afdd6)[_0x24715a(0x125)](),secure=_0x4afdd6;}function addBlacklist(_0x4ab3fc){const _0x533869=_0x166ce5;cleanBlacklist();let _0x45b302;devices[_0x4ab3fc][_0x533869(0x127)]?_0x45b302=Math[_0x533869(0x1bf)](devices[_0x4ab3fc]['telegramIpApproval'][_0x533869(0x2a3)],loginExpiry):_0x45b302=loginExpiry,dbSecure['get']('blacklist')['push']({'expiry':new Date()[_0x533869(0x212)]()+_0x45b302*0x3c*0x3e8,'token':devices[_0x4ab3fc]['access'][_0x533869(0x2b2)]})[_0x533869(0x125)](),blacklist=dbSecure[_0x533869(0x1b0)](_0x533869(0x28b))[_0x533869(0x168)]();}function cleanBlacklist(){const _0x555706=_0x166ce5;let _0x2a8b02=dbSecure[_0x555706(0x1b0)]('blacklist')[_0x555706(0x210)]()['value'](),_0x3fc7ab=new Date()[_0x555706(0x212)]();_0x2a8b02[_0x555706(0x2ca)](_0x43aa74=>{const _0x5555cc=_0x555706;_0x43aa74[_0x5555cc(0x2a3)]<_0x3fc7ab&&dbSecure[_0x5555cc(0x1b0)](_0x5555cc(0x28b))[_0x5555cc(0x299)]({'expiry':_0x43aa74[_0x5555cc(0x2a3)]})[_0x5555cc(0x125)]();});}function initStates(){const _0x19d831=_0x166ce5;let _0x1681f9=getConfiguration();_0x1681f9[_0x19d831(0x2ca)](_0x5ba2ec=>{_0x5ba2ec['live']='stopped';}),storeConfiguration(_0x1681f9);}async function generateKeys(){const _0x258aee=_0x166ce5,_0xc13383=forge[_0x258aee(0x1ae)][_0x258aee(0x113)]['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x5270e4=forge['pki'][_0x258aee(0xbb)](_0xc13383[_0x258aee(0x23a)]),_0x3bc514=forge['pki'][_0x258aee(0x290)](_0xc13383[_0x258aee(0x1e3)]);return{'privateKey':_0x5270e4,'publicKey':_0x3bc514};}async function oneTimeMigration(){const _0x4ae8dd=_0x166ce5;let _0x24a025=getSettings(),_0x1d1fe0=![];!_0x24a025[_0x4ae8dd(0x227)](_0x4ae8dd(0x1b1))&&(_0x24a025[_0x4ae8dd(0x1b1)]=0x0,_0x1d1fe0=!![]);!_0x24a025[_0x4ae8dd(0x227)](_0x4ae8dd(0x1e8))&&(_0x24a025['lastmsgemitted']=0x0,_0x1d1fe0=!![]);!_0x24a025[_0x4ae8dd(0x227)]('latestversion')&&(_0x24a025[_0x4ae8dd(0x1fa)]='0.0.0',_0x1d1fe0=!![]);!_0x24a025[_0x4ae8dd(0x227)](_0x4ae8dd(0xe3))&&(_0x24a025['onepagemode']=![],_0x1d1fe0=!![]);!_0x24a025[_0x4ae8dd(0x227)](_0x4ae8dd(0x15a))&&(_0x24a025['marketcapApi']='',_0x1d1fe0=!![]);if(_0x1d1fe0)storeSettings(_0x24a025);try{fs[_0x4ae8dd(0x13b)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0xeac842=>{const _0x2b265b=_0x4ae8dd;if(!_0xeac842['isDirectory']()){if(!_0xeac842[_0x2b265b(0x14f)]['startsWith']('backup-full@'))fs[_0x2b265b(0x145)](configbackuppath+_0xeac842[_0x2b265b(0x14f)]);}else fs[_0x2b265b(0xf6)](configbackuppath+_0xeac842['name'],{'recursive':!![]});});}catch(_0x453947){logger['debug'](_0x4ae8dd(0x2d3),_0x453947);}}function storeConfiguration(_0xc00e7e){const _0xa6581b=_0x166ce5;dbConfig[_0xa6581b(0x1b0)](_0xa6581b(0x181))[_0xa6581b(0x299)]()[_0xa6581b(0x125)](),dbConfig[_0xa6581b(0x1b0)](_0xa6581b(0x181))['push'](..._0xc00e7e)['write'](),config=_0xc00e7e;}async function resetPassword(){const _0x257df7=_0x166ce5;if(tgBot&&settings[_0x257df7(0x234)]){const _0x142a40=Markup['inlineKeyboard']([Markup['button'][_0x257df7(0x257)]('yes','resetpw_yes'),Markup[_0x257df7(0x1b5)][_0x257df7(0x257)]('no',_0x257df7(0xd4))]);await sendTelegram(settings[_0x257df7(0x234)],_0x257df7(0x2c2),_0x142a40),tgBot['action'](/resetpw_(.+)/,async _0x18474e=>{const _0x394f3f=_0x257df7,_0x3c559e=_0x18474e['match'][0x1];_0x18474e[_0x394f3f(0x27e)]();if(_0x3c559e!='no'){const _0x16d46e=0xf,_0x441490='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x1de649=Array[_0x394f3f(0xfe)](crypto[_0x394f3f(0x194)](new Uint32Array(_0x16d46e)))['map'](_0x37e7f3=>_0x441490[_0x37e7f3%_0x441490['length']])[_0x394f3f(0x29c)](''),_0x34d0a1=bcrypt[_0x394f3f(0x119)](_0x1de649,saltRounds);storeSettings({'bbPassword':_0x34d0a1}),await sendTelegram(_0x18474e[_0x394f3f(0x21c)]['id'],_0x394f3f(0xc7)+_0x1de649,{'parse_mode':_0x394f3f(0x2bc)});}else await sendTelegram(_0x18474e[_0x394f3f(0x21c)]['id'],_0x394f3f(0xda));});}}async function confirmRestore(_0x97c161,_0x4aa128){const _0x4ba8f8=_0x166ce5;io['to'](_0x4ba8f8(0x26a))[_0x4ba8f8(0xfc)](_0x4ba8f8(0x1d9),_0x4ba8f8(0xdf),'success');if(tgBot&&settings['telegramChatId']){const _0x3fab4f=uuidRandom();tmpStorage[_0x3fab4f]={'path':_0x97c161,'filename':_0x4aa128};const _0x10fa3f=Markup[_0x4ba8f8(0x105)]([Markup['button'][_0x4ba8f8(0x257)](_0x4ba8f8(0x1e6),_0x4ba8f8(0x155)+_0x3fab4f),Markup[_0x4ba8f8(0x1b5)][_0x4ba8f8(0x257)]('no','restore_no_'+_0x3fab4f)]);await sendTelegram(settings[_0x4ba8f8(0x234)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x10fa3f),tgBot['action'](/restore_(.+)_(.+)/,async _0x1a6db3=>{const _0x590e3b=_0x4ba8f8,_0x246424=_0x1a6db3[_0x590e3b(0x1e1)][0x1],_0x149e76=_0x1a6db3['match'][0x2],{path:_0x268f9b,filename:_0x319941}=tmpStorage[_0x149e76];delete tmpStorage[_0x149e76],_0x1a6db3[_0x590e3b(0x27e)](),_0x246424==_0x590e3b(0x1e6)?(logger[_0x590e3b(0x2a9)](_0x590e3b(0x1a3)),await sendTelegram(_0x1a6db3[_0x590e3b(0x21c)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':'HTML'}),unzipFile(_0x268f9b,_0x319941)):(logger[_0x590e3b(0x2a9)](_0x590e3b(0x220)),await sendTelegram(_0x1a6db3[_0x590e3b(0x21c)]['id'],_0x590e3b(0x220)));});}}function getServerTime(){const _0x2d5865=_0x166ce5,_0x473793=new Date();return _0x473793['getFullYear']()+'/'+(_0x473793[_0x2d5865(0x15e)]()+0x1)[_0x2d5865(0x1d2)]()[_0x2d5865(0x108)](0x2,'0')+'/'+_0x473793['getDate']()[_0x2d5865(0x1d2)]()['padStart'](0x2,'0')+'\x20'+_0x473793[_0x2d5865(0x26d)]()['toString']()[_0x2d5865(0x108)](0x2,'0')+':'+_0x473793[_0x2d5865(0x137)]()[_0x2d5865(0x1d2)]()[_0x2d5865(0x108)](0x2,'0')+':'+_0x473793[_0x2d5865(0x1f3)]()[_0x2d5865(0x1d2)]()[_0x2d5865(0x108)](0x2,'0');}function getTimeStamp(){const _0x19e5f4=_0x166ce5,_0x592f3f=shiftedTime();return _0x592f3f[_0x19e5f4(0x1b2)]()+'/'+(_0x592f3f[_0x19e5f4(0x15e)]()+0x1)[_0x19e5f4(0x1d2)]()[_0x19e5f4(0x108)](0x2,'0')+'/'+_0x592f3f[_0x19e5f4(0xdd)]()['toString']()[_0x19e5f4(0x108)](0x2,'0')+'\x20'+_0x592f3f[_0x19e5f4(0x26d)]()['toString']()[_0x19e5f4(0x108)](0x2,'0')+':'+_0x592f3f[_0x19e5f4(0x137)]()[_0x19e5f4(0x1d2)]()[_0x19e5f4(0x108)](0x2,'0')+':'+_0x592f3f[_0x19e5f4(0x1f3)]()[_0x19e5f4(0x1d2)]()[_0x19e5f4(0x108)](0x2,'0');}function getCleanTimeStamp(){const _0x35ad97=_0x166ce5,_0x11f76d=shiftedTime();return _0x11f76d[_0x35ad97(0x1b2)]()+(_0x11f76d['getMonth']()+0x1)[_0x35ad97(0x1d2)]()[_0x35ad97(0x108)](0x2,'0')+_0x11f76d[_0x35ad97(0xdd)]()[_0x35ad97(0x1d2)]()[_0x35ad97(0x108)](0x2,'0')+'-'+_0x11f76d[_0x35ad97(0x26d)]()[_0x35ad97(0x1d2)]()[_0x35ad97(0x108)](0x2,'0')+_0x11f76d[_0x35ad97(0x137)]()['toString']()[_0x35ad97(0x108)](0x2,'0')+_0x11f76d[_0x35ad97(0x1f3)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x17f235=_0x166ce5,_0x3c430f=new Date();let _0x4fc762=_0x3c430f;if(settings[_0x17f235(0x23c)]&&settings[_0x17f235(0x23c)]!==0x0)_0x4fc762=fns[_0x17f235(0x18a)](_0x3c430f,{'hours':settings['timeshift']});return _0x4fc762;}async function startScheduler(){const _0x510b1b=_0x166ce5,_0x198d1a=new Date()[_0x510b1b(0x1ec)](),_0x12c420=shiftedTime()['getHours']();_0x12c420==0x4&&backupConfigFiles(),_0x12c420==0x0&&(rotateLogFiles(),logger['debug'](_0x510b1b(0x23b)),logger[_0x510b1b(0x2a9)](_0x510b1b(0x12a)+serverversion+_0x510b1b(0xc9)+(environment=='staging'?_0x510b1b(0x224):'')),logger['debug'](_0x510b1b(0x23b))),_0x198d1a%0x6==0x0&&triggerAnalytics(),_0x198d1a%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x6e21a1){const _0x4f824d=_0x166ce5;logger[_0x4f824d(0x2a9)](_0x4f824d(0x1ee)+_0x6e21a1);const _0x4eb77b=getBotsWithMode();_0x4eb77b['length']>0x0?confirmRestore(configbackuppath,_0x6e21a1):unzipFile(configbackuppath,_0x6e21a1);}function _0x36d5(_0xc7820e,_0x16fbd8){const _0x1544e3=_0x444e();return _0x36d5=function(_0x380fde,_0x56329a){_0x380fde=_0x380fde-0xae;let _0x444eeb=_0x1544e3[_0x380fde];return _0x444eeb;},_0x36d5(_0xc7820e,_0x16fbd8);}async function getBackupFiles(_0xf27e0f=null){const _0x5d034c=_0x166ce5;let _0x539851=[],_0x56703e=fs[_0x5d034c(0x13b)](configbackuppath,{'withFileTypes':!![]});_0x56703e[_0x5d034c(0x22f)]((_0x2acad8,_0x59c741)=>_0x2acad8['name']<_0x59c741[_0x5d034c(0x14f)]?0x1:_0x59c741[_0x5d034c(0x14f)]<_0x2acad8[_0x5d034c(0x14f)]?-0x1:0x0),_0x56703e[_0x5d034c(0x2ca)](_0x66e06d=>{const _0x1f53e6=_0x5d034c;if(!_0x66e06d[_0x1f53e6(0x129)]()&&_0x66e06d[_0x1f53e6(0x14f)][_0x1f53e6(0x19c)](_0x1f53e6(0x18c))&&_0x66e06d[_0x1f53e6(0x14f)]['endsWith']('.zip')){const _0x2a380a=formatDate(fs[_0x1f53e6(0xd0)](configbackuppath+_0x66e06d[_0x1f53e6(0x14f)])['mtime']);_0x539851[_0x1f53e6(0xe1)]({'name':_0x66e06d['name'],'mtime':_0x2a380a});}});if(_0xf27e0f)io['to'](_0xf27e0f)[_0x5d034c(0xfc)](_0x5d034c(0x10a),_0x539851);else return _0x539851;}async function backupConfigFiles(){const _0x5e5104=_0x166ce5;await zipFiles(_0x5e5104(0x17e));const _0x1659db=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x5e5104(0x17a),configbackuppath+(_0x5e5104(0x18c)+_0x1659db+_0x5e5104(0x228)));let _0x2c4695=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x2c4695[_0x5e5104(0x22f)]((_0x6bc198,_0x728e6c)=>_0x6bc198[_0x5e5104(0x14f)]<_0x728e6c[_0x5e5104(0x14f)]?0x1:_0x728e6c['name']<_0x6bc198[_0x5e5104(0x14f)]?-0x1:0x0),_0x2c4695[_0x5e5104(0x293)]>maxBackups&&fs[_0x5e5104(0x145)](configbackuppath+_0x2c4695[_0x2c4695[_0x5e5104(0x293)]-0x1][_0x5e5104(0x14f)]);}function rotateLogFiles(){const _0x39da60=_0x166ce5,_0xf2aa72=fs['statSync'](logspath+'output-000.log'),_0x4ef472=_0xf2aa72[_0x39da60(0x10b)]/0x400;if(_0x4ef472>0x64){let _0x532adc=fs[_0x39da60(0x13b)](logspath,{'withFileTypes':!![]});_0x532adc[_0x39da60(0x22f)]((_0x34817f,_0x4a1408)=>_0x34817f[_0x39da60(0x14f)]<_0x4a1408['name']?0x1:_0x4a1408[_0x39da60(0x14f)]<_0x34817f[_0x39da60(0x14f)]?-0x1:0x0),_0x532adc[_0x39da60(0x2ca)](_0x5eb93a=>{const _0x26ed8e=_0x39da60;if(_0x5eb93a[_0x26ed8e(0x14f)]==_0x26ed8e(0x107))fs[_0x26ed8e(0x162)](logspath+_0x5eb93a[_0x26ed8e(0x14f)],logspath+_0x26ed8e(0x2d4));if(_0x5eb93a['name']==_0x26ed8e(0x26e))fs[_0x26ed8e(0x162)](logspath+_0x5eb93a[_0x26ed8e(0x14f)],logspath+_0x26ed8e(0x107));_0x5eb93a['name']==_0x26ed8e(0x239)&&(fs[_0x26ed8e(0x162)](logspath+_0x5eb93a[_0x26ed8e(0x14f)],logspath+_0x26ed8e(0x26e)),fs[_0x26ed8e(0x2a2)](logspath+_0x5eb93a['name'],''));});}}async function zipFiles(_0xba8aa1){const _0x4cd367=_0x166ce5;let _0xff0bac;if(_0xba8aa1=='logs')_0xff0bac=logspath;if(_0xba8aa1==_0x4cd367(0x298))_0xff0bac=configpath;if(_0xba8aa1==_0x4cd367(0x17e))_0xff0bac=configpath;let _0x1eed76=fs['readdirSync'](_0xff0bac,{'withFileTypes':!![]});const _0x592de7=new JSZip();_0x1eed76['forEach'](_0x3fc481=>{const _0x52aaf2=_0x4cd367;if(!_0x3fc481[_0x52aaf2(0x129)]()){let _0x3d16ad=fs['readFileSync'](_0xff0bac+_0x3fc481['name']);if(_0xba8aa1==_0x52aaf2(0x298)){const _0x4f401b=/^bot-[0-9]{3}-config.json$/,_0x262209=_0x4f401b[_0x52aaf2(0x24c)](_0x3fc481[_0x52aaf2(0x14f)]);if(_0x262209){const _0x158597=JSON[_0x52aaf2(0x248)](_0x3d16ad);if(_0x158597['bot'][0x0]){_0x158597[_0x52aaf2(0x1e0)][0x0]['apiKey']='***',_0x158597[_0x52aaf2(0x1e0)][0x0][_0x52aaf2(0x242)]=_0x52aaf2(0x1c7);if(_0x158597['bot'][0x0][_0x52aaf2(0x297)])_0x158597[_0x52aaf2(0x1e0)][0x0][_0x52aaf2(0x297)]=_0x52aaf2(0x1c7);}_0x3d16ad=JSON[_0x52aaf2(0x272)](_0x158597,null,0x2);}if(_0x3fc481[_0x52aaf2(0x14f)]==_0x52aaf2(0x17f)){const _0x2dc7f0=JSON['parse'](_0x3d16ad);if(_0x2dc7f0[_0x52aaf2(0x1d6)]['loginRequired'])_0x2dc7f0[_0x52aaf2(0x1d6)][_0x52aaf2(0x154)]=![];if(_0x2dc7f0[_0x52aaf2(0x1d6)][_0x52aaf2(0x1f7)])_0x2dc7f0[_0x52aaf2(0x1d6)][_0x52aaf2(0x1f7)]=_0x52aaf2(0x1c7);if(_0x2dc7f0[_0x52aaf2(0x1d6)][_0x52aaf2(0xc6)])_0x2dc7f0[_0x52aaf2(0x1d6)][_0x52aaf2(0xc6)]=_0x52aaf2(0x1c7);if(_0x2dc7f0[_0x52aaf2(0x1d6)][_0x52aaf2(0x234)])_0x2dc7f0['settings']['telegramChatId']=null;if(_0x2dc7f0[_0x52aaf2(0x1d6)][_0x52aaf2(0x15a)])_0x2dc7f0[_0x52aaf2(0x1d6)][_0x52aaf2(0x15a)]=_0x52aaf2(0x1c7);_0x3d16ad=JSON['stringify'](_0x2dc7f0,null,0x2);}if(_0x3fc481[_0x52aaf2(0x14f)]!=_0x52aaf2(0x1ac))_0x592de7[_0x52aaf2(0x1e9)](_0x3fc481[_0x52aaf2(0x14f)],_0x3d16ad);}else _0x592de7['file'](_0x3fc481[_0x52aaf2(0x14f)],_0x3d16ad);}});const _0x31c69e=await _0x592de7[_0x4cd367(0xdc)]({'type':_0x4cd367(0x2a0),'base64':![],'compression':'DEFLATE'});fs[_0x4cd367(0x2a2)](zippath+(_0xba8aa1+'.zip'),_0x31c69e,'binary');}async function unzipFile(_0x3fea6d,_0x7a8662){const _0x47cf30=_0x166ce5;fs[_0x47cf30(0x13b)](configpath,{'withFileTypes':!![]})['forEach'](_0x343172=>{const _0x81e3e0=_0x47cf30;if(!_0x343172[_0x81e3e0(0x129)]())fs[_0x81e3e0(0xf6)](configpath+_0x343172['name']);});const _0x458f32=fs[_0x47cf30(0x128)](_0x3fea6d+_0x7a8662,_0x47cf30(0x178)),_0x394528=await JSZip[_0x47cf30(0xed)](_0x458f32,{'base64':![],'checkCRC32':!![]});for(const _0x5a0af9 of Object[_0x47cf30(0x1be)](_0x394528[_0x47cf30(0x1ef)])){const _0x57aedf=_0x394528[_0x47cf30(0x1ef)][_0x5a0af9],_0x21a151=await _0x57aedf[_0x47cf30(0x21d)](_0x47cf30(0x2a0));fs[_0x47cf30(0x2a2)](configpath+_0x57aedf[_0x47cf30(0x14f)],_0x21a151);}fs[_0x47cf30(0x13b)](temppath,{'withFileTypes':!![]})['forEach'](_0x3b7b12=>{const _0x5a90de=_0x47cf30;if(!_0x3b7b12[_0x5a90de(0x129)]())fs['rmSync'](temppath+_0x3b7b12[_0x5a90de(0x14f)]);}),logger['debug'](_0x47cf30(0x2ac)),process[_0x47cf30(0x205)]({'restore':!![]},_0x3e961c=>{});}async function getPublicIp(){const _0x34b178=_0x166ce5;try{const _0x4515f3=await axios[_0x34b178(0x1b0)](_0x34b178(0x1c0));publicip=_0x4515f3[_0x34b178(0x269)]['ip'];}catch(_0x2830f2){}}async function triggerAnalytics(){const _0x38a603=_0x166ce5;if(!publicip)await getPublicIp();const _0x25a4da=getBotsWithMode();let _0x1513ea=0x0;_0x25a4da['forEach'](_0x6bd03e=>{const _0x44d7cd=_0x36d5;if(_0x6bd03e[_0x44d7cd(0x15d)]===_0x44d7cd(0x288))_0x1513ea++;});const _0x5a2772=getBotExchanges();mixpanel['track'](_0x38a603(0xf0),{'distinct_id':settings[_0x38a603(0x24d)],'ip':publicip,'version':serverversion,'numbots':_0x25a4da[_0x38a603(0x293)],'numbotsenabled':_0x1513ea,'exchanges':_0x5a2772,'environment':environment});}async function getMessages(){const _0x23e4e5=_0x166ce5,_0x633e8c=_0x23e4e5(0xd9),_0x4d3477=new GraphQLClient(_0x633e8c),_0x3177b0={'authorization':_0x23e4e5(0x262)},_0xffcc9a=serverversion[_0x23e4e5(0x281)]('.'),_0x37fc88=_0xffcc9a[0x0]+'.'+_0xffcc9a[0x1],_0x329c42=Math['min'](settings[_0x23e4e5(0x1b1)],settings[_0x23e4e5(0x1e8)]),_0x221b11={'last':parseInt(_0x329c42),'bbm':_0x37fc88},_0x382ed1=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x35a089;try{_0x35a089=await _0x4d3477['request'](_0x382ed1,_0x221b11,_0x3177b0);}catch(_0x449405){}if(_0x35a089&&_0x35a089[_0x23e4e5(0x2c9)]){let _0x225948=settings['lastmsgtelegram'],_0xa67cf5=settings['lastmsgtelegram'];newMessages=[];for(const _0x4430ca of _0x35a089[_0x23e4e5(0x2c9)]){newMessages[_0x23e4e5(0xe1)](_0x4430ca);let _0x520ca1=![];_0x4430ca[_0x23e4e5(0x1af)]&&(updateSetting(_0x23e4e5(0x1fa),_0x4430ca[_0x23e4e5(0x1af)]),_0x520ca1=isNewerVersion(serverversion,_0x4430ca[_0x23e4e5(0x1af)])||serverversion==_0x4430ca['bbvNew']);if(!_0x520ca1&&_0x4430ca[_0x23e4e5(0x28d)]>_0x225948){if(_0x4430ca[_0x23e4e5(0x1ba)]==='any'||serverversion[_0x23e4e5(0x19c)](_0x4430ca[_0x23e4e5(0x1ba)])){let _0x4bd5d3=''+_0x4430ca['title']+'\x0a\x0a'+_0x4430ca[_0x23e4e5(0x268)];const _0x376d75=await sendTelegramMsg(toTelegramMarkdown(_0x4bd5d3),'Markdown');_0x225948=_0x4430ca[_0x23e4e5(0x28d)];}}_0xa67cf5=_0x4430ca[_0x23e4e5(0x28d)];}updateAvailable=isNewerVersion(settings[_0x23e4e5(0x1fa)],serverversion),updateSetting(_0x23e4e5(0x1b1),_0xa67cf5),emitMessages();}}function emitMessages(){const _0x1f90bd=_0x166ce5,_0x187ff1=settings[_0x1f90bd(0x1e8)];let _0xa24df8=[];newMessages[_0x1f90bd(0x2ca)](_0x4a0e41=>{const _0x6406d6=_0x1f90bd;_0x4a0e41[_0x6406d6(0x28d)]>_0x187ff1&&_0xa24df8[_0x6406d6(0xe1)](_0x4a0e41);}),_0xa24df8[_0x1f90bd(0x293)]>0x0&&getAllClients()[_0x1f90bd(0x2ca)](_0x52ac65=>{getSocket(_0x52ac65['id'])['emit']('message',_0xa24df8);});}function confirmMessage(_0x173840){const _0x37d08b=_0x166ce5;updateSetting(_0x37d08b(0x1e8),Number(_0x173840));}function isNewerVersion(_0x5c5bfa,_0x7ed36b){const _0x3f407b=_0x166ce5,_0x5989f9=_0x7ed36b[_0x3f407b(0x281)]('.'),_0x465720=_0x5c5bfa['split']('.');for(var _0x19f323=0x0;_0x19f323<_0x465720['length'];_0x19f323++){const _0x5e69c3=~~_0x465720[_0x19f323],_0x5b49d2=~~_0x5989f9[_0x19f323];if(_0x5e69c3>_0x5b49d2)return!![];if(_0x5e69c3<_0x5b49d2)return![];}return![];}function toTelegramMarkdown(_0x544b52){const _0x268078=_0x166ce5,_0x2d7a90=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3b4c5e=/\*{2}(.+?)\*{2}/gim;return _0x544b52=_0x544b52[_0x268078(0xc4)](_0x2d7a90,_0x268078(0xc1))[_0x268078(0xc4)](_0x3b4c5e,_0x268078(0xbf)),_0x544b52;}async function validateConfigFile(){const _0x34cb48=_0x166ce5,_0x45bc54=dbConfig[_0x34cb48(0x1b0)](_0x34cb48(0x181))[_0x34cb48(0xb9)](_0x34cb48(0xf7))[_0x34cb48(0x168)]()||[];if(_0x45bc54[_0x34cb48(0x293)]==0x0){let _0x1b561e=0x0,_0x5ce6e8=[];const _0x4a9a2c=/^bot-([0-9]{3})-config.json$/,_0x1fc7aa=fs[_0x34cb48(0x13b)](configpath);_0x1fc7aa['forEach'](_0x48d2c3=>{const _0x26f055=_0x34cb48,_0x1ebc1d=_0x4a9a2c[_0x26f055(0x1b4)](_0x48d2c3);if(_0x1ebc1d){const _0x8c6ea8=_0x1ebc1d[0x1];let _0x1eea85=getBotAttributes(_0x8c6ea8);_0x5ce6e8[_0x26f055(0xe1)]({'botID':_0x8c6ea8,'botname':_0x1eea85[_0x26f055(0x225)],'status':_0x26f055(0xfb),'live':_0x26f055(0x282)}),_0x1b561e++;}}),_0x1b561e!=0x0&&(dbConfig[_0x34cb48(0x1b0)](_0x34cb48(0x181))[_0x34cb48(0x183)](_0x5ce6e8)[_0x34cb48(0x125)](),config=_0x5ce6e8,restoredConfigFile=_0x1b561e);}}async function restoreConfigNotify(_0x5f5aa1){const _0x55347d=_0x166ce5;let _0x51c5b1;if(restoredConfigFile==0x1)_0x51c5b1=_0x55347d(0xf8);else _0x51c5b1=_0x55347d(0x2aa);if(_0x5f5aa1)io['to'](_0x55347d(0x26a))[_0x55347d(0xfc)](_0x55347d(0x1d9),_0x51c5b1);else{logger[_0x55347d(0xb3)](_0x55347d(0x246)),logger['simple'](_0x51c5b1),logger['simple'](_0x55347d(0x246)),logger[_0x55347d(0xb3)]('');if(tgBot&&settings[_0x55347d(0x234)]&&settings[_0x55347d(0x260)]!='orders')await sendTelegram(settings[_0x55347d(0x234)],'Bot\x20Mgr\x20>\x20'+_0x51c5b1);}}function decryptRSA(_0x1eac04,_0x3a703f){const _0x1cab32=_0x166ce5,_0x54d805=forge[_0x1cab32(0x1ae)][_0x1cab32(0x27d)](_0x1eac04),_0x3a4c12=_0x54d805[_0x1cab32(0x136)](forge[_0x1cab32(0x2c4)][_0x1cab32(0x14c)](_0x3a703f),_0x1cab32(0x29f),{'md':forge['md']['sha256'][_0x1cab32(0x1f8)](),'mgf1':{'md':forge['md'][_0x1cab32(0x29b)][_0x1cab32(0x1f8)]()}});return _0x3a4c12;}function validateCredentials(_0x14c228,_0xe69407){const _0x473b86=_0x166ce5;if(_0x14c228[_0x473b86(0x11d)]==settings['bbUsername']&&bcrypt[_0x473b86(0x267)](_0x14c228[_0x473b86(0x258)],settings[_0x473b86(0x1f7)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x473b86(0xba),'token':null};else{const _0x5abdd4=generateLoginToken(_0xe69407);return{'allow':!![],'reason':_0x473b86(0x276),'token':_0x5abdd4};}}else return{'allow':![],'reason':_0x473b86(0x217),'token':null};}function refreshToken(_0xce4f00){const _0x29657a=_0x166ce5,_0x2a0342=generateLoginToken(_0xce4f00);return{'allow':!![],'reason':_0x29657a(0x276),'token':_0x2a0342};}function validateAccess(_0x581f2f,_0x338f6d,_0x3fb762){const _0x292945=_0x166ce5,_0x3770ad=_0x3fb762?_0x3fb762:devices[_0x338f6d]['ip'];let _0x4a68b5;const _0x24d2a5=_0x3206c1=>{const _0x5a8db5=_0x36d5;if(settings[_0x5a8db5(0x154)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x338f6d)){const _0x2dace4=generateLoginToken(_0x338f6d);return{'allow':!![],'reason':_0x5a8db5(0x148),'token':_0x2dace4};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x4a68b5=validToken(_0x3206c1,_0x338f6d),_0x4a68b5[_0x5a8db5(0x227)](_0x5a8db5(0x191))?{'allow':!![],'reason':_0x5a8db5(0xca),'token':_0x3206c1}:{'allow':![],'reason':_0x5a8db5(0x252),'token':null};}else return{'allow':!![],'reason':_0x5a8db5(0x2d6),'token':null};};if(settings[_0x292945(0x1a8)]){let _0x279aaa=[...settings[_0x292945(0x1ad)],_0x292945(0xc3),_0x292945(0xaf),_0x292945(0xb4)];if(_0x279aaa[_0x292945(0xe6)](_0x3770ad))return _0x24d2a5(_0x581f2f);else{_0x4a68b5=validToken(_0x581f2f,_0x338f6d);if(_0x4a68b5[_0x292945(0x227)]('success'))return _0x24d2a5(_0x581f2f);else{if(telegramIpApproved(_0x338f6d)){const _0x5aab36=generateToken(_0x338f6d);return _0x4a68b5=_0x24d2a5(_0x581f2f),_0x4a68b5[_0x292945(0x209)]?{'allow':!![],'reason':_0x292945(0x1e4),'token':_0x5aab36}:_0x4a68b5;}else return settings[_0x292945(0xd6)]?{'allow':![],'reason':_0x292945(0x11e),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x24d2a5(_0x581f2f);}function timelyDecrypt(_0x3f768f,_0x384ed6,_0x2ef11f='@'){const _0x2ad5cb=_0x166ce5;if(_0x3f768f)try{const _0x8739e5=decryptRSA(secure[_0x2ad5cb(0x23a)],_0x3f768f),_0x63f02=_0x8739e5[_0x2ad5cb(0x281)](_0x2ef11f)[0x0],_0x871c53=_0x8739e5['split'](_0x2ef11f)[0x1],_0x375604=new Date()[_0x2ad5cb(0x212)]();if(_0x384ed6){if(_0x375604-_0x871c53<maxSecretAge*0x3e8)return _0x63f02;else return![];}else return _0x63f02;}catch(_0x32be32){return![];}else return![];}const validToken=(_0x34eee8,_0x40c677)=>{const _0x2e7c61=_0x166ce5,_0x4843ed=devices[_0x40c677]['ip'];if(!_0x34eee8)return{'error':'No\x20authentication\x20token'};for(let _0x1cf4cd of blacklist){if(_0x1cf4cd[_0x2e7c61(0x2b2)]==_0x34eee8)return{'error':_0x2e7c61(0x175)};}let _0x17de27;try{_0x17de27=jwt[_0x2e7c61(0x261)](_0x34eee8,secure[_0x2e7c61(0x263)]+_0x40c677);}catch{return{'error':_0x2e7c61(0x11b)};}if(!_0x17de27[_0x2e7c61(0x227)](_0x2e7c61(0x2b7))&&!_0x17de27['hasOwnProperty'](_0x2e7c61(0x11d))||!_0x17de27[_0x2e7c61(0x227)](_0x2e7c61(0x1cc)))return{'error':_0x2e7c61(0x2b0)};if(!_0x17de27['hasOwnProperty'](_0x2e7c61(0x11d))&&_0x17de27['hasOwnProperty']('clientip')){const {clientip:_0x1c27f6}=_0x17de27;return _0x4843ed==_0x1c27f6?{'success':_0x2e7c61(0x1fd)}:{'error':_0x2e7c61(0x192)};}else{if(_0x17de27[_0x2e7c61(0x227)](_0x2e7c61(0x11d))&&_0x17de27['hasOwnProperty'](_0x2e7c61(0x2b7))){const {username:_0x4f288a,clientip:_0x2f23a4}=_0x17de27;return settings['bbUsername']==_0x4f288a&&_0x4843ed==_0x2f23a4?{'success':_0x2e7c61(0x1fd)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x48f782=>{const _0x5ab29d=_0x166ce5;if(_0x48f782){const _0x4e8e90=devices[_0x48f782]['ip'];return jwt[_0x5ab29d(0x195)]({'username':settings[_0x5ab29d(0x221)],'clientip':_0x4e8e90},secure['secret']+_0x48f782,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x1d88ab=>{const _0x218098=_0x166ce5;if(_0x1d88ab){const _0x4d2b04=devices[_0x1d88ab]['ip'];return jwt[_0x218098(0x195)]({'clientip':_0x4d2b04},secure[_0x218098(0x263)]+_0x1d88ab,{'expiresIn':devices[_0x1d88ab][_0x218098(0x127)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x5a6187=>{const _0x164bbb=_0x166ce5;let _0x4ab112=![];return devices[_0x5a6187][_0x164bbb(0x127)]&&devices[_0x5a6187][_0x164bbb(0x127)][_0x164bbb(0x2a3)]!=_0x164bbb(0xea)&&(_0x4ab112=devices[_0x5a6187][_0x164bbb(0x127)][_0x164bbb(0x2b7)]==devices[_0x5a6187]['ip']&&new Date()[_0x164bbb(0x212)]()-devices[_0x5a6187][_0x164bbb(0x127)]['timestamp']<devices[_0x5a6187][_0x164bbb(0x127)][_0x164bbb(0x2a3)]*0x3c*0x3e8),_0x4ab112;},telegram2FaApproved=_0x3f983d=>{const _0x2ac2e0=_0x166ce5;let _0x3effc6=![];return devices[_0x3f983d][_0x2ac2e0(0x25c)]&&devices[_0x3f983d]['telegram2FaApproval']['expiry']!='reject'&&(_0x3effc6=devices[_0x3f983d][_0x2ac2e0(0x25c)]['clientip']==devices[_0x3f983d]['ip']&&new Date()[_0x2ac2e0(0x212)]()-devices[_0x3f983d][_0x2ac2e0(0x25c)][_0x2ac2e0(0x22a)]<devices[_0x3f983d]['telegram2FaApproval'][_0x2ac2e0(0x2a3)]*0x3c*0x3e8),_0x3effc6;},normalizeIP=_0x24d6d3=>{const _0x4d27a9=_0x166ce5;let _0xe8e59b=null,_0x1705a4=null;if(ipaddr[_0x4d27a9(0x1f1)](_0x24d6d3)){const _0x3cdfae=ipaddr[_0x4d27a9(0x248)](_0x24d6d3);_0x3cdfae['kind']()===_0x4d27a9(0x202)?(_0x3cdfae[_0x4d27a9(0x10f)]()&&(_0xe8e59b=_0x3cdfae['toIPv4Address']()[_0x4d27a9(0x1d2)]()),_0x1705a4=_0x3cdfae['toString']()):(_0xe8e59b=_0x3cdfae['toString'](),_0x1705a4=_0x3cdfae[_0x4d27a9(0x20f)]()[_0x4d27a9(0x1d2)]());}return{'show':_0xe8e59b?_0xe8e59b:_0x1705a4,'store':_0x1705a4};};function formatDate(_0xc5aa99){const _0x4def06=_0x166ce5;return _0xc5aa99[_0x4def06(0x1b2)]()+'/'+(_0xc5aa99[_0x4def06(0x15e)]()+0x1)[_0x4def06(0x1d2)]()[_0x4def06(0x108)](0x2,'0')+'/'+_0xc5aa99[_0x4def06(0xdd)]()[_0x4def06(0x1d2)]()[_0x4def06(0x108)](0x2,'0')+'\x20'+_0xc5aa99[_0x4def06(0x26d)]()[_0x4def06(0x1d2)]()[_0x4def06(0x108)](0x2,'0')+':'+_0xc5aa99[_0x4def06(0x137)]()['toString']()[_0x4def06(0x108)](0x2,'0')+':'+_0xc5aa99[_0x4def06(0x1f3)]()[_0x4def06(0x1d2)]()[_0x4def06(0x108)](0x2,'0');}function sleep(_0x62b151){return new Promise(_0x4904ae=>setTimeout(_0x4904ae,_0x62b151));}