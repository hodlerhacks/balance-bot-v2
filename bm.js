const _0x21f322=_0x4fb0;(function(_0x564784,_0x3460ed){const _0x13ade7=_0x4fb0,_0x2cf02c=_0x564784();while(!![]){try{const _0x533198=-parseInt(_0x13ade7(0x27d))/0x1*(-parseInt(_0x13ade7(0x227))/0x2)+parseInt(_0x13ade7(0x1e8))/0x3+-parseInt(_0x13ade7(0x2cc))/0x4*(-parseInt(_0x13ade7(0x2b2))/0x5)+-parseInt(_0x13ade7(0x17f))/0x6*(parseInt(_0x13ade7(0x16b))/0x7)+parseInt(_0x13ade7(0x267))/0x8+parseInt(_0x13ade7(0x274))/0x9*(parseInt(_0x13ade7(0x21e))/0xa)+-parseInt(_0x13ade7(0x1fb))/0xb;if(_0x533198===_0x3460ed)break;else _0x2cf02c['push'](_0x2cf02c['shift']());}catch(_0xccca42){_0x2cf02c['push'](_0x2cf02c['shift']());}}}(_0x382c,0x3dd08));const _0x60ca3d=function(){let _0x3937db=!![];return function(_0x14722e,_0x23baae){const _0x5f1304=_0x3937db?function(){const _0x85fded=_0x4fb0;if(_0x23baae){const _0x56263c=_0x23baae[_0x85fded(0x2f5)](_0x14722e,arguments);return _0x23baae=null,_0x56263c;}}:function(){};return _0x3937db=![],_0x5f1304;};}(),_0x177481=_0x60ca3d(this,function(){const _0x137cde=_0x4fb0;return _0x177481[_0x137cde(0x2f4)]()[_0x137cde(0x29f)](_0x137cde(0x301))[_0x137cde(0x2f4)]()['constructor'](_0x177481)[_0x137cde(0x29f)]('(((.+)+)+)+$');});_0x177481();'use strict';process[_0x21f322(0x299)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x21f322(0x126)),fs=require('fs'),fns=require(_0x21f322(0xff)),low=require(_0x21f322(0x29a)),FileSync=require(_0x21f322(0x136)),path=require(_0x21f322(0x291)),crypto=require(_0x21f322(0x263)),forge=require('node-forge'),bcrypt=require('bcryptjs'),jwt=require(_0x21f322(0x202)),ipaddr=require(_0x21f322(0x2cf)),argv=require('yargs/yargs')(process[_0x21f322(0x23f)][_0x21f322(0x2f2)](0x2))[_0x21f322(0x23f)],uuidRandom=require(_0x21f322(0x12b)),{Telegraf,Markup}=require(_0x21f322(0x15a)),Mixpanel=require(_0x21f322(0x13c)),axios=require('axios'),{GraphQLClient,gql}=require(_0x21f322(0x2ad)),util=require(_0x21f322(0xfe)),fileUpload=require(_0x21f322(0x2b9)),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv[_0x21f322(0x26f)]||_0x21f322(0x2ee),pattern=/^[0-9]{2,4}$/;!pattern[_0x21f322(0xf3)](PORT)&&(console[_0x21f322(0x109)](_0x21f322(0x1a6)+PORT+_0x21f322(0x1be)),process[_0x21f322(0xfa)](0x1));const HOST=argv['host']||null,userID=argv[_0x21f322(0x10d)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x21f322(0x12f)][_0x21f322(0x219)];let bbpath=_0x21f322(0x2b0),bbpath2='';const botfile=_0x21f322(0x2d8),configfile=_0x21f322(0x26c),settingsfile='bb-settings.json',securefile=_0x21f322(0x229),environment=require('./'+bbpath2+_0x21f322(0x15b))[_0x21f322(0x130)]||_0x21f322(0x105),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x21f322(0x212)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x21f322(0x248)),configpath=userID?bbpath+_0x21f322(0x1b8)+userID+'/':bbpath+_0x21f322(0x1b8),configbackuppath=configpath+_0x21f322(0x22e),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x21f322(0x1a5)+userID+'/':bbpath+_0x21f322(0x1a5),loggerfile=fs[_0x21f322(0x2f1)](logspath+_0x21f322(0x1de),{'flags':'a'}),temppath=userID?bbpath+_0x21f322(0xfb)+userID+'/':bbpath+_0x21f322(0xfb);!fs[_0x21f322(0x212)](configpath)&&fs['mkdirSync'](configpath);!fs[_0x21f322(0x212)](configbackuppath)&&fs[_0x21f322(0x1e3)](configbackuppath);!fs['existsSync'](logspath)&&fs['mkdirSync'](logspath);!fs[_0x21f322(0x212)](zippath)&&fs[_0x21f322(0x1e3)](zippath);!fs[_0x21f322(0x212)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x21f322(0x26d)]({'bots':[]})[_0x21f322(0x266)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x21f322(0x26d)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x21f322(0x1dd),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x21f322(0x26d)]({'secure':{},'blacklist':[]})['write']();const saltRounds=0xa,mixpanel=Mixpanel['init']('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x21f322(0x1eb)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings['telegramToken']!=''&&settings['telegramToken']!=_0x21f322(0x1b2))&&settings[_0x21f322(0x171)]&&settings[_0x21f322(0x171)]!='')initTelegram();const parseColor=(_0x5344d6,_0x297558)=>{const _0x2bd90e=_0x21f322,_0x5d7d09=/#[A-Z]{3}#/g;if(typeof _0x5344d6=='string'){!_0x297558?_0x5344d6=_0x5344d6[_0x2bd90e(0x279)](_0x5d7d09,''):(_0x5344d6=_0x5344d6[_0x2bd90e(0x279)](/#BLU#/g,_0x2bd90e(0x1bd)),_0x5344d6=_0x5344d6[_0x2bd90e(0x279)](/#RED#/g,_0x2bd90e(0x256)),_0x5344d6=_0x5344d6[_0x2bd90e(0x279)](/#YEL#/g,_0x2bd90e(0x1c3)),_0x5344d6=_0x5344d6[_0x2bd90e(0x279)](/#MAG#/g,_0x2bd90e(0x191)),_0x5344d6=_0x5344d6[_0x2bd90e(0x279)](/#CYA#/g,_0x2bd90e(0x1d4)),_0x5344d6=_0x5344d6[_0x2bd90e(0x279)](/#RES#/g,'\x1b[0m'));;}return _0x5344d6;},logger={'screen':_0x13174f=>{const _0x54d515=_0x21f322;console[_0x54d515(0x109)](parseColor(_0x13174f,!![]));},'simple':_0x5dd9a9=>{const _0x1f570a=_0x21f322;console[_0x1f570a(0x109)](parseColor(_0x5dd9a9,!![])),loggerfile[_0x1f570a(0x266)](util['format'](parseColor(_0x5dd9a9,![]))+'\x0a');},'full':async _0x583a0b=>{const _0x5a2d58=_0x21f322,_0x4114de=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x583a0b;console[_0x5a2d58(0x109)](parseColor(_0x4114de,!![])),loggerfile['write'](util['format'](parseColor(_0x4114de,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x5a2d58(0x129))await sendTelegram(settings[_0x5a2d58(0x24d)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x583a0b,![]));},'debug':async(_0x16657a,_0x2bff51='')=>{const _0x2df672=_0x21f322,_0x5683fd=getTimeStamp()+_0x2df672(0x15d)+_0x16657a;if(debugging)console[_0x2df672(0x109)](parseColor(_0x5683fd,!![]));loggerfile['write'](util[_0x2df672(0x1ec)](parseColor(_0x5683fd,![]))+'\x0a');if(_0x2bff51){if(debugging)console['log'](_0x2bff51);loggerfile[_0x2df672(0x266)](util[_0x2df672(0x1ec)](_0x2bff51)+'\x0a');}}};let terminating=![];process['on'](_0x21f322(0x11f),function(_0x1ad61d){const _0x165e57=_0x21f322;_0x1ad61d[_0x165e57(0x2f4)]()[_0x165e57(0x2a0)]('address\x20already\x20in\x20use')?(logger[_0x165e57(0x2af)](_0x165e57(0x2c0)+_0x1ad61d['port']+_0x165e57(0x2de)),process[_0x165e57(0x294)]({'terminate':!![]},_0x3b8e92=>{})):logger[_0x165e57(0x2af)](_0x1ad61d);}),process['on']('exit',()=>{const _0x54e63c=_0x21f322;stopAllBots(),process[_0x54e63c(0xfa)](0x0);}),process['on'](_0x21f322(0x2b8),()=>{const _0xb26b80=_0x21f322;stopAllBots(),process[_0xb26b80(0xfa)](0x0);}),process['on'](_0x21f322(0x249),()=>{const _0x5a2f28=_0x21f322;stopAllBots(),process[_0x5a2f28(0xfa)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x21f322(0x15b))[_0x21f322(0x2f0)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x21f322(0x268)),app=express(),http=require(_0x21f322(0x206))[_0x21f322(0x167)](app);app[_0x21f322(0x19a)](fileUpload({'useTempFiles':!![]})),app[_0x21f322(0x2c7)](_0x21f322(0x24a),async(_0x2e1a7c,_0x4b250b)=>{const _0x2e5196=_0x21f322,_0x26ad52=_0x2e1a7c[_0x2e5196(0x275)][_0x2e5196(0x297)],_0x43e60c=getClientsWithBotID('botmanager'),_0x3f8ad2=_0x2e1a7c[_0x2e5196(0x1ef)][_0x2e5196(0x2bd)],_0x4ebd49=timelyDecrypt(_0x3f8ad2,![]),_0x3cb25f=_0x43e60c['find'](_0x3e283c=>_0x3e283c['uuid']==_0x4ebd49);if(_0x3cb25f){const _0x27d99e=normalizeIP(_0x2e1a7c[_0x2e5196(0x173)][_0x2e5196(0x144)])[_0x2e5196(0x1aa)],_0x57225f=_0x2e1a7c[_0x2e5196(0x1ef)][_0x2e5196(0x165)];if(validateAccess(_0x57225f,_0x4ebd49,_0x27d99e)[_0x2e5196(0x124)])_0x26ad52==_0x2e5196(0x258)&&await backupConfigFiles(),await zipFiles(_0x26ad52),_0x4b250b[_0x2e5196(0x255)](zippath+(_0x26ad52+_0x2e5196(0x2e0)),_0x6938b5=>{const _0x34128c=_0x2e5196;_0x6938b5&&(logger[_0x34128c(0x13f)](_0x34128c(0x18c)+_0x26ad52),logger[_0x34128c(0x2af)](_0x6938b5));});else logger[_0x2e5196(0x13f)](_0x2e5196(0x1e5)+_0x26ad52+_0x2e5196(0x2bb));}else logger[_0x2e5196(0x13f)](_0x2e5196(0x1e5)+_0x26ad52+_0x2e5196(0x246));}),app[_0x21f322(0x15c)]('/upload-backup',async(_0x179779,_0x5208f8)=>{const _0x4bbebf=_0x21f322,_0x1e50bf=getClientsWithBotID('botmanager'),_0x9779=_0x179779[_0x4bbebf(0x1ef)][_0x4bbebf(0x2bd)],_0x17d900=timelyDecrypt(_0x9779,![]),_0x98c9b4=_0x1e50bf[_0x4bbebf(0x159)](_0x42e1fb=>_0x42e1fb[_0x4bbebf(0x2bd)]==_0x17d900);logger[_0x4bbebf(0x224)](_0x4bbebf(0x16c));if(_0x98c9b4){const _0x4c9853=normalizeIP(_0x179779[_0x4bbebf(0x173)]['remoteAddress'])[_0x4bbebf(0x1aa)],_0x8f700e=_0x179779['headers'][_0x4bbebf(0x165)];if(validateAccess(_0x8f700e,_0x17d900,_0x4c9853)[_0x4bbebf(0x124)]){if(_0x179779[_0x4bbebf(0x26e)]){const _0x154ab0=_0x179779[_0x4bbebf(0x26e)][_0x4bbebf(0x147)];await _0x154ab0['mv'](temppath+_0x154ab0[_0x4bbebf(0x188)]),_0x5208f8[_0x4bbebf(0x294)]({'status':!![],'message':_0x4bbebf(0x25a)});const _0x6e8d18=getBotsWithMode();_0x6e8d18[_0x4bbebf(0x146)]>0x0?confirmRestore(temppath,_0x154ab0['name']):unzipFile(temppath,_0x154ab0['name']);}}else logger['full'](_0x4bbebf(0x223));}else logger[_0x4bbebf(0x13f)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app['use'](express[_0x21f322(0x148)](path[_0x21f322(0x11d)](__dirname,bbpath2,'build2'))),app[_0x21f322(0x19a)](express[_0x21f322(0x148)](path[_0x21f322(0x11d)](__dirname,bbpath2,_0x21f322(0x133)))),app['get']('/',function(_0x4df732,_0x35d978){const _0x307bc2=_0x21f322;_0x35d978[_0x307bc2(0x2c1)](path[_0x307bc2(0x11d)](__dirname,bbpath2,'build2',_0x307bc2(0x286)));}),app[_0x21f322(0x2c7)]('/:bot',function(_0x3fa0e6,_0x412e17){const _0x23ffeb=_0x21f322;_0x412e17['sendFile'](path[_0x23ffeb(0x11d)](__dirname,bbpath2,'build',_0x23ffeb(0x286)));}),app['get'](_0x21f322(0x1d0),(_0x2b1284,_0x2d86a4)=>{const _0x406892=_0x21f322;_0x2d86a4[_0x406892(0x2c1)](path[_0x406892(0x11d)](__dirname,bbpath2,_0x406892(0x133),_0x406892(0x286)));}),app['get'](_0x21f322(0x290),(_0x2f7f34,_0xb4e2b9)=>{const _0x581ebf=_0x21f322;_0xb4e2b9[_0x581ebf(0x2c1)](path[_0x581ebf(0x11d)](__dirname,bbpath2,'build',_0x581ebf(0x286)));}),app['get']('/:bot/coins',(_0xb9003e,_0x3e48f7)=>{const _0x43af7d=_0x21f322;_0x3e48f7[_0x43af7d(0x2c1)](path[_0x43af7d(0x11d)](__dirname,bbpath2,_0x43af7d(0x133),_0x43af7d(0x286)));}),app[_0x21f322(0x2c7)](_0x21f322(0x198),(_0x2d7252,_0x57d0e0)=>{const _0x4d043e=_0x21f322;_0x57d0e0[_0x4d043e(0x2c1)](path[_0x4d043e(0x11d)](__dirname,bbpath2,'build',_0x4d043e(0x286)));}),app[_0x21f322(0x2c7)](_0x21f322(0x1c8),(_0x4a3ff3,_0x4daee9)=>{const _0xacc38b=_0x21f322;_0x4daee9[_0xacc38b(0x2c1)](path[_0xacc38b(0x11d)](__dirname,bbpath2,_0xacc38b(0x133),_0xacc38b(0x286)));}),app[_0x21f322(0x2c7)](_0x21f322(0x120),(_0x282751,_0x3afdec)=>{const _0x180bc0=_0x21f322;_0x3afdec[_0x180bc0(0x2c1)](path[_0x180bc0(0x11d)](__dirname,bbpath2,_0x180bc0(0x133),_0x180bc0(0x286)));});if(HOST)http[_0x21f322(0x2d2)](PORT,HOST);else http[_0x21f322(0x2d2)](PORT);const io=require(_0x21f322(0x117))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function _0x382c(){const _0x4b83cb=['mixpanel','access','replyWithDocument','full','logs','sort','Unauthorized\x20attempt\x20to\x20update\x20bot','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','remoteAddress','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','length','backupfile','static','privateKeyFromPem','sendPortfolioTelegram','HTML','onepagemode','\x20mode','button','file','RSA-OAEP','Bot\x20Mgr\x20>\x20','sendMessage','function','User\x20has\x20been\x20validated','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','text','bots','restore_no_','find','telegraf','version.json','post',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','reset-history','|@|','2FA\x20login\x20required','portfolio','\x20-\x20','rmSync','reinstall','tkn','randomFillSync','createServer','backup-full','filter','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','7ikJMXs','Backup\x20file\x20uploaded','-events.json','/update\x20-\x20update\x20Balance\x20Bot\x0a','string','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','telegramUsername','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','socket','login\x20not\x20required','new-disabled','server','timestamp','reason','(staging)','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','ipv6','login\x20required','sign','-results.json','2308704aNkJxP','auto','login2fa_','bbUsername','CoinMarketCap\x20API\x20key\x20validated','yes','/start','chat','decrypt','name','bbvNew','https://api.ipify.org?format=json','login','Failed\x20to\x20download\x20','_nsps','backup-full.zip','output-001.log','Telegraf\x20error:','\x1b[35m','resetpw_yes','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','show','Unauthorized\x20attempt\x20to\x20delete\x20bot','output-002.log','getPortfolio','/:bot/history','Unauthorized\x20attempt\x20to\x20add\x20bot','use','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','started','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','binary','-performance.json','--------------------------------------','Yes','botmanager','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','tempaccess_5_','zip/','Error:\x20Invalid\x20argument\x20','connection','config_all','track','store','Invalid\x20authentication\x20token\x20(2)','code','************','#RES#\x20','off','/backup\x20-\x20receive\x20backup\x20files\x0a','Notifications\x20disabled\x0a','***','alias','padStart','Token\x20blacklisted','get-logs','family','config/','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Restoring\x20bot(s)\x20from\x20backup','exchange','temporary\x20token\x20generated','\x1b[34m',',\x20must\x20be\x20a\x204\x20digit\x20number','DEFLATE','Unauthorized\x20attempt\x20to\x20log\x20out','Unauthorized\x20attempt\x20to\x20get\x20messages','loginRequired','\x1b[33m','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','publicKeyToPem','title','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','/:bot/configuration','token','isDirectory','Unauthorized\x20attempt\x20to\x20store\x20configuration','range','pidExpireLogin','keys','botID','/:bot/portfolio','BCT','telegram','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','\x1b[36m','editMessageReplyMarkup','inherit','reply','toggleBotMode','toggle_','any','mode','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','0.0.0','/output-000.log','*$1*','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','portfolio_','telegramIpApproval','mkdirSync','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Unauthorized\x20attempt\x20to\x20download\x20','Network\x20Interfaces:','storeHeadless','27519DJWAMV','enable','reinstall_yes','api-eu.mixpanel.com','format','Login\x20accepted','message','headers','getSeconds','error','writeFileSync','login\x20token\x20valid','event','getStartingBalances','Disabled\x20Bot\x20','toggle-bot-mode','config','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','all','5638259KqrLTs','restart_','Restore\x20process\x20aborted','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','getTime','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','Unauthorized\x20login\x20attempt\x20(timeout)','jsonwebtoken','Unauthorized\x20attempt\x20to\x20show\x20configuration','privateKey','update','http','parse','copyFileSync','on_','apiSecret','secure','bbPassword','bb-settings.json','match','inlineKeyboard','Ok,\x20will\x20send\x20order\x20notifications\x20only','backup-full@','existsSync','/on\x20-\x20start\x20bot(s)\x0a','Setting\x20access:\x20','2FA','number','notification','config_orders','node','async','handshake','temporary\x20access\x20timeout','generateAsync','413520qHsfuN','map','getDate','backup-files','toggle','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','debug','No\x20bots\x20running\x20right\x20now','update-bb','34niCrkK','whitelistEnabled','bb-secure.json','\x20files\x20over\x20Telegram:','enabled','telegramEnabled','Error\x20sending\x20','backup/','once','staging','alerts','names','connected','Starting\x20new\x20bot\x20|\x20Bot\x20','hex','restart','$1_$2_$3','getMinutes','bbvReceive','f2aRequired','confirm-message','#RES#\x20if\x20running\x20locally\x0a','tempaccess_15_','/disable\x20-\x20disable\x20notifications\x0a','argv','access\x20timeout','expiry','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','bot','min','settings','\x20(2)','get-messages','clients','SIGINT','/download/:type','invalid\x20credentials','Allow\x20login\x20from\x20IP\x20address\x20','telegramChatId','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','store-fiat','stopped','placeOrder','value','get-starting-balances','15\x20min','download','\x1b[31m','settings.','backup','/off\x20-\x20stop\x20bot(s)\x0a','File\x20uploaded','hashSync','Logged\x20in\x20user\x20...','All\x20bots\x20running\x20right\x20now','\x20to\x20','referer','loadAsync','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','messages','crypto','sha256','#RES#\x20if\x20running\x20on\x20server','write','2260488xZpxXZ','express','Error\x20removing\x20old\x20backup\x20files:','compareSync','bot-','bb-config.json','defaults','files','port','encryptedUuid','Restore\x20process\x20confirmed','start','running','90zrJOSc','params','status\x20code\x20401','place-order','Session\x20expired\x20for\x20user\x20...','replace','1000','getFullYear','secret','24863fQWsZk','delete-bot','kill',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','max','from','getHours','store-configuration','request','index.html','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','lastmsgtelegram','config_alerts','pidRefreshToken','botname','tempaccess_30_','showname','Starting\x20Balance\x20Bot\x20reinstallation','accept','/:bot/performance','path','toIPv4MappedAddress','stringify','send','Backup\x20file\x20unzipped\x20and\x20stored','/metrics\x20-\x20show\x20bot\x20performance\x0a','type','lastmsgemitted','env','lowdb','update-bot','/status\x20-\x20show\x20bot(s)\x20status\x0a','IPv4','catch','search','includes','stop','reset-password','update_no','latestversion','isValid','Deleted\x20Bot\x20','marketcapApi','action','Access\x20enabled\x20for\x20','readdirSync','Login\x20rejected','remove','graphql-request','status','simple','bb/','\x20|\x20','10KILCpd','Password\x20reset\x20rejected','apiKey','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','127.0.0.1','<b>Balance\x20Bot\x20Status:</b>\x0a','SIGTERM','express-fileupload','username','\x20(1)','publicKey','uuid','emit','login2fa_reject_','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','sendFile','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','telegramEvents','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','create','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','get','callback','privateKeyToPem','split','toIPv4Address','45240nmcRqs','::1','conn','ipaddr.js','logout',')\x20|\x20Bot\x20','listen','hasOwnProperty','reload','logged\x20out','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','rsa','bot.js','assign','-config.json','command','disable','store-headless','#RES#','success','.zip','internal','exp','then','\x20>\x20','Unauthorized\x20attempt\x20to\x20confirm\x20message','Restarting\x20Bot\x20','headless','sortBy','ETH','Invalid\x20authentication\x20token\x20(1)','login\x20token\x20generated','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','size','3000','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','version','createWriteStream','slice','clientip','toString','apply','All\x20bots','restore_yes_','verify','password','manual','startsWith','You\x20can\x20use\x20the\x20following\x20commands:\x0a','2FA\x20required','Restore\x20backup\x20file\x20','unlinkSync','live','(((.+)+)+)+$','timeshift','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','reinstall-bb','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','data','test','readFileSync','forEach','sockets','-----------------------------------------------------------------------------------','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','statSync','exit','temp/','2FA\x20login\x20rejected','2FA\x20login\x20token\x20generated','util','date-fns','kind','Server','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Logged\x20out\x20user\x20...','order','production','temporary\x20access\x20not\x20allowed','new','[ip-address]','log','All','Notifications\x20enabled','Unauthorized\x20attempt\x20to\x20get\x20events','user','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','disconnect',')\x20\x20\x20|\x20Bot\x20','Starting\x20Balance\x20Bot\x20update','getUTCHours','pki','temporary\x20access\x20rejected','warning','help','socket.io','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','apiPassword','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','telegramToken','tempaccess_reject_','join','Unauthorized\x20attempt\x20to\x20delete\x20alerts','uncaughtException','/:bot/support','getMonth','/help\x20-\x20show\x20available\x20commands\x0a','metrics','allow','set','child_process','blacklist','Notifications\x20enabled\x0a','orders','telegrammsg','uuid-random','storeConfiguration','close','disabled','versions','environment','telegram2FaApproval','Starting\x20#RED#Balance\x20Bot\x20v','build','push','private','lowdb/adapters/FileSync','address','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','Bot\x20','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','reject'];_0x382c=function(){return _0x4b83cb;};return _0x382c();}function getServerIP(){const _0x54b8e4=_0x21f322;let _0x53ebf7=_0x54b8e4(0x108);const _0x4da06a=networkInterfaces(),_0x6c9559={};for(const _0x21be17 of Object[_0x54b8e4(0x1ce)](_0x4da06a)){for(const _0x1b0246 of _0x4da06a[_0x21be17]){if((_0x1b0246[_0x54b8e4(0x1b7)]==_0x54b8e4(0x29d)||_0x1b0246[_0x54b8e4(0x1b7)]==0x4)&&!_0x1b0246[_0x54b8e4(0x2e1)]){const _0x1ff5cd=ipaddr[_0x54b8e4(0x207)](_0x1b0246[_0x54b8e4(0x137)])[_0x54b8e4(0x1cc)]();_0x1ff5cd!=_0x54b8e4(0x135)&&(!_0x6c9559[_0x21be17]&&(_0x6c9559[_0x21be17]=[]),_0x6c9559[_0x21be17]['push'](_0x1b0246['address']),_0x53ebf7=_0x1b0246[_0x54b8e4(0x137)]);}}}return{'serverip':_0x53ebf7,'netinterfaces':_0x6c9559};}async function startServer(){const _0x277ba3=_0x21f322,{serverip:_0x128f58,netinterfaces:_0x430c65}=getServerIP();logger[_0x277ba3(0x2af)](''),logger[_0x277ba3(0x2af)]('-----------------------------------------------------------------------------------'),await logger[_0x277ba3(0x13f)](_0x277ba3(0x132)+serverversion+_0x277ba3(0x1ae)+(environment==_0x277ba3(0x230)?_0x277ba3(0x179):'')+'\x0a'+(_0x277ba3(0x10e)+PORT+_0x277ba3(0x23c))+('=>\x20Go\x20to\x20#CYA#http://'+_0x128f58+':'+PORT+_0x277ba3(0x265))),logger[_0x277ba3(0x2af)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x44fd24 of config){const _0x1e7c51=_0x44fd24['mode']==_0x277ba3(0x180)?'a':'m';if(_0x44fd24[_0x277ba3(0x2ae)]==_0x277ba3(0x22b)||_0x44fd24[_0x277ba3(0x2ae)]==_0x277ba3(0x107))await logger[_0x277ba3(0x13f)]('Starting\x20('+_0x1e7c51+_0x277ba3(0x2d1)+_0x44fd24[_0x277ba3(0x1cf)]+_0x277ba3(0x2b1)+_0x44fd24[_0x277ba3(0x28b)]),startBot([_0x44fd24[_0x277ba3(0x1cf)],userID],{'cwd':bbpath},function(_0x5ba7d8){if(_0x5ba7d8)logger['full'](_0x5ba7d8);});else(_0x44fd24[_0x277ba3(0x2ae)]==_0x277ba3(0x12e)||_0x44fd24['status']==_0x277ba3(0x175))&&await logger[_0x277ba3(0x13f)]('Idling\x20('+_0x1e7c51+_0x277ba3(0x110)+_0x44fd24[_0x277ba3(0x1cf)]+_0x277ba3(0x2b1)+_0x44fd24['botname']);}else!newBot&&logger[_0x277ba3(0x2af)](_0x277ba3(0x1a3));if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x277ba3(0x2af)](''),await logger[_0x277ba3(0x224)]('Node.js\x20v'+nodeversion),await logger[_0x277ba3(0x224)](_0x277ba3(0x1e6),_0x430c65);}function startSocket(){const _0x943cee=_0x21f322;io['on'](_0x943cee(0x1a7),_0x32c1d7=>{const _0x45b3ca=_0x943cee;let _0x409727,_0x20b5e7,_0x1671fc,_0x3a8fd8,_0x549996;const _0x111583=_0x32c1d7[_0x45b3ca(0x21b)][_0x45b3ca(0x1ef)][_0x45b3ca(0x25f)];_0x20b5e7=_0x111583[_0x45b3ca(0x20e)](/bot[0-9]{3}/);if(_0x20b5e7)_0x1671fc=_0x20b5e7[0x0][_0x45b3ca(0x20e)](/[0-9]{3}/);if(_0x1671fc)_0x409727=_0x1671fc[0x0];else _0x409727=_0x45b3ca(0x1a2);const _0x1193d9=_0x32c1d7[_0x45b3ca(0x21b)]['auth'][_0x45b3ca(0x270)];if(!_0x1193d9)_0x32c1d7[_0x45b3ca(0x2be)]('status',{'publicKey':secure['publicKey']});else{_0x3a8fd8=timelyDecrypt(_0x1193d9,![]);if(!_0x3a8fd8)_0x32c1d7[_0x45b3ca(0x2be)](_0x45b3ca(0x2ae),{'publicKey':secure[_0x45b3ca(0x2bc)]});else{_0x549996=normalizeIP(_0x32c1d7[_0x45b3ca(0x2ce)][_0x45b3ca(0x144)])[_0x45b3ca(0x1aa)];if(!devices[_0x3a8fd8])devices[_0x3a8fd8]={'uuid':_0x3a8fd8,'access':{'token':null}};devices[_0x3a8fd8]['ip']=_0x549996;const _0x43f793=addClient(_0x32c1d7['id'],_0x3a8fd8,_0x409727);setAccess(_0x43f793),emitMessages(),_0x32c1d7['on'](_0x45b3ca(0x18b),_0x55e892=>{const _0x3cf0e9=_0x45b3ca,_0x4a2d3a=timelyDecrypt(_0x55e892[_0x3cf0e9(0x2f9)],!![],'|@|');if(_0x4a2d3a){_0x55e892={'username':_0x55e892[_0x3cf0e9(0x2ba)],'password':_0x4a2d3a},devices[_0x3a8fd8][_0x3cf0e9(0x13d)]=validateCredentials(_0x55e892,_0x3a8fd8);if(devices[_0x3a8fd8][_0x3cf0e9(0x13d)][_0x3cf0e9(0x124)]==![]&&devices[_0x3a8fd8]['access'][_0x3cf0e9(0x178)]=='2FA\x20login\x20required')_0x32c1d7[_0x3cf0e9(0x2be)](_0x3cf0e9(0x2ae),{'access':devices[_0x3a8fd8][_0x3cf0e9(0x13d)]}),loginAccess2FA(_0x3a8fd8,_0x549996);else{if(devices[_0x3a8fd8][_0x3cf0e9(0x13d)][_0x3cf0e9(0x124)]==![]&&devices[_0x3a8fd8][_0x3cf0e9(0x13d)][_0x3cf0e9(0x178)]=='invalid\x20credentials')_0x32c1d7[_0x3cf0e9(0x2be)](_0x3cf0e9(0x2ae),{'access':devices[_0x3a8fd8][_0x3cf0e9(0x13d)]});else devices[_0x3a8fd8]['access'][_0x3cf0e9(0x124)]&&devices[_0x3a8fd8][_0x3cf0e9(0x13d)][_0x3cf0e9(0x178)]==_0x3cf0e9(0x2eb)&&(getClientsWithUuid(_0x3a8fd8)['forEach'](_0x61002d=>{setAccess(_0x61002d);}),logger[_0x3cf0e9(0x224)](_0x3cf0e9(0x25c)+_0x3a8fd8[_0x3cf0e9(0x2f2)](-0x8)),setTokenRefresh(_0x3a8fd8),setSessionTimeout('login',_0x3a8fd8));}}else logger[_0x3cf0e9(0x13f)](_0x3cf0e9(0x201));}),_0x32c1d7['on'](_0x45b3ca(0x2a2),()=>{resetPassword();}),_0x32c1d7['on'](_0x45b3ca(0x10f),_0x24bbc1=>{removeClient(_0x32c1d7['id']);}),_0x409727=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x180413){const _0x12512b=_0x21f322;if(_0x180413!=_0x12512b(0x1a2)&&config[_0x12512b(0x2b4)]!=''){if(pid[_0x180413])pid[_0x180413][_0x12512b(0x294)]({'function':'initclient','args':null});}_0x180413!='botmanager'&&broadcastToBots(_0x12512b(0x157),JSON[_0x12512b(0x293)](config));}function reloadBotManager(){const _0x4d50c3=_0x21f322;getClientsWithBotID('botmanager')[_0x4d50c3(0xf5)](_0x157277=>{const _0x6e58c7=_0x4d50c3;getSocket(_0x157277['id'])[_0x6e58c7(0x2be)](_0x6e58c7(0x2ae),{'access':{'allow':![],'reason':_0x6e58c7(0x2d4),'token':null}});});}function getSocket(_0x6cb471){const _0x10fde7=_0x21f322,_0x57216f=io[_0x10fde7(0x18d)][_0x10fde7(0x2c7)]('/');return _0x57216f[_0x10fde7(0xf6)][_0x10fde7(0x2c7)](_0x6cb471);}function setAccess(_0x3e1540){const _0x1f6c2f=_0x21f322,_0x2b8327=getSocket(_0x3e1540['id']),_0x1ad547=_0x3e1540[_0x1f6c2f(0x2bd)],_0x303a39=_0x3e1540[_0x1f6c2f(0x243)];devices[_0x1ad547][_0x1f6c2f(0x13d)]=validateAccess(devices[_0x1ad547][_0x1f6c2f(0x13d)][_0x1f6c2f(0x1c9)],_0x1ad547),logger[_0x1f6c2f(0x224)](_0x1f6c2f(0x214)+devices[_0x1ad547][_0x1f6c2f(0x13d)][_0x1f6c2f(0x178)]+'\x20|\x20client:\x20...'+_0x3e1540['id'][_0x1f6c2f(0x2f2)](-0x8)+'\x20|\x20user:\x20...'+_0x1ad547[_0x1f6c2f(0x2f2)](-0x8)),_0x2b8327['join'](_0x1ad547);if(devices[_0x1ad547][_0x1f6c2f(0x13d)]['allow']){_0x2b8327[_0x1f6c2f(0x11d)](_0x303a39);if(_0x303a39==_0x1f6c2f(0x1a2))initializeSocketBotManager(_0x2b8327);else initializeSocketBot(_0x2b8327);initClient(_0x303a39);}devices[_0x1ad547][_0x1f6c2f(0x13d)][_0x1f6c2f(0x1c9)]&&devices[_0x1ad547][_0x1f6c2f(0x13d)][_0x1f6c2f(0x178)]==_0x1f6c2f(0x1bc)&&setSessionTimeout(_0x1f6c2f(0x215),_0x1ad547),devices[_0x1ad547][_0x1f6c2f(0x13d)]['token']&&devices[_0x1ad547][_0x1f6c2f(0x13d)][_0x1f6c2f(0x178)]==_0x1f6c2f(0xfd)&&setSessionTimeout(_0x1f6c2f(0x18b),_0x1ad547),_0x2b8327[_0x1f6c2f(0x2be)]('status',{'status':_0x3e1540[_0x1f6c2f(0x176)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1ad547][_0x1f6c2f(0x13d)],'externalip':devices[_0x1ad547]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x1ad547]['access'][_0x1f6c2f(0x124)]==![]&&devices[_0x1ad547][_0x1f6c2f(0x13d)]['reason']==_0x1f6c2f(0x2fd)&&temporaryAccess2FA(_0x1ad547,devices[_0x1ad547]['ip']);}function setSessionTimeout(_0x198b88,_0xc06664){const _0x2a8034=_0x21f322;let _0x3ded45;if(_0x198b88==_0x2a8034(0x18b))_0x3ded45=loginExpiry*0x3c*0x3e8;else _0x3ded45=devices[_0xc06664][_0x2a8034(0x1e2)][_0x2a8034(0x241)]*0x3c*0x3e8-(new Date()[_0x2a8034(0x1ff)]()-devices[_0xc06664][_0x2a8034(0x1e2)][_0x2a8034(0x177)]);if(devices[_0xc06664][_0x2a8034(0x1cd)])clearTimeout(devices[_0xc06664][_0x2a8034(0x1cd)]);devices[_0xc06664][_0x2a8034(0x1cd)]=setTimeout(()=>{const _0x5595b8=_0x2a8034;if(devices[_0xc06664][_0x5595b8(0x28a)])clearTimeout(devices[_0xc06664][_0x5595b8(0x28a)]);removeSocketListeners(_0xc06664),addBlacklist(_0xc06664),devices[_0xc06664]['telegramIpApproval']=null,devices[_0xc06664]['telegram2FaApproval']=null,devices[_0xc06664][_0x5595b8(0x13d)][_0x5595b8(0x1c9)]=null,logger[_0x5595b8(0x224)](_0x5595b8(0x278)+_0xc06664[_0x5595b8(0x2f2)](-0x8)),devices[_0xc06664]['access']=validateAccess(devices[_0xc06664]['access'][_0x5595b8(0x1c9)],_0xc06664),!(devices[_0xc06664]['access'][_0x5595b8(0x124)]&&devices[_0xc06664][_0x5595b8(0x13d)][_0x5595b8(0x178)]==_0x5595b8(0x174))&&(_0x198b88==_0x5595b8(0x18b)?io['to'](_0xc06664)[_0x5595b8(0x2be)](_0x5595b8(0x2ae),{'access':{'allow':![],'reason':_0x5595b8(0x240),'token':null}}):io['to'](_0xc06664)[_0x5595b8(0x2be)](_0x5595b8(0x2ae),{'access':{'allow':![],'reason':_0x5595b8(0x21c),'token':null}})),devices[_0xc06664][_0x5595b8(0x13d)]['token']=null;},_0x3ded45);}function setTokenRefresh(_0x57e8b6){const _0x59aa93=_0x21f322;if(devices[_0x57e8b6][_0x59aa93(0x28a)])clearTimeout(devices[_0x57e8b6][_0x59aa93(0x28a)]);devices[_0x57e8b6][_0x59aa93(0x28a)]=setTimeout(()=>{const _0x4d617c=_0x59aa93;getClientsWithUuid(_0x57e8b6)[_0x4d617c(0x146)]!=0x0?(devices[_0x57e8b6][_0x4d617c(0x13d)]=refreshToken(_0x57e8b6),io['to'](_0x57e8b6)[_0x4d617c(0x2be)](_0x4d617c(0x2ae),{'status':_0x4d617c(0x233),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x57e8b6][_0x4d617c(0x13d)],'externalip':devices[_0x57e8b6]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x57e8b6)):clearTimeout(devices[_0x57e8b6][_0x4d617c(0x28a)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x58210e){const _0x2c2e62=_0x21f322,_0x324b87=getClient(_0x58210e['id'])[_0x2c2e62(0x2bd)];_0x58210e['emit']('bots',config),_0x58210e['emit'](_0x2c2e62(0x245),cleanSettings()),_0x58210e['on']('add-bot',_0x47c151=>{const _0x2deca2=_0x2c2e62;if(validateAccess(_0x47c151,_0x324b87)['allow'])addBot();else logger[_0x2deca2(0x13f)](_0x2deca2(0x199));}),_0x58210e['on'](_0x2c2e62(0x29b),(_0x173509,_0x1530d3)=>{const _0x34cc64=_0x2c2e62;if(validateAccess(_0x1530d3,_0x324b87)['allow'])toggleBot(_0x173509['botID'],_0x173509[_0x34cc64(0x2ae)],_0x173509[_0x34cc64(0x300)]);else logger[_0x34cc64(0x13f)](_0x34cc64(0x142));}),_0x58210e['on'](_0x2c2e62(0x1f7),(_0x195127,_0x2af006)=>{const _0x9f3366=_0x2c2e62;if(validateAccess(_0x2af006,_0x324b87)[_0x9f3366(0x124)])toggleBotMode(_0x195127);else logger['full'](_0x9f3366(0x142));}),_0x58210e['on'](_0x2c2e62(0x27e),(_0x37e24e,_0x2bf9e6)=>{const _0x5de29e=_0x2c2e62;if(validateAccess(_0x2bf9e6,_0x324b87)[_0x5de29e(0x124)])deleteBot(_0x37e24e);else logger[_0x5de29e(0x13f)](_0x5de29e(0x195));}),_0x58210e['on']('store-settings',(_0x49dcd4,_0x592501)=>{const _0x2b3aaf=_0x2c2e62;if(validateAccess(_0x592501,_0x324b87)['allow'])storeSettings(_0x49dcd4,!![]);else logger[_0x2b3aaf(0x13f)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x58210e['on'](_0x2c2e62(0x226),_0x23cee4=>{const _0x3be126=_0x2c2e62;if(validateAccess(_0x23cee4,_0x324b87)[_0x3be126(0x124)])updateBB(_0x3be126(0x205));else logger[_0x3be126(0x13f)](_0x3be126(0x1e4));}),_0x58210e['on'](_0x2c2e62(0xf0),_0xe1b005=>{const _0x1e864c=_0x2c2e62;if(validateAccess(_0xe1b005,_0x324b87)[_0x1e864c(0x124)])updateBB(_0x1e864c(0x164));else logger[_0x1e864c(0x13f)](_0x1e864c(0x200));}),_0x58210e['on']('get-backup-files',_0x4b140d=>{const _0x3b6797=_0x2c2e62;if(validateAccess(_0x4b140d,_0x324b87)[_0x3b6797(0x124)]){const _0x629918=getClient(_0x58210e['id']);if(_0x629918)getBackupFiles(_0x629918['uuid']);else logger['full']('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x3b6797(0x13f)](_0x3b6797(0x1d3));}),_0x58210e['on']('restore-backup-file',(_0x3d5ebf,_0x19ecbc)=>{const _0xdabdbf=_0x2c2e62;if(validateAccess(_0x19ecbc,_0x324b87)[_0xdabdbf(0x124)])restoreBackupFile(_0x3d5ebf);else logger[_0xdabdbf(0x13f)](_0xdabdbf(0x1b9));}),_0x58210e['on'](_0x2c2e62(0x247),_0x5a6413=>{const _0x4c9e14=_0x2c2e62;if(validateAccess(_0x5a6413,_0x324b87)[_0x4c9e14(0x124)])getMessages();else logger[_0x4c9e14(0x13f)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x58210e['on']('confirm-message',(_0x2c21d5,_0x57531b)=>{const _0x36c07e=_0x2c2e62;if(validateAccess(_0x57531b,_0x324b87)[_0x36c07e(0x124)])confirmMessage(_0x2c21d5);else logger[_0x36c07e(0x13f)](_0x36c07e(0x2e5));}),_0x58210e['on'](_0x2c2e62(0x2d0),_0x17001f=>{const _0x2e0b3b=_0x2c2e62;if(validateAccess(_0x17001f,_0x324b87)[_0x2e0b3b(0x124)]){if(devices[_0x324b87][_0x2e0b3b(0x28a)])clearTimeout(devices[_0x324b87][_0x2e0b3b(0x28a)]);if(devices[_0x324b87][_0x2e0b3b(0x1cd)])clearTimeout(devices[_0x324b87][_0x2e0b3b(0x1cd)]);removeSocketListeners(getClient(_0x58210e['id'])[_0x2e0b3b(0x2bd)]),addBlacklist(_0x324b87),devices[_0x324b87][_0x2e0b3b(0x1e2)]=null,devices[_0x324b87][_0x2e0b3b(0x131)]=null,devices[_0x324b87][_0x2e0b3b(0x13d)][_0x2e0b3b(0x1c9)]=null,logger[_0x2e0b3b(0x224)](_0x2e0b3b(0x103)+_0x324b87['slice'](-0x8)),io['to'](getClient(_0x58210e['id'])[_0x2e0b3b(0x2bd)])[_0x2e0b3b(0x2be)]('status',{'access':{'allow':![],'reason':_0x2e0b3b(0x2d5),'token':null}});}else logger[_0x2e0b3b(0x13f)](_0x2e0b3b(0x1c0));});}function initializeSocketBot(_0x38bcda){const _0x1dcddf=_0x21f322,_0x4d8de4=getClient(_0x38bcda['id'])['bot'],_0x586caf=getClient(_0x38bcda['id'])['uuid'];_0x38bcda['on'](_0x1dcddf(0x1b6),(_0x3adbea,_0x31f386)=>{const _0x55df70=_0x1dcddf;if(validateAccess(_0x31f386,_0x586caf)[_0x55df70(0x124)]){if(pid[_0x4d8de4])pid[_0x4d8de4][_0x55df70(0x294)]({'function':'emitHistory','args':_0x3adbea});}else logger['full'](_0x55df70(0x10c));}),_0x38bcda['on']('delete-alerts',(_0x3e41a5,_0x1a3847)=>{const _0x566c56=_0x1dcddf;if(validateAccess(_0x1a3847,_0x586caf)[_0x566c56(0x124)]){if(pid[_0x4d8de4])pid[_0x4d8de4]['send']({'function':'deleteHistoryAlerts','args':_0x3e41a5});}else logger['full'](_0x566c56(0x11e));}),_0x38bcda['on']('get-portfolio',(_0x228add,_0x5a8849)=>{const _0x4f8f0a=_0x1dcddf;if(validateAccess(_0x5a8849,_0x586caf)[_0x4f8f0a(0x124)]){if(pid[_0x4d8de4])pid[_0x4d8de4][_0x4f8f0a(0x294)]({'function':_0x4f8f0a(0x197),'args':_0x228add});}else logger[_0x4f8f0a(0x13f)](_0x4f8f0a(0x102));}),_0x38bcda['on'](_0x1dcddf(0x284),(_0xac384e,_0x1542ef)=>{const _0x2a4da6=_0x1dcddf;if(validateAccess(_0x1542ef,_0x586caf)[_0x2a4da6(0x124)]){if(pid[_0x4d8de4])pid[_0x4d8de4][_0x2a4da6(0x294)]({'function':_0x2a4da6(0x12c),'args':_0xac384e});}else logger[_0x2a4da6(0x13f)](_0x2a4da6(0x1cb));}),_0x38bcda['on'](_0x1dcddf(0x2dd),(_0x96d4,_0x51c5a1)=>{const _0x3d70ee=_0x1dcddf;if(validateAccess(_0x51c5a1,_0x586caf)[_0x3d70ee(0x124)]){if(pid[_0x4d8de4])pid[_0x4d8de4]['send']({'function':_0x3d70ee(0x1e7),'args':_0x96d4});}else logger['full'](_0x3d70ee(0x2ec));}),_0x38bcda['on'](_0x1dcddf(0x24f),(_0x106044,_0x100d38)=>{const _0x55822d=_0x1dcddf;if(validateAccess(_0x100d38,_0x586caf)[_0x55822d(0x124)]){if(pid[_0x4d8de4])pid[_0x4d8de4][_0x55822d(0x294)]({'function':'storeFiat','args':_0x106044});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x38bcda['on'](_0x1dcddf(0x15e),_0x10600d=>{const _0xfc64ff=_0x1dcddf;if(validateAccess(_0x10600d,_0x586caf)[_0xfc64ff(0x124)]){if(pid[_0x4d8de4])pid[_0x4d8de4][_0xfc64ff(0x294)]({'function':'resetHistory','args':null});}else logger['full'](_0xfc64ff(0x2ef));}),_0x38bcda['on'](_0x1dcddf(0x253),_0x1e6335=>{const _0x31a32f=_0x1dcddf;if(validateAccess(_0x1e6335,_0x586caf)[_0x31a32f(0x124)]){if(pid[_0x4d8de4])pid[_0x4d8de4][_0x31a32f(0x294)]({'function':_0x31a32f(0x1f5),'args':null});}else logger[_0x31a32f(0x13f)](_0x31a32f(0x1dc));}),_0x38bcda['on'](_0x1dcddf(0x277),(_0xee2888,_0x27f03d)=>{const _0x51c3cf=_0x1dcddf;if(validateAccess(_0x27f03d,_0x586caf)[_0x51c3cf(0x124)]){if(pid[_0x4d8de4])pid[_0x4d8de4][_0x51c3cf(0x294)]({'function':_0x51c3cf(0x251),'args':_0xee2888});}else logger[_0x51c3cf(0x13f)](_0x51c3cf(0x16a));}),_0x38bcda['on']('cancel-loading',_0x42671c=>{const _0x2dbd83=_0x1dcddf;if(validateAccess(_0x42671c,_0x586caf)[_0x2dbd83(0x124)]){if(pid[_0x4d8de4])pid[_0x4d8de4][_0x2dbd83(0x294)]({'function':'cancelLoading','args':null});}else logger[_0x2dbd83(0x13f)](_0x2dbd83(0x1e0));}),_0x38bcda['on']('show-config',_0x160d90=>{const _0x2afe52=_0x1dcddf;if(validateAccess(_0x160d90,_0x586caf)['allow']){if(pid[_0x4d8de4])pid[_0x4d8de4][_0x2afe52(0x294)]({'function':'showConfig','args':null});}else logger['full'](_0x2afe52(0x203));}),_0x38bcda['on'](_0x1dcddf(0x226),_0x18a6ba=>{const _0x1231b2=_0x1dcddf;if(validateAccess(_0x18a6ba,_0x586caf)[_0x1231b2(0x124)])updateBB('update');else logger[_0x1231b2(0x13f)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x38bcda['on'](_0x1dcddf(0x247),_0x173c08=>{const _0x55b9f8=_0x1dcddf;if(validateAccess(_0x173c08,_0x586caf)[_0x55b9f8(0x124)])getMessages();else logger[_0x55b9f8(0x13f)](_0x55b9f8(0x1c1));}),_0x38bcda['on'](_0x1dcddf(0x23b),(_0x2880dc,_0x448f00)=>{const _0x3ee9cc=_0x1dcddf;if(validateAccess(_0x448f00,_0x586caf)[_0x3ee9cc(0x124)])confirmMessage(_0x2880dc);else logger[_0x3ee9cc(0x13f)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x38bcda['on'](_0x1dcddf(0x2d0),_0x134ed3=>{const _0x1ae86c=_0x1dcddf;if(validateAccess(_0x134ed3,_0x586caf)[_0x1ae86c(0x124)]){if(devices[_0x586caf]['pidRefreshToken'])clearTimeout(devices[_0x586caf][_0x1ae86c(0x28a)]);if(devices[_0x586caf][_0x1ae86c(0x1cd)])clearTimeout(devices[_0x586caf]['pidExpireLogin']);removeSocketListeners(getClient(_0x38bcda['id'])[_0x1ae86c(0x2bd)]),addBlacklist(_0x586caf),devices[_0x586caf]['telegramIpApproval']=null,devices[_0x586caf][_0x1ae86c(0x131)]=null,devices[_0x586caf][_0x1ae86c(0x13d)]['token']=null,logger['debug'](_0x1ae86c(0x103)+_0x586caf['slice'](-0x8)),io['to'](getClient(_0x38bcda['id'])['uuid'])[_0x1ae86c(0x2be)](_0x1ae86c(0x2ae),{'access':{'allow':![],'reason':_0x1ae86c(0x2d5),'token':null}});}else logger[_0x1ae86c(0x13f)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x525760){getClientsWithUuid(_0x525760)['forEach'](_0x425a96=>{getSocket(_0x425a96['id'])['removeAllListeners']();});}function cleanSettings(){const _0x5c7cb8=_0x21f322;let _0x3d2b45=settings;return settings[_0x5c7cb8(0x11b)]&&settings['telegramToken']!=''&&(_0x3d2b45={..._0x3d2b45,'telegramToken':_0x5c7cb8(0x1ad)}),settings['bbPassword']&&settings[_0x5c7cb8(0x20c)]!=''&&(_0x3d2b45={..._0x3d2b45,'bbPassword':'************'}),settings[_0x5c7cb8(0x2a7)]&&settings[_0x5c7cb8(0x2a7)]!=''&&(_0x3d2b45={..._0x3d2b45,'marketcapApi':'************'}),(settings[_0x5c7cb8(0x20c)]&&settings['bbPassword']==_0x5c7cb8(0x1b2)||settings[_0x5c7cb8(0x11b)]&&settings[_0x5c7cb8(0x11b)]==_0x5c7cb8(0x1b2)||settings[_0x5c7cb8(0x2a7)]&&settings['marketcapApi']==_0x5c7cb8(0x1b2))&&(_0x3d2b45={..._0x3d2b45,'restored':{'password':settings[_0x5c7cb8(0x20c)]==_0x5c7cb8(0x1b2),'telegram':settings[_0x5c7cb8(0x11b)]=='***','marketcap':settings[_0x5c7cb8(0x2a7)]==_0x5c7cb8(0x1b2)}}),_0x3d2b45;}async function updateBB(_0x51d699){const _0x371939=_0x21f322;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x3a6952=>{const _0x37f209=_0x4fb0;restartBot(_0x3a6952[_0x37f209(0x1cf)]);});if(_0x51d699==_0x371939(0x205))process[_0x371939(0x294)]({'update':!![],'environment':environment},_0x3c10ef=>{});else _0x51d699==_0x371939(0x164)&&process[_0x371939(0x294)]({'reinstall':!![],'environment':environment},_0x370642=>{});}function startBot(_0x24a75f,_0x1c112b,_0x3dd240){const _0x502141=_0x21f322;if(debugging)_0x24a75f[_0x502141(0x134)]('-d');if(recreate)_0x24a75f[_0x502141(0x134)]('-r');let _0x1bb14c=![];const _0x179d73=_0x24a75f[0x0];_0x1c112b={..._0x1c112b,'stdio':[_0x502141(0x1d6),_0x502141(0x1d6),_0x502141(0x1d6),'ipc']},pid[_0x179d73]=childProcess['fork'](botfile,_0x24a75f,_0x1c112b),pid[_0x179d73]['on']('message',_0x55d7fb=>{const _0x8fb1c8=_0x502141;switch(Object['keys'](_0x55d7fb)[0x0]){case _0x8fb1c8(0x28b):updateBotName(_0x179d73,_0x55d7fb[_0x8fb1c8(0x28b)]);break;case'updatebotmanager':updateBotManager();break;case _0x8fb1c8(0x2ae):updateStatus(_0x179d73,_0x55d7fb['status']);break;case _0x8fb1c8(0x300):updateLive(_0x179d73,_0x55d7fb[_0x8fb1c8(0x300)]);break;case _0x8fb1c8(0x19c):updateLive(_0x179d73,_0x55d7fb[_0x8fb1c8(0x19c)]),io['to'](_0x179d73)['emit'](_0x8fb1c8(0x2ae),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x8fb1c8(0x2a1):_0x55d7fb['stop']==_0x8fb1c8(0x236)&&restartBot(_0x179d73);_0x55d7fb[_0x8fb1c8(0x2a1)]==_0x8fb1c8(0x27f)&&toggleBot(_0x179d73,_0x8fb1c8(0x12e),_0x8fb1c8(0x250));break;case _0x8fb1c8(0x1d2):sendTelegramBot(_0x179d73,_0x55d7fb[_0x8fb1c8(0x1d2)]);break;case _0x8fb1c8(0x12a):sendTelegramMsg(_0x55d7fb[_0x8fb1c8(0x12a)]);break;case _0x8fb1c8(0x153):io['to'](_0x179d73)[_0x8fb1c8(0x2be)](_0x55d7fb[_0x8fb1c8(0x153)],_0x55d7fb['args']);break;}}),pid[_0x179d73]['on'](_0x502141(0x1f1),function(_0xcdd69c){if(_0x1bb14c)return;_0x1bb14c=!![],_0x3dd240(_0xcdd69c);}),pid[_0x179d73]['on']('exit',async function(_0x324c63){const _0x175ad6=_0x502141;if(terminating)return;if(installingUpdate){io[_0x175ad6(0x12d)]();return;}if(_0x1bb14c)return;_0x1bb14c=!![],_0x3dd240(null);const _0x377c86=dbConfig[_0x175ad6(0x2c7)](_0x175ad6(0x157))['find']({'botID':_0x179d73})[_0x175ad6(0x252)]();_0x377c86&&(_0x377c86['status']==_0x175ad6(0x22b)||_0x377c86['status']==_0x175ad6(0x107))&&(await sleep(0x3e8),updateLive(_0x179d73,_0x175ad6(0x250)),logger[_0x175ad6(0x13f)](_0x175ad6(0x2e6)+_0x179d73),startBot([_0x179d73,userID],{'cwd':bbpath},function(_0x277bb6){const _0x1bedf2=_0x175ad6;if(_0x277bb6)logger[_0x1bedf2(0x13f)](_0x277bb6);}));});}function stopBot(_0x492ddf){const _0x518d07=_0x21f322;getClientsWithBotID(_0x492ddf)[_0x518d07(0xf5)](_0x46d560=>{const _0xdeabf3=_0x518d07;getSocket(_0x46d560['id'])[_0xdeabf3(0x10f)](!![]),removeClient(_0x46d560['id']);}),pid[_0x492ddf]&&(pid[_0x492ddf][_0x518d07(0x27f)](),pid[_0x492ddf]=null);}function stopAllBots(){terminating=!![];const _0x3a9167=getEnabledBots();_0x3a9167['forEach'](_0xfd7a1=>{const _0x533f04=_0x4fb0;stopBot(_0xfd7a1[_0x533f04(0x1cf)]);});}function restartBot(_0x2ef30f){const _0x5723fd=_0x21f322;if(pid[_0x2ef30f])pid[_0x2ef30f][_0x5723fd(0x27f)]();}function addBot(){const _0x70978e=_0x21f322;let _0x3468e2;for(let _0x379326=0x1;_0x379326<0x3e9;_0x379326++){_0x3468e2=_0x379326[_0x70978e(0x2f4)]()[_0x70978e(0x1b4)](0x3,'0');let _0x6d9fd9=config[_0x70978e(0x159)](_0x143f2b=>_0x143f2b[_0x70978e(0x1cf)]==_0x3468e2);if(!_0x6d9fd9)break;}if(_0x3468e2===_0x70978e(0x27a)){logger[_0x70978e(0x13f)](_0x70978e(0x242));return;}logger[_0x70978e(0x13f)](_0x70978e(0x234)+_0x3468e2),dbConfig['get'](_0x70978e(0x157))[_0x70978e(0x134)]({'botID':_0x3468e2,'botname':_0x70978e(0x139)+_0x3468e2,'status':'new','live':''})[_0x70978e(0x266)](),startBot([_0x3468e2,userID],{'cwd':bbpath},function(_0x4c4bc0){const _0x5c0fc0=_0x70978e;if(_0x4c4bc0)logger[_0x5c0fc0(0x13f)](_0x4c4bc0);}),config=getConfiguration(),io['to']('botmanager')[_0x70978e(0x2be)]('bots',config),broadcastToBots(_0x70978e(0x157),JSON['stringify'](config));}function deleteBot(_0xd6bcde){const _0x26b0aa=_0x21f322;getClientsWithBotID(_0xd6bcde)[_0x26b0aa(0xf5)](_0x69b94a=>{const _0x3e4e1f=_0x26b0aa;getSocket(_0x69b94a['id'])[_0x3e4e1f(0x10f)](!![]),removeClient(_0x69b94a['id']);}),dbConfig[_0x26b0aa(0x2c7)](_0x26b0aa(0x157))[_0x26b0aa(0x2ac)]({'botID':_0xd6bcde})[_0x26b0aa(0x266)](),logger[_0x26b0aa(0x13f)](_0x26b0aa(0x2a6)+_0xd6bcde),stopBot(_0xd6bcde);try{if(fs[_0x26b0aa(0x212)](path[_0x26b0aa(0x11d)](configpath,_0x26b0aa(0x26b)+_0xd6bcde+_0x26b0aa(0x2da))))fs['unlinkSync'](path[_0x26b0aa(0x11d)](configpath,_0x26b0aa(0x26b)+_0xd6bcde+_0x26b0aa(0x2da)));if(fs[_0x26b0aa(0x212)](path['join'](configpath,'bot-'+_0xd6bcde+'-events.json')))fs[_0x26b0aa(0x2ff)](path[_0x26b0aa(0x11d)](configpath,_0x26b0aa(0x26b)+_0xd6bcde+_0x26b0aa(0x16d)));if(fs['existsSync'](path['join'](configpath,_0x26b0aa(0x26b)+_0xd6bcde+_0x26b0aa(0x19f))))fs['unlinkSync'](path[_0x26b0aa(0x11d)](configpath,_0x26b0aa(0x26b)+_0xd6bcde+'-performance.json'));if(fs[_0x26b0aa(0x212)](path['join'](configpath,_0x26b0aa(0x26b)+_0xd6bcde+_0x26b0aa(0x17e))))fs[_0x26b0aa(0x2ff)](path[_0x26b0aa(0x11d)](configpath,_0x26b0aa(0x26b)+_0xd6bcde+_0x26b0aa(0x17e)));}catch(_0x39e86e){if(_0x39e86e)logger[_0x26b0aa(0x13f)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x39e86e);}config=getConfiguration(),io['to'](_0x26b0aa(0x1a2))[_0x26b0aa(0x2be)]('bots',config),broadcastToBots(_0x26b0aa(0x157),JSON[_0x26b0aa(0x293)](config));}function toggleBot(_0x12cf72,_0x1f0c46,_0x12893e){const _0x5b05b0=_0x21f322;dbConfig['get'](_0x5b05b0(0x157))[_0x5b05b0(0x159)]({'botID':_0x12cf72})[_0x5b05b0(0x2d9)]({'status':_0x1f0c46})[_0x5b05b0(0x2d9)]({'live':_0x12893e})[_0x5b05b0(0x266)]();if(_0x1f0c46==_0x5b05b0(0x22b)||_0x1f0c46==_0x5b05b0(0x107))logger[_0x5b05b0(0x13f)]('Enabled\x20Bot\x20'+_0x12cf72),startBot([_0x12cf72,userID],{'cwd':bbpath},function(_0x11e44f){if(_0x11e44f)logger['full'](_0x11e44f);});else(_0x1f0c46=='disabled'||_0x1f0c46==_0x5b05b0(0x175))&&(logger[_0x5b05b0(0x13f)](_0x5b05b0(0x1f6)+_0x12cf72),stopBot(_0x12cf72));config=getConfiguration(),io['to']('botmanager')[_0x5b05b0(0x2be)](_0x5b05b0(0x157),config),broadcastToBots(_0x5b05b0(0x157),JSON['stringify'](config));}function toggleStatus(_0xfbcd5c){const _0x25c55a=_0x21f322;let _0x12c576=dbConfig[_0x25c55a(0x2c7)]('bots')[_0x25c55a(0x159)]({'botID':_0xfbcd5c})[_0x25c55a(0x252)](),_0x5619be;if(_0x12c576[_0x25c55a(0x2ae)]===_0x25c55a(0x22b))_0x5619be=_0x25c55a(0x12e);else{if(_0x12c576[_0x25c55a(0x2ae)]===_0x25c55a(0x107))_0x5619be=_0x25c55a(0x175);else{if(_0x12c576['status']===_0x25c55a(0x175))_0x5619be='new';else{if(_0x12c576[_0x25c55a(0x2ae)]===_0x25c55a(0x12e))_0x5619be=_0x25c55a(0x22b);}}}return _0x5619be;}function updateStatus(_0xaa0ee1,_0x3079b3){const _0x3cb748=_0x21f322;dbConfig['get'](_0x3cb748(0x157))[_0x3cb748(0x159)]({'botID':_0xaa0ee1})[_0x3cb748(0x2d9)]({'status':_0x3079b3})[_0x3cb748(0x266)](),config=getConfiguration(),io['to'](_0x3cb748(0x1a2))['emit'](_0x3cb748(0x157),config),broadcastToBots(_0x3cb748(0x157),JSON[_0x3cb748(0x293)](config));}function updateLive(_0x135b3e,_0x2264af){const _0xbfda7c=_0x21f322;dbConfig[_0xbfda7c(0x2c7)](_0xbfda7c(0x157))[_0xbfda7c(0x159)]({'botID':_0x135b3e})['assign']({'live':_0x2264af})[_0xbfda7c(0x266)](),config=getConfiguration(),io['to'](_0xbfda7c(0x1a2))['emit']('bots',config),broadcastToBots(_0xbfda7c(0x157),JSON[_0xbfda7c(0x293)](config));}function updateBotName(_0x43a8d2,_0x57033d){const _0x4e77e3=_0x21f322;dbConfig[_0x4e77e3(0x2c7)](_0x4e77e3(0x157))[_0x4e77e3(0x159)]({'botID':_0x43a8d2})['assign']({'botname':_0x57033d})[_0x4e77e3(0x266)](),config=getConfiguration(),io['to'](_0x4e77e3(0x1a2))[_0x4e77e3(0x2be)](_0x4e77e3(0x157),config),broadcastToBots(_0x4e77e3(0x157),JSON[_0x4e77e3(0x293)](config));}function updateBotManager(){const _0x326528=_0x21f322;config=getConfiguration(),io['to'](_0x326528(0x1a2))[_0x326528(0x2be)](_0x326528(0x157),config),broadcastToBots(_0x326528(0x157),JSON[_0x326528(0x293)](config));}function toggleBotMode(_0x5684e2){const _0x5a3f17=_0x21f322;if(pid[_0x5684e2])pid[_0x5684e2][_0x5a3f17(0x294)]({'function':_0x5a3f17(0x1d8),'args':null});else{const _0x1522a2=configpath+_0x5a3f17(0x26b)+_0x5684e2+'-config.json',_0x342f59=fs[_0x5a3f17(0xf4)](_0x1522a2),_0x2235cc=JSON['parse'](_0x342f59),_0x1f9807=_0x2235cc['bot'][0x0][_0x5a3f17(0x2e7)];_0x2235cc[_0x5a3f17(0x243)][0x0][_0x5a3f17(0x2e7)]=!_0x1f9807;const _0x342dcb=JSON[_0x5a3f17(0x293)](_0x2235cc,null,0x2);fs[_0x5a3f17(0x1f2)](_0x1522a2,_0x342dcb),config=getConfiguration(),io['to'](_0x5a3f17(0x1a2))['emit']('bots',config),broadcastToBots(_0x5a3f17(0x157),JSON[_0x5a3f17(0x293)](config));}}function validateTelegram(_0xe1fc0e){const _0x2a10cd=_0x21f322;if(_0xe1fc0e['from'][_0x2a10cd(0x2ba)]!=settings[_0x2a10cd(0x171)]&&'@'+_0xe1fc0e[_0x2a10cd(0x282)][_0x2a10cd(0x2ba)]!=settings[_0x2a10cd(0x171)]||_0xe1fc0e[_0x2a10cd(0x186)]['id']!=settings[_0x2a10cd(0x24d)])return sendTelegram(_0xe1fc0e[_0x2a10cd(0x186)]['id'],_0x2a10cd(0x2c2),{'parse_mode':_0x2a10cd(0x14b)}),![];return!![];}async function initTelegram(){const _0x4c1a17=_0x21f322;tgBot&&(await tgBot[_0x4c1a17(0x2a1)](),await sleep(0x7d0));tgBot=new Telegraf(settings['telegramToken']);let _0x3f56dd=_0x4c1a17(0x2fc);_0x3f56dd+='\x0a',_0x3f56dd+='/enable\x20-\x20enable\x20notifications\x0a',_0x3f56dd+=_0x4c1a17(0x23e),_0x3f56dd+=_0x4c1a17(0x2d6),_0x3f56dd+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x3f56dd+=_0x4c1a17(0x213),_0x3f56dd+=_0x4c1a17(0x259),_0x3f56dd+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x3f56dd+='/names\x20-\x20show\x20bot\x20names\x0a',_0x3f56dd+=_0x4c1a17(0x29c),_0x3f56dd+=_0x4c1a17(0x296),_0x3f56dd+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x3f56dd+='/logs\x20-\x20receive\x20log\x20files\x0a',_0x3f56dd+=_0x4c1a17(0x1b0),_0x3f56dd+=_0x4c1a17(0x16e),_0x3f56dd+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x3f56dd+=_0x4c1a17(0x122);let _0x4bb11b='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x4bb11b+='\x0a',_0x4bb11b+=_0x3f56dd,tgBot[_0x4c1a17(0x29e)]((_0x566022,_0x1046ff)=>{const _0x17a294=_0x4c1a17;logger[_0x17a294(0x2af)](getTimeStamp()+_0x17a294(0x280)),logger[_0x17a294(0x224)](_0x17a294(0x190),_0x566022);}),tgBot[_0x4c1a17(0x19a)](async(_0x95a2,_0xe09db5)=>{const _0x403798=_0x4c1a17;if(settings[_0x403798(0x24d)]||_0x95a2[_0x403798(0x205)][_0x403798(0x1ee)][_0x403798(0x156)]!=_0x403798(0x185)){if(!validateTelegram(_0x95a2))return;}_0xe09db5();}),tgBot[_0x4c1a17(0x2db)](_0x4c1a17(0x272),async _0x18cc91=>{const _0x27970e=_0x4c1a17;if(_0x18cc91['from']['username']==settings[_0x27970e(0x171)]||'@'+_0x18cc91[_0x27970e(0x282)][_0x27970e(0x2ba)]==settings[_0x27970e(0x171)]){if(!settings[_0x27970e(0x24d)])updateSetting(_0x27970e(0x24d),_0x18cc91['chat']['id']);else{if(!validateTelegram(_0x18cc91))return;}}else{if(!validateTelegram(_0x18cc91))return;}updateSetting(_0x27970e(0x22c),!![]),await sendTelegram(_0x18cc91[_0x27970e(0x186)]['id'],_0x4bb11b);}),tgBot[_0x4c1a17(0x2db)](_0x4c1a17(0x1e9),async _0x2b43af=>{const _0x3ddb03=_0x4c1a17;updateSetting(_0x3ddb03(0x22c),!![]),await sendTelegram(_0x2b43af[_0x3ddb03(0x186)]['id'],_0x3ddb03(0x10b));}),tgBot[_0x4c1a17(0x2db)](_0x4c1a17(0x2dc),async _0x5a128a=>{const _0x2f1751=_0x4c1a17;await sendTelegram(_0x5a128a[_0x2f1751(0x186)]['id'],'Notifications\x20disabled'),updateSetting('telegramEnabled',![]);}),tgBot[_0x4c1a17(0x2db)](_0x4c1a17(0x1f8),async _0x23ffb2=>{const _0x5c7203=_0x4c1a17,_0x1c51d5=Markup['inlineKeyboard']([Markup['button']['callback']('Orders',_0x5c7203(0x218)),Markup[_0x5c7203(0x14e)]['callback']('Alerts',_0x5c7203(0x289)),Markup[_0x5c7203(0x14e)][_0x5c7203(0x2c8)](_0x5c7203(0x10a),_0x5c7203(0x1a8))]);_0x23ffb2[_0x5c7203(0x1d7)](_0x5c7203(0x1fe),_0x1c51d5);}),tgBot[_0x4c1a17(0x2a8)](_0x4c1a17(0x218),async _0x3dfcb1=>{const _0xf43164=_0x4c1a17;_0x3dfcb1[_0xf43164(0x1d5)](),updateSetting('telegramEvents','orders'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x3dfcb1[_0xf43164(0x186)]['id'],_0xf43164(0x210));}),tgBot[_0x4c1a17(0x2a8)]('config_alerts',async _0x20d0b1=>{const _0x3d996e=_0x4c1a17;_0x20d0b1['editMessageReplyMarkup'](),updateSetting(_0x3d996e(0x2c3),_0x3d996e(0x231)),updateSetting(_0x3d996e(0x22c),!![]),await sendTelegram(_0x20d0b1[_0x3d996e(0x186)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x4c1a17(0x2a8)](_0x4c1a17(0x1a8),async _0x33406a=>{const _0x33854f=_0x4c1a17;_0x33406a['editMessageReplyMarkup'](),updateSetting(_0x33854f(0x2c3),'all'),updateSetting(_0x33854f(0x22c),!![]),await sendTelegram(_0x33406a[_0x33854f(0x186)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot['command'](_0x4c1a17(0x2ae),async _0x2a4264=>{const _0x321594=_0x4c1a17,_0x152928=getBotsWithMode();let _0x26fd66=_0x321594(0x2b7);config[_0x321594(0xf5)](_0x2cad47=>{const _0x1b47ec=_0x321594,_0x1df3d0=_0x152928['find'](_0x15e5ce=>_0x15e5ce[_0x1b47ec(0x1cf)]==_0x2cad47[_0x1b47ec(0x1cf)])[_0x1b47ec(0x1db)];_0x26fd66+=_0x1b47ec(0x139)+_0x2cad47[_0x1b47ec(0x1cf)]+':\x20'+_0x2cad47['status']+'\x20|\x20'+_0x1df3d0+_0x1b47ec(0x2b1)+_0x2cad47['live']+'\x0a';}),_0x26fd66+='\x0a',_0x26fd66+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x26fd66+=!settings[_0x321594(0x22c)]?_0x321594(0x1b1):_0x321594(0x128),_0x26fd66+=settings[_0x321594(0x22c)]?settings[_0x321594(0x2c3)]=='all'?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0x321594(0x2c3)]+'\x20only\x0a':'',await sendTelegram(_0x2a4264[_0x321594(0x186)]['id'],_0x26fd66,{'parse_mode':_0x321594(0x14b)});}),tgBot[_0x4c1a17(0x2db)](_0x4c1a17(0x236),async _0xe6e9e3=>{const _0x31b19e=_0x4c1a17,_0x4710af=getEnabledBots();if(_0x4710af['length']==0x0)await sendTelegram(_0xe6e9e3[_0x31b19e(0x186)]['id'],_0x31b19e(0x225));else{if(_0x4710af['length']>0x1)_0x4710af[_0x31b19e(0x134)]({'botID':_0x31b19e(0x1fa)});let _0x4cb56c=[],_0xba10fd=[];const _0x3570df=_0x4710af['length']%0x4==0x0||_0x4710af[_0x31b19e(0x146)]%0x4==0x3||_0x4710af[_0x31b19e(0x146)]%0x3==0x1?0x4:0x3;let _0x55237f=0x0;_0x4710af[_0x31b19e(0xf5)]((_0x500488,_0x5322ac)=>{const _0x5bcd2b=_0x31b19e;if(_0x5322ac%_0x3570df==0x0)_0xba10fd=[];_0xba10fd['push'](Markup['button'][_0x5bcd2b(0x2c8)](_0x500488[_0x5bcd2b(0x1cf)]==_0x5bcd2b(0x1fa)?_0x5bcd2b(0x2f6):_0x5bcd2b(0x139)+_0x500488[_0x5bcd2b(0x1cf)],_0x5bcd2b(0x1fc)+_0x500488[_0x5bcd2b(0x1cf)])),_0x5322ac%_0x3570df==0x0&&(_0x4cb56c[_0x55237f]=_0xba10fd,_0x55237f++);});const _0x3c93fb=Markup[_0x31b19e(0x20f)](_0x4cb56c);_0xe6e9e3[_0x31b19e(0x1d7)](_0x31b19e(0x19b),_0x3c93fb);}}),tgBot[_0x4c1a17(0x2a8)](/restart_(.+)/,async _0x2590e7=>{const _0x3906ef=_0x4c1a17,_0x5cb3bc=_0x2590e7[_0x3906ef(0x20e)][0x1];_0x2590e7[_0x3906ef(0x1d5)](),_0x5cb3bc==_0x3906ef(0x1fa)?config['forEach'](_0x34a108=>{restartBot(_0x34a108['botID']);}):restartBot(_0x5cb3bc);}),tgBot['command']('on',async _0x56c36b=>{const _0x93a439=_0x4c1a17,_0x43045d=getDisabledBots();if(_0x43045d[_0x93a439(0x146)]==0x0)await sendTelegram(_0x56c36b[_0x93a439(0x186)]['id'],_0x93a439(0x25d));else{if(_0x43045d[_0x93a439(0x146)]>0x1)_0x43045d[_0x93a439(0x134)]({'botID':_0x93a439(0x1fa)});let _0x160520=[],_0x126a79=[];const _0x4784a5=_0x43045d[_0x93a439(0x146)]%0x4==0x0||_0x43045d[_0x93a439(0x146)]%0x4==0x3||_0x43045d['length']%0x3==0x1?0x4:0x3;let _0x4dbef8=0x0;_0x43045d[_0x93a439(0xf5)]((_0x16f825,_0x40a080)=>{const _0x6a82d0=_0x93a439;if(_0x40a080%_0x4784a5==0x0)_0x126a79=[];_0x126a79[_0x6a82d0(0x134)](Markup['button'][_0x6a82d0(0x2c8)](_0x16f825[_0x6a82d0(0x1cf)]==_0x6a82d0(0x1fa)?_0x6a82d0(0x2f6):_0x6a82d0(0x139)+_0x16f825[_0x6a82d0(0x1cf)],_0x6a82d0(0x209)+_0x16f825['botID'])),_0x40a080%_0x4784a5==0x0&&(_0x160520[_0x4dbef8]=_0x126a79,_0x4dbef8++);});const _0x44e4ea=Markup[_0x93a439(0x20f)](_0x160520);_0x56c36b[_0x93a439(0x1d7)](_0x93a439(0x1c7),_0x44e4ea);}}),tgBot[_0x4c1a17(0x2a8)](/on_(.+)/,async _0x53d5bb=>{const _0x23a3b4=_0x4c1a17,_0x43e612=_0x53d5bb[_0x23a3b4(0x20e)][0x1];_0x53d5bb[_0x23a3b4(0x1d5)]();if(_0x43e612=='all'){const _0x1d9fb5=getDisabledBots();await sendTelegram(_0x53d5bb[_0x23a3b4(0x186)]['id'],_0x23a3b4(0x172)),_0x1d9fb5[_0x23a3b4(0xf5)](_0x4425cb=>{const _0x235e18=_0x23a3b4;if(_0x4425cb['botID']!='all')toggleBot(_0x4425cb[_0x235e18(0x1cf)],toggleStatus(_0x4425cb[_0x235e18(0x1cf)]),_0x235e18(0x250));});}else await sendTelegram(_0x53d5bb[_0x23a3b4(0x186)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x43e612),toggleBot(_0x43e612,toggleStatus(_0x43e612),_0x23a3b4(0x250));}),tgBot[_0x4c1a17(0x2db)](_0x4c1a17(0x1af),async _0x451eec=>{const _0x50d286=_0x4c1a17,_0x4cd1bb=getEnabledBots();if(_0x4cd1bb[_0x50d286(0x146)]==0x0)await sendTelegram(_0x451eec['chat']['id'],_0x50d286(0x225));else{if(_0x4cd1bb[_0x50d286(0x146)]>0x1)_0x4cd1bb[_0x50d286(0x134)]({'botID':_0x50d286(0x1fa)});let _0x23470c=[],_0x9475e5=[];const _0x2dabf5=_0x4cd1bb[_0x50d286(0x146)]%0x4==0x0||_0x4cd1bb[_0x50d286(0x146)]%0x4==0x3||_0x4cd1bb[_0x50d286(0x146)]%0x3==0x1?0x4:0x3;let _0x564a76=0x0;_0x4cd1bb[_0x50d286(0xf5)]((_0x2999c1,_0x1f9243)=>{const _0xfe1975=_0x50d286;if(_0x1f9243%_0x2dabf5==0x0)_0x9475e5=[];_0x9475e5['push'](Markup['button']['callback'](_0x2999c1[_0xfe1975(0x1cf)]==_0xfe1975(0x1fa)?_0xfe1975(0x2f6):_0xfe1975(0x139)+_0x2999c1['botID'],'off_'+_0x2999c1[_0xfe1975(0x1cf)])),_0x1f9243%_0x2dabf5==0x0&&(_0x23470c[_0x564a76]=_0x9475e5,_0x564a76++);});const _0x27ec8d=Markup[_0x50d286(0x20f)](_0x23470c);_0x451eec[_0x50d286(0x1d7)](_0x50d286(0x155),_0x27ec8d);}}),tgBot[_0x4c1a17(0x2a8)](/off_(.+)/,async _0x18050d=>{const _0x4d27cd=_0x4c1a17,_0x3c0bf9=_0x18050d[_0x4d27cd(0x20e)][0x1];_0x18050d[_0x4d27cd(0x1d5)]();if(_0x3c0bf9==_0x4d27cd(0x1fa)){const _0x281ce2=getEnabledBots();await sendTelegram(_0x18050d[_0x4d27cd(0x186)]['id'],_0x4d27cd(0x17a)),_0x281ce2[_0x4d27cd(0xf5)](_0x427690=>{const _0x56848b=_0x4d27cd;if(_0x427690[_0x56848b(0x1cf)]!=_0x56848b(0x1fa))toggleBot(_0x427690['botID'],toggleStatus(_0x427690['botID']),_0x56848b(0x250));});}else await sendTelegram(_0x18050d['chat']['id'],_0x4d27cd(0x1c4)+_0x3c0bf9),toggleBot(_0x3c0bf9,toggleStatus(_0x3c0bf9),_0x4d27cd(0x250));}),tgBot[_0x4c1a17(0x2db)](_0x4c1a17(0x123),async _0x34d213=>{const _0x26cdee=_0x4c1a17,_0x2576e2=getEnabledBots();if(_0x2576e2['length']==0x0)await sendTelegram(_0x34d213[_0x26cdee(0x186)]['id'],_0x26cdee(0x225));else{if(_0x2576e2[_0x26cdee(0x146)]>0x1){let _0x10b5d0=[],_0x16b2da=[];const _0x5c601a=_0x2576e2[_0x26cdee(0x146)]%0x4==0x0||_0x2576e2[_0x26cdee(0x146)]%0x4==0x3||_0x2576e2['length']%0x3==0x1?0x4:0x3;let _0x5896c5=0x0;_0x2576e2[_0x26cdee(0xf5)]((_0x3325e5,_0x413f86)=>{const _0x5d87c0=_0x26cdee;if(_0x413f86%_0x5c601a==0x0)_0x16b2da=[];_0x16b2da[_0x5d87c0(0x134)](Markup[_0x5d87c0(0x14e)]['callback'](_0x5d87c0(0x139)+_0x3325e5[_0x5d87c0(0x1cf)],'metrics_'+_0x3325e5['botID'])),_0x413f86%_0x5c601a==0x0&&(_0x10b5d0[_0x5896c5]=_0x16b2da,_0x5896c5++);});const _0x4f67e5=Markup[_0x26cdee(0x20f)](_0x10b5d0);_0x34d213[_0x26cdee(0x1d7)](_0x26cdee(0x2b5),_0x4f67e5);}else{const _0x56b0a9=_0x2576e2[0x0][_0x26cdee(0x1cf)];if(pid[_0x56b0a9])pid[_0x56b0a9][_0x26cdee(0x294)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x3e720d=>{const _0x2ab171=_0x4c1a17,_0x35e96a=_0x3e720d[_0x2ab171(0x20e)][0x1];_0x3e720d[_0x2ab171(0x1d5)]();if(pid[_0x35e96a])pid[_0x35e96a][_0x2ab171(0x294)]({'function':'sendMetricsTelegram','args':null});}),tgBot['command'](_0x4c1a17(0x161),async _0x27d532=>{const _0x2dc850=_0x4c1a17,_0x4f453e=getEnabledBots();if(_0x4f453e[_0x2dc850(0x146)]==0x0)await sendTelegram(_0x27d532[_0x2dc850(0x186)]['id'],_0x2dc850(0x225));else{if(_0x4f453e[_0x2dc850(0x146)]>0x1){let _0x4f2c6b=[],_0x4e1447=[];const _0x25a2ef=_0x4f453e['length']%0x4==0x0||_0x4f453e[_0x2dc850(0x146)]%0x4==0x3||_0x4f453e[_0x2dc850(0x146)]%0x3==0x1?0x4:0x3;let _0x555103=0x0;_0x4f453e[_0x2dc850(0xf5)]((_0x35692f,_0x1f4386)=>{const _0x490169=_0x2dc850;if(_0x1f4386%_0x25a2ef==0x0)_0x4e1447=[];_0x4e1447['push'](Markup['button'][_0x490169(0x2c8)](_0x490169(0x139)+_0x35692f[_0x490169(0x1cf)],_0x490169(0x1e1)+_0x35692f['botID'])),_0x1f4386%_0x25a2ef==0x0&&(_0x4f2c6b[_0x555103]=_0x4e1447,_0x555103++);});const _0x5a45ae=Markup[_0x2dc850(0x20f)](_0x4f2c6b);_0x27d532[_0x2dc850(0x1d7)](_0x2dc850(0x170),_0x5a45ae);}else{const _0x5cb151=_0x4f453e[0x0][_0x2dc850(0x1cf)];if(pid[_0x5cb151])pid[_0x5cb151]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x13f834=>{const _0x1ed22a=_0x4c1a17,_0x498a91=_0x13f834['match'][0x1];_0x13f834[_0x1ed22a(0x1d5)]();if(pid[_0x498a91])pid[_0x498a91][_0x1ed22a(0x294)]({'function':_0x1ed22a(0x14a),'args':null});}),tgBot['command']('logs',async _0xb6b554=>{const _0x1c8001=_0x4c1a17,_0x2df813=_0x1c8001(0x140);await zipFiles(_0x2df813);const _0x25926c=zippath+(_0x2df813+_0x1c8001(0x2e0));_0xb6b554[_0x1c8001(0x13e)]({'source':_0x25926c})[_0x1c8001(0x2e3)](()=>{})['catch'](_0x3567e6=>logger[_0x1c8001(0x224)](_0x1c8001(0x22d)+_0x2df813+_0x1c8001(0x22a),_0x3567e6));}),tgBot['command']('backup',async _0x3aba6c=>{const _0x383adb=_0x4c1a17,_0x10af77='backup';await backupConfigFiles(),await zipFiles(_0x10af77);const _0xeeae24=zippath+(_0x10af77+_0x383adb(0x2e0));_0x3aba6c[_0x383adb(0x13e)]({'source':_0xeeae24})[_0x383adb(0x2e3)](()=>{})[_0x383adb(0x29e)](_0x2468b8=>logger['debug'](_0x383adb(0x22d)+_0x10af77+_0x383adb(0x22a),_0x2468b8));}),tgBot[_0x4c1a17(0x2db)]('update',async _0x235a76=>{const _0x213913=_0x4c1a17;await getMessages();if(!updateAvailable)await sendTelegram(_0x235a76[_0x213913(0x186)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x235a76[_0x213913(0x186)]['id'],_0x213913(0x118));else{const _0x4b01bf=Markup[_0x213913(0x20f)]([Markup[_0x213913(0x14e)][_0x213913(0x2c8)](_0x213913(0x1a1),'update_yes'),Markup[_0x213913(0x14e)][_0x213913(0x2c8)]('No',_0x213913(0x2a3))]);_0x235a76['reply'](_0x213913(0x145),_0x4b01bf);}}}),tgBot[_0x4c1a17(0x2a8)](/update_(.+)/,async _0x19e4c9=>{const _0x5751bd=_0x4c1a17,_0x4e51a4=_0x19e4c9['match'][0x1];_0x19e4c9['editMessageReplyMarkup'](),_0x4e51a4==_0x5751bd(0x184)&&(await sendTelegram(_0x19e4c9['chat']['id'],_0x5751bd(0x111)),updateBB('update')),_0x4e51a4=='no'&&await sendTelegram(_0x19e4c9['chat']['id'],_0x5751bd(0xf8));}),tgBot[_0x4c1a17(0x2db)](_0x4c1a17(0x164),async _0x24b556=>{const _0xf19b79=_0x4c1a17;if(!validInstallation)await sendTelegram(_0x24b556[_0xf19b79(0x186)]['id'],_0xf19b79(0x11a));else{const _0x32a2ee=Markup[_0xf19b79(0x20f)]([Markup[_0xf19b79(0x14e)]['callback'](_0xf19b79(0x1a1),_0xf19b79(0x1ea)),Markup[_0xf19b79(0x14e)][_0xf19b79(0x2c8)]('No','reinstall_no')]);_0x24b556[_0xf19b79(0x1d7)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x32a2ee);}}),tgBot[_0x4c1a17(0x2a8)](/reinstall_(.+)/,async _0x51b2bb=>{const _0x443bce=_0x4c1a17,_0x106382=_0x51b2bb[_0x443bce(0x20e)][0x1];_0x51b2bb[_0x443bce(0x1d5)](),_0x106382==_0x443bce(0x184)&&(await sendTelegram(_0x51b2bb['chat']['id'],_0x443bce(0x28e)),updateBB('reinstall')),_0x106382=='no'&&await sendTelegram(_0x51b2bb['chat']['id'],_0x443bce(0x2c6));}),tgBot[_0x4c1a17(0x2db)](_0x4c1a17(0x222),async _0x26e48a=>{const _0x257964=_0x4c1a17,_0x1a15ca=getBotsWithMode();if(_0x1a15ca[_0x257964(0x146)]==0x0)await sendTelegram(_0x26e48a[_0x257964(0x186)]['id'],_0x257964(0x225));else{let _0x3ca4a4=[],_0x38e195=[];const _0x32d9cb=0x2;let _0x2501e1=0x0;_0x1a15ca[_0x257964(0xf5)]((_0x3ca69b,_0x594672)=>{const _0x5a4b7f=_0x257964;if(_0x594672%_0x32d9cb==0x0)_0x38e195=[];_0x38e195[_0x5a4b7f(0x134)](Markup[_0x5a4b7f(0x14e)][_0x5a4b7f(0x2c8)](_0x5a4b7f(0x139)+_0x3ca69b[_0x5a4b7f(0x1cf)]+'\x20('+_0x3ca69b[_0x5a4b7f(0x1db)]+')',_0x5a4b7f(0x1d9)+_0x3ca69b[_0x5a4b7f(0x1cf)])),_0x594672%_0x32d9cb==0x0&&(_0x3ca4a4[_0x2501e1]=_0x38e195,_0x2501e1++);});const _0x4a5982=Markup['inlineKeyboard'](_0x3ca4a4);_0x26e48a[_0x257964(0x1d7)](_0x257964(0x2c4),_0x4a5982);}}),tgBot['action'](/toggle_(.+)/,async _0x2880e2=>{const _0x11c253=_0x4c1a17,_0x2c1ac2=_0x2880e2['match'][0x1];_0x2880e2[_0x11c253(0x1d5)]();const _0x9989ea=getBotsWithMode(),_0x51f3a8=_0x9989ea[_0x11c253(0x159)](_0x38a584=>_0x38a584[_0x11c253(0x1cf)]==_0x2c1ac2),_0x5142f7=_0x51f3a8[_0x11c253(0x1db)]=='auto'?'manual':'auto';await sendTelegram(_0x2880e2[_0x11c253(0x186)]['id'],_0x11c253(0x19d)+_0x2c1ac2+_0x11c253(0x25e)+_0x5142f7+_0x11c253(0x14d)),toggleBotMode(_0x2c1ac2);}),tgBot[_0x4c1a17(0x2db)](_0x4c1a17(0x232),async _0x3acc85=>{const _0x18a857=_0x4c1a17;let _0xed81cf='';config['forEach'](_0x1af058=>{const _0x43920d=_0x4fb0;_0xed81cf+=_0x43920d(0x139)+_0x1af058[_0x43920d(0x1cf)]+':\x20'+_0x1af058['botname']+'\x0a';}),await sendTelegram(_0x3acc85[_0x18a857(0x186)]['id'],_0xed81cf,{'parse_mode':_0x18a857(0x14b)});}),tgBot[_0x4c1a17(0x2db)](_0x4c1a17(0x116),async _0x447614=>{const _0x4f0971=_0x4c1a17;await sendTelegram(_0x447614[_0x4f0971(0x186)]['id'],_0x3f56dd);}),process[_0x4c1a17(0x22f)](_0x4c1a17(0x249),()=>tgBot['stop']('SIGINT')),process[_0x4c1a17(0x22f)]('SIGTERM',()=>tgBot['stop'](_0x4c1a17(0x2b8))),tgBot['launch']();}function disableTelegram(){const _0x4e3097=_0x21f322;tgBot&&tgBot[_0x4e3097(0x2a1)]();}async function sendTelegram(_0x352f2d,_0x506e1c,_0x401196){const _0x39e54e=_0x21f322;_0x401196={..._0x401196,'disable_web_page_preview':!![]};try{await tgBot[_0x39e54e(0x1d2)][_0x39e54e(0x152)](_0x352f2d,_0x506e1c,_0x401196);}catch(_0x1b60f6){logger['debug']('Telegram\x20error:',_0x1b60f6);}}async function sendTelegramBot(_0x52cc13,_0x5648cd){const _0x38e70=_0x21f322;if(settings['telegramEnabled']){if(settings[_0x38e70(0x2c3)]==_0x38e70(0x1fa)||(_0x5648cd['type']=='error'||_0x5648cd[_0x38e70(0x297)]==_0x38e70(0x115)||_0x5648cd[_0x38e70(0x297)]==_0x38e70(0x2df))&&settings[_0x38e70(0x2c3)]==_0x38e70(0x231)||_0x5648cd[_0x38e70(0x297)]==_0x38e70(0x104)&&settings[_0x38e70(0x2c3)]==_0x38e70(0x129)){if(tgBot&&settings[_0x38e70(0x24d)]){if(_0x5648cd[_0x38e70(0x28d)])await sendTelegram(settings['telegramChatId'],_0x5648cd[_0x38e70(0x28b)]+_0x38e70(0x2e4)+_0x5648cd[_0x38e70(0x1f4)]);else await sendTelegram(settings[_0x38e70(0x24d)],_0x38e70(0x139)+_0x52cc13+'\x20>\x20'+_0x5648cd[_0x38e70(0x1f4)]);}}}}async function sendTelegramMsg(_0x559571,_0x4a3f60=_0x21f322(0x14b)){const _0x177efe=_0x21f322;return settings['telegramEnabled']&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x177efe(0x24d)],_0x559571,{'parse_mode':_0x4a3f60}),!![]):![];}function getDeviceWithIp(_0x5ac6b4){const _0x3d7b94=_0x21f322;return devices[_0x3d7b94(0x159)](_0x4d79b2=>_0x4d79b2['ip']===_0x5ac6b4);}async function temporaryAccess2FA(_0x9e405f,_0xcf52f7){const _0x5cafb0=_0x21f322;let _0x7a488f=new Date(),_0x138eee=![];if(lastIpApproval){if(_0x7a488f-lastIpApproval<0x1388)_0x138eee=!![];}lastIpApproval=new Date();if(_0x138eee)return;if(tgBot&&settings[_0x5cafb0(0x24d)]){const _0x5a09b0=uuidRandom();tmpStorage[_0x5a09b0]={'uuid':_0x9e405f,'externalip':_0xcf52f7};const _0x468efa=Markup[_0x5cafb0(0x20f)]([Markup[_0x5cafb0(0x14e)][_0x5cafb0(0x2c8)]('5\x20min',_0x5cafb0(0x1a4)+_0x5a09b0),Markup[_0x5cafb0(0x14e)]['callback'](_0x5cafb0(0x254),_0x5cafb0(0x23d)+_0x5a09b0),Markup[_0x5cafb0(0x14e)][_0x5cafb0(0x2c8)]('30\x20min',_0x5cafb0(0x28c)+_0x5a09b0),Markup[_0x5cafb0(0x14e)]['callback']('reject',_0x5cafb0(0x11c)+_0x5a09b0)]);await sendTelegram(settings[_0x5cafb0(0x24d)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0xcf52f7)[_0x5cafb0(0x194)]+'\x20?',_0x468efa),tgBot[_0x5cafb0(0x2a8)](/tempaccess_(.+)_(.+)/,async _0x39e67a=>{const _0xb713e4=_0x5cafb0,_0x370cba=_0x39e67a[_0xb713e4(0x20e)][0x1],_0x5ab402=_0x39e67a[_0xb713e4(0x20e)][0x2],{uuid:_0x50fb1f,externalip:_0x5a9215}=tmpStorage[_0x5ab402];delete tmpStorage[_0x5ab402],_0x39e67a[_0xb713e4(0x1d5)](),devices[_0x50fb1f][_0xb713e4(0x1e2)]={'clientip':_0x5a9215,'timestamp':new Date()[_0xb713e4(0x1ff)](),'expiry':_0x370cba},_0x370cba!=_0xb713e4(0x13b)?(await sendTelegram(_0x39e67a[_0xb713e4(0x186)]['id'],_0xb713e4(0x2a9)+_0x370cba+'\x20minutes',{'parse_mode':_0xb713e4(0x14b)}),io['to'](_0x50fb1f)[_0xb713e4(0x2be)](_0xb713e4(0x2ae),{'access':{'allow':![],'reason':_0xb713e4(0x2d4),'token':null}})):(await sendTelegram(_0x39e67a[_0xb713e4(0x186)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x50fb1f)['emit'](_0xb713e4(0x2ae),{'access':{'allow':![],'reason':_0xb713e4(0x114),'token':null}}));});}}async function loginAccess2FA(_0x5a84df,_0x20da1b){const _0x699d02=_0x21f322;if(tgBot&&settings[_0x699d02(0x24d)]){const _0x2a2d2f=uuidRandom();tmpStorage[_0x2a2d2f]={'uuid':_0x5a84df,'externalip':_0x20da1b};const _0x16154b=Markup[_0x699d02(0x20f)]([Markup[_0x699d02(0x14e)][_0x699d02(0x2c8)](_0x699d02(0x28f),_0x699d02(0x181)+loginExpiry+'_'+_0x2a2d2f),Markup[_0x699d02(0x14e)][_0x699d02(0x2c8)](_0x699d02(0x13b),_0x699d02(0x2bf)+_0x2a2d2f)]);await sendTelegram(settings['telegramChatId'],_0x699d02(0x24c)+normalizeIP(_0x20da1b)[_0x699d02(0x194)]+'\x20?',_0x16154b),tgBot[_0x699d02(0x2a8)](/login2fa_(.+)_(.+)/,async _0xdd705e=>{const _0x521a06=_0x699d02,_0x68f6f5=_0xdd705e[_0x521a06(0x20e)][0x1],_0x214224=_0xdd705e['match'][0x2],{uuid:_0x25c7fc,externalip:_0x238e8a}=tmpStorage[_0x214224];delete tmpStorage[_0x214224],_0xdd705e['editMessageReplyMarkup'](),devices[_0x25c7fc]['telegram2FaApproval']={'clientip':_0x238e8a,'timestamp':new Date()[_0x521a06(0x1ff)](),'expiry':_0x68f6f5},_0x68f6f5!=_0x521a06(0x13b)?(await sendTelegram(_0xdd705e[_0x521a06(0x186)]['id'],_0x521a06(0x1ed),{'parse_mode':_0x521a06(0x14b)}),io['to'](_0x25c7fc)[_0x521a06(0x2be)](_0x521a06(0x2ae),{'access':{'allow':![],'reason':_0x521a06(0x2d4),'token':null}})):(await sendTelegram(_0xdd705e[_0x521a06(0x186)]['id'],_0x521a06(0x2ab)),io['to'](_0x25c7fc)[_0x521a06(0x2be)]('status',{'access':{'allow':![],'reason':_0x521a06(0xfc),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x3e8248=_0x21f322;return dbConfig[_0x3e8248(0x2c7)](_0x3e8248(0x157))[_0x3e8248(0x2e8)](_0x3e8248(0x1cf))[_0x3e8248(0x169)]({'status':_0x3e8248(0x22b)})[_0x3e8248(0x252)]()||[];}function getDisabledBots(){const _0x1079d5=_0x21f322;return dbConfig[_0x1079d5(0x2c7)](_0x1079d5(0x157))[_0x1079d5(0x2e8)](_0x1079d5(0x1cf))[_0x1079d5(0x169)]({'status':_0x1079d5(0x12e)})[_0x1079d5(0x252)]()||[];}function getBotAttributes(_0x5b082d){const _0x3c571e=_0x21f322;let _0x54ac5b={};const _0x4fa4c8=configpath+_0x3c571e(0x26b)+_0x5b082d+_0x3c571e(0x2da),_0x253be6=fs['existsSync'](_0x4fa4c8);if(_0x253be6){const _0x55359c=fs[_0x3c571e(0xf4)](_0x4fa4c8);try{const _0xb93f09=JSON[_0x3c571e(0x207)](_0x55359c),_0x4f2873=_0xb93f09?_0xb93f09[_0x3c571e(0x243)][0x0][_0x3c571e(0x2e7)]:![];_0x54ac5b['mode']=_0x4f2873?'auto':_0x3c571e(0x2fa),_0x54ac5b[_0x3c571e(0x28b)]=_0xb93f09?_0xb93f09[_0x3c571e(0x243)][0x0][_0x3c571e(0x28b)]:_0x3c571e(0x139)+_0x5b082d;}catch(_0x114b58){_0x54ac5b[_0x3c571e(0x1db)]=_0x3c571e(0x2fa),_0x54ac5b['botname']='Bot\x20'+_0x5b082d;}}else _0x54ac5b[_0x3c571e(0x1db)]=_0x3c571e(0x2fa),_0x54ac5b[_0x3c571e(0x28b)]='Bot\x20'+_0x5b082d;return _0x54ac5b;}function getBotsWithMode(){const _0xdddf9c=_0x21f322,_0xa6b615=dbConfig[_0xdddf9c(0x2c7)]('bots')[_0xdddf9c(0x2e8)](_0xdddf9c(0x1cf))[_0xdddf9c(0x252)]()||[];return _0xa6b615[_0xdddf9c(0xf5)](_0x2a9e27=>{const _0x2b3866=_0xdddf9c;let _0x4cea36=getBotAttributes(_0x2a9e27[_0x2b3866(0x1cf)]);_0x2a9e27[_0x2b3866(0x1db)]=_0x4cea36[_0x2b3866(0x1db)];}),_0xa6b615;}function getBotExchanges(){const _0x20773b=_0x21f322;let _0x511515=[];const _0x224aad=dbConfig[_0x20773b(0x2c7)](_0x20773b(0x157))[_0x20773b(0x2e8)](_0x20773b(0x1cf))[_0x20773b(0x252)]()||[];_0x224aad[_0x20773b(0xf5)](_0x579b6d=>{const _0x1cac2a=_0x20773b;if(_0x579b6d[_0x1cac2a(0x2ae)]=='enabled'){const _0x1bcda6=configpath+_0x1cac2a(0x26b)+_0x579b6d[_0x1cac2a(0x1cf)]+_0x1cac2a(0x2da),_0x512cfa=fs['existsSync'](_0x1bcda6);let _0x270a5d;if(_0x512cfa){const _0x28e31a=fs['readFileSync'](_0x1bcda6);try{const _0x4622fe=JSON[_0x1cac2a(0x207)](_0x28e31a);_0x270a5d=_0x4622fe?_0x4622fe[_0x1cac2a(0x243)][0x0][_0x1cac2a(0x1bb)]:null;}catch(_0x454293){}}if(_0x270a5d)_0x511515[_0x1cac2a(0x134)](_0x270a5d);}});const _0x5425f8=[...new Set(_0x511515)][_0x20773b(0x141)]();return _0x5425f8;}async function initUser(){const _0x570d42=_0x21f322;if(!settings['userid']){const _0xeb9224=uuidRandom();mixpanel[_0x570d42(0x1b3)](_0xeb9224),updateSetting('userid',_0xeb9224);}}async function initSecure(){const _0x5495ea=_0x21f322;let _0x5399a9=getSecure();if(!_0x5399a9[_0x5495ea(0x2d3)]('secret')){let _0x52471c=await generateKeys();_0x5399a9['publicKey']=_0x52471c[_0x5495ea(0x2bc)],_0x5399a9[_0x5495ea(0x204)]=_0x52471c[_0x5495ea(0x204)],_0x5399a9[_0x5495ea(0x27c)]=crypto['randomBytes'](0x20)['toString'](_0x5495ea(0x235));;storeSecure(_0x5399a9);}}function getSettings(){const _0x21a493=_0x21f322;return dbSettings[_0x21a493(0x2c7)]('settings')[_0x21a493(0x252)]()||{};}function getSecure(){const _0x3e2565=_0x21f322;return dbSecure[_0x3e2565(0x2c7)]('secure')[_0x3e2565(0x252)]()||{};}function getBlacklist(){const _0x9b08c1=_0x21f322;return dbSecure[_0x9b08c1(0x2c7)](_0x9b08c1(0x127))[_0x9b08c1(0x252)]()||[];}function broadcastToBots(_0x3edf1b,_0x36b2d0){const _0x3e4f25=_0x21f322;config[_0x3e4f25(0xf5)](_0x5e2b0c=>{const _0x58430f=_0x3e4f25;if(_0x5e2b0c[_0x58430f(0x2ae)]==_0x58430f(0x22b)&&_0x5e2b0c[_0x58430f(0x300)]=='running'||_0x5e2b0c['status']==_0x58430f(0x107)&&_0x5e2b0c['live']==_0x58430f(0x273)){if(pid[_0x5e2b0c[_0x58430f(0x1cf)]])pid[_0x5e2b0c[_0x58430f(0x1cf)]][_0x58430f(0x294)]({[_0x3edf1b]:_0x36b2d0});}});}async function storeSettings(_0x22572b,_0x1d42a5=![]){const _0x15b5b4=_0x21f322;_0x22572b={...settings,..._0x22572b};if(_0x1d42a5&&_0x22572b['bbPassword']!=_0x15b5b4(0x1ad)&&_0x22572b[_0x15b5b4(0x20c)]!='***'&&_0x22572b[_0x15b5b4(0x20c)]!=''){const _0x19db56=decryptRSA(secure['privateKey'],_0x22572b['bbPassword'])[_0x15b5b4(0x2ca)]('|@|')[0x0],_0x585868=bcrypt[_0x15b5b4(0x25b)](_0x19db56,saltRounds);_0x22572b={..._0x22572b,'bbPassword':_0x585868};}if(_0x1d42a5&&_0x22572b[_0x15b5b4(0x11b)]!='************'&&_0x22572b[_0x15b5b4(0x11b)]!=_0x15b5b4(0x1b2)&&_0x22572b[_0x15b5b4(0x11b)]!=''){const _0x472a6d=decryptRSA(secure[_0x15b5b4(0x204)],_0x22572b[_0x15b5b4(0x11b)])[_0x15b5b4(0x2ca)](_0x15b5b4(0x15f))[0x0];_0x22572b={..._0x22572b,'telegramToken':_0x472a6d};}if(_0x1d42a5&&_0x22572b[_0x15b5b4(0x2a7)]!='************'&&_0x22572b[_0x15b5b4(0x2a7)]!='***'&&_0x22572b[_0x15b5b4(0x2a7)]!=''){const _0x2f84b9=decryptRSA(secure[_0x15b5b4(0x204)],_0x22572b[_0x15b5b4(0x2a7)])[_0x15b5b4(0x2ca)](_0x15b5b4(0x15f))[0x0];_0x22572b={..._0x22572b,'marketcapApi':_0x2f84b9};}const _0x1e38b1=_0x22572b[_0x15b5b4(0x11b)]!='************'&&_0x22572b[_0x15b5b4(0x11b)]!=settings['telegramToken']||_0x22572b[_0x15b5b4(0x171)]!=settings[_0x15b5b4(0x171)],_0xa69573=_0x22572b['telegramToken']==''||_0x22572b[_0x15b5b4(0x171)]=='',_0x1b91d0=_0x22572b[_0x15b5b4(0x2a7)]&&_0x22572b['marketcapApi']!=_0x15b5b4(0x1ad)&&_0x22572b['marketcapApi']!=settings['marketcapApi'];_0x1e38b1&&(_0x22572b[_0x15b5b4(0x24d)]=null,_0x22572b[_0x15b5b4(0x2c3)]='all');for(const [_0x2ca96e,_0xa99e4d]of Object['entries'](_0x22572b)){if(_0x2ca96e==_0x15b5b4(0x11b)&&_0xa99e4d==_0x15b5b4(0x1ad)){_0x22572b['telegramToken']=settings['telegramToken'];continue;};if(_0x2ca96e==_0x15b5b4(0x20c)&&_0xa99e4d==_0x15b5b4(0x1ad)){_0x22572b[_0x15b5b4(0x20c)]=settings[_0x15b5b4(0x20c)];continue;};if(_0x2ca96e=='marketcapApi'&&_0xa99e4d==_0x15b5b4(0x1ad)){_0x22572b[_0x15b5b4(0x2a7)]=settings['marketcapApi'];continue;};dbSettings[_0x15b5b4(0x125)]('settings.'+_0x2ca96e,_0xa99e4d)[_0x15b5b4(0x266)]();}settings=_0x22572b,io['to'](_0x15b5b4(0x1a2))['emit']('settings',cleanSettings()),broadcastToBots(_0x15b5b4(0xee),settings[_0x15b5b4(0xee)]),broadcastToBots(_0x15b5b4(0x14c),settings[_0x15b5b4(0x14c)]),broadcastToBots(_0x15b5b4(0x2a7),settings[_0x15b5b4(0x2a7)]);if(_0x1e38b1&&!_0xa69573)initTelegram();_0x1e38b1&&_0xa69573&&(updateSetting('telegramChatId',null),disableTelegram()),getAllClients()['forEach'](_0x3384d3=>{const _0x927fbd=_0x15b5b4;getSocket(_0x3384d3['id'])[_0x927fbd(0x2be)]('status',{'access':{'allow':![],'reason':_0x927fbd(0x2d4),'token':null}});}),_0x1b91d0&&(await sleep(0xbb8),testMarketcapApi(_0x22572b[_0x15b5b4(0x2a7)]));}async function testMarketcapApi(_0x32a1d7){const _0x1fd0c0=_0x21f322,_0x27f1c2=[_0x1fd0c0(0x1d1),_0x1fd0c0(0x2e9)];try{await axios[_0x1fd0c0(0x2c7)](_0x1fd0c0(0xf1),{'headers':{'X-CMC_PRO_API_KEY':_0x32a1d7},'params':{'symbol':_0x27f1c2[_0x1fd0c0(0x2f4)]()}});}catch(_0x3a083a){_0x3a083a[_0x1fd0c0(0x2f4)]()[_0x1fd0c0(0x2a0)](_0x1fd0c0(0x276))?(io['to'](_0x1fd0c0(0x1a2))['emit'](_0x1fd0c0(0x217),_0x1fd0c0(0xef)),logger[_0x1fd0c0(0x13f)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x1fd0c0(0x1a2))[_0x1fd0c0(0x2be)]('notification',_0x1fd0c0(0x261)),logger['full']('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x1fd0c0(0x224)]('Error\x20details:',_0x3a083a['toString']()+_0x1fd0c0(0x162)+_0x3a083a[_0x1fd0c0(0x1ac)]));return;}logger[_0x1fd0c0(0x224)](_0x1fd0c0(0x183));}function updateSetting(_0x5eafa2,_0x55b749){const _0x3f78ac=_0x21f322;dbSettings['set'](_0x3f78ac(0x257)+_0x5eafa2,_0x55b749)[_0x3f78ac(0x266)](),settings=getSettings(),io['to'](_0x3f78ac(0x1a2))[_0x3f78ac(0x2be)]('settings',cleanSettings());}function storeSecure(_0x399ad3){const _0x1a8422=_0x21f322;dbSecure[_0x1a8422(0x2c7)](_0x1a8422(0x20b))[_0x1a8422(0x134)](_0x399ad3)[_0x1a8422(0x266)](),secure=_0x399ad3;}function addBlacklist(_0x18e9cc){const _0x276d88=_0x21f322;cleanBlacklist();let _0x339228;devices[_0x18e9cc]['telegramIpApproval']?_0x339228=Math[_0x276d88(0x281)](devices[_0x18e9cc][_0x276d88(0x1e2)][_0x276d88(0x241)],loginExpiry):_0x339228=loginExpiry,dbSecure['get'](_0x276d88(0x127))['push']({'expiry':new Date()['getTime']()+_0x339228*0x3c*0x3e8,'token':devices[_0x18e9cc][_0x276d88(0x13d)][_0x276d88(0x1c9)]})[_0x276d88(0x266)](),blacklist=dbSecure['get'](_0x276d88(0x127))[_0x276d88(0x252)]();}function cleanBlacklist(){const _0xfccdda=_0x21f322;let _0x55945d=dbSecure[_0xfccdda(0x2c7)](_0xfccdda(0x127))['cloneDeep']()['value'](),_0x241ab9=new Date()[_0xfccdda(0x1ff)]();_0x55945d['forEach'](_0x2dcae4=>{const _0x4fea8c=_0xfccdda;_0x2dcae4[_0x4fea8c(0x241)]<_0x241ab9&&dbSecure[_0x4fea8c(0x2c7)](_0x4fea8c(0x127))[_0x4fea8c(0x2ac)]({'expiry':_0x2dcae4[_0x4fea8c(0x241)]})[_0x4fea8c(0x266)]();});}function initStates(){const _0x2f16a6=_0x21f322;let _0x3847c4=getConfiguration();_0x3847c4[_0x2f16a6(0xf5)](_0xdf1840=>{const _0xb22273=_0x2f16a6;_0xdf1840[_0xb22273(0x300)]=_0xb22273(0x250);}),storeConfiguration(_0x3847c4);}async function generateKeys(){const _0x4a016a=_0x21f322,_0x4eac7a=forge[_0x4a016a(0x113)][_0x4a016a(0x2d7)]['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x31c56e=forge[_0x4a016a(0x113)][_0x4a016a(0x2c9)](_0x4eac7a[_0x4a016a(0x204)]),_0x1a665a=forge['pki'][_0x4a016a(0x1c5)](_0x4eac7a[_0x4a016a(0x2bc)]);return{'privateKey':_0x31c56e,'publicKey':_0x1a665a};}async function oneTimeMigration(){const _0x5a1a82=_0x21f322;let _0x31229e=getSettings(),_0x388496=![];!_0x31229e[_0x5a1a82(0x2d3)]('lastmsgtelegram')&&(_0x31229e[_0x5a1a82(0x288)]=0x0,_0x388496=!![]);!_0x31229e[_0x5a1a82(0x2d3)](_0x5a1a82(0x298))&&(_0x31229e['lastmsgemitted']=0x0,_0x388496=!![]);!_0x31229e[_0x5a1a82(0x2d3)](_0x5a1a82(0x2a4))&&(_0x31229e['latestversion']=_0x5a1a82(0x1dd),_0x388496=!![]);!_0x31229e[_0x5a1a82(0x2d3)](_0x5a1a82(0x14c))&&(_0x31229e[_0x5a1a82(0x14c)]=![],_0x388496=!![]);!_0x31229e[_0x5a1a82(0x2d3)](_0x5a1a82(0x2a7))&&(_0x31229e[_0x5a1a82(0x2a7)]='',_0x388496=!![]);if(_0x388496)storeSettings(_0x31229e);try{fs[_0x5a1a82(0x2aa)](configbackuppath,{'withFileTypes':!![]})[_0x5a1a82(0xf5)](_0x108c6d=>{const _0x46a8e2=_0x5a1a82;if(!_0x108c6d['isDirectory']()){if(!_0x108c6d[_0x46a8e2(0x188)][_0x46a8e2(0x2fb)](_0x46a8e2(0x211)))fs[_0x46a8e2(0x2ff)](configbackuppath+_0x108c6d[_0x46a8e2(0x188)]);}else fs[_0x46a8e2(0x163)](configbackuppath+_0x108c6d[_0x46a8e2(0x188)],{'recursive':!![]});});}catch(_0x26b421){logger['debug'](_0x5a1a82(0x269),_0x26b421);}}function storeConfiguration(_0x45cf1e){const _0xfdf14d=_0x21f322;dbConfig[_0xfdf14d(0x2c7)](_0xfdf14d(0x157))['remove']()[_0xfdf14d(0x266)](),dbConfig[_0xfdf14d(0x2c7)]('bots')['push'](..._0x45cf1e)['write'](),config=_0x45cf1e;}async function resetPassword(){const _0x4b0fc3=_0x21f322;if(tgBot&&settings[_0x4b0fc3(0x24d)]){const _0x5094e3=Markup[_0x4b0fc3(0x20f)]([Markup[_0x4b0fc3(0x14e)][_0x4b0fc3(0x2c8)](_0x4b0fc3(0x184),_0x4b0fc3(0x192)),Markup[_0x4b0fc3(0x14e)]['callback']('no','resetpw_no')]);await sendTelegram(settings[_0x4b0fc3(0x24d)],_0x4b0fc3(0x193),_0x5094e3),tgBot[_0x4b0fc3(0x2a8)](/resetpw_(.+)/,async _0x33e01a=>{const _0x1b1ad3=_0x4b0fc3,_0x10c880=_0x33e01a[_0x1b1ad3(0x20e)][0x1];_0x33e01a[_0x1b1ad3(0x1d5)]();if(_0x10c880!='no'){const _0x6a7e08=0xf,_0x478754=_0x1b1ad3(0x287),_0x4a4da1=Array[_0x1b1ad3(0x282)](crypto[_0x1b1ad3(0x166)](new Uint32Array(_0x6a7e08)))[_0x1b1ad3(0x21f)](_0x11c2a7=>_0x478754[_0x11c2a7%_0x478754[_0x1b1ad3(0x146)]])['join'](''),_0x488a8f=bcrypt[_0x1b1ad3(0x25b)](_0x4a4da1,saltRounds);storeSettings({'bbPassword':_0x488a8f}),await sendTelegram(_0x33e01a[_0x1b1ad3(0x186)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x4a4da1,{'parse_mode':'HTML'});}else await sendTelegram(_0x33e01a[_0x1b1ad3(0x186)]['id'],_0x1b1ad3(0x2b3));});}}async function confirmRestore(_0x27885f,_0x285e5d){const _0x300775=_0x21f322;io['to'](_0x300775(0x1a2))[_0x300775(0x2be)](_0x300775(0x217),_0x300775(0x143),'success');if(tgBot&&settings['telegramChatId']){const _0x3ec5c9=uuidRandom();tmpStorage[_0x3ec5c9]={'path':_0x27885f,'filename':_0x285e5d};const _0x247524=Markup['inlineKeyboard']([Markup[_0x300775(0x14e)]['callback']('yes',_0x300775(0x2f7)+_0x3ec5c9),Markup[_0x300775(0x14e)][_0x300775(0x2c8)]('no',_0x300775(0x158)+_0x3ec5c9)]);await sendTelegram(settings[_0x300775(0x24d)],_0x300775(0x13a),_0x247524),tgBot['action'](/restore_(.+)_(.+)/,async _0x38e2c3=>{const _0x3bbc57=_0x300775,_0x445d91=_0x38e2c3[_0x3bbc57(0x20e)][0x1],_0x2c177f=_0x38e2c3['match'][0x2],{path:_0x8e999f,filename:_0x415e37}=tmpStorage[_0x2c177f];delete tmpStorage[_0x2c177f],_0x38e2c3['editMessageReplyMarkup'](),_0x445d91==_0x3bbc57(0x184)?(logger[_0x3bbc57(0x224)](_0x3bbc57(0x271)),await sendTelegram(_0x38e2c3[_0x3bbc57(0x186)]['id'],_0x3bbc57(0x1ba),{'parse_mode':_0x3bbc57(0x14b)}),unzipFile(_0x8e999f,_0x415e37)):(logger[_0x3bbc57(0x224)](_0x3bbc57(0x1fd)),await sendTelegram(_0x38e2c3[_0x3bbc57(0x186)]['id'],_0x3bbc57(0x1fd)));});}}function getServerTime(){const _0x2ba632=_0x21f322,_0x5c10f3=new Date();return _0x5c10f3[_0x2ba632(0x27b)]()+'/'+(_0x5c10f3[_0x2ba632(0x121)]()+0x1)[_0x2ba632(0x2f4)]()[_0x2ba632(0x1b4)](0x2,'0')+'/'+_0x5c10f3[_0x2ba632(0x220)]()[_0x2ba632(0x2f4)]()[_0x2ba632(0x1b4)](0x2,'0')+'\x20'+_0x5c10f3[_0x2ba632(0x283)]()['toString']()[_0x2ba632(0x1b4)](0x2,'0')+':'+_0x5c10f3['getMinutes']()['toString']()[_0x2ba632(0x1b4)](0x2,'0')+':'+_0x5c10f3[_0x2ba632(0x1f0)]()[_0x2ba632(0x2f4)]()[_0x2ba632(0x1b4)](0x2,'0');}function getTimeStamp(){const _0x5074d8=_0x21f322,_0x5cf479=shiftedTime();return _0x5cf479[_0x5074d8(0x27b)]()+'/'+(_0x5cf479['getMonth']()+0x1)[_0x5074d8(0x2f4)]()[_0x5074d8(0x1b4)](0x2,'0')+'/'+_0x5cf479['getDate']()['toString']()[_0x5074d8(0x1b4)](0x2,'0')+'\x20'+_0x5cf479[_0x5074d8(0x283)]()[_0x5074d8(0x2f4)]()[_0x5074d8(0x1b4)](0x2,'0')+':'+_0x5cf479['getMinutes']()[_0x5074d8(0x2f4)]()[_0x5074d8(0x1b4)](0x2,'0')+':'+_0x5cf479[_0x5074d8(0x1f0)]()['toString']()[_0x5074d8(0x1b4)](0x2,'0');}function getCleanTimeStamp(){const _0xec5dc8=_0x21f322,_0x3dc807=shiftedTime();return _0x3dc807['getFullYear']()+(_0x3dc807['getMonth']()+0x1)[_0xec5dc8(0x2f4)]()[_0xec5dc8(0x1b4)](0x2,'0')+_0x3dc807[_0xec5dc8(0x220)]()[_0xec5dc8(0x2f4)]()[_0xec5dc8(0x1b4)](0x2,'0')+'-'+_0x3dc807[_0xec5dc8(0x283)]()['toString']()[_0xec5dc8(0x1b4)](0x2,'0')+_0x3dc807[_0xec5dc8(0x238)]()['toString']()[_0xec5dc8(0x1b4)](0x2,'0')+_0x3dc807[_0xec5dc8(0x1f0)]()[_0xec5dc8(0x2f4)]()[_0xec5dc8(0x1b4)](0x2,'0');}function shiftedTime(){const _0x5da6c2=_0x21f322,_0x3d0eac=new Date();let _0x3b5842=_0x3d0eac;if(settings[_0x5da6c2(0xee)]&&settings[_0x5da6c2(0xee)]!==0x0)_0x3b5842=fns['add'](_0x3d0eac,{'hours':settings['timeshift']});return _0x3b5842;}async function startScheduler(){const _0x5b7f23=_0x21f322,_0x29a419=new Date()[_0x5b7f23(0x112)](),_0xb139b1=shiftedTime()[_0x5b7f23(0x283)]();_0xb139b1==0x4&&backupConfigFiles(),_0xb139b1==0x0&&(rotateLogFiles(),logger[_0x5b7f23(0x224)](_0x5b7f23(0x1a0)),logger[_0x5b7f23(0x224)]('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment=='staging'?'(staging)':'')),logger[_0x5b7f23(0x224)](_0x5b7f23(0x1a0))),_0x29a419%0x6==0x0&&triggerAnalytics(),_0x29a419%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x5ab915){const _0x5ba9ee=_0x21f322;logger[_0x5ba9ee(0x224)](_0x5ba9ee(0x2fe)+_0x5ab915);const _0x2f6c35=getBotsWithMode();_0x2f6c35['length']>0x0?confirmRestore(configbackuppath,_0x5ab915):unzipFile(configbackuppath,_0x5ab915);}async function getBackupFiles(_0x4423e3=null){const _0xa80df7=_0x21f322;let _0x9c72f0=[],_0x47f0a6=fs[_0xa80df7(0x2aa)](configbackuppath,{'withFileTypes':!![]});_0x47f0a6[_0xa80df7(0x141)]((_0x5b1596,_0x3723dd)=>_0x5b1596[_0xa80df7(0x188)]<_0x3723dd[_0xa80df7(0x188)]?0x1:_0x3723dd[_0xa80df7(0x188)]<_0x5b1596[_0xa80df7(0x188)]?-0x1:0x0),_0x47f0a6[_0xa80df7(0xf5)](_0x435ac3=>{const _0x7ecc2f=_0xa80df7;if(!_0x435ac3[_0x7ecc2f(0x1ca)]()&&_0x435ac3['name'][_0x7ecc2f(0x2fb)](_0x7ecc2f(0x211))&&_0x435ac3[_0x7ecc2f(0x188)]['endsWith'](_0x7ecc2f(0x2e0))){const _0x195e2a=formatDate(fs['statSync'](configbackuppath+_0x435ac3[_0x7ecc2f(0x188)])['mtime']);_0x9c72f0[_0x7ecc2f(0x134)]({'name':_0x435ac3[_0x7ecc2f(0x188)],'mtime':_0x195e2a});}});if(_0x4423e3)io['to'](_0x4423e3)[_0xa80df7(0x2be)](_0xa80df7(0x221),_0x9c72f0);else return _0x9c72f0;}async function backupConfigFiles(){const _0x46fb70=_0x21f322;await zipFiles(_0x46fb70(0x168));const _0x18840e=getCleanTimeStamp();fs[_0x46fb70(0x208)](zippath+_0x46fb70(0x18e),configbackuppath+('backup-full@'+_0x18840e+_0x46fb70(0x2e0)));let _0xa11474=fs[_0x46fb70(0x2aa)](configbackuppath,{'withFileTypes':!![]});_0xa11474[_0x46fb70(0x141)]((_0x2511d3,_0x1eb830)=>_0x2511d3[_0x46fb70(0x188)]<_0x1eb830[_0x46fb70(0x188)]?0x1:_0x1eb830[_0x46fb70(0x188)]<_0x2511d3[_0x46fb70(0x188)]?-0x1:0x0),_0xa11474[_0x46fb70(0x146)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0xa11474[_0xa11474[_0x46fb70(0x146)]-0x1][_0x46fb70(0x188)]);}function rotateLogFiles(){const _0x5cfbce=_0x21f322,_0x3692c7=fs[_0x5cfbce(0xf9)](logspath+'output-000.log'),_0x53ca06=_0x3692c7[_0x5cfbce(0x2ed)]/0x400;if(_0x53ca06>0x64){let _0x5d573e=fs[_0x5cfbce(0x2aa)](logspath,{'withFileTypes':!![]});_0x5d573e['sort']((_0x563869,_0x375485)=>_0x563869[_0x5cfbce(0x188)]<_0x375485[_0x5cfbce(0x188)]?0x1:_0x375485[_0x5cfbce(0x188)]<_0x563869[_0x5cfbce(0x188)]?-0x1:0x0),_0x5d573e[_0x5cfbce(0xf5)](_0x479ec9=>{const _0x26c3e1=_0x5cfbce;if(_0x479ec9[_0x26c3e1(0x188)]=='output-002.log')fs[_0x26c3e1(0x208)](logspath+_0x479ec9[_0x26c3e1(0x188)],logspath+'output-003.log');if(_0x479ec9[_0x26c3e1(0x188)]==_0x26c3e1(0x18f))fs[_0x26c3e1(0x208)](logspath+_0x479ec9[_0x26c3e1(0x188)],logspath+_0x26c3e1(0x196));_0x479ec9[_0x26c3e1(0x188)]=='output-000.log'&&(fs['copyFileSync'](logspath+_0x479ec9['name'],logspath+_0x26c3e1(0x18f)),fs[_0x26c3e1(0x1f2)](logspath+_0x479ec9[_0x26c3e1(0x188)],''));});}}async function zipFiles(_0x3c376f){const _0x4b0640=_0x21f322;let _0x4b427e;if(_0x3c376f==_0x4b0640(0x140))_0x4b427e=logspath;if(_0x3c376f=='backup')_0x4b427e=configpath;if(_0x3c376f==_0x4b0640(0x168))_0x4b427e=configpath;let _0xc85db2=fs[_0x4b0640(0x2aa)](_0x4b427e,{'withFileTypes':!![]});const _0x2552e1=new JSZip();_0xc85db2[_0x4b0640(0xf5)](_0xecdce=>{const _0x293f73=_0x4b0640;if(!_0xecdce[_0x293f73(0x1ca)]()){let _0x4b4be0=fs[_0x293f73(0xf4)](_0x4b427e+_0xecdce[_0x293f73(0x188)]);if(_0x3c376f==_0x293f73(0x258)){const _0x535e8b=/^bot-[0-9]{3}-config.json$/,_0x51b1da=_0x535e8b[_0x293f73(0xf3)](_0xecdce['name']);if(_0x51b1da){const _0xf103b4=JSON[_0x293f73(0x207)](_0x4b4be0);if(_0xf103b4[_0x293f73(0x243)][0x0]){_0xf103b4[_0x293f73(0x243)][0x0][_0x293f73(0x2b4)]='***',_0xf103b4[_0x293f73(0x243)][0x0][_0x293f73(0x20a)]=_0x293f73(0x1b2);if(_0xf103b4[_0x293f73(0x243)][0x0][_0x293f73(0x119)])_0xf103b4[_0x293f73(0x243)][0x0][_0x293f73(0x119)]='***';}_0x4b4be0=JSON[_0x293f73(0x293)](_0xf103b4,null,0x2);}if(_0xecdce[_0x293f73(0x188)]==_0x293f73(0x20d)){const _0x35b211=JSON['parse'](_0x4b4be0);if(_0x35b211[_0x293f73(0x245)][_0x293f73(0x1c2)])_0x35b211[_0x293f73(0x245)][_0x293f73(0x1c2)]=![];if(_0x35b211[_0x293f73(0x245)][_0x293f73(0x20c)])_0x35b211[_0x293f73(0x245)][_0x293f73(0x20c)]=_0x293f73(0x1b2);if(_0x35b211[_0x293f73(0x245)][_0x293f73(0x11b)])_0x35b211[_0x293f73(0x245)][_0x293f73(0x11b)]=_0x293f73(0x1b2);if(_0x35b211[_0x293f73(0x245)][_0x293f73(0x24d)])_0x35b211[_0x293f73(0x245)][_0x293f73(0x24d)]=null;if(_0x35b211[_0x293f73(0x245)][_0x293f73(0x2a7)])_0x35b211[_0x293f73(0x245)]['marketcapApi']=_0x293f73(0x1b2);_0x4b4be0=JSON[_0x293f73(0x293)](_0x35b211,null,0x2);}if(_0xecdce[_0x293f73(0x188)]!='bb-secure.json')_0x2552e1[_0x293f73(0x14f)](_0xecdce[_0x293f73(0x188)],_0x4b4be0);}else _0x2552e1[_0x293f73(0x14f)](_0xecdce[_0x293f73(0x188)],_0x4b4be0);}});const _0x11af15=await _0x2552e1[_0x4b0640(0x21d)]({'type':_0x4b0640(0x16f),'base64':![],'compression':_0x4b0640(0x1bf)});fs[_0x4b0640(0x1f2)](zippath+(_0x3c376f+_0x4b0640(0x2e0)),_0x11af15,'binary');}async function unzipFile(_0x75de32,_0x4ba05e){const _0x4a8028=_0x21f322;fs[_0x4a8028(0x2aa)](configpath,{'withFileTypes':!![]})['forEach'](_0x598539=>{const _0x3620f0=_0x4a8028;if(!_0x598539['isDirectory']())fs['rmSync'](configpath+_0x598539[_0x3620f0(0x188)]);});const _0xfc41b1=fs[_0x4a8028(0xf4)](_0x75de32+_0x4ba05e,_0x4a8028(0x19e)),_0x41495b=await JSZip[_0x4a8028(0x260)](_0xfc41b1,{'base64':![],'checkCRC32':!![]});for(const _0x5c37d3 of Object[_0x4a8028(0x1ce)](_0x41495b[_0x4a8028(0x26e)])){const _0x5f3ea9=_0x41495b[_0x4a8028(0x26e)][_0x5c37d3],_0x2dec3b=await _0x5f3ea9[_0x4a8028(0x21a)](_0x4a8028(0x16f));fs[_0x4a8028(0x1f2)](configpath+_0x5f3ea9[_0x4a8028(0x188)],_0x2dec3b);}fs[_0x4a8028(0x2aa)](temppath,{'withFileTypes':!![]})['forEach'](_0x1c8b1e=>{const _0x22bce1=_0x4a8028;if(!_0x1c8b1e[_0x22bce1(0x1ca)]())fs[_0x22bce1(0x163)](temppath+_0x1c8b1e['name']);}),logger['debug'](_0x4a8028(0x295)),process['send']({'restore':!![]},_0x5296b3=>{});}async function getPublicIp(){const _0x1f80f1=_0x21f322;try{const _0xf5c15=await axios[_0x1f80f1(0x2c7)](_0x1f80f1(0x18a));publicip=_0xf5c15[_0x1f80f1(0xf2)]['ip'];}catch(_0x3e7ec1){}}async function triggerAnalytics(){const _0x2da52f=_0x21f322;if(!publicip)await getPublicIp();const _0x4f6b56=getBotsWithMode();let _0x36967f=0x0;_0x4f6b56[_0x2da52f(0xf5)](_0x594674=>{if(_0x594674['status']==='enabled')_0x36967f++;});const _0x1acca6=getBotExchanges();mixpanel[_0x2da52f(0x1a9)](_0x2da52f(0x101),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x4f6b56[_0x2da52f(0x146)],'numbotsenabled':_0x36967f,'exchanges':_0x1acca6,'environment':environment});}async function getMessages(){const _0x3f658e=_0x21f322,_0x58b4f8='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x24e380=new GraphQLClient(_0x58b4f8),_0x3cba47={'authorization':_0x3f658e(0x24e)},_0x485c28=serverversion[_0x3f658e(0x2ca)]('.'),_0x166eeb=_0x485c28[0x0]+'.'+_0x485c28[0x1],_0x15c4b8=Math[_0x3f658e(0x244)](settings['lastmsgtelegram'],settings[_0x3f658e(0x298)]),_0x2606ad={'last':parseInt(_0x15c4b8),'bbm':_0x166eeb},_0x4af192=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x450f0f;try{_0x450f0f=await _0x24e380[_0x3f658e(0x285)](_0x4af192,_0x2606ad,_0x3cba47);}catch(_0x461f30){}if(_0x450f0f&&_0x450f0f[_0x3f658e(0x262)]){let _0x11ba32=settings[_0x3f658e(0x288)],_0x39b619=settings[_0x3f658e(0x288)];newMessages=[];for(const _0x1d8d79 of _0x450f0f[_0x3f658e(0x262)]){newMessages['push'](_0x1d8d79);let _0x4852c0=![];_0x1d8d79['bbvNew']&&(updateSetting(_0x3f658e(0x2a4),_0x1d8d79[_0x3f658e(0x189)]),_0x4852c0=isNewerVersion(serverversion,_0x1d8d79['bbvNew'])||serverversion==_0x1d8d79[_0x3f658e(0x189)]);if(!_0x4852c0&&_0x1d8d79[_0x3f658e(0x216)]>_0x11ba32){if(_0x1d8d79[_0x3f658e(0x239)]===_0x3f658e(0x1da)||serverversion[_0x3f658e(0x2fb)](_0x1d8d79['bbvReceive'])){let _0x3ecd78=''+_0x1d8d79[_0x3f658e(0x1c6)]+'\x0a\x0a'+_0x1d8d79[_0x3f658e(0x1ee)];const _0xb7b763=await sendTelegramMsg(toTelegramMarkdown(_0x3ecd78),'Markdown');_0x11ba32=_0x1d8d79['number'];}}_0x39b619=_0x1d8d79[_0x3f658e(0x216)];}updateAvailable=isNewerVersion(settings[_0x3f658e(0x2a4)],serverversion),updateSetting(_0x3f658e(0x288),_0x39b619),emitMessages();}}function emitMessages(){const _0x1ed344=_0x21f322,_0x2d6492=settings[_0x1ed344(0x298)];let _0x56eb81=[];newMessages[_0x1ed344(0xf5)](_0x3246e9=>{const _0x3a3dca=_0x1ed344;_0x3246e9[_0x3a3dca(0x216)]>_0x2d6492&&_0x56eb81['push'](_0x3246e9);}),_0x56eb81[_0x1ed344(0x146)]>0x0&&getAllClients()[_0x1ed344(0xf5)](_0xd4296=>{const _0x307b76=_0x1ed344;getSocket(_0xd4296['id'])['emit'](_0x307b76(0x1ee),_0x56eb81);});}function confirmMessage(_0x579da3){const _0x3b168e=_0x21f322;updateSetting(_0x3b168e(0x298),Number(_0x579da3));}function isNewerVersion(_0x171a4b,_0x2d17e2){const _0x293099=_0x21f322,_0x40e4b5=_0x2d17e2[_0x293099(0x2ca)]('.'),_0x254709=_0x171a4b['split']('.');for(var _0x549560=0x0;_0x549560<_0x254709[_0x293099(0x146)];_0x549560++){const _0x3d9831=~~_0x254709[_0x549560],_0x2fa754=~~_0x40e4b5[_0x549560];if(_0x3d9831>_0x2fa754)return!![];if(_0x3d9831<_0x2fa754)return![];}return![];}function toTelegramMarkdown(_0x2c562d){const _0xd105b=_0x21f322,_0x429f5a=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x334900=/\*{2}(.+?)\*{2}/gim;return _0x2c562d=_0x2c562d['replace'](_0x429f5a,_0xd105b(0x237))[_0xd105b(0x279)](_0x334900,_0xd105b(0x1df)),_0x2c562d;}async function validateConfigFile(){const _0x41cdbf=_0x21f322,_0x442d4f=dbConfig['get'](_0x41cdbf(0x157))[_0x41cdbf(0x2e8)](_0x41cdbf(0x1cf))['value']()||[];if(_0x442d4f[_0x41cdbf(0x146)]==0x0){let _0x2d7d4f=0x0,_0x130d5f=[];const _0x487f02=/^bot-([0-9]{3})-config.json$/,_0x5adca2=fs[_0x41cdbf(0x2aa)](configpath);_0x5adca2['forEach'](_0x3234a0=>{const _0x3bb247=_0x41cdbf,_0x539a58=_0x487f02['exec'](_0x3234a0);if(_0x539a58){const _0x1b6708=_0x539a58[0x1];let _0x3f5b2b=getBotAttributes(_0x1b6708);_0x130d5f[_0x3bb247(0x134)]({'botID':_0x1b6708,'botname':_0x3f5b2b[_0x3bb247(0x28b)],'status':_0x3bb247(0x12e),'live':_0x3bb247(0x250)}),_0x2d7d4f++;}}),_0x2d7d4f!=0x0&&(dbConfig[_0x41cdbf(0x2c7)]('bots')[_0x41cdbf(0x2d9)](_0x130d5f)[_0x41cdbf(0x266)](),config=_0x130d5f,restoredConfigFile=_0x2d7d4f);}}function _0x4fb0(_0x16ab1a,_0x139ed9){const _0x2c7def=_0x382c();return _0x4fb0=function(_0x177481,_0x60ca3d){_0x177481=_0x177481-0xee;let _0x382cb7=_0x2c7def[_0x177481];return _0x382cb7;},_0x4fb0(_0x16ab1a,_0x139ed9);}async function restoreConfigNotify(_0x48300f){const _0x5d06da=_0x21f322;let _0x468885;if(restoredConfigFile==0x1)_0x468885=_0x5d06da(0x138);else _0x468885=_0x5d06da(0x1f9);if(_0x48300f)io['to'](_0x5d06da(0x1a2))['emit'](_0x5d06da(0x217),_0x468885);else{logger[_0x5d06da(0x2af)](_0x5d06da(0xf7)),logger[_0x5d06da(0x2af)](_0x468885),logger[_0x5d06da(0x2af)](_0x5d06da(0xf7)),logger[_0x5d06da(0x2af)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x5d06da(0x2c3)]!=_0x5d06da(0x129))await sendTelegram(settings[_0x5d06da(0x24d)],_0x5d06da(0x151)+_0x468885);}}function decryptRSA(_0x54bf27,_0x123dfe){const _0x2f69c5=_0x21f322,_0x20e980=forge[_0x2f69c5(0x113)][_0x2f69c5(0x149)](_0x54bf27),_0x4945bc=_0x20e980[_0x2f69c5(0x187)](forge['util']['decode64'](_0x123dfe),_0x2f69c5(0x150),{'md':forge['md'][_0x2f69c5(0x264)][_0x2f69c5(0x2c5)](),'mgf1':{'md':forge['md'][_0x2f69c5(0x264)][_0x2f69c5(0x2c5)]()}});return _0x4945bc;}function validateCredentials(_0x47430f,_0x36500c){const _0x295ebc=_0x21f322;if(_0x47430f['username']==settings['bbUsername']&&bcrypt[_0x295ebc(0x26a)](_0x47430f['password'],settings[_0x295ebc(0x20c)])){if(settings[_0x295ebc(0x23a)])return{'allow':![],'reason':_0x295ebc(0x160),'token':null};else{const _0x14b389=generateLoginToken(_0x36500c);return{'allow':!![],'reason':_0x295ebc(0x2eb),'token':_0x14b389};}}else return{'allow':![],'reason':_0x295ebc(0x24b),'token':null};}function refreshToken(_0x2d8733){const _0x555bb7=_0x21f322,_0x13eefd=generateLoginToken(_0x2d8733);return{'allow':!![],'reason':_0x555bb7(0x2eb),'token':_0x13eefd};}function validateAccess(_0x5ab651,_0x3a4cc3,_0x44a801){const _0x3e76d7=_0x21f322,_0x45eae4=_0x44a801?_0x44a801:devices[_0x3a4cc3]['ip'];let _0x14d5ac;const _0x18ae49=_0x4b03de=>{const _0x1736db=_0x4fb0;if(settings['loginRequired']){if(settings[_0x1736db(0x23a)]){if(telegram2FaApproved(_0x3a4cc3)){const _0x2288bb=generateLoginToken(_0x3a4cc3);return{'allow':!![],'reason':_0x1736db(0xfd),'token':_0x2288bb};}else return{'allow':![],'reason':_0x1736db(0x17c),'token':null};}else return _0x14d5ac=validToken(_0x4b03de,_0x3a4cc3),_0x14d5ac['hasOwnProperty'](_0x1736db(0x2df))?{'allow':!![],'reason':_0x1736db(0x1f3),'token':_0x4b03de}:{'allow':![],'reason':_0x1736db(0x17c),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x3e76d7(0x228)]){let _0x4819a8=[...settings['whitelist'],_0x3e76d7(0x2cd),'::ffff:127.0.0.1',_0x3e76d7(0x2b6)];if(_0x4819a8[_0x3e76d7(0x2a0)](_0x45eae4))return _0x18ae49(_0x5ab651);else{_0x14d5ac=validToken(_0x5ab651,_0x3a4cc3);if(_0x14d5ac['hasOwnProperty'](_0x3e76d7(0x2df)))return _0x18ae49(_0x5ab651);else{if(telegramIpApproved(_0x3a4cc3)){const _0x1cfb31=generateToken(_0x3a4cc3);return _0x14d5ac=_0x18ae49(_0x5ab651),_0x14d5ac[_0x3e76d7(0x124)]?{'allow':!![],'reason':_0x3e76d7(0x1bc),'token':_0x1cfb31}:_0x14d5ac;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x3e76d7(0x2fd),'token':null}:{'allow':![],'reason':_0x3e76d7(0x106),'token':null};}}}else return _0x18ae49(_0x5ab651);}function timelyDecrypt(_0x4c3faf,_0x30dfb4,_0x5767d6='@'){const _0x4eb5c5=_0x21f322;if(_0x4c3faf)try{const _0xe8c09a=decryptRSA(secure[_0x4eb5c5(0x204)],_0x4c3faf),_0x21df2e=_0xe8c09a['split'](_0x5767d6)[0x0],_0x234d3c=_0xe8c09a[_0x4eb5c5(0x2ca)](_0x5767d6)[0x1],_0x379e82=new Date()[_0x4eb5c5(0x1ff)]();if(_0x30dfb4){if(_0x379e82-_0x234d3c<maxSecretAge*0x3e8)return _0x21df2e;else return![];}else return _0x21df2e;}catch(_0x5ae51d){return![];}else return![];}const validToken=(_0x5ef70c,_0x18c6fe)=>{const _0x55b77b=_0x21f322,_0x384cc8=devices[_0x18c6fe]['ip'];if(!_0x5ef70c)return{'error':'No\x20authentication\x20token'};for(let _0x1dea7c of blacklist){if(_0x1dea7c['token']==_0x5ef70c)return{'error':_0x55b77b(0x1b5)};}let _0x3c1e0b;try{_0x3c1e0b=jwt[_0x55b77b(0x2f8)](_0x5ef70c,secure['secret']+_0x18c6fe);}catch{return{'error':_0x55b77b(0x2ea)};}if(!_0x3c1e0b[_0x55b77b(0x2d3)](_0x55b77b(0x2f3))&&!_0x3c1e0b['hasOwnProperty'](_0x55b77b(0x2ba))||!_0x3c1e0b[_0x55b77b(0x2d3)](_0x55b77b(0x2e2)))return{'error':_0x55b77b(0x1ab)};if(!_0x3c1e0b[_0x55b77b(0x2d3)](_0x55b77b(0x2ba))&&_0x3c1e0b[_0x55b77b(0x2d3)]('clientip')){const {clientip:_0x461146}=_0x3c1e0b;return _0x384cc8==_0x461146?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x3c1e0b[_0x55b77b(0x2d3)]('username')&&_0x3c1e0b[_0x55b77b(0x2d3)](_0x55b77b(0x2f3))){const {username:_0x48bd06,clientip:_0x130ba3}=_0x3c1e0b;return settings[_0x55b77b(0x182)]==_0x48bd06&&_0x384cc8==_0x130ba3?{'success':_0x55b77b(0x154)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0xb2927f=>{const _0x15cef8=_0x21f322;if(_0xb2927f){const _0x1de86b=devices[_0xb2927f]['ip'];return jwt[_0x15cef8(0x17d)]({'username':settings['bbUsername'],'clientip':_0x1de86b},secure[_0x15cef8(0x27c)]+_0xb2927f,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x1160d8=>{const _0x17ba32=_0x21f322;if(_0x1160d8){const _0x40beea=devices[_0x1160d8]['ip'];return jwt[_0x17ba32(0x17d)]({'clientip':_0x40beea},secure[_0x17ba32(0x27c)]+_0x1160d8,{'expiresIn':devices[_0x1160d8]['telegramIpApproval']['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x48feac=>{const _0x4e07fb=_0x21f322;let _0x39b480=![];return devices[_0x48feac][_0x4e07fb(0x1e2)]&&devices[_0x48feac][_0x4e07fb(0x1e2)][_0x4e07fb(0x241)]!=_0x4e07fb(0x13b)&&(_0x39b480=devices[_0x48feac][_0x4e07fb(0x1e2)]['clientip']==devices[_0x48feac]['ip']&&new Date()[_0x4e07fb(0x1ff)]()-devices[_0x48feac][_0x4e07fb(0x1e2)]['timestamp']<devices[_0x48feac][_0x4e07fb(0x1e2)][_0x4e07fb(0x241)]*0x3c*0x3e8),_0x39b480;},telegram2FaApproved=_0x508336=>{const _0x5bee49=_0x21f322;let _0x236f1e=![];return devices[_0x508336]['telegram2FaApproval']&&devices[_0x508336][_0x5bee49(0x131)][_0x5bee49(0x241)]!=_0x5bee49(0x13b)&&(_0x236f1e=devices[_0x508336][_0x5bee49(0x131)]['clientip']==devices[_0x508336]['ip']&&new Date()[_0x5bee49(0x1ff)]()-devices[_0x508336]['telegram2FaApproval'][_0x5bee49(0x177)]<devices[_0x508336]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x236f1e;},normalizeIP=_0xcd1e81=>{const _0x323a32=_0x21f322;let _0x5c5f39=null,_0x1ce57e=null;if(ipaddr[_0x323a32(0x2a5)](_0xcd1e81)){const _0x5a7d69=ipaddr[_0x323a32(0x207)](_0xcd1e81);_0x5a7d69[_0x323a32(0x100)]()===_0x323a32(0x17b)?(_0x5a7d69['isIPv4MappedAddress']()&&(_0x5c5f39=_0x5a7d69[_0x323a32(0x2cb)]()[_0x323a32(0x2f4)]()),_0x1ce57e=_0x5a7d69[_0x323a32(0x2f4)]()):(_0x5c5f39=_0x5a7d69['toString'](),_0x1ce57e=_0x5a7d69[_0x323a32(0x292)]()[_0x323a32(0x2f4)]());}return{'show':_0x5c5f39?_0x5c5f39:_0x1ce57e,'store':_0x1ce57e};};function formatDate(_0x3016eb){const _0x1ad89a=_0x21f322;return _0x3016eb[_0x1ad89a(0x27b)]()+'/'+(_0x3016eb[_0x1ad89a(0x121)]()+0x1)[_0x1ad89a(0x2f4)]()[_0x1ad89a(0x1b4)](0x2,'0')+'/'+_0x3016eb['getDate']()[_0x1ad89a(0x2f4)]()[_0x1ad89a(0x1b4)](0x2,'0')+'\x20'+_0x3016eb[_0x1ad89a(0x283)]()[_0x1ad89a(0x2f4)]()[_0x1ad89a(0x1b4)](0x2,'0')+':'+_0x3016eb[_0x1ad89a(0x238)]()[_0x1ad89a(0x2f4)]()[_0x1ad89a(0x1b4)](0x2,'0')+':'+_0x3016eb[_0x1ad89a(0x1f0)]()[_0x1ad89a(0x2f4)]()[_0x1ad89a(0x1b4)](0x2,'0');}function sleep(_0x346377){return new Promise(_0x5479ce=>setTimeout(_0x5479ce,_0x346377));}