const _0x2833d4=_0x56cb;(function(_0x879706,_0x506099){const _0x38f4e6=_0x56cb,_0x50a146=_0x879706();while(!![]){try{const _0x2002a1=parseInt(_0x38f4e6(0x2d1))/0x1*(parseInt(_0x38f4e6(0x233))/0x2)+parseInt(_0x38f4e6(0x2d4))/0x3*(parseInt(_0x38f4e6(0x301))/0x4)+parseInt(_0x38f4e6(0x297))/0x5+-parseInt(_0x38f4e6(0x275))/0x6*(parseInt(_0x38f4e6(0x2de))/0x7)+-parseInt(_0x38f4e6(0x31f))/0x8+parseInt(_0x38f4e6(0x344))/0x9+parseInt(_0x38f4e6(0x1fe))/0xa;if(_0x2002a1===_0x506099)break;else _0x50a146['push'](_0x50a146['shift']());}catch(_0x1c47d0){_0x50a146['push'](_0x50a146['shift']());}}}(_0x13b9,0x96668));const _0x2cf8db=function(){let _0x2db09b=!![];return function(_0x3e5db0,_0xe762a1){const _0xd8d0f2=_0x2db09b?function(){if(_0xe762a1){const _0x38b929=_0xe762a1['apply'](_0x3e5db0,arguments);return _0xe762a1=null,_0x38b929;}}:function(){};return _0x2db09b=![],_0xd8d0f2;};}(),_0x557996=_0x2cf8db(this,function(){const _0x277791=_0x56cb;return _0x557996[_0x277791(0x23f)]()[_0x277791(0x213)](_0x277791(0x2e0))['toString']()[_0x277791(0x2c6)](_0x557996)[_0x277791(0x213)](_0x277791(0x2e0));});_0x557996();'use strict';process[_0x2833d4(0x293)][_0x2833d4(0x192)]=0x1;function _0x56cb(_0x2904c4,_0x50caa5){const _0x548e00=_0x13b9();return _0x56cb=function(_0x557996,_0x2cf8db){_0x557996=_0x557996-0x17c;let _0x13b9b2=_0x548e00[_0x557996];return _0x13b9b2;},_0x56cb(_0x2904c4,_0x50caa5);}const childProcess=require(_0x2833d4(0x215)),fs=require('fs'),fns=require(_0x2833d4(0x377)),low=require(_0x2833d4(0x325)),FileSync=require('lowdb/adapters/FileSync'),path=require(_0x2833d4(0x29f)),crypto=require('crypto'),forge=require('node-forge'),bcrypt=require('bcryptjs'),jwt=require(_0x2833d4(0x292)),ipaddr=require(_0x2833d4(0x229)),yargs=require(_0x2833d4(0x22b)),uuidRandom=require(_0x2833d4(0x1e2)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x2833d4(0x204)),axios=require('axios'),{GraphQLClient,gql}=require(_0x2833d4(0x388)),util=require(_0x2833d4(0x21c)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x2833d4(0x1c6)),argv=yargs(process['argv'][_0x2833d4(0x284)](0x2))[_0x2833d4(0x1c0)],PORT=argv[_0x2833d4(0x202)]||_0x2833d4(0x1fc),pattern=/^[0-9]{2,4}$/;!pattern[_0x2833d4(0x2f4)](PORT)&&(console[_0x2833d4(0x1a1)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x2833d4(0x1a0)),process[_0x2833d4(0x1f4)](0x1));const HOST=argv[_0x2833d4(0x236)]||null,userID=argv[_0x2833d4(0x2f8)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process[_0x2833d4(0x268)][_0x2833d4(0x393)];let bbpath=_0x2833d4(0x24c),bbpath2='';const botfile=_0x2833d4(0x1f0),configfile=_0x2833d4(0x2ce),settingsfile=_0x2833d4(0x1d6),securefile=_0x2833d4(0x290),environment=require('./'+bbpath2+_0x2833d4(0x2d9))[_0x2833d4(0x250)]||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x2833d4(0x34b)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x2833d4(0x318)),configpath=userID?bbpath+_0x2833d4(0x1c5)+userID+'/':bbpath+_0x2833d4(0x1c5),configbackuppath=configpath+_0x2833d4(0x205),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+'logs/',zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x2833d4(0x355),loggerfile=fs[_0x2833d4(0x1c8)](logspath+_0x2833d4(0x1a5),{'flags':'a'}),temppath=userID?bbpath+_0x2833d4(0x296)+userID+'/':bbpath+_0x2833d4(0x296);!fs[_0x2833d4(0x34b)](configpath)&&fs[_0x2833d4(0x2e1)](configpath);!fs[_0x2833d4(0x34b)](configbackuppath)&&fs[_0x2833d4(0x2e1)](configbackuppath);!fs[_0x2833d4(0x34b)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x2833d4(0x34b)](zippath)&&fs[_0x2833d4(0x2e1)](zippath);!fs[_0x2833d4(0x34b)](temppath)&&fs[_0x2833d4(0x2e1)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x2833d4(0x300)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x2833d4(0x264),'onepagemode':![],'marketcapApi':''}})[_0x2833d4(0x300)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x2833d4(0x37a)]({'secure':{},'blacklist':[]})[_0x2833d4(0x300)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x2833d4(0x367)](_0x2833d4(0x2ae),{'host':_0x2833d4(0x2dd)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x2833d4(0x387)]&&(settings[_0x2833d4(0x387)]!=''&&settings[_0x2833d4(0x387)]!='***')&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x301c4d,_0x2980ee)=>{const _0x34e5d9=_0x2833d4,_0x4ccf0c=/#[A-Z]{3}#/g;if(typeof _0x301c4d=='string'){!_0x2980ee?_0x301c4d=_0x301c4d['replace'](_0x4ccf0c,''):(_0x301c4d=_0x301c4d[_0x34e5d9(0x2d7)](/#BLU#/g,_0x34e5d9(0x21a)),_0x301c4d=_0x301c4d[_0x34e5d9(0x2d7)](/#RED#/g,_0x34e5d9(0x343)),_0x301c4d=_0x301c4d[_0x34e5d9(0x2d7)](/#YEL#/g,_0x34e5d9(0x196)),_0x301c4d=_0x301c4d[_0x34e5d9(0x2d7)](/#MAG#/g,'\x1b[35m'),_0x301c4d=_0x301c4d['replace'](/#CYA#/g,_0x34e5d9(0x1d5)),_0x301c4d=_0x301c4d['replace'](/#RES#/g,'\x1b[0m'));;}return _0x301c4d;},logger={'screen':_0x24a0d8=>{const _0x49477c=_0x2833d4;console[_0x49477c(0x1a1)](parseColor(_0x24a0d8,!![]));},'simple':_0x12eb63=>{const _0x311eb9=_0x2833d4;console[_0x311eb9(0x1a1)](parseColor(_0x12eb63,!![])),loggerfile[_0x311eb9(0x300)](util['format'](parseColor(_0x12eb63,![]))+'\x0a');},'full':async _0x5a21c8=>{const _0x145993=_0x2833d4,_0x4477a5=getTimeStamp()+_0x145993(0x206)+_0x5a21c8;console[_0x145993(0x1a1)](parseColor(_0x4477a5,!![])),loggerfile[_0x145993(0x300)](util[_0x145993(0x183)](parseColor(_0x4477a5,![]))+'\x0a');if(tgBot&&settings[_0x145993(0x235)]&&settings[_0x145993(0x1fd)]!=_0x145993(0x34e))await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+parseColor(_0x5a21c8,![]));},'debug':async(_0x24541c,_0x51e10b='')=>{const _0x27e969=_0x2833d4,_0x535e79=getTimeStamp()+_0x27e969(0x274)+_0x24541c;if(debugging)console[_0x27e969(0x1a1)](parseColor(_0x535e79,!![]));loggerfile[_0x27e969(0x300)](util[_0x27e969(0x183)](parseColor(_0x535e79,![]))+'\x0a');if(_0x51e10b){if(debugging)console[_0x27e969(0x1a1)](_0x51e10b);loggerfile[_0x27e969(0x300)](util[_0x27e969(0x183)](_0x51e10b)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x143956){const _0x159ad8=_0x2833d4;_0x143956[_0x159ad8(0x23f)]()[_0x159ad8(0x2bb)](_0x159ad8(0x383))?(logger['simple'](_0x159ad8(0x21d)+_0x143956[_0x159ad8(0x202)]+_0x159ad8(0x248)),process[_0x159ad8(0x32b)]({'terminate':!![]},_0x2ad540=>{})):logger[_0x159ad8(0x311)](_0x143956);}),process['on'](_0x2833d4(0x1f4),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x2833d4(0x1bc),()=>{const _0xbfdde1=_0x2833d4;stopAllBots(),process[_0xbfdde1(0x1f4)](0x0);}),process['on'](_0x2833d4(0x2f1),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];function _0x13b9(){const _0x49cf56=['telegramEnabled','/start','write','25940gLDodE','Unauthorized\x20attempt\x20to\x20get\x20messages','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','replyWithDocument','running','static','Your\x20installation\x20is\x20already\x20up\x20to\x20date','tkn','restore_no_','forEach','reply','confirm-message','-config.json','async','launch','min','simple','get-logs','writeFileSync','private','telegramIpApproval','_nsps','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','clients','Bot\x20','2FA\x20required','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','status','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Notifications\x20types:\x20','7765920epgnhI','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Yes','internal','Backup\x20file\x20unzipped\x20and\x20stored','listen','lowdb','params','parse','delete-bot','/update\x20-\x20update\x20Balance\x20Bot\x0a','build','send','|@|','address','-results.json','Token\x20blacklisted','telegramUsername','login2fa_','alerts','/enable\x20-\x20enable\x20notifications\x0a','Restore\x20process\x20aborted','messages','showConfig','backup','DEFLATE','Server','tempaccess_15_','Restore\x20backup\x20file\x20','Unauthorized\x20attempt\x20to\x20get\x20events','toggle','sendMetricsTelegram','Notifications\x20enabled\x0a','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','remove','join','\x1b[31m','8874306xaZgll','output-002.log','login\x20not\x20required','event','portfolio','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','/metrics\x20-\x20show\x20bot\x20performance\x0a','existsSync','Idling\x20(','login2fa_reject_','orders','push','sendPortfolioTelegram','Invalid\x20username\x20or\x20IP\x20address','No\x20bots\x20running\x20right\x20now','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','access','zip/','.zip','value','/status\x20-\x20show\x20bot(s)\x20status\x0a','toggleBotMode','botID','botmanager','temporary\x20access\x20not\x20allowed','(staging)','\x20>\x20','metrics','token','chat','update-bot','pidRefreshToken','hashSync','publicKey','5\x20min','init','filter','allow','settings.','copyFileSync','isValid','socket.io','isDirectory','\x20-\x20','remoteAddress','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','post','************','telegram','<b>Telegram\x20Bot\x20Status:</b>\x0a','Access\x20enabled\x20for\x20','date-fns','File\x20uploaded','Starting\x20Balance\x20Bot\x20update','defaults','Starting\x20(','any','function','inlineKeyboard','help','hasOwnProperty','auth','fork','address\x20already\x20in\x20use','bbPassword','error','family','telegramToken','graphql-request','settings','resetpw_yes','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','userid','name','login\x20required','config_all','All','staging','\x20only\x0a','node','data','Invalid\x20IP\x20address','auto','Starting\x20#RED#Balance\x20Bot\x20v','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','message','disabled','binary','show','config_alerts','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','username','#RES#\x20if\x20running\x20locally\x0a','randomBytes','format','find','files','Setting\x20access:\x20','live','headless','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','backup-full@','sortBy','generateKeyPair','/names\x20-\x20show\x20bot\x20names\x0a','Bot\x20Mgr\x20>\x20Starting\x20','Telegraf\x20error:','code','You\x20can\x20use\x20the\x20following\x20commands:\x0a','NTBA_FIX_319','Bot\x20Mgr\x20>\x20Toggling\x20','warning','ipc','\x1b[33m','getMonth','latestversion','No\x20authentication\x20token','reinstall_no','logout','button','Password\x20has\x20been\x20reset\x20to:\x20','Bot\x20Mgr\x20>\x20Stopping\x20','onepagemode',',\x20must\x20be\x20a\x204\x20digit\x20number','log','getSeconds','pki','conn','/output-000.log','Enabled\x20','tempaccess_5_','bbvReceive','enable','success','reload','sha256','$1_$2_$3','config','Restoring\x20bot(s)\x20from\x20backup','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','All\x20bots','padStart','\x20(2)','notification','new','catch','full','/:bot/performance','resetpw_no','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','login','SIGTERM','emit','\x20|\x20user:\x20...','privateKeyFromPem','argv','Unauthorized\x20login\x20attempt\x20(timeout)','stringify','2FA\x20login\x20required','compareSync','config/','jszip','Notifications\x20disabled','createWriteStream','getPortfolio','map','headers','off','emitHistory','match','Alerts','15\x20min','/:bot/history','sign','command','hex','\x1b[36m','bb-settings.json','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','number','Unauthorized\x20attempt\x20to\x20confirm\x20message','login\x20token\x20generated','Unauthorized\x20attempt\x20to\x20delete\x20bot','clientip','marketcapApi','ipv6','generateAsync','store-fiat','http://localhost:','uuid-random','#RES#\x20','Ok,\x20will\x20send\x20order\x20notifications\x20only','encryptedUuid','Starting\x20Balance\x20Bot\x20reinstallation','Node.js\x20v','all','max','Deleted\x20Bot\x20','-----------------------------------------------------------------------------------','get-portfolio','tempaccess_reject_','blacklist','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','bot.js','reinstall','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','delete-alerts','exit','Running\x20#RED#Balance\x20Bot\x20v','backup-full.zip','Login\x20rejected','getDate','http','cloneDeep','readdirSync','3000','telegramEvents','878590zrugUZ','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','kind','update-bb','port','Allow\x20login\x20from\x20IP\x20address\x20','mixpanel','backup/',':\x20Bot\x20Mgr\x20>\x20','password','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','stop','getUTCHours','split','/download/:type','add-bot','Restore\x20process\x20confirmed','create','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','lastmsgtelegram','rmSync','search','::ffff:127.0.0.1','child_process','editMessageReplyMarkup','file','Unauthorized\x20attempt\x20to\x20update\x20settings','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','\x1b[34m','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','util','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','expiry',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','verify','off_','secret','action','HTML','Error\x20while\x20deleting\x20config\x20files:\x20','Notifications\x20enabled','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','ipaddr.js','get','yargs','show-config','botname','timestamp','type','publicKeyToPem','callback','temporary\x20access\x20timeout','4GxQerS','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','telegramChatId','host','then','randomFillSync','rsa','bbvNew','download','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','readFileSync','***','toString','https://api.ipify.org?format=json','Error\x20details:','manual','kill','Unauthorized\x20attempt\x20to\x20log\x20out','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','/:bot','build2','#RES#','\x20|\x20','on_','getFullYear','bb/','length',')\x20|\x20Bot\x20','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','environment','lastmsgemitted','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','index.html','-events.json','connection','exec','-performance.json','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','sort','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','uuid','open','CoinMarketCap\x20API\x20key\x20validated','Password\x20reset\x20rejected','pidExpireLogin','Invalid\x20authentication\x20token\x20(2)','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Telegram\x20error:','assign','0.0.0','reset-history','1000','startsWith','versions',')\x20\x20\x20|\x20Bot\x20','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Logged\x20out\x20user\x20...','handshake','bot-','Notifications\x20disabled\x0a','keys','Error\x20sending\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','/:bot/configuration','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','6uJyxyK','restart','mode','2FA\x20login\x20token\x20generated','*$1*','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','logged\x20out','output-000.log','close','entries','/upload-backup','#RES#\x20if\x20running\x20on\x20server','use','ETH','debug','slice','loginRequired','getStartingBalances','yes','Session\x20expired\x20for\x20user\x20...','reset-password','\x20|\x20client:\x20...','showname','sendFile','output-001.log','::ffff:7f00:1','/:bot/coins','bb-secure.json','update','jsonwebtoken','env','Unauthorized\x20attempt\x20to\x20show\x20configuration','get-backup-files','temp/','4270155VIpZYR','request','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','=>\x20Go\x20to\x20#CYA#http://','reason','size','once','removeAllListeners','path','store-configuration','decrypt','/on\x20-\x20start\x20bot(s)\x0a','Bot\x20Mgr\x20>\x20','args','output-003.log','getHours','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','inherit','getMinutes','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','bot','temporaryAccessAllowed','30\x20min','6b67f3d61ee94b8f5c80b4affef4c4d9','new-disabled','Backup\x20file\x20uploaded','User\x20has\x20been\x20validated','started','from','enabled','Error\x20removing\x20old\x20backup\x20files:','timeshift','getTime','restore_yes_','server','exp','includes','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','/backup\x20-\x20receive\x20backup\x20files\x0a','Unauthorized\x20attempt\x20to\x20delete\x20alerts','toggle-bot-mode','endsWith','socket','config_orders','apiSecret','\x20(1)','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','constructor','get-messages','bots','Unauthorized\x20attempt\x20to\x20add\x20bot','disconnect','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','backup-files','temporary\x20token\x20generated','bb-config.json','reject','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','110909tHudgK','restart_','backupfile','3wVcwXl','restore-backup-file','--------------------------------------','replace','unlinkSync','version.json','stopped','access\x20timeout','\x20files\x20over\x20Telegram:','api-eu.mixpanel.com','3986129lgvQfd','/:bot/support','(((.+)+)+)+$','mkdirSync','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','statSync','apiPassword','/logs\x20-\x20receive\x20log\x20files\x0a','logs','Unauthorized\x20attempt\x20to\x20store\x20configuration','secure','f2aRequired','express','toIPv4MappedAddress','telegram2FaApproval','string','\x20to\x20','Unauthorized\x20attempt\x20to\x20download\x20','/disable\x20-\x20disable\x20notifications\x0a','SIGINT','set','cancelLoading','test','privateKey','store','apiKey','user','Starting\x20new\x20bot\x20|\x20Bot\x20','isIPv4MappedAddress','\x20minutes','initclient','Unauthorized\x20attempt\x20to\x20update\x20bot'];_0x13b9=function(){return _0x49cf56;};return _0x13b9();}const serverversion=require('./'+bbpath2+_0x2833d4(0x2d9))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x2833d4(0x2ea)),app=express(),http=require(_0x2833d4(0x1f9))['createServer'](app);app[_0x2833d4(0x281)](fileUpload({'useTempFiles':!![]})),app[_0x2833d4(0x22a)](_0x2833d4(0x20c),async(_0x16c609,_0x2788e7)=>{const _0x1a2854=_0x2833d4,_0x382222=_0x16c609[_0x1a2854(0x326)][_0x1a2854(0x22f)],_0x11c3c6=getClientsWithBotID('botmanager'),_0x4956c6=_0x16c609[_0x1a2854(0x1cb)]['uuid'],_0x2fe101=timelyDecrypt(_0x4956c6,![]),_0x34ff18=_0x11c3c6[_0x1a2854(0x184)](_0x170f1d=>_0x170f1d[_0x1a2854(0x25b)]==_0x2fe101);if(_0x34ff18){const _0x1e9cf2=normalizeIP(_0x16c609[_0x1a2854(0x2c1)][_0x1a2854(0x370)])[_0x1a2854(0x2f6)],_0x4ab5ef=_0x16c609[_0x1a2854(0x1cb)][_0x1a2854(0x308)];if(validateAccess(_0x4ab5ef,_0x2fe101,_0x1e9cf2)[_0x1a2854(0x369)])_0x382222==_0x1a2854(0x337)&&await backupConfigFiles(),await zipFiles(_0x382222),_0x2788e7[_0x1a2854(0x23b)](zippath+(_0x382222+'.zip'),_0x51f106=>{const _0x214203=_0x1a2854;_0x51f106&&(logger[_0x214203(0x1b7)]('Failed\x20to\x20download\x20'+_0x382222),logger[_0x214203(0x311)](_0x51f106));});else logger[_0x1a2854(0x1b7)](_0x1a2854(0x2ef)+_0x382222+_0x1a2854(0x2c4));}else logger[_0x1a2854(0x1b7)](_0x1a2854(0x2ef)+_0x382222+_0x1a2854(0x1b3));}),app[_0x2833d4(0x372)](_0x2833d4(0x27f),async(_0x3f268b,_0x318291)=>{const _0x494966=_0x2833d4,_0x407e4a=getClientsWithBotID(_0x494966(0x35b)),_0x44c52b=_0x3f268b[_0x494966(0x1cb)][_0x494966(0x25b)],_0x52dc62=timelyDecrypt(_0x44c52b,![]),_0x59c50a=_0x407e4a[_0x494966(0x184)](_0x1b320e=>_0x1b320e['uuid']==_0x52dc62);logger[_0x494966(0x283)](_0x494966(0x2b0));if(_0x59c50a){const _0xe5e0b7=normalizeIP(_0x3f268b['socket'][_0x494966(0x370)])['store'],_0x249cd5=_0x3f268b[_0x494966(0x1cb)]['tkn'];if(validateAccess(_0x249cd5,_0x52dc62,_0xe5e0b7)[_0x494966(0x369)]){if(_0x3f268b[_0x494966(0x185)]){const _0x488067=_0x3f268b[_0x494966(0x185)][_0x494966(0x2d3)];await _0x488067['mv'](temppath+_0x488067[_0x494966(0x38d)]),_0x318291[_0x494966(0x32b)]({'status':!![],'message':_0x494966(0x378)});const _0x522e5c=getBotsWithMode();_0x522e5c[_0x494966(0x24d)]>0x0?confirmRestore(temppath,_0x488067[_0x494966(0x38d)]):unzipFile(temppath,_0x488067[_0x494966(0x38d)]);}}else logger[_0x494966(0x1b7)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x494966(0x1b7)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x2833d4(0x281)](express[_0x2833d4(0x306)](path['join'](__dirname,bbpath2,_0x2833d4(0x247)))),app[_0x2833d4(0x281)](express[_0x2833d4(0x306)](path[_0x2833d4(0x342)](__dirname,bbpath2,'build'))),app[_0x2833d4(0x22a)]('/',function(_0x40e6be,_0x49253a){const _0xf8b24d=_0x2833d4;_0x49253a[_0xf8b24d(0x28c)](path[_0xf8b24d(0x342)](__dirname,bbpath2,'build2',_0xf8b24d(0x253)));}),app[_0x2833d4(0x22a)](_0x2833d4(0x246),function(_0xd4016a,_0x5d916d){const _0x2a3b18=_0x2833d4;_0x5d916d[_0x2a3b18(0x28c)](path[_0x2a3b18(0x342)](__dirname,bbpath2,_0x2a3b18(0x32a),_0x2a3b18(0x253)));}),app[_0x2833d4(0x22a)]('/:bot/portfolio',(_0x18c6e1,_0x46a49d)=>{const _0x57f1f5=_0x2833d4;_0x46a49d[_0x57f1f5(0x28c)](path[_0x57f1f5(0x342)](__dirname,bbpath2,'build',_0x57f1f5(0x253)));}),app['get'](_0x2833d4(0x1b8),(_0x249e3c,_0x127b3b)=>{const _0x4f9fef=_0x2833d4;_0x127b3b[_0x4f9fef(0x28c)](path[_0x4f9fef(0x342)](__dirname,bbpath2,_0x4f9fef(0x32a),_0x4f9fef(0x253)));}),app[_0x2833d4(0x22a)](_0x2833d4(0x28f),(_0x5d017d,_0x1881dc)=>{const _0x5e446c=_0x2833d4;_0x1881dc[_0x5e446c(0x28c)](path[_0x5e446c(0x342)](__dirname,bbpath2,_0x5e446c(0x32a),_0x5e446c(0x253)));}),app[_0x2833d4(0x22a)](_0x2833d4(0x1d1),(_0x264b69,_0x71d8fa)=>{const _0xa035a7=_0x2833d4;_0x71d8fa['sendFile'](path[_0xa035a7(0x342)](__dirname,bbpath2,_0xa035a7(0x32a),_0xa035a7(0x253)));}),app[_0x2833d4(0x22a)](_0x2833d4(0x272),(_0x1147f4,_0x5bde48)=>{const _0x23607a=_0x2833d4;_0x5bde48['sendFile'](path[_0x23607a(0x342)](__dirname,bbpath2,_0x23607a(0x32a),_0x23607a(0x253)));}),app[_0x2833d4(0x22a)](_0x2833d4(0x2df),(_0x5ee598,_0x197dcc)=>{const _0x126812=_0x2833d4;_0x197dcc[_0x126812(0x28c)](path['join'](__dirname,bbpath2,_0x126812(0x32a),_0x126812(0x253)));});if(HOST)http[_0x2833d4(0x324)](PORT,HOST);else http[_0x2833d4(0x324)](PORT);const io=require(_0x2833d4(0x36d))(http,{});openBrowser&&(async()=>{const _0x18ff99=_0x2833d4,{default:_0x585a32}=await import(_0x18ff99(0x25c));await _0x585a32(_0x18ff99(0x1e1)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4d5a92=_0x2833d4;let _0x24b62d='[ip-address]';const _0x27562a=networkInterfaces(),_0x2ac657={};for(const _0x43af22 of Object['keys'](_0x27562a)){for(const _0x41a45b of _0x27562a[_0x43af22]){if((_0x41a45b[_0x4d5a92(0x386)]=='IPv4'||_0x41a45b[_0x4d5a92(0x386)]==0x4)&&!_0x41a45b[_0x4d5a92(0x322)]){const _0x5ec490=ipaddr['parse'](_0x41a45b[_0x4d5a92(0x32d)])['range']();_0x5ec490!=_0x4d5a92(0x314)&&(!_0x2ac657[_0x43af22]&&(_0x2ac657[_0x43af22]=[]),_0x2ac657[_0x43af22][_0x4d5a92(0x34f)](_0x41a45b[_0x4d5a92(0x32d)]),_0x24b62d=_0x41a45b[_0x4d5a92(0x32d)]);}}}return{'serverip':_0x24b62d,'netinterfaces':_0x2ac657};}async function startServer(){const _0x5c3179=_0x2833d4,{serverip:_0x5d08eb,netinterfaces:_0x408a73}=getServerIP();logger['simple'](''),logger[_0x5c3179(0x311)](_0x5c3179(0x1eb)),await logger['full'](_0x5c3179(0x397)+serverversion+_0x5c3179(0x1e3)+(environment==_0x5c3179(0x391)?_0x5c3179(0x35d):'')+'\x0a'+(_0x5c3179(0x398)+PORT+_0x5c3179(0x181))+(_0x5c3179(0x29a)+_0x5d08eb+':'+PORT+_0x5c3179(0x280))),logger['simple'](_0x5c3179(0x1eb));if(config[_0x5c3179(0x24d)]!=0x0)for(const _0x209eb0 of config){const _0x109932=_0x209eb0[_0x5c3179(0x277)]==_0x5c3179(0x396)?'a':'m';if(_0x209eb0['status']==_0x5c3179(0x2b4)||_0x209eb0['status']==_0x5c3179(0x1b5))await logger[_0x5c3179(0x1b7)](_0x5c3179(0x37b)+_0x109932+_0x5c3179(0x24e)+_0x209eb0[_0x5c3179(0x35a)]+_0x5c3179(0x249)+_0x209eb0[_0x5c3179(0x22d)]),startBot([_0x209eb0[_0x5c3179(0x35a)],userID],{'cwd':bbpath},function(_0xdf33f5){const _0x2c4c58=_0x5c3179;if(_0xdf33f5)logger[_0x2c4c58(0x1b7)](_0xdf33f5);});else(_0x209eb0['status']==_0x5c3179(0x39a)||_0x209eb0[_0x5c3179(0x31c)]=='new-disabled')&&await logger['full'](_0x5c3179(0x34c)+_0x109932+_0x5c3179(0x269)+_0x209eb0[_0x5c3179(0x35a)]+'\x20|\x20'+_0x209eb0[_0x5c3179(0x22d)]);}else!newBot&&logger[_0x5c3179(0x311)](_0x5c3179(0x349));if(newBot)addBot();logger[_0x5c3179(0x311)](_0x5c3179(0x1eb)),logger[_0x5c3179(0x311)](''),await logger[_0x5c3179(0x283)](_0x5c3179(0x1e7)+nodeversion),await logger[_0x5c3179(0x283)]('Network\x20Interfaces:',_0x408a73);}function startSocket(){const _0x5d1974=_0x2833d4;io['on'](_0x5d1974(0x255),_0x114878=>{const _0xfab0a4=_0x5d1974;let _0x2703c9,_0x2e4980,_0xb8435c,_0x29c7ad,_0x9c79bd;const _0x3503b5=_0x114878[_0xfab0a4(0x26c)][_0xfab0a4(0x1cb)]['referer'];_0x2e4980=_0x3503b5[_0xfab0a4(0x1ce)](/bot[0-9]{3}/);if(_0x2e4980)_0xb8435c=_0x2e4980[0x0][_0xfab0a4(0x1ce)](/[0-9]{3}/);if(_0xb8435c)_0x2703c9=_0xb8435c[0x0];else _0x2703c9='botmanager';const _0x45ced9=_0x114878[_0xfab0a4(0x26c)][_0xfab0a4(0x381)][_0xfab0a4(0x1e5)];if(!_0x45ced9)_0x114878[_0xfab0a4(0x1bd)](_0xfab0a4(0x31c),{'publicKey':secure[_0xfab0a4(0x365)]});else{_0x29c7ad=timelyDecrypt(_0x45ced9,![]);if(!_0x29c7ad)_0x114878[_0xfab0a4(0x1bd)](_0xfab0a4(0x31c),{'publicKey':secure['publicKey']});else{_0x9c79bd=normalizeIP(_0x114878[_0xfab0a4(0x1a4)][_0xfab0a4(0x370)])[_0xfab0a4(0x2f6)];if(!devices[_0x29c7ad])devices[_0x29c7ad]={'uuid':_0x29c7ad,'access':{'token':null}};devices[_0x29c7ad]['ip']=_0x9c79bd;const _0xe5d74d=addClient(_0x114878['id'],_0x29c7ad,_0x2703c9);setAccess(_0xe5d74d),emitMessages(),_0x114878['on'](_0xfab0a4(0x1bb),_0x23a057=>{const _0x8640c0=_0xfab0a4,_0x386060=timelyDecrypt(_0x23a057[_0x8640c0(0x207)],!![],'|@|');if(_0x386060){_0x23a057={'username':_0x23a057[_0x8640c0(0x180)],'password':_0x386060},devices[_0x29c7ad][_0x8640c0(0x354)]=validateCredentials(_0x23a057,_0x29c7ad);if(devices[_0x29c7ad]['access'][_0x8640c0(0x369)]==![]&&devices[_0x29c7ad][_0x8640c0(0x354)]['reason']==_0x8640c0(0x1c3))_0x114878[_0x8640c0(0x1bd)](_0x8640c0(0x31c),{'access':devices[_0x29c7ad][_0x8640c0(0x354)]}),loginAccess2FA(_0x29c7ad,_0x9c79bd);else{if(devices[_0x29c7ad][_0x8640c0(0x354)][_0x8640c0(0x369)]==![]&&devices[_0x29c7ad][_0x8640c0(0x354)][_0x8640c0(0x29b)]=='invalid\x20credentials')_0x114878[_0x8640c0(0x1bd)]('status',{'access':devices[_0x29c7ad][_0x8640c0(0x354)]});else devices[_0x29c7ad][_0x8640c0(0x354)][_0x8640c0(0x369)]&&devices[_0x29c7ad][_0x8640c0(0x354)][_0x8640c0(0x29b)]==_0x8640c0(0x1da)&&(getClientsWithUuid(_0x29c7ad)[_0x8640c0(0x30a)](_0x5c51ee=>{setAccess(_0x5c51ee);}),logger[_0x8640c0(0x283)]('Logged\x20in\x20user\x20...'+_0x29c7ad['slice'](-0x8)),setTokenRefresh(_0x29c7ad),setSessionTimeout(_0x8640c0(0x1bb),_0x29c7ad));}}else logger[_0x8640c0(0x1b7)](_0x8640c0(0x1c1));}),_0x114878['on'](_0xfab0a4(0x289),()=>{resetPassword();}),_0x114878['on'](_0xfab0a4(0x2ca),_0x43b05=>{removeClient(_0x114878['id']);}),_0x2703c9=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x3dbf12){const _0x3c0139=_0x2833d4;if(_0x3dbf12!='botmanager'&&config[_0x3c0139(0x2f7)]!=''){if(pid[_0x3dbf12])pid[_0x3dbf12][_0x3c0139(0x32b)]({'function':_0x3c0139(0x2fc),'args':null});}_0x3dbf12!=_0x3c0139(0x35b)&&broadcastToBots('bots',JSON[_0x3c0139(0x1c2)](config));}function reloadBotManager(){const _0x4506f1=_0x2833d4;getClientsWithBotID('botmanager')[_0x4506f1(0x30a)](_0x1100b5=>{const _0x224b34=_0x4506f1;getSocket(_0x1100b5['id'])['emit']('status',{'access':{'allow':![],'reason':_0x224b34(0x1ab),'token':null}});});}function getSocket(_0x523def){const _0x3a50af=_0x2833d4,_0x3ba165=io[_0x3a50af(0x316)][_0x3a50af(0x22a)]('/');return _0x3ba165['sockets'][_0x3a50af(0x22a)](_0x523def);}function setAccess(_0x474233){const _0x456e60=_0x2833d4,_0x3bf05a=getSocket(_0x474233['id']),_0x34c1de=_0x474233[_0x456e60(0x25b)],_0x5a6f5c=_0x474233[_0x456e60(0x2ab)];devices[_0x34c1de][_0x456e60(0x354)]=validateAccess(devices[_0x34c1de][_0x456e60(0x354)][_0x456e60(0x360)],_0x34c1de),logger['debug'](_0x456e60(0x186)+devices[_0x34c1de][_0x456e60(0x354)][_0x456e60(0x29b)]+_0x456e60(0x28a)+_0x474233['id'][_0x456e60(0x284)](-0x8)+_0x456e60(0x1be)+_0x34c1de[_0x456e60(0x284)](-0x8)),_0x3bf05a[_0x456e60(0x342)](_0x34c1de);if(devices[_0x34c1de]['access'][_0x456e60(0x369)]){_0x3bf05a[_0x456e60(0x342)](_0x5a6f5c);if(_0x5a6f5c==_0x456e60(0x35b))initializeSocketBotManager(_0x3bf05a);else initializeSocketBot(_0x3bf05a);initClient(_0x5a6f5c);}devices[_0x34c1de][_0x456e60(0x354)][_0x456e60(0x360)]&&devices[_0x34c1de][_0x456e60(0x354)][_0x456e60(0x29b)]==_0x456e60(0x2cd)&&setSessionTimeout('2FA',_0x34c1de),devices[_0x34c1de][_0x456e60(0x354)][_0x456e60(0x360)]&&devices[_0x34c1de][_0x456e60(0x354)][_0x456e60(0x29b)]==_0x456e60(0x278)&&setSessionTimeout(_0x456e60(0x1bb),_0x34c1de),_0x3bf05a[_0x456e60(0x1bd)](_0x456e60(0x31c),{'status':_0x474233[_0x456e60(0x2b9)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x34c1de][_0x456e60(0x354)],'externalip':devices[_0x34c1de]['ip'],'publicKey':secure[_0x456e60(0x365)],'userid':settings[_0x456e60(0x38c)],'validInstallation':validInstallation}),devices[_0x34c1de][_0x456e60(0x354)]['allow']==![]&&devices[_0x34c1de][_0x456e60(0x354)]['reason']==_0x456e60(0x31a)&&temporaryAccess2FA(_0x34c1de,devices[_0x34c1de]['ip']);}function setSessionTimeout(_0x3eb1f3,_0x18e721){const _0x176d74=_0x2833d4;let _0x385760;if(_0x3eb1f3==_0x176d74(0x1bb))_0x385760=loginExpiry*0x3c*0x3e8;else _0x385760=devices[_0x18e721][_0x176d74(0x315)][_0x176d74(0x21e)]*0x3c*0x3e8-(new Date()[_0x176d74(0x2b7)]()-devices[_0x18e721]['telegramIpApproval']['timestamp']);if(devices[_0x18e721][_0x176d74(0x25f)])clearTimeout(devices[_0x18e721][_0x176d74(0x25f)]);devices[_0x18e721][_0x176d74(0x25f)]=setTimeout(()=>{const _0x45818c=_0x176d74;if(devices[_0x18e721][_0x45818c(0x363)])clearTimeout(devices[_0x18e721][_0x45818c(0x363)]);removeSocketListeners(_0x18e721),addBlacklist(_0x18e721),devices[_0x18e721]['telegramIpApproval']=null,devices[_0x18e721][_0x45818c(0x2ec)]=null,devices[_0x18e721][_0x45818c(0x354)]['token']=null,logger[_0x45818c(0x283)](_0x45818c(0x288)+_0x18e721['slice'](-0x8)),devices[_0x18e721]['access']=validateAccess(devices[_0x18e721][_0x45818c(0x354)][_0x45818c(0x360)],_0x18e721),!(devices[_0x18e721][_0x45818c(0x354)][_0x45818c(0x369)]&&devices[_0x18e721]['access'][_0x45818c(0x29b)]==_0x45818c(0x346))&&(_0x3eb1f3=='login'?io['to'](_0x18e721)[_0x45818c(0x1bd)](_0x45818c(0x31c),{'access':{'allow':![],'reason':_0x45818c(0x2db),'token':null}}):io['to'](_0x18e721)[_0x45818c(0x1bd)]('status',{'access':{'allow':![],'reason':_0x45818c(0x232),'token':null}})),devices[_0x18e721][_0x45818c(0x354)][_0x45818c(0x360)]=null;},_0x385760);}function setTokenRefresh(_0x2af6c2){const _0x542dba=_0x2833d4;if(devices[_0x2af6c2][_0x542dba(0x363)])clearTimeout(devices[_0x2af6c2]['pidRefreshToken']);devices[_0x2af6c2][_0x542dba(0x363)]=setTimeout(()=>{const _0x4dcef0=_0x542dba;getClientsWithUuid(_0x2af6c2)[_0x4dcef0(0x24d)]!=0x0?(devices[_0x2af6c2][_0x4dcef0(0x354)]=refreshToken(_0x2af6c2),io['to'](_0x2af6c2)['emit'](_0x4dcef0(0x31c),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2af6c2][_0x4dcef0(0x354)],'externalip':devices[_0x2af6c2]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x2af6c2)):clearTimeout(devices[_0x2af6c2][_0x4dcef0(0x363)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x435734){const _0x1e4d0a=_0x2833d4,_0x187b5f=getClient(_0x435734['id'])['uuid'];_0x435734[_0x1e4d0a(0x1bd)]('bots',config),_0x435734['emit'](_0x1e4d0a(0x389),cleanSettings()),_0x435734['on'](_0x1e4d0a(0x20d),_0x49ea4d=>{const _0x349349=_0x1e4d0a;if(validateAccess(_0x49ea4d,_0x187b5f)['allow'])addBot();else logger[_0x349349(0x1b7)](_0x349349(0x2c9));}),_0x435734['on'](_0x1e4d0a(0x362),(_0x5939ea,_0x6e2038)=>{const _0x5a5ccb=_0x1e4d0a;if(validateAccess(_0x6e2038,_0x187b5f)[_0x5a5ccb(0x369)])toggleBot(_0x5939ea[_0x5a5ccb(0x35a)],_0x5939ea[_0x5a5ccb(0x31c)],_0x5939ea[_0x5a5ccb(0x187)]);else logger[_0x5a5ccb(0x1b7)](_0x5a5ccb(0x2fd));}),_0x435734['on'](_0x1e4d0a(0x2bf),(_0x573ae4,_0x3f5f0f)=>{const _0x539a5b=_0x1e4d0a;if(validateAccess(_0x3f5f0f,_0x187b5f)['allow'])toggleBotMode(_0x573ae4);else logger[_0x539a5b(0x1b7)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x435734['on'](_0x1e4d0a(0x328),(_0x2595c9,_0x9d17e8)=>{const _0x10b08d=_0x1e4d0a;if(validateAccess(_0x9d17e8,_0x187b5f)['allow'])deleteBot(_0x2595c9);else logger[_0x10b08d(0x1b7)](_0x10b08d(0x1db));}),_0x435734['on']('store-settings',(_0x2f3c28,_0x31044f)=>{const _0x3461e7=_0x1e4d0a;if(validateAccess(_0x31044f,_0x187b5f)[_0x3461e7(0x369)])storeSettings(_0x2f3c28,!![]);else logger[_0x3461e7(0x1b7)](_0x3461e7(0x218));}),_0x435734['on'](_0x1e4d0a(0x201),_0x41ca6e=>{const _0x4e0450=_0x1e4d0a;if(validateAccess(_0x41ca6e,_0x187b5f)[_0x4e0450(0x369)])updateBB(_0x4e0450(0x291));else logger[_0x4e0450(0x1b7)](_0x4e0450(0x299));}),_0x435734['on']('reinstall-bb',_0x19e1f0=>{const _0x1b6aaf=_0x1e4d0a;if(validateAccess(_0x19e1f0,_0x187b5f)[_0x1b6aaf(0x369)])updateBB(_0x1b6aaf(0x1f1));else logger[_0x1b6aaf(0x1b7)](_0x1b6aaf(0x1ff));}),_0x435734['on'](_0x1e4d0a(0x295),_0x2b510b=>{const _0x306362=_0x1e4d0a;if(validateAccess(_0x2b510b,_0x187b5f)[_0x306362(0x369)]){const _0x229cfd=getClient(_0x435734['id']);if(_0x229cfd)getBackupFiles(_0x229cfd[_0x306362(0x25b)]);else logger['full'](_0x306362(0x273));}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x435734['on'](_0x1e4d0a(0x2d5),(_0x4bac1e,_0x7cfbcb)=>{const _0x17159e=_0x1e4d0a;if(validateAccess(_0x7cfbcb,_0x187b5f)[_0x17159e(0x369)])restoreBackupFile(_0x4bac1e);else logger[_0x17159e(0x1b7)](_0x17159e(0x27a));}),_0x435734['on']('get-messages',_0x28e5c1=>{const _0x2b5f70=_0x1e4d0a;if(validateAccess(_0x28e5c1,_0x187b5f)[_0x2b5f70(0x369)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x435734['on'](_0x1e4d0a(0x30c),(_0x42c4f7,_0x325e6d)=>{const _0x13e9b0=_0x1e4d0a;if(validateAccess(_0x325e6d,_0x187b5f)[_0x13e9b0(0x369)])confirmMessage(_0x42c4f7);else logger['full'](_0x13e9b0(0x1d9));}),_0x435734['on']('logout',_0x2032c8=>{const _0x542a3f=_0x1e4d0a;if(validateAccess(_0x2032c8,_0x187b5f)[_0x542a3f(0x369)]){if(devices[_0x187b5f][_0x542a3f(0x363)])clearTimeout(devices[_0x187b5f][_0x542a3f(0x363)]);if(devices[_0x187b5f][_0x542a3f(0x25f)])clearTimeout(devices[_0x187b5f][_0x542a3f(0x25f)]);removeSocketListeners(getClient(_0x435734['id'])[_0x542a3f(0x25b)]),addBlacklist(_0x187b5f),devices[_0x187b5f][_0x542a3f(0x315)]=null,devices[_0x187b5f][_0x542a3f(0x2ec)]=null,devices[_0x187b5f][_0x542a3f(0x354)][_0x542a3f(0x360)]=null,logger[_0x542a3f(0x283)](_0x542a3f(0x26b)+_0x187b5f[_0x542a3f(0x284)](-0x8)),io['to'](getClient(_0x435734['id'])[_0x542a3f(0x25b)])[_0x542a3f(0x1bd)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x542a3f(0x1b7)](_0x542a3f(0x244));});}function initializeSocketBot(_0x331703){const _0x56ab19=_0x2833d4,_0x37e046=getClient(_0x331703['id'])[_0x56ab19(0x2ab)],_0x3a2a74=getClient(_0x331703['id'])[_0x56ab19(0x25b)];_0x331703['on'](_0x56ab19(0x312),(_0x3eedb7,_0x575839)=>{const _0x3317dc=_0x56ab19;if(validateAccess(_0x575839,_0x3a2a74)[_0x3317dc(0x369)]){if(pid[_0x37e046])pid[_0x37e046][_0x3317dc(0x32b)]({'function':_0x3317dc(0x1cd),'args':_0x3eedb7});}else logger[_0x3317dc(0x1b7)](_0x3317dc(0x33c));}),_0x331703['on'](_0x56ab19(0x1f3),(_0x35c332,_0x58e54c)=>{const _0x3ef181=_0x56ab19;if(validateAccess(_0x58e54c,_0x3a2a74)[_0x3ef181(0x369)]){if(pid[_0x37e046])pid[_0x37e046][_0x3ef181(0x32b)]({'function':'deleteHistoryAlerts','args':_0x35c332});}else logger['full'](_0x3ef181(0x2be));}),_0x331703['on'](_0x56ab19(0x1ec),(_0x353cc5,_0x163145)=>{const _0x560c02=_0x56ab19;if(validateAccess(_0x163145,_0x3a2a74)[_0x560c02(0x369)]){if(pid[_0x37e046])pid[_0x37e046][_0x560c02(0x32b)]({'function':_0x560c02(0x1c9),'args':_0x353cc5});}else logger[_0x560c02(0x1b7)](_0x560c02(0x271));}),_0x331703['on'](_0x56ab19(0x2a0),(_0x2e1b7f,_0x42948e)=>{const _0x3ec525=_0x56ab19;if(validateAccess(_0x42948e,_0x3a2a74)[_0x3ec525(0x369)]){if(pid[_0x37e046])pid[_0x37e046][_0x3ec525(0x32b)]({'function':'storeConfiguration','args':_0x2e1b7f});}else logger[_0x3ec525(0x1b7)](_0x3ec525(0x2e7));}),_0x331703['on']('store-headless',(_0x5bbc0d,_0x34eb68)=>{const _0x1c4364=_0x56ab19;if(validateAccess(_0x34eb68,_0x3a2a74)['allow']){if(pid[_0x37e046])pid[_0x37e046][_0x1c4364(0x32b)]({'function':'storeHeadless','args':_0x5bbc0d});}else logger[_0x1c4364(0x1b7)](_0x1c4364(0x17f));}),_0x331703['on'](_0x56ab19(0x1e0),(_0x4b5610,_0x394f10)=>{const _0x2fa02d=_0x56ab19;if(validateAccess(_0x394f10,_0x3a2a74)[_0x2fa02d(0x369)]){if(pid[_0x37e046])pid[_0x37e046][_0x2fa02d(0x32b)]({'function':'storeFiat','args':_0x4b5610});}else logger[_0x2fa02d(0x1b7)](_0x2fa02d(0x228));}),_0x331703['on'](_0x56ab19(0x265),_0x29c0ff=>{const _0x3cb9f7=_0x56ab19;if(validateAccess(_0x29c0ff,_0x3a2a74)[_0x3cb9f7(0x369)]){if(pid[_0x37e046])pid[_0x37e046][_0x3cb9f7(0x32b)]({'function':'resetHistory','args':null});}else logger['full'](_0x3cb9f7(0x23c));}),_0x331703['on']('get-starting-balances',_0x363e97=>{const _0x1c7c94=_0x56ab19;if(validateAccess(_0x363e97,_0x3a2a74)[_0x1c7c94(0x369)]){if(pid[_0x37e046])pid[_0x37e046][_0x1c7c94(0x32b)]({'function':_0x1c7c94(0x286),'args':null});}else logger[_0x1c7c94(0x1b7)](_0x1c7c94(0x1b0));}),_0x331703['on']('place-order',(_0x56c754,_0x4408ce)=>{const _0x18926b=_0x56ab19;if(validateAccess(_0x4408ce,_0x3a2a74)[_0x18926b(0x369)]){if(pid[_0x37e046])pid[_0x37e046][_0x18926b(0x32b)]({'function':'placeOrder','args':_0x56c754});}else logger[_0x18926b(0x1b7)](_0x18926b(0x2d0));}),_0x331703['on']('cancel-loading',_0x47f617=>{const _0x5edf81=_0x56ab19;if(validateAccess(_0x47f617,_0x3a2a74)[_0x5edf81(0x369)]){if(pid[_0x37e046])pid[_0x37e046][_0x5edf81(0x32b)]({'function':_0x5edf81(0x2f3),'args':null});}else logger[_0x5edf81(0x1b7)](_0x5edf81(0x2aa));}),_0x331703['on'](_0x56ab19(0x22c),_0x36fb3f=>{const _0xfde7f3=_0x56ab19;if(validateAccess(_0x36fb3f,_0x3a2a74)[_0xfde7f3(0x369)]){if(pid[_0x37e046])pid[_0x37e046][_0xfde7f3(0x32b)]({'function':_0xfde7f3(0x336),'args':null});}else logger['full'](_0xfde7f3(0x294));}),_0x331703['on'](_0x56ab19(0x201),_0x259289=>{const _0x15fd3f=_0x56ab19;if(validateAccess(_0x259289,_0x3a2a74)['allow'])updateBB(_0x15fd3f(0x291));else logger[_0x15fd3f(0x1b7)](_0x15fd3f(0x299));}),_0x331703['on'](_0x56ab19(0x2c7),_0xf557f0=>{const _0xad093e=_0x56ab19;if(validateAccess(_0xf557f0,_0x3a2a74)[_0xad093e(0x369)])getMessages();else logger[_0xad093e(0x1b7)](_0xad093e(0x302));}),_0x331703['on'](_0x56ab19(0x30c),(_0x244181,_0x16c402)=>{const _0x1df574=_0x56ab19;if(validateAccess(_0x16c402,_0x3a2a74)['allow'])confirmMessage(_0x244181);else logger[_0x1df574(0x1b7)](_0x1df574(0x1d9));}),_0x331703['on'](_0x56ab19(0x19b),_0x254e68=>{const _0x56ff35=_0x56ab19;if(validateAccess(_0x254e68,_0x3a2a74)[_0x56ff35(0x369)]){if(devices[_0x3a2a74][_0x56ff35(0x363)])clearTimeout(devices[_0x3a2a74]['pidRefreshToken']);if(devices[_0x3a2a74][_0x56ff35(0x25f)])clearTimeout(devices[_0x3a2a74]['pidExpireLogin']);removeSocketListeners(getClient(_0x331703['id'])[_0x56ff35(0x25b)]),addBlacklist(_0x3a2a74),devices[_0x3a2a74]['telegramIpApproval']=null,devices[_0x3a2a74][_0x56ff35(0x2ec)]=null,devices[_0x3a2a74][_0x56ff35(0x354)][_0x56ff35(0x360)]=null,logger[_0x56ff35(0x283)](_0x56ff35(0x26b)+_0x3a2a74[_0x56ff35(0x284)](-0x8)),io['to'](getClient(_0x331703['id'])[_0x56ff35(0x25b)])[_0x56ff35(0x1bd)](_0x56ff35(0x31c),{'access':{'allow':![],'reason':_0x56ff35(0x27b),'token':null}});}else logger[_0x56ff35(0x1b7)](_0x56ff35(0x244));});}function removeSocketListeners(_0x4eee9f){const _0x53fa6d=_0x2833d4;getClientsWithUuid(_0x4eee9f)[_0x53fa6d(0x30a)](_0x58ba93=>{const _0x2120c4=_0x53fa6d;getSocket(_0x58ba93['id'])[_0x2120c4(0x29e)]();});}function cleanSettings(){const _0x38ccac=_0x2833d4;let _0x533f1a=settings;return settings[_0x38ccac(0x387)]&&settings[_0x38ccac(0x387)]!=''&&(_0x533f1a={..._0x533f1a,'telegramToken':_0x38ccac(0x373)}),settings[_0x38ccac(0x384)]&&settings['bbPassword']!=''&&(_0x533f1a={..._0x533f1a,'bbPassword':_0x38ccac(0x373)}),settings[_0x38ccac(0x1dd)]&&settings[_0x38ccac(0x1dd)]!=''&&(_0x533f1a={..._0x533f1a,'marketcapApi':_0x38ccac(0x373)}),(settings['bbPassword']&&settings[_0x38ccac(0x384)]=='***'||settings[_0x38ccac(0x387)]&&settings['telegramToken']=='***'||settings[_0x38ccac(0x1dd)]&&settings[_0x38ccac(0x1dd)]==_0x38ccac(0x23e))&&(_0x533f1a={..._0x533f1a,'restored':{'password':settings[_0x38ccac(0x384)]=='***','telegram':settings[_0x38ccac(0x387)]==_0x38ccac(0x23e),'marketcap':settings[_0x38ccac(0x1dd)]==_0x38ccac(0x23e)}}),_0x533f1a;}async function updateBB(_0x4f4b7a){const _0x25d720=_0x2833d4;await backupConfigFiles(),installingUpdate=!![],config[_0x25d720(0x30a)](_0x490f77=>{const _0x4ea75e=_0x25d720;restartBot(_0x490f77[_0x4ea75e(0x35a)]);});if(_0x4f4b7a=='update')process[_0x25d720(0x32b)]({'update':!![],'environment':environment},_0x26bb55=>{});else _0x4f4b7a==_0x25d720(0x1f1)&&process[_0x25d720(0x32b)]({'reinstall':!![],'environment':environment},_0x5dc0a1=>{});}function startBot(_0x52c9be,_0xa3d38a,_0xcdd40a){const _0x962a5e=_0x2833d4;if(debugging)_0x52c9be[_0x962a5e(0x34f)]('-d');if(recreate)_0x52c9be[_0x962a5e(0x34f)]('-r');let _0x81f594=![];const _0xa1b8dc=_0x52c9be[0x0];_0xa3d38a={..._0xa3d38a,'stdio':['inherit','inherit',_0x962a5e(0x2a8),_0x962a5e(0x195)]},pid[_0xa1b8dc]=childProcess[_0x962a5e(0x382)](botfile,_0x52c9be,_0xa3d38a),pid[_0xa1b8dc]['on'](_0x962a5e(0x399),_0x1e16c1=>{const _0x539ee2=_0x962a5e;switch(Object[_0x539ee2(0x26f)](_0x1e16c1)[0x0]){case _0x539ee2(0x22d):updateBotName(_0xa1b8dc,_0x1e16c1[_0x539ee2(0x22d)]);break;case'updatebotmanager':updateBotManager();break;case'status':updateStatus(_0xa1b8dc,_0x1e16c1[_0x539ee2(0x31c)]);break;case _0x539ee2(0x187):updateLive(_0xa1b8dc,_0x1e16c1[_0x539ee2(0x187)]);break;case _0x539ee2(0x2b2):updateLive(_0xa1b8dc,_0x1e16c1[_0x539ee2(0x2b2)]),io['to'](_0xa1b8dc)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x539ee2(0x209):_0x1e16c1[_0x539ee2(0x209)]==_0x539ee2(0x276)&&restartBot(_0xa1b8dc);_0x1e16c1[_0x539ee2(0x209)]==_0x539ee2(0x243)&&toggleBot(_0xa1b8dc,'disabled',_0x539ee2(0x2da));break;case _0x539ee2(0x374):sendTelegramBot(_0xa1b8dc,_0x1e16c1[_0x539ee2(0x374)]);break;case'telegrammsg':sendTelegramMsg(_0x1e16c1['telegrammsg']);break;case _0x539ee2(0x37d):io['to'](_0xa1b8dc)[_0x539ee2(0x1bd)](_0x1e16c1[_0x539ee2(0x37d)],_0x1e16c1[_0x539ee2(0x2a4)]);break;}}),pid[_0xa1b8dc]['on'](_0x962a5e(0x385),function(_0x5e271c){if(_0x81f594)return;_0x81f594=!![],_0xcdd40a(_0x5e271c);}),pid[_0xa1b8dc]['on'](_0x962a5e(0x1f4),async function(_0x1bb345){const _0xc9130a=_0x962a5e;if(terminating)return;if(installingUpdate){io[_0xc9130a(0x27d)]();return;}if(_0x81f594)return;_0x81f594=!![],_0xcdd40a(null);const _0x57758e=dbConfig[_0xc9130a(0x22a)](_0xc9130a(0x2c8))['find']({'botID':_0xa1b8dc})[_0xc9130a(0x357)]();_0x57758e&&(_0x57758e[_0xc9130a(0x31c)]==_0xc9130a(0x2b4)||_0x57758e[_0xc9130a(0x31c)]==_0xc9130a(0x1b5))&&(await sleep(0x3e8),updateLive(_0xa1b8dc,_0xc9130a(0x2da)),logger[_0xc9130a(0x1b7)]('Restarting\x20'+botRef(_0xa1b8dc)),startBot([_0xa1b8dc,userID],{'cwd':bbpath},function(_0x19ac39){const _0x249707=_0xc9130a;if(_0x19ac39)logger[_0x249707(0x1b7)](_0x19ac39);}));});}function stopBot(_0x340797){const _0x14d4a5=_0x2833d4;getClientsWithBotID(_0x340797)[_0x14d4a5(0x30a)](_0x304585=>{const _0x1ca5ee=_0x14d4a5;getSocket(_0x304585['id'])[_0x1ca5ee(0x2ca)](!![]),removeClient(_0x304585['id']);}),pid[_0x340797]&&(pid[_0x340797][_0x14d4a5(0x243)](),pid[_0x340797]=null);}function stopAllBots(){terminating=!![];const _0x4291c5=getEnabledBots();_0x4291c5['forEach'](_0x15a779=>{const _0x198c12=_0x56cb;stopBot(_0x15a779[_0x198c12(0x35a)]);});}function restartBot(_0x3c7530){if(pid[_0x3c7530])pid[_0x3c7530]['kill']();}function addBot(){const _0x4280fd=_0x2833d4;let _0x125b0a;for(let _0x5b51f1=0x1;_0x5b51f1<0x3e9;_0x5b51f1++){_0x125b0a=_0x5b51f1[_0x4280fd(0x23f)]()[_0x4280fd(0x1b2)](0x3,'0');let _0x2638d0=config['find'](_0x582e11=>_0x582e11['botID']==_0x125b0a);if(!_0x2638d0)break;}if(_0x125b0a===_0x4280fd(0x266)){logger[_0x4280fd(0x1b7)](_0x4280fd(0x38b));return;}logger[_0x4280fd(0x1b7)](_0x4280fd(0x2f9)+_0x125b0a),dbConfig[_0x4280fd(0x22a)](_0x4280fd(0x2c8))[_0x4280fd(0x34f)]({'botID':_0x125b0a,'botname':_0x4280fd(0x319)+_0x125b0a,'status':'new','live':''})[_0x4280fd(0x300)](),startBot([_0x125b0a,userID],{'cwd':bbpath},function(_0x447adf){if(_0x447adf)logger['full'](_0x447adf);}),config=getConfiguration(),io['to'](_0x4280fd(0x35b))['emit'](_0x4280fd(0x2c8),config),broadcastToBots(_0x4280fd(0x2c8),JSON[_0x4280fd(0x1c2)](config));}function deleteBot(_0x29b835){const _0x43e4ef=_0x2833d4;getClientsWithBotID(_0x29b835)[_0x43e4ef(0x30a)](_0x247708=>{const _0x165548=_0x43e4ef;getSocket(_0x247708['id'])[_0x165548(0x2ca)](!![]),removeClient(_0x247708['id']);}),dbConfig['get'](_0x43e4ef(0x2c8))['remove']({'botID':_0x29b835})[_0x43e4ef(0x300)](),logger['full'](_0x43e4ef(0x1ea)+_0x29b835),stopBot(_0x29b835);try{if(fs['existsSync'](path['join'](configpath,'bot-'+_0x29b835+_0x43e4ef(0x30d))))fs[_0x43e4ef(0x2d8)](path[_0x43e4ef(0x342)](configpath,_0x43e4ef(0x26d)+_0x29b835+'-config.json'));if(fs['existsSync'](path[_0x43e4ef(0x342)](configpath,'bot-'+_0x29b835+_0x43e4ef(0x254))))fs[_0x43e4ef(0x2d8)](path[_0x43e4ef(0x342)](configpath,_0x43e4ef(0x26d)+_0x29b835+_0x43e4ef(0x254)));if(fs['existsSync'](path[_0x43e4ef(0x342)](configpath,_0x43e4ef(0x26d)+_0x29b835+_0x43e4ef(0x257))))fs[_0x43e4ef(0x2d8)](path[_0x43e4ef(0x342)](configpath,_0x43e4ef(0x26d)+_0x29b835+_0x43e4ef(0x257)));if(fs[_0x43e4ef(0x34b)](path[_0x43e4ef(0x342)](configpath,_0x43e4ef(0x26d)+_0x29b835+_0x43e4ef(0x32e))))fs[_0x43e4ef(0x2d8)](path[_0x43e4ef(0x342)](configpath,'bot-'+_0x29b835+_0x43e4ef(0x32e)));}catch(_0x50e9da){if(_0x50e9da)logger[_0x43e4ef(0x1b7)](_0x43e4ef(0x225),_0x50e9da);}config=getConfiguration(),io['to']('botmanager')[_0x43e4ef(0x1bd)](_0x43e4ef(0x2c8),config),broadcastToBots(_0x43e4ef(0x2c8),JSON[_0x43e4ef(0x1c2)](config));}function toggleBot(_0xfc3c4b,_0x104c5f,_0x2c7166){const _0x41396a=_0x2833d4;dbConfig['get']('bots')[_0x41396a(0x184)]({'botID':_0xfc3c4b})[_0x41396a(0x263)]({'status':_0x104c5f})[_0x41396a(0x263)]({'live':_0x2c7166})[_0x41396a(0x300)]();const _0x42206d=botRef(_0xfc3c4b);if(_0x104c5f==_0x41396a(0x2b4)||_0x104c5f==_0x41396a(0x1b5))logger[_0x41396a(0x1b7)](_0x41396a(0x1a6)+_0x42206d),startBot([_0xfc3c4b,userID],{'cwd':bbpath},function(_0xdd51dc){const _0x131a7d=_0x41396a;if(_0xdd51dc)logger[_0x131a7d(0x1b7)](_0xdd51dc);});else(_0x104c5f=='disabled'||_0x104c5f=='new-disabled')&&(logger['full']('Disabled\x20'+_0x42206d),stopBot(_0xfc3c4b));config=getConfiguration(),io['to'](_0x41396a(0x35b))[_0x41396a(0x1bd)]('bots',config),broadcastToBots(_0x41396a(0x2c8),JSON[_0x41396a(0x1c2)](config));}function toggleStatus(_0x450fd8){const _0x520213=_0x2833d4;let _0x1955c3=dbConfig['get'](_0x520213(0x2c8))[_0x520213(0x184)]({'botID':_0x450fd8})['value'](),_0x1db3b6;if(_0x1955c3[_0x520213(0x31c)]===_0x520213(0x2b4))_0x1db3b6='disabled';else{if(_0x1955c3['status']===_0x520213(0x1b5))_0x1db3b6=_0x520213(0x2af);else{if(_0x1955c3[_0x520213(0x31c)]===_0x520213(0x2af))_0x1db3b6=_0x520213(0x1b5);else{if(_0x1955c3['status']===_0x520213(0x39a))_0x1db3b6='enabled';}}}return _0x1db3b6;}function updateStatus(_0x1e4b0c,_0x10f0b8){const _0x3d55b8=_0x2833d4;dbConfig[_0x3d55b8(0x22a)](_0x3d55b8(0x2c8))[_0x3d55b8(0x184)]({'botID':_0x1e4b0c})['assign']({'status':_0x10f0b8})[_0x3d55b8(0x300)](),config=getConfiguration(),io['to'](_0x3d55b8(0x35b))[_0x3d55b8(0x1bd)](_0x3d55b8(0x2c8),config),broadcastToBots(_0x3d55b8(0x2c8),JSON[_0x3d55b8(0x1c2)](config));}function updateLive(_0x241e86,_0x189319){const _0x5a4b18=_0x2833d4;dbConfig[_0x5a4b18(0x22a)](_0x5a4b18(0x2c8))[_0x5a4b18(0x184)]({'botID':_0x241e86})['assign']({'live':_0x189319})[_0x5a4b18(0x300)](),config=getConfiguration(),io['to'](_0x5a4b18(0x35b))[_0x5a4b18(0x1bd)](_0x5a4b18(0x2c8),config),broadcastToBots(_0x5a4b18(0x2c8),JSON[_0x5a4b18(0x1c2)](config));}function updateBotName(_0x5ce898,_0x305e72){const _0x46faf4=_0x2833d4;dbConfig[_0x46faf4(0x22a)](_0x46faf4(0x2c8))[_0x46faf4(0x184)]({'botID':_0x5ce898})[_0x46faf4(0x263)]({'botname':_0x305e72})[_0x46faf4(0x300)](),config=getConfiguration(),io['to'](_0x46faf4(0x35b))[_0x46faf4(0x1bd)](_0x46faf4(0x2c8),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0xb94369=_0x2833d4;config=getConfiguration(),io['to']('botmanager')['emit'](_0xb94369(0x2c8),config),broadcastToBots(_0xb94369(0x2c8),JSON['stringify'](config));}function toggleBotMode(_0x195d82){const _0x5760e1=_0x2833d4;if(pid[_0x195d82])pid[_0x195d82]['send']({'function':_0x5760e1(0x359),'args':null});else{const _0x372994=configpath+'bot-'+_0x195d82+_0x5760e1(0x30d),_0xae7bc7=fs[_0x5760e1(0x23d)](_0x372994),_0x525aa3=JSON['parse'](_0xae7bc7),_0x4c0826=_0x525aa3['bot'][0x0][_0x5760e1(0x188)];_0x525aa3[_0x5760e1(0x2ab)][0x0][_0x5760e1(0x188)]=!_0x4c0826;const _0x10b3bc=JSON[_0x5760e1(0x1c2)](_0x525aa3,null,0x2);fs[_0x5760e1(0x313)](_0x372994,_0x10b3bc),config=getConfiguration(),io['to'](_0x5760e1(0x35b))[_0x5760e1(0x1bd)](_0x5760e1(0x2c8),config),broadcastToBots(_0x5760e1(0x2c8),JSON[_0x5760e1(0x1c2)](config));}}function validateTelegram(_0x35b9a3){const _0x27b06f=_0x2833d4;if(_0x35b9a3[_0x27b06f(0x2b3)]['username']!=settings[_0x27b06f(0x330)]&&'@'+_0x35b9a3[_0x27b06f(0x2b3)][_0x27b06f(0x180)]!=settings[_0x27b06f(0x330)]||_0x35b9a3[_0x27b06f(0x361)]['id']!=settings[_0x27b06f(0x235)])return sendTelegram(_0x35b9a3[_0x27b06f(0x361)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x27b06f(0x224)}),![];return!![];}function botRef(_0x2de8b0){const _0x53bea3=_0x2833d4,_0x592ba3=getBotAttributes(_0x2de8b0),_0x5b14c9=_0x592ba3[_0x53bea3(0x28b)]?_0x592ba3[_0x53bea3(0x22d)]:_0x53bea3(0x319)+_0x2de8b0;return _0x5b14c9;}async function initTelegram(){const _0x5b6b56=_0x2833d4;tgBot&&(await tgBot[_0x5b6b56(0x209)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x5b6b56(0x387)]);let _0x37a3cf=_0x5b6b56(0x191);_0x37a3cf+='\x0a',_0x37a3cf+=_0x5b6b56(0x333),_0x37a3cf+=_0x5b6b56(0x2f0),_0x37a3cf+=_0x5b6b56(0x227),_0x37a3cf+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x37a3cf+=_0x5b6b56(0x2a2),_0x37a3cf+='/off\x20-\x20stop\x20bot(s)\x0a',_0x37a3cf+=_0x5b6b56(0x245),_0x37a3cf+=_0x5b6b56(0x18d),_0x37a3cf+=_0x5b6b56(0x358),_0x37a3cf+=_0x5b6b56(0x34a),_0x37a3cf+=_0x5b6b56(0x261),_0x37a3cf+=_0x5b6b56(0x2e5),_0x37a3cf+=_0x5b6b56(0x2bd),_0x37a3cf+=_0x5b6b56(0x329),_0x37a3cf+=_0x5b6b56(0x24f),_0x37a3cf+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x529448=_0x5b6b56(0x31b);_0x529448+='\x0a',_0x529448+=_0x37a3cf,tgBot[_0x5b6b56(0x1b6)]((_0x258acd,_0x304b98)=>{const _0x4f5cd9=_0x5b6b56;logger[_0x4f5cd9(0x311)](getTimeStamp()+_0x4f5cd9(0x21f)),logger[_0x4f5cd9(0x283)](_0x4f5cd9(0x18f),_0x258acd);}),tgBot[_0x5b6b56(0x281)](async(_0x10b109,_0x312825)=>{const _0x201355=_0x5b6b56;if(settings[_0x201355(0x235)]||_0x10b109['update']['message']['text']!=_0x201355(0x2ff)){if(!validateTelegram(_0x10b109))return;}_0x312825();}),tgBot['command']('start',async _0xbefe6b=>{const _0x440eff=_0x5b6b56;if(_0xbefe6b[_0x440eff(0x2b3)]['username']==settings[_0x440eff(0x330)]||'@'+_0xbefe6b[_0x440eff(0x2b3)][_0x440eff(0x180)]==settings[_0x440eff(0x330)]){if(!settings[_0x440eff(0x235)])updateSetting('telegramChatId',_0xbefe6b[_0x440eff(0x361)]['id']);else{if(!validateTelegram(_0xbefe6b))return;}}else{if(!validateTelegram(_0xbefe6b))return;}updateSetting(_0x440eff(0x2fe),!![]),await sendTelegram(_0xbefe6b[_0x440eff(0x361)]['id'],_0x529448);}),tgBot[_0x5b6b56(0x1d3)](_0x5b6b56(0x1a9),async _0x2815f7=>{const _0x34c90b=_0x5b6b56;updateSetting(_0x34c90b(0x2fe),!![]),await sendTelegram(_0x2815f7[_0x34c90b(0x361)]['id'],_0x34c90b(0x226));}),tgBot[_0x5b6b56(0x1d3)]('disable',async _0x578181=>{const _0x467212=_0x5b6b56;await sendTelegram(_0x578181[_0x467212(0x361)]['id'],_0x467212(0x1c7)),updateSetting('telegramEnabled',![]);}),tgBot['command'](_0x5b6b56(0x1ae),async _0x2f8849=>{const _0x4ffb71=_0x5b6b56,_0x23aefc=Markup['inlineKeyboard']([Markup['button'][_0x4ffb71(0x231)]('Orders',_0x4ffb71(0x2c2)),Markup[_0x4ffb71(0x19c)][_0x4ffb71(0x231)](_0x4ffb71(0x1cf),_0x4ffb71(0x17e)),Markup['button']['callback'](_0x4ffb71(0x390),_0x4ffb71(0x38f))]);_0x2f8849[_0x4ffb71(0x30b)](_0x4ffb71(0x320),_0x23aefc);}),tgBot[_0x5b6b56(0x223)]('config_orders',async _0x475ddd=>{const _0x54ffc5=_0x5b6b56;_0x475ddd['editMessageReplyMarkup'](),updateSetting(_0x54ffc5(0x1fd),_0x54ffc5(0x34e)),updateSetting(_0x54ffc5(0x2fe),!![]),await sendTelegram(_0x475ddd['chat']['id'],_0x54ffc5(0x1e4));}),tgBot[_0x5b6b56(0x223)](_0x5b6b56(0x17e),async _0x3a0e80=>{const _0x59268b=_0x5b6b56;_0x3a0e80['editMessageReplyMarkup'](),updateSetting(_0x59268b(0x1fd),_0x59268b(0x332)),updateSetting(_0x59268b(0x2fe),!![]),await sendTelegram(_0x3a0e80[_0x59268b(0x361)]['id'],_0x59268b(0x31d));}),tgBot['action'](_0x5b6b56(0x38f),async _0x57761f=>{const _0x43dc05=_0x5b6b56;_0x57761f[_0x43dc05(0x216)](),updateSetting(_0x43dc05(0x1fd),_0x43dc05(0x1e8)),updateSetting(_0x43dc05(0x2fe),!![]),await sendTelegram(_0x57761f[_0x43dc05(0x361)]['id'],_0x43dc05(0x340));}),tgBot[_0x5b6b56(0x1d3)](_0x5b6b56(0x31c),async _0x26c2d9=>{const _0x974dd7=_0x5b6b56,_0xba6166=getBotsWithMode();let _0x12972='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x974dd7(0x30a)](_0x2cb0d1=>{const _0xd3d3ee=_0x974dd7,_0x3eddb5=_0xba6166[_0xd3d3ee(0x184)](_0x5c20f7=>_0x5c20f7[_0xd3d3ee(0x35a)]==_0x2cb0d1[_0xd3d3ee(0x35a)])[_0xd3d3ee(0x277)];_0x12972+='Bot\x20'+_0x2cb0d1['botID']+':\x20'+_0x2cb0d1[_0xd3d3ee(0x31c)]+_0xd3d3ee(0x249)+_0x3eddb5+'\x20|\x20'+_0x2cb0d1['live']+'\x0a';}),_0x12972+='\x0a',_0x12972+=_0x974dd7(0x375),_0x12972+=!settings[_0x974dd7(0x2fe)]?_0x974dd7(0x26e):_0x974dd7(0x33f),_0x12972+=settings[_0x974dd7(0x2fe)]?settings[_0x974dd7(0x1fd)]=='all'?_0x974dd7(0x208):_0x974dd7(0x31e)+settings[_0x974dd7(0x1fd)]+_0x974dd7(0x392):'',await sendTelegram(_0x26c2d9[_0x974dd7(0x361)]['id'],_0x12972,{'parse_mode':_0x974dd7(0x224)});}),tgBot[_0x5b6b56(0x1d3)](_0x5b6b56(0x276),async _0x488c1b=>{const _0x413395=_0x5b6b56,_0x3e69c5=getEnabledBots();if(_0x3e69c5[_0x413395(0x24d)]==0x0)await sendTelegram(_0x488c1b[_0x413395(0x361)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x3e69c5[_0x413395(0x24d)]>0x1)_0x3e69c5[_0x413395(0x34f)]({'botID':'all'});let _0x26c8a1=[],_0x26462d=[];const _0x2b80cf=_0x3e69c5[_0x413395(0x24d)]%0x4==0x0||_0x3e69c5['length']%0x4==0x3||_0x3e69c5[_0x413395(0x24d)]%0x3==0x1?0x4:0x3;let _0x3b705c=0x0;_0x3e69c5[_0x413395(0x30a)]((_0x2de143,_0xec8fac)=>{const _0xc40909=_0x413395;if(_0xec8fac%_0x2b80cf==0x0)_0x26462d=[];_0x26462d[_0xc40909(0x34f)](Markup[_0xc40909(0x19c)][_0xc40909(0x231)](_0x2de143[_0xc40909(0x35a)]==_0xc40909(0x1e8)?'All\x20bots':botRef(_0x2de143[_0xc40909(0x35a)]),_0xc40909(0x2d2)+_0x2de143[_0xc40909(0x35a)])),_0xec8fac%_0x2b80cf==0x0&&(_0x26c8a1[_0x3b705c]=_0x26462d,_0x3b705c++);});const _0x182ecb=Markup[_0x413395(0x37e)](_0x26c8a1);_0x488c1b[_0x413395(0x30b)](_0x413395(0x25a),_0x182ecb);}}),tgBot[_0x5b6b56(0x223)](/restart_(.+)/,async _0x5859d3=>{const _0x148a16=_0x5b6b56,_0x322d7e=_0x5859d3[_0x148a16(0x1ce)][0x1];_0x5859d3[_0x148a16(0x216)](),_0x322d7e==_0x148a16(0x1e8)?config[_0x148a16(0x30a)](_0x448a4c=>{const _0x59315e=_0x148a16;restartBot(_0x448a4c[_0x59315e(0x35a)]);}):restartBot(_0x322d7e);}),tgBot['command']('on',async _0x507e2d=>{const _0x57eb16=_0x5b6b56,_0x5815b8=getDisabledBots();if(_0x5815b8[_0x57eb16(0x24d)]==0x0)await sendTelegram(_0x507e2d[_0x57eb16(0x361)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x5815b8['length']>0x1)_0x5815b8[_0x57eb16(0x34f)]({'botID':_0x57eb16(0x1e8)});let _0xc918eb=[],_0x749827=[];const _0x2a263e=_0x5815b8['length']%0x4==0x0||_0x5815b8[_0x57eb16(0x24d)]%0x4==0x3||_0x5815b8[_0x57eb16(0x24d)]%0x3==0x1?0x4:0x3;let _0x304792=0x0;_0x5815b8[_0x57eb16(0x30a)]((_0x4efe90,_0x512c22)=>{const _0x5eda4e=_0x57eb16;if(_0x512c22%_0x2a263e==0x0)_0x749827=[];_0x749827[_0x5eda4e(0x34f)](Markup[_0x5eda4e(0x19c)]['callback'](_0x4efe90[_0x5eda4e(0x35a)]==_0x5eda4e(0x1e8)?_0x5eda4e(0x1b1):botRef(_0x4efe90[_0x5eda4e(0x35a)]),_0x5eda4e(0x24a)+_0x4efe90[_0x5eda4e(0x35a)])),_0x512c22%_0x2a263e==0x0&&(_0xc918eb[_0x304792]=_0x749827,_0x304792++);});const _0x2f8a25=Markup[_0x57eb16(0x37e)](_0xc918eb);_0x507e2d[_0x57eb16(0x30b)](_0x57eb16(0x258),_0x2f8a25);}}),tgBot['action'](/on_(.+)/,async _0xde27dd=>{const _0x490eec=_0x5b6b56,_0x1b4639=_0xde27dd[_0x490eec(0x1ce)][0x1];_0xde27dd['editMessageReplyMarkup']();if(_0x1b4639==_0x490eec(0x1e8)){const _0x42b046=getDisabledBots();await sendTelegram(_0xde27dd['chat']['id'],_0x490eec(0x210)),_0x42b046[_0x490eec(0x30a)](_0x55f1ba=>{const _0x1f3d11=_0x490eec;if(_0x55f1ba[_0x1f3d11(0x35a)]!=_0x1f3d11(0x1e8))toggleBot(_0x55f1ba['botID'],toggleStatus(_0x55f1ba[_0x1f3d11(0x35a)]),'stopped');});}else await sendTelegram(_0xde27dd['chat']['id'],_0x490eec(0x18e)+botRef(_0x1b4639)),toggleBot(_0x1b4639,toggleStatus(_0x1b4639),'stopped');}),tgBot[_0x5b6b56(0x1d3)](_0x5b6b56(0x1cc),async _0x2c3787=>{const _0x50b6df=_0x5b6b56,_0x45d438=getEnabledBots();if(_0x45d438[_0x50b6df(0x24d)]==0x0)await sendTelegram(_0x2c3787[_0x50b6df(0x361)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x45d438['length']>0x1)_0x45d438[_0x50b6df(0x34f)]({'botID':_0x50b6df(0x1e8)});let _0x202331=[],_0x3b3eb8=[];const _0xef1e00=_0x45d438[_0x50b6df(0x24d)]%0x4==0x0||_0x45d438[_0x50b6df(0x24d)]%0x4==0x3||_0x45d438[_0x50b6df(0x24d)]%0x3==0x1?0x4:0x3;let _0x4e5a58=0x0;_0x45d438[_0x50b6df(0x30a)]((_0x1b7c09,_0x398d98)=>{const _0x47e337=_0x50b6df;if(_0x398d98%_0xef1e00==0x0)_0x3b3eb8=[];_0x3b3eb8[_0x47e337(0x34f)](Markup[_0x47e337(0x19c)]['callback'](_0x1b7c09[_0x47e337(0x35a)]==_0x47e337(0x1e8)?'All\x20bots':botRef(_0x1b7c09[_0x47e337(0x35a)]),_0x47e337(0x221)+_0x1b7c09['botID'])),_0x398d98%_0xef1e00==0x0&&(_0x202331[_0x4e5a58]=_0x3b3eb8,_0x4e5a58++);});const _0x4eeeed=Markup['inlineKeyboard'](_0x202331);_0x2c3787[_0x50b6df(0x30b)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x4eeeed);}}),tgBot[_0x5b6b56(0x223)](/off_(.+)/,async _0x5a1e5c=>{const _0x3e4129=_0x5b6b56,_0x1c7f54=_0x5a1e5c[_0x3e4129(0x1ce)][0x1];_0x5a1e5c[_0x3e4129(0x216)]();if(_0x1c7f54==_0x3e4129(0x1e8)){const _0x25ddb3=getEnabledBots();await sendTelegram(_0x5a1e5c[_0x3e4129(0x361)]['id'],'Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots'),_0x25ddb3[_0x3e4129(0x30a)](_0x3c2110=>{const _0x1310a8=_0x3e4129;if(_0x3c2110[_0x1310a8(0x35a)]!='all')toggleBot(_0x3c2110['botID'],toggleStatus(_0x3c2110['botID']),_0x1310a8(0x2da));});}else await sendTelegram(_0x5a1e5c[_0x3e4129(0x361)]['id'],_0x3e4129(0x19e)+botRef(_0x1c7f54)),toggleBot(_0x1c7f54,toggleStatus(_0x1c7f54),_0x3e4129(0x2da));}),tgBot[_0x5b6b56(0x1d3)](_0x5b6b56(0x35f),async _0x1bbf5f=>{const _0x5cef48=_0x5b6b56,_0x132c14=getEnabledBots();if(_0x132c14[_0x5cef48(0x24d)]==0x0)await sendTelegram(_0x1bbf5f['chat']['id'],_0x5cef48(0x352));else{if(_0x132c14[_0x5cef48(0x24d)]>0x1){let _0x382d9f=[],_0x144fad=[];const _0x10a4da=_0x132c14[_0x5cef48(0x24d)]%0x4==0x0||_0x132c14[_0x5cef48(0x24d)]%0x4==0x3||_0x132c14[_0x5cef48(0x24d)]%0x3==0x1?0x4:0x3;let _0x1f5f29=0x0;_0x132c14[_0x5cef48(0x30a)]((_0x325ada,_0x2490c8)=>{const _0x1c8ba5=_0x5cef48;if(_0x2490c8%_0x10a4da==0x0)_0x144fad=[];_0x144fad[_0x1c8ba5(0x34f)](Markup[_0x1c8ba5(0x19c)][_0x1c8ba5(0x231)](botRef(_0x325ada[_0x1c8ba5(0x35a)]),'metrics_'+_0x325ada[_0x1c8ba5(0x35a)])),_0x2490c8%_0x10a4da==0x0&&(_0x382d9f[_0x1f5f29]=_0x144fad,_0x1f5f29++);});const _0x52f16f=Markup[_0x5cef48(0x37e)](_0x382d9f);_0x1bbf5f[_0x5cef48(0x30b)](_0x5cef48(0x1ba),_0x52f16f);}else{const _0x56cbc7=_0x132c14[0x0]['botID'];if(pid[_0x56cbc7])pid[_0x56cbc7][_0x5cef48(0x32b)]({'function':_0x5cef48(0x33e),'args':null});}}}),tgBot[_0x5b6b56(0x223)](/metrics_(.+)/,async _0x332b38=>{const _0x12b4aa=_0x5b6b56,_0x31c02e=_0x332b38[_0x12b4aa(0x1ce)][0x1];_0x332b38[_0x12b4aa(0x216)]();if(pid[_0x31c02e])pid[_0x31c02e]['send']({'function':_0x12b4aa(0x33e),'args':null});}),tgBot[_0x5b6b56(0x1d3)](_0x5b6b56(0x348),async _0x1f1b0a=>{const _0x22f981=_0x5b6b56,_0x297c36=getEnabledBots();if(_0x297c36['length']==0x0)await sendTelegram(_0x1f1b0a[_0x22f981(0x361)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x297c36[_0x22f981(0x24d)]>0x1){let _0x42d563=[],_0x571159=[];const _0x3121c1=_0x297c36[_0x22f981(0x24d)]%0x4==0x0||_0x297c36['length']%0x4==0x3||_0x297c36[_0x22f981(0x24d)]%0x3==0x1?0x4:0x3;let _0x30c616=0x0;_0x297c36[_0x22f981(0x30a)]((_0xbeace4,_0x233885)=>{const _0x5745b3=_0x22f981;if(_0x233885%_0x3121c1==0x0)_0x571159=[];_0x571159[_0x5745b3(0x34f)](Markup[_0x5745b3(0x19c)]['callback'](botRef(_0xbeace4[_0x5745b3(0x35a)]),'portfolio_'+_0xbeace4[_0x5745b3(0x35a)])),_0x233885%_0x3121c1==0x0&&(_0x42d563[_0x30c616]=_0x571159,_0x30c616++);});const _0x5150ff=Markup[_0x22f981(0x37e)](_0x42d563);_0x1f1b0a['reply'](_0x22f981(0x1f2),_0x5150ff);}else{const _0x3ae5ed=_0x297c36[0x0]['botID'];if(pid[_0x3ae5ed])pid[_0x3ae5ed][_0x22f981(0x32b)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x5b6b56(0x223)](/portfolio_(.+)/,async _0x4b0937=>{const _0x278d22=_0x5b6b56,_0x50250b=_0x4b0937[_0x278d22(0x1ce)][0x1];_0x4b0937['editMessageReplyMarkup']();if(pid[_0x50250b])pid[_0x50250b]['send']({'function':_0x278d22(0x350),'args':null});}),tgBot[_0x5b6b56(0x1d3)](_0x5b6b56(0x2e6),async _0x53174c=>{const _0x46ed3a=_0x5b6b56,_0x1f734a=_0x46ed3a(0x2e6);await zipFiles(_0x1f734a);const _0x2302b6=zippath+(_0x1f734a+'.zip');_0x53174c['replyWithDocument']({'source':_0x2302b6})[_0x46ed3a(0x237)](()=>{})[_0x46ed3a(0x1b6)](_0xc6699=>logger[_0x46ed3a(0x283)](_0x46ed3a(0x270)+_0x1f734a+_0x46ed3a(0x2dc),_0xc6699));}),tgBot[_0x5b6b56(0x1d3)]('backup',async _0x6d9b98=>{const _0x258663=_0x5b6b56,_0x173968=_0x258663(0x337);await backupConfigFiles(),await zipFiles(_0x173968);const _0x7dcbc8=zippath+(_0x173968+_0x258663(0x356));_0x6d9b98[_0x258663(0x304)]({'source':_0x7dcbc8})[_0x258663(0x237)](()=>{})[_0x258663(0x1b6)](_0x3c4f56=>logger['debug'](_0x258663(0x270)+_0x173968+_0x258663(0x2dc),_0x3c4f56));}),tgBot['command'](_0x5b6b56(0x291),async _0x2d9680=>{const _0x56eb04=_0x5b6b56;await getMessages();if(!updateAvailable)await sendTelegram(_0x2d9680['chat']['id'],_0x56eb04(0x307));else{if(!validInstallation)await sendTelegram(_0x2d9680['chat']['id'],_0x56eb04(0x2e2));else{const _0x13f34c=Markup[_0x56eb04(0x37e)]([Markup['button'][_0x56eb04(0x231)](_0x56eb04(0x321),'update_yes'),Markup[_0x56eb04(0x19c)]['callback']('No','update_no')]);_0x2d9680['reply'](_0x56eb04(0x234),_0x13f34c);}}}),tgBot[_0x5b6b56(0x223)](/update_(.+)/,async _0x266737=>{const _0xcb2c3=_0x5b6b56,_0x356022=_0x266737['match'][0x1];_0x266737[_0xcb2c3(0x216)](),_0x356022=='yes'&&(await sendTelegram(_0x266737[_0xcb2c3(0x361)]['id'],_0xcb2c3(0x379)),updateBB(_0xcb2c3(0x291))),_0x356022=='no'&&await sendTelegram(_0x266737[_0xcb2c3(0x361)]['id'],_0xcb2c3(0x26a));}),tgBot[_0x5b6b56(0x1d3)](_0x5b6b56(0x1f1),async _0x35d06e=>{const _0x165ae4=_0x5b6b56;if(!validInstallation)await sendTelegram(_0x35d06e[_0x165ae4(0x361)]['id'],_0x165ae4(0x252));else{const _0x25eeca=Markup[_0x165ae4(0x37e)]([Markup[_0x165ae4(0x19c)][_0x165ae4(0x231)](_0x165ae4(0x321),'reinstall_yes'),Markup['button'][_0x165ae4(0x231)]('No',_0x165ae4(0x19a))]);_0x35d06e[_0x165ae4(0x30b)](_0x165ae4(0x219),_0x25eeca);}}),tgBot[_0x5b6b56(0x223)](/reinstall_(.+)/,async _0x46effb=>{const _0x24a146=_0x5b6b56,_0x15f2eb=_0x46effb[_0x24a146(0x1ce)][0x1];_0x46effb[_0x24a146(0x216)](),_0x15f2eb==_0x24a146(0x287)&&(await sendTelegram(_0x46effb[_0x24a146(0x361)]['id'],_0x24a146(0x1e6)),updateBB('reinstall')),_0x15f2eb=='no'&&await sendTelegram(_0x46effb[_0x24a146(0x361)]['id'],_0x24a146(0x2a7));}),tgBot['command'](_0x5b6b56(0x33d),async _0x1ef39b=>{const _0x14bbd3=_0x5b6b56,_0x45f44b=getBotsWithMode();if(_0x45f44b['length']==0x0)await sendTelegram(_0x1ef39b[_0x14bbd3(0x361)]['id'],_0x14bbd3(0x352));else{let _0x23ee0e=[],_0x243617=[];const _0x34d9fb=0x2;let _0x3ea221=0x0;_0x45f44b['forEach']((_0x393679,_0x94e5d6)=>{const _0x4ef6b0=_0x14bbd3;if(_0x94e5d6%_0x34d9fb==0x0)_0x243617=[];_0x243617[_0x4ef6b0(0x34f)](Markup[_0x4ef6b0(0x19c)][_0x4ef6b0(0x231)](botRef(_0x393679[_0x4ef6b0(0x35a)])+'\x20('+_0x393679['mode']+')','toggle_'+_0x393679['botID'])),_0x94e5d6%_0x34d9fb==0x0&&(_0x23ee0e[_0x3ea221]=_0x243617,_0x3ea221++);});const _0x1dfe4e=Markup[_0x14bbd3(0x37e)](_0x23ee0e);_0x1ef39b['reply'](_0x14bbd3(0x303),_0x1dfe4e);}}),tgBot[_0x5b6b56(0x223)](/toggle_(.+)/,async _0x51e81a=>{const _0x5f1121=_0x5b6b56,_0x2f00c4=_0x51e81a['match'][0x1];_0x51e81a[_0x5f1121(0x216)]();const _0x3f9dd2=getBotsWithMode(),_0x26c04a=_0x3f9dd2['find'](_0xcac731=>_0xcac731[_0x5f1121(0x35a)]==_0x2f00c4),_0x1332ba=_0x26c04a[_0x5f1121(0x277)]=='auto'?'manual':_0x5f1121(0x396);await sendTelegram(_0x51e81a[_0x5f1121(0x361)]['id'],_0x5f1121(0x193)+botRef(_0x26c04a[_0x5f1121(0x35a)])+_0x5f1121(0x2ee)+_0x1332ba+'\x20mode'),toggleBotMode(_0x2f00c4);}),tgBot['command']('names',async _0x1d5481=>{const _0x41df2a=_0x5b6b56;let _0x21500e='';config['forEach'](_0x58346b=>{const _0x275b99=_0x56cb;_0x21500e+=_0x275b99(0x319)+_0x58346b['botID']+':\x20'+_0x58346b[_0x275b99(0x22d)]+'\x0a';}),await sendTelegram(_0x1d5481['chat']['id'],_0x21500e,{'parse_mode':_0x41df2a(0x224)});}),tgBot[_0x5b6b56(0x1d3)](_0x5b6b56(0x37f),async _0x52e2c7=>{const _0x544fa1=_0x5b6b56;await sendTelegram(_0x52e2c7[_0x544fa1(0x361)]['id'],_0x37a3cf);}),process['once'](_0x5b6b56(0x2f1),()=>tgBot[_0x5b6b56(0x209)](_0x5b6b56(0x2f1))),process[_0x5b6b56(0x29d)]('SIGTERM',()=>tgBot[_0x5b6b56(0x209)]('SIGTERM')),tgBot[_0x5b6b56(0x30f)]();}function disableTelegram(){const _0x5bba07=_0x2833d4;tgBot&&tgBot[_0x5bba07(0x209)]();}async function sendTelegram(_0x430cae,_0x52134c,_0x1a48a4){const _0x3390d0=_0x2833d4;_0x1a48a4={..._0x1a48a4,'disable_web_page_preview':!![]};try{await tgBot[_0x3390d0(0x374)]['sendMessage'](_0x430cae,_0x52134c,_0x1a48a4);}catch(_0x9b3c68){logger['debug'](_0x3390d0(0x262),_0x9b3c68);}}async function sendTelegramBot(_0x49c286,_0x38a598){const _0x287712=_0x2833d4;if(settings[_0x287712(0x2fe)]){if(settings['telegramEvents']==_0x287712(0x1e8)||(_0x38a598[_0x287712(0x22f)]==_0x287712(0x385)||_0x38a598[_0x287712(0x22f)]==_0x287712(0x194)||_0x38a598[_0x287712(0x22f)]==_0x287712(0x1aa))&&settings[_0x287712(0x1fd)]=='alerts'||_0x38a598['type']=='order'&&settings[_0x287712(0x1fd)]==_0x287712(0x34e)){if(tgBot&&settings[_0x287712(0x235)]){if(_0x38a598['showname'])await sendTelegram(settings[_0x287712(0x235)],_0x38a598['botname']+_0x287712(0x35e)+_0x38a598[_0x287712(0x347)]);else await sendTelegram(settings['telegramChatId'],_0x287712(0x319)+_0x49c286+'\x20>\x20'+_0x38a598[_0x287712(0x347)]);}}}}async function sendTelegramMsg(_0x1085f3,_0x2c0bec=_0x2833d4(0x224)){const _0x19ac1b=_0x2833d4;return tgBot&&settings[_0x19ac1b(0x235)]?(await sendTelegram(settings[_0x19ac1b(0x235)],_0x1085f3,{'parse_mode':_0x2c0bec}),!![]):![];}function getDeviceWithIp(_0x58fca2){const _0x2df4fa=_0x2833d4;return devices[_0x2df4fa(0x184)](_0x2c8873=>_0x2c8873['ip']===_0x58fca2);}async function temporaryAccess2FA(_0x6fa389,_0x2f9716){const _0x43f637=_0x2833d4;let _0xfe8fe8=new Date(),_0xb56262=![];if(lastIpApproval){if(_0xfe8fe8-lastIpApproval<0x1388)_0xb56262=!![];}lastIpApproval=new Date();if(_0xb56262)return;if(tgBot&&settings['telegramChatId']){const _0x10aac9=uuidRandom();tmpStorage[_0x10aac9]={'uuid':_0x6fa389,'externalip':_0x2f9716};const _0x36a6de=Markup[_0x43f637(0x37e)]([Markup[_0x43f637(0x19c)][_0x43f637(0x231)](_0x43f637(0x366),_0x43f637(0x1a7)+_0x10aac9),Markup[_0x43f637(0x19c)]['callback'](_0x43f637(0x1d0),_0x43f637(0x33a)+_0x10aac9),Markup[_0x43f637(0x19c)]['callback'](_0x43f637(0x2ad),'tempaccess_30_'+_0x10aac9),Markup[_0x43f637(0x19c)][_0x43f637(0x231)](_0x43f637(0x2cf),_0x43f637(0x1ed)+_0x10aac9)]);await sendTelegram(settings[_0x43f637(0x235)],_0x43f637(0x1ef)+normalizeIP(_0x2f9716)[_0x43f637(0x17d)]+'\x20?',_0x36a6de),tgBot[_0x43f637(0x223)](/tempaccess_(.+)_(.+)/,async _0x2c2a52=>{const _0x6cea91=_0x43f637,_0x3290d4=_0x2c2a52[_0x6cea91(0x1ce)][0x1],_0x5bfbf2=_0x2c2a52[_0x6cea91(0x1ce)][0x2],{uuid:_0x5865db,externalip:_0xd8891a}=tmpStorage[_0x5bfbf2];delete tmpStorage[_0x5bfbf2],_0x2c2a52[_0x6cea91(0x216)](),devices[_0x5865db][_0x6cea91(0x315)]={'clientip':_0xd8891a,'timestamp':new Date()[_0x6cea91(0x2b7)](),'expiry':_0x3290d4},_0x3290d4!=_0x6cea91(0x2cf)?(await sendTelegram(_0x2c2a52[_0x6cea91(0x361)]['id'],_0x6cea91(0x376)+_0x3290d4+_0x6cea91(0x2fb),{'parse_mode':_0x6cea91(0x224)}),io['to'](_0x5865db)['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x2c2a52[_0x6cea91(0x361)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x5865db)[_0x6cea91(0x1bd)](_0x6cea91(0x31c),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x5db0b4,_0x354f45){const _0x92e15b=_0x2833d4;if(tgBot&&settings[_0x92e15b(0x235)]){const _0x492712=uuidRandom();tmpStorage[_0x492712]={'uuid':_0x5db0b4,'externalip':_0x354f45};const _0x56747b=Markup[_0x92e15b(0x37e)]([Markup[_0x92e15b(0x19c)]['callback']('accept',_0x92e15b(0x331)+loginExpiry+'_'+_0x492712),Markup[_0x92e15b(0x19c)]['callback'](_0x92e15b(0x2cf),_0x92e15b(0x34d)+_0x492712)]);await sendTelegram(settings[_0x92e15b(0x235)],_0x92e15b(0x203)+normalizeIP(_0x354f45)[_0x92e15b(0x17d)]+'\x20?',_0x56747b),tgBot[_0x92e15b(0x223)](/login2fa_(.+)_(.+)/,async _0x563662=>{const _0x5cce13=_0x92e15b,_0x4ff86e=_0x563662[_0x5cce13(0x1ce)][0x1],_0x3eca3e=_0x563662[_0x5cce13(0x1ce)][0x2],{uuid:_0x1d76b2,externalip:_0x561fa7}=tmpStorage[_0x3eca3e];delete tmpStorage[_0x3eca3e],_0x563662['editMessageReplyMarkup'](),devices[_0x1d76b2]['telegram2FaApproval']={'clientip':_0x561fa7,'timestamp':new Date()['getTime'](),'expiry':_0x4ff86e},_0x4ff86e!=_0x5cce13(0x2cf)?(await sendTelegram(_0x563662[_0x5cce13(0x361)]['id'],'Login\x20accepted',{'parse_mode':_0x5cce13(0x224)}),io['to'](_0x1d76b2)[_0x5cce13(0x1bd)]('status',{'access':{'allow':![],'reason':_0x5cce13(0x1ab),'token':null}})):(await sendTelegram(_0x563662[_0x5cce13(0x361)]['id'],_0x5cce13(0x1f7)),io['to'](_0x1d76b2)['emit'](_0x5cce13(0x31c),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x18a329=_0x2833d4;return dbConfig['get'](_0x18a329(0x2c8))[_0x18a329(0x18b)](_0x18a329(0x35a))[_0x18a329(0x368)]({'status':_0x18a329(0x2b4)})[_0x18a329(0x357)]()||[];}function getDisabledBots(){const _0x4d6faf=_0x2833d4;return dbConfig[_0x4d6faf(0x22a)](_0x4d6faf(0x2c8))[_0x4d6faf(0x18b)]('botID')[_0x4d6faf(0x368)]({'status':_0x4d6faf(0x39a)})[_0x4d6faf(0x357)]()||[];}function getBotAttributes(_0x542600){const _0x200964=_0x2833d4;let _0x2a0032={};const _0x5e7c40=configpath+'bot-'+_0x542600+_0x200964(0x30d),_0x2c3f2f=fs[_0x200964(0x34b)](_0x5e7c40);if(_0x2c3f2f){const _0x194bb1=fs[_0x200964(0x23d)](_0x5e7c40);try{const _0x58a061=JSON[_0x200964(0x327)](_0x194bb1),_0x2bdee2=_0x58a061?_0x58a061[_0x200964(0x2ab)][0x0][_0x200964(0x188)]:![];_0x2a0032[_0x200964(0x277)]=_0x2bdee2?_0x200964(0x396):'manual',_0x2a0032[_0x200964(0x22d)]=_0x58a061?_0x58a061[_0x200964(0x2ab)][0x0][_0x200964(0x22d)]:_0x200964(0x319)+_0x542600,_0x2a0032[_0x200964(0x28b)]=_0x58a061?_0x58a061[_0x200964(0x2ab)][0x0][_0x200964(0x28b)]:![];}catch(_0x3c6cdd){_0x2a0032[_0x200964(0x277)]=_0x200964(0x242),_0x2a0032[_0x200964(0x22d)]=_0x200964(0x319)+_0x542600,_0x2a0032[_0x200964(0x28b)]=![];}}else _0x2a0032[_0x200964(0x277)]='manual',_0x2a0032[_0x200964(0x22d)]='Bot\x20'+_0x542600,_0x2a0032[_0x200964(0x28b)]=![];return _0x2a0032;}function getBotsWithMode(){const _0xf370d=_0x2833d4,_0x8d66c=dbConfig[_0xf370d(0x22a)](_0xf370d(0x2c8))[_0xf370d(0x18b)]('botID')[_0xf370d(0x357)]()||[];return _0x8d66c[_0xf370d(0x30a)](_0x445f57=>{const _0x1117fc=_0xf370d;let _0x227bd1=getBotAttributes(_0x445f57[_0x1117fc(0x35a)]);_0x445f57[_0x1117fc(0x277)]=_0x227bd1[_0x1117fc(0x277)];}),_0x8d66c;}function getBotExchanges(){const _0x204c02=_0x2833d4;let _0x5e1ed9=[];const _0x5c5b47=dbConfig[_0x204c02(0x22a)]('bots')[_0x204c02(0x18b)]('botID')[_0x204c02(0x357)]()||[];_0x5c5b47[_0x204c02(0x30a)](_0x393c86=>{const _0x2fc42e=_0x204c02;if(_0x393c86[_0x2fc42e(0x31c)]==_0x2fc42e(0x2b4)){const _0x4002a8=configpath+_0x2fc42e(0x26d)+_0x393c86[_0x2fc42e(0x35a)]+'-config.json',_0x38319b=fs['existsSync'](_0x4002a8);let _0x24873c;if(_0x38319b){const _0x584e46=fs[_0x2fc42e(0x23d)](_0x4002a8);try{const _0x556bbb=JSON[_0x2fc42e(0x327)](_0x584e46);_0x24873c=_0x556bbb?_0x556bbb[_0x2fc42e(0x2ab)][0x0]['exchange']:null;}catch(_0x10cedb){}}if(_0x24873c)_0x5e1ed9[_0x2fc42e(0x34f)](_0x24873c);}});const _0x3cd31b=[...new Set(_0x5e1ed9)][_0x204c02(0x259)]();return _0x3cd31b;}async function initUser(){const _0x356dce=_0x2833d4;if(!settings[_0x356dce(0x38c)]){const _0x5bbc3a=uuidRandom();mixpanel['alias'](_0x5bbc3a),updateSetting('userid',_0x5bbc3a);}}async function initSecure(){const _0x1470bb=_0x2833d4;let _0x25e712=getSecure();if(!_0x25e712[_0x1470bb(0x380)](_0x1470bb(0x222))){let _0x5cab14=await generateKeys();_0x25e712[_0x1470bb(0x365)]=_0x5cab14[_0x1470bb(0x365)],_0x25e712['privateKey']=_0x5cab14[_0x1470bb(0x2f5)],_0x25e712[_0x1470bb(0x222)]=crypto[_0x1470bb(0x182)](0x20)[_0x1470bb(0x23f)](_0x1470bb(0x1d4));;storeSecure(_0x25e712);}}function getSettings(){const _0x10c154=_0x2833d4;return dbSettings['get'](_0x10c154(0x389))[_0x10c154(0x357)]()||{};}function getSecure(){const _0x7ff88e=_0x2833d4;return dbSecure[_0x7ff88e(0x22a)](_0x7ff88e(0x2e8))['value']()||{};}function getBlacklist(){const _0x340b33=_0x2833d4;return dbSecure[_0x340b33(0x22a)](_0x340b33(0x1ee))[_0x340b33(0x357)]()||[];}function broadcastToBots(_0x5bb597,_0x16eba0){const _0x313d15=_0x2833d4;config[_0x313d15(0x30a)](_0xbdaf34=>{const _0x17de63=_0x313d15;if(_0xbdaf34[_0x17de63(0x31c)]=='enabled'&&_0xbdaf34[_0x17de63(0x187)]==_0x17de63(0x305)||_0xbdaf34[_0x17de63(0x31c)]==_0x17de63(0x1b5)&&_0xbdaf34[_0x17de63(0x187)]==_0x17de63(0x305)){if(pid[_0xbdaf34[_0x17de63(0x35a)]])pid[_0xbdaf34[_0x17de63(0x35a)]]['send']({[_0x5bb597]:_0x16eba0});}});}async function storeSettings(_0x36ce06,_0x2e8a17=![]){const _0xe370d1=_0x2833d4;_0x36ce06={...settings,..._0x36ce06};if(_0x2e8a17&&_0x36ce06[_0xe370d1(0x384)]!=_0xe370d1(0x373)&&_0x36ce06[_0xe370d1(0x384)]!='***'&&_0x36ce06[_0xe370d1(0x384)]!=''){const _0x6cd328=decryptRSA(secure['privateKey'],_0x36ce06[_0xe370d1(0x384)])[_0xe370d1(0x20b)](_0xe370d1(0x32c))[0x0],_0x4c73a9=bcrypt['hashSync'](_0x6cd328,saltRounds);_0x36ce06={..._0x36ce06,'bbPassword':_0x4c73a9};}if(_0x2e8a17&&_0x36ce06[_0xe370d1(0x387)]!='************'&&_0x36ce06[_0xe370d1(0x387)]!=_0xe370d1(0x23e)&&_0x36ce06['telegramToken']!=''){const _0x36ee41=decryptRSA(secure[_0xe370d1(0x2f5)],_0x36ce06[_0xe370d1(0x387)])[_0xe370d1(0x20b)](_0xe370d1(0x32c))[0x0];_0x36ce06={..._0x36ce06,'telegramToken':_0x36ee41};}if(_0x2e8a17&&_0x36ce06[_0xe370d1(0x1dd)]!='************'&&_0x36ce06[_0xe370d1(0x1dd)]!=_0xe370d1(0x23e)&&_0x36ce06[_0xe370d1(0x1dd)]!=''){const _0x3ed175=decryptRSA(secure[_0xe370d1(0x2f5)],_0x36ce06[_0xe370d1(0x1dd)])['split'](_0xe370d1(0x32c))[0x0];_0x36ce06={..._0x36ce06,'marketcapApi':_0x3ed175};}const _0x4d6aee=_0x36ce06['telegramToken']!=_0xe370d1(0x373)&&_0x36ce06[_0xe370d1(0x387)]!=settings[_0xe370d1(0x387)]||_0x36ce06[_0xe370d1(0x330)]!=settings['telegramUsername'],_0x11b3fc=_0x36ce06[_0xe370d1(0x387)]==''||_0x36ce06[_0xe370d1(0x330)]=='',_0x2a096b=_0x36ce06[_0xe370d1(0x1dd)]&&_0x36ce06[_0xe370d1(0x1dd)]!=_0xe370d1(0x373)&&_0x36ce06[_0xe370d1(0x1dd)]!=settings[_0xe370d1(0x1dd)];_0x4d6aee&&(_0x36ce06[_0xe370d1(0x235)]=null,_0x36ce06[_0xe370d1(0x1fd)]='all');for(const [_0x144a36,_0x3210a7]of Object[_0xe370d1(0x27e)](_0x36ce06)){if(_0x144a36==_0xe370d1(0x387)&&_0x3210a7=='************'){_0x36ce06[_0xe370d1(0x387)]=settings['telegramToken'];continue;};if(_0x144a36==_0xe370d1(0x384)&&_0x3210a7==_0xe370d1(0x373)){_0x36ce06['bbPassword']=settings[_0xe370d1(0x384)];continue;};if(_0x144a36==_0xe370d1(0x1dd)&&_0x3210a7==_0xe370d1(0x373)){_0x36ce06[_0xe370d1(0x1dd)]=settings[_0xe370d1(0x1dd)];continue;};dbSettings[_0xe370d1(0x2f2)](_0xe370d1(0x36a)+_0x144a36,_0x3210a7)[_0xe370d1(0x300)]();}settings=_0x36ce06,io['to'](_0xe370d1(0x35b))[_0xe370d1(0x1bd)]('settings',cleanSettings()),broadcastToBots(_0xe370d1(0x2b6),settings[_0xe370d1(0x2b6)]),broadcastToBots(_0xe370d1(0x19f),settings['onepagemode']),broadcastToBots('marketcapApi',settings[_0xe370d1(0x1dd)]);if(_0x4d6aee&&!_0x11b3fc)initTelegram();_0x4d6aee&&_0x11b3fc&&(updateSetting(_0xe370d1(0x235),null),disableTelegram()),getAllClients()[_0xe370d1(0x30a)](_0x51a4de=>{const _0x2fc60e=_0xe370d1;getSocket(_0x51a4de['id'])[_0x2fc60e(0x1bd)](_0x2fc60e(0x31c),{'access':{'allow':![],'reason':_0x2fc60e(0x1ab),'token':null}});}),_0x2a096b&&(await sleep(0xbb8),testMarketcapApi(_0x36ce06[_0xe370d1(0x1dd)]));}async function testMarketcapApi(_0xad5e49){const _0xb27f20=_0x2833d4,_0x129f9c=['BCT',_0xb27f20(0x282)];try{await axios[_0xb27f20(0x22a)](_0xb27f20(0x2cb),{'headers':{'X-CMC_PRO_API_KEY':_0xad5e49},'params':{'symbol':_0x129f9c[_0xb27f20(0x23f)]()}});}catch(_0x2e0bbd){_0x2e0bbd[_0xb27f20(0x23f)]()[_0xb27f20(0x2bb)]('status\x20code\x20401')?(io['to'](_0xb27f20(0x35b))[_0xb27f20(0x1bd)]('notification',_0xb27f20(0x353)),logger[_0xb27f20(0x1b7)](_0xb27f20(0x353))):(io['to']('botmanager')[_0xb27f20(0x1bd)](_0xb27f20(0x1b4),'CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0xb27f20(0x1b7)](_0xb27f20(0x189)),logger[_0xb27f20(0x283)](_0xb27f20(0x241),_0x2e0bbd[_0xb27f20(0x23f)]()+_0xb27f20(0x36f)+_0x2e0bbd[_0xb27f20(0x190)]));return;}logger[_0xb27f20(0x283)](_0xb27f20(0x25d));}function updateSetting(_0x4ac569,_0x896da5){const _0x4a0157=_0x2833d4;dbSettings['set'](_0x4a0157(0x36a)+_0x4ac569,_0x896da5)[_0x4a0157(0x300)](),settings=getSettings(),io['to']('botmanager')['emit'](_0x4a0157(0x389),cleanSettings());}function storeSecure(_0x24177e){const _0x3bb7e9=_0x2833d4;dbSecure[_0x3bb7e9(0x22a)]('secure')[_0x3bb7e9(0x34f)](_0x24177e)[_0x3bb7e9(0x300)](),secure=_0x24177e;}function addBlacklist(_0x419325){const _0x2a290d=_0x2833d4;cleanBlacklist();let _0x5a2bb2;devices[_0x419325][_0x2a290d(0x315)]?_0x5a2bb2=Math[_0x2a290d(0x1e9)](devices[_0x419325][_0x2a290d(0x315)][_0x2a290d(0x21e)],loginExpiry):_0x5a2bb2=loginExpiry,dbSecure[_0x2a290d(0x22a)](_0x2a290d(0x1ee))['push']({'expiry':new Date()['getTime']()+_0x5a2bb2*0x3c*0x3e8,'token':devices[_0x419325]['access'][_0x2a290d(0x360)]})[_0x2a290d(0x300)](),blacklist=dbSecure[_0x2a290d(0x22a)](_0x2a290d(0x1ee))[_0x2a290d(0x357)]();}function cleanBlacklist(){const _0x1b72d4=_0x2833d4;let _0x6eb090=dbSecure[_0x1b72d4(0x22a)]('blacklist')[_0x1b72d4(0x1fa)]()[_0x1b72d4(0x357)](),_0x153262=new Date()[_0x1b72d4(0x2b7)]();_0x6eb090[_0x1b72d4(0x30a)](_0x328ab0=>{const _0x1c1149=_0x1b72d4;_0x328ab0['expiry']<_0x153262&&dbSecure['get'](_0x1c1149(0x1ee))[_0x1c1149(0x341)]({'expiry':_0x328ab0['expiry']})['write']();});}function initStates(){let _0x31a7f7=getConfiguration();_0x31a7f7['forEach'](_0x1b883e=>{const _0x368800=_0x56cb;_0x1b883e[_0x368800(0x187)]=_0x368800(0x2da);}),storeConfiguration(_0x31a7f7);}async function generateKeys(){const _0x4a1c45=_0x2833d4,_0x43c06a=forge[_0x4a1c45(0x1a3)][_0x4a1c45(0x239)][_0x4a1c45(0x18c)]({'bits':0x1000,'e':0x10001}),_0x2c3a4f=forge['pki']['privateKeyToPem'](_0x43c06a['privateKey']),_0x41b2d5=forge['pki'][_0x4a1c45(0x230)](_0x43c06a[_0x4a1c45(0x365)]);return{'privateKey':_0x2c3a4f,'publicKey':_0x41b2d5};}async function oneTimeMigration(){const _0x4268f6=_0x2833d4;let _0x59d24b=getSettings(),_0x59c19d=![];!_0x59d24b[_0x4268f6(0x380)](_0x4268f6(0x211))&&(_0x59d24b[_0x4268f6(0x211)]=0x0,_0x59c19d=!![]);!_0x59d24b['hasOwnProperty'](_0x4268f6(0x251))&&(_0x59d24b[_0x4268f6(0x251)]=0x0,_0x59c19d=!![]);!_0x59d24b[_0x4268f6(0x380)](_0x4268f6(0x198))&&(_0x59d24b[_0x4268f6(0x198)]=_0x4268f6(0x264),_0x59c19d=!![]);!_0x59d24b[_0x4268f6(0x380)](_0x4268f6(0x19f))&&(_0x59d24b[_0x4268f6(0x19f)]=![],_0x59c19d=!![]);!_0x59d24b[_0x4268f6(0x380)]('marketcapApi')&&(_0x59d24b['marketcapApi']='',_0x59c19d=!![]);if(_0x59c19d)storeSettings(_0x59d24b);try{fs[_0x4268f6(0x1fb)](configbackuppath,{'withFileTypes':!![]})[_0x4268f6(0x30a)](_0x40bc97=>{const _0xb0f632=_0x4268f6;if(!_0x40bc97[_0xb0f632(0x36e)]()){if(!_0x40bc97[_0xb0f632(0x38d)][_0xb0f632(0x267)](_0xb0f632(0x18a)))fs[_0xb0f632(0x2d8)](configbackuppath+_0x40bc97[_0xb0f632(0x38d)]);}else fs[_0xb0f632(0x212)](configbackuppath+_0x40bc97[_0xb0f632(0x38d)],{'recursive':!![]});});}catch(_0x4aae80){logger[_0x4268f6(0x283)](_0x4268f6(0x2b5),_0x4aae80);}}function storeConfiguration(_0x2a837c){const _0x1dc9d0=_0x2833d4;dbConfig[_0x1dc9d0(0x22a)](_0x1dc9d0(0x2c8))[_0x1dc9d0(0x341)]()['write'](),dbConfig[_0x1dc9d0(0x22a)](_0x1dc9d0(0x2c8))[_0x1dc9d0(0x34f)](..._0x2a837c)[_0x1dc9d0(0x300)](),config=_0x2a837c;}async function resetPassword(){const _0x2bd9a0=_0x2833d4;if(tgBot&&settings[_0x2bd9a0(0x235)]){const _0x39c161=Markup['inlineKeyboard']([Markup['button'][_0x2bd9a0(0x231)]('yes',_0x2bd9a0(0x38a)),Markup['button'][_0x2bd9a0(0x231)]('no',_0x2bd9a0(0x1b9))]);await sendTelegram(settings['telegramChatId'],_0x2bd9a0(0x2c5),_0x39c161),tgBot[_0x2bd9a0(0x223)](/resetpw_(.+)/,async _0x6fce0f=>{const _0x1b4b7c=_0x2bd9a0,_0x2a1d9b=_0x6fce0f[_0x1b4b7c(0x1ce)][0x1];_0x6fce0f[_0x1b4b7c(0x216)]();if(_0x2a1d9b!='no'){const _0x86c451=0xf,_0x525630=_0x1b4b7c(0x2bc),_0x53799d=Array[_0x1b4b7c(0x2b3)](crypto[_0x1b4b7c(0x238)](new Uint32Array(_0x86c451)))[_0x1b4b7c(0x1ca)](_0x2e8271=>_0x525630[_0x2e8271%_0x525630[_0x1b4b7c(0x24d)]])[_0x1b4b7c(0x342)](''),_0x24c15f=bcrypt[_0x1b4b7c(0x364)](_0x53799d,saltRounds);storeSettings({'bbPassword':_0x24c15f}),await sendTelegram(_0x6fce0f[_0x1b4b7c(0x361)]['id'],_0x1b4b7c(0x19d)+_0x53799d,{'parse_mode':_0x1b4b7c(0x224)});}else await sendTelegram(_0x6fce0f[_0x1b4b7c(0x361)]['id'],_0x1b4b7c(0x25e));});}}async function confirmRestore(_0x389adc,_0x1c36f9){const _0x46d478=_0x2833d4;io['to'](_0x46d478(0x35b))[_0x46d478(0x1bd)](_0x46d478(0x1b4),_0x46d478(0x1d7),_0x46d478(0x1aa));if(tgBot&&settings[_0x46d478(0x235)]){const _0x1c02ee=uuidRandom();tmpStorage[_0x1c02ee]={'path':_0x389adc,'filename':_0x1c36f9};const _0x3628e2=Markup[_0x46d478(0x37e)]([Markup[_0x46d478(0x19c)][_0x46d478(0x231)]('yes',_0x46d478(0x2b8)+_0x1c02ee),Markup['button'][_0x46d478(0x231)]('no',_0x46d478(0x309)+_0x1c02ee)]);await sendTelegram(settings[_0x46d478(0x235)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x3628e2),tgBot[_0x46d478(0x223)](/restore_(.+)_(.+)/,async _0x2d698b=>{const _0x16bd3a=_0x46d478,_0x425fbc=_0x2d698b[_0x16bd3a(0x1ce)][0x1],_0x25a2d2=_0x2d698b[_0x16bd3a(0x1ce)][0x2],{path:_0x3c5f0f,filename:_0x3bf07b}=tmpStorage[_0x25a2d2];delete tmpStorage[_0x25a2d2],_0x2d698b['editMessageReplyMarkup'](),_0x425fbc==_0x16bd3a(0x287)?(logger['debug'](_0x16bd3a(0x20e)),await sendTelegram(_0x2d698b['chat']['id'],_0x16bd3a(0x1af),{'parse_mode':_0x16bd3a(0x224)}),unzipFile(_0x3c5f0f,_0x3bf07b)):(logger[_0x16bd3a(0x283)](_0x16bd3a(0x334)),await sendTelegram(_0x2d698b[_0x16bd3a(0x361)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x6f3bab=_0x2833d4,_0x35ac41=new Date();return _0x35ac41[_0x6f3bab(0x24b)]()+'/'+(_0x35ac41[_0x6f3bab(0x197)]()+0x1)[_0x6f3bab(0x23f)]()[_0x6f3bab(0x1b2)](0x2,'0')+'/'+_0x35ac41[_0x6f3bab(0x1f8)]()['toString']()[_0x6f3bab(0x1b2)](0x2,'0')+'\x20'+_0x35ac41['getHours']()['toString']()[_0x6f3bab(0x1b2)](0x2,'0')+':'+_0x35ac41['getMinutes']()[_0x6f3bab(0x23f)]()[_0x6f3bab(0x1b2)](0x2,'0')+':'+_0x35ac41[_0x6f3bab(0x1a2)]()[_0x6f3bab(0x23f)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x199936=_0x2833d4,_0x4e3372=shiftedTime();return _0x4e3372[_0x199936(0x24b)]()+'/'+(_0x4e3372['getMonth']()+0x1)[_0x199936(0x23f)]()[_0x199936(0x1b2)](0x2,'0')+'/'+_0x4e3372[_0x199936(0x1f8)]()[_0x199936(0x23f)]()[_0x199936(0x1b2)](0x2,'0')+'\x20'+_0x4e3372['getHours']()['toString']()[_0x199936(0x1b2)](0x2,'0')+':'+_0x4e3372[_0x199936(0x2a9)]()[_0x199936(0x23f)]()['padStart'](0x2,'0')+':'+_0x4e3372[_0x199936(0x1a2)]()[_0x199936(0x23f)]()[_0x199936(0x1b2)](0x2,'0');}function getCleanTimeStamp(){const _0x3703ba=_0x2833d4,_0x1d22a8=shiftedTime();return _0x1d22a8[_0x3703ba(0x24b)]()+(_0x1d22a8[_0x3703ba(0x197)]()+0x1)[_0x3703ba(0x23f)]()['padStart'](0x2,'0')+_0x1d22a8['getDate']()[_0x3703ba(0x23f)]()[_0x3703ba(0x1b2)](0x2,'0')+'-'+_0x1d22a8[_0x3703ba(0x2a6)]()['toString']()[_0x3703ba(0x1b2)](0x2,'0')+_0x1d22a8[_0x3703ba(0x2a9)]()[_0x3703ba(0x23f)]()[_0x3703ba(0x1b2)](0x2,'0')+_0x1d22a8[_0x3703ba(0x1a2)]()['toString']()[_0x3703ba(0x1b2)](0x2,'0');}function shiftedTime(){const _0x2120ee=_0x2833d4,_0x4a1b88=new Date();let _0x32c34d=_0x4a1b88;if(settings[_0x2120ee(0x2b6)]&&settings[_0x2120ee(0x2b6)]!==0x0)_0x32c34d=fns['add'](_0x4a1b88,{'hours':settings[_0x2120ee(0x2b6)]});return _0x32c34d;}async function startScheduler(){const _0xdc48ef=_0x2833d4,_0x9efaac=new Date()[_0xdc48ef(0x20a)](),_0xd39852=shiftedTime()[_0xdc48ef(0x2a6)]();_0xd39852==0x4&&backupConfigFiles(),_0xd39852==0x0&&(rotateLogFiles(),logger[_0xdc48ef(0x283)](_0xdc48ef(0x2d6)),logger[_0xdc48ef(0x283)](_0xdc48ef(0x1f5)+serverversion+_0xdc48ef(0x1e3)+(environment==_0xdc48ef(0x391)?'(staging)':'')),logger[_0xdc48ef(0x283)](_0xdc48ef(0x2d6))),_0x9efaac%0x6==0x0&&triggerAnalytics(),_0x9efaac%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x579925){const _0x448ca7=_0x2833d4;logger[_0x448ca7(0x283)](_0x448ca7(0x33b)+_0x579925);const _0x2b74d0=getBotsWithMode();_0x2b74d0[_0x448ca7(0x24d)]>0x0?confirmRestore(configbackuppath,_0x579925):unzipFile(configbackuppath,_0x579925);}async function getBackupFiles(_0x3698d0=null){const _0x582bf2=_0x2833d4;let _0x17c07e=[],_0x2f277c=fs[_0x582bf2(0x1fb)](configbackuppath,{'withFileTypes':!![]});_0x2f277c[_0x582bf2(0x259)]((_0x347702,_0x5c6ebb)=>_0x347702[_0x582bf2(0x38d)]<_0x5c6ebb[_0x582bf2(0x38d)]?0x1:_0x5c6ebb[_0x582bf2(0x38d)]<_0x347702['name']?-0x1:0x0),_0x2f277c[_0x582bf2(0x30a)](_0xa2d488=>{const _0x4cffc3=_0x582bf2;if(!_0xa2d488[_0x4cffc3(0x36e)]()&&_0xa2d488['name']['startsWith'](_0x4cffc3(0x18a))&&_0xa2d488['name'][_0x4cffc3(0x2c0)](_0x4cffc3(0x356))){const _0x597e9e=formatDate(fs[_0x4cffc3(0x2e3)](configbackuppath+_0xa2d488[_0x4cffc3(0x38d)])['mtime']);_0x17c07e['push']({'name':_0xa2d488['name'],'mtime':_0x597e9e});}});if(_0x3698d0)io['to'](_0x3698d0)[_0x582bf2(0x1bd)](_0x582bf2(0x2cc),_0x17c07e);else return _0x17c07e;}async function backupConfigFiles(){const _0x24ea96=_0x2833d4;await zipFiles('backup-full');const _0x1e0ce6=getCleanTimeStamp();fs[_0x24ea96(0x36b)](zippath+_0x24ea96(0x1f6),configbackuppath+('backup-full@'+_0x1e0ce6+_0x24ea96(0x356)));let _0x44a2a1=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x44a2a1['sort']((_0x43c5b2,_0x2d4a8e)=>_0x43c5b2[_0x24ea96(0x38d)]<_0x2d4a8e[_0x24ea96(0x38d)]?0x1:_0x2d4a8e[_0x24ea96(0x38d)]<_0x43c5b2[_0x24ea96(0x38d)]?-0x1:0x0),_0x44a2a1[_0x24ea96(0x24d)]>maxBackups&&fs[_0x24ea96(0x2d8)](configbackuppath+_0x44a2a1[_0x44a2a1[_0x24ea96(0x24d)]-0x1][_0x24ea96(0x38d)]);}function rotateLogFiles(){const _0x11e265=_0x2833d4,_0x25cde5=fs[_0x11e265(0x2e3)](logspath+_0x11e265(0x27c)),_0x38a5a2=_0x25cde5[_0x11e265(0x29c)]/0x400;if(_0x38a5a2>0x64){let _0x39cd06=fs[_0x11e265(0x1fb)](logspath,{'withFileTypes':!![]});_0x39cd06[_0x11e265(0x259)]((_0x34639b,_0x2c0b06)=>_0x34639b['name']<_0x2c0b06[_0x11e265(0x38d)]?0x1:_0x2c0b06['name']<_0x34639b['name']?-0x1:0x0),_0x39cd06[_0x11e265(0x30a)](_0x5bf554=>{const _0x2a734b=_0x11e265;if(_0x5bf554[_0x2a734b(0x38d)]==_0x2a734b(0x345))fs[_0x2a734b(0x36b)](logspath+_0x5bf554[_0x2a734b(0x38d)],logspath+_0x2a734b(0x2a5));if(_0x5bf554[_0x2a734b(0x38d)]==_0x2a734b(0x28d))fs['copyFileSync'](logspath+_0x5bf554['name'],logspath+_0x2a734b(0x345));_0x5bf554[_0x2a734b(0x38d)]==_0x2a734b(0x27c)&&(fs[_0x2a734b(0x36b)](logspath+_0x5bf554[_0x2a734b(0x38d)],logspath+_0x2a734b(0x28d)),fs[_0x2a734b(0x313)](logspath+_0x5bf554[_0x2a734b(0x38d)],''));});}}async function zipFiles(_0x41c651){const _0x15aaa2=_0x2833d4;let _0xddba1f;if(_0x41c651==_0x15aaa2(0x2e6))_0xddba1f=logspath;if(_0x41c651==_0x15aaa2(0x337))_0xddba1f=configpath;if(_0x41c651=='backup-full')_0xddba1f=configpath;let _0x169e1e=fs[_0x15aaa2(0x1fb)](_0xddba1f,{'withFileTypes':!![]});const _0x101a29=new JSZip();_0x169e1e[_0x15aaa2(0x30a)](_0x1b25e9=>{const _0x473641=_0x15aaa2;if(!_0x1b25e9[_0x473641(0x36e)]()){let _0x5c6776=fs['readFileSync'](_0xddba1f+_0x1b25e9[_0x473641(0x38d)]);if(_0x41c651==_0x473641(0x337)){const _0x49f531=/^bot-[0-9]{3}-config.json$/,_0x4a30cd=_0x49f531[_0x473641(0x2f4)](_0x1b25e9[_0x473641(0x38d)]);if(_0x4a30cd){const _0x584e8f=JSON[_0x473641(0x327)](_0x5c6776);if(_0x584e8f['bot'][0x0]){_0x584e8f[_0x473641(0x2ab)][0x0][_0x473641(0x2f7)]=_0x473641(0x23e),_0x584e8f[_0x473641(0x2ab)][0x0][_0x473641(0x2c3)]='***';if(_0x584e8f[_0x473641(0x2ab)][0x0][_0x473641(0x2e4)])_0x584e8f[_0x473641(0x2ab)][0x0][_0x473641(0x2e4)]=_0x473641(0x23e);}_0x5c6776=JSON['stringify'](_0x584e8f,null,0x2);}if(_0x1b25e9[_0x473641(0x38d)]==_0x473641(0x1d6)){const _0x503a4a=JSON[_0x473641(0x327)](_0x5c6776);if(_0x503a4a[_0x473641(0x389)][_0x473641(0x285)])_0x503a4a['settings']['loginRequired']=![];if(_0x503a4a[_0x473641(0x389)][_0x473641(0x384)])_0x503a4a[_0x473641(0x389)][_0x473641(0x384)]=_0x473641(0x23e);if(_0x503a4a[_0x473641(0x389)][_0x473641(0x387)])_0x503a4a[_0x473641(0x389)][_0x473641(0x387)]=_0x473641(0x23e);if(_0x503a4a['settings']['telegramChatId'])_0x503a4a['settings']['telegramChatId']=null;if(_0x503a4a[_0x473641(0x389)]['marketcapApi'])_0x503a4a[_0x473641(0x389)]['marketcapApi']=_0x473641(0x23e);_0x5c6776=JSON[_0x473641(0x1c2)](_0x503a4a,null,0x2);}if(_0x1b25e9[_0x473641(0x38d)]!='bb-secure.json')_0x101a29[_0x473641(0x217)](_0x1b25e9[_0x473641(0x38d)],_0x5c6776);}else _0x101a29[_0x473641(0x217)](_0x1b25e9[_0x473641(0x38d)],_0x5c6776);}});const _0x425008=await _0x101a29[_0x15aaa2(0x1df)]({'type':_0x15aaa2(0x2ed),'base64':![],'compression':_0x15aaa2(0x338)});fs[_0x15aaa2(0x313)](zippath+(_0x41c651+_0x15aaa2(0x356)),_0x425008,_0x15aaa2(0x17c));}async function unzipFile(_0xcebdf5,_0x487b4c){const _0x5a143a=_0x2833d4;fs[_0x5a143a(0x1fb)](configpath,{'withFileTypes':!![]})[_0x5a143a(0x30a)](_0x2de67e=>{const _0x5f72dd=_0x5a143a;if(!_0x2de67e[_0x5f72dd(0x36e)]())fs[_0x5f72dd(0x212)](configpath+_0x2de67e['name']);});const _0x398566=fs['readFileSync'](_0xcebdf5+_0x487b4c,'binary'),_0x14ba96=await JSZip['loadAsync'](_0x398566,{'base64':![],'checkCRC32':!![]});for(const _0x20475c of Object[_0x5a143a(0x26f)](_0x14ba96[_0x5a143a(0x185)])){const _0x5e289d=_0x14ba96[_0x5a143a(0x185)][_0x20475c],_0x64eb2=await _0x5e289d[_0x5a143a(0x30e)](_0x5a143a(0x2ed));fs[_0x5a143a(0x313)](configpath+_0x5e289d[_0x5a143a(0x38d)],_0x64eb2);}fs[_0x5a143a(0x1fb)](temppath,{'withFileTypes':!![]})['forEach'](_0x1e0ee4=>{const _0x5c4b0c=_0x5a143a;if(!_0x1e0ee4['isDirectory']())fs[_0x5c4b0c(0x212)](temppath+_0x1e0ee4[_0x5c4b0c(0x38d)]);}),logger[_0x5a143a(0x283)](_0x5a143a(0x323)),process[_0x5a143a(0x32b)]({'restore':!![]},_0x5b2667=>{});}async function getPublicIp(){const _0x532927=_0x2833d4;try{const _0x3d33bd=await axios[_0x532927(0x22a)](_0x532927(0x240));publicip=_0x3d33bd[_0x532927(0x394)]['ip'];}catch(_0x151643){}}async function triggerAnalytics(){const _0x5e1efd=_0x2833d4;if(!publicip)await getPublicIp();const _0x495f2b=getBotsWithMode();let _0x52dff0=0x0;_0x495f2b['forEach'](_0x34dc18=>{const _0xe7c271=_0x56cb;if(_0x34dc18['status']===_0xe7c271(0x2b4))_0x52dff0++;});const _0x3f0976=getBotExchanges();mixpanel['track'](_0x5e1efd(0x339),{'distinct_id':settings[_0x5e1efd(0x38c)],'ip':publicip,'version':serverversion,'numbots':_0x495f2b['length'],'numbotsenabled':_0x52dff0,'exchanges':_0x3f0976,'environment':environment});}async function getMessages(){const _0x50b29c=_0x2833d4,_0x5d90b8=_0x50b29c(0x371),_0x118a6a=new GraphQLClient(_0x5d90b8),_0x34744b={'authorization':_0x50b29c(0x21b)},_0x30bc2a=serverversion[_0x50b29c(0x20b)]('.'),_0x365da8=_0x30bc2a[0x0]+'.'+_0x30bc2a[0x1],_0x73914d=Math[_0x50b29c(0x310)](settings[_0x50b29c(0x211)],settings['lastmsgemitted']),_0xe4781e={'last':parseInt(_0x73914d),'bbm':_0x365da8},_0x3f0dff=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1eb824;try{_0x1eb824=await _0x118a6a[_0x50b29c(0x298)](_0x3f0dff,_0xe4781e,_0x34744b);}catch(_0x26b196){}if(_0x1eb824&&_0x1eb824[_0x50b29c(0x335)]){let _0x5b60e3=settings[_0x50b29c(0x211)],_0x50d654=settings[_0x50b29c(0x211)];newMessages=[];for(const _0x3a45c5 of _0x1eb824[_0x50b29c(0x335)]){newMessages[_0x50b29c(0x34f)](_0x3a45c5);let _0x495c6a=![];_0x3a45c5[_0x50b29c(0x23a)]&&(updateSetting('latestversion',_0x3a45c5[_0x50b29c(0x23a)]),_0x495c6a=isNewerVersion(serverversion,_0x3a45c5[_0x50b29c(0x23a)])||serverversion==_0x3a45c5['bbvNew']);if(!_0x495c6a&&_0x3a45c5[_0x50b29c(0x1d8)]>_0x5b60e3){if(_0x3a45c5[_0x50b29c(0x1a8)]===_0x50b29c(0x37c)||serverversion[_0x50b29c(0x267)](_0x3a45c5[_0x50b29c(0x1a8)])){let _0x381838=''+_0x3a45c5['title']+'\x0a\x0a'+_0x3a45c5[_0x50b29c(0x399)];const _0x2cc848=await sendTelegramMsg(toTelegramMarkdown(_0x381838),'Markdown');_0x5b60e3=_0x3a45c5[_0x50b29c(0x1d8)];}}_0x50d654=_0x3a45c5['number'];}updateAvailable=isNewerVersion(settings[_0x50b29c(0x198)],serverversion),updateSetting(_0x50b29c(0x211),_0x50d654),emitMessages();}}function emitMessages(){const _0x92efe6=_0x2833d4,_0x13a75e=settings[_0x92efe6(0x251)];let _0x224712=[];newMessages['forEach'](_0x178dc7=>{const _0x32c4d7=_0x92efe6;_0x178dc7[_0x32c4d7(0x1d8)]>_0x13a75e&&_0x224712['push'](_0x178dc7);}),_0x224712[_0x92efe6(0x24d)]>0x0&&getAllClients()[_0x92efe6(0x30a)](_0x7ad7bf=>{const _0x41c5f1=_0x92efe6;getSocket(_0x7ad7bf['id'])[_0x41c5f1(0x1bd)](_0x41c5f1(0x399),_0x224712);});}function confirmMessage(_0x10bb80){const _0x10e6ac=_0x2833d4;updateSetting(_0x10e6ac(0x251),Number(_0x10bb80));}function isNewerVersion(_0x506b2e,_0x54f4d5){const _0x48c11d=_0x2833d4,_0x2bc793=_0x54f4d5[_0x48c11d(0x20b)]('.'),_0x4bdefd=_0x506b2e['split']('.');for(var _0x249c7c=0x0;_0x249c7c<_0x4bdefd[_0x48c11d(0x24d)];_0x249c7c++){const _0xd5d5be=~~_0x4bdefd[_0x249c7c],_0xe3b22a=~~_0x2bc793[_0x249c7c];if(_0xd5d5be>_0xe3b22a)return!![];if(_0xd5d5be<_0xe3b22a)return![];}return![];}function toTelegramMarkdown(_0x52bcbb){const _0x468d92=_0x2833d4,_0x2a7076=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x385810=/\*{2}(.+?)\*{2}/gim;return _0x52bcbb=_0x52bcbb['replace'](_0x2a7076,_0x468d92(0x1ad))[_0x468d92(0x2d7)](_0x385810,_0x468d92(0x279)),_0x52bcbb;}async function validateConfigFile(){const _0x3e272f=_0x2833d4,_0x4e36a2=dbConfig['get'](_0x3e272f(0x2c8))['sortBy'](_0x3e272f(0x35a))['value']()||[];if(_0x4e36a2['length']==0x0){let _0x15f0c0=0x0,_0x531153=[];const _0x1772d5=/^bot-([0-9]{3})-config.json$/,_0x4876d5=fs[_0x3e272f(0x1fb)](configpath);_0x4876d5[_0x3e272f(0x30a)](_0x1a1dad=>{const _0xa8c39a=_0x3e272f,_0x343844=_0x1772d5[_0xa8c39a(0x256)](_0x1a1dad);if(_0x343844){const _0x45a540=_0x343844[0x1];let _0x113e61=getBotAttributes(_0x45a540);_0x531153['push']({'botID':_0x45a540,'botname':_0x113e61[_0xa8c39a(0x22d)],'status':_0xa8c39a(0x39a),'live':_0xa8c39a(0x2da)}),_0x15f0c0++;}}),_0x15f0c0!=0x0&&(dbConfig['get'](_0x3e272f(0x2c8))['assign'](_0x531153)[_0x3e272f(0x300)](),config=_0x531153,restoredConfigFile=_0x15f0c0);}}async function restoreConfigNotify(_0x4f4f12){const _0x572732=_0x2833d4;let _0x2bd2fa;if(restoredConfigFile==0x1)_0x2bd2fa='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x2bd2fa=_0x572732(0x317);if(_0x4f4f12)io['to'](_0x572732(0x35b))[_0x572732(0x1bd)]('notification',_0x2bd2fa);else{logger[_0x572732(0x311)](_0x572732(0x1eb)),logger['simple'](_0x2bd2fa),logger['simple'](_0x572732(0x1eb)),logger['simple']('');if(tgBot&&settings[_0x572732(0x235)]&&settings[_0x572732(0x1fd)]!=_0x572732(0x34e))await sendTelegram(settings['telegramChatId'],_0x572732(0x2a3)+_0x2bd2fa);}}function decryptRSA(_0x1bcf5e,_0x577102){const _0x302127=_0x2833d4,_0x1e8d21=forge[_0x302127(0x1a3)][_0x302127(0x1bf)](_0x1bcf5e),_0x2e9814=_0x1e8d21[_0x302127(0x2a1)](forge[_0x302127(0x21c)]['decode64'](_0x577102),'RSA-OAEP',{'md':forge['md'][_0x302127(0x1ac)][_0x302127(0x20f)](),'mgf1':{'md':forge['md'][_0x302127(0x1ac)][_0x302127(0x20f)]()}});return _0x2e9814;}function validateCredentials(_0x5bb68b,_0x3a1fff){const _0x28df00=_0x2833d4;if(_0x5bb68b[_0x28df00(0x180)]==settings['bbUsername']&&bcrypt[_0x28df00(0x1c4)](_0x5bb68b[_0x28df00(0x207)],settings[_0x28df00(0x384)])){if(settings[_0x28df00(0x2e9)])return{'allow':![],'reason':_0x28df00(0x1c3),'token':null};else{const _0x5c5790=generateLoginToken(_0x3a1fff);return{'allow':!![],'reason':_0x28df00(0x1da),'token':_0x5c5790};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x40cdcc){const _0x250a09=_0x2833d4,_0x4c7139=generateLoginToken(_0x40cdcc);return{'allow':!![],'reason':_0x250a09(0x1da),'token':_0x4c7139};}function validateAccess(_0x5e815c,_0x1a5d39,_0x3146c5){const _0x269eee=_0x2833d4,_0x7e6d68=_0x3146c5?_0x3146c5:devices[_0x1a5d39]['ip'];let _0x29ed81;const _0x1bed3a=_0xc3145b=>{const _0x7bd677=_0x56cb;if(settings[_0x7bd677(0x285)]){if(settings[_0x7bd677(0x2e9)]){if(telegram2FaApproved(_0x1a5d39)){const _0x540383=generateLoginToken(_0x1a5d39);return{'allow':!![],'reason':_0x7bd677(0x278),'token':_0x540383};}else return{'allow':![],'reason':_0x7bd677(0x38e),'token':null};}else return _0x29ed81=validToken(_0xc3145b,_0x1a5d39),_0x29ed81[_0x7bd677(0x380)](_0x7bd677(0x1aa))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0xc3145b}:{'allow':![],'reason':_0x7bd677(0x38e),'token':null};}else return{'allow':!![],'reason':_0x7bd677(0x346),'token':null};};if(settings['whitelistEnabled']){let _0x33c786=[...settings['whitelist'],'::1',_0x269eee(0x214),'127.0.0.1',_0x269eee(0x28e)];if(_0x33c786[_0x269eee(0x2bb)](_0x7e6d68))return _0x1bed3a(_0x5e815c);else{_0x29ed81=validToken(_0x5e815c,_0x1a5d39);if(_0x29ed81['hasOwnProperty'](_0x269eee(0x1aa)))return _0x1bed3a(_0x5e815c);else{if(telegramIpApproved(_0x1a5d39)){const _0x3d6390=generateToken(_0x1a5d39);return _0x29ed81=_0x1bed3a(_0x5e815c),_0x29ed81['allow']?{'allow':!![],'reason':_0x269eee(0x2cd),'token':_0x3d6390}:_0x29ed81;}else return settings[_0x269eee(0x2ac)]?{'allow':![],'reason':_0x269eee(0x31a),'token':null}:{'allow':![],'reason':_0x269eee(0x35c),'token':null};}}}else return _0x1bed3a(_0x5e815c);}function timelyDecrypt(_0x411b28,_0x1fb069,_0x4ea87b='@'){const _0x188ea6=_0x2833d4;if(_0x411b28)try{const _0x5d8a42=decryptRSA(secure[_0x188ea6(0x2f5)],_0x411b28),_0x2ec677=_0x5d8a42['split'](_0x4ea87b)[0x0],_0x165c06=_0x5d8a42['split'](_0x4ea87b)[0x1],_0x51cf76=new Date()[_0x188ea6(0x2b7)]();if(_0x1fb069){if(_0x51cf76-_0x165c06<maxSecretAge*0x3e8)return _0x2ec677;else return![];}else return _0x2ec677;}catch(_0x698e7){return![];}else return![];}const validToken=(_0x3a3c1f,_0x338d5a)=>{const _0xe30d9f=_0x2833d4,_0x2a78ab=devices[_0x338d5a]['ip'];if(!_0x3a3c1f)return{'error':_0xe30d9f(0x199)};for(let _0x319aa1 of blacklist){if(_0x319aa1[_0xe30d9f(0x360)]==_0x3a3c1f)return{'error':_0xe30d9f(0x32f)};}let _0x39e537;try{_0x39e537=jwt[_0xe30d9f(0x220)](_0x3a3c1f,secure[_0xe30d9f(0x222)]+_0x338d5a);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x39e537[_0xe30d9f(0x380)]('clientip')&&!_0x39e537[_0xe30d9f(0x380)]('username')||!_0x39e537[_0xe30d9f(0x380)](_0xe30d9f(0x2ba)))return{'error':_0xe30d9f(0x260)};if(!_0x39e537[_0xe30d9f(0x380)](_0xe30d9f(0x180))&&_0x39e537[_0xe30d9f(0x380)]('clientip')){const {clientip:_0x5e5948}=_0x39e537;return _0x2a78ab==_0x5e5948?{'success':'User\x20has\x20been\x20validated'}:{'error':_0xe30d9f(0x395)};}else{if(_0x39e537[_0xe30d9f(0x380)](_0xe30d9f(0x180))&&_0x39e537['hasOwnProperty']('clientip')){const {username:_0x132d0a,clientip:_0x19c40f}=_0x39e537;return settings['bbUsername']==_0x132d0a&&_0x2a78ab==_0x19c40f?{'success':_0xe30d9f(0x2b1)}:{'error':_0xe30d9f(0x351)};}}},generateLoginToken=_0x1d38e2=>{const _0x4b4a96=_0x2833d4;if(_0x1d38e2){const _0x3b993d=devices[_0x1d38e2]['ip'];return jwt[_0x4b4a96(0x1d2)]({'username':settings['bbUsername'],'clientip':_0x3b993d},secure[_0x4b4a96(0x222)]+_0x1d38e2,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0xaf0432=>{const _0x30e972=_0x2833d4;if(_0xaf0432){const _0x120f52=devices[_0xaf0432]['ip'];return jwt['sign']({'clientip':_0x120f52},secure[_0x30e972(0x222)]+_0xaf0432,{'expiresIn':devices[_0xaf0432][_0x30e972(0x315)][_0x30e972(0x21e)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x2b3ae2=>{const _0x5adda3=_0x2833d4;let _0x4074ac=![];return devices[_0x2b3ae2][_0x5adda3(0x315)]&&devices[_0x2b3ae2]['telegramIpApproval'][_0x5adda3(0x21e)]!=_0x5adda3(0x2cf)&&(_0x4074ac=devices[_0x2b3ae2][_0x5adda3(0x315)][_0x5adda3(0x1dc)]==devices[_0x2b3ae2]['ip']&&new Date()[_0x5adda3(0x2b7)]()-devices[_0x2b3ae2]['telegramIpApproval'][_0x5adda3(0x22e)]<devices[_0x2b3ae2][_0x5adda3(0x315)]['expiry']*0x3c*0x3e8),_0x4074ac;},telegram2FaApproved=_0x278fc1=>{const _0x45e529=_0x2833d4;let _0x49ff84=![];return devices[_0x278fc1]['telegram2FaApproval']&&devices[_0x278fc1]['telegram2FaApproval'][_0x45e529(0x21e)]!=_0x45e529(0x2cf)&&(_0x49ff84=devices[_0x278fc1]['telegram2FaApproval'][_0x45e529(0x1dc)]==devices[_0x278fc1]['ip']&&new Date()[_0x45e529(0x2b7)]()-devices[_0x278fc1][_0x45e529(0x2ec)][_0x45e529(0x22e)]<devices[_0x278fc1][_0x45e529(0x2ec)][_0x45e529(0x21e)]*0x3c*0x3e8),_0x49ff84;},normalizeIP=_0x562d51=>{const _0x381751=_0x2833d4;let _0x220627=null,_0x4a9c8c=null;if(ipaddr[_0x381751(0x36c)](_0x562d51)){const _0x201f79=ipaddr[_0x381751(0x327)](_0x562d51);_0x201f79[_0x381751(0x200)]()===_0x381751(0x1de)?(_0x201f79[_0x381751(0x2fa)]()&&(_0x220627=_0x201f79['toIPv4Address']()['toString']()),_0x4a9c8c=_0x201f79[_0x381751(0x23f)]()):(_0x220627=_0x201f79[_0x381751(0x23f)](),_0x4a9c8c=_0x201f79[_0x381751(0x2eb)]()[_0x381751(0x23f)]());}return{'show':_0x220627?_0x220627:_0x4a9c8c,'store':_0x4a9c8c};};function formatDate(_0x525fb7){const _0x4aa81d=_0x2833d4;return _0x525fb7[_0x4aa81d(0x24b)]()+'/'+(_0x525fb7[_0x4aa81d(0x197)]()+0x1)[_0x4aa81d(0x23f)]()[_0x4aa81d(0x1b2)](0x2,'0')+'/'+_0x525fb7[_0x4aa81d(0x1f8)]()[_0x4aa81d(0x23f)]()[_0x4aa81d(0x1b2)](0x2,'0')+'\x20'+_0x525fb7[_0x4aa81d(0x2a6)]()[_0x4aa81d(0x23f)]()['padStart'](0x2,'0')+':'+_0x525fb7['getMinutes']()[_0x4aa81d(0x23f)]()['padStart'](0x2,'0')+':'+_0x525fb7['getSeconds']()[_0x4aa81d(0x23f)]()[_0x4aa81d(0x1b2)](0x2,'0');}function sleep(_0x45c674){return new Promise(_0x40b5aa=>setTimeout(_0x40b5aa,_0x45c674));}