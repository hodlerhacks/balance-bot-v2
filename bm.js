const _0x148ee4=_0xe43d;(function(_0x754327,_0x86ffc4){const _0x24a8b3=_0xe43d,_0x251671=_0x754327();while(!![]){try{const _0x233c1d=parseInt(_0x24a8b3(0x243))/0x1+-parseInt(_0x24a8b3(0x223))/0x2+-parseInt(_0x24a8b3(0x29f))/0x3+-parseInt(_0x24a8b3(0x2e9))/0x4*(parseInt(_0x24a8b3(0x302))/0x5)+parseInt(_0x24a8b3(0x28d))/0x6+parseInt(_0x24a8b3(0x169))/0x7*(parseInt(_0x24a8b3(0x264))/0x8)+parseInt(_0x24a8b3(0x179))/0x9*(-parseInt(_0x24a8b3(0x13b))/0xa);if(_0x233c1d===_0x86ffc4)break;else _0x251671['push'](_0x251671['shift']());}catch(_0x383d42){_0x251671['push'](_0x251671['shift']());}}}(_0x1bcd,0x20759));const _0x336bdd=function(){let _0x155de3=!![];return function(_0x28bff7,_0x1f56f3){const _0x4a34f2=_0x155de3?function(){if(_0x1f56f3){const _0x4bd0f0=_0x1f56f3['apply'](_0x28bff7,arguments);return _0x1f56f3=null,_0x4bd0f0;}}:function(){};return _0x155de3=![],_0x4a34f2;};}(),_0xc08c85=_0x336bdd(this,function(){const _0x546f5e=_0xe43d;return _0xc08c85[_0x546f5e(0x27d)]()['search'](_0x546f5e(0x277))[_0x546f5e(0x27d)]()[_0x546f5e(0x28c)](_0xc08c85)['search'](_0x546f5e(0x277));});_0xc08c85();'use strict';process[_0x148ee4(0x181)][_0x148ee4(0x1f4)]=0x1;const childProcess=require(_0x148ee4(0x1ff)),fs=require('fs'),fns=require('date-fns'),low=require(_0x148ee4(0x15c)),FileSync=require(_0x148ee4(0x234)),path=require('path'),crypto=require(_0x148ee4(0x11f)),forge=require(_0x148ee4(0x1eb)),bcrypt=require(_0x148ee4(0x11d)),jwt=require(_0x148ee4(0x1cd)),ipaddr=require(_0x148ee4(0x2d3)),yargs=require(_0x148ee4(0x1c0)),uuidRandom=require(_0x148ee4(0x270)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x148ee4(0x184)),axios=require(_0x148ee4(0x271)),{GraphQLClient,gql}=require(_0x148ee4(0x199)),util=require(_0x148ee4(0x173)),fileUpload=require(_0x148ee4(0x25e)),{networkInterfaces}=require('os'),JSZip=require('jszip'),argv=yargs(process['argv']['slice'](0x2))['argv'],PORT=argv[_0x148ee4(0x19c)]||_0x148ee4(0x1c5),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x148ee4(0x29c)](_0x148ee4(0x1f2)+PORT+_0x148ee4(0x112)),process[_0x148ee4(0x1f0)](0x1));const HOST=argv[_0x148ee4(0x2d5)]||null,userID=argv[_0x148ee4(0x131)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process[_0x148ee4(0x24d)]['node'];let bbpath=_0x148ee4(0x14b),bbpath2='';const botfile='bot.js',configfile='bb-config.json',settingsfile=_0x148ee4(0x211),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x148ee4(0x172))[_0x148ee4(0x2fc)]||_0x148ee4(0x233),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x148ee4(0x24c)](bbpath+botfile)&&(bbpath='',validInstallation=![]);function _0xe43d(_0x352b6f,_0x375c8a){const _0x3f00bf=_0x1bcd();return _0xe43d=function(_0xc08c85,_0x336bdd){_0xc08c85=_0xc08c85-0xfe;let _0x1bcd23=_0x3f00bf[_0xc08c85];return _0x1bcd23;},_0xe43d(_0x352b6f,_0x375c8a);}const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x148ee4(0x27e)),configpath=userID?bbpath+_0x148ee4(0x1b8)+userID+'/':bbpath+_0x148ee4(0x1b8),configbackuppath=configpath+'backup/',logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x148ee4(0x2d2),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+'zip/',loggerfile=fs[_0x148ee4(0x1b1)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x148ee4(0x2bd)+userID+'/':bbpath+'temp/';!fs[_0x148ee4(0x24c)](configpath)&&fs[_0x148ee4(0x23b)](configpath);!fs[_0x148ee4(0x24c)](configbackuppath)&&fs[_0x148ee4(0x23b)](configbackuppath);!fs[_0x148ee4(0x24c)](logspath)&&fs[_0x148ee4(0x23b)](logspath);!fs['existsSync'](zippath)&&fs[_0x148ee4(0x23b)](zippath);!fs['existsSync'](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x148ee4(0x1be)]({'bots':[]})[_0x148ee4(0x107)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x148ee4(0x1be)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x148ee4(0x240),'onepagemode':![],'marketcapApi':''}})[_0x148ee4(0x107)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x148ee4(0x1be)]({'secure':{},'blacklist':[]})[_0x148ee4(0x107)]();const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x148ee4(0x1e4),{'host':_0x148ee4(0x10b)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x148ee4(0x135)]&&(settings[_0x148ee4(0x135)]!=''&&settings[_0x148ee4(0x135)]!=_0x148ee4(0x2ae))&&settings[_0x148ee4(0x306)]&&settings[_0x148ee4(0x306)]!='')initTelegram();const parseColor=(_0x44ecbf,_0x2e7005)=>{const _0x3e05ec=_0x148ee4,_0x45742c=/#[A-Z]{3}#/g;if(typeof _0x44ecbf==_0x3e05ec(0x21d)){!_0x2e7005?_0x44ecbf=_0x44ecbf[_0x3e05ec(0x15f)](_0x45742c,''):(_0x44ecbf=_0x44ecbf[_0x3e05ec(0x15f)](/#BLU#/g,_0x3e05ec(0x1de)),_0x44ecbf=_0x44ecbf[_0x3e05ec(0x15f)](/#RED#/g,_0x3e05ec(0x150)),_0x44ecbf=_0x44ecbf[_0x3e05ec(0x15f)](/#YEL#/g,_0x3e05ec(0x101)),_0x44ecbf=_0x44ecbf[_0x3e05ec(0x15f)](/#MAG#/g,'\x1b[35m'),_0x44ecbf=_0x44ecbf[_0x3e05ec(0x15f)](/#CYA#/g,_0x3e05ec(0x1a6)),_0x44ecbf=_0x44ecbf[_0x3e05ec(0x15f)](/#RES#/g,_0x3e05ec(0x25d)));;}return _0x44ecbf;},logger={'screen':_0x590159=>{console['log'](parseColor(_0x590159,!![]));},'simple':_0x31030b=>{const _0x46d7f7=_0x148ee4;console[_0x46d7f7(0x29c)](parseColor(_0x31030b,!![])),loggerfile[_0x46d7f7(0x107)](util[_0x46d7f7(0x26c)](parseColor(_0x31030b,![]))+'\x0a');},'full':async _0x6b31c2=>{const _0x4161b2=_0x148ee4,_0x1ec458=getTimeStamp()+_0x4161b2(0x312)+_0x6b31c2;console[_0x4161b2(0x29c)](parseColor(_0x1ec458,!![])),loggerfile[_0x4161b2(0x107)](util[_0x4161b2(0x26c)](parseColor(_0x1ec458,![]))+'\x0a');if(tgBot&&settings[_0x4161b2(0x294)]&&settings[_0x4161b2(0x113)]!=_0x4161b2(0x30d))await sendTelegram(settings[_0x4161b2(0x294)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x6b31c2,![]));},'debug':async(_0x21969f,_0x327f36='')=>{const _0x5dd43c=_0x148ee4,_0x4c315d=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x21969f;if(debugging)console['log'](parseColor(_0x4c315d,!![]));loggerfile[_0x5dd43c(0x107)](util[_0x5dd43c(0x26c)](parseColor(_0x4c315d,![]))+'\x0a');if(_0x327f36){if(debugging)console[_0x5dd43c(0x29c)](_0x327f36);loggerfile[_0x5dd43c(0x107)](util[_0x5dd43c(0x26c)](_0x327f36)+'\x0a');}}};let terminating=![];process['on'](_0x148ee4(0x26b),function(_0x3834da){const _0x421bf0=_0x148ee4;_0x3834da['toString']()[_0x421bf0(0x133)](_0x421bf0(0x21c))?(logger[_0x421bf0(0x1d6)]('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x3834da[_0x421bf0(0x19c)]+'#RES#'),process[_0x421bf0(0x24a)]({'terminate':!![]},_0xe1a9df=>{})):logger[_0x421bf0(0x1d6)](_0x3834da);}),process['on'](_0x148ee4(0x1f0),()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGTERM',()=>{const _0x581cc6=_0x148ee4;stopAllBots(),process[_0x581cc6(0x1f0)](0x0);}),process['on'](_0x148ee4(0xfe),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x148ee4(0x212)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x148ee4(0x2c7)),app=express(),http=require(_0x148ee4(0x14c))[_0x148ee4(0x2ed)](app);app[_0x148ee4(0x160)](fileUpload({'useTempFiles':!![]})),app[_0x148ee4(0x165)](_0x148ee4(0x2fa),async(_0x1aa83a,_0x29059d)=>{const _0x20d67f=_0x148ee4,_0xa3206=_0x1aa83a[_0x20d67f(0x129)][_0x20d67f(0x118)],_0x575d62=getClientsWithBotID(_0x20d67f(0x18e)),_0x31ff91=_0x1aa83a[_0x20d67f(0x1cf)][_0x20d67f(0x17a)],_0x2541d0=timelyDecrypt(_0x31ff91,![]),_0x2984cc=_0x575d62['find'](_0x30f801=>_0x30f801[_0x20d67f(0x17a)]==_0x2541d0);if(_0x2984cc){const _0xef1576=normalizeIP(_0x1aa83a[_0x20d67f(0x259)]['remoteAddress'])['store'],_0x50273d=_0x1aa83a[_0x20d67f(0x1cf)]['tkn'];if(validateAccess(_0x50273d,_0x2541d0,_0xef1576)[_0x20d67f(0x22f)])_0xa3206==_0x20d67f(0x2c6)&&await backupConfigFiles(),await zipFiles(_0xa3206),_0x29059d['download'](zippath+(_0xa3206+_0x20d67f(0x2b9)),_0x122c0e=>{const _0x5230b7=_0x20d67f;_0x122c0e&&(logger[_0x5230b7(0x13d)](_0x5230b7(0x283)+_0xa3206),logger['simple'](_0x122c0e));});else logger[_0x20d67f(0x13d)](_0x20d67f(0x18d)+_0xa3206+_0x20d67f(0x1d7));}else logger['full'](_0x20d67f(0x18d)+_0xa3206+_0x20d67f(0x12c));}),app[_0x148ee4(0x119)]('/upload-backup',async(_0x4306e9,_0x1d68e6)=>{const _0x8fbb35=_0x148ee4,_0x784ba6=getClientsWithBotID(_0x8fbb35(0x18e)),_0x3cf33e=_0x4306e9[_0x8fbb35(0x1cf)][_0x8fbb35(0x17a)],_0x20f9c8=timelyDecrypt(_0x3cf33e,![]),_0x47f3ca=_0x784ba6[_0x8fbb35(0x23f)](_0x126846=>_0x126846[_0x8fbb35(0x17a)]==_0x20f9c8);logger[_0x8fbb35(0x204)](_0x8fbb35(0x104));if(_0x47f3ca){const _0x276f75=normalizeIP(_0x4306e9[_0x8fbb35(0x259)][_0x8fbb35(0x262)])['store'],_0x3b3911=_0x4306e9['headers'][_0x8fbb35(0x110)];if(validateAccess(_0x3b3911,_0x20f9c8,_0x276f75)[_0x8fbb35(0x22f)]){if(_0x4306e9[_0x8fbb35(0x1dd)]){const _0x3706dd=_0x4306e9[_0x8fbb35(0x1dd)][_0x8fbb35(0x227)];await _0x3706dd['mv'](temppath+_0x3706dd[_0x8fbb35(0x2e4)]),_0x1d68e6[_0x8fbb35(0x24a)]({'status':!![],'message':_0x8fbb35(0x18b)});const _0x384672=getBotsWithMode();_0x384672[_0x8fbb35(0x20d)]>0x0?confirmRestore(temppath,_0x3706dd[_0x8fbb35(0x2e4)]):unzipFile(temppath,_0x3706dd[_0x8fbb35(0x2e4)]);}}else logger[_0x8fbb35(0x13d)](_0x8fbb35(0x194));}else logger[_0x8fbb35(0x13d)](_0x8fbb35(0x207));}),app[_0x148ee4(0x160)](express['static'](path[_0x148ee4(0x156)](__dirname,bbpath2,_0x148ee4(0x15a)))),app[_0x148ee4(0x160)](express[_0x148ee4(0x246)](path[_0x148ee4(0x156)](__dirname,bbpath2,'build'))),app[_0x148ee4(0x165)]('/',function(_0x2c8f5c,_0x226c9d){const _0xf55a9b=_0x148ee4;_0x226c9d[_0xf55a9b(0x1e0)](path[_0xf55a9b(0x156)](__dirname,bbpath2,_0xf55a9b(0x15a),_0xf55a9b(0x2ac)));}),app[_0x148ee4(0x165)](_0x148ee4(0x2d7),function(_0x1ea9ff,_0x3529f2){const _0x72cf2=_0x148ee4;_0x3529f2[_0x72cf2(0x1e0)](path[_0x72cf2(0x156)](__dirname,bbpath2,_0x72cf2(0x18c),_0x72cf2(0x2ac)));}),app[_0x148ee4(0x165)]('/:bot/portfolio',(_0x59f6a1,_0x41169d)=>{const _0x282976=_0x148ee4;_0x41169d[_0x282976(0x1e0)](path['join'](__dirname,bbpath2,_0x282976(0x18c),_0x282976(0x2ac)));}),app['get'](_0x148ee4(0x1b0),(_0x1eb95d,_0x347cf0)=>{const _0x399f9b=_0x148ee4;_0x347cf0[_0x399f9b(0x1e0)](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x148ee4(0x165)]('/:bot/coins',(_0x2c03f2,_0x30864b)=>{const _0x1be33f=_0x148ee4;_0x30864b[_0x1be33f(0x1e0)](path[_0x1be33f(0x156)](__dirname,bbpath2,_0x1be33f(0x18c),_0x1be33f(0x2ac)));}),app[_0x148ee4(0x165)](_0x148ee4(0x2c1),(_0x273d52,_0x3e9175)=>{const _0xb16913=_0x148ee4;_0x3e9175[_0xb16913(0x1e0)](path[_0xb16913(0x156)](__dirname,bbpath2,_0xb16913(0x18c),_0xb16913(0x2ac)));}),app[_0x148ee4(0x165)](_0x148ee4(0x291),(_0x1698c7,_0x162c69)=>{const _0x292dca=_0x148ee4;_0x162c69[_0x292dca(0x1e0)](path['join'](__dirname,bbpath2,_0x292dca(0x18c),_0x292dca(0x2ac)));}),app[_0x148ee4(0x165)]('/:bot/support',(_0x4e6440,_0x4b075c)=>{const _0x136c72=_0x148ee4;_0x4b075c[_0x136c72(0x1e0)](path[_0x136c72(0x156)](__dirname,bbpath2,_0x136c72(0x18c),_0x136c72(0x2ac)));});if(HOST)http[_0x148ee4(0x2bc)](PORT,HOST);else http[_0x148ee4(0x2bc)](PORT);const io=require(_0x148ee4(0x187))(http,{});openBrowser&&(async()=>{const _0x2704bc=_0x148ee4,{default:_0x42334f}=await import(_0x2704bc(0x305));await _0x42334f(_0x2704bc(0x154)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x3ea3f6=_0x148ee4;let _0x211b32=_0x3ea3f6(0x248);const _0x52c9c5=networkInterfaces(),_0x4f591f={};for(const _0x501d94 of Object[_0x3ea3f6(0x139)](_0x52c9c5)){for(const _0x191a93 of _0x52c9c5[_0x501d94]){if((_0x191a93[_0x3ea3f6(0x14f)]=='IPv4'||_0x191a93[_0x3ea3f6(0x14f)]==0x4)&&!_0x191a93[_0x3ea3f6(0x1fe)]){const _0x3c0b64=ipaddr[_0x3ea3f6(0x128)](_0x191a93[_0x3ea3f6(0x1ad)])[_0x3ea3f6(0x1a0)]();_0x3c0b64!=_0x3ea3f6(0x303)&&(!_0x4f591f[_0x501d94]&&(_0x4f591f[_0x501d94]=[]),_0x4f591f[_0x501d94]['push'](_0x191a93[_0x3ea3f6(0x1ad)]),_0x211b32=_0x191a93[_0x3ea3f6(0x1ad)]);}}}return{'serverip':_0x211b32,'netinterfaces':_0x4f591f};}async function startServer(){const _0x411c19=_0x148ee4,{serverip:_0x906f3e,netinterfaces:_0x43d24c}=getServerIP();logger[_0x411c19(0x1d6)](''),logger['simple'](_0x411c19(0x20f)),await logger[_0x411c19(0x13d)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x411c19(0x11a)+(environment=='staging'?'(staging)':'')+'\x0a'+(_0x411c19(0x2b4)+PORT+_0x411c19(0x1b7))+(_0x411c19(0x2e0)+_0x906f3e+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x411c19(0x1d6)](_0x411c19(0x20f));if(config[_0x411c19(0x20d)]!=0x0)for(const _0x278571 of config){const _0x3c2a23=_0x278571['mode']==_0x411c19(0x2c4)?'a':'m';if(_0x278571[_0x411c19(0x145)]==_0x411c19(0x1ca)||_0x278571[_0x411c19(0x145)]==_0x411c19(0x1ea))await logger[_0x411c19(0x13d)](_0x411c19(0x1ee)+_0x3c2a23+_0x411c19(0x2f1)+_0x278571[_0x411c19(0x2f7)]+'\x20|\x20'+_0x278571[_0x411c19(0x2b0)]),startBot([_0x278571[_0x411c19(0x2f7)],userID],{'cwd':bbpath},function(_0x2a96c5){const _0xebe8b6=_0x411c19;if(_0x2a96c5)logger[_0xebe8b6(0x13d)](_0x2a96c5);});else(_0x278571[_0x411c19(0x145)]=='disabled'||_0x278571[_0x411c19(0x145)]==_0x411c19(0x15b))&&await logger[_0x411c19(0x13d)]('Idling\x20('+_0x3c2a23+_0x411c19(0x13f)+_0x278571['botID']+_0x411c19(0x307)+_0x278571['botname']);}else!newBot&&logger[_0x411c19(0x1d6)](_0x411c19(0x1a4));if(newBot)addBot();logger[_0x411c19(0x1d6)](_0x411c19(0x20f)),logger['simple'](''),await logger[_0x411c19(0x204)]('Node.js\x20v'+nodeversion),await logger[_0x411c19(0x204)](_0x411c19(0x1e5),_0x43d24c);}function startSocket(){const _0x2dc963=_0x148ee4;io['on'](_0x2dc963(0x220),_0x25c851=>{const _0xa8e495=_0x2dc963;let _0x324e92,_0x1ec7e0,_0x530a39,_0x4917f8,_0x279e0e;const _0x1414b9=_0x25c851[_0xa8e495(0x2b1)][_0xa8e495(0x1cf)]['referer'];_0x1ec7e0=_0x1414b9[_0xa8e495(0x232)](/bot[0-9]{3}/);if(_0x1ec7e0)_0x530a39=_0x1ec7e0[0x0]['match'](/[0-9]{3}/);if(_0x530a39)_0x324e92=_0x530a39[0x0];else _0x324e92='botmanager';const _0x35a4d2=_0x25c851[_0xa8e495(0x2b1)]['auth'][_0xa8e495(0x2e1)];if(!_0x35a4d2)_0x25c851['emit'](_0xa8e495(0x145),{'publicKey':secure[_0xa8e495(0x16d)]});else{_0x4917f8=timelyDecrypt(_0x35a4d2,![]);if(!_0x4917f8)_0x25c851['emit'](_0xa8e495(0x145),{'publicKey':secure[_0xa8e495(0x16d)]});else{_0x279e0e=normalizeIP(_0x25c851[_0xa8e495(0x1e3)]['remoteAddress'])[_0xa8e495(0x27a)];if(!devices[_0x4917f8])devices[_0x4917f8]={'uuid':_0x4917f8,'access':{'token':null}};devices[_0x4917f8]['ip']=_0x279e0e;const _0x37fa97=addClient(_0x25c851['id'],_0x4917f8,_0x324e92);setAccess(_0x37fa97),emitMessages(),_0x25c851['on'](_0xa8e495(0x2d1),_0x1eebaf=>{const _0x2ea5bc=_0xa8e495,_0x17905f=timelyDecrypt(_0x1eebaf['password'],!![],'|@|');if(_0x17905f){_0x1eebaf={'username':_0x1eebaf[_0x2ea5bc(0x228)],'password':_0x17905f},devices[_0x4917f8][_0x2ea5bc(0x1bb)]=validateCredentials(_0x1eebaf,_0x4917f8);if(devices[_0x4917f8][_0x2ea5bc(0x1bb)][_0x2ea5bc(0x22f)]==![]&&devices[_0x4917f8][_0x2ea5bc(0x1bb)][_0x2ea5bc(0x229)]==_0x2ea5bc(0x1f3))_0x25c851[_0x2ea5bc(0x2a6)](_0x2ea5bc(0x145),{'access':devices[_0x4917f8][_0x2ea5bc(0x1bb)]}),loginAccess2FA(_0x4917f8,_0x279e0e);else{if(devices[_0x4917f8][_0x2ea5bc(0x1bb)][_0x2ea5bc(0x22f)]==![]&&devices[_0x4917f8]['access'][_0x2ea5bc(0x229)]==_0x2ea5bc(0x24b))_0x25c851['emit']('status',{'access':devices[_0x4917f8][_0x2ea5bc(0x1bb)]});else devices[_0x4917f8][_0x2ea5bc(0x1bb)][_0x2ea5bc(0x22f)]&&devices[_0x4917f8][_0x2ea5bc(0x1bb)][_0x2ea5bc(0x229)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x4917f8)[_0x2ea5bc(0x12f)](_0x28fc02=>{setAccess(_0x28fc02);}),logger[_0x2ea5bc(0x204)](_0x2ea5bc(0x2a3)+_0x4917f8[_0x2ea5bc(0x2c0)](-0x8)),setTokenRefresh(_0x4917f8),setSessionTimeout(_0x2ea5bc(0x2d1),_0x4917f8));}}else logger['full']('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x25c851['on']('reset-password',()=>{resetPassword();}),_0x25c851['on'](_0xa8e495(0x2d4),_0x310d1d=>{removeClient(_0x25c851['id']);}),_0x324e92==_0xa8e495(0x18e)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x52c2e7){const _0x21b427=_0x148ee4;if(_0x52c2e7!='botmanager'&&config['apiKey']!=''){if(pid[_0x52c2e7])pid[_0x52c2e7]['send']({'function':_0x21b427(0x10e),'args':null});}_0x52c2e7!=_0x21b427(0x18e)&&broadcastToBots(_0x21b427(0x26f),JSON[_0x21b427(0x188)](config));}function reloadBotManager(){const _0x383cde=_0x148ee4;getClientsWithBotID('botmanager')[_0x383cde(0x12f)](_0x4199fc=>{const _0x9401dc=_0x383cde;getSocket(_0x4199fc['id'])[_0x9401dc(0x2a6)](_0x9401dc(0x145),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x2991ce){const _0x5d2d7d=_0x148ee4,_0x5d8d04=io[_0x5d2d7d(0x142)][_0x5d2d7d(0x165)]('/');return _0x5d8d04[_0x5d2d7d(0x115)][_0x5d2d7d(0x165)](_0x2991ce);}function setAccess(_0x4b5c8c){const _0x4052d8=_0x148ee4,_0x20490c=getSocket(_0x4b5c8c['id']),_0x208348=_0x4b5c8c[_0x4052d8(0x17a)],_0x5ddfd3=_0x4b5c8c[_0x4052d8(0x267)];devices[_0x208348]['access']=validateAccess(devices[_0x208348][_0x4052d8(0x1bb)][_0x4052d8(0x20e)],_0x208348),logger['debug'](_0x4052d8(0x28f)+devices[_0x208348][_0x4052d8(0x1bb)][_0x4052d8(0x229)]+'\x20|\x20client:\x20...'+_0x4b5c8c['id'][_0x4052d8(0x2c0)](-0x8)+_0x4052d8(0x1dc)+_0x208348[_0x4052d8(0x2c0)](-0x8)),_0x20490c['join'](_0x208348);if(devices[_0x208348][_0x4052d8(0x1bb)][_0x4052d8(0x22f)]){_0x20490c[_0x4052d8(0x156)](_0x5ddfd3);if(_0x5ddfd3==_0x4052d8(0x18e))initializeSocketBotManager(_0x20490c);else initializeSocketBot(_0x20490c);initClient(_0x5ddfd3);}devices[_0x208348][_0x4052d8(0x1bb)][_0x4052d8(0x20e)]&&devices[_0x208348][_0x4052d8(0x1bb)]['reason']==_0x4052d8(0x241)&&setSessionTimeout('2FA',_0x208348),devices[_0x208348][_0x4052d8(0x1bb)]['token']&&devices[_0x208348][_0x4052d8(0x1bb)]['reason']==_0x4052d8(0x2db)&&setSessionTimeout('login',_0x208348),_0x20490c[_0x4052d8(0x2a6)](_0x4052d8(0x145),{'status':_0x4b5c8c[_0x4052d8(0x216)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x208348]['access'],'externalip':devices[_0x208348]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x208348]['access'][_0x4052d8(0x22f)]==![]&&devices[_0x208348][_0x4052d8(0x1bb)][_0x4052d8(0x229)]=='2FA\x20required'&&temporaryAccess2FA(_0x208348,devices[_0x208348]['ip']);}function setSessionTimeout(_0x137af1,_0x24d023){const _0x27df8d=_0x148ee4;let _0x2d4fe8;if(_0x137af1=='login')_0x2d4fe8=loginExpiry*0x3c*0x3e8;else _0x2d4fe8=devices[_0x24d023][_0x27df8d(0x20b)][_0x27df8d(0x1a5)]*0x3c*0x3e8-(new Date()[_0x27df8d(0x26d)]()-devices[_0x24d023][_0x27df8d(0x20b)][_0x27df8d(0x1df)]);if(devices[_0x24d023][_0x27df8d(0x10a)])clearTimeout(devices[_0x24d023][_0x27df8d(0x10a)]);devices[_0x24d023][_0x27df8d(0x10a)]=setTimeout(()=>{const _0x1fc1b7=_0x27df8d;if(devices[_0x24d023][_0x1fc1b7(0x276)])clearTimeout(devices[_0x24d023]['pidRefreshToken']);removeSocketListeners(_0x24d023),addBlacklist(_0x24d023),devices[_0x24d023]['telegramIpApproval']=null,devices[_0x24d023][_0x1fc1b7(0x1c4)]=null,devices[_0x24d023][_0x1fc1b7(0x1bb)]['token']=null,logger['debug'](_0x1fc1b7(0x116)+_0x24d023[_0x1fc1b7(0x2c0)](-0x8)),devices[_0x24d023][_0x1fc1b7(0x1bb)]=validateAccess(devices[_0x24d023][_0x1fc1b7(0x1bb)][_0x1fc1b7(0x20e)],_0x24d023),!(devices[_0x24d023][_0x1fc1b7(0x1bb)][_0x1fc1b7(0x22f)]&&devices[_0x24d023]['access'][_0x1fc1b7(0x229)]==_0x1fc1b7(0x149))&&(_0x137af1=='login'?io['to'](_0x24d023)[_0x1fc1b7(0x2a6)](_0x1fc1b7(0x145),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x24d023)[_0x1fc1b7(0x2a6)]('status',{'access':{'allow':![],'reason':_0x1fc1b7(0x1a1),'token':null}})),devices[_0x24d023][_0x1fc1b7(0x1bb)][_0x1fc1b7(0x20e)]=null;},_0x2d4fe8);}function setTokenRefresh(_0x332922){const _0x521400=_0x148ee4;if(devices[_0x332922][_0x521400(0x276)])clearTimeout(devices[_0x332922][_0x521400(0x276)]);devices[_0x332922][_0x521400(0x276)]=setTimeout(()=>{const _0x25b043=_0x521400;getClientsWithUuid(_0x332922)['length']!=0x0?(devices[_0x332922][_0x25b043(0x1bb)]=refreshToken(_0x332922),io['to'](_0x332922)[_0x25b043(0x2a6)](_0x25b043(0x145),{'status':_0x25b043(0x17d),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x332922][_0x25b043(0x1bb)],'externalip':devices[_0x332922]['ip'],'publicKey':secure[_0x25b043(0x16d)],'validInstallation':validInstallation}),setTokenRefresh(_0x332922)):clearTimeout(devices[_0x332922][_0x25b043(0x276)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x32079c){const _0xca2414=_0x148ee4,_0x9a639a=getClient(_0x32079c['id'])[_0xca2414(0x17a)];_0x32079c[_0xca2414(0x2a6)]('bots',config),_0x32079c['emit'](_0xca2414(0x19b),cleanSettings()),_0x32079c['on'](_0xca2414(0x278),_0x47797b=>{const _0x1e074d=_0xca2414;if(validateAccess(_0x47797b,_0x9a639a)[_0x1e074d(0x22f)])addBot();else logger[_0x1e074d(0x13d)](_0x1e074d(0x222));}),_0x32079c['on'](_0xca2414(0x1f5),(_0x182d88,_0x31af22)=>{const _0x21c0b7=_0xca2414;if(validateAccess(_0x31af22,_0x9a639a)['allow'])toggleBot(_0x182d88['botID'],_0x182d88[_0x21c0b7(0x145)],_0x182d88[_0x21c0b7(0x289)]);else logger[_0x21c0b7(0x13d)](_0x21c0b7(0x22c));}),_0x32079c['on']('toggle-bot-mode',(_0xd5a720,_0x2f5278)=>{const _0x12cdd6=_0xca2414;if(validateAccess(_0x2f5278,_0x9a639a)[_0x12cdd6(0x22f)])toggleBotMode(_0xd5a720);else logger[_0x12cdd6(0x13d)](_0x12cdd6(0x22c));}),_0x32079c['on'](_0xca2414(0x310),(_0x35b120,_0x23b501)=>{const _0x4695f7=_0xca2414;if(validateAccess(_0x23b501,_0x9a639a)['allow'])deleteBot(_0x35b120);else logger[_0x4695f7(0x13d)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x32079c['on'](_0xca2414(0x2c8),(_0x369052,_0x437aec)=>{const _0x59f160=_0xca2414;if(validateAccess(_0x437aec,_0x9a639a)[_0x59f160(0x22f)])storeSettings(_0x369052,!![]);else logger[_0x59f160(0x13d)](_0x59f160(0x2ef));}),_0x32079c['on']('update-bb',_0x3ab5b0=>{const _0x599ef1=_0xca2414;if(validateAccess(_0x3ab5b0,_0x9a639a)[_0x599ef1(0x22f)])updateBB(_0x599ef1(0x167));else logger['full'](_0x599ef1(0x293));}),_0x32079c['on'](_0xca2414(0x1a8),_0x133813=>{const _0x11699e=_0xca2414;if(validateAccess(_0x133813,_0x9a639a)[_0x11699e(0x22f)])updateBB(_0x11699e(0x176));else logger[_0x11699e(0x13d)](_0x11699e(0x254));}),_0x32079c['on'](_0xca2414(0x21b),_0x207b86=>{const _0x5c6b53=_0xca2414;if(validateAccess(_0x207b86,_0x9a639a)[_0x5c6b53(0x22f)]){const _0x17a789=getClient(_0x32079c['id']);if(_0x17a789)getBackupFiles(_0x17a789[_0x5c6b53(0x17a)]);else logger['full'](_0x5c6b53(0x143));}else logger[_0x5c6b53(0x13d)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x32079c['on'](_0xca2414(0x249),(_0x86e47e,_0x31b064)=>{const _0x3fdda8=_0xca2414;if(validateAccess(_0x31b064,_0x9a639a)['allow'])restoreBackupFile(_0x86e47e);else logger[_0x3fdda8(0x13d)](_0x3fdda8(0x21a));}),_0x32079c['on'](_0xca2414(0x10c),_0x590362=>{const _0x23c3f2=_0xca2414;if(validateAccess(_0x590362,_0x9a639a)[_0x23c3f2(0x22f)])getMessages();else logger[_0x23c3f2(0x13d)](_0x23c3f2(0x224));}),_0x32079c['on']('confirm-message',(_0x4957da,_0x23f7b6)=>{const _0x4904a8=_0xca2414;if(validateAccess(_0x23f7b6,_0x9a639a)[_0x4904a8(0x22f)])confirmMessage(_0x4957da);else logger[_0x4904a8(0x13d)](_0x4904a8(0x2df));}),_0x32079c['on'](_0xca2414(0x28e),_0x27e577=>{const _0x2e997d=_0xca2414;if(validateAccess(_0x27e577,_0x9a639a)[_0x2e997d(0x22f)]){if(devices[_0x9a639a][_0x2e997d(0x276)])clearTimeout(devices[_0x9a639a][_0x2e997d(0x276)]);if(devices[_0x9a639a][_0x2e997d(0x10a)])clearTimeout(devices[_0x9a639a]['pidExpireLogin']);removeSocketListeners(getClient(_0x32079c['id'])[_0x2e997d(0x17a)]),addBlacklist(_0x9a639a),devices[_0x9a639a][_0x2e997d(0x20b)]=null,devices[_0x9a639a][_0x2e997d(0x1c4)]=null,devices[_0x9a639a][_0x2e997d(0x1bb)][_0x2e997d(0x20e)]=null,logger[_0x2e997d(0x204)]('Logged\x20out\x20user\x20...'+_0x9a639a[_0x2e997d(0x2c0)](-0x8)),io['to'](getClient(_0x32079c['id'])[_0x2e997d(0x17a)])[_0x2e997d(0x2a6)](_0x2e997d(0x145),{'access':{'allow':![],'reason':_0x2e997d(0x292),'token':null}});}else logger['full'](_0x2e997d(0x2f6));});}function initializeSocketBot(_0x2c4df5){const _0x5d1169=_0x148ee4,_0x5b98c5=getClient(_0x2c4df5['id'])[_0x5d1169(0x267)],_0x3b84ee=getClient(_0x2c4df5['id'])[_0x5d1169(0x17a)];_0x2c4df5['on'](_0x5d1169(0x195),(_0x5e77b4,_0x4fdd46)=>{const _0x54333c=_0x5d1169;if(validateAccess(_0x4fdd46,_0x3b84ee)['allow']){if(pid[_0x5b98c5])pid[_0x5b98c5]['send']({'function':_0x54333c(0x1af),'args':_0x5e77b4});}else logger[_0x54333c(0x13d)](_0x54333c(0x11c));}),_0x2c4df5['on'](_0x5d1169(0x146),(_0x31d81d,_0x12f330)=>{const _0x5e63ad=_0x5d1169;if(validateAccess(_0x12f330,_0x3b84ee)[_0x5e63ad(0x22f)]){if(pid[_0x5b98c5])pid[_0x5b98c5][_0x5e63ad(0x24a)]({'function':_0x5e63ad(0x2f8),'args':_0x31d81d});}else logger[_0x5e63ad(0x13d)](_0x5e63ad(0x2bf));}),_0x2c4df5['on']('get-portfolio',(_0x282086,_0x1caade)=>{const _0x583c17=_0x5d1169;if(validateAccess(_0x1caade,_0x3b84ee)[_0x583c17(0x22f)]){if(pid[_0x5b98c5])pid[_0x5b98c5][_0x583c17(0x24a)]({'function':_0x583c17(0x2a5),'args':_0x282086});}else logger[_0x583c17(0x13d)](_0x583c17(0x1cc));}),_0x2c4df5['on'](_0x5d1169(0x120),(_0x516eac,_0x52e707)=>{const _0x1fe5e3=_0x5d1169;if(validateAccess(_0x52e707,_0x3b84ee)[_0x1fe5e3(0x22f)]){if(pid[_0x5b98c5])pid[_0x5b98c5][_0x1fe5e3(0x24a)]({'function':_0x1fe5e3(0x1ce),'args':_0x516eac});}else logger[_0x1fe5e3(0x13d)](_0x1fe5e3(0x1b5));}),_0x2c4df5['on']('store-headless',(_0x37ee7b,_0x4e4f3e)=>{const _0x82c188=_0x5d1169;if(validateAccess(_0x4e4f3e,_0x3b84ee)[_0x82c188(0x22f)]){if(pid[_0x5b98c5])pid[_0x5b98c5][_0x82c188(0x24a)]({'function':_0x82c188(0x235),'args':_0x37ee7b});}else logger[_0x82c188(0x13d)](_0x82c188(0x147));}),_0x2c4df5['on'](_0x5d1169(0x29b),(_0x34bf7c,_0x365e59)=>{const _0x2c584a=_0x5d1169;if(validateAccess(_0x365e59,_0x3b84ee)['allow']){if(pid[_0x5b98c5])pid[_0x5b98c5][_0x2c584a(0x24a)]({'function':_0x2c584a(0x258),'args':_0x34bf7c});}else logger[_0x2c584a(0x13d)](_0x2c584a(0x27c));}),_0x2c4df5['on'](_0x5d1169(0x217),_0x4cb56f=>{const _0x1b767e=_0x5d1169;if(validateAccess(_0x4cb56f,_0x3b84ee)['allow']){if(pid[_0x5b98c5])pid[_0x5b98c5][_0x1b767e(0x24a)]({'function':_0x1b767e(0x1da),'args':null});}else logger[_0x1b767e(0x13d)](_0x1b767e(0x1a3));}),_0x2c4df5['on'](_0x5d1169(0x25a),_0x4dd89c=>{const _0x120333=_0x5d1169;if(validateAccess(_0x4dd89c,_0x3b84ee)[_0x120333(0x22f)]){if(pid[_0x5b98c5])pid[_0x5b98c5][_0x120333(0x24a)]({'function':'getStartingBalances','args':null});}else logger[_0x120333(0x13d)](_0x120333(0x2dc));}),_0x2c4df5['on'](_0x5d1169(0x2e8),(_0x7064d6,_0x54fbd1)=>{const _0x5464a7=_0x5d1169;if(validateAccess(_0x54fbd1,_0x3b84ee)[_0x5464a7(0x22f)]){if(pid[_0x5b98c5])pid[_0x5b98c5][_0x5464a7(0x24a)]({'function':'placeOrder','args':_0x7064d6});}else logger['full'](_0x5464a7(0x201));}),_0x2c4df5['on'](_0x5d1169(0x2a1),_0x5800f2=>{const _0x5ec2a2=_0x5d1169;if(validateAccess(_0x5800f2,_0x3b84ee)[_0x5ec2a2(0x22f)]){if(pid[_0x5b98c5])pid[_0x5b98c5][_0x5ec2a2(0x24a)]({'function':_0x5ec2a2(0x2a9),'args':null});}else logger[_0x5ec2a2(0x13d)](_0x5ec2a2(0x1b3));}),_0x2c4df5['on'](_0x5d1169(0x1aa),_0x1a18db=>{const _0xea39d0=_0x5d1169;if(validateAccess(_0x1a18db,_0x3b84ee)[_0xea39d0(0x22f)]){if(pid[_0x5b98c5])pid[_0x5b98c5][_0xea39d0(0x24a)]({'function':'showConfig','args':null});}else logger['full'](_0xea39d0(0x178));}),_0x2c4df5['on']('update-bb',_0x503b0d=>{const _0x3704fa=_0x5d1169;if(validateAccess(_0x503b0d,_0x3b84ee)[_0x3704fa(0x22f)])updateBB(_0x3704fa(0x167));else logger[_0x3704fa(0x13d)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2c4df5['on']('get-messages',_0x19c932=>{const _0xcb7e37=_0x5d1169;if(validateAccess(_0x19c932,_0x3b84ee)[_0xcb7e37(0x22f)])getMessages();else logger[_0xcb7e37(0x13d)](_0xcb7e37(0x224));}),_0x2c4df5['on'](_0x5d1169(0x282),(_0x53b3de,_0x161de)=>{const _0x378b83=_0x5d1169;if(validateAccess(_0x161de,_0x3b84ee)[_0x378b83(0x22f)])confirmMessage(_0x53b3de);else logger[_0x378b83(0x13d)](_0x378b83(0x2df));}),_0x2c4df5['on'](_0x5d1169(0x28e),_0x36ab4f=>{const _0x147a3e=_0x5d1169;if(validateAccess(_0x36ab4f,_0x3b84ee)['allow']){if(devices[_0x3b84ee][_0x147a3e(0x276)])clearTimeout(devices[_0x3b84ee]['pidRefreshToken']);if(devices[_0x3b84ee][_0x147a3e(0x10a)])clearTimeout(devices[_0x3b84ee]['pidExpireLogin']);removeSocketListeners(getClient(_0x2c4df5['id'])[_0x147a3e(0x17a)]),addBlacklist(_0x3b84ee),devices[_0x3b84ee][_0x147a3e(0x20b)]=null,devices[_0x3b84ee][_0x147a3e(0x1c4)]=null,devices[_0x3b84ee][_0x147a3e(0x1bb)][_0x147a3e(0x20e)]=null,logger['debug'](_0x147a3e(0x2cf)+_0x3b84ee[_0x147a3e(0x2c0)](-0x8)),io['to'](getClient(_0x2c4df5['id'])[_0x147a3e(0x17a)])['emit']('status',{'access':{'allow':![],'reason':_0x147a3e(0x292),'token':null}});}else logger[_0x147a3e(0x13d)](_0x147a3e(0x2f6));});}function removeSocketListeners(_0x4bef31){getClientsWithUuid(_0x4bef31)['forEach'](_0x1d145e=>{const _0x2703d9=_0xe43d;getSocket(_0x1d145e['id'])[_0x2703d9(0x237)]();});}function cleanSettings(){const _0x55be53=_0x148ee4;let _0x5b6d4b=settings;return settings[_0x55be53(0x135)]&&settings[_0x55be53(0x135)]!=''&&(_0x5b6d4b={..._0x5b6d4b,'telegramToken':_0x55be53(0x30f)}),settings[_0x55be53(0x25f)]&&settings['bbPassword']!=''&&(_0x5b6d4b={..._0x5b6d4b,'bbPassword':_0x55be53(0x30f)}),settings['marketcapApi']&&settings[_0x55be53(0x13a)]!=''&&(_0x5b6d4b={..._0x5b6d4b,'marketcapApi':_0x55be53(0x30f)}),(settings[_0x55be53(0x25f)]&&settings['bbPassword']==_0x55be53(0x2ae)||settings[_0x55be53(0x135)]&&settings['telegramToken']==_0x55be53(0x2ae)||settings[_0x55be53(0x13a)]&&settings[_0x55be53(0x13a)]==_0x55be53(0x2ae))&&(_0x5b6d4b={..._0x5b6d4b,'restored':{'password':settings[_0x55be53(0x25f)]=='***','telegram':settings[_0x55be53(0x135)]=='***','marketcap':settings[_0x55be53(0x13a)]=='***'}}),_0x5b6d4b;}async function updateBB(_0x4fb0a3){const _0x364be8=_0x148ee4;await backupConfigFiles(),installingUpdate=!![],config[_0x364be8(0x12f)](_0x55cdfa=>{const _0x379450=_0x364be8;restartBot(_0x55cdfa[_0x379450(0x2f7)]);});if(_0x4fb0a3=='update')process['send']({'update':!![],'environment':environment},_0x381da1=>{});else _0x4fb0a3==_0x364be8(0x176)&&process[_0x364be8(0x24a)]({'reinstall':!![],'environment':environment},_0x484500=>{});}function startBot(_0x22e237,_0xf10a86,_0x367209){const _0x38bb7b=_0x148ee4;if(debugging)_0x22e237[_0x38bb7b(0x1e6)]('-d');if(recreate)_0x22e237[_0x38bb7b(0x1e6)]('-r');let _0x41afa6=![];const _0x36442c=_0x22e237[0x0];_0xf10a86={..._0xf10a86,'stdio':[_0x38bb7b(0x1d2),_0x38bb7b(0x1d2),_0x38bb7b(0x1d2),_0x38bb7b(0x21f)]},pid[_0x36442c]=childProcess[_0x38bb7b(0x301)](botfile,_0x22e237,_0xf10a86),pid[_0x36442c]['on']('message',_0x22e643=>{const _0x52d4d5=_0x38bb7b;switch(Object['keys'](_0x22e643)[0x0]){case'botname':updateBotName(_0x36442c,_0x22e643['botname']);break;case _0x52d4d5(0x2b5):updateBotManager();break;case _0x52d4d5(0x145):updateStatus(_0x36442c,_0x22e643[_0x52d4d5(0x145)]);break;case _0x52d4d5(0x289):updateLive(_0x36442c,_0x22e643['live']);break;case _0x52d4d5(0x25b):updateLive(_0x36442c,_0x22e643[_0x52d4d5(0x25b)]),io['to'](_0x36442c)[_0x52d4d5(0x2a6)](_0x52d4d5(0x145),{'access':{'allow':![],'reason':_0x52d4d5(0x108),'token':null}});break;case _0x52d4d5(0x265):_0x22e643[_0x52d4d5(0x265)]==_0x52d4d5(0x12e)&&restartBot(_0x36442c);_0x22e643[_0x52d4d5(0x265)]==_0x52d4d5(0x1f1)&&toggleBot(_0x36442c,_0x52d4d5(0x1e7),_0x52d4d5(0x127));break;case _0x52d4d5(0x191):sendTelegramBot(_0x36442c,_0x22e643[_0x52d4d5(0x191)]);break;case _0x52d4d5(0x13e):sendTelegramMsg(_0x22e643[_0x52d4d5(0x13e)]);break;case _0x52d4d5(0x2ca):io['to'](_0x36442c)[_0x52d4d5(0x2a6)](_0x22e643[_0x52d4d5(0x2ca)],_0x22e643[_0x52d4d5(0x1e1)]);break;}}),pid[_0x36442c]['on'](_0x38bb7b(0x2e5),function(_0x4e0505){if(_0x41afa6)return;_0x41afa6=!![],_0x367209(_0x4e0505);}),pid[_0x36442c]['on'](_0x38bb7b(0x1f0),async function(_0xb9fffd){const _0x1be32b=_0x38bb7b;if(terminating)return;if(installingUpdate){io[_0x1be32b(0x261)]();return;}if(_0x41afa6)return;_0x41afa6=!![],_0x367209(null);const _0x233fd0=dbConfig[_0x1be32b(0x165)](_0x1be32b(0x26f))[_0x1be32b(0x23f)]({'botID':_0x36442c})['value']();_0x233fd0&&(_0x233fd0[_0x1be32b(0x145)]==_0x1be32b(0x1ca)||_0x233fd0[_0x1be32b(0x145)]==_0x1be32b(0x1ea))&&(await sleep(0x3e8),updateLive(_0x36442c,_0x1be32b(0x127)),logger[_0x1be32b(0x13d)](_0x1be32b(0x1d8)+botRef(_0x36442c)),startBot([_0x36442c,userID],{'cwd':bbpath},function(_0x138fdc){const _0x2d2390=_0x1be32b;if(_0x138fdc)logger[_0x2d2390(0x13d)](_0x138fdc);}));});}function stopBot(_0x214740){const _0x1e80fb=_0x148ee4;getClientsWithBotID(_0x214740)[_0x1e80fb(0x12f)](_0x2313c1=>{const _0x259673=_0x1e80fb;getSocket(_0x2313c1['id'])[_0x259673(0x2d4)](!![]),removeClient(_0x2313c1['id']);}),pid[_0x214740]&&(pid[_0x214740]['kill'](),pid[_0x214740]=null);}function stopAllBots(){terminating=!![];const _0x48917e=getEnabledBots();_0x48917e['forEach'](_0x5b2936=>{const _0x10a5bc=_0xe43d;stopBot(_0x5b2936[_0x10a5bc(0x2f7)]);});}function restartBot(_0x5b1fb5){const _0x20a2e9=_0x148ee4;if(pid[_0x5b1fb5])pid[_0x5b1fb5][_0x20a2e9(0x1f1)]();}function addBot(){const _0xc3fb65=_0x148ee4;let _0x239625;for(let _0x29f6be=0x1;_0x29f6be<0x3e9;_0x29f6be++){_0x239625=_0x29f6be[_0xc3fb65(0x27d)]()[_0xc3fb65(0x2cc)](0x3,'0');let _0x4bb8c5=config[_0xc3fb65(0x23f)](_0x2a4ebc=>_0x2a4ebc[_0xc3fb65(0x2f7)]==_0x239625);if(!_0x4bb8c5)break;}if(_0x239625==='1000'){logger['full']('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0xc3fb65(0x13d)](_0xc3fb65(0x2c3)+_0x239625),dbConfig[_0xc3fb65(0x165)](_0xc3fb65(0x26f))['push']({'botID':_0x239625,'botname':'Bot\x20'+_0x239625,'status':_0xc3fb65(0x1ea),'live':''})[_0xc3fb65(0x107)](),startBot([_0x239625,userID],{'cwd':bbpath},function(_0x1a3842){const _0x349df5=_0xc3fb65;if(_0x1a3842)logger[_0x349df5(0x13d)](_0x1a3842);}),config=getConfiguration(),io['to'](_0xc3fb65(0x18e))[_0xc3fb65(0x2a6)](_0xc3fb65(0x26f),config),broadcastToBots(_0xc3fb65(0x26f),JSON[_0xc3fb65(0x188)](config));}function deleteBot(_0x209312){const _0xe77f04=_0x148ee4;getClientsWithBotID(_0x209312)[_0xe77f04(0x12f)](_0x407b0c=>{const _0x272e15=_0xe77f04;getSocket(_0x407b0c['id'])[_0x272e15(0x2d4)](!![]),removeClient(_0x407b0c['id']);}),dbConfig['get'](_0xe77f04(0x26f))[_0xe77f04(0x1f8)]({'botID':_0x209312})[_0xe77f04(0x107)](),logger[_0xe77f04(0x13d)](_0xe77f04(0x1c6)+_0x209312),stopBot(_0x209312);try{if(fs[_0xe77f04(0x24c)](path[_0xe77f04(0x156)](configpath,_0xe77f04(0x2f2)+_0x209312+'-config.json')))fs['unlinkSync'](path[_0xe77f04(0x156)](configpath,'bot-'+_0x209312+_0xe77f04(0x1f9)));if(fs[_0xe77f04(0x24c)](path[_0xe77f04(0x156)](configpath,_0xe77f04(0x2f2)+_0x209312+'-events.json')))fs[_0xe77f04(0x1b9)](path['join'](configpath,_0xe77f04(0x2f2)+_0x209312+_0xe77f04(0x2c2)));if(fs[_0xe77f04(0x24c)](path[_0xe77f04(0x156)](configpath,_0xe77f04(0x2f2)+_0x209312+_0xe77f04(0x2a4))))fs['unlinkSync'](path['join'](configpath,_0xe77f04(0x2f2)+_0x209312+_0xe77f04(0x2a4)));if(fs[_0xe77f04(0x24c)](path[_0xe77f04(0x156)](configpath,_0xe77f04(0x2f2)+_0x209312+_0xe77f04(0x11e))))fs[_0xe77f04(0x1b9)](path['join'](configpath,'bot-'+_0x209312+_0xe77f04(0x11e)));}catch(_0x3660ea){if(_0x3660ea)logger[_0xe77f04(0x13d)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x3660ea);}config=getConfiguration(),io['to'](_0xe77f04(0x18e))[_0xe77f04(0x2a6)](_0xe77f04(0x26f),config),broadcastToBots(_0xe77f04(0x26f),JSON[_0xe77f04(0x188)](config));}function toggleBot(_0x491f2e,_0x8efe23,_0x3ac070){const _0x26880a=_0x148ee4;dbConfig[_0x26880a(0x165)](_0x26880a(0x26f))['find']({'botID':_0x491f2e})[_0x26880a(0x1bc)]({'status':_0x8efe23})[_0x26880a(0x1bc)]({'live':_0x3ac070})[_0x26880a(0x107)]();const _0x3253b8=botRef(_0x491f2e);if(_0x8efe23==_0x26880a(0x1ca)||_0x8efe23=='new')logger[_0x26880a(0x13d)](_0x26880a(0x10d)+_0x3253b8),startBot([_0x491f2e,userID],{'cwd':bbpath},function(_0x243250){if(_0x243250)logger['full'](_0x243250);});else(_0x8efe23==_0x26880a(0x1e7)||_0x8efe23==_0x26880a(0x15b))&&(logger[_0x26880a(0x13d)](_0x26880a(0x2a8)+_0x3253b8),stopBot(_0x491f2e));config=getConfiguration(),io['to'](_0x26880a(0x18e))[_0x26880a(0x2a6)](_0x26880a(0x26f),config),broadcastToBots(_0x26880a(0x26f),JSON[_0x26880a(0x188)](config));}function toggleStatus(_0x5d30b5){const _0x58d04e=_0x148ee4;let _0x1cb859=dbConfig['get'](_0x58d04e(0x26f))[_0x58d04e(0x23f)]({'botID':_0x5d30b5})[_0x58d04e(0x2af)](),_0x4ebf60;if(_0x1cb859[_0x58d04e(0x145)]==='enabled')_0x4ebf60=_0x58d04e(0x1e7);else{if(_0x1cb859[_0x58d04e(0x145)]===_0x58d04e(0x1ea))_0x4ebf60=_0x58d04e(0x15b);else{if(_0x1cb859[_0x58d04e(0x145)]===_0x58d04e(0x15b))_0x4ebf60='new';else{if(_0x1cb859[_0x58d04e(0x145)]===_0x58d04e(0x1e7))_0x4ebf60=_0x58d04e(0x1ca);}}}return _0x4ebf60;}function updateStatus(_0x26cf92,_0x1f93f9){const _0xda893d=_0x148ee4;dbConfig['get'](_0xda893d(0x26f))[_0xda893d(0x23f)]({'botID':_0x26cf92})[_0xda893d(0x1bc)]({'status':_0x1f93f9})['write'](),config=getConfiguration(),io['to'](_0xda893d(0x18e))[_0xda893d(0x2a6)]('bots',config),broadcastToBots(_0xda893d(0x26f),JSON['stringify'](config));}function updateLive(_0x1a7140,_0x3b0b7b){const _0x55a6a3=_0x148ee4;dbConfig['get'](_0x55a6a3(0x26f))[_0x55a6a3(0x23f)]({'botID':_0x1a7140})['assign']({'live':_0x3b0b7b})[_0x55a6a3(0x107)](),config=getConfiguration(),io['to'](_0x55a6a3(0x18e))[_0x55a6a3(0x2a6)]('bots',config),broadcastToBots(_0x55a6a3(0x26f),JSON[_0x55a6a3(0x188)](config));}function updateBotName(_0x1c60ca,_0x33d0e7){const _0x39328e=_0x148ee4;dbConfig[_0x39328e(0x165)](_0x39328e(0x26f))['find']({'botID':_0x1c60ca})[_0x39328e(0x1bc)]({'botname':_0x33d0e7})[_0x39328e(0x107)](),config=getConfiguration(),io['to'](_0x39328e(0x18e))[_0x39328e(0x2a6)](_0x39328e(0x26f),config),broadcastToBots(_0x39328e(0x26f),JSON[_0x39328e(0x188)](config));}function updateBotManager(){const _0x396e6c=_0x148ee4;config=getConfiguration(),io['to'](_0x396e6c(0x18e))[_0x396e6c(0x2a6)]('bots',config),broadcastToBots('bots',JSON[_0x396e6c(0x188)](config));}function toggleBotMode(_0x2a98dd){const _0x573297=_0x148ee4;if(pid[_0x2a98dd])pid[_0x2a98dd][_0x573297(0x24a)]({'function':_0x573297(0x22a),'args':null});else{const _0x1de991=configpath+_0x573297(0x2f2)+_0x2a98dd+_0x573297(0x1f9),_0x506f67=fs[_0x573297(0x100)](_0x1de991),_0x2fa477=JSON[_0x573297(0x128)](_0x506f67),_0x217e3a=_0x2fa477[_0x573297(0x267)][0x0][_0x573297(0x30b)];_0x2fa477['bot'][0x0][_0x573297(0x30b)]=!_0x217e3a;const _0xbf818b=JSON[_0x573297(0x188)](_0x2fa477,null,0x2);fs[_0x573297(0x256)](_0x1de991,_0xbf818b),config=getConfiguration(),io['to'](_0x573297(0x18e))['emit'](_0x573297(0x26f),config),broadcastToBots('bots',JSON[_0x573297(0x188)](config));}}function validateTelegram(_0x2f871c){const _0x4fcaea=_0x148ee4;if(_0x2f871c[_0x4fcaea(0x200)][_0x4fcaea(0x228)]!=settings[_0x4fcaea(0x306)]&&'@'+_0x2f871c[_0x4fcaea(0x200)][_0x4fcaea(0x228)]!=settings[_0x4fcaea(0x306)]||_0x2f871c['chat']['id']!=settings[_0x4fcaea(0x294)])return sendTelegram(_0x2f871c[_0x4fcaea(0x185)]['id'],_0x4fcaea(0x2f9),{'parse_mode':_0x4fcaea(0x2ff)}),![];return!![];}function botRef(_0x1d8c5e){const _0x25fe33=_0x148ee4,_0x1388cb=getBotAttributes(_0x1d8c5e),_0x5f00bf=_0x1388cb[_0x25fe33(0x105)]?_0x1388cb['botname']:_0x25fe33(0x279)+_0x1d8c5e;return _0x5f00bf;}async function initTelegram(){const _0x209cff=_0x148ee4;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x209cff(0x135)]);let _0x7a7fe2='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x7a7fe2+='\x0a',_0x7a7fe2+=_0x209cff(0x24e),_0x7a7fe2+=_0x209cff(0x183),_0x7a7fe2+=_0x209cff(0x192),_0x7a7fe2+=_0x209cff(0x287),_0x7a7fe2+=_0x209cff(0x16b),_0x7a7fe2+=_0x209cff(0x231),_0x7a7fe2+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x7a7fe2+=_0x209cff(0x225),_0x7a7fe2+=_0x209cff(0x30e),_0x7a7fe2+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x7a7fe2+=_0x209cff(0x124),_0x7a7fe2+='/logs\x20-\x20receive\x20log\x20files\x0a',_0x7a7fe2+=_0x209cff(0x2e6),_0x7a7fe2+=_0x209cff(0x2cd),_0x7a7fe2+=_0x209cff(0x138),_0x7a7fe2+=_0x209cff(0x144);let _0x1c29b5=_0x209cff(0x23c);_0x1c29b5+='\x0a',_0x1c29b5+=_0x7a7fe2,tgBot[_0x209cff(0x1ae)]((_0x4891ac,_0x1eb971)=>{const _0x599b26=_0x209cff;logger[_0x599b26(0x1d6)](getTimeStamp()+_0x599b26(0x251)),logger[_0x599b26(0x204)](_0x599b26(0x157),_0x4891ac);}),tgBot[_0x209cff(0x160)](async(_0x5cb7bf,_0x552ff6)=>{const _0x3f97b9=_0x209cff;if(settings['telegramChatId']||_0x5cb7bf[_0x3f97b9(0x167)]['message'][_0x3f97b9(0x313)]!=_0x3f97b9(0x2a2)){if(!validateTelegram(_0x5cb7bf))return;}_0x552ff6();}),tgBot[_0x209cff(0x163)]('start',async _0x3e8c02=>{const _0x1d0f6d=_0x209cff;if(_0x3e8c02[_0x1d0f6d(0x200)][_0x1d0f6d(0x228)]==settings['telegramUsername']||'@'+_0x3e8c02['from'][_0x1d0f6d(0x228)]==settings[_0x1d0f6d(0x306)]){if(!settings['telegramChatId'])updateSetting(_0x1d0f6d(0x294),_0x3e8c02['chat']['id']);else{if(!validateTelegram(_0x3e8c02))return;}}else{if(!validateTelegram(_0x3e8c02))return;}updateSetting(_0x1d0f6d(0x1b4),!![]),await sendTelegram(_0x3e8c02[_0x1d0f6d(0x185)]['id'],_0x1c29b5);}),tgBot['command'](_0x209cff(0x2ce),async _0x51c5c4=>{const _0x6dd3de=_0x209cff;updateSetting(_0x6dd3de(0x1b4),!![]),await sendTelegram(_0x51c5c4[_0x6dd3de(0x185)]['id'],'Notifications\x20enabled');}),tgBot[_0x209cff(0x163)](_0x209cff(0x2e7),async _0x2e696a=>{const _0x405331=_0x209cff;await sendTelegram(_0x2e696a[_0x405331(0x185)]['id'],_0x405331(0x106)),updateSetting(_0x405331(0x1b4),![]);}),tgBot['command'](_0x209cff(0x245),async _0x591c26=>{const _0x2e4c55=_0x209cff,_0x244b15=Markup[_0x2e4c55(0x2f4)]([Markup[_0x2e4c55(0x1a2)][_0x2e4c55(0x12b)](_0x2e4c55(0x1f7),'config_orders'),Markup[_0x2e4c55(0x1a2)][_0x2e4c55(0x12b)](_0x2e4c55(0x177),_0x2e4c55(0x26e)),Markup[_0x2e4c55(0x1a2)][_0x2e4c55(0x12b)]('All',_0x2e4c55(0x236))]);_0x591c26['reply'](_0x2e4c55(0x1c7),_0x244b15);}),tgBot[_0x209cff(0x257)]('config_orders',async _0x2a9d1f=>{const _0x10c34a=_0x209cff;_0x2a9d1f['editMessageReplyMarkup'](),updateSetting(_0x10c34a(0x113),_0x10c34a(0x30d)),updateSetting(_0x10c34a(0x1b4),!![]),await sendTelegram(_0x2a9d1f[_0x10c34a(0x185)]['id'],_0x10c34a(0x2b2));}),tgBot[_0x209cff(0x257)](_0x209cff(0x26e),async _0x5d70f2=>{const _0x436049=_0x209cff;_0x5d70f2[_0x436049(0x16a)](),updateSetting(_0x436049(0x113),'alerts'),updateSetting(_0x436049(0x1b4),!![]),await sendTelegram(_0x5d70f2['chat']['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x209cff(0x257)](_0x209cff(0x236),async _0x34736b=>{const _0x4aa1f6=_0x209cff;_0x34736b[_0x4aa1f6(0x16a)](),updateSetting('telegramEvents',_0x4aa1f6(0x273)),updateSetting(_0x4aa1f6(0x1b4),!![]),await sendTelegram(_0x34736b[_0x4aa1f6(0x185)]['id'],_0x4aa1f6(0x28a));}),tgBot[_0x209cff(0x163)](_0x209cff(0x145),async _0x4e21d7=>{const _0x53f77b=_0x209cff,_0x284718=getBotsWithMode();let _0x311039=_0x53f77b(0x244);config[_0x53f77b(0x12f)](_0x1ded51=>{const _0x40d5f4=_0x53f77b,_0x21f125=_0x284718['find'](_0x3e76ed=>_0x3e76ed[_0x40d5f4(0x2f7)]==_0x1ded51[_0x40d5f4(0x2f7)])[_0x40d5f4(0x12a)];_0x311039+=_0x40d5f4(0x279)+_0x1ded51[_0x40d5f4(0x2f7)]+':\x20'+_0x1ded51[_0x40d5f4(0x145)]+_0x40d5f4(0x307)+_0x21f125+_0x40d5f4(0x307)+_0x1ded51[_0x40d5f4(0x289)]+'\x0a';}),_0x311039+='\x0a',_0x311039+=_0x53f77b(0x2e2),_0x311039+=!settings[_0x53f77b(0x1b4)]?_0x53f77b(0x221):_0x53f77b(0x1bd),_0x311039+=settings[_0x53f77b(0x1b4)]?settings['telegramEvents']=='all'?_0x53f77b(0x314):_0x53f77b(0x29d)+settings[_0x53f77b(0x113)]+_0x53f77b(0x30a):'',await sendTelegram(_0x4e21d7['chat']['id'],_0x311039,{'parse_mode':_0x53f77b(0x2ff)});}),tgBot[_0x209cff(0x163)]('restart',async _0x443221=>{const _0x4970a0=_0x209cff,_0x2e75f7=getEnabledBots();if(_0x2e75f7[_0x4970a0(0x20d)]==0x0)await sendTelegram(_0x443221[_0x4970a0(0x185)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x2e75f7[_0x4970a0(0x20d)]>0x1)_0x2e75f7[_0x4970a0(0x1e6)]({'botID':_0x4970a0(0x273)});let _0x65cf67=[],_0x101955=[];const _0x499773=_0x2e75f7[_0x4970a0(0x20d)]%0x4==0x0||_0x2e75f7[_0x4970a0(0x20d)]%0x4==0x3||_0x2e75f7[_0x4970a0(0x20d)]%0x3==0x1?0x4:0x3;let _0x1f763f=0x0;_0x2e75f7[_0x4970a0(0x12f)]((_0x1dbe9a,_0x530286)=>{const _0x271eac=_0x4970a0;if(_0x530286%_0x499773==0x0)_0x101955=[];_0x101955[_0x271eac(0x1e6)](Markup[_0x271eac(0x1a2)][_0x271eac(0x12b)](_0x1dbe9a[_0x271eac(0x2f7)]==_0x271eac(0x273)?_0x271eac(0x24f):botRef(_0x1dbe9a[_0x271eac(0x2f7)]),'restart_'+_0x1dbe9a[_0x271eac(0x2f7)])),_0x530286%_0x499773==0x0&&(_0x65cf67[_0x1f763f]=_0x101955,_0x1f763f++);});const _0x352136=Markup[_0x4970a0(0x2f4)](_0x65cf67);_0x443221['reply'](_0x4970a0(0x311),_0x352136);}}),tgBot['action'](/restart_(.+)/,async _0x5d996a=>{const _0x4877ba=_0x209cff,_0x1f1336=_0x5d996a[_0x4877ba(0x232)][0x1];_0x5d996a[_0x4877ba(0x16a)](),_0x1f1336=='all'?config['forEach'](_0x2059ff=>{const _0x134a7e=_0x4877ba;restartBot(_0x2059ff[_0x134a7e(0x2f7)]);}):restartBot(_0x1f1336);}),tgBot['command']('on',async _0x56ef0e=>{const _0x1c26fb=_0x209cff,_0x41d221=getDisabledBots();if(_0x41d221[_0x1c26fb(0x20d)]==0x0)await sendTelegram(_0x56ef0e['chat']['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x41d221['length']>0x1)_0x41d221[_0x1c26fb(0x1e6)]({'botID':_0x1c26fb(0x273)});let _0x2d573a=[],_0x40da1f=[];const _0x3398e9=_0x41d221[_0x1c26fb(0x20d)]%0x4==0x0||_0x41d221['length']%0x4==0x3||_0x41d221[_0x1c26fb(0x20d)]%0x3==0x1?0x4:0x3;let _0x3f0ac4=0x0;_0x41d221['forEach']((_0x4c665a,_0xcb75a0)=>{const _0x16ca51=_0x1c26fb;if(_0xcb75a0%_0x3398e9==0x0)_0x40da1f=[];_0x40da1f[_0x16ca51(0x1e6)](Markup[_0x16ca51(0x1a2)][_0x16ca51(0x12b)](_0x4c665a[_0x16ca51(0x2f7)]=='all'?_0x16ca51(0x24f):botRef(_0x4c665a[_0x16ca51(0x2f7)]),'on_'+_0x4c665a[_0x16ca51(0x2f7)])),_0xcb75a0%_0x3398e9==0x0&&(_0x2d573a[_0x3f0ac4]=_0x40da1f,_0x3f0ac4++);});const _0x55ae8a=Markup[_0x1c26fb(0x2f4)](_0x2d573a);_0x56ef0e[_0x1c26fb(0x2c9)](_0x1c26fb(0x266),_0x55ae8a);}}),tgBot['action'](/on_(.+)/,async _0x400d4b=>{const _0x1a1a07=_0x209cff,_0x21a0a2=_0x400d4b[_0x1a1a07(0x232)][0x1];_0x400d4b[_0x1a1a07(0x16a)]();if(_0x21a0a2==_0x1a1a07(0x273)){const _0x902ad4=getDisabledBots();await sendTelegram(_0x400d4b[_0x1a1a07(0x185)]['id'],_0x1a1a07(0x272)),_0x902ad4[_0x1a1a07(0x12f)](_0x247254=>{const _0x53e3df=_0x1a1a07;if(_0x247254['botID']!=_0x53e3df(0x273))toggleBot(_0x247254[_0x53e3df(0x2f7)],toggleStatus(_0x247254[_0x53e3df(0x2f7)]),_0x53e3df(0x127));});}else await sendTelegram(_0x400d4b['chat']['id'],_0x1a1a07(0x285)+botRef(_0x21a0a2)),toggleBot(_0x21a0a2,toggleStatus(_0x21a0a2),'stopped');}),tgBot[_0x209cff(0x163)](_0x209cff(0x1d3),async _0x32dc33=>{const _0x5cf6b7=_0x209cff,_0x2809c5=getEnabledBots();if(_0x2809c5[_0x5cf6b7(0x20d)]==0x0)await sendTelegram(_0x32dc33[_0x5cf6b7(0x185)]['id'],_0x5cf6b7(0x186));else{if(_0x2809c5[_0x5cf6b7(0x20d)]>0x1)_0x2809c5[_0x5cf6b7(0x1e6)]({'botID':_0x5cf6b7(0x273)});let _0x5c7396=[],_0x196ff8=[];const _0x5ec11a=_0x2809c5[_0x5cf6b7(0x20d)]%0x4==0x0||_0x2809c5[_0x5cf6b7(0x20d)]%0x4==0x3||_0x2809c5['length']%0x3==0x1?0x4:0x3;let _0x11b405=0x0;_0x2809c5['forEach']((_0x4868a1,_0x40ac56)=>{const _0x1f830d=_0x5cf6b7;if(_0x40ac56%_0x5ec11a==0x0)_0x196ff8=[];_0x196ff8[_0x1f830d(0x1e6)](Markup[_0x1f830d(0x1a2)]['callback'](_0x4868a1[_0x1f830d(0x2f7)]=='all'?'All\x20bots':botRef(_0x4868a1['botID']),'off_'+_0x4868a1['botID'])),_0x40ac56%_0x5ec11a==0x0&&(_0x5c7396[_0x11b405]=_0x196ff8,_0x11b405++);});const _0x1f32ec=Markup[_0x5cf6b7(0x2f4)](_0x5c7396);_0x32dc33['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x1f32ec);}}),tgBot['action'](/off_(.+)/,async _0x3d1256=>{const _0x5acb82=_0x209cff,_0x185ed2=_0x3d1256[_0x5acb82(0x232)][0x1];_0x3d1256['editMessageReplyMarkup']();if(_0x185ed2==_0x5acb82(0x273)){const _0x52cd0b=getEnabledBots();await sendTelegram(_0x3d1256[_0x5acb82(0x185)]['id'],_0x5acb82(0x2c5)),_0x52cd0b[_0x5acb82(0x12f)](_0x467a0b=>{const _0x52ba31=_0x5acb82;if(_0x467a0b[_0x52ba31(0x2f7)]!=_0x52ba31(0x273))toggleBot(_0x467a0b['botID'],toggleStatus(_0x467a0b[_0x52ba31(0x2f7)]),_0x52ba31(0x127));});}else await sendTelegram(_0x3d1256[_0x5acb82(0x185)]['id'],_0x5acb82(0x1fb)+botRef(_0x185ed2)),toggleBot(_0x185ed2,toggleStatus(_0x185ed2),'stopped');}),tgBot[_0x209cff(0x163)]('metrics',async _0x4f5494=>{const _0x4c0582=_0x209cff,_0x552924=getEnabledBots();if(_0x552924['length']==0x0)await sendTelegram(_0x4f5494[_0x4c0582(0x185)]['id'],_0x4c0582(0x186));else{if(_0x552924['length']>0x1){let _0x2504d8=[],_0x1e4e0d=[];const _0x46ee5a=_0x552924[_0x4c0582(0x20d)]%0x4==0x0||_0x552924[_0x4c0582(0x20d)]%0x4==0x3||_0x552924[_0x4c0582(0x20d)]%0x3==0x1?0x4:0x3;let _0x31911f=0x0;_0x552924[_0x4c0582(0x12f)]((_0x4c64d1,_0x234ae6)=>{const _0x442011=_0x4c0582;if(_0x234ae6%_0x46ee5a==0x0)_0x1e4e0d=[];_0x1e4e0d[_0x442011(0x1e6)](Markup[_0x442011(0x1a2)][_0x442011(0x12b)](botRef(_0x4c64d1[_0x442011(0x2f7)]),'metrics_'+_0x4c64d1[_0x442011(0x2f7)])),_0x234ae6%_0x46ee5a==0x0&&(_0x2504d8[_0x31911f]=_0x1e4e0d,_0x31911f++);});const _0x2888d0=Markup['inlineKeyboard'](_0x2504d8);_0x4f5494[_0x4c0582(0x2c9)](_0x4c0582(0x27f),_0x2888d0);}else{const _0x517dca=_0x552924[0x0][_0x4c0582(0x2f7)];if(pid[_0x517dca])pid[_0x517dca][_0x4c0582(0x24a)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x209cff(0x257)](/metrics_(.+)/,async _0xfc3240=>{const _0x26ab8c=_0x209cff,_0x44e717=_0xfc3240[_0x26ab8c(0x232)][0x1];_0xfc3240[_0x26ab8c(0x16a)]();if(pid[_0x44e717])pid[_0x44e717][_0x26ab8c(0x24a)]({'function':'sendMetricsTelegram','args':null});}),tgBot['command'](_0x209cff(0x308),async _0x5a6e98=>{const _0xdacadf=_0x209cff,_0x2886a0=getEnabledBots();if(_0x2886a0[_0xdacadf(0x20d)]==0x0)await sendTelegram(_0x5a6e98[_0xdacadf(0x185)]['id'],_0xdacadf(0x186));else{if(_0x2886a0[_0xdacadf(0x20d)]>0x1){let _0x5e92cd=[],_0x58b5bb=[];const _0x2c3181=_0x2886a0[_0xdacadf(0x20d)]%0x4==0x0||_0x2886a0['length']%0x4==0x3||_0x2886a0[_0xdacadf(0x20d)]%0x3==0x1?0x4:0x3;let _0x4d8ec3=0x0;_0x2886a0[_0xdacadf(0x12f)]((_0x15064f,_0x4f92ea)=>{const _0x4eff60=_0xdacadf;if(_0x4f92ea%_0x2c3181==0x0)_0x58b5bb=[];_0x58b5bb[_0x4eff60(0x1e6)](Markup[_0x4eff60(0x1a2)]['callback'](botRef(_0x15064f[_0x4eff60(0x2f7)]),_0x4eff60(0x218)+_0x15064f[_0x4eff60(0x2f7)])),_0x4f92ea%_0x2c3181==0x0&&(_0x5e92cd[_0x4d8ec3]=_0x58b5bb,_0x4d8ec3++);});const _0x443a5e=Markup[_0xdacadf(0x2f4)](_0x5e92cd);_0x5a6e98['reply'](_0xdacadf(0x14a),_0x443a5e);}else{const _0x3b1a30=_0x2886a0[0x0]['botID'];if(pid[_0x3b1a30])pid[_0x3b1a30][_0xdacadf(0x24a)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x209cff(0x257)](/portfolio_(.+)/,async _0x56608d=>{const _0x4437b7=_0x209cff,_0x5f5676=_0x56608d[_0x4437b7(0x232)][0x1];_0x56608d[_0x4437b7(0x16a)]();if(pid[_0x5f5676])pid[_0x5f5676]['send']({'function':_0x4437b7(0x274),'args':null});}),tgBot['command'](_0x209cff(0x2d0),async _0x534d48=>{const _0x3421fa=_0x209cff,_0x3f3940=_0x3421fa(0x2d0);await zipFiles(_0x3f3940);const _0x4c88b1=zippath+(_0x3f3940+_0x3421fa(0x2b9));_0x534d48['replyWithDocument']({'source':_0x4c88b1})[_0x3421fa(0x166)](()=>{})['catch'](_0x4f946f=>logger[_0x3421fa(0x204)](_0x3421fa(0x2f0)+_0x3f3940+_0x3421fa(0x190),_0x4f946f));}),tgBot[_0x209cff(0x163)](_0x209cff(0x2c6),async _0x298e05=>{const _0x57b975=_0x209cff,_0x39a1d9=_0x57b975(0x2c6);await backupConfigFiles(),await zipFiles(_0x39a1d9);const _0x2209ec=zippath+(_0x39a1d9+_0x57b975(0x2b9));_0x298e05[_0x57b975(0x14d)]({'source':_0x2209ec})[_0x57b975(0x166)](()=>{})[_0x57b975(0x1ae)](_0x22a140=>logger[_0x57b975(0x204)](_0x57b975(0x2f0)+_0x39a1d9+_0x57b975(0x190),_0x22a140));}),tgBot[_0x209cff(0x163)](_0x209cff(0x167),async _0x4f87ef=>{const _0x461376=_0x209cff;await getMessages();if(!updateAvailable)await sendTelegram(_0x4f87ef[_0x461376(0x185)]['id'],_0x461376(0x14e));else{if(!validInstallation)await sendTelegram(_0x4f87ef['chat']['id'],_0x461376(0x203));else{const _0x40217e=Markup[_0x461376(0x2f4)]([Markup[_0x461376(0x1a2)][_0x461376(0x12b)](_0x461376(0x16e),'update_yes'),Markup[_0x461376(0x1a2)][_0x461376(0x12b)]('No',_0x461376(0x1e8))]);_0x4f87ef[_0x461376(0x2c9)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x40217e);}}}),tgBot[_0x209cff(0x257)](/update_(.+)/,async _0x3cfd80=>{const _0x4a2c4d=_0x209cff,_0xf2e712=_0x3cfd80[_0x4a2c4d(0x232)][0x1];_0x3cfd80[_0x4a2c4d(0x16a)](),_0xf2e712==_0x4a2c4d(0x168)&&(await sendTelegram(_0x3cfd80[_0x4a2c4d(0x185)]['id'],_0x4a2c4d(0x11b)),updateBB(_0x4a2c4d(0x167))),_0xf2e712=='no'&&await sendTelegram(_0x3cfd80['chat']['id'],_0x4a2c4d(0x288));}),tgBot[_0x209cff(0x163)](_0x209cff(0x176),async _0x2931e6=>{const _0x13a415=_0x209cff;if(!validInstallation)await sendTelegram(_0x2931e6[_0x13a415(0x185)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x47cb72=Markup[_0x13a415(0x2f4)]([Markup[_0x13a415(0x1a2)]['callback'](_0x13a415(0x16e),_0x13a415(0x239)),Markup['button']['callback']('No',_0x13a415(0x159))]);_0x2931e6[_0x13a415(0x2c9)](_0x13a415(0x2d8),_0x47cb72);}}),tgBot[_0x209cff(0x257)](/reinstall_(.+)/,async _0x90f65e=>{const _0x16ad91=_0x209cff,_0x592d7a=_0x90f65e['match'][0x1];_0x90f65e[_0x16ad91(0x16a)](),_0x592d7a==_0x16ad91(0x168)&&(await sendTelegram(_0x90f65e[_0x16ad91(0x185)]['id'],_0x16ad91(0x1d0)),updateBB(_0x16ad91(0x176))),_0x592d7a=='no'&&await sendTelegram(_0x90f65e[_0x16ad91(0x185)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x209cff(0x163)](_0x209cff(0x1c9),async _0x3b7bf0=>{const _0x4784e7=_0x209cff,_0x1ef5b9=getBotsWithMode();if(_0x1ef5b9[_0x4784e7(0x20d)]==0x0)await sendTelegram(_0x3b7bf0[_0x4784e7(0x185)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x10022e=[],_0x4094bf=[];const _0x5d105e=0x2;let _0x2e9777=0x0;_0x1ef5b9[_0x4784e7(0x12f)]((_0x1791fc,_0x10c404)=>{const _0x266c9b=_0x4784e7;if(_0x10c404%_0x5d105e==0x0)_0x4094bf=[];_0x4094bf[_0x266c9b(0x1e6)](Markup['button']['callback'](botRef(_0x1791fc[_0x266c9b(0x2f7)])+'\x20('+_0x1791fc[_0x266c9b(0x12a)]+')',_0x266c9b(0xff)+_0x1791fc[_0x266c9b(0x2f7)])),_0x10c404%_0x5d105e==0x0&&(_0x10022e[_0x2e9777]=_0x4094bf,_0x2e9777++);});const _0x4a2f11=Markup[_0x4784e7(0x2f4)](_0x10022e);_0x3b7bf0[_0x4784e7(0x2c9)](_0x4784e7(0x174),_0x4a2f11);}}),tgBot['action'](/toggle_(.+)/,async _0x3ed234=>{const _0x4f4db8=_0x209cff,_0x4c601a=_0x3ed234['match'][0x1];_0x3ed234[_0x4f4db8(0x16a)]();const _0x1e429f=getBotsWithMode(),_0x2704de=_0x1e429f['find'](_0x34de12=>_0x34de12[_0x4f4db8(0x2f7)]==_0x4c601a),_0xd0a3c3=_0x2704de[_0x4f4db8(0x12a)]==_0x4f4db8(0x2c4)?_0x4f4db8(0x161):_0x4f4db8(0x2c4);await sendTelegram(_0x3ed234[_0x4f4db8(0x185)]['id'],_0x4f4db8(0x1d5)+botRef(_0x2704de[_0x4f4db8(0x2f7)])+_0x4f4db8(0x214)+_0xd0a3c3+_0x4f4db8(0x182)),toggleBotMode(_0x4c601a);}),tgBot[_0x209cff(0x163)](_0x209cff(0x260),async _0x290f16=>{const _0x333a65=_0x209cff;let _0x4a2a67='';config[_0x333a65(0x12f)](_0x39a7c3=>{const _0x3c5638=_0x333a65;_0x4a2a67+='Bot\x20'+_0x39a7c3[_0x3c5638(0x2f7)]+':\x20'+_0x39a7c3[_0x3c5638(0x2b0)]+'\x0a';}),await sendTelegram(_0x290f16[_0x333a65(0x185)]['id'],_0x4a2a67,{'parse_mode':_0x333a65(0x2ff)});}),tgBot[_0x209cff(0x163)](_0x209cff(0x238),async _0xa412af=>{await sendTelegram(_0xa412af['chat']['id'],_0x7a7fe2);}),process[_0x209cff(0x164)](_0x209cff(0xfe),()=>tgBot[_0x209cff(0x265)](_0x209cff(0xfe))),process[_0x209cff(0x164)]('SIGTERM',()=>tgBot[_0x209cff(0x265)](_0x209cff(0x2b8))),tgBot[_0x209cff(0x298)]();}function disableTelegram(){const _0x3a6b29=_0x148ee4;tgBot&&tgBot[_0x3a6b29(0x265)]();}async function sendTelegram(_0x45115c,_0x3366be,_0x368312){const _0x30a4e0=_0x148ee4;_0x368312={..._0x368312,'disable_web_page_preview':!![]};try{await tgBot[_0x30a4e0(0x191)]['sendMessage'](_0x45115c,_0x3366be,_0x368312);}catch(_0x718403){logger[_0x30a4e0(0x204)](_0x30a4e0(0x20c),_0x718403);}}async function sendTelegramBot(_0x4c08bd,_0x2094c6){const _0x47cb02=_0x148ee4;if(settings['telegramEnabled']){if(settings['telegramEvents']=='all'||(_0x2094c6['type']=='error'||_0x2094c6[_0x47cb02(0x118)]==_0x47cb02(0x162)||_0x2094c6[_0x47cb02(0x118)]==_0x47cb02(0x1ec))&&settings[_0x47cb02(0x113)]==_0x47cb02(0x17e)||_0x2094c6[_0x47cb02(0x118)]==_0x47cb02(0x297)&&settings['telegramEvents']==_0x47cb02(0x30d)){if(tgBot&&settings[_0x47cb02(0x294)]){if(_0x2094c6[_0x47cb02(0x105)])await sendTelegram(settings[_0x47cb02(0x294)],_0x2094c6['botname']+_0x47cb02(0x247)+_0x2094c6['event']);else await sendTelegram(settings['telegramChatId'],_0x47cb02(0x279)+_0x4c08bd+_0x47cb02(0x247)+_0x2094c6[_0x47cb02(0x175)]);}}}}async function sendTelegramMsg(_0x2967b6,_0xc815e1=_0x148ee4(0x2ff)){const _0x4e1778=_0x148ee4;return tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x4e1778(0x294)],_0x2967b6,{'parse_mode':_0xc815e1}),!![]):![];}function getDeviceWithIp(_0x399736){const _0x358780=_0x148ee4;return devices[_0x358780(0x23f)](_0x56ab01=>_0x56ab01['ip']===_0x399736);}async function temporaryAccess2FA(_0x5d70bd,_0x24ffaa){const _0x18bc80=_0x148ee4;let _0x293695=new Date(),_0x1ff43a=![];if(lastIpApproval){if(_0x293695-lastIpApproval<0x1388)_0x1ff43a=!![];}lastIpApproval=new Date();if(_0x1ff43a)return;if(tgBot&&settings[_0x18bc80(0x294)]){const _0x5ce627=uuidRandom();tmpStorage[_0x5ce627]={'uuid':_0x5d70bd,'externalip':_0x24ffaa};const _0x534c0f=Markup[_0x18bc80(0x2f4)]([Markup['button'][_0x18bc80(0x12b)](_0x18bc80(0x2fe),_0x18bc80(0x1e2)+_0x5ce627),Markup[_0x18bc80(0x1a2)][_0x18bc80(0x12b)](_0x18bc80(0x242),_0x18bc80(0x130)+_0x5ce627),Markup[_0x18bc80(0x1a2)]['callback'](_0x18bc80(0x18f),_0x18bc80(0x196)+_0x5ce627),Markup[_0x18bc80(0x1a2)]['callback'](_0x18bc80(0x158),_0x18bc80(0x134)+_0x5ce627)]);await sendTelegram(settings[_0x18bc80(0x294)],_0x18bc80(0x263)+normalizeIP(_0x24ffaa)['show']+'\x20?',_0x534c0f),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x488f9c=>{const _0x19cee1=_0x18bc80,_0xef3bfb=_0x488f9c[_0x19cee1(0x232)][0x1],_0x491562=_0x488f9c['match'][0x2],{uuid:_0x5de1b4,externalip:_0x16663b}=tmpStorage[_0x491562];delete tmpStorage[_0x491562],_0x488f9c[_0x19cee1(0x16a)](),devices[_0x5de1b4][_0x19cee1(0x20b)]={'clientip':_0x16663b,'timestamp':new Date()['getTime'](),'expiry':_0xef3bfb},_0xef3bfb!=_0x19cee1(0x158)?(await sendTelegram(_0x488f9c[_0x19cee1(0x185)]['id'],_0x19cee1(0x1db)+_0xef3bfb+_0x19cee1(0x1c1),{'parse_mode':_0x19cee1(0x2ff)}),io['to'](_0x5de1b4)['emit'](_0x19cee1(0x145),{'access':{'allow':![],'reason':_0x19cee1(0x108),'token':null}})):(await sendTelegram(_0x488f9c[_0x19cee1(0x185)]['id'],_0x19cee1(0x226)),io['to'](_0x5de1b4)['emit'](_0x19cee1(0x145),{'access':{'allow':![],'reason':_0x19cee1(0x206),'token':null}}));});}}async function loginAccess2FA(_0x1358fa,_0x3859e1){const _0x458f35=_0x148ee4;if(tgBot&&settings[_0x458f35(0x294)]){const _0x768967=uuidRandom();tmpStorage[_0x768967]={'uuid':_0x1358fa,'externalip':_0x3859e1};const _0x59fdc7=Markup[_0x458f35(0x2f4)]([Markup[_0x458f35(0x1a2)]['callback']('accept',_0x458f35(0x1d9)+loginExpiry+'_'+_0x768967),Markup[_0x458f35(0x1a2)]['callback']('reject',_0x458f35(0x2ec)+_0x768967)]);await sendTelegram(settings[_0x458f35(0x294)],_0x458f35(0x2cb)+normalizeIP(_0x3859e1)[_0x458f35(0x121)]+'\x20?',_0x59fdc7),tgBot[_0x458f35(0x257)](/login2fa_(.+)_(.+)/,async _0x26f957=>{const _0x52c6e3=_0x458f35,_0x439cad=_0x26f957[_0x52c6e3(0x232)][0x1],_0x10544e=_0x26f957[_0x52c6e3(0x232)][0x2],{uuid:_0x4b6008,externalip:_0x347cd2}=tmpStorage[_0x10544e];delete tmpStorage[_0x10544e],_0x26f957[_0x52c6e3(0x16a)](),devices[_0x4b6008][_0x52c6e3(0x1c4)]={'clientip':_0x347cd2,'timestamp':new Date()[_0x52c6e3(0x26d)](),'expiry':_0x439cad},_0x439cad!=_0x52c6e3(0x158)?(await sendTelegram(_0x26f957[_0x52c6e3(0x185)]['id'],_0x52c6e3(0x2e3),{'parse_mode':_0x52c6e3(0x2ff)}),io['to'](_0x4b6008)['emit'](_0x52c6e3(0x145),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x26f957[_0x52c6e3(0x185)]['id'],'Login\x20rejected'),io['to'](_0x4b6008)[_0x52c6e3(0x2a6)](_0x52c6e3(0x145),{'access':{'allow':![],'reason':_0x52c6e3(0x2de),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xf74e64=_0x148ee4;return dbConfig[_0xf74e64(0x165)](_0xf74e64(0x26f))[_0xf74e64(0x148)](_0xf74e64(0x2f7))['filter']({'status':_0xf74e64(0x1ca)})[_0xf74e64(0x2af)]()||[];}function getDisabledBots(){const _0x219d24=_0x148ee4;return dbConfig[_0x219d24(0x165)](_0x219d24(0x26f))[_0x219d24(0x148)]('botID')['filter']({'status':_0x219d24(0x1e7)})[_0x219d24(0x2af)]()||[];}function getBotAttributes(_0x414347){const _0x4064cb=_0x148ee4;let _0x5a2208={};const _0x44d6dc=configpath+_0x4064cb(0x2f2)+_0x414347+_0x4064cb(0x1f9),_0x3b6483=fs['existsSync'](_0x44d6dc);if(_0x3b6483){const _0x369b90=fs[_0x4064cb(0x100)](_0x44d6dc);try{const _0x1be043=JSON[_0x4064cb(0x128)](_0x369b90),_0x793d37=_0x1be043?_0x1be043[_0x4064cb(0x267)][0x0][_0x4064cb(0x30b)]:![];_0x5a2208[_0x4064cb(0x12a)]=_0x793d37?'auto':_0x4064cb(0x161),_0x5a2208[_0x4064cb(0x2b0)]=_0x1be043?_0x1be043[_0x4064cb(0x267)][0x0][_0x4064cb(0x2b0)]:_0x4064cb(0x279)+_0x414347,_0x5a2208[_0x4064cb(0x105)]=_0x1be043?_0x1be043['bot'][0x0][_0x4064cb(0x105)]:![];}catch(_0x555910){_0x5a2208['mode']=_0x4064cb(0x161),_0x5a2208[_0x4064cb(0x2b0)]='Bot\x20'+_0x414347,_0x5a2208[_0x4064cb(0x105)]=![];}}else _0x5a2208[_0x4064cb(0x12a)]=_0x4064cb(0x161),_0x5a2208[_0x4064cb(0x2b0)]=_0x4064cb(0x279)+_0x414347,_0x5a2208['showname']=![];return _0x5a2208;}function getBotsWithMode(){const _0xc9f06f=_0x148ee4,_0x2edebb=dbConfig[_0xc9f06f(0x165)](_0xc9f06f(0x26f))[_0xc9f06f(0x148)](_0xc9f06f(0x2f7))[_0xc9f06f(0x2af)]()||[];return _0x2edebb[_0xc9f06f(0x12f)](_0x3625ab=>{const _0x564c69=_0xc9f06f;let _0x119b85=getBotAttributes(_0x3625ab['botID']);_0x3625ab['mode']=_0x119b85[_0x564c69(0x12a)];}),_0x2edebb;}function getBotExchanges(){const _0x380102=_0x148ee4;let _0x38df24=[];const _0x2d1d8b=dbConfig[_0x380102(0x165)](_0x380102(0x26f))[_0x380102(0x148)]('botID')[_0x380102(0x2af)]()||[];_0x2d1d8b[_0x380102(0x12f)](_0x5416da=>{const _0x227a05=_0x380102;if(_0x5416da[_0x227a05(0x145)]==_0x227a05(0x1ca)){const _0x4454f9=configpath+_0x227a05(0x2f2)+_0x5416da[_0x227a05(0x2f7)]+_0x227a05(0x1f9),_0x37293c=fs['existsSync'](_0x4454f9);let _0x337918;if(_0x37293c){const _0x2c8341=fs['readFileSync'](_0x4454f9);try{const _0x1ee186=JSON['parse'](_0x2c8341);_0x337918=_0x1ee186?_0x1ee186['bot'][0x0][_0x227a05(0x2ab)]:null;}catch(_0x90bda5){}}if(_0x337918)_0x38df24['push'](_0x337918);}});const _0x13af8b=[...new Set(_0x38df24)][_0x380102(0x21e)]();return _0x13af8b;}async function initUser(){const _0x5ab9b4=_0x148ee4;if(!settings[_0x5ab9b4(0x1ab)]){const _0x4c1bed=uuidRandom();mixpanel[_0x5ab9b4(0x1d4)](_0x4c1bed),updateSetting(_0x5ab9b4(0x1ab),_0x4c1bed);}}async function initSecure(){const _0x5a6f83=_0x148ee4;let _0x1b53de=getSecure();if(!_0x1b53de[_0x5a6f83(0x208)]('secret')){let _0x949e1e=await generateKeys();_0x1b53de[_0x5a6f83(0x16d)]=_0x949e1e[_0x5a6f83(0x16d)],_0x1b53de['privateKey']=_0x949e1e[_0x5a6f83(0x125)],_0x1b53de[_0x5a6f83(0x117)]=crypto[_0x5a6f83(0x2fb)](0x20)[_0x5a6f83(0x27d)](_0x5a6f83(0x193));;storeSecure(_0x1b53de);}}function getSettings(){const _0x11f273=_0x148ee4;return dbSettings[_0x11f273(0x165)]('settings')[_0x11f273(0x2af)]()||{};}function getSecure(){const _0x1dcf47=_0x148ee4;return dbSecure['get']('secure')[_0x1dcf47(0x2af)]()||{};}function getBlacklist(){const _0x4b84af=_0x148ee4;return dbSecure['get']('blacklist')[_0x4b84af(0x2af)]()||[];}function broadcastToBots(_0x578914,_0x2f9e2a){const _0x4f18c6=_0x148ee4;config[_0x4f18c6(0x12f)](_0x46c639=>{const _0x24282d=_0x4f18c6;if(_0x46c639['status']==_0x24282d(0x1ca)&&_0x46c639[_0x24282d(0x289)]=='running'||_0x46c639[_0x24282d(0x145)]=='new'&&_0x46c639['live']==_0x24282d(0x197)){if(pid[_0x46c639[_0x24282d(0x2f7)]])pid[_0x46c639[_0x24282d(0x2f7)]]['send']({[_0x578914]:_0x2f9e2a});}});}function _0x1bcd(){const _0x2a947d=['versions','/enable\x20-\x20enable\x20notifications\x0a','All\x20bots','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','\x20-\x20','Markdown','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','isIPv4MappedAddress','writeFileSync','action','storeFiat','socket','get-starting-balances','started','exp','\x1b[0m','express-fileupload','bbPassword','names','close','remoteAddress','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','1795408aNKbAp','stop','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','bot','rsa','Restore\x20process\x20aborted','split','uncaughtException','format','getTime','config_alerts','bots','uuid-random','axios','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','all','sendPortfolioTelegram','getMonth','pidRefreshToken','(((.+)+)+)+$','add-bot','Bot\x20','store','isValid','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','toString','clients','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','binary','getHours','confirm-message','Failed\x20to\x20download\x20','cloneDeep','Bot\x20Mgr\x20>\x20Starting\x20','lastmsgemitted','/restart\x20-\x20restart\x20bot(s)\x0a','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','live','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','f2aRequired','constructor','849750FgXXAF','logout','Setting\x20access:\x20','Error\x20details:','/:bot/configuration','logged\x20out','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','telegramChatId','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','onepagemode','order','launch','Token\x20blacklisted','whitelist','store-fiat','log','Notifications\x20types:\x20','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','668949WZflDP','2FA\x20required','cancel-loading','/start','Logged\x20in\x20user\x20...','-performance.json','getPortfolio','emit','login\x20required','Disabled\x20','cancelLoading','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','exchange','index.html','startsWith','***','value','botname','handshake','Ok,\x20will\x20send\x20order\x20notifications\x20only','backup-full','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','updatebotmanager','mtime','(staging)','SIGTERM','.zip','compareSync','lastmsgtelegram','listen','temp/','async','Unauthorized\x20attempt\x20to\x20delete\x20alerts','slice','/:bot/history','-events.json','Starting\x20new\x20bot\x20|\x20Bot\x20','auto','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','backup','express','store-settings','reply','function','Allow\x20login\x20from\x20IP\x20address\x20','padStart','/update\x20-\x20update\x20Balance\x20Bot\x0a','enable','Logged\x20out\x20user\x20...','logs','login','logs/','ipaddr.js','disconnect','host','rmSync','/:bot','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','|@|','file','2FA\x20login\x20token\x20generated','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','bbvNew','2FA\x20login\x20rejected','Unauthorized\x20attempt\x20to\x20confirm\x20message','=>\x20Go\x20to\x20#CYA#http://','encryptedUuid','<b>Telegram\x20Bot\x20Status:</b>\x0a','Login\x20accepted','name','error','/backup\x20-\x20receive\x20backup\x20files\x0a','disable','place-order','104872lgepxy','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','copyFileSync','login2fa_reject_','createServer','set','Unauthorized\x20attempt\x20to\x20update\x20settings','Error\x20sending\x20',')\x20|\x20Bot\x20','bot-','track','inlineKeyboard','getSeconds','Unauthorized\x20attempt\x20to\x20log\x20out','botID','deleteHistoryAlerts','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','/download/:type','randomBytes','environment','restore_yes_','5\x20min','HTML','notification','fork','10DneUHL','private','sign','open','telegramUsername','\x20|\x20','portfolio','*$1*','\x20only\x0a','headless','loadAsync','orders','/status\x20-\x20show\x20bot(s)\x20status\x0a','************','delete-bot','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',':\x20Bot\x20Mgr\x20>\x20','text','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','SIGINT','toggle_','readFileSync','\x1b[33m','Invalid\x20authentication\x20token\x20(2)','Invalid\x20IP\x20address','Backup\x20file\x20uploaded','showname','Notifications\x20disabled','write','reload','decrypt','pidExpireLogin','api-eu.mixpanel.com','get-messages','Enabled\x20','initclient','statSync','tkn','resetpw_no',',\x20must\x20be\x20a\x204\x20digit\x20number','telegramEvents','generateKeyPair','sockets','Session\x20expired\x20for\x20user\x20...','secret','type','post','#RES#\x20','Starting\x20Balance\x20Bot\x20update','Unauthorized\x20attempt\x20to\x20get\x20events','bcryptjs','-results.json','crypto','store-configuration','show','add','resetpw_yes','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','privateKey','readdirSync','stopped','parse','params','mode','callback','\x20(2)','min','restart','forEach','tempaccess_15_','user','entries','includes','tempaccess_reject_','telegramToken','bbUsername','::1','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','keys','marketcapApi','290uHbdvK','restore_no_','full','telegrammsg',')\x20\x20\x20|\x20Bot\x20','max','apiPassword','_nsps','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','/help\x20-\x20show\x20available\x20commands\x0a','status','delete-alerts','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','sortBy','login\x20not\x20required','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','bb/','http','replyWithDocument','Your\x20installation\x20is\x20already\x20up\x20to\x20date','family','\x1b[31m','status\x20code\x20401','hashSync','isDirectory','http://localhost:','output-000.log','join','Telegraf\x20error:','reject','reinstall_no','build2','new-disabled','lowdb','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','https://api.ipify.org?format=json','replace','use','manual','warning','command','once','get','then','update','yes','7SlukNj','editMessageReplyMarkup','/on\x20-\x20start\x20bot(s)\x0a','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','publicKey','Yes','staging','output-002.log','bbvReceive','version.json','util','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','event','reinstall','Alerts','Unauthorized\x20attempt\x20to\x20show\x20configuration','16587xoXCgT','uuid','apiSecret','pki','connected','alerts','endsWith','latestversion','env','\x20mode','/disable\x20-\x20disable\x20notifications\x0a','mixpanel','chat','No\x20bots\x20running\x20right\x20now','socket.io','stringify','randomFillSync','request','File\x20uploaded','build','Unauthorized\x20attempt\x20to\x20download\x20','botmanager','30\x20min','\x20files\x20over\x20Telegram:','telegram','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','hex','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','get-logs','tempaccess_30_','running','timeshift','graphql-request','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','settings','port','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Error\x20removing\x20old\x20backup\x20files:','getUTCHours','range','temporary\x20access\x20timeout','button','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','expiry','\x1b[36m','User\x20has\x20been\x20validated','reinstall-bb','--------------------------------------','show-config','userid','exec','address','catch','emitHistory','/:bot/performance','createWriteStream','output-001.log','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','telegramEnabled','Unauthorized\x20attempt\x20to\x20store\x20configuration','Invalid\x20username\x20or\x20IP\x20address','#RES#\x20if\x20running\x20locally\x0a','config/','unlinkSync','login\x20token\x20valid','access','assign','Notifications\x20enabled\x0a','defaults','bb-secure.json','yargs','\x20minutes','data','blacklist','telegram2FaApproval','3000','Deleted\x20Bot\x20','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','privateKeyToPem','toggle','enabled','getDate','Unauthorized\x20attempt\x20to\x20get\x20portfolio','jsonwebtoken','storeConfiguration','headers','Starting\x20Balance\x20Bot\x20reinstallation','loginRequired','inherit','off','alias','Bot\x20Mgr\x20>\x20Toggling\x20','simple','\x20(1)','Restarting\x20','login2fa_','resetHistory','Access\x20enabled\x20for\x20','\x20|\x20user:\x20...','files','\x1b[34m','timestamp','sendFile','args','tempaccess_5_','conn','6b67f3d61ee94b8f5c80b4affef4c4d9','Network\x20Interfaces:','push','disabled','update_no','message','new','node-forge','success','Bot\x20Mgr\x20>\x20','Starting\x20(','Password\x20has\x20been\x20reset\x20to:\x20','exit','kill','Error:\x20Invalid\x20argument\x20','2FA\x20login\x20required','NTBA_FIX_319','update-bot','clientip','Orders','remove','-config.json','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Bot\x20Mgr\x20>\x20Stopping\x20','backup-full@','getFullYear','internal','child_process','from','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','any','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','debug','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','hasOwnProperty','code','$1_$2_$3','telegramIpApproval','Telegram\x20error:','length','token','-----------------------------------------------------------------------------------','number','bb-settings.json','version','publicKeyToPem','\x20to\x20','generateAsync','server','reset-history','portfolio_','output-003.log','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','get-backup-files','address\x20already\x20in\x20use','string','sort','ipc','connection','Notifications\x20disabled\x0a','Unauthorized\x20attempt\x20to\x20add\x20bot','272106FyuQbQ','Unauthorized\x20attempt\x20to\x20get\x20messages','/names\x20-\x20show\x20bot\x20names\x0a','Temporary\x20access\x20rejected','backupfile','username','reason','toggleBotMode','getMinutes','Unauthorized\x20attempt\x20to\x20update\x20bot','127.0.0.1','create','allow','sha256','/off\x20-\x20stop\x20bot(s)\x0a','match','production','lowdb/adapters/FileSync','storeHeadless','config_all','removeAllListeners','help','reinstall_yes','kind','mkdirSync','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','messages','login\x20token\x20generated','find','0.0.0','temporary\x20token\x20generated','15\x20min','231821EgAWAe','<b>Balance\x20Bot\x20Status:</b>\x0a','config','static','\x20>\x20','[ip-address]','restore-backup-file','send','invalid\x20credentials','existsSync'];_0x1bcd=function(){return _0x2a947d;};return _0x1bcd();}async function storeSettings(_0x48e865,_0x649e96=![]){const _0x176b9b=_0x148ee4;_0x48e865={...settings,..._0x48e865};if(_0x649e96&&_0x48e865[_0x176b9b(0x25f)]!=_0x176b9b(0x30f)&&_0x48e865['bbPassword']!=_0x176b9b(0x2ae)&&_0x48e865['bbPassword']!=''){const _0x49e01f=decryptRSA(secure[_0x176b9b(0x125)],_0x48e865[_0x176b9b(0x25f)])[_0x176b9b(0x26a)](_0x176b9b(0x2d9))[0x0],_0x5d0189=bcrypt['hashSync'](_0x49e01f,saltRounds);_0x48e865={..._0x48e865,'bbPassword':_0x5d0189};}if(_0x649e96&&_0x48e865[_0x176b9b(0x135)]!=_0x176b9b(0x30f)&&_0x48e865['telegramToken']!=_0x176b9b(0x2ae)&&_0x48e865[_0x176b9b(0x135)]!=''){const _0x5e8ed0=decryptRSA(secure['privateKey'],_0x48e865[_0x176b9b(0x135)])['split'](_0x176b9b(0x2d9))[0x0];_0x48e865={..._0x48e865,'telegramToken':_0x5e8ed0};}if(_0x649e96&&_0x48e865[_0x176b9b(0x13a)]!=_0x176b9b(0x30f)&&_0x48e865['marketcapApi']!=_0x176b9b(0x2ae)&&_0x48e865[_0x176b9b(0x13a)]!=''){const _0x4add9e=decryptRSA(secure[_0x176b9b(0x125)],_0x48e865['marketcapApi'])[_0x176b9b(0x26a)](_0x176b9b(0x2d9))[0x0];_0x48e865={..._0x48e865,'marketcapApi':_0x4add9e};}const _0x32c64d=_0x48e865['telegramToken']!=_0x176b9b(0x30f)&&_0x48e865[_0x176b9b(0x135)]!=settings['telegramToken']||_0x48e865[_0x176b9b(0x306)]!=settings[_0x176b9b(0x306)],_0x283d42=_0x48e865[_0x176b9b(0x135)]==''||_0x48e865['telegramUsername']=='',_0x51a27c=_0x48e865[_0x176b9b(0x13a)]&&_0x48e865[_0x176b9b(0x13a)]!=_0x176b9b(0x30f)&&_0x48e865[_0x176b9b(0x13a)]!=settings[_0x176b9b(0x13a)];_0x32c64d&&(_0x48e865[_0x176b9b(0x294)]=null,_0x48e865[_0x176b9b(0x113)]=_0x176b9b(0x273));for(const [_0x52ff65,_0x453cf7]of Object[_0x176b9b(0x132)](_0x48e865)){if(_0x52ff65==_0x176b9b(0x135)&&_0x453cf7==_0x176b9b(0x30f)){_0x48e865[_0x176b9b(0x135)]=settings[_0x176b9b(0x135)];continue;};if(_0x52ff65=='bbPassword'&&_0x453cf7==_0x176b9b(0x30f)){_0x48e865[_0x176b9b(0x25f)]=settings[_0x176b9b(0x25f)];continue;};if(_0x52ff65==_0x176b9b(0x13a)&&_0x453cf7==_0x176b9b(0x30f)){_0x48e865[_0x176b9b(0x13a)]=settings['marketcapApi'];continue;};dbSettings[_0x176b9b(0x2ee)]('settings.'+_0x52ff65,_0x453cf7)[_0x176b9b(0x107)]();}settings=_0x48e865,io['to'](_0x176b9b(0x18e))[_0x176b9b(0x2a6)](_0x176b9b(0x19b),cleanSettings()),broadcastToBots(_0x176b9b(0x198),settings[_0x176b9b(0x198)]),broadcastToBots(_0x176b9b(0x296),settings[_0x176b9b(0x296)]),broadcastToBots(_0x176b9b(0x13a),settings[_0x176b9b(0x13a)]);if(_0x32c64d&&!_0x283d42)initTelegram();_0x32c64d&&_0x283d42&&(updateSetting(_0x176b9b(0x294),null),disableTelegram()),getAllClients()[_0x176b9b(0x12f)](_0x1a9527=>{const _0x54699f=_0x176b9b;getSocket(_0x1a9527['id'])[_0x54699f(0x2a6)](_0x54699f(0x145),{'access':{'allow':![],'reason':_0x54699f(0x108),'token':null}});}),_0x51a27c&&(await sleep(0xbb8),testMarketcapApi(_0x48e865[_0x176b9b(0x13a)]));}async function testMarketcapApi(_0x557df8){const _0x5b55bb=_0x148ee4,_0x55a528=['BCT','ETH'];try{await axios[_0x5b55bb(0x165)](_0x5b55bb(0x29e),{'headers':{'X-CMC_PRO_API_KEY':_0x557df8},'params':{'symbol':_0x55a528[_0x5b55bb(0x27d)]()}});}catch(_0x5af7fc){_0x5af7fc[_0x5b55bb(0x27d)]()['includes'](_0x5b55bb(0x151))?(io['to'](_0x5b55bb(0x18e))[_0x5b55bb(0x2a6)](_0x5b55bb(0x300),_0x5b55bb(0x2ea)),logger['full']('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x5b55bb(0x18e))[_0x5b55bb(0x2a6)](_0x5b55bb(0x300),_0x5b55bb(0x2aa)),logger['full']('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger['debug'](_0x5b55bb(0x290),_0x5af7fc['toString']()+_0x5b55bb(0x252)+_0x5af7fc[_0x5b55bb(0x209)]));return;}logger['debug']('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x22d264,_0x4bc94d){const _0x6ee695=_0x148ee4;dbSettings[_0x6ee695(0x2ee)]('settings.'+_0x22d264,_0x4bc94d)[_0x6ee695(0x107)](),settings=getSettings(),io['to'](_0x6ee695(0x18e))['emit']('settings',cleanSettings());}function storeSecure(_0x329b0c){const _0x437323=_0x148ee4;dbSecure[_0x437323(0x165)]('secure')['push'](_0x329b0c)['write'](),secure=_0x329b0c;}function addBlacklist(_0x1be735){const _0x391bbe=_0x148ee4;cleanBlacklist();let _0x241b74;devices[_0x1be735][_0x391bbe(0x20b)]?_0x241b74=Math[_0x391bbe(0x140)](devices[_0x1be735][_0x391bbe(0x20b)]['expiry'],loginExpiry):_0x241b74=loginExpiry,dbSecure[_0x391bbe(0x165)](_0x391bbe(0x1c3))['push']({'expiry':new Date()['getTime']()+_0x241b74*0x3c*0x3e8,'token':devices[_0x1be735][_0x391bbe(0x1bb)][_0x391bbe(0x20e)]})[_0x391bbe(0x107)](),blacklist=dbSecure[_0x391bbe(0x165)]('blacklist')[_0x391bbe(0x2af)]();}function cleanBlacklist(){const _0x241661=_0x148ee4;let _0x111536=dbSecure[_0x241661(0x165)](_0x241661(0x1c3))[_0x241661(0x284)]()[_0x241661(0x2af)](),_0x507dc5=new Date()[_0x241661(0x26d)]();_0x111536[_0x241661(0x12f)](_0x3293a1=>{const _0x5b347a=_0x241661;_0x3293a1[_0x5b347a(0x1a5)]<_0x507dc5&&dbSecure[_0x5b347a(0x165)](_0x5b347a(0x1c3))['remove']({'expiry':_0x3293a1[_0x5b347a(0x1a5)]})[_0x5b347a(0x107)]();});}function initStates(){const _0x5ca29d=_0x148ee4;let _0x4fe44c=getConfiguration();_0x4fe44c[_0x5ca29d(0x12f)](_0x6f9ff9=>{const _0x4f93e1=_0x5ca29d;_0x6f9ff9[_0x4f93e1(0x289)]=_0x4f93e1(0x127);}),storeConfiguration(_0x4fe44c);}async function generateKeys(){const _0x348e5f=_0x148ee4,_0x3eb529=forge['pki'][_0x348e5f(0x268)][_0x348e5f(0x114)]({'bits':0x1000,'e':0x10001}),_0x1609bb=forge[_0x348e5f(0x17c)][_0x348e5f(0x1c8)](_0x3eb529[_0x348e5f(0x125)]),_0x419672=forge[_0x348e5f(0x17c)][_0x348e5f(0x213)](_0x3eb529[_0x348e5f(0x16d)]);return{'privateKey':_0x1609bb,'publicKey':_0x419672};}async function oneTimeMigration(){const _0x571fba=_0x148ee4;let _0x1e2305=getSettings(),_0x4328d2=![];!_0x1e2305[_0x571fba(0x208)](_0x571fba(0x2bb))&&(_0x1e2305['lastmsgtelegram']=0x0,_0x4328d2=!![]);!_0x1e2305[_0x571fba(0x208)]('lastmsgemitted')&&(_0x1e2305[_0x571fba(0x286)]=0x0,_0x4328d2=!![]);!_0x1e2305['hasOwnProperty']('latestversion')&&(_0x1e2305[_0x571fba(0x180)]=_0x571fba(0x240),_0x4328d2=!![]);!_0x1e2305['hasOwnProperty'](_0x571fba(0x296))&&(_0x1e2305[_0x571fba(0x296)]=![],_0x4328d2=!![]);!_0x1e2305['hasOwnProperty'](_0x571fba(0x13a))&&(_0x1e2305[_0x571fba(0x13a)]='',_0x4328d2=!![]);if(_0x4328d2)storeSettings(_0x1e2305);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x23e79f=>{const _0x13ec38=_0x571fba;if(!_0x23e79f[_0x13ec38(0x153)]()){if(!_0x23e79f[_0x13ec38(0x2e4)]['startsWith']('backup-full@'))fs[_0x13ec38(0x1b9)](configbackuppath+_0x23e79f['name']);}else fs['rmSync'](configbackuppath+_0x23e79f[_0x13ec38(0x2e4)],{'recursive':!![]});});}catch(_0x4c9282){logger[_0x571fba(0x204)](_0x571fba(0x19e),_0x4c9282);}}function storeConfiguration(_0x4ad64d){const _0x289783=_0x148ee4;dbConfig['get']('bots')[_0x289783(0x1f8)]()[_0x289783(0x107)](),dbConfig[_0x289783(0x165)](_0x289783(0x26f))['push'](..._0x4ad64d)[_0x289783(0x107)](),config=_0x4ad64d;}async function resetPassword(){const _0x2a47dc=_0x148ee4;if(tgBot&&settings[_0x2a47dc(0x294)]){const _0x428874=Markup[_0x2a47dc(0x2f4)]([Markup[_0x2a47dc(0x1a2)][_0x2a47dc(0x12b)]('yes',_0x2a47dc(0x123)),Markup[_0x2a47dc(0x1a2)][_0x2a47dc(0x12b)]('no',_0x2a47dc(0x111))]);await sendTelegram(settings[_0x2a47dc(0x294)],_0x2a47dc(0x16c),_0x428874),tgBot[_0x2a47dc(0x257)](/resetpw_(.+)/,async _0x262c8f=>{const _0xa85039=_0x2a47dc,_0x2a077d=_0x262c8f['match'][0x1];_0x262c8f[_0xa85039(0x16a)]();if(_0x2a077d!='no'){const _0x136e28=0xf,_0x119b53=_0xa85039(0x1fa),_0x40285f=Array[_0xa85039(0x200)](crypto[_0xa85039(0x189)](new Uint32Array(_0x136e28)))['map'](_0x3a1968=>_0x119b53[_0x3a1968%_0x119b53[_0xa85039(0x20d)]])[_0xa85039(0x156)](''),_0x146074=bcrypt[_0xa85039(0x152)](_0x40285f,saltRounds);storeSettings({'bbPassword':_0x146074}),await sendTelegram(_0x262c8f[_0xa85039(0x185)]['id'],_0xa85039(0x1ef)+_0x40285f,{'parse_mode':_0xa85039(0x2ff)});}else await sendTelegram(_0x262c8f['chat']['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x1b7344,_0x4373db){const _0x30426c=_0x148ee4;io['to'](_0x30426c(0x18e))['emit'](_0x30426c(0x300),_0x30426c(0x19a),_0x30426c(0x1ec));if(tgBot&&settings['telegramChatId']){const _0x181230=uuidRandom();tmpStorage[_0x181230]={'path':_0x1b7344,'filename':_0x4373db};const _0xd9118f=Markup[_0x30426c(0x2f4)]([Markup['button']['callback'](_0x30426c(0x168),_0x30426c(0x2fd)+_0x181230),Markup[_0x30426c(0x1a2)]['callback']('no',_0x30426c(0x13c)+_0x181230)]);await sendTelegram(settings['telegramChatId'],_0x30426c(0x295),_0xd9118f),tgBot[_0x30426c(0x257)](/restore_(.+)_(.+)/,async _0x403b06=>{const _0x2d5f3b=_0x30426c,_0x209ebc=_0x403b06['match'][0x1],_0x39e746=_0x403b06['match'][0x2],{path:_0x8d9939,filename:_0x3d719d}=tmpStorage[_0x39e746];delete tmpStorage[_0x39e746],_0x403b06['editMessageReplyMarkup'](),_0x209ebc==_0x2d5f3b(0x168)?(logger[_0x2d5f3b(0x204)]('Restore\x20process\x20confirmed'),await sendTelegram(_0x403b06['chat']['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x2d5f3b(0x2ff)}),unzipFile(_0x8d9939,_0x3d719d)):(logger[_0x2d5f3b(0x204)](_0x2d5f3b(0x269)),await sendTelegram(_0x403b06[_0x2d5f3b(0x185)]['id'],_0x2d5f3b(0x269)));});}}function getServerTime(){const _0x5d7c22=_0x148ee4,_0x415337=new Date();return _0x415337[_0x5d7c22(0x1fd)]()+'/'+(_0x415337[_0x5d7c22(0x275)]()+0x1)[_0x5d7c22(0x27d)]()[_0x5d7c22(0x2cc)](0x2,'0')+'/'+_0x415337[_0x5d7c22(0x1cb)]()[_0x5d7c22(0x27d)]()[_0x5d7c22(0x2cc)](0x2,'0')+'\x20'+_0x415337[_0x5d7c22(0x281)]()['toString']()[_0x5d7c22(0x2cc)](0x2,'0')+':'+_0x415337['getMinutes']()[_0x5d7c22(0x27d)]()[_0x5d7c22(0x2cc)](0x2,'0')+':'+_0x415337[_0x5d7c22(0x2f5)]()[_0x5d7c22(0x27d)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x1b51e9=_0x148ee4,_0x5196dc=shiftedTime();return _0x5196dc['getFullYear']()+'/'+(_0x5196dc['getMonth']()+0x1)[_0x1b51e9(0x27d)]()['padStart'](0x2,'0')+'/'+_0x5196dc[_0x1b51e9(0x1cb)]()['toString']()[_0x1b51e9(0x2cc)](0x2,'0')+'\x20'+_0x5196dc[_0x1b51e9(0x281)]()[_0x1b51e9(0x27d)]()['padStart'](0x2,'0')+':'+_0x5196dc[_0x1b51e9(0x22b)]()[_0x1b51e9(0x27d)]()['padStart'](0x2,'0')+':'+_0x5196dc[_0x1b51e9(0x2f5)]()['toString']()[_0x1b51e9(0x2cc)](0x2,'0');}function getCleanTimeStamp(){const _0x55cf56=_0x148ee4,_0x32d3bb=shiftedTime();return _0x32d3bb[_0x55cf56(0x1fd)]()+(_0x32d3bb[_0x55cf56(0x275)]()+0x1)['toString']()[_0x55cf56(0x2cc)](0x2,'0')+_0x32d3bb[_0x55cf56(0x1cb)]()['toString']()[_0x55cf56(0x2cc)](0x2,'0')+'-'+_0x32d3bb[_0x55cf56(0x281)]()[_0x55cf56(0x27d)]()[_0x55cf56(0x2cc)](0x2,'0')+_0x32d3bb[_0x55cf56(0x22b)]()[_0x55cf56(0x27d)]()[_0x55cf56(0x2cc)](0x2,'0')+_0x32d3bb[_0x55cf56(0x2f5)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x15e044=_0x148ee4,_0x5ee2e7=new Date();let _0x5f0fc1=_0x5ee2e7;if(settings[_0x15e044(0x198)]&&settings[_0x15e044(0x198)]!==0x0)_0x5f0fc1=fns[_0x15e044(0x122)](_0x5ee2e7,{'hours':settings[_0x15e044(0x198)]});return _0x5f0fc1;}async function startScheduler(){const _0x504cd5=_0x148ee4,_0x1fa9e0=new Date()[_0x504cd5(0x19f)](),_0x131740=shiftedTime()[_0x504cd5(0x281)]();_0x131740==0x4&&backupConfigFiles(),_0x131740==0x0&&(rotateLogFiles(),logger[_0x504cd5(0x204)](_0x504cd5(0x1a9)),logger[_0x504cd5(0x204)]('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0x504cd5(0x16f)?_0x504cd5(0x2b7):'')),logger['debug'](_0x504cd5(0x1a9))),_0x1fa9e0%0x6==0x0&&triggerAnalytics(),_0x1fa9e0%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x403554){const _0x42c37f=_0x148ee4;logger[_0x42c37f(0x204)]('Restore\x20backup\x20file\x20'+_0x403554);const _0x559472=getBotsWithMode();_0x559472[_0x42c37f(0x20d)]>0x0?confirmRestore(configbackuppath,_0x403554):unzipFile(configbackuppath,_0x403554);}async function getBackupFiles(_0x7b981c=null){const _0x147008=_0x148ee4;let _0x1a78d7=[],_0x367cb0=fs[_0x147008(0x126)](configbackuppath,{'withFileTypes':!![]});_0x367cb0[_0x147008(0x21e)]((_0xe61d10,_0x5ee0b7)=>_0xe61d10[_0x147008(0x2e4)]<_0x5ee0b7[_0x147008(0x2e4)]?0x1:_0x5ee0b7[_0x147008(0x2e4)]<_0xe61d10['name']?-0x1:0x0),_0x367cb0[_0x147008(0x12f)](_0x575eb9=>{const _0x34ce37=_0x147008;if(!_0x575eb9[_0x34ce37(0x153)]()&&_0x575eb9[_0x34ce37(0x2e4)]['startsWith']('backup-full@')&&_0x575eb9[_0x34ce37(0x2e4)][_0x34ce37(0x17f)](_0x34ce37(0x2b9))){const _0x31323d=formatDate(fs[_0x34ce37(0x10f)](configbackuppath+_0x575eb9[_0x34ce37(0x2e4)])[_0x34ce37(0x2b6)]);_0x1a78d7['push']({'name':_0x575eb9[_0x34ce37(0x2e4)],'mtime':_0x31323d});}});if(_0x7b981c)io['to'](_0x7b981c)[_0x147008(0x2a6)]('backup-files',_0x1a78d7);else return _0x1a78d7;}async function backupConfigFiles(){const _0x9cbc2e=_0x148ee4;await zipFiles(_0x9cbc2e(0x2b3));const _0x11b061=getCleanTimeStamp();fs[_0x9cbc2e(0x2eb)](zippath+'backup-full.zip',configbackuppath+(_0x9cbc2e(0x1fc)+_0x11b061+_0x9cbc2e(0x2b9)));let _0x1ea634=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x1ea634[_0x9cbc2e(0x21e)]((_0x20387a,_0x3bbf0a)=>_0x20387a['name']<_0x3bbf0a['name']?0x1:_0x3bbf0a['name']<_0x20387a['name']?-0x1:0x0),_0x1ea634[_0x9cbc2e(0x20d)]>maxBackups&&fs[_0x9cbc2e(0x1b9)](configbackuppath+_0x1ea634[_0x1ea634[_0x9cbc2e(0x20d)]-0x1][_0x9cbc2e(0x2e4)]);}function rotateLogFiles(){const _0x3ab36d=_0x148ee4,_0x372620=fs[_0x3ab36d(0x10f)](logspath+_0x3ab36d(0x155)),_0x2596d3=_0x372620['size']/0x400;if(_0x2596d3>0x64){let _0x1c2340=fs[_0x3ab36d(0x126)](logspath,{'withFileTypes':!![]});_0x1c2340['sort']((_0x45b5f6,_0x2ae194)=>_0x45b5f6['name']<_0x2ae194['name']?0x1:_0x2ae194[_0x3ab36d(0x2e4)]<_0x45b5f6[_0x3ab36d(0x2e4)]?-0x1:0x0),_0x1c2340[_0x3ab36d(0x12f)](_0x4355fd=>{const _0x252066=_0x3ab36d;if(_0x4355fd[_0x252066(0x2e4)]==_0x252066(0x170))fs[_0x252066(0x2eb)](logspath+_0x4355fd[_0x252066(0x2e4)],logspath+_0x252066(0x219));if(_0x4355fd[_0x252066(0x2e4)]==_0x252066(0x1b2))fs[_0x252066(0x2eb)](logspath+_0x4355fd[_0x252066(0x2e4)],logspath+_0x252066(0x170));_0x4355fd[_0x252066(0x2e4)]==_0x252066(0x155)&&(fs['copyFileSync'](logspath+_0x4355fd[_0x252066(0x2e4)],logspath+_0x252066(0x1b2)),fs[_0x252066(0x256)](logspath+_0x4355fd[_0x252066(0x2e4)],''));});}}async function zipFiles(_0x24df45){const _0x2cb49e=_0x148ee4;let _0x14ee7c;if(_0x24df45==_0x2cb49e(0x2d0))_0x14ee7c=logspath;if(_0x24df45==_0x2cb49e(0x2c6))_0x14ee7c=configpath;if(_0x24df45==_0x2cb49e(0x2b3))_0x14ee7c=configpath;let _0x15a83a=fs[_0x2cb49e(0x126)](_0x14ee7c,{'withFileTypes':!![]});const _0x5e99e0=new JSZip();_0x15a83a[_0x2cb49e(0x12f)](_0x554c71=>{const _0x13215b=_0x2cb49e;if(!_0x554c71[_0x13215b(0x153)]()){let _0x4879e4=fs['readFileSync'](_0x14ee7c+_0x554c71['name']);if(_0x24df45==_0x13215b(0x2c6)){const _0x24ab14=/^bot-[0-9]{3}-config.json$/,_0x276922=_0x24ab14['test'](_0x554c71['name']);if(_0x276922){const _0x4f79cf=JSON['parse'](_0x4879e4);if(_0x4f79cf[_0x13215b(0x267)][0x0]){_0x4f79cf[_0x13215b(0x267)][0x0]['apiKey']=_0x13215b(0x2ae),_0x4f79cf['bot'][0x0][_0x13215b(0x17b)]=_0x13215b(0x2ae);if(_0x4f79cf[_0x13215b(0x267)][0x0][_0x13215b(0x141)])_0x4f79cf[_0x13215b(0x267)][0x0][_0x13215b(0x141)]=_0x13215b(0x2ae);}_0x4879e4=JSON[_0x13215b(0x188)](_0x4f79cf,null,0x2);}if(_0x554c71[_0x13215b(0x2e4)]==_0x13215b(0x211)){const _0x124bd8=JSON['parse'](_0x4879e4);if(_0x124bd8[_0x13215b(0x19b)][_0x13215b(0x1d1)])_0x124bd8['settings'][_0x13215b(0x1d1)]=![];if(_0x124bd8['settings']['bbPassword'])_0x124bd8[_0x13215b(0x19b)]['bbPassword']=_0x13215b(0x2ae);if(_0x124bd8['settings'][_0x13215b(0x135)])_0x124bd8[_0x13215b(0x19b)][_0x13215b(0x135)]='***';if(_0x124bd8[_0x13215b(0x19b)][_0x13215b(0x294)])_0x124bd8[_0x13215b(0x19b)][_0x13215b(0x294)]=null;if(_0x124bd8['settings'][_0x13215b(0x13a)])_0x124bd8['settings'][_0x13215b(0x13a)]=_0x13215b(0x2ae);_0x4879e4=JSON[_0x13215b(0x188)](_0x124bd8,null,0x2);}if(_0x554c71['name']!=_0x13215b(0x1bf))_0x5e99e0[_0x13215b(0x2da)](_0x554c71[_0x13215b(0x2e4)],_0x4879e4);}else _0x5e99e0[_0x13215b(0x2da)](_0x554c71['name'],_0x4879e4);}});const _0x3a3389=await _0x5e99e0[_0x2cb49e(0x215)]({'type':_0x2cb49e(0x21d),'base64':![],'compression':'DEFLATE'});fs['writeFileSync'](zippath+(_0x24df45+'.zip'),_0x3a3389,_0x2cb49e(0x280));}async function unzipFile(_0xd56b63,_0x50aeb4){const _0x2f2585=_0x148ee4;fs[_0x2f2585(0x126)](configpath,{'withFileTypes':!![]})['forEach'](_0x1bb1d5=>{const _0x71962d=_0x2f2585;if(!_0x1bb1d5[_0x71962d(0x153)]())fs[_0x71962d(0x2d6)](configpath+_0x1bb1d5[_0x71962d(0x2e4)]);});const _0x181a2d=fs[_0x2f2585(0x100)](_0xd56b63+_0x50aeb4,_0x2f2585(0x280)),_0x19c3cc=await JSZip[_0x2f2585(0x30c)](_0x181a2d,{'base64':![],'checkCRC32':!![]});for(const _0x59440f of Object['keys'](_0x19c3cc[_0x2f2585(0x1dd)])){const _0x283a59=_0x19c3cc['files'][_0x59440f],_0x384b68=await _0x283a59[_0x2f2585(0x2be)](_0x2f2585(0x21d));fs[_0x2f2585(0x256)](configpath+_0x283a59[_0x2f2585(0x2e4)],_0x384b68);}fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x2f2585(0x12f)](_0x272e8f=>{const _0x53284e=_0x2f2585;if(!_0x272e8f[_0x53284e(0x153)]())fs[_0x53284e(0x2d6)](temppath+_0x272e8f[_0x53284e(0x2e4)]);}),logger[_0x2f2585(0x204)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x2f2585(0x24a)]({'restore':!![]},_0x419961=>{});}async function getPublicIp(){const _0x482530=_0x148ee4;try{const _0x26c0cc=await axios[_0x482530(0x165)](_0x482530(0x15e));publicip=_0x26c0cc[_0x482530(0x1c2)]['ip'];}catch(_0x4b7f7c){}}async function triggerAnalytics(){const _0x14db22=_0x148ee4;if(!publicip)await getPublicIp();const _0xc144c9=getBotsWithMode();let _0x4fd335=0x0;_0xc144c9[_0x14db22(0x12f)](_0x10931a=>{const _0x1f62d8=_0x14db22;if(_0x10931a[_0x1f62d8(0x145)]===_0x1f62d8(0x1ca))_0x4fd335++;});const _0x434979=getBotExchanges();mixpanel[_0x14db22(0x2f3)]('Server',{'distinct_id':settings[_0x14db22(0x1ab)],'ip':publicip,'version':serverversion,'numbots':_0xc144c9[_0x14db22(0x20d)],'numbotsenabled':_0x4fd335,'exchanges':_0x434979,'environment':environment});}async function getMessages(){const _0x4d5f44=_0x148ee4,_0x4f60c0=_0x4d5f44(0x205),_0x27fe23=new GraphQLClient(_0x4f60c0),_0x3e1c31={'authorization':_0x4d5f44(0x19d)},_0x473b99=serverversion[_0x4d5f44(0x26a)]('.'),_0x1f5332=_0x473b99[0x0]+'.'+_0x473b99[0x1],_0x145c4e=Math[_0x4d5f44(0x12d)](settings[_0x4d5f44(0x2bb)],settings[_0x4d5f44(0x286)]),_0x6bc484={'last':parseInt(_0x145c4e),'bbm':_0x1f5332},_0x304957=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x119b4f;try{_0x119b4f=await _0x27fe23[_0x4d5f44(0x18a)](_0x304957,_0x6bc484,_0x3e1c31);}catch(_0x137cb7){}if(_0x119b4f&&_0x119b4f[_0x4d5f44(0x23d)]){let _0x29375c=settings[_0x4d5f44(0x2bb)],_0x326eb2=settings[_0x4d5f44(0x2bb)];newMessages=[];for(const _0x45f17b of _0x119b4f[_0x4d5f44(0x23d)]){newMessages['push'](_0x45f17b);let _0x2634c9=![];_0x45f17b[_0x4d5f44(0x2dd)]&&(updateSetting('latestversion',_0x45f17b[_0x4d5f44(0x2dd)]),_0x2634c9=isNewerVersion(serverversion,_0x45f17b[_0x4d5f44(0x2dd)])||serverversion==_0x45f17b[_0x4d5f44(0x2dd)]);if(!_0x2634c9&&_0x45f17b['number']>_0x29375c){if(_0x45f17b['bbvReceive']===_0x4d5f44(0x202)||serverversion[_0x4d5f44(0x2ad)](_0x45f17b[_0x4d5f44(0x171)])){let _0x141fcb=''+_0x45f17b['title']+'\x0a\x0a'+_0x45f17b[_0x4d5f44(0x1e9)];const _0xc8c56d=await sendTelegramMsg(toTelegramMarkdown(_0x141fcb),_0x4d5f44(0x253));_0x29375c=_0x45f17b[_0x4d5f44(0x210)];}}_0x326eb2=_0x45f17b[_0x4d5f44(0x210)];}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x326eb2),emitMessages();}}function emitMessages(){const _0x2e8103=_0x148ee4,_0x3c7afd=settings['lastmsgemitted'];let _0x4a5a95=[];newMessages[_0x2e8103(0x12f)](_0x3eb428=>{const _0x2cd85e=_0x2e8103;_0x3eb428['number']>_0x3c7afd&&_0x4a5a95[_0x2cd85e(0x1e6)](_0x3eb428);}),_0x4a5a95[_0x2e8103(0x20d)]>0x0&&getAllClients()['forEach'](_0x4b91cb=>{const _0x50c36f=_0x2e8103;getSocket(_0x4b91cb['id'])['emit'](_0x50c36f(0x1e9),_0x4a5a95);});}function confirmMessage(_0x8a880a){updateSetting('lastmsgemitted',Number(_0x8a880a));}function isNewerVersion(_0x5d893a,_0x489bcc){const _0x3875f0=_0x489bcc['split']('.'),_0x3233ea=_0x5d893a['split']('.');for(var _0x11c143=0x0;_0x11c143<_0x3233ea['length'];_0x11c143++){const _0x493be1=~~_0x3233ea[_0x11c143],_0x1ddea3=~~_0x3875f0[_0x11c143];if(_0x493be1>_0x1ddea3)return!![];if(_0x493be1<_0x1ddea3)return![];}return![];}function toTelegramMarkdown(_0x401896){const _0x169f23=_0x148ee4,_0x314e0b=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x1dcb47=/\*{2}(.+?)\*{2}/gim;return _0x401896=_0x401896[_0x169f23(0x15f)](_0x314e0b,_0x169f23(0x20a))[_0x169f23(0x15f)](_0x1dcb47,_0x169f23(0x309)),_0x401896;}async function validateConfigFile(){const _0x25854e=_0x148ee4,_0x29a849=dbConfig[_0x25854e(0x165)]('bots')[_0x25854e(0x148)](_0x25854e(0x2f7))['value']()||[];if(_0x29a849[_0x25854e(0x20d)]==0x0){let _0x3620b5=0x0,_0x33b0ec=[];const _0x15af54=/^bot-([0-9]{3})-config.json$/,_0x29c448=fs[_0x25854e(0x126)](configpath);_0x29c448[_0x25854e(0x12f)](_0x16b7e5=>{const _0x5058a1=_0x25854e,_0x10475f=_0x15af54[_0x5058a1(0x1ac)](_0x16b7e5);if(_0x10475f){const _0x3067ca=_0x10475f[0x1];let _0x321b6b=getBotAttributes(_0x3067ca);_0x33b0ec[_0x5058a1(0x1e6)]({'botID':_0x3067ca,'botname':_0x321b6b[_0x5058a1(0x2b0)],'status':_0x5058a1(0x1e7),'live':'stopped'}),_0x3620b5++;}}),_0x3620b5!=0x0&&(dbConfig[_0x25854e(0x165)](_0x25854e(0x26f))['assign'](_0x33b0ec)['write'](),config=_0x33b0ec,restoredConfigFile=_0x3620b5);}}async function restoreConfigNotify(_0x496617){const _0x104179=_0x148ee4;let _0x53ddc9;if(restoredConfigFile==0x1)_0x53ddc9=_0x104179(0x15d);else _0x53ddc9=_0x104179(0x250);if(_0x496617)io['to'](_0x104179(0x18e))[_0x104179(0x2a6)](_0x104179(0x300),_0x53ddc9);else{logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x104179(0x1d6)](_0x53ddc9),logger['simple'](_0x104179(0x20f)),logger[_0x104179(0x1d6)]('');if(tgBot&&settings[_0x104179(0x294)]&&settings[_0x104179(0x113)]!=_0x104179(0x30d))await sendTelegram(settings[_0x104179(0x294)],_0x104179(0x1ed)+_0x53ddc9);}}function decryptRSA(_0x4e04d9,_0x1cb0f0){const _0x314b26=_0x148ee4,_0x489192=forge[_0x314b26(0x17c)]['privateKeyFromPem'](_0x4e04d9),_0x83c895=_0x489192[_0x314b26(0x109)](forge[_0x314b26(0x173)]['decode64'](_0x1cb0f0),'RSA-OAEP',{'md':forge['md']['sha256'][_0x314b26(0x22e)](),'mgf1':{'md':forge['md'][_0x314b26(0x230)][_0x314b26(0x22e)]()}});return _0x83c895;}function validateCredentials(_0x37e4c4,_0x462fe5){const _0x182905=_0x148ee4;if(_0x37e4c4[_0x182905(0x228)]==settings[_0x182905(0x136)]&&bcrypt[_0x182905(0x2ba)](_0x37e4c4['password'],settings['bbPassword'])){if(settings[_0x182905(0x28b)])return{'allow':![],'reason':_0x182905(0x1f3),'token':null};else{const _0x1fa6f9=generateLoginToken(_0x462fe5);return{'allow':!![],'reason':_0x182905(0x23e),'token':_0x1fa6f9};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x970a38){const _0x1c7e1b=_0x148ee4,_0x3dddea=generateLoginToken(_0x970a38);return{'allow':!![],'reason':_0x1c7e1b(0x23e),'token':_0x3dddea};}function validateAccess(_0x5efaab,_0x5c97a1,_0x3108fd){const _0x2bd815=_0x148ee4,_0x6ddf13=_0x3108fd?_0x3108fd:devices[_0x5c97a1]['ip'];let _0x2e23a2;const _0x490d0f=_0x168558=>{const _0x2b6091=_0xe43d;if(settings[_0x2b6091(0x1d1)]){if(settings[_0x2b6091(0x28b)]){if(telegram2FaApproved(_0x5c97a1)){const _0x2652aa=generateLoginToken(_0x5c97a1);return{'allow':!![],'reason':_0x2b6091(0x2db),'token':_0x2652aa};}else return{'allow':![],'reason':_0x2b6091(0x2a7),'token':null};}else return _0x2e23a2=validToken(_0x168558,_0x5c97a1),_0x2e23a2[_0x2b6091(0x208)](_0x2b6091(0x1ec))?{'allow':!![],'reason':_0x2b6091(0x1ba),'token':_0x168558}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x2b6091(0x149),'token':null};};if(settings['whitelistEnabled']){let _0x1ce492=[...settings[_0x2bd815(0x29a)],_0x2bd815(0x137),'::ffff:127.0.0.1',_0x2bd815(0x22d),'::ffff:7f00:1'];if(_0x1ce492[_0x2bd815(0x133)](_0x6ddf13))return _0x490d0f(_0x5efaab);else{_0x2e23a2=validToken(_0x5efaab,_0x5c97a1);if(_0x2e23a2['hasOwnProperty']('success'))return _0x490d0f(_0x5efaab);else{if(telegramIpApproved(_0x5c97a1)){const _0x247e08=generateToken(_0x5c97a1);return _0x2e23a2=_0x490d0f(_0x5efaab),_0x2e23a2[_0x2bd815(0x22f)]?{'allow':!![],'reason':_0x2bd815(0x241),'token':_0x247e08}:_0x2e23a2;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x2bd815(0x2a0),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x490d0f(_0x5efaab);}function timelyDecrypt(_0xd0df26,_0x1dabc9,_0x3d34ea='@'){const _0x3132a0=_0x148ee4;if(_0xd0df26)try{const _0x452fc8=decryptRSA(secure['privateKey'],_0xd0df26),_0x24f307=_0x452fc8[_0x3132a0(0x26a)](_0x3d34ea)[0x0],_0xd080cd=_0x452fc8[_0x3132a0(0x26a)](_0x3d34ea)[0x1],_0x38e000=new Date()['getTime']();if(_0x1dabc9){if(_0x38e000-_0xd080cd<maxSecretAge*0x3e8)return _0x24f307;else return![];}else return _0x24f307;}catch(_0x5880b6){return![];}else return![];}const validToken=(_0x471a0c,_0x1d2cda)=>{const _0x48bee6=_0x148ee4,_0xd5bfc8=devices[_0x1d2cda]['ip'];if(!_0x471a0c)return{'error':'No\x20authentication\x20token'};for(let _0x41fd7f of blacklist){if(_0x41fd7f[_0x48bee6(0x20e)]==_0x471a0c)return{'error':_0x48bee6(0x299)};}let _0x146b50;try{_0x146b50=jwt['verify'](_0x471a0c,secure[_0x48bee6(0x117)]+_0x1d2cda);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x146b50['hasOwnProperty']('clientip')&&!_0x146b50[_0x48bee6(0x208)]('username')||!_0x146b50[_0x48bee6(0x208)](_0x48bee6(0x25c)))return{'error':_0x48bee6(0x102)};if(!_0x146b50[_0x48bee6(0x208)]('username')&&_0x146b50[_0x48bee6(0x208)](_0x48bee6(0x1f6))){const {clientip:_0x4b0e64}=_0x146b50;return _0xd5bfc8==_0x4b0e64?{'success':_0x48bee6(0x1a7)}:{'error':_0x48bee6(0x103)};}else{if(_0x146b50[_0x48bee6(0x208)](_0x48bee6(0x228))&&_0x146b50[_0x48bee6(0x208)](_0x48bee6(0x1f6))){const {username:_0x4f42e7,clientip:_0x39ec15}=_0x146b50;return settings[_0x48bee6(0x136)]==_0x4f42e7&&_0xd5bfc8==_0x39ec15?{'success':_0x48bee6(0x1a7)}:{'error':_0x48bee6(0x1b6)};}}},generateLoginToken=_0x22819b=>{const _0x59809f=_0x148ee4;if(_0x22819b){const _0x3165f1=devices[_0x22819b]['ip'];return jwt[_0x59809f(0x304)]({'username':settings[_0x59809f(0x136)],'clientip':_0x3165f1},secure[_0x59809f(0x117)]+_0x22819b,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x32f3a2=>{const _0x17b837=_0x148ee4;if(_0x32f3a2){const _0x352d85=devices[_0x32f3a2]['ip'];return jwt[_0x17b837(0x304)]({'clientip':_0x352d85},secure[_0x17b837(0x117)]+_0x32f3a2,{'expiresIn':devices[_0x32f3a2][_0x17b837(0x20b)][_0x17b837(0x1a5)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x3c2cfd=>{const _0x2e7a4a=_0x148ee4;let _0x2ebc4e=![];return devices[_0x3c2cfd]['telegramIpApproval']&&devices[_0x3c2cfd][_0x2e7a4a(0x20b)]['expiry']!=_0x2e7a4a(0x158)&&(_0x2ebc4e=devices[_0x3c2cfd][_0x2e7a4a(0x20b)][_0x2e7a4a(0x1f6)]==devices[_0x3c2cfd]['ip']&&new Date()[_0x2e7a4a(0x26d)]()-devices[_0x3c2cfd][_0x2e7a4a(0x20b)][_0x2e7a4a(0x1df)]<devices[_0x3c2cfd][_0x2e7a4a(0x20b)][_0x2e7a4a(0x1a5)]*0x3c*0x3e8),_0x2ebc4e;},telegram2FaApproved=_0x2ad6b6=>{const _0x2cc394=_0x148ee4;let _0x543930=![];return devices[_0x2ad6b6]['telegram2FaApproval']&&devices[_0x2ad6b6][_0x2cc394(0x1c4)]['expiry']!='reject'&&(_0x543930=devices[_0x2ad6b6]['telegram2FaApproval'][_0x2cc394(0x1f6)]==devices[_0x2ad6b6]['ip']&&new Date()['getTime']()-devices[_0x2ad6b6][_0x2cc394(0x1c4)]['timestamp']<devices[_0x2ad6b6][_0x2cc394(0x1c4)][_0x2cc394(0x1a5)]*0x3c*0x3e8),_0x543930;},normalizeIP=_0x4d64fe=>{const _0xc015b3=_0x148ee4;let _0x154d87=null,_0x4a95e5=null;if(ipaddr[_0xc015b3(0x27b)](_0x4d64fe)){const _0x15667b=ipaddr[_0xc015b3(0x128)](_0x4d64fe);_0x15667b[_0xc015b3(0x23a)]()==='ipv6'?(_0x15667b[_0xc015b3(0x255)]()&&(_0x154d87=_0x15667b['toIPv4Address']()[_0xc015b3(0x27d)]()),_0x4a95e5=_0x15667b[_0xc015b3(0x27d)]()):(_0x154d87=_0x15667b[_0xc015b3(0x27d)](),_0x4a95e5=_0x15667b['toIPv4MappedAddress']()['toString']());}return{'show':_0x154d87?_0x154d87:_0x4a95e5,'store':_0x4a95e5};};function formatDate(_0x429794){const _0x1dd396=_0x148ee4;return _0x429794[_0x1dd396(0x1fd)]()+'/'+(_0x429794[_0x1dd396(0x275)]()+0x1)[_0x1dd396(0x27d)]()[_0x1dd396(0x2cc)](0x2,'0')+'/'+_0x429794['getDate']()['toString']()[_0x1dd396(0x2cc)](0x2,'0')+'\x20'+_0x429794[_0x1dd396(0x281)]()[_0x1dd396(0x27d)]()[_0x1dd396(0x2cc)](0x2,'0')+':'+_0x429794[_0x1dd396(0x22b)]()[_0x1dd396(0x27d)]()[_0x1dd396(0x2cc)](0x2,'0')+':'+_0x429794[_0x1dd396(0x2f5)]()[_0x1dd396(0x27d)]()['padStart'](0x2,'0');}function sleep(_0x3ebe9a){return new Promise(_0x4c2d26=>setTimeout(_0x4c2d26,_0x3ebe9a));}