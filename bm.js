const _0x4cb281=_0x1713;(function(_0x3e9253,_0x449567){const _0x41eda6=_0x1713,_0x16c91c=_0x3e9253();while(!![]){try{const _0x38fceb=-parseInt(_0x41eda6(0x227))/0x1+-parseInt(_0x41eda6(0x1ca))/0x2*(-parseInt(_0x41eda6(0x324))/0x3)+parseInt(_0x41eda6(0x2f2))/0x4*(parseInt(_0x41eda6(0x2bb))/0x5)+-parseInt(_0x41eda6(0x327))/0x6*(parseInt(_0x41eda6(0x23f))/0x7)+parseInt(_0x41eda6(0x297))/0x8*(parseInt(_0x41eda6(0x2ad))/0x9)+-parseInt(_0x41eda6(0x1de))/0xa+-parseInt(_0x41eda6(0x251))/0xb;if(_0x38fceb===_0x449567)break;else _0x16c91c['push'](_0x16c91c['shift']());}catch(_0x3ac1f6){_0x16c91c['push'](_0x16c91c['shift']());}}}(_0xa6f5,0xdd120));const _0x1b7156=function(){let _0xfc3f48=!![];return function(_0x1eb9f8,_0x4996f8){const _0x3ed46a=_0xfc3f48?function(){const _0x36313a=_0x1713;if(_0x4996f8){const _0x126e1c=_0x4996f8[_0x36313a(0x360)](_0x1eb9f8,arguments);return _0x4996f8=null,_0x126e1c;}}:function(){};return _0xfc3f48=![],_0x3ed46a;};}(),_0x3aa144=_0x1b7156(this,function(){const _0x1a6cca=_0x1713;return _0x3aa144['toString']()['search'](_0x1a6cca(0x2b7))[_0x1a6cca(0x1cc)]()['constructor'](_0x3aa144)[_0x1a6cca(0x258)]('(((.+)+)+)+$');});_0x3aa144();'use strict';process[_0x4cb281(0x313)][_0x4cb281(0x1e6)]=0x1;const childProcess=require(_0x4cb281(0x33c)),fs=require('fs'),fns=require(_0x4cb281(0x2b3)),low=require('lowdb'),FileSync=require(_0x4cb281(0x266)),path=require('path'),crypto=require(_0x4cb281(0x2e5)),forge=require(_0x4cb281(0x2fa)),bcrypt=require('bcryptjs'),jwt=require(_0x4cb281(0x1c3)),ipaddr=require(_0x4cb281(0x256)),argv=require(_0x4cb281(0x262))(process[_0x4cb281(0x27d)][_0x4cb281(0x25c)](0x2))[_0x4cb281(0x27d)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x4cb281(0x269)),Mixpanel=require('mixpanel'),axios=require(_0x4cb281(0x1b7)),{GraphQLClient,gql}=require(_0x4cb281(0x1da)),util=require(_0x4cb281(0x338)),fileUpload=require(_0x4cb281(0x337)),{networkInterfaces}=require('os'),JSZip=require(_0x4cb281(0x1c7)),PORT=argv[_0x4cb281(0x2cc)]||_0x4cb281(0x1c9),pattern=/^[0-9]{2,4}$/;!pattern[_0x4cb281(0x1fa)](PORT)&&(console[_0x4cb281(0x1e8)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x4cb281(0x37c)](0x1));const HOST=argv[_0x4cb281(0x18b)]||null,userID=argv[_0x4cb281(0x33a)]||'',debugging=argv['d']||![],nodeversion=process[_0x4cb281(0x241)]['node'];let bbpath=_0x4cb281(0x335),bbpath2='';const botfile=_0x4cb281(0x19e),configfile=_0x4cb281(0x20f),settingsfile=_0x4cb281(0x3b2),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x4cb281(0x1b8))['environment']||_0x4cb281(0x38f),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x4cb281(0x30b)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4cb281(0x282)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x4cb281(0x29c),configbackuppath=configpath+_0x4cb281(0x195),logspath=userID?bbpath+_0x4cb281(0x26f)+userID+'/':bbpath+_0x4cb281(0x26f),zippath=userID?bbpath+_0x4cb281(0x1f3)+userID+'/':bbpath+'zip/',loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x4cb281(0x18e)+userID+'/':bbpath+_0x4cb281(0x18e);!fs[_0x4cb281(0x30b)](configpath)&&fs[_0x4cb281(0x29d)](configpath);!fs[_0x4cb281(0x30b)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x4cb281(0x30b)](logspath)&&fs[_0x4cb281(0x29d)](logspath);!fs['existsSync'](zippath)&&fs[_0x4cb281(0x29d)](zippath);!fs[_0x4cb281(0x30b)](temppath)&&fs[_0x4cb281(0x29d)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x4cb281(0x386)]({'bots':[]})[_0x4cb281(0x261)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4cb281(0x386)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x4cb281(0x285),'onepagemode':![],'marketcapApi':''}})[_0x4cb281(0x261)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);function _0xa6f5(){const _0x46e54f=['new-disabled','port','/help\x20-\x20show\x20available\x20commands\x0a','login\x20token\x20generated','sendMessage','files','simple','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','/names\x20-\x20show\x20bot\x20names\x0a','from','enabled','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','unlinkSync','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','2FA\x20login\x20token\x20generated','\x1b[36m','kind','update-bot','push','botID','-config.json','logs','showConfig','Logged\x20out\x20user\x20...','yes','crypto','pki','Error\x20sending\x20','message','You\x20can\x20use\x20the\x20following\x20commands:\x0a','whitelist','verify','button','sign','*$1*','build2','[ip-address]','forEach','40148IuWYop','ipc','inherit','emit','\x20to\x20','success','reset-password','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','node-forge','version','writeFileSync','login2fa_reject_','build','telegramIpApproval','Notifications\x20enabled\x0a','started','Temporary\x20access\x20rejected','join','rsa','<b>Telegram\x20Bot\x20Status:</b>\x0a','start','#RES#\x20if\x20running\x20on\x20server','filter','/enable\x20-\x20enable\x20notifications\x0a','download','existsSync','replyWithDocument','apiPassword','off_','publicKeyToPem','password','Node.js\x20v','statSync','env','getDate',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','Starting\x20Balance\x20Bot\x20update','clientip','disable','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','latestversion','new','isValid','getPortfolio','copyFileSync','restart','then','Unauthorized\x20attempt\x20to\x20get\x20portfolio','sendMetricsTelegram','9KxDVVl','temporary\x20token\x20generated','reinstall-bb','1050ypJsLC','/metrics\x20-\x20show\x20bot\x20performance\x0a','entries','botmanager','mode','launch','No\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20show\x20configuration','connected','catch','exec','config_orders','Unauthorized\x20attempt\x20to\x20update\x20bot','api-eu.mixpanel.com','bb/','includes','express-fileupload','util','Alerts','user','resetpw_yes','child_process','names','\x20|\x20user:\x20...','getStartingBalances','publicKey','Unauthorized\x20attempt\x20to\x20store\x20configuration','live','metrics_','auto','value','orders','Starting\x20Balance\x20Bot\x20reinstallation','15\x20min','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','reinstall_yes','backup-full@','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','sendPortfolioTelegram','headers','f2aRequired','delete-alerts','token','store-configuration','error','min','referer','exp','2FA\x20login\x20required','title','\x20(2)','manual','telegramEvents','get','backup-files','\x1b[33m','event','apply','http','Backup\x20file\x20unzipped\x20and\x20stored','access','tempaccess_30_','Login\x20rejected','status','/backup\x20-\x20receive\x20backup\x20files\x0a','allow','/:bot/coins','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Error\x20while\x20deleting\x20config\x20files:\x20','post','Ok,\x20will\x20send\x20order\x20notifications\x20only','resetpw_no','telegramUsername','index.html','Starting\x20#RED#Balance\x20Bot\x20v','tempaccess_15_','apiKey','Password\x20reset\x20rejected','#RES#','/status\x20-\x20show\x20bot(s)\x20status\x0a','Allow\x20login\x20from\x20IP\x20address\x20','close','get-messages','notification','Bot\x20','exit','text','Restore\x20process\x20confirmed','stopped','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Unauthorized\x20attempt\x20to\x20log\x20out','headless','compareSync','kill','placeOrder','defaults','blacklist','sortBy','toggle_','whitelistEnabled','2FA','length','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','pidRefreshToken','production','deleteHistoryAlerts','\x20mode','disabled','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','temporary\x20access\x20timeout','Restore\x20process\x20aborted','get-logs','logged\x20out','listen','update','#RES#\x20','userid','=>\x20Go\x20to\x20#CYA#http://','\x1b[31m','sha256','Ok,\x20will\x20send\x20alert\x20notifications\x20only','accept','SIGINT','type','reload','tkn','encryptedUuid','/:bot/portfolio','\x1b[34m','showname','file','store-settings','/start','privateKey','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Restarting\x20Bot\x20','telegramEnabled','internal','/restart\x20-\x20restart\x20bot(s)\x0a','bb-settings.json','add','host','::ffff:127.0.0.1','on_','temp/','rmSync','\x20|\x20','***',')\x20\x20\x20|\x20Bot\x20','toggleBotMode','reply','backup/','login','portfolio_','track','Unauthorized\x20attempt\x20to\x20get\x20messages','$1_$2_$3','send','command','reason','bot.js','socket','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','createServer','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','get-starting-balances','getMonth','Notifications\x20enabled','127.0.0.1','backupfile','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','randomBytes','set','Disabled\x20Bot\x20','getFullYear','store-headless','/:bot/performance','string','SIGTERM','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','padStart','address','/download/:type','Yes','login\x20not\x20required','axios','version.json','restart_','telegram','telegrammsg','login2fa_','Unauthorized\x20attempt\x20to\x20update\x20settings','match','all','timestamp','marketcapApi','Invalid\x20IP\x20address','jsonwebtoken','toIPv4MappedAddress','loginRequired','DEFLATE','jszip','update_no','3000','1201832VBxeWQ','Unauthorized\x20attempt\x20to\x20confirm\x20message','toString','sort','bb-secure.json','metrics','running','All\x20bots\x20running\x20right\x20now','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Access\x20enabled\x20for\x20','-results.json','/update\x20-\x20update\x20Balance\x20Bot\x0a','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','status\x20code\x20401','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','bot','graphql-request','timeshift','logout','5\x20min','7189890RxOxwy','config','number','toIPv4Address','place-order','readFileSync','getMinutes','decode64','NTBA_FIX_319','#RES#\x20if\x20running\x20locally\x0a','log','Password\x20has\x20been\x20reset\x20to:\x20','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','family','BCT','stop','async','settings','onepagemode','\x20|\x20client:\x20...','toggle','zip/','reinstall','/logs\x20-\x20receive\x20log\x20files\x0a','Notifications\x20disabled\x0a','static','args','backup-full','test','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','auth','bots','once','initclient','update_yes','update-bb','IPv4','replace',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','2FA\x20required','::1','telegram2FaApproval','<b>Balance\x20Bot\x20Status:</b>\x0a','alerts','format','\x20-\x20','store','server','Telegraf\x20error:','bb-config.json','settings.','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Restore\x20backup\x20file\x20','Session\x20expired\x20for\x20user\x20...','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','-performance.json','request','find','2FA\x20login\x20rejected','_nsps','randomFillSync','Failed\x20to\x20download\x20','************','function','fork','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','warning','uuid','assign','getHours','Bot\x20Mgr\x20>\x20','editMessageReplyMarkup','code','1607132IhDcGi','parse','|@|','messages','isIPv4MappedAddress','confirm-message','output-002.log','Unauthorized\x20attempt\x20to\x20download\x20','enable','use','secure','login\x20token\x20valid','help','name','Login\x20accepted','.zip','params','pidExpireLogin','Server','toggle-bot-mode','bbUsername','lastmsgtelegram','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','output-001.log','14476qxuVph','bot-','versions','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','invalid\x20credentials','store-fiat','Running\x20#RED#Balance\x20Bot\x20v','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','conn','All\x20bots','Setting\x20access:\x20','restore-backup-file','backup','staging','Enabled\x20Bot\x20','Restoring\x20bot(s)\x20from\x20backup','binary','Invalid\x20authentication\x20token\x20(1)','6196267wLOvYf','Backup\x20file\x20uploaded','\x20files\x20over\x20Telegram:','range','bbvNew','ipaddr.js','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','search','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','getSeconds','create','slice','bbvReceive','30\x20min','address\x20already\x20in\x20use','secret','write','yargs/yargs','updatebotmanager','off','storeHeadless','lowdb/adapters/FileSync','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','generateAsync','telegraf','emitHistory','action','tempaccess_reject_','storeFiat','generateKeyPair','logs/','tempaccess_5_','-events.json','handshake','Unauthorized\x20attempt\x20to\x20delete\x20alerts','\x1b[0m','privateKeyFromPem','readdirSync','output-000.log','temporary\x20access\x20not\x20allowed','sockets','lastmsgemitted','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Notifications\x20types:\x20','argv','botname','username','privateKeyToPem','Error\x20details:','clients','restore_no_','login\x20required','0.0.0','/disable\x20-\x20disable\x20notifications\x0a','remove','telegramToken','access\x20timeout','HTML','stringify','keys','Deleted\x20Bot\x20','get-portfolio','isDirectory','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','chat','/:bot/history','decrypt','split','User\x20has\x20been\x20validated','8956184wnPxyS','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','inlineKeyboard','config/','mkdirSync','debug','getUTCHours','ipv6','temporaryAccessAllowed','config_alerts','reject','sendFile','telegramChatId','Notifications\x20disabled','callback','storeConfiguration','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','getTime','File\x20uploaded','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','9ERhTRd','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','startsWith','cancelLoading','RSA-OAEP','private','date-fns','No\x20authentication\x20token','full','expiry','(((.+)+)+)+$','disconnect','\x20>\x20','/:bot','615QAEtJd','add-bot','config_all','Logged\x20in\x20user\x20...','remoteAddress','cancel-loading','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Invalid\x20authentication\x20token\x20(2)','1000','(staging)','/:bot/support','hasOwnProperty','-----------------------------------------------------------------------------------','bbPassword','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files'];_0xa6f5=function(){return _0x46e54f;};return _0xa6f5();}dbSecure[_0x4cb281(0x386)]({'secure':{},'blacklist':[]})[_0x4cb281(0x261)]();const saltRounds=0xa,mixpanel=Mixpanel['init']('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x4cb281(0x334)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x4cb281(0x288)]&&(settings['telegramToken']!=''&&settings[_0x4cb281(0x288)]!=_0x4cb281(0x191))&&settings[_0x4cb281(0x36f)]&&settings[_0x4cb281(0x36f)]!='')initTelegram();const parseColor=(_0x5665dd,_0x4fbd9a)=>{const _0x5ade0f=_0x4cb281,_0x36cde7=/#[A-Z]{3}#/g;if(typeof _0x5665dd==_0x5ade0f(0x1af)){!_0x4fbd9a?_0x5665dd=_0x5665dd[_0x5ade0f(0x203)](_0x36cde7,''):(_0x5665dd=_0x5665dd['replace'](/#BLU#/g,_0x5ade0f(0x3a7)),_0x5665dd=_0x5665dd[_0x5ade0f(0x203)](/#RED#/g,_0x5ade0f(0x39d)),_0x5665dd=_0x5665dd[_0x5ade0f(0x203)](/#YEL#/g,_0x5ade0f(0x35e)),_0x5665dd=_0x5665dd[_0x5ade0f(0x203)](/#MAG#/g,'\x1b[35m'),_0x5665dd=_0x5665dd[_0x5ade0f(0x203)](/#CYA#/g,_0x5ade0f(0x2db)),_0x5665dd=_0x5665dd[_0x5ade0f(0x203)](/#RES#/g,_0x5ade0f(0x274)));;}return _0x5665dd;},logger={'screen':_0x5c2f3d=>{console['log'](parseColor(_0x5c2f3d,!![]));},'simple':_0x3d4f9e=>{const _0x1f0485=_0x4cb281;console['log'](parseColor(_0x3d4f9e,!![])),loggerfile[_0x1f0485(0x261)](util[_0x1f0485(0x20a)](parseColor(_0x3d4f9e,![]))+'\x0a');},'full':async _0x4b3fa2=>{const _0x369a6f=_0x4cb281,_0x167e4a=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x4b3fa2;console[_0x369a6f(0x1e8)](parseColor(_0x167e4a,!![])),loggerfile[_0x369a6f(0x261)](util[_0x369a6f(0x20a)](parseColor(_0x167e4a,![]))+'\x0a');if(tgBot&&settings[_0x369a6f(0x2a5)]&&settings[_0x369a6f(0x35b)]!='orders')await sendTelegram(settings[_0x369a6f(0x2a5)],_0x369a6f(0x224)+parseColor(_0x4b3fa2,![]));},'debug':async(_0xbe1662,_0xbf288='')=>{const _0x3d0c08=_0x4cb281,_0x579c43=getTimeStamp()+_0x3d0c08(0x204)+_0xbe1662;if(debugging)console[_0x3d0c08(0x1e8)](parseColor(_0x579c43,!![]));loggerfile[_0x3d0c08(0x261)](util[_0x3d0c08(0x20a)](parseColor(_0x579c43,![]))+'\x0a');if(_0xbf288){if(debugging)console[_0x3d0c08(0x1e8)](_0xbf288);loggerfile[_0x3d0c08(0x261)](util[_0x3d0c08(0x20a)](_0xbf288)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x1059e6){const _0x26fe45=_0x4cb281;_0x1059e6[_0x26fe45(0x1cc)]()[_0x26fe45(0x336)](_0x26fe45(0x25f))?(logger['simple']('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x1059e6['port']+_0x26fe45(0x375)),process[_0x26fe45(0x19b)]({'terminate':!![]},_0x2b3c66=>{})):logger[_0x26fe45(0x2d1)](_0x1059e6);}),process['on'](_0x4cb281(0x37c),()=>{const _0x5611c8=_0x4cb281;stopAllBots(),process[_0x5611c8(0x37c)](0x0);}),process['on'](_0x4cb281(0x1b0),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x4cb281(0x3a1),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x4cb281(0x2fb)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x4cb281(0x361))[_0x4cb281(0x1a1)](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get'](_0x4cb281(0x1b4),async(_0x44daf5,_0x3367bb)=>{const _0x4a8345=_0x4cb281,_0x4468af=_0x44daf5[_0x4a8345(0x237)][_0x4a8345(0x3a2)],_0x339b29=getClientsWithBotID(_0x4a8345(0x32a)),_0x2c71e9=_0x44daf5[_0x4a8345(0x34e)][_0x4a8345(0x221)],_0x770537=timelyDecrypt(_0x2c71e9,![]),_0x559851=_0x339b29[_0x4a8345(0x217)](_0x527a4f=>_0x527a4f[_0x4a8345(0x221)]==_0x770537);if(_0x559851){const _0x5c611f=normalizeIP(_0x44daf5[_0x4a8345(0x19f)][_0x4a8345(0x2bf)])[_0x4a8345(0x20c)],_0x43f27e=_0x44daf5['headers'][_0x4a8345(0x3a4)];if(validateAccess(_0x43f27e,_0x770537,_0x5c611f)[_0x4a8345(0x368)])_0x4468af==_0x4a8345(0x24b)&&await backupConfigFiles(),await zipFiles(_0x4468af),_0x3367bb[_0x4a8345(0x30a)](zippath+(_0x4468af+'.zip'),_0xb8869a=>{const _0x4bc943=_0x4a8345;_0xb8869a&&(logger[_0x4bc943(0x2b5)](_0x4bc943(0x21b)+_0x4468af),logger[_0x4bc943(0x2d1)](_0xb8869a));});else logger[_0x4a8345(0x2b5)](_0x4a8345(0x22e)+_0x4468af+'\x20(1)');}else logger[_0x4a8345(0x2b5)](_0x4a8345(0x22e)+_0x4468af+_0x4a8345(0x359));}),app[_0x4cb281(0x36c)]('/upload-backup',async(_0x42b62d,_0x22b679)=>{const _0x4f94d5=_0x4cb281,_0x21d285=getClientsWithBotID(_0x4f94d5(0x32a)),_0x2abcfa=_0x42b62d[_0x4f94d5(0x34e)][_0x4f94d5(0x221)],_0x5808a8=timelyDecrypt(_0x2abcfa,![]),_0x375e7b=_0x21d285[_0x4f94d5(0x217)](_0x4338eb=>_0x4338eb[_0x4f94d5(0x221)]==_0x5808a8);logger['debug'](_0x4f94d5(0x252));if(_0x375e7b){const _0x30ff48=normalizeIP(_0x42b62d[_0x4f94d5(0x19f)][_0x4f94d5(0x2bf)])['store'],_0x4aa517=_0x42b62d['headers'][_0x4f94d5(0x3a4)];if(validateAccess(_0x4aa517,_0x5808a8,_0x30ff48)['allow']){if(_0x42b62d[_0x4f94d5(0x2d0)]){const _0x1f8d18=_0x42b62d['files'][_0x4f94d5(0x1a7)];await _0x1f8d18['mv'](temppath+_0x1f8d18[_0x4f94d5(0x234)]),_0x22b679[_0x4f94d5(0x19b)]({'status':!![],'message':_0x4f94d5(0x2ab)});const _0x19728e=getBotsWithMode();_0x19728e[_0x4f94d5(0x38c)]>0x0?confirmRestore(temppath,_0x1f8d18[_0x4f94d5(0x234)]):unzipFile(temppath,_0x1f8d18[_0x4f94d5(0x234)]);}}else logger['full'](_0x4f94d5(0x1b1));}else logger[_0x4f94d5(0x2b5)](_0x4f94d5(0x2f9));}),app['use'](express[_0x4cb281(0x1f7)](path[_0x4cb281(0x303)](__dirname,bbpath2,'build2'))),app[_0x4cb281(0x230)](express[_0x4cb281(0x1f7)](path[_0x4cb281(0x303)](__dirname,bbpath2,_0x4cb281(0x2fe)))),app[_0x4cb281(0x35c)]('/',function(_0x2cb95c,_0x48b829){const _0x181e3f=_0x4cb281;_0x48b829[_0x181e3f(0x2a4)](path[_0x181e3f(0x303)](__dirname,bbpath2,_0x181e3f(0x2ef),_0x181e3f(0x370)));}),app['get'](_0x4cb281(0x2ba),function(_0x370dce,_0xa8672e){const _0x1b761d=_0x4cb281;_0xa8672e['sendFile'](path['join'](__dirname,bbpath2,_0x1b761d(0x2fe),'index.html'));}),app[_0x4cb281(0x35c)](_0x4cb281(0x3a6),(_0x5eafc2,_0x20e447)=>{const _0x45d46a=_0x4cb281;_0x20e447['sendFile'](path[_0x45d46a(0x303)](__dirname,bbpath2,_0x45d46a(0x2fe),_0x45d46a(0x370)));}),app['get'](_0x4cb281(0x1ae),(_0x396daf,_0x19edd6)=>{const _0xc7e7a8=_0x4cb281;_0x19edd6[_0xc7e7a8(0x2a4)](path[_0xc7e7a8(0x303)](__dirname,bbpath2,_0xc7e7a8(0x2fe),_0xc7e7a8(0x370)));}),app['get'](_0x4cb281(0x369),(_0x1280b5,_0xcf751)=>{const _0x1174a9=_0x4cb281;_0xcf751['sendFile'](path[_0x1174a9(0x303)](__dirname,bbpath2,_0x1174a9(0x2fe),_0x1174a9(0x370)));}),app[_0x4cb281(0x35c)](_0x4cb281(0x293),(_0x1b96a2,_0x359251)=>{const _0x426240=_0x4cb281;_0x359251[_0x426240(0x2a4)](path['join'](__dirname,bbpath2,_0x426240(0x2fe),_0x426240(0x370)));}),app[_0x4cb281(0x35c)]('/:bot/configuration',(_0x4bb47e,_0x1b20f3)=>{const _0x33d985=_0x4cb281;_0x1b20f3['sendFile'](path[_0x33d985(0x303)](__dirname,bbpath2,'build',_0x33d985(0x370)));}),app['get'](_0x4cb281(0x2c6),(_0x3b949f,_0x627aa6)=>{const _0x5896b6=_0x4cb281;_0x627aa6[_0x5896b6(0x2a4)](path['join'](__dirname,bbpath2,_0x5896b6(0x2fe),_0x5896b6(0x370)));});if(HOST)http['listen'](PORT,HOST);else http[_0x4cb281(0x398)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0xf8532f=_0x4cb281;let _0x18edaf=_0xf8532f(0x2f0);const _0x265a38=networkInterfaces(),_0x340f77={};for(const _0x529539 of Object[_0xf8532f(0x28c)](_0x265a38)){for(const _0x4cdbc7 of _0x265a38[_0x529539]){if((_0x4cdbc7[_0xf8532f(0x1eb)]==_0xf8532f(0x202)||_0x4cdbc7[_0xf8532f(0x1eb)]==0x4)&&!_0x4cdbc7[_0xf8532f(0x3b0)]){const _0x30542a=ipaddr[_0xf8532f(0x228)](_0x4cdbc7[_0xf8532f(0x1b3)])[_0xf8532f(0x254)]();_0x30542a!=_0xf8532f(0x2b2)&&(!_0x340f77[_0x529539]&&(_0x340f77[_0x529539]=[]),_0x340f77[_0x529539][_0xf8532f(0x2de)](_0x4cdbc7['address']),_0x18edaf=_0x4cdbc7[_0xf8532f(0x1b3)]);}}}return{'serverip':_0x18edaf,'netinterfaces':_0x340f77};}async function startServer(){const _0x5a7bee=_0x4cb281,{serverip:_0x4d3748,netinterfaces:_0x13e671}=getServerIP();logger[_0x5a7bee(0x2d1)](''),logger[_0x5a7bee(0x2d1)](_0x5a7bee(0x2c8)),await logger[_0x5a7bee(0x2b5)](_0x5a7bee(0x371)+serverversion+_0x5a7bee(0x39a)+(environment==_0x5a7bee(0x24c)?_0x5a7bee(0x2c5):'')+'\x0a'+(_0x5a7bee(0x298)+PORT+_0x5a7bee(0x1e7))+(_0x5a7bee(0x39c)+_0x4d3748+':'+PORT+_0x5a7bee(0x307))),logger[_0x5a7bee(0x2d1)]('-----------------------------------------------------------------------------------');if(config[_0x5a7bee(0x38c)]!=0x0)for(const _0x4379c3 of config){const _0x2258c1=_0x4379c3['mode']==_0x5a7bee(0x344)?'a':'m';if(_0x4379c3[_0x5a7bee(0x366)]==_0x5a7bee(0x2d6)||_0x4379c3[_0x5a7bee(0x366)]==_0x5a7bee(0x31c))await logger[_0x5a7bee(0x2b5)]('Starting\x20('+_0x2258c1+')\x20|\x20Bot\x20'+_0x4379c3[_0x5a7bee(0x2df)]+_0x5a7bee(0x190)+_0x4379c3[_0x5a7bee(0x27e)]),startBot([_0x4379c3['botID'],userID],{'cwd':bbpath},function(_0x5dc6de){const _0x50b687=_0x5a7bee;if(_0x5dc6de)logger[_0x50b687(0x2b5)](_0x5dc6de);});else(_0x4379c3[_0x5a7bee(0x366)]=='disabled'||_0x4379c3[_0x5a7bee(0x366)]=='new-disabled')&&await logger[_0x5a7bee(0x2b5)]('Idling\x20('+_0x2258c1+_0x5a7bee(0x192)+_0x4379c3['botID']+_0x5a7bee(0x190)+_0x4379c3[_0x5a7bee(0x27e)]);}else!newBot&&logger[_0x5a7bee(0x2d1)](_0x5a7bee(0x2c1));if(newBot)addBot();logger[_0x5a7bee(0x2d1)](_0x5a7bee(0x2c8)),logger[_0x5a7bee(0x2d1)](''),await logger[_0x5a7bee(0x29e)](_0x5a7bee(0x311)+nodeversion),await logger[_0x5a7bee(0x29e)]('Network\x20Interfaces:',_0x13e671);}function startSocket(){io['on']('connection',_0x2ecce4=>{const _0x4cbca5=_0x1713;let _0xcfcf1a,_0x38b409,_0x569b9e,_0x47f7c2,_0x1eb7cc;const _0x55af60=_0x2ecce4['handshake'][_0x4cbca5(0x34e)][_0x4cbca5(0x355)];_0x38b409=_0x55af60['match'](/bot[0-9]{3}/);if(_0x38b409)_0x569b9e=_0x38b409[0x0]['match'](/[0-9]{3}/);if(_0x569b9e)_0xcfcf1a=_0x569b9e[0x0];else _0xcfcf1a=_0x4cbca5(0x32a);const _0x539171=_0x2ecce4[_0x4cbca5(0x272)][_0x4cbca5(0x1fc)][_0x4cbca5(0x3a5)];if(!_0x539171)_0x2ecce4[_0x4cbca5(0x2f5)](_0x4cbca5(0x366),{'publicKey':secure[_0x4cbca5(0x340)]});else{_0x47f7c2=timelyDecrypt(_0x539171,![]);if(!_0x47f7c2)_0x2ecce4[_0x4cbca5(0x2f5)](_0x4cbca5(0x366),{'publicKey':secure[_0x4cbca5(0x340)]});else{_0x1eb7cc=normalizeIP(_0x2ecce4[_0x4cbca5(0x247)]['remoteAddress'])[_0x4cbca5(0x20c)];if(!devices[_0x47f7c2])devices[_0x47f7c2]={'uuid':_0x47f7c2,'access':{'token':null}};devices[_0x47f7c2]['ip']=_0x1eb7cc;const _0x251ade=addClient(_0x2ecce4['id'],_0x47f7c2,_0xcfcf1a);setAccess(_0x251ade),emitMessages(),_0x2ecce4['on'](_0x4cbca5(0x196),_0x8f1f42=>{const _0x44e536=_0x4cbca5,_0x93f62=timelyDecrypt(_0x8f1f42['password'],!![],_0x44e536(0x229));if(_0x93f62){_0x8f1f42={'username':_0x8f1f42[_0x44e536(0x27f)],'password':_0x93f62},devices[_0x47f7c2][_0x44e536(0x363)]=validateCredentials(_0x8f1f42,_0x47f7c2);if(devices[_0x47f7c2][_0x44e536(0x363)][_0x44e536(0x368)]==![]&&devices[_0x47f7c2][_0x44e536(0x363)][_0x44e536(0x19d)]==_0x44e536(0x357))_0x2ecce4[_0x44e536(0x2f5)](_0x44e536(0x366),{'access':devices[_0x47f7c2][_0x44e536(0x363)]}),loginAccess2FA(_0x47f7c2,_0x1eb7cc);else{if(devices[_0x47f7c2]['access'][_0x44e536(0x368)]==![]&&devices[_0x47f7c2][_0x44e536(0x363)][_0x44e536(0x19d)]==_0x44e536(0x243))_0x2ecce4[_0x44e536(0x2f5)](_0x44e536(0x366),{'access':devices[_0x47f7c2]['access']});else devices[_0x47f7c2][_0x44e536(0x363)]['allow']&&devices[_0x47f7c2]['access'][_0x44e536(0x19d)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x47f7c2)['forEach'](_0xcb9c1b=>{setAccess(_0xcb9c1b);}),logger[_0x44e536(0x29e)](_0x44e536(0x2be)+_0x47f7c2[_0x44e536(0x25c)](-0x8)),setTokenRefresh(_0x47f7c2),setSessionTimeout(_0x44e536(0x196),_0x47f7c2));}}else logger[_0x44e536(0x2b5)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x2ecce4['on'](_0x4cbca5(0x2f8),()=>{resetPassword();}),_0x2ecce4['on'](_0x4cbca5(0x2b8),_0xd45202=>{removeClient(_0x2ecce4['id']);}),_0xcfcf1a=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x2fd6fe){const _0x3bedec=_0x4cb281;if(_0x2fd6fe!='botmanager'&&config[_0x3bedec(0x373)]!=''){if(pid[_0x2fd6fe])pid[_0x2fd6fe][_0x3bedec(0x19b)]({'function':_0x3bedec(0x1ff),'args':null});}_0x2fd6fe!=_0x3bedec(0x32a)&&broadcastToBots(_0x3bedec(0x1fd),JSON[_0x3bedec(0x28b)](config));}function reloadBotManager(){const _0x5cdce2=_0x4cb281;getClientsWithBotID(_0x5cdce2(0x32a))[_0x5cdce2(0x2f1)](_0x5eb0bf=>{const _0x634580=_0x5cdce2;getSocket(_0x5eb0bf['id'])['emit'](_0x634580(0x366),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x36b491){const _0x56f645=_0x4cb281,_0x303304=io[_0x56f645(0x219)]['get']('/');return _0x303304[_0x56f645(0x279)][_0x56f645(0x35c)](_0x36b491);}function setAccess(_0x5807a2){const _0x132613=_0x4cb281,_0x5c3aec=getSocket(_0x5807a2['id']),_0x5574a4=_0x5807a2['uuid'],_0x51b0f5=_0x5807a2[_0x132613(0x1d9)];devices[_0x5574a4]['access']=validateAccess(devices[_0x5574a4][_0x132613(0x363)]['token'],_0x5574a4),logger['debug'](_0x132613(0x249)+devices[_0x5574a4][_0x132613(0x363)][_0x132613(0x19d)]+_0x132613(0x1f1)+_0x5807a2['id'][_0x132613(0x25c)](-0x8)+_0x132613(0x33e)+_0x5574a4[_0x132613(0x25c)](-0x8)),_0x5c3aec[_0x132613(0x303)](_0x5574a4);if(devices[_0x5574a4][_0x132613(0x363)][_0x132613(0x368)]){_0x5c3aec[_0x132613(0x303)](_0x51b0f5);if(_0x51b0f5==_0x132613(0x32a))initializeSocketBotManager(_0x5c3aec);else initializeSocketBot(_0x5c3aec);initClient(_0x51b0f5);}devices[_0x5574a4][_0x132613(0x363)][_0x132613(0x351)]&&devices[_0x5574a4]['access'][_0x132613(0x19d)]==_0x132613(0x325)&&setSessionTimeout(_0x132613(0x38b),_0x5574a4),devices[_0x5574a4][_0x132613(0x363)][_0x132613(0x351)]&&devices[_0x5574a4][_0x132613(0x363)][_0x132613(0x19d)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x132613(0x196),_0x5574a4),_0x5c3aec[_0x132613(0x2f5)]('status',{'status':_0x5807a2[_0x132613(0x20d)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5574a4]['access'],'externalip':devices[_0x5574a4]['ip'],'publicKey':secure[_0x132613(0x340)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x5574a4][_0x132613(0x363)][_0x132613(0x368)]==![]&&devices[_0x5574a4][_0x132613(0x363)][_0x132613(0x19d)]==_0x132613(0x205)&&temporaryAccess2FA(_0x5574a4,devices[_0x5574a4]['ip']);}function setSessionTimeout(_0x2b7f10,_0x2d63ba){const _0x116994=_0x4cb281;let _0x54da4a;if(_0x2b7f10==_0x116994(0x196))_0x54da4a=loginExpiry*0x3c*0x3e8;else _0x54da4a=devices[_0x2d63ba][_0x116994(0x2ff)]['expiry']*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x2d63ba][_0x116994(0x2ff)][_0x116994(0x1c0)]);if(devices[_0x2d63ba][_0x116994(0x238)])clearTimeout(devices[_0x2d63ba][_0x116994(0x238)]);devices[_0x2d63ba][_0x116994(0x238)]=setTimeout(()=>{const _0x387623=_0x116994;if(devices[_0x2d63ba][_0x387623(0x38e)])clearTimeout(devices[_0x2d63ba][_0x387623(0x38e)]);removeSocketListeners(_0x2d63ba),addBlacklist(_0x2d63ba),devices[_0x2d63ba]['telegramIpApproval']=null,devices[_0x2d63ba]['telegram2FaApproval']=null,devices[_0x2d63ba][_0x387623(0x363)][_0x387623(0x351)]=null,logger[_0x387623(0x29e)](_0x387623(0x213)+_0x2d63ba[_0x387623(0x25c)](-0x8)),devices[_0x2d63ba][_0x387623(0x363)]=validateAccess(devices[_0x2d63ba]['access'][_0x387623(0x351)],_0x2d63ba),!(devices[_0x2d63ba][_0x387623(0x363)][_0x387623(0x368)]&&devices[_0x2d63ba]['access'][_0x387623(0x19d)]==_0x387623(0x1b6))&&(_0x2b7f10==_0x387623(0x196)?io['to'](_0x2d63ba)[_0x387623(0x2f5)](_0x387623(0x366),{'access':{'allow':![],'reason':_0x387623(0x289),'token':null}}):io['to'](_0x2d63ba)[_0x387623(0x2f5)](_0x387623(0x366),{'access':{'allow':![],'reason':_0x387623(0x394),'token':null}})),devices[_0x2d63ba][_0x387623(0x363)][_0x387623(0x351)]=null;},_0x54da4a);}function setTokenRefresh(_0x35f525){const _0x3d7626=_0x4cb281;if(devices[_0x35f525]['pidRefreshToken'])clearTimeout(devices[_0x35f525][_0x3d7626(0x38e)]);devices[_0x35f525][_0x3d7626(0x38e)]=setTimeout(()=>{const _0xf31f14=_0x3d7626;getClientsWithUuid(_0x35f525)[_0xf31f14(0x38c)]!=0x0?(devices[_0x35f525][_0xf31f14(0x363)]=refreshToken(_0x35f525),io['to'](_0x35f525)[_0xf31f14(0x2f5)]('status',{'status':_0xf31f14(0x32f),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x35f525]['access'],'externalip':devices[_0x35f525]['ip'],'publicKey':secure[_0xf31f14(0x340)],'validInstallation':validInstallation}),setTokenRefresh(_0x35f525)):clearTimeout(devices[_0x35f525][_0xf31f14(0x38e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1ae56d){const _0x3d737d=_0x4cb281,_0x58e55d=getClient(_0x1ae56d['id'])['uuid'];_0x1ae56d[_0x3d737d(0x2f5)]('bots',config),_0x1ae56d[_0x3d737d(0x2f5)](_0x3d737d(0x1ef),cleanSettings()),_0x1ae56d['on'](_0x3d737d(0x2bc),_0x23418a=>{const _0x243f04=_0x3d737d;if(validateAccess(_0x23418a,_0x58e55d)[_0x243f04(0x368)])addBot();else logger[_0x243f04(0x2b5)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x1ae56d['on'](_0x3d737d(0x2dd),(_0x425e6e,_0x4a7576)=>{const _0x1b95af=_0x3d737d;if(validateAccess(_0x4a7576,_0x58e55d)[_0x1b95af(0x368)])toggleBot(_0x425e6e[_0x1b95af(0x2df)],_0x425e6e[_0x1b95af(0x366)],_0x425e6e[_0x1b95af(0x342)]);else logger[_0x1b95af(0x2b5)](_0x1b95af(0x333));}),_0x1ae56d['on'](_0x3d737d(0x23a),(_0x307407,_0x461740)=>{const _0x2bc2ba=_0x3d737d;if(validateAccess(_0x461740,_0x58e55d)[_0x2bc2ba(0x368)])toggleBotMode(_0x307407);else logger[_0x2bc2ba(0x2b5)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x1ae56d['on']('delete-bot',(_0x123d79,_0x47e4d5)=>{if(validateAccess(_0x47e4d5,_0x58e55d)['allow'])deleteBot(_0x123d79);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x1ae56d['on'](_0x3d737d(0x3aa),(_0xd9f7a4,_0xb23c0b)=>{const _0x3f477e=_0x3d737d;if(validateAccess(_0xb23c0b,_0x58e55d)[_0x3f477e(0x368)])storeSettings(_0xd9f7a4,!![]);else logger[_0x3f477e(0x2b5)](_0x3f477e(0x1bd));}),_0x1ae56d['on'](_0x3d737d(0x201),_0x57c08c=>{const _0x2473da=_0x3d737d;if(validateAccess(_0x57c08c,_0x58e55d)[_0x2473da(0x368)])updateBB(_0x2473da(0x399));else logger['full'](_0x2473da(0x1ea));}),_0x1ae56d['on'](_0x3d737d(0x326),_0x336ec2=>{const _0x27150c=_0x3d737d;if(validateAccess(_0x336ec2,_0x58e55d)[_0x27150c(0x368)])updateBB('reinstall');else logger[_0x27150c(0x2b5)](_0x27150c(0x214));}),_0x1ae56d['on']('get-backup-files',_0x4429ab=>{const _0x48d0fe=_0x3d737d;if(validateAccess(_0x4429ab,_0x58e55d)[_0x48d0fe(0x368)]){const _0xf121cf=getClient(_0x1ae56d['id']);if(_0xf121cf)getBackupFiles(_0xf121cf[_0x48d0fe(0x221)]);else logger[_0x48d0fe(0x2b5)](_0x48d0fe(0x211));}else logger['full'](_0x48d0fe(0x2ca));}),_0x1ae56d['on'](_0x3d737d(0x24a),(_0x49620e,_0x51cad5)=>{const _0x3a90ec=_0x3d737d;if(validateAccess(_0x51cad5,_0x58e55d)[_0x3a90ec(0x368)])restoreBackupFile(_0x49620e);else logger[_0x3a90ec(0x2b5)](_0x3a90ec(0x2d9));}),_0x1ae56d['on']('get-messages',_0x103a01=>{const _0x5b174e=_0x3d737d;if(validateAccess(_0x103a01,_0x58e55d)[_0x5b174e(0x368)])getMessages();else logger[_0x5b174e(0x2b5)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1ae56d['on'](_0x3d737d(0x22c),(_0x1d215c,_0x5ea548)=>{const _0x31f3cd=_0x3d737d;if(validateAccess(_0x5ea548,_0x58e55d)['allow'])confirmMessage(_0x1d215c);else logger[_0x31f3cd(0x2b5)](_0x31f3cd(0x1cb));}),_0x1ae56d['on'](_0x3d737d(0x1dc),_0xfc3456=>{const _0x1d6446=_0x3d737d;if(validateAccess(_0xfc3456,_0x58e55d)[_0x1d6446(0x368)]){if(devices[_0x58e55d][_0x1d6446(0x38e)])clearTimeout(devices[_0x58e55d][_0x1d6446(0x38e)]);if(devices[_0x58e55d][_0x1d6446(0x238)])clearTimeout(devices[_0x58e55d][_0x1d6446(0x238)]);removeSocketListeners(getClient(_0x1ae56d['id'])[_0x1d6446(0x221)]),addBlacklist(_0x58e55d),devices[_0x58e55d][_0x1d6446(0x2ff)]=null,devices[_0x58e55d][_0x1d6446(0x207)]=null,devices[_0x58e55d][_0x1d6446(0x363)][_0x1d6446(0x351)]=null,logger[_0x1d6446(0x29e)](_0x1d6446(0x2e3)+_0x58e55d[_0x1d6446(0x25c)](-0x8)),io['to'](getClient(_0x1ae56d['id'])[_0x1d6446(0x221)])['emit'](_0x1d6446(0x366),{'access':{'allow':![],'reason':_0x1d6446(0x397),'token':null}});}else logger['full'](_0x1d6446(0x381));});}function initializeSocketBot(_0x52e027){const _0x407a9a=_0x4cb281,_0x3f6dc4=getClient(_0x52e027['id'])[_0x407a9a(0x1d9)],_0x3a90d3=getClient(_0x52e027['id'])[_0x407a9a(0x221)];_0x52e027['on'](_0x407a9a(0x396),(_0x3136f5,_0x57486a)=>{const _0x3bebe1=_0x407a9a;if(validateAccess(_0x57486a,_0x3a90d3)[_0x3bebe1(0x368)]){if(pid[_0x3f6dc4])pid[_0x3f6dc4][_0x3bebe1(0x19b)]({'function':_0x3bebe1(0x26a),'args':_0x3136f5});}else logger[_0x3bebe1(0x2b5)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x52e027['on'](_0x407a9a(0x350),(_0xd8b27d,_0x50c22f)=>{const _0x3a5aab=_0x407a9a;if(validateAccess(_0x50c22f,_0x3a90d3)['allow']){if(pid[_0x3f6dc4])pid[_0x3f6dc4][_0x3a5aab(0x19b)]({'function':_0x3a5aab(0x390),'args':_0xd8b27d});}else logger[_0x3a5aab(0x2b5)](_0x3a5aab(0x273));}),_0x52e027['on'](_0x407a9a(0x28e),(_0x10d777,_0x57c3d9)=>{const _0xe9f2f3=_0x407a9a;if(validateAccess(_0x57c3d9,_0x3a90d3)[_0xe9f2f3(0x368)]){if(pid[_0x3f6dc4])pid[_0x3f6dc4]['send']({'function':_0xe9f2f3(0x31e),'args':_0x10d777});}else logger['full'](_0xe9f2f3(0x322));}),_0x52e027['on'](_0x407a9a(0x352),(_0x54dbf9,_0x3ca116)=>{const _0x20b5d4=_0x407a9a;if(validateAccess(_0x3ca116,_0x3a90d3)[_0x20b5d4(0x368)]){if(pid[_0x3f6dc4])pid[_0x3f6dc4]['send']({'function':_0x20b5d4(0x2a8),'args':_0x54dbf9});}else logger[_0x20b5d4(0x2b5)](_0x20b5d4(0x341));}),_0x52e027['on'](_0x407a9a(0x1ad),(_0x294d3f,_0x34ad56)=>{const _0x4dc333=_0x407a9a;if(validateAccess(_0x34ad56,_0x3a90d3)[_0x4dc333(0x368)]){if(pid[_0x3f6dc4])pid[_0x3f6dc4]['send']({'function':_0x4dc333(0x265),'args':_0x294d3f});}else logger[_0x4dc333(0x2b5)](_0x4dc333(0x36a));}),_0x52e027['on'](_0x407a9a(0x244),(_0x45fd6e,_0x1cb59d)=>{const _0x3e7ab3=_0x407a9a;if(validateAccess(_0x1cb59d,_0x3a90d3)[_0x3e7ab3(0x368)]){if(pid[_0x3f6dc4])pid[_0x3f6dc4][_0x3e7ab3(0x19b)]({'function':_0x3e7ab3(0x26d),'args':_0x45fd6e});}else logger['full'](_0x3e7ab3(0x349));}),_0x52e027['on']('reset-history',_0x264bb4=>{const _0xa8da8a=_0x407a9a;if(validateAccess(_0x264bb4,_0x3a90d3)['allow']){if(pid[_0x3f6dc4])pid[_0x3f6dc4][_0xa8da8a(0x19b)]({'function':'resetHistory','args':null});}else logger[_0xa8da8a(0x2b5)](_0xa8da8a(0x393));}),_0x52e027['on'](_0x407a9a(0x1a3),_0x32ec7d=>{const _0x5ad2c0=_0x407a9a;if(validateAccess(_0x32ec7d,_0x3a90d3)[_0x5ad2c0(0x368)]){if(pid[_0x3f6dc4])pid[_0x3f6dc4][_0x5ad2c0(0x19b)]({'function':_0x5ad2c0(0x33f),'args':null});}else logger[_0x5ad2c0(0x2b5)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x52e027['on'](_0x407a9a(0x1e2),(_0x1729b7,_0x925c02)=>{const _0x452799=_0x407a9a;if(validateAccess(_0x925c02,_0x3a90d3)[_0x452799(0x368)]){if(pid[_0x3f6dc4])pid[_0x3f6dc4][_0x452799(0x19b)]({'function':_0x452799(0x385),'args':_0x1729b7});}else logger[_0x452799(0x2b5)](_0x452799(0x2c2));}),_0x52e027['on'](_0x407a9a(0x2c0),_0x182c91=>{const _0x2d354e=_0x407a9a;if(validateAccess(_0x182c91,_0x3a90d3)[_0x2d354e(0x368)]){if(pid[_0x3f6dc4])pid[_0x3f6dc4][_0x2d354e(0x19b)]({'function':_0x2d354e(0x2b0),'args':null});}else logger[_0x2d354e(0x2b5)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x52e027['on']('show-config',_0x37c993=>{const _0x238a98=_0x407a9a;if(validateAccess(_0x37c993,_0x3a90d3)['allow']){if(pid[_0x3f6dc4])pid[_0x3f6dc4][_0x238a98(0x19b)]({'function':_0x238a98(0x2e2),'args':null});}else logger['full'](_0x238a98(0x32e));}),_0x52e027['on'](_0x407a9a(0x201),_0x35a701=>{const _0x27f36d=_0x407a9a;if(validateAccess(_0x35a701,_0x3a90d3)[_0x27f36d(0x368)])updateBB(_0x27f36d(0x399));else logger[_0x27f36d(0x2b5)](_0x27f36d(0x1ea));}),_0x52e027['on'](_0x407a9a(0x379),_0x596b44=>{const _0x5316e0=_0x407a9a;if(validateAccess(_0x596b44,_0x3a90d3)[_0x5316e0(0x368)])getMessages();else logger[_0x5316e0(0x2b5)](_0x5316e0(0x199));}),_0x52e027['on'](_0x407a9a(0x22c),(_0x2a29b3,_0xdce82)=>{const _0x197893=_0x407a9a;if(validateAccess(_0xdce82,_0x3a90d3)['allow'])confirmMessage(_0x2a29b3);else logger[_0x197893(0x2b5)](_0x197893(0x1cb));}),_0x52e027['on'](_0x407a9a(0x1dc),_0x46e306=>{const _0x4b24af=_0x407a9a;if(validateAccess(_0x46e306,_0x3a90d3)[_0x4b24af(0x368)]){if(devices[_0x3a90d3][_0x4b24af(0x38e)])clearTimeout(devices[_0x3a90d3]['pidRefreshToken']);if(devices[_0x3a90d3][_0x4b24af(0x238)])clearTimeout(devices[_0x3a90d3][_0x4b24af(0x238)]);removeSocketListeners(getClient(_0x52e027['id'])[_0x4b24af(0x221)]),addBlacklist(_0x3a90d3),devices[_0x3a90d3][_0x4b24af(0x2ff)]=null,devices[_0x3a90d3][_0x4b24af(0x207)]=null,devices[_0x3a90d3]['access'][_0x4b24af(0x351)]=null,logger[_0x4b24af(0x29e)](_0x4b24af(0x2e3)+_0x3a90d3[_0x4b24af(0x25c)](-0x8)),io['to'](getClient(_0x52e027['id'])[_0x4b24af(0x221)])[_0x4b24af(0x2f5)]('status',{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x4b24af(0x2b5)](_0x4b24af(0x381));});}function removeSocketListeners(_0x44a788){const _0x3c773f=_0x4cb281;getClientsWithUuid(_0x44a788)[_0x3c773f(0x2f1)](_0x317622=>{getSocket(_0x317622['id'])['removeAllListeners']();});}function cleanSettings(){const _0x12aa0d=_0x4cb281;let _0x562dcc=settings;return settings[_0x12aa0d(0x288)]&&settings['telegramToken']!=''&&(_0x562dcc={..._0x562dcc,'telegramToken':_0x12aa0d(0x21c)}),settings['bbPassword']&&settings['bbPassword']!=''&&(_0x562dcc={..._0x562dcc,'bbPassword':_0x12aa0d(0x21c)}),settings['marketcapApi']&&settings['marketcapApi']!=''&&(_0x562dcc={..._0x562dcc,'marketcapApi':_0x12aa0d(0x21c)}),(settings[_0x12aa0d(0x2c9)]&&settings['bbPassword']=='***'||settings['telegramToken']&&settings[_0x12aa0d(0x288)]==_0x12aa0d(0x191)||settings[_0x12aa0d(0x1c1)]&&settings[_0x12aa0d(0x1c1)]==_0x12aa0d(0x191))&&(_0x562dcc={..._0x562dcc,'restored':{'password':settings['bbPassword']==_0x12aa0d(0x191),'telegram':settings['telegramToken']=='***','marketcap':settings[_0x12aa0d(0x1c1)]==_0x12aa0d(0x191)}}),_0x562dcc;}async function updateBB(_0x327920){const _0x1c3fd5=_0x4cb281;await backupConfigFiles(),installingUpdate=!![],config[_0x1c3fd5(0x2f1)](_0x28e087=>{const _0x49460d=_0x1c3fd5;restartBot(_0x28e087[_0x49460d(0x2df)]);});if(_0x327920=='update')process[_0x1c3fd5(0x19b)]({'update':!![],'environment':environment},_0x11efb3=>{});else _0x327920=='reinstall'&&process[_0x1c3fd5(0x19b)]({'reinstall':!![],'environment':environment},_0x33bc52=>{});}function startBot(_0xd8da9f,_0x5f8935,_0x203ee6){const _0x1b95f2=_0x4cb281;if(debugging)_0xd8da9f[_0x1b95f2(0x2de)]('-d');let _0x208f15=![];const _0x866b25=_0xd8da9f[0x0];_0x5f8935={..._0x5f8935,'stdio':[_0x1b95f2(0x2f4),'inherit','inherit',_0x1b95f2(0x2f3)]},pid[_0x866b25]=childProcess[_0x1b95f2(0x21e)](botfile,_0xd8da9f,_0x5f8935),pid[_0x866b25]['on'](_0x1b95f2(0x2e8),_0x40d536=>{const _0x3b26ce=_0x1b95f2;switch(Object[_0x3b26ce(0x28c)](_0x40d536)[0x0]){case _0x3b26ce(0x27e):updateBotName(_0x866b25,_0x40d536['botname']);break;case _0x3b26ce(0x263):updateBotManager();break;case _0x3b26ce(0x366):updateStatus(_0x866b25,_0x40d536[_0x3b26ce(0x366)]);break;case _0x3b26ce(0x342):updateLive(_0x866b25,_0x40d536[_0x3b26ce(0x342)]);break;case'started':updateLive(_0x866b25,_0x40d536[_0x3b26ce(0x301)]),io['to'](_0x866b25)[_0x3b26ce(0x2f5)](_0x3b26ce(0x366),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x3b26ce(0x1ed):_0x40d536[_0x3b26ce(0x1ed)]==_0x3b26ce(0x320)&&restartBot(_0x866b25);_0x40d536['stop']==_0x3b26ce(0x384)&&toggleBot(_0x866b25,_0x3b26ce(0x392),_0x3b26ce(0x37f));break;case _0x3b26ce(0x1ba):sendTelegramBot(_0x866b25,_0x40d536[_0x3b26ce(0x1ba)]);break;case _0x3b26ce(0x1bb):sendTelegramMsg(_0x40d536[_0x3b26ce(0x1bb)]);break;case _0x3b26ce(0x21d):io['to'](_0x866b25)[_0x3b26ce(0x2f5)](_0x40d536[_0x3b26ce(0x21d)],_0x40d536[_0x3b26ce(0x1f8)]);break;}}),pid[_0x866b25]['on']('error',function(_0x3f9c86){if(_0x208f15)return;_0x208f15=!![],_0x203ee6(_0x3f9c86);}),pid[_0x866b25]['on'](_0x1b95f2(0x37c),async function(_0x2fd5c1){const _0x130b71=_0x1b95f2;if(terminating)return;if(installingUpdate){io[_0x130b71(0x378)]();return;}if(_0x208f15)return;_0x208f15=!![],_0x203ee6(null);const _0x4aea45=dbConfig[_0x130b71(0x35c)]('bots')['find']({'botID':_0x866b25})[_0x130b71(0x345)]();_0x4aea45&&(_0x4aea45[_0x130b71(0x366)]==_0x130b71(0x2d6)||_0x4aea45[_0x130b71(0x366)]==_0x130b71(0x31c))&&(await sleep(0x3e8),updateLive(_0x866b25,'stopped'),logger[_0x130b71(0x2b5)](_0x130b71(0x3ae)+_0x866b25),startBot([_0x866b25,userID],{'cwd':bbpath},function(_0x56efc){const _0x4d4027=_0x130b71;if(_0x56efc)logger[_0x4d4027(0x2b5)](_0x56efc);}));});}function stopBot(_0x3ff006){getClientsWithBotID(_0x3ff006)['forEach'](_0x310a1b=>{getSocket(_0x310a1b['id'])['disconnect'](!![]),removeClient(_0x310a1b['id']);}),pid[_0x3ff006]&&(pid[_0x3ff006]['kill'](),pid[_0x3ff006]=null);}function stopAllBots(){const _0x4e177b=_0x4cb281;terminating=!![];const _0x45fe9c=getEnabledBots();_0x45fe9c[_0x4e177b(0x2f1)](_0x283c1a=>{const _0x36e5bb=_0x4e177b;stopBot(_0x283c1a[_0x36e5bb(0x2df)]);});}function restartBot(_0x2a45b6){if(pid[_0x2a45b6])pid[_0x2a45b6]['kill']();}function addBot(){const _0x39a065=_0x4cb281;let _0x591e98;for(let _0x5a531d=0x1;_0x5a531d<0x3e9;_0x5a531d++){_0x591e98=_0x5a531d[_0x39a065(0x1cc)]()['padStart'](0x3,'0');let _0x451bfa=config[_0x39a065(0x217)](_0x44413e=>_0x44413e[_0x39a065(0x2df)]==_0x591e98);if(!_0x451bfa)break;}if(_0x591e98===_0x39a065(0x2c4)){logger[_0x39a065(0x2b5)](_0x39a065(0x291));return;}logger[_0x39a065(0x2b5)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x591e98),dbConfig[_0x39a065(0x35c)](_0x39a065(0x1fd))[_0x39a065(0x2de)]({'botID':_0x591e98,'botname':_0x39a065(0x37b)+_0x591e98,'status':_0x39a065(0x31c),'live':''})['write'](),startBot([_0x591e98,userID],{'cwd':bbpath},function(_0x5dfef0){if(_0x5dfef0)logger['full'](_0x5dfef0);}),config=getConfiguration(),io['to']('botmanager')[_0x39a065(0x2f5)]('bots',config),broadcastToBots(_0x39a065(0x1fd),JSON[_0x39a065(0x28b)](config));}function deleteBot(_0x748860){const _0x3dd76d=_0x4cb281;getClientsWithBotID(_0x748860)[_0x3dd76d(0x2f1)](_0x49cd16=>{const _0x1cf23c=_0x3dd76d;getSocket(_0x49cd16['id'])[_0x1cf23c(0x2b8)](!![]),removeClient(_0x49cd16['id']);}),dbConfig[_0x3dd76d(0x35c)]('bots')[_0x3dd76d(0x287)]({'botID':_0x748860})[_0x3dd76d(0x261)](),logger[_0x3dd76d(0x2b5)](_0x3dd76d(0x28d)+_0x748860),stopBot(_0x748860);try{if(fs['existsSync'](path[_0x3dd76d(0x303)](configpath,_0x3dd76d(0x240)+_0x748860+_0x3dd76d(0x2e0))))fs[_0x3dd76d(0x2d8)](path['join'](configpath,_0x3dd76d(0x240)+_0x748860+_0x3dd76d(0x2e0)));if(fs[_0x3dd76d(0x30b)](path[_0x3dd76d(0x303)](configpath,'bot-'+_0x748860+_0x3dd76d(0x271))))fs[_0x3dd76d(0x2d8)](path[_0x3dd76d(0x303)](configpath,_0x3dd76d(0x240)+_0x748860+_0x3dd76d(0x271)));if(fs['existsSync'](path[_0x3dd76d(0x303)](configpath,'bot-'+_0x748860+'-performance.json')))fs['unlinkSync'](path[_0x3dd76d(0x303)](configpath,'bot-'+_0x748860+_0x3dd76d(0x215)));if(fs[_0x3dd76d(0x30b)](path[_0x3dd76d(0x303)](configpath,'bot-'+_0x748860+_0x3dd76d(0x1d4))))fs['unlinkSync'](path[_0x3dd76d(0x303)](configpath,_0x3dd76d(0x240)+_0x748860+_0x3dd76d(0x1d4)));}catch(_0x2fe43e){if(_0x2fe43e)logger[_0x3dd76d(0x2b5)](_0x3dd76d(0x36b),_0x2fe43e);}config=getConfiguration(),io['to'](_0x3dd76d(0x32a))['emit'](_0x3dd76d(0x1fd),config),broadcastToBots('bots',JSON[_0x3dd76d(0x28b)](config));}function toggleBot(_0xa9a91e,_0x2205e9,_0xcdbeb5){const _0x46c16b=_0x4cb281;dbConfig[_0x46c16b(0x35c)](_0x46c16b(0x1fd))[_0x46c16b(0x217)]({'botID':_0xa9a91e})['assign']({'status':_0x2205e9})[_0x46c16b(0x222)]({'live':_0xcdbeb5})['write']();if(_0x2205e9==_0x46c16b(0x2d6)||_0x2205e9==_0x46c16b(0x31c))logger[_0x46c16b(0x2b5)](_0x46c16b(0x24d)+_0xa9a91e),startBot([_0xa9a91e,userID],{'cwd':bbpath},function(_0x3a040d){if(_0x3a040d)logger['full'](_0x3a040d);});else(_0x2205e9==_0x46c16b(0x392)||_0x2205e9==_0x46c16b(0x2cb))&&(logger[_0x46c16b(0x2b5)](_0x46c16b(0x1ab)+_0xa9a91e),stopBot(_0xa9a91e));config=getConfiguration(),io['to'](_0x46c16b(0x32a))['emit'](_0x46c16b(0x1fd),config),broadcastToBots(_0x46c16b(0x1fd),JSON['stringify'](config));}function toggleStatus(_0x525259){const _0x107b66=_0x4cb281;let _0x1b122e=dbConfig[_0x107b66(0x35c)](_0x107b66(0x1fd))[_0x107b66(0x217)]({'botID':_0x525259})[_0x107b66(0x345)](),_0x2560c7;if(_0x1b122e[_0x107b66(0x366)]===_0x107b66(0x2d6))_0x2560c7=_0x107b66(0x392);else{if(_0x1b122e[_0x107b66(0x366)]===_0x107b66(0x31c))_0x2560c7='new-disabled';else{if(_0x1b122e[_0x107b66(0x366)]===_0x107b66(0x2cb))_0x2560c7=_0x107b66(0x31c);else{if(_0x1b122e[_0x107b66(0x366)]==='disabled')_0x2560c7=_0x107b66(0x2d6);}}}return _0x2560c7;}function updateStatus(_0x27a484,_0xa6e57){const _0x710592=_0x4cb281;dbConfig['get'](_0x710592(0x1fd))['find']({'botID':_0x27a484})[_0x710592(0x222)]({'status':_0xa6e57})[_0x710592(0x261)](),config=getConfiguration(),io['to'](_0x710592(0x32a))[_0x710592(0x2f5)](_0x710592(0x1fd),config),broadcastToBots(_0x710592(0x1fd),JSON[_0x710592(0x28b)](config));}function updateLive(_0x571b03,_0x5c9cb6){const _0x54f09c=_0x4cb281;dbConfig[_0x54f09c(0x35c)](_0x54f09c(0x1fd))[_0x54f09c(0x217)]({'botID':_0x571b03})[_0x54f09c(0x222)]({'live':_0x5c9cb6})[_0x54f09c(0x261)](),config=getConfiguration(),io['to'](_0x54f09c(0x32a))[_0x54f09c(0x2f5)](_0x54f09c(0x1fd),config),broadcastToBots(_0x54f09c(0x1fd),JSON[_0x54f09c(0x28b)](config));}function updateBotName(_0x43738e,_0x3eb5c6){const _0x255ed6=_0x4cb281;dbConfig[_0x255ed6(0x35c)](_0x255ed6(0x1fd))[_0x255ed6(0x217)]({'botID':_0x43738e})[_0x255ed6(0x222)]({'botname':_0x3eb5c6})[_0x255ed6(0x261)](),config=getConfiguration(),io['to'](_0x255ed6(0x32a))[_0x255ed6(0x2f5)](_0x255ed6(0x1fd),config),broadcastToBots(_0x255ed6(0x1fd),JSON[_0x255ed6(0x28b)](config));}function updateBotManager(){const _0x25211d=_0x4cb281;config=getConfiguration(),io['to'](_0x25211d(0x32a))[_0x25211d(0x2f5)](_0x25211d(0x1fd),config),broadcastToBots(_0x25211d(0x1fd),JSON['stringify'](config));}function toggleBotMode(_0x52a1ef){const _0x227c99=_0x4cb281;if(pid[_0x52a1ef])pid[_0x52a1ef][_0x227c99(0x19b)]({'function':_0x227c99(0x193),'args':null});else{const _0x39ceb8=configpath+_0x227c99(0x240)+_0x52a1ef+_0x227c99(0x2e0),_0x22bb58=fs['readFileSync'](_0x39ceb8),_0xd729d2=JSON[_0x227c99(0x228)](_0x22bb58),_0x45f1f0=_0xd729d2[_0x227c99(0x1d9)][0x0][_0x227c99(0x382)];_0xd729d2[_0x227c99(0x1d9)][0x0][_0x227c99(0x382)]=!_0x45f1f0;const _0x4c6d70=JSON[_0x227c99(0x28b)](_0xd729d2,null,0x2);fs['writeFileSync'](_0x39ceb8,_0x4c6d70),config=getConfiguration(),io['to'](_0x227c99(0x32a))['emit'](_0x227c99(0x1fd),config),broadcastToBots('bots',JSON['stringify'](config));}}function validateTelegram(_0x38cd4a){const _0x9fef56=_0x4cb281;if(_0x38cd4a['from'][_0x9fef56(0x27f)]!=settings['telegramUsername']&&'@'+_0x38cd4a[_0x9fef56(0x2d5)][_0x9fef56(0x27f)]!=settings[_0x9fef56(0x36f)]||_0x38cd4a[_0x9fef56(0x292)]['id']!=settings[_0x9fef56(0x2a5)])return sendTelegram(_0x38cd4a[_0x9fef56(0x292)]['id'],_0x9fef56(0x2ac),{'parse_mode':_0x9fef56(0x28a)}),![];return!![];}async function initTelegram(){const _0x178fd5=_0x4cb281;tgBot&&(await tgBot[_0x178fd5(0x1ed)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x178fd5(0x288)]);let _0x19c678=_0x178fd5(0x2e9);_0x19c678+='\x0a',_0x19c678+=_0x178fd5(0x309),_0x19c678+=_0x178fd5(0x286),_0x19c678+=_0x178fd5(0x31a),_0x19c678+=_0x178fd5(0x3b1),_0x19c678+='/on\x20-\x20start\x20bot(s)\x0a',_0x19c678+='/off\x20-\x20stop\x20bot(s)\x0a',_0x19c678+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x19c678+=_0x178fd5(0x2d4),_0x19c678+=_0x178fd5(0x376),_0x19c678+=_0x178fd5(0x328),_0x19c678+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x19c678+=_0x178fd5(0x1f5),_0x19c678+=_0x178fd5(0x367),_0x19c678+=_0x178fd5(0x1d5),_0x19c678+=_0x178fd5(0x2d3),_0x19c678+=_0x178fd5(0x2cd);let _0x3814d8=_0x178fd5(0x2ae);_0x3814d8+='\x0a',_0x3814d8+=_0x19c678,tgBot[_0x178fd5(0x330)]((_0x2a0cc3,_0x52ee22)=>{const _0x40f912=_0x178fd5;logger[_0x40f912(0x2d1)](getTimeStamp()+_0x40f912(0x315)),logger[_0x40f912(0x29e)](_0x40f912(0x20e),_0x2a0cc3);}),tgBot[_0x178fd5(0x230)](async(_0x25b46d,_0x3af71f)=>{const _0x23fe2a=_0x178fd5;if(!(!settings[_0x23fe2a(0x2a5)]&&_0x25b46d['update'][_0x23fe2a(0x2e8)][_0x23fe2a(0x37d)]==_0x23fe2a(0x3ab))){if(!validateTelegram(_0x25b46d))return;}_0x3af71f();}),tgBot['command'](_0x178fd5(0x306),async _0xce36a9=>{const _0x17ad86=_0x178fd5;if(_0xce36a9[_0x17ad86(0x2d5)][_0x17ad86(0x27f)]==settings[_0x17ad86(0x36f)]||'@'+_0xce36a9['from'][_0x17ad86(0x27f)]==settings[_0x17ad86(0x36f)]){if(!settings[_0x17ad86(0x2a5)])updateSetting(_0x17ad86(0x2a5),_0xce36a9[_0x17ad86(0x292)]['id']);}if(!validateTelegram(_0xce36a9))return;updateSetting('telegramEnabled',!![]),await sendTelegram(_0xce36a9[_0x17ad86(0x292)]['id'],_0x3814d8);}),tgBot[_0x178fd5(0x19c)](_0x178fd5(0x22f),async _0x459da3=>{const _0x18a7cf=_0x178fd5;updateSetting(_0x18a7cf(0x3af),!![]),await sendTelegram(_0x459da3[_0x18a7cf(0x292)]['id'],_0x18a7cf(0x1a5));}),tgBot['command'](_0x178fd5(0x318),async _0x576a5e=>{const _0x31c876=_0x178fd5;await sendTelegram(_0x576a5e['chat']['id'],_0x31c876(0x2a6)),updateSetting(_0x31c876(0x3af),![]);}),tgBot['command'](_0x178fd5(0x1df),async _0x177919=>{const _0x20afd6=_0x178fd5,_0x19d8b6=Markup['inlineKeyboard']([Markup[_0x20afd6(0x2ec)][_0x20afd6(0x2a7)]('Orders',_0x20afd6(0x332)),Markup[_0x20afd6(0x2ec)][_0x20afd6(0x2a7)](_0x20afd6(0x339),_0x20afd6(0x2a2)),Markup[_0x20afd6(0x2ec)][_0x20afd6(0x2a7)]('All',_0x20afd6(0x2bd))]);_0x177919['reply'](_0x20afd6(0x257),_0x19d8b6);}),tgBot[_0x178fd5(0x26b)]('config_orders',async _0x1f48d4=>{const _0x5cd118=_0x178fd5;_0x1f48d4[_0x5cd118(0x225)](),updateSetting(_0x5cd118(0x35b),_0x5cd118(0x346)),updateSetting(_0x5cd118(0x3af),!![]),await sendTelegram(_0x1f48d4['chat']['id'],_0x5cd118(0x36d));}),tgBot[_0x178fd5(0x26b)]('config_alerts',async _0x235dbf=>{const _0x2176f7=_0x178fd5;_0x235dbf[_0x2176f7(0x225)](),updateSetting('telegramEvents',_0x2176f7(0x209)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x235dbf[_0x2176f7(0x292)]['id'],_0x2176f7(0x39f));}),tgBot[_0x178fd5(0x26b)]('config_all',async _0x3d9ac0=>{const _0x3243fa=_0x178fd5;_0x3d9ac0[_0x3243fa(0x225)](),updateSetting(_0x3243fa(0x35b),_0x3243fa(0x1bf)),updateSetting(_0x3243fa(0x3af),!![]),await sendTelegram(_0x3d9ac0[_0x3243fa(0x292)]['id'],_0x3243fa(0x259));}),tgBot[_0x178fd5(0x19c)](_0x178fd5(0x366),async _0x1adf46=>{const _0x5700de=_0x178fd5,_0x41853c=getBotsWithMode();let _0x2bcf99=_0x5700de(0x208);config[_0x5700de(0x2f1)](_0x8a1788=>{const _0xa8755f=_0x5700de,_0x36c4b2=_0x41853c[_0xa8755f(0x217)](_0x17b8b7=>_0x17b8b7[_0xa8755f(0x2df)]==_0x8a1788[_0xa8755f(0x2df)])['mode'];_0x2bcf99+='Bot\x20'+_0x8a1788[_0xa8755f(0x2df)]+':\x20'+_0x8a1788['status']+_0xa8755f(0x190)+_0x36c4b2+_0xa8755f(0x190)+_0x8a1788['live']+'\x0a';}),_0x2bcf99+='\x0a',_0x2bcf99+=_0x5700de(0x305),_0x2bcf99+=!settings[_0x5700de(0x3af)]?_0x5700de(0x1f6):_0x5700de(0x300),_0x2bcf99+=settings[_0x5700de(0x3af)]?settings[_0x5700de(0x35b)]=='all'?_0x5700de(0x267):_0x5700de(0x27c)+settings[_0x5700de(0x35b)]+'\x20only\x0a':'',await sendTelegram(_0x1adf46[_0x5700de(0x292)]['id'],_0x2bcf99,{'parse_mode':_0x5700de(0x28a)});}),tgBot['command'](_0x178fd5(0x320),async _0x5d5302=>{const _0x824d4=_0x178fd5,_0x4f95ed=getEnabledBots();if(_0x4f95ed[_0x824d4(0x38c)]==0x0)await sendTelegram(_0x5d5302['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x4f95ed[_0x824d4(0x38c)]>0x1)_0x4f95ed[_0x824d4(0x2de)]({'botID':_0x824d4(0x1bf)});let _0x5ef65d=[],_0x24665d=[];const _0x3ec116=_0x4f95ed[_0x824d4(0x38c)]%0x4==0x0||_0x4f95ed[_0x824d4(0x38c)]%0x4==0x3||_0x4f95ed[_0x824d4(0x38c)]%0x3==0x1?0x4:0x3;let _0x229e2e=0x0;_0x4f95ed[_0x824d4(0x2f1)]((_0x52e4ee,_0x542528)=>{const _0x2cefe5=_0x824d4;if(_0x542528%_0x3ec116==0x0)_0x24665d=[];_0x24665d[_0x2cefe5(0x2de)](Markup[_0x2cefe5(0x2ec)][_0x2cefe5(0x2a7)](_0x52e4ee[_0x2cefe5(0x2df)]==_0x2cefe5(0x1bf)?'All\x20bots':_0x2cefe5(0x37b)+_0x52e4ee[_0x2cefe5(0x2df)],_0x2cefe5(0x1b9)+_0x52e4ee[_0x2cefe5(0x2df)])),_0x542528%_0x3ec116==0x0&&(_0x5ef65d[_0x229e2e]=_0x24665d,_0x229e2e++);});const _0x5b5ffd=Markup[_0x824d4(0x29b)](_0x5ef65d);_0x5d5302['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x5b5ffd);}}),tgBot[_0x178fd5(0x26b)](/restart_(.+)/,async _0x332c2e=>{const _0xec5fd9=_0x178fd5,_0x4b43ab=_0x332c2e['match'][0x1];_0x332c2e['editMessageReplyMarkup'](),_0x4b43ab==_0xec5fd9(0x1bf)?config[_0xec5fd9(0x2f1)](_0x53cb0a=>{const _0x3674bc=_0xec5fd9;restartBot(_0x53cb0a[_0x3674bc(0x2df)]);}):restartBot(_0x4b43ab);}),tgBot[_0x178fd5(0x19c)]('on',async _0x4fb77e=>{const _0x5a8f4b=_0x178fd5,_0x225646=getDisabledBots();if(_0x225646['length']==0x0)await sendTelegram(_0x4fb77e['chat']['id'],_0x5a8f4b(0x1d1));else{if(_0x225646[_0x5a8f4b(0x38c)]>0x1)_0x225646[_0x5a8f4b(0x2de)]({'botID':_0x5a8f4b(0x1bf)});let _0x1cdd32=[],_0x501736=[];const _0x51890f=_0x225646[_0x5a8f4b(0x38c)]%0x4==0x0||_0x225646[_0x5a8f4b(0x38c)]%0x4==0x3||_0x225646[_0x5a8f4b(0x38c)]%0x3==0x1?0x4:0x3;let _0x3c4fb5=0x0;_0x225646[_0x5a8f4b(0x2f1)]((_0x8e792d,_0x4dc18d)=>{const _0x3b921e=_0x5a8f4b;if(_0x4dc18d%_0x51890f==0x0)_0x501736=[];_0x501736[_0x3b921e(0x2de)](Markup[_0x3b921e(0x2ec)][_0x3b921e(0x2a7)](_0x8e792d[_0x3b921e(0x2df)]==_0x3b921e(0x1bf)?_0x3b921e(0x248):_0x3b921e(0x37b)+_0x8e792d['botID'],_0x3b921e(0x18d)+_0x8e792d[_0x3b921e(0x2df)])),_0x4dc18d%_0x51890f==0x0&&(_0x1cdd32[_0x3c4fb5]=_0x501736,_0x3c4fb5++);});const _0x50309a=Markup[_0x5a8f4b(0x29b)](_0x1cdd32);_0x4fb77e['reply'](_0x5a8f4b(0x21f),_0x50309a);}}),tgBot[_0x178fd5(0x26b)](/on_(.+)/,async _0x402865=>{const _0x1cc061=_0x178fd5,_0x3ea06e=_0x402865['match'][0x1];_0x402865[_0x1cc061(0x225)]();if(_0x3ea06e=='all'){const _0x10f4af=getDisabledBots();await sendTelegram(_0x402865[_0x1cc061(0x292)]['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x10f4af[_0x1cc061(0x2f1)](_0x48dd55=>{const _0x12fc42=_0x1cc061;if(_0x48dd55['botID']!='all')toggleBot(_0x48dd55[_0x12fc42(0x2df)],toggleStatus(_0x48dd55[_0x12fc42(0x2df)]),'stopped');});}else await sendTelegram(_0x402865[_0x1cc061(0x292)]['id'],_0x1cc061(0x29a)+_0x3ea06e),toggleBot(_0x3ea06e,toggleStatus(_0x3ea06e),_0x1cc061(0x37f));}),tgBot[_0x178fd5(0x19c)](_0x178fd5(0x264),async _0x804ef9=>{const _0x2b8176=_0x178fd5,_0x31ae90=getEnabledBots();if(_0x31ae90['length']==0x0)await sendTelegram(_0x804ef9[_0x2b8176(0x292)]['id'],_0x2b8176(0x32d));else{if(_0x31ae90[_0x2b8176(0x38c)]>0x1)_0x31ae90[_0x2b8176(0x2de)]({'botID':_0x2b8176(0x1bf)});let _0x31ca95=[],_0x1ea363=[];const _0x1bf963=_0x31ae90[_0x2b8176(0x38c)]%0x4==0x0||_0x31ae90[_0x2b8176(0x38c)]%0x4==0x3||_0x31ae90[_0x2b8176(0x38c)]%0x3==0x1?0x4:0x3;let _0x1a33d7=0x0;_0x31ae90['forEach']((_0x38b3ba,_0x49c2b9)=>{const _0x46a875=_0x2b8176;if(_0x49c2b9%_0x1bf963==0x0)_0x1ea363=[];_0x1ea363['push'](Markup['button'][_0x46a875(0x2a7)](_0x38b3ba[_0x46a875(0x2df)]==_0x46a875(0x1bf)?'All\x20bots':'Bot\x20'+_0x38b3ba['botID'],_0x46a875(0x30e)+_0x38b3ba[_0x46a875(0x2df)])),_0x49c2b9%_0x1bf963==0x0&&(_0x31ca95[_0x1a33d7]=_0x1ea363,_0x1a33d7++);});const _0x5d45d6=Markup[_0x2b8176(0x29b)](_0x31ca95);_0x804ef9[_0x2b8176(0x194)](_0x2b8176(0x34c),_0x5d45d6);}}),tgBot[_0x178fd5(0x26b)](/off_(.+)/,async _0x49e65d=>{const _0x5e7131=_0x178fd5,_0x4a2e3f=_0x49e65d[_0x5e7131(0x1be)][0x1];_0x49e65d['editMessageReplyMarkup']();if(_0x4a2e3f==_0x5e7131(0x1bf)){const _0x35985a=getEnabledBots();await sendTelegram(_0x49e65d['chat']['id'],_0x5e7131(0x3ad)),_0x35985a[_0x5e7131(0x2f1)](_0x23d433=>{const _0x530424=_0x5e7131;if(_0x23d433['botID']!=_0x530424(0x1bf))toggleBot(_0x23d433['botID'],toggleStatus(_0x23d433[_0x530424(0x2df)]),_0x530424(0x37f));});}else await sendTelegram(_0x49e65d[_0x5e7131(0x292)]['id'],_0x5e7131(0x1d6)+_0x4a2e3f),toggleBot(_0x4a2e3f,toggleStatus(_0x4a2e3f),'stopped');}),tgBot['command'](_0x178fd5(0x1cf),async _0x29da48=>{const _0x326380=_0x178fd5,_0x4c6d30=getEnabledBots();if(_0x4c6d30['length']==0x0)await sendTelegram(_0x29da48['chat']['id'],_0x326380(0x32d));else{if(_0x4c6d30[_0x326380(0x38c)]>0x1){let _0x3c8588=[],_0x2e9028=[];const _0x638a12=_0x4c6d30[_0x326380(0x38c)]%0x4==0x0||_0x4c6d30[_0x326380(0x38c)]%0x4==0x3||_0x4c6d30[_0x326380(0x38c)]%0x3==0x1?0x4:0x3;let _0x1cf71d=0x0;_0x4c6d30[_0x326380(0x2f1)]((_0x1fba52,_0x3162bf)=>{const _0x211eb4=_0x326380;if(_0x3162bf%_0x638a12==0x0)_0x2e9028=[];_0x2e9028[_0x211eb4(0x2de)](Markup[_0x211eb4(0x2ec)][_0x211eb4(0x2a7)](_0x211eb4(0x37b)+_0x1fba52[_0x211eb4(0x2df)],_0x211eb4(0x343)+_0x1fba52[_0x211eb4(0x2df)])),_0x3162bf%_0x638a12==0x0&&(_0x3c8588[_0x1cf71d]=_0x2e9028,_0x1cf71d++);});const _0x22bb40=Markup['inlineKeyboard'](_0x3c8588);_0x29da48[_0x326380(0x194)](_0x326380(0x2d2),_0x22bb40);}else{const _0x1a4265=_0x4c6d30[0x0][_0x326380(0x2df)];if(pid[_0x1a4265])pid[_0x1a4265][_0x326380(0x19b)]({'function':_0x326380(0x323),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x5bc2b8=>{const _0x395aa5=_0x178fd5,_0x50d3be=_0x5bc2b8[_0x395aa5(0x1be)][0x1];_0x5bc2b8[_0x395aa5(0x225)]();if(pid[_0x50d3be])pid[_0x50d3be]['send']({'function':_0x395aa5(0x323),'args':null});}),tgBot[_0x178fd5(0x19c)]('portfolio',async _0xe9fbe6=>{const _0x39ef7c=_0x178fd5,_0x1b0aad=getEnabledBots();if(_0x1b0aad[_0x39ef7c(0x38c)]==0x0)await sendTelegram(_0xe9fbe6[_0x39ef7c(0x292)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1b0aad[_0x39ef7c(0x38c)]>0x1){let _0x29dca5=[],_0x700c0b=[];const _0x121145=_0x1b0aad[_0x39ef7c(0x38c)]%0x4==0x0||_0x1b0aad[_0x39ef7c(0x38c)]%0x4==0x3||_0x1b0aad[_0x39ef7c(0x38c)]%0x3==0x1?0x4:0x3;let _0x25b626=0x0;_0x1b0aad[_0x39ef7c(0x2f1)]((_0x597e0c,_0x244a42)=>{const _0x57641f=_0x39ef7c;if(_0x244a42%_0x121145==0x0)_0x700c0b=[];_0x700c0b['push'](Markup['button'][_0x57641f(0x2a7)](_0x57641f(0x37b)+_0x597e0c[_0x57641f(0x2df)],_0x57641f(0x197)+_0x597e0c[_0x57641f(0x2df)])),_0x244a42%_0x121145==0x0&&(_0x29dca5[_0x25b626]=_0x700c0b,_0x25b626++);});const _0x58bc14=Markup[_0x39ef7c(0x29b)](_0x29dca5);_0xe9fbe6[_0x39ef7c(0x194)](_0x39ef7c(0x1fb),_0x58bc14);}else{const _0x2f092d=_0x1b0aad[0x0][_0x39ef7c(0x2df)];if(pid[_0x2f092d])pid[_0x2f092d][_0x39ef7c(0x19b)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x5752ed=>{const _0x4dba24=_0x178fd5,_0x219f26=_0x5752ed[_0x4dba24(0x1be)][0x1];_0x5752ed[_0x4dba24(0x225)]();if(pid[_0x219f26])pid[_0x219f26]['send']({'function':_0x4dba24(0x34d),'args':null});}),tgBot['command']('logs',async _0x1d586e=>{const _0x1b23b1=_0x178fd5,_0x4e0b12=_0x1b23b1(0x2e1);await zipFiles(_0x4e0b12);const _0x25c984=zippath+(_0x4e0b12+'.zip');_0x1d586e[_0x1b23b1(0x30c)]({'source':_0x25c984})['then'](()=>{})[_0x1b23b1(0x330)](_0x540733=>logger['debug'](_0x1b23b1(0x2e7)+_0x4e0b12+_0x1b23b1(0x253),_0x540733));}),tgBot[_0x178fd5(0x19c)](_0x178fd5(0x24b),async _0x4747fa=>{const _0x3a0667=_0x178fd5,_0x5d6895=_0x3a0667(0x24b);await backupConfigFiles(),await zipFiles(_0x5d6895);const _0x51d565=zippath+(_0x5d6895+'.zip');_0x4747fa[_0x3a0667(0x30c)]({'source':_0x51d565})[_0x3a0667(0x321)](()=>{})[_0x3a0667(0x330)](_0x252af3=>logger[_0x3a0667(0x29e)](_0x3a0667(0x2e7)+_0x5d6895+_0x3a0667(0x253),_0x252af3));}),tgBot[_0x178fd5(0x19c)](_0x178fd5(0x399),async _0x4938b5=>{const _0x319a8a=_0x178fd5;await getMessages();if(!updateAvailable)await sendTelegram(_0x4938b5['chat']['id'],_0x319a8a(0x1d2));else{if(!validInstallation)await sendTelegram(_0x4938b5[_0x319a8a(0x292)]['id'],_0x319a8a(0x246));else{const _0x5538a2=Markup[_0x319a8a(0x29b)]([Markup[_0x319a8a(0x2ec)][_0x319a8a(0x2a7)]('Yes',_0x319a8a(0x200)),Markup[_0x319a8a(0x2ec)][_0x319a8a(0x2a7)]('No',_0x319a8a(0x1c8))]);_0x4938b5['reply'](_0x319a8a(0x1a0),_0x5538a2);}}}),tgBot[_0x178fd5(0x26b)](/update_(.+)/,async _0xa748ce=>{const _0x4e1921=_0x178fd5,_0xa28a10=_0xa748ce[_0x4e1921(0x1be)][0x1];_0xa748ce['editMessageReplyMarkup'](),_0xa28a10==_0x4e1921(0x2e4)&&(await sendTelegram(_0xa748ce[_0x4e1921(0x292)]['id'],_0x4e1921(0x316)),updateBB(_0x4e1921(0x399))),_0xa28a10=='no'&&await sendTelegram(_0xa748ce['chat']['id'],_0x4e1921(0x1a2));}),tgBot['command']('reinstall',async _0x2e9e24=>{const _0x291c39=_0x178fd5;if(!validInstallation)await sendTelegram(_0x2e9e24['chat']['id'],_0x291c39(0x2d7));else{const _0x1768c4=Markup[_0x291c39(0x29b)]([Markup['button'][_0x291c39(0x2a7)](_0x291c39(0x1b5),_0x291c39(0x34a)),Markup['button']['callback']('No','reinstall_no')]);_0x2e9e24['reply'](_0x291c39(0x299),_0x1768c4);}}),tgBot[_0x178fd5(0x26b)](/reinstall_(.+)/,async _0x3be974=>{const _0x273202=_0x178fd5,_0xb9048b=_0x3be974[_0x273202(0x1be)][0x1];_0x3be974[_0x273202(0x225)](),_0xb9048b=='yes'&&(await sendTelegram(_0x3be974[_0x273202(0x292)]['id'],_0x273202(0x347)),updateBB(_0x273202(0x1f4))),_0xb9048b=='no'&&await sendTelegram(_0x3be974[_0x273202(0x292)]['id'],_0x273202(0x23d));}),tgBot['command'](_0x178fd5(0x1f2),async _0x1ecd62=>{const _0x1585de=_0x178fd5,_0x11f02a=getBotsWithMode();if(_0x11f02a[_0x1585de(0x38c)]==0x0)await sendTelegram(_0x1ecd62[_0x1585de(0x292)]['id'],_0x1585de(0x32d));else{let _0x4d1a13=[],_0x483d1b=[];const _0x3b9fd0=0x2;let _0x38c604=0x0;_0x11f02a[_0x1585de(0x2f1)]((_0x297911,_0x477bc5)=>{const _0x2d8927=_0x1585de;if(_0x477bc5%_0x3b9fd0==0x0)_0x483d1b=[];_0x483d1b[_0x2d8927(0x2de)](Markup[_0x2d8927(0x2ec)][_0x2d8927(0x2a7)](_0x2d8927(0x37b)+_0x297911['botID']+'\x20('+_0x297911[_0x2d8927(0x32b)]+')',_0x2d8927(0x389)+_0x297911[_0x2d8927(0x2df)])),_0x477bc5%_0x3b9fd0==0x0&&(_0x4d1a13[_0x38c604]=_0x483d1b,_0x38c604++);});const _0x10372f=Markup[_0x1585de(0x29b)](_0x4d1a13);_0x1ecd62[_0x1585de(0x194)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x10372f);}}),tgBot[_0x178fd5(0x26b)](/toggle_(.+)/,async _0x1f0d75=>{const _0x53050f=_0x178fd5,_0x545ee2=_0x1f0d75[_0x53050f(0x1be)][0x1];_0x1f0d75[_0x53050f(0x225)]();const _0x72912e=getBotsWithMode(),_0x5295f7=_0x72912e['find'](_0x3228f0=>_0x3228f0[_0x53050f(0x2df)]==_0x545ee2),_0x299507=_0x5295f7[_0x53050f(0x32b)]=='auto'?_0x53050f(0x35a):_0x53050f(0x344);await sendTelegram(_0x1f0d75[_0x53050f(0x292)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x545ee2+_0x53050f(0x2f6)+_0x299507+_0x53050f(0x391)),toggleBotMode(_0x545ee2);}),tgBot['command'](_0x178fd5(0x33d),async _0x55032e=>{const _0x4c2122=_0x178fd5;let _0x39353e='';config[_0x4c2122(0x2f1)](_0x2b7d8f=>{const _0x20dbdd=_0x4c2122;_0x39353e+=_0x20dbdd(0x37b)+_0x2b7d8f[_0x20dbdd(0x2df)]+':\x20'+_0x2b7d8f[_0x20dbdd(0x27e)]+'\x0a';}),await sendTelegram(_0x55032e[_0x4c2122(0x292)]['id'],_0x39353e,{'parse_mode':_0x4c2122(0x28a)});}),tgBot[_0x178fd5(0x19c)](_0x178fd5(0x233),async _0x17719e=>{await sendTelegram(_0x17719e['chat']['id'],_0x19c678);}),process[_0x178fd5(0x1fe)]('SIGINT',()=>tgBot['stop']('SIGINT')),process[_0x178fd5(0x1fe)](_0x178fd5(0x1b0),()=>tgBot[_0x178fd5(0x1ed)](_0x178fd5(0x1b0))),tgBot[_0x178fd5(0x32c)]();}function disableTelegram(){const _0x51c73c=_0x4cb281;tgBot&&tgBot[_0x51c73c(0x1ed)]();}async function sendTelegram(_0x52b1c5,_0x50072a,_0x5e8bd9){const _0x2f1e57=_0x4cb281;_0x5e8bd9={..._0x5e8bd9,'disable_web_page_preview':!![]};try{await tgBot[_0x2f1e57(0x1ba)][_0x2f1e57(0x2cf)](_0x52b1c5,_0x50072a,_0x5e8bd9);}catch(_0x49647e){logger[_0x2f1e57(0x29e)]('Telegram\x20error:',_0x49647e);}}async function sendTelegramBot(_0x15961f,_0x2c5d2a){const _0x591f96=_0x4cb281;if(settings[_0x591f96(0x3af)]){if(settings[_0x591f96(0x35b)]=='all'||(_0x2c5d2a[_0x591f96(0x3a2)]==_0x591f96(0x353)||_0x2c5d2a[_0x591f96(0x3a2)]==_0x591f96(0x220)||_0x2c5d2a['type']==_0x591f96(0x2f7))&&settings[_0x591f96(0x35b)]==_0x591f96(0x209)||_0x2c5d2a['type']=='order'&&settings[_0x591f96(0x35b)]=='orders'){if(tgBot&&settings['telegramChatId']){if(_0x2c5d2a[_0x591f96(0x3a8)])await sendTelegram(settings[_0x591f96(0x2a5)],_0x2c5d2a['botname']+'\x20>\x20'+_0x2c5d2a[_0x591f96(0x35f)]);else await sendTelegram(settings[_0x591f96(0x2a5)],_0x591f96(0x37b)+_0x15961f+_0x591f96(0x2b9)+_0x2c5d2a[_0x591f96(0x35f)]);}}}}async function sendTelegramMsg(_0x5683e1,_0x41aa79=_0x4cb281(0x28a)){const _0x2a539b=_0x4cb281;return settings[_0x2a539b(0x3af)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x2a539b(0x2a5)],_0x5683e1,{'parse_mode':_0x41aa79}),!![]):![];}function getDeviceWithIp(_0x2fafac){const _0x1b5395=_0x4cb281;return devices[_0x1b5395(0x217)](_0xfc905e=>_0xfc905e['ip']===_0x2fafac);}async function temporaryAccess2FA(_0x14e2b2,_0x26f3c9){const _0x5d496b=_0x4cb281;let _0xf6c969=new Date(),_0x31ff3d=![];if(lastIpApproval){if(_0xf6c969-lastIpApproval<0x1388)_0x31ff3d=!![];}lastIpApproval=new Date();if(_0x31ff3d)return;if(tgBot&&settings['telegramChatId']){const _0x3427f0=uuidRandom();tmpStorage[_0x3427f0]={'uuid':_0x14e2b2,'externalip':_0x26f3c9};const _0x359f05=Markup[_0x5d496b(0x29b)]([Markup[_0x5d496b(0x2ec)][_0x5d496b(0x2a7)](_0x5d496b(0x1dd),_0x5d496b(0x270)+_0x3427f0),Markup['button'][_0x5d496b(0x2a7)](_0x5d496b(0x348),_0x5d496b(0x372)+_0x3427f0),Markup[_0x5d496b(0x2ec)][_0x5d496b(0x2a7)](_0x5d496b(0x25e),_0x5d496b(0x364)+_0x3427f0),Markup[_0x5d496b(0x2ec)][_0x5d496b(0x2a7)]('reject',_0x5d496b(0x26c)+_0x3427f0)]);await sendTelegram(settings['telegramChatId'],_0x5d496b(0x290)+normalizeIP(_0x26f3c9)['show']+'\x20?',_0x359f05),tgBot[_0x5d496b(0x26b)](/tempaccess_(.+)_(.+)/,async _0x15b603=>{const _0x4851f2=_0x5d496b,_0x27f0fa=_0x15b603[_0x4851f2(0x1be)][0x1],_0x21034d=_0x15b603['match'][0x2],{uuid:_0x577e54,externalip:_0x5e4845}=tmpStorage[_0x21034d];delete tmpStorage[_0x21034d],_0x15b603[_0x4851f2(0x225)](),devices[_0x577e54][_0x4851f2(0x2ff)]={'clientip':_0x5e4845,'timestamp':new Date()[_0x4851f2(0x2aa)](),'expiry':_0x27f0fa},_0x27f0fa!=_0x4851f2(0x2a3)?(await sendTelegram(_0x15b603[_0x4851f2(0x292)]['id'],_0x4851f2(0x1d3)+_0x27f0fa+'\x20minutes',{'parse_mode':_0x4851f2(0x28a)}),io['to'](_0x577e54)[_0x4851f2(0x2f5)](_0x4851f2(0x366),{'access':{'allow':![],'reason':_0x4851f2(0x3a3),'token':null}})):(await sendTelegram(_0x15b603[_0x4851f2(0x292)]['id'],_0x4851f2(0x302)),io['to'](_0x577e54)[_0x4851f2(0x2f5)](_0x4851f2(0x366),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x793ea3,_0x47fdc9){const _0x36a453=_0x4cb281;if(tgBot&&settings['telegramChatId']){const _0x3eb39f=uuidRandom();tmpStorage[_0x3eb39f]={'uuid':_0x793ea3,'externalip':_0x47fdc9};const _0x52b9c4=Markup[_0x36a453(0x29b)]([Markup[_0x36a453(0x2ec)][_0x36a453(0x2a7)](_0x36a453(0x3a0),_0x36a453(0x1bc)+loginExpiry+'_'+_0x3eb39f),Markup[_0x36a453(0x2ec)][_0x36a453(0x2a7)](_0x36a453(0x2a3),_0x36a453(0x2fd)+_0x3eb39f)]);await sendTelegram(settings['telegramChatId'],_0x36a453(0x377)+normalizeIP(_0x47fdc9)['show']+'\x20?',_0x52b9c4),tgBot[_0x36a453(0x26b)](/login2fa_(.+)_(.+)/,async _0x1af72b=>{const _0x2d8886=_0x36a453,_0x2e1423=_0x1af72b[_0x2d8886(0x1be)][0x1],_0x145b25=_0x1af72b['match'][0x2],{uuid:_0x1c2f9c,externalip:_0x4de3e1}=tmpStorage[_0x145b25];delete tmpStorage[_0x145b25],_0x1af72b[_0x2d8886(0x225)](),devices[_0x1c2f9c]['telegram2FaApproval']={'clientip':_0x4de3e1,'timestamp':new Date()[_0x2d8886(0x2aa)](),'expiry':_0x2e1423},_0x2e1423!='reject'?(await sendTelegram(_0x1af72b['chat']['id'],_0x2d8886(0x235),{'parse_mode':_0x2d8886(0x28a)}),io['to'](_0x1c2f9c)[_0x2d8886(0x2f5)](_0x2d8886(0x366),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x1af72b[_0x2d8886(0x292)]['id'],_0x2d8886(0x365)),io['to'](_0x1c2f9c)[_0x2d8886(0x2f5)](_0x2d8886(0x366),{'access':{'allow':![],'reason':_0x2d8886(0x218),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2127df=_0x4cb281;return dbConfig['get'](_0x2127df(0x1fd))[_0x2127df(0x388)](_0x2127df(0x2df))['filter']({'status':_0x2127df(0x2d6)})[_0x2127df(0x345)]()||[];}function getDisabledBots(){const _0x444f84=_0x4cb281;return dbConfig[_0x444f84(0x35c)]('bots')['sortBy'](_0x444f84(0x2df))[_0x444f84(0x308)]({'status':_0x444f84(0x392)})[_0x444f84(0x345)]()||[];}function getBotAttributes(_0xf8e83d){const _0x91c9b5=_0x4cb281;let _0x24b50b={};const _0x2317bc=configpath+_0x91c9b5(0x240)+_0xf8e83d+'-config.json',_0x4b5013=fs[_0x91c9b5(0x30b)](_0x2317bc);if(_0x4b5013){const _0x5ad313=fs['readFileSync'](_0x2317bc);try{const _0xd649e3=JSON[_0x91c9b5(0x228)](_0x5ad313),_0x2a703c=_0xd649e3?_0xd649e3[_0x91c9b5(0x1d9)][0x0][_0x91c9b5(0x382)]:![];_0x24b50b[_0x91c9b5(0x32b)]=_0x2a703c?_0x91c9b5(0x344):_0x91c9b5(0x35a),_0x24b50b[_0x91c9b5(0x27e)]=_0xd649e3?_0xd649e3[_0x91c9b5(0x1d9)][0x0][_0x91c9b5(0x27e)]:_0x91c9b5(0x37b)+_0xf8e83d;}catch(_0x311955){_0x24b50b['mode']='manual',_0x24b50b['botname']='Bot\x20'+_0xf8e83d;}}else _0x24b50b[_0x91c9b5(0x32b)]='manual',_0x24b50b[_0x91c9b5(0x27e)]=_0x91c9b5(0x37b)+_0xf8e83d;return _0x24b50b;}function getBotsWithMode(){const _0x39fb9d=_0x4cb281,_0xc91242=dbConfig[_0x39fb9d(0x35c)]('bots')[_0x39fb9d(0x388)](_0x39fb9d(0x2df))[_0x39fb9d(0x345)]()||[];return _0xc91242[_0x39fb9d(0x2f1)](_0x328331=>{const _0xa54310=_0x39fb9d;let _0xed14fe=getBotAttributes(_0x328331[_0xa54310(0x2df)]);_0x328331[_0xa54310(0x32b)]=_0xed14fe[_0xa54310(0x32b)];}),_0xc91242;}function getBotExchanges(){const _0x5469d4=_0x4cb281;let _0x264ee9=[];const _0x31af71=dbConfig[_0x5469d4(0x35c)]('bots')[_0x5469d4(0x388)](_0x5469d4(0x2df))[_0x5469d4(0x345)]()||[];_0x31af71[_0x5469d4(0x2f1)](_0x24ea2a=>{const _0x1d2db7=_0x5469d4;if(_0x24ea2a['status']==_0x1d2db7(0x2d6)){const _0xc79c6a=configpath+'bot-'+_0x24ea2a[_0x1d2db7(0x2df)]+_0x1d2db7(0x2e0),_0x5e9700=fs[_0x1d2db7(0x30b)](_0xc79c6a);let _0x2fc084;if(_0x5e9700){const _0xa86fb3=fs['readFileSync'](_0xc79c6a);try{const _0x494e7b=JSON[_0x1d2db7(0x228)](_0xa86fb3);_0x2fc084=_0x494e7b?_0x494e7b[_0x1d2db7(0x1d9)][0x0]['exchange']:null;}catch(_0x2dd6e2){}}if(_0x2fc084)_0x264ee9['push'](_0x2fc084);}});const _0x3cab09=[...new Set(_0x264ee9)]['sort']();return _0x3cab09;}async function initUser(){if(!settings['userid']){const _0x365223=uuidRandom();mixpanel['alias'](_0x365223),updateSetting('userid',_0x365223);}}async function initSecure(){const _0x1c4255=_0x4cb281;let _0x39d96b=getSecure();if(!_0x39d96b[_0x1c4255(0x2c7)](_0x1c4255(0x260))){let _0x2a29d8=await generateKeys();_0x39d96b[_0x1c4255(0x340)]=_0x2a29d8[_0x1c4255(0x340)],_0x39d96b[_0x1c4255(0x3ac)]=_0x2a29d8[_0x1c4255(0x3ac)],_0x39d96b[_0x1c4255(0x260)]=crypto[_0x1c4255(0x1a9)](0x20)['toString']('hex');;storeSecure(_0x39d96b);}}function getSettings(){const _0x14d43e=_0x4cb281;return dbSettings[_0x14d43e(0x35c)]('settings')[_0x14d43e(0x345)]()||{};}function getSecure(){const _0x55667a=_0x4cb281;return dbSecure['get']('secure')[_0x55667a(0x345)]()||{};}function getBlacklist(){const _0x2b9bb0=_0x4cb281;return dbSecure['get'](_0x2b9bb0(0x387))[_0x2b9bb0(0x345)]()||[];}function broadcastToBots(_0x4eaa55,_0x22d84d){const _0x399302=_0x4cb281;config[_0x399302(0x2f1)](_0x3a3aac=>{const _0x4d1a98=_0x399302;if(_0x3a3aac[_0x4d1a98(0x366)]==_0x4d1a98(0x2d6)&&_0x3a3aac[_0x4d1a98(0x342)]==_0x4d1a98(0x1d0)||_0x3a3aac[_0x4d1a98(0x366)]==_0x4d1a98(0x31c)&&_0x3a3aac[_0x4d1a98(0x342)]==_0x4d1a98(0x1d0)){if(pid[_0x3a3aac[_0x4d1a98(0x2df)]])pid[_0x3a3aac['botID']][_0x4d1a98(0x19b)]({[_0x4eaa55]:_0x22d84d});}});}async function storeSettings(_0x5cc5ee,_0x478ca4=![]){const _0x3f7d25=_0x4cb281;_0x5cc5ee={...settings,..._0x5cc5ee};if(_0x478ca4&&_0x5cc5ee['bbPassword']!=_0x3f7d25(0x21c)&&_0x5cc5ee[_0x3f7d25(0x2c9)]!=_0x3f7d25(0x191)&&_0x5cc5ee[_0x3f7d25(0x2c9)]!=''){const _0x1f4196=decryptRSA(secure['privateKey'],_0x5cc5ee[_0x3f7d25(0x2c9)])[_0x3f7d25(0x295)](_0x3f7d25(0x229))[0x0],_0x22e70e=bcrypt['hashSync'](_0x1f4196,saltRounds);_0x5cc5ee={..._0x5cc5ee,'bbPassword':_0x22e70e};}if(_0x478ca4&&_0x5cc5ee[_0x3f7d25(0x288)]!='************'&&_0x5cc5ee[_0x3f7d25(0x288)]!=_0x3f7d25(0x191)&&_0x5cc5ee[_0x3f7d25(0x288)]!=''){const _0x479bf6=decryptRSA(secure[_0x3f7d25(0x3ac)],_0x5cc5ee['telegramToken'])['split']('|@|')[0x0];_0x5cc5ee={..._0x5cc5ee,'telegramToken':_0x479bf6};}if(_0x478ca4&&_0x5cc5ee[_0x3f7d25(0x1c1)]!='************'&&_0x5cc5ee[_0x3f7d25(0x1c1)]!=_0x3f7d25(0x191)&&_0x5cc5ee['marketcapApi']!=''){const _0x102b5d=decryptRSA(secure['privateKey'],_0x5cc5ee[_0x3f7d25(0x1c1)])[_0x3f7d25(0x295)](_0x3f7d25(0x229))[0x0];_0x5cc5ee={..._0x5cc5ee,'marketcapApi':_0x102b5d};}const _0x480a6a=_0x5cc5ee[_0x3f7d25(0x288)]!=_0x3f7d25(0x21c)&&_0x5cc5ee[_0x3f7d25(0x288)]!=settings[_0x3f7d25(0x288)]||_0x5cc5ee[_0x3f7d25(0x36f)]!=settings['telegramUsername'],_0x5518d4=_0x5cc5ee[_0x3f7d25(0x288)]==''||_0x5cc5ee[_0x3f7d25(0x36f)]=='',_0x1695dd=_0x5cc5ee[_0x3f7d25(0x1c1)]&&_0x5cc5ee[_0x3f7d25(0x1c1)]!=_0x3f7d25(0x21c)&&_0x5cc5ee[_0x3f7d25(0x1c1)]!=settings[_0x3f7d25(0x288)];_0x480a6a&&(_0x5cc5ee[_0x3f7d25(0x2a5)]=null,_0x5cc5ee['telegramEvents']=_0x3f7d25(0x1bf));for(const [_0xbea2f,_0x344127]of Object[_0x3f7d25(0x329)](_0x5cc5ee)){if(_0xbea2f==_0x3f7d25(0x288)&&_0x344127==_0x3f7d25(0x21c)){_0x5cc5ee[_0x3f7d25(0x288)]=settings['telegramToken'];continue;};if(_0xbea2f==_0x3f7d25(0x2c9)&&_0x344127==_0x3f7d25(0x21c)){_0x5cc5ee[_0x3f7d25(0x2c9)]=settings[_0x3f7d25(0x2c9)];continue;};if(_0xbea2f=='marketcapApi'&&_0x344127=='************'){_0x5cc5ee[_0x3f7d25(0x1c1)]=settings['marketcapApi'];continue;};dbSettings['set'](_0x3f7d25(0x210)+_0xbea2f,_0x344127)[_0x3f7d25(0x261)]();}settings=_0x5cc5ee,io['to'](_0x3f7d25(0x32a))[_0x3f7d25(0x2f5)](_0x3f7d25(0x1ef),cleanSettings()),broadcastToBots(_0x3f7d25(0x1db),settings[_0x3f7d25(0x1db)]),broadcastToBots(_0x3f7d25(0x1f0),settings[_0x3f7d25(0x1f0)]),broadcastToBots(_0x3f7d25(0x1c1),settings[_0x3f7d25(0x1c1)]);if(_0x480a6a&&!_0x5518d4)initTelegram();if(_0x480a6a&&_0x5518d4)disableTelegram();getAllClients()[_0x3f7d25(0x2f1)](_0x402ae7=>{const _0x11a9eb=_0x3f7d25;getSocket(_0x402ae7['id'])[_0x11a9eb(0x2f5)](_0x11a9eb(0x366),{'access':{'allow':![],'reason':_0x11a9eb(0x3a3),'token':null}});}),_0x1695dd&&(await sleep(0xbb8),testMarketcapApi(_0x5cc5ee[_0x3f7d25(0x1c1)]));}async function testMarketcapApi(_0x321062){const _0x146d73=_0x4cb281,_0x46cab6=[_0x146d73(0x1ec),'ETH'];try{await axios['get'](_0x146d73(0x1d8),{'headers':{'X-CMC_PRO_API_KEY':_0x321062},'params':{'symbol':_0x46cab6[_0x146d73(0x1cc)]()}});}catch(_0x1ee01b){_0x1ee01b[_0x146d73(0x1cc)]()['includes'](_0x146d73(0x1d7))?(io['to']('botmanager')[_0x146d73(0x2f5)]('notification','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x146d73(0x2b5)](_0x146d73(0x38d))):(io['to'](_0x146d73(0x32a))['emit'](_0x146d73(0x37a),_0x146d73(0x1a8)),logger[_0x146d73(0x2b5)](_0x146d73(0x1a8)),logger['debug'](_0x146d73(0x281),_0x1ee01b[_0x146d73(0x1cc)]()+_0x146d73(0x20b)+_0x1ee01b[_0x146d73(0x226)]));return;}logger['debug']('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x5ebd86,_0x3adf1e){const _0x2e9687=_0x4cb281;dbSettings[_0x2e9687(0x1aa)]('settings.'+_0x5ebd86,_0x3adf1e)[_0x2e9687(0x261)](),settings=getSettings(),io['to'](_0x2e9687(0x32a))[_0x2e9687(0x2f5)](_0x2e9687(0x1ef),cleanSettings());}function storeSecure(_0x4fba64){const _0xedc557=_0x4cb281;dbSecure['get'](_0xedc557(0x231))[_0xedc557(0x2de)](_0x4fba64)[_0xedc557(0x261)](),secure=_0x4fba64;}function addBlacklist(_0x54a18f){const _0x189927=_0x4cb281;cleanBlacklist();let _0x628377;devices[_0x54a18f]['telegramIpApproval']?_0x628377=Math['max'](devices[_0x54a18f][_0x189927(0x2ff)][_0x189927(0x2b6)],loginExpiry):_0x628377=loginExpiry,dbSecure['get'](_0x189927(0x387))['push']({'expiry':new Date()[_0x189927(0x2aa)]()+_0x628377*0x3c*0x3e8,'token':devices[_0x54a18f][_0x189927(0x363)][_0x189927(0x351)]})['write'](),blacklist=dbSecure[_0x189927(0x35c)]('blacklist')[_0x189927(0x345)]();}function cleanBlacklist(){const _0x274df2=_0x4cb281;let _0x183f28=dbSecure[_0x274df2(0x35c)](_0x274df2(0x387))['cloneDeep']()[_0x274df2(0x345)](),_0x4f3693=new Date()[_0x274df2(0x2aa)]();_0x183f28['forEach'](_0x3623f6=>{const _0x28390b=_0x274df2;_0x3623f6[_0x28390b(0x2b6)]<_0x4f3693&&dbSecure[_0x28390b(0x35c)](_0x28390b(0x387))[_0x28390b(0x287)]({'expiry':_0x3623f6[_0x28390b(0x2b6)]})[_0x28390b(0x261)]();});}function initStates(){const _0x5735cc=_0x4cb281;let _0x3fb20d=getConfiguration();_0x3fb20d[_0x5735cc(0x2f1)](_0xcf577=>{const _0x1ec4bf=_0x5735cc;_0xcf577['live']=_0x1ec4bf(0x37f);}),storeConfiguration(_0x3fb20d);}async function generateKeys(){const _0x312ce8=_0x4cb281,_0x511f33=forge['pki'][_0x312ce8(0x304)][_0x312ce8(0x26e)]({'bits':0x1000,'e':0x10001}),_0x22c352=forge[_0x312ce8(0x2e6)][_0x312ce8(0x280)](_0x511f33[_0x312ce8(0x3ac)]),_0x22e352=forge[_0x312ce8(0x2e6)][_0x312ce8(0x30f)](_0x511f33[_0x312ce8(0x340)]);return{'privateKey':_0x22c352,'publicKey':_0x22e352};}async function oneTimeMigration(){const _0x398c69=_0x4cb281;let _0x29f2ab=getSettings(),_0x227e42=![];!_0x29f2ab[_0x398c69(0x2c7)]('lastmsgtelegram')&&(_0x29f2ab['lastmsgtelegram']=0x0,_0x227e42=!![]);!_0x29f2ab['hasOwnProperty']('lastmsgemitted')&&(_0x29f2ab[_0x398c69(0x27a)]=0x0,_0x227e42=!![]);!_0x29f2ab[_0x398c69(0x2c7)]('latestversion')&&(_0x29f2ab[_0x398c69(0x31b)]=_0x398c69(0x285),_0x227e42=!![]);!_0x29f2ab[_0x398c69(0x2c7)](_0x398c69(0x1f0))&&(_0x29f2ab['onepagemode']=![],_0x227e42=!![]);!_0x29f2ab[_0x398c69(0x2c7)](_0x398c69(0x1c1))&&(_0x29f2ab[_0x398c69(0x1c1)]='',_0x227e42=!![]);if(_0x227e42)storeSettings(_0x29f2ab);try{fs[_0x398c69(0x276)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x45ff33=>{const _0x79689d=_0x398c69;if(!_0x45ff33[_0x79689d(0x28f)]()){if(!_0x45ff33[_0x79689d(0x234)][_0x79689d(0x2af)](_0x79689d(0x34b)))fs[_0x79689d(0x2d8)](configbackuppath+_0x45ff33[_0x79689d(0x234)]);}else fs['rmSync'](configbackuppath+_0x45ff33[_0x79689d(0x234)],{'recursive':!![]});});}catch(_0x304f8e){logger[_0x398c69(0x29e)]('Error\x20removing\x20old\x20backup\x20files:',_0x304f8e);}}function storeConfiguration(_0x14e38a){const _0x494167=_0x4cb281;dbConfig[_0x494167(0x35c)](_0x494167(0x1fd))[_0x494167(0x287)]()[_0x494167(0x261)](),dbConfig[_0x494167(0x35c)](_0x494167(0x1fd))[_0x494167(0x2de)](..._0x14e38a)[_0x494167(0x261)](),config=_0x14e38a;}async function resetPassword(){const _0x142268=_0x4cb281;if(tgBot&&settings[_0x142268(0x2a5)]){const _0x3306ad=Markup['inlineKeyboard']([Markup['button'][_0x142268(0x2a7)](_0x142268(0x2e4),_0x142268(0x33b)),Markup[_0x142268(0x2ec)][_0x142268(0x2a7)]('no',_0x142268(0x36e))]);await sendTelegram(settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x3306ad),tgBot[_0x142268(0x26b)](/resetpw_(.+)/,async _0x90daa=>{const _0x5133f1=_0x142268,_0x550f6e=_0x90daa[_0x5133f1(0x1be)][0x1];_0x90daa[_0x5133f1(0x225)]();if(_0x550f6e!='no'){const _0x3a3753=0xf,_0x27acab='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x29ae97=Array[_0x5133f1(0x2d5)](crypto[_0x5133f1(0x21a)](new Uint32Array(_0x3a3753)))['map'](_0x2ce6f=>_0x27acab[_0x2ce6f%_0x27acab[_0x5133f1(0x38c)]])['join'](''),_0x84697b=bcrypt['hashSync'](_0x29ae97,saltRounds);storeSettings({'bbPassword':_0x84697b}),await sendTelegram(_0x90daa[_0x5133f1(0x292)]['id'],_0x5133f1(0x1e9)+_0x29ae97,{'parse_mode':'HTML'});}else await sendTelegram(_0x90daa[_0x5133f1(0x292)]['id'],_0x5133f1(0x374));});}}async function confirmRestore(_0x27a50b,_0x5ef896){const _0x5f31e0=_0x4cb281;io['to'](_0x5f31e0(0x32a))[_0x5f31e0(0x2f5)](_0x5f31e0(0x37a),_0x5f31e0(0x242),_0x5f31e0(0x2f7));if(tgBot&&settings[_0x5f31e0(0x2a5)]){const _0x5905cc=uuidRandom();tmpStorage[_0x5905cc]={'path':_0x27a50b,'filename':_0x5ef896};const _0x1de24b=Markup[_0x5f31e0(0x29b)]([Markup[_0x5f31e0(0x2ec)][_0x5f31e0(0x2a7)](_0x5f31e0(0x2e4),'restore_yes_'+_0x5905cc),Markup[_0x5f31e0(0x2ec)][_0x5f31e0(0x2a7)]('no',_0x5f31e0(0x283)+_0x5905cc)]);await sendTelegram(settings['telegramChatId'],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x1de24b),tgBot[_0x5f31e0(0x26b)](/restore_(.+)_(.+)/,async _0x14fbce=>{const _0x5cd4c0=_0x5f31e0,_0x826da2=_0x14fbce['match'][0x1],_0x105a1d=_0x14fbce[_0x5cd4c0(0x1be)][0x2],{path:_0x378e40,filename:_0x23a6cf}=tmpStorage[_0x105a1d];delete tmpStorage[_0x105a1d],_0x14fbce[_0x5cd4c0(0x225)](),_0x826da2==_0x5cd4c0(0x2e4)?(logger[_0x5cd4c0(0x29e)](_0x5cd4c0(0x37e)),await sendTelegram(_0x14fbce['chat']['id'],_0x5cd4c0(0x24e),{'parse_mode':_0x5cd4c0(0x28a)}),unzipFile(_0x378e40,_0x23a6cf)):(logger['debug']('Restore\x20process\x20aborted'),await sendTelegram(_0x14fbce['chat']['id'],_0x5cd4c0(0x395)));});}}function getServerTime(){const _0xec61e=_0x4cb281,_0x4e551c=new Date();return _0x4e551c['getFullYear']()+'/'+(_0x4e551c[_0xec61e(0x1a4)]()+0x1)[_0xec61e(0x1cc)]()[_0xec61e(0x1b2)](0x2,'0')+'/'+_0x4e551c['getDate']()['toString']()[_0xec61e(0x1b2)](0x2,'0')+'\x20'+_0x4e551c[_0xec61e(0x223)]()[_0xec61e(0x1cc)]()[_0xec61e(0x1b2)](0x2,'0')+':'+_0x4e551c[_0xec61e(0x1e4)]()[_0xec61e(0x1cc)]()['padStart'](0x2,'0')+':'+_0x4e551c[_0xec61e(0x25a)]()['toString']()[_0xec61e(0x1b2)](0x2,'0');}function getTimeStamp(){const _0x3fb22f=_0x4cb281,_0x449f54=shiftedTime();return _0x449f54[_0x3fb22f(0x1ac)]()+'/'+(_0x449f54['getMonth']()+0x1)['toString']()[_0x3fb22f(0x1b2)](0x2,'0')+'/'+_0x449f54[_0x3fb22f(0x314)]()[_0x3fb22f(0x1cc)]()[_0x3fb22f(0x1b2)](0x2,'0')+'\x20'+_0x449f54[_0x3fb22f(0x223)]()[_0x3fb22f(0x1cc)]()[_0x3fb22f(0x1b2)](0x2,'0')+':'+_0x449f54['getMinutes']()[_0x3fb22f(0x1cc)]()[_0x3fb22f(0x1b2)](0x2,'0')+':'+_0x449f54[_0x3fb22f(0x25a)]()[_0x3fb22f(0x1cc)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x2ac687=_0x4cb281,_0x444184=shiftedTime();return _0x444184['getFullYear']()+(_0x444184[_0x2ac687(0x1a4)]()+0x1)[_0x2ac687(0x1cc)]()['padStart'](0x2,'0')+_0x444184[_0x2ac687(0x314)]()[_0x2ac687(0x1cc)]()[_0x2ac687(0x1b2)](0x2,'0')+'-'+_0x444184[_0x2ac687(0x223)]()[_0x2ac687(0x1cc)]()[_0x2ac687(0x1b2)](0x2,'0')+_0x444184['getMinutes']()[_0x2ac687(0x1cc)]()['padStart'](0x2,'0')+_0x444184['getSeconds']()[_0x2ac687(0x1cc)]()[_0x2ac687(0x1b2)](0x2,'0');}function shiftedTime(){const _0x28db83=_0x4cb281,_0xe4f2c2=new Date();let _0x44b5a1=_0xe4f2c2;if(settings[_0x28db83(0x1db)]&&settings['timeshift']!==0x0)_0x44b5a1=fns[_0x28db83(0x3b3)](_0xe4f2c2,{'hours':settings[_0x28db83(0x1db)]});return _0x44b5a1;}async function startScheduler(){const _0x3b3c1a=_0x4cb281,_0x32323d=new Date()[_0x3b3c1a(0x29f)](),_0x58dfb0=shiftedTime()[_0x3b3c1a(0x223)]();_0x58dfb0==0x4&&backupConfigFiles(),_0x58dfb0==0x0&&(rotateLogFiles(),logger[_0x3b3c1a(0x29e)]('--------------------------------------'),logger[_0x3b3c1a(0x29e)](_0x3b3c1a(0x245)+serverversion+_0x3b3c1a(0x39a)+(environment==_0x3b3c1a(0x24c)?_0x3b3c1a(0x2c5):'')),logger[_0x3b3c1a(0x29e)]('--------------------------------------')),_0x32323d%0x6==0x0&&triggerAnalytics(),_0x32323d%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0xed9750){const _0x285630=_0x4cb281;logger[_0x285630(0x29e)](_0x285630(0x212)+_0xed9750);const _0x335a01=getBotsWithMode();_0x335a01[_0x285630(0x38c)]>0x0?confirmRestore(configbackuppath,_0xed9750):unzipFile(configbackuppath,_0xed9750);}async function getBackupFiles(_0xa291cb=null){const _0x167ddb=_0x4cb281;let _0x580ca5=[],_0x39655b=fs[_0x167ddb(0x276)](configbackuppath,{'withFileTypes':!![]});_0x39655b['sort']((_0x159e06,_0x1c11e1)=>_0x159e06['name']<_0x1c11e1[_0x167ddb(0x234)]?0x1:_0x1c11e1['name']<_0x159e06['name']?-0x1:0x0),_0x39655b[_0x167ddb(0x2f1)](_0x8af882=>{const _0x5e4a22=_0x167ddb;if(!_0x8af882[_0x5e4a22(0x28f)]()&&_0x8af882['name'][_0x5e4a22(0x2af)](_0x5e4a22(0x34b))&&_0x8af882['name']['endsWith'](_0x5e4a22(0x236))){const _0x1863ee=formatDate(fs[_0x5e4a22(0x312)](configbackuppath+_0x8af882[_0x5e4a22(0x234)])['mtime']);_0x580ca5[_0x5e4a22(0x2de)]({'name':_0x8af882[_0x5e4a22(0x234)],'mtime':_0x1863ee});}});if(_0xa291cb)io['to'](_0xa291cb)[_0x167ddb(0x2f5)](_0x167ddb(0x35d),_0x580ca5);else return _0x580ca5;}async function backupConfigFiles(){const _0x1bffb6=_0x4cb281;await zipFiles('backup-full');const _0x1af902=getCleanTimeStamp();fs[_0x1bffb6(0x31f)](zippath+'backup-full.zip',configbackuppath+(_0x1bffb6(0x34b)+_0x1af902+'.zip'));let _0x4e2deb=fs[_0x1bffb6(0x276)](configbackuppath,{'withFileTypes':!![]});_0x4e2deb[_0x1bffb6(0x1cd)]((_0x17423a,_0xa75b24)=>_0x17423a[_0x1bffb6(0x234)]<_0xa75b24[_0x1bffb6(0x234)]?0x1:_0xa75b24[_0x1bffb6(0x234)]<_0x17423a[_0x1bffb6(0x234)]?-0x1:0x0),_0x4e2deb[_0x1bffb6(0x38c)]>maxBackups&&fs[_0x1bffb6(0x2d8)](configbackuppath+_0x4e2deb[_0x4e2deb['length']-0x1]['name']);}function rotateLogFiles(){const _0x34e984=_0x4cb281,_0xa5d883=fs[_0x34e984(0x312)](logspath+_0x34e984(0x277)),_0x35d38f=_0xa5d883['size']/0x400;if(_0x35d38f>0x64){let _0x345442=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x345442['sort']((_0x34fdfc,_0x8e1861)=>_0x34fdfc[_0x34e984(0x234)]<_0x8e1861[_0x34e984(0x234)]?0x1:_0x8e1861['name']<_0x34fdfc[_0x34e984(0x234)]?-0x1:0x0),_0x345442['forEach'](_0x4bdd90=>{const _0x411d22=_0x34e984;if(_0x4bdd90['name']==_0x411d22(0x22d))fs[_0x411d22(0x31f)](logspath+_0x4bdd90['name'],logspath+'output-003.log');if(_0x4bdd90[_0x411d22(0x234)]==_0x411d22(0x23e))fs['copyFileSync'](logspath+_0x4bdd90[_0x411d22(0x234)],logspath+'output-002.log');_0x4bdd90[_0x411d22(0x234)]=='output-000.log'&&(fs[_0x411d22(0x31f)](logspath+_0x4bdd90[_0x411d22(0x234)],logspath+_0x411d22(0x23e)),fs[_0x411d22(0x2fc)](logspath+_0x4bdd90[_0x411d22(0x234)],''));});}}async function zipFiles(_0x829f){const _0x1e4da5=_0x4cb281;let _0x3ad937;if(_0x829f=='logs')_0x3ad937=logspath;if(_0x829f==_0x1e4da5(0x24b))_0x3ad937=configpath;if(_0x829f==_0x1e4da5(0x1f9))_0x3ad937=configpath;let _0x830505=fs[_0x1e4da5(0x276)](_0x3ad937,{'withFileTypes':!![]});const _0xc58b09=new JSZip();_0x830505[_0x1e4da5(0x2f1)](_0x1cafaf=>{const _0x1e2242=_0x1e4da5;if(!_0x1cafaf[_0x1e2242(0x28f)]()){let _0x3aee5d=fs['readFileSync'](_0x3ad937+_0x1cafaf[_0x1e2242(0x234)]);if(_0x829f==_0x1e2242(0x24b)){const _0x1b4577=/^bot-[0-9]{3}-config.json$/,_0x3d284e=_0x1b4577[_0x1e2242(0x1fa)](_0x1cafaf[_0x1e2242(0x234)]);if(_0x3d284e){const _0x4a2fa1=JSON[_0x1e2242(0x228)](_0x3aee5d);if(_0x4a2fa1[_0x1e2242(0x1d9)][0x0]){_0x4a2fa1[_0x1e2242(0x1d9)][0x0][_0x1e2242(0x373)]=_0x1e2242(0x191),_0x4a2fa1[_0x1e2242(0x1d9)][0x0]['apiSecret']=_0x1e2242(0x191);if(_0x4a2fa1['bot'][0x0]['apiPassword'])_0x4a2fa1['bot'][0x0][_0x1e2242(0x30d)]=_0x1e2242(0x191);}_0x3aee5d=JSON['stringify'](_0x4a2fa1,null,0x2);}if(_0x1cafaf[_0x1e2242(0x234)]==_0x1e2242(0x3b2)){const _0x3bfb6a=JSON[_0x1e2242(0x228)](_0x3aee5d);if(_0x3bfb6a['settings'][_0x1e2242(0x1c5)])_0x3bfb6a[_0x1e2242(0x1ef)][_0x1e2242(0x1c5)]=![];if(_0x3bfb6a[_0x1e2242(0x1ef)]['bbPassword'])_0x3bfb6a[_0x1e2242(0x1ef)]['bbPassword']='***';if(_0x3bfb6a[_0x1e2242(0x1ef)][_0x1e2242(0x288)])_0x3bfb6a['settings']['telegramToken']='***';if(_0x3bfb6a[_0x1e2242(0x1ef)][_0x1e2242(0x2a5)])_0x3bfb6a[_0x1e2242(0x1ef)]['telegramChatId']=null;if(_0x3bfb6a[_0x1e2242(0x1ef)][_0x1e2242(0x1c1)])_0x3bfb6a[_0x1e2242(0x1ef)][_0x1e2242(0x1c1)]='***';_0x3aee5d=JSON['stringify'](_0x3bfb6a,null,0x2);}if(_0x1cafaf['name']!=_0x1e2242(0x1ce))_0xc58b09[_0x1e2242(0x3a9)](_0x1cafaf['name'],_0x3aee5d);}else _0xc58b09[_0x1e2242(0x3a9)](_0x1cafaf[_0x1e2242(0x234)],_0x3aee5d);}});const _0x3cc049=await _0xc58b09[_0x1e4da5(0x268)]({'type':_0x1e4da5(0x1af),'base64':![],'compression':_0x1e4da5(0x1c6)});fs[_0x1e4da5(0x2fc)](zippath+(_0x829f+_0x1e4da5(0x236)),_0x3cc049,_0x1e4da5(0x24f));}async function unzipFile(_0x2d6759,_0x23e582){const _0x52f55f=_0x4cb281;fs[_0x52f55f(0x276)](configpath,{'withFileTypes':!![]})[_0x52f55f(0x2f1)](_0x38a322=>{const _0x5243a9=_0x52f55f;if(!_0x38a322[_0x5243a9(0x28f)]())fs[_0x5243a9(0x18f)](configpath+_0x38a322['name']);});const _0x59fcf6=fs[_0x52f55f(0x1e3)](_0x2d6759+_0x23e582,_0x52f55f(0x24f)),_0x4f040e=await JSZip['loadAsync'](_0x59fcf6,{'base64':![],'checkCRC32':!![]});for(const _0x5ada5d of Object[_0x52f55f(0x28c)](_0x4f040e[_0x52f55f(0x2d0)])){const _0x32a5d5=_0x4f040e['files'][_0x5ada5d],_0x4942a7=await _0x32a5d5[_0x52f55f(0x1ee)](_0x52f55f(0x1af));fs[_0x52f55f(0x2fc)](configpath+_0x32a5d5[_0x52f55f(0x234)],_0x4942a7);}fs[_0x52f55f(0x276)](temppath,{'withFileTypes':!![]})[_0x52f55f(0x2f1)](_0x34f8d7=>{const _0x2d11dd=_0x52f55f;if(!_0x34f8d7[_0x2d11dd(0x28f)]())fs[_0x2d11dd(0x18f)](temppath+_0x34f8d7[_0x2d11dd(0x234)]);}),logger['debug'](_0x52f55f(0x362)),process[_0x52f55f(0x19b)]({'restore':!![]},_0x525801=>{});}async function getPublicIp(){const _0x1a5c61=_0x4cb281;try{const _0x6a0ce=await axios[_0x1a5c61(0x35c)]('https://api.ipify.org?format=json');publicip=_0x6a0ce['data']['ip'];}catch(_0x222fa1){}}async function triggerAnalytics(){const _0x512379=_0x4cb281;if(!publicip)await getPublicIp();const _0x315358=getBotsWithMode();let _0x47947a=0x0;_0x315358[_0x512379(0x2f1)](_0x6646f3=>{const _0x5718f8=_0x512379;if(_0x6646f3['status']===_0x5718f8(0x2d6))_0x47947a++;});const _0x4b5afa=getBotExchanges();mixpanel[_0x512379(0x198)](_0x512379(0x239),{'distinct_id':settings[_0x512379(0x39b)],'ip':publicip,'version':serverversion,'numbots':_0x315358[_0x512379(0x38c)],'numbotsenabled':_0x47947a,'exchanges':_0x4b5afa,'environment':environment});}async function getMessages(){const _0x4b69d2=_0x4cb281,_0x20d461=_0x4b69d2(0x27b),_0x1c2ec3=new GraphQLClient(_0x20d461),_0x142166={'authorization':_0x4b69d2(0x319)},_0x597fb0=serverversion['split']('.'),_0x4dda7f=_0x597fb0[0x0]+'.'+_0x597fb0[0x1],_0x5286d5=Math[_0x4b69d2(0x354)](settings[_0x4b69d2(0x23c)],settings[_0x4b69d2(0x27a)]),_0x277e8c={'last':parseInt(_0x5286d5),'bbm':_0x4dda7f},_0x434dc3=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x434170;try{_0x434170=await _0x1c2ec3[_0x4b69d2(0x216)](_0x434dc3,_0x277e8c,_0x142166);}catch(_0x507ece){}if(_0x434170&&_0x434170[_0x4b69d2(0x22a)]){let _0x5432d5=settings[_0x4b69d2(0x23c)];newMessages=[];for(const _0x491a1b of _0x434170[_0x4b69d2(0x22a)]){newMessages[_0x4b69d2(0x2de)](_0x491a1b);let _0xa7374c=![];_0x491a1b['bbvNew']&&(updateSetting(_0x4b69d2(0x31b),_0x491a1b[_0x4b69d2(0x255)]),_0xa7374c=isNewerVersion(serverversion,_0x491a1b[_0x4b69d2(0x255)])||serverversion==_0x491a1b[_0x4b69d2(0x255)]);if(!_0xa7374c&&_0x491a1b['number']>_0x5432d5){if(_0x491a1b[_0x4b69d2(0x25d)]==='any'||serverversion[_0x4b69d2(0x2af)](_0x491a1b[_0x4b69d2(0x25d)])){let _0x2db6af=''+_0x491a1b[_0x4b69d2(0x358)]+'\x0a\x0a'+_0x491a1b[_0x4b69d2(0x2e8)];const _0x167efe=await sendTelegramMsg(toTelegramMarkdown(_0x2db6af),'Markdown');if(_0x167efe)_0x5432d5=_0x491a1b[_0x4b69d2(0x1e0)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x5432d5),emitMessages();}}function emitMessages(){const _0x2c5980=_0x4cb281,_0x33a1bd=settings[_0x2c5980(0x27a)];let _0x238b73=[];newMessages['forEach'](_0x242f2b=>{const _0x37e95e=_0x2c5980;_0x242f2b['number']>_0x33a1bd&&_0x238b73[_0x37e95e(0x2de)](_0x242f2b);}),_0x238b73[_0x2c5980(0x38c)]>0x0&&getAllClients()[_0x2c5980(0x2f1)](_0x1bb2e8=>{const _0x2da0c4=_0x2c5980;getSocket(_0x1bb2e8['id'])[_0x2da0c4(0x2f5)](_0x2da0c4(0x2e8),_0x238b73);});}function _0x1713(_0x882ca4,_0x4dcceb){const _0x5bc508=_0xa6f5();return _0x1713=function(_0x3aa144,_0x1b7156){_0x3aa144=_0x3aa144-0x18b;let _0xa6f567=_0x5bc508[_0x3aa144];return _0xa6f567;},_0x1713(_0x882ca4,_0x4dcceb);}function confirmMessage(_0x5ce870){const _0x5c7858=_0x4cb281;updateSetting(_0x5c7858(0x27a),Number(_0x5ce870));}function isNewerVersion(_0x25f6d6,_0x3195d2){const _0x30d65d=_0x4cb281,_0x13acd5=_0x3195d2[_0x30d65d(0x295)]('.'),_0x1fddcc=_0x25f6d6['split']('.');for(var _0x2ecd6b=0x0;_0x2ecd6b<_0x1fddcc[_0x30d65d(0x38c)];_0x2ecd6b++){const _0x523a30=~~_0x1fddcc[_0x2ecd6b],_0x394e96=~~_0x13acd5[_0x2ecd6b];if(_0x523a30>_0x394e96)return!![];if(_0x523a30<_0x394e96)return![];}return![];}function toTelegramMarkdown(_0x4fdd79){const _0x58bfd8=_0x4cb281,_0x3c8521=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x1bc18f=/\*{2}(.+?)\*{2}/gim;return _0x4fdd79=_0x4fdd79[_0x58bfd8(0x203)](_0x3c8521,_0x58bfd8(0x19a))[_0x58bfd8(0x203)](_0x1bc18f,_0x58bfd8(0x2ee)),_0x4fdd79;}async function validateConfigFile(){const _0xe998ae=_0x4cb281,_0x6ca52=dbConfig[_0xe998ae(0x35c)]('bots')[_0xe998ae(0x388)](_0xe998ae(0x2df))[_0xe998ae(0x345)]()||[];if(_0x6ca52['length']==0x0){let _0x2d604e=0x0,_0x49f311=[];const _0x2c9e09=/^bot-([0-9]{3})-config.json$/,_0x293b99=fs[_0xe998ae(0x276)](configpath);_0x293b99[_0xe998ae(0x2f1)](_0x3f7af5=>{const _0x2f61a5=_0xe998ae,_0x46b439=_0x2c9e09[_0x2f61a5(0x331)](_0x3f7af5);if(_0x46b439){const _0x1905e3=_0x46b439[0x1];let _0x13d6c4=getBotAttributes(_0x1905e3);_0x49f311['push']({'botID':_0x1905e3,'botname':_0x13d6c4[_0x2f61a5(0x27e)],'status':_0x2f61a5(0x392),'live':_0x2f61a5(0x37f)}),_0x2d604e++;}}),_0x2d604e!=0x0&&(dbConfig[_0xe998ae(0x35c)](_0xe998ae(0x1fd))[_0xe998ae(0x222)](_0x49f311)['write'](),config=_0x49f311,restoredConfigFile=_0x2d604e);}}async function restoreConfigNotify(_0xd77342){const _0x4e874b=_0x4cb281;let _0x50f535;if(restoredConfigFile==0x1)_0x50f535=_0x4e874b(0x2a9);else _0x50f535=_0x4e874b(0x380);if(_0xd77342)io['to'](_0x4e874b(0x32a))[_0x4e874b(0x2f5)](_0x4e874b(0x37a),_0x50f535);else{logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x4e874b(0x2d1)](_0x50f535),logger[_0x4e874b(0x2d1)](_0x4e874b(0x2c8)),logger[_0x4e874b(0x2d1)]('');if(tgBot&&settings[_0x4e874b(0x2a5)]&&settings['telegramEvents']!='orders')await sendTelegram(settings['telegramChatId'],_0x4e874b(0x224)+_0x50f535);}}function decryptRSA(_0x426a03,_0xa88e04){const _0x1df345=_0x4cb281,_0x257889=forge['pki'][_0x1df345(0x275)](_0x426a03),_0x433941=_0x257889[_0x1df345(0x294)](forge[_0x1df345(0x338)][_0x1df345(0x1e5)](_0xa88e04),_0x1df345(0x2b1),{'md':forge['md'][_0x1df345(0x39e)][_0x1df345(0x25b)](),'mgf1':{'md':forge['md'][_0x1df345(0x39e)][_0x1df345(0x25b)]()}});return _0x433941;}function validateCredentials(_0x3ac1c1,_0x404ca7){const _0x2963c6=_0x4cb281;if(_0x3ac1c1[_0x2963c6(0x27f)]==settings[_0x2963c6(0x23b)]&&bcrypt[_0x2963c6(0x383)](_0x3ac1c1[_0x2963c6(0x310)],settings[_0x2963c6(0x2c9)])){if(settings[_0x2963c6(0x34f)])return{'allow':![],'reason':_0x2963c6(0x357),'token':null};else{const _0x541a40=generateLoginToken(_0x404ca7);return{'allow':!![],'reason':_0x2963c6(0x2ce),'token':_0x541a40};}}else return{'allow':![],'reason':_0x2963c6(0x243),'token':null};}function refreshToken(_0x34f5a2){const _0x3323c7=generateLoginToken(_0x34f5a2);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x3323c7};}function validateAccess(_0x401a07,_0x3dfe94,_0x1e0461){const _0x1ab777=_0x4cb281,_0x209473=_0x1e0461?_0x1e0461:devices[_0x3dfe94]['ip'];let _0x2178ee;const _0x31f286=_0x3add06=>{const _0x588823=_0x1713;if(settings[_0x588823(0x1c5)]){if(settings[_0x588823(0x34f)]){if(telegram2FaApproved(_0x3dfe94)){const _0xb17a85=generateLoginToken(_0x3dfe94);return{'allow':!![],'reason':_0x588823(0x2da),'token':_0xb17a85};}else return{'allow':![],'reason':_0x588823(0x284),'token':null};}else return _0x2178ee=validToken(_0x3add06,_0x3dfe94),_0x2178ee[_0x588823(0x2c7)]('success')?{'allow':!![],'reason':_0x588823(0x232),'token':_0x3add06}:{'allow':![],'reason':_0x588823(0x284),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x1ab777(0x38a)]){let _0x2b6c61=[...settings[_0x1ab777(0x2ea)],_0x1ab777(0x206),_0x1ab777(0x18c),_0x1ab777(0x1a6)];if(_0x2b6c61[_0x1ab777(0x336)](_0x209473))return _0x31f286(_0x401a07);else{_0x2178ee=validToken(_0x401a07,_0x3dfe94);if(_0x2178ee[_0x1ab777(0x2c7)]('success'))return _0x31f286(_0x401a07);else{if(telegramIpApproved(_0x3dfe94)){const _0x346841=generateToken(_0x3dfe94);return _0x2178ee=_0x31f286(_0x401a07),_0x2178ee[_0x1ab777(0x368)]?{'allow':!![],'reason':_0x1ab777(0x325),'token':_0x346841}:_0x2178ee;}else return settings[_0x1ab777(0x2a1)]?{'allow':![],'reason':_0x1ab777(0x205),'token':null}:{'allow':![],'reason':_0x1ab777(0x278),'token':null};}}}else return _0x31f286(_0x401a07);}function timelyDecrypt(_0x21ffad,_0x4c870e,_0x3f7ff4='@'){const _0x2bb7e3=_0x4cb281;if(_0x21ffad)try{const _0x133d20=decryptRSA(secure[_0x2bb7e3(0x3ac)],_0x21ffad),_0x59514e=_0x133d20[_0x2bb7e3(0x295)](_0x3f7ff4)[0x0],_0x38a59d=_0x133d20[_0x2bb7e3(0x295)](_0x3f7ff4)[0x1],_0x204ed0=new Date()[_0x2bb7e3(0x2aa)]();if(_0x4c870e){if(_0x204ed0-_0x38a59d<maxSecretAge*0x3e8)return _0x59514e;else return![];}else return _0x59514e;}catch(_0x3ceebe){return![];}else return![];}const validToken=(_0x3de51c,_0x59b785)=>{const _0x3b60cd=_0x4cb281,_0x588f75=devices[_0x59b785]['ip'];if(!_0x3de51c)return{'error':_0x3b60cd(0x2b4)};for(let _0x233616 of blacklist){if(_0x233616['token']==_0x3de51c)return{'error':'Token\x20blacklisted'};}let _0x285804;try{_0x285804=jwt[_0x3b60cd(0x2eb)](_0x3de51c,secure['secret']+_0x59b785);}catch{return{'error':_0x3b60cd(0x250)};}if(!_0x285804[_0x3b60cd(0x2c7)](_0x3b60cd(0x317))&&!_0x285804[_0x3b60cd(0x2c7)]('username')||!_0x285804[_0x3b60cd(0x2c7)](_0x3b60cd(0x356)))return{'error':_0x3b60cd(0x2c3)};if(!_0x285804[_0x3b60cd(0x2c7)](_0x3b60cd(0x27f))&&_0x285804[_0x3b60cd(0x2c7)](_0x3b60cd(0x317))){const {clientip:_0x310dd7}=_0x285804;return _0x588f75==_0x310dd7?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x3b60cd(0x1c2)};}else{if(_0x285804[_0x3b60cd(0x2c7)](_0x3b60cd(0x27f))&&_0x285804[_0x3b60cd(0x2c7)](_0x3b60cd(0x317))){const {username:_0x498f6f,clientip:_0xc34642}=_0x285804;return settings[_0x3b60cd(0x23b)]==_0x498f6f&&_0x588f75==_0xc34642?{'success':_0x3b60cd(0x296)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x1680f3=>{const _0x557f12=_0x4cb281;if(_0x1680f3){const _0x5d348e=devices[_0x1680f3]['ip'];return jwt[_0x557f12(0x2ed)]({'username':settings[_0x557f12(0x23b)],'clientip':_0x5d348e},secure[_0x557f12(0x260)]+_0x1680f3,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x407fbe=>{const _0x331806=_0x4cb281;if(_0x407fbe){const _0x3e53d1=devices[_0x407fbe]['ip'];return jwt[_0x331806(0x2ed)]({'clientip':_0x3e53d1},secure['secret']+_0x407fbe,{'expiresIn':devices[_0x407fbe]['telegramIpApproval']['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x2f8c63=>{const _0x15a171=_0x4cb281;let _0x19f97e=![];return devices[_0x2f8c63][_0x15a171(0x2ff)]&&devices[_0x2f8c63][_0x15a171(0x2ff)][_0x15a171(0x2b6)]!=_0x15a171(0x2a3)&&(_0x19f97e=devices[_0x2f8c63][_0x15a171(0x2ff)][_0x15a171(0x317)]==devices[_0x2f8c63]['ip']&&new Date()[_0x15a171(0x2aa)]()-devices[_0x2f8c63]['telegramIpApproval'][_0x15a171(0x1c0)]<devices[_0x2f8c63][_0x15a171(0x2ff)][_0x15a171(0x2b6)]*0x3c*0x3e8),_0x19f97e;},telegram2FaApproved=_0x1c05d5=>{const _0x331d58=_0x4cb281;let _0x362876=![];return devices[_0x1c05d5][_0x331d58(0x207)]&&devices[_0x1c05d5]['telegram2FaApproval']['expiry']!='reject'&&(_0x362876=devices[_0x1c05d5][_0x331d58(0x207)][_0x331d58(0x317)]==devices[_0x1c05d5]['ip']&&new Date()[_0x331d58(0x2aa)]()-devices[_0x1c05d5][_0x331d58(0x207)][_0x331d58(0x1c0)]<devices[_0x1c05d5]['telegram2FaApproval'][_0x331d58(0x2b6)]*0x3c*0x3e8),_0x362876;},normalizeIP=_0x35af48=>{const _0x1a95b9=_0x4cb281;let _0x5dfae2=null,_0x442258=null;if(ipaddr[_0x1a95b9(0x31d)](_0x35af48)){const _0x5d74ff=ipaddr[_0x1a95b9(0x228)](_0x35af48);_0x5d74ff[_0x1a95b9(0x2dc)]()===_0x1a95b9(0x2a0)?(_0x5d74ff[_0x1a95b9(0x22b)]()&&(_0x5dfae2=_0x5d74ff[_0x1a95b9(0x1e1)]()['toString']()),_0x442258=_0x5d74ff['toString']()):(_0x5dfae2=_0x5d74ff[_0x1a95b9(0x1cc)](),_0x442258=_0x5d74ff[_0x1a95b9(0x1c4)]()[_0x1a95b9(0x1cc)]());}return{'show':_0x5dfae2?_0x5dfae2:_0x442258,'store':_0x442258};};function formatDate(_0x5220c2){const _0x1068b7=_0x4cb281;return _0x5220c2[_0x1068b7(0x1ac)]()+'/'+(_0x5220c2['getMonth']()+0x1)['toString']()[_0x1068b7(0x1b2)](0x2,'0')+'/'+_0x5220c2[_0x1068b7(0x314)]()[_0x1068b7(0x1cc)]()['padStart'](0x2,'0')+'\x20'+_0x5220c2[_0x1068b7(0x223)]()[_0x1068b7(0x1cc)]()[_0x1068b7(0x1b2)](0x2,'0')+':'+_0x5220c2[_0x1068b7(0x1e4)]()[_0x1068b7(0x1cc)]()['padStart'](0x2,'0')+':'+_0x5220c2['getSeconds']()[_0x1068b7(0x1cc)]()[_0x1068b7(0x1b2)](0x2,'0');}function sleep(_0x102090){return new Promise(_0x69edb6=>setTimeout(_0x69edb6,_0x102090));}