const _0x4455e6=_0x53e2;(function(_0x5bdd6e,_0x2f46b9){const _0x3b892b=_0x53e2,_0x18eb37=_0x5bdd6e();while(!![]){try{const _0x57543c=parseInt(_0x3b892b(0x243))/0x1+parseInt(_0x3b892b(0x104))/0x2*(-parseInt(_0x3b892b(0x1b8))/0x3)+-parseInt(_0x3b892b(0x2dd))/0x4+-parseInt(_0x3b892b(0x2c7))/0x5*(-parseInt(_0x3b892b(0x2d5))/0x6)+parseInt(_0x3b892b(0x2d6))/0x7+parseInt(_0x3b892b(0x2f9))/0x8*(parseInt(_0x3b892b(0x143))/0x9)+parseInt(_0x3b892b(0x200))/0xa*(-parseInt(_0x3b892b(0x14a))/0xb);if(_0x57543c===_0x2f46b9)break;else _0x18eb37['push'](_0x18eb37['shift']());}catch(_0x28fb9d){_0x18eb37['push'](_0x18eb37['shift']());}}}(_0x18cc,0xe5d5c));const _0x4c2a3f=function(){let _0x2de97f=!![];return function(_0x131e6f,_0x4cec91){const _0x5aee7a=_0x2de97f?function(){const _0x585225=_0x53e2;if(_0x4cec91){const _0x2f2148=_0x4cec91[_0x585225(0x1b3)](_0x131e6f,arguments);return _0x4cec91=null,_0x2f2148;}}:function(){};return _0x2de97f=![],_0x5aee7a;};}(),_0x10aa6c=_0x4c2a3f(this,function(){const _0x2035e0=_0x53e2;return _0x10aa6c[_0x2035e0(0x31c)]()[_0x2035e0(0x304)](_0x2035e0(0x244))[_0x2035e0(0x31c)]()['constructor'](_0x10aa6c)[_0x2035e0(0x304)]('(((.+)+)+)+$');});_0x10aa6c();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require(_0x4455e6(0x208)),fs=require('fs'),fns=require(_0x4455e6(0x2cf)),low=require(_0x4455e6(0x14b)),FileSync=require(_0x4455e6(0x22e)),path=require(_0x4455e6(0x1e8)),crypto=require(_0x4455e6(0x2d8)),forge=require(_0x4455e6(0x1ef)),bcrypt=require(_0x4455e6(0x19e)),jwt=require(_0x4455e6(0x266)),ipaddr=require(_0x4455e6(0x262)),argv=require(_0x4455e6(0x2cd))(process[_0x4455e6(0x110)][_0x4455e6(0x23b)](0x2))[_0x4455e6(0x110)],uuidRandom=require(_0x4455e6(0x198)),{Telegraf,Markup}=require(_0x4455e6(0x211)),Mixpanel=require(_0x4455e6(0x2c2)),axios=require(_0x4455e6(0x177)),{GraphQLClient,gql}=require(_0x4455e6(0x183)),util=require(_0x4455e6(0x215)),fileUpload=require(_0x4455e6(0x291)),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv['port']||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x4455e6(0x1fb)](PORT)&&(console[_0x4455e6(0x130)](_0x4455e6(0x159)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x4455e6(0x1cd)](0x1));const HOST=argv[_0x4455e6(0x2e8)]||null,userID=argv[_0x4455e6(0x1c4)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x4455e6(0x1d1)][_0x4455e6(0x2fb)];let bbpath='bb/',bbpath2='';const botfile='bot.js',configfile=_0x4455e6(0x1c1),settingsfile=_0x4455e6(0x20b),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x4455e6(0x2a2))[_0x4455e6(0x295)]||_0x4455e6(0x138),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x4455e6(0x176)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4455e6(0x117)),configpath=userID?bbpath+_0x4455e6(0x285)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x4455e6(0x2de),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x4455e6(0x13d),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x4455e6(0x1b7),loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x4455e6(0x20f)+userID+'/':bbpath+_0x4455e6(0x20f);!fs['existsSync'](configpath)&&fs[_0x4455e6(0x131)](configpath);!fs[_0x4455e6(0x176)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x4455e6(0x176)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x4455e6(0x176)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x4455e6(0x176)](temppath)&&fs[_0x4455e6(0x131)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);function _0x53e2(_0x30b94a,_0x3a01af){const _0xe73529=_0x18cc();return _0x53e2=function(_0x10aa6c,_0x4c2a3f){_0x10aa6c=_0x10aa6c-0xfc;let _0x18ccf5=_0xe73529[_0x10aa6c];return _0x18ccf5;},_0x53e2(_0x30b94a,_0x3a01af);}dbConfig[_0x4455e6(0x139)]({'bots':[]})[_0x4455e6(0x26a)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x4455e6(0x139)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x4455e6(0x169),'onepagemode':![],'marketcapApi':''}})[_0x4455e6(0x26a)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4455e6(0x139)]({'secure':{},'blacklist':[]})[_0x4455e6(0x26a)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x4455e6(0x255)](_0x4455e6(0x2ac),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x4455e6(0x12f)]&&(settings[_0x4455e6(0x12f)]!=''&&settings['telegramToken']!=_0x4455e6(0x2e1))&&settings['telegramUsername']&&settings[_0x4455e6(0x155)]!='')initTelegram();const parseColor=(_0x4ce233,_0x391dcf)=>{const _0x258b00=_0x4455e6,_0xd131bd=/#[A-Z]{3}#/g;if(typeof _0x4ce233=='string'){!_0x391dcf?_0x4ce233=_0x4ce233[_0x258b00(0x241)](_0xd131bd,''):(_0x4ce233=_0x4ce233[_0x258b00(0x241)](/#BLU#/g,_0x258b00(0x1c9)),_0x4ce233=_0x4ce233[_0x258b00(0x241)](/#RED#/g,'\x1b[31m'),_0x4ce233=_0x4ce233[_0x258b00(0x241)](/#YEL#/g,_0x258b00(0x1de)),_0x4ce233=_0x4ce233[_0x258b00(0x241)](/#MAG#/g,_0x258b00(0x250)),_0x4ce233=_0x4ce233[_0x258b00(0x241)](/#CYA#/g,_0x258b00(0x24e)),_0x4ce233=_0x4ce233[_0x258b00(0x241)](/#RES#/g,_0x258b00(0x21c)));;}return _0x4ce233;},logger={'screen':_0x5de924=>{const _0x5a0a51=_0x4455e6;console[_0x5a0a51(0x130)](parseColor(_0x5de924,!![]));},'simple':_0xe6f970=>{const _0x1a0dcd=_0x4455e6;console[_0x1a0dcd(0x130)](parseColor(_0xe6f970,!![])),loggerfile['write'](util['format'](parseColor(_0xe6f970,![]))+'\x0a');},'full':async _0x137500=>{const _0x1fa007=_0x4455e6,_0x37de17=getTimeStamp()+_0x1fa007(0x219)+_0x137500;console[_0x1fa007(0x130)](parseColor(_0x37de17,!![])),loggerfile[_0x1fa007(0x26a)](util['format'](parseColor(_0x37de17,![]))+'\x0a');if(tgBot&&settings[_0x1fa007(0x253)]&&settings[_0x1fa007(0x1c7)]!=_0x1fa007(0x178))await sendTelegram(settings[_0x1fa007(0x253)],_0x1fa007(0x24d)+parseColor(_0x137500,![]));},'debug':async(_0x56cf7d,_0x24abdf='')=>{const _0x764333=_0x4455e6,_0x5653a7=getTimeStamp()+_0x764333(0x11c)+_0x56cf7d;if(debugging)console[_0x764333(0x130)](parseColor(_0x5653a7,!![]));loggerfile[_0x764333(0x26a)](util[_0x764333(0x11d)](parseColor(_0x5653a7,![]))+'\x0a');if(_0x24abdf){if(debugging)console['log'](_0x24abdf);loggerfile[_0x764333(0x26a)](util[_0x764333(0x11d)](_0x24abdf)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x41d8c6){const _0x5cf36b=_0x4455e6;_0x41d8c6['toString']()[_0x5cf36b(0x149)](_0x5cf36b(0x28f))?(logger[_0x5cf36b(0x185)](_0x5cf36b(0x2cc)+_0x41d8c6['port']+_0x5cf36b(0x121)),process[_0x5cf36b(0x254)]({'terminate':!![]},_0x2a9334=>{})):logger[_0x5cf36b(0x185)](_0x41d8c6);}),process['on'](_0x4455e6(0x1cd),()=>{const _0x5d0831=_0x4455e6;stopAllBots(),process[_0x5d0831(0x1cd)](0x0);}),process['on'](_0x4455e6(0x1c0),()=>{const _0x4e0639=_0x4455e6;stopAllBots(),process[_0x4e0639(0x1cd)](0x0);}),process['on']('SIGINT',()=>{const _0x23b528=_0x4455e6;stopAllBots(),process[_0x23b528(0x1cd)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4455e6(0x2a2))[_0x4455e6(0x27b)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x4455e6(0x1d4)),app=express(),http=require(_0x4455e6(0x21a))[_0x4455e6(0x2a5)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x4455e6(0x2d1)](_0x4455e6(0x2fa),async(_0x48bf73,_0x23a42c)=>{const _0x79bfc0=_0x4455e6,_0x160dc8=_0x48bf73['params'][_0x79bfc0(0x17a)],_0x3718da=getClientsWithBotID('botmanager'),_0x5a158e=_0x48bf73['headers'][_0x79bfc0(0x1d3)],_0x34d3b1=timelyDecrypt(_0x5a158e,![]),_0x4827b7=_0x3718da[_0x79bfc0(0x298)](_0x100b94=>_0x100b94['uuid']==_0x34d3b1);if(_0x4827b7){const _0x17cbca=normalizeIP(_0x48bf73[_0x79bfc0(0x218)]['remoteAddress'])[_0x79bfc0(0x2bb)],_0x3a433e=_0x48bf73[_0x79bfc0(0x101)][_0x79bfc0(0x2f4)];if(validateAccess(_0x3a433e,_0x34d3b1,_0x17cbca)['allow'])_0x160dc8==_0x79bfc0(0x150)&&await backupConfigFiles(),await zipFiles(_0x160dc8),_0x23a42c[_0x79bfc0(0x25a)](zippath+(_0x160dc8+_0x79bfc0(0x15e)),_0x3e0cae=>{const _0x1b322f=_0x79bfc0;_0x3e0cae&&(logger[_0x1b322f(0x308)](_0x1b322f(0x118)+_0x160dc8),logger[_0x1b322f(0x185)](_0x3e0cae));});else logger[_0x79bfc0(0x308)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x160dc8+_0x79bfc0(0x23f));}else logger[_0x79bfc0(0x308)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x160dc8+'\x20(2)');}),app[_0x4455e6(0x128)](_0x4455e6(0x29d),async(_0x2c6df1,_0x427f72)=>{const _0x152209=_0x4455e6,_0x541a63=getClientsWithBotID(_0x152209(0x151)),_0x449b56=_0x2c6df1[_0x152209(0x101)][_0x152209(0x1d3)],_0xae34e3=timelyDecrypt(_0x449b56,![]),_0x370a27=_0x541a63[_0x152209(0x298)](_0x1cab39=>_0x1cab39[_0x152209(0x1d3)]==_0xae34e3);logger[_0x152209(0x189)](_0x152209(0x270));if(_0x370a27){const _0xab69d1=normalizeIP(_0x2c6df1[_0x152209(0x218)][_0x152209(0x16d)])[_0x152209(0x2bb)],_0x455798=_0x2c6df1[_0x152209(0x101)][_0x152209(0x2f4)];if(validateAccess(_0x455798,_0xae34e3,_0xab69d1)[_0x152209(0x2c3)]){if(_0x2c6df1[_0x152209(0x251)]){const _0x27d851=_0x2c6df1[_0x152209(0x251)][_0x152209(0x190)];await _0x27d851['mv'](temppath+_0x27d851['name']),_0x427f72[_0x152209(0x254)]({'status':!![],'message':_0x152209(0x17b)});const _0x46490d=getBotsWithMode();_0x46490d['length']>0x0?confirmRestore(temppath,_0x27d851[_0x152209(0x166)]):unzipFile(temppath,_0x27d851[_0x152209(0x166)]);}}else logger['full'](_0x152209(0x313));}else logger[_0x152209(0x308)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app['use'](express[_0x4455e6(0x152)](path[_0x4455e6(0x2c1)](__dirname,bbpath2,_0x4455e6(0x2e3)))),app[_0x4455e6(0x1a0)](express['static'](path[_0x4455e6(0x2c1)](__dirname,bbpath2,_0x4455e6(0x1f1)))),app['get']('/',function(_0x481744,_0x4ee221){const _0x51056d=_0x4455e6;_0x4ee221[_0x51056d(0x297)](path[_0x51056d(0x2c1)](__dirname,bbpath2,_0x51056d(0x2e3),_0x51056d(0x158)));}),app[_0x4455e6(0x2d1)]('/:bot',function(_0x4c367a,_0x2b554d){const _0x3621a5=_0x4455e6;_0x2b554d[_0x3621a5(0x297)](path[_0x3621a5(0x2c1)](__dirname,bbpath2,_0x3621a5(0x1f1),_0x3621a5(0x158)));}),app[_0x4455e6(0x2d1)]('/:bot/portfolio',(_0x25aa2e,_0x590786)=>{const _0x4fd74c=_0x4455e6;_0x590786['sendFile'](path[_0x4fd74c(0x2c1)](__dirname,bbpath2,_0x4fd74c(0x1f1),_0x4fd74c(0x158)));}),app['get'](_0x4455e6(0x18e),(_0x464aa5,_0x5e97a1)=>{const _0x5abdfb=_0x4455e6;_0x5e97a1['sendFile'](path[_0x5abdfb(0x2c1)](__dirname,bbpath2,_0x5abdfb(0x1f1),_0x5abdfb(0x158)));}),app[_0x4455e6(0x2d1)](_0x4455e6(0x10b),(_0x19dd3d,_0x2312e1)=>{const _0x186b7e=_0x4455e6;_0x2312e1['sendFile'](path[_0x186b7e(0x2c1)](__dirname,bbpath2,_0x186b7e(0x1f1),_0x186b7e(0x158)));}),app[_0x4455e6(0x2d1)]('/:bot/history',(_0x203b9f,_0x6f4a01)=>{const _0x37ecdc=_0x4455e6;_0x6f4a01[_0x37ecdc(0x297)](path[_0x37ecdc(0x2c1)](__dirname,bbpath2,_0x37ecdc(0x1f1),'index.html'));}),app[_0x4455e6(0x2d1)](_0x4455e6(0x2be),(_0x43c2a2,_0x27ebf6)=>{const _0x2b442f=_0x4455e6;_0x27ebf6[_0x2b442f(0x297)](path[_0x2b442f(0x2c1)](__dirname,bbpath2,_0x2b442f(0x1f1),'index.html'));}),app[_0x4455e6(0x2d1)]('/:bot/support',(_0x50b764,_0x16786f)=>{const _0xd512d7=_0x4455e6;_0x16786f[_0xd512d7(0x297)](path[_0xd512d7(0x2c1)](__dirname,bbpath2,_0xd512d7(0x1f1),_0xd512d7(0x158)));});if(HOST)http[_0x4455e6(0x1e4)](PORT,HOST);else http['listen'](PORT);const io=require(_0x4455e6(0x13e))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1e098d=_0x4455e6;let _0x17c66c=_0x1e098d(0x252);const _0x1c6ccc=networkInterfaces(),_0x21454a={};for(const _0x41ee71 of Object['keys'](_0x1c6ccc)){for(const _0x23482d of _0x1c6ccc[_0x41ee71]){if((_0x23482d[_0x1e098d(0x24a)]=='IPv4'||_0x23482d[_0x1e098d(0x24a)]==0x4)&&!_0x23482d[_0x1e098d(0x209)]){const _0x5a1df0=ipaddr[_0x1e098d(0x2e7)](_0x23482d['address'])[_0x1e098d(0x126)]();_0x5a1df0!=_0x1e098d(0x13a)&&(!_0x21454a[_0x41ee71]&&(_0x21454a[_0x41ee71]=[]),_0x21454a[_0x41ee71][_0x1e098d(0x1e6)](_0x23482d[_0x1e098d(0x1e5)]),_0x17c66c=_0x23482d[_0x1e098d(0x1e5)]);}}}return{'serverip':_0x17c66c,'netinterfaces':_0x21454a};}async function startServer(){const _0x1ab05b=_0x4455e6,{serverip:_0x519fbb,netinterfaces:_0x447ab8}=getServerIP();logger['simple'](''),logger[_0x1ab05b(0x185)](_0x1ab05b(0x1fe)),await logger[_0x1ab05b(0x308)](_0x1ab05b(0x21e)+serverversion+'#RES#\x20'+(environment==_0x1ab05b(0x24b)?_0x1ab05b(0x22d):'')+'\x0a'+(_0x1ab05b(0x1f9)+PORT+_0x1ab05b(0x1da))+(_0x1ab05b(0x114)+_0x519fbb+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x1ab05b(0x185)](_0x1ab05b(0x1fe));if(config[_0x1ab05b(0x216)]!=0x0)for(const _0x20bfd3 of config){const _0x31cec3=_0x20bfd3['mode']=='auto'?'a':'m';if(_0x20bfd3[_0x1ab05b(0x136)]==_0x1ab05b(0x2db)||_0x20bfd3['status']==_0x1ab05b(0x2d3))await logger[_0x1ab05b(0x308)](_0x1ab05b(0x322)+_0x31cec3+_0x1ab05b(0x26f)+_0x20bfd3[_0x1ab05b(0x279)]+'\x20|\x20'+_0x20bfd3[_0x1ab05b(0x147)]),startBot([_0x20bfd3[_0x1ab05b(0x279)],userID],{'cwd':bbpath},function(_0x4e561b){if(_0x4e561b)logger['full'](_0x4e561b);});else(_0x20bfd3[_0x1ab05b(0x136)]=='disabled'||_0x20bfd3[_0x1ab05b(0x136)]==_0x1ab05b(0x27d))&&await logger[_0x1ab05b(0x308)]('Idling\x20('+_0x31cec3+')\x20\x20\x20|\x20Bot\x20'+_0x20bfd3[_0x1ab05b(0x279)]+'\x20|\x20'+_0x20bfd3[_0x1ab05b(0x147)]);}else!newBot&&logger[_0x1ab05b(0x185)](_0x1ab05b(0x268));if(newBot)addBot();logger[_0x1ab05b(0x185)]('-----------------------------------------------------------------------------------'),logger[_0x1ab05b(0x185)](''),await logger[_0x1ab05b(0x189)](_0x1ab05b(0x306)+nodeversion),await logger[_0x1ab05b(0x189)](_0x1ab05b(0x2fc),_0x447ab8);}function startSocket(){const _0x5cc84f=_0x4455e6;io['on'](_0x5cc84f(0x1a6),_0x3e7c13=>{const _0x26bbf8=_0x5cc84f;let _0x4c3179,_0x4b4b84,_0x20e494,_0x5956d5,_0x1be2bc;const _0x4f53be=_0x3e7c13['handshake']['headers'][_0x26bbf8(0x20c)];_0x4b4b84=_0x4f53be[_0x26bbf8(0x100)](/bot[0-9]{3}/);if(_0x4b4b84)_0x20e494=_0x4b4b84[0x0][_0x26bbf8(0x100)](/[0-9]{3}/);if(_0x20e494)_0x4c3179=_0x20e494[0x0];else _0x4c3179=_0x26bbf8(0x151);const _0x209d6c=_0x3e7c13[_0x26bbf8(0x2ef)][_0x26bbf8(0x11a)][_0x26bbf8(0x228)];if(!_0x209d6c)_0x3e7c13[_0x26bbf8(0x1ca)]('status',{'publicKey':secure[_0x26bbf8(0x2e6)]});else{_0x5956d5=timelyDecrypt(_0x209d6c,![]);if(!_0x5956d5)_0x3e7c13['emit'](_0x26bbf8(0x136),{'publicKey':secure[_0x26bbf8(0x2e6)]});else{_0x1be2bc=normalizeIP(_0x3e7c13[_0x26bbf8(0x2ab)]['remoteAddress'])[_0x26bbf8(0x2bb)];if(!devices[_0x5956d5])devices[_0x5956d5]={'uuid':_0x5956d5,'access':{'token':null}};devices[_0x5956d5]['ip']=_0x1be2bc;const _0x4d3098=addClient(_0x3e7c13['id'],_0x5956d5,_0x4c3179);setAccess(_0x4d3098),emitMessages(),_0x3e7c13['on'](_0x26bbf8(0x28a),_0x31011b=>{const _0x362c25=_0x26bbf8,_0x1c76d7=timelyDecrypt(_0x31011b[_0x362c25(0x1cc)],!![],_0x362c25(0x1d2));if(_0x1c76d7){_0x31011b={'username':_0x31011b['username'],'password':_0x1c76d7},devices[_0x5956d5][_0x362c25(0x25e)]=validateCredentials(_0x31011b,_0x5956d5);if(devices[_0x5956d5][_0x362c25(0x25e)][_0x362c25(0x2c3)]==![]&&devices[_0x5956d5][_0x362c25(0x25e)]['reason']==_0x362c25(0x1ba))_0x3e7c13[_0x362c25(0x1ca)](_0x362c25(0x136),{'access':devices[_0x5956d5][_0x362c25(0x25e)]}),loginAccess2FA(_0x5956d5,_0x1be2bc);else{if(devices[_0x5956d5]['access'][_0x362c25(0x2c3)]==![]&&devices[_0x5956d5][_0x362c25(0x25e)]['reason']=='invalid\x20credentials')_0x3e7c13['emit'](_0x362c25(0x136),{'access':devices[_0x5956d5][_0x362c25(0x25e)]});else devices[_0x5956d5]['access'][_0x362c25(0x2c3)]&&devices[_0x5956d5]['access'][_0x362c25(0x288)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x5956d5)[_0x362c25(0x1f3)](_0x416449=>{setAccess(_0x416449);}),logger[_0x362c25(0x189)](_0x362c25(0x283)+_0x5956d5[_0x362c25(0x23b)](-0x8)),setTokenRefresh(_0x5956d5),setSessionTimeout(_0x362c25(0x28a),_0x5956d5));}}else logger[_0x362c25(0x308)](_0x362c25(0x30a));}),_0x3e7c13['on']('reset-password',()=>{resetPassword();}),_0x3e7c13['on'](_0x26bbf8(0x272),_0x4403c9=>{removeClient(_0x3e7c13['id']);}),_0x4c3179==_0x26bbf8(0x151)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4b7438){const _0x36a314=_0x4455e6;if(_0x4b7438!=_0x36a314(0x151)&&config['apiKey']!=''){if(pid[_0x4b7438])pid[_0x4b7438][_0x36a314(0x254)]({'function':_0x36a314(0x226),'args':null});}_0x4b7438!='botmanager'&&broadcastToBots(_0x36a314(0x162),JSON['stringify'](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0x1edb38=>{const _0x1f62e7=_0x53e2;getSocket(_0x1edb38['id'])[_0x1f62e7(0x1ca)](_0x1f62e7(0x136),{'access':{'allow':![],'reason':_0x1f62e7(0x275),'token':null}});});}function getSocket(_0x57157c){const _0x443fa0=_0x4455e6,_0x1b99f2=io[_0x443fa0(0x2d4)][_0x443fa0(0x2d1)]('/');return _0x1b99f2[_0x443fa0(0x2c6)][_0x443fa0(0x2d1)](_0x57157c);}function setAccess(_0x57d52f){const _0x22d6af=_0x4455e6,_0x4853b6=getSocket(_0x57d52f['id']),_0x4c00ba=_0x57d52f['uuid'],_0x5d6b4c=_0x57d52f[_0x22d6af(0x2ee)];devices[_0x4c00ba]['access']=validateAccess(devices[_0x4c00ba][_0x22d6af(0x25e)][_0x22d6af(0x224)],_0x4c00ba),logger['debug'](_0x22d6af(0x124)+devices[_0x4c00ba][_0x22d6af(0x25e)]['reason']+_0x22d6af(0x19c)+_0x57d52f['id'][_0x22d6af(0x23b)](-0x8)+_0x22d6af(0x1bd)+_0x4c00ba[_0x22d6af(0x23b)](-0x8)),_0x4853b6['join'](_0x4c00ba);if(devices[_0x4c00ba]['access'][_0x22d6af(0x2c3)]){_0x4853b6[_0x22d6af(0x2c1)](_0x5d6b4c);if(_0x5d6b4c==_0x22d6af(0x151))initializeSocketBotManager(_0x4853b6);else initializeSocketBot(_0x4853b6);initClient(_0x5d6b4c);}devices[_0x4c00ba][_0x22d6af(0x25e)][_0x22d6af(0x224)]&&devices[_0x4c00ba][_0x22d6af(0x25e)][_0x22d6af(0x288)]==_0x22d6af(0x153)&&setSessionTimeout(_0x22d6af(0x1ec),_0x4c00ba),devices[_0x4c00ba]['access'][_0x22d6af(0x224)]&&devices[_0x4c00ba]['access'][_0x22d6af(0x288)]==_0x22d6af(0x171)&&setSessionTimeout(_0x22d6af(0x28a),_0x4c00ba),_0x4853b6['emit'](_0x22d6af(0x136),{'status':_0x57d52f['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4c00ba][_0x22d6af(0x25e)],'externalip':devices[_0x4c00ba]['ip'],'publicKey':secure[_0x22d6af(0x2e6)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x4c00ba][_0x22d6af(0x25e)][_0x22d6af(0x2c3)]==![]&&devices[_0x4c00ba][_0x22d6af(0x25e)][_0x22d6af(0x288)]==_0x22d6af(0x2e4)&&temporaryAccess2FA(_0x4c00ba,devices[_0x4c00ba]['ip']);}function setSessionTimeout(_0x203b1e,_0x49f9eb){const _0x5c0e06=_0x4455e6;let _0xdfc06;if(_0x203b1e==_0x5c0e06(0x28a))_0xdfc06=loginExpiry*0x3c*0x3e8;else _0xdfc06=devices[_0x49f9eb][_0x5c0e06(0x179)][_0x5c0e06(0x230)]*0x3c*0x3e8-(new Date()[_0x5c0e06(0x287)]()-devices[_0x49f9eb]['telegramIpApproval'][_0x5c0e06(0x109)]);if(devices[_0x49f9eb]['pidExpireLogin'])clearTimeout(devices[_0x49f9eb][_0x5c0e06(0x2f7)]);devices[_0x49f9eb]['pidExpireLogin']=setTimeout(()=>{const _0x3d021f=_0x5c0e06;if(devices[_0x49f9eb][_0x3d021f(0x296)])clearTimeout(devices[_0x49f9eb][_0x3d021f(0x296)]);removeSocketListeners(_0x49f9eb),addBlacklist(_0x49f9eb),devices[_0x49f9eb]['telegramIpApproval']=null,devices[_0x49f9eb][_0x3d021f(0x142)]=null,devices[_0x49f9eb][_0x3d021f(0x25e)][_0x3d021f(0x224)]=null,logger[_0x3d021f(0x189)](_0x3d021f(0x315)+_0x49f9eb[_0x3d021f(0x23b)](-0x8)),devices[_0x49f9eb][_0x3d021f(0x25e)]=validateAccess(devices[_0x49f9eb][_0x3d021f(0x25e)][_0x3d021f(0x224)],_0x49f9eb),!(devices[_0x49f9eb][_0x3d021f(0x25e)][_0x3d021f(0x2c3)]&&devices[_0x49f9eb][_0x3d021f(0x25e)][_0x3d021f(0x288)]=='login\x20not\x20required')&&(_0x203b1e==_0x3d021f(0x28a)?io['to'](_0x49f9eb)[_0x3d021f(0x1ca)]('status',{'access':{'allow':![],'reason':_0x3d021f(0x321),'token':null}}):io['to'](_0x49f9eb)[_0x3d021f(0x1ca)](_0x3d021f(0x136),{'access':{'allow':![],'reason':_0x3d021f(0x11f),'token':null}})),devices[_0x49f9eb][_0x3d021f(0x25e)]['token']=null;},_0xdfc06);}function setTokenRefresh(_0x182025){if(devices[_0x182025]['pidRefreshToken'])clearTimeout(devices[_0x182025]['pidRefreshToken']);devices[_0x182025]['pidRefreshToken']=setTimeout(()=>{const _0x6595ff=_0x53e2;getClientsWithUuid(_0x182025)[_0x6595ff(0x216)]!=0x0?(devices[_0x182025][_0x6595ff(0x25e)]=refreshToken(_0x182025),io['to'](_0x182025)[_0x6595ff(0x1ca)](_0x6595ff(0x136),{'status':_0x6595ff(0x290),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x182025]['access'],'externalip':devices[_0x182025]['ip'],'publicKey':secure[_0x6595ff(0x2e6)],'validInstallation':validInstallation}),setTokenRefresh(_0x182025)):clearTimeout(devices[_0x182025]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1a3d01){const _0x447871=_0x4455e6,_0x12519a=getClient(_0x1a3d01['id'])[_0x447871(0x1d3)];_0x1a3d01[_0x447871(0x1ca)]('bots',config),_0x1a3d01[_0x447871(0x1ca)](_0x447871(0x2ae),cleanSettings()),_0x1a3d01['on'](_0x447871(0x2eb),_0x573b7e=>{const _0x274570=_0x447871;if(validateAccess(_0x573b7e,_0x12519a)[_0x274570(0x2c3)])addBot();else logger[_0x274570(0x308)](_0x274570(0x27a));}),_0x1a3d01['on'](_0x447871(0x1d8),(_0x574f8a,_0x2b1f4d)=>{const _0x325f23=_0x447871;if(validateAccess(_0x2b1f4d,_0x12519a)[_0x325f23(0x2c3)])toggleBot(_0x574f8a['botID'],_0x574f8a['status'],_0x574f8a[_0x325f23(0x292)]);else logger['full'](_0x325f23(0x1e3));}),_0x1a3d01['on'](_0x447871(0x286),(_0x283e21,_0x5721ce)=>{const _0x3bbfa2=_0x447871;if(validateAccess(_0x5721ce,_0x12519a)[_0x3bbfa2(0x2c3)])toggleBotMode(_0x283e21);else logger[_0x3bbfa2(0x308)](_0x3bbfa2(0x1e3));}),_0x1a3d01['on'](_0x447871(0x187),(_0x1eabca,_0x383d31)=>{const _0x1652b6=_0x447871;if(validateAccess(_0x383d31,_0x12519a)[_0x1652b6(0x2c3)])deleteBot(_0x1eabca);else logger[_0x1652b6(0x308)](_0x1652b6(0x2b4));}),_0x1a3d01['on'](_0x447871(0x2c4),(_0x243ec0,_0x4499ac)=>{const _0x2c49db=_0x447871;if(validateAccess(_0x4499ac,_0x12519a)[_0x2c49db(0x2c3)])storeSettings(_0x243ec0,!![]);else logger[_0x2c49db(0x308)](_0x2c49db(0x10f));}),_0x1a3d01['on'](_0x447871(0x1cf),_0x845f9d=>{const _0x5c08ac=_0x447871;if(validateAccess(_0x845f9d,_0x12519a)[_0x5c08ac(0x2c3)])updateBB('update');else logger['full'](_0x5c08ac(0x27e));}),_0x1a3d01['on'](_0x447871(0x1ea),_0x262a0c=>{const _0x27a317=_0x447871;if(validateAccess(_0x262a0c,_0x12519a)[_0x27a317(0x2c3)])updateBB(_0x27a317(0x1fc));else logger[_0x27a317(0x308)](_0x27a317(0x186));}),_0x1a3d01['on'](_0x447871(0x1f8),_0x2ac27a=>{const _0x4b2de6=_0x447871;if(validateAccess(_0x2ac27a,_0x12519a)[_0x4b2de6(0x2c3)]){const _0x356885=getClient(_0x1a3d01['id']);if(_0x356885)getBackupFiles(_0x356885[_0x4b2de6(0x1d3)]);else logger[_0x4b2de6(0x308)](_0x4b2de6(0x1b6));}else logger[_0x4b2de6(0x308)](_0x4b2de6(0x2a1));}),_0x1a3d01['on'](_0x447871(0x16a),(_0x170108,_0x53403b)=>{const _0x4f71f3=_0x447871;if(validateAccess(_0x53403b,_0x12519a)[_0x4f71f3(0x2c3)])restoreBackupFile(_0x170108);else logger[_0x4f71f3(0x308)](_0x4f71f3(0x19f));}),_0x1a3d01['on'](_0x447871(0x1f6),_0x426498=>{const _0xdfd903=_0x447871;if(validateAccess(_0x426498,_0x12519a)[_0xdfd903(0x2c3)])getMessages();else logger[_0xdfd903(0x308)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1a3d01['on']('confirm-message',(_0x4e0d49,_0x2cd697)=>{const _0x3f22d8=_0x447871;if(validateAccess(_0x2cd697,_0x12519a)[_0x3f22d8(0x2c3)])confirmMessage(_0x4e0d49);else logger[_0x3f22d8(0x308)](_0x3f22d8(0x112));}),_0x1a3d01['on']('logout',_0x1553f1=>{const _0x2c7bbf=_0x447871;if(validateAccess(_0x1553f1,_0x12519a)[_0x2c7bbf(0x2c3)]){if(devices[_0x12519a][_0x2c7bbf(0x296)])clearTimeout(devices[_0x12519a][_0x2c7bbf(0x296)]);if(devices[_0x12519a]['pidExpireLogin'])clearTimeout(devices[_0x12519a][_0x2c7bbf(0x2f7)]);removeSocketListeners(getClient(_0x1a3d01['id'])[_0x2c7bbf(0x1d3)]),addBlacklist(_0x12519a),devices[_0x12519a][_0x2c7bbf(0x179)]=null,devices[_0x12519a][_0x2c7bbf(0x142)]=null,devices[_0x12519a]['access'][_0x2c7bbf(0x224)]=null,logger['debug'](_0x2c7bbf(0x2f3)+_0x12519a[_0x2c7bbf(0x23b)](-0x8)),io['to'](getClient(_0x1a3d01['id'])['uuid'])[_0x2c7bbf(0x1ca)](_0x2c7bbf(0x136),{'access':{'allow':![],'reason':_0x2c7bbf(0x2a9),'token':null}});}else logger['full'](_0x2c7bbf(0x238));});}function initializeSocketBot(_0x2fa23c){const _0x3fd3bd=_0x4455e6,_0x37a85b=getClient(_0x2fa23c['id'])[_0x3fd3bd(0x2ee)],_0x758ed7=getClient(_0x2fa23c['id'])[_0x3fd3bd(0x1d3)];_0x2fa23c['on']('get-logs',(_0x4f7bc2,_0x1023b0)=>{const _0x37b519=_0x3fd3bd;if(validateAccess(_0x1023b0,_0x758ed7)[_0x37b519(0x2c3)]){if(pid[_0x37a85b])pid[_0x37a85b][_0x37b519(0x254)]({'function':_0x37b519(0x307),'args':_0x4f7bc2});}else logger[_0x37b519(0x308)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x2fa23c['on'](_0x3fd3bd(0x1ed),(_0x122e19,_0x5df506)=>{const _0x38a082=_0x3fd3bd;if(validateAccess(_0x5df506,_0x758ed7)[_0x38a082(0x2c3)]){if(pid[_0x37a85b])pid[_0x37a85b][_0x38a082(0x254)]({'function':_0x38a082(0x1a5),'args':_0x122e19});}else logger[_0x38a082(0x308)](_0x38a082(0x132));}),_0x2fa23c['on']('get-portfolio',(_0x45ee9f,_0x102e42)=>{const _0x12bdc7=_0x3fd3bd;if(validateAccess(_0x102e42,_0x758ed7)[_0x12bdc7(0x2c3)]){if(pid[_0x37a85b])pid[_0x37a85b][_0x12bdc7(0x254)]({'function':'getPortfolio','args':_0x45ee9f});}else logger[_0x12bdc7(0x308)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x2fa23c['on'](_0x3fd3bd(0x207),(_0x3f28ce,_0xd94041)=>{const _0x239e43=_0x3fd3bd;if(validateAccess(_0xd94041,_0x758ed7)[_0x239e43(0x2c3)]){if(pid[_0x37a85b])pid[_0x37a85b][_0x239e43(0x254)]({'function':_0x239e43(0x2df),'args':_0x3f28ce});}else logger[_0x239e43(0x308)](_0x239e43(0x21b));}),_0x2fa23c['on']('store-headless',(_0x56bac1,_0x59a41c)=>{const _0x4476ec=_0x3fd3bd;if(validateAccess(_0x59a41c,_0x758ed7)[_0x4476ec(0x2c3)]){if(pid[_0x37a85b])pid[_0x37a85b][_0x4476ec(0x254)]({'function':_0x4476ec(0x102),'args':_0x56bac1});}else logger[_0x4476ec(0x308)](_0x4476ec(0x2b2));}),_0x2fa23c['on']('store-fiat',(_0xfd8ece,_0x3e26ec)=>{const _0x52c793=_0x3fd3bd;if(validateAccess(_0x3e26ec,_0x758ed7)[_0x52c793(0x2c3)]){if(pid[_0x37a85b])pid[_0x37a85b][_0x52c793(0x254)]({'function':_0x52c793(0x2ca),'args':_0xfd8ece});}else logger['full'](_0x52c793(0x1bb));}),_0x2fa23c['on'](_0x3fd3bd(0x146),_0x5c8e97=>{const _0x20fb3e=_0x3fd3bd;if(validateAccess(_0x5c8e97,_0x758ed7)[_0x20fb3e(0x2c3)]){if(pid[_0x37a85b])pid[_0x37a85b]['send']({'function':'resetHistory','args':null});}else logger[_0x20fb3e(0x308)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x2fa23c['on'](_0x3fd3bd(0x27c),_0x2be148=>{const _0x1da7f1=_0x3fd3bd;if(validateAccess(_0x2be148,_0x758ed7)[_0x1da7f1(0x2c3)]){if(pid[_0x37a85b])pid[_0x37a85b]['send']({'function':_0x1da7f1(0x2c5),'args':null});}else logger['full'](_0x1da7f1(0x213));}),_0x2fa23c['on'](_0x3fd3bd(0x305),(_0x32069d,_0x36617d)=>{const _0x176015=_0x3fd3bd;if(validateAccess(_0x36617d,_0x758ed7)[_0x176015(0x2c3)]){if(pid[_0x37a85b])pid[_0x37a85b][_0x176015(0x254)]({'function':_0x176015(0x319),'args':_0x32069d});}else logger[_0x176015(0x308)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x2fa23c['on'](_0x3fd3bd(0x24f),_0x39e82f=>{const _0x194bcc=_0x3fd3bd;if(validateAccess(_0x39e82f,_0x758ed7)[_0x194bcc(0x2c3)]){if(pid[_0x37a85b])pid[_0x37a85b]['send']({'function':_0x194bcc(0x249),'args':null});}else logger['full'](_0x194bcc(0x144));}),_0x2fa23c['on'](_0x3fd3bd(0x1f0),_0x3838f8=>{const _0x202e13=_0x3fd3bd;if(validateAccess(_0x3838f8,_0x758ed7)[_0x202e13(0x2c3)]){if(pid[_0x37a85b])pid[_0x37a85b][_0x202e13(0x254)]({'function':_0x202e13(0x2ed),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x2fa23c['on'](_0x3fd3bd(0x1cf),_0x54f3ee=>{const _0x373547=_0x3fd3bd;if(validateAccess(_0x54f3ee,_0x758ed7)['allow'])updateBB(_0x373547(0x157));else logger[_0x373547(0x308)](_0x373547(0x27e));}),_0x2fa23c['on']('get-messages',_0x4bb400=>{const _0x2845d1=_0x3fd3bd;if(validateAccess(_0x4bb400,_0x758ed7)['allow'])getMessages();else logger[_0x2845d1(0x308)](_0x2845d1(0x2bd));}),_0x2fa23c['on'](_0x3fd3bd(0x134),(_0x19d65e,_0x1dbc0e)=>{const _0x3b7105=_0x3fd3bd;if(validateAccess(_0x1dbc0e,_0x758ed7)[_0x3b7105(0x2c3)])confirmMessage(_0x19d65e);else logger[_0x3b7105(0x308)](_0x3b7105(0x112));}),_0x2fa23c['on'](_0x3fd3bd(0x145),_0x56ee2a=>{const _0x3d2578=_0x3fd3bd;if(validateAccess(_0x56ee2a,_0x758ed7)[_0x3d2578(0x2c3)]){if(devices[_0x758ed7]['pidRefreshToken'])clearTimeout(devices[_0x758ed7][_0x3d2578(0x296)]);if(devices[_0x758ed7][_0x3d2578(0x2f7)])clearTimeout(devices[_0x758ed7][_0x3d2578(0x2f7)]);removeSocketListeners(getClient(_0x2fa23c['id'])['uuid']),addBlacklist(_0x758ed7),devices[_0x758ed7][_0x3d2578(0x179)]=null,devices[_0x758ed7][_0x3d2578(0x142)]=null,devices[_0x758ed7][_0x3d2578(0x25e)][_0x3d2578(0x224)]=null,logger['debug'](_0x3d2578(0x2f3)+_0x758ed7[_0x3d2578(0x23b)](-0x8)),io['to'](getClient(_0x2fa23c['id'])[_0x3d2578(0x1d3)])[_0x3d2578(0x1ca)](_0x3d2578(0x136),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x3d2578(0x308)](_0x3d2578(0x238));});}function removeSocketListeners(_0x5ed8ba){const _0x5c1e93=_0x4455e6;getClientsWithUuid(_0x5ed8ba)[_0x5c1e93(0x1f3)](_0x5f2466=>{const _0x2c78d0=_0x5c1e93;getSocket(_0x5f2466['id'])[_0x2c78d0(0x1bf)]();});}function cleanSettings(){const _0x31dfc2=_0x4455e6;let _0x2fcf91=settings;return settings[_0x31dfc2(0x12f)]&&settings[_0x31dfc2(0x12f)]!=''&&(_0x2fcf91={..._0x2fcf91,'telegramToken':'************'}),settings[_0x31dfc2(0x1cb)]&&settings['bbPassword']!=''&&(_0x2fcf91={..._0x2fcf91,'bbPassword':'************'}),settings['marketcapApi']&&settings[_0x31dfc2(0x20e)]!=''&&(_0x2fcf91={..._0x2fcf91,'marketcapApi':_0x31dfc2(0x2cb)}),(settings[_0x31dfc2(0x1cb)]&&settings[_0x31dfc2(0x1cb)]==_0x31dfc2(0x2e1)||settings[_0x31dfc2(0x12f)]&&settings[_0x31dfc2(0x12f)]==_0x31dfc2(0x2e1)||settings['marketcapApi']&&settings['marketcapApi']==_0x31dfc2(0x2e1))&&(_0x2fcf91={..._0x2fcf91,'restored':{'password':settings['bbPassword']==_0x31dfc2(0x2e1),'telegram':settings[_0x31dfc2(0x12f)]==_0x31dfc2(0x2e1),'marketcap':settings['marketcapApi']==_0x31dfc2(0x2e1)}}),_0x2fcf91;}async function updateBB(_0x53226a){const _0x2382ec=_0x4455e6;await backupConfigFiles(),installingUpdate=!![],config[_0x2382ec(0x1f3)](_0x39338b=>{const _0x623e70=_0x2382ec;restartBot(_0x39338b[_0x623e70(0x279)]);});if(_0x53226a==_0x2382ec(0x157))process[_0x2382ec(0x254)]({'update':!![],'environment':environment},_0x4bbe6c=>{});else _0x53226a==_0x2382ec(0x1fc)&&process['send']({'reinstall':!![],'environment':environment},_0x842107=>{});}function startBot(_0x173480,_0x1e218d,_0x5ec4d8){const _0x37ec79=_0x4455e6;if(debugging)_0x173480[_0x37ec79(0x1e6)]('-d');if(recreate)_0x173480['push']('-r');let _0x292fac=![];const _0x458ec0=_0x173480[0x0];_0x1e218d={..._0x1e218d,'stdio':[_0x37ec79(0x12c),_0x37ec79(0x12c),'inherit',_0x37ec79(0x194)]},pid[_0x458ec0]=childProcess['fork'](botfile,_0x173480,_0x1e218d),pid[_0x458ec0]['on'](_0x37ec79(0x1c3),_0xf21799=>{const _0x53bc3b=_0x37ec79;switch(Object['keys'](_0xf21799)[0x0]){case _0x53bc3b(0x147):updateBotName(_0x458ec0,_0xf21799['botname']);break;case _0x53bc3b(0x1ce):updateBotManager();break;case'status':updateStatus(_0x458ec0,_0xf21799['status']);break;case _0x53bc3b(0x292):updateLive(_0x458ec0,_0xf21799['live']);break;case _0x53bc3b(0x12b):updateLive(_0x458ec0,_0xf21799['started']),io['to'](_0x458ec0)[_0x53bc3b(0x1ca)](_0x53bc3b(0x136),{'access':{'allow':![],'reason':_0x53bc3b(0x275),'token':null}});break;case'stop':_0xf21799[_0x53bc3b(0x258)]==_0x53bc3b(0x1a1)&&restartBot(_0x458ec0);_0xf21799[_0x53bc3b(0x258)]==_0x53bc3b(0x1b0)&&toggleBot(_0x458ec0,_0x53bc3b(0x1f2),_0x53bc3b(0x18c));break;case _0x53bc3b(0x225):sendTelegramBot(_0x458ec0,_0xf21799['telegram']);break;case _0x53bc3b(0x16e):sendTelegramMsg(_0xf21799[_0x53bc3b(0x16e)]);break;case'function':io['to'](_0x458ec0)[_0x53bc3b(0x1ca)](_0xf21799['function'],_0xf21799[_0x53bc3b(0x1a7)]);break;}}),pid[_0x458ec0]['on'](_0x37ec79(0x26c),function(_0x52ec88){if(_0x292fac)return;_0x292fac=!![],_0x5ec4d8(_0x52ec88);}),pid[_0x458ec0]['on'](_0x37ec79(0x1cd),async function(_0x2cdc00){const _0x212b16=_0x37ec79;if(terminating)return;if(installingUpdate){io[_0x212b16(0x31f)]();return;}if(_0x292fac)return;_0x292fac=!![],_0x5ec4d8(null);const _0x51ed26=dbConfig[_0x212b16(0x2d1)](_0x212b16(0x162))['find']({'botID':_0x458ec0})['value']();_0x51ed26&&(_0x51ed26[_0x212b16(0x136)]==_0x212b16(0x2db)||_0x51ed26[_0x212b16(0x136)]=='new')&&(await sleep(0x3e8),updateLive(_0x458ec0,_0x212b16(0x18c)),logger[_0x212b16(0x308)]('Restarting\x20'+botRef(_0x458ec0)),startBot([_0x458ec0,userID],{'cwd':bbpath},function(_0x431a3f){const _0x46c693=_0x212b16;if(_0x431a3f)logger[_0x46c693(0x308)](_0x431a3f);}));});}function stopBot(_0x5b6263){const _0x44da83=_0x4455e6;getClientsWithBotID(_0x5b6263)[_0x44da83(0x1f3)](_0xea3ef9=>{getSocket(_0xea3ef9['id'])['disconnect'](!![]),removeClient(_0xea3ef9['id']);}),pid[_0x5b6263]&&(pid[_0x5b6263]['kill'](),pid[_0x5b6263]=null);}function stopAllBots(){const _0x456d98=_0x4455e6;terminating=!![];const _0x245477=getEnabledBots();_0x245477[_0x456d98(0x1f3)](_0x2dbccc=>{const _0x3a4e1f=_0x456d98;stopBot(_0x2dbccc[_0x3a4e1f(0x279)]);});}function restartBot(_0xfb3550){const _0x1a9bbf=_0x4455e6;if(pid[_0xfb3550])pid[_0xfb3550][_0x1a9bbf(0x1b0)]();}function addBot(){const _0x3f5907=_0x4455e6;let _0xdcd131;for(let _0x2f100c=0x1;_0x2f100c<0x3e9;_0x2f100c++){_0xdcd131=_0x2f100c[_0x3f5907(0x31c)]()['padStart'](0x3,'0');let _0x46b9e=config[_0x3f5907(0x298)](_0x50a232=>_0x50a232[_0x3f5907(0x279)]==_0xdcd131);if(!_0x46b9e)break;}if(_0xdcd131===_0x3f5907(0x13c)){logger['full'](_0x3f5907(0x310));return;}logger[_0x3f5907(0x308)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0xdcd131),dbConfig['get'](_0x3f5907(0x162))[_0x3f5907(0x1e6)]({'botID':_0xdcd131,'botname':'Bot\x20'+_0xdcd131,'status':'new','live':''})['write'](),startBot([_0xdcd131,userID],{'cwd':bbpath},function(_0x35ba87){const _0x6a916b=_0x3f5907;if(_0x35ba87)logger[_0x6a916b(0x308)](_0x35ba87);}),config=getConfiguration(),io['to']('botmanager')[_0x3f5907(0x1ca)]('bots',config),broadcastToBots(_0x3f5907(0x162),JSON[_0x3f5907(0x303)](config));}function deleteBot(_0x21d1db){const _0xad748c=_0x4455e6;getClientsWithBotID(_0x21d1db)[_0xad748c(0x1f3)](_0x339d74=>{const _0xfa76d2=_0xad748c;getSocket(_0x339d74['id'])[_0xfa76d2(0x272)](!![]),removeClient(_0x339d74['id']);}),dbConfig[_0xad748c(0x2d1)]('bots')[_0xad748c(0x204)]({'botID':_0x21d1db})['write'](),logger[_0xad748c(0x308)](_0xad748c(0x1b4)+_0x21d1db),stopBot(_0x21d1db);try{if(fs[_0xad748c(0x176)](path[_0xad748c(0x2c1)](configpath,_0xad748c(0x199)+_0x21d1db+'-config.json')))fs['unlinkSync'](path['join'](configpath,'bot-'+_0x21d1db+_0xad748c(0x30d)));if(fs[_0xad748c(0x176)](path[_0xad748c(0x2c1)](configpath,_0xad748c(0x199)+_0x21d1db+_0xad748c(0x122))))fs[_0xad748c(0x2a3)](path[_0xad748c(0x2c1)](configpath,_0xad748c(0x199)+_0x21d1db+_0xad748c(0x122)));if(fs[_0xad748c(0x176)](path[_0xad748c(0x2c1)](configpath,_0xad748c(0x199)+_0x21d1db+'-performance.json')))fs[_0xad748c(0x2a3)](path[_0xad748c(0x2c1)](configpath,_0xad748c(0x199)+_0x21d1db+_0xad748c(0x15b)));if(fs[_0xad748c(0x176)](path[_0xad748c(0x2c1)](configpath,'bot-'+_0x21d1db+_0xad748c(0x18f))))fs['unlinkSync'](path[_0xad748c(0x2c1)](configpath,_0xad748c(0x199)+_0x21d1db+_0xad748c(0x18f)));}catch(_0x352433){if(_0x352433)logger[_0xad748c(0x308)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x352433);}config=getConfiguration(),io['to'](_0xad748c(0x151))[_0xad748c(0x1ca)](_0xad748c(0x162),config),broadcastToBots(_0xad748c(0x162),JSON['stringify'](config));}function toggleBot(_0x279531,_0x14afd8,_0x11ac7c){const _0x5c0855=_0x4455e6;dbConfig[_0x5c0855(0x2d1)](_0x5c0855(0x162))[_0x5c0855(0x298)]({'botID':_0x279531})[_0x5c0855(0x25f)]({'status':_0x14afd8})[_0x5c0855(0x25f)]({'live':_0x11ac7c})[_0x5c0855(0x26a)]();const _0x4c9df8=botRef(_0x279531);if(_0x14afd8=='enabled'||_0x14afd8==_0x5c0855(0x2d3))logger['full']('Enabled\x20'+_0x4c9df8),startBot([_0x279531,userID],{'cwd':bbpath},function(_0x14600f){const _0x4449c9=_0x5c0855;if(_0x14600f)logger[_0x4449c9(0x308)](_0x14600f);});else(_0x14afd8=='disabled'||_0x14afd8==_0x5c0855(0x27d))&&(logger[_0x5c0855(0x308)](_0x5c0855(0x105)+_0x4c9df8),stopBot(_0x279531));config=getConfiguration(),io['to'](_0x5c0855(0x151))[_0x5c0855(0x1ca)](_0x5c0855(0x162),config),broadcastToBots(_0x5c0855(0x162),JSON['stringify'](config));}function toggleStatus(_0x46f066){const _0x3b3238=_0x4455e6;let _0x4542fe=dbConfig[_0x3b3238(0x2d1)]('bots')[_0x3b3238(0x298)]({'botID':_0x46f066})[_0x3b3238(0x2c9)](),_0x188d3c;if(_0x4542fe[_0x3b3238(0x136)]===_0x3b3238(0x2db))_0x188d3c=_0x3b3238(0x1f2);else{if(_0x4542fe[_0x3b3238(0x136)]===_0x3b3238(0x2d3))_0x188d3c=_0x3b3238(0x27d);else{if(_0x4542fe['status']===_0x3b3238(0x27d))_0x188d3c=_0x3b3238(0x2d3);else{if(_0x4542fe[_0x3b3238(0x136)]===_0x3b3238(0x1f2))_0x188d3c=_0x3b3238(0x2db);}}}return _0x188d3c;}function updateStatus(_0x552b22,_0x568c6f){const _0x1cce2b=_0x4455e6;dbConfig[_0x1cce2b(0x2d1)](_0x1cce2b(0x162))[_0x1cce2b(0x298)]({'botID':_0x552b22})[_0x1cce2b(0x25f)]({'status':_0x568c6f})[_0x1cce2b(0x26a)](),config=getConfiguration(),io['to'](_0x1cce2b(0x151))['emit'](_0x1cce2b(0x162),config),broadcastToBots('bots',JSON[_0x1cce2b(0x303)](config));}function updateLive(_0x45bb74,_0x4b5421){const _0x28eaff=_0x4455e6;dbConfig[_0x28eaff(0x2d1)](_0x28eaff(0x162))['find']({'botID':_0x45bb74})[_0x28eaff(0x25f)]({'live':_0x4b5421})[_0x28eaff(0x26a)](),config=getConfiguration(),io['to']('botmanager')[_0x28eaff(0x1ca)]('bots',config),broadcastToBots(_0x28eaff(0x162),JSON[_0x28eaff(0x303)](config));}function updateBotName(_0x40cf73,_0xe340b8){const _0x2d261a=_0x4455e6;dbConfig[_0x2d261a(0x2d1)](_0x2d261a(0x162))[_0x2d261a(0x298)]({'botID':_0x40cf73})['assign']({'botname':_0xe340b8})['write'](),config=getConfiguration(),io['to'](_0x2d261a(0x151))[_0x2d261a(0x1ca)](_0x2d261a(0x162),config),broadcastToBots(_0x2d261a(0x162),JSON[_0x2d261a(0x303)](config));}function updateBotManager(){const _0x26eea1=_0x4455e6;config=getConfiguration(),io['to'](_0x26eea1(0x151))[_0x26eea1(0x1ca)](_0x26eea1(0x162),config),broadcastToBots(_0x26eea1(0x162),JSON[_0x26eea1(0x303)](config));}function toggleBotMode(_0x2a6efc){const _0x30509c=_0x4455e6;if(pid[_0x2a6efc])pid[_0x2a6efc][_0x30509c(0x254)]({'function':'toggleBotMode','args':null});else{const _0x3bab30=configpath+_0x30509c(0x199)+_0x2a6efc+'-config.json',_0x4b21d9=fs['readFileSync'](_0x3bab30),_0x32bb91=JSON['parse'](_0x4b21d9),_0x50b8b6=_0x32bb91[_0x30509c(0x2ee)][0x0][_0x30509c(0x10e)];_0x32bb91[_0x30509c(0x2ee)][0x0][_0x30509c(0x10e)]=!_0x50b8b6;const _0x198019=JSON[_0x30509c(0x303)](_0x32bb91,null,0x2);fs[_0x30509c(0x1eb)](_0x3bab30,_0x198019),config=getConfiguration(),io['to']('botmanager')[_0x30509c(0x1ca)](_0x30509c(0x162),config),broadcastToBots(_0x30509c(0x162),JSON['stringify'](config));}}function validateTelegram(_0x106b46){const _0x401a3c=_0x4455e6;if(_0x106b46[_0x401a3c(0x2b0)][_0x401a3c(0x210)]!=settings[_0x401a3c(0x155)]&&'@'+_0x106b46['from'][_0x401a3c(0x210)]!=settings[_0x401a3c(0x155)]||_0x106b46[_0x401a3c(0x261)]['id']!=settings[_0x401a3c(0x253)])return sendTelegram(_0x106b46[_0x401a3c(0x261)]['id'],_0x401a3c(0x248),{'parse_mode':_0x401a3c(0x2b5)}),![];return!![];}function botRef(_0x1792ed){const _0x4d468c=_0x4455e6,_0xe892db=getBotAttributes(_0x1792ed),_0x19eb96=_0xe892db['showname']?_0xe892db[_0x4d468c(0x147)]:_0x4d468c(0x31b)+_0x1792ed;return _0x19eb96;}async function initTelegram(){const _0x3ceb1e=_0x4455e6;tgBot&&(await tgBot[_0x3ceb1e(0x258)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x3ceb1e(0x12f)]);let _0x83e566=_0x3ceb1e(0x2a8);_0x83e566+='\x0a',_0x83e566+=_0x3ceb1e(0x11b),_0x83e566+=_0x3ceb1e(0x11e),_0x83e566+=_0x3ceb1e(0x1fa),_0x83e566+=_0x3ceb1e(0x103),_0x83e566+=_0x3ceb1e(0x184),_0x83e566+=_0x3ceb1e(0x15a),_0x83e566+=_0x3ceb1e(0x1e7),_0x83e566+=_0x3ceb1e(0x19d),_0x83e566+=_0x3ceb1e(0x10d),_0x83e566+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x83e566+=_0x3ceb1e(0x201),_0x83e566+=_0x3ceb1e(0x18b),_0x83e566+=_0x3ceb1e(0x164),_0x83e566+=_0x3ceb1e(0x21d),_0x83e566+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x83e566+=_0x3ceb1e(0xfe);let _0x7fd263=_0x3ceb1e(0x214);_0x7fd263+='\x0a',_0x7fd263+=_0x83e566,tgBot[_0x3ceb1e(0x2d7)]((_0x1cbc1f,_0x2c4c75)=>{const _0x3876dc=_0x3ceb1e;logger[_0x3876dc(0x185)](getTimeStamp()+_0x3876dc(0x22a)),logger[_0x3876dc(0x189)](_0x3876dc(0x1ff),_0x1cbc1f);}),tgBot[_0x3ceb1e(0x1a0)](async(_0x348831,_0xab12e3)=>{const _0x170ff8=_0x3ceb1e;if(settings['telegramChatId']||_0x348831[_0x170ff8(0x157)][_0x170ff8(0x1c3)]['text']!='/start'){if(!validateTelegram(_0x348831))return;}_0xab12e3();}),tgBot[_0x3ceb1e(0x1be)](_0x3ceb1e(0x1e1),async _0x50ccf1=>{const _0x10ffc8=_0x3ceb1e;if(_0x50ccf1[_0x10ffc8(0x2b0)]['username']==settings[_0x10ffc8(0x155)]||'@'+_0x50ccf1[_0x10ffc8(0x2b0)][_0x10ffc8(0x210)]==settings[_0x10ffc8(0x155)]){if(!settings[_0x10ffc8(0x253)])updateSetting(_0x10ffc8(0x253),_0x50ccf1[_0x10ffc8(0x261)]['id']);else{if(!validateTelegram(_0x50ccf1))return;}}else{if(!validateTelegram(_0x50ccf1))return;}updateSetting(_0x10ffc8(0x172),!![]),await sendTelegram(_0x50ccf1['chat']['id'],_0x7fd263);}),tgBot['command']('enable',async _0x459071=>{const _0xbeb1b4=_0x3ceb1e;updateSetting(_0xbeb1b4(0x172),!![]),await sendTelegram(_0x459071[_0xbeb1b4(0x261)]['id'],'Notifications\x20enabled');}),tgBot[_0x3ceb1e(0x1be)](_0x3ceb1e(0x22c),async _0x50d689=>{const _0x33f624=_0x3ceb1e;await sendTelegram(_0x50d689[_0x33f624(0x261)]['id'],_0x33f624(0x2fe)),updateSetting(_0x33f624(0x172),![]);}),tgBot[_0x3ceb1e(0x1be)]('config',async _0x48d33e=>{const _0x4cad1c=_0x3ceb1e,_0x36f4ca=Markup['inlineKeyboard']([Markup[_0x4cad1c(0x281)][_0x4cad1c(0x168)](_0x4cad1c(0x229),_0x4cad1c(0x222)),Markup[_0x4cad1c(0x281)][_0x4cad1c(0x168)](_0x4cad1c(0x2d0),_0x4cad1c(0x278)),Markup[_0x4cad1c(0x281)][_0x4cad1c(0x168)](_0x4cad1c(0xfd),_0x4cad1c(0x231))]);_0x48d33e[_0x4cad1c(0x217)](_0x4cad1c(0x30f),_0x36f4ca);}),tgBot['action'](_0x3ceb1e(0x222),async _0x2d621a=>{const _0x5683bf=_0x3ceb1e;_0x2d621a[_0x5683bf(0x2b8)](),updateSetting('telegramEvents','orders'),updateSetting(_0x5683bf(0x172),!![]),await sendTelegram(_0x2d621a[_0x5683bf(0x261)]['id'],_0x5683bf(0x21f));}),tgBot[_0x3ceb1e(0x141)](_0x3ceb1e(0x278),async _0x385971=>{const _0x1c7ab7=_0x3ceb1e;_0x385971['editMessageReplyMarkup'](),updateSetting(_0x1c7ab7(0x1c7),_0x1c7ab7(0x123)),updateSetting(_0x1c7ab7(0x172),!![]),await sendTelegram(_0x385971[_0x1c7ab7(0x261)]['id'],_0x1c7ab7(0x160));}),tgBot[_0x3ceb1e(0x141)](_0x3ceb1e(0x231),async _0x4912f7=>{const _0xfffe29=_0x3ceb1e;_0x4912f7[_0xfffe29(0x2b8)](),updateSetting(_0xfffe29(0x1c7),_0xfffe29(0x12a)),updateSetting(_0xfffe29(0x172),!![]),await sendTelegram(_0x4912f7['chat']['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x3ceb1e(0x1be)](_0x3ceb1e(0x136),async _0x44f736=>{const _0x576e4b=_0x3ceb1e,_0x4f5a10=getBotsWithMode();let _0x445a42=_0x576e4b(0x203);config['forEach'](_0x1f2050=>{const _0xa8d559=_0x576e4b,_0x456d16=_0x4f5a10[_0xa8d559(0x298)](_0x26a2d3=>_0x26a2d3[_0xa8d559(0x279)]==_0x1f2050['botID'])[_0xa8d559(0x236)];_0x445a42+='Bot\x20'+_0x1f2050[_0xa8d559(0x279)]+':\x20'+_0x1f2050[_0xa8d559(0x136)]+'\x20|\x20'+_0x456d16+_0xa8d559(0x1bc)+_0x1f2050[_0xa8d559(0x292)]+'\x0a';}),_0x445a42+='\x0a',_0x445a42+=_0x576e4b(0x165),_0x445a42+=!settings[_0x576e4b(0x172)]?'Notifications\x20disabled\x0a':_0x576e4b(0x129),_0x445a42+=settings[_0x576e4b(0x172)]?settings[_0x576e4b(0x1c7)]==_0x576e4b(0x12a)?_0x576e4b(0x314):_0x576e4b(0x2fd)+settings[_0x576e4b(0x1c7)]+_0x576e4b(0x299):'',await sendTelegram(_0x44f736[_0x576e4b(0x261)]['id'],_0x445a42,{'parse_mode':_0x576e4b(0x2b5)});}),tgBot['command'](_0x3ceb1e(0x1a1),async _0x104614=>{const _0x276e03=_0x3ceb1e,_0x5d1d56=getEnabledBots();if(_0x5d1d56[_0x276e03(0x216)]==0x0)await sendTelegram(_0x104614[_0x276e03(0x261)]['id'],_0x276e03(0x30e));else{if(_0x5d1d56[_0x276e03(0x216)]>0x1)_0x5d1d56[_0x276e03(0x1e6)]({'botID':'all'});let _0x1454ce=[],_0x19d66b=[];const _0x17a6ae=_0x5d1d56['length']%0x4==0x0||_0x5d1d56[_0x276e03(0x216)]%0x4==0x3||_0x5d1d56['length']%0x3==0x1?0x4:0x3;let _0x2387c6=0x0;_0x5d1d56[_0x276e03(0x1f3)]((_0x184477,_0x219a75)=>{const _0x251b70=_0x276e03;if(_0x219a75%_0x17a6ae==0x0)_0x19d66b=[];_0x19d66b[_0x251b70(0x1e6)](Markup[_0x251b70(0x281)][_0x251b70(0x168)](_0x184477[_0x251b70(0x279)]=='all'?'All\x20bots':botRef(_0x184477['botID']),_0x251b70(0x12d)+_0x184477[_0x251b70(0x279)])),_0x219a75%_0x17a6ae==0x0&&(_0x1454ce[_0x2387c6]=_0x19d66b,_0x2387c6++);});const _0x12e332=Markup[_0x276e03(0x232)](_0x1454ce);_0x104614[_0x276e03(0x217)](_0x276e03(0x31d),_0x12e332);}}),tgBot[_0x3ceb1e(0x141)](/restart_(.+)/,async _0x5585cf=>{const _0x154a9a=_0x3ceb1e,_0x110268=_0x5585cf[_0x154a9a(0x100)][0x1];_0x5585cf[_0x154a9a(0x2b8)](),_0x110268==_0x154a9a(0x12a)?config[_0x154a9a(0x1f3)](_0x58992c=>{restartBot(_0x58992c['botID']);}):restartBot(_0x110268);}),tgBot[_0x3ceb1e(0x1be)]('on',async _0x5b396c=>{const _0xe980fe=_0x3ceb1e,_0x56fe17=getDisabledBots();if(_0x56fe17[_0xe980fe(0x216)]==0x0)await sendTelegram(_0x5b396c[_0xe980fe(0x261)]['id'],_0xe980fe(0x1b9));else{if(_0x56fe17[_0xe980fe(0x216)]>0x1)_0x56fe17[_0xe980fe(0x1e6)]({'botID':_0xe980fe(0x12a)});let _0x8a8712=[],_0x27be75=[];const _0x4a3632=_0x56fe17[_0xe980fe(0x216)]%0x4==0x0||_0x56fe17['length']%0x4==0x3||_0x56fe17['length']%0x3==0x1?0x4:0x3;let _0x2d1d2f=0x0;_0x56fe17[_0xe980fe(0x1f3)]((_0x337842,_0x213183)=>{const _0x3db9a7=_0xe980fe;if(_0x213183%_0x4a3632==0x0)_0x27be75=[];_0x27be75[_0x3db9a7(0x1e6)](Markup[_0x3db9a7(0x281)][_0x3db9a7(0x168)](_0x337842[_0x3db9a7(0x279)]==_0x3db9a7(0x12a)?_0x3db9a7(0x205):botRef(_0x337842[_0x3db9a7(0x279)]),_0x3db9a7(0x29b)+_0x337842['botID'])),_0x213183%_0x4a3632==0x0&&(_0x8a8712[_0x2d1d2f]=_0x27be75,_0x2d1d2f++);});const _0x479225=Markup['inlineKeyboard'](_0x8a8712);_0x5b396c[_0xe980fe(0x217)](_0xe980fe(0x1a9),_0x479225);}}),tgBot[_0x3ceb1e(0x141)](/on_(.+)/,async _0x4b7994=>{const _0x16afe5=_0x3ceb1e,_0x5ac09a=_0x4b7994['match'][0x1];_0x4b7994[_0x16afe5(0x2b8)]();if(_0x5ac09a==_0x16afe5(0x12a)){const _0x4c23e0=getDisabledBots();await sendTelegram(_0x4b7994[_0x16afe5(0x261)]['id'],_0x16afe5(0x14f)),_0x4c23e0[_0x16afe5(0x1f3)](_0x5e20aa=>{const _0x2836af=_0x16afe5;if(_0x5e20aa[_0x2836af(0x279)]!=_0x2836af(0x12a))toggleBot(_0x5e20aa['botID'],toggleStatus(_0x5e20aa[_0x2836af(0x279)]),'stopped');});}else await sendTelegram(_0x4b7994[_0x16afe5(0x261)]['id'],'Bot\x20Mgr\x20>\x20Starting\x20'+botRef(_0x5ac09a)),toggleBot(_0x5ac09a,toggleStatus(_0x5ac09a),_0x16afe5(0x18c));}),tgBot[_0x3ceb1e(0x1be)](_0x3ceb1e(0x227),async _0x44f56b=>{const _0x1527a9=_0x3ceb1e,_0x32a9cf=getEnabledBots();if(_0x32a9cf['length']==0x0)await sendTelegram(_0x44f56b['chat']['id'],_0x1527a9(0x30e));else{if(_0x32a9cf[_0x1527a9(0x216)]>0x1)_0x32a9cf[_0x1527a9(0x1e6)]({'botID':_0x1527a9(0x12a)});let _0x453a26=[],_0x3a9f54=[];const _0x2eca82=_0x32a9cf[_0x1527a9(0x216)]%0x4==0x0||_0x32a9cf[_0x1527a9(0x216)]%0x4==0x3||_0x32a9cf[_0x1527a9(0x216)]%0x3==0x1?0x4:0x3;let _0x48a57c=0x0;_0x32a9cf[_0x1527a9(0x1f3)]((_0x10769e,_0x541518)=>{const _0xd9cea1=_0x1527a9;if(_0x541518%_0x2eca82==0x0)_0x3a9f54=[];_0x3a9f54[_0xd9cea1(0x1e6)](Markup[_0xd9cea1(0x281)][_0xd9cea1(0x168)](_0x10769e[_0xd9cea1(0x279)]==_0xd9cea1(0x12a)?_0xd9cea1(0x205):botRef(_0x10769e[_0xd9cea1(0x279)]),'off_'+_0x10769e[_0xd9cea1(0x279)])),_0x541518%_0x2eca82==0x0&&(_0x453a26[_0x48a57c]=_0x3a9f54,_0x48a57c++);});const _0x5b89e3=Markup['inlineKeyboard'](_0x453a26);_0x44f56b[_0x1527a9(0x217)](_0x1527a9(0x1e9),_0x5b89e3);}}),tgBot['action'](/off_(.+)/,async _0x537e9d=>{const _0x75cc2f=_0x3ceb1e,_0x104ccc=_0x537e9d[_0x75cc2f(0x100)][0x1];_0x537e9d[_0x75cc2f(0x2b8)]();if(_0x104ccc==_0x75cc2f(0x12a)){const _0x4b111f=getEnabledBots();await sendTelegram(_0x537e9d[_0x75cc2f(0x261)]['id'],_0x75cc2f(0x264)),_0x4b111f[_0x75cc2f(0x1f3)](_0xe44f7b=>{const _0x274809=_0x75cc2f;if(_0xe44f7b[_0x274809(0x279)]!='all')toggleBot(_0xe44f7b['botID'],toggleStatus(_0xe44f7b['botID']),_0x274809(0x18c));});}else await sendTelegram(_0x537e9d[_0x75cc2f(0x261)]['id'],'Bot\x20Mgr\x20>\x20Stopping\x20'+botRef(_0x104ccc)),toggleBot(_0x104ccc,toggleStatus(_0x104ccc),_0x75cc2f(0x18c));}),tgBot[_0x3ceb1e(0x1be)](_0x3ceb1e(0x2af),async _0x3ba5a1=>{const _0x38dfe2=_0x3ceb1e,_0x55baeb=getEnabledBots();if(_0x55baeb[_0x38dfe2(0x216)]==0x0)await sendTelegram(_0x3ba5a1['chat']['id'],_0x38dfe2(0x30e));else{if(_0x55baeb[_0x38dfe2(0x216)]>0x1){let _0x417411=[],_0x16a931=[];const _0x2e2dd0=_0x55baeb['length']%0x4==0x0||_0x55baeb['length']%0x4==0x3||_0x55baeb[_0x38dfe2(0x216)]%0x3==0x1?0x4:0x3;let _0x3515bd=0x0;_0x55baeb['forEach']((_0x2f8d26,_0x44514d)=>{const _0x313649=_0x38dfe2;if(_0x44514d%_0x2e2dd0==0x0)_0x16a931=[];_0x16a931[_0x313649(0x1e6)](Markup['button'][_0x313649(0x168)](botRef(_0x2f8d26[_0x313649(0x279)]),_0x313649(0x23c)+_0x2f8d26[_0x313649(0x279)])),_0x44514d%_0x2e2dd0==0x0&&(_0x417411[_0x3515bd]=_0x16a931,_0x3515bd++);});const _0x3135f3=Markup[_0x38dfe2(0x232)](_0x417411);_0x3ba5a1[_0x38dfe2(0x217)](_0x38dfe2(0x311),_0x3135f3);}else{const _0x58dec4=_0x55baeb[0x0][_0x38dfe2(0x279)];if(pid[_0x58dec4])pid[_0x58dec4][_0x38dfe2(0x254)]({'function':_0x38dfe2(0x16c),'args':null});}}}),tgBot[_0x3ceb1e(0x141)](/metrics_(.+)/,async _0xc12d99=>{const _0x14679e=_0x3ceb1e,_0x4ee7f6=_0xc12d99[_0x14679e(0x100)][0x1];_0xc12d99[_0x14679e(0x2b8)]();if(pid[_0x4ee7f6])pid[_0x4ee7f6][_0x14679e(0x254)]({'function':_0x14679e(0x16c),'args':null});}),tgBot[_0x3ceb1e(0x1be)](_0x3ceb1e(0x1aa),async _0xbb7d9=>{const _0x57014c=_0x3ceb1e,_0x580ee3=getEnabledBots();if(_0x580ee3[_0x57014c(0x216)]==0x0)await sendTelegram(_0xbb7d9[_0x57014c(0x261)]['id'],_0x57014c(0x30e));else{if(_0x580ee3[_0x57014c(0x216)]>0x1){let _0x527311=[],_0x21a859=[];const _0x487db0=_0x580ee3[_0x57014c(0x216)]%0x4==0x0||_0x580ee3[_0x57014c(0x216)]%0x4==0x3||_0x580ee3[_0x57014c(0x216)]%0x3==0x1?0x4:0x3;let _0x2c492b=0x0;_0x580ee3[_0x57014c(0x1f3)]((_0x3acb0d,_0x18b5d0)=>{const _0x40dd5a=_0x57014c;if(_0x18b5d0%_0x487db0==0x0)_0x21a859=[];_0x21a859['push'](Markup['button'][_0x40dd5a(0x168)](botRef(_0x3acb0d[_0x40dd5a(0x279)]),_0x40dd5a(0x206)+_0x3acb0d[_0x40dd5a(0x279)])),_0x18b5d0%_0x487db0==0x0&&(_0x527311[_0x2c492b]=_0x21a859,_0x2c492b++);});const _0xd23a6b=Markup[_0x57014c(0x232)](_0x527311);_0xbb7d9[_0x57014c(0x217)](_0x57014c(0x16f),_0xd23a6b);}else{const _0x4818ba=_0x580ee3[0x0]['botID'];if(pid[_0x4818ba])pid[_0x4818ba][_0x57014c(0x254)]({'function':_0x57014c(0x10a),'args':null});}}}),tgBot[_0x3ceb1e(0x141)](/portfolio_(.+)/,async _0x3ee70f=>{const _0x102f16=_0x3ceb1e,_0x1d9f29=_0x3ee70f[_0x102f16(0x100)][0x1];_0x3ee70f[_0x102f16(0x2b8)]();if(pid[_0x1d9f29])pid[_0x1d9f29][_0x102f16(0x254)]({'function':_0x102f16(0x10a),'args':null});}),tgBot[_0x3ceb1e(0x1be)]('logs',async _0x4ae38a=>{const _0xbd0492=_0x3ceb1e,_0x958bd='logs';await zipFiles(_0x958bd);const _0x51e545=zippath+(_0x958bd+_0xbd0492(0x15e));_0x4ae38a[_0xbd0492(0x1a3)]({'source':_0x51e545})['then'](()=>{})[_0xbd0492(0x2d7)](_0x11e879=>logger[_0xbd0492(0x189)](_0xbd0492(0x127)+_0x958bd+'\x20files\x20over\x20Telegram:',_0x11e879));}),tgBot[_0x3ceb1e(0x1be)](_0x3ceb1e(0x150),async _0x214c9=>{const _0x78efaa=_0x3ceb1e,_0x447575='backup';await backupConfigFiles(),await zipFiles(_0x447575);const _0x39b8a1=zippath+(_0x447575+_0x78efaa(0x15e));_0x214c9[_0x78efaa(0x1a3)]({'source':_0x39b8a1})[_0x78efaa(0x1dd)](()=>{})[_0x78efaa(0x2d7)](_0x457eb3=>logger['debug'](_0x78efaa(0x127)+_0x447575+_0x78efaa(0x2e2),_0x457eb3));}),tgBot[_0x3ceb1e(0x1be)](_0x3ceb1e(0x157),async _0xf4cba9=>{const _0x3900cd=_0x3ceb1e;await getMessages();if(!updateAvailable)await sendTelegram(_0xf4cba9['chat']['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0xf4cba9['chat']['id'],_0x3900cd(0x273));else{const _0x2eac09=Markup[_0x3900cd(0x232)]([Markup['button'][_0x3900cd(0x168)]('Yes',_0x3900cd(0x1fd)),Markup[_0x3900cd(0x281)][_0x3900cd(0x168)]('No',_0x3900cd(0x294))]);_0xf4cba9[_0x3900cd(0x217)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x2eac09);}}}),tgBot[_0x3ceb1e(0x141)](/update_(.+)/,async _0x9806ce=>{const _0x3d294a=_0x3ceb1e,_0x415511=_0x9806ce[_0x3d294a(0x100)][0x1];_0x9806ce[_0x3d294a(0x2b8)](),_0x415511==_0x3d294a(0x2ea)&&(await sendTelegram(_0x9806ce['chat']['id'],_0x3d294a(0x309)),updateBB(_0x3d294a(0x157))),_0x415511=='no'&&await sendTelegram(_0x9806ce[_0x3d294a(0x261)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x3ceb1e(0x1be)](_0x3ceb1e(0x1fc),async _0x423d1f=>{const _0x7c1919=_0x3ceb1e;if(!validInstallation)await sendTelegram(_0x423d1f[_0x7c1919(0x261)]['id'],_0x7c1919(0x140));else{const _0x2c2eea=Markup[_0x7c1919(0x232)]([Markup['button'][_0x7c1919(0x168)](_0x7c1919(0x116),_0x7c1919(0x2bc)),Markup[_0x7c1919(0x281)][_0x7c1919(0x168)]('No',_0x7c1919(0x148))]);_0x423d1f[_0x7c1919(0x217)](_0x7c1919(0x30c),_0x2c2eea);}}),tgBot['action'](/reinstall_(.+)/,async _0x5a16a0=>{const _0x278734=_0x3ceb1e,_0x418d6e=_0x5a16a0[_0x278734(0x100)][0x1];_0x5a16a0[_0x278734(0x2b8)](),_0x418d6e==_0x278734(0x2ea)&&(await sendTelegram(_0x5a16a0[_0x278734(0x261)]['id'],_0x278734(0x17e)),updateBB(_0x278734(0x1fc))),_0x418d6e=='no'&&await sendTelegram(_0x5a16a0[_0x278734(0x261)]['id'],_0x278734(0x2f6));}),tgBot[_0x3ceb1e(0x1be)](_0x3ceb1e(0x167),async _0x5dfc81=>{const _0x1ddf99=_0x3ceb1e,_0x2776fa=getBotsWithMode();if(_0x2776fa[_0x1ddf99(0x216)]==0x0)await sendTelegram(_0x5dfc81[_0x1ddf99(0x261)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x3b09da=[],_0x4ac405=[];const _0x9727a9=0x2;let _0x21391b=0x0;_0x2776fa['forEach']((_0x34f34b,_0x323fa9)=>{const _0x479fdc=_0x1ddf99;if(_0x323fa9%_0x9727a9==0x0)_0x4ac405=[];_0x4ac405['push'](Markup['button'][_0x479fdc(0x168)](botRef(_0x34f34b[_0x479fdc(0x279)])+'\x20('+_0x34f34b[_0x479fdc(0x236)]+')',_0x479fdc(0x188)+_0x34f34b['botID'])),_0x323fa9%_0x9727a9==0x0&&(_0x3b09da[_0x21391b]=_0x4ac405,_0x21391b++);});const _0x22ac8c=Markup['inlineKeyboard'](_0x3b09da);_0x5dfc81['reply'](_0x1ddf99(0x2ba),_0x22ac8c);}}),tgBot[_0x3ceb1e(0x141)](/toggle_(.+)/,async _0x51aed5=>{const _0x3e0424=_0x3ceb1e,_0x33a39e=_0x51aed5[_0x3e0424(0x100)][0x1];_0x51aed5[_0x3e0424(0x2b8)]();const _0x55f32c=getBotsWithMode(),_0x3133a6=_0x55f32c[_0x3e0424(0x298)](_0x53500d=>_0x53500d[_0x3e0424(0x279)]==_0x33a39e),_0x10677f=_0x3133a6['mode']==_0x3e0424(0x28d)?'manual':_0x3e0424(0x28d);await sendTelegram(_0x51aed5[_0x3e0424(0x261)]['id'],_0x3e0424(0x234)+botRef(_0x3133a6[_0x3e0424(0x279)])+_0x3e0424(0x2f1)+_0x10677f+_0x3e0424(0x2aa)),toggleBotMode(_0x33a39e);}),tgBot[_0x3ceb1e(0x1be)](_0x3ceb1e(0x2b1),async _0xcd33eb=>{const _0x2b30f8=_0x3ceb1e;let _0x12043e='';config[_0x2b30f8(0x1f3)](_0x267235=>{const _0x5c1120=_0x2b30f8;_0x12043e+=_0x5c1120(0x31b)+_0x267235[_0x5c1120(0x279)]+':\x20'+_0x267235[_0x5c1120(0x147)]+'\x0a';}),await sendTelegram(_0xcd33eb['chat']['id'],_0x12043e,{'parse_mode':'HTML'});}),tgBot[_0x3ceb1e(0x1be)](_0x3ceb1e(0x276),async _0x3ae688=>{const _0x5556de=_0x3ceb1e;await sendTelegram(_0x3ae688[_0x5556de(0x261)]['id'],_0x83e566);}),process[_0x3ceb1e(0x2f8)](_0x3ceb1e(0x14e),()=>tgBot[_0x3ceb1e(0x258)]('SIGINT')),process['once'](_0x3ceb1e(0x1c0),()=>tgBot[_0x3ceb1e(0x258)](_0x3ceb1e(0x1c0))),tgBot[_0x3ceb1e(0x1ad)]();}function disableTelegram(){const _0x336860=_0x4455e6;tgBot&&tgBot[_0x336860(0x258)]();}async function sendTelegram(_0x188eb9,_0x3b9c2d,_0x24f876){const _0x36463a=_0x4455e6;_0x24f876={..._0x24f876,'disable_web_page_preview':!![]};try{await tgBot[_0x36463a(0x225)][_0x36463a(0x269)](_0x188eb9,_0x3b9c2d,_0x24f876);}catch(_0x2a709c){logger[_0x36463a(0x189)](_0x36463a(0x263),_0x2a709c);}}async function sendTelegramBot(_0x5275e2,_0x374592){const _0x30e292=_0x4455e6;if(settings[_0x30e292(0x172)]){if(settings['telegramEvents']==_0x30e292(0x12a)||(_0x374592[_0x30e292(0x17a)]==_0x30e292(0x26c)||_0x374592[_0x30e292(0x17a)]==_0x30e292(0x221)||_0x374592[_0x30e292(0x17a)]==_0x30e292(0x154))&&settings['telegramEvents']==_0x30e292(0x123)||_0x374592['type']==_0x30e292(0x1ac)&&settings['telegramEvents']==_0x30e292(0x178)){if(tgBot&&settings[_0x30e292(0x253)]){if(_0x374592[_0x30e292(0x26d)])await sendTelegram(settings[_0x30e292(0x253)],_0x374592['botname']+_0x30e292(0x1b2)+_0x374592[_0x30e292(0x317)]);else await sendTelegram(settings['telegramChatId'],_0x30e292(0x31b)+_0x5275e2+'\x20>\x20'+_0x374592[_0x30e292(0x317)]);}}}}async function sendTelegramMsg(_0x4a6290,_0x36d966=_0x4455e6(0x2b5)){const _0x857317=_0x4455e6;return tgBot&&settings[_0x857317(0x253)]?(await sendTelegram(settings['telegramChatId'],_0x4a6290,{'parse_mode':_0x36d966}),!![]):![];}function getDeviceWithIp(_0x37461c){const _0x6a687b=_0x4455e6;return devices[_0x6a687b(0x298)](_0x58393a=>_0x58393a['ip']===_0x37461c);}async function temporaryAccess2FA(_0x1ff37a,_0x56b34a){const _0x20fdd6=_0x4455e6;let _0xcf6d1=new Date(),_0x2c5061=![];if(lastIpApproval){if(_0xcf6d1-lastIpApproval<0x1388)_0x2c5061=!![];}lastIpApproval=new Date();if(_0x2c5061)return;if(tgBot&&settings[_0x20fdd6(0x253)]){const _0x981a3e=uuidRandom();tmpStorage[_0x981a3e]={'uuid':_0x1ff37a,'externalip':_0x56b34a};const _0x360cac=Markup['inlineKeyboard']([Markup[_0x20fdd6(0x281)][_0x20fdd6(0x168)](_0x20fdd6(0x137),_0x20fdd6(0x282)+_0x981a3e),Markup['button']['callback'](_0x20fdd6(0x23a),_0x20fdd6(0x1f5)+_0x981a3e),Markup['button'][_0x20fdd6(0x168)](_0x20fdd6(0x193),'tempaccess_30_'+_0x981a3e),Markup['button'][_0x20fdd6(0x168)](_0x20fdd6(0x19a),_0x20fdd6(0x239)+_0x981a3e)]);await sendTelegram(settings[_0x20fdd6(0x253)],_0x20fdd6(0x22b)+normalizeIP(_0x56b34a)[_0x20fdd6(0x26b)]+'\x20?',_0x360cac),tgBot[_0x20fdd6(0x141)](/tempaccess_(.+)_(.+)/,async _0x55e640=>{const _0x96f97a=_0x20fdd6,_0x14aa5f=_0x55e640[_0x96f97a(0x100)][0x1],_0x3ab3e9=_0x55e640['match'][0x2],{uuid:_0x3fbfb8,externalip:_0x3dbea4}=tmpStorage[_0x3ab3e9];delete tmpStorage[_0x3ab3e9],_0x55e640[_0x96f97a(0x2b8)](),devices[_0x3fbfb8][_0x96f97a(0x179)]={'clientip':_0x3dbea4,'timestamp':new Date()['getTime'](),'expiry':_0x14aa5f},_0x14aa5f!=_0x96f97a(0x19a)?(await sendTelegram(_0x55e640['chat']['id'],_0x96f97a(0x280)+_0x14aa5f+_0x96f97a(0x135),{'parse_mode':_0x96f97a(0x2b5)}),io['to'](_0x3fbfb8)[_0x96f97a(0x1ca)](_0x96f97a(0x136),{'access':{'allow':![],'reason':_0x96f97a(0x275),'token':null}})):(await sendTelegram(_0x55e640['chat']['id'],_0x96f97a(0x2d9)),io['to'](_0x3fbfb8)[_0x96f97a(0x1ca)]('status',{'access':{'allow':![],'reason':_0x96f97a(0x1ae),'token':null}}));});}}async function loginAccess2FA(_0x55be66,_0x20176b){const _0x494ada=_0x4455e6;if(tgBot&&settings[_0x494ada(0x253)]){const _0x52ace9=uuidRandom();tmpStorage[_0x52ace9]={'uuid':_0x55be66,'externalip':_0x20176b};const _0xa413cc=Markup[_0x494ada(0x232)]([Markup[_0x494ada(0x281)]['callback'](_0x494ada(0x16b),_0x494ada(0x1e2)+loginExpiry+'_'+_0x52ace9),Markup[_0x494ada(0x281)][_0x494ada(0x168)]('reject',_0x494ada(0x1d0)+_0x52ace9)]);await sendTelegram(settings[_0x494ada(0x253)],_0x494ada(0x31e)+normalizeIP(_0x20176b)['show']+'\x20?',_0xa413cc),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x37a800=>{const _0x297d77=_0x494ada,_0x37ddec=_0x37a800[_0x297d77(0x100)][0x1],_0x5299f8=_0x37a800[_0x297d77(0x100)][0x2],{uuid:_0xb6f402,externalip:_0x1570be}=tmpStorage[_0x5299f8];delete tmpStorage[_0x5299f8],_0x37a800[_0x297d77(0x2b8)](),devices[_0xb6f402]['telegram2FaApproval']={'clientip':_0x1570be,'timestamp':new Date()['getTime'](),'expiry':_0x37ddec},_0x37ddec!=_0x297d77(0x19a)?(await sendTelegram(_0x37a800[_0x297d77(0x261)]['id'],_0x297d77(0x195),{'parse_mode':'HTML'}),io['to'](_0xb6f402)['emit'](_0x297d77(0x136),{'access':{'allow':![],'reason':_0x297d77(0x275),'token':null}})):(await sendTelegram(_0x37a800[_0x297d77(0x261)]['id'],_0x297d77(0x312)),io['to'](_0xb6f402)['emit'](_0x297d77(0x136),{'access':{'allow':![],'reason':_0x297d77(0x1af),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2a4b24=_0x4455e6;return dbConfig[_0x2a4b24(0x2d1)]('bots')[_0x2a4b24(0x2ec)](_0x2a4b24(0x279))[_0x2a4b24(0x316)]({'status':_0x2a4b24(0x2db)})['value']()||[];}function getDisabledBots(){const _0x1bc800=_0x4455e6;return dbConfig[_0x1bc800(0x2d1)](_0x1bc800(0x162))['sortBy']('botID')[_0x1bc800(0x316)]({'status':'disabled'})[_0x1bc800(0x2c9)]()||[];}function getBotAttributes(_0x606c6e){const _0x4377b2=_0x4455e6;let _0x3ed843={};const _0x2d201f=configpath+_0x4377b2(0x199)+_0x606c6e+_0x4377b2(0x30d),_0x3166c4=fs['existsSync'](_0x2d201f);if(_0x3166c4){const _0x1a0eba=fs[_0x4377b2(0x202)](_0x2d201f);try{const _0x5328c4=JSON['parse'](_0x1a0eba),_0x11aa6e=_0x5328c4?_0x5328c4['bot'][0x0][_0x4377b2(0x10e)]:![];_0x3ed843[_0x4377b2(0x236)]=_0x11aa6e?_0x4377b2(0x28d):'manual',_0x3ed843[_0x4377b2(0x147)]=_0x5328c4?_0x5328c4['bot'][0x0]['botname']:_0x4377b2(0x31b)+_0x606c6e,_0x3ed843['showname']=_0x5328c4?_0x5328c4['bot'][0x0]['showname']:![];}catch(_0x44aec0){_0x3ed843[_0x4377b2(0x236)]=_0x4377b2(0x115),_0x3ed843[_0x4377b2(0x147)]=_0x4377b2(0x31b)+_0x606c6e,_0x3ed843[_0x4377b2(0x26d)]=![];}}else _0x3ed843[_0x4377b2(0x236)]='manual',_0x3ed843['botname']=_0x4377b2(0x31b)+_0x606c6e,_0x3ed843[_0x4377b2(0x26d)]=![];return _0x3ed843;}function getBotsWithMode(){const _0x171668=_0x4455e6,_0x78d63e=dbConfig[_0x171668(0x2d1)](_0x171668(0x162))[_0x171668(0x2ec)]('botID')['value']()||[];return _0x78d63e[_0x171668(0x1f3)](_0x4f6309=>{const _0x5f05f7=_0x171668;let _0x56a129=getBotAttributes(_0x4f6309['botID']);_0x4f6309[_0x5f05f7(0x236)]=_0x56a129['mode'];}),_0x78d63e;}function getBotExchanges(){const _0x13333f=_0x4455e6;let _0x323adc=[];const _0x3fe696=dbConfig['get'](_0x13333f(0x162))['sortBy'](_0x13333f(0x279))[_0x13333f(0x2c9)]()||[];_0x3fe696[_0x13333f(0x1f3)](_0x483221=>{const _0x50ca22=_0x13333f;if(_0x483221[_0x50ca22(0x136)]==_0x50ca22(0x2db)){const _0x1eb088=configpath+_0x50ca22(0x199)+_0x483221['botID']+_0x50ca22(0x30d),_0x4b16e2=fs[_0x50ca22(0x176)](_0x1eb088);let _0x534cbf;if(_0x4b16e2){const _0x19881b=fs[_0x50ca22(0x202)](_0x1eb088);try{const _0x5a0dab=JSON[_0x50ca22(0x2e7)](_0x19881b);_0x534cbf=_0x5a0dab?_0x5a0dab[_0x50ca22(0x2ee)][0x0]['exchange']:null;}catch(_0x5a49a4){}}if(_0x534cbf)_0x323adc[_0x50ca22(0x1e6)](_0x534cbf);}});const _0xbfdd0b=[...new Set(_0x323adc)]['sort']();return _0xbfdd0b;}async function initUser(){const _0x44f679=_0x4455e6;if(!settings[_0x44f679(0x2f0)]){const _0x251f11=uuidRandom();mixpanel[_0x44f679(0x2e5)](_0x251f11),updateSetting(_0x44f679(0x2f0),_0x251f11);}}async function initSecure(){const _0x3212a4=_0x4455e6;let _0x4bea49=getSecure();if(!_0x4bea49['hasOwnProperty'](_0x3212a4(0x284))){let _0x32227e=await generateKeys();_0x4bea49[_0x3212a4(0x2e6)]=_0x32227e[_0x3212a4(0x2e6)],_0x4bea49[_0x3212a4(0x259)]=_0x32227e[_0x3212a4(0x259)],_0x4bea49[_0x3212a4(0x284)]=crypto[_0x3212a4(0x23d)](0x20)[_0x3212a4(0x31c)](_0x3212a4(0x108));;storeSecure(_0x4bea49);}}function getSettings(){const _0x4bf3ef=_0x4455e6;return dbSettings[_0x4bf3ef(0x2d1)](_0x4bf3ef(0x2ae))[_0x4bf3ef(0x2c9)]()||{};}function getSecure(){const _0x3f5e0e=_0x4455e6;return dbSecure[_0x3f5e0e(0x2d1)](_0x3f5e0e(0x237))[_0x3f5e0e(0x2c9)]()||{};}function getBlacklist(){const _0x456604=_0x4455e6;return dbSecure[_0x456604(0x2d1)](_0x456604(0x1df))['value']()||[];}function broadcastToBots(_0x62d1f7,_0x1397b3){const _0x4ac223=_0x4455e6;config[_0x4ac223(0x1f3)](_0x59c89f=>{const _0x51954a=_0x4ac223;if(_0x59c89f[_0x51954a(0x136)]==_0x51954a(0x2db)&&_0x59c89f[_0x51954a(0x292)]=='running'||_0x59c89f['status']==_0x51954a(0x2d3)&&_0x59c89f['live']==_0x51954a(0x23e)){if(pid[_0x59c89f[_0x51954a(0x279)]])pid[_0x59c89f[_0x51954a(0x279)]]['send']({[_0x62d1f7]:_0x1397b3});}});}async function storeSettings(_0x5d610b,_0x5523be=![]){const _0x32ccc8=_0x4455e6;_0x5d610b={...settings,..._0x5d610b};if(_0x5523be&&_0x5d610b['bbPassword']!=_0x32ccc8(0x2cb)&&_0x5d610b[_0x32ccc8(0x1cb)]!='***'&&_0x5d610b[_0x32ccc8(0x1cb)]!=''){const _0x105dc9=decryptRSA(secure[_0x32ccc8(0x259)],_0x5d610b['bbPassword'])[_0x32ccc8(0x2d2)](_0x32ccc8(0x1d2))[0x0],_0x3d0c77=bcrypt[_0x32ccc8(0x29e)](_0x105dc9,saltRounds);_0x5d610b={..._0x5d610b,'bbPassword':_0x3d0c77};}if(_0x5523be&&_0x5d610b['telegramToken']!='************'&&_0x5d610b[_0x32ccc8(0x12f)]!='***'&&_0x5d610b[_0x32ccc8(0x12f)]!=''){const _0x42e867=decryptRSA(secure[_0x32ccc8(0x259)],_0x5d610b[_0x32ccc8(0x12f)])[_0x32ccc8(0x2d2)]('|@|')[0x0];_0x5d610b={..._0x5d610b,'telegramToken':_0x42e867};}if(_0x5523be&&_0x5d610b[_0x32ccc8(0x20e)]!=_0x32ccc8(0x2cb)&&_0x5d610b[_0x32ccc8(0x20e)]!=_0x32ccc8(0x2e1)&&_0x5d610b[_0x32ccc8(0x20e)]!=''){const _0x19d5d9=decryptRSA(secure[_0x32ccc8(0x259)],_0x5d610b['marketcapApi'])[_0x32ccc8(0x2d2)]('|@|')[0x0];_0x5d610b={..._0x5d610b,'marketcapApi':_0x19d5d9};}const _0x3efdac=_0x5d610b[_0x32ccc8(0x12f)]!=_0x32ccc8(0x2cb)&&_0x5d610b[_0x32ccc8(0x12f)]!=settings[_0x32ccc8(0x12f)]||_0x5d610b[_0x32ccc8(0x155)]!=settings['telegramUsername'],_0x55e283=_0x5d610b[_0x32ccc8(0x12f)]==''||_0x5d610b['telegramUsername']=='',_0x4aab17=_0x5d610b[_0x32ccc8(0x20e)]&&_0x5d610b[_0x32ccc8(0x20e)]!=_0x32ccc8(0x2cb)&&_0x5d610b[_0x32ccc8(0x20e)]!=settings['marketcapApi'];_0x3efdac&&(_0x5d610b[_0x32ccc8(0x253)]=null,_0x5d610b[_0x32ccc8(0x1c7)]='all');for(const [_0x2735ab,_0x13472a]of Object[_0x32ccc8(0x1c6)](_0x5d610b)){if(_0x2735ab=='telegramToken'&&_0x13472a==_0x32ccc8(0x2cb)){_0x5d610b[_0x32ccc8(0x12f)]=settings[_0x32ccc8(0x12f)];continue;};if(_0x2735ab==_0x32ccc8(0x1cb)&&_0x13472a=='************'){_0x5d610b[_0x32ccc8(0x1cb)]=settings[_0x32ccc8(0x1cb)];continue;};if(_0x2735ab==_0x32ccc8(0x20e)&&_0x13472a==_0x32ccc8(0x2cb)){_0x5d610b[_0x32ccc8(0x20e)]=settings['marketcapApi'];continue;};dbSettings[_0x32ccc8(0x1d6)]('settings.'+_0x2735ab,_0x13472a)[_0x32ccc8(0x26a)]();}settings=_0x5d610b,io['to']('botmanager')[_0x32ccc8(0x1ca)](_0x32ccc8(0x2ae),cleanSettings()),broadcastToBots(_0x32ccc8(0xff),settings[_0x32ccc8(0xff)]),broadcastToBots('onepagemode',settings['onepagemode']),broadcastToBots(_0x32ccc8(0x20e),settings[_0x32ccc8(0x20e)]);if(_0x3efdac&&!_0x55e283)initTelegram();_0x3efdac&&_0x55e283&&(updateSetting('telegramChatId',null),disableTelegram()),getAllClients()['forEach'](_0x577086=>{const _0x1469c0=_0x32ccc8;getSocket(_0x577086['id'])['emit'](_0x1469c0(0x136),{'access':{'allow':![],'reason':_0x1469c0(0x275),'token':null}});}),_0x4aab17&&(await sleep(0xbb8),testMarketcapApi(_0x5d610b[_0x32ccc8(0x20e)]));}async function testMarketcapApi(_0x178cbd){const _0x24e677=_0x4455e6,_0x39b323=[_0x24e677(0x2b9),_0x24e677(0x197)];try{await axios[_0x24e677(0x2d1)]('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x178cbd},'params':{'symbol':_0x39b323['toString']()}});}catch(_0x37eee0){_0x37eee0[_0x24e677(0x31c)]()[_0x24e677(0x149)](_0x24e677(0x1c8))?(io['to'](_0x24e677(0x151))[_0x24e677(0x1ca)](_0x24e677(0x2c8),_0x24e677(0x274)),logger['full'](_0x24e677(0x274))):(io['to'](_0x24e677(0x151))[_0x24e677(0x1ca)](_0x24e677(0x2c8),_0x24e677(0x2ff)),logger['full'](_0x24e677(0x2ff)),logger[_0x24e677(0x189)]('Error\x20details:',_0x37eee0[_0x24e677(0x31c)]()+'\x20-\x20'+_0x37eee0[_0x24e677(0x15c)]));return;}logger[_0x24e677(0x189)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x5eaef0,_0xc70151){const _0x36af93=_0x4455e6;dbSettings[_0x36af93(0x1d6)]('settings.'+_0x5eaef0,_0xc70151)[_0x36af93(0x26a)](),settings=getSettings(),io['to'](_0x36af93(0x151))[_0x36af93(0x1ca)](_0x36af93(0x2ae),cleanSettings());}function storeSecure(_0x3f95d9){const _0x3ea09d=_0x4455e6;dbSecure['get'](_0x3ea09d(0x237))['push'](_0x3f95d9)[_0x3ea09d(0x26a)](),secure=_0x3f95d9;}function addBlacklist(_0x654637){const _0x53e6f3=_0x4455e6;cleanBlacklist();let _0x59d1a6;devices[_0x654637][_0x53e6f3(0x179)]?_0x59d1a6=Math['max'](devices[_0x654637]['telegramIpApproval'][_0x53e6f3(0x230)],loginExpiry):_0x59d1a6=loginExpiry,dbSecure[_0x53e6f3(0x2d1)](_0x53e6f3(0x1df))[_0x53e6f3(0x1e6)]({'expiry':new Date()[_0x53e6f3(0x287)]()+_0x59d1a6*0x3c*0x3e8,'token':devices[_0x654637][_0x53e6f3(0x25e)][_0x53e6f3(0x224)]})[_0x53e6f3(0x26a)](),blacklist=dbSecure['get']('blacklist')[_0x53e6f3(0x2c9)]();}function cleanBlacklist(){const _0x111ddc=_0x4455e6;let _0xb7fe03=dbSecure[_0x111ddc(0x2d1)]('blacklist')[_0x111ddc(0x2b3)]()['value'](),_0x4081c5=new Date()['getTime']();_0xb7fe03[_0x111ddc(0x1f3)](_0x526dfa=>{const _0xd8339=_0x111ddc;_0x526dfa[_0xd8339(0x230)]<_0x4081c5&&dbSecure[_0xd8339(0x2d1)]('blacklist')['remove']({'expiry':_0x526dfa[_0xd8339(0x230)]})[_0xd8339(0x26a)]();});}function _0x18cc(){const _0x2e5de0=['update-bot','login\x20token\x20valid','#RES#\x20if\x20running\x20locally\x0a','padStart','$1_$2_$3','then','\x1b[33m','blacklist','f2aRequired','start','login2fa_','Unauthorized\x20attempt\x20to\x20update\x20bot','listen','address','push','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','path','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','reinstall-bb','writeFileSync','2FA','delete-alerts','RSA-OAEP','node-forge','show-config','build','disabled','forEach','file','tempaccess_15_','get-messages','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','get-backup-files','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','test','reinstall','update_yes','-----------------------------------------------------------------------------------','Telegraf\x20error:','3363530bODOaE','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','readFileSync','<b>Balance\x20Bot\x20Status:</b>\x0a','remove','All\x20bots','portfolio_','store-configuration','child_process','internal','decrypt','bb-settings.json','referer','ipv6','marketcapApi','temp/','username','telegraf','getFullYear','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','util','length','reply','socket',':\x20Bot\x20Mgr\x20>\x20','http','Unauthorized\x20attempt\x20to\x20store\x20configuration','\x1b[0m','/update\x20-\x20update\x20Balance\x20Bot\x0a','Starting\x20#RED#Balance\x20Bot\x20v','Ok,\x20will\x20send\x20order\x20notifications\x20only','toIPv4MappedAddress','warning','config_orders','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','token','telegram','initclient','off','encryptedUuid','Orders',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','disable','(staging)','lowdb/adapters/FileSync','compareSync','expiry','config_all','inlineKeyboard','::ffff:127.0.0.1','Bot\x20Mgr\x20>\x20Toggling\x20','backup-full','mode','secure','Unauthorized\x20attempt\x20to\x20log\x20out','tempaccess_reject_','15\x20min','slice','metrics_','randomBytes','running','\x20(1)','hasOwnProperty','replace','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','1445303GGWXqh','(((.+)+)+)+$','copyFileSync','onepagemode','readdirSync','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','cancelLoading','family','staging','apiPassword','Bot\x20Mgr\x20>\x20','\x1b[36m','cancel-loading','\x1b[35m','files','[ip-address]','telegramChatId','send','init','number','Running\x20#RED#Balance\x20Bot\x20v','stop','privateKey','download','127.0.0.1','decode64','exp','access','assign','async','chat','ipaddr.js','Telegram\x20error:','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','jsonwebtoken','create','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','sendMessage','write','show','error','showname','getUTCHours',')\x20|\x20Bot\x20','Backup\x20file\x20uploaded','*$1*','disconnect','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','reload','help','keys','config_alerts','botID','Unauthorized\x20attempt\x20to\x20add\x20bot','version','get-starting-balances','new-disabled','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','whitelist','Access\x20enabled\x20for\x20','button','tempaccess_5_','Logged\x20in\x20user\x20...','secret','config/','toggle-bot-mode','getTime','reason','endsWith','login','backup-full@','Backup\x20file\x20unzipped\x20and\x20stored','auto','bbvReceive','address\x20already\x20in\x20use','connected','express-fileupload','live','getDate','update_no','environment','pidRefreshToken','sendFile','find','\x20only\x0a','Invalid\x20authentication\x20token\x20(1)','on_','Password\x20has\x20been\x20reset\x20to:\x20','/upload-backup','hashSync','Restore\x20process\x20confirmed','messages','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','version.json','unlinkSync','startsWith','createServer','getMonth','output-001.log','You\x20can\x20use\x20the\x20following\x20commands:\x0a','logged\x20out','\x20mode','conn','6b67f3d61ee94b8f5c80b4affef4c4d9','getSeconds','settings','metrics','from','names','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','cloneDeep','Unauthorized\x20attempt\x20to\x20delete\x20bot','HTML','Invalid\x20authentication\x20token\x20(2)','track','editMessageReplyMarkup','BCT','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','store','reinstall_yes','Unauthorized\x20attempt\x20to\x20get\x20messages','/:bot/configuration','lastmsgemitted','request','join','mixpanel','allow','store-settings','getStartingBalances','sockets','8918960KHAwnb','notification','value','storeFiat','************','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','yargs/yargs','privateKeyToPem','date-fns','Alerts','get','split','new','_nsps','6TdKHVn','8660386yxYfId','catch','crypto','Temporary\x20access\x20rejected','kind','enabled','add','2185808AGNtiJ','backup/','storeConfiguration','sign','***','\x20files\x20over\x20Telegram:','build2','2FA\x20required','alias','publicKey','parse','host','pki','yes','add-bot','sortBy','showConfig','bot','handshake','userid','\x20to\x20','loginRequired','Logged\x20out\x20user\x20...','tkn','map','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','pidExpireLogin','once','2635024OkBFYR','/download/:type','node','Network\x20Interfaces:','Notifications\x20types:\x20','Notifications\x20disabled','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Invalid\x20username\x20or\x20IP\x20address','getHours','stringify','search','place-order','Node.js\x20v','emitHistory','full','Starting\x20Balance\x20Bot\x20update','Unauthorized\x20login\x20attempt\x20(timeout)','lastmsgtelegram','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','-config.json','No\x20bots\x20running\x20right\x20now','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Login\x20rejected','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Session\x20expired\x20for\x20user\x20...','filter','event','resetpw_no','placeOrder','clientip','Bot\x20','toString','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Allow\x20login\x20from\x20IP\x20address\x20','close','Restore\x20process\x20aborted','access\x20timeout','Starting\x20(','binary','All','/help\x20-\x20show\x20available\x20commands\x0a','timeshift','match','headers','storeHeadless','/restart\x20-\x20restart\x20bot(s)\x0a','2579394ZgqOgP','Disabled\x20','--------------------------------------','No\x20authentication\x20token','hex','timestamp','sendPortfolioTelegram','/:bot/coins','Password\x20reset\x20rejected','/status\x20-\x20show\x20bot(s)\x20status\x0a','headless','Unauthorized\x20attempt\x20to\x20update\x20settings','argv','bbUsername','Unauthorized\x20attempt\x20to\x20confirm\x20message','isIPv4MappedAddress','=>\x20Go\x20to\x20#CYA#http://','manual','Yes','clients','Failed\x20to\x20download\x20','generateKeyPair','auth','/enable\x20-\x20enable\x20notifications\x0a',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','format','/disable\x20-\x20disable\x20notifications\x0a','temporary\x20access\x20timeout','loadAsync','#RES#','-events.json','alerts','Setting\x20access:\x20','mtime','range','Error\x20sending\x20','post','Notifications\x20enabled\x0a','all','started','inherit','restart_','output-002.log','telegramToken','log','mkdirSync','Unauthorized\x20attempt\x20to\x20delete\x20alerts','output-003.log','confirm-message','\x20minutes','status','5\x20min','production','defaults','private','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','1000','logs/','socket.io','backup-full.zip','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','action','telegram2FaApproval','9IEJbLc','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','logout','reset-history','botname','reinstall_no','includes','66vhOfzM','lowdb','login\x20token\x20generated','sort','SIGINT','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','backup','botmanager','static','temporary\x20token\x20generated','success','telegramUsername','isValid','update','index.html','Error:\x20Invalid\x20argument\x20','/off\x20-\x20stop\x20bot(s)\x0a','-performance.json','code','title','.zip','latestversion','Ok,\x20will\x20send\x20alert\x20notifications\x20only','#RES#\x20','bots','temporary\x20access\x20not\x20allowed','/backup\x20-\x20receive\x20backup\x20files\x0a','<b>Telegram\x20Bot\x20Status:</b>\x0a','name','toggle','callback','0.0.0','restore-backup-file','accept','sendMetricsTelegram','remoteAddress','telegrammsg','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','https://api.ipify.org?format=json','2FA\x20login\x20token\x20generated','telegramEnabled','rsa','Markdown','temporaryAccessAllowed','existsSync','axios','orders','telegramIpApproval','type','File\x20uploaded','sha256','isDirectory','Starting\x20Balance\x20Bot\x20reinstallation','toIPv4Address','logs','rmSync','bbvNew','graphql-request','/on\x20-\x20start\x20bot(s)\x0a','simple','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','delete-bot','toggle_','debug','::1','/logs\x20-\x20receive\x20log\x20files\x0a','stopped','DEFLATE','/:bot/performance','-results.json','backupfile','output-000.log','publicKeyToPem','30\x20min','ipc','Login\x20accepted','min','ETH','uuid-random','bot-','reject','Invalid\x20IP\x20address','\x20|\x20client:\x20...','/names\x20-\x20show\x20bot\x20names\x0a','bcryptjs','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','use','restart','exec','replyWithDocument','verify','deleteHistoryAlerts','connection','args','Server','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','portfolio','backup-files','order','launch','temporary\x20access\x20rejected','2FA\x20login\x20rejected','kill','User\x20has\x20been\x20validated','\x20>\x20','apply','Deleted\x20Bot\x20','any','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','zip/','3klIqoh','All\x20bots\x20running\x20right\x20now','2FA\x20login\x20required','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','\x20|\x20','\x20|\x20user:\x20...','command','removeAllListeners','SIGTERM','bb-config.json','apiKey','message','user','Restore\x20backup\x20file\x20','entries','telegramEvents','status\x20code\x20401','\x1b[34m','emit','bbPassword','password','exit','updatebotmanager','update-bb','login2fa_reject_','versions','|@|','uuid','express','getMinutes','set','Token\x20blacklisted'];_0x18cc=function(){return _0x2e5de0;};return _0x18cc();}function initStates(){const _0x31ec83=_0x4455e6;let _0x2823ab=getConfiguration();_0x2823ab[_0x31ec83(0x1f3)](_0x4688c0=>{const _0xf12c82=_0x31ec83;_0x4688c0[_0xf12c82(0x292)]=_0xf12c82(0x18c);}),storeConfiguration(_0x2823ab);}async function generateKeys(){const _0x316351=_0x4455e6,_0x4e5c7e=forge[_0x316351(0x2e9)][_0x316351(0x173)][_0x316351(0x119)]({'bits':0x1000,'e':0x10001}),_0x1b1617=forge['pki'][_0x316351(0x2ce)](_0x4e5c7e[_0x316351(0x259)]),_0x38fe69=forge[_0x316351(0x2e9)][_0x316351(0x192)](_0x4e5c7e['publicKey']);return{'privateKey':_0x1b1617,'publicKey':_0x38fe69};}async function oneTimeMigration(){const _0xb8b53b=_0x4455e6;let _0x28d20c=getSettings(),_0x14c3e9=![];!_0x28d20c[_0xb8b53b(0x240)](_0xb8b53b(0x30b))&&(_0x28d20c[_0xb8b53b(0x30b)]=0x0,_0x14c3e9=!![]);!_0x28d20c[_0xb8b53b(0x240)](_0xb8b53b(0x2bf))&&(_0x28d20c[_0xb8b53b(0x2bf)]=0x0,_0x14c3e9=!![]);!_0x28d20c[_0xb8b53b(0x240)](_0xb8b53b(0x15f))&&(_0x28d20c[_0xb8b53b(0x15f)]=_0xb8b53b(0x169),_0x14c3e9=!![]);!_0x28d20c[_0xb8b53b(0x240)](_0xb8b53b(0x246))&&(_0x28d20c[_0xb8b53b(0x246)]=![],_0x14c3e9=!![]);!_0x28d20c[_0xb8b53b(0x240)]('marketcapApi')&&(_0x28d20c[_0xb8b53b(0x20e)]='',_0x14c3e9=!![]);if(_0x14c3e9)storeSettings(_0x28d20c);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x3f4b81=>{const _0x661768=_0xb8b53b;if(!_0x3f4b81[_0x661768(0x17d)]()){if(!_0x3f4b81[_0x661768(0x166)][_0x661768(0x2a4)](_0x661768(0x28b)))fs[_0x661768(0x2a3)](configbackuppath+_0x3f4b81['name']);}else fs[_0x661768(0x181)](configbackuppath+_0x3f4b81[_0x661768(0x166)],{'recursive':!![]});});}catch(_0x42aa06){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x42aa06);}}function storeConfiguration(_0x351054){const _0x2fbdc8=_0x4455e6;dbConfig[_0x2fbdc8(0x2d1)](_0x2fbdc8(0x162))[_0x2fbdc8(0x204)]()[_0x2fbdc8(0x26a)](),dbConfig[_0x2fbdc8(0x2d1)](_0x2fbdc8(0x162))[_0x2fbdc8(0x1e6)](..._0x351054)[_0x2fbdc8(0x26a)](),config=_0x351054;}async function resetPassword(){const _0x73657f=_0x4455e6;if(tgBot&&settings[_0x73657f(0x253)]){const _0x50bee1=Markup['inlineKeyboard']([Markup[_0x73657f(0x281)]['callback'](_0x73657f(0x2ea),'resetpw_yes'),Markup[_0x73657f(0x281)]['callback']('no',_0x73657f(0x318))]);await sendTelegram(settings[_0x73657f(0x253)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x50bee1),tgBot[_0x73657f(0x141)](/resetpw_(.+)/,async _0x5a307f=>{const _0x3a7e3d=_0x73657f,_0x1c2e92=_0x5a307f[_0x3a7e3d(0x100)][0x1];_0x5a307f[_0x3a7e3d(0x2b8)]();if(_0x1c2e92!='no'){const _0x5546a1=0xf,_0x494a66=_0x3a7e3d(0x300),_0x12e72c=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x5546a1)))[_0x3a7e3d(0x2f5)](_0xa718c3=>_0x494a66[_0xa718c3%_0x494a66[_0x3a7e3d(0x216)]])[_0x3a7e3d(0x2c1)](''),_0xb3753c=bcrypt[_0x3a7e3d(0x29e)](_0x12e72c,saltRounds);storeSettings({'bbPassword':_0xb3753c}),await sendTelegram(_0x5a307f[_0x3a7e3d(0x261)]['id'],_0x3a7e3d(0x29c)+_0x12e72c,{'parse_mode':_0x3a7e3d(0x2b5)});}else await sendTelegram(_0x5a307f[_0x3a7e3d(0x261)]['id'],_0x3a7e3d(0x10c));});}}async function confirmRestore(_0x296c66,_0x59c8f1){const _0x13e27b=_0x4455e6;io['to'](_0x13e27b(0x151))[_0x13e27b(0x1ca)](_0x13e27b(0x2c8),_0x13e27b(0x265),_0x13e27b(0x154));if(tgBot&&settings[_0x13e27b(0x253)]){const _0x4b356f=uuidRandom();tmpStorage[_0x4b356f]={'path':_0x296c66,'filename':_0x59c8f1};const _0x2200bd=Markup[_0x13e27b(0x232)]([Markup['button'][_0x13e27b(0x168)]('yes','restore_yes_'+_0x4b356f),Markup[_0x13e27b(0x281)]['callback']('no','restore_no_'+_0x4b356f)]);await sendTelegram(settings[_0x13e27b(0x253)],_0x13e27b(0x242),_0x2200bd),tgBot[_0x13e27b(0x141)](/restore_(.+)_(.+)/,async _0x712ba8=>{const _0x36a251=_0x13e27b,_0x1d7d17=_0x712ba8[_0x36a251(0x100)][0x1],_0x4bd198=_0x712ba8['match'][0x2],{path:_0x52ce5a,filename:_0x169e89}=tmpStorage[_0x4bd198];delete tmpStorage[_0x4bd198],_0x712ba8[_0x36a251(0x2b8)](),_0x1d7d17==_0x36a251(0x2ea)?(logger[_0x36a251(0x189)](_0x36a251(0x29f)),await sendTelegram(_0x712ba8[_0x36a251(0x261)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x36a251(0x2b5)}),unzipFile(_0x52ce5a,_0x169e89)):(logger[_0x36a251(0x189)](_0x36a251(0x320)),await sendTelegram(_0x712ba8['chat']['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x121552=_0x4455e6,_0x2ea65a=new Date();return _0x2ea65a[_0x121552(0x212)]()+'/'+(_0x2ea65a[_0x121552(0x2a6)]()+0x1)[_0x121552(0x31c)]()['padStart'](0x2,'0')+'/'+_0x2ea65a['getDate']()['toString']()[_0x121552(0x1db)](0x2,'0')+'\x20'+_0x2ea65a[_0x121552(0x302)]()[_0x121552(0x31c)]()['padStart'](0x2,'0')+':'+_0x2ea65a[_0x121552(0x1d5)]()[_0x121552(0x31c)]()['padStart'](0x2,'0')+':'+_0x2ea65a[_0x121552(0x2ad)]()[_0x121552(0x31c)]()[_0x121552(0x1db)](0x2,'0');}function getTimeStamp(){const _0x4d3fc4=_0x4455e6,_0x52cef9=shiftedTime();return _0x52cef9[_0x4d3fc4(0x212)]()+'/'+(_0x52cef9[_0x4d3fc4(0x2a6)]()+0x1)[_0x4d3fc4(0x31c)]()[_0x4d3fc4(0x1db)](0x2,'0')+'/'+_0x52cef9['getDate']()[_0x4d3fc4(0x31c)]()[_0x4d3fc4(0x1db)](0x2,'0')+'\x20'+_0x52cef9[_0x4d3fc4(0x302)]()[_0x4d3fc4(0x31c)]()[_0x4d3fc4(0x1db)](0x2,'0')+':'+_0x52cef9['getMinutes']()[_0x4d3fc4(0x31c)]()[_0x4d3fc4(0x1db)](0x2,'0')+':'+_0x52cef9[_0x4d3fc4(0x2ad)]()[_0x4d3fc4(0x31c)]()[_0x4d3fc4(0x1db)](0x2,'0');}function getCleanTimeStamp(){const _0x4c7402=_0x4455e6,_0xcfbb4b=shiftedTime();return _0xcfbb4b[_0x4c7402(0x212)]()+(_0xcfbb4b[_0x4c7402(0x2a6)]()+0x1)['toString']()[_0x4c7402(0x1db)](0x2,'0')+_0xcfbb4b[_0x4c7402(0x293)]()[_0x4c7402(0x31c)]()[_0x4c7402(0x1db)](0x2,'0')+'-'+_0xcfbb4b[_0x4c7402(0x302)]()[_0x4c7402(0x31c)]()[_0x4c7402(0x1db)](0x2,'0')+_0xcfbb4b[_0x4c7402(0x1d5)]()[_0x4c7402(0x31c)]()['padStart'](0x2,'0')+_0xcfbb4b[_0x4c7402(0x2ad)]()[_0x4c7402(0x31c)]()[_0x4c7402(0x1db)](0x2,'0');}function shiftedTime(){const _0x354acb=_0x4455e6,_0x2d69cf=new Date();let _0x141e7b=_0x2d69cf;if(settings[_0x354acb(0xff)]&&settings[_0x354acb(0xff)]!==0x0)_0x141e7b=fns[_0x354acb(0x2dc)](_0x2d69cf,{'hours':settings[_0x354acb(0xff)]});return _0x141e7b;}async function startScheduler(){const _0x275b70=_0x4455e6,_0x444c07=new Date()[_0x275b70(0x26e)](),_0x51c5ee=shiftedTime()[_0x275b70(0x302)]();_0x51c5ee==0x4&&backupConfigFiles(),_0x51c5ee==0x0&&(rotateLogFiles(),logger[_0x275b70(0x189)](_0x275b70(0x106)),logger['debug'](_0x275b70(0x257)+serverversion+_0x275b70(0x161)+(environment=='staging'?'(staging)':'')),logger['debug'](_0x275b70(0x106))),_0x444c07%0x6==0x0&&triggerAnalytics(),_0x444c07%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x4648b2){const _0x1f5ec9=_0x4455e6;logger[_0x1f5ec9(0x189)](_0x1f5ec9(0x1c5)+_0x4648b2);const _0x5f3bcd=getBotsWithMode();_0x5f3bcd[_0x1f5ec9(0x216)]>0x0?confirmRestore(configbackuppath,_0x4648b2):unzipFile(configbackuppath,_0x4648b2);}async function getBackupFiles(_0x45c2fe=null){const _0x3be600=_0x4455e6;let _0x490ef6=[],_0x3b1d74=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x3b1d74['sort']((_0x141829,_0x343498)=>_0x141829[_0x3be600(0x166)]<_0x343498['name']?0x1:_0x343498['name']<_0x141829[_0x3be600(0x166)]?-0x1:0x0),_0x3b1d74['forEach'](_0xeea04b=>{const _0x5d6646=_0x3be600;if(!_0xeea04b[_0x5d6646(0x17d)]()&&_0xeea04b[_0x5d6646(0x166)][_0x5d6646(0x2a4)]('backup-full@')&&_0xeea04b[_0x5d6646(0x166)][_0x5d6646(0x289)](_0x5d6646(0x15e))){const _0x1435d1=formatDate(fs['statSync'](configbackuppath+_0xeea04b['name'])[_0x5d6646(0x125)]);_0x490ef6[_0x5d6646(0x1e6)]({'name':_0xeea04b[_0x5d6646(0x166)],'mtime':_0x1435d1});}});if(_0x45c2fe)io['to'](_0x45c2fe)[_0x3be600(0x1ca)](_0x3be600(0x1ab),_0x490ef6);else return _0x490ef6;}async function backupConfigFiles(){const _0x2ca57d=_0x4455e6;await zipFiles(_0x2ca57d(0x235));const _0x2d6efd=getCleanTimeStamp();fs[_0x2ca57d(0x245)](zippath+_0x2ca57d(0x13f),configbackuppath+(_0x2ca57d(0x28b)+_0x2d6efd+'.zip'));let _0x2b0ddc=fs[_0x2ca57d(0x247)](configbackuppath,{'withFileTypes':!![]});_0x2b0ddc['sort']((_0x53a8a7,_0x4c63e1)=>_0x53a8a7[_0x2ca57d(0x166)]<_0x4c63e1[_0x2ca57d(0x166)]?0x1:_0x4c63e1[_0x2ca57d(0x166)]<_0x53a8a7[_0x2ca57d(0x166)]?-0x1:0x0),_0x2b0ddc[_0x2ca57d(0x216)]>maxBackups&&fs[_0x2ca57d(0x2a3)](configbackuppath+_0x2b0ddc[_0x2b0ddc['length']-0x1][_0x2ca57d(0x166)]);}function rotateLogFiles(){const _0x6025ae=_0x4455e6,_0x303db5=fs['statSync'](logspath+_0x6025ae(0x191)),_0x147b1b=_0x303db5['size']/0x400;if(_0x147b1b>0x64){let _0x51b821=fs[_0x6025ae(0x247)](logspath,{'withFileTypes':!![]});_0x51b821[_0x6025ae(0x14d)]((_0x27ba91,_0x962113)=>_0x27ba91['name']<_0x962113[_0x6025ae(0x166)]?0x1:_0x962113[_0x6025ae(0x166)]<_0x27ba91[_0x6025ae(0x166)]?-0x1:0x0),_0x51b821[_0x6025ae(0x1f3)](_0x490e7d=>{const _0x279e5d=_0x6025ae;if(_0x490e7d[_0x279e5d(0x166)]==_0x279e5d(0x12e))fs[_0x279e5d(0x245)](logspath+_0x490e7d[_0x279e5d(0x166)],logspath+_0x279e5d(0x133));if(_0x490e7d['name']==_0x279e5d(0x2a7))fs['copyFileSync'](logspath+_0x490e7d['name'],logspath+'output-002.log');_0x490e7d[_0x279e5d(0x166)]==_0x279e5d(0x191)&&(fs[_0x279e5d(0x245)](logspath+_0x490e7d['name'],logspath+_0x279e5d(0x2a7)),fs['writeFileSync'](logspath+_0x490e7d['name'],''));});}}async function zipFiles(_0x37f830){const _0x3d6be2=_0x4455e6;let _0xa01dc6;if(_0x37f830==_0x3d6be2(0x180))_0xa01dc6=logspath;if(_0x37f830==_0x3d6be2(0x150))_0xa01dc6=configpath;if(_0x37f830==_0x3d6be2(0x235))_0xa01dc6=configpath;let _0xf4efb7=fs['readdirSync'](_0xa01dc6,{'withFileTypes':!![]});const _0x2f3fe5=new JSZip();_0xf4efb7[_0x3d6be2(0x1f3)](_0x5583f9=>{const _0x295d06=_0x3d6be2;if(!_0x5583f9[_0x295d06(0x17d)]()){let _0x5a8e7c=fs[_0x295d06(0x202)](_0xa01dc6+_0x5583f9[_0x295d06(0x166)]);if(_0x37f830==_0x295d06(0x150)){const _0x13bc3f=/^bot-[0-9]{3}-config.json$/,_0x54dc36=_0x13bc3f['test'](_0x5583f9['name']);if(_0x54dc36){const _0x2eae22=JSON['parse'](_0x5a8e7c);if(_0x2eae22[_0x295d06(0x2ee)][0x0]){_0x2eae22[_0x295d06(0x2ee)][0x0][_0x295d06(0x1c2)]=_0x295d06(0x2e1),_0x2eae22[_0x295d06(0x2ee)][0x0]['apiSecret']=_0x295d06(0x2e1);if(_0x2eae22[_0x295d06(0x2ee)][0x0][_0x295d06(0x24c)])_0x2eae22[_0x295d06(0x2ee)][0x0][_0x295d06(0x24c)]=_0x295d06(0x2e1);}_0x5a8e7c=JSON['stringify'](_0x2eae22,null,0x2);}if(_0x5583f9[_0x295d06(0x166)]==_0x295d06(0x20b)){const _0x5e9200=JSON[_0x295d06(0x2e7)](_0x5a8e7c);if(_0x5e9200[_0x295d06(0x2ae)][_0x295d06(0x2f2)])_0x5e9200[_0x295d06(0x2ae)][_0x295d06(0x2f2)]=![];if(_0x5e9200[_0x295d06(0x2ae)][_0x295d06(0x1cb)])_0x5e9200[_0x295d06(0x2ae)][_0x295d06(0x1cb)]=_0x295d06(0x2e1);if(_0x5e9200[_0x295d06(0x2ae)][_0x295d06(0x12f)])_0x5e9200[_0x295d06(0x2ae)][_0x295d06(0x12f)]=_0x295d06(0x2e1);if(_0x5e9200[_0x295d06(0x2ae)][_0x295d06(0x253)])_0x5e9200[_0x295d06(0x2ae)][_0x295d06(0x253)]=null;if(_0x5e9200[_0x295d06(0x2ae)][_0x295d06(0x20e)])_0x5e9200[_0x295d06(0x2ae)][_0x295d06(0x20e)]=_0x295d06(0x2e1);_0x5a8e7c=JSON['stringify'](_0x5e9200,null,0x2);}if(_0x5583f9[_0x295d06(0x166)]!='bb-secure.json')_0x2f3fe5[_0x295d06(0x1f4)](_0x5583f9['name'],_0x5a8e7c);}else _0x2f3fe5[_0x295d06(0x1f4)](_0x5583f9[_0x295d06(0x166)],_0x5a8e7c);}});const _0x4ed6b3=await _0x2f3fe5['generateAsync']({'type':'string','base64':![],'compression':_0x3d6be2(0x18d)});fs['writeFileSync'](zippath+(_0x37f830+_0x3d6be2(0x15e)),_0x4ed6b3,_0x3d6be2(0xfc));}async function unzipFile(_0x59949f,_0x252e17){const _0x199f61=_0x4455e6;fs[_0x199f61(0x247)](configpath,{'withFileTypes':!![]})[_0x199f61(0x1f3)](_0x3b3b65=>{const _0x1abc06=_0x199f61;if(!_0x3b3b65['isDirectory']())fs[_0x1abc06(0x181)](configpath+_0x3b3b65['name']);});const _0x10e5c5=fs[_0x199f61(0x202)](_0x59949f+_0x252e17,_0x199f61(0xfc)),_0x3bff5b=await JSZip[_0x199f61(0x120)](_0x10e5c5,{'base64':![],'checkCRC32':!![]});for(const _0x375f9d of Object[_0x199f61(0x277)](_0x3bff5b[_0x199f61(0x251)])){const _0xa753fa=_0x3bff5b[_0x199f61(0x251)][_0x375f9d],_0xe26afa=await _0xa753fa[_0x199f61(0x260)]('string');fs['writeFileSync'](configpath+_0xa753fa[_0x199f61(0x166)],_0xe26afa);}fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x199f61(0x1f3)](_0x440434=>{const _0x55072d=_0x199f61;if(!_0x440434[_0x55072d(0x17d)]())fs[_0x55072d(0x181)](temppath+_0x440434['name']);}),logger[_0x199f61(0x189)](_0x199f61(0x28c)),process['send']({'restore':!![]},_0x45dbb6=>{});}async function getPublicIp(){const _0x147306=_0x4455e6;try{const _0x2a3ec1=await axios[_0x147306(0x2d1)](_0x147306(0x170));publicip=_0x2a3ec1['data']['ip'];}catch(_0x507fb2){}}async function triggerAnalytics(){const _0x4b743f=_0x4455e6;if(!publicip)await getPublicIp();const _0x8eba1f=getBotsWithMode();let _0xa70d88=0x0;_0x8eba1f[_0x4b743f(0x1f3)](_0x5e7cc4=>{const _0x3dc810=_0x4b743f;if(_0x5e7cc4[_0x3dc810(0x136)]===_0x3dc810(0x2db))_0xa70d88++;});const _0x3a2eaf=getBotExchanges();mixpanel[_0x4b743f(0x2b7)](_0x4b743f(0x1a8),{'distinct_id':settings[_0x4b743f(0x2f0)],'ip':publicip,'version':serverversion,'numbots':_0x8eba1f[_0x4b743f(0x216)],'numbotsenabled':_0xa70d88,'exchanges':_0x3a2eaf,'environment':environment});}async function getMessages(){const _0x236cdf=_0x4455e6,_0x27e785=_0x236cdf(0x1f7),_0x4329e9=new GraphQLClient(_0x27e785),_0x24ab4c={'authorization':_0x236cdf(0x13b)},_0x4196c4=serverversion[_0x236cdf(0x2d2)]('.'),_0x5983f7=_0x4196c4[0x0]+'.'+_0x4196c4[0x1],_0x639630=Math[_0x236cdf(0x196)](settings[_0x236cdf(0x30b)],settings[_0x236cdf(0x2bf)]),_0x199792={'last':parseInt(_0x639630),'bbm':_0x5983f7},_0x5e0a60=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1f7cdf;try{_0x1f7cdf=await _0x4329e9[_0x236cdf(0x2c0)](_0x5e0a60,_0x199792,_0x24ab4c);}catch(_0x2161e2){}if(_0x1f7cdf&&_0x1f7cdf[_0x236cdf(0x2a0)]){let _0xfe093e=settings[_0x236cdf(0x30b)],_0x71379a=settings[_0x236cdf(0x30b)];newMessages=[];for(const _0x1e4526 of _0x1f7cdf[_0x236cdf(0x2a0)]){newMessages[_0x236cdf(0x1e6)](_0x1e4526);let _0x1c568d=![];_0x1e4526[_0x236cdf(0x182)]&&(updateSetting('latestversion',_0x1e4526[_0x236cdf(0x182)]),_0x1c568d=isNewerVersion(serverversion,_0x1e4526['bbvNew'])||serverversion==_0x1e4526[_0x236cdf(0x182)]);if(!_0x1c568d&&_0x1e4526[_0x236cdf(0x256)]>_0xfe093e){if(_0x1e4526[_0x236cdf(0x28e)]===_0x236cdf(0x1b5)||serverversion['startsWith'](_0x1e4526[_0x236cdf(0x28e)])){let _0x4fd148=''+_0x1e4526[_0x236cdf(0x15d)]+'\x0a\x0a'+_0x1e4526[_0x236cdf(0x1c3)];const _0x1621ec=await sendTelegramMsg(toTelegramMarkdown(_0x4fd148),_0x236cdf(0x174));_0xfe093e=_0x1e4526[_0x236cdf(0x256)];}}_0x71379a=_0x1e4526[_0x236cdf(0x256)];}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x71379a),emitMessages();}}function emitMessages(){const _0x3a205c=_0x4455e6,_0x3bb625=settings['lastmsgemitted'];let _0x4d451c=[];newMessages[_0x3a205c(0x1f3)](_0x167b67=>{const _0x41aba4=_0x3a205c;_0x167b67['number']>_0x3bb625&&_0x4d451c[_0x41aba4(0x1e6)](_0x167b67);}),_0x4d451c[_0x3a205c(0x216)]>0x0&&getAllClients()[_0x3a205c(0x1f3)](_0x269102=>{const _0x32f7db=_0x3a205c;getSocket(_0x269102['id'])['emit'](_0x32f7db(0x1c3),_0x4d451c);});}function confirmMessage(_0x1780e6){const _0x672697=_0x4455e6;updateSetting(_0x672697(0x2bf),Number(_0x1780e6));}function isNewerVersion(_0x31694f,_0x2cd413){const _0x5ee2d2=_0x2cd413['split']('.'),_0x124197=_0x31694f['split']('.');for(var _0x842aa=0x0;_0x842aa<_0x124197['length'];_0x842aa++){const _0x4f9291=~~_0x124197[_0x842aa],_0x5b9f2c=~~_0x5ee2d2[_0x842aa];if(_0x4f9291>_0x5b9f2c)return!![];if(_0x4f9291<_0x5b9f2c)return![];}return![];}function toTelegramMarkdown(_0x3b1c9d){const _0x2a1c60=_0x4455e6,_0x376764=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3214e7=/\*{2}(.+?)\*{2}/gim;return _0x3b1c9d=_0x3b1c9d[_0x2a1c60(0x241)](_0x376764,_0x2a1c60(0x1dc))[_0x2a1c60(0x241)](_0x3214e7,_0x2a1c60(0x271)),_0x3b1c9d;}async function validateConfigFile(){const _0x56c474=_0x4455e6,_0x3e200f=dbConfig[_0x56c474(0x2d1)](_0x56c474(0x162))[_0x56c474(0x2ec)](_0x56c474(0x279))[_0x56c474(0x2c9)]()||[];if(_0x3e200f[_0x56c474(0x216)]==0x0){let _0x5ea87a=0x0,_0xd1cebe=[];const _0x193b71=/^bot-([0-9]{3})-config.json$/,_0x47debc=fs['readdirSync'](configpath);_0x47debc['forEach'](_0x18f648=>{const _0x258b10=_0x56c474,_0x55c1da=_0x193b71[_0x258b10(0x1a2)](_0x18f648);if(_0x55c1da){const _0x1b68cf=_0x55c1da[0x1];let _0x20f8ef=getBotAttributes(_0x1b68cf);_0xd1cebe['push']({'botID':_0x1b68cf,'botname':_0x20f8ef['botname'],'status':'disabled','live':'stopped'}),_0x5ea87a++;}}),_0x5ea87a!=0x0&&(dbConfig[_0x56c474(0x2d1)]('bots')['assign'](_0xd1cebe)['write'](),config=_0xd1cebe,restoredConfigFile=_0x5ea87a);}}async function restoreConfigNotify(_0xe84568){const _0x4602b3=_0x4455e6;let _0x159e41;if(restoredConfigFile==0x1)_0x159e41=_0x4602b3(0x223);else _0x159e41='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0xe84568)io['to'](_0x4602b3(0x151))[_0x4602b3(0x1ca)]('notification',_0x159e41);else{logger[_0x4602b3(0x185)](_0x4602b3(0x1fe)),logger[_0x4602b3(0x185)](_0x159e41),logger['simple'](_0x4602b3(0x1fe)),logger['simple']('');if(tgBot&&settings['telegramChatId']&&settings[_0x4602b3(0x1c7)]!='orders')await sendTelegram(settings[_0x4602b3(0x253)],_0x4602b3(0x24d)+_0x159e41);}}function decryptRSA(_0x5e3983,_0x2723e1){const _0x335eb7=_0x4455e6,_0xdd8d3a=forge['pki']['privateKeyFromPem'](_0x5e3983),_0x582e4c=_0xdd8d3a[_0x335eb7(0x20a)](forge[_0x335eb7(0x215)][_0x335eb7(0x25c)](_0x2723e1),_0x335eb7(0x1ee),{'md':forge['md'][_0x335eb7(0x17c)][_0x335eb7(0x267)](),'mgf1':{'md':forge['md'][_0x335eb7(0x17c)][_0x335eb7(0x267)]()}});return _0x582e4c;}function validateCredentials(_0x559fea,_0x200577){const _0x388f01=_0x4455e6;if(_0x559fea[_0x388f01(0x210)]==settings[_0x388f01(0x111)]&&bcrypt[_0x388f01(0x22f)](_0x559fea['password'],settings[_0x388f01(0x1cb)])){if(settings[_0x388f01(0x1e0)])return{'allow':![],'reason':_0x388f01(0x1ba),'token':null};else{const _0x614f6e=generateLoginToken(_0x200577);return{'allow':!![],'reason':_0x388f01(0x14c),'token':_0x614f6e};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x4fe133){const _0x5ad68a=_0x4455e6,_0xb876c5=generateLoginToken(_0x4fe133);return{'allow':!![],'reason':_0x5ad68a(0x14c),'token':_0xb876c5};}function validateAccess(_0x177b67,_0x47a40e,_0x3e4eb2){const _0x5d8368=_0x4455e6,_0xa6b7f1=_0x3e4eb2?_0x3e4eb2:devices[_0x47a40e]['ip'];let _0x4f247a;const _0x13db64=_0x5357fe=>{const _0x1b375b=_0x53e2;if(settings[_0x1b375b(0x2f2)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x47a40e)){const _0x5a0d19=generateLoginToken(_0x47a40e);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x5a0d19};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x4f247a=validToken(_0x5357fe,_0x47a40e),_0x4f247a['hasOwnProperty']('success')?{'allow':!![],'reason':_0x1b375b(0x1d9),'token':_0x5357fe}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings['whitelistEnabled']){let _0x291b70=[...settings[_0x5d8368(0x27f)],_0x5d8368(0x18a),_0x5d8368(0x233),_0x5d8368(0x25b)];if(_0x291b70[_0x5d8368(0x149)](_0xa6b7f1))return _0x13db64(_0x177b67);else{_0x4f247a=validToken(_0x177b67,_0x47a40e);if(_0x4f247a[_0x5d8368(0x240)](_0x5d8368(0x154)))return _0x13db64(_0x177b67);else{if(telegramIpApproved(_0x47a40e)){const _0x16d334=generateToken(_0x47a40e);return _0x4f247a=_0x13db64(_0x177b67),_0x4f247a[_0x5d8368(0x2c3)]?{'allow':!![],'reason':_0x5d8368(0x153),'token':_0x16d334}:_0x4f247a;}else return settings[_0x5d8368(0x175)]?{'allow':![],'reason':_0x5d8368(0x2e4),'token':null}:{'allow':![],'reason':_0x5d8368(0x163),'token':null};}}}else return _0x13db64(_0x177b67);}function timelyDecrypt(_0x4027d0,_0x26c1c2,_0x216b67='@'){const _0x46a39d=_0x4455e6;if(_0x4027d0)try{const _0x3275c5=decryptRSA(secure[_0x46a39d(0x259)],_0x4027d0),_0x5251b7=_0x3275c5['split'](_0x216b67)[0x0],_0x4246d5=_0x3275c5[_0x46a39d(0x2d2)](_0x216b67)[0x1],_0x2ea76d=new Date()[_0x46a39d(0x287)]();if(_0x26c1c2){if(_0x2ea76d-_0x4246d5<maxSecretAge*0x3e8)return _0x5251b7;else return![];}else return _0x5251b7;}catch(_0x474c15){return![];}else return![];}const validToken=(_0x17869c,_0x40a3b3)=>{const _0x688181=_0x4455e6,_0x126949=devices[_0x40a3b3]['ip'];if(!_0x17869c)return{'error':_0x688181(0x107)};for(let _0x38659a of blacklist){if(_0x38659a[_0x688181(0x224)]==_0x17869c)return{'error':_0x688181(0x1d7)};}let _0x41d005;try{_0x41d005=jwt[_0x688181(0x1a4)](_0x17869c,secure['secret']+_0x40a3b3);}catch{return{'error':_0x688181(0x29a)};}if(!_0x41d005[_0x688181(0x240)](_0x688181(0x31a))&&!_0x41d005[_0x688181(0x240)](_0x688181(0x210))||!_0x41d005['hasOwnProperty'](_0x688181(0x25d)))return{'error':_0x688181(0x2b6)};if(!_0x41d005['hasOwnProperty'](_0x688181(0x210))&&_0x41d005['hasOwnProperty'](_0x688181(0x31a))){const {clientip:_0xd414b7}=_0x41d005;return _0x126949==_0xd414b7?{'success':_0x688181(0x1b1)}:{'error':_0x688181(0x19b)};}else{if(_0x41d005['hasOwnProperty'](_0x688181(0x210))&&_0x41d005[_0x688181(0x240)](_0x688181(0x31a))){const {username:_0x5ade34,clientip:_0x2d7fd5}=_0x41d005;return settings[_0x688181(0x111)]==_0x5ade34&&_0x126949==_0x2d7fd5?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x688181(0x301)};}}},generateLoginToken=_0x342b86=>{const _0x490bd3=_0x4455e6;if(_0x342b86){const _0x4b845b=devices[_0x342b86]['ip'];return jwt[_0x490bd3(0x2e0)]({'username':settings[_0x490bd3(0x111)],'clientip':_0x4b845b},secure[_0x490bd3(0x284)]+_0x342b86,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x38ced1=>{const _0x4a5a8b=_0x4455e6;if(_0x38ced1){const _0x534dba=devices[_0x38ced1]['ip'];return jwt[_0x4a5a8b(0x2e0)]({'clientip':_0x534dba},secure[_0x4a5a8b(0x284)]+_0x38ced1,{'expiresIn':devices[_0x38ced1][_0x4a5a8b(0x179)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x1d2fad=>{const _0x17001f=_0x4455e6;let _0x3edbca=![];return devices[_0x1d2fad][_0x17001f(0x179)]&&devices[_0x1d2fad]['telegramIpApproval'][_0x17001f(0x230)]!='reject'&&(_0x3edbca=devices[_0x1d2fad][_0x17001f(0x179)][_0x17001f(0x31a)]==devices[_0x1d2fad]['ip']&&new Date()[_0x17001f(0x287)]()-devices[_0x1d2fad]['telegramIpApproval']['timestamp']<devices[_0x1d2fad][_0x17001f(0x179)][_0x17001f(0x230)]*0x3c*0x3e8),_0x3edbca;},telegram2FaApproved=_0x546d54=>{const _0x126f2d=_0x4455e6;let _0x31e348=![];return devices[_0x546d54][_0x126f2d(0x142)]&&devices[_0x546d54][_0x126f2d(0x142)][_0x126f2d(0x230)]!=_0x126f2d(0x19a)&&(_0x31e348=devices[_0x546d54]['telegram2FaApproval'][_0x126f2d(0x31a)]==devices[_0x546d54]['ip']&&new Date()[_0x126f2d(0x287)]()-devices[_0x546d54]['telegram2FaApproval'][_0x126f2d(0x109)]<devices[_0x546d54][_0x126f2d(0x142)][_0x126f2d(0x230)]*0x3c*0x3e8),_0x31e348;},normalizeIP=_0x4dd000=>{const _0xde0a29=_0x4455e6;let _0x4f98c4=null,_0x6a736e=null;if(ipaddr[_0xde0a29(0x156)](_0x4dd000)){const _0x21f3da=ipaddr[_0xde0a29(0x2e7)](_0x4dd000);_0x21f3da[_0xde0a29(0x2da)]()===_0xde0a29(0x20d)?(_0x21f3da[_0xde0a29(0x113)]()&&(_0x4f98c4=_0x21f3da[_0xde0a29(0x17f)]()['toString']()),_0x6a736e=_0x21f3da[_0xde0a29(0x31c)]()):(_0x4f98c4=_0x21f3da[_0xde0a29(0x31c)](),_0x6a736e=_0x21f3da[_0xde0a29(0x220)]()['toString']());}return{'show':_0x4f98c4?_0x4f98c4:_0x6a736e,'store':_0x6a736e};};function formatDate(_0x5c1c9a){const _0x4132f5=_0x4455e6;return _0x5c1c9a[_0x4132f5(0x212)]()+'/'+(_0x5c1c9a['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x5c1c9a[_0x4132f5(0x293)]()[_0x4132f5(0x31c)]()['padStart'](0x2,'0')+'\x20'+_0x5c1c9a[_0x4132f5(0x302)]()['toString']()[_0x4132f5(0x1db)](0x2,'0')+':'+_0x5c1c9a[_0x4132f5(0x1d5)]()[_0x4132f5(0x31c)]()[_0x4132f5(0x1db)](0x2,'0')+':'+_0x5c1c9a[_0x4132f5(0x2ad)]()['toString']()[_0x4132f5(0x1db)](0x2,'0');}function sleep(_0x21684b){return new Promise(_0x29bb74=>setTimeout(_0x29bb74,_0x21684b));}