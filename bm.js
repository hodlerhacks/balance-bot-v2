const _0x57e089=_0x36dc;(function(_0x2735eb,_0xedf9fd){const _0x1104fb=_0x36dc,_0x384623=_0x2735eb();while(!![]){try{const _0xf28b27=-parseInt(_0x1104fb(0x2a6))/0x1+parseInt(_0x1104fb(0x1e0))/0x2*(-parseInt(_0x1104fb(0xed))/0x3)+parseInt(_0x1104fb(0x253))/0x4*(-parseInt(_0x1104fb(0x1b2))/0x5)+parseInt(_0x1104fb(0x263))/0x6+parseInt(_0x1104fb(0x24a))/0x7+parseInt(_0x1104fb(0x2c9))/0x8+parseInt(_0x1104fb(0x2b8))/0x9;if(_0xf28b27===_0xedf9fd)break;else _0x384623['push'](_0x384623['shift']());}catch(_0x23a4a5){_0x384623['push'](_0x384623['shift']());}}}(_0x3012,0xa3cd1));const _0x26095f=function(){let _0x2f078a=!![];return function(_0x55a132,_0x4f0af0){const _0x3097d5=_0x2f078a?function(){if(_0x4f0af0){const _0x2755d0=_0x4f0af0['apply'](_0x55a132,arguments);return _0x4f0af0=null,_0x2755d0;}}:function(){};return _0x2f078a=![],_0x3097d5;};}(),_0x45e52d=_0x26095f(this,function(){const _0x174310=_0x36dc;return _0x45e52d[_0x174310(0x2a0)]()['search'](_0x174310(0x120))[_0x174310(0x2a0)]()[_0x174310(0xdf)](_0x45e52d)[_0x174310(0x150)]('(((.+)+)+)+$');});_0x45e52d();'use strict';process['env'][_0x57e089(0x1f7)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require('date-fns'),low=require(_0x57e089(0x159)),FileSync=require(_0x57e089(0x2c8)),path=require('path'),crypto=require(_0x57e089(0xec)),forge=require('node-forge'),bcrypt=require(_0x57e089(0x2cf)),jwt=require(_0x57e089(0x14b)),ipaddr=require('ipaddr.js'),argv=require(_0x57e089(0x1ee))(process[_0x57e089(0x246)][_0x57e089(0x139)](0x2))[_0x57e089(0x246)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x57e089(0x102)),Mixpanel=require(_0x57e089(0x245)),axios=require(_0x57e089(0x1f1)),{GraphQLClient,gql}=require(_0x57e089(0x1ea)),util=require('util'),fileUpload=require(_0x57e089(0xc5)),{networkInterfaces}=require('os'),JSZip=require(_0x57e089(0x18f)),PORT=argv[_0x57e089(0x22d)]||_0x57e089(0x157),pattern=/^[0-9]{2,4}$/;!pattern[_0x57e089(0x19e)](PORT)&&(console[_0x57e089(0xce)](_0x57e089(0x232)+PORT+_0x57e089(0xe1)),process['exit'](0x1));const HOST=argv['host']||null,userID=argv[_0x57e089(0x252)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process['versions']['node'];let bbpath='bb/',bbpath2='';const botfile=_0x57e089(0x178),configfile=_0x57e089(0x208),settingsfile='bb-settings.json',securefile=_0x57e089(0x244),environment=require('./'+bbpath2+_0x57e089(0x228))[_0x57e089(0xd2)]||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x57e089(0x255)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x57e089(0x1b0)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x57e089(0x1bd),logspath=userID?bbpath+_0x57e089(0x256)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x57e089(0x15d)+userID+'/':bbpath+_0x57e089(0x15d),loggerfile=fs[_0x57e089(0x1f8)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0x57e089(0x27d)+userID+'/':bbpath+'temp/';!fs[_0x57e089(0x255)](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x57e089(0x25b)](configbackuppath);!fs[_0x57e089(0x255)](logspath)&&fs[_0x57e089(0x25b)](logspath);!fs['existsSync'](zippath)&&fs[_0x57e089(0x25b)](zippath);!fs[_0x57e089(0x255)](temppath)&&fs[_0x57e089(0x25b)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x57e089(0x1ec)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x57e089(0x1ec)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x57e089(0xd0)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();const saltRounds=0xa,mixpanel=Mixpanel['init']('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x57e089(0x1b3)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x57e089(0x1d9)]&&(settings[_0x57e089(0x1d9)]!=''&&settings[_0x57e089(0x1d9)]!=_0x57e089(0x174))&&settings[_0x57e089(0x15c)]&&settings[_0x57e089(0x15c)]!='')initTelegram();const parseColor=(_0x54b507,_0x51f3fb)=>{const _0x2b4bdf=_0x57e089,_0x569fa5=/#[A-Z]{3}#/g;if(typeof _0x54b507==_0x2b4bdf(0x1a7)){!_0x51f3fb?_0x54b507=_0x54b507[_0x2b4bdf(0x1dd)](_0x569fa5,''):(_0x54b507=_0x54b507[_0x2b4bdf(0x1dd)](/#BLU#/g,_0x2b4bdf(0x28e)),_0x54b507=_0x54b507[_0x2b4bdf(0x1dd)](/#RED#/g,_0x2b4bdf(0x125)),_0x54b507=_0x54b507[_0x2b4bdf(0x1dd)](/#YEL#/g,'\x1b[33m'),_0x54b507=_0x54b507[_0x2b4bdf(0x1dd)](/#MAG#/g,'\x1b[35m'),_0x54b507=_0x54b507[_0x2b4bdf(0x1dd)](/#CYA#/g,'\x1b[36m'),_0x54b507=_0x54b507[_0x2b4bdf(0x1dd)](/#RES#/g,'\x1b[0m'));;}return _0x54b507;},logger={'screen':_0x5d30b9=>{const _0x491d80=_0x57e089;console[_0x491d80(0xce)](parseColor(_0x5d30b9,!![]));},'simple':_0x35847e=>{const _0xd0bfa6=_0x57e089;console[_0xd0bfa6(0xce)](parseColor(_0x35847e,!![])),loggerfile['write'](util[_0xd0bfa6(0x140)](parseColor(_0x35847e,![]))+'\x0a');},'full':async _0x5a4624=>{const _0x196ff4=_0x57e089,_0x5bc2c2=getTimeStamp()+_0x196ff4(0x28d)+_0x5a4624;console[_0x196ff4(0xce)](parseColor(_0x5bc2c2,!![])),loggerfile['write'](util['format'](parseColor(_0x5bc2c2,![]))+'\x0a');if(tgBot&&settings[_0x196ff4(0xdb)]&&settings[_0x196ff4(0x101)]!='orders')await sendTelegram(settings['telegramChatId'],_0x196ff4(0x141)+parseColor(_0x5a4624,![]));},'debug':async(_0xbd5802,_0x4733bd='')=>{const _0xaf1eac=_0x57e089,_0x3f05df=getTimeStamp()+_0xaf1eac(0x2b6)+_0xbd5802;if(debugging)console[_0xaf1eac(0xce)](parseColor(_0x3f05df,!![]));loggerfile[_0xaf1eac(0xd0)](util[_0xaf1eac(0x140)](parseColor(_0x3f05df,![]))+'\x0a');if(_0x4733bd){if(debugging)console[_0xaf1eac(0xce)](_0x4733bd);loggerfile[_0xaf1eac(0xd0)](util[_0xaf1eac(0x140)](_0x4733bd)+'\x0a');}}};let terminating=![];process['on'](_0x57e089(0xbc),function(_0xa27be9){const _0x2aac59=_0x57e089;_0xa27be9[_0x2aac59(0x2a0)]()[_0x2aac59(0x206)](_0x2aac59(0x285))?(logger[_0x2aac59(0x184)](_0x2aac59(0x27b)+_0xa27be9[_0x2aac59(0x22d)]+_0x2aac59(0x156)),process['send']({'terminate':!![]},_0x27e75d=>{})):logger[_0x2aac59(0x184)](_0xa27be9);}),process['on'](_0x57e089(0x1e4),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x57e089(0x11e),()=>{const _0x347988=_0x57e089;stopAllBots(),process[_0x347988(0x1e4)](0x0);}),process['on'](_0x57e089(0xe0),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x57e089(0x228))[_0x57e089(0x2c0)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x57e089(0xd5)),app=express(),http=require('http')[_0x57e089(0x1be)](app);app[_0x57e089(0x289)](fileUpload({'useTempFiles':!![]})),app['get'](_0x57e089(0x19b),async(_0x564258,_0xa233d6)=>{const _0x34eaee=_0x57e089,_0x2c0987=_0x564258[_0x34eaee(0xff)]['type'],_0x45b110=getClientsWithBotID('botmanager'),_0x1a2f90=_0x564258[_0x34eaee(0x124)][_0x34eaee(0x104)],_0x47cd1c=timelyDecrypt(_0x1a2f90,![]),_0x10ab31=_0x45b110[_0x34eaee(0x236)](_0x57e537=>_0x57e537['uuid']==_0x47cd1c);if(_0x10ab31){const _0x4a656b=normalizeIP(_0x564258[_0x34eaee(0xe5)][_0x34eaee(0x241)])['store'],_0x2ad8cd=_0x564258[_0x34eaee(0x124)]['tkn'];if(validateAccess(_0x2ad8cd,_0x47cd1c,_0x4a656b)['allow'])_0x2c0987==_0x34eaee(0x1bf)&&await backupConfigFiles(),await zipFiles(_0x2c0987),_0xa233d6[_0x34eaee(0x287)](zippath+(_0x2c0987+_0x34eaee(0x25e)),_0x2ae028=>{const _0x4e9229=_0x34eaee;_0x2ae028&&(logger['full'](_0x4e9229(0x1a9)+_0x2c0987),logger[_0x4e9229(0x184)](_0x2ae028));});else logger[_0x34eaee(0x1cd)](_0x34eaee(0x21a)+_0x2c0987+_0x34eaee(0x269));}else logger[_0x34eaee(0x1cd)](_0x34eaee(0x21a)+_0x2c0987+_0x34eaee(0x12e));}),app[_0x57e089(0x16d)](_0x57e089(0x187),async(_0x236b07,_0x3cd3da)=>{const _0x4e0802=_0x57e089,_0x3998a4=getClientsWithBotID('botmanager'),_0xc5165a=_0x236b07[_0x4e0802(0x124)][_0x4e0802(0x104)],_0x111043=timelyDecrypt(_0xc5165a,![]),_0x3aab90=_0x3998a4[_0x4e0802(0x236)](_0x23629d=>_0x23629d[_0x4e0802(0x104)]==_0x111043);logger[_0x4e0802(0x16a)](_0x4e0802(0xf4));if(_0x3aab90){const _0x4e27b1=normalizeIP(_0x236b07['socket']['remoteAddress'])[_0x4e0802(0x11f)],_0x37e15e=_0x236b07[_0x4e0802(0x124)][_0x4e0802(0xe9)];if(validateAccess(_0x37e15e,_0x111043,_0x4e27b1)[_0x4e0802(0x169)]){if(_0x236b07[_0x4e0802(0x1d5)]){const _0x2ee07a=_0x236b07[_0x4e0802(0x1d5)][_0x4e0802(0xd6)];await _0x2ee07a['mv'](temppath+_0x2ee07a[_0x4e0802(0x2c2)]),_0x3cd3da['send']({'status':!![],'message':_0x4e0802(0x1f6)});const _0x41ff0d=getBotsWithMode();_0x41ff0d[_0x4e0802(0x13a)]>0x0?confirmRestore(temppath,_0x2ee07a[_0x4e0802(0x2c2)]):unzipFile(temppath,_0x2ee07a[_0x4e0802(0x2c2)]);}}else logger[_0x4e0802(0x1cd)](_0x4e0802(0x15e));}else logger[_0x4e0802(0x1cd)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x57e089(0x289)](express[_0x57e089(0x1ca)](path[_0x57e089(0x221)](__dirname,bbpath2,_0x57e089(0x160)))),app[_0x57e089(0x289)](express[_0x57e089(0x1ca)](path[_0x57e089(0x221)](__dirname,bbpath2,_0x57e089(0x1f4)))),app[_0x57e089(0x2b7)]('/',function(_0x2213bb,_0x249043){const _0xdd6a99=_0x57e089;_0x249043[_0xdd6a99(0xf6)](path[_0xdd6a99(0x221)](__dirname,bbpath2,_0xdd6a99(0x160),_0xdd6a99(0x1d7)));}),app['get'](_0x57e089(0xe2),function(_0x6e3e5c,_0x10795b){const _0xbd32b0=_0x57e089;_0x10795b['sendFile'](path[_0xbd32b0(0x221)](__dirname,bbpath2,_0xbd32b0(0x1f4),_0xbd32b0(0x1d7)));}),app[_0x57e089(0x2b7)](_0x57e089(0x2c5),(_0x1b9c2b,_0x42469b)=>{const _0x241eac=_0x57e089;_0x42469b[_0x241eac(0xf6)](path[_0x241eac(0x221)](__dirname,bbpath2,_0x241eac(0x1f4),'index.html'));}),app[_0x57e089(0x2b7)](_0x57e089(0x23a),(_0x32f704,_0xee7754)=>{const _0xb2e130=_0x57e089;_0xee7754[_0xb2e130(0xf6)](path[_0xb2e130(0x221)](__dirname,bbpath2,_0xb2e130(0x1f4),_0xb2e130(0x1d7)));}),app[_0x57e089(0x2b7)](_0x57e089(0x2cd),(_0xe28695,_0x3bc451)=>{const _0xd86d5c=_0x57e089;_0x3bc451[_0xd86d5c(0xf6)](path['join'](__dirname,bbpath2,'build',_0xd86d5c(0x1d7)));}),app[_0x57e089(0x2b7)]('/:bot/history',(_0x4845ab,_0x343c88)=>{const _0x192170=_0x57e089;_0x343c88[_0x192170(0xf6)](path[_0x192170(0x221)](__dirname,bbpath2,_0x192170(0x1f4),_0x192170(0x1d7)));}),app['get'](_0x57e089(0x14a),(_0x10e845,_0x90a594)=>{const _0x506f6b=_0x57e089;_0x90a594[_0x506f6b(0xf6)](path[_0x506f6b(0x221)](__dirname,bbpath2,_0x506f6b(0x1f4),'index.html'));}),app[_0x57e089(0x2b7)](_0x57e089(0x1bc),(_0x3eda93,_0x3828ec)=>{const _0x17f3cf=_0x57e089;_0x3828ec[_0x17f3cf(0xf6)](path[_0x17f3cf(0x221)](__dirname,bbpath2,_0x17f3cf(0x1f4),'index.html'));});if(HOST)http[_0x57e089(0x1c8)](PORT,HOST);else http[_0x57e089(0x1c8)](PORT);const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5d958d=_0x57e089;let _0x41b130=_0x5d958d(0x198);const _0x109a04=networkInterfaces(),_0x76d8eb={};for(const _0x3687e6 of Object['keys'](_0x109a04)){for(const _0x355767 of _0x109a04[_0x3687e6]){if((_0x355767[_0x5d958d(0xda)]==_0x5d958d(0x17c)||_0x355767[_0x5d958d(0xda)]==0x4)&&!_0x355767[_0x5d958d(0xf5)]){const _0x1b2b19=ipaddr['parse'](_0x355767['address'])['range']();_0x1b2b19!=_0x5d958d(0x1c1)&&(!_0x76d8eb[_0x3687e6]&&(_0x76d8eb[_0x3687e6]=[]),_0x76d8eb[_0x3687e6][_0x5d958d(0x16e)](_0x355767[_0x5d958d(0x29b)]),_0x41b130=_0x355767['address']);}}}return{'serverip':_0x41b130,'netinterfaces':_0x76d8eb};}async function startServer(){const _0x1e4c6d=_0x57e089,{serverip:_0x30ab3e,netinterfaces:_0x323c39}=getServerIP();logger['simple'](''),logger[_0x1e4c6d(0x184)](_0x1e4c6d(0x1a1)),await logger[_0x1e4c6d(0x1cd)](_0x1e4c6d(0x1da)+serverversion+'#RES#\x20'+(environment=='staging'?_0x1e4c6d(0x1e8):'')+'\x0a'+(_0x1e4c6d(0x1f5)+PORT+_0x1e4c6d(0x296))+('=>\x20Go\x20to\x20#CYA#http://'+_0x30ab3e+':'+PORT+_0x1e4c6d(0xf2))),logger[_0x1e4c6d(0x184)](_0x1e4c6d(0x1a1));if(config[_0x1e4c6d(0x13a)]!=0x0)for(const _0x36915a of config){const _0x139fc4=_0x36915a[_0x1e4c6d(0x209)]==_0x1e4c6d(0x127)?'a':'m';if(_0x36915a[_0x1e4c6d(0x275)]==_0x1e4c6d(0xfd)||_0x36915a[_0x1e4c6d(0x275)]==_0x1e4c6d(0x168))await logger['full']('Starting\x20('+_0x139fc4+')\x20|\x20Bot\x20'+_0x36915a[_0x1e4c6d(0x24b)]+_0x1e4c6d(0x213)+_0x36915a['botname']),startBot([_0x36915a[_0x1e4c6d(0x24b)],userID],{'cwd':bbpath},function(_0x32bd22){const _0x49c5bc=_0x1e4c6d;if(_0x32bd22)logger[_0x49c5bc(0x1cd)](_0x32bd22);});else(_0x36915a[_0x1e4c6d(0x275)]==_0x1e4c6d(0x22a)||_0x36915a[_0x1e4c6d(0x275)]==_0x1e4c6d(0x138))&&await logger['full'](_0x1e4c6d(0x13e)+_0x139fc4+_0x1e4c6d(0x2ca)+_0x36915a['botID']+_0x1e4c6d(0x213)+_0x36915a['botname']);}else!newBot&&logger['simple'](_0x1e4c6d(0x1c4));if(newBot)addBot();logger[_0x1e4c6d(0x184)](_0x1e4c6d(0x1a1)),logger[_0x1e4c6d(0x184)](''),await logger[_0x1e4c6d(0x16a)](_0x1e4c6d(0x10b)+nodeversion),await logger[_0x1e4c6d(0x16a)](_0x1e4c6d(0x2bf),_0x323c39);}function startSocket(){const _0x4a671a=_0x57e089;io['on'](_0x4a671a(0x20e),_0x36315a=>{const _0x349b2c=_0x4a671a;let _0xd39bbe,_0x542b83,_0x4d109c,_0x183b07,_0x5a16be;const _0x472c57=_0x36315a[_0x349b2c(0x1a5)]['headers'][_0x349b2c(0xcd)];_0x542b83=_0x472c57['match'](/bot[0-9]{3}/);if(_0x542b83)_0x4d109c=_0x542b83[0x0]['match'](/[0-9]{3}/);if(_0x4d109c)_0xd39bbe=_0x4d109c[0x0];else _0xd39bbe=_0x349b2c(0x1df);const _0x17937b=_0x36315a[_0x349b2c(0x1a5)][_0x349b2c(0x258)][_0x349b2c(0x207)];if(!_0x17937b)_0x36315a[_0x349b2c(0xd4)](_0x349b2c(0x275),{'publicKey':secure[_0x349b2c(0x180)]});else{_0x183b07=timelyDecrypt(_0x17937b,![]);if(!_0x183b07)_0x36315a['emit']('status',{'publicKey':secure[_0x349b2c(0x180)]});else{_0x5a16be=normalizeIP(_0x36315a[_0x349b2c(0x272)][_0x349b2c(0x241)])[_0x349b2c(0x11f)];if(!devices[_0x183b07])devices[_0x183b07]={'uuid':_0x183b07,'access':{'token':null}};devices[_0x183b07]['ip']=_0x5a16be;const _0x303009=addClient(_0x36315a['id'],_0x183b07,_0xd39bbe);setAccess(_0x303009),emitMessages(),_0x36315a['on'](_0x349b2c(0x2ac),_0x2ea08f=>{const _0x338629=_0x349b2c,_0x43564e=timelyDecrypt(_0x2ea08f['password'],!![],_0x338629(0x24c));if(_0x43564e){_0x2ea08f={'username':_0x2ea08f[_0x338629(0x196)],'password':_0x43564e},devices[_0x183b07][_0x338629(0x1eb)]=validateCredentials(_0x2ea08f,_0x183b07);if(devices[_0x183b07]['access']['allow']==![]&&devices[_0x183b07]['access']['reason']==_0x338629(0x133))_0x36315a['emit'](_0x338629(0x275),{'access':devices[_0x183b07][_0x338629(0x1eb)]}),loginAccess2FA(_0x183b07,_0x5a16be);else{if(devices[_0x183b07]['access'][_0x338629(0x169)]==![]&&devices[_0x183b07]['access'][_0x338629(0x1ad)]==_0x338629(0x20a))_0x36315a[_0x338629(0xd4)](_0x338629(0x275),{'access':devices[_0x183b07]['access']});else devices[_0x183b07]['access'][_0x338629(0x169)]&&devices[_0x183b07][_0x338629(0x1eb)][_0x338629(0x1ad)]==_0x338629(0x26c)&&(getClientsWithUuid(_0x183b07)['forEach'](_0x3a5bd8=>{setAccess(_0x3a5bd8);}),logger['debug'](_0x338629(0xc0)+_0x183b07['slice'](-0x8)),setTokenRefresh(_0x183b07),setSessionTimeout(_0x338629(0x2ac),_0x183b07));}}else logger[_0x338629(0x1cd)](_0x338629(0x1e3));}),_0x36315a['on'](_0x349b2c(0x115),()=>{resetPassword();}),_0x36315a['on'](_0x349b2c(0x123),_0x583b85=>{removeClient(_0x36315a['id']);}),_0xd39bbe==_0x349b2c(0x1df)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x205794){const _0x471891=_0x57e089;if(_0x205794!=_0x471891(0x1df)&&config[_0x471891(0xf9)]!=''){if(pid[_0x205794])pid[_0x205794]['send']({'function':_0x471891(0x276),'args':null});}_0x205794!=_0x471891(0x1df)&&broadcastToBots(_0x471891(0x1e6),JSON['stringify'](config));}function reloadBotManager(){const _0x8ca764=_0x57e089;getClientsWithBotID(_0x8ca764(0x1df))[_0x8ca764(0x10f)](_0x21b08c=>{const _0x36c781=_0x8ca764;getSocket(_0x21b08c['id'])[_0x36c781(0xd4)]('status',{'access':{'allow':![],'reason':_0x36c781(0x1e9),'token':null}});});}function getSocket(_0x5621d4){const _0x2d4ce7=_0x57e089,_0x9fea12=io['_nsps'][_0x2d4ce7(0x2b7)]('/');return _0x9fea12[_0x2d4ce7(0x2b0)][_0x2d4ce7(0x2b7)](_0x5621d4);}function _0x36dc(_0x41226e,_0x3890db){const _0x3ac92f=_0x3012();return _0x36dc=function(_0x45e52d,_0x26095f){_0x45e52d=_0x45e52d-0xb9;let _0x30123b=_0x3ac92f[_0x45e52d];return _0x30123b;},_0x36dc(_0x41226e,_0x3890db);}function setAccess(_0x48e88f){const _0x32f3de=_0x57e089,_0x20abc3=getSocket(_0x48e88f['id']),_0x489447=_0x48e88f['uuid'],_0x16685d=_0x48e88f[_0x32f3de(0x2cc)];devices[_0x489447][_0x32f3de(0x1eb)]=validateAccess(devices[_0x489447][_0x32f3de(0x1eb)][_0x32f3de(0xca)],_0x489447),logger[_0x32f3de(0x16a)](_0x32f3de(0x19c)+devices[_0x489447][_0x32f3de(0x1eb)][_0x32f3de(0x1ad)]+_0x32f3de(0x278)+_0x48e88f['id'][_0x32f3de(0x139)](-0x8)+_0x32f3de(0xbd)+_0x489447['slice'](-0x8)),_0x20abc3[_0x32f3de(0x221)](_0x489447);if(devices[_0x489447][_0x32f3de(0x1eb)][_0x32f3de(0x169)]){_0x20abc3[_0x32f3de(0x221)](_0x16685d);if(_0x16685d==_0x32f3de(0x1df))initializeSocketBotManager(_0x20abc3);else initializeSocketBot(_0x20abc3);initClient(_0x16685d);}devices[_0x489447][_0x32f3de(0x1eb)]['token']&&devices[_0x489447]['access'][_0x32f3de(0x1ad)]==_0x32f3de(0x20f)&&setSessionTimeout(_0x32f3de(0xb9),_0x489447),devices[_0x489447][_0x32f3de(0x1eb)][_0x32f3de(0xca)]&&devices[_0x489447][_0x32f3de(0x1eb)][_0x32f3de(0x1ad)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x32f3de(0x2ac),_0x489447),_0x20abc3['emit'](_0x32f3de(0x275),{'status':_0x48e88f[_0x32f3de(0x254)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x489447]['access'],'externalip':devices[_0x489447]['ip'],'publicKey':secure[_0x32f3de(0x180)],'userid':settings[_0x32f3de(0x28f)],'validInstallation':validInstallation}),devices[_0x489447][_0x32f3de(0x1eb)][_0x32f3de(0x169)]==![]&&devices[_0x489447]['access'][_0x32f3de(0x1ad)]==_0x32f3de(0x273)&&temporaryAccess2FA(_0x489447,devices[_0x489447]['ip']);}function setSessionTimeout(_0x23eac0,_0x4d84bf){const _0x601afa=_0x57e089;let _0x10a7d6;if(_0x23eac0==_0x601afa(0x2ac))_0x10a7d6=loginExpiry*0x3c*0x3e8;else _0x10a7d6=devices[_0x4d84bf]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()[_0x601afa(0x18c)]()-devices[_0x4d84bf][_0x601afa(0xe6)][_0x601afa(0x129)]);if(devices[_0x4d84bf][_0x601afa(0x291)])clearTimeout(devices[_0x4d84bf][_0x601afa(0x291)]);devices[_0x4d84bf]['pidExpireLogin']=setTimeout(()=>{const _0x5d872b=_0x601afa;if(devices[_0x4d84bf][_0x5d872b(0x265)])clearTimeout(devices[_0x4d84bf][_0x5d872b(0x265)]);removeSocketListeners(_0x4d84bf),addBlacklist(_0x4d84bf),devices[_0x4d84bf][_0x5d872b(0xe6)]=null,devices[_0x4d84bf][_0x5d872b(0x128)]=null,devices[_0x4d84bf][_0x5d872b(0x1eb)]['token']=null,logger[_0x5d872b(0x16a)](_0x5d872b(0x106)+_0x4d84bf[_0x5d872b(0x139)](-0x8)),devices[_0x4d84bf][_0x5d872b(0x1eb)]=validateAccess(devices[_0x4d84bf][_0x5d872b(0x1eb)][_0x5d872b(0xca)],_0x4d84bf),!(devices[_0x4d84bf]['access'][_0x5d872b(0x169)]&&devices[_0x4d84bf]['access']['reason']==_0x5d872b(0x1e7))&&(_0x23eac0==_0x5d872b(0x2ac)?io['to'](_0x4d84bf)[_0x5d872b(0xd4)](_0x5d872b(0x275),{'access':{'allow':![],'reason':_0x5d872b(0x268),'token':null}}):io['to'](_0x4d84bf)[_0x5d872b(0xd4)](_0x5d872b(0x275),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x4d84bf][_0x5d872b(0x1eb)][_0x5d872b(0xca)]=null;},_0x10a7d6);}function setTokenRefresh(_0x2db170){const _0x34cf54=_0x57e089;if(devices[_0x2db170][_0x34cf54(0x265)])clearTimeout(devices[_0x2db170][_0x34cf54(0x265)]);devices[_0x2db170][_0x34cf54(0x265)]=setTimeout(()=>{const _0x2d26c6=_0x34cf54;getClientsWithUuid(_0x2db170)['length']!=0x0?(devices[_0x2db170][_0x2d26c6(0x1eb)]=refreshToken(_0x2db170),io['to'](_0x2db170)[_0x2d26c6(0xd4)]('status',{'status':_0x2d26c6(0x10a),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2db170][_0x2d26c6(0x1eb)],'externalip':devices[_0x2db170]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x2db170)):clearTimeout(devices[_0x2db170]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0xcd996d){const _0x824de2=_0x57e089,_0x4a2189=getClient(_0xcd996d['id'])['uuid'];_0xcd996d['emit']('bots',config),_0xcd996d[_0x824de2(0xd4)](_0x824de2(0x26a),cleanSettings()),_0xcd996d['on']('add-bot',_0x19972b=>{const _0x4cebd0=_0x824de2;if(validateAccess(_0x19972b,_0x4a2189)[_0x4cebd0(0x169)])addBot();else logger[_0x4cebd0(0x1cd)](_0x4cebd0(0x29f));}),_0xcd996d['on'](_0x824de2(0x1d2),(_0x190586,_0x51f224)=>{const _0x5308d8=_0x824de2;if(validateAccess(_0x51f224,_0x4a2189)[_0x5308d8(0x169)])toggleBot(_0x190586['botID'],_0x190586[_0x5308d8(0x275)],_0x190586[_0x5308d8(0x25c)]);else logger[_0x5308d8(0x1cd)](_0x5308d8(0x215));}),_0xcd996d['on']('toggle-bot-mode',(_0x5c50b6,_0xa1879)=>{const _0x44a115=_0x824de2;if(validateAccess(_0xa1879,_0x4a2189)[_0x44a115(0x169)])toggleBotMode(_0x5c50b6);else logger[_0x44a115(0x1cd)](_0x44a115(0x215));}),_0xcd996d['on'](_0x824de2(0x224),(_0x387e09,_0x13a104)=>{const _0x82d033=_0x824de2;if(validateAccess(_0x13a104,_0x4a2189)[_0x82d033(0x169)])deleteBot(_0x387e09);else logger[_0x82d033(0x1cd)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0xcd996d['on'](_0x824de2(0x107),(_0x48291c,_0x438afe)=>{const _0x58ecf3=_0x824de2;if(validateAccess(_0x438afe,_0x4a2189)[_0x58ecf3(0x169)])storeSettings(_0x48291c,!![]);else logger[_0x58ecf3(0x1cd)](_0x58ecf3(0x161));}),_0xcd996d['on'](_0x824de2(0x126),_0x40e89b=>{const _0x19c211=_0x824de2;if(validateAccess(_0x40e89b,_0x4a2189)[_0x19c211(0x169)])updateBB('update');else logger[_0x19c211(0x1cd)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0xcd996d['on'](_0x824de2(0x223),_0x267034=>{const _0x20ac64=_0x824de2;if(validateAccess(_0x267034,_0x4a2189)['allow'])updateBB('reinstall');else logger['full'](_0x20ac64(0x2a5));}),_0xcd996d['on'](_0x824de2(0x2c1),_0x1d4ed2=>{const _0x9a843e=_0x824de2;if(validateAccess(_0x1d4ed2,_0x4a2189)['allow']){const _0x2c9cc6=getClient(_0xcd996d['id']);if(_0x2c9cc6)getBackupFiles(_0x2c9cc6['uuid']);else logger[_0x9a843e(0x1cd)](_0x9a843e(0x1ba));}else logger[_0x9a843e(0x1cd)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0xcd996d['on'](_0x824de2(0x267),(_0x2aade1,_0x4bcc62)=>{const _0x32d958=_0x824de2;if(validateAccess(_0x4bcc62,_0x4a2189)['allow'])restoreBackupFile(_0x2aade1);else logger[_0x32d958(0x1cd)](_0x32d958(0xef));}),_0xcd996d['on']('get-messages',_0x29b117=>{const _0x4e603d=_0x824de2;if(validateAccess(_0x29b117,_0x4a2189)['allow'])getMessages();else logger[_0x4e603d(0x1cd)](_0x4e603d(0x170));}),_0xcd996d['on']('confirm-message',(_0x669d0,_0x3fe6d1)=>{const _0x59a454=_0x824de2;if(validateAccess(_0x3fe6d1,_0x4a2189)[_0x59a454(0x169)])confirmMessage(_0x669d0);else logger['full'](_0x59a454(0x1fb));}),_0xcd996d['on']('logout',_0x5f5de6=>{const _0x2dc0eb=_0x824de2;if(validateAccess(_0x5f5de6,_0x4a2189)[_0x2dc0eb(0x169)]){if(devices[_0x4a2189][_0x2dc0eb(0x265)])clearTimeout(devices[_0x4a2189][_0x2dc0eb(0x265)]);if(devices[_0x4a2189][_0x2dc0eb(0x291)])clearTimeout(devices[_0x4a2189][_0x2dc0eb(0x291)]);removeSocketListeners(getClient(_0xcd996d['id'])[_0x2dc0eb(0x104)]),addBlacklist(_0x4a2189),devices[_0x4a2189][_0x2dc0eb(0xe6)]=null,devices[_0x4a2189][_0x2dc0eb(0x128)]=null,devices[_0x4a2189][_0x2dc0eb(0x1eb)][_0x2dc0eb(0xca)]=null,logger['debug'](_0x2dc0eb(0x14f)+_0x4a2189[_0x2dc0eb(0x139)](-0x8)),io['to'](getClient(_0xcd996d['id'])[_0x2dc0eb(0x104)])[_0x2dc0eb(0xd4)](_0x2dc0eb(0x275),{'access':{'allow':![],'reason':_0x2dc0eb(0xc9),'token':null}});}else logger['full'](_0x2dc0eb(0x274));});}function initializeSocketBot(_0x4d8e80){const _0x20a877=_0x57e089,_0x768d52=getClient(_0x4d8e80['id'])['bot'],_0x39777e=getClient(_0x4d8e80['id'])[_0x20a877(0x104)];_0x4d8e80['on'](_0x20a877(0x11c),(_0x1da29c,_0x5b76e9)=>{const _0x3df53f=_0x20a877;if(validateAccess(_0x5b76e9,_0x39777e)[_0x3df53f(0x169)]){if(pid[_0x768d52])pid[_0x768d52][_0x3df53f(0x2ab)]({'function':_0x3df53f(0x266),'args':_0x1da29c});}else logger['full'](_0x3df53f(0x158));}),_0x4d8e80['on'](_0x20a877(0x17e),(_0x5f407a,_0x4db948)=>{const _0x3ad39e=_0x20a877;if(validateAccess(_0x4db948,_0x39777e)[_0x3ad39e(0x169)]){if(pid[_0x768d52])pid[_0x768d52][_0x3ad39e(0x2ab)]({'function':_0x3ad39e(0x2c7),'args':_0x5f407a});}else logger[_0x3ad39e(0x1cd)](_0x3ad39e(0x205));}),_0x4d8e80['on'](_0x20a877(0x2a8),(_0x2c3036,_0x2a20a9)=>{const _0x281751=_0x20a877;if(validateAccess(_0x2a20a9,_0x39777e)[_0x281751(0x169)]){if(pid[_0x768d52])pid[_0x768d52][_0x281751(0x2ab)]({'function':_0x281751(0x11a),'args':_0x2c3036});}else logger[_0x281751(0x1cd)](_0x281751(0x148));}),_0x4d8e80['on'](_0x20a877(0x227),(_0x6ceb7b,_0x2422ed)=>{const _0x33e07=_0x20a877;if(validateAccess(_0x2422ed,_0x39777e)[_0x33e07(0x169)]){if(pid[_0x768d52])pid[_0x768d52][_0x33e07(0x2ab)]({'function':_0x33e07(0x1c3),'args':_0x6ceb7b});}else logger[_0x33e07(0x1cd)](_0x33e07(0x202));}),_0x4d8e80['on'](_0x20a877(0x144),(_0x5ab5f8,_0x43bb03)=>{const _0x26d287=_0x20a877;if(validateAccess(_0x43bb03,_0x39777e)[_0x26d287(0x169)]){if(pid[_0x768d52])pid[_0x768d52][_0x26d287(0x2ab)]({'function':_0x26d287(0x117),'args':_0x5ab5f8});}else logger[_0x26d287(0x1cd)](_0x26d287(0x176));}),_0x4d8e80['on']('store-fiat',(_0x264c07,_0x114bca)=>{const _0x422e04=_0x20a877;if(validateAccess(_0x114bca,_0x39777e)[_0x422e04(0x169)]){if(pid[_0x768d52])pid[_0x768d52]['send']({'function':'storeFiat','args':_0x264c07});}else logger[_0x422e04(0x1cd)](_0x422e04(0x2bc));}),_0x4d8e80['on'](_0x20a877(0x18b),_0x15f775=>{const _0x2d8e9c=_0x20a877;if(validateAccess(_0x15f775,_0x39777e)[_0x2d8e9c(0x169)]){if(pid[_0x768d52])pid[_0x768d52]['send']({'function':_0x2d8e9c(0x2a1),'args':null});}else logger[_0x2d8e9c(0x1cd)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x4d8e80['on'](_0x20a877(0x2a9),_0x43784b=>{const _0x472199=_0x20a877;if(validateAccess(_0x43784b,_0x39777e)['allow']){if(pid[_0x768d52])pid[_0x768d52][_0x472199(0x2ab)]({'function':_0x472199(0xe8),'args':null});}else logger[_0x472199(0x1cd)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x4d8e80['on'](_0x20a877(0x11b),(_0x2755f3,_0x47c0d6)=>{const _0x45748d=_0x20a877;if(validateAccess(_0x47c0d6,_0x39777e)[_0x45748d(0x169)]){if(pid[_0x768d52])pid[_0x768d52][_0x45748d(0x2ab)]({'function':_0x45748d(0x12b),'args':_0x2755f3});}else logger[_0x45748d(0x1cd)](_0x45748d(0x1b5));}),_0x4d8e80['on'](_0x20a877(0x25d),_0x1ebaf4=>{const _0x443110=_0x20a877;if(validateAccess(_0x1ebaf4,_0x39777e)[_0x443110(0x169)]){if(pid[_0x768d52])pid[_0x768d52][_0x443110(0x2ab)]({'function':_0x443110(0x1b9),'args':null});}else logger[_0x443110(0x1cd)](_0x443110(0xdd));}),_0x4d8e80['on'](_0x20a877(0x1fc),_0x294861=>{const _0x43d2b6=_0x20a877;if(validateAccess(_0x294861,_0x39777e)[_0x43d2b6(0x169)]){if(pid[_0x768d52])pid[_0x768d52][_0x43d2b6(0x2ab)]({'function':_0x43d2b6(0x216),'args':null});}else logger[_0x43d2b6(0x1cd)](_0x43d2b6(0x203));}),_0x4d8e80['on']('update-bb',_0x4c2635=>{const _0x49d573=_0x20a877;if(validateAccess(_0x4c2635,_0x39777e)['allow'])updateBB(_0x49d573(0x1ac));else logger[_0x49d573(0x1cd)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x4d8e80['on'](_0x20a877(0x2b2),_0x773da3=>{const _0x341c43=_0x20a877;if(validateAccess(_0x773da3,_0x39777e)[_0x341c43(0x169)])getMessages();else logger['full'](_0x341c43(0x170));}),_0x4d8e80['on']('confirm-message',(_0x39a8cf,_0xa3d3ec)=>{const _0x160202=_0x20a877;if(validateAccess(_0xa3d3ec,_0x39777e)[_0x160202(0x169)])confirmMessage(_0x39a8cf);else logger[_0x160202(0x1cd)](_0x160202(0x1fb));}),_0x4d8e80['on']('logout',_0x438c2d=>{const _0x4c7917=_0x20a877;if(validateAccess(_0x438c2d,_0x39777e)[_0x4c7917(0x169)]){if(devices[_0x39777e]['pidRefreshToken'])clearTimeout(devices[_0x39777e][_0x4c7917(0x265)]);if(devices[_0x39777e]['pidExpireLogin'])clearTimeout(devices[_0x39777e][_0x4c7917(0x291)]);removeSocketListeners(getClient(_0x4d8e80['id'])['uuid']),addBlacklist(_0x39777e),devices[_0x39777e]['telegramIpApproval']=null,devices[_0x39777e][_0x4c7917(0x128)]=null,devices[_0x39777e][_0x4c7917(0x1eb)][_0x4c7917(0xca)]=null,logger[_0x4c7917(0x16a)](_0x4c7917(0x14f)+_0x39777e[_0x4c7917(0x139)](-0x8)),io['to'](getClient(_0x4d8e80['id'])[_0x4c7917(0x104)])['emit'](_0x4c7917(0x275),{'access':{'allow':![],'reason':_0x4c7917(0xc9),'token':null}});}else logger['full'](_0x4c7917(0x274));});}function removeSocketListeners(_0x3c455b){const _0x346a6d=_0x57e089;getClientsWithUuid(_0x3c455b)[_0x346a6d(0x10f)](_0x231a6b=>{const _0x2211a8=_0x346a6d;getSocket(_0x231a6b['id'])[_0x2211a8(0x192)]();});}function cleanSettings(){const _0x2965ac=_0x57e089;let _0x300ab6=settings;return settings[_0x2965ac(0x1d9)]&&settings[_0x2965ac(0x1d9)]!=''&&(_0x300ab6={..._0x300ab6,'telegramToken':_0x2965ac(0xd9)}),settings[_0x2965ac(0x13b)]&&settings['bbPassword']!=''&&(_0x300ab6={..._0x300ab6,'bbPassword':_0x2965ac(0xd9)}),settings[_0x2965ac(0x1cf)]&&settings[_0x2965ac(0x1cf)]!=''&&(_0x300ab6={..._0x300ab6,'marketcapApi':_0x2965ac(0xd9)}),(settings[_0x2965ac(0x13b)]&&settings['bbPassword']=='***'||settings[_0x2965ac(0x1d9)]&&settings[_0x2965ac(0x1d9)]==_0x2965ac(0x174)||settings[_0x2965ac(0x1cf)]&&settings[_0x2965ac(0x1cf)]==_0x2965ac(0x174))&&(_0x300ab6={..._0x300ab6,'restored':{'password':settings[_0x2965ac(0x13b)]==_0x2965ac(0x174),'telegram':settings[_0x2965ac(0x1d9)]==_0x2965ac(0x174),'marketcap':settings[_0x2965ac(0x1cf)]==_0x2965ac(0x174)}}),_0x300ab6;}async function updateBB(_0x2719ed){const _0x2b2885=_0x57e089;await backupConfigFiles(),installingUpdate=!![],config[_0x2b2885(0x10f)](_0x1d82f6=>{const _0x2f55c9=_0x2b2885;restartBot(_0x1d82f6[_0x2f55c9(0x24b)]);});if(_0x2719ed==_0x2b2885(0x1ac))process[_0x2b2885(0x2ab)]({'update':!![],'environment':environment},_0x243adb=>{});else _0x2719ed==_0x2b2885(0x1cb)&&process['send']({'reinstall':!![],'environment':environment},_0x278b23=>{});}function startBot(_0x524880,_0x40561e,_0x339566){const _0x1a0286=_0x57e089;if(debugging)_0x524880[_0x1a0286(0x16e)]('-d');if(recreate)_0x524880[_0x1a0286(0x16e)]('-r');let _0x308d3b=![];const _0x24ed3f=_0x524880[0x0];_0x40561e={..._0x40561e,'stdio':['inherit',_0x1a0286(0x18e),'inherit','ipc']},pid[_0x24ed3f]=childProcess[_0x1a0286(0x282)](botfile,_0x524880,_0x40561e),pid[_0x24ed3f]['on']('message',_0x11f542=>{const _0x26a9b4=_0x1a0286;switch(Object[_0x26a9b4(0x2cb)](_0x11f542)[0x0]){case _0x26a9b4(0x116):updateBotName(_0x24ed3f,_0x11f542['botname']);break;case _0x26a9b4(0x29d):updateBotManager();break;case _0x26a9b4(0x275):updateStatus(_0x24ed3f,_0x11f542[_0x26a9b4(0x275)]);break;case _0x26a9b4(0x25c):updateLive(_0x24ed3f,_0x11f542[_0x26a9b4(0x25c)]);break;case _0x26a9b4(0xcc):updateLive(_0x24ed3f,_0x11f542['started']),io['to'](_0x24ed3f)['emit'](_0x26a9b4(0x275),{'access':{'allow':![],'reason':'reload','token':null}});break;case'stop':_0x11f542[_0x26a9b4(0x1f2)]==_0x26a9b4(0x200)&&restartBot(_0x24ed3f);_0x11f542[_0x26a9b4(0x1f2)]==_0x26a9b4(0x29a)&&toggleBot(_0x24ed3f,_0x26a9b4(0x22a),'stopped');break;case _0x26a9b4(0x17a):sendTelegramBot(_0x24ed3f,_0x11f542[_0x26a9b4(0x17a)]);break;case _0x26a9b4(0x13f):sendTelegramMsg(_0x11f542[_0x26a9b4(0x13f)]);break;case _0x26a9b4(0x283):io['to'](_0x24ed3f)[_0x26a9b4(0xd4)](_0x11f542[_0x26a9b4(0x283)],_0x11f542[_0x26a9b4(0x23c)]);break;}}),pid[_0x24ed3f]['on'](_0x1a0286(0x1aa),function(_0x2aae92){if(_0x308d3b)return;_0x308d3b=!![],_0x339566(_0x2aae92);}),pid[_0x24ed3f]['on'](_0x1a0286(0x1e4),async function(_0x1ffd9f){const _0x42ce51=_0x1a0286;if(terminating)return;if(installingUpdate){io[_0x42ce51(0x20d)]();return;}if(_0x308d3b)return;_0x308d3b=!![],_0x339566(null);const _0x596e1a=dbConfig[_0x42ce51(0x2b7)](_0x42ce51(0x1e6))[_0x42ce51(0x236)]({'botID':_0x24ed3f})[_0x42ce51(0x2c4)]();_0x596e1a&&(_0x596e1a[_0x42ce51(0x275)]=='enabled'||_0x596e1a[_0x42ce51(0x275)]==_0x42ce51(0x168))&&(await sleep(0x3e8),updateLive(_0x24ed3f,'stopped'),logger['full'](_0x42ce51(0x109)+_0x24ed3f),startBot([_0x24ed3f,userID],{'cwd':bbpath},function(_0x2e7132){if(_0x2e7132)logger['full'](_0x2e7132);}));});}function stopBot(_0x620313){const _0x3f383c=_0x57e089;getClientsWithBotID(_0x620313)[_0x3f383c(0x10f)](_0x270acb=>{const _0xdbd407=_0x3f383c;getSocket(_0x270acb['id'])[_0xdbd407(0x123)](!![]),removeClient(_0x270acb['id']);}),pid[_0x620313]&&(pid[_0x620313]['kill'](),pid[_0x620313]=null);}function stopAllBots(){terminating=!![];const _0x40ac50=getEnabledBots();_0x40ac50['forEach'](_0x2ca2c9=>{const _0x3b0937=_0x36dc;stopBot(_0x2ca2c9[_0x3b0937(0x24b)]);});}function restartBot(_0x502a19){const _0x563f49=_0x57e089;if(pid[_0x502a19])pid[_0x502a19][_0x563f49(0x29a)]();}function addBot(){const _0x23ae21=_0x57e089;let _0x18beef;for(let _0x3df7b4=0x1;_0x3df7b4<0x3e9;_0x3df7b4++){_0x18beef=_0x3df7b4[_0x23ae21(0x2a0)]()['padStart'](0x3,'0');let _0x283bd1=config['find'](_0x467c34=>_0x467c34[_0x23ae21(0x24b)]==_0x18beef);if(!_0x283bd1)break;}if(_0x18beef===_0x23ae21(0x155)){logger[_0x23ae21(0x1cd)](_0x23ae21(0x1fa));return;}logger[_0x23ae21(0x1cd)](_0x23ae21(0x100)+_0x18beef),dbConfig[_0x23ae21(0x2b7)]('bots')[_0x23ae21(0x16e)]({'botID':_0x18beef,'botname':_0x23ae21(0xfe)+_0x18beef,'status':_0x23ae21(0x168),'live':''})[_0x23ae21(0xd0)](),startBot([_0x18beef,userID],{'cwd':bbpath},function(_0x4f48a9){if(_0x4f48a9)logger['full'](_0x4f48a9);}),config=getConfiguration(),io['to'](_0x23ae21(0x1df))['emit'](_0x23ae21(0x1e6),config),broadcastToBots(_0x23ae21(0x1e6),JSON[_0x23ae21(0x23f)](config));}function deleteBot(_0x30a492){const _0x42f3af=_0x57e089;getClientsWithBotID(_0x30a492)[_0x42f3af(0x10f)](_0x18f3c0=>{getSocket(_0x18f3c0['id'])['disconnect'](!![]),removeClient(_0x18f3c0['id']);}),dbConfig['get']('bots')[_0x42f3af(0x26e)]({'botID':_0x30a492})['write'](),logger[_0x42f3af(0x1cd)](_0x42f3af(0x145)+_0x30a492),stopBot(_0x30a492);try{if(fs['existsSync'](path[_0x42f3af(0x221)](configpath,_0x42f3af(0x23b)+_0x30a492+_0x42f3af(0x298))))fs[_0x42f3af(0x280)](path[_0x42f3af(0x221)](configpath,_0x42f3af(0x23b)+_0x30a492+_0x42f3af(0x298)));if(fs[_0x42f3af(0x255)](path[_0x42f3af(0x221)](configpath,_0x42f3af(0x23b)+_0x30a492+'-events.json')))fs[_0x42f3af(0x280)](path['join'](configpath,_0x42f3af(0x23b)+_0x30a492+_0x42f3af(0x2b1)));if(fs[_0x42f3af(0x255)](path[_0x42f3af(0x221)](configpath,_0x42f3af(0x23b)+_0x30a492+_0x42f3af(0x151))))fs[_0x42f3af(0x280)](path[_0x42f3af(0x221)](configpath,_0x42f3af(0x23b)+_0x30a492+'-performance.json'));if(fs[_0x42f3af(0x255)](path[_0x42f3af(0x221)](configpath,_0x42f3af(0x23b)+_0x30a492+_0x42f3af(0x22e))))fs['unlinkSync'](path[_0x42f3af(0x221)](configpath,_0x42f3af(0x23b)+_0x30a492+_0x42f3af(0x22e)));}catch(_0x367765){if(_0x367765)logger[_0x42f3af(0x1cd)](_0x42f3af(0x299),_0x367765);}config=getConfiguration(),io['to'](_0x42f3af(0x1df))[_0x42f3af(0xd4)](_0x42f3af(0x1e6),config),broadcastToBots(_0x42f3af(0x1e6),JSON['stringify'](config));}function _0x3012(){const _0x32eb95=['alias','bb-secure.json','mixpanel','argv','reply','orders','Notifications\x20types:\x20','734111OlQdmr','botID','|@|','/restart\x20-\x20restart\x20bot(s)\x0a','User\x20has\x20been\x20validated','headless','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','user','4dAkFpC','server','existsSync','logs/','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','auth','mtime','compareSync','mkdirSync','live','cancel-loading','.zip','apiSecret','output-003.log','backup-full','lastmsgemitted','6601692OFouSa','output-002.log','pidRefreshToken','emitHistory','restore-backup-file','access\x20timeout','\x20(1)','settings','file','login\x20token\x20generated','catch','remove','output-000.log','writeFileSync','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','conn','2FA\x20required','Unauthorized\x20attempt\x20to\x20log\x20out','status','initclient','secure','\x20|\x20client:\x20...','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Error\x20details:','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','getHours','temp/','title','output-001.log','unlinkSync','max','fork','function','toggle','address\x20already\x20in\x20use','then','download','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','use','getMonth','--------------------------------------','resetpw_no',':\x20Bot\x20Mgr\x20>\x20','\x1b[34m','userid','bbvReceive','pidExpireLogin','min','reject','temporaryAccessAllowed','All','#RES#\x20if\x20running\x20locally\x0a','update_no','-config.json','Error\x20while\x20deleting\x20config\x20files:\x20','kill','address','::ffff:127.0.0.1','updatebotmanager','portfolio_','Unauthorized\x20attempt\x20to\x20add\x20bot','toString','resetHistory','Password\x20has\x20been\x20reset\x20to:\x20','copyFileSync','verify','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','1135223DWULNx','Backup\x20file\x20unzipped\x20and\x20stored','get-portfolio','get-starting-balances','assign','send','login','toIPv4MappedAddress','/status\x20-\x20show\x20bot(s)\x20status\x0a','Disabled\x20Bot\x20','sockets','-events.json','get-messages','config_all','Error\x20removing\x20old\x20backup\x20files:','Invalid\x20authentication\x20token\x20(2)',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','get','14845716jSZPEw','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','bbvNew','Notifications\x20disabled','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','create','login\x20required','Network\x20Interfaces:','version','get-backup-files','name','padStart','value','/:bot/portfolio','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','deleteHistoryAlerts','lowdb/adapters/FileSync','1052280KeNqzN',')\x20\x20\x20|\x20Bot\x20','keys','bot','/:bot/coins','30\x20min','bcryptjs','off','2FA','Your\x20installation\x20is\x20already\x20up\x20to\x20date','once','uncaughtException','\x20|\x20user:\x20...','rsa','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Logged\x20in\x20user\x20...','metrics_','password','Orders','success','express-fileupload','/disable\x20-\x20disable\x20notifications\x0a','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','whitelist','logged\x20out','token','match','started','referer','log','show','write','messages','environment','Running\x20#RED#Balance\x20Bot\x20v','emit','express','backupfile','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','readFileSync','************','family','telegramChatId','telegramEnabled','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','all','constructor','SIGINT',',\x20must\x20be\x20a\x204\x20digit\x20number','/:bot','Error\x20sending\x20','Notifications\x20enabled','socket','telegramIpApproval','names','getStartingBalances','tkn','latestversion','*$1*','crypto','3rgYXzA','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','portfolio','filter','#RES#\x20if\x20running\x20on\x20server','bb-settings.json','Backup\x20file\x20uploaded','internal','sendFile','No\x20bots\x20running\x20right\x20now','restore_yes_','apiKey','DEFLATE','status\x20code\x20401','binary','enabled','Bot\x20','params','Starting\x20new\x20bot\x20|\x20Bot\x20','telegramEvents','telegraf','login\x20token\x20valid','uuid','Password\x20reset\x20rejected','Session\x20expired\x20for\x20user\x20...','store-settings','rmSync','Restarting\x20Bot\x20','connected','Node.js\x20v','loadAsync','cloneDeep','entries','forEach','getMinutes','readdirSync','Starting\x20Balance\x20Bot\x20update','restart_','map','reset-password','botname','storeHeadless','startsWith','pki','getPortfolio','place-order','get-logs','<b>Balance\x20Bot\x20Status:</b>\x0a','SIGTERM','store','(((.+)+)+)+$','/logs\x20-\x20receive\x20log\x20files\x0a','hasOwnProperty','disconnect','headers','\x1b[31m','update-bb','auto','telegram2FaApproval','timestamp','off_','placeOrder','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','event','\x20(2)','bbUsername','editMessageReplyMarkup','chat','Ok,\x20will\x20send\x20alert\x20notifications\x20only','2FA\x20login\x20required','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','button','resetpw_yes','on_','new-disabled','slice','length','bbPassword','size','randomBytes','Idling\x20(','telegrammsg','format','Bot\x20Mgr\x20>\x20','backup-full.zip','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','store-headless','Deleted\x20Bot\x20','Invalid\x20username\x20or\x20IP\x20address','onepagemode','Unauthorized\x20attempt\x20to\x20get\x20portfolio','staging','/:bot/configuration','jsonwebtoken','exec','/help\x20-\x20show\x20available\x20commands\x0a','decode64','Logged\x20out\x20user\x20...','search','-performance.json','Notifications\x20enabled\x0a','/off\x20-\x20stop\x20bot(s)\x0a','sort','1000','#RES#','3000','Unauthorized\x20attempt\x20to\x20get\x20events','lowdb','type','order','telegramUsername','zip/','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','endsWith','build2','Unauthorized\x20attempt\x20to\x20update\x20settings','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','CoinMarketCap\x20API\x20key\x20validated','#RES#\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','generateAsync','login2fa_','new','allow','debug','update_yes','secret','post','push','reinstall_yes','Unauthorized\x20attempt\x20to\x20get\x20messages','tempaccess_30_','warning','randomFillSync','***','command','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','\x20minutes','bot.js','set','telegram','\x20only\x0a','IPv4','timeshift','delete-alerts','yes','publicKey','statSync','Access\x20enabled\x20for\x20','isIPv4MappedAddress','simple','split','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','/upload-backup','disable','Login\x20accepted','track','reset-history','getTime','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','inherit','jszip','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Invalid\x20authentication\x20token\x20(1)','removeAllListeners','Restoring\x20bot(s)\x20from\x20backup','notification','/start','username','sign','[ip-address]','toggle_','loginRequired','/download/:type','Setting\x20access:\x20','privateKey','test','replyWithDocument','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','-----------------------------------------------------------------------------------','code','/backup\x20-\x20receive\x20backup\x20files\x0a','tempaccess_reject_','handshake','Invalid\x20IP\x20address','string','from','Failed\x20to\x20download\x20','error','metrics','update','reason','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','whitelistEnabled','config/','clientip','1844915DDsaHF','api-eu.mixpanel.com','/names\x20-\x20show\x20bot\x20names\x0a','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Token\x20blacklisted','toggleBotMode','cancelLoading','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','HTML','/:bot/support','backup/','createServer','backup','callback','private','logs','storeConfiguration','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','hex','Allow\x20login\x20from\x20IP\x20address\x20','lastmsgtelegram','listen','0.0.0','static','reinstall','getSeconds','full','\x20-\x20','marketcapApi','parse','tempaccess_5_','update-bot','<b>Telegram\x20Bot\x20Status:</b>\x0a','/update\x20-\x20update\x20Balance\x20Bot\x0a','files','expiry','index.html','accept','telegramToken','Starting\x20#RED#Balance\x20Bot\x20v','sendMetricsTelegram','toIPv4Address','replace','Enabled\x20Bot\x20','botmanager','1622158iBOMYk','backup-files','\x20mode','Unauthorized\x20login\x20attempt\x20(timeout)','exit','getFullYear','bots','login\x20not\x20required','(staging)','reload','graphql-request','access','defaults','Telegraf\x20error:','yargs/yargs','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','restore_no_','axios','stop','getDate','build','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','File\x20uploaded','NTBA_FIX_319','createWriteStream','All\x20bots','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Unauthorized\x20attempt\x20to\x20confirm\x20message','show-config','hashSync','action','privateKeyFromPem','restart','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Unauthorized\x20attempt\x20to\x20store\x20configuration','Unauthorized\x20attempt\x20to\x20show\x20configuration','settings.','Unauthorized\x20attempt\x20to\x20delete\x20alerts','includes','encryptedUuid','bb-config.json','mode','invalid\x20credentials','isDirectory','publicKeyToPem','close','connection','temporary\x20token\x20generated','number','blacklist','BCT','\x20|\x20','sortBy','Unauthorized\x20attempt\x20to\x20update\x20bot','showConfig','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Yes','manual','Unauthorized\x20attempt\x20to\x20download\x20','config_alerts','Restore\x20process\x20confirmed','message','Starting\x20Balance\x20Bot\x20reinstallation','2FA\x20login\x20token\x20generated','ETH','join','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','reinstall-bb','delete-bot','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Login\x20rejected','store-configuration','version.json','f2aRequired','disabled','util','text','port','-results.json','apiPassword','No\x20authentication\x20token','reinstall_no','Error:\x20Invalid\x20argument\x20','inlineKeyboard','temporary\x20access\x20rejected','backup-full@','find','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','\x20files\x20over\x20Telegram:','15\x20min','/:bot/performance','bot-','args','exp','Telegram\x20error:','stringify','::1','remoteAddress','stopped'];_0x3012=function(){return _0x32eb95;};return _0x3012();}function toggleBot(_0x27dee1,_0x3bde7f,_0x3431da){const _0x28264e=_0x57e089;dbConfig[_0x28264e(0x2b7)](_0x28264e(0x1e6))['find']({'botID':_0x27dee1})[_0x28264e(0x2aa)]({'status':_0x3bde7f})[_0x28264e(0x2aa)]({'live':_0x3431da})[_0x28264e(0xd0)]();if(_0x3bde7f==_0x28264e(0xfd)||_0x3bde7f==_0x28264e(0x168))logger[_0x28264e(0x1cd)](_0x28264e(0x1de)+_0x27dee1),startBot([_0x27dee1,userID],{'cwd':bbpath},function(_0x339f3f){const _0x90ff39=_0x28264e;if(_0x339f3f)logger[_0x90ff39(0x1cd)](_0x339f3f);});else(_0x3bde7f==_0x28264e(0x22a)||_0x3bde7f=='new-disabled')&&(logger[_0x28264e(0x1cd)](_0x28264e(0x2af)+_0x27dee1),stopBot(_0x27dee1));config=getConfiguration(),io['to']('botmanager')[_0x28264e(0xd4)]('bots',config),broadcastToBots('bots',JSON[_0x28264e(0x23f)](config));}function toggleStatus(_0x15a14d){const _0x1389a=_0x57e089;let _0x21b13b=dbConfig[_0x1389a(0x2b7)](_0x1389a(0x1e6))['find']({'botID':_0x15a14d})[_0x1389a(0x2c4)](),_0x5a35a6;if(_0x21b13b[_0x1389a(0x275)]===_0x1389a(0xfd))_0x5a35a6=_0x1389a(0x22a);else{if(_0x21b13b[_0x1389a(0x275)]===_0x1389a(0x168))_0x5a35a6=_0x1389a(0x138);else{if(_0x21b13b['status']===_0x1389a(0x138))_0x5a35a6='new';else{if(_0x21b13b[_0x1389a(0x275)]===_0x1389a(0x22a))_0x5a35a6=_0x1389a(0xfd);}}}return _0x5a35a6;}function updateStatus(_0x217c31,_0x11834c){const _0x54ec72=_0x57e089;dbConfig[_0x54ec72(0x2b7)](_0x54ec72(0x1e6))[_0x54ec72(0x236)]({'botID':_0x217c31})[_0x54ec72(0x2aa)]({'status':_0x11834c})[_0x54ec72(0xd0)](),config=getConfiguration(),io['to']('botmanager')[_0x54ec72(0xd4)](_0x54ec72(0x1e6),config),broadcastToBots(_0x54ec72(0x1e6),JSON[_0x54ec72(0x23f)](config));}function updateLive(_0xbd4ad6,_0x58b388){const _0x378380=_0x57e089;dbConfig[_0x378380(0x2b7)]('bots')[_0x378380(0x236)]({'botID':_0xbd4ad6})['assign']({'live':_0x58b388})[_0x378380(0xd0)](),config=getConfiguration(),io['to'](_0x378380(0x1df))['emit'](_0x378380(0x1e6),config),broadcastToBots(_0x378380(0x1e6),JSON[_0x378380(0x23f)](config));}function updateBotName(_0x2fd919,_0x3240ac){const _0x4edae2=_0x57e089;dbConfig[_0x4edae2(0x2b7)](_0x4edae2(0x1e6))[_0x4edae2(0x236)]({'botID':_0x2fd919})[_0x4edae2(0x2aa)]({'botname':_0x3240ac})[_0x4edae2(0xd0)](),config=getConfiguration(),io['to']('botmanager')[_0x4edae2(0xd4)](_0x4edae2(0x1e6),config),broadcastToBots('bots',JSON[_0x4edae2(0x23f)](config));}function updateBotManager(){const _0x426573=_0x57e089;config=getConfiguration(),io['to']('botmanager')[_0x426573(0xd4)](_0x426573(0x1e6),config),broadcastToBots(_0x426573(0x1e6),JSON[_0x426573(0x23f)](config));}function toggleBotMode(_0x5c985a){const _0x66462c=_0x57e089;if(pid[_0x5c985a])pid[_0x5c985a][_0x66462c(0x2ab)]({'function':_0x66462c(0x1b8),'args':null});else{const _0x123e1b=configpath+_0x66462c(0x23b)+_0x5c985a+'-config.json',_0x56a218=fs[_0x66462c(0xd8)](_0x123e1b),_0x1b6122=JSON[_0x66462c(0x1d0)](_0x56a218),_0x5ae510=_0x1b6122[_0x66462c(0x2cc)][0x0][_0x66462c(0x24f)];_0x1b6122[_0x66462c(0x2cc)][0x0]['headless']=!_0x5ae510;const _0x5007d0=JSON[_0x66462c(0x23f)](_0x1b6122,null,0x2);fs['writeFileSync'](_0x123e1b,_0x5007d0),config=getConfiguration(),io['to']('botmanager')['emit'](_0x66462c(0x1e6),config),broadcastToBots('bots',JSON[_0x66462c(0x23f)](config));}}function validateTelegram(_0xa7bba){const _0x150538=_0x57e089;if(_0xa7bba['from'][_0x150538(0x196)]!=settings[_0x150538(0x15c)]&&'@'+_0xa7bba[_0x150538(0x1a8)][_0x150538(0x196)]!=settings[_0x150538(0x15c)]||_0xa7bba[_0x150538(0x131)]['id']!=settings[_0x150538(0xdb)])return sendTelegram(_0xa7bba[_0x150538(0x131)]['id'],_0x150538(0xc7),{'parse_mode':_0x150538(0x1bb)}),![];return!![];}async function initTelegram(){const _0x4fee90=_0x57e089;tgBot&&(await tgBot[_0x4fee90(0x1f2)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x4fee90(0x1d9)]);let _0x13525a='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x13525a+='\x0a',_0x13525a+='/enable\x20-\x20enable\x20notifications\x0a',_0x13525a+=_0x4fee90(0xc6),_0x13525a+=_0x4fee90(0x288),_0x13525a+=_0x4fee90(0x24d),_0x13525a+='/on\x20-\x20start\x20bot(s)\x0a',_0x13525a+=_0x4fee90(0x153),_0x13525a+=_0x4fee90(0x190),_0x13525a+=_0x4fee90(0x1b4),_0x13525a+=_0x4fee90(0x2ae),_0x13525a+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x13525a+=_0x4fee90(0x2c6),_0x13525a+=_0x4fee90(0x121),_0x13525a+=_0x4fee90(0x1a3),_0x13525a+=_0x4fee90(0x1d4),_0x13525a+=_0x4fee90(0x134),_0x13525a+=_0x4fee90(0x14d);let _0x2c7ef6='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x2c7ef6+='\x0a',_0x2c7ef6+=_0x13525a,tgBot[_0x4fee90(0x26d)]((_0x2a2c85,_0x23e058)=>{const _0x1282dc=_0x4fee90;logger[_0x1282dc(0x184)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger['debug'](_0x1282dc(0x1ed),_0x2a2c85);}),tgBot[_0x4fee90(0x289)](async(_0x1b38ff,_0x294c3)=>{const _0x358ba0=_0x4fee90;if(settings[_0x358ba0(0xdb)]||_0x1b38ff[_0x358ba0(0x1ac)][_0x358ba0(0x21d)][_0x358ba0(0x22c)]!=_0x358ba0(0x195)){if(!validateTelegram(_0x1b38ff))return;}_0x294c3();}),tgBot[_0x4fee90(0x175)]('start',async _0x44b7bf=>{const _0x128f93=_0x4fee90;if(_0x44b7bf[_0x128f93(0x1a8)][_0x128f93(0x196)]==settings[_0x128f93(0x15c)]||'@'+_0x44b7bf[_0x128f93(0x1a8)]['username']==settings['telegramUsername']){if(!settings[_0x128f93(0xdb)])updateSetting(_0x128f93(0xdb),_0x44b7bf[_0x128f93(0x131)]['id']);else{if(!validateTelegram(_0x44b7bf))return;}}else{if(!validateTelegram(_0x44b7bf))return;}updateSetting(_0x128f93(0xdc),!![]),await sendTelegram(_0x44b7bf[_0x128f93(0x131)]['id'],_0x2c7ef6);}),tgBot[_0x4fee90(0x175)]('enable',async _0x25702e=>{const _0x23988c=_0x4fee90;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x25702e['chat']['id'],_0x23988c(0xe4));}),tgBot['command'](_0x4fee90(0x188),async _0x3dace0=>{const _0x28226b=_0x4fee90;await sendTelegram(_0x3dace0[_0x28226b(0x131)]['id'],_0x28226b(0x2bb)),updateSetting('telegramEnabled',![]);}),tgBot[_0x4fee90(0x175)]('config',async _0x44f1f5=>{const _0x286206=_0x4fee90,_0x1661e6=Markup['inlineKeyboard']([Markup[_0x286206(0x135)]['callback'](_0x286206(0xc3),'config_orders'),Markup['button'][_0x286206(0x1c0)]('Alerts',_0x286206(0x21b)),Markup[_0x286206(0x135)][_0x286206(0x1c0)](_0x286206(0x295),_0x286206(0x2b3))]);_0x44f1f5['reply'](_0x286206(0xbf),_0x1661e6);}),tgBot[_0x4fee90(0x1fe)]('config_orders',async _0x257f34=>{const _0x54b1bc=_0x4fee90;_0x257f34[_0x54b1bc(0x130)](),updateSetting(_0x54b1bc(0x101),_0x54b1bc(0x248)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x257f34[_0x54b1bc(0x131)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x4fee90(0x1fe)]('config_alerts',async _0x3d5fd9=>{const _0x36d2c5=_0x4fee90;_0x3d5fd9[_0x36d2c5(0x130)](),updateSetting('telegramEvents','alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x3d5fd9[_0x36d2c5(0x131)]['id'],_0x36d2c5(0x132));}),tgBot[_0x4fee90(0x1fe)](_0x4fee90(0x2b3),async _0x1c33e9=>{const _0x4050a1=_0x4fee90;_0x1c33e9[_0x4050a1(0x130)](),updateSetting(_0x4050a1(0x101),_0x4050a1(0xde)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1c33e9[_0x4050a1(0x131)]['id'],_0x4050a1(0x222));}),tgBot[_0x4fee90(0x175)](_0x4fee90(0x275),async _0x556a16=>{const _0x2cfb96=_0x4fee90,_0x3f9c34=getBotsWithMode();let _0x5b7c59=_0x2cfb96(0x11d);config[_0x2cfb96(0x10f)](_0x225f2b=>{const _0xd12822=_0x2cfb96,_0x2582bd=_0x3f9c34[_0xd12822(0x236)](_0x555a67=>_0x555a67[_0xd12822(0x24b)]==_0x225f2b['botID'])[_0xd12822(0x209)];_0x5b7c59+=_0xd12822(0xfe)+_0x225f2b[_0xd12822(0x24b)]+':\x20'+_0x225f2b[_0xd12822(0x275)]+'\x20|\x20'+_0x2582bd+_0xd12822(0x213)+_0x225f2b[_0xd12822(0x25c)]+'\x0a';}),_0x5b7c59+='\x0a',_0x5b7c59+=_0x2cfb96(0x1d3),_0x5b7c59+=!settings[_0x2cfb96(0xdc)]?'Notifications\x20disabled\x0a':_0x2cfb96(0x152),_0x5b7c59+=settings[_0x2cfb96(0xdc)]?settings['telegramEvents']=='all'?_0x2cfb96(0x225):_0x2cfb96(0x249)+settings[_0x2cfb96(0x101)]+_0x2cfb96(0x17b):'',await sendTelegram(_0x556a16[_0x2cfb96(0x131)]['id'],_0x5b7c59,{'parse_mode':_0x2cfb96(0x1bb)});}),tgBot['command']('restart',async _0x10ceb8=>{const _0x1d016c=_0x4fee90,_0x2302bb=getEnabledBots();if(_0x2302bb[_0x1d016c(0x13a)]==0x0)await sendTelegram(_0x10ceb8[_0x1d016c(0x131)]['id'],_0x1d016c(0xf7));else{if(_0x2302bb['length']>0x1)_0x2302bb[_0x1d016c(0x16e)]({'botID':_0x1d016c(0xde)});let _0x5946a2=[],_0x4a7193=[];const _0x2b7d8d=_0x2302bb['length']%0x4==0x0||_0x2302bb[_0x1d016c(0x13a)]%0x4==0x3||_0x2302bb[_0x1d016c(0x13a)]%0x3==0x1?0x4:0x3;let _0x19cce5=0x0;_0x2302bb[_0x1d016c(0x10f)]((_0x31fcc7,_0x5444c7)=>{const _0x42f006=_0x1d016c;if(_0x5444c7%_0x2b7d8d==0x0)_0x4a7193=[];_0x4a7193[_0x42f006(0x16e)](Markup['button'][_0x42f006(0x1c0)](_0x31fcc7[_0x42f006(0x24b)]=='all'?'All\x20bots':_0x42f006(0xfe)+_0x31fcc7[_0x42f006(0x24b)],_0x42f006(0x113)+_0x31fcc7[_0x42f006(0x24b)])),_0x5444c7%_0x2b7d8d==0x0&&(_0x5946a2[_0x19cce5]=_0x4a7193,_0x19cce5++);});const _0x25e790=Markup[_0x1d016c(0x233)](_0x5946a2);_0x10ceb8[_0x1d016c(0x247)](_0x1d016c(0x1ef),_0x25e790);}}),tgBot[_0x4fee90(0x1fe)](/restart_(.+)/,async _0x586b82=>{const _0x780dab=_0x4fee90,_0x3fb5c7=_0x586b82[_0x780dab(0xcb)][0x1];_0x586b82['editMessageReplyMarkup'](),_0x3fb5c7==_0x780dab(0xde)?config[_0x780dab(0x10f)](_0x12a6a8=>{restartBot(_0x12a6a8['botID']);}):restartBot(_0x3fb5c7);}),tgBot[_0x4fee90(0x175)]('on',async _0xf29235=>{const _0x5f1bb4=_0x4fee90,_0x40ebe9=getDisabledBots();if(_0x40ebe9[_0x5f1bb4(0x13a)]==0x0)await sendTelegram(_0xf29235[_0x5f1bb4(0x131)]['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x40ebe9[_0x5f1bb4(0x13a)]>0x1)_0x40ebe9['push']({'botID':_0x5f1bb4(0xde)});let _0x1b8662=[],_0x4043b7=[];const _0x57e055=_0x40ebe9[_0x5f1bb4(0x13a)]%0x4==0x0||_0x40ebe9['length']%0x4==0x3||_0x40ebe9[_0x5f1bb4(0x13a)]%0x3==0x1?0x4:0x3;let _0xe0da7d=0x0;_0x40ebe9['forEach']((_0x45a089,_0x3747f7)=>{const _0x36e9ae=_0x5f1bb4;if(_0x3747f7%_0x57e055==0x0)_0x4043b7=[];_0x4043b7[_0x36e9ae(0x16e)](Markup[_0x36e9ae(0x135)]['callback'](_0x45a089['botID']==_0x36e9ae(0xde)?_0x36e9ae(0x1f9):_0x36e9ae(0xfe)+_0x45a089[_0x36e9ae(0x24b)],_0x36e9ae(0x137)+_0x45a089[_0x36e9ae(0x24b)])),_0x3747f7%_0x57e055==0x0&&(_0x1b8662[_0xe0da7d]=_0x4043b7,_0xe0da7d++);});const _0xed440=Markup['inlineKeyboard'](_0x1b8662);_0xf29235['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0xed440);}}),tgBot[_0x4fee90(0x1fe)](/on_(.+)/,async _0x4e77bf=>{const _0x77cf35=_0x4fee90,_0xfc599b=_0x4e77bf[_0x77cf35(0xcb)][0x1];_0x4e77bf[_0x77cf35(0x130)]();if(_0xfc599b=='all'){const _0x459af3=getDisabledBots();await sendTelegram(_0x4e77bf['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20all\x20bots'),_0x459af3[_0x77cf35(0x10f)](_0x270712=>{const _0x82cce9=_0x77cf35;if(_0x270712[_0x82cce9(0x24b)]!='all')toggleBot(_0x270712[_0x82cce9(0x24b)],toggleStatus(_0x270712[_0x82cce9(0x24b)]),_0x82cce9(0x242));});}else await sendTelegram(_0x4e77bf[_0x77cf35(0x131)]['id'],_0x77cf35(0x279)+_0xfc599b),toggleBot(_0xfc599b,toggleStatus(_0xfc599b),_0x77cf35(0x242));}),tgBot[_0x4fee90(0x175)](_0x4fee90(0x2d0),async _0x111b9f=>{const _0x17611b=_0x4fee90,_0x131f8d=getEnabledBots();if(_0x131f8d['length']==0x0)await sendTelegram(_0x111b9f['chat']['id'],_0x17611b(0xf7));else{if(_0x131f8d[_0x17611b(0x13a)]>0x1)_0x131f8d[_0x17611b(0x16e)]({'botID':'all'});let _0xfe5c2=[],_0x49118a=[];const _0x54beba=_0x131f8d[_0x17611b(0x13a)]%0x4==0x0||_0x131f8d[_0x17611b(0x13a)]%0x4==0x3||_0x131f8d[_0x17611b(0x13a)]%0x3==0x1?0x4:0x3;let _0x5c687b=0x0;_0x131f8d[_0x17611b(0x10f)]((_0x20e79d,_0x20e557)=>{const _0x3a9865=_0x17611b;if(_0x20e557%_0x54beba==0x0)_0x49118a=[];_0x49118a['push'](Markup['button'][_0x3a9865(0x1c0)](_0x20e79d[_0x3a9865(0x24b)]==_0x3a9865(0xde)?_0x3a9865(0x1f9):_0x3a9865(0xfe)+_0x20e79d[_0x3a9865(0x24b)],_0x3a9865(0x12a)+_0x20e79d[_0x3a9865(0x24b)])),_0x20e557%_0x54beba==0x0&&(_0xfe5c2[_0x5c687b]=_0x49118a,_0x5c687b++);});const _0x4e6382=Markup['inlineKeyboard'](_0xfe5c2);_0x111b9f[_0x17611b(0x247)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x4e6382);}}),tgBot[_0x4fee90(0x1fe)](/off_(.+)/,async _0x43e0cf=>{const _0x25c489=_0x4fee90,_0x38ad55=_0x43e0cf['match'][0x1];_0x43e0cf[_0x25c489(0x130)]();if(_0x38ad55==_0x25c489(0xde)){const _0x149a72=getEnabledBots();await sendTelegram(_0x43e0cf[_0x25c489(0x131)]['id'],_0x25c489(0x186)),_0x149a72[_0x25c489(0x10f)](_0x2e43ec=>{const _0x149b76=_0x25c489;if(_0x2e43ec[_0x149b76(0x24b)]!=_0x149b76(0xde))toggleBot(_0x2e43ec[_0x149b76(0x24b)],toggleStatus(_0x2e43ec[_0x149b76(0x24b)]),'stopped');});}else await sendTelegram(_0x43e0cf[_0x25c489(0x131)]['id'],_0x25c489(0x1ae)+_0x38ad55),toggleBot(_0x38ad55,toggleStatus(_0x38ad55),_0x25c489(0x242));}),tgBot[_0x4fee90(0x175)](_0x4fee90(0x1ab),async _0x4d37c7=>{const _0x443a95=_0x4fee90,_0x1948c1=getEnabledBots();if(_0x1948c1[_0x443a95(0x13a)]==0x0)await sendTelegram(_0x4d37c7[_0x443a95(0x131)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1948c1[_0x443a95(0x13a)]>0x1){let _0xf65ac8=[],_0x5a136b=[];const _0x56f186=_0x1948c1[_0x443a95(0x13a)]%0x4==0x0||_0x1948c1['length']%0x4==0x3||_0x1948c1[_0x443a95(0x13a)]%0x3==0x1?0x4:0x3;let _0x407dd0=0x0;_0x1948c1[_0x443a95(0x10f)]((_0x157eed,_0xee47b3)=>{const _0x1ada82=_0x443a95;if(_0xee47b3%_0x56f186==0x0)_0x5a136b=[];_0x5a136b[_0x1ada82(0x16e)](Markup['button'][_0x1ada82(0x1c0)](_0x1ada82(0xfe)+_0x157eed['botID'],_0x1ada82(0xc1)+_0x157eed[_0x1ada82(0x24b)])),_0xee47b3%_0x56f186==0x0&&(_0xf65ac8[_0x407dd0]=_0x5a136b,_0x407dd0++);});const _0x1909a3=Markup[_0x443a95(0x233)](_0xf65ac8);_0x4d37c7['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x1909a3);}else{const _0x455151=_0x1948c1[0x0][_0x443a95(0x24b)];if(pid[_0x455151])pid[_0x455151][_0x443a95(0x2ab)]({'function':_0x443a95(0x1db),'args':null});}}}),tgBot[_0x4fee90(0x1fe)](/metrics_(.+)/,async _0x2aab69=>{const _0x1486c3=_0x4fee90,_0x44fc2f=_0x2aab69[_0x1486c3(0xcb)][0x1];_0x2aab69[_0x1486c3(0x130)]();if(pid[_0x44fc2f])pid[_0x44fc2f][_0x1486c3(0x2ab)]({'function':_0x1486c3(0x1db),'args':null});}),tgBot[_0x4fee90(0x175)](_0x4fee90(0xf0),async _0x2d8e15=>{const _0x564df4=_0x4fee90,_0x21cf15=getEnabledBots();if(_0x21cf15[_0x564df4(0x13a)]==0x0)await sendTelegram(_0x2d8e15['chat']['id'],_0x564df4(0xf7));else{if(_0x21cf15['length']>0x1){let _0x4639f0=[],_0x1a6276=[];const _0x42f1cd=_0x21cf15[_0x564df4(0x13a)]%0x4==0x0||_0x21cf15['length']%0x4==0x3||_0x21cf15[_0x564df4(0x13a)]%0x3==0x1?0x4:0x3;let _0x39d9ee=0x0;_0x21cf15[_0x564df4(0x10f)]((_0x41f18f,_0x2d66ce)=>{const _0x5df936=_0x564df4;if(_0x2d66ce%_0x42f1cd==0x0)_0x1a6276=[];_0x1a6276[_0x5df936(0x16e)](Markup[_0x5df936(0x135)][_0x5df936(0x1c0)](_0x5df936(0xfe)+_0x41f18f[_0x5df936(0x24b)],_0x5df936(0x29e)+_0x41f18f[_0x5df936(0x24b)])),_0x2d66ce%_0x42f1cd==0x0&&(_0x4639f0[_0x39d9ee]=_0x1a6276,_0x39d9ee++);});const _0x3bb4ba=Markup[_0x564df4(0x233)](_0x4639f0);_0x2d8e15['reply'](_0x564df4(0x165),_0x3bb4ba);}else{const _0x63d7d6=_0x21cf15[0x0]['botID'];if(pid[_0x63d7d6])pid[_0x63d7d6][_0x564df4(0x2ab)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x4fee90(0x1fe)](/portfolio_(.+)/,async _0x40aed9=>{const _0x134098=_0x4fee90,_0x5fa3e2=_0x40aed9[_0x134098(0xcb)][0x1];_0x40aed9[_0x134098(0x130)]();if(pid[_0x5fa3e2])pid[_0x5fa3e2]['send']({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x4fee90(0x175)](_0x4fee90(0x1c2),async _0x4b8c5e=>{const _0x3a4c1f=_0x4fee90,_0x4efd36=_0x3a4c1f(0x1c2);await zipFiles(_0x4efd36);const _0x1e8b72=zippath+(_0x4efd36+'.zip');_0x4b8c5e[_0x3a4c1f(0x19f)]({'source':_0x1e8b72})[_0x3a4c1f(0x286)](()=>{})[_0x3a4c1f(0x26d)](_0x467a7f=>logger['debug']('Error\x20sending\x20'+_0x4efd36+_0x3a4c1f(0x238),_0x467a7f));}),tgBot[_0x4fee90(0x175)](_0x4fee90(0x1bf),async _0x7e433c=>{const _0x5ba739=_0x4fee90,_0x5a6262=_0x5ba739(0x1bf);await backupConfigFiles(),await zipFiles(_0x5a6262);const _0x4e9c7b=zippath+(_0x5a6262+_0x5ba739(0x25e));_0x7e433c[_0x5ba739(0x19f)]({'source':_0x4e9c7b})[_0x5ba739(0x286)](()=>{})['catch'](_0x4abf7f=>logger['debug'](_0x5ba739(0xe3)+_0x5a6262+'\x20files\x20over\x20Telegram:',_0x4abf7f));}),tgBot[_0x4fee90(0x175)](_0x4fee90(0x1ac),async _0x435b66=>{const _0x32d2e1=_0x4fee90;await getMessages();if(!updateAvailable)await sendTelegram(_0x435b66[_0x32d2e1(0x131)]['id'],_0x32d2e1(0xba));else{if(!validInstallation)await sendTelegram(_0x435b66[_0x32d2e1(0x131)]['id'],_0x32d2e1(0x250));else{const _0x4a5b39=Markup[_0x32d2e1(0x233)]([Markup[_0x32d2e1(0x135)]['callback'](_0x32d2e1(0x218),_0x32d2e1(0x16b)),Markup[_0x32d2e1(0x135)][_0x32d2e1(0x1c0)]('No',_0x32d2e1(0x297))]);_0x435b66[_0x32d2e1(0x247)]('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x4a5b39);}}}),tgBot[_0x4fee90(0x1fe)](/update_(.+)/,async _0x5a9d81=>{const _0x20cf3d=_0x4fee90,_0x2971a5=_0x5a9d81[_0x20cf3d(0xcb)][0x1];_0x5a9d81[_0x20cf3d(0x130)](),_0x2971a5==_0x20cf3d(0x17f)&&(await sendTelegram(_0x5a9d81[_0x20cf3d(0x131)]['id'],_0x20cf3d(0x112)),updateBB('update')),_0x2971a5=='no'&&await sendTelegram(_0x5a9d81[_0x20cf3d(0x131)]['id'],_0x20cf3d(0x201));}),tgBot[_0x4fee90(0x175)]('reinstall',async _0x434844=>{const _0x35ae3e=_0x4fee90;if(!validInstallation)await sendTelegram(_0x434844[_0x35ae3e(0x131)]['id'],_0x35ae3e(0x18d));else{const _0x5b5464=Markup[_0x35ae3e(0x233)]([Markup['button'][_0x35ae3e(0x1c0)](_0x35ae3e(0x218),_0x35ae3e(0x16f)),Markup[_0x35ae3e(0x135)][_0x35ae3e(0x1c0)]('No',_0x35ae3e(0x231))]);_0x434844[_0x35ae3e(0x247)](_0x35ae3e(0x1a0),_0x5b5464);}}),tgBot[_0x4fee90(0x1fe)](/reinstall_(.+)/,async _0x33dd6c=>{const _0x28cbe8=_0x4fee90,_0x69b170=_0x33dd6c[_0x28cbe8(0xcb)][0x1];_0x33dd6c[_0x28cbe8(0x130)](),_0x69b170==_0x28cbe8(0x17f)&&(await sendTelegram(_0x33dd6c[_0x28cbe8(0x131)]['id'],_0x28cbe8(0x21e)),updateBB(_0x28cbe8(0x1cb))),_0x69b170=='no'&&await sendTelegram(_0x33dd6c[_0x28cbe8(0x131)]['id'],_0x28cbe8(0x271));}),tgBot[_0x4fee90(0x175)](_0x4fee90(0x284),async _0xfc56d5=>{const _0x21ede6=_0x4fee90,_0x27a056=getBotsWithMode();if(_0x27a056[_0x21ede6(0x13a)]==0x0)await sendTelegram(_0xfc56d5[_0x21ede6(0x131)]['id'],_0x21ede6(0xf7));else{let _0x417e0c=[],_0x3f6054=[];const _0x594c79=0x2;let _0x56e442=0x0;_0x27a056[_0x21ede6(0x10f)]((_0x66ca45,_0x532844)=>{const _0x3f87d5=_0x21ede6;if(_0x532844%_0x594c79==0x0)_0x3f6054=[];_0x3f6054[_0x3f87d5(0x16e)](Markup[_0x3f87d5(0x135)]['callback'](_0x3f87d5(0xfe)+_0x66ca45['botID']+'\x20('+_0x66ca45['mode']+')',_0x3f87d5(0x199)+_0x66ca45['botID'])),_0x532844%_0x594c79==0x0&&(_0x417e0c[_0x56e442]=_0x3f6054,_0x56e442++);});const _0x4c2209=Markup[_0x21ede6(0x233)](_0x417e0c);_0xfc56d5['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x4c2209);}}),tgBot[_0x4fee90(0x1fe)](/toggle_(.+)/,async _0x2c19fe=>{const _0x213cff=_0x4fee90,_0x2deda1=_0x2c19fe['match'][0x1];_0x2c19fe['editMessageReplyMarkup']();const _0x9b7e72=getBotsWithMode(),_0x1eb421=_0x9b7e72[_0x213cff(0x236)](_0x16f381=>_0x16f381['botID']==_0x2deda1),_0x2a65a6=_0x1eb421[_0x213cff(0x209)]=='auto'?'manual':_0x213cff(0x127);await sendTelegram(_0x2c19fe['chat']['id'],_0x213cff(0x217)+_0x2deda1+'\x20to\x20'+_0x2a65a6+_0x213cff(0x1e2)),toggleBotMode(_0x2deda1);}),tgBot[_0x4fee90(0x175)](_0x4fee90(0xe7),async _0x51f6da=>{const _0x4879f0=_0x4fee90;let _0x5a59d0='';config['forEach'](_0x197f3b=>{const _0x17bc2e=_0x36dc;_0x5a59d0+=_0x17bc2e(0xfe)+_0x197f3b[_0x17bc2e(0x24b)]+':\x20'+_0x197f3b['botname']+'\x0a';}),await sendTelegram(_0x51f6da[_0x4879f0(0x131)]['id'],_0x5a59d0,{'parse_mode':_0x4879f0(0x1bb)});}),tgBot['command']('help',async _0x50fd02=>{const _0x51fbae=_0x4fee90;await sendTelegram(_0x50fd02[_0x51fbae(0x131)]['id'],_0x13525a);}),process[_0x4fee90(0xbb)](_0x4fee90(0xe0),()=>tgBot[_0x4fee90(0x1f2)](_0x4fee90(0xe0))),process[_0x4fee90(0xbb)](_0x4fee90(0x11e),()=>tgBot[_0x4fee90(0x1f2)](_0x4fee90(0x11e))),tgBot['launch']();}function disableTelegram(){const _0x58e455=_0x57e089;tgBot&&tgBot[_0x58e455(0x1f2)]();}async function sendTelegram(_0x524d40,_0x2c4265,_0x12620f){const _0x5c8af2=_0x57e089;_0x12620f={..._0x12620f,'disable_web_page_preview':!![]};try{await tgBot[_0x5c8af2(0x17a)]['sendMessage'](_0x524d40,_0x2c4265,_0x12620f);}catch(_0x409191){logger[_0x5c8af2(0x16a)](_0x5c8af2(0x23e),_0x409191);}}async function sendTelegramBot(_0x13b2e3,_0x4715c4){const _0x24a22d=_0x57e089;if(settings[_0x24a22d(0xdc)]){if(settings['telegramEvents']=='all'||(_0x4715c4['type']==_0x24a22d(0x1aa)||_0x4715c4[_0x24a22d(0x15a)]==_0x24a22d(0x172)||_0x4715c4[_0x24a22d(0x15a)]==_0x24a22d(0xc4))&&settings[_0x24a22d(0x101)]=='alerts'||_0x4715c4['type']==_0x24a22d(0x15b)&&settings[_0x24a22d(0x101)]==_0x24a22d(0x248)){if(tgBot&&settings[_0x24a22d(0xdb)]){if(_0x4715c4['showname'])await sendTelegram(settings[_0x24a22d(0xdb)],_0x4715c4[_0x24a22d(0x116)]+'\x20>\x20'+_0x4715c4[_0x24a22d(0x12d)]);else await sendTelegram(settings[_0x24a22d(0xdb)],'Bot\x20'+_0x13b2e3+'\x20>\x20'+_0x4715c4[_0x24a22d(0x12d)]);}}}}async function sendTelegramMsg(_0x331e73,_0x28888a='HTML'){const _0x364cbd=_0x57e089;return settings[_0x364cbd(0xdc)]&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings[_0x364cbd(0xdb)],_0x331e73,{'parse_mode':_0x28888a}),!![]):![];}function getDeviceWithIp(_0x8a84c0){const _0x22c0fe=_0x57e089;return devices[_0x22c0fe(0x236)](_0x219c73=>_0x219c73['ip']===_0x8a84c0);}async function temporaryAccess2FA(_0x3163c3,_0x49d755){const _0x395bad=_0x57e089;let _0x388826=new Date(),_0x35b5f6=![];if(lastIpApproval){if(_0x388826-lastIpApproval<0x1388)_0x35b5f6=!![];}lastIpApproval=new Date();if(_0x35b5f6)return;if(tgBot&&settings[_0x395bad(0xdb)]){const _0xb7b286=uuidRandom();tmpStorage[_0xb7b286]={'uuid':_0x3163c3,'externalip':_0x49d755};const _0x4598e8=Markup['inlineKeyboard']([Markup['button'][_0x395bad(0x1c0)]('5\x20min',_0x395bad(0x1d1)+_0xb7b286),Markup['button'][_0x395bad(0x1c0)](_0x395bad(0x239),'tempaccess_15_'+_0xb7b286),Markup[_0x395bad(0x135)][_0x395bad(0x1c0)](_0x395bad(0x2ce),_0x395bad(0x171)+_0xb7b286),Markup[_0x395bad(0x135)][_0x395bad(0x1c0)](_0x395bad(0x293),_0x395bad(0x1a4)+_0xb7b286)]);await sendTelegram(settings[_0x395bad(0xdb)],_0x395bad(0xd7)+normalizeIP(_0x49d755)[_0x395bad(0xcf)]+'\x20?',_0x4598e8),tgBot[_0x395bad(0x1fe)](/tempaccess_(.+)_(.+)/,async _0x57d8a5=>{const _0x43989c=_0x395bad,_0x125829=_0x57d8a5['match'][0x1],_0x189d25=_0x57d8a5[_0x43989c(0xcb)][0x2],{uuid:_0x496d5d,externalip:_0x46785c}=tmpStorage[_0x189d25];delete tmpStorage[_0x189d25],_0x57d8a5['editMessageReplyMarkup'](),devices[_0x496d5d][_0x43989c(0xe6)]={'clientip':_0x46785c,'timestamp':new Date()['getTime'](),'expiry':_0x125829},_0x125829!=_0x43989c(0x293)?(await sendTelegram(_0x57d8a5[_0x43989c(0x131)]['id'],_0x43989c(0x182)+_0x125829+_0x43989c(0x177),{'parse_mode':_0x43989c(0x1bb)}),io['to'](_0x496d5d)[_0x43989c(0xd4)](_0x43989c(0x275),{'access':{'allow':![],'reason':_0x43989c(0x1e9),'token':null}})):(await sendTelegram(_0x57d8a5[_0x43989c(0x131)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x496d5d)['emit'](_0x43989c(0x275),{'access':{'allow':![],'reason':_0x43989c(0x234),'token':null}}));});}}async function loginAccess2FA(_0x237d9a,_0x497b6e){const _0x29025d=_0x57e089;if(tgBot&&settings[_0x29025d(0xdb)]){const _0x1dfed4=uuidRandom();tmpStorage[_0x1dfed4]={'uuid':_0x237d9a,'externalip':_0x497b6e};const _0x17c586=Markup[_0x29025d(0x233)]([Markup['button']['callback'](_0x29025d(0x1d8),_0x29025d(0x167)+loginExpiry+'_'+_0x1dfed4),Markup[_0x29025d(0x135)]['callback']('reject','login2fa_reject_'+_0x1dfed4)]);await sendTelegram(settings[_0x29025d(0xdb)],_0x29025d(0x1c6)+normalizeIP(_0x497b6e)[_0x29025d(0xcf)]+'\x20?',_0x17c586),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x5658e8=>{const _0x35a6ba=_0x29025d,_0x2d6bc7=_0x5658e8[_0x35a6ba(0xcb)][0x1],_0x3c58d9=_0x5658e8[_0x35a6ba(0xcb)][0x2],{uuid:_0x637657,externalip:_0x5a3807}=tmpStorage[_0x3c58d9];delete tmpStorage[_0x3c58d9],_0x5658e8[_0x35a6ba(0x130)](),devices[_0x637657][_0x35a6ba(0x128)]={'clientip':_0x5a3807,'timestamp':new Date()[_0x35a6ba(0x18c)](),'expiry':_0x2d6bc7},_0x2d6bc7!=_0x35a6ba(0x293)?(await sendTelegram(_0x5658e8[_0x35a6ba(0x131)]['id'],_0x35a6ba(0x189),{'parse_mode':_0x35a6ba(0x1bb)}),io['to'](_0x637657)['emit'](_0x35a6ba(0x275),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x5658e8[_0x35a6ba(0x131)]['id'],_0x35a6ba(0x226)),io['to'](_0x637657)[_0x35a6ba(0xd4)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x27f696=_0x57e089;return dbConfig[_0x27f696(0x2b7)]('bots')['sortBy']('botID')[_0x27f696(0xf1)]({'status':_0x27f696(0xfd)})[_0x27f696(0x2c4)]()||[];}function getDisabledBots(){const _0x3436f1=_0x57e089;return dbConfig[_0x3436f1(0x2b7)](_0x3436f1(0x1e6))[_0x3436f1(0x214)]('botID')[_0x3436f1(0xf1)]({'status':'disabled'})['value']()||[];}function getBotAttributes(_0x4a6cef){const _0x1a5043=_0x57e089;let _0x1c5144={};const _0x40ff4e=configpath+_0x1a5043(0x23b)+_0x4a6cef+_0x1a5043(0x298),_0x10f60c=fs[_0x1a5043(0x255)](_0x40ff4e);if(_0x10f60c){const _0x3930d5=fs[_0x1a5043(0xd8)](_0x40ff4e);try{const _0x18a706=JSON[_0x1a5043(0x1d0)](_0x3930d5),_0x472cda=_0x18a706?_0x18a706['bot'][0x0][_0x1a5043(0x24f)]:![];_0x1c5144[_0x1a5043(0x209)]=_0x472cda?_0x1a5043(0x127):_0x1a5043(0x219),_0x1c5144['botname']=_0x18a706?_0x18a706[_0x1a5043(0x2cc)][0x0]['botname']:_0x1a5043(0xfe)+_0x4a6cef;}catch(_0x44f483){_0x1c5144[_0x1a5043(0x209)]=_0x1a5043(0x219),_0x1c5144[_0x1a5043(0x116)]=_0x1a5043(0xfe)+_0x4a6cef;}}else _0x1c5144[_0x1a5043(0x209)]=_0x1a5043(0x219),_0x1c5144['botname']=_0x1a5043(0xfe)+_0x4a6cef;return _0x1c5144;}function getBotsWithMode(){const _0x35195b=_0x57e089,_0x53aee5=dbConfig[_0x35195b(0x2b7)](_0x35195b(0x1e6))[_0x35195b(0x214)]('botID')[_0x35195b(0x2c4)]()||[];return _0x53aee5[_0x35195b(0x10f)](_0xd6d9f2=>{const _0x56730f=_0x35195b;let _0x1198a8=getBotAttributes(_0xd6d9f2['botID']);_0xd6d9f2[_0x56730f(0x209)]=_0x1198a8[_0x56730f(0x209)];}),_0x53aee5;}function getBotExchanges(){const _0xd84598=_0x57e089;let _0x3dea77=[];const _0x573eb2=dbConfig[_0xd84598(0x2b7)](_0xd84598(0x1e6))[_0xd84598(0x214)](_0xd84598(0x24b))[_0xd84598(0x2c4)]()||[];_0x573eb2[_0xd84598(0x10f)](_0x232609=>{const _0x38a7d6=_0xd84598;if(_0x232609[_0x38a7d6(0x275)]==_0x38a7d6(0xfd)){const _0x511255=configpath+_0x38a7d6(0x23b)+_0x232609['botID']+'-config.json',_0x21ebbb=fs[_0x38a7d6(0x255)](_0x511255);let _0xc65713;if(_0x21ebbb){const _0x2e1452=fs[_0x38a7d6(0xd8)](_0x511255);try{const _0x55ac7=JSON[_0x38a7d6(0x1d0)](_0x2e1452);_0xc65713=_0x55ac7?_0x55ac7['bot'][0x0]['exchange']:null;}catch(_0xdddc57){}}if(_0xc65713)_0x3dea77['push'](_0xc65713);}});const _0x4914ca=[...new Set(_0x3dea77)]['sort']();return _0x4914ca;}async function initUser(){const _0x94d668=_0x57e089;if(!settings[_0x94d668(0x28f)]){const _0x46273a=uuidRandom();mixpanel[_0x94d668(0x243)](_0x46273a),updateSetting(_0x94d668(0x28f),_0x46273a);}}async function initSecure(){const _0x374e09=_0x57e089;let _0x5e3015=getSecure();if(!_0x5e3015['hasOwnProperty'](_0x374e09(0x16c))){let _0x19c713=await generateKeys();_0x5e3015['publicKey']=_0x19c713[_0x374e09(0x180)],_0x5e3015[_0x374e09(0x19d)]=_0x19c713[_0x374e09(0x19d)],_0x5e3015[_0x374e09(0x16c)]=crypto[_0x374e09(0x13d)](0x20)['toString'](_0x374e09(0x1c5));;storeSecure(_0x5e3015);}}function getSettings(){const _0x5efc7a=_0x57e089;return dbSettings[_0x5efc7a(0x2b7)](_0x5efc7a(0x26a))[_0x5efc7a(0x2c4)]()||{};}function getSecure(){const _0x568726=_0x57e089;return dbSecure[_0x568726(0x2b7)](_0x568726(0x277))[_0x568726(0x2c4)]()||{};}function getBlacklist(){const _0x2f93d5=_0x57e089;return dbSecure[_0x2f93d5(0x2b7)](_0x2f93d5(0x211))[_0x2f93d5(0x2c4)]()||[];}function broadcastToBots(_0x2b911,_0x2f87bb){const _0x4dca67=_0x57e089;config[_0x4dca67(0x10f)](_0x34eb39=>{const _0xc84906=_0x4dca67;if(_0x34eb39[_0xc84906(0x275)]=='enabled'&&_0x34eb39[_0xc84906(0x25c)]=='running'||_0x34eb39['status']==_0xc84906(0x168)&&_0x34eb39[_0xc84906(0x25c)]=='running'){if(pid[_0x34eb39['botID']])pid[_0x34eb39[_0xc84906(0x24b)]]['send']({[_0x2b911]:_0x2f87bb});}});}async function storeSettings(_0x7c7ff6,_0x18e2c3=![]){const _0x2daa65=_0x57e089;_0x7c7ff6={...settings,..._0x7c7ff6};if(_0x18e2c3&&_0x7c7ff6['bbPassword']!=_0x2daa65(0xd9)&&_0x7c7ff6[_0x2daa65(0x13b)]!=_0x2daa65(0x174)&&_0x7c7ff6['bbPassword']!=''){const _0x254fdd=decryptRSA(secure[_0x2daa65(0x19d)],_0x7c7ff6[_0x2daa65(0x13b)])['split'](_0x2daa65(0x24c))[0x0],_0x598af7=bcrypt[_0x2daa65(0x1fd)](_0x254fdd,saltRounds);_0x7c7ff6={..._0x7c7ff6,'bbPassword':_0x598af7};}if(_0x18e2c3&&_0x7c7ff6[_0x2daa65(0x1d9)]!='************'&&_0x7c7ff6[_0x2daa65(0x1d9)]!=_0x2daa65(0x174)&&_0x7c7ff6[_0x2daa65(0x1d9)]!=''){const _0x66d273=decryptRSA(secure[_0x2daa65(0x19d)],_0x7c7ff6['telegramToken'])['split'](_0x2daa65(0x24c))[0x0];_0x7c7ff6={..._0x7c7ff6,'telegramToken':_0x66d273};}if(_0x18e2c3&&_0x7c7ff6[_0x2daa65(0x1cf)]!=_0x2daa65(0xd9)&&_0x7c7ff6[_0x2daa65(0x1cf)]!=_0x2daa65(0x174)&&_0x7c7ff6['marketcapApi']!=''){const _0x2f4b8a=decryptRSA(secure[_0x2daa65(0x19d)],_0x7c7ff6[_0x2daa65(0x1cf)])[_0x2daa65(0x185)]('|@|')[0x0];_0x7c7ff6={..._0x7c7ff6,'marketcapApi':_0x2f4b8a};}const _0x21d5ee=_0x7c7ff6[_0x2daa65(0x1d9)]!='************'&&_0x7c7ff6[_0x2daa65(0x1d9)]!=settings[_0x2daa65(0x1d9)]||_0x7c7ff6[_0x2daa65(0x15c)]!=settings['telegramUsername'],_0x6f7788=_0x7c7ff6[_0x2daa65(0x1d9)]==''||_0x7c7ff6['telegramUsername']=='',_0x48179a=_0x7c7ff6[_0x2daa65(0x1cf)]&&_0x7c7ff6[_0x2daa65(0x1cf)]!='************'&&_0x7c7ff6['marketcapApi']!=settings[_0x2daa65(0x1cf)];_0x21d5ee&&(_0x7c7ff6[_0x2daa65(0xdb)]=null,_0x7c7ff6['telegramEvents']='all');for(const [_0x1e7a5f,_0x647d0f]of Object[_0x2daa65(0x10e)](_0x7c7ff6)){if(_0x1e7a5f==_0x2daa65(0x1d9)&&_0x647d0f==_0x2daa65(0xd9)){_0x7c7ff6[_0x2daa65(0x1d9)]=settings[_0x2daa65(0x1d9)];continue;};if(_0x1e7a5f==_0x2daa65(0x13b)&&_0x647d0f=='************'){_0x7c7ff6[_0x2daa65(0x13b)]=settings['bbPassword'];continue;};if(_0x1e7a5f==_0x2daa65(0x1cf)&&_0x647d0f==_0x2daa65(0xd9)){_0x7c7ff6[_0x2daa65(0x1cf)]=settings['marketcapApi'];continue;};dbSettings[_0x2daa65(0x179)]('settings.'+_0x1e7a5f,_0x647d0f)[_0x2daa65(0xd0)]();}settings=_0x7c7ff6,io['to'](_0x2daa65(0x1df))[_0x2daa65(0xd4)](_0x2daa65(0x26a),cleanSettings()),broadcastToBots(_0x2daa65(0x17d),settings[_0x2daa65(0x17d)]),broadcastToBots('onepagemode',settings[_0x2daa65(0x147)]),broadcastToBots('marketcapApi',settings[_0x2daa65(0x1cf)]);if(_0x21d5ee&&!_0x6f7788)initTelegram();_0x21d5ee&&_0x6f7788&&(updateSetting('telegramChatId',null),disableTelegram()),getAllClients()['forEach'](_0x10d264=>{const _0x2c74b7=_0x2daa65;getSocket(_0x10d264['id'])['emit'](_0x2c74b7(0x275),{'access':{'allow':![],'reason':_0x2c74b7(0x1e9),'token':null}});}),_0x48179a&&(await sleep(0xbb8),testMarketcapApi(_0x7c7ff6[_0x2daa65(0x1cf)]));}async function testMarketcapApi(_0x10f327){const _0xc44657=_0x57e089,_0x3a381f=[_0xc44657(0x212),_0xc44657(0x220)];try{await axios[_0xc44657(0x2b7)](_0xc44657(0x162),{'headers':{'X-CMC_PRO_API_KEY':_0x10f327},'params':{'symbol':_0x3a381f['toString']()}});}catch(_0x4deb70){_0x4deb70[_0xc44657(0x2a0)]()[_0xc44657(0x206)](_0xc44657(0xfb))?(io['to']('botmanager')[_0xc44657(0xd4)]('notification',_0xc44657(0xee)),logger[_0xc44657(0x1cd)](_0xc44657(0xee))):(io['to']('botmanager')['emit'](_0xc44657(0x194),_0xc44657(0x2b9)),logger[_0xc44657(0x1cd)](_0xc44657(0x2b9)),logger[_0xc44657(0x16a)](_0xc44657(0x27a),_0x4deb70[_0xc44657(0x2a0)]()+_0xc44657(0x1ce)+_0x4deb70[_0xc44657(0x1a2)]));return;}logger[_0xc44657(0x16a)](_0xc44657(0x163));}function updateSetting(_0x85d758,_0x1b6526){const _0x194375=_0x57e089;dbSettings[_0x194375(0x179)](_0x194375(0x204)+_0x85d758,_0x1b6526)['write'](),settings=getSettings(),io['to'](_0x194375(0x1df))['emit']('settings',cleanSettings());}function storeSecure(_0x4d9c2b){const _0x3810fa=_0x57e089;dbSecure[_0x3810fa(0x2b7)](_0x3810fa(0x277))[_0x3810fa(0x16e)](_0x4d9c2b)[_0x3810fa(0xd0)](),secure=_0x4d9c2b;}function addBlacklist(_0x24e3e9){const _0x3170cc=_0x57e089;cleanBlacklist();let _0x8b3c27;devices[_0x24e3e9]['telegramIpApproval']?_0x8b3c27=Math[_0x3170cc(0x281)](devices[_0x24e3e9]['telegramIpApproval'][_0x3170cc(0x1d6)],loginExpiry):_0x8b3c27=loginExpiry,dbSecure[_0x3170cc(0x2b7)](_0x3170cc(0x211))[_0x3170cc(0x16e)]({'expiry':new Date()[_0x3170cc(0x18c)]()+_0x8b3c27*0x3c*0x3e8,'token':devices[_0x24e3e9][_0x3170cc(0x1eb)][_0x3170cc(0xca)]})[_0x3170cc(0xd0)](),blacklist=dbSecure[_0x3170cc(0x2b7)](_0x3170cc(0x211))[_0x3170cc(0x2c4)]();}function cleanBlacklist(){const _0x1694d5=_0x57e089;let _0xfb10a2=dbSecure['get'](_0x1694d5(0x211))[_0x1694d5(0x10d)]()[_0x1694d5(0x2c4)](),_0x1d50d9=new Date()[_0x1694d5(0x18c)]();_0xfb10a2[_0x1694d5(0x10f)](_0x1fc5b9=>{const _0x1f9cfd=_0x1694d5;_0x1fc5b9['expiry']<_0x1d50d9&&dbSecure[_0x1f9cfd(0x2b7)](_0x1f9cfd(0x211))[_0x1f9cfd(0x26e)]({'expiry':_0x1fc5b9[_0x1f9cfd(0x1d6)]})['write']();});}function initStates(){const _0x5ed837=_0x57e089;let _0x213335=getConfiguration();_0x213335[_0x5ed837(0x10f)](_0x1da259=>{const _0x18e5b1=_0x5ed837;_0x1da259[_0x18e5b1(0x25c)]=_0x18e5b1(0x242);}),storeConfiguration(_0x213335);}async function generateKeys(){const _0x12d7d8=_0x57e089,_0x566226=forge[_0x12d7d8(0x119)][_0x12d7d8(0xbe)]['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x236e98=forge[_0x12d7d8(0x119)]['privateKeyToPem'](_0x566226[_0x12d7d8(0x19d)]),_0x5104a1=forge[_0x12d7d8(0x119)][_0x12d7d8(0x20c)](_0x566226['publicKey']);return{'privateKey':_0x236e98,'publicKey':_0x5104a1};}async function oneTimeMigration(){const _0xa02dcc=_0x57e089;let _0x49fdbf=getSettings(),_0x445de7=![];!_0x49fdbf['hasOwnProperty']('lastmsgtelegram')&&(_0x49fdbf[_0xa02dcc(0x1c7)]=0x0,_0x445de7=!![]);!_0x49fdbf[_0xa02dcc(0x122)](_0xa02dcc(0x262))&&(_0x49fdbf[_0xa02dcc(0x262)]=0x0,_0x445de7=!![]);!_0x49fdbf[_0xa02dcc(0x122)](_0xa02dcc(0xea))&&(_0x49fdbf[_0xa02dcc(0xea)]=_0xa02dcc(0x1c9),_0x445de7=!![]);!_0x49fdbf[_0xa02dcc(0x122)](_0xa02dcc(0x147))&&(_0x49fdbf[_0xa02dcc(0x147)]=![],_0x445de7=!![]);!_0x49fdbf[_0xa02dcc(0x122)](_0xa02dcc(0x1cf))&&(_0x49fdbf[_0xa02dcc(0x1cf)]='',_0x445de7=!![]);if(_0x445de7)storeSettings(_0x49fdbf);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x29d443=>{const _0x47e8a0=_0xa02dcc;if(!_0x29d443[_0x47e8a0(0x20b)]()){if(!_0x29d443[_0x47e8a0(0x2c2)][_0x47e8a0(0x118)](_0x47e8a0(0x235)))fs[_0x47e8a0(0x280)](configbackuppath+_0x29d443[_0x47e8a0(0x2c2)]);}else fs[_0x47e8a0(0x108)](configbackuppath+_0x29d443[_0x47e8a0(0x2c2)],{'recursive':!![]});});}catch(_0xd69c66){logger[_0xa02dcc(0x16a)](_0xa02dcc(0x2b4),_0xd69c66);}}function storeConfiguration(_0x4d0838){const _0x57b7e7=_0x57e089;dbConfig[_0x57b7e7(0x2b7)]('bots')[_0x57b7e7(0x26e)]()[_0x57b7e7(0xd0)](),dbConfig['get'](_0x57b7e7(0x1e6))[_0x57b7e7(0x16e)](..._0x4d0838)[_0x57b7e7(0xd0)](),config=_0x4d0838;}async function resetPassword(){const _0x454295=_0x57e089;if(tgBot&&settings['telegramChatId']){const _0x4d0c54=Markup[_0x454295(0x233)]([Markup[_0x454295(0x135)]['callback']('yes',_0x454295(0x136)),Markup['button']['callback']('no',_0x454295(0x28c))]);await sendTelegram(settings['telegramChatId'],_0x454295(0x143),_0x4d0c54),tgBot['action'](/resetpw_(.+)/,async _0x5b184b=>{const _0x2b7f61=_0x454295,_0x21b793=_0x5b184b[_0x2b7f61(0xcb)][0x1];_0x5b184b['editMessageReplyMarkup']();if(_0x21b793!='no'){const _0x33a699=0xf,_0x31abf3=_0x2b7f61(0x251),_0x4ce21b=Array[_0x2b7f61(0x1a8)](crypto[_0x2b7f61(0x173)](new Uint32Array(_0x33a699)))[_0x2b7f61(0x114)](_0x4a0f6d=>_0x31abf3[_0x4a0f6d%_0x31abf3[_0x2b7f61(0x13a)]])[_0x2b7f61(0x221)](''),_0x3bb9e7=bcrypt['hashSync'](_0x4ce21b,saltRounds);storeSettings({'bbPassword':_0x3bb9e7}),await sendTelegram(_0x5b184b[_0x2b7f61(0x131)]['id'],_0x2b7f61(0x2a2)+_0x4ce21b,{'parse_mode':_0x2b7f61(0x1bb)});}else await sendTelegram(_0x5b184b[_0x2b7f61(0x131)]['id'],_0x2b7f61(0x105));});}}async function confirmRestore(_0x42fdd2,_0x5d5d5f){const _0x2996df=_0x57e089;io['to'](_0x2996df(0x1df))[_0x2996df(0xd4)]('notification',_0x2996df(0x257),_0x2996df(0xc4));if(tgBot&&settings['telegramChatId']){const _0x536a61=uuidRandom();tmpStorage[_0x536a61]={'path':_0x42fdd2,'filename':_0x5d5d5f};const _0x4cb2b3=Markup[_0x2996df(0x233)]([Markup['button']['callback'](_0x2996df(0x17f),_0x2996df(0xf8)+_0x536a61),Markup[_0x2996df(0x135)]['callback']('no',_0x2996df(0x1f0)+_0x536a61)]);await sendTelegram(settings[_0x2996df(0xdb)],_0x2996df(0x1b6),_0x4cb2b3),tgBot['action'](/restore_(.+)_(.+)/,async _0x28023c=>{const _0x557267=_0x2996df,_0x56ec4e=_0x28023c[_0x557267(0xcb)][0x1],_0x3538ff=_0x28023c[_0x557267(0xcb)][0x2],{path:_0x9a34e8,filename:_0x535036}=tmpStorage[_0x3538ff];delete tmpStorage[_0x3538ff],_0x28023c[_0x557267(0x130)](),_0x56ec4e==_0x557267(0x17f)?(logger['debug'](_0x557267(0x21c)),await sendTelegram(_0x28023c['chat']['id'],_0x557267(0x193),{'parse_mode':_0x557267(0x1bb)}),unzipFile(_0x9a34e8,_0x535036)):(logger[_0x557267(0x16a)]('Restore\x20process\x20aborted'),await sendTelegram(_0x28023c[_0x557267(0x131)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x2092d1=_0x57e089,_0x293f2d=new Date();return _0x293f2d[_0x2092d1(0x1e5)]()+'/'+(_0x293f2d[_0x2092d1(0x28a)]()+0x1)['toString']()[_0x2092d1(0x2c3)](0x2,'0')+'/'+_0x293f2d[_0x2092d1(0x1f3)]()['toString']()[_0x2092d1(0x2c3)](0x2,'0')+'\x20'+_0x293f2d[_0x2092d1(0x27c)]()[_0x2092d1(0x2a0)]()[_0x2092d1(0x2c3)](0x2,'0')+':'+_0x293f2d[_0x2092d1(0x110)]()['toString']()[_0x2092d1(0x2c3)](0x2,'0')+':'+_0x293f2d['getSeconds']()['toString']()['padStart'](0x2,'0');}function getTimeStamp(){const _0x1b986d=_0x57e089,_0x43ba12=shiftedTime();return _0x43ba12['getFullYear']()+'/'+(_0x43ba12[_0x1b986d(0x28a)]()+0x1)[_0x1b986d(0x2a0)]()[_0x1b986d(0x2c3)](0x2,'0')+'/'+_0x43ba12['getDate']()[_0x1b986d(0x2a0)]()[_0x1b986d(0x2c3)](0x2,'0')+'\x20'+_0x43ba12[_0x1b986d(0x27c)]()[_0x1b986d(0x2a0)]()[_0x1b986d(0x2c3)](0x2,'0')+':'+_0x43ba12['getMinutes']()['toString']()[_0x1b986d(0x2c3)](0x2,'0')+':'+_0x43ba12['getSeconds']()['toString']()[_0x1b986d(0x2c3)](0x2,'0');}function getCleanTimeStamp(){const _0x5415f4=_0x57e089,_0x1c8273=shiftedTime();return _0x1c8273['getFullYear']()+(_0x1c8273[_0x5415f4(0x28a)]()+0x1)[_0x5415f4(0x2a0)]()[_0x5415f4(0x2c3)](0x2,'0')+_0x1c8273[_0x5415f4(0x1f3)]()[_0x5415f4(0x2a0)]()[_0x5415f4(0x2c3)](0x2,'0')+'-'+_0x1c8273[_0x5415f4(0x27c)]()[_0x5415f4(0x2a0)]()[_0x5415f4(0x2c3)](0x2,'0')+_0x1c8273[_0x5415f4(0x110)]()[_0x5415f4(0x2a0)]()[_0x5415f4(0x2c3)](0x2,'0')+_0x1c8273[_0x5415f4(0x1cc)]()[_0x5415f4(0x2a0)]()[_0x5415f4(0x2c3)](0x2,'0');}function shiftedTime(){const _0x659c06=_0x57e089,_0x47819c=new Date();let _0xf7f989=_0x47819c;if(settings[_0x659c06(0x17d)]&&settings[_0x659c06(0x17d)]!==0x0)_0xf7f989=fns['add'](_0x47819c,{'hours':settings[_0x659c06(0x17d)]});return _0xf7f989;}async function startScheduler(){const _0xc16a8b=_0x57e089,_0xc77431=new Date()['getUTCHours'](),_0x34e112=shiftedTime()[_0xc16a8b(0x27c)]();_0x34e112==0x4&&backupConfigFiles(),_0x34e112==0x0&&(rotateLogFiles(),logger[_0xc16a8b(0x16a)](_0xc16a8b(0x28b)),logger[_0xc16a8b(0x16a)](_0xc16a8b(0xd3)+serverversion+_0xc16a8b(0x164)+(environment==_0xc16a8b(0x149)?_0xc16a8b(0x1e8):'')),logger[_0xc16a8b(0x16a)]('--------------------------------------')),_0xc77431%0x6==0x0&&triggerAnalytics(),_0xc77431%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x412006){const _0x390df2=_0x57e089;logger[_0x390df2(0x16a)]('Restore\x20backup\x20file\x20'+_0x412006);const _0x59c0e9=getBotsWithMode();_0x59c0e9['length']>0x0?confirmRestore(configbackuppath,_0x412006):unzipFile(configbackuppath,_0x412006);}async function getBackupFiles(_0x13b650=null){const _0x175de3=_0x57e089;let _0x5ee562=[],_0x12b81e=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x12b81e[_0x175de3(0x154)]((_0x136e67,_0xc5fd43)=>_0x136e67[_0x175de3(0x2c2)]<_0xc5fd43[_0x175de3(0x2c2)]?0x1:_0xc5fd43[_0x175de3(0x2c2)]<_0x136e67['name']?-0x1:0x0),_0x12b81e[_0x175de3(0x10f)](_0x2c290f=>{const _0xf07be9=_0x175de3;if(!_0x2c290f[_0xf07be9(0x20b)]()&&_0x2c290f[_0xf07be9(0x2c2)][_0xf07be9(0x118)](_0xf07be9(0x235))&&_0x2c290f[_0xf07be9(0x2c2)][_0xf07be9(0x15f)]('.zip')){const _0x3b409a=formatDate(fs[_0xf07be9(0x181)](configbackuppath+_0x2c290f[_0xf07be9(0x2c2)])[_0xf07be9(0x259)]);_0x5ee562[_0xf07be9(0x16e)]({'name':_0x2c290f[_0xf07be9(0x2c2)],'mtime':_0x3b409a});}});if(_0x13b650)io['to'](_0x13b650)[_0x175de3(0xd4)](_0x175de3(0x1e1),_0x5ee562);else return _0x5ee562;}async function backupConfigFiles(){const _0x5cf5bd=_0x57e089;await zipFiles(_0x5cf5bd(0x261));const _0x43b529=getCleanTimeStamp();fs[_0x5cf5bd(0x2a3)](zippath+_0x5cf5bd(0x142),configbackuppath+(_0x5cf5bd(0x235)+_0x43b529+_0x5cf5bd(0x25e)));let _0x527873=fs[_0x5cf5bd(0x111)](configbackuppath,{'withFileTypes':!![]});_0x527873[_0x5cf5bd(0x154)]((_0x4b0732,_0x1b3023)=>_0x4b0732[_0x5cf5bd(0x2c2)]<_0x1b3023[_0x5cf5bd(0x2c2)]?0x1:_0x1b3023[_0x5cf5bd(0x2c2)]<_0x4b0732[_0x5cf5bd(0x2c2)]?-0x1:0x0),_0x527873[_0x5cf5bd(0x13a)]>maxBackups&&fs[_0x5cf5bd(0x280)](configbackuppath+_0x527873[_0x527873[_0x5cf5bd(0x13a)]-0x1][_0x5cf5bd(0x2c2)]);}function rotateLogFiles(){const _0x3fc33a=_0x57e089,_0x4784a6=fs[_0x3fc33a(0x181)](logspath+_0x3fc33a(0x26f)),_0x152393=_0x4784a6[_0x3fc33a(0x13c)]/0x400;if(_0x152393>0x64){let _0x316fbf=fs[_0x3fc33a(0x111)](logspath,{'withFileTypes':!![]});_0x316fbf[_0x3fc33a(0x154)]((_0x50ef65,_0x2df8fd)=>_0x50ef65['name']<_0x2df8fd['name']?0x1:_0x2df8fd[_0x3fc33a(0x2c2)]<_0x50ef65[_0x3fc33a(0x2c2)]?-0x1:0x0),_0x316fbf[_0x3fc33a(0x10f)](_0x52d4ef=>{const _0xd17770=_0x3fc33a;if(_0x52d4ef['name']==_0xd17770(0x264))fs[_0xd17770(0x2a3)](logspath+_0x52d4ef[_0xd17770(0x2c2)],logspath+_0xd17770(0x260));if(_0x52d4ef[_0xd17770(0x2c2)]==_0xd17770(0x27f))fs['copyFileSync'](logspath+_0x52d4ef['name'],logspath+_0xd17770(0x264));_0x52d4ef[_0xd17770(0x2c2)]=='output-000.log'&&(fs[_0xd17770(0x2a3)](logspath+_0x52d4ef[_0xd17770(0x2c2)],logspath+_0xd17770(0x27f)),fs[_0xd17770(0x270)](logspath+_0x52d4ef['name'],''));});}}async function zipFiles(_0x51b5fe){const _0x49eac9=_0x57e089;let _0x5ec58d;if(_0x51b5fe=='logs')_0x5ec58d=logspath;if(_0x51b5fe==_0x49eac9(0x1bf))_0x5ec58d=configpath;if(_0x51b5fe==_0x49eac9(0x261))_0x5ec58d=configpath;let _0x58fea4=fs[_0x49eac9(0x111)](_0x5ec58d,{'withFileTypes':!![]});const _0x3fd169=new JSZip();_0x58fea4['forEach'](_0x56d3f1=>{const _0x1a6392=_0x49eac9;if(!_0x56d3f1[_0x1a6392(0x20b)]()){let _0x56f349=fs[_0x1a6392(0xd8)](_0x5ec58d+_0x56d3f1[_0x1a6392(0x2c2)]);if(_0x51b5fe==_0x1a6392(0x1bf)){const _0x1fcff4=/^bot-[0-9]{3}-config.json$/,_0x21ff7d=_0x1fcff4[_0x1a6392(0x19e)](_0x56d3f1['name']);if(_0x21ff7d){const _0x5a027a=JSON[_0x1a6392(0x1d0)](_0x56f349);if(_0x5a027a[_0x1a6392(0x2cc)][0x0]){_0x5a027a[_0x1a6392(0x2cc)][0x0][_0x1a6392(0xf9)]='***',_0x5a027a[_0x1a6392(0x2cc)][0x0][_0x1a6392(0x25f)]=_0x1a6392(0x174);if(_0x5a027a['bot'][0x0][_0x1a6392(0x22f)])_0x5a027a[_0x1a6392(0x2cc)][0x0][_0x1a6392(0x22f)]=_0x1a6392(0x174);}_0x56f349=JSON['stringify'](_0x5a027a,null,0x2);}if(_0x56d3f1[_0x1a6392(0x2c2)]==_0x1a6392(0xf3)){const _0x658133=JSON[_0x1a6392(0x1d0)](_0x56f349);if(_0x658133[_0x1a6392(0x26a)][_0x1a6392(0x19a)])_0x658133['settings'][_0x1a6392(0x19a)]=![];if(_0x658133[_0x1a6392(0x26a)][_0x1a6392(0x13b)])_0x658133[_0x1a6392(0x26a)][_0x1a6392(0x13b)]=_0x1a6392(0x174);if(_0x658133[_0x1a6392(0x26a)][_0x1a6392(0x1d9)])_0x658133[_0x1a6392(0x26a)][_0x1a6392(0x1d9)]=_0x1a6392(0x174);if(_0x658133[_0x1a6392(0x26a)][_0x1a6392(0xdb)])_0x658133[_0x1a6392(0x26a)][_0x1a6392(0xdb)]=null;if(_0x658133['settings'][_0x1a6392(0x1cf)])_0x658133['settings']['marketcapApi']=_0x1a6392(0x174);_0x56f349=JSON[_0x1a6392(0x23f)](_0x658133,null,0x2);}if(_0x56d3f1[_0x1a6392(0x2c2)]!=_0x1a6392(0x244))_0x3fd169[_0x1a6392(0x26b)](_0x56d3f1['name'],_0x56f349);}else _0x3fd169['file'](_0x56d3f1[_0x1a6392(0x2c2)],_0x56f349);}});const _0xf7b6a5=await _0x3fd169[_0x49eac9(0x166)]({'type':_0x49eac9(0x1a7),'base64':![],'compression':_0x49eac9(0xfa)});fs[_0x49eac9(0x270)](zippath+(_0x51b5fe+'.zip'),_0xf7b6a5,_0x49eac9(0xfc));}async function unzipFile(_0x142ba5,_0x124f83){const _0x4e2b85=_0x57e089;fs[_0x4e2b85(0x111)](configpath,{'withFileTypes':!![]})[_0x4e2b85(0x10f)](_0x312762=>{const _0x17280e=_0x4e2b85;if(!_0x312762[_0x17280e(0x20b)]())fs[_0x17280e(0x108)](configpath+_0x312762['name']);});const _0x4c548a=fs[_0x4e2b85(0xd8)](_0x142ba5+_0x124f83,'binary'),_0x2de3b5=await JSZip[_0x4e2b85(0x10c)](_0x4c548a,{'base64':![],'checkCRC32':!![]});for(const _0x269978 of Object[_0x4e2b85(0x2cb)](_0x2de3b5[_0x4e2b85(0x1d5)])){const _0x1c1b53=_0x2de3b5['files'][_0x269978],_0x21774a=await _0x1c1b53['async'](_0x4e2b85(0x1a7));fs['writeFileSync'](configpath+_0x1c1b53[_0x4e2b85(0x2c2)],_0x21774a);}fs[_0x4e2b85(0x111)](temppath,{'withFileTypes':!![]})[_0x4e2b85(0x10f)](_0x5d3169=>{const _0x31c2b5=_0x4e2b85;if(!_0x5d3169[_0x31c2b5(0x20b)]())fs['rmSync'](temppath+_0x5d3169[_0x31c2b5(0x2c2)]);}),logger[_0x4e2b85(0x16a)](_0x4e2b85(0x2a7)),process[_0x4e2b85(0x2ab)]({'restore':!![]},_0x1d91f7=>{});}async function getPublicIp(){const _0x22368b=_0x57e089;try{const _0x3b9e76=await axios[_0x22368b(0x2b7)]('https://api.ipify.org?format=json');publicip=_0x3b9e76['data']['ip'];}catch(_0xd68994){}}async function triggerAnalytics(){const _0x4e4145=_0x57e089;if(!publicip)await getPublicIp();const _0x40d003=getBotsWithMode();let _0x2dd1b1=0x0;_0x40d003[_0x4e4145(0x10f)](_0x215695=>{const _0x30f374=_0x4e4145;if(_0x215695[_0x30f374(0x275)]==='enabled')_0x2dd1b1++;});const _0x99b43c=getBotExchanges();mixpanel[_0x4e4145(0x18a)]('Server',{'distinct_id':settings[_0x4e4145(0x28f)],'ip':publicip,'version':serverversion,'numbots':_0x40d003[_0x4e4145(0x13a)],'numbotsenabled':_0x2dd1b1,'exchanges':_0x99b43c,'environment':environment});}async function getMessages(){const _0x57a6f8=_0x57e089,_0x42e634='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x51cee8=new GraphQLClient(_0x42e634),_0x1ba8ec={'authorization':_0x57a6f8(0x237)},_0x5417ec=serverversion[_0x57a6f8(0x185)]('.'),_0x131b49=_0x5417ec[0x0]+'.'+_0x5417ec[0x1],_0x13ee4c=Math[_0x57a6f8(0x292)](settings[_0x57a6f8(0x1c7)],settings['lastmsgemitted']),_0x2683c9={'last':parseInt(_0x13ee4c),'bbm':_0x131b49},_0x1050a8=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1e3643;try{_0x1e3643=await _0x51cee8['request'](_0x1050a8,_0x2683c9,_0x1ba8ec);}catch(_0x2587e6){}if(_0x1e3643&&_0x1e3643[_0x57a6f8(0xd1)]){let _0x462ec9=settings[_0x57a6f8(0x1c7)];newMessages=[];for(const _0x95f867 of _0x1e3643['messages']){newMessages['push'](_0x95f867);let _0x58ff44=![];_0x95f867[_0x57a6f8(0x2ba)]&&(updateSetting('latestversion',_0x95f867['bbvNew']),_0x58ff44=isNewerVersion(serverversion,_0x95f867[_0x57a6f8(0x2ba)])||serverversion==_0x95f867['bbvNew']);if(!_0x58ff44&&_0x95f867[_0x57a6f8(0x210)]>_0x462ec9){if(_0x95f867[_0x57a6f8(0x290)]==='any'||serverversion[_0x57a6f8(0x118)](_0x95f867[_0x57a6f8(0x290)])){let _0x6ac8aa=''+_0x95f867[_0x57a6f8(0x27e)]+'\x0a\x0a'+_0x95f867[_0x57a6f8(0x21d)];const _0x39859b=await sendTelegramMsg(toTelegramMarkdown(_0x6ac8aa),'Markdown');if(_0x39859b)_0x462ec9=_0x95f867[_0x57a6f8(0x210)];}}}updateAvailable=isNewerVersion(settings[_0x57a6f8(0xea)],serverversion),updateSetting(_0x57a6f8(0x1c7),_0x462ec9),emitMessages();}}function emitMessages(){const _0x17fbd6=_0x57e089,_0x1cdc0b=settings[_0x17fbd6(0x262)];let _0x569dc8=[];newMessages[_0x17fbd6(0x10f)](_0x3edeeb=>{const _0xa3060f=_0x17fbd6;_0x3edeeb['number']>_0x1cdc0b&&_0x569dc8[_0xa3060f(0x16e)](_0x3edeeb);}),_0x569dc8[_0x17fbd6(0x13a)]>0x0&&getAllClients()['forEach'](_0x558718=>{const _0xf8b773=_0x17fbd6;getSocket(_0x558718['id'])['emit'](_0xf8b773(0x21d),_0x569dc8);});}function confirmMessage(_0x44e9c2){const _0x248d83=_0x57e089;updateSetting(_0x248d83(0x262),Number(_0x44e9c2));}function isNewerVersion(_0x43816f,_0x452e45){const _0x4421a3=_0x57e089,_0x5e3303=_0x452e45[_0x4421a3(0x185)]('.'),_0x13e6d1=_0x43816f[_0x4421a3(0x185)]('.');for(var _0x2ade19=0x0;_0x2ade19<_0x13e6d1['length'];_0x2ade19++){const _0x43d9c9=~~_0x13e6d1[_0x2ade19],_0x53df7e=~~_0x5e3303[_0x2ade19];if(_0x43d9c9>_0x53df7e)return!![];if(_0x43d9c9<_0x53df7e)return![];}return![];}function toTelegramMarkdown(_0x457dbc){const _0xaf3dcc=_0x57e089,_0x27ecc6=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x492784=/\*{2}(.+?)\*{2}/gim;return _0x457dbc=_0x457dbc[_0xaf3dcc(0x1dd)](_0x27ecc6,'$1_$2_$3')[_0xaf3dcc(0x1dd)](_0x492784,_0xaf3dcc(0xeb)),_0x457dbc;}async function validateConfigFile(){const _0x4d2755=_0x57e089,_0x591322=dbConfig[_0x4d2755(0x2b7)](_0x4d2755(0x1e6))[_0x4d2755(0x214)]('botID')[_0x4d2755(0x2c4)]()||[];if(_0x591322['length']==0x0){let _0x56e279=0x0,_0x22a867=[];const _0x479f88=/^bot-([0-9]{3})-config.json$/,_0x2c139f=fs[_0x4d2755(0x111)](configpath);_0x2c139f[_0x4d2755(0x10f)](_0x113d39=>{const _0x567b33=_0x4d2755,_0x3fd52c=_0x479f88[_0x567b33(0x14c)](_0x113d39);if(_0x3fd52c){const _0x5b6a7a=_0x3fd52c[0x1];let _0x6cf339=getBotAttributes(_0x5b6a7a);_0x22a867[_0x567b33(0x16e)]({'botID':_0x5b6a7a,'botname':_0x6cf339['botname'],'status':'disabled','live':'stopped'}),_0x56e279++;}}),_0x56e279!=0x0&&(dbConfig[_0x4d2755(0x2b7)](_0x4d2755(0x1e6))[_0x4d2755(0x2aa)](_0x22a867)[_0x4d2755(0xd0)](),config=_0x22a867,restoredConfigFile=_0x56e279);}}async function restoreConfigNotify(_0x995f44){const _0x5dfe27=_0x57e089;let _0x4a1163;if(restoredConfigFile==0x1)_0x4a1163='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x4a1163=_0x5dfe27(0x12c);if(_0x995f44)io['to'](_0x5dfe27(0x1df))[_0x5dfe27(0xd4)]('notification',_0x4a1163);else{logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x5dfe27(0x184)](_0x4a1163),logger[_0x5dfe27(0x184)](_0x5dfe27(0x1a1)),logger['simple']('');if(tgBot&&settings[_0x5dfe27(0xdb)]&&settings[_0x5dfe27(0x101)]!=_0x5dfe27(0x248))await sendTelegram(settings[_0x5dfe27(0xdb)],_0x5dfe27(0x141)+_0x4a1163);}}function decryptRSA(_0x48885a,_0x479cf6){const _0x45e1ca=_0x57e089,_0x28deb5=forge['pki'][_0x45e1ca(0x1ff)](_0x48885a),_0x1f75d9=_0x28deb5['decrypt'](forge[_0x45e1ca(0x22b)][_0x45e1ca(0x14e)](_0x479cf6),'RSA-OAEP',{'md':forge['md']['sha256'][_0x45e1ca(0x2bd)](),'mgf1':{'md':forge['md']['sha256'][_0x45e1ca(0x2bd)]()}});return _0x1f75d9;}function validateCredentials(_0x538636,_0x320e9e){const _0x2bd072=_0x57e089;if(_0x538636[_0x2bd072(0x196)]==settings[_0x2bd072(0x12f)]&&bcrypt[_0x2bd072(0x25a)](_0x538636[_0x2bd072(0xc2)],settings['bbPassword'])){if(settings[_0x2bd072(0x229)])return{'allow':![],'reason':_0x2bd072(0x133),'token':null};else{const _0x11ef47=generateLoginToken(_0x320e9e);return{'allow':!![],'reason':_0x2bd072(0x26c),'token':_0x11ef47};}}else return{'allow':![],'reason':_0x2bd072(0x20a),'token':null};}function refreshToken(_0x5eb5d6){const _0x469a1a=_0x57e089,_0x1fdd2d=generateLoginToken(_0x5eb5d6);return{'allow':!![],'reason':_0x469a1a(0x26c),'token':_0x1fdd2d};}function validateAccess(_0x41e607,_0x460ba1,_0x9cf1a0){const _0x35d176=_0x57e089,_0x527ec9=_0x9cf1a0?_0x9cf1a0:devices[_0x460ba1]['ip'];let _0x2dba5d;const _0x484d3f=_0x2e09e6=>{const _0x11993b=_0x36dc;if(settings[_0x11993b(0x19a)]){if(settings[_0x11993b(0x229)]){if(telegram2FaApproved(_0x460ba1)){const _0x58b05b=generateLoginToken(_0x460ba1);return{'allow':!![],'reason':_0x11993b(0x21f),'token':_0x58b05b};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x2dba5d=validToken(_0x2e09e6,_0x460ba1),_0x2dba5d[_0x11993b(0x122)](_0x11993b(0xc4))?{'allow':!![],'reason':_0x11993b(0x103),'token':_0x2e09e6}:{'allow':![],'reason':_0x11993b(0x2be),'token':null};}else return{'allow':!![],'reason':_0x11993b(0x1e7),'token':null};};if(settings[_0x35d176(0x1af)]){let _0x13accb=[...settings[_0x35d176(0xc8)],_0x35d176(0x240),_0x35d176(0x29c),'127.0.0.1'];if(_0x13accb['includes'](_0x527ec9))return _0x484d3f(_0x41e607);else{_0x2dba5d=validToken(_0x41e607,_0x460ba1);if(_0x2dba5d['hasOwnProperty'](_0x35d176(0xc4)))return _0x484d3f(_0x41e607);else{if(telegramIpApproved(_0x460ba1)){const _0x5923a6=generateToken(_0x460ba1);return _0x2dba5d=_0x484d3f(_0x41e607),_0x2dba5d['allow']?{'allow':!![],'reason':_0x35d176(0x20f),'token':_0x5923a6}:_0x2dba5d;}else return settings[_0x35d176(0x294)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x484d3f(_0x41e607);}function timelyDecrypt(_0x43cc44,_0x28d527,_0xacd0b3='@'){if(_0x43cc44)try{const _0x29885b=decryptRSA(secure['privateKey'],_0x43cc44),_0x1febf6=_0x29885b['split'](_0xacd0b3)[0x0],_0x1951ac=_0x29885b['split'](_0xacd0b3)[0x1],_0xb2fea2=new Date()['getTime']();if(_0x28d527){if(_0xb2fea2-_0x1951ac<maxSecretAge*0x3e8)return _0x1febf6;else return![];}else return _0x1febf6;}catch(_0x2db7db){return![];}else return![];}const validToken=(_0x24839a,_0x447537)=>{const _0x425e6e=_0x57e089,_0x15cc77=devices[_0x447537]['ip'];if(!_0x24839a)return{'error':_0x425e6e(0x230)};for(let _0x56b5a4 of blacklist){if(_0x56b5a4[_0x425e6e(0xca)]==_0x24839a)return{'error':_0x425e6e(0x1b7)};}let _0x253e5e;try{_0x253e5e=jwt[_0x425e6e(0x2a4)](_0x24839a,secure[_0x425e6e(0x16c)]+_0x447537);}catch{return{'error':_0x425e6e(0x191)};}if(!_0x253e5e['hasOwnProperty'](_0x425e6e(0x1b1))&&!_0x253e5e['hasOwnProperty'](_0x425e6e(0x196))||!_0x253e5e[_0x425e6e(0x122)](_0x425e6e(0x23d)))return{'error':_0x425e6e(0x2b5)};if(!_0x253e5e[_0x425e6e(0x122)](_0x425e6e(0x196))&&_0x253e5e[_0x425e6e(0x122)](_0x425e6e(0x1b1))){const {clientip:_0x2862e8}=_0x253e5e;return _0x15cc77==_0x2862e8?{'success':_0x425e6e(0x24e)}:{'error':_0x425e6e(0x1a6)};}else{if(_0x253e5e[_0x425e6e(0x122)](_0x425e6e(0x196))&&_0x253e5e[_0x425e6e(0x122)](_0x425e6e(0x1b1))){const {username:_0x1ca6bc,clientip:_0x2ba166}=_0x253e5e;return settings[_0x425e6e(0x12f)]==_0x1ca6bc&&_0x15cc77==_0x2ba166?{'success':_0x425e6e(0x24e)}:{'error':_0x425e6e(0x146)};}}},generateLoginToken=_0x34afc4=>{const _0x2f48b0=_0x57e089;if(_0x34afc4){const _0xeb5a78=devices[_0x34afc4]['ip'];return jwt[_0x2f48b0(0x197)]({'username':settings[_0x2f48b0(0x12f)],'clientip':_0xeb5a78},secure[_0x2f48b0(0x16c)]+_0x34afc4,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x23d3cf=>{const _0xe1559c=_0x57e089;if(_0x23d3cf){const _0x5b74da=devices[_0x23d3cf]['ip'];return jwt[_0xe1559c(0x197)]({'clientip':_0x5b74da},secure[_0xe1559c(0x16c)]+_0x23d3cf,{'expiresIn':devices[_0x23d3cf][_0xe1559c(0xe6)][_0xe1559c(0x1d6)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x5832b6=>{const _0x2c07ab=_0x57e089;let _0x6853cc=![];return devices[_0x5832b6]['telegramIpApproval']&&devices[_0x5832b6][_0x2c07ab(0xe6)][_0x2c07ab(0x1d6)]!=_0x2c07ab(0x293)&&(_0x6853cc=devices[_0x5832b6][_0x2c07ab(0xe6)][_0x2c07ab(0x1b1)]==devices[_0x5832b6]['ip']&&new Date()[_0x2c07ab(0x18c)]()-devices[_0x5832b6][_0x2c07ab(0xe6)][_0x2c07ab(0x129)]<devices[_0x5832b6][_0x2c07ab(0xe6)]['expiry']*0x3c*0x3e8),_0x6853cc;},telegram2FaApproved=_0x9d7ff2=>{const _0x39c287=_0x57e089;let _0x127611=![];return devices[_0x9d7ff2][_0x39c287(0x128)]&&devices[_0x9d7ff2][_0x39c287(0x128)][_0x39c287(0x1d6)]!=_0x39c287(0x293)&&(_0x127611=devices[_0x9d7ff2][_0x39c287(0x128)][_0x39c287(0x1b1)]==devices[_0x9d7ff2]['ip']&&new Date()[_0x39c287(0x18c)]()-devices[_0x9d7ff2][_0x39c287(0x128)]['timestamp']<devices[_0x9d7ff2][_0x39c287(0x128)][_0x39c287(0x1d6)]*0x3c*0x3e8),_0x127611;},normalizeIP=_0x28a2f0=>{const _0x155d11=_0x57e089;let _0x194e87=null,_0x7a7091=null;if(ipaddr['isValid'](_0x28a2f0)){const _0x4435b6=ipaddr[_0x155d11(0x1d0)](_0x28a2f0);_0x4435b6['kind']()==='ipv6'?(_0x4435b6[_0x155d11(0x183)]()&&(_0x194e87=_0x4435b6[_0x155d11(0x1dc)]()[_0x155d11(0x2a0)]()),_0x7a7091=_0x4435b6[_0x155d11(0x2a0)]()):(_0x194e87=_0x4435b6[_0x155d11(0x2a0)](),_0x7a7091=_0x4435b6[_0x155d11(0x2ad)]()[_0x155d11(0x2a0)]());}return{'show':_0x194e87?_0x194e87:_0x7a7091,'store':_0x7a7091};};function formatDate(_0x2927e4){const _0x217115=_0x57e089;return _0x2927e4[_0x217115(0x1e5)]()+'/'+(_0x2927e4[_0x217115(0x28a)]()+0x1)[_0x217115(0x2a0)]()['padStart'](0x2,'0')+'/'+_0x2927e4['getDate']()[_0x217115(0x2a0)]()[_0x217115(0x2c3)](0x2,'0')+'\x20'+_0x2927e4[_0x217115(0x27c)]()['toString']()['padStart'](0x2,'0')+':'+_0x2927e4[_0x217115(0x110)]()[_0x217115(0x2a0)]()[_0x217115(0x2c3)](0x2,'0')+':'+_0x2927e4[_0x217115(0x1cc)]()[_0x217115(0x2a0)]()[_0x217115(0x2c3)](0x2,'0');}function sleep(_0xacf95f){return new Promise(_0x1cfec0=>setTimeout(_0x1cfec0,_0xacf95f));}