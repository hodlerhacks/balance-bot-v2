const _0x3865fb=_0x1d6d;(function(_0x49a1ef,_0x140554){const _0x5a6e5a=_0x1d6d,_0x48d42a=_0x49a1ef();while(!![]){try{const _0x12ec34=-parseInt(_0x5a6e5a(0x2fa))/0x1+-parseInt(_0x5a6e5a(0x206))/0x2*(-parseInt(_0x5a6e5a(0x2f1))/0x3)+-parseInt(_0x5a6e5a(0x113))/0x4*(parseInt(_0x5a6e5a(0x123))/0x5)+parseInt(_0x5a6e5a(0x1eb))/0x6+parseInt(_0x5a6e5a(0x1a8))/0x7+-parseInt(_0x5a6e5a(0x149))/0x8+-parseInt(_0x5a6e5a(0x208))/0x9*(parseInt(_0x5a6e5a(0x14a))/0xa);if(_0x12ec34===_0x140554)break;else _0x48d42a['push'](_0x48d42a['shift']());}catch(_0x46ecdc){_0x48d42a['push'](_0x48d42a['shift']());}}}(_0x1fef,0xaacd6));const _0x1ea987=function(){let _0x155f98=!![];return function(_0x4dbb0f,_0x4e21be){const _0x300cee=_0x155f98?function(){const _0x2bd7a8=_0x1d6d;if(_0x4e21be){const _0x4795c2=_0x4e21be[_0x2bd7a8(0xf6)](_0x4dbb0f,arguments);return _0x4e21be=null,_0x4795c2;}}:function(){};return _0x155f98=![],_0x300cee;};}(),_0x48d491=_0x1ea987(this,function(){const _0x23daa5=_0x1d6d;return _0x48d491[_0x23daa5(0x2ed)]()[_0x23daa5(0x107)](_0x23daa5(0x283))[_0x23daa5(0x2ed)]()[_0x23daa5(0x1a4)](_0x48d491)[_0x23daa5(0x107)](_0x23daa5(0x283));});_0x48d491();'use strict';process['env'][_0x3865fb(0x13c)]=0x1;const childProcess=require(_0x3865fb(0x293)),fs=require('fs'),fns=require(_0x3865fb(0x1d5)),low=require(_0x3865fb(0x2d2)),FileSync=require(_0x3865fb(0x14c)),path=require(_0x3865fb(0x141)),crypto=require(_0x3865fb(0x131)),forge=require('node-forge'),bcrypt=require(_0x3865fb(0x1d6)),jwt=require(_0x3865fb(0x166)),ipaddr=require(_0x3865fb(0x1a6)),argv=require('yargs/yargs')(process['argv']['slice'](0x2))[_0x3865fb(0x15b)],uuidRandom=require(_0x3865fb(0x1c2)),{Telegraf,Markup}=require(_0x3865fb(0x18d)),Mixpanel=require(_0x3865fb(0x23a)),axios=require(_0x3865fb(0x24e)),{GraphQLClient,gql}=require(_0x3865fb(0x126)),util=require(_0x3865fb(0x213)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv['port']||_0x3865fb(0x1c1),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x3865fb(0x200)](_0x3865fb(0x100)+PORT+_0x3865fb(0x102)),process[_0x3865fb(0x2b2)](0x1));const HOST=argv[_0x3865fb(0xfa)]||null,userID=argv[_0x3865fb(0x194)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x3865fb(0xff)][_0x3865fb(0x253)];let bbpath='bb/',bbpath2='';const botfile=_0x3865fb(0x1c6),configfile=_0x3865fb(0x172),settingsfile='bb-settings.json',securefile=_0x3865fb(0x224),environment=require('./'+bbpath2+_0x3865fb(0x1f9))['environment']||_0x3865fb(0xe6),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x3865fb(0x139)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3865fb(0xf5)),configpath=userID?bbpath+_0x3865fb(0x28a)+userID+'/':bbpath+_0x3865fb(0x28a),configbackuppath=configpath+_0x3865fb(0x27b),logspath=userID?bbpath+_0x3865fb(0xfb)+userID+'/':bbpath+_0x3865fb(0xfb),zippath=userID?bbpath+_0x3865fb(0x2b4)+userID+'/':bbpath+_0x3865fb(0x2b4),loggerfile=fs[_0x3865fb(0x2aa)](logspath+_0x3865fb(0x2d0),{'flags':'a'}),temppath=userID?bbpath+_0x3865fb(0x2f7)+userID+'/':bbpath+'temp/';!fs[_0x3865fb(0x139)](configpath)&&fs[_0x3865fb(0x112)](configpath);!fs[_0x3865fb(0x139)](configbackuppath)&&fs[_0x3865fb(0x112)](configbackuppath);!fs[_0x3865fb(0x139)](logspath)&&fs[_0x3865fb(0x112)](logspath);!fs[_0x3865fb(0x139)](zippath)&&fs[_0x3865fb(0x112)](zippath);function _0x1d6d(_0x2a25e6,_0x29c74c){const _0x4b673e=_0x1fef();return _0x1d6d=function(_0x48d491,_0x1ea987){_0x48d491=_0x48d491-0xe0;let _0x1fef8e=_0x4b673e[_0x48d491];return _0x1fef8e;},_0x1d6d(_0x2a25e6,_0x29c74c);}!fs[_0x3865fb(0x139)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x3865fb(0xe8)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3865fb(0x255)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x3865fb(0x255)]({'secure':{},'blacklist':[]})[_0x3865fb(0xe8)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x3865fb(0x170)](_0x3865fb(0x2df),{'host':_0x3865fb(0x16e)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x3865fb(0x26f)]&&(settings['telegramToken']!=''&&settings[_0x3865fb(0x26f)]!=_0x3865fb(0x12f))&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x5c09f2,_0x3d73f5)=>{const _0x306ace=_0x3865fb,_0x139ad2=/#[A-Z]{3}#/g;if(typeof _0x5c09f2==_0x306ace(0x1d7)){!_0x3d73f5?_0x5c09f2=_0x5c09f2[_0x306ace(0x11b)](_0x139ad2,''):(_0x5c09f2=_0x5c09f2[_0x306ace(0x11b)](/#BLU#/g,_0x306ace(0x268)),_0x5c09f2=_0x5c09f2[_0x306ace(0x11b)](/#RED#/g,'\x1b[31m'),_0x5c09f2=_0x5c09f2[_0x306ace(0x11b)](/#YEL#/g,_0x306ace(0x297)),_0x5c09f2=_0x5c09f2[_0x306ace(0x11b)](/#MAG#/g,'\x1b[35m'),_0x5c09f2=_0x5c09f2[_0x306ace(0x11b)](/#CYA#/g,_0x306ace(0x25d)),_0x5c09f2=_0x5c09f2[_0x306ace(0x11b)](/#RES#/g,_0x306ace(0x199)));;}return _0x5c09f2;},logger={'screen':_0x5e3675=>{const _0x36f1a6=_0x3865fb;console[_0x36f1a6(0x200)](parseColor(_0x5e3675,!![]));},'simple':_0x42f397=>{const _0x5038e4=_0x3865fb;console[_0x5038e4(0x200)](parseColor(_0x42f397,!![])),loggerfile[_0x5038e4(0xe8)](util['format'](parseColor(_0x42f397,![]))+'\x0a');},'full':async _0x31c3e5=>{const _0x4c2f27=_0x3865fb,_0x121edb=getTimeStamp()+_0x4c2f27(0x1ef)+_0x31c3e5;console[_0x4c2f27(0x200)](parseColor(_0x121edb,!![])),loggerfile[_0x4c2f27(0xe8)](util[_0x4c2f27(0xfc)](parseColor(_0x121edb,![]))+'\x0a');if(tgBot&&settings[_0x4c2f27(0x121)]&&settings[_0x4c2f27(0x24a)]!=_0x4c2f27(0x236))await sendTelegram(settings[_0x4c2f27(0x121)],_0x4c2f27(0x23f)+parseColor(_0x31c3e5,![]));},'debug':async(_0x1395ec,_0x5dc684='')=>{const _0x5ae067=_0x3865fb,_0x24ebb8=getTimeStamp()+_0x5ae067(0x2cd)+_0x1395ec;if(debugging)console['log'](parseColor(_0x24ebb8,!![]));loggerfile[_0x5ae067(0xe8)](util[_0x5ae067(0xfc)](parseColor(_0x24ebb8,![]))+'\x0a');if(_0x5dc684){if(debugging)console[_0x5ae067(0x200)](_0x5dc684);loggerfile[_0x5ae067(0xe8)](util[_0x5ae067(0xfc)](_0x5dc684)+'\x0a');}}};let terminating=![];process['on'](_0x3865fb(0x252),function(_0x1b0d46){const _0x5aed3b=_0x3865fb;_0x1b0d46[_0x5aed3b(0x2ed)]()['includes']('address\x20already\x20in\x20use')?(logger[_0x5aed3b(0x23c)]('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x1b0d46[_0x5aed3b(0x2af)]+_0x5aed3b(0xee)),process[_0x5aed3b(0x1a7)]({'terminate':!![]},_0x5b0a4b=>{})):logger[_0x5aed3b(0x23c)](_0x1b0d46);}),process['on'](_0x3865fb(0x2b2),()=>{const _0x5473d4=_0x3865fb;stopAllBots(),process[_0x5473d4(0x2b2)](0x0);}),process['on'](_0x3865fb(0x104),()=>{const _0x492aa2=_0x3865fb;stopAllBots(),process[_0x492aa2(0x2b2)](0x0);}),process['on'](_0x3865fb(0xe2),()=>{const _0x4bf692=_0x3865fb;stopAllBots(),process[_0x4bf692(0x2b2)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x3865fb(0x1f9))[_0x3865fb(0x1d1)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3865fb(0x2a6)),app=express(),http=require(_0x3865fb(0x287))[_0x3865fb(0x20e)](app);app[_0x3865fb(0x279)](fileUpload({'useTempFiles':!![]})),app['get'](_0x3865fb(0x2a7),async(_0x58e716,_0xe22f51)=>{const _0x388e4e=_0x3865fb,_0x310f60=_0x58e716[_0x388e4e(0x17e)][_0x388e4e(0x1d9)],_0x35aa8c=getClientsWithBotID('botmanager'),_0x5e9fbb=_0x58e716[_0x388e4e(0x276)]['uuid'],_0x1605b7=timelyDecrypt(_0x5e9fbb,![]),_0x3c1c54=_0x35aa8c[_0x388e4e(0x10c)](_0x275c2e=>_0x275c2e[_0x388e4e(0x1ca)]==_0x1605b7);if(_0x3c1c54){const _0x35d6e8=normalizeIP(_0x58e716[_0x388e4e(0x254)][_0x388e4e(0x15e)])[_0x388e4e(0x1de)],_0x598727=_0x58e716[_0x388e4e(0x276)]['tkn'];if(validateAccess(_0x598727,_0x1605b7,_0x35d6e8)[_0x388e4e(0x248)])_0x310f60==_0x388e4e(0x164)&&await backupConfigFiles(),await zipFiles(_0x310f60),_0xe22f51[_0x388e4e(0x2d7)](zippath+(_0x310f60+_0x388e4e(0x1dd)),_0x517f57=>{const _0x5e0afe=_0x388e4e;_0x517f57&&(logger[_0x5e0afe(0x20f)](_0x5e0afe(0x1f5)+_0x310f60),logger[_0x5e0afe(0x23c)](_0x517f57));});else logger[_0x388e4e(0x20f)](_0x388e4e(0x2c0)+_0x310f60+_0x388e4e(0x147));}else logger['full'](_0x388e4e(0x2c0)+_0x310f60+_0x388e4e(0x222));}),app['post']('/upload-backup',async(_0x24e6a1,_0x7075b1)=>{const _0x50d078=_0x3865fb,_0x33208f=getClientsWithBotID(_0x50d078(0x2f2)),_0x5a97a7=_0x24e6a1[_0x50d078(0x276)][_0x50d078(0x1ca)],_0x13eaa9=timelyDecrypt(_0x5a97a7,![]),_0x4d4abc=_0x33208f['find'](_0x3fbe90=>_0x3fbe90['uuid']==_0x13eaa9);logger[_0x50d078(0x2da)](_0x50d078(0x260));if(_0x4d4abc){const _0x13ca59=normalizeIP(_0x24e6a1[_0x50d078(0x254)][_0x50d078(0x15e)])[_0x50d078(0x1de)],_0x133666=_0x24e6a1[_0x50d078(0x276)][_0x50d078(0x202)];if(validateAccess(_0x133666,_0x13eaa9,_0x13ca59)[_0x50d078(0x248)]){if(_0x24e6a1[_0x50d078(0x21d)]){const _0x3c8739=_0x24e6a1['files']['backupfile'];await _0x3c8739['mv'](temppath+_0x3c8739[_0x50d078(0x1d2)]),_0x7075b1['send']({'status':!![],'message':_0x50d078(0x2c1)});const _0x141f30=getBotsWithMode();_0x141f30['length']>0x0?confirmRestore(temppath,_0x3c8739[_0x50d078(0x1d2)]):unzipFile(temppath,_0x3c8739['name']);}}else logger[_0x50d078(0x20f)](_0x50d078(0x26a));}else logger[_0x50d078(0x20f)](_0x50d078(0x1f8));}),app['use'](express['static'](path[_0x3865fb(0x241)](__dirname,bbpath2,_0x3865fb(0x1be)))),app[_0x3865fb(0x279)](express['static'](path['join'](__dirname,bbpath2,_0x3865fb(0x25a)))),app[_0x3865fb(0x1a3)]('/',function(_0x18bb31,_0x1d8dd0){const _0x16dec1=_0x3865fb;_0x1d8dd0[_0x16dec1(0x22b)](path['join'](__dirname,bbpath2,'build2',_0x16dec1(0x298)));}),app['get'](_0x3865fb(0x2d5),function(_0x5981e5,_0x44479b){const _0x439a60=_0x3865fb;_0x44479b[_0x439a60(0x22b)](path['join'](__dirname,bbpath2,_0x439a60(0x25a),_0x439a60(0x298)));}),app[_0x3865fb(0x1a3)](_0x3865fb(0x2a0),(_0x3fb914,_0x5124ae)=>{const _0x577e53=_0x3865fb;_0x5124ae['sendFile'](path[_0x577e53(0x241)](__dirname,bbpath2,_0x577e53(0x25a),_0x577e53(0x298)));}),app[_0x3865fb(0x1a3)](_0x3865fb(0x2d9),(_0x5f4557,_0x1446df)=>{const _0xbdc8f7=_0x3865fb;_0x1446df[_0xbdc8f7(0x22b)](path[_0xbdc8f7(0x241)](__dirname,bbpath2,_0xbdc8f7(0x25a),_0xbdc8f7(0x298)));}),app['get'](_0x3865fb(0x1fa),(_0x584c42,_0x1d5fc1)=>{const _0x36b111=_0x3865fb;_0x1d5fc1[_0x36b111(0x22b)](path[_0x36b111(0x241)](__dirname,bbpath2,_0x36b111(0x25a),_0x36b111(0x298)));}),app['get'](_0x3865fb(0x111),(_0x158ffa,_0x4d9032)=>{const _0x23b022=_0x3865fb;_0x4d9032[_0x23b022(0x22b)](path[_0x23b022(0x241)](__dirname,bbpath2,_0x23b022(0x25a),'index.html'));}),app[_0x3865fb(0x1a3)]('/:bot/configuration',(_0x2984f7,_0x514d07)=>{const _0x3ffd82=_0x3865fb;_0x514d07[_0x3ffd82(0x22b)](path[_0x3ffd82(0x241)](__dirname,bbpath2,_0x3ffd82(0x25a),_0x3ffd82(0x298)));}),app[_0x3865fb(0x1a3)](_0x3865fb(0x2c9),(_0x3c6ef2,_0x8d4eab)=>{const _0x44c4ad=_0x3865fb;_0x8d4eab['sendFile'](path[_0x44c4ad(0x241)](__dirname,bbpath2,'build','index.html'));});if(HOST)http[_0x3865fb(0x230)](PORT,HOST);else http[_0x3865fb(0x230)](PORT);const io=require(_0x3865fb(0x2d8))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x57c066=_0x3865fb;let _0x55c543=_0x57c066(0x125);const _0x888408=networkInterfaces(),_0x5b252d={};for(const _0x59a0c9 of Object[_0x57c066(0x12d)](_0x888408)){for(const _0x34cef3 of _0x888408[_0x59a0c9]){if((_0x34cef3[_0x57c066(0x288)]=='IPv4'||_0x34cef3[_0x57c066(0x288)]==0x4)&&!_0x34cef3[_0x57c066(0x2c3)]){const _0x14bd1b=ipaddr[_0x57c066(0x2e8)](_0x34cef3[_0x57c066(0x10f)])['range']();_0x14bd1b!=_0x57c066(0x1e0)&&(!_0x5b252d[_0x59a0c9]&&(_0x5b252d[_0x59a0c9]=[]),_0x5b252d[_0x59a0c9][_0x57c066(0x264)](_0x34cef3[_0x57c066(0x10f)]),_0x55c543=_0x34cef3[_0x57c066(0x10f)]);}}}return{'serverip':_0x55c543,'netinterfaces':_0x5b252d};}async function startServer(){const _0x5572bb=_0x3865fb,{serverip:_0x3a7be7,netinterfaces:_0xadba41}=getServerIP();logger[_0x5572bb(0x23c)](''),logger['simple'](_0x5572bb(0x26d)),await logger[_0x5572bb(0x20f)](_0x5572bb(0x2ac)+serverversion+_0x5572bb(0x13a)+(environment==_0x5572bb(0x144)?'(staging)':'')+'\x0a'+(_0x5572bb(0x2a5)+PORT+_0x5572bb(0x272))+(_0x5572bb(0x191)+_0x3a7be7+':'+PORT+_0x5572bb(0x21c))),logger[_0x5572bb(0x23c)]('-----------------------------------------------------------------------------------');if(config[_0x5572bb(0x2c2)]!=0x0)for(const _0x43c9ab of config){const _0x56ae2e=_0x43c9ab[_0x5572bb(0x198)]==_0x5572bb(0x1f0)?'a':'m';if(_0x43c9ab['status']==_0x5572bb(0x285)||_0x43c9ab[_0x5572bb(0x188)]=='new')await logger['full'](_0x5572bb(0x128)+_0x56ae2e+')\x20|\x20Bot\x20'+_0x43c9ab['botID']+_0x5572bb(0x16b)+_0x43c9ab[_0x5572bb(0x2bb)]),startBot([_0x43c9ab[_0x5572bb(0x11c)],userID],{'cwd':bbpath},function(_0x33b324){const _0x458dc2=_0x5572bb;if(_0x33b324)logger[_0x458dc2(0x20f)](_0x33b324);});else(_0x43c9ab['status']=='disabled'||_0x43c9ab[_0x5572bb(0x188)]=='new-disabled')&&await logger['full']('Idling\x20('+_0x56ae2e+_0x5572bb(0x150)+_0x43c9ab[_0x5572bb(0x11c)]+_0x5572bb(0x16b)+_0x43c9ab['botname']);}else!newBot&&logger[_0x5572bb(0x23c)](_0x5572bb(0x1d8));if(newBot)addBot();logger[_0x5572bb(0x23c)](_0x5572bb(0x26d)),logger[_0x5572bb(0x23c)](''),await logger['debug'](_0x5572bb(0x237)+nodeversion),await logger[_0x5572bb(0x2da)](_0x5572bb(0x1db),_0xadba41);}function startSocket(){io['on']('connection',_0x5182cb=>{const _0x4646a7=_0x1d6d;let _0x172cf7,_0x4bfc58,_0x1df404,_0x5b7efb,_0x6d9973;const _0x258ec2=_0x5182cb[_0x4646a7(0x13e)][_0x4646a7(0x276)][_0x4646a7(0x132)];_0x4bfc58=_0x258ec2[_0x4646a7(0xfe)](/bot[0-9]{3}/);if(_0x4bfc58)_0x1df404=_0x4bfc58[0x0][_0x4646a7(0xfe)](/[0-9]{3}/);if(_0x1df404)_0x172cf7=_0x1df404[0x0];else _0x172cf7=_0x4646a7(0x2f2);const _0x4c422c=_0x5182cb[_0x4646a7(0x13e)][_0x4646a7(0x110)][_0x4646a7(0x16a)];if(!_0x4c422c)_0x5182cb[_0x4646a7(0x22e)](_0x4646a7(0x188),{'publicKey':secure[_0x4646a7(0x1fb)]});else{_0x5b7efb=timelyDecrypt(_0x4c422c,![]);if(!_0x5b7efb)_0x5182cb[_0x4646a7(0x22e)](_0x4646a7(0x188),{'publicKey':secure[_0x4646a7(0x1fb)]});else{_0x6d9973=normalizeIP(_0x5182cb[_0x4646a7(0x14e)][_0x4646a7(0x15e)])[_0x4646a7(0x1de)];if(!devices[_0x5b7efb])devices[_0x5b7efb]={'uuid':_0x5b7efb,'access':{'token':null}};devices[_0x5b7efb]['ip']=_0x6d9973;const _0x1c3ad2=addClient(_0x5182cb['id'],_0x5b7efb,_0x172cf7);setAccess(_0x1c3ad2),emitMessages(),_0x5182cb['on']('login',_0x45c147=>{const _0xec92a7=_0x4646a7,_0x6ddf60=timelyDecrypt(_0x45c147[_0xec92a7(0x2ee)],!![],'|@|');if(_0x6ddf60){_0x45c147={'username':_0x45c147[_0xec92a7(0xf7)],'password':_0x6ddf60},devices[_0x5b7efb][_0xec92a7(0x180)]=validateCredentials(_0x45c147,_0x5b7efb);if(devices[_0x5b7efb][_0xec92a7(0x180)][_0xec92a7(0x248)]==![]&&devices[_0x5b7efb][_0xec92a7(0x180)][_0xec92a7(0x226)]==_0xec92a7(0x193))_0x5182cb[_0xec92a7(0x22e)](_0xec92a7(0x188),{'access':devices[_0x5b7efb]['access']}),loginAccess2FA(_0x5b7efb,_0x6d9973);else{if(devices[_0x5b7efb][_0xec92a7(0x180)][_0xec92a7(0x248)]==![]&&devices[_0x5b7efb]['access'][_0xec92a7(0x226)]==_0xec92a7(0x238))_0x5182cb[_0xec92a7(0x22e)]('status',{'access':devices[_0x5b7efb][_0xec92a7(0x180)]});else devices[_0x5b7efb][_0xec92a7(0x180)]['allow']&&devices[_0x5b7efb][_0xec92a7(0x180)][_0xec92a7(0x226)]==_0xec92a7(0x23e)&&(getClientsWithUuid(_0x5b7efb)[_0xec92a7(0xec)](_0x3cedea=>{setAccess(_0x3cedea);}),logger['debug'](_0xec92a7(0x282)+_0x5b7efb[_0xec92a7(0x2ae)](-0x8)),setTokenRefresh(_0x5b7efb),setSessionTimeout(_0xec92a7(0x2b3),_0x5b7efb));}}else logger['full'](_0xec92a7(0x12a));}),_0x5182cb['on']('reset-password',()=>{resetPassword();}),_0x5182cb['on']('disconnect',_0x6005e0=>{removeClient(_0x5182cb['id']);}),_0x172cf7==_0x4646a7(0x2f2)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x3a45ab){const _0x4e0e6a=_0x3865fb;if(_0x3a45ab!=_0x4e0e6a(0x2f2)&&config[_0x4e0e6a(0x20a)]!=''){if(pid[_0x3a45ab])pid[_0x3a45ab][_0x4e0e6a(0x1a7)]({'function':_0x4e0e6a(0x203),'args':null});}_0x3a45ab!=_0x4e0e6a(0x2f2)&&broadcastToBots(_0x4e0e6a(0x155),JSON[_0x4e0e6a(0x2be)](config));}function reloadBotManager(){const _0x4cf533=_0x3865fb;getClientsWithBotID(_0x4cf533(0x2f2))['forEach'](_0x963dc9=>{const _0x5400aa=_0x4cf533;getSocket(_0x963dc9['id'])[_0x5400aa(0x22e)](_0x5400aa(0x188),{'access':{'allow':![],'reason':_0x5400aa(0x27c),'token':null}});});}function getSocket(_0x3e4bb1){const _0x53dd72=_0x3865fb,_0x708ba2=io[_0x53dd72(0x19e)][_0x53dd72(0x1a3)]('/');return _0x708ba2[_0x53dd72(0x1c4)][_0x53dd72(0x1a3)](_0x3e4bb1);}function setAccess(_0x1daff){const _0x487250=_0x3865fb,_0xe1effd=getSocket(_0x1daff['id']),_0x5551f7=_0x1daff[_0x487250(0x1ca)],_0x52c6ab=_0x1daff[_0x487250(0x179)];devices[_0x5551f7][_0x487250(0x180)]=validateAccess(devices[_0x5551f7][_0x487250(0x180)][_0x487250(0x1b3)],_0x5551f7),logger[_0x487250(0x2da)](_0x487250(0xe5)+devices[_0x5551f7][_0x487250(0x180)]['reason']+'\x20|\x20client:\x20...'+_0x1daff['id']['slice'](-0x8)+_0x487250(0x205)+_0x5551f7['slice'](-0x8)),_0xe1effd[_0x487250(0x241)](_0x5551f7);if(devices[_0x5551f7][_0x487250(0x180)][_0x487250(0x248)]){_0xe1effd[_0x487250(0x241)](_0x52c6ab);if(_0x52c6ab==_0x487250(0x2f2))initializeSocketBotManager(_0xe1effd);else initializeSocketBot(_0xe1effd);initClient(_0x52c6ab);}devices[_0x5551f7][_0x487250(0x180)]['token']&&devices[_0x5551f7][_0x487250(0x180)]['reason']=='temporary\x20token\x20generated'&&setSessionTimeout(_0x487250(0x2dd),_0x5551f7),devices[_0x5551f7][_0x487250(0x180)][_0x487250(0x1b3)]&&devices[_0x5551f7][_0x487250(0x180)]['reason']==_0x487250(0x2c5)&&setSessionTimeout(_0x487250(0x2b3),_0x5551f7),_0xe1effd[_0x487250(0x22e)]('status',{'status':_0x1daff[_0x487250(0x258)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5551f7][_0x487250(0x180)],'externalip':devices[_0x5551f7]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x487250(0x178)],'validInstallation':validInstallation}),devices[_0x5551f7][_0x487250(0x180)][_0x487250(0x248)]==![]&&devices[_0x5551f7][_0x487250(0x180)][_0x487250(0x226)]=='2FA\x20required'&&temporaryAccess2FA(_0x5551f7,devices[_0x5551f7]['ip']);}function setSessionTimeout(_0x276d8a,_0x3a386c){const _0x4203de=_0x3865fb;let _0xa1ebb2;if(_0x276d8a==_0x4203de(0x2b3))_0xa1ebb2=loginExpiry*0x3c*0x3e8;else _0xa1ebb2=devices[_0x3a386c][_0x4203de(0x212)][_0x4203de(0x2ef)]*0x3c*0x3e8-(new Date()[_0x4203de(0x215)]()-devices[_0x3a386c][_0x4203de(0x212)][_0x4203de(0x1dc)]);if(devices[_0x3a386c]['pidExpireLogin'])clearTimeout(devices[_0x3a386c][_0x4203de(0x1bd)]);devices[_0x3a386c][_0x4203de(0x1bd)]=setTimeout(()=>{const _0x1efbee=_0x4203de;if(devices[_0x3a386c][_0x1efbee(0x124)])clearTimeout(devices[_0x3a386c][_0x1efbee(0x124)]);removeSocketListeners(_0x3a386c),addBlacklist(_0x3a386c),devices[_0x3a386c][_0x1efbee(0x212)]=null,devices[_0x3a386c]['telegram2FaApproval']=null,devices[_0x3a386c][_0x1efbee(0x180)][_0x1efbee(0x1b3)]=null,logger[_0x1efbee(0x2da)](_0x1efbee(0x22f)+_0x3a386c[_0x1efbee(0x2ae)](-0x8)),devices[_0x3a386c]['access']=validateAccess(devices[_0x3a386c]['access'][_0x1efbee(0x1b3)],_0x3a386c),!(devices[_0x3a386c]['access'][_0x1efbee(0x248)]&&devices[_0x3a386c][_0x1efbee(0x180)][_0x1efbee(0x226)]==_0x1efbee(0x1b9))&&(_0x276d8a=='login'?io['to'](_0x3a386c)[_0x1efbee(0x22e)]('status',{'access':{'allow':![],'reason':_0x1efbee(0x12c),'token':null}}):io['to'](_0x3a386c)[_0x1efbee(0x22e)]('status',{'access':{'allow':![],'reason':_0x1efbee(0x175),'token':null}})),devices[_0x3a386c][_0x1efbee(0x180)][_0x1efbee(0x1b3)]=null;},_0xa1ebb2);}function setTokenRefresh(_0x2efbf9){const _0x48bfe4=_0x3865fb;if(devices[_0x2efbf9][_0x48bfe4(0x124)])clearTimeout(devices[_0x2efbf9]['pidRefreshToken']);devices[_0x2efbf9][_0x48bfe4(0x124)]=setTimeout(()=>{const _0x2b101c=_0x48bfe4;getClientsWithUuid(_0x2efbf9)['length']!=0x0?(devices[_0x2efbf9]['access']=refreshToken(_0x2efbf9),io['to'](_0x2efbf9)['emit'](_0x2b101c(0x188),{'status':_0x2b101c(0x250),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2efbf9][_0x2b101c(0x180)],'externalip':devices[_0x2efbf9]['ip'],'publicKey':secure[_0x2b101c(0x1fb)],'validInstallation':validInstallation}),setTokenRefresh(_0x2efbf9)):clearTimeout(devices[_0x2efbf9][_0x2b101c(0x124)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4e7d21){const _0x57b38d=_0x3865fb,_0x4f4588=getClient(_0x4e7d21['id'])[_0x57b38d(0x1ca)];_0x4e7d21[_0x57b38d(0x22e)]('bots',config),_0x4e7d21[_0x57b38d(0x22e)]('settings',cleanSettings()),_0x4e7d21['on']('add-bot',_0x16441c=>{const _0x338b3d=_0x57b38d;if(validateAccess(_0x16441c,_0x4f4588)[_0x338b3d(0x248)])addBot();else logger['full'](_0x338b3d(0x1c5));}),_0x4e7d21['on'](_0x57b38d(0x118),(_0x3e01ef,_0x437a35)=>{const _0x3595a5=_0x57b38d;if(validateAccess(_0x437a35,_0x4f4588)['allow'])toggleBot(_0x3e01ef['botID'],_0x3e01ef[_0x3595a5(0x188)],_0x3e01ef[_0x3595a5(0x274)]);else logger[_0x3595a5(0x20f)](_0x3595a5(0xf3));}),_0x4e7d21['on'](_0x57b38d(0x165),(_0xa941fd,_0x120535)=>{const _0x2ef98f=_0x57b38d;if(validateAccess(_0x120535,_0x4f4588)[_0x2ef98f(0x248)])toggleBotMode(_0xa941fd);else logger[_0x2ef98f(0x20f)](_0x2ef98f(0xf3));}),_0x4e7d21['on'](_0x57b38d(0x18e),(_0x3b160d,_0x4cc246)=>{const _0x4934f6=_0x57b38d;if(validateAccess(_0x4cc246,_0x4f4588)['allow'])deleteBot(_0x3b160d);else logger[_0x4934f6(0x20f)](_0x4934f6(0x2c7));}),_0x4e7d21['on'](_0x57b38d(0x2db),(_0x2a4a63,_0x28f495)=>{const _0x3023ca=_0x57b38d;if(validateAccess(_0x28f495,_0x4f4588)[_0x3023ca(0x248)])storeSettings(_0x2a4a63,!![]);else logger['full'](_0x3023ca(0x2c4));}),_0x4e7d21['on'](_0x57b38d(0x105),_0x32d86e=>{const _0x5d9dd4=_0x57b38d;if(validateAccess(_0x32d86e,_0x4f4588)['allow'])updateBB(_0x5d9dd4(0x244));else logger[_0x5d9dd4(0x20f)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x4e7d21['on']('reinstall-bb',_0x4908ef=>{const _0x182b9=_0x57b38d;if(validateAccess(_0x4908ef,_0x4f4588)[_0x182b9(0x248)])updateBB(_0x182b9(0x109));else logger[_0x182b9(0x20f)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x4e7d21['on'](_0x57b38d(0x2ba),_0x390900=>{const _0x16f3cb=_0x57b38d;if(validateAccess(_0x390900,_0x4f4588)[_0x16f3cb(0x248)]){const _0x18bc70=getClient(_0x4e7d21['id']);if(_0x18bc70)getBackupFiles(_0x18bc70[_0x16f3cb(0x1ca)]);else logger[_0x16f3cb(0x20f)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x16f3cb(0x20f)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x4e7d21['on']('restore-backup-file',(_0x4d77a1,_0x204ed6)=>{const _0x5e0f18=_0x57b38d;if(validateAccess(_0x204ed6,_0x4f4588)['allow'])restoreBackupFile(_0x4d77a1);else logger[_0x5e0f18(0x20f)](_0x5e0f18(0x152));}),_0x4e7d21['on'](_0x57b38d(0x2f4),_0x59fa0a=>{const _0x39c205=_0x57b38d;if(validateAccess(_0x59fa0a,_0x4f4588)[_0x39c205(0x248)])getMessages();else logger['full'](_0x39c205(0x1b5));}),_0x4e7d21['on'](_0x57b38d(0x1d0),(_0x48331c,_0x11078e)=>{const _0x536b0a=_0x57b38d;if(validateAccess(_0x11078e,_0x4f4588)['allow'])confirmMessage(_0x48331c);else logger[_0x536b0a(0x20f)](_0x536b0a(0x189));}),_0x4e7d21['on']('logout',_0x54b513=>{const _0xf967ce=_0x57b38d;if(validateAccess(_0x54b513,_0x4f4588)[_0xf967ce(0x248)]){if(devices[_0x4f4588]['pidRefreshToken'])clearTimeout(devices[_0x4f4588][_0xf967ce(0x124)]);if(devices[_0x4f4588][_0xf967ce(0x1bd)])clearTimeout(devices[_0x4f4588][_0xf967ce(0x1bd)]);removeSocketListeners(getClient(_0x4e7d21['id'])[_0xf967ce(0x1ca)]),addBlacklist(_0x4f4588),devices[_0x4f4588][_0xf967ce(0x212)]=null,devices[_0x4f4588][_0xf967ce(0x11f)]=null,devices[_0x4f4588][_0xf967ce(0x180)][_0xf967ce(0x1b3)]=null,logger[_0xf967ce(0x2da)](_0xf967ce(0xf1)+_0x4f4588[_0xf967ce(0x2ae)](-0x8)),io['to'](getClient(_0x4e7d21['id'])[_0xf967ce(0x1ca)])[_0xf967ce(0x22e)](_0xf967ce(0x188),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0xf967ce(0x20f)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x1d9c81){const _0x2fa6d2=_0x3865fb,_0x3ffa5e=getClient(_0x1d9c81['id'])['bot'],_0x181690=getClient(_0x1d9c81['id'])[_0x2fa6d2(0x1ca)];_0x1d9c81['on'](_0x2fa6d2(0x1fc),(_0x21c271,_0x3e3b8f)=>{const _0x44b948=_0x2fa6d2;if(validateAccess(_0x3e3b8f,_0x181690)[_0x44b948(0x248)]){if(pid[_0x3ffa5e])pid[_0x3ffa5e]['send']({'function':_0x44b948(0x2ca),'args':_0x21c271});}else logger[_0x44b948(0x20f)](_0x44b948(0xfd));}),_0x1d9c81['on']('delete-alerts',(_0x44567e,_0x23d995)=>{const _0x59de3c=_0x2fa6d2;if(validateAccess(_0x23d995,_0x181690)[_0x59de3c(0x248)]){if(pid[_0x3ffa5e])pid[_0x3ffa5e][_0x59de3c(0x1a7)]({'function':_0x59de3c(0x183),'args':_0x44567e});}else logger[_0x59de3c(0x20f)](_0x59de3c(0x11d));}),_0x1d9c81['on'](_0x2fa6d2(0x19a),(_0x239df7,_0x498e71)=>{const _0x43c4d9=_0x2fa6d2;if(validateAccess(_0x498e71,_0x181690)['allow']){if(pid[_0x3ffa5e])pid[_0x3ffa5e][_0x43c4d9(0x1a7)]({'function':_0x43c4d9(0x2e3),'args':_0x239df7});}else logger[_0x43c4d9(0x20f)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x1d9c81['on'](_0x2fa6d2(0xf4),(_0x418d4f,_0xd355bf)=>{const _0x37e9c0=_0x2fa6d2;if(validateAccess(_0xd355bf,_0x181690)['allow']){if(pid[_0x3ffa5e])pid[_0x3ffa5e][_0x37e9c0(0x1a7)]({'function':_0x37e9c0(0x1ad),'args':_0x418d4f});}else logger[_0x37e9c0(0x20f)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x1d9c81['on'](_0x2fa6d2(0x265),(_0x196647,_0x53ce28)=>{const _0x105723=_0x2fa6d2;if(validateAccess(_0x53ce28,_0x181690)[_0x105723(0x248)]){if(pid[_0x3ffa5e])pid[_0x3ffa5e]['send']({'function':'storeHeadless','args':_0x196647});}else logger[_0x105723(0x20f)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x1d9c81['on'](_0x2fa6d2(0x134),(_0x44bd54,_0x58cda4)=>{const _0x4f5475=_0x2fa6d2;if(validateAccess(_0x58cda4,_0x181690)[_0x4f5475(0x248)]){if(pid[_0x3ffa5e])pid[_0x3ffa5e][_0x4f5475(0x1a7)]({'function':_0x4f5475(0x148),'args':_0x44bd54});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x1d9c81['on']('reset-history',_0x33d783=>{const _0x2b6d2a=_0x2fa6d2;if(validateAccess(_0x33d783,_0x181690)[_0x2b6d2a(0x248)]){if(pid[_0x3ffa5e])pid[_0x3ffa5e][_0x2b6d2a(0x1a7)]({'function':_0x2b6d2a(0x232),'args':null});}else logger[_0x2b6d2a(0x20f)](_0x2b6d2a(0x234));}),_0x1d9c81['on']('get-starting-balances',_0x299c22=>{const _0x38b98e=_0x2fa6d2;if(validateAccess(_0x299c22,_0x181690)['allow']){if(pid[_0x3ffa5e])pid[_0x3ffa5e][_0x38b98e(0x1a7)]({'function':_0x38b98e(0x28b),'args':null});}else logger[_0x38b98e(0x20f)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x1d9c81['on'](_0x2fa6d2(0x174),(_0xd99fd2,_0x2b6c80)=>{const _0x2a1ce3=_0x2fa6d2;if(validateAccess(_0x2b6c80,_0x181690)['allow']){if(pid[_0x3ffa5e])pid[_0x3ffa5e][_0x2a1ce3(0x1a7)]({'function':_0x2a1ce3(0x22d),'args':_0xd99fd2});}else logger[_0x2a1ce3(0x20f)](_0x2a1ce3(0x2c6));}),_0x1d9c81['on'](_0x2fa6d2(0x1b1),_0x255c91=>{const _0x51fc5b=_0x2fa6d2;if(validateAccess(_0x255c91,_0x181690)[_0x51fc5b(0x248)]){if(pid[_0x3ffa5e])pid[_0x3ffa5e]['send']({'function':'cancelLoading','args':null});}else logger[_0x51fc5b(0x20f)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x1d9c81['on'](_0x2fa6d2(0x1f6),_0x23ad94=>{const _0xbcd488=_0x2fa6d2;if(validateAccess(_0x23ad94,_0x181690)[_0xbcd488(0x248)]){if(pid[_0x3ffa5e])pid[_0x3ffa5e]['send']({'function':_0xbcd488(0xe4),'args':null});}else logger[_0xbcd488(0x20f)](_0xbcd488(0x277));}),_0x1d9c81['on'](_0x2fa6d2(0x105),_0x2646bb=>{const _0x4f8bd3=_0x2fa6d2;if(validateAccess(_0x2646bb,_0x181690)[_0x4f8bd3(0x248)])updateBB(_0x4f8bd3(0x244));else logger[_0x4f8bd3(0x20f)](_0x4f8bd3(0x1ec));}),_0x1d9c81['on'](_0x2fa6d2(0x2f4),_0x5d352f=>{const _0x4c1008=_0x2fa6d2;if(validateAccess(_0x5d352f,_0x181690)[_0x4c1008(0x248)])getMessages();else logger[_0x4c1008(0x20f)](_0x4c1008(0x1b5));}),_0x1d9c81['on'](_0x2fa6d2(0x1d0),(_0x41ae0e,_0x2a8cf1)=>{const _0x251af8=_0x2fa6d2;if(validateAccess(_0x2a8cf1,_0x181690)['allow'])confirmMessage(_0x41ae0e);else logger['full'](_0x251af8(0x189));}),_0x1d9c81['on']('logout',_0x5c17e6=>{const _0x49e20c=_0x2fa6d2;if(validateAccess(_0x5c17e6,_0x181690)[_0x49e20c(0x248)]){if(devices[_0x181690]['pidRefreshToken'])clearTimeout(devices[_0x181690]['pidRefreshToken']);if(devices[_0x181690][_0x49e20c(0x1bd)])clearTimeout(devices[_0x181690][_0x49e20c(0x1bd)]);removeSocketListeners(getClient(_0x1d9c81['id'])[_0x49e20c(0x1ca)]),addBlacklist(_0x181690),devices[_0x181690][_0x49e20c(0x212)]=null,devices[_0x181690][_0x49e20c(0x11f)]=null,devices[_0x181690][_0x49e20c(0x180)]['token']=null,logger[_0x49e20c(0x2da)](_0x49e20c(0xf1)+_0x181690[_0x49e20c(0x2ae)](-0x8)),io['to'](getClient(_0x1d9c81['id'])['uuid'])['emit']('status',{'access':{'allow':![],'reason':_0x49e20c(0x28e),'token':null}});}else logger[_0x49e20c(0x20f)](_0x49e20c(0x2e5));});}function removeSocketListeners(_0x566193){const _0x232884=_0x3865fb;getClientsWithUuid(_0x566193)[_0x232884(0xec)](_0x3ca4f5=>{const _0x2b8428=_0x232884;getSocket(_0x3ca4f5['id'])[_0x2b8428(0x1a9)]();});}function cleanSettings(){const _0x496126=_0x3865fb;let _0x11be63=settings;return settings['telegramToken']&&settings[_0x496126(0x26f)]!=''&&(_0x11be63={..._0x11be63,'telegramToken':_0x496126(0x122)}),settings[_0x496126(0x1a0)]&&settings[_0x496126(0x1a0)]!=''&&(_0x11be63={..._0x11be63,'bbPassword':'************'}),settings[_0x496126(0x11e)]&&settings[_0x496126(0x11e)]!=''&&(_0x11be63={..._0x11be63,'marketcapApi':_0x496126(0x122)}),(settings[_0x496126(0x1a0)]&&settings[_0x496126(0x1a0)]==_0x496126(0x12f)||settings[_0x496126(0x26f)]&&settings['telegramToken']==_0x496126(0x12f)||settings['marketcapApi']&&settings[_0x496126(0x11e)]==_0x496126(0x12f))&&(_0x11be63={..._0x11be63,'restored':{'password':settings[_0x496126(0x1a0)]==_0x496126(0x12f),'telegram':settings[_0x496126(0x26f)]=='***','marketcap':settings['marketcapApi']==_0x496126(0x12f)}}),_0x11be63;}async function updateBB(_0x288385){const _0x535e6d=_0x3865fb;await backupConfigFiles(),installingUpdate=!![],config[_0x535e6d(0xec)](_0x560f1e=>{const _0x1c71e5=_0x535e6d;restartBot(_0x560f1e[_0x1c71e5(0x11c)]);});if(_0x288385==_0x535e6d(0x244))process[_0x535e6d(0x1a7)]({'update':!![],'environment':environment},_0x1bf3fb=>{});else _0x288385==_0x535e6d(0x109)&&process[_0x535e6d(0x1a7)]({'reinstall':!![],'environment':environment},_0x165c74=>{});}function startBot(_0x16925a,_0x25c768,_0x1e2a60){const _0x4b9266=_0x3865fb;if(debugging)_0x16925a['push']('-d');if(recreate)_0x16925a[_0x4b9266(0x264)]('-r');let _0x3df633=![];const _0x41a613=_0x16925a[0x0];_0x25c768={..._0x25c768,'stdio':[_0x4b9266(0x231),_0x4b9266(0x231),_0x4b9266(0x231),_0x4b9266(0x101)]},pid[_0x41a613]=childProcess[_0x4b9266(0x2b6)](botfile,_0x16925a,_0x25c768),pid[_0x41a613]['on'](_0x4b9266(0x10a),_0x4f6e6c=>{const _0x5b18b5=_0x4b9266;switch(Object[_0x5b18b5(0x12d)](_0x4f6e6c)[0x0]){case _0x5b18b5(0x2bb):updateBotName(_0x41a613,_0x4f6e6c[_0x5b18b5(0x2bb)]);break;case _0x5b18b5(0x2ea):updateBotManager();break;case'status':updateStatus(_0x41a613,_0x4f6e6c['status']);break;case _0x5b18b5(0x274):updateLive(_0x41a613,_0x4f6e6c[_0x5b18b5(0x274)]);break;case _0x5b18b5(0x1da):updateLive(_0x41a613,_0x4f6e6c['started']),io['to'](_0x41a613)[_0x5b18b5(0x22e)](_0x5b18b5(0x188),{'access':{'allow':![],'reason':_0x5b18b5(0x27c),'token':null}});break;case _0x5b18b5(0x29a):_0x4f6e6c[_0x5b18b5(0x29a)]==_0x5b18b5(0x2cf)&&restartBot(_0x41a613);_0x4f6e6c[_0x5b18b5(0x29a)]==_0x5b18b5(0x2a8)&&toggleBot(_0x41a613,_0x5b18b5(0x145),_0x5b18b5(0x19f));break;case _0x5b18b5(0x2fb):sendTelegramBot(_0x41a613,_0x4f6e6c[_0x5b18b5(0x2fb)]);break;case _0x5b18b5(0x247):sendTelegramMsg(_0x4f6e6c[_0x5b18b5(0x247)]);break;case _0x5b18b5(0x289):io['to'](_0x41a613)[_0x5b18b5(0x22e)](_0x4f6e6c[_0x5b18b5(0x289)],_0x4f6e6c['args']);break;}}),pid[_0x41a613]['on'](_0x4b9266(0x1cc),function(_0x30d5cf){if(_0x3df633)return;_0x3df633=!![],_0x1e2a60(_0x30d5cf);}),pid[_0x41a613]['on']('exit',async function(_0x4e6563){const _0x2e2211=_0x4b9266;if(terminating)return;if(installingUpdate){io[_0x2e2211(0x2bc)]();return;}if(_0x3df633)return;_0x3df633=!![],_0x1e2a60(null);const _0x1958f0=dbConfig[_0x2e2211(0x1a3)]('bots')[_0x2e2211(0x10c)]({'botID':_0x41a613})[_0x2e2211(0x2a3)]();_0x1958f0&&(_0x1958f0['status']==_0x2e2211(0x285)||_0x1958f0[_0x2e2211(0x188)]==_0x2e2211(0xea))&&(await sleep(0x3e8),updateLive(_0x41a613,_0x2e2211(0x19f)),logger[_0x2e2211(0x20f)](_0x2e2211(0x140)+_0x41a613),startBot([_0x41a613,userID],{'cwd':bbpath},function(_0x1870c1){const _0x190e33=_0x2e2211;if(_0x1870c1)logger[_0x190e33(0x20f)](_0x1870c1);}));});}function stopBot(_0x1a41eb){const _0x17f9e5=_0x3865fb;getClientsWithBotID(_0x1a41eb)[_0x17f9e5(0xec)](_0x32dfb4=>{getSocket(_0x32dfb4['id'])['disconnect'](!![]),removeClient(_0x32dfb4['id']);}),pid[_0x1a41eb]&&(pid[_0x1a41eb][_0x17f9e5(0x2a8)](),pid[_0x1a41eb]=null);}function stopAllBots(){const _0x4cf92f=_0x3865fb;terminating=!![];const _0xd0a743=getEnabledBots();_0xd0a743[_0x4cf92f(0xec)](_0x275230=>{stopBot(_0x275230['botID']);});}function restartBot(_0x14fcca){const _0x994cd7=_0x3865fb;if(pid[_0x14fcca])pid[_0x14fcca][_0x994cd7(0x2a8)]();}function addBot(){const _0x2faea5=_0x3865fb;let _0x53946d;for(let _0xaca054=0x1;_0xaca054<0x3e9;_0xaca054++){_0x53946d=_0xaca054[_0x2faea5(0x2ed)]()['padStart'](0x3,'0');let _0x53817d=config[_0x2faea5(0x10c)](_0xee554=>_0xee554[_0x2faea5(0x11c)]==_0x53946d);if(!_0x53817d)break;}if(_0x53946d===_0x2faea5(0x1f3)){logger[_0x2faea5(0x20f)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x2faea5(0x20f)](_0x2faea5(0x14b)+_0x53946d),dbConfig['get']('bots')[_0x2faea5(0x264)]({'botID':_0x53946d,'botname':_0x2faea5(0x2f8)+_0x53946d,'status':_0x2faea5(0xea),'live':''})[_0x2faea5(0xe8)](),startBot([_0x53946d,userID],{'cwd':bbpath},function(_0x5923b1){const _0x56afda=_0x2faea5;if(_0x5923b1)logger[_0x56afda(0x20f)](_0x5923b1);}),config=getConfiguration(),io['to']('botmanager')[_0x2faea5(0x22e)](_0x2faea5(0x155),config),broadcastToBots(_0x2faea5(0x155),JSON['stringify'](config));}function deleteBot(_0x37ac92){const _0x590dfd=_0x3865fb;getClientsWithBotID(_0x37ac92)['forEach'](_0x4b22af=>{const _0x5072b3=_0x1d6d;getSocket(_0x4b22af['id'])[_0x5072b3(0x135)](!![]),removeClient(_0x4b22af['id']);}),dbConfig[_0x590dfd(0x1a3)](_0x590dfd(0x155))[_0x590dfd(0x24f)]({'botID':_0x37ac92})[_0x590dfd(0xe8)](),logger[_0x590dfd(0x20f)](_0x590dfd(0x204)+_0x37ac92),stopBot(_0x37ac92);try{if(fs['existsSync'](path[_0x590dfd(0x241)](configpath,_0x590dfd(0x242)+_0x37ac92+_0x590dfd(0x270))))fs[_0x590dfd(0x26c)](path[_0x590dfd(0x241)](configpath,_0x590dfd(0x242)+_0x37ac92+'-config.json'));if(fs[_0x590dfd(0x139)](path['join'](configpath,_0x590dfd(0x242)+_0x37ac92+_0x590dfd(0x281))))fs[_0x590dfd(0x26c)](path[_0x590dfd(0x241)](configpath,_0x590dfd(0x242)+_0x37ac92+'-events.json'));if(fs['existsSync'](path[_0x590dfd(0x241)](configpath,_0x590dfd(0x242)+_0x37ac92+_0x590dfd(0x163))))fs[_0x590dfd(0x26c)](path[_0x590dfd(0x241)](configpath,'bot-'+_0x37ac92+'-performance.json'));if(fs[_0x590dfd(0x139)](path['join'](configpath,_0x590dfd(0x242)+_0x37ac92+_0x590dfd(0x256))))fs[_0x590dfd(0x26c)](path[_0x590dfd(0x241)](configpath,_0x590dfd(0x242)+_0x37ac92+_0x590dfd(0x256)));}catch(_0x4f9c57){if(_0x4f9c57)logger[_0x590dfd(0x20f)](_0x590dfd(0x27f),_0x4f9c57);}config=getConfiguration(),io['to'](_0x590dfd(0x2f2))[_0x590dfd(0x22e)](_0x590dfd(0x155),config),broadcastToBots(_0x590dfd(0x155),JSON[_0x590dfd(0x2be)](config));}function toggleBot(_0x482a6d,_0x29269c,_0xa58da1){const _0x274dec=_0x3865fb;dbConfig['get'](_0x274dec(0x155))['find']({'botID':_0x482a6d})[_0x274dec(0x214)]({'status':_0x29269c})[_0x274dec(0x214)]({'live':_0xa58da1})['write']();if(_0x29269c==_0x274dec(0x285)||_0x29269c==_0x274dec(0xea))logger[_0x274dec(0x20f)](_0x274dec(0x233)+_0x482a6d),startBot([_0x482a6d,userID],{'cwd':bbpath},function(_0x55d0e5){if(_0x55d0e5)logger['full'](_0x55d0e5);});else(_0x29269c=='disabled'||_0x29269c=='new-disabled')&&(logger[_0x274dec(0x20f)](_0x274dec(0x201)+_0x482a6d),stopBot(_0x482a6d));config=getConfiguration(),io['to']('botmanager')[_0x274dec(0x22e)](_0x274dec(0x155),config),broadcastToBots(_0x274dec(0x155),JSON[_0x274dec(0x2be)](config));}function toggleStatus(_0x14c34f){const _0x2a06d4=_0x3865fb;let _0x5328c4=dbConfig['get'](_0x2a06d4(0x155))[_0x2a06d4(0x10c)]({'botID':_0x14c34f})[_0x2a06d4(0x2a3)](),_0xd2b8e1;if(_0x5328c4[_0x2a06d4(0x188)]===_0x2a06d4(0x285))_0xd2b8e1=_0x2a06d4(0x145);else{if(_0x5328c4[_0x2a06d4(0x188)]===_0x2a06d4(0xea))_0xd2b8e1=_0x2a06d4(0x116);else{if(_0x5328c4[_0x2a06d4(0x188)]===_0x2a06d4(0x116))_0xd2b8e1='new';else{if(_0x5328c4[_0x2a06d4(0x188)]===_0x2a06d4(0x145))_0xd2b8e1='enabled';}}}return _0xd2b8e1;}function updateStatus(_0x545552,_0x1bdacb){const _0x4ca2fe=_0x3865fb;dbConfig['get'](_0x4ca2fe(0x155))[_0x4ca2fe(0x10c)]({'botID':_0x545552})[_0x4ca2fe(0x214)]({'status':_0x1bdacb})['write'](),config=getConfiguration(),io['to'](_0x4ca2fe(0x2f2))['emit'](_0x4ca2fe(0x155),config),broadcastToBots(_0x4ca2fe(0x155),JSON[_0x4ca2fe(0x2be)](config));}function updateLive(_0x1136ba,_0x2e6177){const _0x3f8d53=_0x3865fb;dbConfig[_0x3f8d53(0x1a3)](_0x3f8d53(0x155))[_0x3f8d53(0x10c)]({'botID':_0x1136ba})[_0x3f8d53(0x214)]({'live':_0x2e6177})[_0x3f8d53(0xe8)](),config=getConfiguration(),io['to'](_0x3f8d53(0x2f2))[_0x3f8d53(0x22e)]('bots',config),broadcastToBots('bots',JSON[_0x3f8d53(0x2be)](config));}function updateBotName(_0x46d98a,_0x323b5f){const _0x326479=_0x3865fb;dbConfig[_0x326479(0x1a3)](_0x326479(0x155))[_0x326479(0x10c)]({'botID':_0x46d98a})['assign']({'botname':_0x323b5f})[_0x326479(0xe8)](),config=getConfiguration(),io['to'](_0x326479(0x2f2))['emit'](_0x326479(0x155),config),broadcastToBots(_0x326479(0x155),JSON[_0x326479(0x2be)](config));}function updateBotManager(){const _0x1c0701=_0x3865fb;config=getConfiguration(),io['to'](_0x1c0701(0x2f2))[_0x1c0701(0x22e)](_0x1c0701(0x155),config),broadcastToBots(_0x1c0701(0x155),JSON[_0x1c0701(0x2be)](config));}function toggleBotMode(_0x32400a){const _0x2cbebb=_0x3865fb;if(pid[_0x32400a])pid[_0x32400a]['send']({'function':_0x2cbebb(0x2cc),'args':null});else{const _0x314c8c=configpath+_0x2cbebb(0x242)+_0x32400a+_0x2cbebb(0x270),_0x3d41cc=fs[_0x2cbebb(0x108)](_0x314c8c),_0xc461e3=JSON[_0x2cbebb(0x2e8)](_0x3d41cc),_0x5e2ba0=_0xc461e3[_0x2cbebb(0x179)][0x0][_0x2cbebb(0x24d)];_0xc461e3[_0x2cbebb(0x179)][0x0]['headless']=!_0x5e2ba0;const _0x3ca4ec=JSON['stringify'](_0xc461e3,null,0x2);fs[_0x2cbebb(0x239)](_0x314c8c,_0x3ca4ec),config=getConfiguration(),io['to'](_0x2cbebb(0x2f2))[_0x2cbebb(0x22e)](_0x2cbebb(0x155),config),broadcastToBots(_0x2cbebb(0x155),JSON[_0x2cbebb(0x2be)](config));}}function validateTelegram(_0x3ac992){const _0x3c91bf=_0x3865fb;if(_0x3ac992['from'][_0x3c91bf(0xf7)]!=settings[_0x3c91bf(0xef)]&&'@'+_0x3ac992[_0x3c91bf(0x218)][_0x3c91bf(0xf7)]!=settings[_0x3c91bf(0xef)]||_0x3ac992['chat']['id']!=settings['telegramChatId'])return sendTelegram(_0x3ac992['chat']['id'],_0x3c91bf(0x2c8),{'parse_mode':_0x3c91bf(0xeb)}),![];return!![];}async function initTelegram(){const _0x48b570=_0x3865fb;tgBot&&(await tgBot[_0x48b570(0x29a)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x48b570(0x26f)]);let _0x5dad05=_0x48b570(0x290);_0x5dad05+='\x0a',_0x5dad05+='/enable\x20-\x20enable\x20notifications\x0a',_0x5dad05+=_0x48b570(0x11a),_0x5dad05+=_0x48b570(0x17d),_0x5dad05+=_0x48b570(0x2b1),_0x5dad05+='/on\x20-\x20start\x20bot(s)\x0a',_0x5dad05+=_0x48b570(0x2f0),_0x5dad05+=_0x48b570(0x1e4),_0x5dad05+=_0x48b570(0x1c3),_0x5dad05+=_0x48b570(0x25c),_0x5dad05+=_0x48b570(0x299),_0x5dad05+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x5dad05+=_0x48b570(0x24c),_0x5dad05+=_0x48b570(0x10b),_0x5dad05+=_0x48b570(0x249),_0x5dad05+=_0x48b570(0x257),_0x5dad05+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x1d29a6='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x1d29a6+='\x0a',_0x1d29a6+=_0x5dad05,tgBot[_0x48b570(0x1ed)]((_0x5a2fb8,_0x4f5a73)=>{const _0x58c361=_0x48b570;logger[_0x58c361(0x23c)](getTimeStamp()+_0x58c361(0x190)),logger[_0x58c361(0x2da)]('Telegraf\x20error:',_0x5a2fb8);}),tgBot[_0x48b570(0x279)](async(_0x2470c5,_0x4e96ef)=>{const _0x380823=_0x48b570;if(settings['telegramChatId']||_0x2470c5[_0x380823(0x244)][_0x380823(0x10a)]['text']!=_0x380823(0x262)){if(!validateTelegram(_0x2470c5))return;}_0x4e96ef();}),tgBot['command'](_0x48b570(0x220),async _0x2e5692=>{const _0x36ee81=_0x48b570;if(_0x2e5692['from'][_0x36ee81(0xf7)]==settings['telegramUsername']||'@'+_0x2e5692[_0x36ee81(0x218)][_0x36ee81(0xf7)]==settings['telegramUsername']){if(!settings[_0x36ee81(0x121)])updateSetting(_0x36ee81(0x121),_0x2e5692[_0x36ee81(0x171)]['id']);else{if(!validateTelegram(_0x2e5692))return;}}else{if(!validateTelegram(_0x2e5692))return;}updateSetting(_0x36ee81(0x1f7),!![]),await sendTelegram(_0x2e5692[_0x36ee81(0x171)]['id'],_0x1d29a6);}),tgBot[_0x48b570(0x2bf)](_0x48b570(0x16d),async _0x4702fb=>{const _0x3cd411=_0x48b570;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x4702fb[_0x3cd411(0x171)]['id'],'Notifications\x20enabled');}),tgBot[_0x48b570(0x2bf)](_0x48b570(0x115),async _0x2e1824=>{const _0x2cf29c=_0x48b570;await sendTelegram(_0x2e1824['chat']['id'],_0x2cf29c(0x18f)),updateSetting(_0x2cf29c(0x1f7),![]);}),tgBot['command']('config',async _0x569fc6=>{const _0x15aadf=_0x48b570,_0x4a0e45=Markup[_0x15aadf(0x168)]([Markup[_0x15aadf(0x25f)][_0x15aadf(0x28f)](_0x15aadf(0xf8),_0x15aadf(0x1c0)),Markup[_0x15aadf(0x25f)][_0x15aadf(0x28f)](_0x15aadf(0x284),'config_alerts'),Markup[_0x15aadf(0x25f)]['callback'](_0x15aadf(0x15f),_0x15aadf(0x2de))]);_0x569fc6[_0x15aadf(0x1cd)](_0x15aadf(0x1b0),_0x4a0e45);}),tgBot['action']('config_orders',async _0x29937b=>{const _0x915e1=_0x48b570;_0x29937b[_0x915e1(0x207)](),updateSetting(_0x915e1(0x24a),_0x915e1(0x236)),updateSetting(_0x915e1(0x1f7),!![]),await sendTelegram(_0x29937b[_0x915e1(0x171)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot['action'](_0x48b570(0x28d),async _0x5d466a=>{const _0x4f24b6=_0x48b570;_0x5d466a[_0x4f24b6(0x207)](),updateSetting(_0x4f24b6(0x24a),'alerts'),updateSetting(_0x4f24b6(0x1f7),!![]),await sendTelegram(_0x5d466a['chat']['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x48b570(0x21a)]('config_all',async _0x483ceb=>{const _0x44ff85=_0x48b570;_0x483ceb[_0x44ff85(0x207)](),updateSetting(_0x44ff85(0x24a),_0x44ff85(0x1e2)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x483ceb['chat']['id'],_0x44ff85(0x23d));}),tgBot[_0x48b570(0x2bf)](_0x48b570(0x188),async _0x40634e=>{const _0x3e5d84=_0x48b570,_0x409fb0=getBotsWithMode();let _0x4020eb=_0x3e5d84(0x246);config[_0x3e5d84(0xec)](_0x1a42b8=>{const _0x5b60ea=_0x3e5d84,_0x5c2afd=_0x409fb0[_0x5b60ea(0x10c)](_0x1e02ab=>_0x1e02ab[_0x5b60ea(0x11c)]==_0x1a42b8[_0x5b60ea(0x11c)])['mode'];_0x4020eb+=_0x5b60ea(0x2f8)+_0x1a42b8[_0x5b60ea(0x11c)]+':\x20'+_0x1a42b8[_0x5b60ea(0x188)]+'\x20|\x20'+_0x5c2afd+'\x20|\x20'+_0x1a42b8[_0x5b60ea(0x274)]+'\x0a';}),_0x4020eb+='\x0a',_0x4020eb+=_0x3e5d84(0x2e0),_0x4020eb+=!settings[_0x3e5d84(0x1f7)]?_0x3e5d84(0x28c):_0x3e5d84(0x1ce),_0x4020eb+=settings['telegramEnabled']?settings[_0x3e5d84(0x24a)]=='all'?_0x3e5d84(0x1c8):_0x3e5d84(0x2ec)+settings[_0x3e5d84(0x24a)]+_0x3e5d84(0x184):'',await sendTelegram(_0x40634e[_0x3e5d84(0x171)]['id'],_0x4020eb,{'parse_mode':_0x3e5d84(0xeb)});}),tgBot[_0x48b570(0x2bf)](_0x48b570(0x2cf),async _0x1773f2=>{const _0xe60af4=_0x48b570,_0x79ca25=getEnabledBots();if(_0x79ca25[_0xe60af4(0x2c2)]==0x0)await sendTelegram(_0x1773f2['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x79ca25[_0xe60af4(0x2c2)]>0x1)_0x79ca25['push']({'botID':_0xe60af4(0x1e2)});let _0x40b82a=[],_0x3dd225=[];const _0x297c76=_0x79ca25[_0xe60af4(0x2c2)]%0x4==0x0||_0x79ca25[_0xe60af4(0x2c2)]%0x4==0x3||_0x79ca25['length']%0x3==0x1?0x4:0x3;let _0x389373=0x0;_0x79ca25[_0xe60af4(0xec)]((_0x2800d6,_0x10b382)=>{const _0x3a450a=_0xe60af4;if(_0x10b382%_0x297c76==0x0)_0x3dd225=[];_0x3dd225['push'](Markup[_0x3a450a(0x25f)]['callback'](_0x2800d6[_0x3a450a(0x11c)]=='all'?_0x3a450a(0x2b9):_0x3a450a(0x2f8)+_0x2800d6[_0x3a450a(0x11c)],_0x3a450a(0x1f1)+_0x2800d6['botID'])),_0x10b382%_0x297c76==0x0&&(_0x40b82a[_0x389373]=_0x3dd225,_0x389373++);});const _0x1617f4=Markup[_0xe60af4(0x168)](_0x40b82a);_0x1773f2['reply'](_0xe60af4(0x186),_0x1617f4);}}),tgBot[_0x48b570(0x21a)](/restart_(.+)/,async _0x34242f=>{const _0x28b3d2=_0x48b570,_0x217195=_0x34242f[_0x28b3d2(0xfe)][0x1];_0x34242f[_0x28b3d2(0x207)](),_0x217195=='all'?config[_0x28b3d2(0xec)](_0x1e6f70=>{const _0x46c92d=_0x28b3d2;restartBot(_0x1e6f70[_0x46c92d(0x11c)]);}):restartBot(_0x217195);}),tgBot[_0x48b570(0x2bf)]('on',async _0x223b17=>{const _0x2f125=_0x48b570,_0x1c4b2c=getDisabledBots();if(_0x1c4b2c['length']==0x0)await sendTelegram(_0x223b17[_0x2f125(0x171)]['id'],_0x2f125(0x2b5));else{if(_0x1c4b2c[_0x2f125(0x2c2)]>0x1)_0x1c4b2c[_0x2f125(0x264)]({'botID':'all'});let _0x47321a=[],_0x46528f=[];const _0x1fd2da=_0x1c4b2c[_0x2f125(0x2c2)]%0x4==0x0||_0x1c4b2c[_0x2f125(0x2c2)]%0x4==0x3||_0x1c4b2c[_0x2f125(0x2c2)]%0x3==0x1?0x4:0x3;let _0x902fcd=0x0;_0x1c4b2c['forEach']((_0xc87ac,_0x4ac36f)=>{const _0x1688bf=_0x2f125;if(_0x4ac36f%_0x1fd2da==0x0)_0x46528f=[];_0x46528f[_0x1688bf(0x264)](Markup['button']['callback'](_0xc87ac[_0x1688bf(0x11c)]==_0x1688bf(0x1e2)?_0x1688bf(0x2b9):_0x1688bf(0x2f8)+_0xc87ac['botID'],_0x1688bf(0x278)+_0xc87ac['botID'])),_0x4ac36f%_0x1fd2da==0x0&&(_0x47321a[_0x902fcd]=_0x46528f,_0x902fcd++);});const _0x21b34f=Markup[_0x2f125(0x168)](_0x47321a);_0x223b17[_0x2f125(0x1cd)](_0x2f125(0x2a2),_0x21b34f);}}),tgBot[_0x48b570(0x21a)](/on_(.+)/,async _0x24d951=>{const _0xd8b51b=_0x48b570,_0x1bc24a=_0x24d951[_0xd8b51b(0xfe)][0x1];_0x24d951[_0xd8b51b(0x207)]();if(_0x1bc24a==_0xd8b51b(0x1e2)){const _0x2cd493=getDisabledBots();await sendTelegram(_0x24d951[_0xd8b51b(0x171)]['id'],_0xd8b51b(0x129)),_0x2cd493[_0xd8b51b(0xec)](_0x4e1b4c=>{const _0x1f18e9=_0xd8b51b;if(_0x4e1b4c[_0x1f18e9(0x11c)]!='all')toggleBot(_0x4e1b4c[_0x1f18e9(0x11c)],toggleStatus(_0x4e1b4c[_0x1f18e9(0x11c)]),_0x1f18e9(0x19f));});}else await sendTelegram(_0x24d951['chat']['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x1bc24a),toggleBot(_0x1bc24a,toggleStatus(_0x1bc24a),'stopped');}),tgBot[_0x48b570(0x2bf)]('off',async _0x891109=>{const _0x35b2fe=_0x48b570,_0x8aeb41=getEnabledBots();if(_0x8aeb41['length']==0x0)await sendTelegram(_0x891109[_0x35b2fe(0x171)]['id'],_0x35b2fe(0xe0));else{if(_0x8aeb41[_0x35b2fe(0x2c2)]>0x1)_0x8aeb41[_0x35b2fe(0x264)]({'botID':_0x35b2fe(0x1e2)});let _0x15c260=[],_0x568ba5=[];const _0x362d74=_0x8aeb41[_0x35b2fe(0x2c2)]%0x4==0x0||_0x8aeb41[_0x35b2fe(0x2c2)]%0x4==0x3||_0x8aeb41[_0x35b2fe(0x2c2)]%0x3==0x1?0x4:0x3;let _0x58a19b=0x0;_0x8aeb41[_0x35b2fe(0xec)]((_0x16a652,_0x52b1d7)=>{const _0x4505aa=_0x35b2fe;if(_0x52b1d7%_0x362d74==0x0)_0x568ba5=[];_0x568ba5[_0x4505aa(0x264)](Markup[_0x4505aa(0x25f)][_0x4505aa(0x28f)](_0x16a652[_0x4505aa(0x11c)]=='all'?_0x4505aa(0x2b9):_0x4505aa(0x2f8)+_0x16a652[_0x4505aa(0x11c)],_0x4505aa(0x29c)+_0x16a652[_0x4505aa(0x11c)])),_0x52b1d7%_0x362d74==0x0&&(_0x15c260[_0x58a19b]=_0x568ba5,_0x58a19b++);});const _0x5d324f=Markup['inlineKeyboard'](_0x15c260);_0x891109[_0x35b2fe(0x1cd)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x5d324f);}}),tgBot['action'](/off_(.+)/,async _0x42df0e=>{const _0x55babc=_0x48b570,_0x3fdb4b=_0x42df0e[_0x55babc(0xfe)][0x1];_0x42df0e['editMessageReplyMarkup']();if(_0x3fdb4b==_0x55babc(0x1e2)){const _0x48014a=getEnabledBots();await sendTelegram(_0x42df0e[_0x55babc(0x171)]['id'],_0x55babc(0x1b8)),_0x48014a[_0x55babc(0xec)](_0x5de492=>{const _0xdd4710=_0x55babc;if(_0x5de492[_0xdd4710(0x11c)]!=_0xdd4710(0x1e2))toggleBot(_0x5de492[_0xdd4710(0x11c)],toggleStatus(_0x5de492['botID']),_0xdd4710(0x19f));});}else await sendTelegram(_0x42df0e['chat']['id'],_0x55babc(0x20b)+_0x3fdb4b),toggleBot(_0x3fdb4b,toggleStatus(_0x3fdb4b),'stopped');}),tgBot['command'](_0x48b570(0x29b),async _0x5ee939=>{const _0x325c6f=_0x48b570,_0x5aad8c=getEnabledBots();if(_0x5aad8c[_0x325c6f(0x2c2)]==0x0)await sendTelegram(_0x5ee939[_0x325c6f(0x171)]['id'],_0x325c6f(0xe0));else{if(_0x5aad8c[_0x325c6f(0x2c2)]>0x1){let _0x4de533=[],_0x2ed4b1=[];const _0x54388e=_0x5aad8c['length']%0x4==0x0||_0x5aad8c[_0x325c6f(0x2c2)]%0x4==0x3||_0x5aad8c[_0x325c6f(0x2c2)]%0x3==0x1?0x4:0x3;let _0x3e59ae=0x0;_0x5aad8c[_0x325c6f(0xec)]((_0x2027bf,_0x24b3bc)=>{const _0x559aa6=_0x325c6f;if(_0x24b3bc%_0x54388e==0x0)_0x2ed4b1=[];_0x2ed4b1[_0x559aa6(0x264)](Markup[_0x559aa6(0x25f)][_0x559aa6(0x28f)]('Bot\x20'+_0x2027bf[_0x559aa6(0x11c)],_0x559aa6(0x2fc)+_0x2027bf[_0x559aa6(0x11c)])),_0x24b3bc%_0x54388e==0x0&&(_0x4de533[_0x3e59ae]=_0x2ed4b1,_0x3e59ae++);});const _0xf55ad8=Markup[_0x325c6f(0x168)](_0x4de533);_0x5ee939[_0x325c6f(0x1cd)](_0x325c6f(0x251),_0xf55ad8);}else{const _0x17469f=_0x5aad8c[0x0][_0x325c6f(0x11c)];if(pid[_0x17469f])pid[_0x17469f]['send']({'function':_0x325c6f(0x2e9),'args':null});}}}),tgBot[_0x48b570(0x21a)](/metrics_(.+)/,async _0x5d1c6d=>{const _0x29e913=_0x48b570,_0x2d7072=_0x5d1c6d['match'][0x1];_0x5d1c6d[_0x29e913(0x207)]();if(pid[_0x2d7072])pid[_0x2d7072]['send']({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x48b570(0x2bf)]('portfolio',async _0xb2e2ca=>{const _0x3bc757=_0x48b570,_0x1f346f=getEnabledBots();if(_0x1f346f['length']==0x0)await sendTelegram(_0xb2e2ca[_0x3bc757(0x171)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1f346f['length']>0x1){let _0x1af47a=[],_0x55e11a=[];const _0x4d0c64=_0x1f346f[_0x3bc757(0x2c2)]%0x4==0x0||_0x1f346f[_0x3bc757(0x2c2)]%0x4==0x3||_0x1f346f[_0x3bc757(0x2c2)]%0x3==0x1?0x4:0x3;let _0x4d32e5=0x0;_0x1f346f[_0x3bc757(0xec)]((_0xdf001a,_0x1f7fec)=>{const _0x1ce92d=_0x3bc757;if(_0x1f7fec%_0x4d0c64==0x0)_0x55e11a=[];_0x55e11a['push'](Markup['button']['callback'](_0x1ce92d(0x2f8)+_0xdf001a[_0x1ce92d(0x11c)],_0x1ce92d(0x197)+_0xdf001a[_0x1ce92d(0x11c)])),_0x1f7fec%_0x4d0c64==0x0&&(_0x1af47a[_0x4d32e5]=_0x55e11a,_0x4d32e5++);});const _0x303021=Markup[_0x3bc757(0x168)](_0x1af47a);_0xb2e2ca[_0x3bc757(0x1cd)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x303021);}else{const _0xc73c34=_0x1f346f[0x0][_0x3bc757(0x11c)];if(pid[_0xc73c34])pid[_0xc73c34][_0x3bc757(0x1a7)]({'function':_0x3bc757(0x181),'args':null});}}}),tgBot[_0x48b570(0x21a)](/portfolio_(.+)/,async _0x26ebdd=>{const _0x21fabe=_0x48b570,_0x57eb0d=_0x26ebdd[_0x21fabe(0xfe)][0x1];_0x26ebdd[_0x21fabe(0x207)]();if(pid[_0x57eb0d])pid[_0x57eb0d][_0x21fabe(0x1a7)]({'function':_0x21fabe(0x181),'args':null});}),tgBot[_0x48b570(0x2bf)](_0x48b570(0x19d),async _0x11dd06=>{const _0xfb5895=_0x48b570,_0x16fdb9=_0xfb5895(0x19d);await zipFiles(_0x16fdb9);const _0x5544b0=zippath+(_0x16fdb9+_0xfb5895(0x1dd));_0x11dd06['replyWithDocument']({'source':_0x5544b0})[_0xfb5895(0x243)](()=>{})[_0xfb5895(0x1ed)](_0x52f555=>logger[_0xfb5895(0x2da)](_0xfb5895(0x169)+_0x16fdb9+_0xfb5895(0x130),_0x52f555));}),tgBot['command'](_0x48b570(0x164),async _0x84be34=>{const _0x399883=_0x48b570,_0x571e89='backup';await backupConfigFiles(),await zipFiles(_0x571e89);const _0x3e8468=zippath+(_0x571e89+_0x399883(0x1dd));_0x84be34['replyWithDocument']({'source':_0x3e8468})[_0x399883(0x243)](()=>{})[_0x399883(0x1ed)](_0x4f4ddc=>logger['debug'](_0x399883(0x169)+_0x571e89+_0x399883(0x130),_0x4f4ddc));}),tgBot[_0x48b570(0x2bf)](_0x48b570(0x244),async _0x24593a=>{const _0x131a01=_0x48b570;await getMessages();if(!updateAvailable)await sendTelegram(_0x24593a[_0x131a01(0x171)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x24593a[_0x131a01(0x171)]['id'],_0x131a01(0x291));else{const _0x39681d=Markup[_0x131a01(0x168)]([Markup[_0x131a01(0x25f)][_0x131a01(0x28f)](_0x131a01(0x21f),_0x131a01(0x1bc)),Markup['button'][_0x131a01(0x28f)]('No','update_no')]);_0x24593a['reply'](_0x131a01(0x266),_0x39681d);}}}),tgBot[_0x48b570(0x21a)](/update_(.+)/,async _0x1c13ff=>{const _0x5c45ef=_0x48b570,_0x46f788=_0x1c13ff[_0x5c45ef(0xfe)][0x1];_0x1c13ff[_0x5c45ef(0x207)](),_0x46f788==_0x5c45ef(0x16f)&&(await sendTelegram(_0x1c13ff[_0x5c45ef(0x171)]['id'],_0x5c45ef(0x160)),updateBB(_0x5c45ef(0x244))),_0x46f788=='no'&&await sendTelegram(_0x1c13ff['chat']['id'],_0x5c45ef(0x12b));}),tgBot[_0x48b570(0x2bf)](_0x48b570(0x109),async _0x526849=>{const _0x31c5af=_0x48b570;if(!validInstallation)await sendTelegram(_0x526849[_0x31c5af(0x171)]['id'],_0x31c5af(0xe3));else{const _0x1facfa=Markup[_0x31c5af(0x168)]([Markup[_0x31c5af(0x25f)]['callback'](_0x31c5af(0x21f),_0x31c5af(0x177)),Markup[_0x31c5af(0x25f)][_0x31c5af(0x28f)]('No',_0x31c5af(0x2d6))]);_0x526849[_0x31c5af(0x1cd)](_0x31c5af(0x1b6),_0x1facfa);}}),tgBot[_0x48b570(0x21a)](/reinstall_(.+)/,async _0x171edc=>{const _0x47ee52=_0x48b570,_0x37df71=_0x171edc[_0x47ee52(0xfe)][0x1];_0x171edc[_0x47ee52(0x207)](),_0x37df71==_0x47ee52(0x16f)&&(await sendTelegram(_0x171edc[_0x47ee52(0x171)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x47ee52(0x109))),_0x37df71=='no'&&await sendTelegram(_0x171edc['chat']['id'],_0x47ee52(0x15c));}),tgBot['command'](_0x48b570(0x103),async _0x473a50=>{const _0x29150c=_0x48b570,_0x2831c5=getBotsWithMode();if(_0x2831c5[_0x29150c(0x2c2)]==0x0)await sendTelegram(_0x473a50['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x7ee561=[],_0x548b74=[];const _0x1da1b5=0x2;let _0x37f5be=0x0;_0x2831c5[_0x29150c(0xec)]((_0x11bdd0,_0x24c50c)=>{const _0x51325b=_0x29150c;if(_0x24c50c%_0x1da1b5==0x0)_0x548b74=[];_0x548b74['push'](Markup['button'][_0x51325b(0x28f)](_0x51325b(0x2f8)+_0x11bdd0[_0x51325b(0x11c)]+'\x20('+_0x11bdd0['mode']+')',_0x51325b(0x280)+_0x11bdd0[_0x51325b(0x11c)])),_0x24c50c%_0x1da1b5==0x0&&(_0x7ee561[_0x37f5be]=_0x548b74,_0x37f5be++);});const _0x603547=Markup[_0x29150c(0x168)](_0x7ee561);_0x473a50[_0x29150c(0x1cd)](_0x29150c(0x196),_0x603547);}}),tgBot[_0x48b570(0x21a)](/toggle_(.+)/,async _0x2157fb=>{const _0x48e8ac=_0x48b570,_0x31c57b=_0x2157fb['match'][0x1];_0x2157fb['editMessageReplyMarkup']();const _0x4f2ea7=getBotsWithMode(),_0x46072c=_0x4f2ea7[_0x48e8ac(0x10c)](_0x54f032=>_0x54f032[_0x48e8ac(0x11c)]==_0x31c57b),_0x5a7c5f=_0x46072c[_0x48e8ac(0x198)]==_0x48e8ac(0x1f0)?_0x48e8ac(0xe7):_0x48e8ac(0x1f0);await sendTelegram(_0x2157fb[_0x48e8ac(0x171)]['id'],_0x48e8ac(0x1c7)+_0x31c57b+_0x48e8ac(0x1ac)+_0x5a7c5f+_0x48e8ac(0x1e3)),toggleBotMode(_0x31c57b);}),tgBot[_0x48b570(0x2bf)]('names',async _0x31ce27=>{let _0x57aa91='';config['forEach'](_0x1091f8=>{const _0x19221d=_0x1d6d;_0x57aa91+=_0x19221d(0x2f8)+_0x1091f8['botID']+':\x20'+_0x1091f8[_0x19221d(0x2bb)]+'\x0a';}),await sendTelegram(_0x31ce27['chat']['id'],_0x57aa91,{'parse_mode':'HTML'});}),tgBot[_0x48b570(0x2bf)](_0x48b570(0x1cf),async _0xaf0b2c=>{const _0x2ef650=_0x48b570;await sendTelegram(_0xaf0b2c[_0x2ef650(0x171)]['id'],_0x5dad05);}),process['once'](_0x48b570(0xe2),()=>tgBot[_0x48b570(0x29a)](_0x48b570(0xe2))),process[_0x48b570(0x29d)](_0x48b570(0x104),()=>tgBot['stop'](_0x48b570(0x104))),tgBot[_0x48b570(0x1a5)]();}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x541584,_0x38e290,_0x29f09f){const _0x32a30c=_0x3865fb;_0x29f09f={..._0x29f09f,'disable_web_page_preview':!![]};try{await tgBot[_0x32a30c(0x2fb)][_0x32a30c(0x1d3)](_0x541584,_0x38e290,_0x29f09f);}catch(_0x53514f){logger[_0x32a30c(0x2da)](_0x32a30c(0x26e),_0x53514f);}}async function sendTelegramBot(_0x2b3366,_0x334a0b){const _0x565eaa=_0x3865fb;if(settings[_0x565eaa(0x1f7)]){if(settings['telegramEvents']==_0x565eaa(0x1e2)||(_0x334a0b[_0x565eaa(0x1d9)]==_0x565eaa(0x1cc)||_0x334a0b[_0x565eaa(0x1d9)]==_0x565eaa(0x273)||_0x334a0b[_0x565eaa(0x1d9)]=='success')&&settings[_0x565eaa(0x24a)]==_0x565eaa(0x2f6)||_0x334a0b[_0x565eaa(0x1d9)]==_0x565eaa(0x182)&&settings['telegramEvents']==_0x565eaa(0x236)){if(tgBot&&settings[_0x565eaa(0x121)]){if(_0x334a0b[_0x565eaa(0x17c)])await sendTelegram(settings[_0x565eaa(0x121)],_0x334a0b[_0x565eaa(0x2bb)]+'\x20>\x20'+_0x334a0b[_0x565eaa(0x271)]);else await sendTelegram(settings[_0x565eaa(0x121)],_0x565eaa(0x2f8)+_0x2b3366+'\x20>\x20'+_0x334a0b[_0x565eaa(0x271)]);}}}}async function sendTelegramMsg(_0x1b308f,_0xe0037=_0x3865fb(0xeb)){const _0x3a1ac8=_0x3865fb;return settings[_0x3a1ac8(0x1f7)]&&tgBot&&settings[_0x3a1ac8(0x121)]?(await sendTelegram(settings[_0x3a1ac8(0x121)],_0x1b308f,{'parse_mode':_0xe0037}),!![]):![];}function getDeviceWithIp(_0x4f4d6a){const _0x15d0cb=_0x3865fb;return devices[_0x15d0cb(0x10c)](_0x375e52=>_0x375e52['ip']===_0x4f4d6a);}async function temporaryAccess2FA(_0xff6d81,_0xb06aea){const _0x7a65af=_0x3865fb;let _0xedce13=new Date(),_0xebbe66=![];if(lastIpApproval){if(_0xedce13-lastIpApproval<0x1388)_0xebbe66=!![];}lastIpApproval=new Date();if(_0xebbe66)return;if(tgBot&&settings['telegramChatId']){const _0x3d4a6a=uuidRandom();tmpStorage[_0x3d4a6a]={'uuid':_0xff6d81,'externalip':_0xb06aea};const _0x2b02a9=Markup['inlineKeyboard']([Markup[_0x7a65af(0x25f)][_0x7a65af(0x28f)](_0x7a65af(0x1e9),_0x7a65af(0x223)+_0x3d4a6a),Markup['button'][_0x7a65af(0x28f)]('15\x20min',_0x7a65af(0x1bf)+_0x3d4a6a),Markup['button'][_0x7a65af(0x28f)](_0x7a65af(0x295),_0x7a65af(0x235)+_0x3d4a6a),Markup[_0x7a65af(0x25f)][_0x7a65af(0x28f)](_0x7a65af(0x137),_0x7a65af(0x1e8)+_0x3d4a6a)]);await sendTelegram(settings[_0x7a65af(0x121)],_0x7a65af(0x219)+normalizeIP(_0xb06aea)['show']+'\x20?',_0x2b02a9),tgBot[_0x7a65af(0x21a)](/tempaccess_(.+)_(.+)/,async _0x4a7264=>{const _0x58b786=_0x7a65af,_0x33fc9f=_0x4a7264['match'][0x1],_0xcaa392=_0x4a7264[_0x58b786(0xfe)][0x2],{uuid:_0x3f8877,externalip:_0xb68bb8}=tmpStorage[_0xcaa392];delete tmpStorage[_0xcaa392],_0x4a7264[_0x58b786(0x207)](),devices[_0x3f8877][_0x58b786(0x212)]={'clientip':_0xb68bb8,'timestamp':new Date()[_0x58b786(0x215)](),'expiry':_0x33fc9f},_0x33fc9f!=_0x58b786(0x137)?(await sendTelegram(_0x4a7264[_0x58b786(0x171)]['id'],_0x58b786(0x211)+_0x33fc9f+_0x58b786(0x263),{'parse_mode':_0x58b786(0xeb)}),io['to'](_0x3f8877)[_0x58b786(0x22e)](_0x58b786(0x188),{'access':{'allow':![],'reason':_0x58b786(0x27c),'token':null}})):(await sendTelegram(_0x4a7264['chat']['id'],'Temporary\x20access\x20rejected'),io['to'](_0x3f8877)['emit'](_0x58b786(0x188),{'access':{'allow':![],'reason':_0x58b786(0x176),'token':null}}));});}}async function loginAccess2FA(_0x46d522,_0x26f03e){const _0x57c59e=_0x3865fb;if(tgBot&&settings[_0x57c59e(0x121)]){const _0x6e9bc9=uuidRandom();tmpStorage[_0x6e9bc9]={'uuid':_0x46d522,'externalip':_0x26f03e};const _0x4723eb=Markup[_0x57c59e(0x168)]([Markup[_0x57c59e(0x25f)][_0x57c59e(0x28f)](_0x57c59e(0xf0),_0x57c59e(0x136)+loginExpiry+'_'+_0x6e9bc9),Markup[_0x57c59e(0x25f)][_0x57c59e(0x28f)](_0x57c59e(0x137),'login2fa_reject_'+_0x6e9bc9)]);await sendTelegram(settings[_0x57c59e(0x121)],_0x57c59e(0x14f)+normalizeIP(_0x26f03e)[_0x57c59e(0x25e)]+'\x20?',_0x4723eb),tgBot[_0x57c59e(0x21a)](/login2fa_(.+)_(.+)/,async _0x2d13a0=>{const _0x37a688=_0x57c59e,_0x51cf89=_0x2d13a0[_0x37a688(0xfe)][0x1],_0x1dab16=_0x2d13a0[_0x37a688(0xfe)][0x2],{uuid:_0x10da3b,externalip:_0x45cff2}=tmpStorage[_0x1dab16];delete tmpStorage[_0x1dab16],_0x2d13a0[_0x37a688(0x207)](),devices[_0x10da3b][_0x37a688(0x11f)]={'clientip':_0x45cff2,'timestamp':new Date()[_0x37a688(0x215)](),'expiry':_0x51cf89},_0x51cf89!=_0x37a688(0x137)?(await sendTelegram(_0x2d13a0[_0x37a688(0x171)]['id'],_0x37a688(0x10e),{'parse_mode':_0x37a688(0xeb)}),io['to'](_0x10da3b)[_0x37a688(0x22e)](_0x37a688(0x188),{'access':{'allow':![],'reason':_0x37a688(0x27c),'token':null}})):(await sendTelegram(_0x2d13a0[_0x37a688(0x171)]['id'],_0x37a688(0x114)),io['to'](_0x10da3b)[_0x37a688(0x22e)]('status',{'access':{'allow':![],'reason':_0x37a688(0xe9),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2a06c7=_0x3865fb;return dbConfig['get'](_0x2a06c7(0x155))[_0x2a06c7(0x138)](_0x2a06c7(0x11c))[_0x2a06c7(0x1fe)]({'status':_0x2a06c7(0x285)})[_0x2a06c7(0x2a3)]()||[];}function _0x1fef(){const _0x50590b=['simple','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','login\x20token\x20generated','Bot\x20Mgr\x20>\x20','getMinutes','join','bot-','then','update','binary','<b>Balance\x20Bot\x20Status:</b>\x0a','telegrammsg','allow','/update\x20-\x20update\x20Balance\x20Bot\x0a','telegramEvents','output-002.log','/logs\x20-\x20receive\x20log\x20files\x0a','headless','axios','remove','connected','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','uncaughtException','node','socket','defaults','-results.json','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','server','(staging)','build','--------------------------------------','/status\x20-\x20show\x20bot(s)\x20status\x0a','\x1b[36m','show','button','Backup\x20file\x20uploaded','backup-full','/start','\x20minutes','push','store-headless','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','resetpw_yes','\x1b[34m','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','unlinkSync','-----------------------------------------------------------------------------------','Telegram\x20error:','telegramToken','-config.json','event','#RES#\x20if\x20running\x20locally\x0a','warning','live','max','headers','Unauthorized\x20attempt\x20to\x20show\x20configuration','on_','use','timeshift','backup/','reload','hashSync','clientip','Error\x20while\x20deleting\x20config\x20files:\x20','toggle_','-events.json','Logged\x20in\x20user\x20...','(((.+)+)+)+$','Alerts','enabled','lastmsgtelegram','http','family','function','config/','getStartingBalances','Notifications\x20disabled\x0a','config_alerts','logged\x20out','callback','You\x20can\x20use\x20the\x20following\x20commands:\x0a','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Restore\x20process\x20confirmed','child_process','getHours','30\x20min','output-001.log','\x1b[33m','index.html','/metrics\x20-\x20show\x20bot\x20performance\x0a','stop','metrics','off_','once','randomFillSync','min','/:bot/portfolio','Token\x20blacklisted','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','value','Error\x20removing\x20old\x20backup\x20files:','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','express','/download/:type','kill','login\x20required','createWriteStream','sha256','Starting\x20#RED#Balance\x20Bot\x20v','temporary\x20token\x20generated','slice','port','Restore\x20process\x20aborted','/restart\x20-\x20restart\x20bot(s)\x0a','exit','login','zip/','All\x20bots\x20running\x20right\x20now','fork','login\x20token\x20valid','$1_$2_$3','All\x20bots','get-backup-files','botname','close','hasOwnProperty','stringify','command','Unauthorized\x20attempt\x20to\x20download\x20','File\x20uploaded','length','internal','Unauthorized\x20attempt\x20to\x20update\x20settings','2FA\x20login\x20token\x20generated','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Unauthorized\x20attempt\x20to\x20delete\x20bot','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','/:bot/support','emitHistory','ipv6','toggleBotMode',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','bbvReceive','restart','/output-000.log','exp','lowdb','split','sign','/:bot','reinstall_no','download','socket.io','/:bot/performance','debug','store-settings','Markdown','2FA','config_all','6b67f3d61ee94b8f5c80b4affef4c4d9','<b>Telegram\x20Bot\x20Status:</b>\x0a','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','toIPv4Address','getPortfolio','toIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20log\x20out','hex','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','parse','sendMetricsTelegram','updatebotmanager','settings.','Notifications\x20types:\x20','toString','password','expiry','/off\x20-\x20stop\x20bot(s)\x0a','88809sWeHps','botmanager','isValid','get-messages','messages','alerts','temp/','Bot\x20','getMonth','798437kxfBce','telegram','metrics_','bbvNew','No\x20bots\x20running\x20right\x20now','Password\x20has\x20been\x20reset\x20to:\x20','SIGINT','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','showConfig','Setting\x20access:\x20','production','manual','write','2FA\x20login\x20rejected','new','HTML','forEach','secret','#RES#','telegramUsername','accept','Logged\x20out\x20user\x20...','latestversion','Unauthorized\x20attempt\x20to\x20update\x20bot','store-configuration','clients','apply','username','Orders','output-000.log','host','logs/','format','Unauthorized\x20attempt\x20to\x20get\x20events','match','versions','Error:\x20Invalid\x20argument\x20','ipc',',\x20must\x20be\x20a\x204\x20digit\x20number','toggle','SIGTERM','update-bb','bbUsername','search','readFileSync','reinstall','message','/backup\x20-\x20receive\x20backup\x20files\x0a','find','Error\x20details:','Login\x20accepted','address','auth','/:bot/history','mkdirSync','72hoYwRx','Login\x20rejected','disable','new-disabled','\x20-\x20','update-bot','isIPv4MappedAddress','/disable\x20-\x20disable\x20notifications\x0a','replace','botID','Unauthorized\x20attempt\x20to\x20delete\x20alerts','marketcapApi','telegram2FaApproval','create','telegramChatId','************','27970PYWXZw','pidRefreshToken','[ip-address]','graphql-request','onepagemode','Starting\x20(','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Unauthorized\x20login\x20attempt\x20(timeout)','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','access\x20timeout','keys','decrypt','***','\x20files\x20over\x20Telegram:','crypto','referer','Invalid\x20IP\x20address','store-fiat','disconnect','login2fa_','reject','sortBy','existsSync','#RES#\x20','|@|','NTBA_FIX_319','getSeconds','handshake','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','Restarting\x20Bot\x20','path','notification','f2aRequired','staging','disabled','randomBytes','\x20(1)','storeFiat','83728aDcHaH','1110420PYXLnB','Starting\x20new\x20bot\x20|\x20Bot\x20','lowdb/adapters/FileSync','settings','conn','Allow\x20login\x20from\x20IP\x20address\x20',')\x20\x20\x20|\x20Bot\x20','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','temporaryAccessAllowed','padStart','bots','lastmsgemitted','code','exchange','privateKey','backup-files','argv','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','getFullYear','remoteAddress','All','Starting\x20Balance\x20Bot\x20update','map','request','-performance.json','backup','toggle-bot-mode','jsonwebtoken','pki','inlineKeyboard','Error\x20sending\x20','encryptedUuid','\x20|\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','enable','api-eu.mixpanel.com','yes','init','chat','bb-config.json','::1','place-order','temporary\x20access\x20timeout','temporary\x20access\x20rejected','reinstall_yes','userid','bot','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','data','showname','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','params','sort','access','sendPortfolioTelegram','order','deleteHistoryAlerts','\x20only\x0a','Backup\x20file\x20unzipped\x20and\x20stored','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Server','status','Unauthorized\x20attempt\x20to\x20confirm\x20message','Password\x20reset\x20rejected','backup-full@','readdirSync','telegraf','delete-bot','Notifications\x20disabled',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','=>\x20Go\x20to\x20#CYA#http://','bb-settings.json','2FA\x20login\x20required','user','Invalid\x20authentication\x20token\x20(1)','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','portfolio_','mode','\x1b[0m','get-portfolio','set','generateKeyPair','logs','_nsps','stopped','bbPassword','blacklist','publicKeyToPem','get','constructor','launch','ipaddr.js','send','8993334rwKCWI','removeAllListeners','cloneDeep','BCT','\x20to\x20','storeConfiguration','generateAsync','decode64','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','cancel-loading','User\x20has\x20been\x20validated','token','async','Unauthorized\x20attempt\x20to\x20get\x20messages','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','copyFileSync','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','login\x20not\x20required','2FA\x20required','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','update_yes','pidExpireLogin','build2','tempaccess_15_','config_orders','3000','uuid-random','/names\x20-\x20show\x20bot\x20names\x0a','sockets','Unauthorized\x20attempt\x20to\x20add\x20bot','bot.js','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','status\x20code\x20401','uuid','rmSync','error','reply','Notifications\x20enabled\x0a','help','confirm-message','version','name','sendMessage','Invalid\x20username\x20or\x20IP\x20address','date-fns','bcryptjs','string','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','type','started','Network\x20Interfaces:','timestamp','.zip','store','includes','private','running','all','\x20mode','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','any','success','RSA-OAEP','tempaccess_reject_','5\x20min','loginRequired','3147954lgYuxv','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','catch','entries',':\x20Bot\x20Mgr\x20>\x20','auto','restart_','Invalid\x20authentication\x20token\x20(2)','1000','https://api.ipify.org?format=json','Failed\x20to\x20download\x20','show-config','telegramEnabled','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','version.json','/:bot/coins','publicKey','get-logs','verify','filter','file','log','Disabled\x20Bot\x20','tkn','initclient','Deleted\x20Bot\x20','\x20|\x20user:\x20...','84EReCmE','editMessageReplyMarkup','117MjpyPZ','privateKeyFromPem','apiKey','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','number','Restoring\x20bot(s)\x20from\x20backup','createServer','full','temporary\x20access\x20not\x20allowed','Access\x20enabled\x20for\x20','telegramIpApproval','util','assign','getTime','secure','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','from','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','action','endsWith','#RES#\x20if\x20running\x20on\x20server','files','startsWith','Yes','start','apiSecret','\x20(2)','tempaccess_5_','bb-secure.json','add','reason','output-003.log','apiPassword','whitelistEnabled','test','sendFile','getDate','placeOrder','emit','Session\x20expired\x20for\x20user\x20...','listen','inherit','resetHistory','Enabled\x20Bot\x20','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','tempaccess_30_','orders','Node.js\x20v','invalid\x20credentials','writeFileSync','mixpanel','isDirectory'];_0x1fef=function(){return _0x50590b;};return _0x1fef();}function getDisabledBots(){const _0x15c011=_0x3865fb;return dbConfig[_0x15c011(0x1a3)](_0x15c011(0x155))['sortBy']('botID')[_0x15c011(0x1fe)]({'status':_0x15c011(0x145)})['value']()||[];}function getBotAttributes(_0x559483){const _0x2c6f14=_0x3865fb;let _0x413f62={};const _0x227794=configpath+'bot-'+_0x559483+_0x2c6f14(0x270),_0x329b7f=fs['existsSync'](_0x227794);if(_0x329b7f){const _0x251c2a=fs[_0x2c6f14(0x108)](_0x227794);try{const _0x57f7b0=JSON[_0x2c6f14(0x2e8)](_0x251c2a),_0x4717e3=_0x57f7b0?_0x57f7b0[_0x2c6f14(0x179)][0x0][_0x2c6f14(0x24d)]:![];_0x413f62[_0x2c6f14(0x198)]=_0x4717e3?_0x2c6f14(0x1f0):'manual',_0x413f62[_0x2c6f14(0x2bb)]=_0x57f7b0?_0x57f7b0[_0x2c6f14(0x179)][0x0][_0x2c6f14(0x2bb)]:_0x2c6f14(0x2f8)+_0x559483;}catch(_0x49ca08){_0x413f62['mode']='manual',_0x413f62['botname']=_0x2c6f14(0x2f8)+_0x559483;}}else _0x413f62['mode']=_0x2c6f14(0xe7),_0x413f62[_0x2c6f14(0x2bb)]=_0x2c6f14(0x2f8)+_0x559483;return _0x413f62;}function getBotsWithMode(){const _0x4c7f3e=_0x3865fb,_0x5cbec0=dbConfig[_0x4c7f3e(0x1a3)](_0x4c7f3e(0x155))['sortBy'](_0x4c7f3e(0x11c))[_0x4c7f3e(0x2a3)]()||[];return _0x5cbec0['forEach'](_0xe4ce6c=>{const _0x5d52d1=_0x4c7f3e;let _0xbb164b=getBotAttributes(_0xe4ce6c[_0x5d52d1(0x11c)]);_0xe4ce6c[_0x5d52d1(0x198)]=_0xbb164b[_0x5d52d1(0x198)];}),_0x5cbec0;}function getBotExchanges(){const _0x1e8da9=_0x3865fb;let _0x26fb71=[];const _0x35754e=dbConfig[_0x1e8da9(0x1a3)]('bots')[_0x1e8da9(0x138)](_0x1e8da9(0x11c))[_0x1e8da9(0x2a3)]()||[];_0x35754e[_0x1e8da9(0xec)](_0x103c5f=>{const _0x14f9f8=_0x1e8da9;if(_0x103c5f['status']==_0x14f9f8(0x285)){const _0x21f8ad=configpath+_0x14f9f8(0x242)+_0x103c5f[_0x14f9f8(0x11c)]+_0x14f9f8(0x270),_0xf4b90=fs[_0x14f9f8(0x139)](_0x21f8ad);let _0x124292;if(_0xf4b90){const _0xfad861=fs['readFileSync'](_0x21f8ad);try{const _0x82118d=JSON[_0x14f9f8(0x2e8)](_0xfad861);_0x124292=_0x82118d?_0x82118d[_0x14f9f8(0x179)][0x0][_0x14f9f8(0x158)]:null;}catch(_0x3de650){}}if(_0x124292)_0x26fb71[_0x14f9f8(0x264)](_0x124292);}});const _0x55bcd9=[...new Set(_0x26fb71)][_0x1e8da9(0x17f)]();return _0x55bcd9;}async function initUser(){const _0x3556bc=_0x3865fb;if(!settings[_0x3556bc(0x178)]){const _0x3fa769=uuidRandom();mixpanel['alias'](_0x3fa769),updateSetting(_0x3556bc(0x178),_0x3fa769);}}async function initSecure(){const _0x2558f3=_0x3865fb;let _0x2de320=getSecure();if(!_0x2de320[_0x2558f3(0x2bd)](_0x2558f3(0xed))){let _0x2895d9=await generateKeys();_0x2de320[_0x2558f3(0x1fb)]=_0x2895d9[_0x2558f3(0x1fb)],_0x2de320[_0x2558f3(0x159)]=_0x2895d9['privateKey'],_0x2de320[_0x2558f3(0xed)]=crypto[_0x2558f3(0x146)](0x20)[_0x2558f3(0x2ed)](_0x2558f3(0x2e6));;storeSecure(_0x2de320);}}function getSettings(){const _0xa81290=_0x3865fb;return dbSettings['get'](_0xa81290(0x14d))[_0xa81290(0x2a3)]()||{};}function getSecure(){const _0x47a505=_0x3865fb;return dbSecure[_0x47a505(0x1a3)](_0x47a505(0x216))[_0x47a505(0x2a3)]()||{};}function getBlacklist(){const _0x3556d9=_0x3865fb;return dbSecure[_0x3556d9(0x1a3)](_0x3556d9(0x1a1))[_0x3556d9(0x2a3)]()||[];}function broadcastToBots(_0x175373,_0x3b9bb0){config['forEach'](_0x2830e8=>{const _0x1cb10d=_0x1d6d;if(_0x2830e8['status']==_0x1cb10d(0x285)&&_0x2830e8[_0x1cb10d(0x274)]==_0x1cb10d(0x1e1)||_0x2830e8[_0x1cb10d(0x188)]==_0x1cb10d(0xea)&&_0x2830e8[_0x1cb10d(0x274)]==_0x1cb10d(0x1e1)){if(pid[_0x2830e8[_0x1cb10d(0x11c)]])pid[_0x2830e8[_0x1cb10d(0x11c)]][_0x1cb10d(0x1a7)]({[_0x175373]:_0x3b9bb0});}});}async function storeSettings(_0x4e29c1,_0x38a687=![]){const _0x544eb6=_0x3865fb;_0x4e29c1={...settings,..._0x4e29c1};if(_0x38a687&&_0x4e29c1[_0x544eb6(0x1a0)]!=_0x544eb6(0x122)&&_0x4e29c1['bbPassword']!=_0x544eb6(0x12f)&&_0x4e29c1[_0x544eb6(0x1a0)]!=''){const _0x54e2bc=decryptRSA(secure[_0x544eb6(0x159)],_0x4e29c1[_0x544eb6(0x1a0)])[_0x544eb6(0x2d3)](_0x544eb6(0x13b))[0x0],_0x1b978b=bcrypt[_0x544eb6(0x27d)](_0x54e2bc,saltRounds);_0x4e29c1={..._0x4e29c1,'bbPassword':_0x1b978b};}if(_0x38a687&&_0x4e29c1['telegramToken']!='************'&&_0x4e29c1[_0x544eb6(0x26f)]!=_0x544eb6(0x12f)&&_0x4e29c1[_0x544eb6(0x26f)]!=''){const _0x4b1c4c=decryptRSA(secure[_0x544eb6(0x159)],_0x4e29c1['telegramToken'])[_0x544eb6(0x2d3)](_0x544eb6(0x13b))[0x0];_0x4e29c1={..._0x4e29c1,'telegramToken':_0x4b1c4c};}if(_0x38a687&&_0x4e29c1[_0x544eb6(0x11e)]!='************'&&_0x4e29c1['marketcapApi']!=_0x544eb6(0x12f)&&_0x4e29c1['marketcapApi']!=''){const _0x31b5d0=decryptRSA(secure['privateKey'],_0x4e29c1[_0x544eb6(0x11e)])[_0x544eb6(0x2d3)](_0x544eb6(0x13b))[0x0];_0x4e29c1={..._0x4e29c1,'marketcapApi':_0x31b5d0};}const _0x2a3948=_0x4e29c1[_0x544eb6(0x26f)]!='************'&&_0x4e29c1[_0x544eb6(0x26f)]!=settings[_0x544eb6(0x26f)]||_0x4e29c1[_0x544eb6(0xef)]!=settings[_0x544eb6(0xef)],_0xd63611=_0x4e29c1['telegramToken']==''||_0x4e29c1[_0x544eb6(0xef)]=='',_0x53cc49=_0x4e29c1[_0x544eb6(0x11e)]&&_0x4e29c1[_0x544eb6(0x11e)]!=_0x544eb6(0x122)&&_0x4e29c1[_0x544eb6(0x11e)]!=settings[_0x544eb6(0x11e)];_0x2a3948&&(_0x4e29c1[_0x544eb6(0x121)]=null,_0x4e29c1['telegramEvents']=_0x544eb6(0x1e2));for(const [_0x83533b,_0x45fb94]of Object[_0x544eb6(0x1ee)](_0x4e29c1)){if(_0x83533b==_0x544eb6(0x26f)&&_0x45fb94==_0x544eb6(0x122)){_0x4e29c1[_0x544eb6(0x26f)]=settings[_0x544eb6(0x26f)];continue;};if(_0x83533b=='bbPassword'&&_0x45fb94=='************'){_0x4e29c1[_0x544eb6(0x1a0)]=settings[_0x544eb6(0x1a0)];continue;};if(_0x83533b=='marketcapApi'&&_0x45fb94==_0x544eb6(0x122)){_0x4e29c1[_0x544eb6(0x11e)]=settings[_0x544eb6(0x11e)];continue;};dbSettings[_0x544eb6(0x19b)](_0x544eb6(0x2eb)+_0x83533b,_0x45fb94)[_0x544eb6(0xe8)]();}settings=_0x4e29c1,io['to'](_0x544eb6(0x2f2))['emit'](_0x544eb6(0x14d),cleanSettings()),broadcastToBots(_0x544eb6(0x27a),settings[_0x544eb6(0x27a)]),broadcastToBots(_0x544eb6(0x127),settings[_0x544eb6(0x127)]),broadcastToBots(_0x544eb6(0x11e),settings[_0x544eb6(0x11e)]);if(_0x2a3948&&!_0xd63611)initTelegram();_0x2a3948&&_0xd63611&&(updateSetting(_0x544eb6(0x121),null),disableTelegram()),getAllClients()[_0x544eb6(0xec)](_0x307b1c=>{const _0x56ecf1=_0x544eb6;getSocket(_0x307b1c['id'])['emit']('status',{'access':{'allow':![],'reason':_0x56ecf1(0x27c),'token':null}});}),_0x53cc49&&(await sleep(0xbb8),testMarketcapApi(_0x4e29c1[_0x544eb6(0x11e)]));}async function testMarketcapApi(_0xdf7ced){const _0x43a255=_0x3865fb,_0x324064=[_0x43a255(0x1ab),'ETH'];try{await axios['get'](_0x43a255(0x17a),{'headers':{'X-CMC_PRO_API_KEY':_0xdf7ced},'params':{'symbol':_0x324064[_0x43a255(0x2ed)]()}});}catch(_0x44d6fd){_0x44d6fd[_0x43a255(0x2ed)]()['includes'](_0x43a255(0x1c9))?(io['to'](_0x43a255(0x2f2))[_0x43a255(0x22e)](_0x43a255(0x142),_0x43a255(0x13f)),logger['full'](_0x43a255(0x13f))):(io['to'](_0x43a255(0x2f2))[_0x43a255(0x22e)](_0x43a255(0x142),'CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x43a255(0x20f)](_0x43a255(0x217)),logger[_0x43a255(0x2da)](_0x43a255(0x10d),_0x44d6fd['toString']()+_0x43a255(0x117)+_0x44d6fd[_0x43a255(0x157)]));return;}logger[_0x43a255(0x2da)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x3b0bb8,_0x2120f0){const _0x48c0a0=_0x3865fb;dbSettings['set'](_0x48c0a0(0x2eb)+_0x3b0bb8,_0x2120f0)[_0x48c0a0(0xe8)](),settings=getSettings(),io['to']('botmanager')[_0x48c0a0(0x22e)]('settings',cleanSettings());}function storeSecure(_0x266be5){const _0x24fa69=_0x3865fb;dbSecure[_0x24fa69(0x1a3)](_0x24fa69(0x216))['push'](_0x266be5)[_0x24fa69(0xe8)](),secure=_0x266be5;}function addBlacklist(_0x4a5da7){const _0xdc54a=_0x3865fb;cleanBlacklist();let _0x4d8833;devices[_0x4a5da7][_0xdc54a(0x212)]?_0x4d8833=Math[_0xdc54a(0x275)](devices[_0x4a5da7][_0xdc54a(0x212)]['expiry'],loginExpiry):_0x4d8833=loginExpiry,dbSecure[_0xdc54a(0x1a3)](_0xdc54a(0x1a1))['push']({'expiry':new Date()[_0xdc54a(0x215)]()+_0x4d8833*0x3c*0x3e8,'token':devices[_0x4a5da7]['access'][_0xdc54a(0x1b3)]})[_0xdc54a(0xe8)](),blacklist=dbSecure['get'](_0xdc54a(0x1a1))['value']();}function cleanBlacklist(){const _0x4f326d=_0x3865fb;let _0xd78861=dbSecure[_0x4f326d(0x1a3)](_0x4f326d(0x1a1))[_0x4f326d(0x1aa)]()['value'](),_0x21df3a=new Date()[_0x4f326d(0x215)]();_0xd78861[_0x4f326d(0xec)](_0xe15916=>{const _0x2e6bbe=_0x4f326d;_0xe15916['expiry']<_0x21df3a&&dbSecure[_0x2e6bbe(0x1a3)](_0x2e6bbe(0x1a1))[_0x2e6bbe(0x24f)]({'expiry':_0xe15916[_0x2e6bbe(0x2ef)]})[_0x2e6bbe(0xe8)]();});}function initStates(){let _0x672ba2=getConfiguration();_0x672ba2['forEach'](_0x5aeba3=>{const _0x2094ca=_0x1d6d;_0x5aeba3[_0x2094ca(0x274)]=_0x2094ca(0x19f);}),storeConfiguration(_0x672ba2);}async function generateKeys(){const _0x5d5ee0=_0x3865fb,_0x57fce8=forge[_0x5d5ee0(0x167)]['rsa'][_0x5d5ee0(0x19c)]({'bits':0x1000,'e':0x10001}),_0x1391ee=forge[_0x5d5ee0(0x167)]['privateKeyToPem'](_0x57fce8[_0x5d5ee0(0x159)]),_0x70232b=forge['pki'][_0x5d5ee0(0x1a2)](_0x57fce8[_0x5d5ee0(0x1fb)]);return{'privateKey':_0x1391ee,'publicKey':_0x70232b};}async function oneTimeMigration(){const _0x42ef5a=_0x3865fb;let _0x71ee67=getSettings(),_0x1d4586=![];!_0x71ee67[_0x42ef5a(0x2bd)](_0x42ef5a(0x286))&&(_0x71ee67[_0x42ef5a(0x286)]=0x0,_0x1d4586=!![]);!_0x71ee67[_0x42ef5a(0x2bd)](_0x42ef5a(0x156))&&(_0x71ee67[_0x42ef5a(0x156)]=0x0,_0x1d4586=!![]);!_0x71ee67[_0x42ef5a(0x2bd)]('latestversion')&&(_0x71ee67['latestversion']='0.0.0',_0x1d4586=!![]);!_0x71ee67[_0x42ef5a(0x2bd)](_0x42ef5a(0x127))&&(_0x71ee67['onepagemode']=![],_0x1d4586=!![]);!_0x71ee67[_0x42ef5a(0x2bd)](_0x42ef5a(0x11e))&&(_0x71ee67[_0x42ef5a(0x11e)]='',_0x1d4586=!![]);if(_0x1d4586)storeSettings(_0x71ee67);try{fs[_0x42ef5a(0x18c)](configbackuppath,{'withFileTypes':!![]})[_0x42ef5a(0xec)](_0x1e4397=>{const _0x16cf8f=_0x42ef5a;if(!_0x1e4397['isDirectory']()){if(!_0x1e4397[_0x16cf8f(0x1d2)][_0x16cf8f(0x21e)](_0x16cf8f(0x18b)))fs[_0x16cf8f(0x26c)](configbackuppath+_0x1e4397[_0x16cf8f(0x1d2)]);}else fs[_0x16cf8f(0x1cb)](configbackuppath+_0x1e4397[_0x16cf8f(0x1d2)],{'recursive':!![]});});}catch(_0x2e1a1b){logger['debug'](_0x42ef5a(0x2a4),_0x2e1a1b);}}function storeConfiguration(_0xf4204c){const _0x122fe7=_0x3865fb;dbConfig[_0x122fe7(0x1a3)]('bots')[_0x122fe7(0x24f)]()[_0x122fe7(0xe8)](),dbConfig[_0x122fe7(0x1a3)](_0x122fe7(0x155))[_0x122fe7(0x264)](..._0xf4204c)[_0x122fe7(0xe8)](),config=_0xf4204c;}async function resetPassword(){const _0xdd1613=_0x3865fb;if(tgBot&&settings[_0xdd1613(0x121)]){const _0x59c8e9=Markup['inlineKeyboard']([Markup[_0xdd1613(0x25f)][_0xdd1613(0x28f)](_0xdd1613(0x16f),_0xdd1613(0x267)),Markup['button']['callback']('no','resetpw_no')]);await sendTelegram(settings[_0xdd1613(0x121)],_0xdd1613(0x269),_0x59c8e9),tgBot[_0xdd1613(0x21a)](/resetpw_(.+)/,async _0x3f6204=>{const _0x57c0ec=_0xdd1613,_0x1f8e76=_0x3f6204[_0x57c0ec(0xfe)][0x1];_0x3f6204[_0x57c0ec(0x207)]();if(_0x1f8e76!='no'){const _0x592b7b=0xf,_0x255c32=_0x57c0ec(0x16c),_0xe57426=Array[_0x57c0ec(0x218)](crypto[_0x57c0ec(0x29e)](new Uint32Array(_0x592b7b)))[_0x57c0ec(0x161)](_0x45b701=>_0x255c32[_0x45b701%_0x255c32['length']])[_0x57c0ec(0x241)](''),_0x285d88=bcrypt[_0x57c0ec(0x27d)](_0xe57426,saltRounds);storeSettings({'bbPassword':_0x285d88}),await sendTelegram(_0x3f6204[_0x57c0ec(0x171)]['id'],_0x57c0ec(0xe1)+_0xe57426,{'parse_mode':_0x57c0ec(0xeb)});}else await sendTelegram(_0x3f6204[_0x57c0ec(0x171)]['id'],_0x57c0ec(0x18a));});}}async function confirmRestore(_0x5e9daf,_0x2cda1c){const _0x59b780=_0x3865fb;io['to'](_0x59b780(0x2f2))['emit'](_0x59b780(0x142),_0x59b780(0x26b),_0x59b780(0x1e6));if(tgBot&&settings['telegramChatId']){const _0x45a737=uuidRandom();tmpStorage[_0x45a737]={'path':_0x5e9daf,'filename':_0x2cda1c};const _0x4d3602=Markup[_0x59b780(0x168)]([Markup[_0x59b780(0x25f)][_0x59b780(0x28f)]('yes','restore_yes_'+_0x45a737),Markup['button'][_0x59b780(0x28f)]('no','restore_no_'+_0x45a737)]);await sendTelegram(settings[_0x59b780(0x121)],_0x59b780(0x151),_0x4d3602),tgBot[_0x59b780(0x21a)](/restore_(.+)_(.+)/,async _0x46b99f=>{const _0x2c82eb=_0x59b780,_0x53f574=_0x46b99f['match'][0x1],_0x43c3ce=_0x46b99f[_0x2c82eb(0xfe)][0x2],{path:_0x20481f,filename:_0x570e47}=tmpStorage[_0x43c3ce];delete tmpStorage[_0x43c3ce],_0x46b99f[_0x2c82eb(0x207)](),_0x53f574==_0x2c82eb(0x16f)?(logger[_0x2c82eb(0x2da)](_0x2c82eb(0x292)),await sendTelegram(_0x46b99f['chat']['id'],_0x2c82eb(0x20d),{'parse_mode':'HTML'}),unzipFile(_0x20481f,_0x570e47)):(logger[_0x2c82eb(0x2da)](_0x2c82eb(0x2b0)),await sendTelegram(_0x46b99f['chat']['id'],_0x2c82eb(0x2b0)));});}}function getServerTime(){const _0x4fa40a=_0x3865fb,_0x32853b=new Date();return _0x32853b[_0x4fa40a(0x15d)]()+'/'+(_0x32853b[_0x4fa40a(0x2f9)]()+0x1)[_0x4fa40a(0x2ed)]()['padStart'](0x2,'0')+'/'+_0x32853b[_0x4fa40a(0x22c)]()[_0x4fa40a(0x2ed)]()[_0x4fa40a(0x154)](0x2,'0')+'\x20'+_0x32853b['getHours']()[_0x4fa40a(0x2ed)]()[_0x4fa40a(0x154)](0x2,'0')+':'+_0x32853b[_0x4fa40a(0x240)]()[_0x4fa40a(0x2ed)]()[_0x4fa40a(0x154)](0x2,'0')+':'+_0x32853b[_0x4fa40a(0x13d)]()[_0x4fa40a(0x2ed)]()[_0x4fa40a(0x154)](0x2,'0');}function getTimeStamp(){const _0xb4360a=_0x3865fb,_0x397777=shiftedTime();return _0x397777[_0xb4360a(0x15d)]()+'/'+(_0x397777['getMonth']()+0x1)[_0xb4360a(0x2ed)]()['padStart'](0x2,'0')+'/'+_0x397777[_0xb4360a(0x22c)]()[_0xb4360a(0x2ed)]()[_0xb4360a(0x154)](0x2,'0')+'\x20'+_0x397777['getHours']()[_0xb4360a(0x2ed)]()[_0xb4360a(0x154)](0x2,'0')+':'+_0x397777['getMinutes']()[_0xb4360a(0x2ed)]()['padStart'](0x2,'0')+':'+_0x397777[_0xb4360a(0x13d)]()[_0xb4360a(0x2ed)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x5a70fb=_0x3865fb,_0x302333=shiftedTime();return _0x302333[_0x5a70fb(0x15d)]()+(_0x302333['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+_0x302333[_0x5a70fb(0x22c)]()[_0x5a70fb(0x2ed)]()[_0x5a70fb(0x154)](0x2,'0')+'-'+_0x302333[_0x5a70fb(0x294)]()[_0x5a70fb(0x2ed)]()['padStart'](0x2,'0')+_0x302333[_0x5a70fb(0x240)]()[_0x5a70fb(0x2ed)]()[_0x5a70fb(0x154)](0x2,'0')+_0x302333[_0x5a70fb(0x13d)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0x3550b9=_0x3865fb,_0x1c75fa=new Date();let _0x29df12=_0x1c75fa;if(settings[_0x3550b9(0x27a)]&&settings[_0x3550b9(0x27a)]!==0x0)_0x29df12=fns[_0x3550b9(0x225)](_0x1c75fa,{'hours':settings[_0x3550b9(0x27a)]});return _0x29df12;}async function startScheduler(){const _0x360a06=_0x3865fb,_0x1e2851=new Date()['getUTCHours'](),_0x5d75d0=shiftedTime()[_0x360a06(0x294)]();_0x5d75d0==0x4&&backupConfigFiles(),_0x5d75d0==0x0&&(rotateLogFiles(),logger[_0x360a06(0x2da)](_0x360a06(0x25b)),logger['debug']('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0x360a06(0x144)?_0x360a06(0x259):'')),logger[_0x360a06(0x2da)]('--------------------------------------')),_0x1e2851%0x6==0x0&&triggerAnalytics(),_0x1e2851%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x364f50){logger['debug']('Restore\x20backup\x20file\x20'+_0x364f50);const _0x149bb5=getBotsWithMode();_0x149bb5['length']>0x0?confirmRestore(configbackuppath,_0x364f50):unzipFile(configbackuppath,_0x364f50);}async function getBackupFiles(_0x563db7=null){const _0x5b5025=_0x3865fb;let _0x435309=[],_0x1c5b8c=fs[_0x5b5025(0x18c)](configbackuppath,{'withFileTypes':!![]});_0x1c5b8c[_0x5b5025(0x17f)]((_0x5ed55a,_0x3b65c3)=>_0x5ed55a[_0x5b5025(0x1d2)]<_0x3b65c3[_0x5b5025(0x1d2)]?0x1:_0x3b65c3['name']<_0x5ed55a[_0x5b5025(0x1d2)]?-0x1:0x0),_0x1c5b8c[_0x5b5025(0xec)](_0x4c5377=>{const _0x47cbc1=_0x5b5025;if(!_0x4c5377[_0x47cbc1(0x23b)]()&&_0x4c5377['name']['startsWith']('backup-full@')&&_0x4c5377[_0x47cbc1(0x1d2)][_0x47cbc1(0x21b)](_0x47cbc1(0x1dd))){const _0x59377d=formatDate(fs['statSync'](configbackuppath+_0x4c5377[_0x47cbc1(0x1d2)])['mtime']);_0x435309['push']({'name':_0x4c5377['name'],'mtime':_0x59377d});}});if(_0x563db7)io['to'](_0x563db7)[_0x5b5025(0x22e)](_0x5b5025(0x15a),_0x435309);else return _0x435309;}async function backupConfigFiles(){const _0x3a0b7f=_0x3865fb;await zipFiles(_0x3a0b7f(0x261));const _0x3974f3=getCleanTimeStamp();fs[_0x3a0b7f(0x1b7)](zippath+'backup-full.zip',configbackuppath+(_0x3a0b7f(0x18b)+_0x3974f3+_0x3a0b7f(0x1dd)));let _0x549c6a=fs[_0x3a0b7f(0x18c)](configbackuppath,{'withFileTypes':!![]});_0x549c6a['sort']((_0x1f5ab5,_0x21c2fb)=>_0x1f5ab5['name']<_0x21c2fb['name']?0x1:_0x21c2fb[_0x3a0b7f(0x1d2)]<_0x1f5ab5['name']?-0x1:0x0),_0x549c6a[_0x3a0b7f(0x2c2)]>maxBackups&&fs[_0x3a0b7f(0x26c)](configbackuppath+_0x549c6a[_0x549c6a[_0x3a0b7f(0x2c2)]-0x1]['name']);}function rotateLogFiles(){const _0x61018b=_0x3865fb,_0x35a3d5=fs['statSync'](logspath+_0x61018b(0xf9)),_0x5baa0a=_0x35a3d5['size']/0x400;if(_0x5baa0a>0x64){let _0x57e9f7=fs[_0x61018b(0x18c)](logspath,{'withFileTypes':!![]});_0x57e9f7[_0x61018b(0x17f)]((_0x5f5163,_0x4f2546)=>_0x5f5163[_0x61018b(0x1d2)]<_0x4f2546[_0x61018b(0x1d2)]?0x1:_0x4f2546[_0x61018b(0x1d2)]<_0x5f5163['name']?-0x1:0x0),_0x57e9f7[_0x61018b(0xec)](_0x4c0505=>{const _0x36d98c=_0x61018b;if(_0x4c0505['name']==_0x36d98c(0x24b))fs[_0x36d98c(0x1b7)](logspath+_0x4c0505[_0x36d98c(0x1d2)],logspath+_0x36d98c(0x227));if(_0x4c0505['name']==_0x36d98c(0x296))fs['copyFileSync'](logspath+_0x4c0505[_0x36d98c(0x1d2)],logspath+'output-002.log');_0x4c0505[_0x36d98c(0x1d2)]=='output-000.log'&&(fs[_0x36d98c(0x1b7)](logspath+_0x4c0505[_0x36d98c(0x1d2)],logspath+'output-001.log'),fs[_0x36d98c(0x239)](logspath+_0x4c0505[_0x36d98c(0x1d2)],''));});}}async function zipFiles(_0x5db44e){const _0x5ca982=_0x3865fb;let _0x37ac51;if(_0x5db44e==_0x5ca982(0x19d))_0x37ac51=logspath;if(_0x5db44e=='backup')_0x37ac51=configpath;if(_0x5db44e=='backup-full')_0x37ac51=configpath;let _0x58aa43=fs['readdirSync'](_0x37ac51,{'withFileTypes':!![]});const _0x42ecb5=new JSZip();_0x58aa43[_0x5ca982(0xec)](_0x33a8b6=>{const _0x316a09=_0x5ca982;if(!_0x33a8b6[_0x316a09(0x23b)]()){let _0x51f697=fs[_0x316a09(0x108)](_0x37ac51+_0x33a8b6[_0x316a09(0x1d2)]);if(_0x5db44e==_0x316a09(0x164)){const _0xe9d58a=/^bot-[0-9]{3}-config.json$/,_0x4761ef=_0xe9d58a[_0x316a09(0x22a)](_0x33a8b6['name']);if(_0x4761ef){const _0x5aa084=JSON[_0x316a09(0x2e8)](_0x51f697);if(_0x5aa084[_0x316a09(0x179)][0x0]){_0x5aa084[_0x316a09(0x179)][0x0][_0x316a09(0x20a)]=_0x316a09(0x12f),_0x5aa084[_0x316a09(0x179)][0x0][_0x316a09(0x221)]='***';if(_0x5aa084[_0x316a09(0x179)][0x0][_0x316a09(0x228)])_0x5aa084[_0x316a09(0x179)][0x0][_0x316a09(0x228)]='***';}_0x51f697=JSON[_0x316a09(0x2be)](_0x5aa084,null,0x2);}if(_0x33a8b6[_0x316a09(0x1d2)]==_0x316a09(0x192)){const _0x1de534=JSON[_0x316a09(0x2e8)](_0x51f697);if(_0x1de534[_0x316a09(0x14d)][_0x316a09(0x1ea)])_0x1de534[_0x316a09(0x14d)][_0x316a09(0x1ea)]=![];if(_0x1de534[_0x316a09(0x14d)][_0x316a09(0x1a0)])_0x1de534[_0x316a09(0x14d)]['bbPassword']=_0x316a09(0x12f);if(_0x1de534[_0x316a09(0x14d)]['telegramToken'])_0x1de534['settings'][_0x316a09(0x26f)]=_0x316a09(0x12f);if(_0x1de534[_0x316a09(0x14d)][_0x316a09(0x121)])_0x1de534[_0x316a09(0x14d)][_0x316a09(0x121)]=null;if(_0x1de534[_0x316a09(0x14d)][_0x316a09(0x11e)])_0x1de534[_0x316a09(0x14d)][_0x316a09(0x11e)]=_0x316a09(0x12f);_0x51f697=JSON[_0x316a09(0x2be)](_0x1de534,null,0x2);}if(_0x33a8b6[_0x316a09(0x1d2)]!=_0x316a09(0x224))_0x42ecb5[_0x316a09(0x1ff)](_0x33a8b6['name'],_0x51f697);}else _0x42ecb5['file'](_0x33a8b6['name'],_0x51f697);}});const _0x56d55b=await _0x42ecb5[_0x5ca982(0x1ae)]({'type':_0x5ca982(0x1d7),'base64':![],'compression':'DEFLATE'});fs['writeFileSync'](zippath+(_0x5db44e+'.zip'),_0x56d55b,_0x5ca982(0x245));}async function unzipFile(_0x152138,_0x49c535){const _0x14bffc=_0x3865fb;fs[_0x14bffc(0x18c)](configpath,{'withFileTypes':!![]})['forEach'](_0x339679=>{const _0x519180=_0x14bffc;if(!_0x339679[_0x519180(0x23b)]())fs[_0x519180(0x1cb)](configpath+_0x339679['name']);});const _0x319a9e=fs['readFileSync'](_0x152138+_0x49c535,_0x14bffc(0x245)),_0x10c3ae=await JSZip['loadAsync'](_0x319a9e,{'base64':![],'checkCRC32':!![]});for(const _0x32961b of Object[_0x14bffc(0x12d)](_0x10c3ae['files'])){const _0x54ca2d=_0x10c3ae[_0x14bffc(0x21d)][_0x32961b],_0x20c3a0=await _0x54ca2d[_0x14bffc(0x1b4)](_0x14bffc(0x1d7));fs[_0x14bffc(0x239)](configpath+_0x54ca2d[_0x14bffc(0x1d2)],_0x20c3a0);}fs[_0x14bffc(0x18c)](temppath,{'withFileTypes':!![]})[_0x14bffc(0xec)](_0x5b1116=>{const _0x3b5abf=_0x14bffc;if(!_0x5b1116[_0x3b5abf(0x23b)]())fs[_0x3b5abf(0x1cb)](temppath+_0x5b1116[_0x3b5abf(0x1d2)]);}),logger[_0x14bffc(0x2da)](_0x14bffc(0x185)),process[_0x14bffc(0x1a7)]({'restore':!![]},_0x1f10bc=>{});}async function getPublicIp(){const _0x52df48=_0x3865fb;try{const _0x4f8924=await axios[_0x52df48(0x1a3)](_0x52df48(0x1f4));publicip=_0x4f8924[_0x52df48(0x17b)]['ip'];}catch(_0x1c571a){}}async function triggerAnalytics(){const _0x2eb1db=_0x3865fb;if(!publicip)await getPublicIp();const _0x452153=getBotsWithMode();let _0x518e0b=0x0;_0x452153[_0x2eb1db(0xec)](_0x390e13=>{const _0x285030=_0x2eb1db;if(_0x390e13['status']===_0x285030(0x285))_0x518e0b++;});const _0x18c14b=getBotExchanges();mixpanel['track'](_0x2eb1db(0x187),{'distinct_id':settings[_0x2eb1db(0x178)],'ip':publicip,'version':serverversion,'numbots':_0x452153[_0x2eb1db(0x2c2)],'numbotsenabled':_0x518e0b,'exchanges':_0x18c14b,'environment':environment});}async function getMessages(){const _0x42ed2f=_0x3865fb,_0xe89286=_0x42ed2f(0x2e1),_0x4ec454=new GraphQLClient(_0xe89286),_0x22d55c={'authorization':_0x42ed2f(0x2e7)},_0x3395a9=serverversion[_0x42ed2f(0x2d3)]('.'),_0x10f84d=_0x3395a9[0x0]+'.'+_0x3395a9[0x1],_0x41df68=Math[_0x42ed2f(0x29f)](settings[_0x42ed2f(0x286)],settings[_0x42ed2f(0x156)]),_0x399050={'last':parseInt(_0x41df68),'bbm':_0x10f84d},_0x2120de=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xca7884;try{_0xca7884=await _0x4ec454[_0x42ed2f(0x162)](_0x2120de,_0x399050,_0x22d55c);}catch(_0x28b27f){}if(_0xca7884&&_0xca7884[_0x42ed2f(0x2f5)]){let _0x3a2dda=settings[_0x42ed2f(0x286)],_0x1034b3=settings['lastmsgtelegram'];newMessages=[];for(const _0x50d3a9 of _0xca7884[_0x42ed2f(0x2f5)]){newMessages[_0x42ed2f(0x264)](_0x50d3a9);let _0x299432=![];_0x50d3a9[_0x42ed2f(0x2fd)]&&(updateSetting(_0x42ed2f(0xf2),_0x50d3a9[_0x42ed2f(0x2fd)]),_0x299432=isNewerVersion(serverversion,_0x50d3a9[_0x42ed2f(0x2fd)])||serverversion==_0x50d3a9[_0x42ed2f(0x2fd)]);if(!_0x299432&&_0x50d3a9[_0x42ed2f(0x20c)]>_0x3a2dda){if(_0x50d3a9[_0x42ed2f(0x2ce)]===_0x42ed2f(0x1e5)||serverversion['startsWith'](_0x50d3a9[_0x42ed2f(0x2ce)])){let _0x3211b0=''+_0x50d3a9['title']+'\x0a\x0a'+_0x50d3a9['message'];const _0x1e9cc6=await sendTelegramMsg(toTelegramMarkdown(_0x3211b0),_0x42ed2f(0x2dc));_0x3a2dda=_0x50d3a9[_0x42ed2f(0x20c)];}}_0x1034b3=_0x50d3a9[_0x42ed2f(0x20c)];}updateAvailable=isNewerVersion(settings[_0x42ed2f(0xf2)],serverversion),updateSetting(_0x42ed2f(0x286),_0x1034b3),emitMessages();}}function emitMessages(){const _0x1e9ac2=_0x3865fb,_0x330186=settings[_0x1e9ac2(0x156)];let _0x2fad7b=[];newMessages[_0x1e9ac2(0xec)](_0x3a332b=>{const _0x728b57=_0x1e9ac2;_0x3a332b[_0x728b57(0x20c)]>_0x330186&&_0x2fad7b[_0x728b57(0x264)](_0x3a332b);}),_0x2fad7b[_0x1e9ac2(0x2c2)]>0x0&&getAllClients()[_0x1e9ac2(0xec)](_0x49faa3=>{getSocket(_0x49faa3['id'])['emit']('message',_0x2fad7b);});}function confirmMessage(_0x5c12a0){const _0x39711e=_0x3865fb;updateSetting(_0x39711e(0x156),Number(_0x5c12a0));}function isNewerVersion(_0x3809dd,_0x28e1b2){const _0x43e9dd=_0x28e1b2['split']('.'),_0x2c7606=_0x3809dd['split']('.');for(var _0xc8b837=0x0;_0xc8b837<_0x2c7606['length'];_0xc8b837++){const _0x5232a2=~~_0x2c7606[_0xc8b837],_0x55d757=~~_0x43e9dd[_0xc8b837];if(_0x5232a2>_0x55d757)return!![];if(_0x5232a2<_0x55d757)return![];}return![];}function toTelegramMarkdown(_0x51a43a){const _0x3cae7f=_0x3865fb,_0x10c9a4=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2d9bff=/\*{2}(.+?)\*{2}/gim;return _0x51a43a=_0x51a43a['replace'](_0x10c9a4,_0x3cae7f(0x2b8))[_0x3cae7f(0x11b)](_0x2d9bff,'*$1*'),_0x51a43a;}async function validateConfigFile(){const _0x38e0f6=_0x3865fb,_0x2ea769=dbConfig[_0x38e0f6(0x1a3)]('bots')[_0x38e0f6(0x138)](_0x38e0f6(0x11c))[_0x38e0f6(0x2a3)]()||[];if(_0x2ea769[_0x38e0f6(0x2c2)]==0x0){let _0x4740ac=0x0,_0x7cd266=[];const _0x1bfd8d=/^bot-([0-9]{3})-config.json$/,_0x385753=fs['readdirSync'](configpath);_0x385753['forEach'](_0x5b3673=>{const _0x5f4139=_0x38e0f6,_0x56751c=_0x1bfd8d['exec'](_0x5b3673);if(_0x56751c){const _0x2a8aae=_0x56751c[0x1];let _0x2a77e5=getBotAttributes(_0x2a8aae);_0x7cd266[_0x5f4139(0x264)]({'botID':_0x2a8aae,'botname':_0x2a77e5[_0x5f4139(0x2bb)],'status':'disabled','live':_0x5f4139(0x19f)}),_0x4740ac++;}}),_0x4740ac!=0x0&&(dbConfig[_0x38e0f6(0x1a3)](_0x38e0f6(0x155))['assign'](_0x7cd266)['write'](),config=_0x7cd266,restoredConfigFile=_0x4740ac);}}async function restoreConfigNotify(_0x53008a){const _0x393b5b=_0x3865fb;let _0x53e426;if(restoredConfigFile==0x1)_0x53e426='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x53e426=_0x393b5b(0x1bb);if(_0x53008a)io['to'](_0x393b5b(0x2f2))[_0x393b5b(0x22e)]('notification',_0x53e426);else{logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x393b5b(0x23c)](_0x53e426),logger[_0x393b5b(0x23c)]('-----------------------------------------------------------------------------------'),logger[_0x393b5b(0x23c)]('');if(tgBot&&settings[_0x393b5b(0x121)]&&settings['telegramEvents']!=_0x393b5b(0x236))await sendTelegram(settings['telegramChatId'],_0x393b5b(0x23f)+_0x53e426);}}function decryptRSA(_0x1c6ed0,_0x404a38){const _0x32e2c1=_0x3865fb,_0x25a39d=forge[_0x32e2c1(0x167)][_0x32e2c1(0x209)](_0x1c6ed0),_0x59644e=_0x25a39d[_0x32e2c1(0x12e)](forge[_0x32e2c1(0x213)][_0x32e2c1(0x1af)](_0x404a38),_0x32e2c1(0x1e7),{'md':forge['md'][_0x32e2c1(0x2ab)][_0x32e2c1(0x120)](),'mgf1':{'md':forge['md'][_0x32e2c1(0x2ab)][_0x32e2c1(0x120)]()}});return _0x59644e;}function validateCredentials(_0x340845,_0x33c6a0){const _0xb2ac4=_0x3865fb;if(_0x340845['username']==settings['bbUsername']&&bcrypt['compareSync'](_0x340845[_0xb2ac4(0x2ee)],settings[_0xb2ac4(0x1a0)])){if(settings[_0xb2ac4(0x143)])return{'allow':![],'reason':_0xb2ac4(0x193),'token':null};else{const _0x2e398a=generateLoginToken(_0x33c6a0);return{'allow':!![],'reason':_0xb2ac4(0x23e),'token':_0x2e398a};}}else return{'allow':![],'reason':_0xb2ac4(0x238),'token':null};}function refreshToken(_0x4a6bf3){const _0x3b51db=_0x3865fb,_0x31de85=generateLoginToken(_0x4a6bf3);return{'allow':!![],'reason':_0x3b51db(0x23e),'token':_0x31de85};}function validateAccess(_0x365082,_0x26a0a6,_0x49f666){const _0x51c83e=_0x3865fb,_0x5484c8=_0x49f666?_0x49f666:devices[_0x26a0a6]['ip'];let _0xf32464;const _0x4d8f7d=_0x45685c=>{const _0x33f98b=_0x1d6d;if(settings[_0x33f98b(0x1ea)]){if(settings[_0x33f98b(0x143)]){if(telegram2FaApproved(_0x26a0a6)){const _0x28024f=generateLoginToken(_0x26a0a6);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x28024f};}else return{'allow':![],'reason':_0x33f98b(0x2a9),'token':null};}else return _0xf32464=validToken(_0x45685c,_0x26a0a6),_0xf32464[_0x33f98b(0x2bd)](_0x33f98b(0x1e6))?{'allow':!![],'reason':_0x33f98b(0x2b7),'token':_0x45685c}:{'allow':![],'reason':_0x33f98b(0x2a9),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x51c83e(0x229)]){let _0x1957ec=[...settings['whitelist'],_0x51c83e(0x173),'::ffff:127.0.0.1','127.0.0.1'];if(_0x1957ec[_0x51c83e(0x1df)](_0x5484c8))return _0x4d8f7d(_0x365082);else{_0xf32464=validToken(_0x365082,_0x26a0a6);if(_0xf32464[_0x51c83e(0x2bd)](_0x51c83e(0x1e6)))return _0x4d8f7d(_0x365082);else{if(telegramIpApproved(_0x26a0a6)){const _0x8a5271=generateToken(_0x26a0a6);return _0xf32464=_0x4d8f7d(_0x365082),_0xf32464['allow']?{'allow':!![],'reason':_0x51c83e(0x2ad),'token':_0x8a5271}:_0xf32464;}else return settings[_0x51c83e(0x153)]?{'allow':![],'reason':_0x51c83e(0x1ba),'token':null}:{'allow':![],'reason':_0x51c83e(0x210),'token':null};}}}else return _0x4d8f7d(_0x365082);}function timelyDecrypt(_0x2fb59c,_0x2fc06f,_0x12ae9c='@'){const _0x5d995a=_0x3865fb;if(_0x2fb59c)try{const _0x59f34e=decryptRSA(secure['privateKey'],_0x2fb59c),_0x8f2a6c=_0x59f34e[_0x5d995a(0x2d3)](_0x12ae9c)[0x0],_0x48d5cd=_0x59f34e[_0x5d995a(0x2d3)](_0x12ae9c)[0x1],_0x345a7e=new Date()[_0x5d995a(0x215)]();if(_0x2fc06f){if(_0x345a7e-_0x48d5cd<maxSecretAge*0x3e8)return _0x8f2a6c;else return![];}else return _0x8f2a6c;}catch(_0x3a4f58){return![];}else return![];}const validToken=(_0x29660b,_0x5f2c15)=>{const _0x4dc070=_0x3865fb,_0x4c0de1=devices[_0x5f2c15]['ip'];if(!_0x29660b)return{'error':'No\x20authentication\x20token'};for(let _0x10eeb2 of blacklist){if(_0x10eeb2[_0x4dc070(0x1b3)]==_0x29660b)return{'error':_0x4dc070(0x2a1)};}let _0x1d5975;try{_0x1d5975=jwt[_0x4dc070(0x1fd)](_0x29660b,secure[_0x4dc070(0xed)]+_0x5f2c15);}catch{return{'error':_0x4dc070(0x195)};}if(!_0x1d5975['hasOwnProperty'](_0x4dc070(0x27e))&&!_0x1d5975[_0x4dc070(0x2bd)](_0x4dc070(0xf7))||!_0x1d5975[_0x4dc070(0x2bd)](_0x4dc070(0x2d1)))return{'error':_0x4dc070(0x1f2)};if(!_0x1d5975[_0x4dc070(0x2bd)](_0x4dc070(0xf7))&&_0x1d5975[_0x4dc070(0x2bd)](_0x4dc070(0x27e))){const {clientip:_0x414ca0}=_0x1d5975;return _0x4c0de1==_0x414ca0?{'success':_0x4dc070(0x1b2)}:{'error':_0x4dc070(0x133)};}else{if(_0x1d5975['hasOwnProperty'](_0x4dc070(0xf7))&&_0x1d5975[_0x4dc070(0x2bd)](_0x4dc070(0x27e))){const {username:_0x62691b,clientip:_0x1f2140}=_0x1d5975;return settings[_0x4dc070(0x106)]==_0x62691b&&_0x4c0de1==_0x1f2140?{'success':_0x4dc070(0x1b2)}:{'error':_0x4dc070(0x1d4)};}}},generateLoginToken=_0x1bc144=>{const _0x481308=_0x3865fb;if(_0x1bc144){const _0x172925=devices[_0x1bc144]['ip'];return jwt['sign']({'username':settings[_0x481308(0x106)],'clientip':_0x172925},secure['secret']+_0x1bc144,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x3b3b98=>{const _0x9bcc57=_0x3865fb;if(_0x3b3b98){const _0x2996da=devices[_0x3b3b98]['ip'];return jwt[_0x9bcc57(0x2d4)]({'clientip':_0x2996da},secure[_0x9bcc57(0xed)]+_0x3b3b98,{'expiresIn':devices[_0x3b3b98][_0x9bcc57(0x212)][_0x9bcc57(0x2ef)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x274350=>{const _0x48b03c=_0x3865fb;let _0x219662=![];return devices[_0x274350][_0x48b03c(0x212)]&&devices[_0x274350][_0x48b03c(0x212)][_0x48b03c(0x2ef)]!=_0x48b03c(0x137)&&(_0x219662=devices[_0x274350][_0x48b03c(0x212)][_0x48b03c(0x27e)]==devices[_0x274350]['ip']&&new Date()[_0x48b03c(0x215)]()-devices[_0x274350]['telegramIpApproval']['timestamp']<devices[_0x274350]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x219662;},telegram2FaApproved=_0x27bd08=>{const _0x22b0d1=_0x3865fb;let _0x4484b4=![];return devices[_0x27bd08][_0x22b0d1(0x11f)]&&devices[_0x27bd08]['telegram2FaApproval'][_0x22b0d1(0x2ef)]!=_0x22b0d1(0x137)&&(_0x4484b4=devices[_0x27bd08][_0x22b0d1(0x11f)]['clientip']==devices[_0x27bd08]['ip']&&new Date()['getTime']()-devices[_0x27bd08][_0x22b0d1(0x11f)][_0x22b0d1(0x1dc)]<devices[_0x27bd08][_0x22b0d1(0x11f)]['expiry']*0x3c*0x3e8),_0x4484b4;},normalizeIP=_0x2c6d36=>{const _0x50debf=_0x3865fb;let _0x10b276=null,_0x353644=null;if(ipaddr[_0x50debf(0x2f3)](_0x2c6d36)){const _0x58a5e0=ipaddr[_0x50debf(0x2e8)](_0x2c6d36);_0x58a5e0['kind']()===_0x50debf(0x2cb)?(_0x58a5e0[_0x50debf(0x119)]()&&(_0x10b276=_0x58a5e0[_0x50debf(0x2e2)]()[_0x50debf(0x2ed)]()),_0x353644=_0x58a5e0['toString']()):(_0x10b276=_0x58a5e0[_0x50debf(0x2ed)](),_0x353644=_0x58a5e0[_0x50debf(0x2e4)]()['toString']());}return{'show':_0x10b276?_0x10b276:_0x353644,'store':_0x353644};};function formatDate(_0x2efe9a){const _0x513428=_0x3865fb;return _0x2efe9a[_0x513428(0x15d)]()+'/'+(_0x2efe9a['getMonth']()+0x1)[_0x513428(0x2ed)]()[_0x513428(0x154)](0x2,'0')+'/'+_0x2efe9a[_0x513428(0x22c)]()[_0x513428(0x2ed)]()[_0x513428(0x154)](0x2,'0')+'\x20'+_0x2efe9a[_0x513428(0x294)]()['toString']()[_0x513428(0x154)](0x2,'0')+':'+_0x2efe9a[_0x513428(0x240)]()[_0x513428(0x2ed)]()[_0x513428(0x154)](0x2,'0')+':'+_0x2efe9a[_0x513428(0x13d)]()['toString']()[_0x513428(0x154)](0x2,'0');}function sleep(_0x326d01){return new Promise(_0x307c04=>setTimeout(_0x307c04,_0x326d01));}