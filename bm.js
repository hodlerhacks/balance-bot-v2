const _0x3d1b94=_0x5cc6;(function(_0x27e020,_0x57744a){const _0x18a49d=_0x5cc6,_0x49bb76=_0x27e020();while(!![]){try{const _0xa945a8=parseInt(_0x18a49d(0x1fc))/0x1*(-parseInt(_0x18a49d(0x164))/0x2)+-parseInt(_0x18a49d(0x214))/0x3+-parseInt(_0x18a49d(0x317))/0x4*(parseInt(_0x18a49d(0x1e9))/0x5)+parseInt(_0x18a49d(0x18e))/0x6+-parseInt(_0x18a49d(0x24e))/0x7*(-parseInt(_0x18a49d(0x2f1))/0x8)+parseInt(_0x18a49d(0x19b))/0x9*(-parseInt(_0x18a49d(0x1f5))/0xa)+parseInt(_0x18a49d(0x2c0))/0xb*(parseInt(_0x18a49d(0x33a))/0xc);if(_0xa945a8===_0x57744a)break;else _0x49bb76['push'](_0x49bb76['shift']());}catch(_0xfa4aec){_0x49bb76['push'](_0x49bb76['shift']());}}}(_0x439d,0x3ff76));const _0x163ca1=function(){let _0x53bf4e=!![];return function(_0x554d67,_0xbafdec){const _0x289cce=_0x53bf4e?function(){const _0x5daae6=_0x5cc6;if(_0xbafdec){const _0x37b1eb=_0xbafdec[_0x5daae6(0x217)](_0x554d67,arguments);return _0xbafdec=null,_0x37b1eb;}}:function(){};return _0x53bf4e=![],_0x289cce;};}(),_0x4ccb44=_0x163ca1(this,function(){const _0x1147e9=_0x5cc6;return _0x4ccb44['toString']()[_0x1147e9(0x213)](_0x1147e9(0x2eb))[_0x1147e9(0x321)]()[_0x1147e9(0x1fa)](_0x4ccb44)[_0x1147e9(0x213)](_0x1147e9(0x2eb));});_0x4ccb44();'use strict';process[_0x3d1b94(0x1f3)][_0x3d1b94(0x2b7)]=0x1;const childProcess=require(_0x3d1b94(0x341)),fs=require('fs'),fns=require(_0x3d1b94(0x2a7)),low=require('lowdb'),FileSync=require(_0x3d1b94(0x21f)),path=require(_0x3d1b94(0x1cc)),crypto=require(_0x3d1b94(0x166)),forge=require(_0x3d1b94(0x31d)),bcrypt=require(_0x3d1b94(0x1a9)),jwt=require(_0x3d1b94(0x234)),ipaddr=require(_0x3d1b94(0x36c)),argv=require('yargs/yargs')(process[_0x3d1b94(0x31f)][_0x3d1b94(0x176)](0x2))[_0x3d1b94(0x31f)],uuidRandom=require(_0x3d1b94(0x2cf)),{Telegraf,Markup}=require(_0x3d1b94(0x231)),Mixpanel=require(_0x3d1b94(0x274)),axios=require(_0x3d1b94(0x30f)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x3d1b94(0x1e0)),fileUpload=require(_0x3d1b94(0x1bb)),{networkInterfaces}=require('os'),JSZip=require(_0x3d1b94(0x194)),PORT=argv[_0x3d1b94(0x297)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x3d1b94(0x221)](PORT)&&(console[_0x3d1b94(0x33c)](_0x3d1b94(0x354)+PORT+_0x3d1b94(0x256)),process[_0x3d1b94(0x193)](0x1));const HOST=argv[_0x3d1b94(0x28e)]||null,userID=argv[_0x3d1b94(0x181)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x3d1b94(0x261)][_0x3d1b94(0x187)];let bbpath='bb/',bbpath2='';const botfile=_0x3d1b94(0x264),configfile=_0x3d1b94(0x1b8),settingsfile=_0x3d1b94(0x25b),securefile=_0x3d1b94(0x310),environment=require('./'+bbpath2+'version.json')['environment']||_0x3d1b94(0x204),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x3d1b94(0x2e3)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x3d1b94(0x257)),configpath=userID?bbpath+_0x3d1b94(0x1d4)+userID+'/':bbpath+_0x3d1b94(0x1d4),configbackuppath=configpath+_0x3d1b94(0x255),logspath=userID?bbpath+_0x3d1b94(0x275)+userID+'/':bbpath+_0x3d1b94(0x275),zippath=userID?bbpath+_0x3d1b94(0x316)+userID+'/':bbpath+'zip/',loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x3d1b94(0x2e4);!fs[_0x3d1b94(0x2e3)](configpath)&&fs[_0x3d1b94(0x156)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x3d1b94(0x156)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x3d1b94(0x156)](logspath);!fs[_0x3d1b94(0x2e3)](zippath)&&fs[_0x3d1b94(0x156)](zippath);!fs[_0x3d1b94(0x2e3)](temppath)&&fs[_0x3d1b94(0x156)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x3d1b94(0x324)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x3d1b94(0x326)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x3d1b94(0x326)]();const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x3d1b94(0x347),{'host':_0x3d1b94(0x19e)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x3d1b94(0x303)]&&(settings[_0x3d1b94(0x303)]!=''&&settings[_0x3d1b94(0x303)]!='***')&&settings[_0x3d1b94(0x294)]&&settings[_0x3d1b94(0x294)]!='')initTelegram();const parseColor=(_0x3ef004,_0x2d5112)=>{const _0x2139d0=_0x3d1b94,_0x2e849d=/#[A-Z]{3}#/g;if(typeof _0x3ef004=='string'){!_0x2d5112?_0x3ef004=_0x3ef004[_0x2139d0(0x32d)](_0x2e849d,''):(_0x3ef004=_0x3ef004[_0x2139d0(0x32d)](/#BLU#/g,_0x2139d0(0x2a3)),_0x3ef004=_0x3ef004[_0x2139d0(0x32d)](/#RED#/g,_0x2139d0(0x184)),_0x3ef004=_0x3ef004[_0x2139d0(0x32d)](/#YEL#/g,_0x2139d0(0x2cd)),_0x3ef004=_0x3ef004['replace'](/#MAG#/g,_0x2139d0(0x2e0)),_0x3ef004=_0x3ef004[_0x2139d0(0x32d)](/#CYA#/g,_0x2139d0(0x26b)),_0x3ef004=_0x3ef004[_0x2139d0(0x32d)](/#RES#/g,_0x2139d0(0x320)));;}return _0x3ef004;},logger={'screen':_0x42f8ad=>{const _0x1e397d=_0x3d1b94;console[_0x1e397d(0x33c)](parseColor(_0x42f8ad,!![]));},'simple':_0xed9909=>{const _0x59fb84=_0x3d1b94;console[_0x59fb84(0x33c)](parseColor(_0xed9909,!![])),loggerfile[_0x59fb84(0x326)](util[_0x59fb84(0x253)](parseColor(_0xed9909,![]))+'\x0a');},'full':async _0x1ef1c6=>{const _0x561bdd=_0x3d1b94,_0x42a2b8=getTimeStamp()+_0x561bdd(0x2f4)+_0x1ef1c6;console[_0x561bdd(0x33c)](parseColor(_0x42a2b8,!![])),loggerfile[_0x561bdd(0x326)](util[_0x561bdd(0x253)](parseColor(_0x42a2b8,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x561bdd(0x2c4)]!=_0x561bdd(0x311))await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+parseColor(_0x1ef1c6,![]));},'debug':async(_0xb70b08,_0x5b1752='')=>{const _0x2a6a6d=_0x3d1b94,_0x49d24f=getTimeStamp()+_0x2a6a6d(0x172)+_0xb70b08;if(debugging)console[_0x2a6a6d(0x33c)](parseColor(_0x49d24f,!![]));loggerfile[_0x2a6a6d(0x326)](util[_0x2a6a6d(0x253)](parseColor(_0x49d24f,![]))+'\x0a');if(_0x5b1752){if(debugging)console[_0x2a6a6d(0x33c)](_0x5b1752);loggerfile[_0x2a6a6d(0x326)](util[_0x2a6a6d(0x253)](_0x5b1752)+'\x0a');}}};let terminating=![];process['on'](_0x3d1b94(0x1ef),function(_0x45a4a1){const _0x4ae005=_0x3d1b94;_0x45a4a1['toString']()[_0x4ae005(0x265)](_0x4ae005(0x2aa))?(logger['simple'](_0x4ae005(0x1d7)+_0x45a4a1['port']+_0x4ae005(0x334)),process[_0x4ae005(0x225)]({'terminate':!![]},_0xac2fda=>{})):logger[_0x4ae005(0x1ed)](_0x45a4a1);}),process['on']('exit',()=>{const _0x8b03c0=_0x3d1b94;stopAllBots(),process[_0x8b03c0(0x193)](0x0);}),process['on'](_0x3d1b94(0x2a8),()=>{const _0x26f5cc=_0x3d1b94;stopAllBots(),process[_0x26f5cc(0x193)](0x0);}),process['on']('SIGINT',()=>{const _0x150d1e=_0x3d1b94;stopAllBots(),process[_0x150d1e(0x193)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x3d1b94(0x1a4)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x3d1b94(0x325)),app=express(),http=require(_0x3d1b94(0x2af))[_0x3d1b94(0x1af)](app);app[_0x3d1b94(0x34d)](fileUpload({'useTempFiles':!![]})),app[_0x3d1b94(0x167)]('/download/:type',async(_0x5af808,_0x41209)=>{const _0x3bd1aa=_0x3d1b94,_0x12cef3=_0x5af808['params'][_0x3bd1aa(0x333)],_0x5554e4=getClientsWithBotID(_0x3bd1aa(0x21d)),_0x213a17=_0x5af808[_0x3bd1aa(0x185)][_0x3bd1aa(0x2ff)],_0x5477ca=timelyDecrypt(_0x213a17,![]),_0x564a44=_0x5554e4[_0x3bd1aa(0x2c3)](_0x2ad83a=>_0x2ad83a[_0x3bd1aa(0x2ff)]==_0x5477ca);if(_0x564a44){const _0x42ff21=normalizeIP(_0x5af808[_0x3bd1aa(0x26f)][_0x3bd1aa(0x296)])[_0x3bd1aa(0x27e)],_0x221d98=_0x5af808[_0x3bd1aa(0x185)]['tkn'];if(validateAccess(_0x221d98,_0x5477ca,_0x42ff21)[_0x3bd1aa(0x251)])_0x12cef3==_0x3bd1aa(0x357)&&await backupConfigFiles(),await zipFiles(_0x12cef3),_0x41209[_0x3bd1aa(0x351)](zippath+(_0x12cef3+_0x3bd1aa(0x323)),_0x59a96c=>{const _0x3f053f=_0x3bd1aa;_0x59a96c&&(logger[_0x3f053f(0x17c)]('Failed\x20to\x20download\x20'+_0x12cef3),logger[_0x3f053f(0x1ed)](_0x59a96c));});else logger[_0x3bd1aa(0x17c)](_0x3bd1aa(0x2c8)+_0x12cef3+_0x3bd1aa(0x1dc));}else logger[_0x3bd1aa(0x17c)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x12cef3+_0x3bd1aa(0x208));}),app['post']('/upload-backup',async(_0x19ceeb,_0xb64b04)=>{const _0x24ea00=_0x3d1b94,_0x2c80cc=getClientsWithBotID('botmanager'),_0x420ec0=_0x19ceeb[_0x24ea00(0x185)][_0x24ea00(0x2ff)],_0x35a8d4=timelyDecrypt(_0x420ec0,![]),_0x5ac52c=_0x2c80cc[_0x24ea00(0x2c3)](_0x26b906=>_0x26b906[_0x24ea00(0x2ff)]==_0x35a8d4);logger[_0x24ea00(0x162)](_0x24ea00(0x259));if(_0x5ac52c){const _0x2cad10=normalizeIP(_0x19ceeb['socket'][_0x24ea00(0x296)])[_0x24ea00(0x27e)],_0x165fb8=_0x19ceeb[_0x24ea00(0x185)][_0x24ea00(0x23d)];if(validateAccess(_0x165fb8,_0x35a8d4,_0x2cad10)[_0x24ea00(0x251)]){if(_0x19ceeb[_0x24ea00(0x32e)]){const _0x2a12d9=_0x19ceeb[_0x24ea00(0x32e)][_0x24ea00(0x2bc)];await _0x2a12d9['mv'](temppath+_0x2a12d9[_0x24ea00(0x1fb)]),_0xb64b04['send']({'status':!![],'message':_0x24ea00(0x26e)});const _0x4e7682=getBotsWithMode();_0x4e7682[_0x24ea00(0x309)]>0x0?confirmRestore(temppath,_0x2a12d9[_0x24ea00(0x1fb)]):unzipFile(temppath,_0x2a12d9['name']);}}else logger[_0x24ea00(0x17c)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger['full'](_0x24ea00(0x28b));}),app[_0x3d1b94(0x34d)](express[_0x3d1b94(0x262)](path[_0x3d1b94(0x1c6)](__dirname,bbpath2,_0x3d1b94(0x2e1)))),app[_0x3d1b94(0x34d)](express[_0x3d1b94(0x262)](path[_0x3d1b94(0x1c6)](__dirname,bbpath2,_0x3d1b94(0x260)))),app['get']('/',function(_0x3ef7bc,_0x175976){const _0x3d48e7=_0x3d1b94;_0x175976['sendFile'](path[_0x3d48e7(0x1c6)](__dirname,bbpath2,_0x3d48e7(0x2e1),_0x3d48e7(0x153)));}),app[_0x3d1b94(0x167)](_0x3d1b94(0x32a),function(_0x5b0bf8,_0x6a2b22){const _0x15e227=_0x3d1b94;_0x6a2b22['sendFile'](path[_0x15e227(0x1c6)](__dirname,bbpath2,'build',_0x15e227(0x153)));}),app[_0x3d1b94(0x167)](_0x3d1b94(0x25a),(_0xff548a,_0x45011f)=>{const _0x2fdb88=_0x3d1b94;_0x45011f[_0x2fdb88(0x151)](path['join'](__dirname,bbpath2,'build',_0x2fdb88(0x153)));}),app[_0x3d1b94(0x167)](_0x3d1b94(0x1cf),(_0x1048b2,_0x24bbca)=>{const _0x315c08=_0x3d1b94;_0x24bbca[_0x315c08(0x151)](path[_0x315c08(0x1c6)](__dirname,bbpath2,_0x315c08(0x260),_0x315c08(0x153)));}),app[_0x3d1b94(0x167)]('/:bot/coins',(_0xa7a705,_0x41bc1c)=>{const _0x2a303b=_0x3d1b94;_0x41bc1c[_0x2a303b(0x151)](path[_0x2a303b(0x1c6)](__dirname,bbpath2,'build','index.html'));}),app['get']('/:bot/history',(_0x6997ec,_0x1a4ac1)=>{const _0x3678f9=_0x3d1b94;_0x1a4ac1['sendFile'](path[_0x3678f9(0x1c6)](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x3d1b94(0x2b0),(_0x259059,_0x585e7d)=>{const _0x742634=_0x3d1b94;_0x585e7d[_0x742634(0x151)](path[_0x742634(0x1c6)](__dirname,bbpath2,_0x742634(0x260),_0x742634(0x153)));}),app['get'](_0x3d1b94(0x313),(_0x45c55a,_0x483cfe)=>{const _0x3d8f43=_0x3d1b94;_0x483cfe[_0x3d8f43(0x151)](path[_0x3d8f43(0x1c6)](__dirname,bbpath2,'build',_0x3d8f43(0x153)));});if(HOST)http[_0x3d1b94(0x355)](PORT,HOST);else http['listen'](PORT);const io=require(_0x3d1b94(0x1c0))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4762f2=_0x3d1b94;let _0x394e9a='[ip-address]';const _0x53e6bd=networkInterfaces(),_0x1df7e6={};for(const _0x2c962d of Object[_0x4762f2(0x178)](_0x53e6bd)){for(const _0x232111 of _0x53e6bd[_0x2c962d]){if((_0x232111[_0x4762f2(0x31a)]==_0x4762f2(0x35b)||_0x232111[_0x4762f2(0x31a)]==0x4)&&!_0x232111[_0x4762f2(0x2fb)]){const _0x9d6583=ipaddr[_0x4762f2(0x359)](_0x232111[_0x4762f2(0x1da)])[_0x4762f2(0x31e)]();_0x9d6583!='private'&&(!_0x1df7e6[_0x2c962d]&&(_0x1df7e6[_0x2c962d]=[]),_0x1df7e6[_0x2c962d][_0x4762f2(0x273)](_0x232111[_0x4762f2(0x1da)]),_0x394e9a=_0x232111['address']);}}}return{'serverip':_0x394e9a,'netinterfaces':_0x1df7e6};}async function startServer(){const _0x3e9061=_0x3d1b94,{serverip:_0x3bce7e,netinterfaces:_0x4dd7f2}=getServerIP();logger[_0x3e9061(0x1ed)](''),logger[_0x3e9061(0x1ed)]('-----------------------------------------------------------------------------------'),await logger[_0x3e9061(0x17c)](_0x3e9061(0x1b5)+serverversion+_0x3e9061(0x26d)+(environment==_0x3e9061(0x1e5)?_0x3e9061(0x1aa):'')+'\x0a'+(_0x3e9061(0x35f)+PORT+_0x3e9061(0x2de))+(_0x3e9061(0x367)+_0x3bce7e+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger['simple'](_0x3e9061(0x32b));if(config[_0x3e9061(0x309)]!=0x0)for(const _0x16d0d7 of config){const _0x116a16=_0x16d0d7[_0x3e9061(0x192)]=='auto'?'a':'m';if(_0x16d0d7[_0x3e9061(0x1c4)]==_0x3e9061(0x1de)||_0x16d0d7[_0x3e9061(0x1c4)]==_0x3e9061(0x247))await logger[_0x3e9061(0x17c)](_0x3e9061(0x252)+_0x116a16+_0x3e9061(0x301)+_0x16d0d7[_0x3e9061(0x31c)]+_0x3e9061(0x25e)+_0x16d0d7[_0x3e9061(0x154)]),startBot([_0x16d0d7['botID'],userID],{'cwd':bbpath},function(_0xd3b1f){const _0x1e84a5=_0x3e9061;if(_0xd3b1f)logger[_0x1e84a5(0x17c)](_0xd3b1f);});else(_0x16d0d7[_0x3e9061(0x1c4)]==_0x3e9061(0x160)||_0x16d0d7['status']==_0x3e9061(0x2a9))&&await logger['full']('Idling\x20('+_0x116a16+_0x3e9061(0x226)+_0x16d0d7[_0x3e9061(0x31c)]+_0x3e9061(0x25e)+_0x16d0d7['botname']);}else!newBot&&logger[_0x3e9061(0x1ed)](_0x3e9061(0x15b));if(newBot)addBot();logger[_0x3e9061(0x1ed)](_0x3e9061(0x32b)),logger[_0x3e9061(0x1ed)](''),await logger[_0x3e9061(0x162)]('Node.js\x20v'+nodeversion),await logger[_0x3e9061(0x162)](_0x3e9061(0x30b),_0x4dd7f2);}function startSocket(){const _0x567b0a=_0x3d1b94;io['on'](_0x567b0a(0x22a),_0x4c8412=>{const _0x1485cc=_0x567b0a;let _0x16ba18,_0x207821,_0x367b86,_0x55e16e,_0x45cdc1;const _0x166679=_0x4c8412[_0x1485cc(0x340)]['headers'][_0x1485cc(0x283)];_0x207821=_0x166679[_0x1485cc(0x1c2)](/bot[0-9]{3}/);if(_0x207821)_0x367b86=_0x207821[0x0]['match'](/[0-9]{3}/);if(_0x367b86)_0x16ba18=_0x367b86[0x0];else _0x16ba18=_0x1485cc(0x21d);const _0x4da216=_0x4c8412[_0x1485cc(0x340)]['auth'][_0x1485cc(0x2ca)];if(!_0x4da216)_0x4c8412['emit'](_0x1485cc(0x1c4),{'publicKey':secure[_0x1485cc(0x239)]});else{_0x55e16e=timelyDecrypt(_0x4da216,![]);if(!_0x55e16e)_0x4c8412[_0x1485cc(0x363)](_0x1485cc(0x1c4),{'publicKey':secure[_0x1485cc(0x239)]});else{_0x45cdc1=normalizeIP(_0x4c8412[_0x1485cc(0x30e)]['remoteAddress'])[_0x1485cc(0x27e)];if(!devices[_0x55e16e])devices[_0x55e16e]={'uuid':_0x55e16e,'access':{'token':null}};devices[_0x55e16e]['ip']=_0x45cdc1;const _0x16d9f5=addClient(_0x4c8412['id'],_0x55e16e,_0x16ba18);setAccess(_0x16d9f5),emitMessages(),_0x4c8412['on']('login',_0x57cf20=>{const _0x50ef2d=_0x1485cc,_0x5ebb3b=timelyDecrypt(_0x57cf20[_0x50ef2d(0x269)],!![],'|@|');if(_0x5ebb3b){_0x57cf20={'username':_0x57cf20[_0x50ef2d(0x244)],'password':_0x5ebb3b},devices[_0x55e16e][_0x50ef2d(0x245)]=validateCredentials(_0x57cf20,_0x55e16e);if(devices[_0x55e16e][_0x50ef2d(0x245)]['allow']==![]&&devices[_0x55e16e][_0x50ef2d(0x245)][_0x50ef2d(0x159)]==_0x50ef2d(0x1ec))_0x4c8412[_0x50ef2d(0x363)](_0x50ef2d(0x1c4),{'access':devices[_0x55e16e][_0x50ef2d(0x245)]}),loginAccess2FA(_0x55e16e,_0x45cdc1);else{if(devices[_0x55e16e][_0x50ef2d(0x245)][_0x50ef2d(0x251)]==![]&&devices[_0x55e16e][_0x50ef2d(0x245)][_0x50ef2d(0x159)]==_0x50ef2d(0x295))_0x4c8412['emit'](_0x50ef2d(0x1c4),{'access':devices[_0x55e16e][_0x50ef2d(0x245)]});else devices[_0x55e16e][_0x50ef2d(0x245)][_0x50ef2d(0x251)]&&devices[_0x55e16e][_0x50ef2d(0x245)]['reason']==_0x50ef2d(0x2ed)&&(getClientsWithUuid(_0x55e16e)[_0x50ef2d(0x240)](_0x2e78a7=>{setAccess(_0x2e78a7);}),logger[_0x50ef2d(0x162)](_0x50ef2d(0x190)+_0x55e16e['slice'](-0x8)),setTokenRefresh(_0x55e16e),setSessionTimeout(_0x50ef2d(0x27a),_0x55e16e));}}else logger[_0x50ef2d(0x17c)](_0x50ef2d(0x25c));}),_0x4c8412['on'](_0x1485cc(0x2c7),()=>{resetPassword();}),_0x4c8412['on'](_0x1485cc(0x246),_0x445098=>{removeClient(_0x4c8412['id']);}),_0x16ba18==_0x1485cc(0x21d)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x20debe){const _0x155c98=_0x3d1b94;if(_0x20debe!=_0x155c98(0x21d)&&config[_0x155c98(0x2fe)]!=''){if(pid[_0x20debe])pid[_0x20debe][_0x155c98(0x225)]({'function':_0x155c98(0x2fd),'args':null});}_0x20debe!='botmanager'&&broadcastToBots(_0x155c98(0x2d0),JSON['stringify'](config));}function reloadBotManager(){const _0x247ca3=_0x3d1b94;getClientsWithBotID(_0x247ca3(0x21d))[_0x247ca3(0x240)](_0x1e4bad=>{const _0x662d5d=_0x247ca3;getSocket(_0x1e4bad['id'])[_0x662d5d(0x363)]('status',{'access':{'allow':![],'reason':_0x662d5d(0x304),'token':null}});});}function getSocket(_0x2fca56){const _0x2b1742=_0x3d1b94,_0x55dc5c=io[_0x2b1742(0x1c1)][_0x2b1742(0x167)]('/');return _0x55dc5c[_0x2b1742(0x2d3)]['get'](_0x2fca56);}function setAccess(_0x17fa11){const _0x1d9f9c=_0x3d1b94,_0x41be65=getSocket(_0x17fa11['id']),_0xc8cc7c=_0x17fa11['uuid'],_0x4a2ccb=_0x17fa11[_0x1d9f9c(0x2d4)];devices[_0xc8cc7c][_0x1d9f9c(0x245)]=validateAccess(devices[_0xc8cc7c][_0x1d9f9c(0x245)]['token'],_0xc8cc7c),logger[_0x1d9f9c(0x162)]('Setting\x20access:\x20'+devices[_0xc8cc7c][_0x1d9f9c(0x245)][_0x1d9f9c(0x159)]+'\x20|\x20client:\x20...'+_0x17fa11['id'][_0x1d9f9c(0x176)](-0x8)+_0x1d9f9c(0x175)+_0xc8cc7c[_0x1d9f9c(0x176)](-0x8)),_0x41be65['join'](_0xc8cc7c);if(devices[_0xc8cc7c][_0x1d9f9c(0x245)]['allow']){_0x41be65[_0x1d9f9c(0x1c6)](_0x4a2ccb);if(_0x4a2ccb==_0x1d9f9c(0x21d))initializeSocketBotManager(_0x41be65);else initializeSocketBot(_0x41be65);initClient(_0x4a2ccb);}devices[_0xc8cc7c][_0x1d9f9c(0x245)][_0x1d9f9c(0x1ce)]&&devices[_0xc8cc7c]['access'][_0x1d9f9c(0x159)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x1d9f9c(0x2db),_0xc8cc7c),devices[_0xc8cc7c][_0x1d9f9c(0x245)][_0x1d9f9c(0x1ce)]&&devices[_0xc8cc7c][_0x1d9f9c(0x245)][_0x1d9f9c(0x159)]==_0x1d9f9c(0x254)&&setSessionTimeout('login',_0xc8cc7c),_0x41be65[_0x1d9f9c(0x363)]('status',{'status':_0x17fa11[_0x1d9f9c(0x268)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xc8cc7c][_0x1d9f9c(0x245)],'externalip':devices[_0xc8cc7c]['ip'],'publicKey':secure['publicKey'],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0xc8cc7c]['access'][_0x1d9f9c(0x251)]==![]&&devices[_0xc8cc7c][_0x1d9f9c(0x245)]['reason']=='2FA\x20required'&&temporaryAccess2FA(_0xc8cc7c,devices[_0xc8cc7c]['ip']);}function setSessionTimeout(_0x1fdafd,_0x5d6ae2){const _0x114c1f=_0x3d1b94;let _0x4a894f;if(_0x1fdafd=='login')_0x4a894f=loginExpiry*0x3c*0x3e8;else _0x4a894f=devices[_0x5d6ae2][_0x114c1f(0x344)][_0x114c1f(0x16e)]*0x3c*0x3e8-(new Date()[_0x114c1f(0x1e1)]()-devices[_0x5d6ae2][_0x114c1f(0x344)][_0x114c1f(0x29f)]);if(devices[_0x5d6ae2][_0x114c1f(0x33f)])clearTimeout(devices[_0x5d6ae2][_0x114c1f(0x33f)]);devices[_0x5d6ae2][_0x114c1f(0x33f)]=setTimeout(()=>{const _0x34b6cb=_0x114c1f;if(devices[_0x5d6ae2][_0x34b6cb(0x16f)])clearTimeout(devices[_0x5d6ae2]['pidRefreshToken']);removeSocketListeners(_0x5d6ae2),addBlacklist(_0x5d6ae2),devices[_0x5d6ae2][_0x34b6cb(0x344)]=null,devices[_0x5d6ae2]['telegram2FaApproval']=null,devices[_0x5d6ae2]['access'][_0x34b6cb(0x1ce)]=null,logger[_0x34b6cb(0x162)](_0x34b6cb(0x163)+_0x5d6ae2[_0x34b6cb(0x176)](-0x8)),devices[_0x5d6ae2][_0x34b6cb(0x245)]=validateAccess(devices[_0x5d6ae2]['access']['token'],_0x5d6ae2),!(devices[_0x5d6ae2]['access'][_0x34b6cb(0x251)]&&devices[_0x5d6ae2][_0x34b6cb(0x245)][_0x34b6cb(0x159)]==_0x34b6cb(0x29b))&&(_0x1fdafd==_0x34b6cb(0x27a)?io['to'](_0x5d6ae2)[_0x34b6cb(0x363)](_0x34b6cb(0x1c4),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x5d6ae2)[_0x34b6cb(0x363)](_0x34b6cb(0x1c4),{'access':{'allow':![],'reason':_0x34b6cb(0x1bd),'token':null}})),devices[_0x5d6ae2][_0x34b6cb(0x245)][_0x34b6cb(0x1ce)]=null;},_0x4a894f);}function setTokenRefresh(_0x2a3e75){const _0x2c0c28=_0x3d1b94;if(devices[_0x2a3e75][_0x2c0c28(0x16f)])clearTimeout(devices[_0x2a3e75][_0x2c0c28(0x16f)]);devices[_0x2a3e75]['pidRefreshToken']=setTimeout(()=>{const _0xed4223=_0x2c0c28;getClientsWithUuid(_0x2a3e75)[_0xed4223(0x309)]!=0x0?(devices[_0x2a3e75]['access']=refreshToken(_0x2a3e75),io['to'](_0x2a3e75)['emit'](_0xed4223(0x1c4),{'status':_0xed4223(0x1d6),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2a3e75][_0xed4223(0x245)],'externalip':devices[_0x2a3e75]['ip'],'publicKey':secure[_0xed4223(0x239)],'validInstallation':validInstallation}),setTokenRefresh(_0x2a3e75)):clearTimeout(devices[_0x2a3e75][_0xed4223(0x16f)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x2e964f){const _0xc0d2d1=_0x3d1b94,_0x44c57c=getClient(_0x2e964f['id'])['uuid'];_0x2e964f[_0xc0d2d1(0x363)]('bots',config),_0x2e964f[_0xc0d2d1(0x363)](_0xc0d2d1(0x328),cleanSettings()),_0x2e964f['on'](_0xc0d2d1(0x28f),_0x29aa4c=>{const _0x5f54e7=_0xc0d2d1;if(validateAccess(_0x29aa4c,_0x44c57c)['allow'])addBot();else logger['full'](_0x5f54e7(0x353));}),_0x2e964f['on'](_0xc0d2d1(0x170),(_0x4ef946,_0x52cfc7)=>{const _0x469017=_0xc0d2d1;if(validateAccess(_0x52cfc7,_0x44c57c)[_0x469017(0x251)])toggleBot(_0x4ef946[_0x469017(0x31c)],_0x4ef946[_0x469017(0x1c4)],_0x4ef946[_0x469017(0x2fa)]);else logger['full'](_0x469017(0x1ea));}),_0x2e964f['on'](_0xc0d2d1(0x2d7),(_0x3be86c,_0x2cb644)=>{const _0x123284=_0xc0d2d1;if(validateAccess(_0x2cb644,_0x44c57c)[_0x123284(0x251)])toggleBotMode(_0x3be86c);else logger[_0x123284(0x17c)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x2e964f['on'](_0xc0d2d1(0x216),(_0x1c7869,_0x16d6b4)=>{const _0x3023bd=_0xc0d2d1;if(validateAccess(_0x16d6b4,_0x44c57c)[_0x3023bd(0x251)])deleteBot(_0x1c7869);else logger[_0x3023bd(0x17c)](_0x3023bd(0x24c));}),_0x2e964f['on'](_0xc0d2d1(0x350),(_0x3b1cb9,_0xc12833)=>{const _0x531612=_0xc0d2d1;if(validateAccess(_0xc12833,_0x44c57c)['allow'])storeSettings(_0x3b1cb9,!![]);else logger['full'](_0x531612(0x1f8));}),_0x2e964f['on']('update-bb',_0x350b72=>{const _0x2d05c2=_0xc0d2d1;if(validateAccess(_0x350b72,_0x44c57c)[_0x2d05c2(0x251)])updateBB(_0x2d05c2(0x1ca));else logger[_0x2d05c2(0x17c)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x2e964f['on'](_0xc0d2d1(0x1c9),_0x26d858=>{const _0x15d381=_0xc0d2d1;if(validateAccess(_0x26d858,_0x44c57c)[_0x15d381(0x251)])updateBB(_0x15d381(0x22b));else logger[_0x15d381(0x17c)](_0x15d381(0x15c));}),_0x2e964f['on']('get-backup-files',_0x17f494=>{const _0x102556=_0xc0d2d1;if(validateAccess(_0x17f494,_0x44c57c)['allow']){const _0x5ec4d3=getClient(_0x2e964f['id']);if(_0x5ec4d3)getBackupFiles(_0x5ec4d3[_0x102556(0x2ff)]);else logger[_0x102556(0x17c)](_0x102556(0x289));}else logger[_0x102556(0x17c)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x2e964f['on']('restore-backup-file',(_0x45e409,_0xd5f9d)=>{const _0x50472d=_0xc0d2d1;if(validateAccess(_0xd5f9d,_0x44c57c)[_0x50472d(0x251)])restoreBackupFile(_0x45e409);else logger[_0x50472d(0x17c)](_0x50472d(0x266));}),_0x2e964f['on']('get-messages',_0x1ef4f6=>{const _0x2518e6=_0xc0d2d1;if(validateAccess(_0x1ef4f6,_0x44c57c)[_0x2518e6(0x251)])getMessages();else logger[_0x2518e6(0x17c)](_0x2518e6(0x2f9));}),_0x2e964f['on'](_0xc0d2d1(0x1d3),(_0x118be6,_0x48e237)=>{const _0xaee01b=_0xc0d2d1;if(validateAccess(_0x48e237,_0x44c57c)[_0xaee01b(0x251)])confirmMessage(_0x118be6);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x2e964f['on']('logout',_0x29f3c4=>{const _0x4bbcf7=_0xc0d2d1;if(validateAccess(_0x29f3c4,_0x44c57c)[_0x4bbcf7(0x251)]){if(devices[_0x44c57c][_0x4bbcf7(0x16f)])clearTimeout(devices[_0x44c57c][_0x4bbcf7(0x16f)]);if(devices[_0x44c57c][_0x4bbcf7(0x33f)])clearTimeout(devices[_0x44c57c][_0x4bbcf7(0x33f)]);removeSocketListeners(getClient(_0x2e964f['id'])['uuid']),addBlacklist(_0x44c57c),devices[_0x44c57c]['telegramIpApproval']=null,devices[_0x44c57c][_0x4bbcf7(0x314)]=null,devices[_0x44c57c][_0x4bbcf7(0x245)][_0x4bbcf7(0x1ce)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x44c57c['slice'](-0x8)),io['to'](getClient(_0x2e964f['id'])[_0x4bbcf7(0x2ff)])[_0x4bbcf7(0x363)](_0x4bbcf7(0x1c4),{'access':{'allow':![],'reason':_0x4bbcf7(0x1a6),'token':null}});}else logger[_0x4bbcf7(0x17c)](_0x4bbcf7(0x16b));});}function initializeSocketBot(_0x223071){const _0x3d62b5=_0x3d1b94,_0x2244cf=getClient(_0x223071['id'])['bot'],_0x2fb87a=getClient(_0x223071['id'])[_0x3d62b5(0x2ff)];_0x223071['on']('get-logs',(_0x145b16,_0x7304ee)=>{const _0x59e0b7=_0x3d62b5;if(validateAccess(_0x7304ee,_0x2fb87a)[_0x59e0b7(0x251)]){if(pid[_0x2244cf])pid[_0x2244cf][_0x59e0b7(0x225)]({'function':'emitHistory','args':_0x145b16});}else logger[_0x59e0b7(0x17c)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x223071['on']('delete-alerts',(_0x1b25a5,_0x3b7542)=>{const _0x327045=_0x3d62b5;if(validateAccess(_0x3b7542,_0x2fb87a)['allow']){if(pid[_0x2244cf])pid[_0x2244cf][_0x327045(0x225)]({'function':_0x327045(0x360),'args':_0x1b25a5});}else logger[_0x327045(0x17c)](_0x327045(0x243));}),_0x223071['on']('get-portfolio',(_0x4b1391,_0x26039b)=>{const _0x4feacf=_0x3d62b5;if(validateAccess(_0x26039b,_0x2fb87a)[_0x4feacf(0x251)]){if(pid[_0x2244cf])pid[_0x2244cf]['send']({'function':_0x4feacf(0x322),'args':_0x4b1391});}else logger[_0x4feacf(0x17c)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x223071['on'](_0x3d62b5(0x29c),(_0xc98395,_0x31ce8f)=>{const _0x10ea62=_0x3d62b5;if(validateAccess(_0x31ce8f,_0x2fb87a)[_0x10ea62(0x251)]){if(pid[_0x2244cf])pid[_0x2244cf]['send']({'function':_0x10ea62(0x2ae),'args':_0xc98395});}else logger[_0x10ea62(0x17c)](_0x10ea62(0x34b));}),_0x223071['on']('store-headless',(_0x2a3b3e,_0x27bf2f)=>{const _0x2447d8=_0x3d62b5;if(validateAccess(_0x27bf2f,_0x2fb87a)[_0x2447d8(0x251)]){if(pid[_0x2244cf])pid[_0x2244cf]['send']({'function':_0x2447d8(0x2c1),'args':_0x2a3b3e});}else logger[_0x2447d8(0x17c)](_0x2447d8(0x17e));}),_0x223071['on'](_0x3d62b5(0x173),(_0x3fff2b,_0x5d9d70)=>{const _0x8b5217=_0x3d62b5;if(validateAccess(_0x5d9d70,_0x2fb87a)['allow']){if(pid[_0x2244cf])pid[_0x2244cf][_0x8b5217(0x225)]({'function':_0x8b5217(0x1ab),'args':_0x3fff2b});}else logger[_0x8b5217(0x17c)](_0x8b5217(0x188));}),_0x223071['on'](_0x3d62b5(0x196),_0x4b1228=>{const _0xb53ea9=_0x3d62b5;if(validateAccess(_0x4b1228,_0x2fb87a)[_0xb53ea9(0x251)]){if(pid[_0x2244cf])pid[_0x2244cf][_0xb53ea9(0x225)]({'function':_0xb53ea9(0x35e),'args':null});}else logger[_0xb53ea9(0x17c)](_0xb53ea9(0x18d));}),_0x223071['on']('get-starting-balances',_0xf18ac6=>{const _0x55e03c=_0x3d62b5;if(validateAccess(_0xf18ac6,_0x2fb87a)[_0x55e03c(0x251)]){if(pid[_0x2244cf])pid[_0x2244cf][_0x55e03c(0x225)]({'function':_0x55e03c(0x2e9),'args':null});}else logger[_0x55e03c(0x17c)](_0x55e03c(0x235));}),_0x223071['on']('place-order',(_0x142140,_0x4e4382)=>{const _0x1f3b0f=_0x3d62b5;if(validateAccess(_0x4e4382,_0x2fb87a)[_0x1f3b0f(0x251)]){if(pid[_0x2244cf])pid[_0x2244cf]['send']({'function':_0x1f3b0f(0x315),'args':_0x142140});}else logger[_0x1f3b0f(0x17c)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x223071['on'](_0x3d62b5(0x232),_0x3163ec=>{const _0x134962=_0x3d62b5;if(validateAccess(_0x3163ec,_0x2fb87a)[_0x134962(0x251)]){if(pid[_0x2244cf])pid[_0x2244cf][_0x134962(0x225)]({'function':'cancelLoading','args':null});}else logger[_0x134962(0x17c)](_0x134962(0x349));}),_0x223071['on'](_0x3d62b5(0x1ff),_0x580026=>{const _0x50f6ca=_0x3d62b5;if(validateAccess(_0x580026,_0x2fb87a)[_0x50f6ca(0x251)]){if(pid[_0x2244cf])pid[_0x2244cf][_0x50f6ca(0x225)]({'function':_0x50f6ca(0x228),'args':null});}else logger[_0x50f6ca(0x17c)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x223071['on'](_0x3d62b5(0x2c5),_0x5c10e8=>{const _0xe5e724=_0x3d62b5;if(validateAccess(_0x5c10e8,_0x2fb87a)[_0xe5e724(0x251)])updateBB(_0xe5e724(0x1ca));else logger['full'](_0xe5e724(0x2d1));}),_0x223071['on'](_0x3d62b5(0x168),_0x5f2834=>{if(validateAccess(_0x5f2834,_0x2fb87a)['allow'])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x223071['on'](_0x3d62b5(0x1d3),(_0x72447d,_0x31fdfc)=>{const _0x42a532=_0x3d62b5;if(validateAccess(_0x31fdfc,_0x2fb87a)[_0x42a532(0x251)])confirmMessage(_0x72447d);else logger[_0x42a532(0x17c)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x223071['on'](_0x3d62b5(0x152),_0x4405a0=>{const _0x56642e=_0x3d62b5;if(validateAccess(_0x4405a0,_0x2fb87a)['allow']){if(devices[_0x2fb87a]['pidRefreshToken'])clearTimeout(devices[_0x2fb87a][_0x56642e(0x16f)]);if(devices[_0x2fb87a][_0x56642e(0x33f)])clearTimeout(devices[_0x2fb87a][_0x56642e(0x33f)]);removeSocketListeners(getClient(_0x223071['id'])['uuid']),addBlacklist(_0x2fb87a),devices[_0x2fb87a][_0x56642e(0x344)]=null,devices[_0x2fb87a][_0x56642e(0x314)]=null,devices[_0x2fb87a][_0x56642e(0x245)][_0x56642e(0x1ce)]=null,logger[_0x56642e(0x162)](_0x56642e(0x2bf)+_0x2fb87a[_0x56642e(0x176)](-0x8)),io['to'](getClient(_0x223071['id'])['uuid'])['emit'](_0x56642e(0x1c4),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x56642e(0x17c)](_0x56642e(0x16b));});}function removeSocketListeners(_0x102ef5){const _0x3b689b=_0x3d1b94;getClientsWithUuid(_0x102ef5)[_0x3b689b(0x240)](_0x4215ec=>{const _0x4245ee=_0x3b689b;getSocket(_0x4215ec['id'])[_0x4245ee(0x227)]();});}function cleanSettings(){const _0x4de387=_0x3d1b94;let _0x489f16=settings;return settings[_0x4de387(0x303)]&&settings[_0x4de387(0x303)]!=''&&(_0x489f16={..._0x489f16,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x4de387(0x343)]!=''&&(_0x489f16={..._0x489f16,'bbPassword':_0x4de387(0x16c)}),settings[_0x4de387(0x2e6)]&&settings[_0x4de387(0x2e6)]!=''&&(_0x489f16={..._0x489f16,'marketcapApi':_0x4de387(0x16c)}),(settings[_0x4de387(0x343)]&&settings[_0x4de387(0x343)]==_0x4de387(0x263)||settings[_0x4de387(0x303)]&&settings[_0x4de387(0x303)]==_0x4de387(0x263)||settings[_0x4de387(0x2e6)]&&settings[_0x4de387(0x2e6)]==_0x4de387(0x263))&&(_0x489f16={..._0x489f16,'restored':{'password':settings[_0x4de387(0x343)]=='***','telegram':settings['telegramToken']=='***','marketcap':settings[_0x4de387(0x2e6)]==_0x4de387(0x263)}}),_0x489f16;}async function updateBB(_0x9b0876){const _0x10611a=_0x3d1b94;await backupConfigFiles(),installingUpdate=!![],config[_0x10611a(0x240)](_0x1646b6=>{const _0x571aee=_0x10611a;restartBot(_0x1646b6[_0x571aee(0x31c)]);});if(_0x9b0876=='update')process['send']({'update':!![],'environment':environment},_0x594da4=>{});else _0x9b0876=='reinstall'&&process[_0x10611a(0x225)]({'reinstall':!![],'environment':environment},_0x3671b1=>{});}function startBot(_0x5e0fdb,_0x11dd43,_0x5e243d){const _0x25e753=_0x3d1b94;if(debugging)_0x5e0fdb[_0x25e753(0x273)]('-d');if(recreate)_0x5e0fdb[_0x25e753(0x273)]('-r');let _0x514152=![];const _0x25c33b=_0x5e0fdb[0x0];_0x11dd43={..._0x11dd43,'stdio':['inherit',_0x25e753(0x199),_0x25e753(0x199),'ipc']},pid[_0x25c33b]=childProcess[_0x25e753(0x15f)](botfile,_0x5e0fdb,_0x11dd43),pid[_0x25c33b]['on'](_0x25e753(0x2ee),_0xf0c7da=>{const _0x3f7287=_0x25e753;switch(Object[_0x3f7287(0x178)](_0xf0c7da)[0x0]){case _0x3f7287(0x154):updateBotName(_0x25c33b,_0xf0c7da['botname']);break;case _0x3f7287(0x29e):updateBotManager();break;case'status':updateStatus(_0x25c33b,_0xf0c7da['status']);break;case _0x3f7287(0x2fa):updateLive(_0x25c33b,_0xf0c7da[_0x3f7287(0x2fa)]);break;case'started':updateLive(_0x25c33b,_0xf0c7da[_0x3f7287(0x286)]),io['to'](_0x25c33b)['emit'](_0x3f7287(0x1c4),{'access':{'allow':![],'reason':_0x3f7287(0x304),'token':null}});break;case _0x3f7287(0x28a):_0xf0c7da[_0x3f7287(0x28a)]==_0x3f7287(0x278)&&restartBot(_0x25c33b);_0xf0c7da[_0x3f7287(0x28a)]==_0x3f7287(0x258)&&toggleBot(_0x25c33b,_0x3f7287(0x160),_0x3f7287(0x203));break;case _0x3f7287(0x339):sendTelegramBot(_0x25c33b,_0xf0c7da[_0x3f7287(0x339)]);break;case _0x3f7287(0x33d):sendTelegramMsg(_0xf0c7da[_0x3f7287(0x33d)]);break;case _0x3f7287(0x1f2):io['to'](_0x25c33b)[_0x3f7287(0x363)](_0xf0c7da[_0x3f7287(0x1f2)],_0xf0c7da['args']);break;}}),pid[_0x25c33b]['on'](_0x25e753(0x2f5),function(_0x54910c){if(_0x514152)return;_0x514152=!![],_0x5e243d(_0x54910c);}),pid[_0x25c33b]['on'](_0x25e753(0x193),async function(_0x109950){const _0x1ee4c2=_0x25e753;if(terminating)return;if(installingUpdate){io['close']();return;}if(_0x514152)return;_0x514152=!![],_0x5e243d(null);const _0x464e5f=dbConfig['get'](_0x1ee4c2(0x2d0))[_0x1ee4c2(0x2c3)]({'botID':_0x25c33b})['value']();_0x464e5f&&(_0x464e5f['status']==_0x1ee4c2(0x1de)||_0x464e5f[_0x1ee4c2(0x1c4)]==_0x1ee4c2(0x247))&&(await sleep(0x3e8),updateLive(_0x25c33b,_0x1ee4c2(0x203)),logger['full'](_0x1ee4c2(0x30a)+_0x25c33b),startBot([_0x25c33b,userID],{'cwd':bbpath},function(_0x5cec92){const _0x459fbe=_0x1ee4c2;if(_0x5cec92)logger[_0x459fbe(0x17c)](_0x5cec92);}));});}function stopBot(_0x58859f){getClientsWithBotID(_0x58859f)['forEach'](_0x5ce7f0=>{const _0x94e0f7=_0x5cc6;getSocket(_0x5ce7f0['id'])[_0x94e0f7(0x246)](!![]),removeClient(_0x5ce7f0['id']);}),pid[_0x58859f]&&(pid[_0x58859f]['kill'](),pid[_0x58859f]=null);}function stopAllBots(){const _0x13ed52=_0x3d1b94;terminating=!![];const _0x50c278=getEnabledBots();_0x50c278[_0x13ed52(0x240)](_0x3a63c2=>{const _0x24fede=_0x13ed52;stopBot(_0x3a63c2[_0x24fede(0x31c)]);});}function restartBot(_0x1caf3a){const _0x26e1a2=_0x3d1b94;if(pid[_0x1caf3a])pid[_0x1caf3a][_0x26e1a2(0x258)]();}function addBot(){const _0x28c78f=_0x3d1b94;let _0x37c70e;for(let _0xac48ed=0x1;_0xac48ed<0x3e9;_0xac48ed++){_0x37c70e=_0xac48ed['toString']()[_0x28c78f(0x30c)](0x3,'0');let _0x28aaed=config[_0x28c78f(0x2c3)](_0x5697f5=>_0x5697f5[_0x28c78f(0x31c)]==_0x37c70e);if(!_0x28aaed)break;}if(_0x37c70e==='1000'){logger[_0x28c78f(0x17c)](_0x28c78f(0x26c));return;}logger[_0x28c78f(0x17c)](_0x28c78f(0x312)+_0x37c70e),dbConfig[_0x28c78f(0x167)](_0x28c78f(0x2d0))['push']({'botID':_0x37c70e,'botname':_0x28c78f(0x335)+_0x37c70e,'status':_0x28c78f(0x247),'live':''})[_0x28c78f(0x326)](),startBot([_0x37c70e,userID],{'cwd':bbpath},function(_0x1cdfaf){const _0x308303=_0x28c78f;if(_0x1cdfaf)logger[_0x308303(0x17c)](_0x1cdfaf);}),config=getConfiguration(),io['to']('botmanager')['emit'](_0x28c78f(0x2d0),config),broadcastToBots(_0x28c78f(0x2d0),JSON[_0x28c78f(0x1c8)](config));}function deleteBot(_0x1d66ae){const _0x315100=_0x3d1b94;getClientsWithBotID(_0x1d66ae)['forEach'](_0x2e7898=>{const _0x160d72=_0x5cc6;getSocket(_0x2e7898['id'])[_0x160d72(0x246)](!![]),removeClient(_0x2e7898['id']);}),dbConfig[_0x315100(0x167)](_0x315100(0x2d0))[_0x315100(0x342)]({'botID':_0x1d66ae})[_0x315100(0x326)](),logger[_0x315100(0x17c)](_0x315100(0x2b9)+_0x1d66ae),stopBot(_0x1d66ae);try{if(fs[_0x315100(0x2e3)](path[_0x315100(0x1c6)](configpath,_0x315100(0x33e)+_0x1d66ae+_0x315100(0x306))))fs[_0x315100(0x157)](path[_0x315100(0x1c6)](configpath,_0x315100(0x33e)+_0x1d66ae+_0x315100(0x306)));if(fs[_0x315100(0x2e3)](path[_0x315100(0x1c6)](configpath,_0x315100(0x33e)+_0x1d66ae+_0x315100(0x2be))))fs[_0x315100(0x157)](path[_0x315100(0x1c6)](configpath,_0x315100(0x33e)+_0x1d66ae+_0x315100(0x2be)));if(fs[_0x315100(0x2e3)](path[_0x315100(0x1c6)](configpath,_0x315100(0x33e)+_0x1d66ae+_0x315100(0x1a2))))fs[_0x315100(0x157)](path['join'](configpath,'bot-'+_0x1d66ae+_0x315100(0x1a2)));if(fs[_0x315100(0x2e3)](path[_0x315100(0x1c6)](configpath,_0x315100(0x33e)+_0x1d66ae+'-results.json')))fs[_0x315100(0x157)](path[_0x315100(0x1c6)](configpath,_0x315100(0x33e)+_0x1d66ae+_0x315100(0x1b1)));}catch(_0x94b0b8){if(_0x94b0b8)logger[_0x315100(0x17c)](_0x315100(0x345),_0x94b0b8);}config=getConfiguration(),io['to']('botmanager')[_0x315100(0x363)](_0x315100(0x2d0),config),broadcastToBots('bots',JSON[_0x315100(0x1c8)](config));}function toggleBot(_0x4e9207,_0x2b3e64,_0x50e44f){const _0x57705f=_0x3d1b94;dbConfig['get']('bots')[_0x57705f(0x2c3)]({'botID':_0x4e9207})['assign']({'status':_0x2b3e64})[_0x57705f(0x28d)]({'live':_0x50e44f})['write']();if(_0x2b3e64==_0x57705f(0x1de)||_0x2b3e64==_0x57705f(0x247))logger['full']('Enabled\x20Bot\x20'+_0x4e9207),startBot([_0x4e9207,userID],{'cwd':bbpath},function(_0x59d457){const _0x33646c=_0x57705f;if(_0x59d457)logger[_0x33646c(0x17c)](_0x59d457);});else(_0x2b3e64==_0x57705f(0x160)||_0x2b3e64==_0x57705f(0x2a9))&&(logger[_0x57705f(0x17c)]('Disabled\x20Bot\x20'+_0x4e9207),stopBot(_0x4e9207));config=getConfiguration(),io['to'](_0x57705f(0x21d))['emit'](_0x57705f(0x2d0),config),broadcastToBots(_0x57705f(0x2d0),JSON['stringify'](config));}function toggleStatus(_0x3af14d){const _0x324bdc=_0x3d1b94;let _0x484bc2=dbConfig['get'](_0x324bdc(0x2d0))[_0x324bdc(0x2c3)]({'botID':_0x3af14d})[_0x324bdc(0x267)](),_0x4e5efa;if(_0x484bc2[_0x324bdc(0x1c4)]===_0x324bdc(0x1de))_0x4e5efa=_0x324bdc(0x160);else{if(_0x484bc2[_0x324bdc(0x1c4)]===_0x324bdc(0x247))_0x4e5efa='new-disabled';else{if(_0x484bc2[_0x324bdc(0x1c4)]===_0x324bdc(0x2a9))_0x4e5efa='new';else{if(_0x484bc2[_0x324bdc(0x1c4)]==='disabled')_0x4e5efa=_0x324bdc(0x1de);}}}return _0x4e5efa;}function updateStatus(_0x25269a,_0x2c537b){const _0x1af9d9=_0x3d1b94;dbConfig[_0x1af9d9(0x167)](_0x1af9d9(0x2d0))[_0x1af9d9(0x2c3)]({'botID':_0x25269a})[_0x1af9d9(0x28d)]({'status':_0x2c537b})[_0x1af9d9(0x326)](),config=getConfiguration(),io['to'](_0x1af9d9(0x21d))[_0x1af9d9(0x363)](_0x1af9d9(0x2d0),config),broadcastToBots(_0x1af9d9(0x2d0),JSON[_0x1af9d9(0x1c8)](config));}function updateLive(_0x23e835,_0x53837e){const _0x2a565c=_0x3d1b94;dbConfig[_0x2a565c(0x167)](_0x2a565c(0x2d0))[_0x2a565c(0x2c3)]({'botID':_0x23e835})[_0x2a565c(0x28d)]({'live':_0x53837e})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x2a565c(0x363)]('bots',config),broadcastToBots(_0x2a565c(0x2d0),JSON['stringify'](config));}function updateBotName(_0x270e08,_0x3aa5ef){const _0x15f651=_0x3d1b94;dbConfig[_0x15f651(0x167)](_0x15f651(0x2d0))[_0x15f651(0x2c3)]({'botID':_0x270e08})[_0x15f651(0x28d)]({'botname':_0x3aa5ef})[_0x15f651(0x326)](),config=getConfiguration(),io['to'](_0x15f651(0x21d))[_0x15f651(0x363)]('bots',config),broadcastToBots(_0x15f651(0x2d0),JSON['stringify'](config));}function updateBotManager(){const _0x3a85f5=_0x3d1b94;config=getConfiguration(),io['to']('botmanager')[_0x3a85f5(0x363)](_0x3a85f5(0x2d0),config),broadcastToBots(_0x3a85f5(0x2d0),JSON['stringify'](config));}function toggleBotMode(_0x1d20df){const _0x18739d=_0x3d1b94;if(pid[_0x1d20df])pid[_0x1d20df][_0x18739d(0x225)]({'function':'toggleBotMode','args':null});else{const _0x507d7c=configpath+_0x18739d(0x33e)+_0x1d20df+_0x18739d(0x306),_0x39fa13=fs[_0x18739d(0x27f)](_0x507d7c),_0x28e0e8=JSON[_0x18739d(0x359)](_0x39fa13),_0x23acde=_0x28e0e8[_0x18739d(0x2d4)][0x0][_0x18739d(0x25d)];_0x28e0e8[_0x18739d(0x2d4)][0x0][_0x18739d(0x25d)]=!_0x23acde;const _0xfcf533=JSON[_0x18739d(0x1c8)](_0x28e0e8,null,0x2);fs[_0x18739d(0x1e6)](_0x507d7c,_0xfcf533),config=getConfiguration(),io['to']('botmanager')['emit'](_0x18739d(0x2d0),config),broadcastToBots(_0x18739d(0x2d0),JSON[_0x18739d(0x1c8)](config));}}function validateTelegram(_0x176fb1){const _0x5f4226=_0x3d1b94;if(_0x176fb1[_0x5f4226(0x233)][_0x5f4226(0x244)]!=settings[_0x5f4226(0x294)]&&'@'+_0x176fb1[_0x5f4226(0x233)][_0x5f4226(0x244)]!=settings[_0x5f4226(0x294)]||_0x176fb1['chat']['id']!=settings['telegramChatId'])return sendTelegram(_0x176fb1['chat']['id'],_0x5f4226(0x2fc),{'parse_mode':_0x5f4226(0x22d)}),![];return!![];}async function initTelegram(){const _0x2795d9=_0x3d1b94;tgBot&&(await tgBot[_0x2795d9(0x28a)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x2795d9(0x303)]);let _0x1c0475=_0x2795d9(0x365);_0x1c0475+='\x0a',_0x1c0475+=_0x2795d9(0x20c),_0x1c0475+=_0x2795d9(0x19c),_0x1c0475+=_0x2795d9(0x174),_0x1c0475+='/restart\x20-\x20restart\x20bot(s)\x0a',_0x1c0475+=_0x2795d9(0x165),_0x1c0475+=_0x2795d9(0x2d8),_0x1c0475+=_0x2795d9(0x201),_0x1c0475+=_0x2795d9(0x27b),_0x1c0475+=_0x2795d9(0x182),_0x1c0475+=_0x2795d9(0x2e8),_0x1c0475+=_0x2795d9(0x2a4),_0x1c0475+=_0x2795d9(0x202),_0x1c0475+=_0x2795d9(0x1a5),_0x1c0475+=_0x2795d9(0x279),_0x1c0475+=_0x2795d9(0x1e4),_0x1c0475+=_0x2795d9(0x33b);let _0x2bd49e='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x2bd49e+='\x0a',_0x2bd49e+=_0x1c0475,tgBot['catch']((_0x5e5092,_0x32606d)=>{const _0x598be1=_0x2795d9;logger[_0x598be1(0x1ed)](getTimeStamp()+_0x598be1(0x2b3)),logger['debug'](_0x598be1(0x242),_0x5e5092);}),tgBot[_0x2795d9(0x34d)](async(_0xea34d9,_0xb0b8d5)=>{const _0x4b5044=_0x2795d9;if(settings[_0x4b5044(0x1b4)]||_0xea34d9[_0x4b5044(0x1ca)][_0x4b5044(0x2ee)][_0x4b5044(0x2b4)]!='/start'){if(!validateTelegram(_0xea34d9))return;}_0xb0b8d5();}),tgBot[_0x2795d9(0x200)]('start',async _0x1bf10d=>{const _0x6a9ab9=_0x2795d9;if(_0x1bf10d['from'][_0x6a9ab9(0x244)]==settings[_0x6a9ab9(0x294)]||'@'+_0x1bf10d['from'][_0x6a9ab9(0x244)]==settings[_0x6a9ab9(0x294)]){if(!settings['telegramChatId'])updateSetting(_0x6a9ab9(0x1b4),_0x1bf10d[_0x6a9ab9(0x21e)]['id']);else{if(!validateTelegram(_0x1bf10d))return;}}else{if(!validateTelegram(_0x1bf10d))return;}updateSetting(_0x6a9ab9(0x346),!![]),await sendTelegram(_0x1bf10d[_0x6a9ab9(0x21e)]['id'],_0x2bd49e);}),tgBot[_0x2795d9(0x200)](_0x2795d9(0x27d),async _0x2d44ff=>{const _0x2c2399=_0x2795d9;updateSetting(_0x2c2399(0x346),!![]),await sendTelegram(_0x2d44ff[_0x2c2399(0x21e)]['id'],_0x2c2399(0x25f));}),tgBot[_0x2795d9(0x200)]('disable',async _0xa5b294=>{const _0x4ded63=_0x2795d9;await sendTelegram(_0xa5b294[_0x4ded63(0x21e)]['id'],_0x4ded63(0x15e)),updateSetting(_0x4ded63(0x346),![]);}),tgBot[_0x2795d9(0x200)](_0x2795d9(0x229),async _0x3670c8=>{const _0x15c902=_0x2795d9,_0x401039=Markup[_0x15c902(0x2c9)]([Markup[_0x15c902(0x20e)][_0x15c902(0x1a7)]('Orders','config_orders'),Markup[_0x15c902(0x20e)][_0x15c902(0x1a7)](_0x15c902(0x1b0),_0x15c902(0x31b)),Markup[_0x15c902(0x20e)][_0x15c902(0x1a7)](_0x15c902(0x183),_0x15c902(0x248))]);_0x3670c8['reply'](_0x15c902(0x24b),_0x401039);}),tgBot['action'](_0x2795d9(0x2c2),async _0x1db261=>{const _0x5c3ebf=_0x2795d9;_0x1db261[_0x5c3ebf(0x16a)](),updateSetting('telegramEvents',_0x5c3ebf(0x311)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1db261[_0x5c3ebf(0x21e)]['id'],_0x5c3ebf(0x21a));}),tgBot[_0x2795d9(0x277)](_0x2795d9(0x31b),async _0x208fc2=>{const _0x3f0cfb=_0x2795d9;_0x208fc2[_0x3f0cfb(0x16a)](),updateSetting(_0x3f0cfb(0x2c4),_0x3f0cfb(0x1e2)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x208fc2[_0x3f0cfb(0x21e)]['id'],_0x3f0cfb(0x27c));}),tgBot[_0x2795d9(0x277)]('config_all',async _0x3390a9=>{const _0x20f9c7=_0x2795d9;_0x3390a9[_0x20f9c7(0x16a)](),updateSetting(_0x20f9c7(0x2c4),_0x20f9c7(0x2c6)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x3390a9[_0x20f9c7(0x21e)]['id'],_0x20f9c7(0x337));}),tgBot[_0x2795d9(0x200)](_0x2795d9(0x1c4),async _0x2ca9c3=>{const _0xbf068e=_0x2795d9,_0x5216f0=getBotsWithMode();let _0x4be351=_0xbf068e(0x238);config[_0xbf068e(0x240)](_0x3939c0=>{const _0x923888=_0xbf068e,_0x114828=_0x5216f0[_0x923888(0x2c3)](_0xc2d5b8=>_0xc2d5b8[_0x923888(0x31c)]==_0x3939c0['botID'])['mode'];_0x4be351+='Bot\x20'+_0x3939c0['botID']+':\x20'+_0x3939c0['status']+_0x923888(0x25e)+_0x114828+'\x20|\x20'+_0x3939c0[_0x923888(0x2fa)]+'\x0a';}),_0x4be351+='\x0a',_0x4be351+=_0xbf068e(0x1fd),_0x4be351+=!settings[_0xbf068e(0x346)]?_0xbf068e(0x1df):_0xbf068e(0x1a8),_0x4be351+=settings['telegramEnabled']?settings[_0xbf068e(0x2c4)]==_0xbf068e(0x2c6)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0xbf068e(0x2c4)]+_0xbf068e(0x2ce):'',await sendTelegram(_0x2ca9c3[_0xbf068e(0x21e)]['id'],_0x4be351,{'parse_mode':'HTML'});}),tgBot[_0x2795d9(0x200)](_0x2795d9(0x278),async _0x6aa0ab=>{const _0x52ebcb=_0x2795d9,_0x53fe0a=getEnabledBots();if(_0x53fe0a[_0x52ebcb(0x309)]==0x0)await sendTelegram(_0x6aa0ab[_0x52ebcb(0x21e)]['id'],_0x52ebcb(0x290));else{if(_0x53fe0a[_0x52ebcb(0x309)]>0x1)_0x53fe0a['push']({'botID':_0x52ebcb(0x2c6)});let _0x242890=[],_0xb05734=[];const _0x13a16a=_0x53fe0a[_0x52ebcb(0x309)]%0x4==0x0||_0x53fe0a[_0x52ebcb(0x309)]%0x4==0x3||_0x53fe0a[_0x52ebcb(0x309)]%0x3==0x1?0x4:0x3;let _0x5740cb=0x0;_0x53fe0a[_0x52ebcb(0x240)]((_0x479715,_0xbe5b07)=>{const _0x1be4ba=_0x52ebcb;if(_0xbe5b07%_0x13a16a==0x0)_0xb05734=[];_0xb05734[_0x1be4ba(0x273)](Markup[_0x1be4ba(0x20e)][_0x1be4ba(0x1a7)](_0x479715['botID']=='all'?_0x1be4ba(0x155):_0x1be4ba(0x335)+_0x479715[_0x1be4ba(0x31c)],_0x1be4ba(0x2d6)+_0x479715[_0x1be4ba(0x31c)])),_0xbe5b07%_0x13a16a==0x0&&(_0x242890[_0x5740cb]=_0xb05734,_0x5740cb++);});const _0xf89d18=Markup['inlineKeyboard'](_0x242890);_0x6aa0ab[_0x52ebcb(0x206)](_0x52ebcb(0x24d),_0xf89d18);}}),tgBot['action'](/restart_(.+)/,async _0x478153=>{const _0x26c1ba=_0x2795d9,_0x192f02=_0x478153[_0x26c1ba(0x1c2)][0x1];_0x478153[_0x26c1ba(0x16a)](),_0x192f02==_0x26c1ba(0x2c6)?config[_0x26c1ba(0x240)](_0x72eee4=>{const _0x507c56=_0x26c1ba;restartBot(_0x72eee4[_0x507c56(0x31c)]);}):restartBot(_0x192f02);}),tgBot[_0x2795d9(0x200)]('on',async _0x3715d0=>{const _0x5947c0=_0x2795d9,_0x34d437=getDisabledBots();if(_0x34d437[_0x5947c0(0x309)]==0x0)await sendTelegram(_0x3715d0[_0x5947c0(0x21e)]['id'],_0x5947c0(0x1cd));else{if(_0x34d437['length']>0x1)_0x34d437[_0x5947c0(0x273)]({'botID':_0x5947c0(0x2c6)});let _0x14e5e1=[],_0x1486d0=[];const _0x38e071=_0x34d437['length']%0x4==0x0||_0x34d437[_0x5947c0(0x309)]%0x4==0x3||_0x34d437[_0x5947c0(0x309)]%0x3==0x1?0x4:0x3;let _0x2e2333=0x0;_0x34d437['forEach']((_0x57e58c,_0xad8709)=>{const _0x55aea9=_0x5947c0;if(_0xad8709%_0x38e071==0x0)_0x1486d0=[];_0x1486d0[_0x55aea9(0x273)](Markup[_0x55aea9(0x20e)][_0x55aea9(0x1a7)](_0x57e58c[_0x55aea9(0x31c)]==_0x55aea9(0x2c6)?_0x55aea9(0x155):_0x55aea9(0x335)+_0x57e58c[_0x55aea9(0x31c)],_0x55aea9(0x220)+_0x57e58c[_0x55aea9(0x31c)])),_0xad8709%_0x38e071==0x0&&(_0x14e5e1[_0x2e2333]=_0x1486d0,_0x2e2333++);});const _0x364006=Markup['inlineKeyboard'](_0x14e5e1);_0x3715d0[_0x5947c0(0x206)](_0x5947c0(0x29d),_0x364006);}}),tgBot['action'](/on_(.+)/,async _0x5b3bf6=>{const _0x5e454a=_0x2795d9,_0x34d97b=_0x5b3bf6[_0x5e454a(0x1c2)][0x1];_0x5b3bf6[_0x5e454a(0x16a)]();if(_0x34d97b==_0x5e454a(0x2c6)){const _0x4c9f60=getDisabledBots();await sendTelegram(_0x5b3bf6[_0x5e454a(0x21e)]['id'],_0x5e454a(0x1c3)),_0x4c9f60[_0x5e454a(0x240)](_0x1125e1=>{const _0xdef7d7=_0x5e454a;if(_0x1125e1[_0xdef7d7(0x31c)]!=_0xdef7d7(0x2c6))toggleBot(_0x1125e1['botID'],toggleStatus(_0x1125e1[_0xdef7d7(0x31c)]),_0xdef7d7(0x203));});}else await sendTelegram(_0x5b3bf6['chat']['id'],_0x5e454a(0x1d2)+_0x34d97b),toggleBot(_0x34d97b,toggleStatus(_0x34d97b),_0x5e454a(0x203));}),tgBot['command'](_0x2795d9(0x2b6),async _0x13b461=>{const _0x1a8338=_0x2795d9,_0x2a8e9c=getEnabledBots();if(_0x2a8e9c[_0x1a8338(0x309)]==0x0)await sendTelegram(_0x13b461[_0x1a8338(0x21e)]['id'],_0x1a8338(0x290));else{if(_0x2a8e9c[_0x1a8338(0x309)]>0x1)_0x2a8e9c['push']({'botID':_0x1a8338(0x2c6)});let _0x58130b=[],_0x406e94=[];const _0xf3d996=_0x2a8e9c['length']%0x4==0x0||_0x2a8e9c[_0x1a8338(0x309)]%0x4==0x3||_0x2a8e9c['length']%0x3==0x1?0x4:0x3;let _0x358485=0x0;_0x2a8e9c[_0x1a8338(0x240)]((_0xf56e8d,_0x7c7e20)=>{const _0x55fe3c=_0x1a8338;if(_0x7c7e20%_0xf3d996==0x0)_0x406e94=[];_0x406e94[_0x55fe3c(0x273)](Markup[_0x55fe3c(0x20e)][_0x55fe3c(0x1a7)](_0xf56e8d[_0x55fe3c(0x31c)]==_0x55fe3c(0x2c6)?_0x55fe3c(0x155):'Bot\x20'+_0xf56e8d['botID'],_0x55fe3c(0x22f)+_0xf56e8d['botID'])),_0x7c7e20%_0xf3d996==0x0&&(_0x58130b[_0x358485]=_0x406e94,_0x358485++);});const _0x151609=Markup['inlineKeyboard'](_0x58130b);_0x13b461[_0x1a8338(0x206)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x151609);}}),tgBot[_0x2795d9(0x277)](/off_(.+)/,async _0x20f49c=>{const _0x109158=_0x2795d9,_0x5b892d=_0x20f49c['match'][0x1];_0x20f49c[_0x109158(0x16a)]();if(_0x5b892d==_0x109158(0x2c6)){const _0x51ae60=getEnabledBots();await sendTelegram(_0x20f49c[_0x109158(0x21e)]['id'],_0x109158(0x2cb)),_0x51ae60[_0x109158(0x240)](_0x484503=>{const _0x17a65c=_0x109158;if(_0x484503[_0x17a65c(0x31c)]!=_0x17a65c(0x2c6))toggleBot(_0x484503['botID'],toggleStatus(_0x484503[_0x17a65c(0x31c)]),'stopped');});}else await sendTelegram(_0x20f49c[_0x109158(0x21e)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x5b892d),toggleBot(_0x5b892d,toggleStatus(_0x5b892d),_0x109158(0x203));}),tgBot[_0x2795d9(0x200)](_0x2795d9(0x32c),async _0x30734f=>{const _0x465edb=_0x2795d9,_0x50c435=getEnabledBots();if(_0x50c435['length']==0x0)await sendTelegram(_0x30734f['chat']['id'],_0x465edb(0x290));else{if(_0x50c435[_0x465edb(0x309)]>0x1){let _0x64f24a=[],_0x2c72dc=[];const _0x1ff57d=_0x50c435['length']%0x4==0x0||_0x50c435[_0x465edb(0x309)]%0x4==0x3||_0x50c435[_0x465edb(0x309)]%0x3==0x1?0x4:0x3;let _0x4af892=0x0;_0x50c435[_0x465edb(0x240)]((_0x409fea,_0x31c7d5)=>{const _0x5d6aca=_0x465edb;if(_0x31c7d5%_0x1ff57d==0x0)_0x2c72dc=[];_0x2c72dc[_0x5d6aca(0x273)](Markup[_0x5d6aca(0x20e)][_0x5d6aca(0x1a7)]('Bot\x20'+_0x409fea[_0x5d6aca(0x31c)],_0x5d6aca(0x15d)+_0x409fea[_0x5d6aca(0x31c)])),_0x31c7d5%_0x1ff57d==0x0&&(_0x64f24a[_0x4af892]=_0x2c72dc,_0x4af892++);});const _0x37e916=Markup[_0x465edb(0x2c9)](_0x64f24a);_0x30734f['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x37e916);}else{const _0x217903=_0x50c435[0x0][_0x465edb(0x31c)];if(pid[_0x217903])pid[_0x217903][_0x465edb(0x225)]({'function':_0x465edb(0x2da),'args':null});}}}),tgBot[_0x2795d9(0x277)](/metrics_(.+)/,async _0x12c1a7=>{const _0x3942e6=_0x2795d9,_0x24f10e=_0x12c1a7[_0x3942e6(0x1c2)][0x1];_0x12c1a7['editMessageReplyMarkup']();if(pid[_0x24f10e])pid[_0x24f10e][_0x3942e6(0x225)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x2795d9(0x200)](_0x2795d9(0x1eb),async _0x13f4d7=>{const _0x514679=_0x2795d9,_0x510df1=getEnabledBots();if(_0x510df1[_0x514679(0x309)]==0x0)await sendTelegram(_0x13f4d7[_0x514679(0x21e)]['id'],_0x514679(0x290));else{if(_0x510df1['length']>0x1){let _0x17b72c=[],_0x268f3f=[];const _0x399fa1=_0x510df1[_0x514679(0x309)]%0x4==0x0||_0x510df1['length']%0x4==0x3||_0x510df1[_0x514679(0x309)]%0x3==0x1?0x4:0x3;let _0x222f00=0x0;_0x510df1[_0x514679(0x240)]((_0x2cf815,_0x1c607f)=>{const _0x1fd51e=_0x514679;if(_0x1c607f%_0x399fa1==0x0)_0x268f3f=[];_0x268f3f[_0x1fd51e(0x273)](Markup[_0x1fd51e(0x20e)][_0x1fd51e(0x1a7)](_0x1fd51e(0x335)+_0x2cf815[_0x1fd51e(0x31c)],_0x1fd51e(0x1cb)+_0x2cf815[_0x1fd51e(0x31c)])),_0x1c607f%_0x399fa1==0x0&&(_0x17b72c[_0x222f00]=_0x268f3f,_0x222f00++);});const _0x17ffef=Markup['inlineKeyboard'](_0x17b72c);_0x13f4d7[_0x514679(0x206)](_0x514679(0x2f8),_0x17ffef);}else{const _0x5df5fa=_0x510df1[0x0]['botID'];if(pid[_0x5df5fa])pid[_0x5df5fa][_0x514679(0x225)]({'function':_0x514679(0x1a1),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x201b3f=>{const _0xb7ccb3=_0x2795d9,_0x42d521=_0x201b3f['match'][0x1];_0x201b3f[_0xb7ccb3(0x16a)]();if(pid[_0x42d521])pid[_0x42d521]['send']({'function':_0xb7ccb3(0x1a1),'args':null});}),tgBot[_0x2795d9(0x200)](_0x2795d9(0x1d8),async _0x4757f5=>{const _0x502d2c=_0x2795d9,_0x32d8eb='logs';await zipFiles(_0x32d8eb);const _0x5e3fb3=zippath+(_0x32d8eb+_0x502d2c(0x323));_0x4757f5[_0x502d2c(0x16d)]({'source':_0x5e3fb3})[_0x502d2c(0x336)](()=>{})[_0x502d2c(0x180)](_0x4e5b9b=>logger[_0x502d2c(0x162)](_0x502d2c(0x302)+_0x32d8eb+_0x502d2c(0x158),_0x4e5b9b));}),tgBot['command'](_0x2795d9(0x357),async _0x170755=>{const _0x2fa14a=_0x2795d9,_0x29fb98='backup';await backupConfigFiles(),await zipFiles(_0x29fb98);const _0x3bc34d=zippath+(_0x29fb98+_0x2fa14a(0x323));_0x170755['replyWithDocument']({'source':_0x3bc34d})[_0x2fa14a(0x336)](()=>{})[_0x2fa14a(0x180)](_0x184d7e=>logger['debug']('Error\x20sending\x20'+_0x29fb98+'\x20files\x20over\x20Telegram:',_0x184d7e));}),tgBot[_0x2795d9(0x200)](_0x2795d9(0x1ca),async _0x1536d4=>{const _0x18cf36=_0x2795d9;await getMessages();if(!updateAvailable)await sendTelegram(_0x1536d4['chat']['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x1536d4[_0x18cf36(0x21e)]['id'],_0x18cf36(0x18a));else{const _0x3fa657=Markup['inlineKeyboard']([Markup[_0x18cf36(0x20e)][_0x18cf36(0x1a7)](_0x18cf36(0x35d),_0x18cf36(0x288)),Markup[_0x18cf36(0x20e)]['callback']('No',_0x18cf36(0x2e2))]);_0x1536d4[_0x18cf36(0x206)](_0x18cf36(0x189),_0x3fa657);}}}),tgBot['action'](/update_(.+)/,async _0x35e501=>{const _0x4487a6=_0x2795d9,_0x381b24=_0x35e501[_0x4487a6(0x1c2)][0x1];_0x35e501[_0x4487a6(0x16a)](),_0x381b24==_0x4487a6(0x28c)&&(await sendTelegram(_0x35e501[_0x4487a6(0x21e)]['id'],_0x4487a6(0x327)),updateBB(_0x4487a6(0x1ca))),_0x381b24=='no'&&await sendTelegram(_0x35e501[_0x4487a6(0x21e)]['id'],_0x4487a6(0x330));}),tgBot['command']('reinstall',async _0x23ff1b=>{const _0x4ae6b9=_0x2795d9;if(!validInstallation)await sendTelegram(_0x23ff1b[_0x4ae6b9(0x21e)]['id'],_0x4ae6b9(0x215));else{const _0x1db2e0=Markup[_0x4ae6b9(0x2c9)]([Markup[_0x4ae6b9(0x20e)][_0x4ae6b9(0x1a7)]('Yes','reinstall_yes'),Markup[_0x4ae6b9(0x20e)][_0x4ae6b9(0x1a7)]('No',_0x4ae6b9(0x329))]);_0x23ff1b[_0x4ae6b9(0x206)](_0x4ae6b9(0x35a),_0x1db2e0);}}),tgBot['action'](/reinstall_(.+)/,async _0x390a38=>{const _0x471636=_0x2795d9,_0x2e71cb=_0x390a38[_0x471636(0x1c2)][0x1];_0x390a38[_0x471636(0x16a)](),_0x2e71cb==_0x471636(0x28c)&&(await sendTelegram(_0x390a38[_0x471636(0x21e)]['id'],_0x471636(0x348)),updateBB(_0x471636(0x22b))),_0x2e71cb=='no'&&await sendTelegram(_0x390a38['chat']['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot[_0x2795d9(0x200)]('toggle',async _0x1bd3a0=>{const _0x5306d7=_0x2795d9,_0x1b8beb=getBotsWithMode();if(_0x1b8beb[_0x5306d7(0x309)]==0x0)await sendTelegram(_0x1bd3a0[_0x5306d7(0x21e)]['id'],_0x5306d7(0x290));else{let _0x1829a8=[],_0x5314f4=[];const _0x26ca28=0x2;let _0x410194=0x0;_0x1b8beb['forEach']((_0x35b969,_0x141118)=>{const _0x2b0350=_0x5306d7;if(_0x141118%_0x26ca28==0x0)_0x5314f4=[];_0x5314f4['push'](Markup[_0x2b0350(0x20e)][_0x2b0350(0x1a7)](_0x2b0350(0x335)+_0x35b969[_0x2b0350(0x31c)]+'\x20('+_0x35b969[_0x2b0350(0x192)]+')','toggle_'+_0x35b969[_0x2b0350(0x31c)])),_0x141118%_0x26ca28==0x0&&(_0x1829a8[_0x410194]=_0x5314f4,_0x410194++);});const _0x15719c=Markup[_0x5306d7(0x2c9)](_0x1829a8);_0x1bd3a0[_0x5306d7(0x206)](_0x5306d7(0x2a2),_0x15719c);}}),tgBot[_0x2795d9(0x277)](/toggle_(.+)/,async _0x50bbcf=>{const _0x34c947=_0x2795d9,_0x4cc577=_0x50bbcf[_0x34c947(0x1c2)][0x1];_0x50bbcf[_0x34c947(0x16a)]();const _0x447108=getBotsWithMode(),_0x5ef1e6=_0x447108[_0x34c947(0x2c3)](_0x2c1b2c=>_0x2c1b2c[_0x34c947(0x31c)]==_0x4cc577),_0x26ee4c=_0x5ef1e6[_0x34c947(0x192)]=='auto'?'manual':_0x34c947(0x1f0);await sendTelegram(_0x50bbcf[_0x34c947(0x21e)]['id'],_0x34c947(0x17d)+_0x4cc577+'\x20to\x20'+_0x26ee4c+_0x34c947(0x22c)),toggleBotMode(_0x4cc577);}),tgBot[_0x2795d9(0x200)](_0x2795d9(0x36e),async _0x160c40=>{const _0x10395f=_0x2795d9;let _0x4afe56='';config[_0x10395f(0x240)](_0x343a78=>{const _0x4f729f=_0x10395f;_0x4afe56+=_0x4f729f(0x335)+_0x343a78[_0x4f729f(0x31c)]+':\x20'+_0x343a78['botname']+'\x0a';}),await sendTelegram(_0x160c40[_0x10395f(0x21e)]['id'],_0x4afe56,{'parse_mode':_0x10395f(0x22d)});}),tgBot[_0x2795d9(0x200)](_0x2795d9(0x18f),async _0x3059cb=>{const _0x3df492=_0x2795d9;await sendTelegram(_0x3059cb[_0x3df492(0x21e)]['id'],_0x1c0475);}),process[_0x2795d9(0x197)](_0x2795d9(0x210),()=>tgBot[_0x2795d9(0x28a)]('SIGINT')),process[_0x2795d9(0x197)](_0x2795d9(0x2a8),()=>tgBot[_0x2795d9(0x28a)](_0x2795d9(0x2a8))),tgBot[_0x2795d9(0x280)]();}function disableTelegram(){const _0x2c391f=_0x3d1b94;tgBot&&tgBot[_0x2c391f(0x28a)]();}async function sendTelegram(_0x2f7cf9,_0x168ea5,_0x1f5d99){const _0x376e81=_0x3d1b94;_0x1f5d99={..._0x1f5d99,'disable_web_page_preview':!![]};try{await tgBot[_0x376e81(0x339)][_0x376e81(0x209)](_0x2f7cf9,_0x168ea5,_0x1f5d99);}catch(_0x3377be){logger[_0x376e81(0x162)]('Telegram\x20error:',_0x3377be);}}async function sendTelegramBot(_0x5dd142,_0x419da5){const _0x228aac=_0x3d1b94;if(settings[_0x228aac(0x346)]){if(settings[_0x228aac(0x2c4)]=='all'||(_0x419da5['type']==_0x228aac(0x2f5)||_0x419da5[_0x228aac(0x333)]==_0x228aac(0x26a)||_0x419da5[_0x228aac(0x333)]==_0x228aac(0x368))&&settings['telegramEvents']==_0x228aac(0x1e2)||_0x419da5['type']=='order'&&settings['telegramEvents']==_0x228aac(0x311)){if(tgBot&&settings[_0x228aac(0x1b4)]){if(_0x419da5['showname'])await sendTelegram(settings['telegramChatId'],_0x419da5[_0x228aac(0x154)]+_0x228aac(0x361)+_0x419da5[_0x228aac(0x1d1)]);else await sendTelegram(settings[_0x228aac(0x1b4)],_0x228aac(0x335)+_0x5dd142+_0x228aac(0x361)+_0x419da5[_0x228aac(0x1d1)]);}}}}async function sendTelegramMsg(_0x1b903b,_0x4cbaf9='HTML'){const _0x27ff91=_0x3d1b94;return settings[_0x27ff91(0x346)]&&tgBot&&settings[_0x27ff91(0x1b4)]?(await sendTelegram(settings[_0x27ff91(0x1b4)],_0x1b903b,{'parse_mode':_0x4cbaf9}),!![]):![];}function getDeviceWithIp(_0x1252d7){const _0x572ef9=_0x3d1b94;return devices[_0x572ef9(0x2c3)](_0x11358f=>_0x11358f['ip']===_0x1252d7);}async function temporaryAccess2FA(_0x114c89,_0x2cc68f){const _0x4859e0=_0x3d1b94;let _0x543fc4=new Date(),_0x222af9=![];if(lastIpApproval){if(_0x543fc4-lastIpApproval<0x1388)_0x222af9=!![];}lastIpApproval=new Date();if(_0x222af9)return;if(tgBot&&settings[_0x4859e0(0x1b4)]){const _0x4df3a9=uuidRandom();tmpStorage[_0x4df3a9]={'uuid':_0x114c89,'externalip':_0x2cc68f};const _0x44ba5b=Markup[_0x4859e0(0x2c9)]([Markup[_0x4859e0(0x20e)]['callback'](_0x4859e0(0x2f6),_0x4859e0(0x358)+_0x4df3a9),Markup[_0x4859e0(0x20e)][_0x4859e0(0x1a7)](_0x4859e0(0x1c5),'tempaccess_15_'+_0x4df3a9),Markup['button'][_0x4859e0(0x1a7)]('30\x20min','tempaccess_30_'+_0x4df3a9),Markup['button'][_0x4859e0(0x1a7)](_0x4859e0(0x179),_0x4859e0(0x2dd)+_0x4df3a9)]);await sendTelegram(settings[_0x4859e0(0x1b4)],_0x4859e0(0x1d9)+normalizeIP(_0x2cc68f)[_0x4859e0(0x230)]+'\x20?',_0x44ba5b),tgBot[_0x4859e0(0x277)](/tempaccess_(.+)_(.+)/,async _0x284a39=>{const _0x2dfba6=_0x4859e0,_0x3f1bba=_0x284a39[_0x2dfba6(0x1c2)][0x1],_0x386bd8=_0x284a39['match'][0x2],{uuid:_0x3dea74,externalip:_0x408740}=tmpStorage[_0x386bd8];delete tmpStorage[_0x386bd8],_0x284a39[_0x2dfba6(0x16a)](),devices[_0x3dea74][_0x2dfba6(0x344)]={'clientip':_0x408740,'timestamp':new Date()[_0x2dfba6(0x1e1)](),'expiry':_0x3f1bba},_0x3f1bba!=_0x2dfba6(0x179)?(await sendTelegram(_0x284a39[_0x2dfba6(0x21e)]['id'],_0x2dfba6(0x20b)+_0x3f1bba+'\x20minutes',{'parse_mode':_0x2dfba6(0x22d)}),io['to'](_0x3dea74)[_0x2dfba6(0x363)](_0x2dfba6(0x1c4),{'access':{'allow':![],'reason':_0x2dfba6(0x304),'token':null}})):(await sendTelegram(_0x284a39[_0x2dfba6(0x21e)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x3dea74)[_0x2dfba6(0x363)](_0x2dfba6(0x1c4),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x5c5a4c,_0x20ef76){const _0x4b110b=_0x3d1b94;if(tgBot&&settings[_0x4b110b(0x1b4)]){const _0x1ad83f=uuidRandom();tmpStorage[_0x1ad83f]={'uuid':_0x5c5a4c,'externalip':_0x20ef76};const _0x297104=Markup['inlineKeyboard']([Markup[_0x4b110b(0x20e)][_0x4b110b(0x1a7)](_0x4b110b(0x307),_0x4b110b(0x2d2)+loginExpiry+'_'+_0x1ad83f),Markup[_0x4b110b(0x20e)][_0x4b110b(0x1a7)](_0x4b110b(0x179),_0x4b110b(0x212)+_0x1ad83f)]);await sendTelegram(settings[_0x4b110b(0x1b4)],_0x4b110b(0x1ee)+normalizeIP(_0x20ef76)[_0x4b110b(0x230)]+'\x20?',_0x297104),tgBot[_0x4b110b(0x277)](/login2fa_(.+)_(.+)/,async _0x4dcf27=>{const _0x18e398=_0x4b110b,_0x585041=_0x4dcf27[_0x18e398(0x1c2)][0x1],_0x432fbd=_0x4dcf27[_0x18e398(0x1c2)][0x2],{uuid:_0x50c760,externalip:_0xd071f5}=tmpStorage[_0x432fbd];delete tmpStorage[_0x432fbd],_0x4dcf27[_0x18e398(0x16a)](),devices[_0x50c760]['telegram2FaApproval']={'clientip':_0xd071f5,'timestamp':new Date()[_0x18e398(0x1e1)](),'expiry':_0x585041},_0x585041!='reject'?(await sendTelegram(_0x4dcf27[_0x18e398(0x21e)]['id'],_0x18e398(0x24f),{'parse_mode':'HTML'}),io['to'](_0x50c760)[_0x18e398(0x363)](_0x18e398(0x1c4),{'access':{'allow':![],'reason':_0x18e398(0x304),'token':null}})):(await sendTelegram(_0x4dcf27[_0x18e398(0x21e)]['id'],_0x18e398(0x1be)),io['to'](_0x50c760)['emit']('status',{'access':{'allow':![],'reason':_0x18e398(0x18b),'token':null}}));});}}function _0x439d(){const _0x396a6d=['createServer','Alerts','-results.json','timeshift','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','telegramChatId','Starting\x20#RED#Balance\x20Bot\x20v','Invalid\x20authentication\x20token\x20(2)','Restore\x20process\x20aborted','bb-config.json','latestversion','sortBy','express-fileupload','output-003.log','temporary\x20access\x20timeout','Login\x20rejected','DEFLATE','socket.io','_nsps','match','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','status','15\x20min','join','::1','stringify','reinstall-bb','update','portfolio_','path','All\x20bots\x20running\x20right\x20now','token','/:bot/performance','isDirectory','event','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','confirm-message','config/','loginRequired','connected','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','logs','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','address','bbvReceive','\x20(1)','add','enabled','Notifications\x20disabled\x0a','util','getTime','alerts','generateAsync','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','staging','writeFileSync','exp','::ffff:127.0.0.1','10rzPIjM','Unauthorized\x20attempt\x20to\x20update\x20bot','portfolio','2FA\x20login\x20required','simple','Allow\x20login\x20from\x20IP\x20address\x20','uncaughtException','auto','number','function','env','any','10tZwXDq','|@|','Password\x20has\x20been\x20reset\x20to:\x20','Unauthorized\x20attempt\x20to\x20update\x20settings','Error\x20details:','constructor','name','2LaYTnR','<b>Telegram\x20Bot\x20Status:</b>\x0a','pki','show-config','command','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','/logs\x20-\x20receive\x20log\x20files\x0a','stopped','production','manual','reply','file','\x20(2)','sendMessage','backup-full','Access\x20enabled\x20for\x20','/enable\x20-\x20enable\x20notifications\x0a','RSA-OAEP','button','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','SIGINT','CoinMarketCap\x20API\x20key\x20validated','login2fa_reject_','search','1340298YVJXfQ','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','delete-bot','apply','Invalid\x20authentication\x20token\x20(1)','getFullYear','Ok,\x20will\x20send\x20order\x20notifications\x20only','login\x20required','Error\x20removing\x20old\x20backup\x20files:','botmanager','chat','lowdb/adapters/FileSync','on_','test','temporary\x20token\x20generated','whitelistEnabled','$1_$2_$3','send',')\x20\x20\x20|\x20Bot\x20','removeAllListeners','showConfig','config','connection','reinstall','\x20mode','HTML','User\x20has\x20been\x20validated','off_','show','telegraf','cancel-loading','from','jsonwebtoken','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','bbUsername','compareSync','<b>Balance\x20Bot\x20Status:</b>\x0a','publicKey','Markdown','min','decode64','tkn','Restore\x20process\x20confirmed','toIPv4MappedAddress','forEach','Bot\x20Mgr\x20>\x20','Telegraf\x20error:','Unauthorized\x20attempt\x20to\x20delete\x20alerts','username','access','disconnect','new','config_all','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','startsWith','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Unauthorized\x20attempt\x20to\x20delete\x20bot','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','32228VdHebc','Login\x20accepted','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','allow','Starting\x20(','format','2FA\x20login\x20token\x20generated','backup/',',\x20must\x20be\x20a\x204\x20digit\x20number','clients','kill','Backup\x20file\x20uploaded','/:bot/portfolio','bb-settings.json','Unauthorized\x20login\x20attempt\x20(timeout)','headless','\x20|\x20','Notifications\x20enabled','build','versions','static','***','bot.js','includes','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','value','server','password','warning','\x1b[36m','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','#RES#\x20','File\x20uploaded','socket','getDate','cloneDeep','string','push','mixpanel','logs/','kind','action','restart','/update\x20-\x20update\x20Balance\x20Bot\x0a','login','/names\x20-\x20show\x20bot\x20names\x0a','Ok,\x20will\x20send\x20alert\x20notifications\x20only','enable','store','readFileSync','launch','binary','backup-files','referer','getUTCHours','login\x20token\x20valid','started','publicKeyToPem','update_yes','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','stop','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','yes','assign','host','add-bot','No\x20bots\x20running\x20right\x20now','ETH','getMonth','privateKeyFromPem','telegramUsername','invalid\x20credentials','remoteAddress','port','map','sign','getHours','login\x20not\x20required','store-configuration','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','updatebotmanager','timestamp','exec','size','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','\x1b[34m','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','BCT','output-002.log','date-fns','SIGTERM','new-disabled','address\x20already\x20in\x20use','hasOwnProperty','lastmsgemitted','Backup\x20file\x20unzipped\x20and\x20stored','storeConfiguration','http','/:bot/configuration','No\x20authentication\x20token','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','text','endsWith','off','NTBA_FIX_319','onepagemode','Deleted\x20Bot\x20','set','2FA\x20required','backupfile','resetpw_no','-events.json','Logged\x20out\x20user\x20...','13199901ZlGeMy','storeHeadless','config_orders','find','telegramEvents','update-bb','all','reset-password','Unauthorized\x20attempt\x20to\x20download\x20','inlineKeyboard','encryptedUuid','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','apiPassword','\x1b[33m','\x20only\x0a','uuid-random','bots','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','login2fa_','sockets','bot','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','restart_','toggle-bot-mode','/off\x20-\x20stop\x20bot(s)\x0a','privateKey','sendMetricsTelegram','2FA','--------------------------------------','tempaccess_reject_','#RES#\x20if\x20running\x20locally\x0a','notification','\x1b[35m','build2','update_no','existsSync','temp/','request','marketcapApi','Running\x20#RED#Balance\x20Bot\x20v','/metrics\x20-\x20show\x20bot\x20performance\x0a','getStartingBalances','rmSync','(((.+)+)+)+$','temporaryAccessAllowed','login\x20token\x20generated','message','max','readdirSync','192tfrYAX','Invalid\x20username\x20or\x20IP\x20address','\x20-\x20',':\x20Bot\x20Mgr\x20>\x20','error','5\x20min','mtime','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Unauthorized\x20attempt\x20to\x20get\x20messages','live','internal','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','initclient','apiKey','uuid','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',')\x20|\x20Bot\x20','Error\x20sending\x20','telegramToken','reload','https://api.ipify.org?format=json','-config.json','accept','running','length','Restarting\x20Bot\x20','Network\x20Interfaces:','padStart','hex','conn','axios','bb-secure.json','orders','Starting\x20new\x20bot\x20|\x20Bot\x20','/:bot/support','telegram2FaApproval','placeOrder','zip/','39428qETHDj','statSync','lastmsgtelegram','family','config_alerts','botID','node-forge','range','argv','\x1b[0m','toString','getPortfolio','.zip','defaults','express','write','Starting\x20Balance\x20Bot\x20update','settings','reinstall_no','/:bot','-----------------------------------------------------------------------------------','metrics','replace','files','toIPv4Address','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','generateKeyPair','code','type','#RES#','Bot\x20','then','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','blacklist','telegram','12TwNuVF','/help\x20-\x20show\x20available\x20commands\x0a','log','telegrammsg','bot-','pidExpireLogin','handshake','child_process','remove','bbPassword','telegramIpApproval','Error\x20while\x20deleting\x20config\x20files:\x20','telegramEnabled','6b67f3d61ee94b8f5c80b4affef4c4d9','Starting\x20Balance\x20Bot\x20reinstallation','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','alias','Unauthorized\x20attempt\x20to\x20store\x20configuration','backup-full@','use','data','getMinutes','store-settings','download','Restore\x20backup\x20file\x20','Unauthorized\x20attempt\x20to\x20add\x20bot','Error:\x20Invalid\x20argument\x20','listen','privateKeyToPem','backup','tempaccess_5_','parse','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','IPv4','Server','Yes','resetHistory','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','deleteHistoryAlerts','\x20>\x20','0.0.0','emit','apiSecret','You\x20can\x20use\x20the\x20following\x20commands:\x0a','secure','=>\x20Go\x20to\x20#CYA#http://','success','settings.','status\x20code\x20401','messages','ipaddr.js','Invalid\x20IP\x20address','names','sendFile','logout','index.html','botname','All\x20bots','mkdirSync','unlinkSync','\x20files\x20over\x20Telegram:','reason','userid','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','metrics_','Notifications\x20disabled','fork','disabled','create','debug','Session\x20expired\x20for\x20user\x20...','385570uvlwKR','/on\x20-\x20start\x20bot(s)\x0a','crypto','get','get-messages','bbvNew','editMessageReplyMarkup','Unauthorized\x20attempt\x20to\x20log\x20out','************','replyWithDocument','expiry','pidRefreshToken','update-bot','f2aRequired',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','store-fiat','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','\x20|\x20user:\x20...','slice','hashSync','keys','reject','getSeconds','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','full','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','temporary\x20access\x20not\x20allowed','catch','user','/status\x20-\x20show\x20bot(s)\x20status\x0a','All','\x1b[31m','headers','copyFileSync','node','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','2FA\x20login\x20rejected','output-001.log','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','264036IrCFZZ','help','Logged\x20in\x20user\x20...','clientip','mode','exit','jszip','Token\x20blacklisted','reset-history','once','sort','inherit','isValid','2163933yAOkRe','/disable\x20-\x20disable\x20notifications\x0a','Restoring\x20bot(s)\x20from\x20backup','api-eu.mixpanel.com','Password\x20reset\x20rejected','split','sendPortfolioTelegram','-performance.json','output-000.log','version','/backup\x20-\x20receive\x20backup\x20files\x0a','logged\x20out','callback','Notifications\x20enabled\x0a','bcryptjs','(staging)','storeFiat','secret','loadAsync','sha256'];_0x439d=function(){return _0x396a6d;};return _0x439d();}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x515b35=_0x3d1b94;return dbConfig[_0x515b35(0x167)](_0x515b35(0x2d0))['sortBy']('botID')['filter']({'status':_0x515b35(0x1de)})[_0x515b35(0x267)]()||[];}function getDisabledBots(){const _0x4d0802=_0x3d1b94;return dbConfig[_0x4d0802(0x167)](_0x4d0802(0x2d0))[_0x4d0802(0x1ba)](_0x4d0802(0x31c))['filter']({'status':_0x4d0802(0x160)})[_0x4d0802(0x267)]()||[];}function getBotAttributes(_0x36cd18){const _0x2c88c9=_0x3d1b94;let _0x3abff6={};const _0x6c3d8e=configpath+'bot-'+_0x36cd18+_0x2c88c9(0x306),_0x3a281f=fs[_0x2c88c9(0x2e3)](_0x6c3d8e);if(_0x3a281f){const _0x32ac4e=fs[_0x2c88c9(0x27f)](_0x6c3d8e);try{const _0x5c49cd=JSON[_0x2c88c9(0x359)](_0x32ac4e),_0x407a54=_0x5c49cd?_0x5c49cd[_0x2c88c9(0x2d4)][0x0][_0x2c88c9(0x25d)]:![];_0x3abff6[_0x2c88c9(0x192)]=_0x407a54?_0x2c88c9(0x1f0):_0x2c88c9(0x205),_0x3abff6[_0x2c88c9(0x154)]=_0x5c49cd?_0x5c49cd[_0x2c88c9(0x2d4)][0x0]['botname']:_0x2c88c9(0x335)+_0x36cd18;}catch(_0x2bd5a5){_0x3abff6[_0x2c88c9(0x192)]='manual',_0x3abff6[_0x2c88c9(0x154)]=_0x2c88c9(0x335)+_0x36cd18;}}else _0x3abff6[_0x2c88c9(0x192)]=_0x2c88c9(0x205),_0x3abff6['botname']='Bot\x20'+_0x36cd18;return _0x3abff6;}function getBotsWithMode(){const _0xf5fb73=_0x3d1b94,_0x487c86=dbConfig[_0xf5fb73(0x167)](_0xf5fb73(0x2d0))['sortBy'](_0xf5fb73(0x31c))[_0xf5fb73(0x267)]()||[];return _0x487c86[_0xf5fb73(0x240)](_0x10798f=>{const _0x4abce2=_0xf5fb73;let _0x1e6482=getBotAttributes(_0x10798f[_0x4abce2(0x31c)]);_0x10798f[_0x4abce2(0x192)]=_0x1e6482[_0x4abce2(0x192)];}),_0x487c86;}function getBotExchanges(){const _0x201388=_0x3d1b94;let _0x31c9bf=[];const _0x54f1bd=dbConfig[_0x201388(0x167)](_0x201388(0x2d0))[_0x201388(0x1ba)]('botID')[_0x201388(0x267)]()||[];_0x54f1bd[_0x201388(0x240)](_0x2df145=>{const _0x1aefe3=_0x201388;if(_0x2df145['status']==_0x1aefe3(0x1de)){const _0x251010=configpath+_0x1aefe3(0x33e)+_0x2df145[_0x1aefe3(0x31c)]+'-config.json',_0x199636=fs[_0x1aefe3(0x2e3)](_0x251010);let _0x2fbf7d;if(_0x199636){const _0x419b7a=fs[_0x1aefe3(0x27f)](_0x251010);try{const _0x42169f=JSON[_0x1aefe3(0x359)](_0x419b7a);_0x2fbf7d=_0x42169f?_0x42169f[_0x1aefe3(0x2d4)][0x0]['exchange']:null;}catch(_0x32bd73){}}if(_0x2fbf7d)_0x31c9bf[_0x1aefe3(0x273)](_0x2fbf7d);}});const _0x5f0d09=[...new Set(_0x31c9bf)][_0x201388(0x198)]();return _0x5f0d09;}async function initUser(){const _0x57ffb5=_0x3d1b94;if(!settings[_0x57ffb5(0x15a)]){const _0x365a0f=uuidRandom();mixpanel[_0x57ffb5(0x34a)](_0x365a0f),updateSetting(_0x57ffb5(0x15a),_0x365a0f);}}async function initSecure(){const _0x3a5853=_0x3d1b94;let _0x488ad4=getSecure();if(!_0x488ad4[_0x3a5853(0x2ab)](_0x3a5853(0x1ac))){let _0x5a9da0=await generateKeys();_0x488ad4[_0x3a5853(0x239)]=_0x5a9da0[_0x3a5853(0x239)],_0x488ad4['privateKey']=_0x5a9da0[_0x3a5853(0x2d9)],_0x488ad4[_0x3a5853(0x1ac)]=crypto['randomBytes'](0x20)[_0x3a5853(0x321)](_0x3a5853(0x30d));;storeSecure(_0x488ad4);}}function getSettings(){const _0x2cf773=_0x3d1b94;return dbSettings[_0x2cf773(0x167)](_0x2cf773(0x328))[_0x2cf773(0x267)]()||{};}function getSecure(){const _0x2bbe69=_0x3d1b94;return dbSecure[_0x2bbe69(0x167)](_0x2bbe69(0x366))['value']()||{};}function getBlacklist(){const _0x597cdf=_0x3d1b94;return dbSecure[_0x597cdf(0x167)](_0x597cdf(0x338))[_0x597cdf(0x267)]()||[];}function broadcastToBots(_0x1378ed,_0x5b63e4){const _0x3c1065=_0x3d1b94;config[_0x3c1065(0x240)](_0x1e1a0b=>{const _0x273f82=_0x3c1065;if(_0x1e1a0b[_0x273f82(0x1c4)]==_0x273f82(0x1de)&&_0x1e1a0b[_0x273f82(0x2fa)]=='running'||_0x1e1a0b[_0x273f82(0x1c4)]==_0x273f82(0x247)&&_0x1e1a0b[_0x273f82(0x2fa)]==_0x273f82(0x308)){if(pid[_0x1e1a0b[_0x273f82(0x31c)]])pid[_0x1e1a0b['botID']][_0x273f82(0x225)]({[_0x1378ed]:_0x5b63e4});}});}async function storeSettings(_0x24da8d,_0x80d0cf=![]){const _0x243bce=_0x3d1b94;_0x24da8d={...settings,..._0x24da8d};if(_0x80d0cf&&_0x24da8d['bbPassword']!=_0x243bce(0x16c)&&_0x24da8d['bbPassword']!=_0x243bce(0x263)&&_0x24da8d['bbPassword']!=''){const _0x37cc58=decryptRSA(secure[_0x243bce(0x2d9)],_0x24da8d[_0x243bce(0x343)])[_0x243bce(0x1a0)](_0x243bce(0x1f6))[0x0],_0x4992e2=bcrypt[_0x243bce(0x177)](_0x37cc58,saltRounds);_0x24da8d={..._0x24da8d,'bbPassword':_0x4992e2};}if(_0x80d0cf&&_0x24da8d[_0x243bce(0x303)]!=_0x243bce(0x16c)&&_0x24da8d[_0x243bce(0x303)]!=_0x243bce(0x263)&&_0x24da8d[_0x243bce(0x303)]!=''){const _0x1b54a6=decryptRSA(secure[_0x243bce(0x2d9)],_0x24da8d[_0x243bce(0x303)])[_0x243bce(0x1a0)](_0x243bce(0x1f6))[0x0];_0x24da8d={..._0x24da8d,'telegramToken':_0x1b54a6};}if(_0x80d0cf&&_0x24da8d[_0x243bce(0x2e6)]!=_0x243bce(0x16c)&&_0x24da8d[_0x243bce(0x2e6)]!=_0x243bce(0x263)&&_0x24da8d['marketcapApi']!=''){const _0x5d89d7=decryptRSA(secure[_0x243bce(0x2d9)],_0x24da8d[_0x243bce(0x2e6)])[_0x243bce(0x1a0)]('|@|')[0x0];_0x24da8d={..._0x24da8d,'marketcapApi':_0x5d89d7};}const _0x39be7a=_0x24da8d[_0x243bce(0x303)]!=_0x243bce(0x16c)&&_0x24da8d[_0x243bce(0x303)]!=settings[_0x243bce(0x303)]||_0x24da8d[_0x243bce(0x294)]!=settings['telegramUsername'],_0x425337=_0x24da8d[_0x243bce(0x303)]==''||_0x24da8d[_0x243bce(0x294)]=='',_0x2800c3=_0x24da8d[_0x243bce(0x2e6)]&&_0x24da8d[_0x243bce(0x2e6)]!=_0x243bce(0x16c)&&_0x24da8d['marketcapApi']!=settings[_0x243bce(0x2e6)];_0x39be7a&&(_0x24da8d[_0x243bce(0x1b4)]=null,_0x24da8d[_0x243bce(0x2c4)]='all');for(const [_0x54728a,_0x16a689]of Object['entries'](_0x24da8d)){if(_0x54728a==_0x243bce(0x303)&&_0x16a689==_0x243bce(0x16c)){_0x24da8d[_0x243bce(0x303)]=settings[_0x243bce(0x303)];continue;};if(_0x54728a==_0x243bce(0x343)&&_0x16a689==_0x243bce(0x16c)){_0x24da8d['bbPassword']=settings['bbPassword'];continue;};if(_0x54728a==_0x243bce(0x2e6)&&_0x16a689==_0x243bce(0x16c)){_0x24da8d[_0x243bce(0x2e6)]=settings[_0x243bce(0x2e6)];continue;};dbSettings['set'](_0x243bce(0x369)+_0x54728a,_0x16a689)['write']();}settings=_0x24da8d,io['to'](_0x243bce(0x21d))[_0x243bce(0x363)]('settings',cleanSettings()),broadcastToBots(_0x243bce(0x1b2),settings['timeshift']),broadcastToBots('onepagemode',settings['onepagemode']),broadcastToBots(_0x243bce(0x2e6),settings[_0x243bce(0x2e6)]);if(_0x39be7a&&!_0x425337)initTelegram();_0x39be7a&&_0x425337&&(updateSetting('telegramChatId',null),disableTelegram()),getAllClients()['forEach'](_0x24ce81=>{const _0x4f84bc=_0x243bce;getSocket(_0x24ce81['id'])[_0x4f84bc(0x363)](_0x4f84bc(0x1c4),{'access':{'allow':![],'reason':_0x4f84bc(0x304),'token':null}});}),_0x2800c3&&(await sleep(0xbb8),testMarketcapApi(_0x24da8d[_0x243bce(0x2e6)]));}async function testMarketcapApi(_0x25115d){const _0x4eec3b=_0x3d1b94,_0x3c9721=[_0x4eec3b(0x2a5),_0x4eec3b(0x291)];try{await axios[_0x4eec3b(0x167)]('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x25115d},'params':{'symbol':_0x3c9721[_0x4eec3b(0x321)]()}});}catch(_0x34cf9e){_0x34cf9e['toString']()['includes'](_0x4eec3b(0x36a))?(io['to'](_0x4eec3b(0x21d))[_0x4eec3b(0x363)]('notification',_0x4eec3b(0x249)),logger[_0x4eec3b(0x17c)](_0x4eec3b(0x249))):(io['to'](_0x4eec3b(0x21d))[_0x4eec3b(0x363)]('notification',_0x4eec3b(0x2d5)),logger['full'](_0x4eec3b(0x2d5)),logger[_0x4eec3b(0x162)](_0x4eec3b(0x1f9),_0x34cf9e[_0x4eec3b(0x321)]()+_0x4eec3b(0x2f3)+_0x34cf9e[_0x4eec3b(0x332)]));return;}logger['debug'](_0x4eec3b(0x211));}function _0x5cc6(_0x3db793,_0x3325e1){const _0x2b1945=_0x439d();return _0x5cc6=function(_0x4ccb44,_0x163ca1){_0x4ccb44=_0x4ccb44-0x151;let _0x439d24=_0x2b1945[_0x4ccb44];return _0x439d24;},_0x5cc6(_0x3db793,_0x3325e1);}function updateSetting(_0x4b1d1b,_0x34c7fe){const _0x1ad6e5=_0x3d1b94;dbSettings[_0x1ad6e5(0x2ba)]('settings.'+_0x4b1d1b,_0x34c7fe)[_0x1ad6e5(0x326)](),settings=getSettings(),io['to'](_0x1ad6e5(0x21d))[_0x1ad6e5(0x363)](_0x1ad6e5(0x328),cleanSettings());}function storeSecure(_0x1a595a){const _0x152f87=_0x3d1b94;dbSecure[_0x152f87(0x167)](_0x152f87(0x366))[_0x152f87(0x273)](_0x1a595a)[_0x152f87(0x326)](),secure=_0x1a595a;}function addBlacklist(_0x10b868){const _0x1d79c8=_0x3d1b94;cleanBlacklist();let _0x5912ce;devices[_0x10b868][_0x1d79c8(0x344)]?_0x5912ce=Math[_0x1d79c8(0x2ef)](devices[_0x10b868][_0x1d79c8(0x344)][_0x1d79c8(0x16e)],loginExpiry):_0x5912ce=loginExpiry,dbSecure['get'](_0x1d79c8(0x338))[_0x1d79c8(0x273)]({'expiry':new Date()[_0x1d79c8(0x1e1)]()+_0x5912ce*0x3c*0x3e8,'token':devices[_0x10b868][_0x1d79c8(0x245)][_0x1d79c8(0x1ce)]})[_0x1d79c8(0x326)](),blacklist=dbSecure[_0x1d79c8(0x167)](_0x1d79c8(0x338))[_0x1d79c8(0x267)]();}function cleanBlacklist(){const _0x5a2cfc=_0x3d1b94;let _0x3cd50d=dbSecure[_0x5a2cfc(0x167)](_0x5a2cfc(0x338))[_0x5a2cfc(0x271)]()[_0x5a2cfc(0x267)](),_0x2ff168=new Date()[_0x5a2cfc(0x1e1)]();_0x3cd50d[_0x5a2cfc(0x240)](_0x5099b7=>{const _0x16056b=_0x5a2cfc;_0x5099b7['expiry']<_0x2ff168&&dbSecure[_0x16056b(0x167)]('blacklist')[_0x16056b(0x342)]({'expiry':_0x5099b7['expiry']})[_0x16056b(0x326)]();});}function initStates(){let _0x48d022=getConfiguration();_0x48d022['forEach'](_0x2a8ce6=>{_0x2a8ce6['live']='stopped';}),storeConfiguration(_0x48d022);}async function generateKeys(){const _0x4643f5=_0x3d1b94,_0x1214f2=forge[_0x4643f5(0x1fe)]['rsa'][_0x4643f5(0x331)]({'bits':0x1000,'e':0x10001}),_0x17ef6c=forge[_0x4643f5(0x1fe)][_0x4643f5(0x356)](_0x1214f2[_0x4643f5(0x2d9)]),_0x2f1217=forge[_0x4643f5(0x1fe)][_0x4643f5(0x287)](_0x1214f2[_0x4643f5(0x239)]);return{'privateKey':_0x17ef6c,'publicKey':_0x2f1217};}async function oneTimeMigration(){const _0x411902=_0x3d1b94;let _0x204c80=getSettings(),_0x423dc4=![];!_0x204c80[_0x411902(0x2ab)]('lastmsgtelegram')&&(_0x204c80[_0x411902(0x319)]=0x0,_0x423dc4=!![]);!_0x204c80[_0x411902(0x2ab)](_0x411902(0x2ac))&&(_0x204c80[_0x411902(0x2ac)]=0x0,_0x423dc4=!![]);!_0x204c80[_0x411902(0x2ab)]('latestversion')&&(_0x204c80[_0x411902(0x1b9)]=_0x411902(0x362),_0x423dc4=!![]);!_0x204c80['hasOwnProperty'](_0x411902(0x2b8))&&(_0x204c80[_0x411902(0x2b8)]=![],_0x423dc4=!![]);!_0x204c80['hasOwnProperty'](_0x411902(0x2e6))&&(_0x204c80[_0x411902(0x2e6)]='',_0x423dc4=!![]);if(_0x423dc4)storeSettings(_0x204c80);try{fs[_0x411902(0x2f0)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x87bd19=>{const _0xa7ca57=_0x411902;if(!_0x87bd19[_0xa7ca57(0x1d0)]()){if(!_0x87bd19[_0xa7ca57(0x1fb)][_0xa7ca57(0x24a)]('backup-full@'))fs[_0xa7ca57(0x157)](configbackuppath+_0x87bd19['name']);}else fs[_0xa7ca57(0x2ea)](configbackuppath+_0x87bd19['name'],{'recursive':!![]});});}catch(_0x2bab08){logger[_0x411902(0x162)](_0x411902(0x21c),_0x2bab08);}}function storeConfiguration(_0xcabfd9){const _0x352ca3=_0x3d1b94;dbConfig['get'](_0x352ca3(0x2d0))[_0x352ca3(0x342)]()[_0x352ca3(0x326)](),dbConfig[_0x352ca3(0x167)]('bots')[_0x352ca3(0x273)](..._0xcabfd9)['write'](),config=_0xcabfd9;}async function resetPassword(){const _0x1973fc=_0x3d1b94;if(tgBot&&settings[_0x1973fc(0x1b4)]){const _0x483f64=Markup[_0x1973fc(0x2c9)]([Markup['button']['callback'](_0x1973fc(0x28c),'resetpw_yes'),Markup[_0x1973fc(0x20e)][_0x1973fc(0x1a7)]('no',_0x1973fc(0x2bd))]);await sendTelegram(settings['telegramChatId'],_0x1973fc(0x20f),_0x483f64),tgBot[_0x1973fc(0x277)](/resetpw_(.+)/,async _0x4a2b00=>{const _0x4f8d11=_0x1973fc,_0x434f89=_0x4a2b00[_0x4f8d11(0x1c2)][0x1];_0x4a2b00[_0x4f8d11(0x16a)]();if(_0x434f89!='no'){const _0xf1d697=0xf,_0x525f21=_0x4f8d11(0x1b3),_0x2ff5f6=Array[_0x4f8d11(0x233)](crypto['randomFillSync'](new Uint32Array(_0xf1d697)))[_0x4f8d11(0x298)](_0x5d6276=>_0x525f21[_0x5d6276%_0x525f21['length']])['join'](''),_0x1c69d4=bcrypt[_0x4f8d11(0x177)](_0x2ff5f6,saltRounds);storeSettings({'bbPassword':_0x1c69d4}),await sendTelegram(_0x4a2b00[_0x4f8d11(0x21e)]['id'],_0x4f8d11(0x1f7)+_0x2ff5f6,{'parse_mode':'HTML'});}else await sendTelegram(_0x4a2b00[_0x4f8d11(0x21e)]['id'],_0x4f8d11(0x19f));});}}async function confirmRestore(_0x35e56c,_0x48ab02){const _0x43950d=_0x3d1b94;io['to']('botmanager')[_0x43950d(0x363)]('notification',_0x43950d(0x300),_0x43950d(0x368));if(tgBot&&settings[_0x43950d(0x1b4)]){const _0x215099=uuidRandom();tmpStorage[_0x215099]={'path':_0x35e56c,'filename':_0x48ab02};const _0x407380=Markup['inlineKeyboard']([Markup['button'][_0x43950d(0x1a7)]('yes','restore_yes_'+_0x215099),Markup[_0x43950d(0x20e)]['callback']('no','restore_no_'+_0x215099)]);await sendTelegram(settings[_0x43950d(0x1b4)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x407380),tgBot[_0x43950d(0x277)](/restore_(.+)_(.+)/,async _0x378151=>{const _0x54a455=_0x43950d,_0x289f81=_0x378151[_0x54a455(0x1c2)][0x1],_0x474f8f=_0x378151[_0x54a455(0x1c2)][0x2],{path:_0x10af9e,filename:_0xc7a54}=tmpStorage[_0x474f8f];delete tmpStorage[_0x474f8f],_0x378151[_0x54a455(0x16a)](),_0x289f81==_0x54a455(0x28c)?(logger[_0x54a455(0x162)](_0x54a455(0x23e)),await sendTelegram(_0x378151[_0x54a455(0x21e)]['id'],_0x54a455(0x19d),{'parse_mode':_0x54a455(0x22d)}),unzipFile(_0x10af9e,_0xc7a54)):(logger[_0x54a455(0x162)](_0x54a455(0x1b7)),await sendTelegram(_0x378151['chat']['id'],_0x54a455(0x1b7)));});}}function getServerTime(){const _0x2d82c2=_0x3d1b94,_0x3495f1=new Date();return _0x3495f1[_0x2d82c2(0x219)]()+'/'+(_0x3495f1['getMonth']()+0x1)[_0x2d82c2(0x321)]()[_0x2d82c2(0x30c)](0x2,'0')+'/'+_0x3495f1['getDate']()[_0x2d82c2(0x321)]()[_0x2d82c2(0x30c)](0x2,'0')+'\x20'+_0x3495f1[_0x2d82c2(0x29a)]()[_0x2d82c2(0x321)]()[_0x2d82c2(0x30c)](0x2,'0')+':'+_0x3495f1[_0x2d82c2(0x34f)]()['toString']()[_0x2d82c2(0x30c)](0x2,'0')+':'+_0x3495f1['getSeconds']()[_0x2d82c2(0x321)]()[_0x2d82c2(0x30c)](0x2,'0');}function getTimeStamp(){const _0x4dcdf4=_0x3d1b94,_0x42d5f4=shiftedTime();return _0x42d5f4[_0x4dcdf4(0x219)]()+'/'+(_0x42d5f4[_0x4dcdf4(0x292)]()+0x1)[_0x4dcdf4(0x321)]()[_0x4dcdf4(0x30c)](0x2,'0')+'/'+_0x42d5f4[_0x4dcdf4(0x270)]()[_0x4dcdf4(0x321)]()['padStart'](0x2,'0')+'\x20'+_0x42d5f4[_0x4dcdf4(0x29a)]()[_0x4dcdf4(0x321)]()['padStart'](0x2,'0')+':'+_0x42d5f4[_0x4dcdf4(0x34f)]()[_0x4dcdf4(0x321)]()[_0x4dcdf4(0x30c)](0x2,'0')+':'+_0x42d5f4[_0x4dcdf4(0x17a)]()[_0x4dcdf4(0x321)]()[_0x4dcdf4(0x30c)](0x2,'0');}function getCleanTimeStamp(){const _0x384b07=_0x3d1b94,_0x2118ef=shiftedTime();return _0x2118ef[_0x384b07(0x219)]()+(_0x2118ef[_0x384b07(0x292)]()+0x1)[_0x384b07(0x321)]()[_0x384b07(0x30c)](0x2,'0')+_0x2118ef[_0x384b07(0x270)]()[_0x384b07(0x321)]()['padStart'](0x2,'0')+'-'+_0x2118ef['getHours']()[_0x384b07(0x321)]()[_0x384b07(0x30c)](0x2,'0')+_0x2118ef[_0x384b07(0x34f)]()[_0x384b07(0x321)]()[_0x384b07(0x30c)](0x2,'0')+_0x2118ef[_0x384b07(0x17a)]()[_0x384b07(0x321)]()[_0x384b07(0x30c)](0x2,'0');}function shiftedTime(){const _0x2acef1=_0x3d1b94,_0x32113d=new Date();let _0x3f9724=_0x32113d;if(settings[_0x2acef1(0x1b2)]&&settings[_0x2acef1(0x1b2)]!==0x0)_0x3f9724=fns[_0x2acef1(0x1dd)](_0x32113d,{'hours':settings[_0x2acef1(0x1b2)]});return _0x3f9724;}async function startScheduler(){const _0x19f8f5=_0x3d1b94,_0x1d569e=new Date()[_0x19f8f5(0x284)](),_0x235f9e=shiftedTime()['getHours']();_0x235f9e==0x4&&backupConfigFiles(),_0x235f9e==0x0&&(rotateLogFiles(),logger[_0x19f8f5(0x162)]('--------------------------------------'),logger[_0x19f8f5(0x162)](_0x19f8f5(0x2e7)+serverversion+_0x19f8f5(0x26d)+(environment==_0x19f8f5(0x1e5)?_0x19f8f5(0x1aa):'')),logger[_0x19f8f5(0x162)](_0x19f8f5(0x2dc))),_0x1d569e%0x6==0x0&&triggerAnalytics(),_0x1d569e%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x1e7aff){const _0x289d24=_0x3d1b94;logger[_0x289d24(0x162)](_0x289d24(0x352)+_0x1e7aff);const _0x510189=getBotsWithMode();_0x510189[_0x289d24(0x309)]>0x0?confirmRestore(configbackuppath,_0x1e7aff):unzipFile(configbackuppath,_0x1e7aff);}async function getBackupFiles(_0x3d23f9=null){const _0x4e47cc=_0x3d1b94;let _0x1ea6b2=[],_0x318081=fs[_0x4e47cc(0x2f0)](configbackuppath,{'withFileTypes':!![]});_0x318081[_0x4e47cc(0x198)]((_0x3c7f58,_0x36f9e4)=>_0x3c7f58['name']<_0x36f9e4[_0x4e47cc(0x1fb)]?0x1:_0x36f9e4[_0x4e47cc(0x1fb)]<_0x3c7f58['name']?-0x1:0x0),_0x318081[_0x4e47cc(0x240)](_0x1eb9e9=>{const _0x33d6b8=_0x4e47cc;if(!_0x1eb9e9[_0x33d6b8(0x1d0)]()&&_0x1eb9e9[_0x33d6b8(0x1fb)]['startsWith'](_0x33d6b8(0x34c))&&_0x1eb9e9[_0x33d6b8(0x1fb)][_0x33d6b8(0x2b5)]('.zip')){const _0x3f5159=formatDate(fs[_0x33d6b8(0x318)](configbackuppath+_0x1eb9e9['name'])[_0x33d6b8(0x2f7)]);_0x1ea6b2[_0x33d6b8(0x273)]({'name':_0x1eb9e9[_0x33d6b8(0x1fb)],'mtime':_0x3f5159});}});if(_0x3d23f9)io['to'](_0x3d23f9)[_0x4e47cc(0x363)](_0x4e47cc(0x282),_0x1ea6b2);else return _0x1ea6b2;}async function backupConfigFiles(){const _0x1a86b6=_0x3d1b94;await zipFiles(_0x1a86b6(0x20a));const _0x5f5abe=getCleanTimeStamp();fs['copyFileSync'](zippath+'backup-full.zip',configbackuppath+(_0x1a86b6(0x34c)+_0x5f5abe+_0x1a86b6(0x323)));let _0xcf3081=fs[_0x1a86b6(0x2f0)](configbackuppath,{'withFileTypes':!![]});_0xcf3081[_0x1a86b6(0x198)]((_0x10a96b,_0x40a481)=>_0x10a96b[_0x1a86b6(0x1fb)]<_0x40a481[_0x1a86b6(0x1fb)]?0x1:_0x40a481[_0x1a86b6(0x1fb)]<_0x10a96b[_0x1a86b6(0x1fb)]?-0x1:0x0),_0xcf3081['length']>maxBackups&&fs[_0x1a86b6(0x157)](configbackuppath+_0xcf3081[_0xcf3081[_0x1a86b6(0x309)]-0x1][_0x1a86b6(0x1fb)]);}function rotateLogFiles(){const _0x4d42cc=_0x3d1b94,_0x473bc8=fs['statSync'](logspath+'output-000.log'),_0x2aa451=_0x473bc8[_0x4d42cc(0x2a1)]/0x400;if(_0x2aa451>0x64){let _0x2ff719=fs[_0x4d42cc(0x2f0)](logspath,{'withFileTypes':!![]});_0x2ff719[_0x4d42cc(0x198)]((_0x1892b0,_0x70b043)=>_0x1892b0[_0x4d42cc(0x1fb)]<_0x70b043[_0x4d42cc(0x1fb)]?0x1:_0x70b043[_0x4d42cc(0x1fb)]<_0x1892b0['name']?-0x1:0x0),_0x2ff719[_0x4d42cc(0x240)](_0x1bc554=>{const _0x5f1bae=_0x4d42cc;if(_0x1bc554[_0x5f1bae(0x1fb)]==_0x5f1bae(0x2a6))fs[_0x5f1bae(0x186)](logspath+_0x1bc554['name'],logspath+_0x5f1bae(0x1bc));if(_0x1bc554[_0x5f1bae(0x1fb)]==_0x5f1bae(0x18c))fs[_0x5f1bae(0x186)](logspath+_0x1bc554[_0x5f1bae(0x1fb)],logspath+_0x5f1bae(0x2a6));_0x1bc554[_0x5f1bae(0x1fb)]==_0x5f1bae(0x1a3)&&(fs[_0x5f1bae(0x186)](logspath+_0x1bc554[_0x5f1bae(0x1fb)],logspath+_0x5f1bae(0x18c)),fs['writeFileSync'](logspath+_0x1bc554[_0x5f1bae(0x1fb)],''));});}}async function zipFiles(_0x5417ce){const _0x5cf27a=_0x3d1b94;let _0x169382;if(_0x5417ce==_0x5cf27a(0x1d8))_0x169382=logspath;if(_0x5417ce==_0x5cf27a(0x357))_0x169382=configpath;if(_0x5417ce==_0x5cf27a(0x20a))_0x169382=configpath;let _0xac9e93=fs['readdirSync'](_0x169382,{'withFileTypes':!![]});const _0x5afead=new JSZip();_0xac9e93['forEach'](_0x11e269=>{const _0x454508=_0x5cf27a;if(!_0x11e269[_0x454508(0x1d0)]()){let _0x52266f=fs[_0x454508(0x27f)](_0x169382+_0x11e269[_0x454508(0x1fb)]);if(_0x5417ce==_0x454508(0x357)){const _0x3bb8a2=/^bot-[0-9]{3}-config.json$/,_0x4734df=_0x3bb8a2[_0x454508(0x221)](_0x11e269['name']);if(_0x4734df){const _0x25025a=JSON[_0x454508(0x359)](_0x52266f);if(_0x25025a[_0x454508(0x2d4)][0x0]){_0x25025a[_0x454508(0x2d4)][0x0][_0x454508(0x2fe)]='***',_0x25025a[_0x454508(0x2d4)][0x0][_0x454508(0x364)]=_0x454508(0x263);if(_0x25025a[_0x454508(0x2d4)][0x0][_0x454508(0x2cc)])_0x25025a[_0x454508(0x2d4)][0x0][_0x454508(0x2cc)]=_0x454508(0x263);}_0x52266f=JSON[_0x454508(0x1c8)](_0x25025a,null,0x2);}if(_0x11e269['name']==_0x454508(0x25b)){const _0x2a8328=JSON[_0x454508(0x359)](_0x52266f);if(_0x2a8328[_0x454508(0x328)]['loginRequired'])_0x2a8328[_0x454508(0x328)][_0x454508(0x1d5)]=![];if(_0x2a8328[_0x454508(0x328)][_0x454508(0x343)])_0x2a8328[_0x454508(0x328)]['bbPassword']=_0x454508(0x263);if(_0x2a8328[_0x454508(0x328)][_0x454508(0x303)])_0x2a8328['settings']['telegramToken']=_0x454508(0x263);if(_0x2a8328[_0x454508(0x328)][_0x454508(0x1b4)])_0x2a8328['settings'][_0x454508(0x1b4)]=null;if(_0x2a8328[_0x454508(0x328)][_0x454508(0x2e6)])_0x2a8328['settings'][_0x454508(0x2e6)]=_0x454508(0x263);_0x52266f=JSON['stringify'](_0x2a8328,null,0x2);}if(_0x11e269[_0x454508(0x1fb)]!=_0x454508(0x310))_0x5afead[_0x454508(0x207)](_0x11e269[_0x454508(0x1fb)],_0x52266f);}else _0x5afead[_0x454508(0x207)](_0x11e269[_0x454508(0x1fb)],_0x52266f);}});const _0x8b0986=await _0x5afead[_0x5cf27a(0x1e3)]({'type':'string','base64':![],'compression':_0x5cf27a(0x1bf)});fs[_0x5cf27a(0x1e6)](zippath+(_0x5417ce+'.zip'),_0x8b0986,_0x5cf27a(0x281));}async function unzipFile(_0x4ae8e1,_0x5ba953){const _0x1c536c=_0x3d1b94;fs[_0x1c536c(0x2f0)](configpath,{'withFileTypes':!![]})['forEach'](_0x26d56a=>{const _0x3ac1f9=_0x1c536c;if(!_0x26d56a[_0x3ac1f9(0x1d0)]())fs[_0x3ac1f9(0x2ea)](configpath+_0x26d56a[_0x3ac1f9(0x1fb)]);});const _0x2b6d36=fs[_0x1c536c(0x27f)](_0x4ae8e1+_0x5ba953,'binary'),_0x3a095d=await JSZip[_0x1c536c(0x1ad)](_0x2b6d36,{'base64':![],'checkCRC32':!![]});for(const _0x295bf5 of Object['keys'](_0x3a095d[_0x1c536c(0x32e)])){const _0x16e360=_0x3a095d[_0x1c536c(0x32e)][_0x295bf5],_0x31461a=await _0x16e360['async'](_0x1c536c(0x272));fs['writeFileSync'](configpath+_0x16e360['name'],_0x31461a);}fs[_0x1c536c(0x2f0)](temppath,{'withFileTypes':!![]})[_0x1c536c(0x240)](_0x20cf04=>{const _0x1e2755=_0x1c536c;if(!_0x20cf04['isDirectory']())fs[_0x1e2755(0x2ea)](temppath+_0x20cf04['name']);}),logger[_0x1c536c(0x162)](_0x1c536c(0x2ad)),process[_0x1c536c(0x225)]({'restore':!![]},_0x11cd7a=>{});}async function getPublicIp(){const _0x3d6131=_0x3d1b94;try{const _0x47158b=await axios['get'](_0x3d6131(0x305));publicip=_0x47158b[_0x3d6131(0x34e)]['ip'];}catch(_0x32526a){}}async function triggerAnalytics(){const _0x4fee08=_0x3d1b94;if(!publicip)await getPublicIp();const _0x40095a=getBotsWithMode();let _0x495dac=0x0;_0x40095a[_0x4fee08(0x240)](_0x341496=>{const _0x528441=_0x4fee08;if(_0x341496[_0x528441(0x1c4)]==='enabled')_0x495dac++;});const _0x2f2e9f=getBotExchanges();mixpanel['track'](_0x4fee08(0x35c),{'distinct_id':settings[_0x4fee08(0x15a)],'ip':publicip,'version':serverversion,'numbots':_0x40095a[_0x4fee08(0x309)],'numbotsenabled':_0x495dac,'exchanges':_0x2f2e9f,'environment':environment});}async function getMessages(){const _0x240086=_0x3d1b94,_0x4b74bd='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x46e347=new GraphQLClient(_0x4b74bd),_0x45602b={'authorization':_0x240086(0x17b)},_0x257210=serverversion[_0x240086(0x1a0)]('.'),_0x8975c6=_0x257210[0x0]+'.'+_0x257210[0x1],_0x362efb=Math[_0x240086(0x23b)](settings[_0x240086(0x319)],settings[_0x240086(0x2ac)]),_0x5d04db={'last':parseInt(_0x362efb),'bbm':_0x8975c6},_0x23d995=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xdd3c02;try{_0xdd3c02=await _0x46e347[_0x240086(0x2e5)](_0x23d995,_0x5d04db,_0x45602b);}catch(_0x508948){}if(_0xdd3c02&&_0xdd3c02['messages']){let _0x1d150a=settings[_0x240086(0x319)],_0x28876b=settings['lastmsgtelegram'];newMessages=[];for(const _0x9b4f2c of _0xdd3c02[_0x240086(0x36b)]){newMessages[_0x240086(0x273)](_0x9b4f2c);let _0x5a6528=![];_0x9b4f2c[_0x240086(0x169)]&&(updateSetting('latestversion',_0x9b4f2c[_0x240086(0x169)]),_0x5a6528=isNewerVersion(serverversion,_0x9b4f2c[_0x240086(0x169)])||serverversion==_0x9b4f2c[_0x240086(0x169)]);if(!_0x5a6528&&_0x9b4f2c[_0x240086(0x1f1)]>_0x1d150a){if(_0x9b4f2c['bbvReceive']===_0x240086(0x1f4)||serverversion[_0x240086(0x24a)](_0x9b4f2c[_0x240086(0x1db)])){let _0x46c7db=''+_0x9b4f2c['title']+'\x0a\x0a'+_0x9b4f2c['message'];const _0x13dc2a=await sendTelegramMsg(toTelegramMarkdown(_0x46c7db),_0x240086(0x23a));_0x1d150a=_0x9b4f2c[_0x240086(0x1f1)];}}_0x28876b=_0x9b4f2c[_0x240086(0x1f1)];}updateAvailable=isNewerVersion(settings[_0x240086(0x1b9)],serverversion),updateSetting(_0x240086(0x319),_0x28876b),emitMessages();}}function emitMessages(){const _0x236775=_0x3d1b94,_0x427f51=settings[_0x236775(0x2ac)];let _0x25a528=[];newMessages[_0x236775(0x240)](_0x511876=>{const _0xf5ee6c=_0x236775;_0x511876['number']>_0x427f51&&_0x25a528[_0xf5ee6c(0x273)](_0x511876);}),_0x25a528[_0x236775(0x309)]>0x0&&getAllClients()[_0x236775(0x240)](_0x1daa29=>{const _0x2d43d6=_0x236775;getSocket(_0x1daa29['id'])[_0x2d43d6(0x363)]('message',_0x25a528);});}function confirmMessage(_0x33f3d7){const _0x4568a4=_0x3d1b94;updateSetting(_0x4568a4(0x2ac),Number(_0x33f3d7));}function isNewerVersion(_0x58f303,_0x468a4e){const _0x455a94=_0x3d1b94,_0x1875c3=_0x468a4e[_0x455a94(0x1a0)]('.'),_0x5852f4=_0x58f303[_0x455a94(0x1a0)]('.');for(var _0x4696fe=0x0;_0x4696fe<_0x5852f4[_0x455a94(0x309)];_0x4696fe++){const _0x32a6a6=~~_0x5852f4[_0x4696fe],_0x4e4bf3=~~_0x1875c3[_0x4696fe];if(_0x32a6a6>_0x4e4bf3)return!![];if(_0x32a6a6<_0x4e4bf3)return![];}return![];}function toTelegramMarkdown(_0x5b580a){const _0x152ec7=_0x3d1b94,_0x58fa7c=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4d39a3=/\*{2}(.+?)\*{2}/gim;return _0x5b580a=_0x5b580a[_0x152ec7(0x32d)](_0x58fa7c,_0x152ec7(0x224))[_0x152ec7(0x32d)](_0x4d39a3,'*$1*'),_0x5b580a;}async function validateConfigFile(){const _0x21a6b9=_0x3d1b94,_0x276fdf=dbConfig[_0x21a6b9(0x167)]('bots')[_0x21a6b9(0x1ba)](_0x21a6b9(0x31c))[_0x21a6b9(0x267)]()||[];if(_0x276fdf[_0x21a6b9(0x309)]==0x0){let _0x423672=0x0,_0x345331=[];const _0x94c1b4=/^bot-([0-9]{3})-config.json$/,_0xb3a332=fs['readdirSync'](configpath);_0xb3a332[_0x21a6b9(0x240)](_0x1adba3=>{const _0x2dbd3d=_0x21a6b9,_0x594290=_0x94c1b4[_0x2dbd3d(0x2a0)](_0x1adba3);if(_0x594290){const _0x4ff211=_0x594290[0x1];let _0x5111ab=getBotAttributes(_0x4ff211);_0x345331[_0x2dbd3d(0x273)]({'botID':_0x4ff211,'botname':_0x5111ab[_0x2dbd3d(0x154)],'status':_0x2dbd3d(0x160),'live':'stopped'}),_0x423672++;}}),_0x423672!=0x0&&(dbConfig[_0x21a6b9(0x167)](_0x21a6b9(0x2d0))[_0x21a6b9(0x28d)](_0x345331)[_0x21a6b9(0x326)](),config=_0x345331,restoredConfigFile=_0x423672);}}async function restoreConfigNotify(_0x3cb750){const _0x25d717=_0x3d1b94;let _0x2ef226;if(restoredConfigFile==0x1)_0x2ef226=_0x25d717(0x250);else _0x2ef226=_0x25d717(0x2b2);if(_0x3cb750)io['to'](_0x25d717(0x21d))[_0x25d717(0x363)](_0x25d717(0x2df),_0x2ef226);else{logger['simple'](_0x25d717(0x32b)),logger['simple'](_0x2ef226),logger[_0x25d717(0x1ed)]('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings[_0x25d717(0x1b4)]&&settings['telegramEvents']!=_0x25d717(0x311))await sendTelegram(settings['telegramChatId'],_0x25d717(0x241)+_0x2ef226);}}function decryptRSA(_0x239f64,_0x35d95e){const _0x348ffa=_0x3d1b94,_0x72f051=forge[_0x348ffa(0x1fe)][_0x348ffa(0x293)](_0x239f64),_0x34221a=_0x72f051['decrypt'](forge[_0x348ffa(0x1e0)][_0x348ffa(0x23c)](_0x35d95e),_0x348ffa(0x20d),{'md':forge['md'][_0x348ffa(0x1ae)][_0x348ffa(0x161)](),'mgf1':{'md':forge['md']['sha256'][_0x348ffa(0x161)]()}});return _0x34221a;}function validateCredentials(_0x2f53f1,_0x179103){const _0x4c2a88=_0x3d1b94;if(_0x2f53f1[_0x4c2a88(0x244)]==settings[_0x4c2a88(0x236)]&&bcrypt[_0x4c2a88(0x237)](_0x2f53f1['password'],settings[_0x4c2a88(0x343)])){if(settings[_0x4c2a88(0x171)])return{'allow':![],'reason':_0x4c2a88(0x1ec),'token':null};else{const _0x51d831=generateLoginToken(_0x179103);return{'allow':!![],'reason':_0x4c2a88(0x2ed),'token':_0x51d831};}}else return{'allow':![],'reason':_0x4c2a88(0x295),'token':null};}function refreshToken(_0x456517){const _0x7828ff=generateLoginToken(_0x456517);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x7828ff};}function validateAccess(_0x49b31f,_0x2d41e1,_0x1761a6){const _0x365f7a=_0x3d1b94,_0x4c5cc9=_0x1761a6?_0x1761a6:devices[_0x2d41e1]['ip'];let _0x5a48b0;const _0x58099b=_0x287f96=>{const _0x1cb8e3=_0x5cc6;if(settings['loginRequired']){if(settings[_0x1cb8e3(0x171)]){if(telegram2FaApproved(_0x2d41e1)){const _0xcb854b=generateLoginToken(_0x2d41e1);return{'allow':!![],'reason':_0x1cb8e3(0x254),'token':_0xcb854b};}else return{'allow':![],'reason':_0x1cb8e3(0x21b),'token':null};}else return _0x5a48b0=validToken(_0x287f96,_0x2d41e1),_0x5a48b0[_0x1cb8e3(0x2ab)]('success')?{'allow':!![],'reason':_0x1cb8e3(0x285),'token':_0x287f96}:{'allow':![],'reason':_0x1cb8e3(0x21b),'token':null};}else return{'allow':!![],'reason':_0x1cb8e3(0x29b),'token':null};};if(settings[_0x365f7a(0x223)]){let _0x28581f=[...settings['whitelist'],_0x365f7a(0x1c7),_0x365f7a(0x1e8),'127.0.0.1'];if(_0x28581f[_0x365f7a(0x265)](_0x4c5cc9))return _0x58099b(_0x49b31f);else{_0x5a48b0=validToken(_0x49b31f,_0x2d41e1);if(_0x5a48b0[_0x365f7a(0x2ab)](_0x365f7a(0x368)))return _0x58099b(_0x49b31f);else{if(telegramIpApproved(_0x2d41e1)){const _0x40c3c2=generateToken(_0x2d41e1);return _0x5a48b0=_0x58099b(_0x49b31f),_0x5a48b0[_0x365f7a(0x251)]?{'allow':!![],'reason':_0x365f7a(0x222),'token':_0x40c3c2}:_0x5a48b0;}else return settings[_0x365f7a(0x2ec)]?{'allow':![],'reason':_0x365f7a(0x2bb),'token':null}:{'allow':![],'reason':_0x365f7a(0x17f),'token':null};}}}else return _0x58099b(_0x49b31f);}function timelyDecrypt(_0x577f00,_0x5db57e,_0x359061='@'){const _0x4f1d9a=_0x3d1b94;if(_0x577f00)try{const _0x361b4f=decryptRSA(secure[_0x4f1d9a(0x2d9)],_0x577f00),_0x409c7b=_0x361b4f['split'](_0x359061)[0x0],_0xd08b97=_0x361b4f[_0x4f1d9a(0x1a0)](_0x359061)[0x1],_0x240c37=new Date()['getTime']();if(_0x5db57e){if(_0x240c37-_0xd08b97<maxSecretAge*0x3e8)return _0x409c7b;else return![];}else return _0x409c7b;}catch(_0x3e75cf){return![];}else return![];}const validToken=(_0x3d4a54,_0x3ff2e5)=>{const _0x50a6e8=_0x3d1b94,_0x33c774=devices[_0x3ff2e5]['ip'];if(!_0x3d4a54)return{'error':_0x50a6e8(0x2b1)};for(let _0x3fb910 of blacklist){if(_0x3fb910['token']==_0x3d4a54)return{'error':_0x50a6e8(0x195)};}let _0x50eb79;try{_0x50eb79=jwt['verify'](_0x3d4a54,secure[_0x50a6e8(0x1ac)]+_0x3ff2e5);}catch{return{'error':_0x50a6e8(0x218)};}if(!_0x50eb79[_0x50a6e8(0x2ab)](_0x50a6e8(0x191))&&!_0x50eb79['hasOwnProperty'](_0x50a6e8(0x244))||!_0x50eb79[_0x50a6e8(0x2ab)](_0x50a6e8(0x1e7)))return{'error':_0x50a6e8(0x1b6)};if(!_0x50eb79[_0x50a6e8(0x2ab)](_0x50a6e8(0x244))&&_0x50eb79[_0x50a6e8(0x2ab)](_0x50a6e8(0x191))){const {clientip:_0x4d15b8}=_0x50eb79;return _0x33c774==_0x4d15b8?{'success':_0x50a6e8(0x22e)}:{'error':_0x50a6e8(0x36d)};}else{if(_0x50eb79[_0x50a6e8(0x2ab)](_0x50a6e8(0x244))&&_0x50eb79[_0x50a6e8(0x2ab)]('clientip')){const {username:_0x492fca,clientip:_0x58c81e}=_0x50eb79;return settings[_0x50a6e8(0x236)]==_0x492fca&&_0x33c774==_0x58c81e?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x50a6e8(0x2f2)};}}},generateLoginToken=_0x2a2cac=>{const _0x43a263=_0x3d1b94;if(_0x2a2cac){const _0x1fdda7=devices[_0x2a2cac]['ip'];return jwt['sign']({'username':settings[_0x43a263(0x236)],'clientip':_0x1fdda7},secure[_0x43a263(0x1ac)]+_0x2a2cac,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x39c67f=>{const _0x63fc24=_0x3d1b94;if(_0x39c67f){const _0x146a52=devices[_0x39c67f]['ip'];return jwt[_0x63fc24(0x299)]({'clientip':_0x146a52},secure[_0x63fc24(0x1ac)]+_0x39c67f,{'expiresIn':devices[_0x39c67f][_0x63fc24(0x344)][_0x63fc24(0x16e)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x281d15=>{const _0x56743b=_0x3d1b94;let _0x332ab1=![];return devices[_0x281d15][_0x56743b(0x344)]&&devices[_0x281d15]['telegramIpApproval'][_0x56743b(0x16e)]!='reject'&&(_0x332ab1=devices[_0x281d15][_0x56743b(0x344)][_0x56743b(0x191)]==devices[_0x281d15]['ip']&&new Date()[_0x56743b(0x1e1)]()-devices[_0x281d15]['telegramIpApproval'][_0x56743b(0x29f)]<devices[_0x281d15]['telegramIpApproval'][_0x56743b(0x16e)]*0x3c*0x3e8),_0x332ab1;},telegram2FaApproved=_0x1bb81f=>{const _0x1961f4=_0x3d1b94;let _0x1f19a9=![];return devices[_0x1bb81f][_0x1961f4(0x314)]&&devices[_0x1bb81f][_0x1961f4(0x314)]['expiry']!='reject'&&(_0x1f19a9=devices[_0x1bb81f][_0x1961f4(0x314)]['clientip']==devices[_0x1bb81f]['ip']&&new Date()[_0x1961f4(0x1e1)]()-devices[_0x1bb81f][_0x1961f4(0x314)][_0x1961f4(0x29f)]<devices[_0x1bb81f]['telegram2FaApproval'][_0x1961f4(0x16e)]*0x3c*0x3e8),_0x1f19a9;},normalizeIP=_0x170234=>{const _0x33ce4b=_0x3d1b94;let _0x3e259d=null,_0x5d760a=null;if(ipaddr[_0x33ce4b(0x19a)](_0x170234)){const _0x3db44e=ipaddr[_0x33ce4b(0x359)](_0x170234);_0x3db44e[_0x33ce4b(0x276)]()==='ipv6'?(_0x3db44e['isIPv4MappedAddress']()&&(_0x3e259d=_0x3db44e[_0x33ce4b(0x32f)]()[_0x33ce4b(0x321)]()),_0x5d760a=_0x3db44e[_0x33ce4b(0x321)]()):(_0x3e259d=_0x3db44e[_0x33ce4b(0x321)](),_0x5d760a=_0x3db44e[_0x33ce4b(0x23f)]()['toString']());}return{'show':_0x3e259d?_0x3e259d:_0x5d760a,'store':_0x5d760a};};function formatDate(_0x16d7ab){const _0x3c874a=_0x3d1b94;return _0x16d7ab[_0x3c874a(0x219)]()+'/'+(_0x16d7ab[_0x3c874a(0x292)]()+0x1)[_0x3c874a(0x321)]()['padStart'](0x2,'0')+'/'+_0x16d7ab['getDate']()[_0x3c874a(0x321)]()[_0x3c874a(0x30c)](0x2,'0')+'\x20'+_0x16d7ab[_0x3c874a(0x29a)]()[_0x3c874a(0x321)]()[_0x3c874a(0x30c)](0x2,'0')+':'+_0x16d7ab['getMinutes']()['toString']()[_0x3c874a(0x30c)](0x2,'0')+':'+_0x16d7ab[_0x3c874a(0x17a)]()['toString']()[_0x3c874a(0x30c)](0x2,'0');}function sleep(_0x209367){return new Promise(_0x5f34a2=>setTimeout(_0x5f34a2,_0x209367));}