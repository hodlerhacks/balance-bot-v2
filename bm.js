const _0x49f930=_0x2ff0;(function(_0x4c3429,_0x77a825){const _0x496625=_0x2ff0,_0x4721c8=_0x4c3429();while(!![]){try{const _0x19f315=-parseInt(_0x496625(0x1d9))/0x1+parseInt(_0x496625(0x16e))/0x2+-parseInt(_0x496625(0x202))/0x3*(-parseInt(_0x496625(0x315))/0x4)+parseInt(_0x496625(0x1b1))/0x5*(parseInt(_0x496625(0x289))/0x6)+-parseInt(_0x496625(0x233))/0x7*(-parseInt(_0x496625(0x2ed))/0x8)+-parseInt(_0x496625(0x2db))/0x9*(parseInt(_0x496625(0x1c8))/0xa)+parseInt(_0x496625(0x2c2))/0xb*(-parseInt(_0x496625(0x2c0))/0xc);if(_0x19f315===_0x77a825)break;else _0x4721c8['push'](_0x4721c8['shift']());}catch(_0xf856d4){_0x4721c8['push'](_0x4721c8['shift']());}}}(_0x27bd,0x45b6b));const _0x5282ba=function(){let _0x385ae7=!![];return function(_0x3f1fcf,_0x47e5e5){const _0x171e9c=_0x385ae7?function(){const _0x5de269=_0x2ff0;if(_0x47e5e5){const _0x338380=_0x47e5e5[_0x5de269(0x222)](_0x3f1fcf,arguments);return _0x47e5e5=null,_0x338380;}}:function(){};return _0x385ae7=![],_0x171e9c;};}(),_0x3658d1=_0x5282ba(this,function(){const _0xfcf35f=_0x2ff0;return _0x3658d1[_0xfcf35f(0x294)]()[_0xfcf35f(0x306)](_0xfcf35f(0x204))[_0xfcf35f(0x294)]()['constructor'](_0x3658d1)['search'](_0xfcf35f(0x204));});_0x3658d1();'use strict';process[_0x49f930(0x169)][_0x49f930(0x14b)]=0x1;const childProcess=require(_0x49f930(0x1ca)),fs=require('fs'),fns=require('date-fns'),low=require(_0x49f930(0x2ec)),FileSync=require(_0x49f930(0x234)),path=require(_0x49f930(0x29b)),crypto=require('crypto'),forge=require(_0x49f930(0x2ee)),bcrypt=require(_0x49f930(0x31a)),jwt=require(_0x49f930(0x125)),ipaddr=require(_0x49f930(0x180)),argv=require(_0x49f930(0x301))(process[_0x49f930(0x1a7)]['slice'](0x2))[_0x49f930(0x1a7)],uuidRandom=require(_0x49f930(0x28b)),{Telegraf,Markup}=require(_0x49f930(0x229)),Mixpanel=require(_0x49f930(0x153)),axios=require(_0x49f930(0x174)),{GraphQLClient,gql}=require(_0x49f930(0x1fd)),util=require(_0x49f930(0x21e)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x49f930(0x300)),PORT=argv['port']||_0x49f930(0x2da),pattern=/^[0-9]{2,4}$/;!pattern[_0x49f930(0x18d)](PORT)&&(console[_0x49f930(0x152)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x49f930(0x2e9)),process[_0x49f930(0x14d)](0x1));const HOST=argv['host']||null,userID=argv['user']||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process[_0x49f930(0x2f7)][_0x49f930(0x2bf)];let bbpath=_0x49f930(0x18b),bbpath2='';const botfile=_0x49f930(0x283),configfile=_0x49f930(0x280),settingsfile=_0x49f930(0x1da),securefile=_0x49f930(0x23d),environment=require('./'+bbpath2+_0x49f930(0x145))[_0x49f930(0x2f4)]||_0x49f930(0x278),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x49f930(0x28a)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x49f930(0x2f6)),configpath=userID?bbpath+_0x49f930(0x2a1)+userID+'/':bbpath+_0x49f930(0x2a1),configbackuppath=configpath+_0x49f930(0x1f0),logspath=userID?bbpath+_0x49f930(0x32b)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+'zip/'+userID+'/':bbpath+'zip/',loggerfile=fs[_0x49f930(0x304)](logspath+_0x49f930(0x2e2),{'flags':'a'}),temppath=userID?bbpath+_0x49f930(0x151)+userID+'/':bbpath+_0x49f930(0x151);!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x49f930(0x2ac)](configbackuppath);function _0x2ff0(_0x3731e6,_0x2701e5){const _0x4a7511=_0x27bd();return _0x2ff0=function(_0x3658d1,_0x5282ba){_0x3658d1=_0x3658d1-0x112;let _0x27bdf6=_0x4a7511[_0x3658d1];return _0x27bdf6;},_0x2ff0(_0x3731e6,_0x2701e5);}!fs['existsSync'](logspath)&&fs['mkdirSync'](logspath);!fs[_0x49f930(0x28a)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x49f930(0x28a)](temppath)&&fs[_0x49f930(0x2ac)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x49f930(0x225)]({'bots':[]})[_0x49f930(0x1de)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x49f930(0x225)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x49f930(0x1de)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x49f930(0x1de)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x49f930(0x32d)](_0x49f930(0x143),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x49f930(0x2c9)]&&(settings[_0x49f930(0x2c9)]!=''&&settings[_0x49f930(0x2c9)]!=_0x49f930(0x13c))&&settings[_0x49f930(0x2b1)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x18de0d,_0x5c35fa)=>{const _0x3d7faf=_0x49f930,_0x594e7d=/#[A-Z]{3}#/g;if(typeof _0x18de0d=='string'){!_0x5c35fa?_0x18de0d=_0x18de0d['replace'](_0x594e7d,''):(_0x18de0d=_0x18de0d[_0x3d7faf(0x246)](/#BLU#/g,_0x3d7faf(0x2f5)),_0x18de0d=_0x18de0d[_0x3d7faf(0x246)](/#RED#/g,_0x3d7faf(0x27f)),_0x18de0d=_0x18de0d[_0x3d7faf(0x246)](/#YEL#/g,'\x1b[33m'),_0x18de0d=_0x18de0d[_0x3d7faf(0x246)](/#MAG#/g,_0x3d7faf(0x1c2)),_0x18de0d=_0x18de0d['replace'](/#CYA#/g,'\x1b[36m'),_0x18de0d=_0x18de0d[_0x3d7faf(0x246)](/#RES#/g,_0x3d7faf(0x1b6)));;}return _0x18de0d;},logger={'screen':_0x20daca=>{const _0x44e205=_0x49f930;console[_0x44e205(0x152)](parseColor(_0x20daca,!![]));},'simple':_0x597f84=>{const _0x594036=_0x49f930;console[_0x594036(0x152)](parseColor(_0x597f84,!![])),loggerfile[_0x594036(0x1de)](util[_0x594036(0x136)](parseColor(_0x597f84,![]))+'\x0a');},'full':async _0x3ac6fa=>{const _0x4cb18b=_0x49f930,_0x59d0a0=getTimeStamp()+_0x4cb18b(0x219)+_0x3ac6fa;console[_0x4cb18b(0x152)](parseColor(_0x59d0a0,!![])),loggerfile[_0x4cb18b(0x1de)](util['format'](parseColor(_0x59d0a0,![]))+'\x0a');if(tgBot&&settings[_0x4cb18b(0x247)]&&settings[_0x4cb18b(0x251)]!='orders')await sendTelegram(settings[_0x4cb18b(0x247)],_0x4cb18b(0x2a0)+parseColor(_0x3ac6fa,![]));},'debug':async(_0x8ee624,_0x4aedea='')=>{const _0x3b08f6=_0x49f930,_0x4be7be=getTimeStamp()+_0x3b08f6(0x1a6)+_0x8ee624;if(debugging)console[_0x3b08f6(0x152)](parseColor(_0x4be7be,!![]));loggerfile[_0x3b08f6(0x1de)](util['format'](parseColor(_0x4be7be,![]))+'\x0a');if(_0x4aedea){if(debugging)console[_0x3b08f6(0x152)](_0x4aedea);loggerfile[_0x3b08f6(0x1de)](util[_0x3b08f6(0x136)](_0x4aedea)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x2dadc6){const _0x21dbad=_0x49f930;_0x2dadc6[_0x21dbad(0x294)]()[_0x21dbad(0x207)](_0x21dbad(0x2d7))?(logger[_0x21dbad(0x193)](_0x21dbad(0x224)+_0x2dadc6[_0x21dbad(0x2e8)]+'#RES#'),process['send']({'terminate':!![]},_0x22cd7f=>{})):logger[_0x21dbad(0x193)](_0x2dadc6);}),process['on'](_0x49f930(0x14d),()=>{const _0x2e06fc=_0x49f930;stopAllBots(),process[_0x2e06fc(0x14d)](0x0);}),process['on']('SIGTERM',()=>{const _0x3a5a42=_0x49f930;stopAllBots(),process[_0x3a5a42(0x14d)](0x0);}),process['on'](_0x49f930(0x15c),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x49f930(0x145))[_0x49f930(0x164)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')['createServer'](app);app[_0x49f930(0x126)](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x1beb10,_0x18a18e)=>{const _0x287f1a=_0x49f930,_0x460b81=_0x1beb10[_0x287f1a(0x2c3)][_0x287f1a(0x1eb)],_0x41a7c4=getClientsWithBotID(_0x287f1a(0x144)),_0x4ee4b3=_0x1beb10[_0x287f1a(0x21f)][_0x287f1a(0x2ea)],_0x166f48=timelyDecrypt(_0x4ee4b3,![]),_0x4adfd9=_0x41a7c4[_0x287f1a(0x2ce)](_0x145e0e=>_0x145e0e['uuid']==_0x166f48);if(_0x4adfd9){const _0x4e18f7=normalizeIP(_0x1beb10[_0x287f1a(0x2a8)]['remoteAddress'])[_0x287f1a(0x129)],_0x46e290=_0x1beb10[_0x287f1a(0x21f)][_0x287f1a(0x16a)];if(validateAccess(_0x46e290,_0x166f48,_0x4e18f7)[_0x287f1a(0x114)])_0x460b81==_0x287f1a(0x217)&&await backupConfigFiles(),await zipFiles(_0x460b81),_0x18a18e[_0x287f1a(0x1f5)](zippath+(_0x460b81+_0x287f1a(0x14f)),_0x559e43=>{const _0x31ffaf=_0x287f1a;_0x559e43&&(logger[_0x31ffaf(0x2df)](_0x31ffaf(0x232)+_0x460b81),logger[_0x31ffaf(0x193)](_0x559e43));});else logger[_0x287f1a(0x2df)](_0x287f1a(0x312)+_0x460b81+_0x287f1a(0x327));}else logger['full'](_0x287f1a(0x312)+_0x460b81+'\x20(2)');}),app['post']('/upload-backup',async(_0x2ab0d6,_0x4cfda6)=>{const _0x125798=_0x49f930,_0x219596=getClientsWithBotID(_0x125798(0x144)),_0xd1b93e=_0x2ab0d6[_0x125798(0x21f)][_0x125798(0x2ea)],_0xcebbc0=timelyDecrypt(_0xd1b93e,![]),_0xad2589=_0x219596[_0x125798(0x2ce)](_0x3d9f7d=>_0x3d9f7d[_0x125798(0x2ea)]==_0xcebbc0);logger['debug'](_0x125798(0x1fe));if(_0xad2589){const _0x56c32a=normalizeIP(_0x2ab0d6['socket'][_0x125798(0x236)])['store'],_0x3b237a=_0x2ab0d6[_0x125798(0x21f)][_0x125798(0x16a)];if(validateAccess(_0x3b237a,_0xcebbc0,_0x56c32a)[_0x125798(0x114)]){if(_0x2ab0d6[_0x125798(0x189)]){const _0x1beffc=_0x2ab0d6[_0x125798(0x189)][_0x125798(0x2cc)];await _0x1beffc['mv'](temppath+_0x1beffc[_0x125798(0x297)]),_0x4cfda6['send']({'status':!![],'message':_0x125798(0x1bf)});const _0x1031ae=getBotsWithMode();_0x1031ae[_0x125798(0x287)]>0x0?confirmRestore(temppath,_0x1beffc[_0x125798(0x297)]):unzipFile(temppath,_0x1beffc[_0x125798(0x297)]);}}else logger[_0x125798(0x2df)](_0x125798(0x28d));}else logger['full'](_0x125798(0x139));}),app[_0x49f930(0x126)](express[_0x49f930(0x13f)](path['join'](__dirname,bbpath2,_0x49f930(0x1ce)))),app[_0x49f930(0x126)](express[_0x49f930(0x13f)](path['join'](__dirname,bbpath2,_0x49f930(0x23e)))),app['get']('/',function(_0x20eca0,_0x1578b4){const _0x5826bd=_0x49f930;_0x1578b4[_0x5826bd(0x1d2)](path[_0x5826bd(0x27c)](__dirname,bbpath2,_0x5826bd(0x1ce),_0x5826bd(0x199)));}),app[_0x49f930(0x2d1)](_0x49f930(0x1a1),function(_0x42a295,_0x2d0f64){const _0x1a93f9=_0x49f930;_0x2d0f64[_0x1a93f9(0x1d2)](path[_0x1a93f9(0x27c)](__dirname,bbpath2,_0x1a93f9(0x23e),_0x1a93f9(0x199)));}),app[_0x49f930(0x2d1)]('/:bot/portfolio',(_0x3a5d22,_0x31bee9)=>{const _0x570f04=_0x49f930;_0x31bee9[_0x570f04(0x1d2)](path[_0x570f04(0x27c)](__dirname,bbpath2,_0x570f04(0x23e),_0x570f04(0x199)));}),app[_0x49f930(0x2d1)](_0x49f930(0x258),(_0x3f315b,_0x5a63ef)=>{const _0x505e64=_0x49f930;_0x5a63ef[_0x505e64(0x1d2)](path[_0x505e64(0x27c)](__dirname,bbpath2,_0x505e64(0x23e),_0x505e64(0x199)));}),app[_0x49f930(0x2d1)](_0x49f930(0x32c),(_0x321276,_0x40b736)=>{const _0x4c8df9=_0x49f930;_0x40b736[_0x4c8df9(0x1d2)](path['join'](__dirname,bbpath2,'build',_0x4c8df9(0x199)));}),app[_0x49f930(0x2d1)]('/:bot/history',(_0xf31a74,_0x1a266f)=>{const _0x1b494f=_0x49f930;_0x1a266f[_0x1b494f(0x1d2)](path[_0x1b494f(0x27c)](__dirname,bbpath2,_0x1b494f(0x23e),_0x1b494f(0x199)));}),app[_0x49f930(0x2d1)](_0x49f930(0x1f2),(_0x2c4328,_0xd1b188)=>{const _0x411380=_0x49f930;_0xd1b188[_0x411380(0x1d2)](path[_0x411380(0x27c)](__dirname,bbpath2,_0x411380(0x23e),_0x411380(0x199)));}),app[_0x49f930(0x2d1)](_0x49f930(0x2fa),(_0x4a53a3,_0x1d0f5e)=>{const _0x30d8c0=_0x49f930;_0x1d0f5e[_0x30d8c0(0x1d2)](path['join'](__dirname,bbpath2,_0x30d8c0(0x23e),_0x30d8c0(0x199)));});if(HOST)http[_0x49f930(0x14e)](PORT,HOST);else http[_0x49f930(0x14e)](PORT);const io=require(_0x49f930(0x296))(http,{});openBrowser&&(async()=>{const _0x21ee7b=_0x49f930,_0xcd63d6=(await import(_0x21ee7b(0x208)))['default'];await _0xcd63d6(_0x21ee7b(0x133)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1f4ae5=_0x49f930;let _0x219be6=_0x1f4ae5(0x281);const _0x3c0612=networkInterfaces(),_0x3aa866={};for(const _0x40491d of Object[_0x1f4ae5(0x11d)](_0x3c0612)){for(const _0xb30e1c of _0x3c0612[_0x40491d]){if((_0xb30e1c['family']=='IPv4'||_0xb30e1c[_0x1f4ae5(0x19e)]==0x4)&&!_0xb30e1c[_0x1f4ae5(0x17f)]){const _0x2ee808=ipaddr[_0x1f4ae5(0x16d)](_0xb30e1c[_0x1f4ae5(0x1e5)])[_0x1f4ae5(0x1c0)]();_0x2ee808!=_0x1f4ae5(0x2f2)&&(!_0x3aa866[_0x40491d]&&(_0x3aa866[_0x40491d]=[]),_0x3aa866[_0x40491d][_0x1f4ae5(0x1fb)](_0xb30e1c['address']),_0x219be6=_0xb30e1c[_0x1f4ae5(0x1e5)]);}}}return{'serverip':_0x219be6,'netinterfaces':_0x3aa866};}async function startServer(){const _0x3f7c82=_0x49f930,{serverip:_0x5a9db5,netinterfaces:_0x44b643}=getServerIP();logger['simple'](''),logger[_0x3f7c82(0x193)]('-----------------------------------------------------------------------------------'),await logger[_0x3f7c82(0x2df)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment=='staging'?_0x3f7c82(0x25c):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x3f7c82(0x292)+_0x5a9db5+':'+PORT+_0x3f7c82(0x1bc))),logger[_0x3f7c82(0x193)](_0x3f7c82(0x268));if(config['length']!=0x0)for(const _0x2e5c80 of config){const _0x1d1dc7=_0x2e5c80[_0x3f7c82(0x206)]==_0x3f7c82(0x181)?'a':'m';if(_0x2e5c80[_0x3f7c82(0x23f)]=='enabled'||_0x2e5c80[_0x3f7c82(0x23f)]==_0x3f7c82(0x1f7))await logger[_0x3f7c82(0x2df)](_0x3f7c82(0x25a)+_0x1d1dc7+')\x20|\x20Bot\x20'+_0x2e5c80['botID']+'\x20|\x20'+_0x2e5c80[_0x3f7c82(0x29c)]),startBot([_0x2e5c80[_0x3f7c82(0x195)],userID],{'cwd':bbpath},function(_0x1953a0){const _0x5582b4=_0x3f7c82;if(_0x1953a0)logger[_0x5582b4(0x2df)](_0x1953a0);});else(_0x2e5c80[_0x3f7c82(0x23f)]==_0x3f7c82(0x21c)||_0x2e5c80[_0x3f7c82(0x23f)]=='new-disabled')&&await logger[_0x3f7c82(0x2df)](_0x3f7c82(0x18a)+_0x1d1dc7+_0x3f7c82(0x220)+_0x2e5c80['botID']+_0x3f7c82(0x185)+_0x2e5c80[_0x3f7c82(0x29c)]);}else!newBot&&logger[_0x3f7c82(0x193)](_0x3f7c82(0x135));if(newBot)addBot();logger[_0x3f7c82(0x193)]('-----------------------------------------------------------------------------------'),logger[_0x3f7c82(0x193)](''),await logger['debug'](_0x3f7c82(0x2b7)+nodeversion),await logger[_0x3f7c82(0x2fb)](_0x3f7c82(0x1a8),_0x44b643);}function startSocket(){const _0x5ddbb3=_0x49f930;io['on'](_0x5ddbb3(0x27a),_0x42eda5=>{const _0x569df0=_0x5ddbb3;let _0x42f5a0,_0x21618d,_0x3b5c0e,_0x3b4a6d,_0xb1ff74;const _0x19f26c=_0x42eda5['handshake'][_0x569df0(0x21f)][_0x569df0(0x314)];_0x21618d=_0x19f26c[_0x569df0(0x2eb)](/bot[0-9]{3}/);if(_0x21618d)_0x3b5c0e=_0x21618d[0x0]['match'](/[0-9]{3}/);if(_0x3b5c0e)_0x42f5a0=_0x3b5c0e[0x0];else _0x42f5a0=_0x569df0(0x144);const _0x427bb4=_0x42eda5[_0x569df0(0x1bb)][_0x569df0(0x168)][_0x569df0(0x19d)];if(!_0x427bb4)_0x42eda5[_0x569df0(0x1b0)](_0x569df0(0x23f),{'publicKey':secure[_0x569df0(0x2be)]});else{_0x3b4a6d=timelyDecrypt(_0x427bb4,![]);if(!_0x3b4a6d)_0x42eda5[_0x569df0(0x1b0)](_0x569df0(0x23f),{'publicKey':secure[_0x569df0(0x2be)]});else{_0xb1ff74=normalizeIP(_0x42eda5[_0x569df0(0x1a5)]['remoteAddress'])['store'];if(!devices[_0x3b4a6d])devices[_0x3b4a6d]={'uuid':_0x3b4a6d,'access':{'token':null}};devices[_0x3b4a6d]['ip']=_0xb1ff74;const _0x42d2da=addClient(_0x42eda5['id'],_0x3b4a6d,_0x42f5a0);setAccess(_0x42d2da),emitMessages(),_0x42eda5['on'](_0x569df0(0x2f9),_0xfc082b=>{const _0xced97a=_0x569df0,_0x4685bf=timelyDecrypt(_0xfc082b[_0xced97a(0x31e)],!![],_0xced97a(0x1a4));if(_0x4685bf){_0xfc082b={'username':_0xfc082b[_0xced97a(0x1ea)],'password':_0x4685bf},devices[_0x3b4a6d][_0xced97a(0x123)]=validateCredentials(_0xfc082b,_0x3b4a6d);if(devices[_0x3b4a6d][_0xced97a(0x123)][_0xced97a(0x114)]==![]&&devices[_0x3b4a6d][_0xced97a(0x123)][_0xced97a(0x317)]==_0xced97a(0x1c5))_0x42eda5[_0xced97a(0x1b0)]('status',{'access':devices[_0x3b4a6d][_0xced97a(0x123)]}),loginAccess2FA(_0x3b4a6d,_0xb1ff74);else{if(devices[_0x3b4a6d]['access'][_0xced97a(0x114)]==![]&&devices[_0x3b4a6d][_0xced97a(0x123)][_0xced97a(0x317)]==_0xced97a(0x2c7))_0x42eda5[_0xced97a(0x1b0)](_0xced97a(0x23f),{'access':devices[_0x3b4a6d][_0xced97a(0x123)]});else devices[_0x3b4a6d][_0xced97a(0x123)][_0xced97a(0x114)]&&devices[_0x3b4a6d][_0xced97a(0x123)][_0xced97a(0x317)]==_0xced97a(0x28f)&&(getClientsWithUuid(_0x3b4a6d)[_0xced97a(0x22e)](_0x48e3fb=>{setAccess(_0x48e3fb);}),logger[_0xced97a(0x2fb)]('Logged\x20in\x20user\x20...'+_0x3b4a6d[_0xced97a(0x31f)](-0x8)),setTokenRefresh(_0x3b4a6d),setSessionTimeout(_0xced97a(0x2f9),_0x3b4a6d));}}else logger[_0xced97a(0x2df)](_0xced97a(0x1b2));}),_0x42eda5['on'](_0x569df0(0x2e5),()=>{resetPassword();}),_0x42eda5['on'](_0x569df0(0x2cd),_0x5f5813=>{removeClient(_0x42eda5['id']);}),_0x42f5a0=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x510f06){const _0x1b04c0=_0x49f930;if(_0x510f06!=_0x1b04c0(0x144)&&config[_0x1b04c0(0x31d)]!=''){if(pid[_0x510f06])pid[_0x510f06][_0x1b04c0(0x28e)]({'function':_0x1b04c0(0x2c4),'args':null});}_0x510f06!='botmanager'&&broadcastToBots(_0x1b04c0(0x1b5),JSON['stringify'](config));}function reloadBotManager(){const _0x2961e2=_0x49f930;getClientsWithBotID(_0x2961e2(0x144))[_0x2961e2(0x22e)](_0x4f9459=>{getSocket(_0x4f9459['id'])['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x29b1a6){const _0x1b171f=_0x49f930,_0x1b1103=io[_0x1b171f(0x2b4)]['get']('/');return _0x1b1103[_0x1b171f(0x130)][_0x1b171f(0x2d1)](_0x29b1a6);}function setAccess(_0x43a851){const _0x62d79d=_0x49f930,_0x137160=getSocket(_0x43a851['id']),_0x20530e=_0x43a851[_0x62d79d(0x2ea)],_0x435414=_0x43a851[_0x62d79d(0x25f)];devices[_0x20530e][_0x62d79d(0x123)]=validateAccess(devices[_0x20530e][_0x62d79d(0x123)][_0x62d79d(0x2b0)],_0x20530e),logger[_0x62d79d(0x2fb)](_0x62d79d(0x316)+devices[_0x20530e][_0x62d79d(0x123)]['reason']+_0x62d79d(0x1c7)+_0x43a851['id']['slice'](-0x8)+_0x62d79d(0x18c)+_0x20530e[_0x62d79d(0x31f)](-0x8)),_0x137160[_0x62d79d(0x27c)](_0x20530e);if(devices[_0x20530e]['access'][_0x62d79d(0x114)]){_0x137160[_0x62d79d(0x27c)](_0x435414);if(_0x435414=='botmanager')initializeSocketBotManager(_0x137160);else initializeSocketBot(_0x137160);initClient(_0x435414);}devices[_0x20530e]['access'][_0x62d79d(0x2b0)]&&devices[_0x20530e][_0x62d79d(0x123)][_0x62d79d(0x317)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x62d79d(0x27b),_0x20530e),devices[_0x20530e][_0x62d79d(0x123)]['token']&&devices[_0x20530e][_0x62d79d(0x123)]['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x62d79d(0x2f9),_0x20530e),_0x137160[_0x62d79d(0x1b0)](_0x62d79d(0x23f),{'status':_0x43a851[_0x62d79d(0x19b)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x20530e][_0x62d79d(0x123)],'externalip':devices[_0x20530e]['ip'],'publicKey':secure[_0x62d79d(0x2be)],'userid':settings[_0x62d79d(0x2d9)],'validInstallation':validInstallation}),devices[_0x20530e][_0x62d79d(0x123)]['allow']==![]&&devices[_0x20530e]['access'][_0x62d79d(0x317)]==_0x62d79d(0x240)&&temporaryAccess2FA(_0x20530e,devices[_0x20530e]['ip']);}function setSessionTimeout(_0xbb27bc,_0x4abd6e){const _0x5c97f7=_0x49f930;let _0x5c401d;if(_0xbb27bc==_0x5c97f7(0x2f9))_0x5c401d=loginExpiry*0x3c*0x3e8;else _0x5c401d=devices[_0x4abd6e][_0x5c97f7(0x20e)][_0x5c97f7(0x263)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x4abd6e][_0x5c97f7(0x20e)][_0x5c97f7(0x1ee)]);if(devices[_0x4abd6e][_0x5c97f7(0x1af)])clearTimeout(devices[_0x4abd6e][_0x5c97f7(0x1af)]);devices[_0x4abd6e][_0x5c97f7(0x1af)]=setTimeout(()=>{const _0x80a513=_0x5c97f7;if(devices[_0x4abd6e][_0x80a513(0x2d4)])clearTimeout(devices[_0x4abd6e][_0x80a513(0x2d4)]);removeSocketListeners(_0x4abd6e),addBlacklist(_0x4abd6e),devices[_0x4abd6e][_0x80a513(0x20e)]=null,devices[_0x4abd6e][_0x80a513(0x11a)]=null,devices[_0x4abd6e][_0x80a513(0x123)][_0x80a513(0x2b0)]=null,logger[_0x80a513(0x2fb)](_0x80a513(0x173)+_0x4abd6e[_0x80a513(0x31f)](-0x8)),devices[_0x4abd6e][_0x80a513(0x123)]=validateAccess(devices[_0x4abd6e][_0x80a513(0x123)]['token'],_0x4abd6e),!(devices[_0x4abd6e][_0x80a513(0x123)][_0x80a513(0x114)]&&devices[_0x4abd6e][_0x80a513(0x123)][_0x80a513(0x317)]==_0x80a513(0x30c))&&(_0xbb27bc==_0x80a513(0x2f9)?io['to'](_0x4abd6e)['emit'](_0x80a513(0x23f),{'access':{'allow':![],'reason':_0x80a513(0x2fd),'token':null}}):io['to'](_0x4abd6e)['emit'](_0x80a513(0x23f),{'access':{'allow':![],'reason':_0x80a513(0x2f1),'token':null}})),devices[_0x4abd6e][_0x80a513(0x123)][_0x80a513(0x2b0)]=null;},_0x5c401d);}function setTokenRefresh(_0x3f5b16){const _0x2ba80f=_0x49f930;if(devices[_0x3f5b16]['pidRefreshToken'])clearTimeout(devices[_0x3f5b16][_0x2ba80f(0x2d4)]);devices[_0x3f5b16][_0x2ba80f(0x2d4)]=setTimeout(()=>{const _0x31f22a=_0x2ba80f;getClientsWithUuid(_0x3f5b16)[_0x31f22a(0x287)]!=0x0?(devices[_0x3f5b16][_0x31f22a(0x123)]=refreshToken(_0x3f5b16),io['to'](_0x3f5b16)[_0x31f22a(0x1b0)](_0x31f22a(0x23f),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x3f5b16][_0x31f22a(0x123)],'externalip':devices[_0x3f5b16]['ip'],'publicKey':secure[_0x31f22a(0x2be)],'validInstallation':validInstallation}),setTokenRefresh(_0x3f5b16)):clearTimeout(devices[_0x3f5b16]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x456b01){const _0x3455b2=_0x49f930,_0x34d6c3=getClient(_0x456b01['id'])['uuid'];_0x456b01[_0x3455b2(0x1b0)](_0x3455b2(0x1b5),config),_0x456b01[_0x3455b2(0x1b0)]('settings',cleanSettings()),_0x456b01['on'](_0x3455b2(0x223),_0x4cef3f=>{const _0x1bd2dc=_0x3455b2;if(validateAccess(_0x4cef3f,_0x34d6c3)[_0x1bd2dc(0x114)])addBot();else logger['full'](_0x1bd2dc(0x252));}),_0x456b01['on']('update-bot',(_0x5c0e5e,_0x30b95f)=>{const _0x551213=_0x3455b2;if(validateAccess(_0x30b95f,_0x34d6c3)[_0x551213(0x114)])toggleBot(_0x5c0e5e[_0x551213(0x195)],_0x5c0e5e['status'],_0x5c0e5e[_0x551213(0x172)]);else logger[_0x551213(0x2df)](_0x551213(0x1e0));}),_0x456b01['on'](_0x3455b2(0x216),(_0x842d6,_0x2edf71)=>{const _0xe301cf=_0x3455b2;if(validateAccess(_0x2edf71,_0x34d6c3)['allow'])toggleBotMode(_0x842d6);else logger[_0xe301cf(0x2df)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x456b01['on']('delete-bot',(_0x469861,_0x5f419e)=>{if(validateAccess(_0x5f419e,_0x34d6c3)['allow'])deleteBot(_0x469861);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x456b01['on'](_0x3455b2(0x218),(_0x57e52f,_0x582543)=>{const _0x535db8=_0x3455b2;if(validateAccess(_0x582543,_0x34d6c3)['allow'])storeSettings(_0x57e52f,!![]);else logger[_0x535db8(0x2df)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x456b01['on'](_0x3455b2(0x203),_0x5548ff=>{const _0x32984b=_0x3455b2;if(validateAccess(_0x5548ff,_0x34d6c3)[_0x32984b(0x114)])updateBB(_0x32984b(0x325));else logger[_0x32984b(0x2df)](_0x32984b(0x24c));}),_0x456b01['on'](_0x3455b2(0x200),_0x46f8db=>{const _0x5d3fe2=_0x3455b2;if(validateAccess(_0x46f8db,_0x34d6c3)[_0x5d3fe2(0x114)])updateBB(_0x5d3fe2(0x255));else logger[_0x5d3fe2(0x2df)](_0x5d3fe2(0x238));}),_0x456b01['on'](_0x3455b2(0x146),_0x43e823=>{const _0xc060d9=_0x3455b2;if(validateAccess(_0x43e823,_0x34d6c3)[_0xc060d9(0x114)]){const _0x321413=getClient(_0x456b01['id']);if(_0x321413)getBackupFiles(_0x321413[_0xc060d9(0x2ea)]);else logger[_0xc060d9(0x2df)](_0xc060d9(0x313));}else logger[_0xc060d9(0x2df)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x456b01['on'](_0x3455b2(0x188),(_0x113fb8,_0x3e45b7)=>{const _0x34b52b=_0x3455b2;if(validateAccess(_0x3e45b7,_0x34d6c3)[_0x34b52b(0x114)])restoreBackupFile(_0x113fb8);else logger[_0x34b52b(0x2df)](_0x34b52b(0x261));}),_0x456b01['on']('get-messages',_0x2ae387=>{const _0x1a6e28=_0x3455b2;if(validateAccess(_0x2ae387,_0x34d6c3)['allow'])getMessages();else logger[_0x1a6e28(0x2df)](_0x1a6e28(0x2c1));}),_0x456b01['on']('confirm-message',(_0x27e02e,_0x4aacb8)=>{const _0x2ae212=_0x3455b2;if(validateAccess(_0x4aacb8,_0x34d6c3)[_0x2ae212(0x114)])confirmMessage(_0x27e02e);else logger[_0x2ae212(0x2df)](_0x2ae212(0x2d6));}),_0x456b01['on'](_0x3455b2(0x326),_0x1cd0e5=>{const _0xe715bb=_0x3455b2;if(validateAccess(_0x1cd0e5,_0x34d6c3)[_0xe715bb(0x114)]){if(devices[_0x34d6c3][_0xe715bb(0x2d4)])clearTimeout(devices[_0x34d6c3]['pidRefreshToken']);if(devices[_0x34d6c3][_0xe715bb(0x1af)])clearTimeout(devices[_0x34d6c3][_0xe715bb(0x1af)]);removeSocketListeners(getClient(_0x456b01['id'])[_0xe715bb(0x2ea)]),addBlacklist(_0x34d6c3),devices[_0x34d6c3][_0xe715bb(0x20e)]=null,devices[_0x34d6c3]['telegram2FaApproval']=null,devices[_0x34d6c3][_0xe715bb(0x123)][_0xe715bb(0x2b0)]=null,logger['debug'](_0xe715bb(0x1df)+_0x34d6c3[_0xe715bb(0x31f)](-0x8)),io['to'](getClient(_0x456b01['id'])[_0xe715bb(0x2ea)])[_0xe715bb(0x1b0)](_0xe715bb(0x23f),{'access':{'allow':![],'reason':_0xe715bb(0x1ab),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x45da75){const _0x51f4de=_0x49f930,_0x42d67a=getClient(_0x45da75['id'])['bot'],_0x375713=getClient(_0x45da75['id'])['uuid'];_0x45da75['on'](_0x51f4de(0x264),(_0x309903,_0x282e5c)=>{const _0x7ac5e5=_0x51f4de;if(validateAccess(_0x282e5c,_0x375713)[_0x7ac5e5(0x114)]){if(pid[_0x42d67a])pid[_0x42d67a][_0x7ac5e5(0x28e)]({'function':'emitHistory','args':_0x309903});}else logger[_0x7ac5e5(0x2df)](_0x7ac5e5(0x17a));}),_0x45da75['on']('delete-alerts',(_0x15d1d6,_0x484999)=>{const _0x4a4f89=_0x51f4de;if(validateAccess(_0x484999,_0x375713)[_0x4a4f89(0x114)]){if(pid[_0x42d67a])pid[_0x42d67a][_0x4a4f89(0x28e)]({'function':_0x4a4f89(0x2b5),'args':_0x15d1d6});}else logger[_0x4a4f89(0x2df)](_0x4a4f89(0x1ba));}),_0x45da75['on'](_0x51f4de(0x161),(_0x367aa6,_0x4deba0)=>{const _0xdebeb2=_0x51f4de;if(validateAccess(_0x4deba0,_0x375713)[_0xdebeb2(0x114)]){if(pid[_0x42d67a])pid[_0x42d67a][_0xdebeb2(0x28e)]({'function':_0xdebeb2(0x29e),'args':_0x367aa6});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x45da75['on'](_0x51f4de(0x30a),(_0x125102,_0xd49d4c)=>{const _0x3e2f4f=_0x51f4de;if(validateAccess(_0xd49d4c,_0x375713)[_0x3e2f4f(0x114)]){if(pid[_0x42d67a])pid[_0x42d67a][_0x3e2f4f(0x28e)]({'function':_0x3e2f4f(0x30d),'args':_0x125102});}else logger['full'](_0x3e2f4f(0x201));}),_0x45da75['on'](_0x51f4de(0x1ac),(_0x449ee9,_0x58011a)=>{const _0x40c86e=_0x51f4de;if(validateAccess(_0x58011a,_0x375713)[_0x40c86e(0x114)]){if(pid[_0x42d67a])pid[_0x42d67a][_0x40c86e(0x28e)]({'function':_0x40c86e(0x2c5),'args':_0x449ee9});}else logger[_0x40c86e(0x2df)](_0x40c86e(0x192));}),_0x45da75['on']('store-fiat',(_0x5052b0,_0x437e18)=>{const _0x4c73a6=_0x51f4de;if(validateAccess(_0x437e18,_0x375713)[_0x4c73a6(0x114)]){if(pid[_0x42d67a])pid[_0x42d67a]['send']({'function':_0x4c73a6(0x273),'args':_0x5052b0});}else logger[_0x4c73a6(0x2df)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x45da75['on']('reset-history',_0x778624=>{const _0x2c6a32=_0x51f4de;if(validateAccess(_0x778624,_0x375713)['allow']){if(pid[_0x42d67a])pid[_0x42d67a][_0x2c6a32(0x28e)]({'function':_0x2c6a32(0x148),'args':null});}else logger[_0x2c6a32(0x2df)](_0x2c6a32(0x25b));}),_0x45da75['on'](_0x51f4de(0x2e3),_0x320f25=>{const _0x582173=_0x51f4de;if(validateAccess(_0x320f25,_0x375713)[_0x582173(0x114)]){if(pid[_0x42d67a])pid[_0x42d67a]['send']({'function':_0x582173(0x1aa),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x45da75['on'](_0x51f4de(0x2bd),(_0x56d275,_0x34ceb3)=>{const _0x51349b=_0x51f4de;if(validateAccess(_0x34ceb3,_0x375713)[_0x51349b(0x114)]){if(pid[_0x42d67a])pid[_0x42d67a]['send']({'function':_0x51349b(0x2f0),'args':_0x56d275});}else logger[_0x51349b(0x2df)](_0x51349b(0x1be));}),_0x45da75['on']('cancel-loading',_0x508ff0=>{const _0x27cb76=_0x51f4de;if(validateAccess(_0x508ff0,_0x375713)[_0x27cb76(0x114)]){if(pid[_0x42d67a])pid[_0x42d67a][_0x27cb76(0x28e)]({'function':_0x27cb76(0x20d),'args':null});}else logger[_0x27cb76(0x2df)](_0x27cb76(0x2a3));}),_0x45da75['on'](_0x51f4de(0x12d),_0x43edc7=>{const _0x144bc7=_0x51f4de;if(validateAccess(_0x43edc7,_0x375713)[_0x144bc7(0x114)]){if(pid[_0x42d67a])pid[_0x42d67a][_0x144bc7(0x28e)]({'function':_0x144bc7(0x23a),'args':null});}else logger[_0x144bc7(0x2df)](_0x144bc7(0x1b3));}),_0x45da75['on'](_0x51f4de(0x203),_0x18a4df=>{const _0xc21c6=_0x51f4de;if(validateAccess(_0x18a4df,_0x375713)[_0xc21c6(0x114)])updateBB(_0xc21c6(0x325));else logger[_0xc21c6(0x2df)](_0xc21c6(0x24c));}),_0x45da75['on'](_0x51f4de(0x32a),_0x523f40=>{const _0x5e434=_0x51f4de;if(validateAccess(_0x523f40,_0x375713)[_0x5e434(0x114)])getMessages();else logger[_0x5e434(0x2df)](_0x5e434(0x2c1));}),_0x45da75['on'](_0x51f4de(0x17c),(_0x5e6d8a,_0xae1241)=>{const _0x280529=_0x51f4de;if(validateAccess(_0xae1241,_0x375713)[_0x280529(0x114)])confirmMessage(_0x5e6d8a);else logger[_0x280529(0x2df)](_0x280529(0x2d6));}),_0x45da75['on']('logout',_0x5ac233=>{const _0x9d93bc=_0x51f4de;if(validateAccess(_0x5ac233,_0x375713)[_0x9d93bc(0x114)]){if(devices[_0x375713][_0x9d93bc(0x2d4)])clearTimeout(devices[_0x375713][_0x9d93bc(0x2d4)]);if(devices[_0x375713][_0x9d93bc(0x1af)])clearTimeout(devices[_0x375713][_0x9d93bc(0x1af)]);removeSocketListeners(getClient(_0x45da75['id'])[_0x9d93bc(0x2ea)]),addBlacklist(_0x375713),devices[_0x375713][_0x9d93bc(0x20e)]=null,devices[_0x375713]['telegram2FaApproval']=null,devices[_0x375713][_0x9d93bc(0x123)][_0x9d93bc(0x2b0)]=null,logger[_0x9d93bc(0x2fb)](_0x9d93bc(0x1df)+_0x375713[_0x9d93bc(0x31f)](-0x8)),io['to'](getClient(_0x45da75['id'])[_0x9d93bc(0x2ea)])[_0x9d93bc(0x1b0)](_0x9d93bc(0x23f),{'access':{'allow':![],'reason':_0x9d93bc(0x1ab),'token':null}});}else logger[_0x9d93bc(0x2df)](_0x9d93bc(0x303));});}function removeSocketListeners(_0x4dca56){const _0x25dfa8=_0x49f930;getClientsWithUuid(_0x4dca56)[_0x25dfa8(0x22e)](_0x2dbf30=>{const _0x5220d4=_0x25dfa8;getSocket(_0x2dbf30['id'])[_0x5220d4(0x323)]();});}function cleanSettings(){const _0x350e9e=_0x49f930;let _0x48f51d=settings;return settings[_0x350e9e(0x2c9)]&&settings[_0x350e9e(0x2c9)]!=''&&(_0x48f51d={..._0x48f51d,'telegramToken':'************'}),settings[_0x350e9e(0x170)]&&settings[_0x350e9e(0x170)]!=''&&(_0x48f51d={..._0x48f51d,'bbPassword':_0x350e9e(0x117)}),settings[_0x350e9e(0x12b)]&&settings[_0x350e9e(0x12b)]!=''&&(_0x48f51d={..._0x48f51d,'marketcapApi':_0x350e9e(0x117)}),(settings['bbPassword']&&settings['bbPassword']==_0x350e9e(0x13c)||settings[_0x350e9e(0x2c9)]&&settings[_0x350e9e(0x2c9)]=='***'||settings[_0x350e9e(0x12b)]&&settings[_0x350e9e(0x12b)]==_0x350e9e(0x13c))&&(_0x48f51d={..._0x48f51d,'restored':{'password':settings[_0x350e9e(0x170)]==_0x350e9e(0x13c),'telegram':settings['telegramToken']=='***','marketcap':settings[_0x350e9e(0x12b)]==_0x350e9e(0x13c)}}),_0x48f51d;}async function updateBB(_0x4767c3){const _0x382293=_0x49f930;await backupConfigFiles(),installingUpdate=!![],config[_0x382293(0x22e)](_0x53a0e0=>{const _0x3e5cb0=_0x382293;restartBot(_0x53a0e0[_0x3e5cb0(0x195)]);});if(_0x4767c3=='update')process[_0x382293(0x28e)]({'update':!![],'environment':environment},_0x495653=>{});else _0x4767c3==_0x382293(0x255)&&process[_0x382293(0x28e)]({'reinstall':!![],'environment':environment},_0x35a8a8=>{});}function startBot(_0x2cf95b,_0x27442a,_0x73200f){const _0x53f49d=_0x49f930;if(debugging)_0x2cf95b[_0x53f49d(0x1fb)]('-d');if(recreate)_0x2cf95b[_0x53f49d(0x1fb)]('-r');let _0x4d2d78=![];const _0x20039c=_0x2cf95b[0x0];_0x27442a={..._0x27442a,'stdio':[_0x53f49d(0x155),'inherit',_0x53f49d(0x155),_0x53f49d(0x2ff)]},pid[_0x20039c]=childProcess['fork'](botfile,_0x2cf95b,_0x27442a),pid[_0x20039c]['on'](_0x53f49d(0x290),_0x431c63=>{const _0x3538e4=_0x53f49d;switch(Object[_0x3538e4(0x11d)](_0x431c63)[0x0]){case _0x3538e4(0x29c):updateBotName(_0x20039c,_0x431c63['botname']);break;case _0x3538e4(0x12a):updateBotManager();break;case _0x3538e4(0x23f):updateStatus(_0x20039c,_0x431c63[_0x3538e4(0x23f)]);break;case'live':updateLive(_0x20039c,_0x431c63['live']);break;case _0x3538e4(0x176):updateLive(_0x20039c,_0x431c63[_0x3538e4(0x176)]),io['to'](_0x20039c)[_0x3538e4(0x1b0)](_0x3538e4(0x23f),{'access':{'allow':![],'reason':_0x3538e4(0x307),'token':null}});break;case'stop':_0x431c63['stop']==_0x3538e4(0x305)&&restartBot(_0x20039c);_0x431c63['stop']==_0x3538e4(0x14c)&&toggleBot(_0x20039c,_0x3538e4(0x21c),_0x3538e4(0x20f));break;case _0x3538e4(0x288):sendTelegramBot(_0x20039c,_0x431c63['telegram']);break;case _0x3538e4(0x2f8):sendTelegramMsg(_0x431c63[_0x3538e4(0x2f8)]);break;case _0x3538e4(0x1cb):io['to'](_0x20039c)['emit'](_0x431c63[_0x3538e4(0x1cb)],_0x431c63[_0x3538e4(0x2ba)]);break;}}),pid[_0x20039c]['on']('error',function(_0x326216){if(_0x4d2d78)return;_0x4d2d78=!![],_0x73200f(_0x326216);}),pid[_0x20039c]['on']('exit',async function(_0x1dfb7c){const _0x544bc0=_0x53f49d;if(terminating)return;if(installingUpdate){io['close']();return;}if(_0x4d2d78)return;_0x4d2d78=!![],_0x73200f(null);const _0xbaffdc=dbConfig['get'](_0x544bc0(0x1b5))[_0x544bc0(0x2ce)]({'botID':_0x20039c})[_0x544bc0(0x24a)]();_0xbaffdc&&(_0xbaffdc['status']=='enabled'||_0xbaffdc[_0x544bc0(0x23f)]==_0x544bc0(0x1f7))&&(await sleep(0x3e8),updateLive(_0x20039c,_0x544bc0(0x20f)),logger['full'](_0x544bc0(0x16f)+botRef(_0x20039c)),startBot([_0x20039c,userID],{'cwd':bbpath},function(_0x92b4f5){const _0x48b3c1=_0x544bc0;if(_0x92b4f5)logger[_0x48b3c1(0x2df)](_0x92b4f5);}));});}function stopBot(_0x3195a7){const _0x5a7f86=_0x49f930;getClientsWithBotID(_0x3195a7)[_0x5a7f86(0x22e)](_0x1c77e4=>{const _0x56fa79=_0x5a7f86;getSocket(_0x1c77e4['id'])[_0x56fa79(0x2cd)](!![]),removeClient(_0x1c77e4['id']);}),pid[_0x3195a7]&&(pid[_0x3195a7]['kill'](),pid[_0x3195a7]=null);}function stopAllBots(){terminating=!![];const _0x29f61d=getEnabledBots();_0x29f61d['forEach'](_0x4faaeb=>{const _0x5d6d29=_0x2ff0;stopBot(_0x4faaeb[_0x5d6d29(0x195)]);});}function restartBot(_0x591c50){if(pid[_0x591c50])pid[_0x591c50]['kill']();}function addBot(){const _0x1b061b=_0x49f930;let _0x18db4d;for(let _0x326c09=0x1;_0x326c09<0x3e9;_0x326c09++){_0x18db4d=_0x326c09[_0x1b061b(0x294)]()['padStart'](0x3,'0');let _0x47c2d5=config['find'](_0x38fc2e=>_0x38fc2e['botID']==_0x18db4d);if(!_0x47c2d5)break;}if(_0x18db4d===_0x1b061b(0x140)){logger[_0x1b061b(0x2df)](_0x1b061b(0x131));return;}logger[_0x1b061b(0x2df)](_0x1b061b(0x187)+_0x18db4d),dbConfig[_0x1b061b(0x2d1)]('bots')[_0x1b061b(0x1fb)]({'botID':_0x18db4d,'botname':_0x1b061b(0x331)+_0x18db4d,'status':_0x1b061b(0x1f7),'live':''})[_0x1b061b(0x1de)](),startBot([_0x18db4d,userID],{'cwd':bbpath},function(_0x3ee8ed){const _0x50fec6=_0x1b061b;if(_0x3ee8ed)logger[_0x50fec6(0x2df)](_0x3ee8ed);}),config=getConfiguration(),io['to'](_0x1b061b(0x144))[_0x1b061b(0x1b0)]('bots',config),broadcastToBots(_0x1b061b(0x1b5),JSON[_0x1b061b(0x2fc)](config));}function deleteBot(_0x59ebb6){const _0x11d476=_0x49f930;getClientsWithBotID(_0x59ebb6)[_0x11d476(0x22e)](_0x8fa9ec=>{const _0x5a9d12=_0x11d476;getSocket(_0x8fa9ec['id'])[_0x5a9d12(0x2cd)](!![]),removeClient(_0x8fa9ec['id']);}),dbConfig[_0x11d476(0x2d1)](_0x11d476(0x1b5))[_0x11d476(0x227)]({'botID':_0x59ebb6})[_0x11d476(0x1de)](),logger[_0x11d476(0x2df)](_0x11d476(0x2b9)+_0x59ebb6),stopBot(_0x59ebb6);try{if(fs[_0x11d476(0x28a)](path[_0x11d476(0x27c)](configpath,'bot-'+_0x59ebb6+'-config.json')))fs['unlinkSync'](path['join'](configpath,_0x11d476(0x2c8)+_0x59ebb6+_0x11d476(0x20b)));if(fs[_0x11d476(0x28a)](path[_0x11d476(0x27c)](configpath,_0x11d476(0x2c8)+_0x59ebb6+_0x11d476(0x250))))fs[_0x11d476(0x2d3)](path['join'](configpath,_0x11d476(0x2c8)+_0x59ebb6+_0x11d476(0x250)));if(fs[_0x11d476(0x28a)](path[_0x11d476(0x27c)](configpath,'bot-'+_0x59ebb6+_0x11d476(0x333))))fs[_0x11d476(0x2d3)](path[_0x11d476(0x27c)](configpath,'bot-'+_0x59ebb6+_0x11d476(0x333)));if(fs['existsSync'](path[_0x11d476(0x27c)](configpath,_0x11d476(0x2c8)+_0x59ebb6+_0x11d476(0x270))))fs[_0x11d476(0x2d3)](path[_0x11d476(0x27c)](configpath,_0x11d476(0x2c8)+_0x59ebb6+_0x11d476(0x270)));}catch(_0x3db409){if(_0x3db409)logger['full'](_0x11d476(0x1a3),_0x3db409);}config=getConfiguration(),io['to'](_0x11d476(0x144))[_0x11d476(0x1b0)](_0x11d476(0x1b5),config),broadcastToBots(_0x11d476(0x1b5),JSON[_0x11d476(0x2fc)](config));}function toggleBot(_0xfcbe5,_0x38ab5d,_0x30268d){const _0x208124=_0x49f930;dbConfig[_0x208124(0x2d1)]('bots')[_0x208124(0x2ce)]({'botID':_0xfcbe5})[_0x208124(0x154)]({'status':_0x38ab5d})[_0x208124(0x154)]({'live':_0x30268d})['write']();const _0x25689f=botRef(_0xfcbe5);if(_0x38ab5d==_0x208124(0x175)||_0x38ab5d==_0x208124(0x1f7))logger[_0x208124(0x2df)]('Enabled\x20'+_0x25689f),startBot([_0xfcbe5,userID],{'cwd':bbpath},function(_0x3a5484){if(_0x3a5484)logger['full'](_0x3a5484);});else(_0x38ab5d==_0x208124(0x21c)||_0x38ab5d==_0x208124(0x308))&&(logger[_0x208124(0x2df)](_0x208124(0x24e)+_0x25689f),stopBot(_0xfcbe5));config=getConfiguration(),io['to']('botmanager')[_0x208124(0x1b0)]('bots',config),broadcastToBots('bots',JSON[_0x208124(0x2fc)](config));}function toggleStatus(_0xd3f8e8){const _0x5aa325=_0x49f930;let _0x4b047e=dbConfig[_0x5aa325(0x2d1)](_0x5aa325(0x1b5))[_0x5aa325(0x2ce)]({'botID':_0xd3f8e8})[_0x5aa325(0x24a)](),_0x4f8f88;if(_0x4b047e['status']===_0x5aa325(0x175))_0x4f8f88='disabled';else{if(_0x4b047e[_0x5aa325(0x23f)]===_0x5aa325(0x1f7))_0x4f8f88=_0x5aa325(0x308);else{if(_0x4b047e[_0x5aa325(0x23f)]===_0x5aa325(0x308))_0x4f8f88='new';else{if(_0x4b047e[_0x5aa325(0x23f)]===_0x5aa325(0x21c))_0x4f8f88=_0x5aa325(0x175);}}}return _0x4f8f88;}function updateStatus(_0x27fbdc,_0x247c37){const _0x36c26d=_0x49f930;dbConfig[_0x36c26d(0x2d1)](_0x36c26d(0x1b5))[_0x36c26d(0x2ce)]({'botID':_0x27fbdc})[_0x36c26d(0x154)]({'status':_0x247c37})['write'](),config=getConfiguration(),io['to']('botmanager')['emit']('bots',config),broadcastToBots('bots',JSON[_0x36c26d(0x2fc)](config));}function updateLive(_0x25f4ec,_0xe1bfec){const _0x51a50e=_0x49f930;dbConfig[_0x51a50e(0x2d1)](_0x51a50e(0x1b5))[_0x51a50e(0x2ce)]({'botID':_0x25f4ec})[_0x51a50e(0x154)]({'live':_0xe1bfec})[_0x51a50e(0x1de)](),config=getConfiguration(),io['to']('botmanager')[_0x51a50e(0x1b0)](_0x51a50e(0x1b5),config),broadcastToBots(_0x51a50e(0x1b5),JSON[_0x51a50e(0x2fc)](config));}function updateBotName(_0x3ffc65,_0x5171d6){const _0x505226=_0x49f930;dbConfig['get'](_0x505226(0x1b5))[_0x505226(0x2ce)]({'botID':_0x3ffc65})['assign']({'botname':_0x5171d6})[_0x505226(0x1de)](),config=getConfiguration(),io['to'](_0x505226(0x144))[_0x505226(0x1b0)](_0x505226(0x1b5),config),broadcastToBots(_0x505226(0x1b5),JSON[_0x505226(0x2fc)](config));}function updateBotManager(){const _0xd75da1=_0x49f930;config=getConfiguration(),io['to'](_0xd75da1(0x144))[_0xd75da1(0x1b0)](_0xd75da1(0x1b5),config),broadcastToBots(_0xd75da1(0x1b5),JSON['stringify'](config));}function toggleBotMode(_0x594a30){const _0x52e73e=_0x49f930;if(pid[_0x594a30])pid[_0x594a30]['send']({'function':'toggleBotMode','args':null});else{const _0x4c9af1=configpath+_0x52e73e(0x2c8)+_0x594a30+_0x52e73e(0x20b),_0x151c0d=fs[_0x52e73e(0x25d)](_0x4c9af1),_0x1b4e3b=JSON['parse'](_0x151c0d),_0x345d11=_0x1b4e3b['bot'][0x0]['headless'];_0x1b4e3b[_0x52e73e(0x25f)][0x0]['headless']=!_0x345d11;const _0x579629=JSON[_0x52e73e(0x2fc)](_0x1b4e3b,null,0x2);fs[_0x52e73e(0x30e)](_0x4c9af1,_0x579629),config=getConfiguration(),io['to'](_0x52e73e(0x144))['emit']('bots',config),broadcastToBots(_0x52e73e(0x1b5),JSON['stringify'](config));}}function validateTelegram(_0x553aa3){const _0xae2300=_0x49f930;if(_0x553aa3[_0xae2300(0x230)]['username']!=settings[_0xae2300(0x2b1)]&&'@'+_0x553aa3['from']['username']!=settings[_0xae2300(0x2b1)]||_0x553aa3[_0xae2300(0x274)]['id']!=settings[_0xae2300(0x247)])return sendTelegram(_0x553aa3[_0xae2300(0x274)]['id'],_0xae2300(0x11c),{'parse_mode':'HTML'}),![];return!![];}function botRef(_0x4b3a21){const _0x188399=_0x49f930,_0x2ba3f0=getBotAttributes(_0x4b3a21),_0x3c3b1b=_0x2ba3f0[_0x188399(0x2d0)]?_0x2ba3f0[_0x188399(0x29c)]:_0x188399(0x331)+_0x4b3a21;return _0x3c3b1b;}async function initTelegram(){const _0x3ba94f=_0x49f930;tgBot&&(await tgBot[_0x3ba94f(0x190)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x3ba94f(0x2c9)]);let _0xc2c298=_0x3ba94f(0x26f);_0xc2c298+='\x0a',_0xc2c298+=_0x3ba94f(0x239),_0xc2c298+=_0x3ba94f(0x282),_0xc2c298+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0xc2c298+='/restart\x20-\x20restart\x20bot(s)\x0a',_0xc2c298+=_0x3ba94f(0x2e0),_0xc2c298+='/off\x20-\x20stop\x20bot(s)\x0a',_0xc2c298+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0xc2c298+='/names\x20-\x20show\x20bot\x20names\x0a',_0xc2c298+=_0x3ba94f(0x1b8),_0xc2c298+=_0x3ba94f(0x1f9),_0xc2c298+=_0x3ba94f(0x177),_0xc2c298+=_0x3ba94f(0x235),_0xc2c298+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0xc2c298+=_0x3ba94f(0x19a),_0xc2c298+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0xc2c298+=_0x3ba94f(0x13a);let _0xf5f2a8=_0x3ba94f(0x12f);_0xf5f2a8+='\x0a',_0xf5f2a8+=_0xc2c298,tgBot[_0x3ba94f(0x215)]((_0x427d34,_0x2c84d)=>{const _0x502d11=_0x3ba94f;logger[_0x502d11(0x193)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger[_0x502d11(0x2fb)](_0x502d11(0x17e),_0x427d34);}),tgBot[_0x3ba94f(0x126)](async(_0x5e580e,_0x56f754)=>{const _0x59fda3=_0x3ba94f;if(settings['telegramChatId']||_0x5e580e['update']['message'][_0x59fda3(0x328)]!=_0x59fda3(0x237)){if(!validateTelegram(_0x5e580e))return;}_0x56f754();}),tgBot[_0x3ba94f(0x127)](_0x3ba94f(0x295),async _0x4a597d=>{const _0x199aeb=_0x3ba94f;if(_0x4a597d[_0x199aeb(0x230)]['username']==settings[_0x199aeb(0x2b1)]||'@'+_0x4a597d['from'][_0x199aeb(0x1ea)]==settings['telegramUsername']){if(!settings[_0x199aeb(0x247)])updateSetting(_0x199aeb(0x247),_0x4a597d['chat']['id']);else{if(!validateTelegram(_0x4a597d))return;}}else{if(!validateTelegram(_0x4a597d))return;}updateSetting(_0x199aeb(0x11b),!![]),await sendTelegram(_0x4a597d['chat']['id'],_0xf5f2a8);}),tgBot[_0x3ba94f(0x127)](_0x3ba94f(0x13e),async _0x58f555=>{const _0x292d9b=_0x3ba94f;updateSetting(_0x292d9b(0x11b),!![]),await sendTelegram(_0x58f555['chat']['id'],_0x292d9b(0x1d7));}),tgBot[_0x3ba94f(0x127)](_0x3ba94f(0x12c),async _0x1a40d6=>{const _0x65e1e1=_0x3ba94f;await sendTelegram(_0x1a40d6['chat']['id'],_0x65e1e1(0x16c)),updateSetting(_0x65e1e1(0x11b),![]);}),tgBot[_0x3ba94f(0x127)](_0x3ba94f(0x29f),async _0x450be7=>{const _0x3abfeb=_0x3ba94f,_0x3ff48b=Markup[_0x3abfeb(0x13d)]([Markup[_0x3abfeb(0x15b)]['callback'](_0x3abfeb(0x324),'config_orders'),Markup[_0x3abfeb(0x15b)]['callback'](_0x3abfeb(0x2bb),_0x3abfeb(0x221)),Markup[_0x3abfeb(0x15b)]['callback'](_0x3abfeb(0x1dd),_0x3abfeb(0x1d3))]);_0x450be7[_0x3abfeb(0x2a2)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x3ff48b);}),tgBot['action']('config_orders',async _0x56ce98=>{const _0x11163b=_0x3ba94f;_0x56ce98['editMessageReplyMarkup'](),updateSetting(_0x11163b(0x251),_0x11163b(0x26d)),updateSetting(_0x11163b(0x11b),!![]),await sendTelegram(_0x56ce98['chat']['id'],_0x11163b(0x18e));}),tgBot['action'](_0x3ba94f(0x221),async _0x1e8780=>{const _0x49989c=_0x3ba94f;_0x1e8780[_0x49989c(0x186)](),updateSetting('telegramEvents',_0x49989c(0x26e)),updateSetting(_0x49989c(0x11b),!![]),await sendTelegram(_0x1e8780[_0x49989c(0x274)]['id'],_0x49989c(0x1dc));}),tgBot[_0x3ba94f(0x1f4)](_0x3ba94f(0x1d3),async _0x28e6f2=>{const _0x594be3=_0x3ba94f;_0x28e6f2['editMessageReplyMarkup'](),updateSetting(_0x594be3(0x251),_0x594be3(0x321)),updateSetting(_0x594be3(0x11b),!![]),await sendTelegram(_0x28e6f2[_0x594be3(0x274)]['id'],_0x594be3(0x259));}),tgBot['command'](_0x3ba94f(0x23f),async _0x1a1e64=>{const _0x35f01e=_0x3ba94f,_0x2c0a00=getBotsWithMode();let _0x3475fd=_0x35f01e(0x159);config[_0x35f01e(0x22e)](_0x48e843=>{const _0xce957a=_0x35f01e,_0x362c45=_0x2c0a00[_0xce957a(0x2ce)](_0x46a82b=>_0x46a82b[_0xce957a(0x195)]==_0x48e843['botID'])[_0xce957a(0x206)];_0x3475fd+=_0xce957a(0x331)+_0x48e843[_0xce957a(0x195)]+':\x20'+_0x48e843[_0xce957a(0x23f)]+'\x20|\x20'+_0x362c45+_0xce957a(0x185)+_0x48e843[_0xce957a(0x172)]+'\x0a';}),_0x3475fd+='\x0a',_0x3475fd+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x3475fd+=!settings[_0x35f01e(0x11b)]?_0x35f01e(0x1ad):_0x35f01e(0x310),_0x3475fd+=settings[_0x35f01e(0x11b)]?settings[_0x35f01e(0x251)]==_0x35f01e(0x321)?_0x35f01e(0x1e2):'Notifications\x20types:\x20'+settings[_0x35f01e(0x251)]+_0x35f01e(0x256):'',await sendTelegram(_0x1a1e64[_0x35f01e(0x274)]['id'],_0x3475fd,{'parse_mode':_0x35f01e(0x27d)});}),tgBot[_0x3ba94f(0x127)]('restart',async _0x1778ea=>{const _0x547304=_0x3ba94f,_0x1fbd0f=getEnabledBots();if(_0x1fbd0f[_0x547304(0x287)]==0x0)await sendTelegram(_0x1778ea['chat']['id'],_0x547304(0x1f8));else{if(_0x1fbd0f[_0x547304(0x287)]>0x1)_0x1fbd0f[_0x547304(0x1fb)]({'botID':_0x547304(0x321)});let _0x5ca1ae=[],_0x3e3afa=[];const _0x3fdbf2=_0x1fbd0f[_0x547304(0x287)]%0x4==0x0||_0x1fbd0f[_0x547304(0x287)]%0x4==0x3||_0x1fbd0f[_0x547304(0x287)]%0x3==0x1?0x4:0x3;let _0x48a9d7=0x0;_0x1fbd0f[_0x547304(0x22e)]((_0x16cdf4,_0x13ad36)=>{const _0x4517f1=_0x547304;if(_0x13ad36%_0x3fdbf2==0x0)_0x3e3afa=[];_0x3e3afa[_0x4517f1(0x1fb)](Markup['button'][_0x4517f1(0x21b)](_0x16cdf4[_0x4517f1(0x195)]=='all'?_0x4517f1(0x137):botRef(_0x16cdf4[_0x4517f1(0x195)]),_0x4517f1(0x14a)+_0x16cdf4['botID'])),_0x13ad36%_0x3fdbf2==0x0&&(_0x5ca1ae[_0x48a9d7]=_0x3e3afa,_0x48a9d7++);});const _0x2b2f51=Markup[_0x547304(0x13d)](_0x5ca1ae);_0x1778ea[_0x547304(0x2a2)](_0x547304(0x311),_0x2b2f51);}}),tgBot['action'](/restart_(.+)/,async _0xc2b6ca=>{const _0x32d4b8=_0x3ba94f,_0x5c4a3a=_0xc2b6ca[_0x32d4b8(0x2eb)][0x1];_0xc2b6ca[_0x32d4b8(0x186)](),_0x5c4a3a=='all'?config['forEach'](_0x2d38e2=>{const _0xe87693=_0x32d4b8;restartBot(_0x2d38e2[_0xe87693(0x195)]);}):restartBot(_0x5c4a3a);}),tgBot['command']('on',async _0x1bb84d=>{const _0x48516a=_0x3ba94f,_0x1e0e2c=getDisabledBots();if(_0x1e0e2c[_0x48516a(0x287)]==0x0)await sendTelegram(_0x1bb84d['chat']['id'],_0x48516a(0x302));else{if(_0x1e0e2c[_0x48516a(0x287)]>0x1)_0x1e0e2c[_0x48516a(0x1fb)]({'botID':_0x48516a(0x321)});let _0x4c7aa5=[],_0x4d21b3=[];const _0x19f3a3=_0x1e0e2c['length']%0x4==0x0||_0x1e0e2c[_0x48516a(0x287)]%0x4==0x3||_0x1e0e2c[_0x48516a(0x287)]%0x3==0x1?0x4:0x3;let _0x5c9004=0x0;_0x1e0e2c[_0x48516a(0x22e)]((_0x3031f1,_0x312e6c)=>{const _0x36b938=_0x48516a;if(_0x312e6c%_0x19f3a3==0x0)_0x4d21b3=[];_0x4d21b3[_0x36b938(0x1fb)](Markup[_0x36b938(0x15b)][_0x36b938(0x21b)](_0x3031f1[_0x36b938(0x195)]==_0x36b938(0x321)?_0x36b938(0x137):botRef(_0x3031f1['botID']),_0x36b938(0x2e1)+_0x3031f1['botID'])),_0x312e6c%_0x19f3a3==0x0&&(_0x4c7aa5[_0x5c9004]=_0x4d21b3,_0x5c9004++);});const _0x2904f8=Markup[_0x48516a(0x13d)](_0x4c7aa5);_0x1bb84d[_0x48516a(0x2a2)](_0x48516a(0x279),_0x2904f8);}}),tgBot[_0x3ba94f(0x1f4)](/on_(.+)/,async _0x294a36=>{const _0x3f641f=_0x3ba94f,_0x499444=_0x294a36['match'][0x1];_0x294a36[_0x3f641f(0x186)]();if(_0x499444==_0x3f641f(0x321)){const _0x5dca5d=getDisabledBots();await sendTelegram(_0x294a36['chat']['id'],_0x3f641f(0x22b)),_0x5dca5d[_0x3f641f(0x22e)](_0x26f4a6=>{const _0x1c9151=_0x3f641f;if(_0x26f4a6[_0x1c9151(0x195)]!=_0x1c9151(0x321))toggleBot(_0x26f4a6['botID'],toggleStatus(_0x26f4a6['botID']),_0x1c9151(0x20f));});}else await sendTelegram(_0x294a36[_0x3f641f(0x274)]['id'],'Bot\x20Mgr\x20>\x20Starting\x20'+botRef(_0x499444)),toggleBot(_0x499444,toggleStatus(_0x499444),_0x3f641f(0x20f));}),tgBot[_0x3ba94f(0x127)]('off',async _0x54cd44=>{const _0x28ac32=_0x3ba94f,_0x35406b=getEnabledBots();if(_0x35406b[_0x28ac32(0x287)]==0x0)await sendTelegram(_0x54cd44[_0x28ac32(0x274)]['id'],_0x28ac32(0x1f8));else{if(_0x35406b[_0x28ac32(0x287)]>0x1)_0x35406b[_0x28ac32(0x1fb)]({'botID':_0x28ac32(0x321)});let _0x4570f0=[],_0x722aff=[];const _0x59d7ca=_0x35406b[_0x28ac32(0x287)]%0x4==0x0||_0x35406b['length']%0x4==0x3||_0x35406b['length']%0x3==0x1?0x4:0x3;let _0x26f6b3=0x0;_0x35406b[_0x28ac32(0x22e)]((_0x2bb0b4,_0x150380)=>{const _0x5c2f0d=_0x28ac32;if(_0x150380%_0x59d7ca==0x0)_0x722aff=[];_0x722aff[_0x5c2f0d(0x1fb)](Markup[_0x5c2f0d(0x15b)][_0x5c2f0d(0x21b)](_0x2bb0b4[_0x5c2f0d(0x195)]==_0x5c2f0d(0x321)?'All\x20bots':botRef(_0x2bb0b4['botID']),_0x5c2f0d(0x2ab)+_0x2bb0b4['botID'])),_0x150380%_0x59d7ca==0x0&&(_0x4570f0[_0x26f6b3]=_0x722aff,_0x26f6b3++);});const _0x290226=Markup[_0x28ac32(0x13d)](_0x4570f0);_0x54cd44[_0x28ac32(0x2a2)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x290226);}}),tgBot[_0x3ba94f(0x1f4)](/off_(.+)/,async _0x5c5d1e=>{const _0x2ba8c5=_0x3ba94f,_0x4354c2=_0x5c5d1e[_0x2ba8c5(0x2eb)][0x1];_0x5c5d1e[_0x2ba8c5(0x186)]();if(_0x4354c2=='all'){const _0x6b8ce4=getEnabledBots();await sendTelegram(_0x5c5d1e[_0x2ba8c5(0x274)]['id'],_0x2ba8c5(0x1a2)),_0x6b8ce4['forEach'](_0x5ea459=>{const _0xeda0a3=_0x2ba8c5;if(_0x5ea459[_0xeda0a3(0x195)]!=_0xeda0a3(0x321))toggleBot(_0x5ea459['botID'],toggleStatus(_0x5ea459[_0xeda0a3(0x195)]),'stopped');});}else await sendTelegram(_0x5c5d1e[_0x2ba8c5(0x274)]['id'],_0x2ba8c5(0x260)+botRef(_0x4354c2)),toggleBot(_0x4354c2,toggleStatus(_0x4354c2),'stopped');}),tgBot[_0x3ba94f(0x127)](_0x3ba94f(0x142),async _0x23a102=>{const _0x2ac4a6=_0x3ba94f,_0x4a227a=getEnabledBots();if(_0x4a227a[_0x2ac4a6(0x287)]==0x0)await sendTelegram(_0x23a102['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x4a227a['length']>0x1){let _0x15286f=[],_0x13b68b=[];const _0x3c4103=_0x4a227a[_0x2ac4a6(0x287)]%0x4==0x0||_0x4a227a['length']%0x4==0x3||_0x4a227a[_0x2ac4a6(0x287)]%0x3==0x1?0x4:0x3;let _0x4ae098=0x0;_0x4a227a[_0x2ac4a6(0x22e)]((_0x14b211,_0x276350)=>{const _0x3b29ac=_0x2ac4a6;if(_0x276350%_0x3c4103==0x0)_0x13b68b=[];_0x13b68b[_0x3b29ac(0x1fb)](Markup[_0x3b29ac(0x15b)][_0x3b29ac(0x21b)](botRef(_0x14b211[_0x3b29ac(0x195)]),_0x3b29ac(0x16b)+_0x14b211[_0x3b29ac(0x195)])),_0x276350%_0x3c4103==0x0&&(_0x15286f[_0x4ae098]=_0x13b68b,_0x4ae098++);});const _0x2002ed=Markup['inlineKeyboard'](_0x15286f);_0x23a102[_0x2ac4a6(0x2a2)](_0x2ac4a6(0x112),_0x2002ed);}else{const _0x169ac7=_0x4a227a[0x0][_0x2ac4a6(0x195)];if(pid[_0x169ac7])pid[_0x169ac7][_0x2ac4a6(0x28e)]({'function':_0x2ac4a6(0x113),'args':null});}}}),tgBot[_0x3ba94f(0x1f4)](/metrics_(.+)/,async _0x56b81c=>{const _0x5f18ae=_0x3ba94f,_0x19a91f=_0x56b81c[_0x5f18ae(0x2eb)][0x1];_0x56b81c['editMessageReplyMarkup']();if(pid[_0x19a91f])pid[_0x19a91f][_0x5f18ae(0x28e)]({'function':_0x5f18ae(0x113),'args':null});}),tgBot[_0x3ba94f(0x127)](_0x3ba94f(0x1d6),async _0xbde0d5=>{const _0x3645ae=_0x3ba94f,_0x44347a=getEnabledBots();if(_0x44347a['length']==0x0)await sendTelegram(_0xbde0d5[_0x3645ae(0x274)]['id'],_0x3645ae(0x1f8));else{if(_0x44347a['length']>0x1){let _0x521b11=[],_0x19df56=[];const _0x59df22=_0x44347a[_0x3645ae(0x287)]%0x4==0x0||_0x44347a[_0x3645ae(0x287)]%0x4==0x3||_0x44347a[_0x3645ae(0x287)]%0x3==0x1?0x4:0x3;let _0x598244=0x0;_0x44347a[_0x3645ae(0x22e)]((_0x5b4a39,_0x5ea73d)=>{const _0x34f23b=_0x3645ae;if(_0x5ea73d%_0x59df22==0x0)_0x19df56=[];_0x19df56[_0x34f23b(0x1fb)](Markup[_0x34f23b(0x15b)][_0x34f23b(0x21b)](botRef(_0x5b4a39[_0x34f23b(0x195)]),_0x34f23b(0x1ec)+_0x5b4a39[_0x34f23b(0x195)])),_0x5ea73d%_0x59df22==0x0&&(_0x521b11[_0x598244]=_0x19df56,_0x598244++);});const _0x1c5dac=Markup[_0x3645ae(0x13d)](_0x521b11);_0xbde0d5[_0x3645ae(0x2a2)](_0x3645ae(0x1fc),_0x1c5dac);}else{const _0x58b5f7=_0x44347a[0x0][_0x3645ae(0x195)];if(pid[_0x58b5f7])pid[_0x58b5f7]['send']({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x3ba94f(0x1f4)](/portfolio_(.+)/,async _0x5ae959=>{const _0x3874a8=_0x3ba94f,_0x142186=_0x5ae959['match'][0x1];_0x5ae959[_0x3874a8(0x186)]();if(pid[_0x142186])pid[_0x142186]['send']({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x3ba94f(0x127)](_0x3ba94f(0x2af),async _0x1b1efc=>{const _0x14a3ad=_0x3ba94f,_0x581c2b=_0x14a3ad(0x2af);await zipFiles(_0x581c2b);const _0x4c0b1a=zippath+(_0x581c2b+_0x14a3ad(0x14f));_0x1b1efc[_0x14a3ad(0x2aa)]({'source':_0x4c0b1a})[_0x14a3ad(0x226)](()=>{})[_0x14a3ad(0x215)](_0x34bc72=>logger['debug']('Error\x20sending\x20'+_0x581c2b+_0x14a3ad(0x26c),_0x34bc72));}),tgBot['command'](_0x3ba94f(0x217),async _0x1609e5=>{const _0x367d95=_0x3ba94f,_0x210eb0=_0x367d95(0x217);await backupConfigFiles(),await zipFiles(_0x210eb0);const _0x459700=zippath+(_0x210eb0+_0x367d95(0x14f));_0x1609e5[_0x367d95(0x2aa)]({'source':_0x459700})['then'](()=>{})['catch'](_0x1af489=>logger['debug']('Error\x20sending\x20'+_0x210eb0+'\x20files\x20over\x20Telegram:',_0x1af489));}),tgBot[_0x3ba94f(0x127)](_0x3ba94f(0x325),async _0x2426e2=>{const _0x22ca1e=_0x3ba94f;await getMessages();if(!updateAvailable)await sendTelegram(_0x2426e2[_0x22ca1e(0x274)]['id'],_0x22ca1e(0x141));else{if(!validInstallation)await sendTelegram(_0x2426e2['chat']['id'],_0x22ca1e(0x26a));else{const _0x578dc6=Markup[_0x22ca1e(0x13d)]([Markup['button'][_0x22ca1e(0x21b)](_0x22ca1e(0x29a),'update_yes'),Markup[_0x22ca1e(0x15b)][_0x22ca1e(0x21b)]('No',_0x22ca1e(0x1e3))]);_0x2426e2['reply'](_0x22ca1e(0x2a5),_0x578dc6);}}}),tgBot[_0x3ba94f(0x1f4)](/update_(.+)/,async _0x12f7f6=>{const _0xf13a27=_0x3ba94f,_0x1cdfbc=_0x12f7f6[_0xf13a27(0x2eb)][0x1];_0x12f7f6['editMessageReplyMarkup'](),_0x1cdfbc==_0xf13a27(0x320)&&(await sendTelegram(_0x12f7f6[_0xf13a27(0x274)]['id'],_0xf13a27(0x2cb)),updateBB(_0xf13a27(0x325))),_0x1cdfbc=='no'&&await sendTelegram(_0x12f7f6['chat']['id'],_0xf13a27(0x1c3));}),tgBot[_0x3ba94f(0x127)]('reinstall',async _0x2a31ad=>{const _0xaa98e6=_0x3ba94f;if(!validInstallation)await sendTelegram(_0x2a31ad[_0xaa98e6(0x274)]['id'],_0xaa98e6(0x24b));else{const _0x4242b7=Markup['inlineKeyboard']([Markup[_0xaa98e6(0x15b)][_0xaa98e6(0x21b)](_0xaa98e6(0x29a),_0xaa98e6(0x120)),Markup[_0xaa98e6(0x15b)][_0xaa98e6(0x21b)]('No',_0xaa98e6(0x31b))]);_0x2a31ad[_0xaa98e6(0x2a2)](_0xaa98e6(0x30b),_0x4242b7);}}),tgBot[_0x3ba94f(0x1f4)](/reinstall_(.+)/,async _0x55e41f=>{const _0x17a12f=_0x3ba94f,_0x44880e=_0x55e41f['match'][0x1];_0x55e41f[_0x17a12f(0x186)](),_0x44880e==_0x17a12f(0x320)&&(await sendTelegram(_0x55e41f[_0x17a12f(0x274)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB('reinstall')),_0x44880e=='no'&&await sendTelegram(_0x55e41f[_0x17a12f(0x274)]['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot['command']('toggle',async _0x597dbc=>{const _0xf63706=_0x3ba94f,_0xc14a0=getBotsWithMode();if(_0xc14a0['length']==0x0)await sendTelegram(_0x597dbc[_0xf63706(0x274)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x51348c=[],_0x16e078=[];const _0x50c7b6=0x2;let _0x3e4ee2=0x0;_0xc14a0[_0xf63706(0x22e)]((_0x1b5755,_0x222b3b)=>{const _0x1c8dfa=_0xf63706;if(_0x222b3b%_0x50c7b6==0x0)_0x16e078=[];_0x16e078['push'](Markup[_0x1c8dfa(0x15b)][_0x1c8dfa(0x21b)](botRef(_0x1b5755[_0x1c8dfa(0x195)])+'\x20('+_0x1b5755[_0x1c8dfa(0x206)]+')',_0x1c8dfa(0x24d)+_0x1b5755[_0x1c8dfa(0x195)])),_0x222b3b%_0x50c7b6==0x0&&(_0x51348c[_0x3e4ee2]=_0x16e078,_0x3e4ee2++);});const _0x695b3e=Markup[_0xf63706(0x13d)](_0x51348c);_0x597dbc['reply'](_0xf63706(0x253),_0x695b3e);}}),tgBot['action'](/toggle_(.+)/,async _0x469a76=>{const _0x961f14=_0x3ba94f,_0x49c0f4=_0x469a76[_0x961f14(0x2eb)][0x1];_0x469a76[_0x961f14(0x186)]();const _0x572d6d=getBotsWithMode(),_0x18c13a=_0x572d6d[_0x961f14(0x2ce)](_0xd713cc=>_0xd713cc['botID']==_0x49c0f4),_0x1b41a9=_0x18c13a[_0x961f14(0x206)]==_0x961f14(0x181)?_0x961f14(0x191):_0x961f14(0x181);await sendTelegram(_0x469a76['chat']['id'],_0x961f14(0x1ef)+botRef(_0x18c13a['botID'])+_0x961f14(0x2a4)+_0x1b41a9+_0x961f14(0x293)),toggleBotMode(_0x49c0f4);}),tgBot[_0x3ba94f(0x127)](_0x3ba94f(0x2cf),async _0x66d4d=>{const _0x731eea=_0x3ba94f;let _0x3d463b='';config['forEach'](_0x5ec5ef=>{const _0x474fba=_0x2ff0;_0x3d463b+=_0x474fba(0x331)+_0x5ec5ef['botID']+':\x20'+_0x5ec5ef[_0x474fba(0x29c)]+'\x0a';}),await sendTelegram(_0x66d4d[_0x731eea(0x274)]['id'],_0x3d463b,{'parse_mode':_0x731eea(0x27d)});}),tgBot[_0x3ba94f(0x127)](_0x3ba94f(0x213),async _0xe1dacc=>{await sendTelegram(_0xe1dacc['chat']['id'],_0xc2c298);}),process['once'](_0x3ba94f(0x15c),()=>tgBot['stop'](_0x3ba94f(0x15c))),process['once'](_0x3ba94f(0x254),()=>tgBot[_0x3ba94f(0x190)](_0x3ba94f(0x254))),tgBot[_0x3ba94f(0x171)]();}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x26e637,_0x19968f,_0x29f182){const _0x5bc0ab=_0x49f930;_0x29f182={..._0x29f182,'disable_web_page_preview':!![]};try{await tgBot[_0x5bc0ab(0x288)][_0x5bc0ab(0x2ae)](_0x26e637,_0x19968f,_0x29f182);}catch(_0x177922){logger[_0x5bc0ab(0x2fb)]('Telegram\x20error:',_0x177922);}}async function sendTelegramBot(_0x3fa5b1,_0x7e18c8){const _0x5e21a6=_0x49f930;if(settings['telegramEnabled']){if(settings['telegramEvents']=='all'||(_0x7e18c8[_0x5e21a6(0x1eb)]==_0x5e21a6(0x21d)||_0x7e18c8[_0x5e21a6(0x1eb)]=='warning'||_0x7e18c8['type']==_0x5e21a6(0x11f))&&settings[_0x5e21a6(0x251)]==_0x5e21a6(0x26e)||_0x7e18c8[_0x5e21a6(0x1eb)]==_0x5e21a6(0x329)&&settings[_0x5e21a6(0x251)]=='orders'){if(tgBot&&settings[_0x5e21a6(0x247)]){if(_0x7e18c8[_0x5e21a6(0x2d0)])await sendTelegram(settings['telegramChatId'],_0x7e18c8[_0x5e21a6(0x29c)]+_0x5e21a6(0x158)+_0x7e18c8[_0x5e21a6(0x2d5)]);else await sendTelegram(settings[_0x5e21a6(0x247)],'Bot\x20'+_0x3fa5b1+'\x20>\x20'+_0x7e18c8[_0x5e21a6(0x2d5)]);}}}}async function sendTelegramMsg(_0x27b691,_0x13b7d4=_0x49f930(0x27d)){const _0x294a51=_0x49f930;return tgBot&&settings[_0x294a51(0x247)]?(await sendTelegram(settings[_0x294a51(0x247)],_0x27b691,{'parse_mode':_0x13b7d4}),!![]):![];}function getDeviceWithIp(_0x24aa53){const _0x50ecf6=_0x49f930;return devices[_0x50ecf6(0x2ce)](_0x3230ed=>_0x3230ed['ip']===_0x24aa53);}async function temporaryAccess2FA(_0xf60dc7,_0x5f5ac3){const _0x10b781=_0x49f930;let _0x14aa07=new Date(),_0x404037=![];if(lastIpApproval){if(_0x14aa07-lastIpApproval<0x1388)_0x404037=!![];}lastIpApproval=new Date();if(_0x404037)return;if(tgBot&&settings['telegramChatId']){const _0x489295=uuidRandom();tmpStorage[_0x489295]={'uuid':_0xf60dc7,'externalip':_0x5f5ac3};const _0x5775aa=Markup[_0x10b781(0x13d)]([Markup[_0x10b781(0x15b)]['callback'](_0x10b781(0x162),_0x10b781(0x11e)+_0x489295),Markup[_0x10b781(0x15b)]['callback'](_0x10b781(0x2e4),_0x10b781(0x166)+_0x489295),Markup[_0x10b781(0x15b)]['callback'](_0x10b781(0x276),_0x10b781(0x156)+_0x489295),Markup[_0x10b781(0x15b)]['callback'](_0x10b781(0x118),'tempaccess_reject_'+_0x489295)]);await sendTelegram(settings[_0x10b781(0x247)],_0x10b781(0x1ed)+normalizeIP(_0x5f5ac3)[_0x10b781(0x31c)]+'\x20?',_0x5775aa),tgBot[_0x10b781(0x1f4)](/tempaccess_(.+)_(.+)/,async _0x11c423=>{const _0x536fec=_0x10b781,_0x3346e2=_0x11c423[_0x536fec(0x2eb)][0x1],_0x4df8bf=_0x11c423[_0x536fec(0x2eb)][0x2],{uuid:_0x227469,externalip:_0xb84d1d}=tmpStorage[_0x4df8bf];delete tmpStorage[_0x4df8bf],_0x11c423['editMessageReplyMarkup'](),devices[_0x227469][_0x536fec(0x20e)]={'clientip':_0xb84d1d,'timestamp':new Date()[_0x536fec(0x30f)](),'expiry':_0x3346e2},_0x3346e2!='reject'?(await sendTelegram(_0x11c423['chat']['id'],_0x536fec(0x1f3)+_0x3346e2+_0x536fec(0x1d1),{'parse_mode':'HTML'}),io['to'](_0x227469)[_0x536fec(0x1b0)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x11c423[_0x536fec(0x274)]['id'],_0x536fec(0x257)),io['to'](_0x227469)[_0x536fec(0x1b0)](_0x536fec(0x23f),{'access':{'allow':![],'reason':_0x536fec(0x291),'token':null}}));});}}async function loginAccess2FA(_0x10cc83,_0x2627ee){const _0x10d493=_0x49f930;if(tgBot&&settings[_0x10d493(0x247)]){const _0x18f0af=uuidRandom();tmpStorage[_0x18f0af]={'uuid':_0x10cc83,'externalip':_0x2627ee};const _0x30f9c9=Markup[_0x10d493(0x13d)]([Markup[_0x10d493(0x15b)][_0x10d493(0x21b)](_0x10d493(0x271),_0x10d493(0x184)+loginExpiry+'_'+_0x18f0af),Markup[_0x10d493(0x15b)][_0x10d493(0x21b)]('reject',_0x10d493(0x2a6)+_0x18f0af)]);await sendTelegram(settings[_0x10d493(0x247)],_0x10d493(0x1ae)+normalizeIP(_0x2627ee)['show']+'\x20?',_0x30f9c9),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x31a253=>{const _0x1d15a8=_0x10d493,_0x316071=_0x31a253[_0x1d15a8(0x2eb)][0x1],_0x4bc24f=_0x31a253[_0x1d15a8(0x2eb)][0x2],{uuid:_0x122d42,externalip:_0x304ae6}=tmpStorage[_0x4bc24f];delete tmpStorage[_0x4bc24f],_0x31a253[_0x1d15a8(0x186)](),devices[_0x122d42][_0x1d15a8(0x11a)]={'clientip':_0x304ae6,'timestamp':new Date()[_0x1d15a8(0x30f)](),'expiry':_0x316071},_0x316071!=_0x1d15a8(0x118)?(await sendTelegram(_0x31a253[_0x1d15a8(0x274)]['id'],_0x1d15a8(0x1e6),{'parse_mode':_0x1d15a8(0x27d)}),io['to'](_0x122d42)[_0x1d15a8(0x1b0)](_0x1d15a8(0x23f),{'access':{'allow':![],'reason':_0x1d15a8(0x307),'token':null}})):(await sendTelegram(_0x31a253[_0x1d15a8(0x274)]['id'],_0x1d15a8(0x299)),io['to'](_0x122d42)[_0x1d15a8(0x1b0)](_0x1d15a8(0x23f),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x43c90b=_0x49f930;return dbConfig[_0x43c90b(0x2d1)](_0x43c90b(0x1b5))['sortBy'](_0x43c90b(0x195))[_0x43c90b(0x1d5)]({'status':_0x43c90b(0x175)})[_0x43c90b(0x24a)]()||[];}function getDisabledBots(){const _0x5bd5ff=_0x49f930;return dbConfig[_0x5bd5ff(0x2d1)](_0x5bd5ff(0x1b5))[_0x5bd5ff(0x210)](_0x5bd5ff(0x195))[_0x5bd5ff(0x1d5)]({'status':_0x5bd5ff(0x21c)})['value']()||[];}function getBotAttributes(_0x148304){const _0x2a01f9=_0x49f930;let _0x511c61={};const _0x2be760=configpath+_0x2a01f9(0x2c8)+_0x148304+_0x2a01f9(0x20b),_0x267528=fs[_0x2a01f9(0x28a)](_0x2be760);if(_0x267528){const _0x134cf6=fs[_0x2a01f9(0x25d)](_0x2be760);try{const _0x229009=JSON[_0x2a01f9(0x16d)](_0x134cf6),_0x519bcf=_0x229009?_0x229009[_0x2a01f9(0x25f)][0x0]['headless']:![];_0x511c61['mode']=_0x519bcf?_0x2a01f9(0x181):_0x2a01f9(0x191),_0x511c61[_0x2a01f9(0x29c)]=_0x229009?_0x229009[_0x2a01f9(0x25f)][0x0][_0x2a01f9(0x29c)]:_0x2a01f9(0x331)+_0x148304,_0x511c61[_0x2a01f9(0x2d0)]=_0x229009?_0x229009[_0x2a01f9(0x25f)][0x0][_0x2a01f9(0x2d0)]:![];}catch(_0x1855f6){_0x511c61[_0x2a01f9(0x206)]=_0x2a01f9(0x191),_0x511c61[_0x2a01f9(0x29c)]=_0x2a01f9(0x331)+_0x148304,_0x511c61[_0x2a01f9(0x2d0)]=![];}}else _0x511c61[_0x2a01f9(0x206)]=_0x2a01f9(0x191),_0x511c61[_0x2a01f9(0x29c)]=_0x2a01f9(0x331)+_0x148304,_0x511c61[_0x2a01f9(0x2d0)]=![];return _0x511c61;}function getBotsWithMode(){const _0x4256fa=_0x49f930,_0x18a7ba=dbConfig['get'](_0x4256fa(0x1b5))['sortBy'](_0x4256fa(0x195))[_0x4256fa(0x24a)]()||[];return _0x18a7ba[_0x4256fa(0x22e)](_0x89a8de=>{const _0x2ff855=_0x4256fa;let _0x4fa0cd=getBotAttributes(_0x89a8de[_0x2ff855(0x195)]);_0x89a8de[_0x2ff855(0x206)]=_0x4fa0cd[_0x2ff855(0x206)];}),_0x18a7ba;}function getBotExchanges(){const _0x4d4a64=_0x49f930;let _0x5439af=[];const _0x4f2aa1=dbConfig['get'](_0x4d4a64(0x1b5))[_0x4d4a64(0x210)](_0x4d4a64(0x195))['value']()||[];_0x4f2aa1[_0x4d4a64(0x22e)](_0x253f66=>{const _0x30c729=_0x4d4a64;if(_0x253f66[_0x30c729(0x23f)]==_0x30c729(0x175)){const _0x1f80d2=configpath+_0x30c729(0x2c8)+_0x253f66[_0x30c729(0x195)]+_0x30c729(0x20b),_0x303587=fs['existsSync'](_0x1f80d2);let _0xba420f;if(_0x303587){const _0x2e59b3=fs[_0x30c729(0x25d)](_0x1f80d2);try{const _0x351105=JSON['parse'](_0x2e59b3);_0xba420f=_0x351105?_0x351105[_0x30c729(0x25f)][0x0][_0x30c729(0x298)]:null;}catch(_0x1e63da){}}if(_0xba420f)_0x5439af[_0x30c729(0x1fb)](_0xba420f);}});const _0xaf5b9b=[...new Set(_0x5439af)][_0x4d4a64(0x194)]();return _0xaf5b9b;}async function initUser(){const _0x447175=_0x49f930;if(!settings['userid']){const _0x4ab028=uuidRandom();mixpanel['alias'](_0x4ab028),updateSetting(_0x447175(0x2d9),_0x4ab028);}}async function initSecure(){const _0x52f082=_0x49f930;let _0x250c09=getSecure();if(!_0x250c09[_0x52f082(0x17b)](_0x52f082(0x150))){let _0x5d63b8=await generateKeys();_0x250c09[_0x52f082(0x2be)]=_0x5d63b8[_0x52f082(0x2be)],_0x250c09[_0x52f082(0x27e)]=_0x5d63b8[_0x52f082(0x27e)],_0x250c09[_0x52f082(0x150)]=crypto[_0x52f082(0x1cd)](0x20)[_0x52f082(0x294)](_0x52f082(0x285));;storeSecure(_0x250c09);}}function getSettings(){const _0x5bc47c=_0x49f930;return dbSettings['get'](_0x5bc47c(0x32e))[_0x5bc47c(0x24a)]()||{};}function getSecure(){const _0xb9c44b=_0x49f930;return dbSecure[_0xb9c44b(0x2d1)](_0xb9c44b(0x1e8))[_0xb9c44b(0x24a)]()||{};}function getBlacklist(){const _0xc64aa4=_0x49f930;return dbSecure[_0xc64aa4(0x2d1)](_0xc64aa4(0x1c1))[_0xc64aa4(0x24a)]()||[];}function broadcastToBots(_0x435af1,_0x57a900){config['forEach'](_0x19500d=>{const _0x1a6c47=_0x2ff0;if(_0x19500d['status']==_0x1a6c47(0x175)&&_0x19500d[_0x1a6c47(0x172)]==_0x1a6c47(0x1f6)||_0x19500d[_0x1a6c47(0x23f)]==_0x1a6c47(0x1f7)&&_0x19500d['live']==_0x1a6c47(0x1f6)){if(pid[_0x19500d[_0x1a6c47(0x195)]])pid[_0x19500d[_0x1a6c47(0x195)]][_0x1a6c47(0x28e)]({[_0x435af1]:_0x57a900});}});}async function storeSettings(_0x2e04c2,_0x4778bc=![]){const _0x47b896=_0x49f930;_0x2e04c2={...settings,..._0x2e04c2};if(_0x4778bc&&_0x2e04c2[_0x47b896(0x170)]!=_0x47b896(0x117)&&_0x2e04c2[_0x47b896(0x170)]!=_0x47b896(0x13c)&&_0x2e04c2[_0x47b896(0x170)]!=''){const _0x3ece98=decryptRSA(secure[_0x47b896(0x27e)],_0x2e04c2[_0x47b896(0x170)])['split'](_0x47b896(0x1a4))[0x0],_0x140592=bcrypt[_0x47b896(0x29d)](_0x3ece98,saltRounds);_0x2e04c2={..._0x2e04c2,'bbPassword':_0x140592};}if(_0x4778bc&&_0x2e04c2[_0x47b896(0x2c9)]!='************'&&_0x2e04c2[_0x47b896(0x2c9)]!='***'&&_0x2e04c2[_0x47b896(0x2c9)]!=''){const _0x9f88ca=decryptRSA(secure['privateKey'],_0x2e04c2[_0x47b896(0x2c9)])[_0x47b896(0x2ad)](_0x47b896(0x1a4))[0x0];_0x2e04c2={..._0x2e04c2,'telegramToken':_0x9f88ca};}if(_0x4778bc&&_0x2e04c2[_0x47b896(0x12b)]!=_0x47b896(0x117)&&_0x2e04c2[_0x47b896(0x12b)]!=_0x47b896(0x13c)&&_0x2e04c2[_0x47b896(0x12b)]!=''){const _0x3a4044=decryptRSA(secure[_0x47b896(0x27e)],_0x2e04c2[_0x47b896(0x12b)])['split']('|@|')[0x0];_0x2e04c2={..._0x2e04c2,'marketcapApi':_0x3a4044};}const _0x24601c=_0x2e04c2[_0x47b896(0x2c9)]!=_0x47b896(0x117)&&_0x2e04c2['telegramToken']!=settings[_0x47b896(0x2c9)]||_0x2e04c2[_0x47b896(0x2b1)]!=settings[_0x47b896(0x2b1)],_0xb5acfe=_0x2e04c2[_0x47b896(0x2c9)]==''||_0x2e04c2['telegramUsername']=='',_0x17b661=_0x2e04c2[_0x47b896(0x12b)]&&_0x2e04c2[_0x47b896(0x12b)]!=_0x47b896(0x117)&&_0x2e04c2[_0x47b896(0x12b)]!=settings[_0x47b896(0x12b)];_0x24601c&&(_0x2e04c2[_0x47b896(0x247)]=null,_0x2e04c2[_0x47b896(0x251)]='all');for(const [_0x3b3a7e,_0x57721a]of Object[_0x47b896(0x197)](_0x2e04c2)){if(_0x3b3a7e==_0x47b896(0x2c9)&&_0x57721a=='************'){_0x2e04c2[_0x47b896(0x2c9)]=settings[_0x47b896(0x2c9)];continue;};if(_0x3b3a7e==_0x47b896(0x170)&&_0x57721a==_0x47b896(0x117)){_0x2e04c2[_0x47b896(0x170)]=settings[_0x47b896(0x170)];continue;};if(_0x3b3a7e==_0x47b896(0x12b)&&_0x57721a==_0x47b896(0x117)){_0x2e04c2['marketcapApi']=settings[_0x47b896(0x12b)];continue;};dbSettings['set'](_0x47b896(0x21a)+_0x3b3a7e,_0x57721a)[_0x47b896(0x1de)]();}settings=_0x2e04c2,io['to'](_0x47b896(0x144))[_0x47b896(0x1b0)](_0x47b896(0x32e),cleanSettings()),broadcastToBots(_0x47b896(0x1c4),settings[_0x47b896(0x1c4)]),broadcastToBots(_0x47b896(0x138),settings[_0x47b896(0x138)]),broadcastToBots(_0x47b896(0x12b),settings[_0x47b896(0x12b)]);if(_0x24601c&&!_0xb5acfe)initTelegram();_0x24601c&&_0xb5acfe&&(updateSetting(_0x47b896(0x247),null),disableTelegram()),getAllClients()[_0x47b896(0x22e)](_0x3edfe6=>{const _0x30112e=_0x47b896;getSocket(_0x3edfe6['id'])[_0x30112e(0x1b0)](_0x30112e(0x23f),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x17b661&&(await sleep(0xbb8),testMarketcapApi(_0x2e04c2[_0x47b896(0x12b)]));}async function testMarketcapApi(_0xd40e5b){const _0xa8436=_0x49f930,_0x1c5dde=['BCT','ETH'];try{await axios['get']('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0xd40e5b},'params':{'symbol':_0x1c5dde['toString']()}});}catch(_0x41a539){_0x41a539['toString']()[_0xa8436(0x207)](_0xa8436(0x25e))?(io['to'](_0xa8436(0x144))[_0xa8436(0x1b0)](_0xa8436(0x2b8),_0xa8436(0x1e9)),logger['full'](_0xa8436(0x1e9))):(io['to'](_0xa8436(0x144))[_0xa8436(0x1b0)]('notification','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0xa8436(0x2df)](_0xa8436(0x1c6)),logger[_0xa8436(0x2fb)](_0xa8436(0x249),_0x41a539[_0xa8436(0x294)]()+_0xa8436(0x2a9)+_0x41a539['code']));return;}logger[_0xa8436(0x2fb)](_0xa8436(0x242));}function updateSetting(_0x1ff3d5,_0x46fdd3){const _0x1fce65=_0x49f930;dbSettings[_0x1fce65(0x26b)](_0x1fce65(0x21a)+_0x1ff3d5,_0x46fdd3)[_0x1fce65(0x1de)](),settings=getSettings(),io['to'](_0x1fce65(0x144))[_0x1fce65(0x1b0)](_0x1fce65(0x32e),cleanSettings());}function storeSecure(_0x50b7f7){const _0x33cdaf=_0x49f930;dbSecure[_0x33cdaf(0x2d1)]('secure')['push'](_0x50b7f7)[_0x33cdaf(0x1de)](),secure=_0x50b7f7;}function addBlacklist(_0x2be0b2){const _0x370ed5=_0x49f930;cleanBlacklist();let _0x2b834b;devices[_0x2be0b2][_0x370ed5(0x20e)]?_0x2b834b=Math[_0x370ed5(0x205)](devices[_0x2be0b2][_0x370ed5(0x20e)][_0x370ed5(0x263)],loginExpiry):_0x2b834b=loginExpiry,dbSecure[_0x370ed5(0x2d1)](_0x370ed5(0x1c1))[_0x370ed5(0x1fb)]({'expiry':new Date()['getTime']()+_0x2b834b*0x3c*0x3e8,'token':devices[_0x2be0b2][_0x370ed5(0x123)][_0x370ed5(0x2b0)]})[_0x370ed5(0x1de)](),blacklist=dbSecure['get'](_0x370ed5(0x1c1))[_0x370ed5(0x24a)]();}function cleanBlacklist(){const _0x29e002=_0x49f930;let _0x353a3a=dbSecure[_0x29e002(0x2d1)]('blacklist')[_0x29e002(0x2dc)]()[_0x29e002(0x24a)](),_0x23f8b0=new Date()['getTime']();_0x353a3a[_0x29e002(0x22e)](_0x41d4be=>{const _0x1cf527=_0x29e002;_0x41d4be[_0x1cf527(0x263)]<_0x23f8b0&&dbSecure[_0x1cf527(0x2d1)](_0x1cf527(0x1c1))[_0x1cf527(0x227)]({'expiry':_0x41d4be[_0x1cf527(0x263)]})[_0x1cf527(0x1de)]();});}function initStates(){const _0x4d010f=_0x49f930;let _0x27948c=getConfiguration();_0x27948c[_0x4d010f(0x22e)](_0x31ebea=>{const _0x3ecec4=_0x4d010f;_0x31ebea[_0x3ecec4(0x172)]=_0x3ecec4(0x20f);}),storeConfiguration(_0x27948c);}async function generateKeys(){const _0x34b903=_0x49f930,_0xd2d552=forge[_0x34b903(0x1b4)][_0x34b903(0x245)][_0x34b903(0x231)]({'bits':0x1000,'e':0x10001}),_0x5cd69a=forge[_0x34b903(0x1b4)]['privateKeyToPem'](_0xd2d552[_0x34b903(0x27e)]),_0x50729a=forge[_0x34b903(0x1b4)][_0x34b903(0x1e4)](_0xd2d552[_0x34b903(0x2be)]);return{'privateKey':_0x5cd69a,'publicKey':_0x50729a};}async function oneTimeMigration(){const _0x17eb58=_0x49f930;let _0x1c9cce=getSettings(),_0x2a305a=![];!_0x1c9cce[_0x17eb58(0x17b)](_0x17eb58(0x15e))&&(_0x1c9cce[_0x17eb58(0x15e)]=0x0,_0x2a305a=!![]);!_0x1c9cce['hasOwnProperty'](_0x17eb58(0x119))&&(_0x1c9cce['lastmsgemitted']=0x0,_0x2a305a=!![]);!_0x1c9cce[_0x17eb58(0x17b)](_0x17eb58(0x1e1))&&(_0x1c9cce[_0x17eb58(0x1e1)]='0.0.0',_0x2a305a=!![]);!_0x1c9cce[_0x17eb58(0x17b)]('onepagemode')&&(_0x1c9cce[_0x17eb58(0x138)]=![],_0x2a305a=!![]);!_0x1c9cce['hasOwnProperty'](_0x17eb58(0x12b))&&(_0x1c9cce['marketcapApi']='',_0x2a305a=!![]);if(_0x2a305a)storeSettings(_0x1c9cce);try{fs[_0x17eb58(0x128)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x1c3e73=>{const _0x557d65=_0x17eb58;if(!_0x1c3e73[_0x557d65(0x157)]()){if(!_0x1c3e73[_0x557d65(0x297)][_0x557d65(0x182)](_0x557d65(0x322)))fs[_0x557d65(0x2d3)](configbackuppath+_0x1c3e73[_0x557d65(0x297)]);}else fs['rmSync'](configbackuppath+_0x1c3e73[_0x557d65(0x297)],{'recursive':!![]});});}catch(_0x3aa0a9){logger[_0x17eb58(0x2fb)](_0x17eb58(0x160),_0x3aa0a9);}}function _0x27bd(){const _0x5d4aa8=['env','tkn','metrics_','Notifications\x20disabled','parse','369400gnMZXO','Restarting\x20','bbPassword','launch','live','Session\x20expired\x20for\x20user\x20...','axios','enabled','started','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','getHours','temporary\x20token\x20generated','Unauthorized\x20attempt\x20to\x20get\x20events','hasOwnProperty','confirm-message','rmSync','Telegraf\x20error:','internal','ipaddr.js','auto','startsWith','exp','login2fa_','\x20|\x20','editMessageReplyMarkup','Starting\x20new\x20bot\x20|\x20Bot\x20','restore-backup-file','files','Idling\x20(','bb/','\x20|\x20user:\x20...','test','Ok,\x20will\x20send\x20order\x20notifications\x20only','restore_no_','stop','manual','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','simple','sort','botID','getMinutes','entries','file','index.html','/update\x20-\x20update\x20Balance\x20Bot\x0a','server','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','encryptedUuid','family','User\x20has\x20been\x20validated','::ffff:127.0.0.1','/:bot','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','Error\x20while\x20deleting\x20config\x20files:\x20','|@|','conn',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','argv','Network\x20Interfaces:','loginRequired','getStartingBalances','logged\x20out','store-headless','Notifications\x20disabled\x0a','Allow\x20login\x20from\x20IP\x20address\x20','pidExpireLogin','emit','823085JNFtLb','Unauthorized\x20login\x20attempt\x20(timeout)','Unauthorized\x20attempt\x20to\x20show\x20configuration','pki','bots','\x1b[0m','temporaryAccessAllowed','/status\x20-\x20show\x20bot(s)\x20status\x0a','generateAsync','Unauthorized\x20attempt\x20to\x20delete\x20alerts','handshake','#RES#\x20if\x20running\x20on\x20server','login\x20token\x20valid','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','File\x20uploaded','range','blacklist','\x1b[35m','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','timeshift','2FA\x20login\x20required','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','\x20|\x20client:\x20...','3479690ydZbEk','bbvReceive','child_process','function','data','randomBytes','build2','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','output-002.log','\x20minutes','sendFile','config_all','::1','filter','portfolio','Notifications\x20enabled','randomFillSync','220079dgZCyB','bb-settings.json','isIPv4MappedAddress','Ok,\x20will\x20send\x20alert\x20notifications\x20only','All','write','Logged\x20out\x20user\x20...','Unauthorized\x20attempt\x20to\x20update\x20bot','latestversion','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','update_no','publicKeyToPem','address','Login\x20accepted','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','secure','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','username','type','portfolio_','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','timestamp','Bot\x20Mgr\x20>\x20Toggling\x20','backup/','binary','/:bot/configuration','Access\x20enabled\x20for\x20','action','download','running','new','No\x20bots\x20running\x20right\x20now','/metrics\x20-\x20show\x20bot\x20performance\x0a','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','push','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','graphql-request','Backup\x20file\x20uploaded','getSeconds','reinstall-bb','Unauthorized\x20attempt\x20to\x20store\x20configuration','5007BgoyAu','update-bb','(((.+)+)+)+$','max','mode','includes','open','exec','output-003.log','-config.json','--------------------------------------','cancelLoading','telegramIpApproval','stopped','sortBy','Token\x20blacklisted','Restore\x20process\x20aborted','help','backup-files','catch','toggle-bot-mode','backup','store-settings',':\x20Bot\x20Mgr\x20>\x20','settings.','callback','disabled','error','util','headers',')\x20\x20\x20|\x20Bot\x20','config_alerts','apply','add-bot','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','defaults','then','remove','messages','telegraf','decrypt','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','verify','async','forEach','kind','from','generateKeyPair','Failed\x20to\x20download\x20','2471wDIUdc','lowdb/adapters/FileSync','/logs\x20-\x20receive\x20log\x20files\x0a','remoteAddress','/start','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','/enable\x20-\x20enable\x20notifications\x0a','showConfig','Restore\x20backup\x20file\x20','padStart','bb-secure.json','build','status','2FA\x20required','map','CoinMarketCap\x20API\x20key\x20validated','number','copyFileSync','rsa','replace','telegramChatId','Running\x20#RED#Balance\x20Bot\x20v','Error\x20details:','value','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','toggle_','Disabled\x20','Markdown','-events.json','telegramEvents','Unauthorized\x20attempt\x20to\x20add\x20bot','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','SIGTERM','reinstall','\x20only\x0a','Temporary\x20access\x20rejected','/:bot/performance','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Starting\x20(','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','(staging)','readFileSync','status\x20code\x20401','bot','Bot\x20Mgr\x20>\x20Stopping\x20','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Restore\x20process\x20confirmed','expiry','get-logs','isValid','loadAsync','Server','-----------------------------------------------------------------------------------','Password\x20has\x20been\x20reset\x20to:\x20','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','set','\x20files\x20over\x20Telegram:','orders','alerts','You\x20can\x20use\x20the\x20following\x20commands:\x0a','-results.json','accept','min','storeFiat','chat','bbvNew','30\x20min','string','production','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','connection','2FA','join','HTML','privateKey','\x1b[31m','bb-config.json','[ip-address]','/disable\x20-\x20disable\x20notifications\x0a','bot.js','*$1*','hex','output-001.log','length','telegram','12QnknAF','existsSync','uuid-random','Invalid\x20IP\x20address','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','send','login\x20token\x20generated','message','temporary\x20access\x20rejected','=>\x20Go\x20to\x20#CYA#http://','\x20mode','toString','start','socket.io','name','exchange','Login\x20rejected','Yes','path','botname','hashSync','getPortfolio','config','Bot\x20Mgr\x20>\x20','config/','reply','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','\x20to\x20','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','login2fa_reject_','restore_yes_','socket','\x20-\x20','replyWithDocument','off_','mkdirSync','split','sendMessage','logs','token','telegramUsername','f2aRequired','staging','_nsps','deleteHistoryAlerts','create','Node.js\x20v','notification','Deleted\x20Bot\x20','args','Alerts','resetpw_no','place-order','publicKey','node','12ddVXHg','Unauthorized\x20attempt\x20to\x20get\x20messages','5330501tfWDTB','params','initclient','storeHeadless','clientip','invalid\x20credentials','bot-','telegramToken','Invalid\x20authentication\x20token\x20(1)','Starting\x20Balance\x20Bot\x20update','backupfile','disconnect','find','names','showname','get','endsWith','unlinkSync','pidRefreshToken','event','Unauthorized\x20attempt\x20to\x20confirm\x20message','address\x20already\x20in\x20use','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','userid','3000','9PqWtFE','cloneDeep','sign','whitelist','full','/on\x20-\x20start\x20bot(s)\x0a','on_','/output-000.log','get-starting-balances','15\x20min','reset-password','No\x20authentication\x20token','bbUsername','port',',\x20must\x20be\x20a\x204\x20digit\x20number','uuid','match','lowdb','5744rAgyKt','node-forge','request','placeOrder','temporary\x20access\x20timeout','private','sha256','environment','\x1b[34m','clients','versions','telegrammsg','login','/:bot/support','debug','stringify','access\x20timeout','apiPassword','ipc','jszip','yargs/yargs','All\x20bots\x20running\x20right\x20now','Unauthorized\x20attempt\x20to\x20log\x20out','createWriteStream','restart','search','reload','new-disabled','getFullYear','store-configuration','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','login\x20not\x20required','storeConfiguration','writeFileSync','getTime','Notifications\x20enabled\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Unauthorized\x20attempt\x20to\x20download\x20','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','referer','1368uMcmYL','Setting\x20access:\x20','reason','#RES#\x20','whitelistEnabled','bcryptjs','reinstall_no','show','apiKey','password','slice','yes','all','backup-full@','removeAllListeners','Orders','update','logout','\x20(1)','text','order','get-messages','logs/','/:bot/coins','init','settings','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Password\x20reset\x20rejected','Bot\x20','getDate','-performance.json','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','sendMetricsTelegram','allow','output-000.log','Invalid\x20authentication\x20token\x20(2)','************','reject','lastmsgemitted','telegram2FaApproval','telegramEnabled','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','keys','tempaccess_5_','success','reinstall_yes','$1_$2_$3','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','access','getMonth','jsonwebtoken','use','command','readdirSync','store','updatebotmanager','marketcapApi','disable','show-config','2FA\x20login\x20token\x20generated','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','sockets','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','apiSecret','http://localhost:','Backup\x20file\x20unzipped\x20and\x20stored','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','format','All\x20bots','onepagemode','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','/help\x20-\x20show\x20available\x20commands\x0a','temporary\x20access\x20not\x20allowed','***','inlineKeyboard','enable','static','1000','Your\x20installation\x20is\x20already\x20up\x20to\x20date','metrics','6b67f3d61ee94b8f5c80b4affef4c4d9','botmanager','version.json','get-backup-files','add','resetHistory','Invalid\x20username\x20or\x20IP\x20address','restart_','NTBA_FIX_319','kill','exit','listen','.zip','secret','temp/','log','mixpanel','assign','inherit','tempaccess_30_','isDirectory','\x20>\x20','<b>Balance\x20Bot\x20Status:</b>\x0a','getUTCHours','button','SIGINT','statSync','lastmsgtelegram','mtime','Error\x20removing\x20old\x20backup\x20files:','get-portfolio','5\x20min','resetpw_yes','version','backup-full','tempaccess_15_','DEFLATE','auth'];_0x27bd=function(){return _0x5d4aa8;};return _0x27bd();}function storeConfiguration(_0x1ed6e4){const _0x1f7396=_0x49f930;dbConfig[_0x1f7396(0x2d1)](_0x1f7396(0x1b5))[_0x1f7396(0x227)]()[_0x1f7396(0x1de)](),dbConfig[_0x1f7396(0x2d1)](_0x1f7396(0x1b5))['push'](..._0x1ed6e4)['write'](),config=_0x1ed6e4;}async function resetPassword(){const _0x217fb3=_0x49f930;if(tgBot&&settings[_0x217fb3(0x247)]){const _0x173e49=Markup[_0x217fb3(0x13d)]([Markup[_0x217fb3(0x15b)][_0x217fb3(0x21b)](_0x217fb3(0x320),_0x217fb3(0x163)),Markup[_0x217fb3(0x15b)][_0x217fb3(0x21b)]('no',_0x217fb3(0x2bc))]);await sendTelegram(settings[_0x217fb3(0x247)],_0x217fb3(0x1e7),_0x173e49),tgBot[_0x217fb3(0x1f4)](/resetpw_(.+)/,async _0x4e9464=>{const _0x5c0251=_0x217fb3,_0x2cb35d=_0x4e9464[_0x5c0251(0x2eb)][0x1];_0x4e9464[_0x5c0251(0x186)]();if(_0x2cb35d!='no'){const _0xb5cd2e=0xf,_0x3d1da9=_0x5c0251(0x1cf),_0x5ec0c2=Array[_0x5c0251(0x230)](crypto[_0x5c0251(0x1d8)](new Uint32Array(_0xb5cd2e)))[_0x5c0251(0x241)](_0xc03d7d=>_0x3d1da9[_0xc03d7d%_0x3d1da9['length']])['join'](''),_0x48732f=bcrypt[_0x5c0251(0x29d)](_0x5ec0c2,saltRounds);storeSettings({'bbPassword':_0x48732f}),await sendTelegram(_0x4e9464[_0x5c0251(0x274)]['id'],_0x5c0251(0x269)+_0x5ec0c2,{'parse_mode':'HTML'});}else await sendTelegram(_0x4e9464[_0x5c0251(0x274)]['id'],_0x5c0251(0x330));});}}async function confirmRestore(_0x23e59f,_0x46b38a){const _0x299e45=_0x49f930;io['to'](_0x299e45(0x144))[_0x299e45(0x1b0)]('notification',_0x299e45(0x2d8),_0x299e45(0x11f));if(tgBot&&settings['telegramChatId']){const _0x1176ca=uuidRandom();tmpStorage[_0x1176ca]={'path':_0x23e59f,'filename':_0x46b38a};const _0x3582f2=Markup[_0x299e45(0x13d)]([Markup[_0x299e45(0x15b)][_0x299e45(0x21b)](_0x299e45(0x320),_0x299e45(0x2a7)+_0x1176ca),Markup[_0x299e45(0x15b)][_0x299e45(0x21b)]('no',_0x299e45(0x18f)+_0x1176ca)]);await sendTelegram(settings[_0x299e45(0x247)],_0x299e45(0x19c),_0x3582f2),tgBot[_0x299e45(0x1f4)](/restore_(.+)_(.+)/,async _0x15b633=>{const _0x5794af=_0x299e45,_0x430b3=_0x15b633[_0x5794af(0x2eb)][0x1],_0x4ce11f=_0x15b633[_0x5794af(0x2eb)][0x2],{path:_0x495f59,filename:_0x1646ca}=tmpStorage[_0x4ce11f];delete tmpStorage[_0x4ce11f],_0x15b633[_0x5794af(0x186)](),_0x430b3==_0x5794af(0x320)?(logger[_0x5794af(0x2fb)](_0x5794af(0x262)),await sendTelegram(_0x15b633[_0x5794af(0x274)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':_0x5794af(0x27d)}),unzipFile(_0x495f59,_0x1646ca)):(logger['debug'](_0x5794af(0x212)),await sendTelegram(_0x15b633[_0x5794af(0x274)]['id'],_0x5794af(0x212)));});}}function getServerTime(){const _0x4107be=_0x49f930,_0x40a8ca=new Date();return _0x40a8ca[_0x4107be(0x309)]()+'/'+(_0x40a8ca['getMonth']()+0x1)[_0x4107be(0x294)]()['padStart'](0x2,'0')+'/'+_0x40a8ca['getDate']()[_0x4107be(0x294)]()[_0x4107be(0x23c)](0x2,'0')+'\x20'+_0x40a8ca['getHours']()[_0x4107be(0x294)]()[_0x4107be(0x23c)](0x2,'0')+':'+_0x40a8ca[_0x4107be(0x196)]()[_0x4107be(0x294)]()[_0x4107be(0x23c)](0x2,'0')+':'+_0x40a8ca[_0x4107be(0x1ff)]()['toString']()[_0x4107be(0x23c)](0x2,'0');}function getTimeStamp(){const _0x2a9529=_0x49f930,_0x55a7ea=shiftedTime();return _0x55a7ea['getFullYear']()+'/'+(_0x55a7ea[_0x2a9529(0x124)]()+0x1)[_0x2a9529(0x294)]()[_0x2a9529(0x23c)](0x2,'0')+'/'+_0x55a7ea[_0x2a9529(0x332)]()[_0x2a9529(0x294)]()[_0x2a9529(0x23c)](0x2,'0')+'\x20'+_0x55a7ea[_0x2a9529(0x178)]()['toString']()[_0x2a9529(0x23c)](0x2,'0')+':'+_0x55a7ea['getMinutes']()[_0x2a9529(0x294)]()[_0x2a9529(0x23c)](0x2,'0')+':'+_0x55a7ea['getSeconds']()[_0x2a9529(0x294)]()[_0x2a9529(0x23c)](0x2,'0');}function getCleanTimeStamp(){const _0x59f15c=_0x49f930,_0x5dfdfc=shiftedTime();return _0x5dfdfc[_0x59f15c(0x309)]()+(_0x5dfdfc[_0x59f15c(0x124)]()+0x1)[_0x59f15c(0x294)]()['padStart'](0x2,'0')+_0x5dfdfc[_0x59f15c(0x332)]()[_0x59f15c(0x294)]()[_0x59f15c(0x23c)](0x2,'0')+'-'+_0x5dfdfc[_0x59f15c(0x178)]()[_0x59f15c(0x294)]()['padStart'](0x2,'0')+_0x5dfdfc[_0x59f15c(0x196)]()[_0x59f15c(0x294)]()[_0x59f15c(0x23c)](0x2,'0')+_0x5dfdfc[_0x59f15c(0x1ff)]()[_0x59f15c(0x294)]()['padStart'](0x2,'0');}function shiftedTime(){const _0xbf13ce=_0x49f930,_0x5e647a=new Date();let _0xf65cb9=_0x5e647a;if(settings[_0xbf13ce(0x1c4)]&&settings['timeshift']!==0x0)_0xf65cb9=fns[_0xbf13ce(0x147)](_0x5e647a,{'hours':settings[_0xbf13ce(0x1c4)]});return _0xf65cb9;}async function startScheduler(){const _0x31d1e0=_0x49f930,_0x2c7407=new Date()[_0x31d1e0(0x15a)](),_0x1c7649=shiftedTime()[_0x31d1e0(0x178)]();_0x1c7649==0x4&&backupConfigFiles(),_0x1c7649==0x0&&(rotateLogFiles(),logger[_0x31d1e0(0x2fb)]('--------------------------------------'),logger[_0x31d1e0(0x2fb)](_0x31d1e0(0x248)+serverversion+_0x31d1e0(0x318)+(environment==_0x31d1e0(0x2b3)?'(staging)':'')),logger[_0x31d1e0(0x2fb)](_0x31d1e0(0x20c))),_0x2c7407%0x6==0x0&&triggerAnalytics(),_0x2c7407%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x4eeeb2){const _0x2b9fe3=_0x49f930;logger[_0x2b9fe3(0x2fb)](_0x2b9fe3(0x23b)+_0x4eeeb2);const _0x20453c=getBotsWithMode();_0x20453c[_0x2b9fe3(0x287)]>0x0?confirmRestore(configbackuppath,_0x4eeeb2):unzipFile(configbackuppath,_0x4eeeb2);}async function getBackupFiles(_0x4b0981=null){const _0x2ee3c3=_0x49f930;let _0x323918=[],_0x499b7e=fs[_0x2ee3c3(0x128)](configbackuppath,{'withFileTypes':!![]});_0x499b7e[_0x2ee3c3(0x194)]((_0x32ac5a,_0x5179e3)=>_0x32ac5a['name']<_0x5179e3[_0x2ee3c3(0x297)]?0x1:_0x5179e3['name']<_0x32ac5a[_0x2ee3c3(0x297)]?-0x1:0x0),_0x499b7e[_0x2ee3c3(0x22e)](_0x40ed79=>{const _0x3ef809=_0x2ee3c3;if(!_0x40ed79[_0x3ef809(0x157)]()&&_0x40ed79[_0x3ef809(0x297)]['startsWith'](_0x3ef809(0x322))&&_0x40ed79[_0x3ef809(0x297)][_0x3ef809(0x2d2)](_0x3ef809(0x14f))){const _0x15ed12=formatDate(fs['statSync'](configbackuppath+_0x40ed79['name'])[_0x3ef809(0x15f)]);_0x323918['push']({'name':_0x40ed79[_0x3ef809(0x297)],'mtime':_0x15ed12});}});if(_0x4b0981)io['to'](_0x4b0981)[_0x2ee3c3(0x1b0)](_0x2ee3c3(0x214),_0x323918);else return _0x323918;}async function backupConfigFiles(){const _0x3d0e26=_0x49f930;await zipFiles('backup-full');const _0x442cb2=getCleanTimeStamp();fs[_0x3d0e26(0x244)](zippath+'backup-full.zip',configbackuppath+(_0x3d0e26(0x322)+_0x442cb2+'.zip'));let _0x1dffcb=fs[_0x3d0e26(0x128)](configbackuppath,{'withFileTypes':!![]});_0x1dffcb[_0x3d0e26(0x194)]((_0x1468e8,_0x3cba14)=>_0x1468e8[_0x3d0e26(0x297)]<_0x3cba14[_0x3d0e26(0x297)]?0x1:_0x3cba14[_0x3d0e26(0x297)]<_0x1468e8[_0x3d0e26(0x297)]?-0x1:0x0),_0x1dffcb[_0x3d0e26(0x287)]>maxBackups&&fs[_0x3d0e26(0x2d3)](configbackuppath+_0x1dffcb[_0x1dffcb[_0x3d0e26(0x287)]-0x1]['name']);}function rotateLogFiles(){const _0x507e5f=_0x49f930,_0x48bb84=fs[_0x507e5f(0x15d)](logspath+_0x507e5f(0x115)),_0x435398=_0x48bb84['size']/0x400;if(_0x435398>0x64){let _0xde0172=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0xde0172[_0x507e5f(0x194)]((_0x397d0b,_0x483085)=>_0x397d0b[_0x507e5f(0x297)]<_0x483085[_0x507e5f(0x297)]?0x1:_0x483085[_0x507e5f(0x297)]<_0x397d0b['name']?-0x1:0x0),_0xde0172['forEach'](_0x3c9936=>{const _0xa52836=_0x507e5f;if(_0x3c9936[_0xa52836(0x297)]==_0xa52836(0x1d0))fs[_0xa52836(0x244)](logspath+_0x3c9936[_0xa52836(0x297)],logspath+_0xa52836(0x20a));if(_0x3c9936[_0xa52836(0x297)]==_0xa52836(0x286))fs[_0xa52836(0x244)](logspath+_0x3c9936['name'],logspath+_0xa52836(0x1d0));_0x3c9936['name']==_0xa52836(0x115)&&(fs[_0xa52836(0x244)](logspath+_0x3c9936[_0xa52836(0x297)],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x3c9936[_0xa52836(0x297)],''));});}}async function zipFiles(_0xa04295){const _0xa1c598=_0x49f930;let _0xe6718;if(_0xa04295==_0xa1c598(0x2af))_0xe6718=logspath;if(_0xa04295==_0xa1c598(0x217))_0xe6718=configpath;if(_0xa04295==_0xa1c598(0x165))_0xe6718=configpath;let _0xab398c=fs[_0xa1c598(0x128)](_0xe6718,{'withFileTypes':!![]});const _0x3451ba=new JSZip();_0xab398c[_0xa1c598(0x22e)](_0x467ada=>{const _0x3afc45=_0xa1c598;if(!_0x467ada['isDirectory']()){let _0x1e2a26=fs[_0x3afc45(0x25d)](_0xe6718+_0x467ada[_0x3afc45(0x297)]);if(_0xa04295=='backup'){const _0x4d00c7=/^bot-[0-9]{3}-config.json$/,_0x64850f=_0x4d00c7[_0x3afc45(0x18d)](_0x467ada[_0x3afc45(0x297)]);if(_0x64850f){const _0x1ef78e=JSON[_0x3afc45(0x16d)](_0x1e2a26);if(_0x1ef78e[_0x3afc45(0x25f)][0x0]){_0x1ef78e[_0x3afc45(0x25f)][0x0][_0x3afc45(0x31d)]=_0x3afc45(0x13c),_0x1ef78e[_0x3afc45(0x25f)][0x0][_0x3afc45(0x132)]=_0x3afc45(0x13c);if(_0x1ef78e[_0x3afc45(0x25f)][0x0][_0x3afc45(0x2fe)])_0x1ef78e[_0x3afc45(0x25f)][0x0][_0x3afc45(0x2fe)]=_0x3afc45(0x13c);}_0x1e2a26=JSON[_0x3afc45(0x2fc)](_0x1ef78e,null,0x2);}if(_0x467ada[_0x3afc45(0x297)]==_0x3afc45(0x1da)){const _0x8614c6=JSON[_0x3afc45(0x16d)](_0x1e2a26);if(_0x8614c6[_0x3afc45(0x32e)][_0x3afc45(0x1a9)])_0x8614c6[_0x3afc45(0x32e)][_0x3afc45(0x1a9)]=![];if(_0x8614c6['settings'][_0x3afc45(0x170)])_0x8614c6[_0x3afc45(0x32e)][_0x3afc45(0x170)]=_0x3afc45(0x13c);if(_0x8614c6[_0x3afc45(0x32e)]['telegramToken'])_0x8614c6['settings'][_0x3afc45(0x2c9)]=_0x3afc45(0x13c);if(_0x8614c6[_0x3afc45(0x32e)][_0x3afc45(0x247)])_0x8614c6['settings']['telegramChatId']=null;if(_0x8614c6['settings']['marketcapApi'])_0x8614c6[_0x3afc45(0x32e)]['marketcapApi']=_0x3afc45(0x13c);_0x1e2a26=JSON[_0x3afc45(0x2fc)](_0x8614c6,null,0x2);}if(_0x467ada[_0x3afc45(0x297)]!=_0x3afc45(0x23d))_0x3451ba['file'](_0x467ada['name'],_0x1e2a26);}else _0x3451ba[_0x3afc45(0x198)](_0x467ada[_0x3afc45(0x297)],_0x1e2a26);}});const _0x144a22=await _0x3451ba[_0xa1c598(0x1b9)]({'type':'string','base64':![],'compression':_0xa1c598(0x167)});fs['writeFileSync'](zippath+(_0xa04295+_0xa1c598(0x14f)),_0x144a22,_0xa1c598(0x1f1));}async function unzipFile(_0x347b6c,_0x5fe1c){const _0x443040=_0x49f930;fs[_0x443040(0x128)](configpath,{'withFileTypes':!![]})[_0x443040(0x22e)](_0xdd1c96=>{const _0x3a642e=_0x443040;if(!_0xdd1c96['isDirectory']())fs[_0x3a642e(0x17d)](configpath+_0xdd1c96[_0x3a642e(0x297)]);});const _0x4553d6=fs[_0x443040(0x25d)](_0x347b6c+_0x5fe1c,_0x443040(0x1f1)),_0x430123=await JSZip[_0x443040(0x266)](_0x4553d6,{'base64':![],'checkCRC32':!![]});for(const _0x24592c of Object[_0x443040(0x11d)](_0x430123[_0x443040(0x189)])){const _0x50bc46=_0x430123[_0x443040(0x189)][_0x24592c],_0x95e7d5=await _0x50bc46[_0x443040(0x22d)](_0x443040(0x277));fs[_0x443040(0x30e)](configpath+_0x50bc46[_0x443040(0x297)],_0x95e7d5);}fs[_0x443040(0x128)](temppath,{'withFileTypes':!![]})['forEach'](_0x120148=>{const _0x3e4a7e=_0x443040;if(!_0x120148[_0x3e4a7e(0x157)]())fs[_0x3e4a7e(0x17d)](temppath+_0x120148['name']);}),logger[_0x443040(0x2fb)](_0x443040(0x134)),process['send']({'restore':!![]},_0x253287=>{});}async function getPublicIp(){const _0x4b79fc=_0x49f930;try{const _0x2ef163=await axios[_0x4b79fc(0x2d1)]('https://api.ipify.org?format=json');publicip=_0x2ef163[_0x4b79fc(0x1cc)]['ip'];}catch(_0x465799){}}async function triggerAnalytics(){const _0x3f6880=_0x49f930;if(!publicip)await getPublicIp();const _0x26485d=getBotsWithMode();let _0x53167b=0x0;_0x26485d[_0x3f6880(0x22e)](_0x4e0acc=>{const _0x377595=_0x3f6880;if(_0x4e0acc[_0x377595(0x23f)]===_0x377595(0x175))_0x53167b++;});const _0x1df126=getBotExchanges();mixpanel['track'](_0x3f6880(0x267),{'distinct_id':settings[_0x3f6880(0x2d9)],'ip':publicip,'version':serverversion,'numbots':_0x26485d[_0x3f6880(0x287)],'numbotsenabled':_0x53167b,'exchanges':_0x1df126,'environment':environment});}async function getMessages(){const _0x59cebb=_0x49f930,_0x1c97dc=_0x59cebb(0x1fa),_0x426edf=new GraphQLClient(_0x1c97dc),_0x55f6d6={'authorization':_0x59cebb(0x32f)},_0x23540e=serverversion[_0x59cebb(0x2ad)]('.'),_0x4811a0=_0x23540e[0x0]+'.'+_0x23540e[0x1],_0xed172d=Math[_0x59cebb(0x272)](settings['lastmsgtelegram'],settings[_0x59cebb(0x119)]),_0x32e4ca={'last':parseInt(_0xed172d),'bbm':_0x4811a0},_0x420e8d=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x12739f;try{_0x12739f=await _0x426edf[_0x59cebb(0x2ef)](_0x420e8d,_0x32e4ca,_0x55f6d6);}catch(_0x25c7ae){}if(_0x12739f&&_0x12739f[_0x59cebb(0x228)]){let _0x161cd1=settings[_0x59cebb(0x15e)],_0x271afb=settings[_0x59cebb(0x15e)];newMessages=[];for(const _0x20b74f of _0x12739f['messages']){newMessages[_0x59cebb(0x1fb)](_0x20b74f);let _0xab2836=![];_0x20b74f[_0x59cebb(0x275)]&&(updateSetting('latestversion',_0x20b74f['bbvNew']),_0xab2836=isNewerVersion(serverversion,_0x20b74f[_0x59cebb(0x275)])||serverversion==_0x20b74f[_0x59cebb(0x275)]);if(!_0xab2836&&_0x20b74f['number']>_0x161cd1){if(_0x20b74f[_0x59cebb(0x1c9)]==='any'||serverversion[_0x59cebb(0x182)](_0x20b74f[_0x59cebb(0x1c9)])){let _0x1c20d6=''+_0x20b74f['title']+'\x0a\x0a'+_0x20b74f[_0x59cebb(0x290)];const _0x331c03=await sendTelegramMsg(toTelegramMarkdown(_0x1c20d6),_0x59cebb(0x24f));_0x161cd1=_0x20b74f['number'];}}_0x271afb=_0x20b74f['number'];}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x59cebb(0x15e),_0x271afb),emitMessages();}}function emitMessages(){const _0x15f625=_0x49f930,_0x429824=settings[_0x15f625(0x119)];let _0x2e471c=[];newMessages[_0x15f625(0x22e)](_0x5b43d7=>{const _0x4bce78=_0x15f625;_0x5b43d7[_0x4bce78(0x243)]>_0x429824&&_0x2e471c[_0x4bce78(0x1fb)](_0x5b43d7);}),_0x2e471c[_0x15f625(0x287)]>0x0&&getAllClients()['forEach'](_0x543ec8=>{const _0x2acf93=_0x15f625;getSocket(_0x543ec8['id'])[_0x2acf93(0x1b0)](_0x2acf93(0x290),_0x2e471c);});}function confirmMessage(_0x443b07){updateSetting('lastmsgemitted',Number(_0x443b07));}function isNewerVersion(_0x35935e,_0x5d4abe){const _0xafbf25=_0x49f930,_0x2b38b5=_0x5d4abe[_0xafbf25(0x2ad)]('.'),_0x40efcc=_0x35935e['split']('.');for(var _0x1e256d=0x0;_0x1e256d<_0x40efcc[_0xafbf25(0x287)];_0x1e256d++){const _0x36883e=~~_0x40efcc[_0x1e256d],_0x30ed31=~~_0x2b38b5[_0x1e256d];if(_0x36883e>_0x30ed31)return!![];if(_0x36883e<_0x30ed31)return![];}return![];}function toTelegramMarkdown(_0x328cbb){const _0x235219=_0x49f930,_0x4a3976=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2c7bc2=/\*{2}(.+?)\*{2}/gim;return _0x328cbb=_0x328cbb[_0x235219(0x246)](_0x4a3976,_0x235219(0x121))[_0x235219(0x246)](_0x2c7bc2,_0x235219(0x284)),_0x328cbb;}async function validateConfigFile(){const _0x42e975=_0x49f930,_0x30655a=dbConfig[_0x42e975(0x2d1)](_0x42e975(0x1b5))[_0x42e975(0x210)]('botID')[_0x42e975(0x24a)]()||[];if(_0x30655a['length']==0x0){let _0x39e746=0x0,_0x27548a=[];const _0x17937f=/^bot-([0-9]{3})-config.json$/,_0x58e079=fs[_0x42e975(0x128)](configpath);_0x58e079[_0x42e975(0x22e)](_0xa95abc=>{const _0x27f3d5=_0x42e975,_0x1f3ae6=_0x17937f[_0x27f3d5(0x209)](_0xa95abc);if(_0x1f3ae6){const _0x2f8153=_0x1f3ae6[0x1];let _0x57242b=getBotAttributes(_0x2f8153);_0x27548a['push']({'botID':_0x2f8153,'botname':_0x57242b[_0x27f3d5(0x29c)],'status':_0x27f3d5(0x21c),'live':_0x27f3d5(0x20f)}),_0x39e746++;}}),_0x39e746!=0x0&&(dbConfig['get'](_0x42e975(0x1b5))[_0x42e975(0x154)](_0x27548a)[_0x42e975(0x1de)](),config=_0x27548a,restoredConfigFile=_0x39e746);}}async function restoreConfigNotify(_0x326623){const _0x27cfd2=_0x49f930;let _0x4a941b;if(restoredConfigFile==0x1)_0x4a941b='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x4a941b=_0x27cfd2(0x122);if(_0x326623)io['to']('botmanager')['emit'](_0x27cfd2(0x2b8),_0x4a941b);else{logger[_0x27cfd2(0x193)](_0x27cfd2(0x268)),logger[_0x27cfd2(0x193)](_0x4a941b),logger['simple'](_0x27cfd2(0x268)),logger['simple']('');if(tgBot&&settings[_0x27cfd2(0x247)]&&settings[_0x27cfd2(0x251)]!=_0x27cfd2(0x26d))await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x4a941b);}}function decryptRSA(_0x23b797,_0x446649){const _0xb7003f=_0x49f930,_0x64e859=forge['pki']['privateKeyFromPem'](_0x23b797),_0x11f811=_0x64e859[_0xb7003f(0x22a)](forge[_0xb7003f(0x21e)]['decode64'](_0x446649),'RSA-OAEP',{'md':forge['md'][_0xb7003f(0x2f3)][_0xb7003f(0x2b6)](),'mgf1':{'md':forge['md'][_0xb7003f(0x2f3)]['create']()}});return _0x11f811;}function validateCredentials(_0x2561f4,_0x41b772){const _0x348d2b=_0x49f930;if(_0x2561f4[_0x348d2b(0x1ea)]==settings['bbUsername']&&bcrypt['compareSync'](_0x2561f4[_0x348d2b(0x31e)],settings[_0x348d2b(0x170)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x348d2b(0x1c5),'token':null};else{const _0x432217=generateLoginToken(_0x41b772);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x432217};}}else return{'allow':![],'reason':_0x348d2b(0x2c7),'token':null};}function refreshToken(_0x5b2bb3){const _0x49d3f8=_0x49f930,_0x3ce9f0=generateLoginToken(_0x5b2bb3);return{'allow':!![],'reason':_0x49d3f8(0x28f),'token':_0x3ce9f0};}function validateAccess(_0xb1ae3b,_0x2536ce,_0x1113e2){const _0x31e51b=_0x49f930,_0x112787=_0x1113e2?_0x1113e2:devices[_0x2536ce]['ip'];let _0x48cfaf;const _0x447a25=_0x1afa02=>{const _0x2255c6=_0x2ff0;if(settings[_0x2255c6(0x1a9)]){if(settings[_0x2255c6(0x2b2)]){if(telegram2FaApproved(_0x2536ce)){const _0x269133=generateLoginToken(_0x2536ce);return{'allow':!![],'reason':_0x2255c6(0x12e),'token':_0x269133};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x48cfaf=validToken(_0x1afa02,_0x2536ce),_0x48cfaf[_0x2255c6(0x17b)](_0x2255c6(0x11f))?{'allow':!![],'reason':_0x2255c6(0x1bd),'token':_0x1afa02}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x2255c6(0x30c),'token':null};};if(settings[_0x31e51b(0x319)]){let _0x4195b2=[...settings[_0x31e51b(0x2de)],_0x31e51b(0x1d4),_0x31e51b(0x1a0),'127.0.0.1','::ffff:7f00:1'];if(_0x4195b2['includes'](_0x112787))return _0x447a25(_0xb1ae3b);else{_0x48cfaf=validToken(_0xb1ae3b,_0x2536ce);if(_0x48cfaf[_0x31e51b(0x17b)]('success'))return _0x447a25(_0xb1ae3b);else{if(telegramIpApproved(_0x2536ce)){const _0x34d70b=generateToken(_0x2536ce);return _0x48cfaf=_0x447a25(_0xb1ae3b),_0x48cfaf[_0x31e51b(0x114)]?{'allow':!![],'reason':_0x31e51b(0x179),'token':_0x34d70b}:_0x48cfaf;}else return settings[_0x31e51b(0x1b7)]?{'allow':![],'reason':_0x31e51b(0x240),'token':null}:{'allow':![],'reason':_0x31e51b(0x13b),'token':null};}}}else return _0x447a25(_0xb1ae3b);}function timelyDecrypt(_0x4995fa,_0x5665c2,_0x4b03b7='@'){const _0x1de346=_0x49f930;if(_0x4995fa)try{const _0x27335f=decryptRSA(secure[_0x1de346(0x27e)],_0x4995fa),_0x172480=_0x27335f[_0x1de346(0x2ad)](_0x4b03b7)[0x0],_0x3af3c7=_0x27335f['split'](_0x4b03b7)[0x1],_0x284ae6=new Date()[_0x1de346(0x30f)]();if(_0x5665c2){if(_0x284ae6-_0x3af3c7<maxSecretAge*0x3e8)return _0x172480;else return![];}else return _0x172480;}catch(_0x3d12c5){return![];}else return![];}const validToken=(_0x22e02c,_0x50aa98)=>{const _0x4cde00=_0x49f930,_0x496ade=devices[_0x50aa98]['ip'];if(!_0x22e02c)return{'error':_0x4cde00(0x2e6)};for(let _0xc4d550 of blacklist){if(_0xc4d550[_0x4cde00(0x2b0)]==_0x22e02c)return{'error':_0x4cde00(0x211)};}let _0x43b70d;try{_0x43b70d=jwt[_0x4cde00(0x22c)](_0x22e02c,secure[_0x4cde00(0x150)]+_0x50aa98);}catch{return{'error':_0x4cde00(0x2ca)};}if(!_0x43b70d[_0x4cde00(0x17b)](_0x4cde00(0x2c6))&&!_0x43b70d[_0x4cde00(0x17b)]('username')||!_0x43b70d[_0x4cde00(0x17b)](_0x4cde00(0x183)))return{'error':_0x4cde00(0x116)};if(!_0x43b70d[_0x4cde00(0x17b)](_0x4cde00(0x1ea))&&_0x43b70d[_0x4cde00(0x17b)](_0x4cde00(0x2c6))){const {clientip:_0x747133}=_0x43b70d;return _0x496ade==_0x747133?{'success':_0x4cde00(0x19f)}:{'error':_0x4cde00(0x28c)};}else{if(_0x43b70d['hasOwnProperty'](_0x4cde00(0x1ea))&&_0x43b70d[_0x4cde00(0x17b)](_0x4cde00(0x2c6))){const {username:_0x36ab82,clientip:_0x47f375}=_0x43b70d;return settings[_0x4cde00(0x2e7)]==_0x36ab82&&_0x496ade==_0x47f375?{'success':_0x4cde00(0x19f)}:{'error':_0x4cde00(0x149)};}}},generateLoginToken=_0x2810a3=>{const _0x2f07ab=_0x49f930;if(_0x2810a3){const _0x3af631=devices[_0x2810a3]['ip'];return jwt[_0x2f07ab(0x2dd)]({'username':settings[_0x2f07ab(0x2e7)],'clientip':_0x3af631},secure[_0x2f07ab(0x150)]+_0x2810a3,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x1e5732=>{const _0x57023a=_0x49f930;if(_0x1e5732){const _0x143e79=devices[_0x1e5732]['ip'];return jwt[_0x57023a(0x2dd)]({'clientip':_0x143e79},secure['secret']+_0x1e5732,{'expiresIn':devices[_0x1e5732][_0x57023a(0x20e)][_0x57023a(0x263)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x3dc4ce=>{const _0x3ff258=_0x49f930;let _0x54da4d=![];return devices[_0x3dc4ce][_0x3ff258(0x20e)]&&devices[_0x3dc4ce]['telegramIpApproval'][_0x3ff258(0x263)]!=_0x3ff258(0x118)&&(_0x54da4d=devices[_0x3dc4ce][_0x3ff258(0x20e)][_0x3ff258(0x2c6)]==devices[_0x3dc4ce]['ip']&&new Date()['getTime']()-devices[_0x3dc4ce][_0x3ff258(0x20e)]['timestamp']<devices[_0x3dc4ce][_0x3ff258(0x20e)][_0x3ff258(0x263)]*0x3c*0x3e8),_0x54da4d;},telegram2FaApproved=_0x17f9d0=>{const _0x45c2d8=_0x49f930;let _0x4a1995=![];return devices[_0x17f9d0][_0x45c2d8(0x11a)]&&devices[_0x17f9d0]['telegram2FaApproval'][_0x45c2d8(0x263)]!=_0x45c2d8(0x118)&&(_0x4a1995=devices[_0x17f9d0][_0x45c2d8(0x11a)][_0x45c2d8(0x2c6)]==devices[_0x17f9d0]['ip']&&new Date()[_0x45c2d8(0x30f)]()-devices[_0x17f9d0][_0x45c2d8(0x11a)][_0x45c2d8(0x1ee)]<devices[_0x17f9d0]['telegram2FaApproval'][_0x45c2d8(0x263)]*0x3c*0x3e8),_0x4a1995;},normalizeIP=_0x545cd9=>{const _0x269bab=_0x49f930;let _0x1bab0d=null,_0x42e562=null;if(ipaddr[_0x269bab(0x265)](_0x545cd9)){const _0x2716b5=ipaddr[_0x269bab(0x16d)](_0x545cd9);_0x2716b5[_0x269bab(0x22f)]()==='ipv6'?(_0x2716b5[_0x269bab(0x1db)]()&&(_0x1bab0d=_0x2716b5['toIPv4Address']()['toString']()),_0x42e562=_0x2716b5['toString']()):(_0x1bab0d=_0x2716b5[_0x269bab(0x294)](),_0x42e562=_0x2716b5['toIPv4MappedAddress']()[_0x269bab(0x294)]());}return{'show':_0x1bab0d?_0x1bab0d:_0x42e562,'store':_0x42e562};};function formatDate(_0x444607){const _0x4a9716=_0x49f930;return _0x444607[_0x4a9716(0x309)]()+'/'+(_0x444607['getMonth']()+0x1)[_0x4a9716(0x294)]()[_0x4a9716(0x23c)](0x2,'0')+'/'+_0x444607[_0x4a9716(0x332)]()[_0x4a9716(0x294)]()[_0x4a9716(0x23c)](0x2,'0')+'\x20'+_0x444607[_0x4a9716(0x178)]()[_0x4a9716(0x294)]()['padStart'](0x2,'0')+':'+_0x444607[_0x4a9716(0x196)]()[_0x4a9716(0x294)]()['padStart'](0x2,'0')+':'+_0x444607[_0x4a9716(0x1ff)]()['toString']()[_0x4a9716(0x23c)](0x2,'0');}function sleep(_0x144f20){return new Promise(_0x568fea=>setTimeout(_0x568fea,_0x144f20));}