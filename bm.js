const _0x433ce9=_0x2499;(function(_0x1a8e55,_0x48ebd6){const _0xce8f40=_0x2499,_0x10331f=_0x1a8e55();while(!![]){try{const _0x20ab34=-parseInt(_0xce8f40(0x395))/0x1*(parseInt(_0xce8f40(0x3c3))/0x2)+-parseInt(_0xce8f40(0x247))/0x3*(-parseInt(_0xce8f40(0x271))/0x4)+parseInt(_0xce8f40(0x315))/0x5*(parseInt(_0xce8f40(0x3de))/0x6)+parseInt(_0xce8f40(0x297))/0x7*(parseInt(_0xce8f40(0x3e8))/0x8)+parseInt(_0xce8f40(0x206))/0x9*(parseInt(_0xce8f40(0x36f))/0xa)+parseInt(_0xce8f40(0x3da))/0xb*(parseInt(_0xce8f40(0x2b8))/0xc)+parseInt(_0xce8f40(0x2d2))/0xd*(-parseInt(_0xce8f40(0x30b))/0xe);if(_0x20ab34===_0x48ebd6)break;else _0x10331f['push'](_0x10331f['shift']());}catch(_0x222d69){_0x10331f['push'](_0x10331f['shift']());}}}(_0x3280,0xd2f3b));const _0x1a3868=function(){let _0x338ada=!![];return function(_0x1f7a13,_0x3c686b){const _0x33e148=_0x338ada?function(){const _0x1ae153=_0x2499;if(_0x3c686b){const _0x3abbcc=_0x3c686b[_0x1ae153(0x264)](_0x1f7a13,arguments);return _0x3c686b=null,_0x3abbcc;}}:function(){};return _0x338ada=![],_0x33e148;};}(),_0x5740b4=_0x1a3868(this,function(){const _0x1ce69d=_0x2499;return _0x5740b4[_0x1ce69d(0x286)]()[_0x1ce69d(0x3d0)]('(((.+)+)+)+$')[_0x1ce69d(0x286)]()[_0x1ce69d(0x324)](_0x5740b4)[_0x1ce69d(0x3d0)]('(((.+)+)+)+$');});_0x5740b4();'use strict';function _0x2499(_0x3ad330,_0x7eda24){const _0xc3ee4e=_0x3280();return _0x2499=function(_0x5740b4,_0x1a3868){_0x5740b4=_0x5740b4-0x1ed;let _0x328046=_0xc3ee4e[_0x5740b4];return _0x328046;},_0x2499(_0x3ad330,_0x7eda24);}process[_0x433ce9(0x397)][_0x433ce9(0x3cf)]=0x1;const childProcess=require(_0x433ce9(0x31b)),fs=require('fs'),fns=require('date-fns'),low=require(_0x433ce9(0x2f7)),FileSync=require(_0x433ce9(0x39b)),path=require(_0x433ce9(0x242)),crypto=require(_0x433ce9(0x268)),forge=require(_0x433ce9(0x311)),bcrypt=require(_0x433ce9(0x3f4)),jwt=require('jsonwebtoken'),ipaddr=require('ipaddr.js'),yargs=require(_0x433ce9(0x2c7)),uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x433ce9(0x3bc)),Mixpanel=require(_0x433ce9(0x3a1)),axios=require('axios'),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x433ce9(0x27e)),fileUpload=require(_0x433ce9(0x3ed)),{networkInterfaces}=require('os'),JSZip=require(_0x433ce9(0x228)),argv=yargs(process['argv'][_0x433ce9(0x208)](0x2))[_0x433ce9(0x323)],PORT=argv[_0x433ce9(0x34d)]||_0x433ce9(0x2c2),pattern=/^[0-9]{2,4}$/;!pattern[_0x433ce9(0x232)](PORT)&&(console[_0x433ce9(0x382)](_0x433ce9(0x223)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x433ce9(0x31f)](0x1));const HOST=argv[_0x433ce9(0x257)]||null,userID=argv[_0x433ce9(0x400)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process['versions']['node'];let bbpath=_0x433ce9(0x3fe),bbpath2='';const botfile=_0x433ce9(0x2d3),configfile=_0x433ce9(0x211),settingsfile=_0x433ce9(0x3ae),securefile=_0x433ce9(0x3a4),environment=require('./'+bbpath2+_0x433ce9(0x403))['environment']||_0x433ce9(0x22f),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x433ce9(0x3ec)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x433ce9(0x2f2)),configpath=userID?bbpath+_0x433ce9(0x27c)+userID+'/':bbpath+_0x433ce9(0x27c),configbackuppath=configpath+_0x433ce9(0x1ed),logspath=userID?bbpath+_0x433ce9(0x37a)+userID+'/':bbpath+_0x433ce9(0x37a),zippath=userID?bbpath+_0x433ce9(0x322)+userID+'/':bbpath+_0x433ce9(0x322),loggerfile=fs[_0x433ce9(0x332)](logspath+_0x433ce9(0x370),{'flags':'a'}),temppath=userID?bbpath+_0x433ce9(0x1ef)+userID+'/':bbpath+_0x433ce9(0x1ef);!fs[_0x433ce9(0x3ec)](configpath)&&fs[_0x433ce9(0x37b)](configpath);!fs[_0x433ce9(0x3ec)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x433ce9(0x3ec)](logspath)&&fs[_0x433ce9(0x37b)](logspath);!fs['existsSync'](zippath)&&fs[_0x433ce9(0x37b)](zippath);!fs[_0x433ce9(0x3ec)](temppath)&&fs[_0x433ce9(0x37b)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x433ce9(0x21d)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x433ce9(0x21d)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x433ce9(0x1f9),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0x433ce9(0x348)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x433ce9(0x335)](_0x433ce9(0x2c0),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x433ce9(0x310)]&&(settings[_0x433ce9(0x310)]!=''&&settings[_0x433ce9(0x310)]!=_0x433ce9(0x284))&&settings[_0x433ce9(0x21f)]&&settings[_0x433ce9(0x21f)]!='')initTelegram();const parseColor=(_0x48db99,_0x18e13c)=>{const _0x57e574=_0x433ce9,_0xe41d5c=/#[A-Z]{3}#/g;if(typeof _0x48db99==_0x57e574(0x23b)){!_0x18e13c?_0x48db99=_0x48db99['replace'](_0xe41d5c,''):(_0x48db99=_0x48db99[_0x57e574(0x3d5)](/#BLU#/g,_0x57e574(0x205)),_0x48db99=_0x48db99[_0x57e574(0x3d5)](/#RED#/g,_0x57e574(0x263)),_0x48db99=_0x48db99[_0x57e574(0x3d5)](/#YEL#/g,_0x57e574(0x273)),_0x48db99=_0x48db99['replace'](/#MAG#/g,_0x57e574(0x366)),_0x48db99=_0x48db99['replace'](/#CYA#/g,_0x57e574(0x277)),_0x48db99=_0x48db99['replace'](/#RES#/g,_0x57e574(0x3d1)));;}return _0x48db99;},logger={'screen':_0x5d3488=>{const _0x2e0afa=_0x433ce9;console[_0x2e0afa(0x382)](parseColor(_0x5d3488,!![]));},'simple':_0x1dbb9c=>{const _0x4c9c32=_0x433ce9;console[_0x4c9c32(0x382)](parseColor(_0x1dbb9c,!![])),loggerfile[_0x4c9c32(0x348)](util[_0x4c9c32(0x296)](parseColor(_0x1dbb9c,![]))+'\x0a');},'full':async _0x39d806=>{const _0x3ca0e0=_0x433ce9,_0x4d4995=getTimeStamp()+_0x3ca0e0(0x1f2)+_0x39d806;console[_0x3ca0e0(0x382)](parseColor(_0x4d4995,!![])),loggerfile['write'](util[_0x3ca0e0(0x296)](parseColor(_0x4d4995,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x3ca0e0(0x2f9))await sendTelegram(settings['telegramChatId'],_0x3ca0e0(0x3aa)+parseColor(_0x39d806,![]));},'debug':async(_0xc8488c,_0x5dabba='')=>{const _0x16f69e=_0x433ce9,_0x19302a=getTimeStamp()+_0x16f69e(0x2cb)+_0xc8488c;if(debugging)console['log'](parseColor(_0x19302a,!![]));loggerfile['write'](util[_0x16f69e(0x296)](parseColor(_0x19302a,![]))+'\x0a');if(_0x5dabba){if(debugging)console[_0x16f69e(0x382)](_0x5dabba);loggerfile[_0x16f69e(0x348)](util[_0x16f69e(0x296)](_0x5dabba)+'\x0a');}}};let terminating=![];process['on'](_0x433ce9(0x393),function(_0x30931b){const _0x30b7a7=_0x433ce9;_0x30931b[_0x30b7a7(0x286)]()[_0x30b7a7(0x2a9)](_0x30b7a7(0x2db))?(logger[_0x30b7a7(0x3df)]('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x30931b['port']+_0x30b7a7(0x33b)),process[_0x30b7a7(0x37d)]({'terminate':!![]},_0x44008b=>{})):logger[_0x30b7a7(0x3df)](_0x30931b);}),process['on']('exit',()=>{const _0x158d48=_0x433ce9;stopAllBots(),process[_0x158d48(0x31f)](0x0);}),process['on'](_0x433ce9(0x229),()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGINT',()=>{const _0x35d090=_0x433ce9;stopAllBots(),process[_0x35d090(0x31f)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x433ce9(0x403))[_0x433ce9(0x3e1)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')[_0x433ce9(0x378)](app);app[_0x433ce9(0x2f0)](fileUpload({'useTempFiles':!![]})),app[_0x433ce9(0x261)]('/download/:type',async(_0x582e7c,_0x1bbbe2)=>{const _0x479831=_0x433ce9,_0xc982cf=_0x582e7c[_0x479831(0x293)]['type'],_0xbda824=getClientsWithBotID(_0x479831(0x22d)),_0x461554=_0x582e7c[_0x479831(0x303)][_0x479831(0x34b)],_0x493121=timelyDecrypt(_0x461554,![]),_0x3a3d23=_0xbda824[_0x479831(0x339)](_0xf3cbf7=>_0xf3cbf7[_0x479831(0x34b)]==_0x493121);if(_0x3a3d23){const _0x47c787=normalizeIP(_0x582e7c[_0x479831(0x29a)][_0x479831(0x20d)])[_0x479831(0x1f5)],_0x185445=_0x582e7c[_0x479831(0x303)]['tkn'];if(validateAccess(_0x185445,_0x493121,_0x47c787)[_0x479831(0x2fd)])_0xc982cf==_0x479831(0x33e)&&await backupConfigFiles(),await zipFiles(_0xc982cf),_0x1bbbe2[_0x479831(0x2de)](zippath+(_0xc982cf+_0x479831(0x377)),_0x32399e=>{const _0x17eb1d=_0x479831;_0x32399e&&(logger[_0x17eb1d(0x3a6)](_0x17eb1d(0x216)+_0xc982cf),logger[_0x17eb1d(0x3df)](_0x32399e));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0xc982cf+_0x479831(0x219));}else logger[_0x479831(0x3a6)](_0x479831(0x2bc)+_0xc982cf+'\x20(2)');}),app[_0x433ce9(0x3d4)](_0x433ce9(0x2ae),async(_0x4b666e,_0x33cf1f)=>{const _0x238a60=_0x433ce9,_0x32136f=getClientsWithBotID(_0x238a60(0x22d)),_0x3c2ffa=_0x4b666e[_0x238a60(0x303)][_0x238a60(0x34b)],_0x2e758a=timelyDecrypt(_0x3c2ffa,![]),_0x341cd4=_0x32136f['find'](_0x139d02=>_0x139d02[_0x238a60(0x34b)]==_0x2e758a);logger[_0x238a60(0x26e)](_0x238a60(0x396));if(_0x341cd4){const _0x18052f=normalizeIP(_0x4b666e[_0x238a60(0x29a)][_0x238a60(0x20d)])[_0x238a60(0x1f5)],_0x24d08d=_0x4b666e[_0x238a60(0x303)][_0x238a60(0x3d8)];if(validateAccess(_0x24d08d,_0x2e758a,_0x18052f)[_0x238a60(0x2fd)]){if(_0x4b666e[_0x238a60(0x2ef)]){const _0x67a2f3=_0x4b666e[_0x238a60(0x2ef)][_0x238a60(0x381)];await _0x67a2f3['mv'](temppath+_0x67a2f3[_0x238a60(0x392)]),_0x33cf1f[_0x238a60(0x37d)]({'status':!![],'message':'File\x20uploaded'});const _0x433b73=getBotsWithMode();_0x433b73['length']>0x0?confirmRestore(temppath,_0x67a2f3['name']):unzipFile(temppath,_0x67a2f3[_0x238a60(0x392)]);}}else logger['full'](_0x238a60(0x34c));}else logger[_0x238a60(0x3a6)](_0x238a60(0x3c7));}),app[_0x433ce9(0x2f0)](express['static'](path[_0x433ce9(0x2d4)](__dirname,bbpath2,_0x433ce9(0x2e2)))),app['use'](express['static'](path['join'](__dirname,bbpath2,'build'))),app[_0x433ce9(0x261)]('/',function(_0x27093e,_0x35a82a){const _0x1d5046=_0x433ce9;_0x35a82a[_0x1d5046(0x290)](path[_0x1d5046(0x2d4)](__dirname,bbpath2,'build2',_0x1d5046(0x204)));}),app['get'](_0x433ce9(0x337),function(_0x5885dc,_0x6256c){const _0xf1e007=_0x433ce9;_0x6256c['sendFile'](path[_0xf1e007(0x2d4)](__dirname,bbpath2,'build','index.html'));}),app[_0x433ce9(0x261)]('/:bot/portfolio',(_0x4dc1da,_0x585d66)=>{const _0x44518a=_0x433ce9;_0x585d66['sendFile'](path['join'](__dirname,bbpath2,_0x44518a(0x25b),_0x44518a(0x204)));}),app[_0x433ce9(0x261)](_0x433ce9(0x1fd),(_0x1de879,_0x387a8d)=>{const _0x5d33cb=_0x433ce9;_0x387a8d[_0x5d33cb(0x290)](path[_0x5d33cb(0x2d4)](__dirname,bbpath2,_0x5d33cb(0x25b),_0x5d33cb(0x204)));}),app[_0x433ce9(0x261)](_0x433ce9(0x308),(_0x4a7d3c,_0x55adfe)=>{const _0x2529b0=_0x433ce9;_0x55adfe[_0x2529b0(0x290)](path[_0x2529b0(0x2d4)](__dirname,bbpath2,_0x2529b0(0x25b),_0x2529b0(0x204)));}),app[_0x433ce9(0x261)](_0x433ce9(0x2c3),(_0x419fb5,_0x2f6abf)=>{const _0x28b38d=_0x433ce9;_0x2f6abf[_0x28b38d(0x290)](path[_0x28b38d(0x2d4)](__dirname,bbpath2,_0x28b38d(0x25b),'index.html'));}),app[_0x433ce9(0x261)]('/:bot/configuration',(_0xf029dd,_0x2d639d)=>{const _0x299dd7=_0x433ce9;_0x2d639d[_0x299dd7(0x290)](path[_0x299dd7(0x2d4)](__dirname,bbpath2,'build','index.html'));}),app[_0x433ce9(0x261)](_0x433ce9(0x266),(_0x163849,_0x2cd37e)=>{const _0x1d4305=_0x433ce9;_0x2cd37e['sendFile'](path[_0x1d4305(0x2d4)](__dirname,bbpath2,'build','index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0x433ce9(0x34a)](PORT);const io=require(_0x433ce9(0x25c))(http,{});openBrowser&&(async()=>{const _0x254ce7=_0x433ce9,{default:_0x563bcf}=await import(_0x254ce7(0x26a));await _0x563bcf(_0x254ce7(0x301)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x507345=_0x433ce9;let _0x3eb7d1='[ip-address]';const _0x4deb57=networkInterfaces(),_0x1d9367={};for(const _0x482b87 of Object[_0x507345(0x3c6)](_0x4deb57)){for(const _0x525c41 of _0x4deb57[_0x482b87]){if((_0x525c41[_0x507345(0x2ad)]==_0x507345(0x2cc)||_0x525c41['family']==0x4)&&!_0x525c41[_0x507345(0x30a)]){const _0x366dcf=ipaddr[_0x507345(0x32a)](_0x525c41[_0x507345(0x31a)])['range']();_0x366dcf!=_0x507345(0x250)&&(!_0x1d9367[_0x482b87]&&(_0x1d9367[_0x482b87]=[]),_0x1d9367[_0x482b87]['push'](_0x525c41[_0x507345(0x31a)]),_0x3eb7d1=_0x525c41[_0x507345(0x31a)]);}}}return{'serverip':_0x3eb7d1,'netinterfaces':_0x1d9367};}async function startServer(){const _0x3ef6ef=_0x433ce9,{serverip:_0x17c78d,netinterfaces:_0x50a637}=getServerIP();logger[_0x3ef6ef(0x3df)](''),logger[_0x3ef6ef(0x3df)]('-----------------------------------------------------------------------------------'),await logger[_0x3ef6ef(0x3a6)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0x3ef6ef(0x3f1)?'(staging)':'')+'\x0a'+(_0x3ef6ef(0x231)+PORT+_0x3ef6ef(0x2ce))+(_0x3ef6ef(0x3bb)+_0x17c78d+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x3ef6ef(0x3df)](_0x3ef6ef(0x3b9));if(config[_0x3ef6ef(0x305)]!=0x0)for(const _0x204860 of config){const _0x4e6000=_0x204860[_0x3ef6ef(0x1f3)]=='auto'?'a':'m';if(_0x204860[_0x3ef6ef(0x367)]==_0x3ef6ef(0x40a)||_0x204860['status']==_0x3ef6ef(0x402))await logger[_0x3ef6ef(0x3a6)](_0x3ef6ef(0x372)+_0x4e6000+_0x3ef6ef(0x3cd)+_0x204860[_0x3ef6ef(0x3a8)]+_0x3ef6ef(0x39f)+_0x204860['botname']),startBot([_0x204860[_0x3ef6ef(0x3a8)],userID],{'cwd':bbpath},function(_0x24ce28){const _0x2e80e2=_0x3ef6ef;if(_0x24ce28)logger[_0x2e80e2(0x3a6)](_0x24ce28);});else(_0x204860[_0x3ef6ef(0x367)]==_0x3ef6ef(0x2e5)||_0x204860['status']==_0x3ef6ef(0x3cb))&&await logger[_0x3ef6ef(0x3a6)](_0x3ef6ef(0x34f)+_0x4e6000+_0x3ef6ef(0x3f5)+_0x204860[_0x3ef6ef(0x3a8)]+'\x20|\x20'+_0x204860[_0x3ef6ef(0x3c9)]);}else!newBot&&logger[_0x3ef6ef(0x3df)](_0x3ef6ef(0x347));if(newBot)addBot();logger['simple'](_0x3ef6ef(0x3b9)),logger[_0x3ef6ef(0x3df)](''),await logger[_0x3ef6ef(0x26e)](_0x3ef6ef(0x375)+nodeversion),await logger[_0x3ef6ef(0x26e)]('Network\x20Interfaces:',_0x50a637);}function startSocket(){const _0x1d7452=_0x433ce9;io['on'](_0x1d7452(0x3eb),_0x1044f0=>{const _0x3bbc80=_0x1d7452;let _0x59a253,_0x3298e8,_0x23dd3b,_0x3676cb,_0x2ed246;const _0x44a053=_0x1044f0['handshake'][_0x3bbc80(0x303)][_0x3bbc80(0x33a)];_0x3298e8=_0x44a053[_0x3bbc80(0x2e4)](/bot[0-9]{3}/);if(_0x3298e8)_0x23dd3b=_0x3298e8[0x0]['match'](/[0-9]{3}/);if(_0x23dd3b)_0x59a253=_0x23dd3b[0x0];else _0x59a253=_0x3bbc80(0x22d);const _0x856a99=_0x1044f0[_0x3bbc80(0x3d6)]['auth'][_0x3bbc80(0x317)];if(!_0x856a99)_0x1044f0['emit'](_0x3bbc80(0x367),{'publicKey':secure[_0x3bbc80(0x3af)]});else{_0x3676cb=timelyDecrypt(_0x856a99,![]);if(!_0x3676cb)_0x1044f0[_0x3bbc80(0x1ff)](_0x3bbc80(0x367),{'publicKey':secure[_0x3bbc80(0x3af)]});else{_0x2ed246=normalizeIP(_0x1044f0[_0x3bbc80(0x1f0)][_0x3bbc80(0x20d)])['store'];if(!devices[_0x3676cb])devices[_0x3676cb]={'uuid':_0x3676cb,'access':{'token':null}};devices[_0x3676cb]['ip']=_0x2ed246;const _0x679e6c=addClient(_0x1044f0['id'],_0x3676cb,_0x59a253);setAccess(_0x679e6c),emitMessages(),_0x1044f0['on'](_0x3bbc80(0x249),_0x1742ea=>{const _0x2023a8=_0x3bbc80,_0xf3c027=timelyDecrypt(_0x1742ea[_0x2023a8(0x298)],!![],_0x2023a8(0x24d));if(_0xf3c027){_0x1742ea={'username':_0x1742ea['username'],'password':_0xf3c027},devices[_0x3676cb][_0x2023a8(0x2df)]=validateCredentials(_0x1742ea,_0x3676cb);if(devices[_0x3676cb][_0x2023a8(0x2df)][_0x2023a8(0x2fd)]==![]&&devices[_0x3676cb]['access'][_0x2023a8(0x35c)]==_0x2023a8(0x262))_0x1044f0[_0x2023a8(0x1ff)](_0x2023a8(0x367),{'access':devices[_0x3676cb][_0x2023a8(0x2df)]}),loginAccess2FA(_0x3676cb,_0x2ed246);else{if(devices[_0x3676cb]['access'][_0x2023a8(0x2fd)]==![]&&devices[_0x3676cb]['access']['reason']==_0x2023a8(0x2b0))_0x1044f0['emit'](_0x2023a8(0x367),{'access':devices[_0x3676cb][_0x2023a8(0x2df)]});else devices[_0x3676cb]['access'][_0x2023a8(0x2fd)]&&devices[_0x3676cb]['access']['reason']==_0x2023a8(0x22a)&&(getClientsWithUuid(_0x3676cb)[_0x2023a8(0x302)](_0x53dd61=>{setAccess(_0x53dd61);}),logger[_0x2023a8(0x26e)](_0x2023a8(0x394)+_0x3676cb[_0x2023a8(0x208)](-0x8)),setTokenRefresh(_0x3676cb),setSessionTimeout(_0x2023a8(0x249),_0x3676cb));}}else logger[_0x2023a8(0x3a6)](_0x2023a8(0x2fb));}),_0x1044f0['on']('reset-password',()=>{resetPassword();}),_0x1044f0['on'](_0x3bbc80(0x243),_0x12f199=>{removeClient(_0x1044f0['id']);}),_0x59a253=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x14a8b0){const _0x242020=_0x433ce9;if(_0x14a8b0!=_0x242020(0x22d)&&config[_0x242020(0x285)]!=''){if(pid[_0x14a8b0])pid[_0x14a8b0][_0x242020(0x37d)]({'function':_0x242020(0x300),'args':null});}_0x14a8b0!='botmanager'&&broadcastToBots('bots',JSON[_0x242020(0x3d2)](config));}function reloadBotManager(){const _0x52c257=_0x433ce9;getClientsWithBotID(_0x52c257(0x22d))[_0x52c257(0x302)](_0x43997e=>{const _0x4c13be=_0x52c257;getSocket(_0x43997e['id'])[_0x4c13be(0x1ff)](_0x4c13be(0x367),{'access':{'allow':![],'reason':_0x4c13be(0x2a5),'token':null}});});}function getSocket(_0x2fc66f){const _0x50421e=_0x433ce9,_0x5a0adb=io[_0x50421e(0x2e9)][_0x50421e(0x261)]('/');return _0x5a0adb[_0x50421e(0x224)][_0x50421e(0x261)](_0x2fc66f);}function setAccess(_0x248985){const _0x28c2ad=_0x433ce9,_0x3ed2f3=getSocket(_0x248985['id']),_0x257340=_0x248985['uuid'],_0x1d5ca0=_0x248985['bot'];devices[_0x257340][_0x28c2ad(0x2df)]=validateAccess(devices[_0x257340]['access']['token'],_0x257340),logger[_0x28c2ad(0x26e)](_0x28c2ad(0x3e0)+devices[_0x257340][_0x28c2ad(0x2df)]['reason']+'\x20|\x20client:\x20...'+_0x248985['id'][_0x28c2ad(0x208)](-0x8)+'\x20|\x20user:\x20...'+_0x257340[_0x28c2ad(0x208)](-0x8)),_0x3ed2f3[_0x28c2ad(0x2d4)](_0x257340);if(devices[_0x257340][_0x28c2ad(0x2df)][_0x28c2ad(0x2fd)]){_0x3ed2f3[_0x28c2ad(0x2d4)](_0x1d5ca0);if(_0x1d5ca0==_0x28c2ad(0x22d))initializeSocketBotManager(_0x3ed2f3);else initializeSocketBot(_0x3ed2f3);initClient(_0x1d5ca0);}devices[_0x257340]['access'][_0x28c2ad(0x39a)]&&devices[_0x257340][_0x28c2ad(0x2df)][_0x28c2ad(0x35c)]==_0x28c2ad(0x3a9)&&setSessionTimeout('2FA',_0x257340),devices[_0x257340][_0x28c2ad(0x2df)][_0x28c2ad(0x39a)]&&devices[_0x257340][_0x28c2ad(0x2df)]['reason']==_0x28c2ad(0x307)&&setSessionTimeout('login',_0x257340),_0x3ed2f3[_0x28c2ad(0x1ff)]('status',{'status':_0x248985[_0x28c2ad(0x2eb)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x257340][_0x28c2ad(0x2df)],'externalip':devices[_0x257340]['ip'],'publicKey':secure[_0x28c2ad(0x3af)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x257340]['access'][_0x28c2ad(0x2fd)]==![]&&devices[_0x257340][_0x28c2ad(0x2df)][_0x28c2ad(0x35c)]==_0x28c2ad(0x227)&&temporaryAccess2FA(_0x257340,devices[_0x257340]['ip']);}function setSessionTimeout(_0x2534cc,_0x39c7cc){const _0x3e63e3=_0x433ce9;let _0x335639;if(_0x2534cc==_0x3e63e3(0x249))_0x335639=loginExpiry*0x3c*0x3e8;else _0x335639=devices[_0x39c7cc][_0x3e63e3(0x3c0)][_0x3e63e3(0x354)]*0x3c*0x3e8-(new Date()[_0x3e63e3(0x25a)]()-devices[_0x39c7cc][_0x3e63e3(0x3c0)][_0x3e63e3(0x2a3)]);if(devices[_0x39c7cc][_0x3e63e3(0x2f5)])clearTimeout(devices[_0x39c7cc][_0x3e63e3(0x2f5)]);devices[_0x39c7cc][_0x3e63e3(0x2f5)]=setTimeout(()=>{const _0x132760=_0x3e63e3;if(devices[_0x39c7cc]['pidRefreshToken'])clearTimeout(devices[_0x39c7cc][_0x132760(0x2c1)]);removeSocketListeners(_0x39c7cc),addBlacklist(_0x39c7cc),devices[_0x39c7cc][_0x132760(0x3c0)]=null,devices[_0x39c7cc][_0x132760(0x2f6)]=null,devices[_0x39c7cc][_0x132760(0x2df)][_0x132760(0x39a)]=null,logger[_0x132760(0x26e)](_0x132760(0x2b5)+_0x39c7cc[_0x132760(0x208)](-0x8)),devices[_0x39c7cc]['access']=validateAccess(devices[_0x39c7cc][_0x132760(0x2df)]['token'],_0x39c7cc),!(devices[_0x39c7cc][_0x132760(0x2df)][_0x132760(0x2fd)]&&devices[_0x39c7cc]['access'][_0x132760(0x35c)]==_0x132760(0x3f0))&&(_0x2534cc==_0x132760(0x249)?io['to'](_0x39c7cc)['emit']('status',{'access':{'allow':![],'reason':_0x132760(0x28b),'token':null}}):io['to'](_0x39c7cc)[_0x132760(0x1ff)](_0x132760(0x367),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x39c7cc][_0x132760(0x2df)][_0x132760(0x39a)]=null;},_0x335639);}function setTokenRefresh(_0x4e3a7e){const _0x4c31a1=_0x433ce9;if(devices[_0x4e3a7e]['pidRefreshToken'])clearTimeout(devices[_0x4e3a7e][_0x4c31a1(0x2c1)]);devices[_0x4e3a7e][_0x4c31a1(0x2c1)]=setTimeout(()=>{const _0x404999=_0x4c31a1;getClientsWithUuid(_0x4e3a7e)[_0x404999(0x305)]!=0x0?(devices[_0x4e3a7e][_0x404999(0x2df)]=refreshToken(_0x4e3a7e),io['to'](_0x4e3a7e)[_0x404999(0x1ff)](_0x404999(0x367),{'status':_0x404999(0x3f6),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4e3a7e][_0x404999(0x2df)],'externalip':devices[_0x4e3a7e]['ip'],'publicKey':secure[_0x404999(0x3af)],'validInstallation':validInstallation}),setTokenRefresh(_0x4e3a7e)):clearTimeout(devices[_0x4e3a7e]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function _0x3280(){const _0x397e47=['max','botmanager','Invalid\x20IP\x20address','production','push','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','test','settings','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','ETH','privateKeyFromPem','function','#RES#\x20','Notifications\x20enabled','bot','string','userid','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','chat','alias','readFileSync','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','path','disconnect','1000','add-bot','stop','2456931GBGuuu','\x20files\x20over\x20Telegram:','login','any','Bot\x20Mgr\x20>\x20Starting\x20','5\x20min','|@|','placeOrder','RSA-OAEP','private','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','bbUsername','timeshift','/on\x20-\x20start\x20bot(s)\x0a','username','telegramEvents','host','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Markdown','getTime','build','socket.io','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','statSync','/update\x20-\x20update\x20Balance\x20Bot\x0a','output-000.log','get','2FA\x20login\x20required','\x1b[31m','apply','/enable\x20-\x20enable\x20notifications\x0a','/:bot/support','cancelLoading','crypto','metrics','open','getFullYear','\x20-\x20','bbPassword','debug','Unauthorized\x20attempt\x20to\x20get\x20messages','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','4NKWItj','assign','\x1b[33m','once','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','$1_$2_$3','\x1b[36m','getUTCHours','get-backup-files','resetHistory','get-logs','config/','isIPv4MappedAddress','util','names','Bot\x20','accept','/help\x20-\x20show\x20available\x20commands\x0a','bot-','***','apiKey','toString','callback','Login\x20rejected','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Logged\x20out\x20user\x20...','access\x20timeout','endsWith','cancel-loading','hashSync','privateKey','sendFile','getMonth','latestversion','params','start',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','format','7HgDRTm','password','randomFillSync','socket','-config.json','login\x20required','portfolio','storeHeadless','Bot\x20Mgr\x20>\x20Toggling\x20','resetpw_yes','<b>Balance\x20Bot\x20Status:</b>\x0a','ipc','timestamp','fork','reload','************','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','Notifications\x20disabled\x0a','includes','telegram','Notifications\x20types:\x20','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','family','/upload-backup','title','invalid\x20credentials','request','Starting\x20Balance\x20Bot\x20reinstallation','error','data','Session\x20expired\x20for\x20user\x20...','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','24VaFquR','started','*$1*','emitHistory','Unauthorized\x20attempt\x20to\x20download\x20','update_yes','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','127.0.0.1','6b67f3d61ee94b8f5c80b4affef4c4d9','pidRefreshToken','3000','/:bot/history','::1','storeConfiguration','loadAsync','yargs','reinstall_yes','action','yes',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','IPv4','Unauthorized\x20attempt\x20to\x20get\x20events','#RES#\x20if\x20running\x20locally\x0a','getSeconds','reject','getHours','2561UGBCNF','bot.js','join','auto','update','update_no','Server','replyWithDocument','place-order','address\x20already\x20in\x20use','close','show','download','access','copyFileSync','event','build2','unlinkSync','match','disabled','Bot\x20Mgr\x20>\x20Stopping\x20','button','backup-files','_nsps','sortBy','server','showConfig','update-bb','backup-full@','files','use','stopped','clients','remove','headless','pidExpireLogin','telegram2FaApproval','lowdb','apiSecret','orders','2FA\x20login\x20rejected','Unauthorized\x20login\x20attempt\x20(timeout)','loginRequired','allow','isDirectory','sendMetricsTelegram','initclient','http://localhost:','forEach','headers','Unauthorized\x20attempt\x20to\x20delete\x20bot','length','onepagemode','2FA\x20login\x20token\x20generated','/:bot/coins','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','internal','89614foISIu','Error\x20sending\x20','store-configuration','editMessageReplyMarkup','\x20>\x20','telegramToken','node-forge','backup-full','from','config','5DYAgPY','Notifications\x20enabled\x0a','encryptedUuid','marketcapApi','metrics_','address','child_process','Token\x20blacklisted','bots','Unauthorized\x20attempt\x20to\x20confirm\x20message','exit','reply','All','zip/','argv','constructor','rmSync','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Unauthorized\x20attempt\x20to\x20log\x20out','getMinutes','whitelistEnabled','parse','track','\x20mode','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','temporary\x20access\x20rejected','delete-alerts','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','create','createWriteStream','restart','You\x20can\x20use\x20the\x20following\x20commands:\x0a','init','kind','/:bot','settings.','find','referer','#RES#','disable','catch','backup','split','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','tempaccess_15_','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','login2fa_reject_','temporaryAccessAllowed','restore_no_','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','write','showname','listen','uuid','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','port','off_','Idling\x20(','toggle-bot-mode','telegramEnabled','sha256','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','expiry','Telegraf\x20error:','entries','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','output-003.log','secure','Alerts','restore-backup-file','reason','Disabled\x20','telegramChatId','lastmsgtelegram','then','-performance.json','Login\x20accepted','\x20to\x20','reinstall-bb','publicKeyToPem','\x1b[35m','status','Unauthorized\x20attempt\x20to\x20update\x20settings','removeAllListeners','logged\x20out','randomBytes','privateKeyToPem','Invalid\x20authentication\x20token\x20(1)','/names\x20-\x20show\x20bot\x20names\x0a','785300lKXxHg','/output-000.log','backup-full.zip','Starting\x20(','Password\x20has\x20been\x20reset\x20to:\x20','clientip','Node.js\x20v','reinstall_no','.zip','createServer','rsa','logs/','mkdirSync','live','send','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Unauthorized\x20attempt\x20to\x20delete\x20alerts','pki','backupfile','log','text','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','(staging)','No\x20authentication\x20token','get-portfolio','::ffff:127.0.0.1','sendPortfolioTelegram','bbvReceive','reset-history','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','binary','User\x20has\x20been\x20validated','number','writeFileSync','name','uncaughtException','Logged\x20in\x20user\x20...','727tBnMAd','Backup\x20file\x20uploaded','env','padStart','Temporary\x20access\x20rejected','token','lowdb/adapters/FileSync','ipv6','command','/metrics\x20-\x20show\x20bot\x20performance\x0a','\x20|\x20','BCT','mixpanel','Ok,\x20will\x20send\x20order\x20notifications\x20only','CoinMarketCap\x20API\x20key\x20validated','bb-secure.json','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','full','f2aRequired','botID','temporary\x20token\x20generated','Bot\x20Mgr\x20>\x20','hasOwnProperty','sendMessage','set','bb-settings.json','publicKey','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','blacklist','config_orders','Starting\x20Balance\x20Bot\x20update','/off\x20-\x20stop\x20bot(s)\x0a','Error\x20while\x20deleting\x20config\x20files:\x20','/logs\x20-\x20receive\x20log\x20files\x0a','Yes','-----------------------------------------------------------------------------------','Invalid\x20authentication\x20token\x20(2)','=>\x20Go\x20to\x20#CYA#http://','telegraf','output-001.log','warning','No\x20bots\x20running\x20right\x20now','telegramIpApproval','mtime','success','3884PasUEG','message','launch','keys','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','notification','botname','30\x20min','new-disabled','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots',')\x20|\x20Bot\x20','Telegram\x20error:','NTBA_FIX_319','search','\x1b[0m','stringify','updatebotmanager','post','replace','handshake','add','tkn','config_all','5851747aUpzOO','15\x20min','logs','status\x20code\x20401','4836426TvcNHk','simple','Setting\x20access:\x20','version','Restarting\x20','storeFiat','All\x20bots','Enabled\x20','Error\x20details:','Deleted\x20Bot\x20','1757184jIsdZA','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','getDate','connection','existsSync','express-fileupload','Restore\x20process\x20aborted','confirm-message','login\x20not\x20required','staging','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','--------------------------------------','bcryptjs',')\x20\x20\x20|\x20Bot\x20','connected','type','store-headless','inherit','generateKeyPair','Restore\x20backup\x20file\x20','logout','sign','bb/','order','user','reinstall','new','version.json','/start','-events.json','/backup\x20-\x20receive\x20backup\x20files\x0a','tempaccess_reject_','inlineKeyboard','portfolio_','enabled','backup/','startsWith','temp/','conn','Unauthorized\x20attempt\x20to\x20get\x20portfolio',':\x20Bot\x20Mgr\x20>\x20','mode','file','store','messages','::ffff:7f00:1','generateAsync','0.0.0','Restoring\x20bot(s)\x20from\x20backup','https://api.ipify.org?format=json','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','/:bot/performance','HTML','emit','bbvNew','sort','/disable\x20-\x20disable\x20notifications\x0a','Allow\x20login\x20from\x20IP\x20address\x20','index.html','\x1b[34m','72KvDfLo','restore_yes_','slice','<b>Telegram\x20Bot\x20Status:</b>\x0a','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','get-messages','readdirSync','remoteAddress','lastmsgemitted','secret','apiPassword','bb-config.json','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','/restart\x20-\x20restart\x20bot(s)\x0a','telegrammsg','exchange','Failed\x20to\x20download\x20','SIGINT','config_alerts','\x20(1)','value','Password\x20reset\x20rejected','running','defaults','exp','telegramUsername','All\x20bots\x20running\x20right\x20now','toIPv4Address','all','Error:\x20Invalid\x20argument\x20','sockets','toggle_','manual','2FA\x20required','jszip','SIGTERM','login\x20token\x20generated','alerts'];_0x3280=function(){return _0x397e47;};return _0x3280();}function initializeSocketBotManager(_0x105309){const _0x34fcdd=_0x433ce9,_0x5e88c6=getClient(_0x105309['id'])[_0x34fcdd(0x34b)];_0x105309[_0x34fcdd(0x1ff)](_0x34fcdd(0x31d),config),_0x105309[_0x34fcdd(0x1ff)](_0x34fcdd(0x233),cleanSettings()),_0x105309['on'](_0x34fcdd(0x245),_0x4162b6=>{const _0x41ef79=_0x34fcdd;if(validateAccess(_0x4162b6,_0x5e88c6)[_0x41ef79(0x2fd)])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x105309['on']('update-bot',(_0x304240,_0x1d8b71)=>{const _0x28e538=_0x34fcdd;if(validateAccess(_0x1d8b71,_0x5e88c6)[_0x28e538(0x2fd)])toggleBot(_0x304240[_0x28e538(0x3a8)],_0x304240[_0x28e538(0x367)],_0x304240[_0x28e538(0x37c)]);else logger[_0x28e538(0x3a6)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x105309['on'](_0x34fcdd(0x350),(_0x1df932,_0x24647c)=>{const _0x462678=_0x34fcdd;if(validateAccess(_0x24647c,_0x5e88c6)[_0x462678(0x2fd)])toggleBotMode(_0x1df932);else logger[_0x462678(0x3a6)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x105309['on']('delete-bot',(_0x21cefd,_0xd7728d)=>{const _0x65f6e9=_0x34fcdd;if(validateAccess(_0xd7728d,_0x5e88c6)[_0x65f6e9(0x2fd)])deleteBot(_0x21cefd);else logger['full'](_0x65f6e9(0x304));}),_0x105309['on']('store-settings',(_0x311a7c,_0x4316a8)=>{const _0x3ecf8a=_0x34fcdd;if(validateAccess(_0x4316a8,_0x5e88c6)[_0x3ecf8a(0x2fd)])storeSettings(_0x311a7c,!![]);else logger[_0x3ecf8a(0x3a6)](_0x3ecf8a(0x368));}),_0x105309['on'](_0x34fcdd(0x2ed),_0x18aeb0=>{const _0x303305=_0x34fcdd;if(validateAccess(_0x18aeb0,_0x5e88c6)['allow'])updateBB(_0x303305(0x2d6));else logger[_0x303305(0x3a6)](_0x303305(0x2b7));}),_0x105309['on'](_0x34fcdd(0x364),_0x2ab57c=>{const _0x3b8700=_0x34fcdd;if(validateAccess(_0x2ab57c,_0x5e88c6)[_0x3b8700(0x2fd)])updateBB('reinstall');else logger[_0x3b8700(0x3a6)](_0x3b8700(0x241));}),_0x105309['on'](_0x34fcdd(0x279),_0x26856f=>{const _0x8439d4=_0x34fcdd;if(validateAccess(_0x26856f,_0x5e88c6)[_0x8439d4(0x2fd)]){const _0x421dcc=getClient(_0x105309['id']);if(_0x421dcc)getBackupFiles(_0x421dcc['uuid']);else logger[_0x8439d4(0x3a6)](_0x8439d4(0x330));}else logger['full'](_0x8439d4(0x357));}),_0x105309['on'](_0x34fcdd(0x35b),(_0x2630b1,_0x4a227e)=>{const _0x170795=_0x34fcdd;if(validateAccess(_0x4a227e,_0x5e88c6)[_0x170795(0x2fd)])restoreBackupFile(_0x2630b1);else logger[_0x170795(0x3a6)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x105309['on'](_0x34fcdd(0x20b),_0x18628b=>{const _0x474e36=_0x34fcdd;if(validateAccess(_0x18628b,_0x5e88c6)[_0x474e36(0x2fd)])getMessages();else logger[_0x474e36(0x3a6)](_0x474e36(0x26f));}),_0x105309['on'](_0x34fcdd(0x3ef),(_0x16edb1,_0x48f0d9)=>{const _0x342124=_0x34fcdd;if(validateAccess(_0x48f0d9,_0x5e88c6)[_0x342124(0x2fd)])confirmMessage(_0x16edb1);else logger[_0x342124(0x3a6)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x105309['on']('logout',_0x5d04c7=>{const _0x21bd55=_0x34fcdd;if(validateAccess(_0x5d04c7,_0x5e88c6)[_0x21bd55(0x2fd)]){if(devices[_0x5e88c6]['pidRefreshToken'])clearTimeout(devices[_0x5e88c6]['pidRefreshToken']);if(devices[_0x5e88c6]['pidExpireLogin'])clearTimeout(devices[_0x5e88c6][_0x21bd55(0x2f5)]);removeSocketListeners(getClient(_0x105309['id'])[_0x21bd55(0x34b)]),addBlacklist(_0x5e88c6),devices[_0x5e88c6][_0x21bd55(0x3c0)]=null,devices[_0x5e88c6][_0x21bd55(0x2f6)]=null,devices[_0x5e88c6][_0x21bd55(0x2df)][_0x21bd55(0x39a)]=null,logger[_0x21bd55(0x26e)](_0x21bd55(0x28a)+_0x5e88c6[_0x21bd55(0x208)](-0x8)),io['to'](getClient(_0x105309['id'])[_0x21bd55(0x34b)])[_0x21bd55(0x1ff)](_0x21bd55(0x367),{'access':{'allow':![],'reason':_0x21bd55(0x36a),'token':null}});}else logger[_0x21bd55(0x3a6)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x1a4548){const _0x4d14eb=_0x433ce9,_0x3df54a=getClient(_0x1a4548['id'])[_0x4d14eb(0x23a)],_0x3eebe7=getClient(_0x1a4548['id'])[_0x4d14eb(0x34b)];_0x1a4548['on'](_0x4d14eb(0x27b),(_0x3ffaae,_0x3eb2cb)=>{const _0x455bb4=_0x4d14eb;if(validateAccess(_0x3eb2cb,_0x3eebe7)['allow']){if(pid[_0x3df54a])pid[_0x3df54a]['send']({'function':_0x455bb4(0x2bb),'args':_0x3ffaae});}else logger[_0x455bb4(0x3a6)](_0x455bb4(0x2cd));}),_0x1a4548['on'](_0x4d14eb(0x32f),(_0x115bd7,_0x2b05f9)=>{const _0x2e9572=_0x4d14eb;if(validateAccess(_0x2b05f9,_0x3eebe7)['allow']){if(pid[_0x3df54a])pid[_0x3df54a][_0x2e9572(0x37d)]({'function':'deleteHistoryAlerts','args':_0x115bd7});}else logger[_0x2e9572(0x3a6)](_0x2e9572(0x37f));}),_0x1a4548['on'](_0x4d14eb(0x388),(_0x2b4fc4,_0x480660)=>{const _0x50bfaa=_0x4d14eb;if(validateAccess(_0x480660,_0x3eebe7)[_0x50bfaa(0x2fd)]){if(pid[_0x3df54a])pid[_0x3df54a][_0x50bfaa(0x37d)]({'function':'getPortfolio','args':_0x2b4fc4});}else logger[_0x50bfaa(0x3a6)](_0x50bfaa(0x1f1));}),_0x1a4548['on'](_0x4d14eb(0x30d),(_0x3a7036,_0x26880a)=>{const _0x24b034=_0x4d14eb;if(validateAccess(_0x26880a,_0x3eebe7)['allow']){if(pid[_0x3df54a])pid[_0x3df54a]['send']({'function':_0x24b034(0x2c5),'args':_0x3a7036});}else logger[_0x24b034(0x3a6)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x1a4548['on'](_0x4d14eb(0x3f8),(_0x48057e,_0x42aaad)=>{const _0x597121=_0x4d14eb;if(validateAccess(_0x42aaad,_0x3eebe7)['allow']){if(pid[_0x3df54a])pid[_0x3df54a][_0x597121(0x37d)]({'function':_0x597121(0x29e),'args':_0x48057e});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x1a4548['on']('store-fiat',(_0x564df3,_0x301377)=>{const _0x142017=_0x4d14eb;if(validateAccess(_0x301377,_0x3eebe7)[_0x142017(0x2fd)]){if(pid[_0x3df54a])pid[_0x3df54a][_0x142017(0x37d)]({'function':_0x142017(0x3e3),'args':_0x564df3});}else logger[_0x142017(0x3a6)](_0x142017(0x2b6));}),_0x1a4548['on'](_0x4d14eb(0x38c),_0x72e29a=>{const _0x34065e=_0x4d14eb;if(validateAccess(_0x72e29a,_0x3eebe7)[_0x34065e(0x2fd)]){if(pid[_0x3df54a])pid[_0x3df54a]['send']({'function':_0x34065e(0x27a),'args':null});}else logger[_0x34065e(0x3a6)](_0x34065e(0x326));}),_0x1a4548['on']('get-starting-balances',_0x29ef58=>{const _0x531997=_0x4d14eb;if(validateAccess(_0x29ef58,_0x3eebe7)[_0x531997(0x2fd)]){if(pid[_0x3df54a])pid[_0x3df54a][_0x531997(0x37d)]({'function':'getStartingBalances','args':null});}else logger[_0x531997(0x3a6)](_0x531997(0x342));}),_0x1a4548['on'](_0x4d14eb(0x2da),(_0x40efdb,_0x284db4)=>{const _0x3c4f68=_0x4d14eb;if(validateAccess(_0x284db4,_0x3eebe7)[_0x3c4f68(0x2fd)]){if(pid[_0x3df54a])pid[_0x3df54a][_0x3c4f68(0x37d)]({'function':_0x3c4f68(0x24e),'args':_0x40efdb});}else logger[_0x3c4f68(0x3a6)](_0x3c4f68(0x384));}),_0x1a4548['on'](_0x4d14eb(0x28d),_0x1910a1=>{const _0x489314=_0x4d14eb;if(validateAccess(_0x1910a1,_0x3eebe7)[_0x489314(0x2fd)]){if(pid[_0x3df54a])pid[_0x3df54a]['send']({'function':_0x489314(0x267),'args':null});}else logger['full'](_0x489314(0x3e9));}),_0x1a4548['on']('show-config',_0x55c7f2=>{const _0x78fc45=_0x4d14eb;if(validateAccess(_0x55c7f2,_0x3eebe7)[_0x78fc45(0x2fd)]){if(pid[_0x3df54a])pid[_0x3df54a][_0x78fc45(0x37d)]({'function':_0x78fc45(0x2ec),'args':null});}else logger[_0x78fc45(0x3a6)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x1a4548['on'](_0x4d14eb(0x2ed),_0x5a7d5c=>{const _0x1e01b9=_0x4d14eb;if(validateAccess(_0x5a7d5c,_0x3eebe7)['allow'])updateBB('update');else logger[_0x1e01b9(0x3a6)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x1a4548['on'](_0x4d14eb(0x20b),_0x2464ae=>{const _0x2316c5=_0x4d14eb;if(validateAccess(_0x2464ae,_0x3eebe7)[_0x2316c5(0x2fd)])getMessages();else logger[_0x2316c5(0x3a6)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1a4548['on'](_0x4d14eb(0x3ef),(_0x5b9d7b,_0x8131ce)=>{const _0x11fd4f=_0x4d14eb;if(validateAccess(_0x8131ce,_0x3eebe7)['allow'])confirmMessage(_0x5b9d7b);else logger[_0x11fd4f(0x3a6)](_0x11fd4f(0x31e));}),_0x1a4548['on'](_0x4d14eb(0x3fc),_0x59d890=>{const _0x4191bf=_0x4d14eb;if(validateAccess(_0x59d890,_0x3eebe7)['allow']){if(devices[_0x3eebe7][_0x4191bf(0x2c1)])clearTimeout(devices[_0x3eebe7]['pidRefreshToken']);if(devices[_0x3eebe7][_0x4191bf(0x2f5)])clearTimeout(devices[_0x3eebe7][_0x4191bf(0x2f5)]);removeSocketListeners(getClient(_0x1a4548['id'])[_0x4191bf(0x34b)]),addBlacklist(_0x3eebe7),devices[_0x3eebe7][_0x4191bf(0x3c0)]=null,devices[_0x3eebe7][_0x4191bf(0x2f6)]=null,devices[_0x3eebe7][_0x4191bf(0x2df)][_0x4191bf(0x39a)]=null,logger['debug'](_0x4191bf(0x28a)+_0x3eebe7['slice'](-0x8)),io['to'](getClient(_0x1a4548['id'])['uuid'])[_0x4191bf(0x1ff)]('status',{'access':{'allow':![],'reason':_0x4191bf(0x36a),'token':null}});}else logger['full'](_0x4191bf(0x327));});}function removeSocketListeners(_0xd7d3e4){const _0x4ebf48=_0x433ce9;getClientsWithUuid(_0xd7d3e4)[_0x4ebf48(0x302)](_0x21bcb0=>{const _0x15e12a=_0x4ebf48;getSocket(_0x21bcb0['id'])[_0x15e12a(0x369)]();});}function cleanSettings(){const _0x2c0b59=_0x433ce9;let _0x336d9f=settings;return settings['telegramToken']&&settings[_0x2c0b59(0x310)]!=''&&(_0x336d9f={..._0x336d9f,'telegramToken':_0x2c0b59(0x2a6)}),settings['bbPassword']&&settings[_0x2c0b59(0x26d)]!=''&&(_0x336d9f={..._0x336d9f,'bbPassword':_0x2c0b59(0x2a6)}),settings['marketcapApi']&&settings['marketcapApi']!=''&&(_0x336d9f={..._0x336d9f,'marketcapApi':_0x2c0b59(0x2a6)}),(settings[_0x2c0b59(0x26d)]&&settings[_0x2c0b59(0x26d)]==_0x2c0b59(0x284)||settings[_0x2c0b59(0x310)]&&settings[_0x2c0b59(0x310)]==_0x2c0b59(0x284)||settings[_0x2c0b59(0x318)]&&settings[_0x2c0b59(0x318)]==_0x2c0b59(0x284))&&(_0x336d9f={..._0x336d9f,'restored':{'password':settings[_0x2c0b59(0x26d)]==_0x2c0b59(0x284),'telegram':settings[_0x2c0b59(0x310)]=='***','marketcap':settings['marketcapApi']==_0x2c0b59(0x284)}}),_0x336d9f;}async function updateBB(_0x1af4e5){const _0x20ff4e=_0x433ce9;await backupConfigFiles(),installingUpdate=!![],config[_0x20ff4e(0x302)](_0x2f028c=>{restartBot(_0x2f028c['botID']);});if(_0x1af4e5==_0x20ff4e(0x2d6))process[_0x20ff4e(0x37d)]({'update':!![],'environment':environment},_0x1a048b=>{});else _0x1af4e5==_0x20ff4e(0x401)&&process[_0x20ff4e(0x37d)]({'reinstall':!![],'environment':environment},_0x2b8511=>{});}function startBot(_0x56b732,_0x5d63b1,_0x4f483c){const _0x375e74=_0x433ce9;if(debugging)_0x56b732[_0x375e74(0x230)]('-d');if(recreate)_0x56b732[_0x375e74(0x230)]('-r');let _0x587ae7=![];const _0x1c06de=_0x56b732[0x0];_0x5d63b1={..._0x5d63b1,'stdio':['inherit',_0x375e74(0x3f9),_0x375e74(0x3f9),_0x375e74(0x2a2)]},pid[_0x1c06de]=childProcess[_0x375e74(0x2a4)](botfile,_0x56b732,_0x5d63b1),pid[_0x1c06de]['on'](_0x375e74(0x3c4),_0x1947d5=>{const _0x3cc7c2=_0x375e74;switch(Object[_0x3cc7c2(0x3c6)](_0x1947d5)[0x0]){case _0x3cc7c2(0x3c9):updateBotName(_0x1c06de,_0x1947d5['botname']);break;case _0x3cc7c2(0x3d3):updateBotManager();break;case'status':updateStatus(_0x1c06de,_0x1947d5[_0x3cc7c2(0x367)]);break;case _0x3cc7c2(0x37c):updateLive(_0x1c06de,_0x1947d5[_0x3cc7c2(0x37c)]);break;case _0x3cc7c2(0x2b9):updateLive(_0x1c06de,_0x1947d5[_0x3cc7c2(0x2b9)]),io['to'](_0x1c06de)[_0x3cc7c2(0x1ff)](_0x3cc7c2(0x367),{'access':{'allow':![],'reason':_0x3cc7c2(0x2a5),'token':null}});break;case'stop':_0x1947d5[_0x3cc7c2(0x246)]==_0x3cc7c2(0x333)&&restartBot(_0x1c06de);_0x1947d5['stop']=='kill'&&toggleBot(_0x1c06de,'disabled',_0x3cc7c2(0x2f1));break;case'telegram':sendTelegramBot(_0x1c06de,_0x1947d5[_0x3cc7c2(0x2aa)]);break;case _0x3cc7c2(0x214):sendTelegramMsg(_0x1947d5['telegrammsg']);break;case'function':io['to'](_0x1c06de)[_0x3cc7c2(0x1ff)](_0x1947d5[_0x3cc7c2(0x237)],_0x1947d5['args']);break;}}),pid[_0x1c06de]['on'](_0x375e74(0x2b3),function(_0x3a8aa2){if(_0x587ae7)return;_0x587ae7=!![],_0x4f483c(_0x3a8aa2);}),pid[_0x1c06de]['on'](_0x375e74(0x31f),async function(_0x8c1d6c){const _0x58c2bb=_0x375e74;if(terminating)return;if(installingUpdate){io[_0x58c2bb(0x2dc)]();return;}if(_0x587ae7)return;_0x587ae7=!![],_0x4f483c(null);const _0x27d7ab=dbConfig[_0x58c2bb(0x261)](_0x58c2bb(0x31d))[_0x58c2bb(0x339)]({'botID':_0x1c06de})['value']();_0x27d7ab&&(_0x27d7ab[_0x58c2bb(0x367)]=='enabled'||_0x27d7ab['status']==_0x58c2bb(0x402))&&(await sleep(0x3e8),updateLive(_0x1c06de,_0x58c2bb(0x2f1)),logger[_0x58c2bb(0x3a6)](_0x58c2bb(0x3e2)+botRef(_0x1c06de)),startBot([_0x1c06de,userID],{'cwd':bbpath},function(_0x3cc29c){if(_0x3cc29c)logger['full'](_0x3cc29c);}));});}function stopBot(_0x31c14d){getClientsWithBotID(_0x31c14d)['forEach'](_0x2636e0=>{getSocket(_0x2636e0['id'])['disconnect'](!![]),removeClient(_0x2636e0['id']);}),pid[_0x31c14d]&&(pid[_0x31c14d]['kill'](),pid[_0x31c14d]=null);}function stopAllBots(){const _0x48be14=_0x433ce9;terminating=!![];const _0x3d3818=getEnabledBots();_0x3d3818[_0x48be14(0x302)](_0x253620=>{const _0x1c030b=_0x48be14;stopBot(_0x253620[_0x1c030b(0x3a8)]);});}function restartBot(_0x4f1f0d){if(pid[_0x4f1f0d])pid[_0x4f1f0d]['kill']();}function addBot(){const _0x5ec58a=_0x433ce9;let _0x29c20a;for(let _0x449688=0x1;_0x449688<0x3e9;_0x449688++){_0x29c20a=_0x449688[_0x5ec58a(0x286)]()[_0x5ec58a(0x398)](0x3,'0');let _0x48ad71=config['find'](_0x4fe81b=>_0x4fe81b['botID']==_0x29c20a);if(!_0x48ad71)break;}if(_0x29c20a===_0x5ec58a(0x244)){logger[_0x5ec58a(0x3a6)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x5ec58a(0x3a6)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x29c20a),dbConfig[_0x5ec58a(0x261)](_0x5ec58a(0x31d))[_0x5ec58a(0x230)]({'botID':_0x29c20a,'botname':'Bot\x20'+_0x29c20a,'status':_0x5ec58a(0x402),'live':''})[_0x5ec58a(0x348)](),startBot([_0x29c20a,userID],{'cwd':bbpath},function(_0x54fc9e){const _0x252919=_0x5ec58a;if(_0x54fc9e)logger[_0x252919(0x3a6)](_0x54fc9e);}),config=getConfiguration(),io['to'](_0x5ec58a(0x22d))[_0x5ec58a(0x1ff)]('bots',config),broadcastToBots('bots',JSON[_0x5ec58a(0x3d2)](config));}function deleteBot(_0x2a8df8){const _0x557b13=_0x433ce9;getClientsWithBotID(_0x2a8df8)['forEach'](_0xbdc708=>{const _0x591145=_0x2499;getSocket(_0xbdc708['id'])[_0x591145(0x243)](!![]),removeClient(_0xbdc708['id']);}),dbConfig[_0x557b13(0x261)](_0x557b13(0x31d))[_0x557b13(0x2f3)]({'botID':_0x2a8df8})[_0x557b13(0x348)](),logger[_0x557b13(0x3a6)](_0x557b13(0x3e7)+_0x2a8df8),stopBot(_0x2a8df8);try{if(fs[_0x557b13(0x3ec)](path[_0x557b13(0x2d4)](configpath,_0x557b13(0x283)+_0x2a8df8+_0x557b13(0x29b))))fs[_0x557b13(0x2e3)](path[_0x557b13(0x2d4)](configpath,_0x557b13(0x283)+_0x2a8df8+_0x557b13(0x29b)));if(fs[_0x557b13(0x3ec)](path['join'](configpath,'bot-'+_0x2a8df8+_0x557b13(0x405))))fs[_0x557b13(0x2e3)](path[_0x557b13(0x2d4)](configpath,_0x557b13(0x283)+_0x2a8df8+_0x557b13(0x405)));if(fs[_0x557b13(0x3ec)](path['join'](configpath,'bot-'+_0x2a8df8+'-performance.json')))fs[_0x557b13(0x2e3)](path[_0x557b13(0x2d4)](configpath,_0x557b13(0x283)+_0x2a8df8+_0x557b13(0x361)));if(fs[_0x557b13(0x3ec)](path[_0x557b13(0x2d4)](configpath,'bot-'+_0x2a8df8+'-results.json')))fs[_0x557b13(0x2e3)](path[_0x557b13(0x2d4)](configpath,_0x557b13(0x283)+_0x2a8df8+'-results.json'));}catch(_0x1d0fd8){if(_0x1d0fd8)logger['full'](_0x557b13(0x3b6),_0x1d0fd8);}config=getConfiguration(),io['to'](_0x557b13(0x22d))['emit']('bots',config),broadcastToBots(_0x557b13(0x31d),JSON[_0x557b13(0x3d2)](config));}function toggleBot(_0x58379d,_0x1f56f6,_0x484943){const _0x453f4b=_0x433ce9;dbConfig[_0x453f4b(0x261)]('bots')['find']({'botID':_0x58379d})[_0x453f4b(0x272)]({'status':_0x1f56f6})[_0x453f4b(0x272)]({'live':_0x484943})[_0x453f4b(0x348)]();const _0x5f54d2=botRef(_0x58379d);if(_0x1f56f6==_0x453f4b(0x40a)||_0x1f56f6==_0x453f4b(0x402))logger['full'](_0x453f4b(0x3e5)+_0x5f54d2),startBot([_0x58379d,userID],{'cwd':bbpath},function(_0x391f44){const _0x28f143=_0x453f4b;if(_0x391f44)logger[_0x28f143(0x3a6)](_0x391f44);});else(_0x1f56f6==_0x453f4b(0x2e5)||_0x1f56f6==_0x453f4b(0x3cb))&&(logger['full'](_0x453f4b(0x35d)+_0x5f54d2),stopBot(_0x58379d));config=getConfiguration(),io['to'](_0x453f4b(0x22d))[_0x453f4b(0x1ff)](_0x453f4b(0x31d),config),broadcastToBots(_0x453f4b(0x31d),JSON[_0x453f4b(0x3d2)](config));}function toggleStatus(_0x4980c9){const _0x1e3750=_0x433ce9;let _0x28604f=dbConfig[_0x1e3750(0x261)](_0x1e3750(0x31d))[_0x1e3750(0x339)]({'botID':_0x4980c9})[_0x1e3750(0x21a)](),_0x399efd;if(_0x28604f[_0x1e3750(0x367)]===_0x1e3750(0x40a))_0x399efd=_0x1e3750(0x2e5);else{if(_0x28604f[_0x1e3750(0x367)]===_0x1e3750(0x402))_0x399efd=_0x1e3750(0x3cb);else{if(_0x28604f['status']===_0x1e3750(0x3cb))_0x399efd='new';else{if(_0x28604f[_0x1e3750(0x367)]===_0x1e3750(0x2e5))_0x399efd='enabled';}}}return _0x399efd;}function updateStatus(_0x8cf2e5,_0xc15a30){const _0x490017=_0x433ce9;dbConfig[_0x490017(0x261)]('bots')[_0x490017(0x339)]({'botID':_0x8cf2e5})[_0x490017(0x272)]({'status':_0xc15a30})[_0x490017(0x348)](),config=getConfiguration(),io['to']('botmanager')[_0x490017(0x1ff)](_0x490017(0x31d),config),broadcastToBots(_0x490017(0x31d),JSON[_0x490017(0x3d2)](config));}function updateLive(_0x3313c2,_0x3660ed){const _0x24d55f=_0x433ce9;dbConfig[_0x24d55f(0x261)](_0x24d55f(0x31d))[_0x24d55f(0x339)]({'botID':_0x3313c2})['assign']({'live':_0x3660ed})[_0x24d55f(0x348)](),config=getConfiguration(),io['to'](_0x24d55f(0x22d))['emit'](_0x24d55f(0x31d),config),broadcastToBots(_0x24d55f(0x31d),JSON['stringify'](config));}function updateBotName(_0x454313,_0x3be577){const _0xd2a945=_0x433ce9;dbConfig[_0xd2a945(0x261)](_0xd2a945(0x31d))[_0xd2a945(0x339)]({'botID':_0x454313})[_0xd2a945(0x272)]({'botname':_0x3be577})[_0xd2a945(0x348)](),config=getConfiguration(),io['to'](_0xd2a945(0x22d))[_0xd2a945(0x1ff)](_0xd2a945(0x31d),config),broadcastToBots(_0xd2a945(0x31d),JSON[_0xd2a945(0x3d2)](config));}function updateBotManager(){const _0x5100d0=_0x433ce9;config=getConfiguration(),io['to']('botmanager')[_0x5100d0(0x1ff)](_0x5100d0(0x31d),config),broadcastToBots(_0x5100d0(0x31d),JSON[_0x5100d0(0x3d2)](config));}function toggleBotMode(_0x161778){const _0x5922b0=_0x433ce9;if(pid[_0x161778])pid[_0x161778]['send']({'function':'toggleBotMode','args':null});else{const _0x3e717a=configpath+_0x5922b0(0x283)+_0x161778+_0x5922b0(0x29b),_0x31e994=fs[_0x5922b0(0x240)](_0x3e717a),_0x1a096c=JSON[_0x5922b0(0x32a)](_0x31e994),_0x1a525b=_0x1a096c[_0x5922b0(0x23a)][0x0]['headless'];_0x1a096c[_0x5922b0(0x23a)][0x0]['headless']=!_0x1a525b;const _0x57bfa5=JSON['stringify'](_0x1a096c,null,0x2);fs[_0x5922b0(0x391)](_0x3e717a,_0x57bfa5),config=getConfiguration(),io['to'](_0x5922b0(0x22d))[_0x5922b0(0x1ff)](_0x5922b0(0x31d),config),broadcastToBots(_0x5922b0(0x31d),JSON['stringify'](config));}}function validateTelegram(_0x2fe1d3){const _0x4dbef3=_0x433ce9;if(_0x2fe1d3[_0x4dbef3(0x313)]['username']!=settings[_0x4dbef3(0x21f)]&&'@'+_0x2fe1d3[_0x4dbef3(0x313)]['username']!=settings[_0x4dbef3(0x21f)]||_0x2fe1d3[_0x4dbef3(0x23e)]['id']!=settings[_0x4dbef3(0x35e)])return sendTelegram(_0x2fe1d3[_0x4dbef3(0x23e)]['id'],_0x4dbef3(0x251),{'parse_mode':'HTML'}),![];return!![];}function botRef(_0x2c8fdb){const _0x57874f=_0x433ce9,_0x161a04=getBotAttributes(_0x2c8fdb),_0x23a521=_0x161a04[_0x57874f(0x349)]?_0x161a04[_0x57874f(0x3c9)]:'Bot\x20'+_0x2c8fdb;return _0x23a521;}async function initTelegram(){const _0x1c71a8=_0x433ce9;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x1c71a8(0x310)]);let _0x7827b4=_0x1c71a8(0x334);_0x7827b4+='\x0a',_0x7827b4+=_0x1c71a8(0x265),_0x7827b4+=_0x1c71a8(0x202),_0x7827b4+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x7827b4+=_0x1c71a8(0x213),_0x7827b4+=_0x1c71a8(0x254),_0x7827b4+=_0x1c71a8(0x3b5),_0x7827b4+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x7827b4+=_0x1c71a8(0x36e),_0x7827b4+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x7827b4+=_0x1c71a8(0x39e),_0x7827b4+=_0x1c71a8(0x3b0),_0x7827b4+=_0x1c71a8(0x3b7),_0x7827b4+=_0x1c71a8(0x406),_0x7827b4+=_0x1c71a8(0x25f),_0x7827b4+=_0x1c71a8(0x23d),_0x7827b4+=_0x1c71a8(0x282);let _0x5315ca=_0x1c71a8(0x32d);_0x5315ca+='\x0a',_0x5315ca+=_0x7827b4,tgBot[_0x1c71a8(0x33d)]((_0x5b5878,_0x4504a7)=>{const _0x243ee4=_0x1c71a8;logger[_0x243ee4(0x3df)](getTimeStamp()+_0x243ee4(0x295)),logger[_0x243ee4(0x26e)](_0x243ee4(0x355),_0x5b5878);}),tgBot[_0x1c71a8(0x2f0)](async(_0x2e4fbc,_0x44b35e)=>{const _0x4400c6=_0x1c71a8;if(settings[_0x4400c6(0x35e)]||_0x2e4fbc[_0x4400c6(0x2d6)]['message'][_0x4400c6(0x383)]!=_0x4400c6(0x404)){if(!validateTelegram(_0x2e4fbc))return;}_0x44b35e();}),tgBot['command'](_0x1c71a8(0x294),async _0x4f1033=>{const _0x54a1ae=_0x1c71a8;if(_0x4f1033[_0x54a1ae(0x313)]['username']==settings[_0x54a1ae(0x21f)]||'@'+_0x4f1033[_0x54a1ae(0x313)][_0x54a1ae(0x255)]==settings['telegramUsername']){if(!settings[_0x54a1ae(0x35e)])updateSetting(_0x54a1ae(0x35e),_0x4f1033[_0x54a1ae(0x23e)]['id']);else{if(!validateTelegram(_0x4f1033))return;}}else{if(!validateTelegram(_0x4f1033))return;}updateSetting(_0x54a1ae(0x351),!![]),await sendTelegram(_0x4f1033[_0x54a1ae(0x23e)]['id'],_0x5315ca);}),tgBot[_0x1c71a8(0x39d)]('enable',async _0x20fd1c=>{const _0x1a9337=_0x1c71a8;updateSetting(_0x1a9337(0x351),!![]),await sendTelegram(_0x20fd1c['chat']['id'],_0x1a9337(0x239));}),tgBot[_0x1c71a8(0x39d)](_0x1c71a8(0x33c),async _0x293ee5=>{const _0x55c191=_0x1c71a8;await sendTelegram(_0x293ee5['chat']['id'],'Notifications\x20disabled'),updateSetting(_0x55c191(0x351),![]);}),tgBot[_0x1c71a8(0x39d)](_0x1c71a8(0x314),async _0x6a287e=>{const _0x42651d=_0x1c71a8,_0x56da2c=Markup[_0x42651d(0x408)]([Markup[_0x42651d(0x2e7)]['callback']('Orders','config_orders'),Markup[_0x42651d(0x2e7)]['callback'](_0x42651d(0x35a),_0x42651d(0x218)),Markup['button'][_0x42651d(0x287)](_0x42651d(0x321),_0x42651d(0x3d9))]);_0x6a287e[_0x42651d(0x320)](_0x42651d(0x353),_0x56da2c);}),tgBot[_0x1c71a8(0x2c9)](_0x1c71a8(0x3b3),async _0x58715e=>{const _0x20cee2=_0x1c71a8;_0x58715e[_0x20cee2(0x30e)](),updateSetting(_0x20cee2(0x256),_0x20cee2(0x2f9)),updateSetting(_0x20cee2(0x351),!![]),await sendTelegram(_0x58715e[_0x20cee2(0x23e)]['id'],_0x20cee2(0x3a2));}),tgBot['action'](_0x1c71a8(0x218),async _0xf56c8a=>{const _0xc32114=_0x1c71a8;_0xf56c8a[_0xc32114(0x30e)](),updateSetting(_0xc32114(0x256),_0xc32114(0x22b)),updateSetting(_0xc32114(0x351),!![]),await sendTelegram(_0xf56c8a[_0xc32114(0x23e)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x1c71a8(0x2c9)](_0x1c71a8(0x3d9),async _0x5a6d81=>{const _0x3c44e9=_0x1c71a8;_0x5a6d81[_0x3c44e9(0x30e)](),updateSetting('telegramEvents',_0x3c44e9(0x222)),updateSetting(_0x3c44e9(0x351),!![]),await sendTelegram(_0x5a6d81['chat']['id'],_0x3c44e9(0x2ac));}),tgBot['command']('status',async _0x4c83e6=>{const _0x50344d=_0x1c71a8,_0x229803=getBotsWithMode();let _0x40741d=_0x50344d(0x2a1);config[_0x50344d(0x302)](_0x5aef66=>{const _0x5aa71b=_0x50344d,_0x563bdd=_0x229803[_0x5aa71b(0x339)](_0x487a77=>_0x487a77['botID']==_0x5aef66[_0x5aa71b(0x3a8)])['mode'];_0x40741d+=_0x5aa71b(0x280)+_0x5aef66[_0x5aa71b(0x3a8)]+':\x20'+_0x5aef66[_0x5aa71b(0x367)]+_0x5aa71b(0x39f)+_0x563bdd+'\x20|\x20'+_0x5aef66[_0x5aa71b(0x37c)]+'\x0a';}),_0x40741d+='\x0a',_0x40741d+=_0x50344d(0x209),_0x40741d+=!settings[_0x50344d(0x351)]?_0x50344d(0x2a8):_0x50344d(0x316),_0x40741d+=settings['telegramEnabled']?settings[_0x50344d(0x256)]==_0x50344d(0x222)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x50344d(0x2ab)+settings[_0x50344d(0x256)]+'\x20only\x0a':'',await sendTelegram(_0x4c83e6[_0x50344d(0x23e)]['id'],_0x40741d,{'parse_mode':'HTML'});}),tgBot[_0x1c71a8(0x39d)]('restart',async _0x15a360=>{const _0x3b6eb7=_0x1c71a8,_0x579666=getEnabledBots();if(_0x579666[_0x3b6eb7(0x305)]==0x0)await sendTelegram(_0x15a360[_0x3b6eb7(0x23e)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x579666[_0x3b6eb7(0x305)]>0x1)_0x579666[_0x3b6eb7(0x230)]({'botID':'all'});let _0x14e8b5=[],_0x2a388d=[];const _0x5696ef=_0x579666[_0x3b6eb7(0x305)]%0x4==0x0||_0x579666[_0x3b6eb7(0x305)]%0x4==0x3||_0x579666[_0x3b6eb7(0x305)]%0x3==0x1?0x4:0x3;let _0x28883e=0x0;_0x579666[_0x3b6eb7(0x302)]((_0x3127fa,_0x506ae7)=>{const _0x21593c=_0x3b6eb7;if(_0x506ae7%_0x5696ef==0x0)_0x2a388d=[];_0x2a388d[_0x21593c(0x230)](Markup[_0x21593c(0x2e7)][_0x21593c(0x287)](_0x3127fa['botID']=='all'?_0x21593c(0x3e4):botRef(_0x3127fa['botID']),'restart_'+_0x3127fa[_0x21593c(0x3a8)])),_0x506ae7%_0x5696ef==0x0&&(_0x14e8b5[_0x28883e]=_0x2a388d,_0x28883e++);});const _0x17fc8a=Markup['inlineKeyboard'](_0x14e8b5);_0x15a360['reply'](_0x3b6eb7(0x2be),_0x17fc8a);}}),tgBot[_0x1c71a8(0x2c9)](/restart_(.+)/,async _0x3cb238=>{const _0x5a7555=_0x1c71a8,_0xe4b2fc=_0x3cb238[_0x5a7555(0x2e4)][0x1];_0x3cb238[_0x5a7555(0x30e)](),_0xe4b2fc==_0x5a7555(0x222)?config[_0x5a7555(0x302)](_0x1d9a6d=>{restartBot(_0x1d9a6d['botID']);}):restartBot(_0xe4b2fc);}),tgBot[_0x1c71a8(0x39d)]('on',async _0x94551d=>{const _0x25b490=_0x1c71a8,_0x47a3f1=getDisabledBots();if(_0x47a3f1[_0x25b490(0x305)]==0x0)await sendTelegram(_0x94551d[_0x25b490(0x23e)]['id'],_0x25b490(0x220));else{if(_0x47a3f1['length']>0x1)_0x47a3f1[_0x25b490(0x230)]({'botID':_0x25b490(0x222)});let _0x2b0289=[],_0x312c69=[];const _0xf2a1b1=_0x47a3f1['length']%0x4==0x0||_0x47a3f1[_0x25b490(0x305)]%0x4==0x3||_0x47a3f1['length']%0x3==0x1?0x4:0x3;let _0x297aae=0x0;_0x47a3f1[_0x25b490(0x302)]((_0x2dbeee,_0x2d6a1a)=>{const _0x526fd2=_0x25b490;if(_0x2d6a1a%_0xf2a1b1==0x0)_0x312c69=[];_0x312c69[_0x526fd2(0x230)](Markup['button'][_0x526fd2(0x287)](_0x2dbeee[_0x526fd2(0x3a8)]==_0x526fd2(0x222)?_0x526fd2(0x3e4):botRef(_0x2dbeee[_0x526fd2(0x3a8)]),'on_'+_0x2dbeee[_0x526fd2(0x3a8)])),_0x2d6a1a%_0xf2a1b1==0x0&&(_0x2b0289[_0x297aae]=_0x312c69,_0x297aae++);});const _0x1c1767=Markup[_0x25b490(0x408)](_0x2b0289);_0x94551d['reply'](_0x25b490(0x270),_0x1c1767);}}),tgBot[_0x1c71a8(0x2c9)](/on_(.+)/,async _0x4de099=>{const _0xba0a1a=_0x1c71a8,_0x464cff=_0x4de099['match'][0x1];_0x4de099[_0xba0a1a(0x30e)]();if(_0x464cff==_0xba0a1a(0x222)){const _0x25e3ee=getDisabledBots();await sendTelegram(_0x4de099[_0xba0a1a(0x23e)]['id'],'Bot\x20Mgr\x20>\x20Starting\x20all\x20bots'),_0x25e3ee[_0xba0a1a(0x302)](_0x154b4b=>{const _0x1b2925=_0xba0a1a;if(_0x154b4b[_0x1b2925(0x3a8)]!=_0x1b2925(0x222))toggleBot(_0x154b4b[_0x1b2925(0x3a8)],toggleStatus(_0x154b4b['botID']),'stopped');});}else await sendTelegram(_0x4de099[_0xba0a1a(0x23e)]['id'],_0xba0a1a(0x24b)+botRef(_0x464cff)),toggleBot(_0x464cff,toggleStatus(_0x464cff),'stopped');}),tgBot[_0x1c71a8(0x39d)]('off',async _0x463d7a=>{const _0x913e42=_0x1c71a8,_0x55342c=getEnabledBots();if(_0x55342c[_0x913e42(0x305)]==0x0)await sendTelegram(_0x463d7a[_0x913e42(0x23e)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x55342c[_0x913e42(0x305)]>0x1)_0x55342c['push']({'botID':_0x913e42(0x222)});let _0x56b4dc=[],_0x5368bb=[];const _0x348dc5=_0x55342c[_0x913e42(0x305)]%0x4==0x0||_0x55342c[_0x913e42(0x305)]%0x4==0x3||_0x55342c[_0x913e42(0x305)]%0x3==0x1?0x4:0x3;let _0x362ab6=0x0;_0x55342c[_0x913e42(0x302)]((_0x4232ff,_0x5de714)=>{const _0x22c4b6=_0x913e42;if(_0x5de714%_0x348dc5==0x0)_0x5368bb=[];_0x5368bb[_0x22c4b6(0x230)](Markup[_0x22c4b6(0x2e7)][_0x22c4b6(0x287)](_0x4232ff[_0x22c4b6(0x3a8)]=='all'?'All\x20bots':botRef(_0x4232ff['botID']),_0x22c4b6(0x34e)+_0x4232ff[_0x22c4b6(0x3a8)])),_0x5de714%_0x348dc5==0x0&&(_0x56b4dc[_0x362ab6]=_0x5368bb,_0x362ab6++);});const _0x3f6e5f=Markup[_0x913e42(0x408)](_0x56b4dc);_0x463d7a[_0x913e42(0x320)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x3f6e5f);}}),tgBot['action'](/off_(.+)/,async _0x443ddb=>{const _0x536597=_0x1c71a8,_0x4cd6bc=_0x443ddb[_0x536597(0x2e4)][0x1];_0x443ddb[_0x536597(0x30e)]();if(_0x4cd6bc=='all'){const _0x1d8e8f=getEnabledBots();await sendTelegram(_0x443ddb[_0x536597(0x23e)]['id'],_0x536597(0x3cc)),_0x1d8e8f[_0x536597(0x302)](_0x4c1bf3=>{const _0x4ef690=_0x536597;if(_0x4c1bf3['botID']!=_0x4ef690(0x222))toggleBot(_0x4c1bf3[_0x4ef690(0x3a8)],toggleStatus(_0x4c1bf3[_0x4ef690(0x3a8)]),'stopped');});}else await sendTelegram(_0x443ddb[_0x536597(0x23e)]['id'],_0x536597(0x2e6)+botRef(_0x4cd6bc)),toggleBot(_0x4cd6bc,toggleStatus(_0x4cd6bc),_0x536597(0x2f1));}),tgBot[_0x1c71a8(0x39d)](_0x1c71a8(0x269),async _0x514224=>{const _0x4c1b54=_0x1c71a8,_0xe95e4e=getEnabledBots();if(_0xe95e4e['length']==0x0)await sendTelegram(_0x514224[_0x4c1b54(0x23e)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0xe95e4e[_0x4c1b54(0x305)]>0x1){let _0x41e9bf=[],_0x4c0ca5=[];const _0xe12003=_0xe95e4e['length']%0x4==0x0||_0xe95e4e[_0x4c1b54(0x305)]%0x4==0x3||_0xe95e4e[_0x4c1b54(0x305)]%0x3==0x1?0x4:0x3;let _0x28206c=0x0;_0xe95e4e[_0x4c1b54(0x302)]((_0x15c394,_0x78ac2d)=>{const _0x52570e=_0x4c1b54;if(_0x78ac2d%_0xe12003==0x0)_0x4c0ca5=[];_0x4c0ca5[_0x52570e(0x230)](Markup[_0x52570e(0x2e7)]['callback'](botRef(_0x15c394[_0x52570e(0x3a8)]),_0x52570e(0x319)+_0x15c394[_0x52570e(0x3a8)])),_0x78ac2d%_0xe12003==0x0&&(_0x41e9bf[_0x28206c]=_0x4c0ca5,_0x28206c++);});const _0xa562e8=Markup[_0x4c1b54(0x408)](_0x41e9bf);_0x514224[_0x4c1b54(0x320)](_0x4c1b54(0x258),_0xa562e8);}else{const _0x3caa9f=_0xe95e4e[0x0]['botID'];if(pid[_0x3caa9f])pid[_0x3caa9f][_0x4c1b54(0x37d)]({'function':_0x4c1b54(0x2ff),'args':null});}}}),tgBot[_0x1c71a8(0x2c9)](/metrics_(.+)/,async _0x39c2bc=>{const _0x460b11=_0x1c71a8,_0x378ddc=_0x39c2bc[_0x460b11(0x2e4)][0x1];_0x39c2bc[_0x460b11(0x30e)]();if(pid[_0x378ddc])pid[_0x378ddc][_0x460b11(0x37d)]({'function':_0x460b11(0x2ff),'args':null});}),tgBot[_0x1c71a8(0x39d)](_0x1c71a8(0x29d),async _0x457662=>{const _0x14ced5=_0x1c71a8,_0x2d41df=getEnabledBots();if(_0x2d41df[_0x14ced5(0x305)]==0x0)await sendTelegram(_0x457662[_0x14ced5(0x23e)]['id'],_0x14ced5(0x3bf));else{if(_0x2d41df[_0x14ced5(0x305)]>0x1){let _0x64483=[],_0x3ae90b=[];const _0x76d23c=_0x2d41df['length']%0x4==0x0||_0x2d41df['length']%0x4==0x3||_0x2d41df['length']%0x3==0x1?0x4:0x3;let _0x471f88=0x0;_0x2d41df['forEach']((_0x2eb7fd,_0x231180)=>{const _0xf9986f=_0x14ced5;if(_0x231180%_0x76d23c==0x0)_0x3ae90b=[];_0x3ae90b['push'](Markup[_0xf9986f(0x2e7)]['callback'](botRef(_0x2eb7fd[_0xf9986f(0x3a8)]),_0xf9986f(0x409)+_0x2eb7fd[_0xf9986f(0x3a8)])),_0x231180%_0x76d23c==0x0&&(_0x64483[_0x471f88]=_0x3ae90b,_0x471f88++);});const _0x4bdcb1=Markup[_0x14ced5(0x408)](_0x64483);_0x457662['reply'](_0x14ced5(0x20a),_0x4bdcb1);}else{const _0x40fbdd=_0x2d41df[0x0][_0x14ced5(0x3a8)];if(pid[_0x40fbdd])pid[_0x40fbdd][_0x14ced5(0x37d)]({'function':_0x14ced5(0x38a),'args':null});}}}),tgBot[_0x1c71a8(0x2c9)](/portfolio_(.+)/,async _0x4eec5b=>{const _0x82ee93=_0x1c71a8,_0x1ec487=_0x4eec5b['match'][0x1];_0x4eec5b[_0x82ee93(0x30e)]();if(pid[_0x1ec487])pid[_0x1ec487][_0x82ee93(0x37d)]({'function':_0x82ee93(0x38a),'args':null});}),tgBot[_0x1c71a8(0x39d)](_0x1c71a8(0x3dc),async _0x50aae7=>{const _0x2ef167=_0x1c71a8,_0x3a3ede=_0x2ef167(0x3dc);await zipFiles(_0x3a3ede);const _0xd89268=zippath+(_0x3a3ede+'.zip');_0x50aae7[_0x2ef167(0x2d9)]({'source':_0xd89268})[_0x2ef167(0x360)](()=>{})[_0x2ef167(0x33d)](_0x4745a3=>logger['debug'](_0x2ef167(0x30c)+_0x3a3ede+_0x2ef167(0x248),_0x4745a3));}),tgBot[_0x1c71a8(0x39d)](_0x1c71a8(0x33e),async _0x5b66ab=>{const _0x3d2961=_0x1c71a8,_0x28ab47='backup';await backupConfigFiles(),await zipFiles(_0x28ab47);const _0x132171=zippath+(_0x28ab47+_0x3d2961(0x377));_0x5b66ab[_0x3d2961(0x2d9)]({'source':_0x132171})[_0x3d2961(0x360)](()=>{})[_0x3d2961(0x33d)](_0x5f1241=>logger[_0x3d2961(0x26e)](_0x3d2961(0x30c)+_0x28ab47+_0x3d2961(0x248),_0x5f1241));}),tgBot[_0x1c71a8(0x39d)]('update',async _0x44a87b=>{const _0xac6894=_0x1c71a8;await getMessages();if(!updateAvailable)await sendTelegram(_0x44a87b[_0xac6894(0x23e)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x44a87b['chat']['id'],_0xac6894(0x25d));else{const _0x471559=Markup['inlineKeyboard']([Markup[_0xac6894(0x2e7)]['callback'](_0xac6894(0x3b8),_0xac6894(0x2bd)),Markup[_0xac6894(0x2e7)]['callback']('No',_0xac6894(0x2d7))]);_0x44a87b[_0xac6894(0x320)](_0xac6894(0x343),_0x471559);}}}),tgBot['action'](/update_(.+)/,async _0x5c9927=>{const _0xa18457=_0x1c71a8,_0x463b7c=_0x5c9927[_0xa18457(0x2e4)][0x1];_0x5c9927[_0xa18457(0x30e)](),_0x463b7c==_0xa18457(0x2ca)&&(await sendTelegram(_0x5c9927[_0xa18457(0x23e)]['id'],_0xa18457(0x3b4)),updateBB(_0xa18457(0x2d6))),_0x463b7c=='no'&&await sendTelegram(_0x5c9927[_0xa18457(0x23e)]['id'],_0xa18457(0x3b1));}),tgBot[_0x1c71a8(0x39d)](_0x1c71a8(0x401),async _0xf2c996=>{const _0x290298=_0x1c71a8;if(!validInstallation)await sendTelegram(_0xf2c996['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x519fa1=Markup['inlineKeyboard']([Markup[_0x290298(0x2e7)][_0x290298(0x287)](_0x290298(0x3b8),_0x290298(0x2c8)),Markup[_0x290298(0x2e7)][_0x290298(0x287)]('No',_0x290298(0x376))]);_0xf2c996[_0x290298(0x320)](_0x290298(0x309),_0x519fa1);}}),tgBot['action'](/reinstall_(.+)/,async _0x45bd90=>{const _0x4ffd3d=_0x1c71a8,_0x87461c=_0x45bd90[_0x4ffd3d(0x2e4)][0x1];_0x45bd90['editMessageReplyMarkup'](),_0x87461c==_0x4ffd3d(0x2ca)&&(await sendTelegram(_0x45bd90['chat']['id'],_0x4ffd3d(0x2b2)),updateBB(_0x4ffd3d(0x401))),_0x87461c=='no'&&await sendTelegram(_0x45bd90[_0x4ffd3d(0x23e)]['id'],_0x4ffd3d(0x38d));}),tgBot[_0x1c71a8(0x39d)]('toggle',async _0x8e2e16=>{const _0x27fb23=_0x1c71a8,_0x244976=getBotsWithMode();if(_0x244976[_0x27fb23(0x305)]==0x0)await sendTelegram(_0x8e2e16[_0x27fb23(0x23e)]['id'],_0x27fb23(0x3bf));else{let _0x233702=[],_0xdcff4d=[];const _0x5f5bea=0x2;let _0x36bd1a=0x0;_0x244976[_0x27fb23(0x302)]((_0x35c86f,_0x1947b6)=>{const _0x2ebe47=_0x27fb23;if(_0x1947b6%_0x5f5bea==0x0)_0xdcff4d=[];_0xdcff4d['push'](Markup[_0x2ebe47(0x2e7)]['callback'](botRef(_0x35c86f['botID'])+'\x20('+_0x35c86f[_0x2ebe47(0x1f3)]+')',_0x2ebe47(0x225)+_0x35c86f['botID'])),_0x1947b6%_0x5f5bea==0x0&&(_0x233702[_0x36bd1a]=_0xdcff4d,_0x36bd1a++);});const _0x16cb80=Markup[_0x27fb23(0x408)](_0x233702);_0x8e2e16[_0x27fb23(0x320)](_0x27fb23(0x234),_0x16cb80);}}),tgBot[_0x1c71a8(0x2c9)](/toggle_(.+)/,async _0x5471e0=>{const _0x37c0d0=_0x1c71a8,_0x992899=_0x5471e0[_0x37c0d0(0x2e4)][0x1];_0x5471e0[_0x37c0d0(0x30e)]();const _0xfaeb7f=getBotsWithMode(),_0x440a0b=_0xfaeb7f['find'](_0x46182d=>_0x46182d['botID']==_0x992899),_0x29abb2=_0x440a0b[_0x37c0d0(0x1f3)]=='auto'?_0x37c0d0(0x226):'auto';await sendTelegram(_0x5471e0['chat']['id'],_0x37c0d0(0x29f)+botRef(_0x440a0b[_0x37c0d0(0x3a8)])+_0x37c0d0(0x363)+_0x29abb2+_0x37c0d0(0x32c)),toggleBotMode(_0x992899);}),tgBot[_0x1c71a8(0x39d)](_0x1c71a8(0x27f),async _0x51c9b2=>{const _0x4775e7=_0x1c71a8;let _0x5c3f41='';config[_0x4775e7(0x302)](_0x172ebc=>{const _0x2b1349=_0x4775e7;_0x5c3f41+=_0x2b1349(0x280)+_0x172ebc[_0x2b1349(0x3a8)]+':\x20'+_0x172ebc[_0x2b1349(0x3c9)]+'\x0a';}),await sendTelegram(_0x51c9b2['chat']['id'],_0x5c3f41,{'parse_mode':_0x4775e7(0x1fe)});}),tgBot[_0x1c71a8(0x39d)]('help',async _0x5525e7=>{await sendTelegram(_0x5525e7['chat']['id'],_0x7827b4);}),process['once']('SIGINT',()=>tgBot[_0x1c71a8(0x246)](_0x1c71a8(0x217))),process[_0x1c71a8(0x274)](_0x1c71a8(0x229),()=>tgBot[_0x1c71a8(0x246)](_0x1c71a8(0x229))),tgBot[_0x1c71a8(0x3c5)]();}function disableTelegram(){const _0x27db9b=_0x433ce9;tgBot&&tgBot[_0x27db9b(0x246)]();}async function sendTelegram(_0x225790,_0x53b366,_0x35838f){const _0x2bdad9=_0x433ce9;_0x35838f={..._0x35838f,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0x2bdad9(0x3ac)](_0x225790,_0x53b366,_0x35838f);}catch(_0x34cf49){logger['debug'](_0x2bdad9(0x3ce),_0x34cf49);}}async function sendTelegramBot(_0x546c2d,_0x44add4){const _0x31c935=_0x433ce9;if(settings[_0x31c935(0x351)]){if(settings[_0x31c935(0x256)]==_0x31c935(0x222)||(_0x44add4[_0x31c935(0x3f7)]==_0x31c935(0x2b3)||_0x44add4[_0x31c935(0x3f7)]==_0x31c935(0x3be)||_0x44add4[_0x31c935(0x3f7)]==_0x31c935(0x3c2))&&settings[_0x31c935(0x256)]==_0x31c935(0x22b)||_0x44add4[_0x31c935(0x3f7)]==_0x31c935(0x3ff)&&settings[_0x31c935(0x256)]==_0x31c935(0x2f9)){if(tgBot&&settings['telegramChatId']){if(_0x44add4[_0x31c935(0x349)])await sendTelegram(settings[_0x31c935(0x35e)],_0x44add4[_0x31c935(0x3c9)]+_0x31c935(0x30f)+_0x44add4['event']);else await sendTelegram(settings[_0x31c935(0x35e)],_0x31c935(0x280)+_0x546c2d+_0x31c935(0x30f)+_0x44add4[_0x31c935(0x2e1)]);}}}}async function sendTelegramMsg(_0x14449d,_0x465a10='HTML'){const _0x2fe9e3=_0x433ce9;return tgBot&&settings[_0x2fe9e3(0x35e)]?(await sendTelegram(settings[_0x2fe9e3(0x35e)],_0x14449d,{'parse_mode':_0x465a10}),!![]):![];}function getDeviceWithIp(_0x5bfdf3){const _0x56a255=_0x433ce9;return devices[_0x56a255(0x339)](_0x2e2130=>_0x2e2130['ip']===_0x5bfdf3);}async function temporaryAccess2FA(_0x5e5d3c,_0x554dfe){const _0x2fcecd=_0x433ce9;let _0x31c3e4=new Date(),_0xa65d56=![];if(lastIpApproval){if(_0x31c3e4-lastIpApproval<0x1388)_0xa65d56=!![];}lastIpApproval=new Date();if(_0xa65d56)return;if(tgBot&&settings['telegramChatId']){const _0x225fbd=uuidRandom();tmpStorage[_0x225fbd]={'uuid':_0x5e5d3c,'externalip':_0x554dfe};const _0x5ae942=Markup[_0x2fcecd(0x408)]([Markup[_0x2fcecd(0x2e7)][_0x2fcecd(0x287)](_0x2fcecd(0x24c),'tempaccess_5_'+_0x225fbd),Markup[_0x2fcecd(0x2e7)][_0x2fcecd(0x287)](_0x2fcecd(0x3db),_0x2fcecd(0x341)+_0x225fbd),Markup['button'][_0x2fcecd(0x287)](_0x2fcecd(0x3ca),'tempaccess_30_'+_0x225fbd),Markup['button']['callback'](_0x2fcecd(0x2d0),_0x2fcecd(0x407)+_0x225fbd)]);await sendTelegram(settings[_0x2fcecd(0x35e)],_0x2fcecd(0x37e)+normalizeIP(_0x554dfe)[_0x2fcecd(0x2dd)]+'\x20?',_0x5ae942),tgBot[_0x2fcecd(0x2c9)](/tempaccess_(.+)_(.+)/,async _0x535646=>{const _0x189cb8=_0x2fcecd,_0x4af31f=_0x535646[_0x189cb8(0x2e4)][0x1],_0x29873c=_0x535646[_0x189cb8(0x2e4)][0x2],{uuid:_0x1536bd,externalip:_0x453ed0}=tmpStorage[_0x29873c];delete tmpStorage[_0x29873c],_0x535646[_0x189cb8(0x30e)](),devices[_0x1536bd][_0x189cb8(0x3c0)]={'clientip':_0x453ed0,'timestamp':new Date()[_0x189cb8(0x25a)](),'expiry':_0x4af31f},_0x4af31f!=_0x189cb8(0x2d0)?(await sendTelegram(_0x535646[_0x189cb8(0x23e)]['id'],'Access\x20enabled\x20for\x20'+_0x4af31f+'\x20minutes',{'parse_mode':_0x189cb8(0x1fe)}),io['to'](_0x1536bd)[_0x189cb8(0x1ff)](_0x189cb8(0x367),{'access':{'allow':![],'reason':_0x189cb8(0x2a5),'token':null}})):(await sendTelegram(_0x535646[_0x189cb8(0x23e)]['id'],_0x189cb8(0x399)),io['to'](_0x1536bd)[_0x189cb8(0x1ff)](_0x189cb8(0x367),{'access':{'allow':![],'reason':_0x189cb8(0x32e),'token':null}}));});}}async function loginAccess2FA(_0x225bf1,_0x298dcd){const _0x2d682e=_0x433ce9;if(tgBot&&settings[_0x2d682e(0x35e)]){const _0xa7ad99=uuidRandom();tmpStorage[_0xa7ad99]={'uuid':_0x225bf1,'externalip':_0x298dcd};const _0x8ad7=Markup[_0x2d682e(0x408)]([Markup[_0x2d682e(0x2e7)][_0x2d682e(0x287)](_0x2d682e(0x281),'login2fa_'+loginExpiry+'_'+_0xa7ad99),Markup[_0x2d682e(0x2e7)][_0x2d682e(0x287)](_0x2d682e(0x2d0),_0x2d682e(0x344)+_0xa7ad99)]);await sendTelegram(settings['telegramChatId'],_0x2d682e(0x203)+normalizeIP(_0x298dcd)['show']+'\x20?',_0x8ad7),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x18f5c8=>{const _0x3cf33d=_0x2d682e,_0x10aa39=_0x18f5c8[_0x3cf33d(0x2e4)][0x1],_0x24d672=_0x18f5c8[_0x3cf33d(0x2e4)][0x2],{uuid:_0x361638,externalip:_0x351a22}=tmpStorage[_0x24d672];delete tmpStorage[_0x24d672],_0x18f5c8[_0x3cf33d(0x30e)](),devices[_0x361638][_0x3cf33d(0x2f6)]={'clientip':_0x351a22,'timestamp':new Date()[_0x3cf33d(0x25a)](),'expiry':_0x10aa39},_0x10aa39!='reject'?(await sendTelegram(_0x18f5c8['chat']['id'],_0x3cf33d(0x362),{'parse_mode':_0x3cf33d(0x1fe)}),io['to'](_0x361638)[_0x3cf33d(0x1ff)](_0x3cf33d(0x367),{'access':{'allow':![],'reason':_0x3cf33d(0x2a5),'token':null}})):(await sendTelegram(_0x18f5c8['chat']['id'],_0x3cf33d(0x288)),io['to'](_0x361638)[_0x3cf33d(0x1ff)](_0x3cf33d(0x367),{'access':{'allow':![],'reason':_0x3cf33d(0x2fa),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x569859=_0x433ce9;return dbConfig[_0x569859(0x261)](_0x569859(0x31d))[_0x569859(0x2ea)](_0x569859(0x3a8))['filter']({'status':_0x569859(0x40a)})[_0x569859(0x21a)]()||[];}function getDisabledBots(){const _0x52a971=_0x433ce9;return dbConfig[_0x52a971(0x261)](_0x52a971(0x31d))['sortBy'](_0x52a971(0x3a8))['filter']({'status':_0x52a971(0x2e5)})['value']()||[];}function getBotAttributes(_0xcaaa49){const _0x442d35=_0x433ce9;let _0x46e762={};const _0x3e003a=configpath+_0x442d35(0x283)+_0xcaaa49+_0x442d35(0x29b),_0x123e35=fs[_0x442d35(0x3ec)](_0x3e003a);if(_0x123e35){const _0x3fe8d6=fs['readFileSync'](_0x3e003a);try{const _0x2a0b7f=JSON['parse'](_0x3fe8d6),_0x49c1d0=_0x2a0b7f?_0x2a0b7f['bot'][0x0][_0x442d35(0x2f4)]:![];_0x46e762[_0x442d35(0x1f3)]=_0x49c1d0?_0x442d35(0x2d5):_0x442d35(0x226),_0x46e762[_0x442d35(0x3c9)]=_0x2a0b7f?_0x2a0b7f['bot'][0x0]['botname']:_0x442d35(0x280)+_0xcaaa49,_0x46e762['showname']=_0x2a0b7f?_0x2a0b7f['bot'][0x0][_0x442d35(0x349)]:![];}catch(_0x2567a0){_0x46e762['mode']='manual',_0x46e762[_0x442d35(0x3c9)]=_0x442d35(0x280)+_0xcaaa49,_0x46e762[_0x442d35(0x349)]=![];}}else _0x46e762[_0x442d35(0x1f3)]=_0x442d35(0x226),_0x46e762[_0x442d35(0x3c9)]=_0x442d35(0x280)+_0xcaaa49,_0x46e762[_0x442d35(0x349)]=![];return _0x46e762;}function getBotsWithMode(){const _0x402579=_0x433ce9,_0x1d32aa=dbConfig[_0x402579(0x261)]('bots')[_0x402579(0x2ea)](_0x402579(0x3a8))[_0x402579(0x21a)]()||[];return _0x1d32aa[_0x402579(0x302)](_0x5e5f0c=>{const _0x18c4db=_0x402579;let _0x16df48=getBotAttributes(_0x5e5f0c['botID']);_0x5e5f0c[_0x18c4db(0x1f3)]=_0x16df48[_0x18c4db(0x1f3)];}),_0x1d32aa;}function getBotExchanges(){const _0x1124e9=_0x433ce9;let _0x5865e8=[];const _0x768f37=dbConfig[_0x1124e9(0x261)](_0x1124e9(0x31d))[_0x1124e9(0x2ea)](_0x1124e9(0x3a8))[_0x1124e9(0x21a)]()||[];_0x768f37['forEach'](_0x1620bf=>{const _0x701eb1=_0x1124e9;if(_0x1620bf[_0x701eb1(0x367)]=='enabled'){const _0x4a2540=configpath+_0x701eb1(0x283)+_0x1620bf['botID']+'-config.json',_0x312d0f=fs[_0x701eb1(0x3ec)](_0x4a2540);let _0x4c741d;if(_0x312d0f){const _0x3df6c6=fs[_0x701eb1(0x240)](_0x4a2540);try{const _0xe5491d=JSON[_0x701eb1(0x32a)](_0x3df6c6);_0x4c741d=_0xe5491d?_0xe5491d[_0x701eb1(0x23a)][0x0][_0x701eb1(0x215)]:null;}catch(_0x613216){}}if(_0x4c741d)_0x5865e8['push'](_0x4c741d);}});const _0x31baef=[...new Set(_0x5865e8)]['sort']();return _0x31baef;}async function initUser(){const _0x164bfa=_0x433ce9;if(!settings['userid']){const _0x64947c=uuidRandom();mixpanel[_0x164bfa(0x23f)](_0x64947c),updateSetting(_0x164bfa(0x23c),_0x64947c);}}async function initSecure(){const _0x4254ad=_0x433ce9;let _0x285ca3=getSecure();if(!_0x285ca3['hasOwnProperty'](_0x4254ad(0x20f))){let _0x51e720=await generateKeys();_0x285ca3[_0x4254ad(0x3af)]=_0x51e720[_0x4254ad(0x3af)],_0x285ca3[_0x4254ad(0x28f)]=_0x51e720[_0x4254ad(0x28f)],_0x285ca3[_0x4254ad(0x20f)]=crypto[_0x4254ad(0x36b)](0x20)[_0x4254ad(0x286)]('hex');;storeSecure(_0x285ca3);}}function getSettings(){const _0x37759d=_0x433ce9;return dbSettings['get'](_0x37759d(0x233))[_0x37759d(0x21a)]()||{};}function getSecure(){const _0xb63775=_0x433ce9;return dbSecure['get']('secure')[_0xb63775(0x21a)]()||{};}function getBlacklist(){const _0x265907=_0x433ce9;return dbSecure[_0x265907(0x261)](_0x265907(0x3b2))[_0x265907(0x21a)]()||[];}function broadcastToBots(_0x1aa392,_0x1507fd){const _0x4c5cd8=_0x433ce9;config[_0x4c5cd8(0x302)](_0x2c3f04=>{const _0x47d6a6=_0x4c5cd8;if(_0x2c3f04[_0x47d6a6(0x367)]==_0x47d6a6(0x40a)&&_0x2c3f04[_0x47d6a6(0x37c)]==_0x47d6a6(0x21c)||_0x2c3f04[_0x47d6a6(0x367)]==_0x47d6a6(0x402)&&_0x2c3f04[_0x47d6a6(0x37c)]=='running'){if(pid[_0x2c3f04[_0x47d6a6(0x3a8)]])pid[_0x2c3f04['botID']][_0x47d6a6(0x37d)]({[_0x1aa392]:_0x1507fd});}});}async function storeSettings(_0x28a740,_0x5c6070=![]){const _0x12ffd3=_0x433ce9;_0x28a740={...settings,..._0x28a740};if(_0x5c6070&&_0x28a740['bbPassword']!='************'&&_0x28a740[_0x12ffd3(0x26d)]!=_0x12ffd3(0x284)&&_0x28a740[_0x12ffd3(0x26d)]!=''){const _0x4decc8=decryptRSA(secure[_0x12ffd3(0x28f)],_0x28a740[_0x12ffd3(0x26d)])[_0x12ffd3(0x33f)](_0x12ffd3(0x24d))[0x0],_0x36bd80=bcrypt[_0x12ffd3(0x28e)](_0x4decc8,saltRounds);_0x28a740={..._0x28a740,'bbPassword':_0x36bd80};}if(_0x5c6070&&_0x28a740['telegramToken']!=_0x12ffd3(0x2a6)&&_0x28a740[_0x12ffd3(0x310)]!=_0x12ffd3(0x284)&&_0x28a740[_0x12ffd3(0x310)]!=''){const _0x418307=decryptRSA(secure[_0x12ffd3(0x28f)],_0x28a740[_0x12ffd3(0x310)])[_0x12ffd3(0x33f)](_0x12ffd3(0x24d))[0x0];_0x28a740={..._0x28a740,'telegramToken':_0x418307};}if(_0x5c6070&&_0x28a740[_0x12ffd3(0x318)]!='************'&&_0x28a740[_0x12ffd3(0x318)]!=_0x12ffd3(0x284)&&_0x28a740['marketcapApi']!=''){const _0x48c87f=decryptRSA(secure[_0x12ffd3(0x28f)],_0x28a740[_0x12ffd3(0x318)])[_0x12ffd3(0x33f)](_0x12ffd3(0x24d))[0x0];_0x28a740={..._0x28a740,'marketcapApi':_0x48c87f};}const _0x398e7f=_0x28a740['telegramToken']!=_0x12ffd3(0x2a6)&&_0x28a740['telegramToken']!=settings[_0x12ffd3(0x310)]||_0x28a740['telegramUsername']!=settings['telegramUsername'],_0x456485=_0x28a740[_0x12ffd3(0x310)]==''||_0x28a740[_0x12ffd3(0x21f)]=='',_0x9dbcad=_0x28a740[_0x12ffd3(0x318)]&&_0x28a740[_0x12ffd3(0x318)]!='************'&&_0x28a740[_0x12ffd3(0x318)]!=settings[_0x12ffd3(0x318)];_0x398e7f&&(_0x28a740['telegramChatId']=null,_0x28a740[_0x12ffd3(0x256)]='all');for(const [_0x27e642,_0x52b815]of Object[_0x12ffd3(0x356)](_0x28a740)){if(_0x27e642=='telegramToken'&&_0x52b815==_0x12ffd3(0x2a6)){_0x28a740['telegramToken']=settings[_0x12ffd3(0x310)];continue;};if(_0x27e642==_0x12ffd3(0x26d)&&_0x52b815==_0x12ffd3(0x2a6)){_0x28a740[_0x12ffd3(0x26d)]=settings[_0x12ffd3(0x26d)];continue;};if(_0x27e642==_0x12ffd3(0x318)&&_0x52b815==_0x12ffd3(0x2a6)){_0x28a740['marketcapApi']=settings[_0x12ffd3(0x318)];continue;};dbSettings[_0x12ffd3(0x3ad)](_0x12ffd3(0x338)+_0x27e642,_0x52b815)['write']();}settings=_0x28a740,io['to'](_0x12ffd3(0x22d))[_0x12ffd3(0x1ff)](_0x12ffd3(0x233),cleanSettings()),broadcastToBots('timeshift',settings[_0x12ffd3(0x253)]),broadcastToBots(_0x12ffd3(0x306),settings[_0x12ffd3(0x306)]),broadcastToBots(_0x12ffd3(0x318),settings[_0x12ffd3(0x318)]);if(_0x398e7f&&!_0x456485)initTelegram();_0x398e7f&&_0x456485&&(updateSetting('telegramChatId',null),disableTelegram()),getAllClients()['forEach'](_0x7434f9=>{const _0x387cde=_0x12ffd3;getSocket(_0x7434f9['id'])[_0x387cde(0x1ff)](_0x387cde(0x367),{'access':{'allow':![],'reason':_0x387cde(0x2a5),'token':null}});}),_0x9dbcad&&(await sleep(0xbb8),testMarketcapApi(_0x28a740[_0x12ffd3(0x318)]));}async function testMarketcapApi(_0x23f92e){const _0x42afe8=_0x433ce9,_0x191937=[_0x42afe8(0x3a0),_0x42afe8(0x235)];try{await axios['get'](_0x42afe8(0x385),{'headers':{'X-CMC_PRO_API_KEY':_0x23f92e},'params':{'symbol':_0x191937[_0x42afe8(0x286)]()}});}catch(_0x540725){_0x540725[_0x42afe8(0x286)]()[_0x42afe8(0x2a9)](_0x42afe8(0x3dd))?(io['to']('botmanager')['emit'](_0x42afe8(0x3c8),_0x42afe8(0x275)),logger['full']('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x42afe8(0x22d))[_0x42afe8(0x1ff)](_0x42afe8(0x3c8),_0x42afe8(0x212)),logger[_0x42afe8(0x3a6)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x42afe8(0x26e)](_0x42afe8(0x3e6),_0x540725['toString']()+_0x42afe8(0x26c)+_0x540725['code']));return;}logger['debug'](_0x42afe8(0x3a3));}function updateSetting(_0x1960d1,_0x3f1609){const _0x553c83=_0x433ce9;dbSettings[_0x553c83(0x3ad)](_0x553c83(0x338)+_0x1960d1,_0x3f1609)['write'](),settings=getSettings(),io['to'](_0x553c83(0x22d))[_0x553c83(0x1ff)](_0x553c83(0x233),cleanSettings());}function storeSecure(_0x232df0){const _0x6f4d39=_0x433ce9;dbSecure[_0x6f4d39(0x261)](_0x6f4d39(0x359))[_0x6f4d39(0x230)](_0x232df0)[_0x6f4d39(0x348)](),secure=_0x232df0;}function addBlacklist(_0x280185){const _0x3a10bc=_0x433ce9;cleanBlacklist();let _0x4db61e;devices[_0x280185][_0x3a10bc(0x3c0)]?_0x4db61e=Math[_0x3a10bc(0x22c)](devices[_0x280185][_0x3a10bc(0x3c0)][_0x3a10bc(0x354)],loginExpiry):_0x4db61e=loginExpiry,dbSecure[_0x3a10bc(0x261)](_0x3a10bc(0x3b2))['push']({'expiry':new Date()[_0x3a10bc(0x25a)]()+_0x4db61e*0x3c*0x3e8,'token':devices[_0x280185][_0x3a10bc(0x2df)]['token']})[_0x3a10bc(0x348)](),blacklist=dbSecure[_0x3a10bc(0x261)]('blacklist')[_0x3a10bc(0x21a)]();}function cleanBlacklist(){const _0x195a4b=_0x433ce9;let _0x3a3cb9=dbSecure[_0x195a4b(0x261)](_0x195a4b(0x3b2))['cloneDeep']()['value'](),_0x1feb3f=new Date()[_0x195a4b(0x25a)]();_0x3a3cb9[_0x195a4b(0x302)](_0x1446a8=>{const _0x4bcb79=_0x195a4b;_0x1446a8[_0x4bcb79(0x354)]<_0x1feb3f&&dbSecure[_0x4bcb79(0x261)](_0x4bcb79(0x3b2))[_0x4bcb79(0x2f3)]({'expiry':_0x1446a8[_0x4bcb79(0x354)]})[_0x4bcb79(0x348)]();});}function initStates(){const _0x3b4d50=_0x433ce9;let _0x29cb2a=getConfiguration();_0x29cb2a[_0x3b4d50(0x302)](_0x4ec800=>{const _0x33e0d0=_0x3b4d50;_0x4ec800['live']=_0x33e0d0(0x2f1);}),storeConfiguration(_0x29cb2a);}async function generateKeys(){const _0xfef90e=_0x433ce9,_0x59267a=forge[_0xfef90e(0x380)][_0xfef90e(0x379)][_0xfef90e(0x3fa)]({'bits':0x1000,'e':0x10001}),_0x180f6d=forge[_0xfef90e(0x380)][_0xfef90e(0x36c)](_0x59267a[_0xfef90e(0x28f)]),_0x396e47=forge[_0xfef90e(0x380)][_0xfef90e(0x365)](_0x59267a[_0xfef90e(0x3af)]);return{'privateKey':_0x180f6d,'publicKey':_0x396e47};}async function oneTimeMigration(){const _0x1ae4bc=_0x433ce9;let _0x19c3b2=getSettings(),_0xbaab5c=![];!_0x19c3b2[_0x1ae4bc(0x3ab)]('lastmsgtelegram')&&(_0x19c3b2[_0x1ae4bc(0x35f)]=0x0,_0xbaab5c=!![]);!_0x19c3b2[_0x1ae4bc(0x3ab)]('lastmsgemitted')&&(_0x19c3b2['lastmsgemitted']=0x0,_0xbaab5c=!![]);!_0x19c3b2['hasOwnProperty'](_0x1ae4bc(0x292))&&(_0x19c3b2[_0x1ae4bc(0x292)]=_0x1ae4bc(0x1f9),_0xbaab5c=!![]);!_0x19c3b2[_0x1ae4bc(0x3ab)](_0x1ae4bc(0x306))&&(_0x19c3b2[_0x1ae4bc(0x306)]=![],_0xbaab5c=!![]);!_0x19c3b2['hasOwnProperty']('marketcapApi')&&(_0x19c3b2['marketcapApi']='',_0xbaab5c=!![]);if(_0xbaab5c)storeSettings(_0x19c3b2);try{fs[_0x1ae4bc(0x20c)](configbackuppath,{'withFileTypes':!![]})[_0x1ae4bc(0x302)](_0x23d2c6=>{const _0x439000=_0x1ae4bc;if(!_0x23d2c6[_0x439000(0x2fe)]()){if(!_0x23d2c6['name'][_0x439000(0x1ee)](_0x439000(0x2ee)))fs[_0x439000(0x2e3)](configbackuppath+_0x23d2c6[_0x439000(0x392)]);}else fs[_0x439000(0x325)](configbackuppath+_0x23d2c6[_0x439000(0x392)],{'recursive':!![]});});}catch(_0x3f4549){logger[_0x1ae4bc(0x26e)]('Error\x20removing\x20old\x20backup\x20files:',_0x3f4549);}}function storeConfiguration(_0x3c31de){const _0x48d4f7=_0x433ce9;dbConfig[_0x48d4f7(0x261)]('bots')['remove']()[_0x48d4f7(0x348)](),dbConfig[_0x48d4f7(0x261)](_0x48d4f7(0x31d))[_0x48d4f7(0x230)](..._0x3c31de)[_0x48d4f7(0x348)](),config=_0x3c31de;}async function resetPassword(){const _0x47fa43=_0x433ce9;if(tgBot&&settings[_0x47fa43(0x35e)]){const _0xedf7aa=Markup[_0x47fa43(0x408)]([Markup[_0x47fa43(0x2e7)][_0x47fa43(0x287)](_0x47fa43(0x2ca),_0x47fa43(0x2a0)),Markup['button'][_0x47fa43(0x287)]('no','resetpw_no')]);await sendTelegram(settings[_0x47fa43(0x35e)],_0x47fa43(0x289),_0xedf7aa),tgBot[_0x47fa43(0x2c9)](/resetpw_(.+)/,async _0x4d5672=>{const _0x596efc=_0x47fa43,_0xeb62d3=_0x4d5672[_0x596efc(0x2e4)][0x1];_0x4d5672[_0x596efc(0x30e)]();if(_0xeb62d3!='no'){const _0xf8d0bb=0xf,_0x29fab2='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x2540a5=Array[_0x596efc(0x313)](crypto[_0x596efc(0x299)](new Uint32Array(_0xf8d0bb)))['map'](_0x1dec9c=>_0x29fab2[_0x1dec9c%_0x29fab2[_0x596efc(0x305)]])['join'](''),_0x3d9bbb=bcrypt[_0x596efc(0x28e)](_0x2540a5,saltRounds);storeSettings({'bbPassword':_0x3d9bbb}),await sendTelegram(_0x4d5672['chat']['id'],_0x596efc(0x373)+_0x2540a5,{'parse_mode':_0x596efc(0x1fe)});}else await sendTelegram(_0x4d5672['chat']['id'],_0x596efc(0x21b));});}}async function confirmRestore(_0x204fec,_0x469654){const _0x4ebbc2=_0x433ce9;io['to'](_0x4ebbc2(0x22d))['emit']('notification','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot',_0x4ebbc2(0x3c2));if(tgBot&&settings[_0x4ebbc2(0x35e)]){const _0xce6e91=uuidRandom();tmpStorage[_0xce6e91]={'path':_0x204fec,'filename':_0x469654};const _0x1150e2=Markup['inlineKeyboard']([Markup[_0x4ebbc2(0x2e7)][_0x4ebbc2(0x287)](_0x4ebbc2(0x2ca),_0x4ebbc2(0x207)+_0xce6e91),Markup[_0x4ebbc2(0x2e7)][_0x4ebbc2(0x287)]('no',_0x4ebbc2(0x346)+_0xce6e91)]);await sendTelegram(settings['telegramChatId'],_0x4ebbc2(0x3a5),_0x1150e2),tgBot[_0x4ebbc2(0x2c9)](/restore_(.+)_(.+)/,async _0x3a810e=>{const _0x4202ff=_0x4ebbc2,_0x29338b=_0x3a810e[_0x4202ff(0x2e4)][0x1],_0x91b9df=_0x3a810e[_0x4202ff(0x2e4)][0x2],{path:_0x57009f,filename:_0x1dd138}=tmpStorage[_0x91b9df];delete tmpStorage[_0x91b9df],_0x3a810e['editMessageReplyMarkup'](),_0x29338b==_0x4202ff(0x2ca)?(logger['debug']('Restore\x20process\x20confirmed'),await sendTelegram(_0x3a810e[_0x4202ff(0x23e)]['id'],_0x4202ff(0x1fa),{'parse_mode':'HTML'}),unzipFile(_0x57009f,_0x1dd138)):(logger[_0x4202ff(0x26e)]('Restore\x20process\x20aborted'),await sendTelegram(_0x3a810e[_0x4202ff(0x23e)]['id'],_0x4202ff(0x3ee)));});}}function getServerTime(){const _0x3e2cc4=_0x433ce9,_0x3ac9de=new Date();return _0x3ac9de[_0x3e2cc4(0x26b)]()+'/'+(_0x3ac9de[_0x3e2cc4(0x291)]()+0x1)[_0x3e2cc4(0x286)]()[_0x3e2cc4(0x398)](0x2,'0')+'/'+_0x3ac9de[_0x3e2cc4(0x3ea)]()[_0x3e2cc4(0x286)]()['padStart'](0x2,'0')+'\x20'+_0x3ac9de[_0x3e2cc4(0x2d1)]()['toString']()[_0x3e2cc4(0x398)](0x2,'0')+':'+_0x3ac9de[_0x3e2cc4(0x328)]()[_0x3e2cc4(0x286)]()[_0x3e2cc4(0x398)](0x2,'0')+':'+_0x3ac9de['getSeconds']()[_0x3e2cc4(0x286)]()[_0x3e2cc4(0x398)](0x2,'0');}function getTimeStamp(){const _0x1dd063=_0x433ce9,_0x2f1f3c=shiftedTime();return _0x2f1f3c['getFullYear']()+'/'+(_0x2f1f3c[_0x1dd063(0x291)]()+0x1)[_0x1dd063(0x286)]()[_0x1dd063(0x398)](0x2,'0')+'/'+_0x2f1f3c['getDate']()[_0x1dd063(0x286)]()['padStart'](0x2,'0')+'\x20'+_0x2f1f3c['getHours']()['toString']()[_0x1dd063(0x398)](0x2,'0')+':'+_0x2f1f3c[_0x1dd063(0x328)]()[_0x1dd063(0x286)]()[_0x1dd063(0x398)](0x2,'0')+':'+_0x2f1f3c[_0x1dd063(0x2cf)]()['toString']()[_0x1dd063(0x398)](0x2,'0');}function getCleanTimeStamp(){const _0x5bdef7=_0x433ce9,_0x56e2d1=shiftedTime();return _0x56e2d1[_0x5bdef7(0x26b)]()+(_0x56e2d1['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+_0x56e2d1[_0x5bdef7(0x3ea)]()[_0x5bdef7(0x286)]()[_0x5bdef7(0x398)](0x2,'0')+'-'+_0x56e2d1['getHours']()[_0x5bdef7(0x286)]()['padStart'](0x2,'0')+_0x56e2d1['getMinutes']()['toString']()[_0x5bdef7(0x398)](0x2,'0')+_0x56e2d1[_0x5bdef7(0x2cf)]()[_0x5bdef7(0x286)]()[_0x5bdef7(0x398)](0x2,'0');}function shiftedTime(){const _0x107dec=_0x433ce9,_0x3aebe1=new Date();let _0x3b3539=_0x3aebe1;if(settings[_0x107dec(0x253)]&&settings['timeshift']!==0x0)_0x3b3539=fns[_0x107dec(0x3d7)](_0x3aebe1,{'hours':settings[_0x107dec(0x253)]});return _0x3b3539;}async function startScheduler(){const _0x11c9c7=_0x433ce9,_0x385fb3=new Date()[_0x11c9c7(0x278)](),_0x15aef2=shiftedTime()[_0x11c9c7(0x2d1)]();_0x15aef2==0x4&&backupConfigFiles(),_0x15aef2==0x0&&(rotateLogFiles(),logger[_0x11c9c7(0x26e)]('--------------------------------------'),logger['debug']('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x11c9c7(0x238)+(environment==_0x11c9c7(0x3f1)?_0x11c9c7(0x386):'')),logger[_0x11c9c7(0x26e)](_0x11c9c7(0x3f3))),_0x385fb3%0x6==0x0&&triggerAnalytics(),_0x385fb3%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x2b2bac){const _0x3032e4=_0x433ce9;logger[_0x3032e4(0x26e)](_0x3032e4(0x3fb)+_0x2b2bac);const _0x46ad6c=getBotsWithMode();_0x46ad6c['length']>0x0?confirmRestore(configbackuppath,_0x2b2bac):unzipFile(configbackuppath,_0x2b2bac);}async function getBackupFiles(_0x180c36=null){const _0x28afba=_0x433ce9;let _0x55a7be=[],_0x4a8425=fs[_0x28afba(0x20c)](configbackuppath,{'withFileTypes':!![]});_0x4a8425[_0x28afba(0x201)]((_0xe3aeee,_0x316db8)=>_0xe3aeee[_0x28afba(0x392)]<_0x316db8[_0x28afba(0x392)]?0x1:_0x316db8[_0x28afba(0x392)]<_0xe3aeee[_0x28afba(0x392)]?-0x1:0x0),_0x4a8425['forEach'](_0x39954f=>{const _0x1a808e=_0x28afba;if(!_0x39954f['isDirectory']()&&_0x39954f[_0x1a808e(0x392)]['startsWith']('backup-full@')&&_0x39954f[_0x1a808e(0x392)][_0x1a808e(0x28c)](_0x1a808e(0x377))){const _0x52cbcc=formatDate(fs[_0x1a808e(0x25e)](configbackuppath+_0x39954f['name'])[_0x1a808e(0x3c1)]);_0x55a7be[_0x1a808e(0x230)]({'name':_0x39954f[_0x1a808e(0x392)],'mtime':_0x52cbcc});}});if(_0x180c36)io['to'](_0x180c36)['emit'](_0x28afba(0x2e8),_0x55a7be);else return _0x55a7be;}async function backupConfigFiles(){const _0xd4b7d9=_0x433ce9;await zipFiles(_0xd4b7d9(0x312));const _0x1d3149=getCleanTimeStamp();fs[_0xd4b7d9(0x2e0)](zippath+_0xd4b7d9(0x371),configbackuppath+(_0xd4b7d9(0x2ee)+_0x1d3149+_0xd4b7d9(0x377)));let _0x4e7ceb=fs[_0xd4b7d9(0x20c)](configbackuppath,{'withFileTypes':!![]});_0x4e7ceb[_0xd4b7d9(0x201)]((_0x2de5f5,_0x4df00a)=>_0x2de5f5[_0xd4b7d9(0x392)]<_0x4df00a[_0xd4b7d9(0x392)]?0x1:_0x4df00a[_0xd4b7d9(0x392)]<_0x2de5f5[_0xd4b7d9(0x392)]?-0x1:0x0),_0x4e7ceb[_0xd4b7d9(0x305)]>maxBackups&&fs[_0xd4b7d9(0x2e3)](configbackuppath+_0x4e7ceb[_0x4e7ceb[_0xd4b7d9(0x305)]-0x1][_0xd4b7d9(0x392)]);}function rotateLogFiles(){const _0x135a4a=_0x433ce9,_0x43267e=fs[_0x135a4a(0x25e)](logspath+_0x135a4a(0x260)),_0x21364d=_0x43267e['size']/0x400;if(_0x21364d>0x64){let _0x2a5723=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x2a5723['sort']((_0x2f784f,_0x37ab17)=>_0x2f784f[_0x135a4a(0x392)]<_0x37ab17[_0x135a4a(0x392)]?0x1:_0x37ab17[_0x135a4a(0x392)]<_0x2f784f[_0x135a4a(0x392)]?-0x1:0x0),_0x2a5723[_0x135a4a(0x302)](_0x158e1a=>{const _0x39019e=_0x135a4a;if(_0x158e1a[_0x39019e(0x392)]=='output-002.log')fs['copyFileSync'](logspath+_0x158e1a[_0x39019e(0x392)],logspath+_0x39019e(0x358));if(_0x158e1a['name']==_0x39019e(0x3bd))fs[_0x39019e(0x2e0)](logspath+_0x158e1a[_0x39019e(0x392)],logspath+'output-002.log');_0x158e1a['name']==_0x39019e(0x260)&&(fs[_0x39019e(0x2e0)](logspath+_0x158e1a[_0x39019e(0x392)],logspath+_0x39019e(0x3bd)),fs[_0x39019e(0x391)](logspath+_0x158e1a[_0x39019e(0x392)],''));});}}async function zipFiles(_0x34d1d8){const _0x2985ed=_0x433ce9;let _0x3b482e;if(_0x34d1d8==_0x2985ed(0x3dc))_0x3b482e=logspath;if(_0x34d1d8==_0x2985ed(0x33e))_0x3b482e=configpath;if(_0x34d1d8=='backup-full')_0x3b482e=configpath;let _0x1c6874=fs[_0x2985ed(0x20c)](_0x3b482e,{'withFileTypes':!![]});const _0x37275d=new JSZip();_0x1c6874[_0x2985ed(0x302)](_0x482fad=>{const _0xc5d7e5=_0x2985ed;if(!_0x482fad[_0xc5d7e5(0x2fe)]()){let _0x2c58c6=fs[_0xc5d7e5(0x240)](_0x3b482e+_0x482fad['name']);if(_0x34d1d8=='backup'){const _0x540232=/^bot-[0-9]{3}-config.json$/,_0x139023=_0x540232[_0xc5d7e5(0x232)](_0x482fad['name']);if(_0x139023){const _0x4c1d0e=JSON[_0xc5d7e5(0x32a)](_0x2c58c6);if(_0x4c1d0e[_0xc5d7e5(0x23a)][0x0]){_0x4c1d0e[_0xc5d7e5(0x23a)][0x0][_0xc5d7e5(0x285)]=_0xc5d7e5(0x284),_0x4c1d0e[_0xc5d7e5(0x23a)][0x0][_0xc5d7e5(0x2f8)]='***';if(_0x4c1d0e[_0xc5d7e5(0x23a)][0x0][_0xc5d7e5(0x210)])_0x4c1d0e['bot'][0x0][_0xc5d7e5(0x210)]='***';}_0x2c58c6=JSON['stringify'](_0x4c1d0e,null,0x2);}if(_0x482fad[_0xc5d7e5(0x392)]=='bb-settings.json'){const _0x1ee414=JSON[_0xc5d7e5(0x32a)](_0x2c58c6);if(_0x1ee414[_0xc5d7e5(0x233)][_0xc5d7e5(0x2fc)])_0x1ee414['settings']['loginRequired']=![];if(_0x1ee414['settings']['bbPassword'])_0x1ee414[_0xc5d7e5(0x233)]['bbPassword']=_0xc5d7e5(0x284);if(_0x1ee414[_0xc5d7e5(0x233)][_0xc5d7e5(0x310)])_0x1ee414[_0xc5d7e5(0x233)][_0xc5d7e5(0x310)]=_0xc5d7e5(0x284);if(_0x1ee414['settings'][_0xc5d7e5(0x35e)])_0x1ee414['settings'][_0xc5d7e5(0x35e)]=null;if(_0x1ee414[_0xc5d7e5(0x233)][_0xc5d7e5(0x318)])_0x1ee414[_0xc5d7e5(0x233)][_0xc5d7e5(0x318)]=_0xc5d7e5(0x284);_0x2c58c6=JSON['stringify'](_0x1ee414,null,0x2);}if(_0x482fad[_0xc5d7e5(0x392)]!=_0xc5d7e5(0x3a4))_0x37275d['file'](_0x482fad[_0xc5d7e5(0x392)],_0x2c58c6);}else _0x37275d[_0xc5d7e5(0x1f4)](_0x482fad[_0xc5d7e5(0x392)],_0x2c58c6);}});const _0x1b38b3=await _0x37275d[_0x2985ed(0x1f8)]({'type':_0x2985ed(0x23b),'base64':![],'compression':'DEFLATE'});fs[_0x2985ed(0x391)](zippath+(_0x34d1d8+_0x2985ed(0x377)),_0x1b38b3,_0x2985ed(0x38e));}async function unzipFile(_0x19c23b,_0x4434a3){const _0x1553a1=_0x433ce9;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x1553a1(0x302)](_0x317d7e=>{const _0x4337b3=_0x1553a1;if(!_0x317d7e['isDirectory']())fs[_0x4337b3(0x325)](configpath+_0x317d7e[_0x4337b3(0x392)]);});const _0x570c36=fs[_0x1553a1(0x240)](_0x19c23b+_0x4434a3,_0x1553a1(0x38e)),_0x39d81a=await JSZip[_0x1553a1(0x2c6)](_0x570c36,{'base64':![],'checkCRC32':!![]});for(const _0x4be8ea of Object[_0x1553a1(0x3c6)](_0x39d81a[_0x1553a1(0x2ef)])){const _0x27ea34=_0x39d81a[_0x1553a1(0x2ef)][_0x4be8ea],_0x2a1b40=await _0x27ea34['async'](_0x1553a1(0x23b));fs[_0x1553a1(0x391)](configpath+_0x27ea34[_0x1553a1(0x392)],_0x2a1b40);}fs[_0x1553a1(0x20c)](temppath,{'withFileTypes':!![]})['forEach'](_0x561427=>{const _0x548e02=_0x1553a1;if(!_0x561427[_0x548e02(0x2fe)]())fs['rmSync'](temppath+_0x561427['name']);}),logger[_0x1553a1(0x26e)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x1553a1(0x37d)]({'restore':!![]},_0x32f2ec=>{});}async function getPublicIp(){const _0x5364bb=_0x433ce9;try{const _0x1a9f9a=await axios[_0x5364bb(0x261)](_0x5364bb(0x1fb));publicip=_0x1a9f9a[_0x5364bb(0x2b4)]['ip'];}catch(_0x13a294){}}async function triggerAnalytics(){const _0x2790aa=_0x433ce9;if(!publicip)await getPublicIp();const _0x169716=getBotsWithMode();let _0x1f282a=0x0;_0x169716['forEach'](_0x26e66c=>{if(_0x26e66c['status']==='enabled')_0x1f282a++;});const _0xca01e8=getBotExchanges();mixpanel[_0x2790aa(0x32b)](_0x2790aa(0x2d8),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x169716[_0x2790aa(0x305)],'numbotsenabled':_0x1f282a,'exchanges':_0xca01e8,'environment':environment});}async function getMessages(){const _0x41b6bd=_0x433ce9,_0x12e04a=_0x41b6bd(0x1fc),_0xb08a43=new GraphQLClient(_0x12e04a),_0x5852ff={'authorization':_0x41b6bd(0x340)},_0x5e17f6=serverversion[_0x41b6bd(0x33f)]('.'),_0x1158bf=_0x5e17f6[0x0]+'.'+_0x5e17f6[0x1],_0x2918b6=Math['min'](settings[_0x41b6bd(0x35f)],settings[_0x41b6bd(0x20e)]),_0x261999={'last':parseInt(_0x2918b6),'bbm':_0x1158bf},_0x11e519=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xcc13dc;try{_0xcc13dc=await _0xb08a43[_0x41b6bd(0x2b1)](_0x11e519,_0x261999,_0x5852ff);}catch(_0x164474){}if(_0xcc13dc&&_0xcc13dc[_0x41b6bd(0x1f6)]){let _0x54a12e=settings[_0x41b6bd(0x35f)],_0x9b0e3f=settings[_0x41b6bd(0x35f)];newMessages=[];for(const _0x5e3fe9 of _0xcc13dc[_0x41b6bd(0x1f6)]){newMessages[_0x41b6bd(0x230)](_0x5e3fe9);let _0x13bd25=![];_0x5e3fe9[_0x41b6bd(0x200)]&&(updateSetting(_0x41b6bd(0x292),_0x5e3fe9[_0x41b6bd(0x200)]),_0x13bd25=isNewerVersion(serverversion,_0x5e3fe9[_0x41b6bd(0x200)])||serverversion==_0x5e3fe9[_0x41b6bd(0x200)]);if(!_0x13bd25&&_0x5e3fe9[_0x41b6bd(0x390)]>_0x54a12e){if(_0x5e3fe9[_0x41b6bd(0x38b)]===_0x41b6bd(0x24a)||serverversion['startsWith'](_0x5e3fe9['bbvReceive'])){let _0x528e47=''+_0x5e3fe9[_0x41b6bd(0x2af)]+'\x0a\x0a'+_0x5e3fe9[_0x41b6bd(0x3c4)];const _0x44e849=await sendTelegramMsg(toTelegramMarkdown(_0x528e47),_0x41b6bd(0x259));_0x54a12e=_0x5e3fe9['number'];}}_0x9b0e3f=_0x5e3fe9[_0x41b6bd(0x390)];}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x41b6bd(0x35f),_0x9b0e3f),emitMessages();}}function emitMessages(){const _0x1f2be1=_0x433ce9,_0x4e00ba=settings['lastmsgemitted'];let _0x3cdb17=[];newMessages[_0x1f2be1(0x302)](_0x3110d1=>{const _0x370259=_0x1f2be1;_0x3110d1[_0x370259(0x390)]>_0x4e00ba&&_0x3cdb17[_0x370259(0x230)](_0x3110d1);}),_0x3cdb17[_0x1f2be1(0x305)]>0x0&&getAllClients()[_0x1f2be1(0x302)](_0x3fa32c=>{const _0x47052c=_0x1f2be1;getSocket(_0x3fa32c['id'])[_0x47052c(0x1ff)](_0x47052c(0x3c4),_0x3cdb17);});}function confirmMessage(_0x3329f0){const _0x228da1=_0x433ce9;updateSetting(_0x228da1(0x20e),Number(_0x3329f0));}function isNewerVersion(_0x5946d6,_0x2c0688){const _0x4bd041=_0x433ce9,_0x3e618d=_0x2c0688[_0x4bd041(0x33f)]('.'),_0x5429c9=_0x5946d6[_0x4bd041(0x33f)]('.');for(var _0xe49dc2=0x0;_0xe49dc2<_0x5429c9['length'];_0xe49dc2++){const _0x5a16a1=~~_0x5429c9[_0xe49dc2],_0x1cf287=~~_0x3e618d[_0xe49dc2];if(_0x5a16a1>_0x1cf287)return!![];if(_0x5a16a1<_0x1cf287)return![];}return![];}function toTelegramMarkdown(_0x52c5b1){const _0x3664ab=_0x433ce9,_0x380163=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3c8c51=/\*{2}(.+?)\*{2}/gim;return _0x52c5b1=_0x52c5b1[_0x3664ab(0x3d5)](_0x380163,_0x3664ab(0x276))[_0x3664ab(0x3d5)](_0x3c8c51,_0x3664ab(0x2ba)),_0x52c5b1;}async function validateConfigFile(){const _0x4d635c=_0x433ce9,_0x451f2b=dbConfig['get']('bots')['sortBy'](_0x4d635c(0x3a8))['value']()||[];if(_0x451f2b[_0x4d635c(0x305)]==0x0){let _0x310b72=0x0,_0x49b629=[];const _0x5b3860=/^bot-([0-9]{3})-config.json$/,_0x2d0961=fs[_0x4d635c(0x20c)](configpath);_0x2d0961[_0x4d635c(0x302)](_0x55987a=>{const _0x1c1a5d=_0x4d635c,_0xbfe6c7=_0x5b3860['exec'](_0x55987a);if(_0xbfe6c7){const _0x4d34a5=_0xbfe6c7[0x1];let _0x1a2c27=getBotAttributes(_0x4d34a5);_0x49b629[_0x1c1a5d(0x230)]({'botID':_0x4d34a5,'botname':_0x1a2c27[_0x1c1a5d(0x3c9)],'status':'disabled','live':'stopped'}),_0x310b72++;}}),_0x310b72!=0x0&&(dbConfig['get'](_0x4d635c(0x31d))['assign'](_0x49b629)[_0x4d635c(0x348)](),config=_0x49b629,restoredConfigFile=_0x310b72);}}async function restoreConfigNotify(_0x397c3d){const _0x171ab7=_0x433ce9;let _0x5f591e;if(restoredConfigFile==0x1)_0x5f591e=_0x171ab7(0x3f2);else _0x5f591e=_0x171ab7(0x2a7);if(_0x397c3d)io['to']('botmanager')[_0x171ab7(0x1ff)](_0x171ab7(0x3c8),_0x5f591e);else{logger[_0x171ab7(0x3df)](_0x171ab7(0x3b9)),logger['simple'](_0x5f591e),logger[_0x171ab7(0x3df)]('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings[_0x171ab7(0x35e)]&&settings[_0x171ab7(0x256)]!='orders')await sendTelegram(settings[_0x171ab7(0x35e)],_0x171ab7(0x3aa)+_0x5f591e);}}function decryptRSA(_0x26b246,_0x464aed){const _0x5d819a=_0x433ce9,_0x32d618=forge[_0x5d819a(0x380)][_0x5d819a(0x236)](_0x26b246),_0x393fb7=_0x32d618['decrypt'](forge['util']['decode64'](_0x464aed),_0x5d819a(0x24f),{'md':forge['md'][_0x5d819a(0x352)][_0x5d819a(0x331)](),'mgf1':{'md':forge['md']['sha256'][_0x5d819a(0x331)]()}});return _0x393fb7;}function validateCredentials(_0x2e42f2,_0x5884c6){const _0x10955d=_0x433ce9;if(_0x2e42f2[_0x10955d(0x255)]==settings['bbUsername']&&bcrypt['compareSync'](_0x2e42f2[_0x10955d(0x298)],settings[_0x10955d(0x26d)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x10955d(0x262),'token':null};else{const _0x4a218c=generateLoginToken(_0x5884c6);return{'allow':!![],'reason':_0x10955d(0x22a),'token':_0x4a218c};}}else return{'allow':![],'reason':_0x10955d(0x2b0),'token':null};}function refreshToken(_0x5e512f){const _0x261074=_0x433ce9,_0x2f1ffe=generateLoginToken(_0x5e512f);return{'allow':!![],'reason':_0x261074(0x22a),'token':_0x2f1ffe};}function validateAccess(_0xf56360,_0xe5f316,_0x380891){const _0x2f955f=_0x433ce9,_0x5d09c9=_0x380891?_0x380891:devices[_0xe5f316]['ip'];let _0x1050a9;const _0x24f965=_0x20ccbd=>{const _0x14df0f=_0x2499;if(settings[_0x14df0f(0x2fc)]){if(settings[_0x14df0f(0x3a7)]){if(telegram2FaApproved(_0xe5f316)){const _0x155205=generateLoginToken(_0xe5f316);return{'allow':!![],'reason':_0x14df0f(0x307),'token':_0x155205};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x1050a9=validToken(_0x20ccbd,_0xe5f316),_0x1050a9[_0x14df0f(0x3ab)]('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x20ccbd}:{'allow':![],'reason':_0x14df0f(0x29c),'token':null};}else return{'allow':!![],'reason':_0x14df0f(0x3f0),'token':null};};if(settings[_0x2f955f(0x329)]){let _0x26d3ba=[...settings['whitelist'],_0x2f955f(0x2c4),_0x2f955f(0x389),_0x2f955f(0x2bf),_0x2f955f(0x1f7)];if(_0x26d3ba['includes'](_0x5d09c9))return _0x24f965(_0xf56360);else{_0x1050a9=validToken(_0xf56360,_0xe5f316);if(_0x1050a9[_0x2f955f(0x3ab)](_0x2f955f(0x3c2)))return _0x24f965(_0xf56360);else{if(telegramIpApproved(_0xe5f316)){const _0x2068aa=generateToken(_0xe5f316);return _0x1050a9=_0x24f965(_0xf56360),_0x1050a9[_0x2f955f(0x2fd)]?{'allow':!![],'reason':_0x2f955f(0x3a9),'token':_0x2068aa}:_0x1050a9;}else return settings[_0x2f955f(0x345)]?{'allow':![],'reason':_0x2f955f(0x227),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x24f965(_0xf56360);}function timelyDecrypt(_0x47e5ec,_0x550d51,_0xebf979='@'){const _0x22af64=_0x433ce9;if(_0x47e5ec)try{const _0x45a5e7=decryptRSA(secure[_0x22af64(0x28f)],_0x47e5ec),_0x5af42f=_0x45a5e7[_0x22af64(0x33f)](_0xebf979)[0x0],_0x3588c8=_0x45a5e7[_0x22af64(0x33f)](_0xebf979)[0x1],_0x17731f=new Date()['getTime']();if(_0x550d51){if(_0x17731f-_0x3588c8<maxSecretAge*0x3e8)return _0x5af42f;else return![];}else return _0x5af42f;}catch(_0x2cc402){return![];}else return![];}const validToken=(_0xe0d575,_0x344b5f)=>{const _0x31bfd4=_0x433ce9,_0x2828b2=devices[_0x344b5f]['ip'];if(!_0xe0d575)return{'error':_0x31bfd4(0x387)};for(let _0x39d763 of blacklist){if(_0x39d763['token']==_0xe0d575)return{'error':_0x31bfd4(0x31c)};}let _0xaff3da;try{_0xaff3da=jwt['verify'](_0xe0d575,secure[_0x31bfd4(0x20f)]+_0x344b5f);}catch{return{'error':_0x31bfd4(0x36d)};}if(!_0xaff3da['hasOwnProperty'](_0x31bfd4(0x374))&&!_0xaff3da[_0x31bfd4(0x3ab)](_0x31bfd4(0x255))||!_0xaff3da[_0x31bfd4(0x3ab)](_0x31bfd4(0x21e)))return{'error':_0x31bfd4(0x3ba)};if(!_0xaff3da['hasOwnProperty'](_0x31bfd4(0x255))&&_0xaff3da[_0x31bfd4(0x3ab)](_0x31bfd4(0x374))){const {clientip:_0x18fd9b}=_0xaff3da;return _0x2828b2==_0x18fd9b?{'success':_0x31bfd4(0x38f)}:{'error':_0x31bfd4(0x22e)};}else{if(_0xaff3da['hasOwnProperty']('username')&&_0xaff3da[_0x31bfd4(0x3ab)](_0x31bfd4(0x374))){const {username:_0x462da8,clientip:_0x2bbccd}=_0xaff3da;return settings['bbUsername']==_0x462da8&&_0x2828b2==_0x2bbccd?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x1907e0=>{const _0x363f39=_0x433ce9;if(_0x1907e0){const _0x51c60d=devices[_0x1907e0]['ip'];return jwt[_0x363f39(0x3fd)]({'username':settings[_0x363f39(0x252)],'clientip':_0x51c60d},secure[_0x363f39(0x20f)]+_0x1907e0,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0xed3d9b=>{const _0x481a3c=_0x433ce9;if(_0xed3d9b){const _0x3a9f69=devices[_0xed3d9b]['ip'];return jwt[_0x481a3c(0x3fd)]({'clientip':_0x3a9f69},secure[_0x481a3c(0x20f)]+_0xed3d9b,{'expiresIn':devices[_0xed3d9b][_0x481a3c(0x3c0)][_0x481a3c(0x354)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x11b06e=>{const _0x4ea838=_0x433ce9;let _0x2bfc05=![];return devices[_0x11b06e][_0x4ea838(0x3c0)]&&devices[_0x11b06e]['telegramIpApproval'][_0x4ea838(0x354)]!=_0x4ea838(0x2d0)&&(_0x2bfc05=devices[_0x11b06e][_0x4ea838(0x3c0)][_0x4ea838(0x374)]==devices[_0x11b06e]['ip']&&new Date()[_0x4ea838(0x25a)]()-devices[_0x11b06e]['telegramIpApproval'][_0x4ea838(0x2a3)]<devices[_0x11b06e][_0x4ea838(0x3c0)][_0x4ea838(0x354)]*0x3c*0x3e8),_0x2bfc05;},telegram2FaApproved=_0xbd12ad=>{const _0x20f591=_0x433ce9;let _0x3c93ae=![];return devices[_0xbd12ad][_0x20f591(0x2f6)]&&devices[_0xbd12ad][_0x20f591(0x2f6)][_0x20f591(0x354)]!=_0x20f591(0x2d0)&&(_0x3c93ae=devices[_0xbd12ad][_0x20f591(0x2f6)][_0x20f591(0x374)]==devices[_0xbd12ad]['ip']&&new Date()[_0x20f591(0x25a)]()-devices[_0xbd12ad][_0x20f591(0x2f6)][_0x20f591(0x2a3)]<devices[_0xbd12ad][_0x20f591(0x2f6)][_0x20f591(0x354)]*0x3c*0x3e8),_0x3c93ae;},normalizeIP=_0x2d645c=>{const _0x149826=_0x433ce9;let _0x39ee3d=null,_0x24b56c=null;if(ipaddr['isValid'](_0x2d645c)){const _0x5922fe=ipaddr[_0x149826(0x32a)](_0x2d645c);_0x5922fe[_0x149826(0x336)]()===_0x149826(0x39c)?(_0x5922fe[_0x149826(0x27d)]()&&(_0x39ee3d=_0x5922fe[_0x149826(0x221)]()[_0x149826(0x286)]()),_0x24b56c=_0x5922fe[_0x149826(0x286)]()):(_0x39ee3d=_0x5922fe[_0x149826(0x286)](),_0x24b56c=_0x5922fe['toIPv4MappedAddress']()['toString']());}return{'show':_0x39ee3d?_0x39ee3d:_0x24b56c,'store':_0x24b56c};};function formatDate(_0xd34667){const _0x4fcc12=_0x433ce9;return _0xd34667[_0x4fcc12(0x26b)]()+'/'+(_0xd34667[_0x4fcc12(0x291)]()+0x1)[_0x4fcc12(0x286)]()[_0x4fcc12(0x398)](0x2,'0')+'/'+_0xd34667[_0x4fcc12(0x3ea)]()[_0x4fcc12(0x286)]()['padStart'](0x2,'0')+'\x20'+_0xd34667[_0x4fcc12(0x2d1)]()[_0x4fcc12(0x286)]()[_0x4fcc12(0x398)](0x2,'0')+':'+_0xd34667[_0x4fcc12(0x328)]()[_0x4fcc12(0x286)]()[_0x4fcc12(0x398)](0x2,'0')+':'+_0xd34667['getSeconds']()[_0x4fcc12(0x286)]()[_0x4fcc12(0x398)](0x2,'0');}function sleep(_0x45f806){return new Promise(_0x2b3eaf=>setTimeout(_0x2b3eaf,_0x45f806));}