const _0x155ac1=_0x3b45;(function(_0x3c26de,_0x64465e){const _0x3756b9=_0x3b45,_0x3593ff=_0x3c26de();while(!![]){try{const _0xb0325=parseInt(_0x3756b9(0x29a))/0x1+parseInt(_0x3756b9(0x28f))/0x2+-parseInt(_0x3756b9(0x14b))/0x3*(-parseInt(_0x3756b9(0x2fd))/0x4)+parseInt(_0x3756b9(0x25c))/0x5+parseInt(_0x3756b9(0x240))/0x6*(parseInt(_0x3756b9(0x166))/0x7)+parseInt(_0x3756b9(0x189))/0x8+-parseInt(_0x3756b9(0x193))/0x9*(parseInt(_0x3756b9(0x148))/0xa);if(_0xb0325===_0x64465e)break;else _0x3593ff['push'](_0x3593ff['shift']());}catch(_0x27f0cf){_0x3593ff['push'](_0x3593ff['shift']());}}}(_0x5eb5,0x9103f));const _0x52bdc3=function(){let _0x38821e=!![];return function(_0x9259a8,_0x2cf528){const _0x43f430=_0x38821e?function(){const _0x4541e0=_0x3b45;if(_0x2cf528){const _0x3add2c=_0x2cf528[_0x4541e0(0x30e)](_0x9259a8,arguments);return _0x2cf528=null,_0x3add2c;}}:function(){};return _0x38821e=![],_0x43f430;};}(),_0x44537c=_0x52bdc3(this,function(){const _0x5970a6=_0x3b45;return _0x44537c[_0x5970a6(0x21d)]()['search'](_0x5970a6(0x183))[_0x5970a6(0x21d)]()[_0x5970a6(0x229)](_0x44537c)[_0x5970a6(0x232)](_0x5970a6(0x183));});_0x44537c();'use strict';process[_0x155ac1(0x1e5)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x155ac1(0x16d)),fs=require('fs'),fns=require(_0x155ac1(0x162)),low=require(_0x155ac1(0x2b6)),FileSync=require(_0x155ac1(0x1bf)),path=require(_0x155ac1(0x259)),crypto=require(_0x155ac1(0x1f7)),forge=require('node-forge'),bcrypt=require(_0x155ac1(0x144)),jwt=require(_0x155ac1(0x255)),ipaddr=require(_0x155ac1(0x2f2)),argv=require(_0x155ac1(0x1d8))(process['argv']['slice'](0x2))['argv'],uuidRandom=require(_0x155ac1(0x33e)),{Telegraf,Markup}=require(_0x155ac1(0x2f3)),Mixpanel=require(_0x155ac1(0x31b)),axios=require(_0x155ac1(0x1d7)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x155ac1(0x250)),fileUpload=require(_0x155ac1(0x322)),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv['port']||_0x155ac1(0x178),pattern=/^[0-9]{2,4}$/;!pattern[_0x155ac1(0x28a)](PORT)&&(console['log']('Error:\x20Invalid\x20argument\x20'+PORT+_0x155ac1(0x1e8)),process['exit'](0x1));const HOST=argv['host']||null,userID=argv[_0x155ac1(0x180)]||'',debugging=argv['d']||![],nodeversion=process[_0x155ac1(0x1d6)][_0x155ac1(0x155)];let bbpath=_0x155ac1(0x212),bbpath2='';const botfile=_0x155ac1(0x2ac),configfile=_0x155ac1(0x128),settingsfile=_0x155ac1(0x304),securefile='bb-secure.json',environment=require('./'+bbpath2+_0x155ac1(0x242))[_0x155ac1(0x213)]||_0x155ac1(0x23c),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x155ac1(0x13b)),configpath=userID?bbpath+_0x155ac1(0x210)+userID+'/':bbpath+_0x155ac1(0x210),configbackuppath=configpath+_0x155ac1(0x32e),logspath=userID?bbpath+_0x155ac1(0x19a)+userID+'/':bbpath+_0x155ac1(0x19a),zippath=userID?bbpath+_0x155ac1(0x24e)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x155ac1(0x2ed)](logspath+_0x155ac1(0x1bc),{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x155ac1(0x275);!fs['existsSync'](configpath)&&fs[_0x155ac1(0x30d)](configpath);!fs[_0x155ac1(0x257)](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x155ac1(0x257)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x155ac1(0x257)](zippath)&&fs[_0x155ac1(0x30d)](zippath);!fs[_0x155ac1(0x257)](temppath)&&fs[_0x155ac1(0x30d)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x155ac1(0x289)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x155ac1(0x16b)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x155ac1(0x289)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x155ac1(0x16b)]({'secure':{},'blacklist':[]})[_0x155ac1(0x289)]();function _0x5eb5(){const _0xf7c010=['SIGINT','family','User\x20has\x20been\x20validated','uuid','files','-results.json','telegramEvents','3000','success','yes','apiSecret','telegramChatId','update_no','Unauthorized\x20attempt\x20to\x20delete\x20bot','expiry','user','inherit','telegram2FaApproval','(((.+)+)+)+$','tempaccess_5_','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','1000','copyFileSync','static','6967392JKWDhx','readdirSync','then','ETH','Allow\x20login\x20from\x20IP\x20address\x20','$1_$2_$3','Node.js\x20v','exit','Deleted\x20Bot\x20','backup','29583459KuhYEW','/:bot/history','confirm-message','access','\x20|\x20user:\x20...','tempaccess_reject_','get-messages','logs/','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','telegramEnabled','auth','hasOwnProperty','length','replace','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','login\x20token\x20generated','backupfile','address\x20already\x20in\x20use','statSync','connected','telegramIpApproval','match','login','\x20mode','password','Markdown','chat','from','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Bot\x20','backup-full@','\x20only\x0a','value','config','Invalid\x20IP\x20address','exchange','text','createServer','stringify','disable','track','/output-000.log','temporary\x20token\x20generated','-----------------------------------------------------------------------------------','lowdb/adapters/FileSync','storeHeadless','-events.json','replyWithDocument','bbvReceive','metrics',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','output-001.log','privateKeyToPem','token','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Backup\x20file\x20uploaded','/download/:type','max','apiPassword','/:bot/portfolio','sortBy','started','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','reset-history','portfolio','Invalid\x20username\x20or\x20IP\x20address','reinstall-bb','versions','axios','yargs/yargs','new-disabled','2FA\x20required','latestversion','emitHistory','Unauthorized\x20attempt\x20to\x20add\x20bot','disabled','internal','Error\x20while\x20deleting\x20config\x20files:\x20','Unauthorized\x20attempt\x20to\x20log\x20out','loadAsync','getStartingBalances','Login\x20rejected','env','Temporary\x20access\x20rejected','Notifications\x20enabled\x0a',',\x20must\x20be\x20a\x204\x20digit\x20number','stop','size','\x20files\x20over\x20Telegram:','|@|','orders','.zip','live','create','2FA\x20login\x20token\x20generated','remoteAddress','index.html','sendPortfolioTelegram','debug','/:bot/coins','crypto','f2aRequired','Telegram\x20error:','warning','forEach','login\x20not\x20required','sendMetricsTelegram','Login\x20accepted','cancel-loading','event','enable','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','config_all','Access\x20enabled\x20for\x20','sort','publicKey','startsWith','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','connection','login2fa_reject_','build2','add','bot-','inlineKeyboard','getDate','config/','Running\x20#RED#Balance\x20Bot\x20v','bb/','environment','entries','marketcapApi','download',')\x20\x20\x20|\x20Bot\x20','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','#RES#\x20if\x20running\x20on\x20server','toggleBotMode','login2fa_','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','toString','auto','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','sign','Session\x20expired\x20for\x20user\x20...','Unauthorized\x20attempt\x20to\x20get\x20messages','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','off','order','All','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','new','constructor','Notifications\x20types:\x20','loginRequired','version','Telegraf\x20error:','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','::ffff:127.0.0.1','Unauthorized\x20attempt\x20to\x20show\x20configuration','Password\x20has\x20been\x20reset\x20to:\x20','search','place-order','timestamp','getMinutes','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','privateKeyFromPem','reply','Invalid\x20authentication\x20token\x20(1)','secret','binary','production','log','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','No\x20bots\x20running\x20right\x20now','18YeVsIt','clientip','version.json','disconnect','sha256','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','/upload-backup','off_','reason','find','Idling\x20(','IPv4','metrics_','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','zip/','_nsps','util','format','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','remove','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','jsonwebtoken','Restore\x20process\x20confirmed','existsSync','You\x20can\x20use\x20the\x20following\x20commands:\x0a','path','ipc','Error\x20sending\x20','5607595eqdRlg','Restoring\x20bot(s)\x20from\x20backup','All\x20bots\x20running\x20right\x20now','settings','Restore\x20backup\x20file\x20','bots','Logged\x20in\x20user\x20...','build','privateKey','error','tempaccess_30_','/:bot/support','launch','backup-full.zip','\x20>\x20','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','\x1b[31m','request','allow','generateAsync','function','resetHistory','updatebotmanager','temporary\x20access\x20rejected','************','temp/','cloneDeep','\x1b[33m','messages','access\x20timeout','telegramToken','Failed\x20to\x20download\x20','timeshift','rsa','socket','get-starting-balances','onepagemode','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Network\x20Interfaces:','getHours','help','stopped','file','Unauthorized\x20attempt\x20to\x20update\x20settings','lastmsgemitted','write','test','config_alerts','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','botmanager','/help\x20-\x20show\x20available\x20commands\x0a','742060CHDcXt','bb-secure.json','Starting\x20Balance\x20Bot\x20reinstallation','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','assign','removeAllListeners','mode','map','delete-alerts','send','isDirectory','266887ezXlSr','isValid','Yes','hex','2FA','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','blacklist','socket.io','username','express','*$1*','botID','lastmsgtelegram','action','exec','on_','backup-full','listen','bot.js','alias','Orders','randomFillSync','[ip-address]','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','/:bot/configuration','store-fiat','writeFileSync','DEFLATE','lowdb','manual','status','All\x20bots','/update\x20-\x20update\x20Balance\x20Bot\x0a','HTML','Error\x20removing\x20old\x20backup\x20files:','init','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',')\x20|\x20Bot\x20','apiKey','range','https://api.ipify.org?format=json','Server','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','catch','bbvNew','Backup\x20file\x20unzipped\x20and\x20stored','/status\x20-\x20show\x20bot(s)\x20status\x0a','/metrics\x20-\x20show\x20bot\x20performance\x0a','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','2FA\x20login\x20required','telegramUsername','args','0.0.0','getSeconds','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','post','\x1b[0m','port','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','name','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Restore\x20process\x20aborted','login\x20token\x20valid','alerts','Token\x20blacklisted','Unauthorized\x20attempt\x20to\x20confirm\x20message','all','Unauthorized\x20attempt\x20to\x20get\x20events','headless','<b>Telegram\x20Bot\x20Status:</b>\x0a','restore_yes_','\x20(2)','Invalid\x20authentication\x20token\x20(2)','getPortfolio','get-backup-files','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','data','Unauthorized\x20attempt\x20to\x20get\x20portfolio','pki','config_orders','use','/start','createWriteStream','filter','output-000.log','telegram','BCT','ipaddr.js','telegraf','bot','settings.','#RES#\x20','CoinMarketCap\x20API\x20key\x20validated','File\x20uploaded','handshake','full','/names\x20-\x20show\x20bot\x20names\x0a','get-logs','3148612kMSVMW','set','headers','rmSync','message','ipv6','getUTCHours','bb-settings.json','showConfig','parse','slice','userid','reload',':\x20Bot\x20Mgr\x20>\x20','update','editMessageReplyMarkup','mkdirSync','apply','decode64','server','Unauthorized\x20attempt\x20to\x20update\x20bot','\x20|\x20','bbUsername','logs','button','\x20-\x20','decrypt','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','/:bot/performance','pidRefreshToken','mixpanel','show','encryptedUuid','kind','output-003.log','Enabled\x20Bot\x20','get','express-fileupload','number','command','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','toIPv4Address','get-portfolio','temporary\x20access\x20not\x20allowed','compareSync','reinstall','any','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','getMonth','backup/','\x20(1)','store-headless','Setting\x20access:\x20','title','logged\x20out','getTime','Notifications\x20disabled','Ok,\x20will\x20send\x20order\x20notifications\x20only','endsWith','bbPassword','store-configuration','Alerts','store','http','Unauthorized\x20attempt\x20to\x20delete\x20alerts','uuid-random','emit','padStart','push','toIPv4MappedAddress','add-bot','tempaccess_15_','sendFile','address','type','bb-config.json','pidExpireLogin','/enable\x20-\x20enable\x20notifications\x0a','Bot\x20Mgr\x20>\x20','***','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','split','accept','callback','restore-backup-file','string','keys','tkn','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','once','notification','=>\x20Go\x20to\x20#CYA#http://','getFullYear','kill','clients','status\x20code\x20401','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','verify','-performance.json','30\x20min','Password\x20reset\x20rejected','enabled','/restart\x20-\x20restart\x20bot(s)\x0a','bcryptjs','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Disabled\x20Bot\x20','storeFiat','10GIhAmp','/logs\x20-\x20receive\x20log\x20files\x0a','login\x20required','3Afaiis','running','SIGTERM','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Restarting\x20Bot\x20','botname','sendMessage','sockets','publicKeyToPem','secure','node','restart','join','params','generateKeyPair','update_yes','toggle_',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','readFileSync','conn','deleteHistoryAlerts','referer','reinstall_yes','date-fns','-config.json','Unauthorized\x20attempt\x20to\x20download\x20','No\x20authentication\x20token','1081549JgMSWe','fork','unlinkSync','output-002.log','reject','defaults','logout','child_process','portfolio_','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','simple'];_0x5eb5=function(){return _0xf7c010;};return _0x5eb5();}const saltRounds=0xa,mixpanel=Mixpanel[_0x155ac1(0x2bd)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x155ac1(0x27a)]&&(settings[_0x155ac1(0x27a)]!=''&&settings[_0x155ac1(0x27a)]!=_0x155ac1(0x12c))&&settings[_0x155ac1(0x2cd)]&&settings[_0x155ac1(0x2cd)]!='')initTelegram();const parseColor=(_0x42298c,_0x2ae453)=>{const _0x134feb=_0x155ac1,_0x3236fe=/#[A-Z]{3}#/g;if(typeof _0x42298c=='string'){!_0x2ae453?_0x42298c=_0x42298c[_0x134feb(0x1a0)](_0x3236fe,''):(_0x42298c=_0x42298c['replace'](/#BLU#/g,'\x1b[34m'),_0x42298c=_0x42298c['replace'](/#RED#/g,_0x134feb(0x26c)),_0x42298c=_0x42298c[_0x134feb(0x1a0)](/#YEL#/g,_0x134feb(0x277)),_0x42298c=_0x42298c[_0x134feb(0x1a0)](/#MAG#/g,'\x1b[35m'),_0x42298c=_0x42298c[_0x134feb(0x1a0)](/#CYA#/g,'\x1b[36m'),_0x42298c=_0x42298c[_0x134feb(0x1a0)](/#RES#/g,_0x134feb(0x2d3)));;}return _0x42298c;},logger={'screen':_0x47075e=>{const _0x52579b=_0x155ac1;console[_0x52579b(0x23d)](parseColor(_0x47075e,!![]));},'simple':_0x16b7dd=>{const _0x143e11=_0x155ac1;console['log'](parseColor(_0x16b7dd,!![])),loggerfile[_0x143e11(0x289)](util[_0x143e11(0x251)](parseColor(_0x16b7dd,![]))+'\x0a');},'full':async _0x110d0f=>{const _0x4a7505=_0x155ac1,_0x283e78=getTimeStamp()+_0x4a7505(0x30a)+_0x110d0f;console['log'](parseColor(_0x283e78,!![])),loggerfile[_0x4a7505(0x289)](util[_0x4a7505(0x251)](parseColor(_0x283e78,![]))+'\x0a');if(tgBot&&settings[_0x4a7505(0x17c)]&&settings[_0x4a7505(0x177)]!=_0x4a7505(0x1ed))await sendTelegram(settings[_0x4a7505(0x17c)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x110d0f,![]));},'debug':async(_0x131b09,_0x27a0ba='')=>{const _0x5ba127=_0x155ac1,_0x23b498=getTimeStamp()+_0x5ba127(0x15c)+_0x131b09;if(debugging)console[_0x5ba127(0x23d)](parseColor(_0x23b498,!![]));loggerfile[_0x5ba127(0x289)](util[_0x5ba127(0x251)](parseColor(_0x23b498,![]))+'\x0a');if(_0x27a0ba){if(debugging)console[_0x5ba127(0x23d)](_0x27a0ba);loggerfile[_0x5ba127(0x289)](util[_0x5ba127(0x251)](_0x27a0ba)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x13e34f){const _0x4153c2=_0x155ac1;_0x13e34f[_0x4153c2(0x21d)]()['includes'](_0x4153c2(0x1a4))?(logger[_0x4153c2(0x170)](_0x4153c2(0x28c)+_0x13e34f[_0x4153c2(0x2d4)]+'#RES#'),process[_0x4153c2(0x298)]({'terminate':!![]},_0x4dca4d=>{})):logger[_0x4153c2(0x170)](_0x13e34f);}),process['on'](_0x155ac1(0x190),()=>{const _0x568278=_0x155ac1;stopAllBots(),process[_0x568278(0x190)](0x0);}),process['on'](_0x155ac1(0x14d),()=>{const _0x4666c1=_0x155ac1;stopAllBots(),process[_0x4666c1(0x190)](0x0);}),process['on'](_0x155ac1(0x171),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x155ac1(0x22c)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x155ac1(0x2a3)),app=express(),http=require(_0x155ac1(0x33c))[_0x155ac1(0x1b8)](app);app[_0x155ac1(0x2eb)](fileUpload({'useTempFiles':!![]})),app[_0x155ac1(0x321)](_0x155ac1(0x1cb),async(_0x5a03cc,_0x6cb95d)=>{const _0x376f55=_0x155ac1,_0x2017b1=_0x5a03cc[_0x376f55(0x158)][_0x376f55(0x127)],_0x3d57fe=getClientsWithBotID(_0x376f55(0x28d)),_0x5a6022=_0x5a03cc['headers']['uuid'],_0x2b90ca=timelyDecrypt(_0x5a6022,![]),_0x500772=_0x3d57fe[_0x376f55(0x249)](_0x447a6a=>_0x447a6a[_0x376f55(0x174)]==_0x2b90ca);if(_0x500772){const _0x1781fe=normalizeIP(_0x5a03cc[_0x376f55(0x27e)][_0x376f55(0x1f2)])[_0x376f55(0x33b)],_0x5d2779=_0x5a03cc[_0x376f55(0x2ff)][_0x376f55(0x134)];if(validateAccess(_0x5d2779,_0x2b90ca,_0x1781fe)['allow'])_0x2017b1==_0x376f55(0x192)&&await backupConfigFiles(),await zipFiles(_0x2017b1),_0x6cb95d[_0x376f55(0x216)](zippath+(_0x2017b1+'.zip'),_0x1a66bf=>{const _0x457450=_0x376f55;_0x1a66bf&&(logger['full'](_0x457450(0x27b)+_0x2017b1),logger[_0x457450(0x170)](_0x1a66bf));});else logger[_0x376f55(0x2fa)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x2017b1+_0x376f55(0x32f));}else logger[_0x376f55(0x2fa)](_0x376f55(0x164)+_0x2017b1+_0x376f55(0x2e2));}),app[_0x155ac1(0x2d2)](_0x155ac1(0x246),async(_0x510c91,_0x3c5734)=>{const _0x59f93f=_0x155ac1,_0x2f7cb8=getClientsWithBotID(_0x59f93f(0x28d)),_0x5512be=_0x510c91['headers'][_0x59f93f(0x174)],_0x20a765=timelyDecrypt(_0x5512be,![]),_0x1423e4=_0x2f7cb8['find'](_0xce4770=>_0xce4770['uuid']==_0x20a765);logger[_0x59f93f(0x1f5)](_0x59f93f(0x1ca));if(_0x1423e4){const _0xd61989=normalizeIP(_0x510c91[_0x59f93f(0x27e)]['remoteAddress'])[_0x59f93f(0x33b)],_0x33b7e6=_0x510c91[_0x59f93f(0x2ff)][_0x59f93f(0x134)];if(validateAccess(_0x33b7e6,_0x20a765,_0xd61989)[_0x59f93f(0x26e)]){if(_0x510c91['files']){const _0x4b31ba=_0x510c91[_0x59f93f(0x175)][_0x59f93f(0x1a3)];await _0x4b31ba['mv'](temppath+_0x4b31ba[_0x59f93f(0x2d6)]),_0x3c5734[_0x59f93f(0x298)]({'status':!![],'message':_0x59f93f(0x2f8)});const _0x39d864=getBotsWithMode();_0x39d864[_0x59f93f(0x19f)]>0x0?confirmRestore(temppath,_0x4b31ba[_0x59f93f(0x2d6)]):unzipFile(temppath,_0x4b31ba[_0x59f93f(0x2d6)]);}}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger['full'](_0x59f93f(0x23e));}),app['use'](express[_0x155ac1(0x188)](path[_0x155ac1(0x157)](__dirname,bbpath2,_0x155ac1(0x20b)))),app[_0x155ac1(0x2eb)](express[_0x155ac1(0x188)](path[_0x155ac1(0x157)](__dirname,bbpath2,_0x155ac1(0x263)))),app['get']('/',function(_0x1b4abd,_0x2713e9){const _0x4ec207=_0x155ac1;_0x2713e9['sendFile'](path['join'](__dirname,bbpath2,_0x4ec207(0x20b),_0x4ec207(0x1f3)));}),app['get']('/:bot',function(_0x1de8b2,_0x3efc10){const _0x3fb1d7=_0x155ac1;_0x3efc10['sendFile'](path['join'](__dirname,bbpath2,_0x3fb1d7(0x263),'index.html'));}),app[_0x155ac1(0x321)](_0x155ac1(0x1ce),(_0x4f62f5,_0x58f0bd)=>{const _0xef0488=_0x155ac1;_0x58f0bd[_0xef0488(0x125)](path['join'](__dirname,bbpath2,_0xef0488(0x263),_0xef0488(0x1f3)));}),app['get'](_0x155ac1(0x319),(_0x148915,_0x117f27)=>{const _0x31835e=_0x155ac1;_0x117f27['sendFile'](path[_0x31835e(0x157)](__dirname,bbpath2,'build','index.html'));}),app[_0x155ac1(0x321)](_0x155ac1(0x1f6),(_0x37cf88,_0x4eea5)=>{const _0x3cd9f6=_0x155ac1;_0x4eea5['sendFile'](path['join'](__dirname,bbpath2,'build',_0x3cd9f6(0x1f3)));}),app['get'](_0x155ac1(0x194),(_0x29f69d,_0x4c972e)=>{const _0x1c2a65=_0x155ac1;_0x4c972e[_0x1c2a65(0x125)](path[_0x1c2a65(0x157)](__dirname,bbpath2,_0x1c2a65(0x263),_0x1c2a65(0x1f3)));}),app[_0x155ac1(0x321)](_0x155ac1(0x2b2),(_0x38e268,_0x2a7516)=>{const _0x2a651e=_0x155ac1;_0x2a7516[_0x2a651e(0x125)](path[_0x2a651e(0x157)](__dirname,bbpath2,_0x2a651e(0x263),_0x2a651e(0x1f3)));}),app[_0x155ac1(0x321)](_0x155ac1(0x267),(_0x1270b6,_0x23aa26)=>{const _0x581289=_0x155ac1;_0x23aa26[_0x581289(0x125)](path[_0x581289(0x157)](__dirname,bbpath2,_0x581289(0x263),_0x581289(0x1f3)));});if(HOST)http[_0x155ac1(0x2ab)](PORT,HOST);else http[_0x155ac1(0x2ab)](PORT);const io=require(_0x155ac1(0x2a1))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x4a1411=_0x155ac1;let _0x3edc38=_0x4a1411(0x2b0);const _0x3d0013=networkInterfaces(),_0x5862ef={};for(const _0x577e92 of Object[_0x4a1411(0x133)](_0x3d0013)){for(const _0x15d699 of _0x3d0013[_0x577e92]){if((_0x15d699[_0x4a1411(0x172)]==_0x4a1411(0x24b)||_0x15d699['family']==0x4)&&!_0x15d699[_0x4a1411(0x1df)]){const _0x5e6a29=ipaddr[_0x4a1411(0x306)](_0x15d699['address'])[_0x4a1411(0x2c2)]();_0x5e6a29!='private'&&(!_0x5862ef[_0x577e92]&&(_0x5862ef[_0x577e92]=[]),_0x5862ef[_0x577e92][_0x4a1411(0x121)](_0x15d699[_0x4a1411(0x126)]),_0x3edc38=_0x15d699[_0x4a1411(0x126)]);}}}return{'serverip':_0x3edc38,'netinterfaces':_0x5862ef};}async function startServer(){const _0x2c3ec9=_0x155ac1,{serverip:_0x4c938d,netinterfaces:_0x1e031c}=getServerIP();logger[_0x2c3ec9(0x170)](''),logger[_0x2c3ec9(0x170)](_0x2c3ec9(0x1be)),await logger[_0x2c3ec9(0x2fa)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x2c3ec9(0x2f6)+(environment=='staging'?'(staging)':'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x2c3ec9(0x138)+_0x4c938d+':'+PORT+_0x2c3ec9(0x219))),logger[_0x2c3ec9(0x170)]('-----------------------------------------------------------------------------------');if(config['length']!=0x0)for(const _0x4e3c54 of config){const _0x211dbb=_0x4e3c54['mode']==_0x2c3ec9(0x21e)?'a':'m';if(_0x4e3c54['status']==_0x2c3ec9(0x142)||_0x4e3c54[_0x2c3ec9(0x2b8)]=='new')await logger[_0x2c3ec9(0x2fa)]('Starting\x20('+_0x211dbb+_0x2c3ec9(0x2c0)+_0x4e3c54[_0x2c3ec9(0x2a5)]+_0x2c3ec9(0x312)+_0x4e3c54[_0x2c3ec9(0x150)]),startBot([_0x4e3c54['botID'],userID],{'cwd':bbpath},function(_0x5c4013){const _0x161f1e=_0x2c3ec9;if(_0x5c4013)logger[_0x161f1e(0x2fa)](_0x5c4013);});else(_0x4e3c54[_0x2c3ec9(0x2b8)]==_0x2c3ec9(0x1de)||_0x4e3c54[_0x2c3ec9(0x2b8)]==_0x2c3ec9(0x1d9))&&await logger[_0x2c3ec9(0x2fa)](_0x2c3ec9(0x24a)+_0x211dbb+_0x2c3ec9(0x217)+_0x4e3c54[_0x2c3ec9(0x2a5)]+_0x2c3ec9(0x312)+_0x4e3c54[_0x2c3ec9(0x150)]);}else!newBot&&logger['simple'](_0x2c3ec9(0x24d));if(newBot)addBot();logger[_0x2c3ec9(0x170)](_0x2c3ec9(0x1be)),logger[_0x2c3ec9(0x170)](''),await logger['debug'](_0x2c3ec9(0x18f)+nodeversion),await logger[_0x2c3ec9(0x1f5)](_0x2c3ec9(0x282),_0x1e031c);}function startSocket(){const _0x58965b=_0x155ac1;io['on'](_0x58965b(0x209),_0x4f36b4=>{const _0x8c18f0=_0x58965b;let _0x4a04e1,_0x1f4549,_0x385766,_0x40a217,_0x4c20a2;const _0x24161c=_0x4f36b4['handshake']['headers'][_0x8c18f0(0x160)];_0x1f4549=_0x24161c[_0x8c18f0(0x1a8)](/bot[0-9]{3}/);if(_0x1f4549)_0x385766=_0x1f4549[0x0]['match'](/[0-9]{3}/);if(_0x385766)_0x4a04e1=_0x385766[0x0];else _0x4a04e1='botmanager';const _0x2cb183=_0x4f36b4[_0x8c18f0(0x2f9)][_0x8c18f0(0x19d)][_0x8c18f0(0x31d)];if(!_0x2cb183)_0x4f36b4[_0x8c18f0(0x33f)](_0x8c18f0(0x2b8),{'publicKey':secure[_0x8c18f0(0x206)]});else{_0x40a217=timelyDecrypt(_0x2cb183,![]);if(!_0x40a217)_0x4f36b4[_0x8c18f0(0x33f)](_0x8c18f0(0x2b8),{'publicKey':secure[_0x8c18f0(0x206)]});else{_0x4c20a2=normalizeIP(_0x4f36b4[_0x8c18f0(0x15e)]['remoteAddress'])[_0x8c18f0(0x33b)];if(!devices[_0x40a217])devices[_0x40a217]={'uuid':_0x40a217,'access':{'token':null}};devices[_0x40a217]['ip']=_0x4c20a2;const _0x1c6e62=addClient(_0x4f36b4['id'],_0x40a217,_0x4a04e1);setAccess(_0x1c6e62),emitMessages(),_0x4f36b4['on'](_0x8c18f0(0x1a9),_0x20dcd6=>{const _0x266605=_0x8c18f0,_0x5166d7=timelyDecrypt(_0x20dcd6['password'],!![],_0x266605(0x1ec));if(_0x5166d7){_0x20dcd6={'username':_0x20dcd6[_0x266605(0x2a2)],'password':_0x5166d7},devices[_0x40a217][_0x266605(0x196)]=validateCredentials(_0x20dcd6,_0x40a217);if(devices[_0x40a217][_0x266605(0x196)][_0x266605(0x26e)]==![]&&devices[_0x40a217][_0x266605(0x196)][_0x266605(0x248)]==_0x266605(0x2cc))_0x4f36b4[_0x266605(0x33f)]('status',{'access':devices[_0x40a217][_0x266605(0x196)]}),loginAccess2FA(_0x40a217,_0x4c20a2);else{if(devices[_0x40a217][_0x266605(0x196)][_0x266605(0x26e)]==![]&&devices[_0x40a217][_0x266605(0x196)]['reason']=='invalid\x20credentials')_0x4f36b4[_0x266605(0x33f)](_0x266605(0x2b8),{'access':devices[_0x40a217][_0x266605(0x196)]});else devices[_0x40a217][_0x266605(0x196)][_0x266605(0x26e)]&&devices[_0x40a217][_0x266605(0x196)][_0x266605(0x248)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x40a217)['forEach'](_0x44f32b=>{setAccess(_0x44f32b);}),logger[_0x266605(0x1f5)](_0x266605(0x262)+_0x40a217[_0x266605(0x307)](-0x8)),setTokenRefresh(_0x40a217),setSessionTimeout(_0x266605(0x1a9),_0x40a217));}}else logger[_0x266605(0x2fa)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x4f36b4['on']('reset-password',()=>{resetPassword();}),_0x4f36b4['on'](_0x8c18f0(0x243),_0x51c98b=>{removeClient(_0x4f36b4['id']);}),_0x4a04e1==_0x8c18f0(0x28d)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x4cb7f6){const _0x4075a1=_0x155ac1;if(_0x4cb7f6!=_0x4075a1(0x28d)&&config[_0x4075a1(0x2c1)]!=''){if(pid[_0x4cb7f6])pid[_0x4cb7f6][_0x4075a1(0x298)]({'function':'initclient','args':null});}_0x4cb7f6!='botmanager'&&broadcastToBots(_0x4075a1(0x261),JSON[_0x4075a1(0x1b9)](config));}function reloadBotManager(){const _0x4f18dd=_0x155ac1;getClientsWithBotID('botmanager')[_0x4f18dd(0x1fb)](_0x2afc3d=>{const _0x6bf6b6=_0x4f18dd;getSocket(_0x2afc3d['id'])['emit'](_0x6bf6b6(0x2b8),{'access':{'allow':![],'reason':_0x6bf6b6(0x309),'token':null}});});}function getSocket(_0x109901){const _0x2a8a64=_0x155ac1,_0x259e80=io[_0x2a8a64(0x24f)][_0x2a8a64(0x321)]('/');return _0x259e80[_0x2a8a64(0x152)]['get'](_0x109901);}function setAccess(_0x24282d){const _0x3b77e2=_0x155ac1,_0x12e196=getSocket(_0x24282d['id']),_0x2024af=_0x24282d[_0x3b77e2(0x174)],_0x188e87=_0x24282d[_0x3b77e2(0x2f4)];devices[_0x2024af]['access']=validateAccess(devices[_0x2024af][_0x3b77e2(0x196)][_0x3b77e2(0x1c8)],_0x2024af),logger[_0x3b77e2(0x1f5)](_0x3b77e2(0x331)+devices[_0x2024af][_0x3b77e2(0x196)][_0x3b77e2(0x248)]+'\x20|\x20client:\x20...'+_0x24282d['id']['slice'](-0x8)+_0x3b77e2(0x197)+_0x2024af[_0x3b77e2(0x307)](-0x8)),_0x12e196['join'](_0x2024af);if(devices[_0x2024af][_0x3b77e2(0x196)]['allow']){_0x12e196[_0x3b77e2(0x157)](_0x188e87);if(_0x188e87==_0x3b77e2(0x28d))initializeSocketBotManager(_0x12e196);else initializeSocketBot(_0x12e196);initClient(_0x188e87);}devices[_0x2024af]['access'][_0x3b77e2(0x1c8)]&&devices[_0x2024af]['access']['reason']==_0x3b77e2(0x1bd)&&setSessionTimeout(_0x3b77e2(0x29e),_0x2024af),devices[_0x2024af][_0x3b77e2(0x196)][_0x3b77e2(0x1c8)]&&devices[_0x2024af][_0x3b77e2(0x196)][_0x3b77e2(0x248)]==_0x3b77e2(0x1f1)&&setSessionTimeout(_0x3b77e2(0x1a9),_0x2024af),_0x12e196[_0x3b77e2(0x33f)]('status',{'status':_0x24282d[_0x3b77e2(0x310)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2024af][_0x3b77e2(0x196)],'externalip':devices[_0x2024af]['ip'],'publicKey':secure[_0x3b77e2(0x206)],'userid':settings[_0x3b77e2(0x308)],'validInstallation':validInstallation}),devices[_0x2024af][_0x3b77e2(0x196)][_0x3b77e2(0x26e)]==![]&&devices[_0x2024af][_0x3b77e2(0x196)][_0x3b77e2(0x248)]=='2FA\x20required'&&temporaryAccess2FA(_0x2024af,devices[_0x2024af]['ip']);}function setSessionTimeout(_0x90943e,_0x3383b1){const _0x26e92e=_0x155ac1;let _0x530641;if(_0x90943e==_0x26e92e(0x1a9))_0x530641=loginExpiry*0x3c*0x3e8;else _0x530641=devices[_0x3383b1]['telegramIpApproval'][_0x26e92e(0x17f)]*0x3c*0x3e8-(new Date()[_0x26e92e(0x334)]()-devices[_0x3383b1]['telegramIpApproval'][_0x26e92e(0x234)]);if(devices[_0x3383b1]['pidExpireLogin'])clearTimeout(devices[_0x3383b1][_0x26e92e(0x129)]);devices[_0x3383b1]['pidExpireLogin']=setTimeout(()=>{const _0x16c2fd=_0x26e92e;if(devices[_0x3383b1][_0x16c2fd(0x31a)])clearTimeout(devices[_0x3383b1][_0x16c2fd(0x31a)]);removeSocketListeners(_0x3383b1),addBlacklist(_0x3383b1),devices[_0x3383b1][_0x16c2fd(0x1a7)]=null,devices[_0x3383b1]['telegram2FaApproval']=null,devices[_0x3383b1][_0x16c2fd(0x196)]['token']=null,logger[_0x16c2fd(0x1f5)](_0x16c2fd(0x221)+_0x3383b1[_0x16c2fd(0x307)](-0x8)),devices[_0x3383b1][_0x16c2fd(0x196)]=validateAccess(devices[_0x3383b1][_0x16c2fd(0x196)][_0x16c2fd(0x1c8)],_0x3383b1),!(devices[_0x3383b1][_0x16c2fd(0x196)][_0x16c2fd(0x26e)]&&devices[_0x3383b1][_0x16c2fd(0x196)][_0x16c2fd(0x248)]=='login\x20not\x20required')&&(_0x90943e=='login'?io['to'](_0x3383b1)[_0x16c2fd(0x33f)](_0x16c2fd(0x2b8),{'access':{'allow':![],'reason':_0x16c2fd(0x279),'token':null}}):io['to'](_0x3383b1)['emit'](_0x16c2fd(0x2b8),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x3383b1][_0x16c2fd(0x196)]['token']=null;},_0x530641);}function setTokenRefresh(_0x55b32f){const _0x4e5334=_0x155ac1;if(devices[_0x55b32f]['pidRefreshToken'])clearTimeout(devices[_0x55b32f][_0x4e5334(0x31a)]);devices[_0x55b32f][_0x4e5334(0x31a)]=setTimeout(()=>{const _0x16ece0=_0x4e5334;getClientsWithUuid(_0x55b32f)['length']!=0x0?(devices[_0x55b32f][_0x16ece0(0x196)]=refreshToken(_0x55b32f),io['to'](_0x55b32f)[_0x16ece0(0x33f)]('status',{'status':_0x16ece0(0x1a6),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x55b32f][_0x16ece0(0x196)],'externalip':devices[_0x55b32f]['ip'],'publicKey':secure[_0x16ece0(0x206)],'validInstallation':validInstallation}),setTokenRefresh(_0x55b32f)):clearTimeout(devices[_0x55b32f][_0x16ece0(0x31a)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3b9046){const _0x3ac530=_0x155ac1,_0x57c40f=getClient(_0x3b9046['id'])['uuid'];_0x3b9046['emit'](_0x3ac530(0x261),config),_0x3b9046[_0x3ac530(0x33f)](_0x3ac530(0x25f),cleanSettings()),_0x3b9046['on'](_0x3ac530(0x123),_0x534e23=>{const _0x133db5=_0x3ac530;if(validateAccess(_0x534e23,_0x57c40f)[_0x133db5(0x26e)])addBot();else logger[_0x133db5(0x2fa)](_0x133db5(0x1dd));}),_0x3b9046['on']('update-bot',(_0xb79812,_0x5edc9f)=>{const _0x12e6ec=_0x3ac530;if(validateAccess(_0x5edc9f,_0x57c40f)[_0x12e6ec(0x26e)])toggleBot(_0xb79812[_0x12e6ec(0x2a5)],_0xb79812[_0x12e6ec(0x2b8)],_0xb79812[_0x12e6ec(0x1ef)]);else logger['full'](_0x12e6ec(0x311));}),_0x3b9046['on']('toggle-bot-mode',(_0x4fc037,_0x3d3555)=>{const _0x80ee7b=_0x3ac530;if(validateAccess(_0x3d3555,_0x57c40f)['allow'])toggleBotMode(_0x4fc037);else logger[_0x80ee7b(0x2fa)](_0x80ee7b(0x311));}),_0x3b9046['on']('delete-bot',(_0x16710b,_0x159ac4)=>{const _0x33ad1a=_0x3ac530;if(validateAccess(_0x159ac4,_0x57c40f)[_0x33ad1a(0x26e)])deleteBot(_0x16710b);else logger[_0x33ad1a(0x2fa)](_0x33ad1a(0x17e));}),_0x3b9046['on']('store-settings',(_0x170e15,_0x2dc6ca)=>{const _0x42c8f3=_0x3ac530;if(validateAccess(_0x2dc6ca,_0x57c40f)['allow'])storeSettings(_0x170e15,!![]);else logger['full'](_0x42c8f3(0x287));}),_0x3b9046['on']('update-bb',_0x505ea0=>{const _0x6bd7d6=_0x3ac530;if(validateAccess(_0x505ea0,_0x57c40f)['allow'])updateBB(_0x6bd7d6(0x30b));else logger[_0x6bd7d6(0x2fa)](_0x6bd7d6(0x318));}),_0x3b9046['on'](_0x3ac530(0x1d5),_0x1107b1=>{const _0x4fb8a8=_0x3ac530;if(validateAccess(_0x1107b1,_0x57c40f)['allow'])updateBB(_0x4fb8a8(0x32a));else logger[_0x4fb8a8(0x2fa)](_0x4fb8a8(0x223));}),_0x3b9046['on'](_0x3ac530(0x2e5),_0x44d684=>{const _0x146e35=_0x3ac530;if(validateAccess(_0x44d684,_0x57c40f)[_0x146e35(0x26e)]){const _0x1cea3d=getClient(_0x3b9046['id']);if(_0x1cea3d)getBackupFiles(_0x1cea3d[_0x146e35(0x174)]);else logger[_0x146e35(0x2fa)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x146e35(0x2fa)](_0x146e35(0x281));}),_0x3b9046['on'](_0x3ac530(0x131),(_0x47c865,_0x4b5e77)=>{const _0x329e6d=_0x3ac530;if(validateAccess(_0x4b5e77,_0x57c40f)[_0x329e6d(0x26e)])restoreBackupFile(_0x47c865);else logger[_0x329e6d(0x2fa)](_0x329e6d(0x2e6));}),_0x3b9046['on'](_0x3ac530(0x199),_0xd1009e=>{const _0xda5db9=_0x3ac530;if(validateAccess(_0xd1009e,_0x57c40f)[_0xda5db9(0x26e)])getMessages();else logger['full'](_0xda5db9(0x222));}),_0x3b9046['on']('confirm-message',(_0x454d25,_0x3dbce7)=>{const _0x34c9b3=_0x3ac530;if(validateAccess(_0x3dbce7,_0x57c40f)['allow'])confirmMessage(_0x454d25);else logger[_0x34c9b3(0x2fa)](_0x34c9b3(0x2dc));}),_0x3b9046['on'](_0x3ac530(0x16c),_0x658df1=>{const _0x117c2e=_0x3ac530;if(validateAccess(_0x658df1,_0x57c40f)[_0x117c2e(0x26e)]){if(devices[_0x57c40f][_0x117c2e(0x31a)])clearTimeout(devices[_0x57c40f][_0x117c2e(0x31a)]);if(devices[_0x57c40f]['pidExpireLogin'])clearTimeout(devices[_0x57c40f][_0x117c2e(0x129)]);removeSocketListeners(getClient(_0x3b9046['id'])[_0x117c2e(0x174)]),addBlacklist(_0x57c40f),devices[_0x57c40f][_0x117c2e(0x1a7)]=null,devices[_0x57c40f][_0x117c2e(0x182)]=null,devices[_0x57c40f][_0x117c2e(0x196)][_0x117c2e(0x1c8)]=null,logger[_0x117c2e(0x1f5)]('Logged\x20out\x20user\x20...'+_0x57c40f[_0x117c2e(0x307)](-0x8)),io['to'](getClient(_0x3b9046['id'])[_0x117c2e(0x174)])[_0x117c2e(0x33f)]('status',{'access':{'allow':![],'reason':_0x117c2e(0x333),'token':null}});}else logger[_0x117c2e(0x2fa)](_0x117c2e(0x1e1));});}function initializeSocketBot(_0x259928){const _0x23c7ce=_0x155ac1,_0x5a4079=getClient(_0x259928['id'])[_0x23c7ce(0x2f4)],_0x3e568d=getClient(_0x259928['id'])[_0x23c7ce(0x174)];_0x259928['on'](_0x23c7ce(0x2fc),(_0x318ba3,_0x1960e2)=>{const _0x2b2de1=_0x23c7ce;if(validateAccess(_0x1960e2,_0x3e568d)[_0x2b2de1(0x26e)]){if(pid[_0x5a4079])pid[_0x5a4079]['send']({'function':_0x2b2de1(0x1dc),'args':_0x318ba3});}else logger[_0x2b2de1(0x2fa)](_0x2b2de1(0x2de));}),_0x259928['on'](_0x23c7ce(0x297),(_0x1b1126,_0x30ef0a)=>{const _0x2294b5=_0x23c7ce;if(validateAccess(_0x30ef0a,_0x3e568d)['allow']){if(pid[_0x5a4079])pid[_0x5a4079][_0x2294b5(0x298)]({'function':_0x2294b5(0x15f),'args':_0x1b1126});}else logger[_0x2294b5(0x2fa)](_0x2294b5(0x33d));}),_0x259928['on'](_0x23c7ce(0x327),(_0x3e5bcb,_0x4e45d9)=>{const _0x439c79=_0x23c7ce;if(validateAccess(_0x4e45d9,_0x3e568d)[_0x439c79(0x26e)]){if(pid[_0x5a4079])pid[_0x5a4079][_0x439c79(0x298)]({'function':_0x439c79(0x2e4),'args':_0x3e5bcb});}else logger[_0x439c79(0x2fa)](_0x439c79(0x2e8));}),_0x259928['on'](_0x23c7ce(0x339),(_0x2afad1,_0x3a2a59)=>{const _0xff7f3f=_0x23c7ce;if(validateAccess(_0x3a2a59,_0x3e568d)[_0xff7f3f(0x26e)]){if(pid[_0x5a4079])pid[_0x5a4079][_0xff7f3f(0x298)]({'function':'storeConfiguration','args':_0x2afad1});}else logger[_0xff7f3f(0x2fa)]('Unauthorized\x20attempt\x20to\x20store\x20configuration');}),_0x259928['on'](_0x23c7ce(0x330),(_0x31125c,_0xbec424)=>{const _0x543607=_0x23c7ce;if(validateAccess(_0xbec424,_0x3e568d)[_0x543607(0x26e)]){if(pid[_0x5a4079])pid[_0x5a4079][_0x543607(0x298)]({'function':_0x543607(0x1c0),'args':_0x31125c});}else logger[_0x543607(0x2fa)](_0x543607(0x1c9));}),_0x259928['on'](_0x23c7ce(0x2b3),(_0x329584,_0x5823be)=>{const _0x2f82ab=_0x23c7ce;if(validateAccess(_0x5823be,_0x3e568d)['allow']){if(pid[_0x5a4079])pid[_0x5a4079]['send']({'function':_0x2f82ab(0x147),'args':_0x329584});}else logger['full'](_0x2f82ab(0x32c));}),_0x259928['on'](_0x23c7ce(0x1d2),_0x1d5141=>{const _0x4104b9=_0x23c7ce;if(validateAccess(_0x1d5141,_0x3e568d)[_0x4104b9(0x26e)]){if(pid[_0x5a4079])pid[_0x5a4079][_0x4104b9(0x298)]({'function':_0x4104b9(0x271),'args':null});}else logger[_0x4104b9(0x2fa)](_0x4104b9(0x2d5));}),_0x259928['on'](_0x23c7ce(0x27f),_0x6c8752=>{const _0x1610db=_0x23c7ce;if(validateAccess(_0x6c8752,_0x3e568d)[_0x1610db(0x26e)]){if(pid[_0x5a4079])pid[_0x5a4079][_0x1610db(0x298)]({'function':_0x1610db(0x1e3),'args':null});}else logger[_0x1610db(0x2fa)](_0x1610db(0x12d));}),_0x259928['on'](_0x23c7ce(0x233),(_0x47fc0b,_0x5e25b3)=>{const _0xf54d70=_0x23c7ce;if(validateAccess(_0x5e25b3,_0x3e568d)[_0xf54d70(0x26e)]){if(pid[_0x5a4079])pid[_0x5a4079][_0xf54d70(0x298)]({'function':'placeOrder','args':_0x47fc0b});}else logger[_0xf54d70(0x2fa)](_0xf54d70(0x2d1));}),_0x259928['on'](_0x23c7ce(0x1ff),_0x4c4e15=>{const _0xb1fc2c=_0x23c7ce;if(validateAccess(_0x4c4e15,_0x3e568d)[_0xb1fc2c(0x26e)]){if(pid[_0x5a4079])pid[_0x5a4079][_0xb1fc2c(0x298)]({'function':'cancelLoading','args':null});}else logger[_0xb1fc2c(0x2fa)](_0xb1fc2c(0x2d7));}),_0x259928['on']('show-config',_0x16b013=>{const _0x3e32c0=_0x23c7ce;if(validateAccess(_0x16b013,_0x3e568d)['allow']){if(pid[_0x5a4079])pid[_0x5a4079]['send']({'function':_0x3e32c0(0x305),'args':null});}else logger[_0x3e32c0(0x2fa)](_0x3e32c0(0x230));}),_0x259928['on']('update-bb',_0x469b10=>{const _0x55c890=_0x23c7ce;if(validateAccess(_0x469b10,_0x3e568d)[_0x55c890(0x26e)])updateBB(_0x55c890(0x30b));else logger[_0x55c890(0x2fa)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x259928['on']('get-messages',_0x1d759b=>{const _0x580d25=_0x23c7ce;if(validateAccess(_0x1d759b,_0x3e568d)[_0x580d25(0x26e)])getMessages();else logger[_0x580d25(0x2fa)](_0x580d25(0x222));}),_0x259928['on'](_0x23c7ce(0x195),(_0x5dc7e1,_0x1fc17c)=>{const _0x479952=_0x23c7ce;if(validateAccess(_0x1fc17c,_0x3e568d)[_0x479952(0x26e)])confirmMessage(_0x5dc7e1);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x259928['on']('logout',_0x385c29=>{const _0x2a62e5=_0x23c7ce;if(validateAccess(_0x385c29,_0x3e568d)[_0x2a62e5(0x26e)]){if(devices[_0x3e568d]['pidRefreshToken'])clearTimeout(devices[_0x3e568d]['pidRefreshToken']);if(devices[_0x3e568d][_0x2a62e5(0x129)])clearTimeout(devices[_0x3e568d][_0x2a62e5(0x129)]);removeSocketListeners(getClient(_0x259928['id'])[_0x2a62e5(0x174)]),addBlacklist(_0x3e568d),devices[_0x3e568d]['telegramIpApproval']=null,devices[_0x3e568d][_0x2a62e5(0x182)]=null,devices[_0x3e568d][_0x2a62e5(0x196)][_0x2a62e5(0x1c8)]=null,logger[_0x2a62e5(0x1f5)]('Logged\x20out\x20user\x20...'+_0x3e568d['slice'](-0x8)),io['to'](getClient(_0x259928['id'])[_0x2a62e5(0x174)])[_0x2a62e5(0x33f)](_0x2a62e5(0x2b8),{'access':{'allow':![],'reason':_0x2a62e5(0x333),'token':null}});}else logger['full'](_0x2a62e5(0x1e1));});}function removeSocketListeners(_0x148135){const _0x4f3002=_0x155ac1;getClientsWithUuid(_0x148135)[_0x4f3002(0x1fb)](_0x1ff4e9=>{const _0x18aadd=_0x4f3002;getSocket(_0x1ff4e9['id'])[_0x18aadd(0x294)]();});}function cleanSettings(){const _0x362b84=_0x155ac1;let _0x5ab858=settings;return settings[_0x362b84(0x27a)]&&settings[_0x362b84(0x27a)]!=''&&(_0x5ab858={..._0x5ab858,'telegramToken':_0x362b84(0x274)}),settings['bbPassword']&&settings[_0x362b84(0x338)]!=''&&(_0x5ab858={..._0x5ab858,'bbPassword':_0x362b84(0x274)}),settings[_0x362b84(0x215)]&&settings[_0x362b84(0x215)]!=''&&(_0x5ab858={..._0x5ab858,'marketcapApi':_0x362b84(0x274)}),(settings['bbPassword']&&settings[_0x362b84(0x338)]==_0x362b84(0x12c)||settings['telegramToken']&&settings[_0x362b84(0x27a)]==_0x362b84(0x12c)||settings[_0x362b84(0x215)]&&settings[_0x362b84(0x215)]==_0x362b84(0x12c))&&(_0x5ab858={..._0x5ab858,'restored':{'password':settings['bbPassword']==_0x362b84(0x12c),'telegram':settings[_0x362b84(0x27a)]=='***','marketcap':settings[_0x362b84(0x215)]=='***'}}),_0x5ab858;}async function updateBB(_0x5a44ef){const _0x4e3689=_0x155ac1;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x5d9ab1=>{const _0x504c5d=_0x3b45;restartBot(_0x5d9ab1[_0x504c5d(0x2a5)]);});if(_0x5a44ef==_0x4e3689(0x30b))process[_0x4e3689(0x298)]({'update':!![],'environment':environment},_0x5c85a9=>{});else _0x5a44ef==_0x4e3689(0x32a)&&process[_0x4e3689(0x298)]({'reinstall':!![],'environment':environment},_0x37674a=>{});}function startBot(_0x6842b2,_0x191bba,_0x15454a){const _0x5d9457=_0x155ac1;if(debugging)_0x6842b2[_0x5d9457(0x121)]('-d');let _0x5e361b=![];const _0x377414=_0x6842b2[0x0];_0x191bba={..._0x191bba,'stdio':[_0x5d9457(0x181),_0x5d9457(0x181),_0x5d9457(0x181),_0x5d9457(0x25a)]},pid[_0x377414]=childProcess[_0x5d9457(0x167)](botfile,_0x6842b2,_0x191bba),pid[_0x377414]['on'](_0x5d9457(0x301),_0x3298d8=>{const _0x31b857=_0x5d9457;switch(Object[_0x31b857(0x133)](_0x3298d8)[0x0]){case _0x31b857(0x150):updateBotName(_0x377414,_0x3298d8[_0x31b857(0x150)]);break;case _0x31b857(0x272):updateBotManager();break;case _0x31b857(0x2b8):updateStatus(_0x377414,_0x3298d8[_0x31b857(0x2b8)]);break;case _0x31b857(0x1ef):updateLive(_0x377414,_0x3298d8['live']);break;case _0x31b857(0x1d0):updateLive(_0x377414,_0x3298d8[_0x31b857(0x1d0)]),io['to'](_0x377414)[_0x31b857(0x33f)](_0x31b857(0x2b8),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x31b857(0x1e9):_0x3298d8[_0x31b857(0x1e9)]=='restart'&&restartBot(_0x377414);_0x3298d8[_0x31b857(0x1e9)]==_0x31b857(0x13a)&&toggleBot(_0x377414,'disabled',_0x31b857(0x285));break;case'telegram':sendTelegramBot(_0x377414,_0x3298d8[_0x31b857(0x2f0)]);break;case'telegrammsg':sendTelegramMsg(_0x3298d8['telegrammsg']);break;case _0x31b857(0x270):io['to'](_0x377414)['emit'](_0x3298d8[_0x31b857(0x270)],_0x3298d8[_0x31b857(0x2ce)]);break;}}),pid[_0x377414]['on']('error',function(_0x20ccc0){if(_0x5e361b)return;_0x5e361b=!![],_0x15454a(_0x20ccc0);}),pid[_0x377414]['on'](_0x5d9457(0x190),async function(_0x39c3bb){const _0x367973=_0x5d9457;if(terminating)return;if(installingUpdate){io['close']();return;}if(_0x5e361b)return;_0x5e361b=!![],_0x15454a(null);const _0x2357e2=dbConfig['get'](_0x367973(0x261))[_0x367973(0x249)]({'botID':_0x377414})[_0x367973(0x1b3)]();_0x2357e2&&(_0x2357e2[_0x367973(0x2b8)]==_0x367973(0x142)||_0x2357e2[_0x367973(0x2b8)]==_0x367973(0x228))&&(await sleep(0x3e8),updateLive(_0x377414,_0x367973(0x285)),logger['full'](_0x367973(0x14f)+_0x377414),startBot([_0x377414,userID],{'cwd':bbpath},function(_0x2e7960){const _0xf3977=_0x367973;if(_0x2e7960)logger[_0xf3977(0x2fa)](_0x2e7960);}));});}function stopBot(_0x2281dd){const _0xdd4c0f=_0x155ac1;getClientsWithBotID(_0x2281dd)[_0xdd4c0f(0x1fb)](_0x2be409=>{const _0x4dc774=_0xdd4c0f;getSocket(_0x2be409['id'])[_0x4dc774(0x243)](!![]),removeClient(_0x2be409['id']);}),pid[_0x2281dd]&&(pid[_0x2281dd]['kill'](),pid[_0x2281dd]=null);}function stopAllBots(){const _0x375dfd=_0x155ac1;terminating=!![];const _0x36abf6=getEnabledBots();_0x36abf6[_0x375dfd(0x1fb)](_0x2e0755=>{const _0x5f1162=_0x375dfd;stopBot(_0x2e0755[_0x5f1162(0x2a5)]);});}function restartBot(_0x57a9e7){const _0x46e61f=_0x155ac1;if(pid[_0x57a9e7])pid[_0x57a9e7][_0x46e61f(0x13a)]();}function addBot(){const _0x50ccde=_0x155ac1;let _0xbce0cf;for(let _0x3be780=0x1;_0x3be780<0x3e9;_0x3be780++){_0xbce0cf=_0x3be780['toString']()[_0x50ccde(0x340)](0x3,'0');let _0x13958f=config[_0x50ccde(0x249)](_0x3520dc=>_0x3520dc[_0x50ccde(0x2a5)]==_0xbce0cf);if(!_0x13958f)break;}if(_0xbce0cf===_0x50ccde(0x186)){logger[_0x50ccde(0x2fa)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x50ccde(0x2fa)]('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0xbce0cf),dbConfig[_0x50ccde(0x321)]('bots')[_0x50ccde(0x121)]({'botID':_0xbce0cf,'botname':_0x50ccde(0x1b0)+_0xbce0cf,'status':_0x50ccde(0x228),'live':''})[_0x50ccde(0x289)](),startBot([_0xbce0cf,userID],{'cwd':bbpath},function(_0x575b00){const _0x47e056=_0x50ccde;if(_0x575b00)logger[_0x47e056(0x2fa)](_0x575b00);}),config=getConfiguration(),io['to']('botmanager')[_0x50ccde(0x33f)](_0x50ccde(0x261),config),broadcastToBots(_0x50ccde(0x261),JSON[_0x50ccde(0x1b9)](config));}function deleteBot(_0x516df4){const _0x4a25af=_0x155ac1;getClientsWithBotID(_0x516df4)[_0x4a25af(0x1fb)](_0x20ace8=>{const _0x40ce4d=_0x4a25af;getSocket(_0x20ace8['id'])[_0x40ce4d(0x243)](!![]),removeClient(_0x20ace8['id']);}),dbConfig['get'](_0x4a25af(0x261))['remove']({'botID':_0x516df4})[_0x4a25af(0x289)](),logger[_0x4a25af(0x2fa)](_0x4a25af(0x191)+_0x516df4),stopBot(_0x516df4);try{if(fs['existsSync'](path['join'](configpath,_0x4a25af(0x20d)+_0x516df4+_0x4a25af(0x163))))fs[_0x4a25af(0x168)](path['join'](configpath,_0x4a25af(0x20d)+_0x516df4+_0x4a25af(0x163)));if(fs[_0x4a25af(0x257)](path['join'](configpath,'bot-'+_0x516df4+'-events.json')))fs[_0x4a25af(0x168)](path[_0x4a25af(0x157)](configpath,_0x4a25af(0x20d)+_0x516df4+_0x4a25af(0x1c1)));if(fs['existsSync'](path[_0x4a25af(0x157)](configpath,_0x4a25af(0x20d)+_0x516df4+_0x4a25af(0x13f))))fs[_0x4a25af(0x168)](path[_0x4a25af(0x157)](configpath,_0x4a25af(0x20d)+_0x516df4+'-performance.json'));if(fs[_0x4a25af(0x257)](path['join'](configpath,_0x4a25af(0x20d)+_0x516df4+_0x4a25af(0x176))))fs[_0x4a25af(0x168)](path[_0x4a25af(0x157)](configpath,_0x4a25af(0x20d)+_0x516df4+_0x4a25af(0x176)));}catch(_0x26401b){if(_0x26401b)logger[_0x4a25af(0x2fa)](_0x4a25af(0x1e0),_0x26401b);}config=getConfiguration(),io['to'](_0x4a25af(0x28d))[_0x4a25af(0x33f)](_0x4a25af(0x261),config),broadcastToBots('bots',JSON[_0x4a25af(0x1b9)](config));}function toggleBot(_0x41737a,_0x4194bc,_0x497b58){const _0x137f5e=_0x155ac1;dbConfig['get'](_0x137f5e(0x261))[_0x137f5e(0x249)]({'botID':_0x41737a})[_0x137f5e(0x293)]({'status':_0x4194bc})[_0x137f5e(0x293)]({'live':_0x497b58})[_0x137f5e(0x289)]();if(_0x4194bc==_0x137f5e(0x142)||_0x4194bc=='new')logger[_0x137f5e(0x2fa)](_0x137f5e(0x320)+_0x41737a),startBot([_0x41737a,userID],{'cwd':bbpath},function(_0x398176){const _0x2a2353=_0x137f5e;if(_0x398176)logger[_0x2a2353(0x2fa)](_0x398176);});else(_0x4194bc==_0x137f5e(0x1de)||_0x4194bc==_0x137f5e(0x1d9))&&(logger[_0x137f5e(0x2fa)](_0x137f5e(0x146)+_0x41737a),stopBot(_0x41737a));config=getConfiguration(),io['to'](_0x137f5e(0x28d))[_0x137f5e(0x33f)](_0x137f5e(0x261),config),broadcastToBots(_0x137f5e(0x261),JSON[_0x137f5e(0x1b9)](config));}function toggleStatus(_0x532909){const _0x32d1de=_0x155ac1;let _0x12580f=dbConfig[_0x32d1de(0x321)](_0x32d1de(0x261))[_0x32d1de(0x249)]({'botID':_0x532909})['value'](),_0x3ffb2a;if(_0x12580f[_0x32d1de(0x2b8)]===_0x32d1de(0x142))_0x3ffb2a=_0x32d1de(0x1de);else{if(_0x12580f[_0x32d1de(0x2b8)]===_0x32d1de(0x228))_0x3ffb2a=_0x32d1de(0x1d9);else{if(_0x12580f[_0x32d1de(0x2b8)]===_0x32d1de(0x1d9))_0x3ffb2a=_0x32d1de(0x228);else{if(_0x12580f[_0x32d1de(0x2b8)]==='disabled')_0x3ffb2a=_0x32d1de(0x142);}}}return _0x3ffb2a;}function updateStatus(_0x46655b,_0x8d20a7){const _0x3851b3=_0x155ac1;dbConfig['get'](_0x3851b3(0x261))['find']({'botID':_0x46655b})[_0x3851b3(0x293)]({'status':_0x8d20a7})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x3851b3(0x33f)]('bots',config),broadcastToBots(_0x3851b3(0x261),JSON[_0x3851b3(0x1b9)](config));}function updateLive(_0x45819f,_0x5208a0){const _0x13a8d6=_0x155ac1;dbConfig[_0x13a8d6(0x321)](_0x13a8d6(0x261))[_0x13a8d6(0x249)]({'botID':_0x45819f})['assign']({'live':_0x5208a0})[_0x13a8d6(0x289)](),config=getConfiguration(),io['to'](_0x13a8d6(0x28d))[_0x13a8d6(0x33f)](_0x13a8d6(0x261),config),broadcastToBots('bots',JSON[_0x13a8d6(0x1b9)](config));}function updateBotName(_0x2212f5,_0x363bec){const _0x4df3ff=_0x155ac1;dbConfig[_0x4df3ff(0x321)](_0x4df3ff(0x261))[_0x4df3ff(0x249)]({'botID':_0x2212f5})[_0x4df3ff(0x293)]({'botname':_0x363bec})[_0x4df3ff(0x289)](),config=getConfiguration(),io['to'](_0x4df3ff(0x28d))[_0x4df3ff(0x33f)](_0x4df3ff(0x261),config),broadcastToBots(_0x4df3ff(0x261),JSON[_0x4df3ff(0x1b9)](config));}function updateBotManager(){const _0x5f0774=_0x155ac1;config=getConfiguration(),io['to']('botmanager')[_0x5f0774(0x33f)](_0x5f0774(0x261),config),broadcastToBots(_0x5f0774(0x261),JSON[_0x5f0774(0x1b9)](config));}function toggleBotMode(_0x41bc27){const _0x320932=_0x155ac1;if(pid[_0x41bc27])pid[_0x41bc27][_0x320932(0x298)]({'function':_0x320932(0x21a),'args':null});else{const _0x2421df=configpath+_0x320932(0x20d)+_0x41bc27+_0x320932(0x163),_0x382101=fs[_0x320932(0x15d)](_0x2421df),_0x3895ce=JSON['parse'](_0x382101),_0x80577e=_0x3895ce['bot'][0x0][_0x320932(0x2df)];_0x3895ce['bot'][0x0][_0x320932(0x2df)]=!_0x80577e;const _0x289f9f=JSON[_0x320932(0x1b9)](_0x3895ce,null,0x2);fs[_0x320932(0x2b4)](_0x2421df,_0x289f9f),config=getConfiguration(),io['to'](_0x320932(0x28d))[_0x320932(0x33f)](_0x320932(0x261),config),broadcastToBots(_0x320932(0x261),JSON['stringify'](config));}}function validateTelegram(_0x1db1ab){const _0x10915a=_0x155ac1;if(_0x1db1ab['from'][_0x10915a(0x2a2)]!=settings[_0x10915a(0x2cd)]&&'@'+_0x1db1ab[_0x10915a(0x1ae)][_0x10915a(0x2a2)]!=settings[_0x10915a(0x2cd)]||_0x1db1ab[_0x10915a(0x1ad)]['id']!=settings[_0x10915a(0x17c)])return sendTelegram(_0x1db1ab[_0x10915a(0x1ad)]['id'],_0x10915a(0x227),{'parse_mode':_0x10915a(0x2bb)}),![];return!![];}function _0x3b45(_0x2d859f,_0x4acc08){const _0x11693c=_0x5eb5();return _0x3b45=function(_0x44537c,_0x52bdc3){_0x44537c=_0x44537c-0x121;let _0x5eb5fe=_0x11693c[_0x44537c];return _0x5eb5fe;},_0x3b45(_0x2d859f,_0x4acc08);}async function initTelegram(){const _0x20c486=_0x155ac1;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings['telegramToken']);let _0x1262d7=_0x20c486(0x258);_0x1262d7+='\x0a',_0x1262d7+=_0x20c486(0x12a),_0x1262d7+='/disable\x20-\x20disable\x20notifications\x0a',_0x1262d7+=_0x20c486(0x145),_0x1262d7+=_0x20c486(0x143),_0x1262d7+='/on\x20-\x20start\x20bot(s)\x0a',_0x1262d7+='/off\x20-\x20stop\x20bot(s)\x0a',_0x1262d7+=_0x20c486(0x185),_0x1262d7+=_0x20c486(0x2fb),_0x1262d7+=_0x20c486(0x2c9),_0x1262d7+=_0x20c486(0x2ca),_0x1262d7+=_0x20c486(0x22e),_0x1262d7+=_0x20c486(0x149),_0x1262d7+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0x1262d7+=_0x20c486(0x2ba),_0x1262d7+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x1262d7+=_0x20c486(0x28e);let _0x35b664=_0x20c486(0x1d1);_0x35b664+='\x0a',_0x35b664+=_0x1262d7,tgBot[_0x20c486(0x2c6)]((_0x5cf9f8,_0x21d534)=>{const _0x5865f6=_0x20c486;logger[_0x5865f6(0x170)](getTimeStamp()+_0x5865f6(0x1c5)),logger[_0x5865f6(0x1f5)](_0x5865f6(0x22d),_0x5cf9f8);}),tgBot[_0x20c486(0x2eb)](async(_0x50b138,_0x446262)=>{const _0x5b3c17=_0x20c486;if(!(!settings[_0x5b3c17(0x17c)]&&_0x50b138[_0x5b3c17(0x30b)][_0x5b3c17(0x301)][_0x5b3c17(0x1b7)]==_0x5b3c17(0x2ec))){if(!validateTelegram(_0x50b138))return;}_0x446262();}),tgBot['command']('start',async _0x31ee75=>{const _0x23f0c7=_0x20c486;if(_0x31ee75[_0x23f0c7(0x1ae)][_0x23f0c7(0x2a2)]==settings[_0x23f0c7(0x2cd)]||'@'+_0x31ee75['from']['username']==settings[_0x23f0c7(0x2cd)]){if(!settings[_0x23f0c7(0x17c)])updateSetting(_0x23f0c7(0x17c),_0x31ee75[_0x23f0c7(0x1ad)]['id']);}if(!validateTelegram(_0x31ee75))return;updateSetting(_0x23f0c7(0x19c),!![]),await sendTelegram(_0x31ee75['chat']['id'],_0x35b664);}),tgBot['command'](_0x20c486(0x201),async _0x3f81d3=>{const _0x3eeeef=_0x20c486;updateSetting(_0x3eeeef(0x19c),!![]),await sendTelegram(_0x3f81d3[_0x3eeeef(0x1ad)]['id'],'Notifications\x20enabled');}),tgBot[_0x20c486(0x324)](_0x20c486(0x1ba),async _0x448795=>{const _0x16fbd0=_0x20c486;await sendTelegram(_0x448795[_0x16fbd0(0x1ad)]['id'],_0x16fbd0(0x335)),updateSetting(_0x16fbd0(0x19c),![]);}),tgBot['command'](_0x20c486(0x1b4),async _0x13700f=>{const _0x38243b=_0x20c486,_0x39df17=Markup['inlineKeyboard']([Markup[_0x38243b(0x315)][_0x38243b(0x130)](_0x38243b(0x2ae),_0x38243b(0x2ea)),Markup[_0x38243b(0x315)][_0x38243b(0x130)](_0x38243b(0x33a),_0x38243b(0x28b)),Markup[_0x38243b(0x315)][_0x38243b(0x130)](_0x38243b(0x226),'config_all')]);_0x13700f[_0x38243b(0x238)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x39df17);}),tgBot[_0x20c486(0x2a7)]('config_orders',async _0x1bad68=>{const _0x795944=_0x20c486;_0x1bad68[_0x795944(0x30c)](),updateSetting('telegramEvents',_0x795944(0x1ed)),updateSetting(_0x795944(0x19c),!![]),await sendTelegram(_0x1bad68['chat']['id'],_0x795944(0x336));}),tgBot[_0x20c486(0x2a7)](_0x20c486(0x28b),async _0x14e65e=>{const _0x1cc5b8=_0x20c486;_0x14e65e[_0x1cc5b8(0x30c)](),updateSetting('telegramEvents',_0x1cc5b8(0x2da)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x14e65e[_0x1cc5b8(0x1ad)]['id'],'Ok,\x20will\x20send\x20alert\x20notifications\x20only');}),tgBot[_0x20c486(0x2a7)](_0x20c486(0x203),async _0x45730c=>{const _0x5056a8=_0x20c486;_0x45730c['editMessageReplyMarkup'](),updateSetting(_0x5056a8(0x177),_0x5056a8(0x2dd)),updateSetting(_0x5056a8(0x19c),!![]),await sendTelegram(_0x45730c[_0x5056a8(0x1ad)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x20c486(0x324)](_0x20c486(0x2b8),async _0x1f5dba=>{const _0x382c18=_0x20c486,_0x123f0b=getBotsWithMode();let _0x32e9a6='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x382c18(0x1fb)](_0x1e9c83=>{const _0x1e75cd=_0x382c18,_0x5c5c84=_0x123f0b[_0x1e75cd(0x249)](_0x267445=>_0x267445[_0x1e75cd(0x2a5)]==_0x1e9c83[_0x1e75cd(0x2a5)])['mode'];_0x32e9a6+=_0x1e75cd(0x1b0)+_0x1e9c83[_0x1e75cd(0x2a5)]+':\x20'+_0x1e9c83[_0x1e75cd(0x2b8)]+_0x1e75cd(0x312)+_0x5c5c84+_0x1e75cd(0x312)+_0x1e9c83[_0x1e75cd(0x1ef)]+'\x0a';}),_0x32e9a6+='\x0a',_0x32e9a6+=_0x382c18(0x2e0),_0x32e9a6+=!settings[_0x382c18(0x19c)]?'Notifications\x20disabled\x0a':_0x382c18(0x1e7),_0x32e9a6+=settings[_0x382c18(0x19c)]?settings['telegramEvents']==_0x382c18(0x2dd)?_0x382c18(0x254):_0x382c18(0x22a)+settings[_0x382c18(0x177)]+_0x382c18(0x1b2):'',await sendTelegram(_0x1f5dba['chat']['id'],_0x32e9a6,{'parse_mode':_0x382c18(0x2bb)});}),tgBot['command'](_0x20c486(0x156),async _0x30aedb=>{const _0x39b14d=_0x20c486,_0x58741e=getEnabledBots();if(_0x58741e[_0x39b14d(0x19f)]==0x0)await sendTelegram(_0x30aedb['chat']['id'],_0x39b14d(0x23f));else{if(_0x58741e[_0x39b14d(0x19f)]>0x1)_0x58741e[_0x39b14d(0x121)]({'botID':_0x39b14d(0x2dd)});let _0xa21e08=[],_0x4c8d4f=[];const _0x424f82=_0x58741e['length']%0x4==0x0||_0x58741e[_0x39b14d(0x19f)]%0x4==0x3||_0x58741e[_0x39b14d(0x19f)]%0x3==0x1?0x4:0x3;let _0x304417=0x0;_0x58741e[_0x39b14d(0x1fb)]((_0x4385a8,_0x4fea56)=>{const _0x1748d4=_0x39b14d;if(_0x4fea56%_0x424f82==0x0)_0x4c8d4f=[];_0x4c8d4f[_0x1748d4(0x121)](Markup[_0x1748d4(0x315)][_0x1748d4(0x130)](_0x4385a8['botID']==_0x1748d4(0x2dd)?_0x1748d4(0x2b9):_0x1748d4(0x1b0)+_0x4385a8[_0x1748d4(0x2a5)],'restart_'+_0x4385a8[_0x1748d4(0x2a5)])),_0x4fea56%_0x424f82==0x0&&(_0xa21e08[_0x304417]=_0x4c8d4f,_0x304417++);});const _0x5cd453=Markup[_0x39b14d(0x20e)](_0xa21e08);_0x30aedb[_0x39b14d(0x238)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x5cd453);}}),tgBot[_0x20c486(0x2a7)](/restart_(.+)/,async _0x4703ce=>{const _0x513bb7=_0x20c486,_0x857ef6=_0x4703ce[_0x513bb7(0x1a8)][0x1];_0x4703ce[_0x513bb7(0x30c)](),_0x857ef6==_0x513bb7(0x2dd)?config[_0x513bb7(0x1fb)](_0x296df6=>{restartBot(_0x296df6['botID']);}):restartBot(_0x857ef6);}),tgBot[_0x20c486(0x324)]('on',async _0x5cf35e=>{const _0x1c64de=_0x20c486,_0xcac392=getDisabledBots();if(_0xcac392['length']==0x0)await sendTelegram(_0x5cf35e[_0x1c64de(0x1ad)]['id'],_0x1c64de(0x25e));else{if(_0xcac392[_0x1c64de(0x19f)]>0x1)_0xcac392['push']({'botID':'all'});let _0x429248=[],_0x37db4e=[];const _0x471511=_0xcac392[_0x1c64de(0x19f)]%0x4==0x0||_0xcac392[_0x1c64de(0x19f)]%0x4==0x3||_0xcac392[_0x1c64de(0x19f)]%0x3==0x1?0x4:0x3;let _0x5102fc=0x0;_0xcac392[_0x1c64de(0x1fb)]((_0xe2af3,_0x33965e)=>{const _0x4a48b1=_0x1c64de;if(_0x33965e%_0x471511==0x0)_0x37db4e=[];_0x37db4e['push'](Markup[_0x4a48b1(0x315)][_0x4a48b1(0x130)](_0xe2af3['botID']==_0x4a48b1(0x2dd)?_0x4a48b1(0x2b9):_0x4a48b1(0x1b0)+_0xe2af3[_0x4a48b1(0x2a5)],_0x4a48b1(0x2a9)+_0xe2af3[_0x4a48b1(0x2a5)])),_0x33965e%_0x471511==0x0&&(_0x429248[_0x5102fc]=_0x37db4e,_0x5102fc++);});const _0x265459=Markup[_0x1c64de(0x20e)](_0x429248);_0x5cf35e['reply'](_0x1c64de(0x19b),_0x265459);}}),tgBot[_0x20c486(0x2a7)](/on_(.+)/,async _0x4fda26=>{const _0x13c5a0=_0x20c486,_0x59cdc9=_0x4fda26[_0x13c5a0(0x1a8)][0x1];_0x4fda26[_0x13c5a0(0x30c)]();if(_0x59cdc9==_0x13c5a0(0x2dd)){const _0x1e8194=getDisabledBots();await sendTelegram(_0x4fda26[_0x13c5a0(0x1ad)]['id'],_0x13c5a0(0x1a1)),_0x1e8194[_0x13c5a0(0x1fb)](_0x4bccbd=>{const _0x5df6e1=_0x13c5a0;if(_0x4bccbd[_0x5df6e1(0x2a5)]!=_0x5df6e1(0x2dd))toggleBot(_0x4bccbd[_0x5df6e1(0x2a5)],toggleStatus(_0x4bccbd[_0x5df6e1(0x2a5)]),'stopped');});}else await sendTelegram(_0x4fda26[_0x13c5a0(0x1ad)]['id'],_0x13c5a0(0x1af)+_0x59cdc9),toggleBot(_0x59cdc9,toggleStatus(_0x59cdc9),'stopped');}),tgBot[_0x20c486(0x324)](_0x20c486(0x224),async _0x3a6f2b=>{const _0x49953f=_0x20c486,_0x5267e8=getEnabledBots();if(_0x5267e8[_0x49953f(0x19f)]==0x0)await sendTelegram(_0x3a6f2b[_0x49953f(0x1ad)]['id'],_0x49953f(0x23f));else{if(_0x5267e8[_0x49953f(0x19f)]>0x1)_0x5267e8['push']({'botID':_0x49953f(0x2dd)});let _0x517c13=[],_0x43d3ee=[];const _0x207d01=_0x5267e8[_0x49953f(0x19f)]%0x4==0x0||_0x5267e8[_0x49953f(0x19f)]%0x4==0x3||_0x5267e8['length']%0x3==0x1?0x4:0x3;let _0x531f19=0x0;_0x5267e8[_0x49953f(0x1fb)]((_0xafeb1b,_0x165115)=>{const _0x4cfc9e=_0x49953f;if(_0x165115%_0x207d01==0x0)_0x43d3ee=[];_0x43d3ee[_0x4cfc9e(0x121)](Markup[_0x4cfc9e(0x315)]['callback'](_0xafeb1b['botID']==_0x4cfc9e(0x2dd)?_0x4cfc9e(0x2b9):'Bot\x20'+_0xafeb1b[_0x4cfc9e(0x2a5)],_0x4cfc9e(0x247)+_0xafeb1b[_0x4cfc9e(0x2a5)])),_0x165115%_0x207d01==0x0&&(_0x517c13[_0x531f19]=_0x43d3ee,_0x531f19++);});const _0x1f894a=Markup[_0x49953f(0x20e)](_0x517c13);_0x3a6f2b[_0x49953f(0x238)](_0x49953f(0x21f),_0x1f894a);}}),tgBot['action'](/off_(.+)/,async _0x5e3178=>{const _0x1ad110=_0x20c486,_0x19487b=_0x5e3178[_0x1ad110(0x1a8)][0x1];_0x5e3178[_0x1ad110(0x30c)]();if(_0x19487b==_0x1ad110(0x2dd)){const _0x3b36be=getEnabledBots();await sendTelegram(_0x5e3178[_0x1ad110(0x1ad)]['id'],_0x1ad110(0x292)),_0x3b36be['forEach'](_0x31a424=>{const _0x31983d=_0x1ad110;if(_0x31a424[_0x31983d(0x2a5)]!=_0x31983d(0x2dd))toggleBot(_0x31a424[_0x31983d(0x2a5)],toggleStatus(_0x31a424[_0x31983d(0x2a5)]),_0x31983d(0x285));});}else await sendTelegram(_0x5e3178['chat']['id'],_0x1ad110(0x16f)+_0x19487b),toggleBot(_0x19487b,toggleStatus(_0x19487b),'stopped');}),tgBot[_0x20c486(0x324)](_0x20c486(0x1c4),async _0xca2924=>{const _0xfb1da8=_0x20c486,_0x1c8dcd=getEnabledBots();if(_0x1c8dcd[_0xfb1da8(0x19f)]==0x0)await sendTelegram(_0xca2924[_0xfb1da8(0x1ad)]['id'],_0xfb1da8(0x23f));else{if(_0x1c8dcd[_0xfb1da8(0x19f)]>0x1){let _0x56be79=[],_0x3df156=[];const _0x206754=_0x1c8dcd[_0xfb1da8(0x19f)]%0x4==0x0||_0x1c8dcd[_0xfb1da8(0x19f)]%0x4==0x3||_0x1c8dcd[_0xfb1da8(0x19f)]%0x3==0x1?0x4:0x3;let _0x11ab24=0x0;_0x1c8dcd[_0xfb1da8(0x1fb)]((_0x34e471,_0x55b3bc)=>{const _0x7e9e0=_0xfb1da8;if(_0x55b3bc%_0x206754==0x0)_0x3df156=[];_0x3df156['push'](Markup[_0x7e9e0(0x315)][_0x7e9e0(0x130)](_0x7e9e0(0x1b0)+_0x34e471[_0x7e9e0(0x2a5)],_0x7e9e0(0x24c)+_0x34e471[_0x7e9e0(0x2a5)])),_0x55b3bc%_0x206754==0x0&&(_0x56be79[_0x11ab24]=_0x3df156,_0x11ab24++);});const _0x254b04=Markup[_0xfb1da8(0x20e)](_0x56be79);_0xca2924['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x254b04);}else{const _0x5295e8=_0x1c8dcd[0x0][_0xfb1da8(0x2a5)];if(pid[_0x5295e8])pid[_0x5295e8][_0xfb1da8(0x298)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0xb9b94c=>{const _0x4e486a=_0x20c486,_0x5aa201=_0xb9b94c[_0x4e486a(0x1a8)][0x1];_0xb9b94c[_0x4e486a(0x30c)]();if(pid[_0x5aa201])pid[_0x5aa201][_0x4e486a(0x298)]({'function':_0x4e486a(0x1fd),'args':null});}),tgBot[_0x20c486(0x324)](_0x20c486(0x1d3),async _0x7d49c6=>{const _0xfc8f1e=_0x20c486,_0x4e5d46=getEnabledBots();if(_0x4e5d46[_0xfc8f1e(0x19f)]==0x0)await sendTelegram(_0x7d49c6[_0xfc8f1e(0x1ad)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x4e5d46[_0xfc8f1e(0x19f)]>0x1){let _0x5b96fd=[],_0x3f2020=[];const _0x505c33=_0x4e5d46[_0xfc8f1e(0x19f)]%0x4==0x0||_0x4e5d46['length']%0x4==0x3||_0x4e5d46[_0xfc8f1e(0x19f)]%0x3==0x1?0x4:0x3;let _0x4dce9f=0x0;_0x4e5d46[_0xfc8f1e(0x1fb)]((_0x54eb44,_0x36831c)=>{const _0x913c9e=_0xfc8f1e;if(_0x36831c%_0x505c33==0x0)_0x3f2020=[];_0x3f2020[_0x913c9e(0x121)](Markup[_0x913c9e(0x315)][_0x913c9e(0x130)](_0x913c9e(0x1b0)+_0x54eb44[_0x913c9e(0x2a5)],_0x913c9e(0x16e)+_0x54eb44[_0x913c9e(0x2a5)])),_0x36831c%_0x505c33==0x0&&(_0x5b96fd[_0x4dce9f]=_0x3f2020,_0x4dce9f++);});const _0x1234fb=Markup[_0xfc8f1e(0x20e)](_0x5b96fd);_0x7d49c6[_0xfc8f1e(0x238)](_0xfc8f1e(0x202),_0x1234fb);}else{const _0x1544ac=_0x4e5d46[0x0][_0xfc8f1e(0x2a5)];if(pid[_0x1544ac])pid[_0x1544ac][_0xfc8f1e(0x298)]({'function':_0xfc8f1e(0x1f4),'args':null});}}}),tgBot[_0x20c486(0x2a7)](/portfolio_(.+)/,async _0xfcc9ab=>{const _0x50e9dc=_0x20c486,_0x3042f1=_0xfcc9ab['match'][0x1];_0xfcc9ab['editMessageReplyMarkup']();if(pid[_0x3042f1])pid[_0x3042f1][_0x50e9dc(0x298)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x20c486(0x324)]('logs',async _0x50c5d9=>{const _0x280bae=_0x20c486,_0x25e549=_0x280bae(0x314);await zipFiles(_0x25e549);const _0x56f33f=zippath+(_0x25e549+_0x280bae(0x1ee));_0x50c5d9[_0x280bae(0x1c2)]({'source':_0x56f33f})['then'](()=>{})['catch'](_0x141d7c=>logger[_0x280bae(0x1f5)]('Error\x20sending\x20'+_0x25e549+_0x280bae(0x1eb),_0x141d7c));}),tgBot[_0x20c486(0x324)](_0x20c486(0x192),async _0x34acae=>{const _0x3f71fe=_0x20c486,_0x4ac79d=_0x3f71fe(0x192);await backupConfigFiles(),await zipFiles(_0x4ac79d);const _0x2238dd=zippath+(_0x4ac79d+_0x3f71fe(0x1ee));_0x34acae[_0x3f71fe(0x1c2)]({'source':_0x2238dd})[_0x3f71fe(0x18b)](()=>{})[_0x3f71fe(0x2c6)](_0x18421a=>logger[_0x3f71fe(0x1f5)](_0x3f71fe(0x25b)+_0x4ac79d+_0x3f71fe(0x1eb),_0x18421a));}),tgBot[_0x20c486(0x324)](_0x20c486(0x30b),async _0x50e37d=>{const _0x35ed0b=_0x20c486;await getMessages();if(!updateAvailable)await sendTelegram(_0x50e37d[_0x35ed0b(0x1ad)]['id'],_0x35ed0b(0x14e));else{if(!validInstallation)await sendTelegram(_0x50e37d['chat']['id'],_0x35ed0b(0x325));else{const _0x181009=Markup['inlineKeyboard']([Markup[_0x35ed0b(0x315)][_0x35ed0b(0x130)](_0x35ed0b(0x29c),_0x35ed0b(0x15a)),Markup['button'][_0x35ed0b(0x130)]('No',_0x35ed0b(0x17d))]);_0x50e37d['reply'](_0x35ed0b(0x29f),_0x181009);}}}),tgBot[_0x20c486(0x2a7)](/update_(.+)/,async _0x38d516=>{const _0x31c148=_0x20c486,_0x45568d=_0x38d516['match'][0x1];_0x38d516[_0x31c148(0x30c)](),_0x45568d==_0x31c148(0x17a)&&(await sendTelegram(_0x38d516['chat']['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0x31c148(0x30b))),_0x45568d=='no'&&await sendTelegram(_0x38d516[_0x31c148(0x1ad)]['id'],_0x31c148(0x236));}),tgBot[_0x20c486(0x324)](_0x20c486(0x32a),async _0x58b7d0=>{const _0x56a8d2=_0x20c486;if(!validInstallation)await sendTelegram(_0x58b7d0[_0x56a8d2(0x1ad)]['id'],_0x56a8d2(0x245));else{const _0x1eca68=Markup[_0x56a8d2(0x20e)]([Markup['button'][_0x56a8d2(0x130)]('Yes',_0x56a8d2(0x161)),Markup['button'][_0x56a8d2(0x130)]('No','reinstall_no')]);_0x58b7d0[_0x56a8d2(0x238)](_0x56a8d2(0x13d),_0x1eca68);}}),tgBot[_0x20c486(0x2a7)](/reinstall_(.+)/,async _0x16b27b=>{const _0x29e0f2=_0x20c486,_0x33bfbe=_0x16b27b[_0x29e0f2(0x1a8)][0x1];_0x16b27b[_0x29e0f2(0x30c)](),_0x33bfbe=='yes'&&(await sendTelegram(_0x16b27b[_0x29e0f2(0x1ad)]['id'],_0x29e0f2(0x291)),updateBB(_0x29e0f2(0x32a))),_0x33bfbe=='no'&&await sendTelegram(_0x16b27b['chat']['id'],_0x29e0f2(0x2c5));}),tgBot['command']('toggle',async _0x2f2998=>{const _0x2f5104=_0x20c486,_0x339ef3=getBotsWithMode();if(_0x339ef3[_0x2f5104(0x19f)]==0x0)await sendTelegram(_0x2f2998[_0x2f5104(0x1ad)]['id'],_0x2f5104(0x23f));else{let _0xf5c5ef=[],_0x24385f=[];const _0xbce77=0x2;let _0x405330=0x0;_0x339ef3['forEach']((_0x14d906,_0x420170)=>{const _0x3637f9=_0x2f5104;if(_0x420170%_0xbce77==0x0)_0x24385f=[];_0x24385f[_0x3637f9(0x121)](Markup[_0x3637f9(0x315)][_0x3637f9(0x130)](_0x3637f9(0x1b0)+_0x14d906[_0x3637f9(0x2a5)]+'\x20('+_0x14d906[_0x3637f9(0x295)]+')',_0x3637f9(0x15b)+_0x14d906[_0x3637f9(0x2a5)])),_0x420170%_0xbce77==0x0&&(_0xf5c5ef[_0x405330]=_0x24385f,_0x405330++);});const _0xc03c21=Markup[_0x2f5104(0x20e)](_0xf5c5ef);_0x2f2998['reply'](_0x2f5104(0x2bf),_0xc03c21);}}),tgBot[_0x20c486(0x2a7)](/toggle_(.+)/,async _0x4c03e8=>{const _0x2f9dfa=_0x20c486,_0x2f08c1=_0x4c03e8[_0x2f9dfa(0x1a8)][0x1];_0x4c03e8[_0x2f9dfa(0x30c)]();const _0x78ceea=getBotsWithMode(),_0x294bc7=_0x78ceea[_0x2f9dfa(0x249)](_0x17c73d=>_0x17c73d[_0x2f9dfa(0x2a5)]==_0x2f08c1),_0x1d284b=_0x294bc7[_0x2f9dfa(0x295)]=='auto'?'manual':_0x2f9dfa(0x21e);await sendTelegram(_0x4c03e8[_0x2f9dfa(0x1ad)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x2f08c1+'\x20to\x20'+_0x1d284b+_0x2f9dfa(0x1aa)),toggleBotMode(_0x2f08c1);}),tgBot[_0x20c486(0x324)]('names',async _0x2ceac5=>{const _0x1f1c02=_0x20c486;let _0x167f07='';config[_0x1f1c02(0x1fb)](_0x46c10d=>{const _0x43214b=_0x1f1c02;_0x167f07+='Bot\x20'+_0x46c10d[_0x43214b(0x2a5)]+':\x20'+_0x46c10d[_0x43214b(0x150)]+'\x0a';}),await sendTelegram(_0x2ceac5[_0x1f1c02(0x1ad)]['id'],_0x167f07,{'parse_mode':_0x1f1c02(0x2bb)});}),tgBot[_0x20c486(0x324)](_0x20c486(0x284),async _0x241359=>{const _0x56886a=_0x20c486;await sendTelegram(_0x241359[_0x56886a(0x1ad)]['id'],_0x1262d7);}),process[_0x20c486(0x136)](_0x20c486(0x171),()=>tgBot[_0x20c486(0x1e9)]('SIGINT')),process[_0x20c486(0x136)](_0x20c486(0x14d),()=>tgBot[_0x20c486(0x1e9)](_0x20c486(0x14d))),tgBot[_0x20c486(0x268)]();}function disableTelegram(){const _0xc1b37=_0x155ac1;tgBot&&tgBot[_0xc1b37(0x1e9)]();}async function sendTelegram(_0x4cec1b,_0x11c142,_0x55526d){const _0x1f7832=_0x155ac1;_0x55526d={..._0x55526d,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0x1f7832(0x151)](_0x4cec1b,_0x11c142,_0x55526d);}catch(_0x460538){logger['debug'](_0x1f7832(0x1f9),_0x460538);}}async function sendTelegramBot(_0x368ff0,_0x230682){const _0x514c28=_0x155ac1;if(settings[_0x514c28(0x19c)]){if(settings['telegramEvents']==_0x514c28(0x2dd)||(_0x230682['type']==_0x514c28(0x265)||_0x230682[_0x514c28(0x127)]==_0x514c28(0x1fa)||_0x230682['type']==_0x514c28(0x179))&&settings[_0x514c28(0x177)]==_0x514c28(0x2da)||_0x230682[_0x514c28(0x127)]==_0x514c28(0x225)&&settings['telegramEvents']==_0x514c28(0x1ed)){if(tgBot&&settings[_0x514c28(0x17c)]){if(_0x230682['showname'])await sendTelegram(settings[_0x514c28(0x17c)],_0x230682['botname']+_0x514c28(0x26a)+_0x230682['event']);else await sendTelegram(settings[_0x514c28(0x17c)],_0x514c28(0x1b0)+_0x368ff0+'\x20>\x20'+_0x230682[_0x514c28(0x200)]);}}}}async function sendTelegramMsg(_0x467384,_0x25d3e3=_0x155ac1(0x2bb)){const _0x146458=_0x155ac1;return settings['telegramEnabled']&&tgBot&&settings[_0x146458(0x17c)]?(await sendTelegram(settings[_0x146458(0x17c)],_0x467384,{'parse_mode':_0x25d3e3}),!![]):![];}function getDeviceWithIp(_0x6ddfa6){return devices['find'](_0x5d12a2=>_0x5d12a2['ip']===_0x6ddfa6);}async function temporaryAccess2FA(_0x41b2d5,_0x7beb2c){const _0x286273=_0x155ac1;let _0x39ecd3=new Date(),_0x23d021=![];if(lastIpApproval){if(_0x39ecd3-lastIpApproval<0x1388)_0x23d021=!![];}lastIpApproval=new Date();if(_0x23d021)return;if(tgBot&&settings['telegramChatId']){const _0x57f55e=uuidRandom();tmpStorage[_0x57f55e]={'uuid':_0x41b2d5,'externalip':_0x7beb2c};const _0x3be853=Markup['inlineKeyboard']([Markup['button'][_0x286273(0x130)]('5\x20min',_0x286273(0x184)+_0x57f55e),Markup[_0x286273(0x315)][_0x286273(0x130)]('15\x20min',_0x286273(0x124)+_0x57f55e),Markup[_0x286273(0x315)][_0x286273(0x130)](_0x286273(0x140),_0x286273(0x266)+_0x57f55e),Markup['button']['callback'](_0x286273(0x16a),_0x286273(0x198)+_0x57f55e)]);await sendTelegram(settings['telegramChatId'],_0x286273(0x2be)+normalizeIP(_0x7beb2c)[_0x286273(0x31c)]+'\x20?',_0x3be853),tgBot[_0x286273(0x2a7)](/tempaccess_(.+)_(.+)/,async _0x9dfae2=>{const _0x3ed33d=_0x286273,_0x3ac2f7=_0x9dfae2[_0x3ed33d(0x1a8)][0x1],_0x5b16fd=_0x9dfae2[_0x3ed33d(0x1a8)][0x2],{uuid:_0x4db3cd,externalip:_0x58653d}=tmpStorage[_0x5b16fd];delete tmpStorage[_0x5b16fd],_0x9dfae2[_0x3ed33d(0x30c)](),devices[_0x4db3cd]['telegramIpApproval']={'clientip':_0x58653d,'timestamp':new Date()['getTime'](),'expiry':_0x3ac2f7},_0x3ac2f7!=_0x3ed33d(0x16a)?(await sendTelegram(_0x9dfae2[_0x3ed33d(0x1ad)]['id'],_0x3ed33d(0x204)+_0x3ac2f7+'\x20minutes',{'parse_mode':_0x3ed33d(0x2bb)}),io['to'](_0x4db3cd)[_0x3ed33d(0x33f)](_0x3ed33d(0x2b8),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x9dfae2['chat']['id'],_0x3ed33d(0x1e6)),io['to'](_0x4db3cd)['emit'](_0x3ed33d(0x2b8),{'access':{'allow':![],'reason':_0x3ed33d(0x273),'token':null}}));});}}async function loginAccess2FA(_0x418c4d,_0x1f9c21){const _0x3f70ed=_0x155ac1;if(tgBot&&settings[_0x3f70ed(0x17c)]){const _0x14ee3d=uuidRandom();tmpStorage[_0x14ee3d]={'uuid':_0x418c4d,'externalip':_0x1f9c21};const _0x14215e=Markup['inlineKeyboard']([Markup[_0x3f70ed(0x315)][_0x3f70ed(0x130)](_0x3f70ed(0x12f),_0x3f70ed(0x21b)+loginExpiry+'_'+_0x14ee3d),Markup['button']['callback']('reject',_0x3f70ed(0x20a)+_0x14ee3d)]);await sendTelegram(settings[_0x3f70ed(0x17c)],_0x3f70ed(0x18d)+normalizeIP(_0x1f9c21)['show']+'\x20?',_0x14215e),tgBot[_0x3f70ed(0x2a7)](/login2fa_(.+)_(.+)/,async _0x2dfda9=>{const _0x366ffd=_0x3f70ed,_0x4c9ff7=_0x2dfda9[_0x366ffd(0x1a8)][0x1],_0x1eda28=_0x2dfda9['match'][0x2],{uuid:_0xa1fb98,externalip:_0x1b535a}=tmpStorage[_0x1eda28];delete tmpStorage[_0x1eda28],_0x2dfda9[_0x366ffd(0x30c)](),devices[_0xa1fb98][_0x366ffd(0x182)]={'clientip':_0x1b535a,'timestamp':new Date()[_0x366ffd(0x334)](),'expiry':_0x4c9ff7},_0x4c9ff7!=_0x366ffd(0x16a)?(await sendTelegram(_0x2dfda9[_0x366ffd(0x1ad)]['id'],_0x366ffd(0x1fe),{'parse_mode':_0x366ffd(0x2bb)}),io['to'](_0xa1fb98)['emit'](_0x366ffd(0x2b8),{'access':{'allow':![],'reason':_0x366ffd(0x309),'token':null}})):(await sendTelegram(_0x2dfda9[_0x366ffd(0x1ad)]['id'],_0x366ffd(0x1e4)),io['to'](_0xa1fb98)['emit'](_0x366ffd(0x2b8),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x306f83=_0x155ac1;return dbConfig[_0x306f83(0x321)](_0x306f83(0x261))['sortBy']('botID')[_0x306f83(0x2ee)]({'status':_0x306f83(0x142)})[_0x306f83(0x1b3)]()||[];}function getDisabledBots(){const _0xec9d3b=_0x155ac1;return dbConfig[_0xec9d3b(0x321)](_0xec9d3b(0x261))[_0xec9d3b(0x1cf)](_0xec9d3b(0x2a5))[_0xec9d3b(0x2ee)]({'status':_0xec9d3b(0x1de)})[_0xec9d3b(0x1b3)]()||[];}function getBotAttributes(_0x404cab){const _0x1f940b=_0x155ac1;let _0x34db1f={};const _0x49fccd=configpath+_0x1f940b(0x20d)+_0x404cab+_0x1f940b(0x163),_0xa23aac=fs[_0x1f940b(0x257)](_0x49fccd);if(_0xa23aac){const _0x2975c5=fs[_0x1f940b(0x15d)](_0x49fccd);try{const _0x5165c1=JSON[_0x1f940b(0x306)](_0x2975c5),_0x3312c1=_0x5165c1?_0x5165c1[_0x1f940b(0x2f4)][0x0][_0x1f940b(0x2df)]:![];_0x34db1f[_0x1f940b(0x295)]=_0x3312c1?_0x1f940b(0x21e):_0x1f940b(0x2b7),_0x34db1f[_0x1f940b(0x150)]=_0x5165c1?_0x5165c1[_0x1f940b(0x2f4)][0x0][_0x1f940b(0x150)]:_0x1f940b(0x1b0)+_0x404cab;}catch(_0x46b319){_0x34db1f[_0x1f940b(0x295)]=_0x1f940b(0x2b7),_0x34db1f[_0x1f940b(0x150)]=_0x1f940b(0x1b0)+_0x404cab;}}else _0x34db1f[_0x1f940b(0x295)]=_0x1f940b(0x2b7),_0x34db1f['botname']=_0x1f940b(0x1b0)+_0x404cab;return _0x34db1f;}function getBotsWithMode(){const _0x5cff85=_0x155ac1,_0x2d1a39=dbConfig[_0x5cff85(0x321)](_0x5cff85(0x261))['sortBy'](_0x5cff85(0x2a5))[_0x5cff85(0x1b3)]()||[];return _0x2d1a39['forEach'](_0x1a6607=>{const _0x6c7979=_0x5cff85;let _0x46f279=getBotAttributes(_0x1a6607[_0x6c7979(0x2a5)]);_0x1a6607['mode']=_0x46f279[_0x6c7979(0x295)];}),_0x2d1a39;}function getBotExchanges(){const _0x2beea7=_0x155ac1;let _0x176cab=[];const _0x43c0e6=dbConfig[_0x2beea7(0x321)]('bots')[_0x2beea7(0x1cf)]('botID')[_0x2beea7(0x1b3)]()||[];_0x43c0e6[_0x2beea7(0x1fb)](_0x349d44=>{const _0x257847=_0x2beea7;if(_0x349d44[_0x257847(0x2b8)]==_0x257847(0x142)){const _0x2d1952=configpath+_0x257847(0x20d)+_0x349d44[_0x257847(0x2a5)]+_0x257847(0x163),_0x41a21d=fs[_0x257847(0x257)](_0x2d1952);let _0x17f6f0;if(_0x41a21d){const _0x576931=fs[_0x257847(0x15d)](_0x2d1952);try{const _0x483e23=JSON[_0x257847(0x306)](_0x576931);_0x17f6f0=_0x483e23?_0x483e23[_0x257847(0x2f4)][0x0][_0x257847(0x1b6)]:null;}catch(_0xeab834){}}if(_0x17f6f0)_0x176cab[_0x257847(0x121)](_0x17f6f0);}});const _0x3f9c15=[...new Set(_0x176cab)][_0x2beea7(0x205)]();return _0x3f9c15;}async function initUser(){const _0x1669e0=_0x155ac1;if(!settings[_0x1669e0(0x308)]){const _0xda6bf5=uuidRandom();mixpanel[_0x1669e0(0x2ad)](_0xda6bf5),updateSetting('userid',_0xda6bf5);}}async function initSecure(){const _0x4e7a2f=_0x155ac1;let _0x41ccf0=getSecure();if(!_0x41ccf0['hasOwnProperty'](_0x4e7a2f(0x23a))){let _0x16179a=await generateKeys();_0x41ccf0[_0x4e7a2f(0x206)]=_0x16179a[_0x4e7a2f(0x206)],_0x41ccf0[_0x4e7a2f(0x264)]=_0x16179a[_0x4e7a2f(0x264)],_0x41ccf0[_0x4e7a2f(0x23a)]=crypto['randomBytes'](0x20)['toString'](_0x4e7a2f(0x29d));;storeSecure(_0x41ccf0);}}function getSettings(){const _0x232259=_0x155ac1;return dbSettings[_0x232259(0x321)]('settings')[_0x232259(0x1b3)]()||{};}function getSecure(){const _0x34b6c8=_0x155ac1;return dbSecure[_0x34b6c8(0x321)](_0x34b6c8(0x154))['value']()||{};}function getBlacklist(){const _0x428fbd=_0x155ac1;return dbSecure[_0x428fbd(0x321)](_0x428fbd(0x2a0))['value']()||[];}function broadcastToBots(_0xded992,_0x3e204f){const _0x5778c2=_0x155ac1;config[_0x5778c2(0x1fb)](_0x55d3fd=>{const _0xf58280=_0x5778c2;if(_0x55d3fd[_0xf58280(0x2b8)]==_0xf58280(0x142)&&_0x55d3fd['live']==_0xf58280(0x14c)||_0x55d3fd[_0xf58280(0x2b8)]=='new'&&_0x55d3fd[_0xf58280(0x1ef)]=='running'){if(pid[_0x55d3fd[_0xf58280(0x2a5)]])pid[_0x55d3fd['botID']][_0xf58280(0x298)]({[_0xded992]:_0x3e204f});}});}async function storeSettings(_0x2a05c5,_0x80cae1=![]){const _0x3783cf=_0x155ac1;_0x2a05c5={...settings,..._0x2a05c5};if(_0x80cae1&&_0x2a05c5['bbPassword']!=_0x3783cf(0x274)&&_0x2a05c5[_0x3783cf(0x338)]!='***'&&_0x2a05c5['bbPassword']!=''){const _0x57d02f=decryptRSA(secure[_0x3783cf(0x264)],_0x2a05c5[_0x3783cf(0x338)])[_0x3783cf(0x12e)]('|@|')[0x0],_0xa99930=bcrypt['hashSync'](_0x57d02f,saltRounds);_0x2a05c5={..._0x2a05c5,'bbPassword':_0xa99930};}if(_0x80cae1&&_0x2a05c5[_0x3783cf(0x27a)]!=_0x3783cf(0x274)&&_0x2a05c5['telegramToken']!=_0x3783cf(0x12c)&&_0x2a05c5['telegramToken']!=''){const _0x3dfb04=decryptRSA(secure[_0x3783cf(0x264)],_0x2a05c5[_0x3783cf(0x27a)])[_0x3783cf(0x12e)](_0x3783cf(0x1ec))[0x0];_0x2a05c5={..._0x2a05c5,'telegramToken':_0x3dfb04};}if(_0x80cae1&&_0x2a05c5[_0x3783cf(0x215)]!=_0x3783cf(0x274)&&_0x2a05c5[_0x3783cf(0x215)]!='***'&&_0x2a05c5[_0x3783cf(0x215)]!=''){const _0x47fdda=decryptRSA(secure[_0x3783cf(0x264)],_0x2a05c5[_0x3783cf(0x215)])[_0x3783cf(0x12e)](_0x3783cf(0x1ec))[0x0];_0x2a05c5={..._0x2a05c5,'marketcapApi':_0x47fdda};}const _0x4ddfe2=_0x2a05c5[_0x3783cf(0x27a)]!=_0x3783cf(0x274)&&_0x2a05c5['telegramToken']!=settings[_0x3783cf(0x27a)]||_0x2a05c5['telegramUsername']!=settings[_0x3783cf(0x2cd)],_0x5ee38c=_0x2a05c5['telegramToken']==''||_0x2a05c5[_0x3783cf(0x2cd)]=='',_0x52ab28=_0x2a05c5[_0x3783cf(0x215)]&&_0x2a05c5['marketcapApi']!=_0x3783cf(0x274)&&_0x2a05c5[_0x3783cf(0x215)]!=settings[_0x3783cf(0x27a)];_0x4ddfe2&&(_0x2a05c5[_0x3783cf(0x17c)]=null,_0x2a05c5[_0x3783cf(0x177)]=_0x3783cf(0x2dd));for(const [_0x2ec4e2,_0x4f39fb]of Object[_0x3783cf(0x214)](_0x2a05c5)){if(_0x2ec4e2==_0x3783cf(0x27a)&&_0x4f39fb==_0x3783cf(0x274)){_0x2a05c5[_0x3783cf(0x27a)]=settings[_0x3783cf(0x27a)];continue;};if(_0x2ec4e2==_0x3783cf(0x338)&&_0x4f39fb==_0x3783cf(0x274)){_0x2a05c5['bbPassword']=settings['bbPassword'];continue;};if(_0x2ec4e2==_0x3783cf(0x215)&&_0x4f39fb==_0x3783cf(0x274)){_0x2a05c5[_0x3783cf(0x215)]=settings['marketcapApi'];continue;};dbSettings['set'](_0x3783cf(0x2f5)+_0x2ec4e2,_0x4f39fb)[_0x3783cf(0x289)]();}settings=_0x2a05c5,io['to'](_0x3783cf(0x28d))[_0x3783cf(0x33f)](_0x3783cf(0x25f),cleanSettings()),broadcastToBots(_0x3783cf(0x27c),settings[_0x3783cf(0x27c)]),broadcastToBots(_0x3783cf(0x280),settings[_0x3783cf(0x280)]),broadcastToBots(_0x3783cf(0x215),settings[_0x3783cf(0x215)]);if(_0x4ddfe2&&!_0x5ee38c)initTelegram();if(_0x4ddfe2&&_0x5ee38c)disableTelegram();getAllClients()[_0x3783cf(0x1fb)](_0x15310d=>{const _0xfe251b=_0x3783cf;getSocket(_0x15310d['id'])[_0xfe251b(0x33f)](_0xfe251b(0x2b8),{'access':{'allow':![],'reason':_0xfe251b(0x309),'token':null}});}),_0x52ab28&&(await sleep(0xbb8),testMarketcapApi(_0x2a05c5[_0x3783cf(0x215)]));}async function testMarketcapApi(_0x3ca7a0){const _0xbbac9d=_0x155ac1,_0x17b613=[_0xbbac9d(0x2f1),_0xbbac9d(0x18c)];try{await axios[_0xbbac9d(0x321)](_0xbbac9d(0x252),{'headers':{'X-CMC_PRO_API_KEY':_0x3ca7a0},'params':{'symbol':_0x17b613[_0xbbac9d(0x21d)]()}});}catch(_0x1c5c70){_0x1c5c70[_0xbbac9d(0x21d)]()['includes'](_0xbbac9d(0x13c))?(io['to'](_0xbbac9d(0x28d))[_0xbbac9d(0x33f)](_0xbbac9d(0x137),_0xbbac9d(0x26b)),logger[_0xbbac9d(0x2fa)](_0xbbac9d(0x26b))):(io['to'](_0xbbac9d(0x28d))[_0xbbac9d(0x33f)]('notification','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0xbbac9d(0x2fa)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0xbbac9d(0x1f5)]('Error\x20details:',_0x1c5c70['toString']()+_0xbbac9d(0x316)+_0x1c5c70['code']));return;}logger[_0xbbac9d(0x1f5)](_0xbbac9d(0x2f7));}function updateSetting(_0x287a45,_0x1bb0da){const _0x59b33d=_0x155ac1;dbSettings[_0x59b33d(0x2fe)](_0x59b33d(0x2f5)+_0x287a45,_0x1bb0da)[_0x59b33d(0x289)](),settings=getSettings(),io['to'](_0x59b33d(0x28d))['emit']('settings',cleanSettings());}function storeSecure(_0x35ba08){const _0x33302f=_0x155ac1;dbSecure[_0x33302f(0x321)]('secure')[_0x33302f(0x121)](_0x35ba08)[_0x33302f(0x289)](),secure=_0x35ba08;}function addBlacklist(_0x5d2916){const _0xb2c531=_0x155ac1;cleanBlacklist();let _0x28e45e;devices[_0x5d2916]['telegramIpApproval']?_0x28e45e=Math[_0xb2c531(0x1cc)](devices[_0x5d2916][_0xb2c531(0x1a7)][_0xb2c531(0x17f)],loginExpiry):_0x28e45e=loginExpiry,dbSecure['get'](_0xb2c531(0x2a0))['push']({'expiry':new Date()['getTime']()+_0x28e45e*0x3c*0x3e8,'token':devices[_0x5d2916][_0xb2c531(0x196)][_0xb2c531(0x1c8)]})[_0xb2c531(0x289)](),blacklist=dbSecure[_0xb2c531(0x321)](_0xb2c531(0x2a0))[_0xb2c531(0x1b3)]();}function cleanBlacklist(){const _0x40661a=_0x155ac1;let _0x5a5fe6=dbSecure['get'](_0x40661a(0x2a0))[_0x40661a(0x276)]()[_0x40661a(0x1b3)](),_0x472b61=new Date()['getTime']();_0x5a5fe6[_0x40661a(0x1fb)](_0x3f462e=>{const _0x3e7cb9=_0x40661a;_0x3f462e[_0x3e7cb9(0x17f)]<_0x472b61&&dbSecure[_0x3e7cb9(0x321)]('blacklist')['remove']({'expiry':_0x3f462e['expiry']})[_0x3e7cb9(0x289)]();});}function initStates(){let _0x5a65a8=getConfiguration();_0x5a65a8['forEach'](_0x3b1e06=>{const _0x266bbc=_0x3b45;_0x3b1e06[_0x266bbc(0x1ef)]=_0x266bbc(0x285);}),storeConfiguration(_0x5a65a8);}async function generateKeys(){const _0x44d389=_0x155ac1,_0xc0dfeb=forge['pki'][_0x44d389(0x27d)][_0x44d389(0x159)]({'bits':0x1000,'e':0x10001}),_0x5eee07=forge[_0x44d389(0x2e9)][_0x44d389(0x1c7)](_0xc0dfeb[_0x44d389(0x264)]),_0x59babc=forge[_0x44d389(0x2e9)][_0x44d389(0x153)](_0xc0dfeb[_0x44d389(0x206)]);return{'privateKey':_0x5eee07,'publicKey':_0x59babc};}async function oneTimeMigration(){const _0x16237a=_0x155ac1;let _0x130480=getSettings(),_0x321ebc=![];!_0x130480[_0x16237a(0x19e)]('lastmsgtelegram')&&(_0x130480[_0x16237a(0x2a6)]=0x0,_0x321ebc=!![]);!_0x130480[_0x16237a(0x19e)](_0x16237a(0x288))&&(_0x130480[_0x16237a(0x288)]=0x0,_0x321ebc=!![]);!_0x130480['hasOwnProperty'](_0x16237a(0x1db))&&(_0x130480['latestversion']=_0x16237a(0x2cf),_0x321ebc=!![]);!_0x130480[_0x16237a(0x19e)]('onepagemode')&&(_0x130480[_0x16237a(0x280)]=![],_0x321ebc=!![]);!_0x130480[_0x16237a(0x19e)](_0x16237a(0x215))&&(_0x130480[_0x16237a(0x215)]='',_0x321ebc=!![]);if(_0x321ebc)storeSettings(_0x130480);try{fs[_0x16237a(0x18a)](configbackuppath,{'withFileTypes':!![]})[_0x16237a(0x1fb)](_0xd875e2=>{const _0x22620d=_0x16237a;if(!_0xd875e2[_0x22620d(0x299)]()){if(!_0xd875e2[_0x22620d(0x2d6)][_0x22620d(0x207)](_0x22620d(0x1b1)))fs[_0x22620d(0x168)](configbackuppath+_0xd875e2[_0x22620d(0x2d6)]);}else fs['rmSync'](configbackuppath+_0xd875e2[_0x22620d(0x2d6)],{'recursive':!![]});});}catch(_0x55fa7c){logger[_0x16237a(0x1f5)](_0x16237a(0x2bc),_0x55fa7c);}}function storeConfiguration(_0x4ac970){const _0x29a7dd=_0x155ac1;dbConfig[_0x29a7dd(0x321)](_0x29a7dd(0x261))[_0x29a7dd(0x253)]()[_0x29a7dd(0x289)](),dbConfig[_0x29a7dd(0x321)]('bots')[_0x29a7dd(0x121)](..._0x4ac970)[_0x29a7dd(0x289)](),config=_0x4ac970;}async function resetPassword(){const _0x463646=_0x155ac1;if(tgBot&&settings[_0x463646(0x17c)]){const _0x2bca54=Markup[_0x463646(0x20e)]([Markup['button']['callback'](_0x463646(0x17a),'resetpw_yes'),Markup[_0x463646(0x315)]['callback']('no','resetpw_no')]);await sendTelegram(settings[_0x463646(0x17c)],_0x463646(0x208),_0x2bca54),tgBot[_0x463646(0x2a7)](/resetpw_(.+)/,async _0x47c6b2=>{const _0x3e6f9d=_0x463646,_0x4ce370=_0x47c6b2[_0x3e6f9d(0x1a8)][0x1];_0x47c6b2[_0x3e6f9d(0x30c)]();if(_0x4ce370!='no'){const _0x47188b=0xf,_0x1f002e='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x1fa6ed=Array[_0x3e6f9d(0x1ae)](crypto[_0x3e6f9d(0x2af)](new Uint32Array(_0x47188b)))[_0x3e6f9d(0x296)](_0x21f87d=>_0x1f002e[_0x21f87d%_0x1f002e['length']])[_0x3e6f9d(0x157)](''),_0x58f9f8=bcrypt['hashSync'](_0x1fa6ed,saltRounds);storeSettings({'bbPassword':_0x58f9f8}),await sendTelegram(_0x47c6b2[_0x3e6f9d(0x1ad)]['id'],_0x3e6f9d(0x231)+_0x1fa6ed,{'parse_mode':_0x3e6f9d(0x2bb)});}else await sendTelegram(_0x47c6b2[_0x3e6f9d(0x1ad)]['id'],_0x3e6f9d(0x141));});}}async function confirmRestore(_0x8be4d8,_0x2ed973){const _0xa28115=_0x155ac1;io['to'](_0xa28115(0x28d))['emit'](_0xa28115(0x137),_0xa28115(0x2b1),_0xa28115(0x179));if(tgBot&&settings['telegramChatId']){const _0x41cd78=uuidRandom();tmpStorage[_0x41cd78]={'path':_0x8be4d8,'filename':_0x2ed973};const _0x323189=Markup['inlineKeyboard']([Markup[_0xa28115(0x315)]['callback'](_0xa28115(0x17a),_0xa28115(0x2e1)+_0x41cd78),Markup[_0xa28115(0x315)][_0xa28115(0x130)]('no','restore_no_'+_0x41cd78)]);await sendTelegram(settings[_0xa28115(0x17c)],_0xa28115(0x218),_0x323189),tgBot[_0xa28115(0x2a7)](/restore_(.+)_(.+)/,async _0x583c06=>{const _0x7acb8=_0xa28115,_0x1f45d7=_0x583c06[_0x7acb8(0x1a8)][0x1],_0x1274a4=_0x583c06[_0x7acb8(0x1a8)][0x2],{path:_0x3786c9,filename:_0x523629}=tmpStorage[_0x1274a4];delete tmpStorage[_0x1274a4],_0x583c06[_0x7acb8(0x30c)](),_0x1f45d7==_0x7acb8(0x17a)?(logger[_0x7acb8(0x1f5)](_0x7acb8(0x256)),await sendTelegram(_0x583c06[_0x7acb8(0x1ad)]['id'],_0x7acb8(0x25d),{'parse_mode':'HTML'}),unzipFile(_0x3786c9,_0x523629)):(logger[_0x7acb8(0x1f5)]('Restore\x20process\x20aborted'),await sendTelegram(_0x583c06[_0x7acb8(0x1ad)]['id'],_0x7acb8(0x2d8)));});}}function getServerTime(){const _0x256113=_0x155ac1,_0x2ed691=new Date();return _0x2ed691['getFullYear']()+'/'+(_0x2ed691[_0x256113(0x32d)]()+0x1)[_0x256113(0x21d)]()[_0x256113(0x340)](0x2,'0')+'/'+_0x2ed691[_0x256113(0x20f)]()[_0x256113(0x21d)]()[_0x256113(0x340)](0x2,'0')+'\x20'+_0x2ed691[_0x256113(0x283)]()[_0x256113(0x21d)]()[_0x256113(0x340)](0x2,'0')+':'+_0x2ed691['getMinutes']()[_0x256113(0x21d)]()['padStart'](0x2,'0')+':'+_0x2ed691[_0x256113(0x2d0)]()[_0x256113(0x21d)]()[_0x256113(0x340)](0x2,'0');}function getTimeStamp(){const _0x51c541=_0x155ac1,_0x51eb37=shiftedTime();return _0x51eb37['getFullYear']()+'/'+(_0x51eb37[_0x51c541(0x32d)]()+0x1)[_0x51c541(0x21d)]()[_0x51c541(0x340)](0x2,'0')+'/'+_0x51eb37[_0x51c541(0x20f)]()[_0x51c541(0x21d)]()[_0x51c541(0x340)](0x2,'0')+'\x20'+_0x51eb37[_0x51c541(0x283)]()['toString']()[_0x51c541(0x340)](0x2,'0')+':'+_0x51eb37[_0x51c541(0x235)]()['toString']()[_0x51c541(0x340)](0x2,'0')+':'+_0x51eb37[_0x51c541(0x2d0)]()[_0x51c541(0x21d)]()[_0x51c541(0x340)](0x2,'0');}function getCleanTimeStamp(){const _0x259136=_0x155ac1,_0x107e2d=shiftedTime();return _0x107e2d[_0x259136(0x139)]()+(_0x107e2d[_0x259136(0x32d)]()+0x1)[_0x259136(0x21d)]()['padStart'](0x2,'0')+_0x107e2d[_0x259136(0x20f)]()[_0x259136(0x21d)]()['padStart'](0x2,'0')+'-'+_0x107e2d[_0x259136(0x283)]()[_0x259136(0x21d)]()['padStart'](0x2,'0')+_0x107e2d[_0x259136(0x235)]()[_0x259136(0x21d)]()[_0x259136(0x340)](0x2,'0')+_0x107e2d[_0x259136(0x2d0)]()[_0x259136(0x21d)]()[_0x259136(0x340)](0x2,'0');}function shiftedTime(){const _0x5e2a2a=_0x155ac1,_0x11e5b4=new Date();let _0x200947=_0x11e5b4;if(settings[_0x5e2a2a(0x27c)]&&settings[_0x5e2a2a(0x27c)]!==0x0)_0x200947=fns[_0x5e2a2a(0x20c)](_0x11e5b4,{'hours':settings['timeshift']});return _0x200947;}async function startScheduler(){const _0x8aa2ab=_0x155ac1,_0x36b929=new Date()[_0x8aa2ab(0x303)](),_0x461b02=shiftedTime()[_0x8aa2ab(0x283)]();_0x461b02==0x4&&backupConfigFiles(),_0x461b02==0x0&&(rotateLogFiles(),logger['debug']('--------------------------------------'),logger[_0x8aa2ab(0x1f5)](_0x8aa2ab(0x211)+serverversion+_0x8aa2ab(0x2f6)+(environment=='staging'?'(staging)':'')),logger[_0x8aa2ab(0x1f5)]('--------------------------------------')),_0x36b929%0x6==0x0&&triggerAnalytics(),_0x36b929%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x2d9613){const _0x3d086a=_0x155ac1;logger[_0x3d086a(0x1f5)](_0x3d086a(0x260)+_0x2d9613);const _0x409022=getBotsWithMode();_0x409022[_0x3d086a(0x19f)]>0x0?confirmRestore(configbackuppath,_0x2d9613):unzipFile(configbackuppath,_0x2d9613);}async function getBackupFiles(_0x73adfb=null){const _0x29bf04=_0x155ac1;let _0xf8ec0c=[],_0x1c968d=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x1c968d[_0x29bf04(0x205)]((_0x156f82,_0x2bed83)=>_0x156f82[_0x29bf04(0x2d6)]<_0x2bed83[_0x29bf04(0x2d6)]?0x1:_0x2bed83[_0x29bf04(0x2d6)]<_0x156f82['name']?-0x1:0x0),_0x1c968d['forEach'](_0x28604f=>{const _0x363f7a=_0x29bf04;if(!_0x28604f[_0x363f7a(0x299)]()&&_0x28604f[_0x363f7a(0x2d6)][_0x363f7a(0x207)]('backup-full@')&&_0x28604f[_0x363f7a(0x2d6)][_0x363f7a(0x337)]('.zip')){const _0x14ae01=formatDate(fs[_0x363f7a(0x1a5)](configbackuppath+_0x28604f[_0x363f7a(0x2d6)])['mtime']);_0xf8ec0c[_0x363f7a(0x121)]({'name':_0x28604f[_0x363f7a(0x2d6)],'mtime':_0x14ae01});}});if(_0x73adfb)io['to'](_0x73adfb)['emit']('backup-files',_0xf8ec0c);else return _0xf8ec0c;}async function backupConfigFiles(){const _0x9cb9e1=_0x155ac1;await zipFiles(_0x9cb9e1(0x2aa));const _0x1429aa=getCleanTimeStamp();fs[_0x9cb9e1(0x187)](zippath+_0x9cb9e1(0x269),configbackuppath+('backup-full@'+_0x1429aa+_0x9cb9e1(0x1ee)));let _0x2cc951=fs[_0x9cb9e1(0x18a)](configbackuppath,{'withFileTypes':!![]});_0x2cc951[_0x9cb9e1(0x205)]((_0x6865be,_0x47c25d)=>_0x6865be['name']<_0x47c25d[_0x9cb9e1(0x2d6)]?0x1:_0x47c25d['name']<_0x6865be[_0x9cb9e1(0x2d6)]?-0x1:0x0),_0x2cc951[_0x9cb9e1(0x19f)]>maxBackups&&fs[_0x9cb9e1(0x168)](configbackuppath+_0x2cc951[_0x2cc951['length']-0x1][_0x9cb9e1(0x2d6)]);}function rotateLogFiles(){const _0x59edc2=_0x155ac1,_0x176815=fs[_0x59edc2(0x1a5)](logspath+_0x59edc2(0x2ef)),_0x5bbfab=_0x176815[_0x59edc2(0x1ea)]/0x400;if(_0x5bbfab>0x64){let _0x49721e=fs[_0x59edc2(0x18a)](logspath,{'withFileTypes':!![]});_0x49721e[_0x59edc2(0x205)]((_0x1258b5,_0x5e3f80)=>_0x1258b5[_0x59edc2(0x2d6)]<_0x5e3f80[_0x59edc2(0x2d6)]?0x1:_0x5e3f80[_0x59edc2(0x2d6)]<_0x1258b5[_0x59edc2(0x2d6)]?-0x1:0x0),_0x49721e[_0x59edc2(0x1fb)](_0x1c31c5=>{const _0x5a508c=_0x59edc2;if(_0x1c31c5[_0x5a508c(0x2d6)]=='output-002.log')fs['copyFileSync'](logspath+_0x1c31c5[_0x5a508c(0x2d6)],logspath+_0x5a508c(0x31f));if(_0x1c31c5[_0x5a508c(0x2d6)]=='output-001.log')fs['copyFileSync'](logspath+_0x1c31c5[_0x5a508c(0x2d6)],logspath+_0x5a508c(0x169));_0x1c31c5[_0x5a508c(0x2d6)]==_0x5a508c(0x2ef)&&(fs[_0x5a508c(0x187)](logspath+_0x1c31c5[_0x5a508c(0x2d6)],logspath+_0x5a508c(0x1c6)),fs['writeFileSync'](logspath+_0x1c31c5[_0x5a508c(0x2d6)],''));});}}async function zipFiles(_0x2d6590){const _0x5c7d71=_0x155ac1;let _0x2a9cda;if(_0x2d6590==_0x5c7d71(0x314))_0x2a9cda=logspath;if(_0x2d6590==_0x5c7d71(0x192))_0x2a9cda=configpath;if(_0x2d6590==_0x5c7d71(0x2aa))_0x2a9cda=configpath;let _0x3869ad=fs[_0x5c7d71(0x18a)](_0x2a9cda,{'withFileTypes':!![]});const _0x378fcb=new JSZip();_0x3869ad[_0x5c7d71(0x1fb)](_0xa67759=>{const _0x51693e=_0x5c7d71;if(!_0xa67759['isDirectory']()){let _0xdab811=fs[_0x51693e(0x15d)](_0x2a9cda+_0xa67759[_0x51693e(0x2d6)]);if(_0x2d6590=='backup'){const _0xd77a76=/^bot-[0-9]{3}-config.json$/,_0x19e44b=_0xd77a76['test'](_0xa67759['name']);if(_0x19e44b){const _0x1b14ed=JSON[_0x51693e(0x306)](_0xdab811);if(_0x1b14ed[_0x51693e(0x2f4)][0x0]){_0x1b14ed[_0x51693e(0x2f4)][0x0][_0x51693e(0x2c1)]=_0x51693e(0x12c),_0x1b14ed[_0x51693e(0x2f4)][0x0][_0x51693e(0x17b)]=_0x51693e(0x12c);if(_0x1b14ed[_0x51693e(0x2f4)][0x0]['apiPassword'])_0x1b14ed['bot'][0x0][_0x51693e(0x1cd)]=_0x51693e(0x12c);}_0xdab811=JSON[_0x51693e(0x1b9)](_0x1b14ed,null,0x2);}if(_0xa67759[_0x51693e(0x2d6)]=='bb-settings.json'){const _0x2623cc=JSON[_0x51693e(0x306)](_0xdab811);if(_0x2623cc[_0x51693e(0x25f)][_0x51693e(0x22b)])_0x2623cc[_0x51693e(0x25f)]['loginRequired']=![];if(_0x2623cc[_0x51693e(0x25f)]['bbPassword'])_0x2623cc[_0x51693e(0x25f)][_0x51693e(0x338)]=_0x51693e(0x12c);if(_0x2623cc[_0x51693e(0x25f)][_0x51693e(0x27a)])_0x2623cc[_0x51693e(0x25f)][_0x51693e(0x27a)]=_0x51693e(0x12c);if(_0x2623cc[_0x51693e(0x25f)][_0x51693e(0x17c)])_0x2623cc[_0x51693e(0x25f)][_0x51693e(0x17c)]=null;if(_0x2623cc[_0x51693e(0x25f)]['marketcapApi'])_0x2623cc[_0x51693e(0x25f)][_0x51693e(0x215)]=_0x51693e(0x12c);_0xdab811=JSON['stringify'](_0x2623cc,null,0x2);}if(_0xa67759['name']!=_0x51693e(0x290))_0x378fcb[_0x51693e(0x286)](_0xa67759[_0x51693e(0x2d6)],_0xdab811);}else _0x378fcb[_0x51693e(0x286)](_0xa67759[_0x51693e(0x2d6)],_0xdab811);}});const _0x36c81d=await _0x378fcb[_0x5c7d71(0x26f)]({'type':_0x5c7d71(0x132),'base64':![],'compression':_0x5c7d71(0x2b5)});fs['writeFileSync'](zippath+(_0x2d6590+_0x5c7d71(0x1ee)),_0x36c81d,'binary');}async function unzipFile(_0xb8677b,_0x18f678){const _0x90bc4c=_0x155ac1;fs[_0x90bc4c(0x18a)](configpath,{'withFileTypes':!![]})[_0x90bc4c(0x1fb)](_0x1192a7=>{if(!_0x1192a7['isDirectory']())fs['rmSync'](configpath+_0x1192a7['name']);});const _0x217131=fs['readFileSync'](_0xb8677b+_0x18f678,_0x90bc4c(0x23b)),_0x3f5592=await JSZip[_0x90bc4c(0x1e2)](_0x217131,{'base64':![],'checkCRC32':!![]});for(const _0x9f118b of Object['keys'](_0x3f5592['files'])){const _0x3fcc9b=_0x3f5592[_0x90bc4c(0x175)][_0x9f118b],_0x3e662f=await _0x3fcc9b['async'](_0x90bc4c(0x132));fs['writeFileSync'](configpath+_0x3fcc9b[_0x90bc4c(0x2d6)],_0x3e662f);}fs['readdirSync'](temppath,{'withFileTypes':!![]})[_0x90bc4c(0x1fb)](_0x5a2bea=>{const _0x260f15=_0x90bc4c;if(!_0x5a2bea[_0x260f15(0x299)]())fs[_0x260f15(0x300)](temppath+_0x5a2bea['name']);}),logger[_0x90bc4c(0x1f5)](_0x90bc4c(0x2c8)),process[_0x90bc4c(0x298)]({'restore':!![]},_0xa65822=>{});}async function getPublicIp(){const _0x18afe7=_0x155ac1;try{const _0x12bf45=await axios[_0x18afe7(0x321)](_0x18afe7(0x2c3));publicip=_0x12bf45[_0x18afe7(0x2e7)]['ip'];}catch(_0x2b46e6){}}async function triggerAnalytics(){const _0x393981=_0x155ac1;if(!publicip)await getPublicIp();const _0x50551b=getBotsWithMode();let _0x4334c7=0x0;_0x50551b['forEach'](_0x5d0768=>{const _0x252bb8=_0x3b45;if(_0x5d0768[_0x252bb8(0x2b8)]==='enabled')_0x4334c7++;});const _0x223709=getBotExchanges();mixpanel[_0x393981(0x1bb)](_0x393981(0x2c4),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x50551b[_0x393981(0x19f)],'numbotsenabled':_0x4334c7,'exchanges':_0x223709,'environment':environment});}async function getMessages(){const _0x26385=_0x155ac1,_0x3fd92b=_0x26385(0x2cb),_0x50ffe0=new GraphQLClient(_0x3fd92b),_0x1bcff7={'authorization':_0x26385(0x135)},_0x1f1b05=serverversion[_0x26385(0x12e)]('.'),_0x27717f=_0x1f1b05[0x0]+'.'+_0x1f1b05[0x1],_0x476124=Math['min'](settings[_0x26385(0x2a6)],settings[_0x26385(0x288)]),_0x477433={'last':parseInt(_0x476124),'bbm':_0x27717f},_0x3851c8=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4739fd;try{_0x4739fd=await _0x50ffe0[_0x26385(0x26d)](_0x3851c8,_0x477433,_0x1bcff7);}catch(_0x1b4088){}if(_0x4739fd&&_0x4739fd[_0x26385(0x278)]){let _0x746c82=settings['lastmsgtelegram'];newMessages=[];for(const _0x2bd543 of _0x4739fd['messages']){newMessages['push'](_0x2bd543);let _0x3ebea8=![];_0x2bd543['bbvNew']&&(updateSetting('latestversion',_0x2bd543['bbvNew']),_0x3ebea8=isNewerVersion(serverversion,_0x2bd543[_0x26385(0x2c7)])||serverversion==_0x2bd543[_0x26385(0x2c7)]);if(!_0x3ebea8&&_0x2bd543[_0x26385(0x323)]>_0x746c82){if(_0x2bd543['bbvReceive']===_0x26385(0x32b)||serverversion[_0x26385(0x207)](_0x2bd543[_0x26385(0x1c3)])){let _0x3cf955=''+_0x2bd543[_0x26385(0x332)]+'\x0a\x0a'+_0x2bd543['message'];const _0x4b9063=await sendTelegramMsg(toTelegramMarkdown(_0x3cf955),_0x26385(0x1ac));if(_0x4b9063)_0x746c82=_0x2bd543['number'];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x26385(0x2a6),_0x746c82),emitMessages();}}function emitMessages(){const _0x19e557=_0x155ac1,_0x26f78d=settings[_0x19e557(0x288)];let _0x57f4d9=[];newMessages['forEach'](_0x403193=>{const _0xa5caae=_0x19e557;_0x403193[_0xa5caae(0x323)]>_0x26f78d&&_0x57f4d9[_0xa5caae(0x121)](_0x403193);}),_0x57f4d9[_0x19e557(0x19f)]>0x0&&getAllClients()['forEach'](_0x47e3fb=>{const _0x19291a=_0x19e557;getSocket(_0x47e3fb['id'])[_0x19291a(0x33f)](_0x19291a(0x301),_0x57f4d9);});}function confirmMessage(_0x7b7338){const _0xd590d6=_0x155ac1;updateSetting(_0xd590d6(0x288),Number(_0x7b7338));}function isNewerVersion(_0x276a04,_0x12e59d){const _0x98366a=_0x155ac1,_0x16b8f8=_0x12e59d[_0x98366a(0x12e)]('.'),_0x4166fb=_0x276a04[_0x98366a(0x12e)]('.');for(var _0x7ddf13=0x0;_0x7ddf13<_0x4166fb[_0x98366a(0x19f)];_0x7ddf13++){const _0x26c417=~~_0x4166fb[_0x7ddf13],_0xf07106=~~_0x16b8f8[_0x7ddf13];if(_0x26c417>_0xf07106)return!![];if(_0x26c417<_0xf07106)return![];}return![];}function toTelegramMarkdown(_0x1ca554){const _0x184747=_0x155ac1,_0x205e56=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x2fb640=/\*{2}(.+?)\*{2}/gim;return _0x1ca554=_0x1ca554['replace'](_0x205e56,_0x184747(0x18e))['replace'](_0x2fb640,_0x184747(0x2a4)),_0x1ca554;}async function validateConfigFile(){const _0x3cb8d2=_0x155ac1,_0x5af1ce=dbConfig['get']('bots')[_0x3cb8d2(0x1cf)](_0x3cb8d2(0x2a5))[_0x3cb8d2(0x1b3)]()||[];if(_0x5af1ce['length']==0x0){let _0x1b9175=0x0,_0x59629a=[];const _0x55a76b=/^bot-([0-9]{3})-config.json$/,_0x3763cb=fs[_0x3cb8d2(0x18a)](configpath);_0x3763cb[_0x3cb8d2(0x1fb)](_0x46dda7=>{const _0x51bbef=_0x3cb8d2,_0x453aa0=_0x55a76b[_0x51bbef(0x2a8)](_0x46dda7);if(_0x453aa0){const _0x439ade=_0x453aa0[0x1];let _0x3c03e7=getBotAttributes(_0x439ade);_0x59629a['push']({'botID':_0x439ade,'botname':_0x3c03e7[_0x51bbef(0x150)],'status':_0x51bbef(0x1de),'live':_0x51bbef(0x285)}),_0x1b9175++;}}),_0x1b9175!=0x0&&(dbConfig[_0x3cb8d2(0x321)](_0x3cb8d2(0x261))[_0x3cb8d2(0x293)](_0x59629a)[_0x3cb8d2(0x289)](),config=_0x59629a,restoredConfigFile=_0x1b9175);}}async function restoreConfigNotify(_0x3b766d){const _0x1103ef=_0x155ac1;let _0x458b33;if(restoredConfigFile==0x1)_0x458b33=_0x1103ef(0x21c);else _0x458b33='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x3b766d)io['to'](_0x1103ef(0x28d))[_0x1103ef(0x33f)](_0x1103ef(0x137),_0x458b33);else{logger[_0x1103ef(0x170)](_0x1103ef(0x1be)),logger['simple'](_0x458b33),logger['simple'](_0x1103ef(0x1be)),logger[_0x1103ef(0x170)]('');if(tgBot&&settings[_0x1103ef(0x17c)]&&settings[_0x1103ef(0x177)]!=_0x1103ef(0x1ed))await sendTelegram(settings[_0x1103ef(0x17c)],_0x1103ef(0x12b)+_0x458b33);}}function decryptRSA(_0x1a065d,_0x4c5f05){const _0x54bd0a=_0x155ac1,_0x5cdc51=forge[_0x54bd0a(0x2e9)][_0x54bd0a(0x237)](_0x1a065d),_0x4c0af5=_0x5cdc51[_0x54bd0a(0x317)](forge['util'][_0x54bd0a(0x30f)](_0x4c5f05),'RSA-OAEP',{'md':forge['md'][_0x54bd0a(0x244)][_0x54bd0a(0x1f0)](),'mgf1':{'md':forge['md'][_0x54bd0a(0x244)][_0x54bd0a(0x1f0)]()}});return _0x4c0af5;}function validateCredentials(_0x6cb1fc,_0x29bd39){const _0x2e8853=_0x155ac1;if(_0x6cb1fc[_0x2e8853(0x2a2)]==settings['bbUsername']&&bcrypt[_0x2e8853(0x329)](_0x6cb1fc[_0x2e8853(0x1ab)],settings[_0x2e8853(0x338)])){if(settings['f2aRequired'])return{'allow':![],'reason':_0x2e8853(0x2cc),'token':null};else{const _0x4f38ad=generateLoginToken(_0x29bd39);return{'allow':!![],'reason':_0x2e8853(0x1a2),'token':_0x4f38ad};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x88bc80){const _0x1310ed=_0x155ac1,_0x1e2a91=generateLoginToken(_0x88bc80);return{'allow':!![],'reason':_0x1310ed(0x1a2),'token':_0x1e2a91};}function validateAccess(_0x526886,_0x20cbe6,_0x2cd48d){const _0xb293cf=_0x155ac1,_0xaee9c3=_0x2cd48d?_0x2cd48d:devices[_0x20cbe6]['ip'];let _0x40f456;const _0x287b8b=_0x469186=>{const _0x4a6f2b=_0x3b45;if(settings[_0x4a6f2b(0x22b)]){if(settings[_0x4a6f2b(0x1f8)]){if(telegram2FaApproved(_0x20cbe6)){const _0x3d5a16=generateLoginToken(_0x20cbe6);return{'allow':!![],'reason':_0x4a6f2b(0x1f1),'token':_0x3d5a16};}else return{'allow':![],'reason':_0x4a6f2b(0x14a),'token':null};}else return _0x40f456=validToken(_0x469186,_0x20cbe6),_0x40f456['hasOwnProperty']('success')?{'allow':!![],'reason':_0x4a6f2b(0x2d9),'token':_0x469186}:{'allow':![],'reason':_0x4a6f2b(0x14a),'token':null};}else return{'allow':!![],'reason':_0x4a6f2b(0x1fc),'token':null};};if(settings['whitelistEnabled']){let _0xebe043=[...settings['whitelist'],'::1',_0xb293cf(0x22f),'127.0.0.1'];if(_0xebe043['includes'](_0xaee9c3))return _0x287b8b(_0x526886);else{_0x40f456=validToken(_0x526886,_0x20cbe6);if(_0x40f456[_0xb293cf(0x19e)](_0xb293cf(0x179)))return _0x287b8b(_0x526886);else{if(telegramIpApproved(_0x20cbe6)){const _0x9534bb=generateToken(_0x20cbe6);return _0x40f456=_0x287b8b(_0x526886),_0x40f456[_0xb293cf(0x26e)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x9534bb}:_0x40f456;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0xb293cf(0x1da),'token':null}:{'allow':![],'reason':_0xb293cf(0x328),'token':null};}}}else return _0x287b8b(_0x526886);}function timelyDecrypt(_0x11d23b,_0xf45ae0,_0x3fa1bf='@'){const _0x221c0e=_0x155ac1;if(_0x11d23b)try{const _0x553e5d=decryptRSA(secure['privateKey'],_0x11d23b),_0xc601f1=_0x553e5d[_0x221c0e(0x12e)](_0x3fa1bf)[0x0],_0x1e18fa=_0x553e5d['split'](_0x3fa1bf)[0x1],_0xbc9090=new Date()[_0x221c0e(0x334)]();if(_0xf45ae0){if(_0xbc9090-_0x1e18fa<maxSecretAge*0x3e8)return _0xc601f1;else return![];}else return _0xc601f1;}catch(_0x502050){return![];}else return![];}const validToken=(_0x498684,_0x4ee73f)=>{const _0x828843=_0x155ac1,_0x406930=devices[_0x4ee73f]['ip'];if(!_0x498684)return{'error':_0x828843(0x165)};for(let _0x404439 of blacklist){if(_0x404439[_0x828843(0x1c8)]==_0x498684)return{'error':_0x828843(0x2db)};}let _0x1240af;try{_0x1240af=jwt[_0x828843(0x13e)](_0x498684,secure[_0x828843(0x23a)]+_0x4ee73f);}catch{return{'error':_0x828843(0x239)};}if(!_0x1240af[_0x828843(0x19e)](_0x828843(0x241))&&!_0x1240af['hasOwnProperty']('username')||!_0x1240af['hasOwnProperty']('exp'))return{'error':_0x828843(0x2e3)};if(!_0x1240af[_0x828843(0x19e)](_0x828843(0x2a2))&&_0x1240af[_0x828843(0x19e)]('clientip')){const {clientip:_0x3d3505}=_0x1240af;return _0x406930==_0x3d3505?{'success':_0x828843(0x173)}:{'error':_0x828843(0x1b5)};}else{if(_0x1240af['hasOwnProperty'](_0x828843(0x2a2))&&_0x1240af[_0x828843(0x19e)](_0x828843(0x241))){const {username:_0x512fa1,clientip:_0x4d604d}=_0x1240af;return settings[_0x828843(0x313)]==_0x512fa1&&_0x406930==_0x4d604d?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x828843(0x1d4)};}}},generateLoginToken=_0x47af93=>{const _0x162c1b=_0x155ac1;if(_0x47af93){const _0x393cc6=devices[_0x47af93]['ip'];return jwt[_0x162c1b(0x220)]({'username':settings[_0x162c1b(0x313)],'clientip':_0x393cc6},secure['secret']+_0x47af93,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x403fe1=>{const _0x817097=_0x155ac1;if(_0x403fe1){const _0x303cf8=devices[_0x403fe1]['ip'];return jwt[_0x817097(0x220)]({'clientip':_0x303cf8},secure[_0x817097(0x23a)]+_0x403fe1,{'expiresIn':devices[_0x403fe1][_0x817097(0x1a7)][_0x817097(0x17f)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x1c1d32=>{const _0x4109c9=_0x155ac1;let _0x5b8332=![];return devices[_0x1c1d32][_0x4109c9(0x1a7)]&&devices[_0x1c1d32][_0x4109c9(0x1a7)]['expiry']!='reject'&&(_0x5b8332=devices[_0x1c1d32][_0x4109c9(0x1a7)][_0x4109c9(0x241)]==devices[_0x1c1d32]['ip']&&new Date()['getTime']()-devices[_0x1c1d32][_0x4109c9(0x1a7)][_0x4109c9(0x234)]<devices[_0x1c1d32][_0x4109c9(0x1a7)]['expiry']*0x3c*0x3e8),_0x5b8332;},telegram2FaApproved=_0x3a6b81=>{const _0x288fdf=_0x155ac1;let _0x369e9e=![];return devices[_0x3a6b81][_0x288fdf(0x182)]&&devices[_0x3a6b81][_0x288fdf(0x182)][_0x288fdf(0x17f)]!=_0x288fdf(0x16a)&&(_0x369e9e=devices[_0x3a6b81][_0x288fdf(0x182)][_0x288fdf(0x241)]==devices[_0x3a6b81]['ip']&&new Date()[_0x288fdf(0x334)]()-devices[_0x3a6b81][_0x288fdf(0x182)][_0x288fdf(0x234)]<devices[_0x3a6b81]['telegram2FaApproval'][_0x288fdf(0x17f)]*0x3c*0x3e8),_0x369e9e;},normalizeIP=_0x1b4892=>{const _0x3fdc37=_0x155ac1;let _0x5441c5=null,_0xb14dc8=null;if(ipaddr[_0x3fdc37(0x29b)](_0x1b4892)){const _0xef01d6=ipaddr[_0x3fdc37(0x306)](_0x1b4892);_0xef01d6[_0x3fdc37(0x31e)]()===_0x3fdc37(0x302)?(_0xef01d6['isIPv4MappedAddress']()&&(_0x5441c5=_0xef01d6[_0x3fdc37(0x326)]()[_0x3fdc37(0x21d)]()),_0xb14dc8=_0xef01d6[_0x3fdc37(0x21d)]()):(_0x5441c5=_0xef01d6[_0x3fdc37(0x21d)](),_0xb14dc8=_0xef01d6[_0x3fdc37(0x122)]()[_0x3fdc37(0x21d)]());}return{'show':_0x5441c5?_0x5441c5:_0xb14dc8,'store':_0xb14dc8};};function formatDate(_0x22ac2d){const _0x5f0f87=_0x155ac1;return _0x22ac2d[_0x5f0f87(0x139)]()+'/'+(_0x22ac2d[_0x5f0f87(0x32d)]()+0x1)[_0x5f0f87(0x21d)]()[_0x5f0f87(0x340)](0x2,'0')+'/'+_0x22ac2d[_0x5f0f87(0x20f)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x22ac2d['getHours']()[_0x5f0f87(0x21d)]()['padStart'](0x2,'0')+':'+_0x22ac2d[_0x5f0f87(0x235)]()[_0x5f0f87(0x21d)]()[_0x5f0f87(0x340)](0x2,'0')+':'+_0x22ac2d[_0x5f0f87(0x2d0)]()['toString']()[_0x5f0f87(0x340)](0x2,'0');}function sleep(_0x18b83b){return new Promise(_0x10066b=>setTimeout(_0x10066b,_0x18b83b));}