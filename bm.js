const _0x281d12=_0x3323;(function(_0x1501d4,_0x1f6f77){const _0x214da1=_0x3323,_0x189df3=_0x1501d4();while(!![]){try{const _0x597ba3=-parseInt(_0x214da1(0x2ce))/0x1+-parseInt(_0x214da1(0x212))/0x2*(-parseInt(_0x214da1(0x24c))/0x3)+parseInt(_0x214da1(0x2c3))/0x4+-parseInt(_0x214da1(0x1eb))/0x5+parseInt(_0x214da1(0x1cd))/0x6+-parseInt(_0x214da1(0x14f))/0x7*(parseInt(_0x214da1(0x1a2))/0x8)+parseInt(_0x214da1(0x354))/0x9;if(_0x597ba3===_0x1f6f77)break;else _0x189df3['push'](_0x189df3['shift']());}catch(_0x1614ed){_0x189df3['push'](_0x189df3['shift']());}}}(_0x3e04,0x1efc4));const _0x49f109=function(){let _0x12b622=!![];return function(_0x1eb3dc,_0x5f33b1){const _0x36b3fc=_0x12b622?function(){const _0x21d5d7=_0x3323;if(_0x5f33b1){const _0x5e818b=_0x5f33b1[_0x21d5d7(0x2b2)](_0x1eb3dc,arguments);return _0x5f33b1=null,_0x5e818b;}}:function(){};return _0x12b622=![],_0x36b3fc;};}(),_0x42d64d=_0x49f109(this,function(){const _0x59dc11=_0x3323;return _0x42d64d['toString']()[_0x59dc11(0x2ae)](_0x59dc11(0x30e))['toString']()[_0x59dc11(0x26b)](_0x42d64d)[_0x59dc11(0x2ae)]('(((.+)+)+)+$');});_0x42d64d();'use strict';process[_0x281d12(0x2a4)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x281d12(0x307)),fs=require('fs'),fns=require(_0x281d12(0x333)),low=require(_0x281d12(0x331)),FileSync=require(_0x281d12(0x355)),path=require(_0x281d12(0x282)),crypto=require('crypto'),forge=require(_0x281d12(0x18e)),bcrypt=require(_0x281d12(0x338)),jwt=require(_0x281d12(0x1d3)),ipaddr=require(_0x281d12(0x166)),yargs=require(_0x281d12(0x168)),uuidRandom=require(_0x281d12(0x157)),{Telegraf,Markup}=require(_0x281d12(0x20d)),Mixpanel=require('mixpanel'),axios=require(_0x281d12(0x17d)),{GraphQLClient,gql}=require(_0x281d12(0x295)),util=require(_0x281d12(0x35c)),fileUpload=require(_0x281d12(0x28a)),{networkInterfaces}=require('os'),JSZip=require(_0x281d12(0x20c)),argv=yargs(process['argv'][_0x281d12(0x1d6)](0x2))[_0x281d12(0x239)],PORT=argv[_0x281d12(0x2e3)]||_0x281d12(0x2bc),pattern=/^[0-9]{2,4}$/;!pattern[_0x281d12(0x19c)](PORT)&&(console[_0x281d12(0x26d)](_0x281d12(0x248)+PORT+_0x281d12(0x32d)),process[_0x281d12(0x1e2)](0x1));const HOST=argv[_0x281d12(0x258)]||null,userID=argv[_0x281d12(0x1f0)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process[_0x281d12(0x1cf)]['node'];let bbpath=_0x281d12(0x158),bbpath2='';const botfile='bot.js',configfile=_0x281d12(0x22d),settingsfile=_0x281d12(0x25c),securefile=_0x281d12(0x2c2),environment=require('./'+bbpath2+'version.json')[_0x281d12(0x151)]||_0x281d12(0x236),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x281d12(0x315)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x281d12(0x15f),configbackuppath=configpath+_0x281d12(0x2de),logspath=userID?bbpath+_0x281d12(0x14d)+userID+'/':bbpath+_0x281d12(0x14d),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x281d12(0x34f),loggerfile=fs[_0x281d12(0x178)](logspath+_0x281d12(0x1b4),{'flags':'a'}),temppath=userID?bbpath+_0x281d12(0x28b)+userID+'/':bbpath+_0x281d12(0x28b);!fs[_0x281d12(0x2a6)](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs[_0x281d12(0x2b6)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0x281d12(0x2b6)](logspath);!fs['existsSync'](zippath)&&fs['mkdirSync'](zippath);!fs[_0x281d12(0x2a6)](temppath)&&fs[_0x281d12(0x2b6)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x281d12(0x23a)]({'bots':[]})[_0x281d12(0x1b6)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x281d12(0x23a)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x281d12(0x1b6)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x281d12(0x23a)]({'secure':{},'blacklist':[]})[_0x281d12(0x1b6)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x281d12(0x1d0)](_0x281d12(0x2ad),{'host':_0x281d12(0x304)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x281d12(0x2fe)]&&(settings[_0x281d12(0x2fe)]!=''&&settings[_0x281d12(0x2fe)]!=_0x281d12(0x1dc))&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x6c074e,_0x39f701)=>{const _0x4dd79d=_0x281d12,_0x5a7b12=/#[A-Z]{3}#/g;if(typeof _0x6c074e=='string'){!_0x39f701?_0x6c074e=_0x6c074e['replace'](_0x5a7b12,''):(_0x6c074e=_0x6c074e[_0x4dd79d(0x356)](/#BLU#/g,_0x4dd79d(0x203)),_0x6c074e=_0x6c074e[_0x4dd79d(0x356)](/#RED#/g,_0x4dd79d(0x18c)),_0x6c074e=_0x6c074e[_0x4dd79d(0x356)](/#YEL#/g,'\x1b[33m'),_0x6c074e=_0x6c074e[_0x4dd79d(0x356)](/#MAG#/g,_0x4dd79d(0x270)),_0x6c074e=_0x6c074e['replace'](/#CYA#/g,_0x4dd79d(0x314)),_0x6c074e=_0x6c074e['replace'](/#RES#/g,_0x4dd79d(0x351)));;}return _0x6c074e;},logger={'screen':_0x5df0c9=>{const _0x27a9c5=_0x281d12;console[_0x27a9c5(0x26d)](parseColor(_0x5df0c9,!![]));},'simple':_0x169982=>{console['log'](parseColor(_0x169982,!![])),loggerfile['write'](util['format'](parseColor(_0x169982,![]))+'\x0a');},'full':async _0x516aad=>{const _0x3bbb61=_0x281d12,_0x3ba549=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x516aad;console[_0x3bbb61(0x26d)](parseColor(_0x3ba549,!![])),loggerfile['write'](util[_0x3bbb61(0x262)](parseColor(_0x3ba549,![]))+'\x0a');if(tgBot&&settings[_0x3bbb61(0x1b8)]&&settings[_0x3bbb61(0x261)]!=_0x3bbb61(0x24e))await sendTelegram(settings[_0x3bbb61(0x1b8)],_0x3bbb61(0x14e)+parseColor(_0x516aad,![]));},'debug':async(_0x5c6b15,_0xcb90f3='')=>{const _0x1b8ee1=_0x281d12,_0x114766=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20'+_0x5c6b15;if(debugging)console[_0x1b8ee1(0x26d)](parseColor(_0x114766,!![]));loggerfile[_0x1b8ee1(0x1b6)](util['format'](parseColor(_0x114766,![]))+'\x0a');if(_0xcb90f3){if(debugging)console[_0x1b8ee1(0x26d)](_0xcb90f3);loggerfile[_0x1b8ee1(0x1b6)](util[_0x1b8ee1(0x262)](_0xcb90f3)+'\x0a');}}};let terminating=![];process['on'](_0x281d12(0x235),function(_0x3b5aee){const _0x6769dc=_0x281d12;_0x3b5aee[_0x6769dc(0x145)]()['includes']('address\x20already\x20in\x20use')?(logger['simple']('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x3b5aee[_0x6769dc(0x2e3)]+_0x6769dc(0x34d)),process[_0x6769dc(0x281)]({'terminate':!![]},_0x2c4362=>{})):logger[_0x6769dc(0x310)](_0x3b5aee);}),process['on'](_0x281d12(0x1e2),()=>{const _0x363138=_0x281d12;stopAllBots(),process[_0x363138(0x1e2)](0x0);}),process['on']('SIGTERM',()=>{const _0x307a06=_0x281d12;stopAllBots(),process[_0x307a06(0x1e2)](0x0);}),process['on']('SIGINT',()=>{const _0x1ddb80=_0x281d12;stopAllBots(),process[_0x1ddb80(0x1e2)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x281d12(0x2bd))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x281d12(0x1a8)),app=express(),http=require(_0x281d12(0x188))[_0x281d12(0x22b)](app);app[_0x281d12(0x246)](fileUpload({'useTempFiles':!![]})),app[_0x281d12(0x302)](_0x281d12(0x227),async(_0x589581,_0x5e397e)=>{const _0x497b24=_0x281d12,_0x3b77bf=_0x589581[_0x497b24(0x283)][_0x497b24(0x1cb)],_0x3b7196=getClientsWithBotID(_0x497b24(0x27b)),_0x275f16=_0x589581[_0x497b24(0x20e)][_0x497b24(0x2a2)],_0x117eb6=timelyDecrypt(_0x275f16,![]),_0x467ba0=_0x3b7196['find'](_0x2fec12=>_0x2fec12[_0x497b24(0x2a2)]==_0x117eb6);if(_0x467ba0){const _0x156cbb=normalizeIP(_0x589581[_0x497b24(0x152)][_0x497b24(0x1c3)])[_0x497b24(0x325)],_0x20955a=_0x589581[_0x497b24(0x20e)][_0x497b24(0x28e)];if(validateAccess(_0x20955a,_0x117eb6,_0x156cbb)[_0x497b24(0x328)])_0x3b77bf=='backup'&&await backupConfigFiles(),await zipFiles(_0x3b77bf),_0x5e397e[_0x497b24(0x161)](zippath+(_0x3b77bf+_0x497b24(0x147)),_0x4c23ec=>{const _0x2f119b=_0x497b24;_0x4c23ec&&(logger['full'](_0x2f119b(0x19e)+_0x3b77bf),logger['simple'](_0x4c23ec));});else logger['full'](_0x497b24(0x26c)+_0x3b77bf+_0x497b24(0x306));}else logger[_0x497b24(0x1fa)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x3b77bf+'\x20(2)');}),app[_0x281d12(0x22c)]('/upload-backup',async(_0x26ba6f,_0x243c7e)=>{const _0x37a043=_0x281d12,_0x3edab6=getClientsWithBotID(_0x37a043(0x27b)),_0xbfea30=_0x26ba6f[_0x37a043(0x20e)][_0x37a043(0x2a2)],_0x2c5cdb=timelyDecrypt(_0xbfea30,![]),_0x291c7e=_0x3edab6[_0x37a043(0x171)](_0x1ac574=>_0x1ac574[_0x37a043(0x2a2)]==_0x2c5cdb);logger[_0x37a043(0x1ae)](_0x37a043(0x220));if(_0x291c7e){const _0x3848ba=normalizeIP(_0x26ba6f[_0x37a043(0x152)]['remoteAddress'])[_0x37a043(0x325)],_0x21f7e9=_0x26ba6f[_0x37a043(0x20e)][_0x37a043(0x28e)];if(validateAccess(_0x21f7e9,_0x2c5cdb,_0x3848ba)['allow']){if(_0x26ba6f['files']){const _0x280d48=_0x26ba6f['files'][_0x37a043(0x35d)];await _0x280d48['mv'](temppath+_0x280d48[_0x37a043(0x320)]),_0x243c7e[_0x37a043(0x281)]({'status':!![],'message':'File\x20uploaded'});const _0x39c54a=getBotsWithMode();_0x39c54a[_0x37a043(0x1fb)]>0x0?confirmRestore(temppath,_0x280d48[_0x37a043(0x320)]):unzipFile(temppath,_0x280d48[_0x37a043(0x320)]);}}else logger[_0x37a043(0x1fa)](_0x37a043(0x2e9));}else logger['full']('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x281d12(0x246)](express[_0x281d12(0x336)](path['join'](__dirname,bbpath2,_0x281d12(0x140)))),app[_0x281d12(0x246)](express[_0x281d12(0x336)](path['join'](__dirname,bbpath2,_0x281d12(0x206)))),app['get']('/',function(_0x9bf14d,_0x562b66){const _0x640a66=_0x281d12;_0x562b66[_0x640a66(0x359)](path['join'](__dirname,bbpath2,_0x640a66(0x140),'index.html'));}),app[_0x281d12(0x302)](_0x281d12(0x358),function(_0x1dbf8b,_0x10bdf1){const _0x51f7b2=_0x281d12;_0x10bdf1[_0x51f7b2(0x359)](path[_0x51f7b2(0x20b)](__dirname,bbpath2,_0x51f7b2(0x206),_0x51f7b2(0x31e)));}),app[_0x281d12(0x302)](_0x281d12(0x1a3),(_0xbfbad1,_0x18505b)=>{const _0x466a54=_0x281d12;_0x18505b[_0x466a54(0x359)](path[_0x466a54(0x20b)](__dirname,bbpath2,'build',_0x466a54(0x31e)));}),app[_0x281d12(0x302)](_0x281d12(0x2c8),(_0x2bedea,_0x41e74d)=>{const _0xde9773=_0x281d12;_0x41e74d[_0xde9773(0x359)](path['join'](__dirname,bbpath2,_0xde9773(0x206),_0xde9773(0x31e)));}),app[_0x281d12(0x302)](_0x281d12(0x350),(_0x195e30,_0x16e10a)=>{const _0x3b9d4a=_0x281d12;_0x16e10a[_0x3b9d4a(0x359)](path[_0x3b9d4a(0x20b)](__dirname,bbpath2,_0x3b9d4a(0x206),_0x3b9d4a(0x31e)));}),app[_0x281d12(0x302)](_0x281d12(0x224),(_0x5d2c47,_0x15c940)=>{const _0x565b63=_0x281d12;_0x15c940[_0x565b63(0x359)](path[_0x565b63(0x20b)](__dirname,bbpath2,_0x565b63(0x206),_0x565b63(0x31e)));}),app['get']('/:bot/configuration',(_0x462978,_0x57301e)=>{const _0x2782bc=_0x281d12;_0x57301e[_0x2782bc(0x359)](path[_0x2782bc(0x20b)](__dirname,bbpath2,_0x2782bc(0x206),_0x2782bc(0x31e)));}),app['get']('/:bot/support',(_0x4296f9,_0x1a1044)=>{const _0x2c31ec=_0x281d12;_0x1a1044['sendFile'](path[_0x2c31ec(0x20b)](__dirname,bbpath2,_0x2c31ec(0x206),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0x281d12(0x35b)](PORT);const io=require(_0x281d12(0x27d))(http,{});openBrowser&&(async()=>{const _0x468a88=_0x281d12,{default:_0x3866d3}=await import(_0x468a88(0x190));await _0x3866d3(_0x468a88(0x23f)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x419b87=_0x281d12;let _0x1ba35c='[ip-address]';const _0x24442d=networkInterfaces(),_0x128856={};for(const _0x2334ff of Object[_0x419b87(0x2fc)](_0x24442d)){for(const _0x4056ae of _0x24442d[_0x2334ff]){if((_0x4056ae[_0x419b87(0x1db)]==_0x419b87(0x23d)||_0x4056ae[_0x419b87(0x1db)]==0x4)&&!_0x4056ae['internal']){const _0x153244=ipaddr['parse'](_0x4056ae[_0x419b87(0x22f)])[_0x419b87(0x1b1)]();_0x153244!='private'&&(!_0x128856[_0x2334ff]&&(_0x128856[_0x2334ff]=[]),_0x128856[_0x2334ff]['push'](_0x4056ae[_0x419b87(0x22f)]),_0x1ba35c=_0x4056ae[_0x419b87(0x22f)]);}}}return{'serverip':_0x1ba35c,'netinterfaces':_0x128856};}async function startServer(){const _0x7376c6=_0x281d12,{serverip:_0x433af7,netinterfaces:_0x18c3da}=getServerIP();logger[_0x7376c6(0x310)](''),logger[_0x7376c6(0x310)]('-----------------------------------------------------------------------------------'),await logger['full'](_0x7376c6(0x251)+serverversion+_0x7376c6(0x267)+(environment==_0x7376c6(0x2f7)?_0x7376c6(0x200):'')+'\x0a'+(_0x7376c6(0x189)+PORT+_0x7376c6(0x316))+(_0x7376c6(0x280)+_0x433af7+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0x7376c6(0x310)](_0x7376c6(0x1ab));if(config['length']!=0x0)for(const _0x373acc of config){const _0x188c34=_0x373acc[_0x7376c6(0x308)]==_0x7376c6(0x1b2)?'a':'m';if(_0x373acc[_0x7376c6(0x337)]=='enabled'||_0x373acc[_0x7376c6(0x337)]=='new')await logger[_0x7376c6(0x1fa)](_0x7376c6(0x2e7)+_0x188c34+_0x7376c6(0x1a5)+_0x373acc[_0x7376c6(0x219)]+_0x7376c6(0x146)+_0x373acc['botname']),startBot([_0x373acc[_0x7376c6(0x219)],userID],{'cwd':bbpath},function(_0x3e47b5){const _0x418be8=_0x7376c6;if(_0x3e47b5)logger[_0x418be8(0x1fa)](_0x3e47b5);});else(_0x373acc['status']==_0x7376c6(0x2dc)||_0x373acc[_0x7376c6(0x337)]=='new-disabled')&&await logger[_0x7376c6(0x1fa)](_0x7376c6(0x1ef)+_0x188c34+_0x7376c6(0x15a)+_0x373acc[_0x7376c6(0x219)]+_0x7376c6(0x146)+_0x373acc['botname']);}else!newBot&&logger[_0x7376c6(0x310)](_0x7376c6(0x1e5));if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger['simple'](''),await logger['debug']('Node.js\x20v'+nodeversion),await logger[_0x7376c6(0x1ae)](_0x7376c6(0x1aa),_0x18c3da);}function startSocket(){const _0x174fb8=_0x281d12;io['on'](_0x174fb8(0x35a),_0x1f1341=>{const _0x3396b3=_0x174fb8;let _0x32585c,_0x18cce1,_0x57795d,_0xff1ee1,_0x5b9524;const _0x1a9897=_0x1f1341[_0x3396b3(0x340)][_0x3396b3(0x20e)][_0x3396b3(0x2ea)];_0x18cce1=_0x1a9897[_0x3396b3(0x22e)](/bot[0-9]{3}/);if(_0x18cce1)_0x57795d=_0x18cce1[0x0][_0x3396b3(0x22e)](/[0-9]{3}/);if(_0x57795d)_0x32585c=_0x57795d[0x0];else _0x32585c=_0x3396b3(0x27b);const _0x3a341c=_0x1f1341[_0x3396b3(0x340)][_0x3396b3(0x159)][_0x3396b3(0x23c)];if(!_0x3a341c)_0x1f1341[_0x3396b3(0x2fb)]('status',{'publicKey':secure[_0x3396b3(0x230)]});else{_0xff1ee1=timelyDecrypt(_0x3a341c,![]);if(!_0xff1ee1)_0x1f1341[_0x3396b3(0x2fb)](_0x3396b3(0x337),{'publicKey':secure[_0x3396b3(0x230)]});else{_0x5b9524=normalizeIP(_0x1f1341[_0x3396b3(0x225)]['remoteAddress'])[_0x3396b3(0x325)];if(!devices[_0xff1ee1])devices[_0xff1ee1]={'uuid':_0xff1ee1,'access':{'token':null}};devices[_0xff1ee1]['ip']=_0x5b9524;const _0xc9576d=addClient(_0x1f1341['id'],_0xff1ee1,_0x32585c);setAccess(_0xc9576d),emitMessages(),_0x1f1341['on'](_0x3396b3(0x32c),_0x1ec40f=>{const _0x404ed7=_0x3396b3,_0x95aaf5=timelyDecrypt(_0x1ec40f[_0x404ed7(0x1ed)],!![],_0x404ed7(0x21d));if(_0x95aaf5){_0x1ec40f={'username':_0x1ec40f[_0x404ed7(0x1ca)],'password':_0x95aaf5},devices[_0xff1ee1][_0x404ed7(0x334)]=validateCredentials(_0x1ec40f,_0xff1ee1);if(devices[_0xff1ee1][_0x404ed7(0x334)][_0x404ed7(0x328)]==![]&&devices[_0xff1ee1]['access'][_0x404ed7(0x232)]==_0x404ed7(0x2cd))_0x1f1341['emit'](_0x404ed7(0x337),{'access':devices[_0xff1ee1][_0x404ed7(0x334)]}),loginAccess2FA(_0xff1ee1,_0x5b9524);else{if(devices[_0xff1ee1][_0x404ed7(0x334)]['allow']==![]&&devices[_0xff1ee1][_0x404ed7(0x334)][_0x404ed7(0x232)]==_0x404ed7(0x204))_0x1f1341[_0x404ed7(0x2fb)]('status',{'access':devices[_0xff1ee1][_0x404ed7(0x334)]});else devices[_0xff1ee1]['access'][_0x404ed7(0x328)]&&devices[_0xff1ee1][_0x404ed7(0x334)]['reason']==_0x404ed7(0x1c8)&&(getClientsWithUuid(_0xff1ee1)[_0x404ed7(0x21b)](_0xdd7606=>{setAccess(_0xdd7606);}),logger[_0x404ed7(0x1ae)]('Logged\x20in\x20user\x20...'+_0xff1ee1[_0x404ed7(0x1d6)](-0x8)),setTokenRefresh(_0xff1ee1),setSessionTimeout('login',_0xff1ee1));}}else logger[_0x404ed7(0x1fa)](_0x404ed7(0x249));}),_0x1f1341['on'](_0x3396b3(0x300),()=>{resetPassword();}),_0x1f1341['on'](_0x3396b3(0x31a),_0x3dfa4f=>{removeClient(_0x1f1341['id']);}),_0x32585c==_0x3396b3(0x27b)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x152018){const _0x4fa83a=_0x281d12;if(_0x152018!=_0x4fa83a(0x27b)&&config[_0x4fa83a(0x25d)]!=''){if(pid[_0x152018])pid[_0x152018][_0x4fa83a(0x281)]({'function':_0x4fa83a(0x2d9),'args':null});}_0x152018!=_0x4fa83a(0x27b)&&broadcastToBots('bots',JSON['stringify'](config));}function reloadBotManager(){const _0x3a0001=_0x281d12;getClientsWithBotID('botmanager')[_0x3a0001(0x21b)](_0x33cf81=>{const _0x49c72a=_0x3a0001;getSocket(_0x33cf81['id'])[_0x49c72a(0x2fb)](_0x49c72a(0x337),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x179232){const _0x3125c7=_0x281d12,_0x4b5ed8=io[_0x3125c7(0x268)][_0x3125c7(0x302)]('/');return _0x4b5ed8['sockets'][_0x3125c7(0x302)](_0x179232);}function setAccess(_0x5d9603){const _0x553de4=_0x281d12,_0x4e28c8=getSocket(_0x5d9603['id']),_0x35c79c=_0x5d9603['uuid'],_0x5b65bb=_0x5d9603[_0x553de4(0x207)];devices[_0x35c79c][_0x553de4(0x334)]=validateAccess(devices[_0x35c79c][_0x553de4(0x334)][_0x553de4(0x13f)],_0x35c79c),logger[_0x553de4(0x1ae)]('Setting\x20access:\x20'+devices[_0x35c79c][_0x553de4(0x334)][_0x553de4(0x232)]+'\x20|\x20client:\x20...'+_0x5d9603['id'][_0x553de4(0x1d6)](-0x8)+_0x553de4(0x309)+_0x35c79c[_0x553de4(0x1d6)](-0x8)),_0x4e28c8[_0x553de4(0x20b)](_0x35c79c);if(devices[_0x35c79c][_0x553de4(0x334)][_0x553de4(0x328)]){_0x4e28c8[_0x553de4(0x20b)](_0x5b65bb);if(_0x5b65bb==_0x553de4(0x27b))initializeSocketBotManager(_0x4e28c8);else initializeSocketBot(_0x4e28c8);initClient(_0x5b65bb);}devices[_0x35c79c]['access'][_0x553de4(0x13f)]&&devices[_0x35c79c]['access'][_0x553de4(0x232)]==_0x553de4(0x2ca)&&setSessionTimeout(_0x553de4(0x1de),_0x35c79c),devices[_0x35c79c]['access'][_0x553de4(0x13f)]&&devices[_0x35c79c][_0x553de4(0x334)][_0x553de4(0x232)]==_0x553de4(0x162)&&setSessionTimeout(_0x553de4(0x32c),_0x35c79c),_0x4e28c8[_0x553de4(0x2fb)](_0x553de4(0x337),{'status':_0x5d9603[_0x553de4(0x2ff)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x35c79c][_0x553de4(0x334)],'externalip':devices[_0x35c79c]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x553de4(0x2e4)],'validInstallation':validInstallation}),devices[_0x35c79c]['access'][_0x553de4(0x328)]==![]&&devices[_0x35c79c]['access'][_0x553de4(0x232)]==_0x553de4(0x1b7)&&temporaryAccess2FA(_0x35c79c,devices[_0x35c79c]['ip']);}function setSessionTimeout(_0x4157f4,_0x237895){const _0x1a9bab=_0x281d12;let _0x29d123;if(_0x4157f4==_0x1a9bab(0x32c))_0x29d123=loginExpiry*0x3c*0x3e8;else _0x29d123=devices[_0x237895]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()[_0x1a9bab(0x223)]()-devices[_0x237895]['telegramIpApproval'][_0x1a9bab(0x1e3)]);if(devices[_0x237895][_0x1a9bab(0x1bf)])clearTimeout(devices[_0x237895][_0x1a9bab(0x1bf)]);devices[_0x237895][_0x1a9bab(0x1bf)]=setTimeout(()=>{const _0x5dcd0d=_0x1a9bab;if(devices[_0x237895][_0x5dcd0d(0x29a)])clearTimeout(devices[_0x237895]['pidRefreshToken']);removeSocketListeners(_0x237895),addBlacklist(_0x237895),devices[_0x237895][_0x5dcd0d(0x173)]=null,devices[_0x237895][_0x5dcd0d(0x272)]=null,devices[_0x237895]['access'][_0x5dcd0d(0x13f)]=null,logger[_0x5dcd0d(0x1ae)]('Session\x20expired\x20for\x20user\x20...'+_0x237895[_0x5dcd0d(0x1d6)](-0x8)),devices[_0x237895][_0x5dcd0d(0x334)]=validateAccess(devices[_0x237895][_0x5dcd0d(0x334)][_0x5dcd0d(0x13f)],_0x237895),!(devices[_0x237895][_0x5dcd0d(0x334)][_0x5dcd0d(0x328)]&&devices[_0x237895][_0x5dcd0d(0x334)][_0x5dcd0d(0x232)]=='login\x20not\x20required')&&(_0x4157f4==_0x5dcd0d(0x32c)?io['to'](_0x237895)[_0x5dcd0d(0x2fb)](_0x5dcd0d(0x337),{'access':{'allow':![],'reason':_0x5dcd0d(0x2c0),'token':null}}):io['to'](_0x237895)['emit'](_0x5dcd0d(0x337),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x237895][_0x5dcd0d(0x334)][_0x5dcd0d(0x13f)]=null;},_0x29d123);}function setTokenRefresh(_0x4f7de5){const _0x1b9efd=_0x281d12;if(devices[_0x4f7de5][_0x1b9efd(0x29a)])clearTimeout(devices[_0x4f7de5]['pidRefreshToken']);devices[_0x4f7de5][_0x1b9efd(0x29a)]=setTimeout(()=>{const _0x19c439=_0x1b9efd;getClientsWithUuid(_0x4f7de5)[_0x19c439(0x1fb)]!=0x0?(devices[_0x4f7de5][_0x19c439(0x334)]=refreshToken(_0x4f7de5),io['to'](_0x4f7de5)[_0x19c439(0x2fb)]('status',{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4f7de5]['access'],'externalip':devices[_0x4f7de5]['ip'],'publicKey':secure[_0x19c439(0x230)],'validInstallation':validInstallation}),setTokenRefresh(_0x4f7de5)):clearTimeout(devices[_0x4f7de5]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x3c4636){const _0x4477f4=_0x281d12,_0x3c680e=getClient(_0x3c4636['id'])['uuid'];_0x3c4636[_0x4477f4(0x2fb)]('bots',config),_0x3c4636[_0x4477f4(0x2fb)](_0x4477f4(0x16b),cleanSettings()),_0x3c4636['on'](_0x4477f4(0x28f),_0x439af1=>{const _0x38184=_0x4477f4;if(validateAccess(_0x439af1,_0x3c680e)[_0x38184(0x328)])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x3c4636['on'](_0x4477f4(0x2c7),(_0x76b24f,_0x3fad9f)=>{const _0x49bf57=_0x4477f4;if(validateAccess(_0x3fad9f,_0x3c680e)[_0x49bf57(0x328)])toggleBot(_0x76b24f[_0x49bf57(0x219)],_0x76b24f[_0x49bf57(0x337)],_0x76b24f[_0x49bf57(0x1b5)]);else logger[_0x49bf57(0x1fa)](_0x49bf57(0x1e8));}),_0x3c4636['on'](_0x4477f4(0x2d0),(_0x4bad1b,_0x35c807)=>{const _0x3aaa5c=_0x4477f4;if(validateAccess(_0x35c807,_0x3c680e)[_0x3aaa5c(0x328)])toggleBotMode(_0x4bad1b);else logger[_0x3aaa5c(0x1fa)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x3c4636['on'](_0x4477f4(0x18f),(_0x4ddaae,_0x30257e)=>{const _0x4a08b7=_0x4477f4;if(validateAccess(_0x30257e,_0x3c680e)[_0x4a08b7(0x328)])deleteBot(_0x4ddaae);else logger[_0x4a08b7(0x1fa)](_0x4a08b7(0x15d));}),_0x3c4636['on'](_0x4477f4(0x160),(_0x437a4c,_0x6453d9)=>{const _0x385848=_0x4477f4;if(validateAccess(_0x6453d9,_0x3c680e)[_0x385848(0x328)])storeSettings(_0x437a4c,!![]);else logger[_0x385848(0x1fa)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x3c4636['on'](_0x4477f4(0x215),_0xdb2312=>{const _0x287622=_0x4477f4;if(validateAccess(_0xdb2312,_0x3c680e)['allow'])updateBB('update');else logger[_0x287622(0x1fa)](_0x287622(0x33e));}),_0x3c4636['on']('reinstall-bb',_0x99e6e2=>{const _0x15fce2=_0x4477f4;if(validateAccess(_0x99e6e2,_0x3c680e)[_0x15fce2(0x328)])updateBB(_0x15fce2(0x2e8));else logger[_0x15fce2(0x1fa)](_0x15fce2(0x23e));}),_0x3c4636['on'](_0x4477f4(0x199),_0x17f7e8=>{const _0x283534=_0x4477f4;if(validateAccess(_0x17f7e8,_0x3c680e)[_0x283534(0x328)]){const _0x1d4378=getClient(_0x3c4636['id']);if(_0x1d4378)getBackupFiles(_0x1d4378[_0x283534(0x2a2)]);else logger['full'](_0x283534(0x31f));}else logger[_0x283534(0x1fa)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x3c4636['on'](_0x4477f4(0x240),(_0x459186,_0x1e42a7)=>{const _0x20b84b=_0x4477f4;if(validateAccess(_0x1e42a7,_0x3c680e)[_0x20b84b(0x328)])restoreBackupFile(_0x459186);else logger[_0x20b84b(0x1fa)](_0x20b84b(0x18b));}),_0x3c4636['on'](_0x4477f4(0x143),_0x234288=>{const _0x19a6a7=_0x4477f4;if(validateAccess(_0x234288,_0x3c680e)[_0x19a6a7(0x328)])getMessages();else logger['full'](_0x19a6a7(0x1f3));}),_0x3c4636['on'](_0x4477f4(0x327),(_0x1e2b13,_0x45b002)=>{const _0x4c6f93=_0x4477f4;if(validateAccess(_0x45b002,_0x3c680e)['allow'])confirmMessage(_0x1e2b13);else logger['full'](_0x4c6f93(0x25f));}),_0x3c4636['on'](_0x4477f4(0x1e9),_0x4457b9=>{const _0x522966=_0x4477f4;if(validateAccess(_0x4457b9,_0x3c680e)[_0x522966(0x328)]){if(devices[_0x3c680e][_0x522966(0x29a)])clearTimeout(devices[_0x3c680e][_0x522966(0x29a)]);if(devices[_0x3c680e][_0x522966(0x1bf)])clearTimeout(devices[_0x3c680e][_0x522966(0x1bf)]);removeSocketListeners(getClient(_0x3c4636['id'])['uuid']),addBlacklist(_0x3c680e),devices[_0x3c680e][_0x522966(0x173)]=null,devices[_0x3c680e][_0x522966(0x272)]=null,devices[_0x3c680e][_0x522966(0x334)][_0x522966(0x13f)]=null,logger[_0x522966(0x1ae)](_0x522966(0x1d5)+_0x3c680e[_0x522966(0x1d6)](-0x8)),io['to'](getClient(_0x3c4636['id'])['uuid'])[_0x522966(0x2fb)](_0x522966(0x337),{'access':{'allow':![],'reason':_0x522966(0x209),'token':null}});}else logger['full'](_0x522966(0x2f0));});}function initializeSocketBot(_0x3921cf){const _0x55795a=_0x281d12,_0x852ec0=getClient(_0x3921cf['id'])[_0x55795a(0x207)],_0x1c35bc=getClient(_0x3921cf['id'])[_0x55795a(0x2a2)];_0x3921cf['on']('get-logs',(_0xff7af8,_0xbc6676)=>{const _0x117241=_0x55795a;if(validateAccess(_0xbc6676,_0x1c35bc)[_0x117241(0x328)]){if(pid[_0x852ec0])pid[_0x852ec0][_0x117241(0x281)]({'function':_0x117241(0x2c4),'args':_0xff7af8});}else logger[_0x117241(0x1fa)](_0x117241(0x1df));}),_0x3921cf['on'](_0x55795a(0x1c6),(_0x5d0fff,_0x29a24c)=>{const _0x595618=_0x55795a;if(validateAccess(_0x29a24c,_0x1c35bc)[_0x595618(0x328)]){if(pid[_0x852ec0])pid[_0x852ec0][_0x595618(0x281)]({'function':'deleteHistoryAlerts','args':_0x5d0fff});}else logger[_0x595618(0x1fa)](_0x595618(0x265));}),_0x3921cf['on'](_0x55795a(0x1dd),(_0x87c380,_0x26bc7e)=>{const _0x2d29e8=_0x55795a;if(validateAccess(_0x26bc7e,_0x1c35bc)[_0x2d29e8(0x328)]){if(pid[_0x852ec0])pid[_0x852ec0][_0x2d29e8(0x281)]({'function':_0x2d29e8(0x1fd),'args':_0x87c380});}else logger[_0x2d29e8(0x1fa)](_0x2d29e8(0x21a));}),_0x3921cf['on'](_0x55795a(0x27f),(_0x57956d,_0x261be3)=>{const _0xaea62f=_0x55795a;if(validateAccess(_0x261be3,_0x1c35bc)[_0xaea62f(0x328)]){if(pid[_0x852ec0])pid[_0x852ec0][_0xaea62f(0x281)]({'function':_0xaea62f(0x1c9),'args':_0x57956d});}else logger[_0xaea62f(0x1fa)](_0xaea62f(0x293));}),_0x3921cf['on'](_0x55795a(0x19f),(_0x4380e6,_0x52f5e9)=>{const _0x643d8f=_0x55795a;if(validateAccess(_0x52f5e9,_0x1c35bc)['allow']){if(pid[_0x852ec0])pid[_0x852ec0][_0x643d8f(0x281)]({'function':_0x643d8f(0x2fa),'args':_0x4380e6});}else logger[_0x643d8f(0x1fa)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x3921cf['on'](_0x55795a(0x2d2),(_0x5e8b0e,_0x1531be)=>{const _0x5dc25a=_0x55795a;if(validateAccess(_0x1531be,_0x1c35bc)[_0x5dc25a(0x328)]){if(pid[_0x852ec0])pid[_0x852ec0][_0x5dc25a(0x281)]({'function':'storeFiat','args':_0x5e8b0e});}else logger[_0x5dc25a(0x1fa)](_0x5dc25a(0x288));}),_0x3921cf['on'](_0x55795a(0x13e),_0x704cd4=>{const _0x2ce795=_0x55795a;if(validateAccess(_0x704cd4,_0x1c35bc)[_0x2ce795(0x328)]){if(pid[_0x852ec0])pid[_0x852ec0][_0x2ce795(0x281)]({'function':_0x2ce795(0x2e1),'args':null});}else logger[_0x2ce795(0x1fa)](_0x2ce795(0x1bc));}),_0x3921cf['on'](_0x55795a(0x180),_0x5a061c=>{const _0x4acdef=_0x55795a;if(validateAccess(_0x5a061c,_0x1c35bc)[_0x4acdef(0x328)]){if(pid[_0x852ec0])pid[_0x852ec0][_0x4acdef(0x281)]({'function':_0x4acdef(0x17f),'args':null});}else logger[_0x4acdef(0x1fa)](_0x4acdef(0x29d));}),_0x3921cf['on'](_0x55795a(0x1e1),(_0x3d09cf,_0x17f2ee)=>{const _0x2ffb78=_0x55795a;if(validateAccess(_0x17f2ee,_0x1c35bc)[_0x2ffb78(0x328)]){if(pid[_0x852ec0])pid[_0x852ec0][_0x2ffb78(0x281)]({'function':_0x2ffb78(0x18d),'args':_0x3d09cf});}else logger[_0x2ffb78(0x1fa)](_0x2ffb78(0x2d3));}),_0x3921cf['on'](_0x55795a(0x29f),_0x2dbd83=>{const _0x1ced74=_0x55795a;if(validateAccess(_0x2dbd83,_0x1c35bc)[_0x1ced74(0x328)]){if(pid[_0x852ec0])pid[_0x852ec0][_0x1ced74(0x281)]({'function':'cancelLoading','args':null});}else logger[_0x1ced74(0x1fa)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x3921cf['on'](_0x55795a(0x285),_0x58fad6=>{const _0x4b0224=_0x55795a;if(validateAccess(_0x58fad6,_0x1c35bc)['allow']){if(pid[_0x852ec0])pid[_0x852ec0]['send']({'function':'showConfig','args':null});}else logger[_0x4b0224(0x1fa)](_0x4b0224(0x2c9));}),_0x3921cf['on'](_0x55795a(0x215),_0x45c051=>{const _0x4021c5=_0x55795a;if(validateAccess(_0x45c051,_0x1c35bc)[_0x4021c5(0x328)])updateBB(_0x4021c5(0x1a7));else logger[_0x4021c5(0x1fa)](_0x4021c5(0x33e));}),_0x3921cf['on']('get-messages',_0x5a958e=>{const _0x1d3832=_0x55795a;if(validateAccess(_0x5a958e,_0x1c35bc)[_0x1d3832(0x328)])getMessages();else logger['full'](_0x1d3832(0x1f3));}),_0x3921cf['on'](_0x55795a(0x327),(_0x2305ce,_0x40729b)=>{const _0x11e19f=_0x55795a;if(validateAccess(_0x40729b,_0x1c35bc)[_0x11e19f(0x328)])confirmMessage(_0x2305ce);else logger[_0x11e19f(0x1fa)](_0x11e19f(0x25f));}),_0x3921cf['on'](_0x55795a(0x1e9),_0x3b7bb1=>{const _0x1e96cf=_0x55795a;if(validateAccess(_0x3b7bb1,_0x1c35bc)['allow']){if(devices[_0x1c35bc]['pidRefreshToken'])clearTimeout(devices[_0x1c35bc][_0x1e96cf(0x29a)]);if(devices[_0x1c35bc][_0x1e96cf(0x1bf)])clearTimeout(devices[_0x1c35bc][_0x1e96cf(0x1bf)]);removeSocketListeners(getClient(_0x3921cf['id'])['uuid']),addBlacklist(_0x1c35bc),devices[_0x1c35bc][_0x1e96cf(0x173)]=null,devices[_0x1c35bc][_0x1e96cf(0x272)]=null,devices[_0x1c35bc][_0x1e96cf(0x334)][_0x1e96cf(0x13f)]=null,logger[_0x1e96cf(0x1ae)](_0x1e96cf(0x1d5)+_0x1c35bc[_0x1e96cf(0x1d6)](-0x8)),io['to'](getClient(_0x3921cf['id'])[_0x1e96cf(0x2a2)])[_0x1e96cf(0x2fb)](_0x1e96cf(0x337),{'access':{'allow':![],'reason':_0x1e96cf(0x209),'token':null}});}else logger[_0x1e96cf(0x1fa)](_0x1e96cf(0x2f0));});}function _0x3e04(){const _0x2ef3b5=['messages','Backup\x20file\x20uploaded','-events.json',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','getTime','/:bot/history','conn','stop','/download/:type','track','login2fa_reject_','isDirectory','createServer','post','bb-config.json','match','address','publicKey','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','reason','toggle','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','uncaughtException','production','config_all','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','argv','defaults','temporary\x20access\x20not\x20allowed','encryptedUuid','IPv4','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','http://localhost:','restore-backup-file','sendMetricsTelegram','clientip','Notifications\x20disabled','f2aRequired','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','use','decrypt','Error:\x20Invalid\x20argument\x20','Unauthorized\x20login\x20attempt\x20(timeout)','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','sha256','305313QgyfDy','entries','orders','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Starting\x20#RED#Balance\x20Bot\x20v','headless','Invalid\x20authentication\x20token\x20(2)','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','title','generateAsync','bbPassword','host','secret','Error\x20while\x20deleting\x20config\x20files:\x20','apiSecret','bb-settings.json','apiKey','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','Unauthorized\x20attempt\x20to\x20confirm\x20message','new-disabled','telegramEvents','format','off','alerts','Unauthorized\x20attempt\x20to\x20delete\x20alerts','marketcapApi','#RES#\x20','_nsps','config_alerts','Your\x20installation\x20is\x20already\x20up\x20to\x20date','constructor','Unauthorized\x20attempt\x20to\x20download\x20','log','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','RSA-OAEP','\x1b[35m','stringify','telegram2FaApproval','Telegram\x20error:','getDate','blacklist','/restart\x20-\x20restart\x20bot(s)\x0a','/start','\x20only\x0a','logs','Invalid\x20IP\x20address','botmanager','create','socket.io','/update\x20-\x20update\x20Balance\x20Bot\x0a','store-configuration','=>\x20Go\x20to\x20#CYA#http://','send','path','params','catch','show-config','\x20to\x20','files','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','whitelist','express-fileupload','temp/','fork','login\x20required','tkn','add-bot','Alerts','5\x20min','-results.json','Unauthorized\x20attempt\x20to\x20store\x20configuration','/backup\x20-\x20receive\x20backup\x20files\x0a','graphql-request','file','max','enabled','readFileSync','pidRefreshToken','reply','restart_','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','cancel-loading','Bot\x20Mgr\x20>\x20Toggling\x20','reject','uuid','getSeconds','env','success','existsSync','Login\x20rejected','stopped','min','metrics','timeshift','getMonth','6b67f3d61ee94b8f5c80b4affef4c4d9','search','showname','Access\x20enabled\x20for\x20','All\x20bots','apply','Notifications\x20disabled\x0a','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','whitelistEnabled','mkdirSync','replyWithDocument','User\x20has\x20been\x20validated','30\x20min','secure','Restoring\x20bot(s)\x20from\x20backup','3000','version.json','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','access\x20timeout','output-000.log','bb-secure.json','365748DQteWX','emitHistory','ipc','SIGINT','update-bot','/:bot/performance','Unauthorized\x20attempt\x20to\x20show\x20configuration','temporary\x20token\x20generated','backup-full','login2fa_','2FA\x20login\x20required','222140ZcRKJZ','startsWith','toggle-bot-mode','randomFillSync','store-fiat','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','copyFileSync','telegramEnabled','event','kill','getMinutes','initclient','Bot\x20Mgr\x20>\x20Stopping\x20','onepagemode','disabled','Starting\x20Balance\x20Bot\x20reinstallation','backup/','https://api.ipify.org?format=json','running','resetHistory','close','port','userid','bbUsername','bot-','Starting\x20(','reinstall','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','referer','generateKeyPair','restart','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','message','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Unauthorized\x20attempt\x20to\x20log\x20out','output-002.log','ETH','backup-full.zip','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','config_orders','$1_$2_$3','staging','All\x20bots\x20running\x20right\x20now','push','storeHeadless','emit','keys','tempaccess_5_','telegramToken','server','reset-password','hasOwnProperty','get','statSync','api-eu.mixpanel.com','\x20files\x20over\x20Telegram:','\x20(1)','child_process','mode','\x20|\x20user:\x20...','Password\x20has\x20been\x20reset\x20to:\x20','telegrammsg','Ok,\x20will\x20send\x20order\x20notifications\x20only','lastmsgemitted','(((.+)+)+)+$','restore_no_','simple','verify','command','help','\x1b[36m','clients','#RES#\x20if\x20running\x20locally\x0a','temporary\x20access\x20rejected','chat','lastmsgtelegram','disconnect','127.0.0.1','warning','sort','index.html','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','name','once','set','restore_yes_','sendPortfolioTelegram','store','Notifications\x20enabled\x0a','confirm-message','allow','/names\x20-\x20show\x20bot\x20names\x0a','::1','parse','login',',\x20must\x20be\x20a\x204\x20digit\x20number','apiPassword','rmSync','Restore\x20backup\x20file\x20','lowdb','Notifications\x20enabled','date-fns','access','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','static','status','bcryptjs','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','bots','/metrics\x20-\x20show\x20bot\x20performance\x0a','\x20>\x20','disable','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','toIPv4MappedAddress','handshake','exec','************','backup','updatebotmanager','inherit','pki','\x20minutes','number','Restore\x20process\x20confirmed','function','bbvNew','botname','#RES#','value','zip/','/:bot/coins','\x1b[0m','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','All','1107540RteFii','lowdb/adapters/FileSync','replace','No\x20authentication\x20token','/:bot','sendFile','connection','listen','util','backupfile','editMessageReplyMarkup','Server','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','reset-history','token','build2','readdirSync','Bot\x20','get-messages','data','toString','\x20|\x20','.zip','Error\x20removing\x20old\x20backup\x20files:','Temporary\x20access\x20rejected','/status\x20-\x20show\x20bot(s)\x20status\x0a','update_no','portfolio','logs/','Bot\x20Mgr\x20>\x20','63203RdTghC','Enabled\x20','environment','socket','sign','loginRequired','Error\x20sending\x20','names','uuid-random','bb/','auth',')\x20\x20\x20|\x20Bot\x20','launch','<b>Balance\x20Bot\x20Status:</b>\x0a','Unauthorized\x20attempt\x20to\x20delete\x20bot','bbvReceive','config/','store-settings','download','2FA\x20login\x20token\x20generated','No\x20bots\x20running\x20right\x20now','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','/on\x20-\x20start\x20bot(s)\x0a','ipaddr.js','--------------------------------------','yargs','Restore\x20process\x20aborted','Login\x20accepted','settings','Bot\x20Mgr\x20>\x20Starting\x20','then','manual','SIGTERM','inlineKeyboard','find','backup-full@','telegramIpApproval','writeFileSync','tempaccess_reject_','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','off_','createWriteStream','latestversion','notification','output-001.log','You\x20can\x20use\x20the\x20following\x20commands:\x0a','axios','callback','getStartingBalances','get-starting-balances','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','exp','HTML','removeAllListeners','temporaryAccessAllowed','15\x20min','::ffff:7f00:1','http','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','yes','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','\x1b[31m','placeOrder','node-forge','delete-bot','open','telegram','Ok,\x20will\x20send\x20alert\x20notifications\x20only','tempaccess_15_','-performance.json','1000','decode64','telegramUsername','from','get-backup-files','all','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','test','-config.json','Failed\x20to\x20download\x20','store-headless','split','map','56dZVuhK','/:bot/portfolio','\x20mode',')\x20|\x20Bot\x20','Error\x20details:','update','express','status\x20code\x20401','Network\x20Interfaces:','-----------------------------------------------------------------------------------','expiry','/enable\x20-\x20enable\x20notifications\x0a','debug','Yes','toggle_','range','auto','show','/output-000.log','live','write','2FA\x20required','telegramChatId','Starting\x20new\x20bot\x20|\x20Bot\x20','text','mtime','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','config','async','pidExpireLogin','new','remove','*$1*','remoteAddress','unlinkSync','request','delete-alerts','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','login\x20token\x20generated','storeConfiguration','username','type','rsa','629142KDQEYa','order','versions','init','loadAsync','button','jsonwebtoken','privateKey','Logged\x20out\x20user\x20...','slice','Invalid\x20username\x20or\x20IP\x20address','hashSync','exchange','resetpw_no','family','***','get-portfolio','2FA','Unauthorized\x20attempt\x20to\x20get\x20events','Allow\x20login\x20from\x20IP\x20address\x20','place-order','exit','timestamp','binary','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','DEFLATE','getFullYear','Unauthorized\x20attempt\x20to\x20update\x20bot','logout','isIPv4MappedAddress','553185TBuKBN','Token\x20blacklisted','password','settings.','Idling\x20(','user','sortBy','getHours','Unauthorized\x20attempt\x20to\x20get\x20messages','compareSync','portfolio_','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','filter','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','/off\x20-\x20stop\x20bot(s)\x0a','full','length','kind','getPortfolio','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','output-003.log','(staging)','Backup\x20file\x20unzipped\x20and\x20stored','BCT','\x1b[34m','invalid\x20credentials','error','build','bot','tempaccess_30_','logged\x20out','assign','join','jszip','telegraf','headers','padStart','size','reload','4vxyrJW','cloneDeep','accept','update-bb','/disable\x20-\x20disable\x20notifications\x0a','isValid','action','botID','Unauthorized\x20attempt\x20to\x20get\x20portfolio','forEach','resetpw_yes','|@|','login\x20not\x20required'];_0x3e04=function(){return _0x2ef3b5;};return _0x3e04();}function removeSocketListeners(_0x3e5243){const _0x39c1dd=_0x281d12;getClientsWithUuid(_0x3e5243)[_0x39c1dd(0x21b)](_0x5a17b1=>{const _0x25b9e9=_0x39c1dd;getSocket(_0x5a17b1['id'])[_0x25b9e9(0x184)]();});}function cleanSettings(){const _0x164758=_0x281d12;let _0x2aec80=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x2aec80={..._0x2aec80,'telegramToken':'************'}),settings['bbPassword']&&settings[_0x164758(0x257)]!=''&&(_0x2aec80={..._0x2aec80,'bbPassword':_0x164758(0x342)}),settings[_0x164758(0x266)]&&settings['marketcapApi']!=''&&(_0x2aec80={..._0x2aec80,'marketcapApi':_0x164758(0x342)}),(settings[_0x164758(0x257)]&&settings['bbPassword']==_0x164758(0x1dc)||settings[_0x164758(0x2fe)]&&settings[_0x164758(0x2fe)]==_0x164758(0x1dc)||settings[_0x164758(0x266)]&&settings['marketcapApi']==_0x164758(0x1dc))&&(_0x2aec80={..._0x2aec80,'restored':{'password':settings[_0x164758(0x257)]==_0x164758(0x1dc),'telegram':settings[_0x164758(0x2fe)]==_0x164758(0x1dc),'marketcap':settings[_0x164758(0x266)]==_0x164758(0x1dc)}}),_0x2aec80;}async function updateBB(_0x5d6cca){const _0x233de0=_0x281d12;await backupConfigFiles(),installingUpdate=!![],config[_0x233de0(0x21b)](_0x4bd9d8=>{const _0x2e0a08=_0x233de0;restartBot(_0x4bd9d8[_0x2e0a08(0x219)]);});if(_0x5d6cca==_0x233de0(0x1a7))process[_0x233de0(0x281)]({'update':!![],'environment':environment},_0x30712a=>{});else _0x5d6cca==_0x233de0(0x2e8)&&process[_0x233de0(0x281)]({'reinstall':!![],'environment':environment},_0x3d7439=>{});}function startBot(_0x8af069,_0x307863,_0x5c5ebc){const _0x932c4f=_0x281d12;if(debugging)_0x8af069['push']('-d');if(recreate)_0x8af069[_0x932c4f(0x2f9)]('-r');let _0x81a70c=![];const _0x1d5c4e=_0x8af069[0x0];_0x307863={..._0x307863,'stdio':[_0x932c4f(0x345),_0x932c4f(0x345),_0x932c4f(0x345),_0x932c4f(0x2c5)]},pid[_0x1d5c4e]=childProcess[_0x932c4f(0x28c)](botfile,_0x8af069,_0x307863),pid[_0x1d5c4e]['on'](_0x932c4f(0x2ee),_0x2ec0a7=>{const _0xd48b18=_0x932c4f;switch(Object['keys'](_0x2ec0a7)[0x0]){case'botname':updateBotName(_0x1d5c4e,_0x2ec0a7[_0xd48b18(0x34c)]);break;case _0xd48b18(0x344):updateBotManager();break;case _0xd48b18(0x337):updateStatus(_0x1d5c4e,_0x2ec0a7[_0xd48b18(0x337)]);break;case _0xd48b18(0x1b5):updateLive(_0x1d5c4e,_0x2ec0a7[_0xd48b18(0x1b5)]);break;case'started':updateLive(_0x1d5c4e,_0x2ec0a7['started']),io['to'](_0x1d5c4e)[_0xd48b18(0x2fb)]('status',{'access':{'allow':![],'reason':_0xd48b18(0x211),'token':null}});break;case _0xd48b18(0x226):_0x2ec0a7[_0xd48b18(0x226)]==_0xd48b18(0x2ec)&&restartBot(_0x1d5c4e);_0x2ec0a7[_0xd48b18(0x226)]==_0xd48b18(0x2d7)&&toggleBot(_0x1d5c4e,'disabled','stopped');break;case'telegram':sendTelegramBot(_0x1d5c4e,_0x2ec0a7[_0xd48b18(0x191)]);break;case _0xd48b18(0x30b):sendTelegramMsg(_0x2ec0a7[_0xd48b18(0x30b)]);break;case'function':io['to'](_0x1d5c4e)['emit'](_0x2ec0a7[_0xd48b18(0x34a)],_0x2ec0a7['args']);break;}}),pid[_0x1d5c4e]['on'](_0x932c4f(0x205),function(_0x521a6e){if(_0x81a70c)return;_0x81a70c=!![],_0x5c5ebc(_0x521a6e);}),pid[_0x1d5c4e]['on'](_0x932c4f(0x1e2),async function(_0x446f37){const _0x478337=_0x932c4f;if(terminating)return;if(installingUpdate){io[_0x478337(0x2e2)]();return;}if(_0x81a70c)return;_0x81a70c=!![],_0x5c5ebc(null);const _0x2fd6f7=dbConfig[_0x478337(0x302)](_0x478337(0x33a))[_0x478337(0x171)]({'botID':_0x1d5c4e})[_0x478337(0x34e)]();_0x2fd6f7&&(_0x2fd6f7[_0x478337(0x337)]==_0x478337(0x298)||_0x2fd6f7[_0x478337(0x337)]=='new')&&(await sleep(0x3e8),updateLive(_0x1d5c4e,_0x478337(0x2a8)),logger[_0x478337(0x1fa)]('Restarting\x20'+botRef(_0x1d5c4e)),startBot([_0x1d5c4e,userID],{'cwd':bbpath},function(_0x1cbcd1){const _0x34b4a1=_0x478337;if(_0x1cbcd1)logger[_0x34b4a1(0x1fa)](_0x1cbcd1);}));});}function stopBot(_0x7bdb5a){const _0x1ba987=_0x281d12;getClientsWithBotID(_0x7bdb5a)[_0x1ba987(0x21b)](_0x47aa88=>{const _0x199b62=_0x1ba987;getSocket(_0x47aa88['id'])[_0x199b62(0x31a)](!![]),removeClient(_0x47aa88['id']);}),pid[_0x7bdb5a]&&(pid[_0x7bdb5a][_0x1ba987(0x2d7)](),pid[_0x7bdb5a]=null);}function stopAllBots(){terminating=!![];const _0x197d81=getEnabledBots();_0x197d81['forEach'](_0x4df8c3=>{stopBot(_0x4df8c3['botID']);});}function restartBot(_0x22baa5){const _0x191f6b=_0x281d12;if(pid[_0x22baa5])pid[_0x22baa5][_0x191f6b(0x2d7)]();}function addBot(){const _0x2269f3=_0x281d12;let _0x5ebba7;for(let _0x85be96=0x1;_0x85be96<0x3e9;_0x85be96++){_0x5ebba7=_0x85be96[_0x2269f3(0x145)]()[_0x2269f3(0x20f)](0x3,'0');let _0x1c8c8d=config['find'](_0x550742=>_0x550742[_0x2269f3(0x219)]==_0x5ebba7);if(!_0x1c8c8d)break;}if(_0x5ebba7===_0x2269f3(0x195)){logger['full'](_0x2269f3(0x1c7));return;}logger[_0x2269f3(0x1fa)](_0x2269f3(0x1b9)+_0x5ebba7),dbConfig[_0x2269f3(0x302)](_0x2269f3(0x33a))[_0x2269f3(0x2f9)]({'botID':_0x5ebba7,'botname':_0x2269f3(0x142)+_0x5ebba7,'status':_0x2269f3(0x1c0),'live':''})[_0x2269f3(0x1b6)](),startBot([_0x5ebba7,userID],{'cwd':bbpath},function(_0x3ac577){if(_0x3ac577)logger['full'](_0x3ac577);}),config=getConfiguration(),io['to'](_0x2269f3(0x27b))[_0x2269f3(0x2fb)](_0x2269f3(0x33a),config),broadcastToBots(_0x2269f3(0x33a),JSON[_0x2269f3(0x271)](config));}function deleteBot(_0x59285d){const _0x6cbb21=_0x281d12;getClientsWithBotID(_0x59285d)[_0x6cbb21(0x21b)](_0x217593=>{const _0x10ca97=_0x6cbb21;getSocket(_0x217593['id'])[_0x10ca97(0x31a)](!![]),removeClient(_0x217593['id']);}),dbConfig[_0x6cbb21(0x302)]('bots')[_0x6cbb21(0x1c1)]({'botID':_0x59285d})['write'](),logger[_0x6cbb21(0x1fa)]('Deleted\x20Bot\x20'+_0x59285d),stopBot(_0x59285d);try{if(fs[_0x6cbb21(0x2a6)](path[_0x6cbb21(0x20b)](configpath,'bot-'+_0x59285d+'-config.json')))fs[_0x6cbb21(0x1c4)](path[_0x6cbb21(0x20b)](configpath,_0x6cbb21(0x2e6)+_0x59285d+_0x6cbb21(0x19d)));if(fs[_0x6cbb21(0x2a6)](path[_0x6cbb21(0x20b)](configpath,_0x6cbb21(0x2e6)+_0x59285d+_0x6cbb21(0x221))))fs[_0x6cbb21(0x1c4)](path[_0x6cbb21(0x20b)](configpath,_0x6cbb21(0x2e6)+_0x59285d+_0x6cbb21(0x221)));if(fs[_0x6cbb21(0x2a6)](path['join'](configpath,_0x6cbb21(0x2e6)+_0x59285d+_0x6cbb21(0x194))))fs['unlinkSync'](path[_0x6cbb21(0x20b)](configpath,_0x6cbb21(0x2e6)+_0x59285d+_0x6cbb21(0x194)));if(fs[_0x6cbb21(0x2a6)](path['join'](configpath,_0x6cbb21(0x2e6)+_0x59285d+'-results.json')))fs[_0x6cbb21(0x1c4)](path['join'](configpath,'bot-'+_0x59285d+_0x6cbb21(0x292)));}catch(_0x24e6d4){if(_0x24e6d4)logger[_0x6cbb21(0x1fa)](_0x6cbb21(0x25a),_0x24e6d4);}config=getConfiguration(),io['to'](_0x6cbb21(0x27b))[_0x6cbb21(0x2fb)](_0x6cbb21(0x33a),config),broadcastToBots('bots',JSON[_0x6cbb21(0x271)](config));}function toggleBot(_0x4f4c58,_0x113209,_0x3cbaab){const _0x2d518d=_0x281d12;dbConfig[_0x2d518d(0x302)](_0x2d518d(0x33a))[_0x2d518d(0x171)]({'botID':_0x4f4c58})[_0x2d518d(0x20a)]({'status':_0x113209})[_0x2d518d(0x20a)]({'live':_0x3cbaab})[_0x2d518d(0x1b6)]();const _0x3ca81e=botRef(_0x4f4c58);if(_0x113209==_0x2d518d(0x298)||_0x113209==_0x2d518d(0x1c0))logger[_0x2d518d(0x1fa)](_0x2d518d(0x150)+_0x3ca81e),startBot([_0x4f4c58,userID],{'cwd':bbpath},function(_0x4acd1e){const _0x15c4a1=_0x2d518d;if(_0x4acd1e)logger[_0x15c4a1(0x1fa)](_0x4acd1e);});else(_0x113209=='disabled'||_0x113209==_0x2d518d(0x260))&&(logger['full']('Disabled\x20'+_0x3ca81e),stopBot(_0x4f4c58));config=getConfiguration(),io['to'](_0x2d518d(0x27b))[_0x2d518d(0x2fb)](_0x2d518d(0x33a),config),broadcastToBots('bots',JSON[_0x2d518d(0x271)](config));}function toggleStatus(_0x2edcb0){const _0x4b45a8=_0x281d12;let _0x102ab0=dbConfig[_0x4b45a8(0x302)](_0x4b45a8(0x33a))[_0x4b45a8(0x171)]({'botID':_0x2edcb0})[_0x4b45a8(0x34e)](),_0x404356;if(_0x102ab0['status']===_0x4b45a8(0x298))_0x404356=_0x4b45a8(0x2dc);else{if(_0x102ab0[_0x4b45a8(0x337)]===_0x4b45a8(0x1c0))_0x404356=_0x4b45a8(0x260);else{if(_0x102ab0[_0x4b45a8(0x337)]===_0x4b45a8(0x260))_0x404356=_0x4b45a8(0x1c0);else{if(_0x102ab0[_0x4b45a8(0x337)]===_0x4b45a8(0x2dc))_0x404356=_0x4b45a8(0x298);}}}return _0x404356;}function updateStatus(_0x886714,_0x2216e6){const _0x511d94=_0x281d12;dbConfig[_0x511d94(0x302)](_0x511d94(0x33a))[_0x511d94(0x171)]({'botID':_0x886714})[_0x511d94(0x20a)]({'status':_0x2216e6})[_0x511d94(0x1b6)](),config=getConfiguration(),io['to'](_0x511d94(0x27b))[_0x511d94(0x2fb)](_0x511d94(0x33a),config),broadcastToBots(_0x511d94(0x33a),JSON[_0x511d94(0x271)](config));}function updateLive(_0x3bacb1,_0x317961){const _0x1fbfc5=_0x281d12;dbConfig[_0x1fbfc5(0x302)](_0x1fbfc5(0x33a))[_0x1fbfc5(0x171)]({'botID':_0x3bacb1})[_0x1fbfc5(0x20a)]({'live':_0x317961})[_0x1fbfc5(0x1b6)](),config=getConfiguration(),io['to'](_0x1fbfc5(0x27b))[_0x1fbfc5(0x2fb)](_0x1fbfc5(0x33a),config),broadcastToBots('bots',JSON[_0x1fbfc5(0x271)](config));}function updateBotName(_0xe14a4f,_0x588da2){const _0x5b3d91=_0x281d12;dbConfig['get'](_0x5b3d91(0x33a))[_0x5b3d91(0x171)]({'botID':_0xe14a4f})[_0x5b3d91(0x20a)]({'botname':_0x588da2})[_0x5b3d91(0x1b6)](),config=getConfiguration(),io['to'](_0x5b3d91(0x27b))[_0x5b3d91(0x2fb)](_0x5b3d91(0x33a),config),broadcastToBots('bots',JSON[_0x5b3d91(0x271)](config));}function updateBotManager(){const _0x29a0aa=_0x281d12;config=getConfiguration(),io['to'](_0x29a0aa(0x27b))[_0x29a0aa(0x2fb)](_0x29a0aa(0x33a),config),broadcastToBots(_0x29a0aa(0x33a),JSON[_0x29a0aa(0x271)](config));}function toggleBotMode(_0x182f22){const _0x1d8395=_0x281d12;if(pid[_0x182f22])pid[_0x182f22][_0x1d8395(0x281)]({'function':'toggleBotMode','args':null});else{const _0x19044d=configpath+'bot-'+_0x182f22+'-config.json',_0x30e1c0=fs[_0x1d8395(0x299)](_0x19044d),_0xebc304=JSON[_0x1d8395(0x32b)](_0x30e1c0),_0x4fe33f=_0xebc304[_0x1d8395(0x207)][0x0][_0x1d8395(0x252)];_0xebc304['bot'][0x0][_0x1d8395(0x252)]=!_0x4fe33f;const _0x50c4a7=JSON['stringify'](_0xebc304,null,0x2);fs['writeFileSync'](_0x19044d,_0x50c4a7),config=getConfiguration(),io['to'](_0x1d8395(0x27b))[_0x1d8395(0x2fb)]('bots',config),broadcastToBots(_0x1d8395(0x33a),JSON[_0x1d8395(0x271)](config));}}function validateTelegram(_0x9737ff){const _0x1a8e68=_0x281d12;if(_0x9737ff[_0x1a8e68(0x198)][_0x1a8e68(0x1ca)]!=settings[_0x1a8e68(0x197)]&&'@'+_0x9737ff['from'][_0x1a8e68(0x1ca)]!=settings[_0x1a8e68(0x197)]||_0x9737ff[_0x1a8e68(0x318)]['id']!=settings['telegramChatId'])return sendTelegram(_0x9737ff[_0x1a8e68(0x318)]['id'],_0x1a8e68(0x352),{'parse_mode':_0x1a8e68(0x183)}),![];return!![];}function botRef(_0x370ddd){const _0x4a41a1=_0x281d12,_0x5c4fe2=getBotAttributes(_0x370ddd),_0x2edea0=_0x5c4fe2[_0x4a41a1(0x2af)]?_0x5c4fe2[_0x4a41a1(0x34c)]:_0x4a41a1(0x142)+_0x370ddd;return _0x2edea0;}async function initTelegram(){const _0x122bec=_0x281d12;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x122bec(0x2fe)]);let _0x2322b2=_0x122bec(0x17c);_0x2322b2+='\x0a',_0x2322b2+=_0x122bec(0x1ad),_0x2322b2+=_0x122bec(0x216),_0x2322b2+=_0x122bec(0x19b),_0x2322b2+=_0x122bec(0x276),_0x2322b2+=_0x122bec(0x165),_0x2322b2+=_0x122bec(0x1f9),_0x2322b2+=_0x122bec(0x2b4),_0x2322b2+=_0x122bec(0x329),_0x2322b2+=_0x122bec(0x14a),_0x2322b2+=_0x122bec(0x33b),_0x2322b2+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x2322b2+='/logs\x20-\x20receive\x20log\x20files\x0a',_0x2322b2+=_0x122bec(0x294),_0x2322b2+=_0x122bec(0x27e),_0x2322b2+=_0x122bec(0x24a),_0x2322b2+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x4adbb4=_0x122bec(0x1fe);_0x4adbb4+='\x0a',_0x4adbb4+=_0x2322b2,tgBot[_0x122bec(0x284)]((_0x2ed8b3,_0x19af54)=>{const _0x91a0d3=_0x122bec;logger[_0x91a0d3(0x310)](getTimeStamp()+_0x91a0d3(0x222)),logger[_0x91a0d3(0x1ae)]('Telegraf\x20error:',_0x2ed8b3);}),tgBot['use'](async(_0x2861da,_0x2c62f8)=>{const _0x429f9a=_0x122bec;if(settings[_0x429f9a(0x1b8)]||_0x2861da[_0x429f9a(0x1a7)]['message'][_0x429f9a(0x1ba)]!=_0x429f9a(0x277)){if(!validateTelegram(_0x2861da))return;}_0x2c62f8();}),tgBot[_0x122bec(0x312)]('start',async _0x4ac801=>{const _0x16ee7b=_0x122bec;if(_0x4ac801[_0x16ee7b(0x198)]['username']==settings[_0x16ee7b(0x197)]||'@'+_0x4ac801[_0x16ee7b(0x198)]['username']==settings[_0x16ee7b(0x197)]){if(!settings[_0x16ee7b(0x1b8)])updateSetting(_0x16ee7b(0x1b8),_0x4ac801[_0x16ee7b(0x318)]['id']);else{if(!validateTelegram(_0x4ac801))return;}}else{if(!validateTelegram(_0x4ac801))return;}updateSetting(_0x16ee7b(0x2d5),!![]),await sendTelegram(_0x4ac801[_0x16ee7b(0x318)]['id'],_0x4adbb4);}),tgBot[_0x122bec(0x312)]('enable',async _0x1e167f=>{const _0x2039a5=_0x122bec;updateSetting(_0x2039a5(0x2d5),!![]),await sendTelegram(_0x1e167f[_0x2039a5(0x318)]['id'],_0x2039a5(0x332));}),tgBot['command'](_0x122bec(0x33d),async _0x120118=>{const _0x10fee1=_0x122bec;await sendTelegram(_0x120118[_0x10fee1(0x318)]['id'],_0x10fee1(0x243)),updateSetting(_0x10fee1(0x2d5),![]);}),tgBot[_0x122bec(0x312)](_0x122bec(0x1bd),async _0xf0b318=>{const _0x4a0580=_0x122bec,_0x463a6a=Markup[_0x4a0580(0x170)]([Markup[_0x4a0580(0x1d2)][_0x4a0580(0x17e)]('Orders',_0x4a0580(0x2f5)),Markup['button'][_0x4a0580(0x17e)](_0x4a0580(0x290),_0x4a0580(0x269)),Markup[_0x4a0580(0x1d2)]['callback'](_0x4a0580(0x353),'config_all')]);_0xf0b318['reply'](_0x4a0580(0x29e),_0x463a6a);}),tgBot['action'](_0x122bec(0x2f5),async _0x515012=>{const _0x510afb=_0x122bec;_0x515012[_0x510afb(0x35e)](),updateSetting(_0x510afb(0x261),_0x510afb(0x24e)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x515012[_0x510afb(0x318)]['id'],_0x510afb(0x30c));}),tgBot[_0x122bec(0x218)](_0x122bec(0x269),async _0x55a4a2=>{const _0x7ff102=_0x122bec;_0x55a4a2[_0x7ff102(0x35e)](),updateSetting(_0x7ff102(0x261),'alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x55a4a2[_0x7ff102(0x318)]['id'],_0x7ff102(0x192));}),tgBot[_0x122bec(0x218)](_0x122bec(0x237),async _0x40d317=>{const _0x5bd5a0=_0x122bec;_0x40d317[_0x5bd5a0(0x35e)](),updateSetting(_0x5bd5a0(0x261),_0x5bd5a0(0x19a)),updateSetting(_0x5bd5a0(0x2d5),!![]),await sendTelegram(_0x40d317[_0x5bd5a0(0x318)]['id'],_0x5bd5a0(0x250));}),tgBot[_0x122bec(0x312)](_0x122bec(0x337),async _0x2f114a=>{const _0x274c49=_0x122bec,_0x5f50c6=getBotsWithMode();let _0x5d9fbb=_0x274c49(0x15c);config[_0x274c49(0x21b)](_0x5b8654=>{const _0x18e46c=_0x274c49,_0xa31ddf=_0x5f50c6['find'](_0x400663=>_0x400663[_0x18e46c(0x219)]==_0x5b8654[_0x18e46c(0x219)])['mode'];_0x5d9fbb+=_0x18e46c(0x142)+_0x5b8654[_0x18e46c(0x219)]+':\x20'+_0x5b8654[_0x18e46c(0x337)]+_0x18e46c(0x146)+_0xa31ddf+_0x18e46c(0x146)+_0x5b8654[_0x18e46c(0x1b5)]+'\x0a';}),_0x5d9fbb+='\x0a',_0x5d9fbb+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x5d9fbb+=!settings[_0x274c49(0x2d5)]?_0x274c49(0x2b3):_0x274c49(0x326),_0x5d9fbb+=settings[_0x274c49(0x2d5)]?settings['telegramEvents']==_0x274c49(0x19a)?_0x274c49(0x25e):'Notifications\x20types:\x20'+settings['telegramEvents']+_0x274c49(0x278):'',await sendTelegram(_0x2f114a[_0x274c49(0x318)]['id'],_0x5d9fbb,{'parse_mode':_0x274c49(0x183)});}),tgBot[_0x122bec(0x312)](_0x122bec(0x2ec),async _0x1c8c60=>{const _0x4481f5=_0x122bec,_0x5537a5=getEnabledBots();if(_0x5537a5[_0x4481f5(0x1fb)]==0x0)await sendTelegram(_0x1c8c60[_0x4481f5(0x318)]['id'],_0x4481f5(0x163));else{if(_0x5537a5['length']>0x1)_0x5537a5['push']({'botID':_0x4481f5(0x19a)});let _0x456890=[],_0xed1034=[];const _0x23981c=_0x5537a5[_0x4481f5(0x1fb)]%0x4==0x0||_0x5537a5[_0x4481f5(0x1fb)]%0x4==0x3||_0x5537a5['length']%0x3==0x1?0x4:0x3;let _0xfa7671=0x0;_0x5537a5['forEach']((_0xaa85a,_0x49f85)=>{const _0x337782=_0x4481f5;if(_0x49f85%_0x23981c==0x0)_0xed1034=[];_0xed1034[_0x337782(0x2f9)](Markup['button'][_0x337782(0x17e)](_0xaa85a[_0x337782(0x219)]==_0x337782(0x19a)?_0x337782(0x2b1):botRef(_0xaa85a[_0x337782(0x219)]),_0x337782(0x29c)+_0xaa85a[_0x337782(0x219)])),_0x49f85%_0x23981c==0x0&&(_0x456890[_0xfa7671]=_0xed1034,_0xfa7671++);});const _0x1414b1=Markup[_0x4481f5(0x170)](_0x456890);_0x1c8c60[_0x4481f5(0x29b)](_0x4481f5(0x24f),_0x1414b1);}}),tgBot['action'](/restart_(.+)/,async _0x404338=>{const _0x577e3b=_0x122bec,_0x4674d9=_0x404338[_0x577e3b(0x22e)][0x1];_0x404338['editMessageReplyMarkup'](),_0x4674d9=='all'?config[_0x577e3b(0x21b)](_0x22ee01=>{const _0x2c4432=_0x577e3b;restartBot(_0x22ee01[_0x2c4432(0x219)]);}):restartBot(_0x4674d9);}),tgBot[_0x122bec(0x312)]('on',async _0x537d52=>{const _0xd4d568=_0x122bec,_0x3c3c2e=getDisabledBots();if(_0x3c3c2e[_0xd4d568(0x1fb)]==0x0)await sendTelegram(_0x537d52[_0xd4d568(0x318)]['id'],_0xd4d568(0x2f8));else{if(_0x3c3c2e[_0xd4d568(0x1fb)]>0x1)_0x3c3c2e[_0xd4d568(0x2f9)]({'botID':_0xd4d568(0x19a)});let _0x45c7d8=[],_0xf61836=[];const _0x10ab7b=_0x3c3c2e[_0xd4d568(0x1fb)]%0x4==0x0||_0x3c3c2e[_0xd4d568(0x1fb)]%0x4==0x3||_0x3c3c2e[_0xd4d568(0x1fb)]%0x3==0x1?0x4:0x3;let _0x2bfddc=0x0;_0x3c3c2e[_0xd4d568(0x21b)]((_0x2b4f6b,_0x431afb)=>{const _0x163e36=_0xd4d568;if(_0x431afb%_0x10ab7b==0x0)_0xf61836=[];_0xf61836[_0x163e36(0x2f9)](Markup['button']['callback'](_0x2b4f6b[_0x163e36(0x219)]=='all'?_0x163e36(0x2b1):botRef(_0x2b4f6b[_0x163e36(0x219)]),'on_'+_0x2b4f6b[_0x163e36(0x219)])),_0x431afb%_0x10ab7b==0x0&&(_0x45c7d8[_0x2bfddc]=_0xf61836,_0x2bfddc++);});const _0x2fd315=Markup[_0xd4d568(0x170)](_0x45c7d8);_0x537d52[_0xd4d568(0x29b)](_0xd4d568(0x1f6),_0x2fd315);}}),tgBot[_0x122bec(0x218)](/on_(.+)/,async _0x2a4118=>{const _0x381710=_0x122bec,_0x4b6ad5=_0x2a4118[_0x381710(0x22e)][0x1];_0x2a4118['editMessageReplyMarkup']();if(_0x4b6ad5=='all'){const _0x3a0a4a=getDisabledBots();await sendTelegram(_0x2a4118[_0x381710(0x318)]['id'],_0x381710(0x181)),_0x3a0a4a[_0x381710(0x21b)](_0x2c058e=>{const _0x2446c6=_0x381710;if(_0x2c058e[_0x2446c6(0x219)]!=_0x2446c6(0x19a))toggleBot(_0x2c058e[_0x2446c6(0x219)],toggleStatus(_0x2c058e[_0x2446c6(0x219)]),_0x2446c6(0x2a8));});}else await sendTelegram(_0x2a4118[_0x381710(0x318)]['id'],_0x381710(0x16c)+botRef(_0x4b6ad5)),toggleBot(_0x4b6ad5,toggleStatus(_0x4b6ad5),_0x381710(0x2a8));}),tgBot['command'](_0x122bec(0x263),async _0x426509=>{const _0x1adedd=_0x122bec,_0x4cd3ba=getEnabledBots();if(_0x4cd3ba[_0x1adedd(0x1fb)]==0x0)await sendTelegram(_0x426509[_0x1adedd(0x318)]['id'],_0x1adedd(0x163));else{if(_0x4cd3ba[_0x1adedd(0x1fb)]>0x1)_0x4cd3ba[_0x1adedd(0x2f9)]({'botID':'all'});let _0x4a0363=[],_0x444f4c=[];const _0x246913=_0x4cd3ba[_0x1adedd(0x1fb)]%0x4==0x0||_0x4cd3ba[_0x1adedd(0x1fb)]%0x4==0x3||_0x4cd3ba[_0x1adedd(0x1fb)]%0x3==0x1?0x4:0x3;let _0x28febe=0x0;_0x4cd3ba['forEach']((_0x3f490f,_0x48ccae)=>{const _0x487b73=_0x1adedd;if(_0x48ccae%_0x246913==0x0)_0x444f4c=[];_0x444f4c['push'](Markup['button'][_0x487b73(0x17e)](_0x3f490f[_0x487b73(0x219)]==_0x487b73(0x19a)?_0x487b73(0x2b1):botRef(_0x3f490f[_0x487b73(0x219)]),_0x487b73(0x177)+_0x3f490f[_0x487b73(0x219)])),_0x48ccae%_0x246913==0x0&&(_0x4a0363[_0x28febe]=_0x444f4c,_0x28febe++);});const _0x119306=Markup[_0x1adedd(0x170)](_0x4a0363);_0x426509['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x119306);}}),tgBot[_0x122bec(0x218)](/off_(.+)/,async _0x3bef02=>{const _0x182c60=_0x122bec,_0x20379e=_0x3bef02[_0x182c60(0x22e)][0x1];_0x3bef02[_0x182c60(0x35e)]();if(_0x20379e==_0x182c60(0x19a)){const _0x4f2b31=getEnabledBots();await sendTelegram(_0x3bef02[_0x182c60(0x318)]['id'],_0x182c60(0x2f4)),_0x4f2b31['forEach'](_0x34b276=>{const _0x36776=_0x182c60;if(_0x34b276['botID']!=_0x36776(0x19a))toggleBot(_0x34b276[_0x36776(0x219)],toggleStatus(_0x34b276['botID']),_0x36776(0x2a8));});}else await sendTelegram(_0x3bef02[_0x182c60(0x318)]['id'],_0x182c60(0x2da)+botRef(_0x20379e)),toggleBot(_0x20379e,toggleStatus(_0x20379e),'stopped');}),tgBot[_0x122bec(0x312)](_0x122bec(0x2aa),async _0x5784f9=>{const _0x3c8db0=_0x122bec,_0x3a9215=getEnabledBots();if(_0x3a9215[_0x3c8db0(0x1fb)]==0x0)await sendTelegram(_0x5784f9[_0x3c8db0(0x318)]['id'],_0x3c8db0(0x163));else{if(_0x3a9215[_0x3c8db0(0x1fb)]>0x1){let _0x1d503c=[],_0x351173=[];const _0x377d06=_0x3a9215[_0x3c8db0(0x1fb)]%0x4==0x0||_0x3a9215['length']%0x4==0x3||_0x3a9215[_0x3c8db0(0x1fb)]%0x3==0x1?0x4:0x3;let _0x55d57a=0x0;_0x3a9215[_0x3c8db0(0x21b)]((_0x5e9b27,_0x5c0adc)=>{const _0x3cbdec=_0x3c8db0;if(_0x5c0adc%_0x377d06==0x0)_0x351173=[];_0x351173[_0x3cbdec(0x2f9)](Markup[_0x3cbdec(0x1d2)][_0x3cbdec(0x17e)](botRef(_0x5e9b27[_0x3cbdec(0x219)]),'metrics_'+_0x5e9b27[_0x3cbdec(0x219)])),_0x5c0adc%_0x377d06==0x0&&(_0x1d503c[_0x55d57a]=_0x351173,_0x55d57a++);});const _0x17c1fd=Markup[_0x3c8db0(0x170)](_0x1d503c);_0x5784f9[_0x3c8db0(0x29b)](_0x3c8db0(0x238),_0x17c1fd);}else{const _0x3d89ce=_0x3a9215[0x0][_0x3c8db0(0x219)];if(pid[_0x3d89ce])pid[_0x3d89ce]['send']({'function':_0x3c8db0(0x241),'args':null});}}}),tgBot[_0x122bec(0x218)](/metrics_(.+)/,async _0x468d51=>{const _0x4cf288=_0x122bec,_0x57705e=_0x468d51[_0x4cf288(0x22e)][0x1];_0x468d51[_0x4cf288(0x35e)]();if(pid[_0x57705e])pid[_0x57705e][_0x4cf288(0x281)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x122bec(0x312)](_0x122bec(0x14c),async _0x5d1ffb=>{const _0x1c59d7=_0x122bec,_0x2a4b53=getEnabledBots();if(_0x2a4b53['length']==0x0)await sendTelegram(_0x5d1ffb[_0x1c59d7(0x318)]['id'],_0x1c59d7(0x163));else{if(_0x2a4b53[_0x1c59d7(0x1fb)]>0x1){let _0x4f5c1f=[],_0x35e82c=[];const _0x1e3f04=_0x2a4b53[_0x1c59d7(0x1fb)]%0x4==0x0||_0x2a4b53[_0x1c59d7(0x1fb)]%0x4==0x3||_0x2a4b53[_0x1c59d7(0x1fb)]%0x3==0x1?0x4:0x3;let _0xe0b6a2=0x0;_0x2a4b53[_0x1c59d7(0x21b)]((_0x55531d,_0x3561eb)=>{const _0x263197=_0x1c59d7;if(_0x3561eb%_0x1e3f04==0x0)_0x35e82c=[];_0x35e82c[_0x263197(0x2f9)](Markup['button'][_0x263197(0x17e)](botRef(_0x55531d[_0x263197(0x219)]),_0x263197(0x1f5)+_0x55531d['botID'])),_0x3561eb%_0x1e3f04==0x0&&(_0x4f5c1f[_0xe0b6a2]=_0x35e82c,_0xe0b6a2++);});const _0x3cbca2=Markup[_0x1c59d7(0x170)](_0x4f5c1f);_0x5d1ffb[_0x1c59d7(0x29b)](_0x1c59d7(0x13d),_0x3cbca2);}else{const _0x453432=_0x2a4b53[0x0][_0x1c59d7(0x219)];if(pid[_0x453432])pid[_0x453432][_0x1c59d7(0x281)]({'function':_0x1c59d7(0x324),'args':null});}}}),tgBot[_0x122bec(0x218)](/portfolio_(.+)/,async _0x1fac8e=>{const _0x481269=_0x122bec,_0x3802e3=_0x1fac8e[_0x481269(0x22e)][0x1];_0x1fac8e[_0x481269(0x35e)]();if(pid[_0x3802e3])pid[_0x3802e3][_0x481269(0x281)]({'function':'sendPortfolioTelegram','args':null});}),tgBot['command']('logs',async _0x34a15a=>{const _0x11be1c=_0x122bec,_0x2ed913=_0x11be1c(0x279);await zipFiles(_0x2ed913);const _0x560d9e=zippath+(_0x2ed913+'.zip');_0x34a15a['replyWithDocument']({'source':_0x560d9e})[_0x11be1c(0x16d)](()=>{})[_0x11be1c(0x284)](_0xb0aa4e=>logger['debug'](_0x11be1c(0x155)+_0x2ed913+'\x20files\x20over\x20Telegram:',_0xb0aa4e));}),tgBot[_0x122bec(0x312)]('backup',async _0x55f0e1=>{const _0x384569=_0x122bec,_0x3c7790=_0x384569(0x343);await backupConfigFiles(),await zipFiles(_0x3c7790);const _0x6a1430=zippath+(_0x3c7790+_0x384569(0x147));_0x55f0e1[_0x384569(0x2b7)]({'source':_0x6a1430})[_0x384569(0x16d)](()=>{})[_0x384569(0x284)](_0x3dd40f=>logger[_0x384569(0x1ae)](_0x384569(0x155)+_0x3c7790+_0x384569(0x305),_0x3dd40f));}),tgBot[_0x122bec(0x312)](_0x122bec(0x1a7),async _0x431a21=>{const _0x2acdb9=_0x122bec;await getMessages();if(!updateAvailable)await sendTelegram(_0x431a21[_0x2acdb9(0x318)]['id'],_0x2acdb9(0x26a));else{if(!validInstallation)await sendTelegram(_0x431a21[_0x2acdb9(0x318)]['id'],_0x2acdb9(0x26e));else{const _0x1522f4=Markup[_0x2acdb9(0x170)]([Markup['button'][_0x2acdb9(0x17e)](_0x2acdb9(0x1af),'update_yes'),Markup[_0x2acdb9(0x1d2)][_0x2acdb9(0x17e)]('No',_0x2acdb9(0x14b))]);_0x431a21[_0x2acdb9(0x29b)](_0x2acdb9(0x254),_0x1522f4);}}}),tgBot[_0x122bec(0x218)](/update_(.+)/,async _0xb65da2=>{const _0x5a8090=_0x122bec,_0x4cabcb=_0xb65da2[_0x5a8090(0x22e)][0x1];_0xb65da2[_0x5a8090(0x35e)](),_0x4cabcb==_0x5a8090(0x18a)&&(await sendTelegram(_0xb65da2['chat']['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0x5a8090(0x1a7))),_0x4cabcb=='no'&&await sendTelegram(_0xb65da2[_0x5a8090(0x318)]['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x122bec(0x312)](_0x122bec(0x2e8),async _0x2ba2ce=>{const _0x5a6d51=_0x122bec;if(!validInstallation)await sendTelegram(_0x2ba2ce['chat']['id'],_0x5a6d51(0x335));else{const _0x5bf4d2=Markup[_0x5a6d51(0x170)]([Markup[_0x5a6d51(0x1d2)][_0x5a6d51(0x17e)](_0x5a6d51(0x1af),'reinstall_yes'),Markup[_0x5a6d51(0x1d2)][_0x5a6d51(0x17e)]('No','reinstall_no')]);_0x2ba2ce[_0x5a6d51(0x29b)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x5bf4d2);}}),tgBot['action'](/reinstall_(.+)/,async _0x43682b=>{const _0x1cefb1=_0x122bec,_0x2d0735=_0x43682b[_0x1cefb1(0x22e)][0x1];_0x43682b['editMessageReplyMarkup'](),_0x2d0735=='yes'&&(await sendTelegram(_0x43682b[_0x1cefb1(0x318)]['id'],_0x1cefb1(0x2dd)),updateBB(_0x1cefb1(0x2e8))),_0x2d0735=='no'&&await sendTelegram(_0x43682b[_0x1cefb1(0x318)]['id'],_0x1cefb1(0x1f8));}),tgBot[_0x122bec(0x312)](_0x122bec(0x233),async _0x5543bd=>{const _0x2b26c9=_0x122bec,_0x5714c5=getBotsWithMode();if(_0x5714c5['length']==0x0)await sendTelegram(_0x5543bd[_0x2b26c9(0x318)]['id'],_0x2b26c9(0x163));else{let _0x4784d9=[],_0x4bacac=[];const _0x2d830b=0x2;let _0x2840b9=0x0;_0x5714c5[_0x2b26c9(0x21b)]((_0x557377,_0x2c79ce)=>{const _0x25315c=_0x2b26c9;if(_0x2c79ce%_0x2d830b==0x0)_0x4bacac=[];_0x4bacac['push'](Markup[_0x25315c(0x1d2)][_0x25315c(0x17e)](botRef(_0x557377[_0x25315c(0x219)])+'\x20('+_0x557377[_0x25315c(0x308)]+')',_0x25315c(0x1b0)+_0x557377['botID'])),_0x2c79ce%_0x2d830b==0x0&&(_0x4784d9[_0x2840b9]=_0x4bacac,_0x2840b9++);});const _0x566116=Markup[_0x2b26c9(0x170)](_0x4784d9);_0x5543bd['reply']('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x566116);}}),tgBot[_0x122bec(0x218)](/toggle_(.+)/,async _0x4c383e=>{const _0x50f8be=_0x122bec,_0x64a0c7=_0x4c383e[_0x50f8be(0x22e)][0x1];_0x4c383e[_0x50f8be(0x35e)]();const _0x91e4ea=getBotsWithMode(),_0x4336fd=_0x91e4ea[_0x50f8be(0x171)](_0x85ca14=>_0x85ca14[_0x50f8be(0x219)]==_0x64a0c7),_0x2cc4f8=_0x4336fd[_0x50f8be(0x308)]==_0x50f8be(0x1b2)?_0x50f8be(0x16e):_0x50f8be(0x1b2);await sendTelegram(_0x4c383e[_0x50f8be(0x318)]['id'],_0x50f8be(0x2a0)+botRef(_0x4336fd[_0x50f8be(0x219)])+_0x50f8be(0x286)+_0x2cc4f8+_0x50f8be(0x1a4)),toggleBotMode(_0x64a0c7);}),tgBot[_0x122bec(0x312)](_0x122bec(0x156),async _0x5b1670=>{const _0x4a68a7=_0x122bec;let _0x52bb3a='';config[_0x4a68a7(0x21b)](_0x36fb08=>{const _0x2f36ee=_0x4a68a7;_0x52bb3a+=_0x2f36ee(0x142)+_0x36fb08[_0x2f36ee(0x219)]+':\x20'+_0x36fb08[_0x2f36ee(0x34c)]+'\x0a';}),await sendTelegram(_0x5b1670[_0x4a68a7(0x318)]['id'],_0x52bb3a,{'parse_mode':_0x4a68a7(0x183)});}),tgBot['command'](_0x122bec(0x313),async _0x52d14a=>{const _0x4e2f66=_0x122bec;await sendTelegram(_0x52d14a[_0x4e2f66(0x318)]['id'],_0x2322b2);}),process[_0x122bec(0x321)]('SIGINT',()=>tgBot[_0x122bec(0x226)](_0x122bec(0x2c6))),process[_0x122bec(0x321)](_0x122bec(0x16f),()=>tgBot[_0x122bec(0x226)](_0x122bec(0x16f))),tgBot[_0x122bec(0x15b)]();}function disableTelegram(){const _0x1d87f0=_0x281d12;tgBot&&tgBot[_0x1d87f0(0x226)]();}async function sendTelegram(_0x40cf9d,_0x3a22b3,_0x415723){const _0x548269=_0x281d12;_0x415723={..._0x415723,'disable_web_page_preview':!![]};try{await tgBot[_0x548269(0x191)]['sendMessage'](_0x40cf9d,_0x3a22b3,_0x415723);}catch(_0x1d6dab){logger[_0x548269(0x1ae)](_0x548269(0x273),_0x1d6dab);}}async function sendTelegramBot(_0x406fe7,_0x371097){const _0x37da0d=_0x281d12;if(settings[_0x37da0d(0x2d5)]){if(settings[_0x37da0d(0x261)]=='all'||(_0x371097[_0x37da0d(0x1cb)]=='error'||_0x371097['type']==_0x37da0d(0x31c)||_0x371097['type']==_0x37da0d(0x2a5))&&settings['telegramEvents']==_0x37da0d(0x264)||_0x371097[_0x37da0d(0x1cb)]==_0x37da0d(0x1ce)&&settings['telegramEvents']==_0x37da0d(0x24e)){if(tgBot&&settings['telegramChatId']){if(_0x371097['showname'])await sendTelegram(settings[_0x37da0d(0x1b8)],_0x371097[_0x37da0d(0x34c)]+_0x37da0d(0x33c)+_0x371097[_0x37da0d(0x2d6)]);else await sendTelegram(settings[_0x37da0d(0x1b8)],'Bot\x20'+_0x406fe7+_0x37da0d(0x33c)+_0x371097['event']);}}}}async function sendTelegramMsg(_0x34faa3,_0x221a17=_0x281d12(0x183)){const _0x53fa5b=_0x281d12;return tgBot&&settings[_0x53fa5b(0x1b8)]?(await sendTelegram(settings[_0x53fa5b(0x1b8)],_0x34faa3,{'parse_mode':_0x221a17}),!![]):![];}function getDeviceWithIp(_0x4f06ca){const _0xd76eae=_0x281d12;return devices[_0xd76eae(0x171)](_0xd96204=>_0xd96204['ip']===_0x4f06ca);}async function temporaryAccess2FA(_0x4d866c,_0x5c5dbc){const _0x5dd635=_0x281d12;let _0x5e3b6d=new Date(),_0x178278=![];if(lastIpApproval){if(_0x5e3b6d-lastIpApproval<0x1388)_0x178278=!![];}lastIpApproval=new Date();if(_0x178278)return;if(tgBot&&settings['telegramChatId']){const _0x4f4604=uuidRandom();tmpStorage[_0x4f4604]={'uuid':_0x4d866c,'externalip':_0x5c5dbc};const _0x5f37d3=Markup['inlineKeyboard']([Markup['button'][_0x5dd635(0x17e)](_0x5dd635(0x291),_0x5dd635(0x2fd)+_0x4f4604),Markup['button'][_0x5dd635(0x17e)](_0x5dd635(0x186),_0x5dd635(0x193)+_0x4f4604),Markup[_0x5dd635(0x1d2)]['callback'](_0x5dd635(0x2b9),_0x5dd635(0x208)+_0x4f4604),Markup[_0x5dd635(0x1d2)][_0x5dd635(0x17e)]('reject',_0x5dd635(0x175)+_0x4f4604)]);await sendTelegram(settings[_0x5dd635(0x1b8)],_0x5dd635(0x339)+normalizeIP(_0x5c5dbc)[_0x5dd635(0x1b3)]+'\x20?',_0x5f37d3),tgBot[_0x5dd635(0x218)](/tempaccess_(.+)_(.+)/,async _0x9d4c41=>{const _0x4473ad=_0x5dd635,_0x2ce187=_0x9d4c41[_0x4473ad(0x22e)][0x1],_0x3aab2d=_0x9d4c41[_0x4473ad(0x22e)][0x2],{uuid:_0x1a6629,externalip:_0x510dbb}=tmpStorage[_0x3aab2d];delete tmpStorage[_0x3aab2d],_0x9d4c41[_0x4473ad(0x35e)](),devices[_0x1a6629][_0x4473ad(0x173)]={'clientip':_0x510dbb,'timestamp':new Date()[_0x4473ad(0x223)](),'expiry':_0x2ce187},_0x2ce187!=_0x4473ad(0x2a1)?(await sendTelegram(_0x9d4c41[_0x4473ad(0x318)]['id'],_0x4473ad(0x2b0)+_0x2ce187+_0x4473ad(0x347),{'parse_mode':_0x4473ad(0x183)}),io['to'](_0x1a6629)['emit'](_0x4473ad(0x337),{'access':{'allow':![],'reason':_0x4473ad(0x211),'token':null}})):(await sendTelegram(_0x9d4c41[_0x4473ad(0x318)]['id'],_0x4473ad(0x149)),io['to'](_0x1a6629)[_0x4473ad(0x2fb)]('status',{'access':{'allow':![],'reason':_0x4473ad(0x317),'token':null}}));});}}async function loginAccess2FA(_0x545847,_0x1f7b25){const _0x178ea4=_0x281d12;if(tgBot&&settings[_0x178ea4(0x1b8)]){const _0x410fb7=uuidRandom();tmpStorage[_0x410fb7]={'uuid':_0x545847,'externalip':_0x1f7b25};const _0x461031=Markup[_0x178ea4(0x170)]([Markup[_0x178ea4(0x1d2)]['callback'](_0x178ea4(0x214),_0x178ea4(0x2cc)+loginExpiry+'_'+_0x410fb7),Markup[_0x178ea4(0x1d2)][_0x178ea4(0x17e)](_0x178ea4(0x2a1),_0x178ea4(0x229)+_0x410fb7)]);await sendTelegram(settings[_0x178ea4(0x1b8)],_0x178ea4(0x1e0)+normalizeIP(_0x1f7b25)[_0x178ea4(0x1b3)]+'\x20?',_0x461031),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x4244ad=>{const _0x2819b8=_0x178ea4,_0x19a95a=_0x4244ad[_0x2819b8(0x22e)][0x1],_0x3d1782=_0x4244ad[_0x2819b8(0x22e)][0x2],{uuid:_0x21d425,externalip:_0x16b267}=tmpStorage[_0x3d1782];delete tmpStorage[_0x3d1782],_0x4244ad[_0x2819b8(0x35e)](),devices[_0x21d425][_0x2819b8(0x272)]={'clientip':_0x16b267,'timestamp':new Date()['getTime'](),'expiry':_0x19a95a},_0x19a95a!=_0x2819b8(0x2a1)?(await sendTelegram(_0x4244ad[_0x2819b8(0x318)]['id'],_0x2819b8(0x16a),{'parse_mode':_0x2819b8(0x183)}),io['to'](_0x21d425)[_0x2819b8(0x2fb)](_0x2819b8(0x337),{'access':{'allow':![],'reason':_0x2819b8(0x211),'token':null}})):(await sendTelegram(_0x4244ad['chat']['id'],_0x2819b8(0x2a7)),io['to'](_0x21d425)['emit'](_0x2819b8(0x337),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0xf5ca3=_0x281d12;return dbConfig['get'](_0xf5ca3(0x33a))[_0xf5ca3(0x1f1)](_0xf5ca3(0x219))[_0xf5ca3(0x1f7)]({'status':_0xf5ca3(0x298)})[_0xf5ca3(0x34e)]()||[];}function getDisabledBots(){const _0x5a24cd=_0x281d12;return dbConfig[_0x5a24cd(0x302)](_0x5a24cd(0x33a))[_0x5a24cd(0x1f1)](_0x5a24cd(0x219))[_0x5a24cd(0x1f7)]({'status':'disabled'})[_0x5a24cd(0x34e)]()||[];}function getBotAttributes(_0x4449be){const _0x1d01f6=_0x281d12;let _0x1e79b4={};const _0x5727a2=configpath+'bot-'+_0x4449be+_0x1d01f6(0x19d),_0x6393c0=fs[_0x1d01f6(0x2a6)](_0x5727a2);if(_0x6393c0){const _0x41a444=fs[_0x1d01f6(0x299)](_0x5727a2);try{const _0x34c6c2=JSON[_0x1d01f6(0x32b)](_0x41a444),_0x25a422=_0x34c6c2?_0x34c6c2[_0x1d01f6(0x207)][0x0][_0x1d01f6(0x252)]:![];_0x1e79b4[_0x1d01f6(0x308)]=_0x25a422?_0x1d01f6(0x1b2):'manual',_0x1e79b4['botname']=_0x34c6c2?_0x34c6c2[_0x1d01f6(0x207)][0x0][_0x1d01f6(0x34c)]:'Bot\x20'+_0x4449be,_0x1e79b4['showname']=_0x34c6c2?_0x34c6c2[_0x1d01f6(0x207)][0x0][_0x1d01f6(0x2af)]:![];}catch(_0x189fbc){_0x1e79b4[_0x1d01f6(0x308)]='manual',_0x1e79b4[_0x1d01f6(0x34c)]=_0x1d01f6(0x142)+_0x4449be,_0x1e79b4[_0x1d01f6(0x2af)]=![];}}else _0x1e79b4[_0x1d01f6(0x308)]=_0x1d01f6(0x16e),_0x1e79b4[_0x1d01f6(0x34c)]='Bot\x20'+_0x4449be,_0x1e79b4['showname']=![];return _0x1e79b4;}function getBotsWithMode(){const _0x12a7a8=_0x281d12,_0x5bfdf9=dbConfig[_0x12a7a8(0x302)]('bots')[_0x12a7a8(0x1f1)](_0x12a7a8(0x219))[_0x12a7a8(0x34e)]()||[];return _0x5bfdf9['forEach'](_0x5780fc=>{const _0x160a1a=_0x12a7a8;let _0x3a6a92=getBotAttributes(_0x5780fc[_0x160a1a(0x219)]);_0x5780fc[_0x160a1a(0x308)]=_0x3a6a92['mode'];}),_0x5bfdf9;}function getBotExchanges(){const _0x5613b4=_0x281d12;let _0x326ca8=[];const _0xe9bdc8=dbConfig[_0x5613b4(0x302)](_0x5613b4(0x33a))['sortBy']('botID')[_0x5613b4(0x34e)]()||[];_0xe9bdc8[_0x5613b4(0x21b)](_0x482941=>{const _0x312077=_0x5613b4;if(_0x482941[_0x312077(0x337)]=='enabled'){const _0x14feee=configpath+'bot-'+_0x482941[_0x312077(0x219)]+_0x312077(0x19d),_0x322ef1=fs[_0x312077(0x2a6)](_0x14feee);let _0x546008;if(_0x322ef1){const _0x261db2=fs['readFileSync'](_0x14feee);try{const _0x55f005=JSON[_0x312077(0x32b)](_0x261db2);_0x546008=_0x55f005?_0x55f005['bot'][0x0][_0x312077(0x1d9)]:null;}catch(_0x4c6894){}}if(_0x546008)_0x326ca8[_0x312077(0x2f9)](_0x546008);}});const _0x5c9a26=[...new Set(_0x326ca8)]['sort']();return _0x5c9a26;}async function initUser(){const _0x5f02aa=_0x281d12;if(!settings[_0x5f02aa(0x2e4)]){const _0x471ef6=uuidRandom();mixpanel['alias'](_0x471ef6),updateSetting('userid',_0x471ef6);}}async function initSecure(){const _0x4c6554=_0x281d12;let _0x22c21a=getSecure();if(!_0x22c21a['hasOwnProperty'](_0x4c6554(0x259))){let _0x133f61=await generateKeys();_0x22c21a[_0x4c6554(0x230)]=_0x133f61[_0x4c6554(0x230)],_0x22c21a[_0x4c6554(0x1d4)]=_0x133f61['privateKey'],_0x22c21a[_0x4c6554(0x259)]=crypto['randomBytes'](0x20)['toString']('hex');;storeSecure(_0x22c21a);}}function getSettings(){const _0x505d0c=_0x281d12;return dbSettings['get'](_0x505d0c(0x16b))[_0x505d0c(0x34e)]()||{};}function getSecure(){const _0x4ad58b=_0x281d12;return dbSecure[_0x4ad58b(0x302)](_0x4ad58b(0x2ba))[_0x4ad58b(0x34e)]()||{};}function getBlacklist(){return dbSecure['get']('blacklist')['value']()||[];}function broadcastToBots(_0xb61d73,_0x9845b){const _0x4c8bbb=_0x281d12;config[_0x4c8bbb(0x21b)](_0x41a107=>{const _0x38df65=_0x4c8bbb;if(_0x41a107[_0x38df65(0x337)]==_0x38df65(0x298)&&_0x41a107[_0x38df65(0x1b5)]=='running'||_0x41a107['status']==_0x38df65(0x1c0)&&_0x41a107[_0x38df65(0x1b5)]==_0x38df65(0x2e0)){if(pid[_0x41a107['botID']])pid[_0x41a107[_0x38df65(0x219)]][_0x38df65(0x281)]({[_0xb61d73]:_0x9845b});}});}async function storeSettings(_0x2e0ba9,_0x5014a6=![]){const _0x4fbbb1=_0x281d12;_0x2e0ba9={...settings,..._0x2e0ba9};if(_0x5014a6&&_0x2e0ba9[_0x4fbbb1(0x257)]!='************'&&_0x2e0ba9[_0x4fbbb1(0x257)]!='***'&&_0x2e0ba9['bbPassword']!=''){const _0x5d98d2=decryptRSA(secure[_0x4fbbb1(0x1d4)],_0x2e0ba9[_0x4fbbb1(0x257)])[_0x4fbbb1(0x1a0)](_0x4fbbb1(0x21d))[0x0],_0x24f3c6=bcrypt[_0x4fbbb1(0x1d8)](_0x5d98d2,saltRounds);_0x2e0ba9={..._0x2e0ba9,'bbPassword':_0x24f3c6};}if(_0x5014a6&&_0x2e0ba9['telegramToken']!=_0x4fbbb1(0x342)&&_0x2e0ba9[_0x4fbbb1(0x2fe)]!=_0x4fbbb1(0x1dc)&&_0x2e0ba9['telegramToken']!=''){const _0x123a5e=decryptRSA(secure[_0x4fbbb1(0x1d4)],_0x2e0ba9['telegramToken'])[_0x4fbbb1(0x1a0)](_0x4fbbb1(0x21d))[0x0];_0x2e0ba9={..._0x2e0ba9,'telegramToken':_0x123a5e};}if(_0x5014a6&&_0x2e0ba9['marketcapApi']!=_0x4fbbb1(0x342)&&_0x2e0ba9[_0x4fbbb1(0x266)]!=_0x4fbbb1(0x1dc)&&_0x2e0ba9[_0x4fbbb1(0x266)]!=''){const _0x394118=decryptRSA(secure['privateKey'],_0x2e0ba9[_0x4fbbb1(0x266)])[_0x4fbbb1(0x1a0)]('|@|')[0x0];_0x2e0ba9={..._0x2e0ba9,'marketcapApi':_0x394118};}const _0x4fda3f=_0x2e0ba9['telegramToken']!='************'&&_0x2e0ba9['telegramToken']!=settings[_0x4fbbb1(0x2fe)]||_0x2e0ba9['telegramUsername']!=settings['telegramUsername'],_0x297015=_0x2e0ba9[_0x4fbbb1(0x2fe)]==''||_0x2e0ba9[_0x4fbbb1(0x197)]=='',_0x225675=_0x2e0ba9['marketcapApi']&&_0x2e0ba9[_0x4fbbb1(0x266)]!='************'&&_0x2e0ba9[_0x4fbbb1(0x266)]!=settings[_0x4fbbb1(0x266)];_0x4fda3f&&(_0x2e0ba9[_0x4fbbb1(0x1b8)]=null,_0x2e0ba9[_0x4fbbb1(0x261)]=_0x4fbbb1(0x19a));for(const [_0x6d71a8,_0x4c2e42]of Object[_0x4fbbb1(0x24d)](_0x2e0ba9)){if(_0x6d71a8==_0x4fbbb1(0x2fe)&&_0x4c2e42=='************'){_0x2e0ba9[_0x4fbbb1(0x2fe)]=settings['telegramToken'];continue;};if(_0x6d71a8==_0x4fbbb1(0x257)&&_0x4c2e42=='************'){_0x2e0ba9[_0x4fbbb1(0x257)]=settings[_0x4fbbb1(0x257)];continue;};if(_0x6d71a8==_0x4fbbb1(0x266)&&_0x4c2e42==_0x4fbbb1(0x342)){_0x2e0ba9[_0x4fbbb1(0x266)]=settings[_0x4fbbb1(0x266)];continue;};dbSettings[_0x4fbbb1(0x322)](_0x4fbbb1(0x1ee)+_0x6d71a8,_0x4c2e42)['write']();}settings=_0x2e0ba9,io['to'](_0x4fbbb1(0x27b))[_0x4fbbb1(0x2fb)]('settings',cleanSettings()),broadcastToBots('timeshift',settings[_0x4fbbb1(0x2ab)]),broadcastToBots(_0x4fbbb1(0x2db),settings['onepagemode']),broadcastToBots(_0x4fbbb1(0x266),settings['marketcapApi']);if(_0x4fda3f&&!_0x297015)initTelegram();_0x4fda3f&&_0x297015&&(updateSetting(_0x4fbbb1(0x1b8),null),disableTelegram()),getAllClients()[_0x4fbbb1(0x21b)](_0x379ed8=>{getSocket(_0x379ed8['id'])['emit']('status',{'access':{'allow':![],'reason':'reload','token':null}});}),_0x225675&&(await sleep(0xbb8),testMarketcapApi(_0x2e0ba9[_0x4fbbb1(0x266)]));}async function testMarketcapApi(_0x563e10){const _0x217eef=_0x281d12,_0x462425=[_0x217eef(0x202),_0x217eef(0x2f2)];try{await axios[_0x217eef(0x302)](_0x217eef(0x234),{'headers':{'X-CMC_PRO_API_KEY':_0x563e10},'params':{'symbol':_0x462425[_0x217eef(0x145)]()}});}catch(_0x2933c9){_0x2933c9[_0x217eef(0x145)]()['includes'](_0x217eef(0x1a9))?(io['to'](_0x217eef(0x27b))['emit'](_0x217eef(0x17a),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x217eef(0x1fa)](_0x217eef(0x176))):(io['to'](_0x217eef(0x27b))[_0x217eef(0x2fb)](_0x217eef(0x17a),'CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x217eef(0x1fa)](_0x217eef(0x2be)),logger[_0x217eef(0x1ae)](_0x217eef(0x1a6),_0x2933c9[_0x217eef(0x145)]()+'\x20-\x20'+_0x2933c9['code']));return;}logger['debug']('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x544c92,_0x399395){const _0x4e9dee=_0x281d12;dbSettings[_0x4e9dee(0x322)](_0x4e9dee(0x1ee)+_0x544c92,_0x399395)[_0x4e9dee(0x1b6)](),settings=getSettings(),io['to']('botmanager')[_0x4e9dee(0x2fb)]('settings',cleanSettings());}function storeSecure(_0x46af56){const _0x2b0b69=_0x281d12;dbSecure[_0x2b0b69(0x302)](_0x2b0b69(0x2ba))[_0x2b0b69(0x2f9)](_0x46af56)[_0x2b0b69(0x1b6)](),secure=_0x46af56;}function addBlacklist(_0x25ecbd){const _0xe526ed=_0x281d12;cleanBlacklist();let _0xffe1aa;devices[_0x25ecbd]['telegramIpApproval']?_0xffe1aa=Math[_0xe526ed(0x297)](devices[_0x25ecbd][_0xe526ed(0x173)][_0xe526ed(0x1ac)],loginExpiry):_0xffe1aa=loginExpiry,dbSecure[_0xe526ed(0x302)]('blacklist')[_0xe526ed(0x2f9)]({'expiry':new Date()[_0xe526ed(0x223)]()+_0xffe1aa*0x3c*0x3e8,'token':devices[_0x25ecbd]['access'][_0xe526ed(0x13f)]})[_0xe526ed(0x1b6)](),blacklist=dbSecure[_0xe526ed(0x302)](_0xe526ed(0x275))[_0xe526ed(0x34e)]();}function cleanBlacklist(){const _0x126310=_0x281d12;let _0x521402=dbSecure[_0x126310(0x302)](_0x126310(0x275))[_0x126310(0x213)]()[_0x126310(0x34e)](),_0x168976=new Date()['getTime']();_0x521402[_0x126310(0x21b)](_0x558b27=>{const _0x4abe42=_0x126310;_0x558b27[_0x4abe42(0x1ac)]<_0x168976&&dbSecure[_0x4abe42(0x302)](_0x4abe42(0x275))['remove']({'expiry':_0x558b27[_0x4abe42(0x1ac)]})[_0x4abe42(0x1b6)]();});}function initStates(){let _0x11b543=getConfiguration();_0x11b543['forEach'](_0x57c6f4=>{const _0x51fb42=_0x3323;_0x57c6f4['live']=_0x51fb42(0x2a8);}),storeConfiguration(_0x11b543);}async function generateKeys(){const _0x309718=_0x281d12,_0x3c4ee4=forge[_0x309718(0x346)][_0x309718(0x1cc)][_0x309718(0x2eb)]({'bits':0x1000,'e':0x10001}),_0xf976ab=forge[_0x309718(0x346)]['privateKeyToPem'](_0x3c4ee4['privateKey']),_0x44fa0e=forge[_0x309718(0x346)]['publicKeyToPem'](_0x3c4ee4[_0x309718(0x230)]);return{'privateKey':_0xf976ab,'publicKey':_0x44fa0e};}async function oneTimeMigration(){const _0x57d2dd=_0x281d12;let _0x3da59e=getSettings(),_0x5f1c03=![];!_0x3da59e[_0x57d2dd(0x301)]('lastmsgtelegram')&&(_0x3da59e[_0x57d2dd(0x319)]=0x0,_0x5f1c03=!![]);!_0x3da59e[_0x57d2dd(0x301)](_0x57d2dd(0x30d))&&(_0x3da59e[_0x57d2dd(0x30d)]=0x0,_0x5f1c03=!![]);!_0x3da59e['hasOwnProperty'](_0x57d2dd(0x179))&&(_0x3da59e['latestversion']='0.0.0',_0x5f1c03=!![]);!_0x3da59e['hasOwnProperty'](_0x57d2dd(0x2db))&&(_0x3da59e[_0x57d2dd(0x2db)]=![],_0x5f1c03=!![]);!_0x3da59e[_0x57d2dd(0x301)](_0x57d2dd(0x266))&&(_0x3da59e[_0x57d2dd(0x266)]='',_0x5f1c03=!![]);if(_0x5f1c03)storeSettings(_0x3da59e);try{fs[_0x57d2dd(0x141)](configbackuppath,{'withFileTypes':!![]})[_0x57d2dd(0x21b)](_0x4a1cc6=>{const _0x7725bb=_0x57d2dd;if(!_0x4a1cc6[_0x7725bb(0x22a)]()){if(!_0x4a1cc6[_0x7725bb(0x320)][_0x7725bb(0x2cf)](_0x7725bb(0x172)))fs[_0x7725bb(0x1c4)](configbackuppath+_0x4a1cc6['name']);}else fs[_0x7725bb(0x32f)](configbackuppath+_0x4a1cc6['name'],{'recursive':!![]});});}catch(_0xa193df){logger[_0x57d2dd(0x1ae)](_0x57d2dd(0x148),_0xa193df);}}function storeConfiguration(_0x135ccc){const _0xfa80ad=_0x281d12;dbConfig[_0xfa80ad(0x302)](_0xfa80ad(0x33a))[_0xfa80ad(0x1c1)]()['write'](),dbConfig[_0xfa80ad(0x302)](_0xfa80ad(0x33a))[_0xfa80ad(0x2f9)](..._0x135ccc)['write'](),config=_0x135ccc;}async function resetPassword(){const _0x481feb=_0x281d12;if(tgBot&&settings[_0x481feb(0x1b8)]){const _0x2e8b5d=Markup[_0x481feb(0x170)]([Markup[_0x481feb(0x1d2)][_0x481feb(0x17e)](_0x481feb(0x18a),_0x481feb(0x21c)),Markup[_0x481feb(0x1d2)][_0x481feb(0x17e)]('no',_0x481feb(0x1da))]);await sendTelegram(settings[_0x481feb(0x1b8)],_0x481feb(0x2ef),_0x2e8b5d),tgBot['action'](/resetpw_(.+)/,async _0x215845=>{const _0x590423=_0x481feb,_0x29dcfc=_0x215845['match'][0x1];_0x215845[_0x590423(0x35e)]();if(_0x29dcfc!='no'){const _0x4912ff=0xf,_0x1b5695=_0x590423(0x231),_0x57817d=Array[_0x590423(0x198)](crypto[_0x590423(0x2d1)](new Uint32Array(_0x4912ff)))[_0x590423(0x1a1)](_0x39e377=>_0x1b5695[_0x39e377%_0x1b5695[_0x590423(0x1fb)]])[_0x590423(0x20b)](''),_0x27c843=bcrypt[_0x590423(0x1d8)](_0x57817d,saltRounds);storeSettings({'bbPassword':_0x27c843}),await sendTelegram(_0x215845[_0x590423(0x318)]['id'],_0x590423(0x30a)+_0x57817d,{'parse_mode':_0x590423(0x183)});}else await sendTelegram(_0x215845['chat']['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x18d09a,_0xdda42c){const _0x4f78b7=_0x281d12;io['to'](_0x4f78b7(0x27b))[_0x4f78b7(0x2fb)](_0x4f78b7(0x17a),_0x4f78b7(0x164),_0x4f78b7(0x2a5));if(tgBot&&settings[_0x4f78b7(0x1b8)]){const _0xbe4851=uuidRandom();tmpStorage[_0xbe4851]={'path':_0x18d09a,'filename':_0xdda42c};const _0x11a5d2=Markup[_0x4f78b7(0x170)]([Markup[_0x4f78b7(0x1d2)]['callback']('yes',_0x4f78b7(0x323)+_0xbe4851),Markup[_0x4f78b7(0x1d2)][_0x4f78b7(0x17e)]('no',_0x4f78b7(0x30f)+_0xbe4851)]);await sendTelegram(settings[_0x4f78b7(0x1b8)],_0x4f78b7(0x245),_0x11a5d2),tgBot[_0x4f78b7(0x218)](/restore_(.+)_(.+)/,async _0x2260ab=>{const _0x230f92=_0x4f78b7,_0x513821=_0x2260ab[_0x230f92(0x22e)][0x1],_0x2fb92a=_0x2260ab[_0x230f92(0x22e)][0x2],{path:_0x5d9a08,filename:_0x3f782a}=tmpStorage[_0x2fb92a];delete tmpStorage[_0x2fb92a],_0x2260ab[_0x230f92(0x35e)](),_0x513821=='yes'?(logger['debug'](_0x230f92(0x349)),await sendTelegram(_0x2260ab[_0x230f92(0x318)]['id'],_0x230f92(0x2bb),{'parse_mode':_0x230f92(0x183)}),unzipFile(_0x5d9a08,_0x3f782a)):(logger[_0x230f92(0x1ae)](_0x230f92(0x169)),await sendTelegram(_0x2260ab[_0x230f92(0x318)]['id'],_0x230f92(0x169)));});}}function getServerTime(){const _0x24aa5=_0x281d12,_0x383e24=new Date();return _0x383e24[_0x24aa5(0x1e7)]()+'/'+(_0x383e24[_0x24aa5(0x2ac)]()+0x1)[_0x24aa5(0x145)]()['padStart'](0x2,'0')+'/'+_0x383e24[_0x24aa5(0x274)]()[_0x24aa5(0x145)]()[_0x24aa5(0x20f)](0x2,'0')+'\x20'+_0x383e24[_0x24aa5(0x1f2)]()[_0x24aa5(0x145)]()['padStart'](0x2,'0')+':'+_0x383e24['getMinutes']()[_0x24aa5(0x145)]()[_0x24aa5(0x20f)](0x2,'0')+':'+_0x383e24[_0x24aa5(0x2a3)]()[_0x24aa5(0x145)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x1572c0=_0x281d12,_0x30510b=shiftedTime();return _0x30510b['getFullYear']()+'/'+(_0x30510b[_0x1572c0(0x2ac)]()+0x1)[_0x1572c0(0x145)]()['padStart'](0x2,'0')+'/'+_0x30510b[_0x1572c0(0x274)]()[_0x1572c0(0x145)]()[_0x1572c0(0x20f)](0x2,'0')+'\x20'+_0x30510b[_0x1572c0(0x1f2)]()[_0x1572c0(0x145)]()['padStart'](0x2,'0')+':'+_0x30510b[_0x1572c0(0x2d8)]()[_0x1572c0(0x145)]()[_0x1572c0(0x20f)](0x2,'0')+':'+_0x30510b['getSeconds']()[_0x1572c0(0x145)]()[_0x1572c0(0x20f)](0x2,'0');}function getCleanTimeStamp(){const _0x3269f0=_0x281d12,_0x2e4138=shiftedTime();return _0x2e4138['getFullYear']()+(_0x2e4138[_0x3269f0(0x2ac)]()+0x1)[_0x3269f0(0x145)]()[_0x3269f0(0x20f)](0x2,'0')+_0x2e4138[_0x3269f0(0x274)]()['toString']()[_0x3269f0(0x20f)](0x2,'0')+'-'+_0x2e4138[_0x3269f0(0x1f2)]()[_0x3269f0(0x145)]()[_0x3269f0(0x20f)](0x2,'0')+_0x2e4138[_0x3269f0(0x2d8)]()[_0x3269f0(0x145)]()[_0x3269f0(0x20f)](0x2,'0')+_0x2e4138[_0x3269f0(0x2a3)]()[_0x3269f0(0x145)]()[_0x3269f0(0x20f)](0x2,'0');}function shiftedTime(){const _0x2315cf=_0x281d12,_0x3dc9df=new Date();let _0x2b3a83=_0x3dc9df;if(settings[_0x2315cf(0x2ab)]&&settings[_0x2315cf(0x2ab)]!==0x0)_0x2b3a83=fns['add'](_0x3dc9df,{'hours':settings[_0x2315cf(0x2ab)]});return _0x2b3a83;}async function startScheduler(){const _0x3c618a=_0x281d12,_0x4b16fd=new Date()['getUTCHours'](),_0x1a9398=shiftedTime()[_0x3c618a(0x1f2)]();_0x1a9398==0x4&&backupConfigFiles(),_0x1a9398==0x0&&(rotateLogFiles(),logger[_0x3c618a(0x1ae)](_0x3c618a(0x167)),logger[_0x3c618a(0x1ae)]('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x3c618a(0x267)+(environment=='staging'?_0x3c618a(0x200):'')),logger[_0x3c618a(0x1ae)](_0x3c618a(0x167))),_0x4b16fd%0x6==0x0&&triggerAnalytics(),_0x4b16fd%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x4ebe07){const _0x5888de=_0x281d12;logger[_0x5888de(0x1ae)](_0x5888de(0x330)+_0x4ebe07);const _0xe0f9c2=getBotsWithMode();_0xe0f9c2['length']>0x0?confirmRestore(configbackuppath,_0x4ebe07):unzipFile(configbackuppath,_0x4ebe07);}async function getBackupFiles(_0x222ea3=null){const _0x2e4dae=_0x281d12;let _0xd29c54=[],_0x112e3a=fs[_0x2e4dae(0x141)](configbackuppath,{'withFileTypes':!![]});_0x112e3a[_0x2e4dae(0x31d)]((_0x4e1412,_0x995123)=>_0x4e1412[_0x2e4dae(0x320)]<_0x995123['name']?0x1:_0x995123['name']<_0x4e1412[_0x2e4dae(0x320)]?-0x1:0x0),_0x112e3a[_0x2e4dae(0x21b)](_0x4de8cc=>{const _0x45e686=_0x2e4dae;if(!_0x4de8cc[_0x45e686(0x22a)]()&&_0x4de8cc['name']['startsWith']('backup-full@')&&_0x4de8cc[_0x45e686(0x320)]['endsWith']('.zip')){const _0x16a6fc=formatDate(fs[_0x45e686(0x303)](configbackuppath+_0x4de8cc[_0x45e686(0x320)])[_0x45e686(0x1bb)]);_0xd29c54[_0x45e686(0x2f9)]({'name':_0x4de8cc['name'],'mtime':_0x16a6fc});}});if(_0x222ea3)io['to'](_0x222ea3)[_0x2e4dae(0x2fb)]('backup-files',_0xd29c54);else return _0xd29c54;}async function backupConfigFiles(){const _0x3d75bb=_0x281d12;await zipFiles(_0x3d75bb(0x2cb));const _0x271d01=getCleanTimeStamp();fs[_0x3d75bb(0x2d4)](zippath+_0x3d75bb(0x2f3),configbackuppath+(_0x3d75bb(0x172)+_0x271d01+_0x3d75bb(0x147)));let _0x438960=fs[_0x3d75bb(0x141)](configbackuppath,{'withFileTypes':!![]});_0x438960[_0x3d75bb(0x31d)]((_0x29d62f,_0x122285)=>_0x29d62f[_0x3d75bb(0x320)]<_0x122285[_0x3d75bb(0x320)]?0x1:_0x122285[_0x3d75bb(0x320)]<_0x29d62f['name']?-0x1:0x0),_0x438960['length']>maxBackups&&fs[_0x3d75bb(0x1c4)](configbackuppath+_0x438960[_0x438960[_0x3d75bb(0x1fb)]-0x1]['name']);}function rotateLogFiles(){const _0xa56290=_0x281d12,_0x4a7221=fs[_0xa56290(0x303)](logspath+_0xa56290(0x2c1)),_0x293d57=_0x4a7221[_0xa56290(0x210)]/0x400;if(_0x293d57>0x64){let _0x1edd1b=fs[_0xa56290(0x141)](logspath,{'withFileTypes':!![]});_0x1edd1b['sort']((_0xec517e,_0x33d589)=>_0xec517e[_0xa56290(0x320)]<_0x33d589[_0xa56290(0x320)]?0x1:_0x33d589[_0xa56290(0x320)]<_0xec517e[_0xa56290(0x320)]?-0x1:0x0),_0x1edd1b[_0xa56290(0x21b)](_0x5c3d82=>{const _0x4de2d2=_0xa56290;if(_0x5c3d82[_0x4de2d2(0x320)]==_0x4de2d2(0x2f1))fs[_0x4de2d2(0x2d4)](logspath+_0x5c3d82[_0x4de2d2(0x320)],logspath+_0x4de2d2(0x1ff));if(_0x5c3d82[_0x4de2d2(0x320)]=='output-001.log')fs[_0x4de2d2(0x2d4)](logspath+_0x5c3d82['name'],logspath+_0x4de2d2(0x2f1));_0x5c3d82[_0x4de2d2(0x320)]=='output-000.log'&&(fs[_0x4de2d2(0x2d4)](logspath+_0x5c3d82['name'],logspath+_0x4de2d2(0x17b)),fs[_0x4de2d2(0x174)](logspath+_0x5c3d82[_0x4de2d2(0x320)],''));});}}async function zipFiles(_0xdeec3e){const _0x15f398=_0x281d12;let _0x1260d1;if(_0xdeec3e=='logs')_0x1260d1=logspath;if(_0xdeec3e==_0x15f398(0x343))_0x1260d1=configpath;if(_0xdeec3e==_0x15f398(0x2cb))_0x1260d1=configpath;let _0x4fb1a9=fs[_0x15f398(0x141)](_0x1260d1,{'withFileTypes':!![]});const _0x35bf47=new JSZip();_0x4fb1a9[_0x15f398(0x21b)](_0x2ef5f0=>{const _0x2ed746=_0x15f398;if(!_0x2ef5f0[_0x2ed746(0x22a)]()){let _0x37a4de=fs[_0x2ed746(0x299)](_0x1260d1+_0x2ef5f0[_0x2ed746(0x320)]);if(_0xdeec3e==_0x2ed746(0x343)){const _0x25a7c7=/^bot-[0-9]{3}-config.json$/,_0x1a7078=_0x25a7c7['test'](_0x2ef5f0[_0x2ed746(0x320)]);if(_0x1a7078){const _0x442c39=JSON[_0x2ed746(0x32b)](_0x37a4de);if(_0x442c39[_0x2ed746(0x207)][0x0]){_0x442c39[_0x2ed746(0x207)][0x0][_0x2ed746(0x25d)]=_0x2ed746(0x1dc),_0x442c39[_0x2ed746(0x207)][0x0][_0x2ed746(0x25b)]=_0x2ed746(0x1dc);if(_0x442c39[_0x2ed746(0x207)][0x0][_0x2ed746(0x32e)])_0x442c39[_0x2ed746(0x207)][0x0]['apiPassword']='***';}_0x37a4de=JSON[_0x2ed746(0x271)](_0x442c39,null,0x2);}if(_0x2ef5f0[_0x2ed746(0x320)]=='bb-settings.json'){const _0x41631a=JSON[_0x2ed746(0x32b)](_0x37a4de);if(_0x41631a['settings'][_0x2ed746(0x154)])_0x41631a[_0x2ed746(0x16b)]['loginRequired']=![];if(_0x41631a['settings'][_0x2ed746(0x257)])_0x41631a['settings'][_0x2ed746(0x257)]=_0x2ed746(0x1dc);if(_0x41631a[_0x2ed746(0x16b)][_0x2ed746(0x2fe)])_0x41631a['settings'][_0x2ed746(0x2fe)]=_0x2ed746(0x1dc);if(_0x41631a[_0x2ed746(0x16b)][_0x2ed746(0x1b8)])_0x41631a['settings'][_0x2ed746(0x1b8)]=null;if(_0x41631a[_0x2ed746(0x16b)][_0x2ed746(0x266)])_0x41631a[_0x2ed746(0x16b)][_0x2ed746(0x266)]=_0x2ed746(0x1dc);_0x37a4de=JSON[_0x2ed746(0x271)](_0x41631a,null,0x2);}if(_0x2ef5f0['name']!=_0x2ed746(0x2c2))_0x35bf47[_0x2ed746(0x296)](_0x2ef5f0['name'],_0x37a4de);}else _0x35bf47[_0x2ed746(0x296)](_0x2ef5f0[_0x2ed746(0x320)],_0x37a4de);}});const _0x1e2d42=await _0x35bf47[_0x15f398(0x256)]({'type':'string','base64':![],'compression':_0x15f398(0x1e6)});fs[_0x15f398(0x174)](zippath+(_0xdeec3e+'.zip'),_0x1e2d42,_0x15f398(0x1e4));}async function unzipFile(_0x3c0dcb,_0x68b39a){const _0x1c5a8b=_0x281d12;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x1c5a8b(0x21b)](_0x3a7a5f=>{const _0x3a077e=_0x1c5a8b;if(!_0x3a7a5f[_0x3a077e(0x22a)]())fs[_0x3a077e(0x32f)](configpath+_0x3a7a5f[_0x3a077e(0x320)]);});const _0x11b28f=fs[_0x1c5a8b(0x299)](_0x3c0dcb+_0x68b39a,_0x1c5a8b(0x1e4)),_0x566efb=await JSZip[_0x1c5a8b(0x1d1)](_0x11b28f,{'base64':![],'checkCRC32':!![]});for(const _0x342bd8 of Object['keys'](_0x566efb[_0x1c5a8b(0x287)])){const _0x1750ba=_0x566efb['files'][_0x342bd8],_0x4b1046=await _0x1750ba[_0x1c5a8b(0x1be)]('string');fs[_0x1c5a8b(0x174)](configpath+_0x1750ba['name'],_0x4b1046);}fs[_0x1c5a8b(0x141)](temppath,{'withFileTypes':!![]})['forEach'](_0x460c77=>{const _0x9783d=_0x1c5a8b;if(!_0x460c77[_0x9783d(0x22a)]())fs[_0x9783d(0x32f)](temppath+_0x460c77[_0x9783d(0x320)]);}),logger[_0x1c5a8b(0x1ae)](_0x1c5a8b(0x201)),process[_0x1c5a8b(0x281)]({'restore':!![]},_0x30dadf=>{});}async function getPublicIp(){const _0xa343fa=_0x281d12;try{const _0x3a10ac=await axios[_0xa343fa(0x302)](_0xa343fa(0x2df));publicip=_0x3a10ac[_0xa343fa(0x144)]['ip'];}catch(_0x12a4c0){}}async function triggerAnalytics(){const _0x3965d1=_0x281d12;if(!publicip)await getPublicIp();const _0x4362c5=getBotsWithMode();let _0x8c81a8=0x0;_0x4362c5['forEach'](_0x2a0ae3=>{const _0x7360c7=_0x3323;if(_0x2a0ae3[_0x7360c7(0x337)]==='enabled')_0x8c81a8++;});const _0x2a72f5=getBotExchanges();mixpanel[_0x3965d1(0x228)](_0x3965d1(0x35f),{'distinct_id':settings[_0x3965d1(0x2e4)],'ip':publicip,'version':serverversion,'numbots':_0x4362c5[_0x3965d1(0x1fb)],'numbotsenabled':_0x8c81a8,'exchanges':_0x2a72f5,'environment':environment});}async function getMessages(){const _0x2fb552=_0x281d12,_0x2a4013=_0x2fb552(0x2ed),_0x2a6cfb=new GraphQLClient(_0x2a4013),_0xe1e640={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x540e62=serverversion['split']('.'),_0x4328f0=_0x540e62[0x0]+'.'+_0x540e62[0x1],_0xfa70ce=Math[_0x2fb552(0x2a9)](settings['lastmsgtelegram'],settings[_0x2fb552(0x30d)]),_0x2a49ef={'last':parseInt(_0xfa70ce),'bbm':_0x4328f0},_0x38970d=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0xbe2475;try{_0xbe2475=await _0x2a6cfb[_0x2fb552(0x1c5)](_0x38970d,_0x2a49ef,_0xe1e640);}catch(_0x3e7e4a){}if(_0xbe2475&&_0xbe2475[_0x2fb552(0x21f)]){let _0x312e46=settings[_0x2fb552(0x319)],_0x447c22=settings['lastmsgtelegram'];newMessages=[];for(const _0x3f9bc5 of _0xbe2475[_0x2fb552(0x21f)]){newMessages[_0x2fb552(0x2f9)](_0x3f9bc5);let _0x51e32f=![];_0x3f9bc5[_0x2fb552(0x34b)]&&(updateSetting(_0x2fb552(0x179),_0x3f9bc5['bbvNew']),_0x51e32f=isNewerVersion(serverversion,_0x3f9bc5['bbvNew'])||serverversion==_0x3f9bc5['bbvNew']);if(!_0x51e32f&&_0x3f9bc5[_0x2fb552(0x348)]>_0x312e46){if(_0x3f9bc5[_0x2fb552(0x15e)]==='any'||serverversion['startsWith'](_0x3f9bc5[_0x2fb552(0x15e)])){let _0x1af3bf=''+_0x3f9bc5[_0x2fb552(0x255)]+'\x0a\x0a'+_0x3f9bc5[_0x2fb552(0x2ee)];const _0x1e7dc5=await sendTelegramMsg(toTelegramMarkdown(_0x1af3bf),'Markdown');_0x312e46=_0x3f9bc5[_0x2fb552(0x348)];}}_0x447c22=_0x3f9bc5['number'];}updateAvailable=isNewerVersion(settings[_0x2fb552(0x179)],serverversion),updateSetting(_0x2fb552(0x319),_0x447c22),emitMessages();}}function emitMessages(){const _0x1309b9=_0x281d12,_0x2956dc=settings['lastmsgemitted'];let _0x408f3b=[];newMessages[_0x1309b9(0x21b)](_0x103d42=>{const _0x5cccc1=_0x1309b9;_0x103d42[_0x5cccc1(0x348)]>_0x2956dc&&_0x408f3b['push'](_0x103d42);}),_0x408f3b[_0x1309b9(0x1fb)]>0x0&&getAllClients()['forEach'](_0x1af82d=>{const _0xb06b4e=_0x1309b9;getSocket(_0x1af82d['id'])[_0xb06b4e(0x2fb)](_0xb06b4e(0x2ee),_0x408f3b);});}function confirmMessage(_0x276839){const _0x566af8=_0x281d12;updateSetting(_0x566af8(0x30d),Number(_0x276839));}function isNewerVersion(_0x40d04b,_0x12abc8){const _0x439cb8=_0x281d12,_0x5c2caa=_0x12abc8[_0x439cb8(0x1a0)]('.'),_0x4596db=_0x40d04b[_0x439cb8(0x1a0)]('.');for(var _0x38cf15=0x0;_0x38cf15<_0x4596db[_0x439cb8(0x1fb)];_0x38cf15++){const _0x4859ef=~~_0x4596db[_0x38cf15],_0xd08bee=~~_0x5c2caa[_0x38cf15];if(_0x4859ef>_0xd08bee)return!![];if(_0x4859ef<_0xd08bee)return![];}return![];}function toTelegramMarkdown(_0x23cfd6){const _0x2eff7a=_0x281d12,_0x524931=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x20da4c=/\*{2}(.+?)\*{2}/gim;return _0x23cfd6=_0x23cfd6[_0x2eff7a(0x356)](_0x524931,_0x2eff7a(0x2f6))[_0x2eff7a(0x356)](_0x20da4c,_0x2eff7a(0x1c2)),_0x23cfd6;}async function validateConfigFile(){const _0x3b7e75=_0x281d12,_0x165a13=dbConfig['get'](_0x3b7e75(0x33a))['sortBy'](_0x3b7e75(0x219))[_0x3b7e75(0x34e)]()||[];if(_0x165a13[_0x3b7e75(0x1fb)]==0x0){let _0x593fd5=0x0,_0x590dff=[];const _0x15a54c=/^bot-([0-9]{3})-config.json$/,_0x23493b=fs['readdirSync'](configpath);_0x23493b[_0x3b7e75(0x21b)](_0x34bfb1=>{const _0x3e2814=_0x3b7e75,_0x509a63=_0x15a54c[_0x3e2814(0x341)](_0x34bfb1);if(_0x509a63){const _0x18a0b1=_0x509a63[0x1];let _0x378623=getBotAttributes(_0x18a0b1);_0x590dff[_0x3e2814(0x2f9)]({'botID':_0x18a0b1,'botname':_0x378623[_0x3e2814(0x34c)],'status':_0x3e2814(0x2dc),'live':_0x3e2814(0x2a8)}),_0x593fd5++;}}),_0x593fd5!=0x0&&(dbConfig['get']('bots')['assign'](_0x590dff)['write'](),config=_0x590dff,restoredConfigFile=_0x593fd5);}}async function restoreConfigNotify(_0x142e01){const _0x84ef5b=_0x281d12;let _0x2ca191;if(restoredConfigFile==0x1)_0x2ca191=_0x84ef5b(0x2bf);else _0x2ca191='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x142e01)io['to']('botmanager')[_0x84ef5b(0x2fb)]('notification',_0x2ca191);else{logger['simple'](_0x84ef5b(0x1ab)),logger[_0x84ef5b(0x310)](_0x2ca191),logger[_0x84ef5b(0x310)]('-----------------------------------------------------------------------------------'),logger[_0x84ef5b(0x310)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x84ef5b(0x261)]!=_0x84ef5b(0x24e))await sendTelegram(settings[_0x84ef5b(0x1b8)],_0x84ef5b(0x14e)+_0x2ca191);}}function decryptRSA(_0x2a1cbc,_0x1938fd){const _0x33c3b6=_0x281d12,_0x5835cf=forge[_0x33c3b6(0x346)]['privateKeyFromPem'](_0x2a1cbc),_0x8dac18=_0x5835cf[_0x33c3b6(0x247)](forge[_0x33c3b6(0x35c)][_0x33c3b6(0x196)](_0x1938fd),_0x33c3b6(0x26f),{'md':forge['md'][_0x33c3b6(0x24b)][_0x33c3b6(0x27c)](),'mgf1':{'md':forge['md']['sha256'][_0x33c3b6(0x27c)]()}});return _0x8dac18;}function validateCredentials(_0x31ba34,_0x1a74f7){const _0x25d1ae=_0x281d12;if(_0x31ba34[_0x25d1ae(0x1ca)]==settings[_0x25d1ae(0x2e5)]&&bcrypt[_0x25d1ae(0x1f4)](_0x31ba34[_0x25d1ae(0x1ed)],settings[_0x25d1ae(0x257)])){if(settings[_0x25d1ae(0x244)])return{'allow':![],'reason':_0x25d1ae(0x2cd),'token':null};else{const _0x56f357=generateLoginToken(_0x1a74f7);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x56f357};}}else return{'allow':![],'reason':_0x25d1ae(0x204),'token':null};}function refreshToken(_0xb329db){const _0x2418c6=_0x281d12,_0x43c786=generateLoginToken(_0xb329db);return{'allow':!![],'reason':_0x2418c6(0x1c8),'token':_0x43c786};}function validateAccess(_0x9810a3,_0xd0ff02,_0x44f76d){const _0x20efe3=_0x281d12,_0x444ed7=_0x44f76d?_0x44f76d:devices[_0xd0ff02]['ip'];let _0x71131d;const _0x26d2c2=_0x549d7c=>{const _0x3e5f14=_0x3323;if(settings['loginRequired']){if(settings[_0x3e5f14(0x244)]){if(telegram2FaApproved(_0xd0ff02)){const _0x2fc3b6=generateLoginToken(_0xd0ff02);return{'allow':!![],'reason':_0x3e5f14(0x162),'token':_0x2fc3b6};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x71131d=validToken(_0x549d7c,_0xd0ff02),_0x71131d[_0x3e5f14(0x301)](_0x3e5f14(0x2a5))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x549d7c}:{'allow':![],'reason':_0x3e5f14(0x28d),'token':null};}else return{'allow':!![],'reason':_0x3e5f14(0x21e),'token':null};};if(settings[_0x20efe3(0x2b5)]){let _0x3e2cbd=[...settings[_0x20efe3(0x289)],_0x20efe3(0x32a),'::ffff:127.0.0.1',_0x20efe3(0x31b),_0x20efe3(0x187)];if(_0x3e2cbd['includes'](_0x444ed7))return _0x26d2c2(_0x9810a3);else{_0x71131d=validToken(_0x9810a3,_0xd0ff02);if(_0x71131d[_0x20efe3(0x301)](_0x20efe3(0x2a5)))return _0x26d2c2(_0x9810a3);else{if(telegramIpApproved(_0xd0ff02)){const _0x583a8b=generateToken(_0xd0ff02);return _0x71131d=_0x26d2c2(_0x9810a3),_0x71131d[_0x20efe3(0x328)]?{'allow':!![],'reason':_0x20efe3(0x2ca),'token':_0x583a8b}:_0x71131d;}else return settings[_0x20efe3(0x185)]?{'allow':![],'reason':_0x20efe3(0x1b7),'token':null}:{'allow':![],'reason':_0x20efe3(0x23b),'token':null};}}}else return _0x26d2c2(_0x9810a3);}function timelyDecrypt(_0x30fb18,_0x3eb3b2,_0x3c0e1c='@'){const _0x50cee7=_0x281d12;if(_0x30fb18)try{const _0x147ddb=decryptRSA(secure[_0x50cee7(0x1d4)],_0x30fb18),_0x10f309=_0x147ddb[_0x50cee7(0x1a0)](_0x3c0e1c)[0x0],_0x3666ef=_0x147ddb[_0x50cee7(0x1a0)](_0x3c0e1c)[0x1],_0x518ea2=new Date()[_0x50cee7(0x223)]();if(_0x3eb3b2){if(_0x518ea2-_0x3666ef<maxSecretAge*0x3e8)return _0x10f309;else return![];}else return _0x10f309;}catch(_0xd0af4a){return![];}else return![];}const validToken=(_0x3262ec,_0x9ae317)=>{const _0x407d3e=_0x281d12,_0x574d2a=devices[_0x9ae317]['ip'];if(!_0x3262ec)return{'error':_0x407d3e(0x357)};for(let _0x289a83 of blacklist){if(_0x289a83[_0x407d3e(0x13f)]==_0x3262ec)return{'error':_0x407d3e(0x1ec)};}let _0x3cf7fd;try{_0x3cf7fd=jwt[_0x407d3e(0x311)](_0x3262ec,secure[_0x407d3e(0x259)]+_0x9ae317);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x3cf7fd[_0x407d3e(0x301)]('clientip')&&!_0x3cf7fd[_0x407d3e(0x301)](_0x407d3e(0x1ca))||!_0x3cf7fd['hasOwnProperty'](_0x407d3e(0x182)))return{'error':_0x407d3e(0x253)};if(!_0x3cf7fd[_0x407d3e(0x301)]('username')&&_0x3cf7fd[_0x407d3e(0x301)]('clientip')){const {clientip:_0x25629b}=_0x3cf7fd;return _0x574d2a==_0x25629b?{'success':_0x407d3e(0x2b8)}:{'error':_0x407d3e(0x27a)};}else{if(_0x3cf7fd[_0x407d3e(0x301)]('username')&&_0x3cf7fd['hasOwnProperty'](_0x407d3e(0x242))){const {username:_0x18423,clientip:_0xe3900d}=_0x3cf7fd;return settings['bbUsername']==_0x18423&&_0x574d2a==_0xe3900d?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x407d3e(0x1d7)};}}},generateLoginToken=_0x13e488=>{const _0x17dc2d=_0x281d12;if(_0x13e488){const _0x252d59=devices[_0x13e488]['ip'];return jwt[_0x17dc2d(0x153)]({'username':settings[_0x17dc2d(0x2e5)],'clientip':_0x252d59},secure['secret']+_0x13e488,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x5b8448=>{const _0x4246f7=_0x281d12;if(_0x5b8448){const _0x1ac337=devices[_0x5b8448]['ip'];return jwt[_0x4246f7(0x153)]({'clientip':_0x1ac337},secure[_0x4246f7(0x259)]+_0x5b8448,{'expiresIn':devices[_0x5b8448][_0x4246f7(0x173)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x231253=>{const _0x21d6ac=_0x281d12;let _0x2f2444=![];return devices[_0x231253][_0x21d6ac(0x173)]&&devices[_0x231253]['telegramIpApproval'][_0x21d6ac(0x1ac)]!=_0x21d6ac(0x2a1)&&(_0x2f2444=devices[_0x231253][_0x21d6ac(0x173)][_0x21d6ac(0x242)]==devices[_0x231253]['ip']&&new Date()[_0x21d6ac(0x223)]()-devices[_0x231253][_0x21d6ac(0x173)]['timestamp']<devices[_0x231253][_0x21d6ac(0x173)][_0x21d6ac(0x1ac)]*0x3c*0x3e8),_0x2f2444;},telegram2FaApproved=_0x346e41=>{const _0x675473=_0x281d12;let _0x417d9e=![];return devices[_0x346e41][_0x675473(0x272)]&&devices[_0x346e41][_0x675473(0x272)][_0x675473(0x1ac)]!='reject'&&(_0x417d9e=devices[_0x346e41][_0x675473(0x272)]['clientip']==devices[_0x346e41]['ip']&&new Date()[_0x675473(0x223)]()-devices[_0x346e41][_0x675473(0x272)][_0x675473(0x1e3)]<devices[_0x346e41][_0x675473(0x272)]['expiry']*0x3c*0x3e8),_0x417d9e;},normalizeIP=_0x2bd5ee=>{const _0x45c5f0=_0x281d12;let _0x50609e=null,_0x4abf6b=null;if(ipaddr[_0x45c5f0(0x217)](_0x2bd5ee)){const _0x449c26=ipaddr['parse'](_0x2bd5ee);_0x449c26[_0x45c5f0(0x1fc)]()==='ipv6'?(_0x449c26[_0x45c5f0(0x1ea)]()&&(_0x50609e=_0x449c26['toIPv4Address']()[_0x45c5f0(0x145)]()),_0x4abf6b=_0x449c26[_0x45c5f0(0x145)]()):(_0x50609e=_0x449c26[_0x45c5f0(0x145)](),_0x4abf6b=_0x449c26[_0x45c5f0(0x33f)]()[_0x45c5f0(0x145)]());}return{'show':_0x50609e?_0x50609e:_0x4abf6b,'store':_0x4abf6b};};function formatDate(_0x3eca7c){const _0x366dd5=_0x281d12;return _0x3eca7c['getFullYear']()+'/'+(_0x3eca7c['getMonth']()+0x1)[_0x366dd5(0x145)]()[_0x366dd5(0x20f)](0x2,'0')+'/'+_0x3eca7c['getDate']()[_0x366dd5(0x145)]()[_0x366dd5(0x20f)](0x2,'0')+'\x20'+_0x3eca7c['getHours']()[_0x366dd5(0x145)]()[_0x366dd5(0x20f)](0x2,'0')+':'+_0x3eca7c[_0x366dd5(0x2d8)]()[_0x366dd5(0x145)]()[_0x366dd5(0x20f)](0x2,'0')+':'+_0x3eca7c['getSeconds']()['toString']()[_0x366dd5(0x20f)](0x2,'0');}function _0x3323(_0xfe3e84,_0x4258aa){const _0x438f73=_0x3e04();return _0x3323=function(_0x42d64d,_0x49f109){_0x42d64d=_0x42d64d-0x13d;let _0x3e041d=_0x438f73[_0x42d64d];return _0x3e041d;},_0x3323(_0xfe3e84,_0x4258aa);}function sleep(_0x6b0a71){return new Promise(_0x3d6a72=>setTimeout(_0x3d6a72,_0x6b0a71));}