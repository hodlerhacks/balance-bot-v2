const _0x53b0a9=_0x1653;(function(_0x2a6c25,_0x3126f7){const _0x17f976=_0x1653,_0x143f81=_0x2a6c25();while(!![]){try{const _0x3bbeba=-parseInt(_0x17f976(0x246))/0x1+parseInt(_0x17f976(0x2a5))/0x2*(parseInt(_0x17f976(0x331))/0x3)+parseInt(_0x17f976(0x177))/0x4+-parseInt(_0x17f976(0x2aa))/0x5*(-parseInt(_0x17f976(0x313))/0x6)+-parseInt(_0x17f976(0x2e5))/0x7+-parseInt(_0x17f976(0x296))/0x8+parseInt(_0x17f976(0x31a))/0x9;if(_0x3bbeba===_0x3126f7)break;else _0x143f81['push'](_0x143f81['shift']());}catch(_0x3dee55){_0x143f81['push'](_0x143f81['shift']());}}}(_0x273c,0x7beb3));const _0x4e8d74=function(){let _0x13e402=!![];return function(_0x33b73f,_0x2645d4){const _0x51472c=_0x13e402?function(){if(_0x2645d4){const _0x22484f=_0x2645d4['apply'](_0x33b73f,arguments);return _0x2645d4=null,_0x22484f;}}:function(){};return _0x13e402=![],_0x51472c;};}(),_0x278818=_0x4e8d74(this,function(){const _0xdef0c5=_0x1653;return _0x278818['toString']()[_0xdef0c5(0x19d)](_0xdef0c5(0x18c))[_0xdef0c5(0x198)]()[_0xdef0c5(0x2bd)](_0x278818)[_0xdef0c5(0x19d)](_0xdef0c5(0x18c));});_0x278818();'use strict';process[_0x53b0a9(0x2e2)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x53b0a9(0x243)),fs=require('fs'),fns=require('date-fns'),low=require(_0x53b0a9(0x1cb)),FileSync=require(_0x53b0a9(0x1e2)),path=require(_0x53b0a9(0x2a2)),crypto=require(_0x53b0a9(0x1b5)),forge=require(_0x53b0a9(0x179)),bcrypt=require('bcryptjs'),jwt=require(_0x53b0a9(0x19c)),ipaddr=require('ipaddr.js'),argv=require(_0x53b0a9(0x2b5))(process[_0x53b0a9(0x327)][_0x53b0a9(0x140)](0x2))[_0x53b0a9(0x327)],uuidRandom=require(_0x53b0a9(0x1dd)),{Telegraf,Markup}=require(_0x53b0a9(0x21c)),Mixpanel=require(_0x53b0a9(0x28e)),axios=require(_0x53b0a9(0x145)),{GraphQLClient,gql}=require(_0x53b0a9(0x31d)),util=require(_0x53b0a9(0x2de)),fileUpload=require(_0x53b0a9(0x131)),{networkInterfaces}=require('os'),JSZip=require(_0x53b0a9(0x239)),PORT=argv[_0x53b0a9(0x16c)]||'3000',pattern=/^[0-9]{2,4}$/;!pattern[_0x53b0a9(0x1a1)](PORT)&&(console[_0x53b0a9(0x31f)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x53b0a9(0x129)),process[_0x53b0a9(0x139)](0x1));const HOST=argv[_0x53b0a9(0x32d)]||null,userID=argv[_0x53b0a9(0x314)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x53b0a9(0x297)][_0x53b0a9(0x1b6)];let bbpath='bb/',bbpath2='';const botfile=_0x53b0a9(0x30c),configfile='bb-config.json',settingsfile='bb-settings.json',securefile='bb-secure.json',environment=require('./'+bbpath2+'version.json')[_0x53b0a9(0x267)]||_0x53b0a9(0x192),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x53b0a9(0x12f)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x53b0a9(0x19a)),configpath=userID?bbpath+_0x53b0a9(0x236)+userID+'/':bbpath+'config/',configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x53b0a9(0x293)+userID+'/':bbpath+_0x53b0a9(0x293),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x53b0a9(0x306),loggerfile=fs[_0x53b0a9(0x1f5)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+'temp/';!fs[_0x53b0a9(0x12f)](configpath)&&fs[_0x53b0a9(0x28b)](configpath);!fs[_0x53b0a9(0x12f)](configbackuppath)&&fs[_0x53b0a9(0x28b)](configbackuppath);!fs[_0x53b0a9(0x12f)](logspath)&&fs[_0x53b0a9(0x28b)](logspath);!fs[_0x53b0a9(0x12f)](zippath)&&fs[_0x53b0a9(0x28b)](zippath);!fs[_0x53b0a9(0x12f)](temppath)&&fs[_0x53b0a9(0x28b)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);function _0x273c(){const _0x1da10e=['rsa','alias','headless','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','get-logs','password','join','Notifications\x20disabled\x0a','disabled','environment','whitelistEnabled','Invalid\x20IP\x20address','enable','editMessageReplyMarkup','size','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','metrics','telegramEnabled','yes','address\x20already\x20in\x20use','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','restore_no_','telegramUsername','chat','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Alerts','create','\x20|\x20','settings','Allow\x20login\x20from\x20IP\x20address\x20','Your\x20installation\x20is\x20already\x20up\x20to\x20date','f2aRequired','store-headless','cloneDeep','toIPv4Address','token','unlinkSync','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot',':\x20Bot\x20Mgr\x20>\x20','new-disabled','SIGTERM','running','type','value','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','mkdirSync','/metrics\x20-\x20show\x20bot\x20performance\x0a','logout','mixpanel','getUTCHours','private','ipv6','Restore\x20process\x20aborted','logs/','Notifications\x20types:\x20','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','1013960DaUdul','versions','launch','#RES#\x20if\x20running\x20locally\x0a','sendPortfolioTelegram','help','output-000.log','Yes','Unauthorized\x20attempt\x20to\x20delete\x20alerts','inherit','config_all','temporary\x20access\x20not\x20allowed','path','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','binary','205002TilLPr','_nsps','update_no','Starting\x20Balance\x20Bot\x20reinstallation','data','2066060KDSHEW','assign',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','emitHistory','text','connection','mode','filter','Enabled\x20Bot\x20','post','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','yargs/yargs','tkn','Password\x20reset\x20rejected','logs','defaults','success','\x20>\x20','range','constructor','backup-full.zip','access','/restart\x20-\x20restart\x20bot(s)\x0a','.zip','\x20only\x0a','action','blacklist','storeHeadless','Notifications\x20enabled\x0a','Unauthorized\x20attempt\x20to\x20confirm\x20message','randomBytes','off','/on\x20-\x20start\x20bot(s)\x0a','send','length','catch','socket','bot-','Starting\x20Balance\x20Bot\x20update','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','add-bot','Temporary\x20access\x20rejected','secret','Markdown','config_alerts','kind','Error\x20removing\x20old\x20backup\x20files:','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','\x1b[36m','auto','readdirSync','util','connected','*$1*','\x20-\x20','env','sortBy','getDate','3547082ZUKpYs','pidRefreshToken','toggle_','store-settings','botID','temporary\x20access\x20timeout','conn','Restarting\x20Bot\x20','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','status','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','api-eu.mixpanel.com','login','Logged\x20out\x20user\x20...','RSA-OAEP','hasOwnProperty','getHours','-----------------------------------------------------------------------------------','get-portfolio','output-001.log','ETH','/enable\x20-\x20enable\x20notifications\x0a','set','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','apiPassword','30\x20min','whitelist','write','sendMessage','files','bb-settings.json','Unauthorized\x20attempt\x20to\x20update\x20settings','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','zip/','get-starting-balances','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','reinstall_yes','bb-secure.json','live','bot.js','(staging)','access\x20timeout','login2fa_','file','version','6b67f3d61ee94b8f5c80b4affef4c4d9','6wsfxFJ','user','telegramEvents','names','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','/logs\x20-\x20receive\x20log\x20files\x0a','Bot\x20','9053289dBMSJH','get-messages','telegramToken','graphql-request','store','log','logged\x20out','backup','bbPassword','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','new','#RES#\x20','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','argv','showConfig','resetHistory','Login\x20accepted','lastmsgemitted','getMinutes','host','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','pki','/:bot','9xseaVL','exp','add','publicKey','update-bb','split','enabled','apiSecret','\x20files\x20over\x20Telegram:','/:bot/history','loginRequired','update','-events.json','username',',\x20must\x20be\x20a\x204\x20digit\x20number','address','User\x20has\x20been\x20validated','portfolio','1000','emit','existsSync','async','express-fileupload','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','close','backupfile','sendMetricsTelegram','stop','botname','removeAllListeners','exit','\x1b[31m','debug','::1','5\x20min','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','push','slice','find','login\x20token\x20valid','messages','from','axios','once','orders','publicKeyToPem','/:bot/performance','reply','exec','staging','sendFile','backup-files','manual','Invalid\x20authentication\x20token\x20(2)','lastmsgtelegram','static','portfolio_','output-002.log','remoteAddress','callback','settings.','\x1b[35m','--------------------------------------','generateKeyPair','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','Session\x20expired\x20for\x20user\x20...','isDirectory','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','2FA\x20login\x20required','telegram2FaApproval','stopped','0.0.0','Unauthorized\x20attempt\x20to\x20update\x20bot','loadAsync','Network\x20Interfaces:','updatebotmanager','Disabled\x20Bot\x20','version.json','Unauthorized\x20attempt\x20to\x20get\x20messages','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','format','port','bbvNew','userid','index.html','Unauthorized\x20attempt\x20to\x20store\x20configuration','***','bots','timeshift','encryptedUuid','-config.json','showname','89488hXcsiM','function','node-forge','headers','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','temporary\x20access\x20rejected','store-fiat','writeFileSync','full','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Error\x20while\x20deleting\x20config\x20files:\x20','Token\x20blacklisted','store-configuration','::ffff:127.0.0.1','getTime','Restore\x20process\x20confirmed','reinstall','\x1b[34m','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','/off\x20-\x20stop\x20bot(s)\x0a','entries','(((.+)+)+)+$','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','fork','File\x20uploaded','SIGINT','place-order','production','alerts','pidExpireLogin','DEFLATE','telegramChatId','use','toString','get-backup-files','clients','Server','jsonwebtoken','search','name','on_','Access\x20enabled\x20for\x20','test','All\x20bots\x20running\x20right\x20now','any','invalid\x20credentials','-results.json','Backup\x20file\x20unzipped\x20and\x20stored','started','notification','Notifications\x20disabled','telegramIpApproval','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','initclient','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','mtime','IPv4','getFullYear','inlineKeyboard','/disable\x20-\x20disable\x20notifications\x0a','toggle-bot-mode','Error\x20details:','crypto','node','build','secure','download','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Failed\x20to\x20download\x20','backup-full','/download/:type','/update\x20-\x20update\x20Balance\x20Bot\x0a','marketcapApi','latestversion','HTML','metrics_','/:bot/coins','storeConfiguration','getMonth','server','isValid','/help\x20-\x20show\x20available\x20commands\x0a','Node.js\x20v','button','lowdb','reject','restore_yes_','Unauthorized\x20login\x20attempt\x20(timeout)','endsWith','event','<b>Telegram\x20Bot\x20Status:</b>\x0a','simple','You\x20can\x20use\x20the\x20following\x20commands:\x0a','build2','Running\x20#RED#Balance\x20Bot\x20v','sign','telegram','bbvReceive','clientip','login\x20not\x20required','map','\x20to\x20','uuid-random','decode64','hashSync','parse','2FA\x20login\x20token\x20generated','lowdb/adapters/FileSync','No\x20bots\x20running\x20right\x20now','sha256','getSeconds','verify','Backup\x20file\x20uploaded','then','botmanager','allow','Unauthorized\x20attempt\x20to\x20show\x20configuration','disable','get','handshake','/:bot/configuration','message','resetpw_no','includes','toggle','family','createWriteStream','placeOrder','config_orders','Password\x20has\x20been\x20reset\x20to:\x20','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','$1_$2_$3','reinstall-bb','rmSync','backup-full@','init','login\x20required','params','\x1b[33m','getStartingBalances','Telegraf\x20error:',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Starting\x20#RED#Balance\x20Bot\x20v','apiKey','disconnect','max','listen',')\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20delete\x20bot','bbUsername','http','keys','track','kill','padStart','match','/names\x20-\x20show\x20bot\x20names\x0a','confirm-message','2FA\x20required','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','replyWithDocument','referer','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','telegraf','toIPv4MappedAddress','timestamp','stringify','Restore\x20backup\x20file\x20','reason','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','startsWith','expiry','cancelLoading','storeFiat','[ip-address]','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','login\x20token\x20generated','127.0.0.1',')\x20\x20\x20|\x20Bot\x20','getPortfolio','\x20minutes','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','temporary\x20token\x20generated','copyFileSync','\x20mode','isIPv4MappedAddress','\x20|\x20client:\x20...','all','config/','compareSync','telegrammsg','jszip','Ok,\x20will\x20send\x20order\x20notifications\x20only','statSync','toggleBotMode','All\x20bots','auth','command','sockets','generateAsync','reload','child_process','socket.io','reset-history','607966MMdDff','************','/start','Starting\x20new\x20bot\x20|\x20Bot\x20','-performance.json','Invalid\x20authentication\x20token\x20(1)','min','readFileSync','error','remove','bot','sort','uuid','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','Unauthorized\x20attempt\x20to\x20log\x20out','restart','Ok,\x20will\x20send\x20alert\x20notifications\x20only','replace','privateKey','off_','number','forEach'];_0x273c=function(){return _0x1da10e;};return _0x273c();}dbConfig['defaults']({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x53b0a9(0x2b9)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x53b0a9(0x162),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x53b0a9(0x2b9)]({'secure':{},'blacklist':[]})[_0x53b0a9(0x300)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x53b0a9(0x1fe)](_0x53b0a9(0x312),{'host':_0x53b0a9(0x2f0)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x53b0a9(0x31c)]&&(settings['telegramToken']!=''&&settings[_0x53b0a9(0x31c)]!=_0x53b0a9(0x171))&&settings['telegramUsername']&&settings[_0x53b0a9(0x274)]!='')initTelegram();const parseColor=(_0x30c3bf,_0x2b85a2)=>{const _0x23f557=_0x53b0a9,_0x26ef08=/#[A-Z]{3}#/g;if(typeof _0x30c3bf=='string'){!_0x2b85a2?_0x30c3bf=_0x30c3bf['replace'](_0x26ef08,''):(_0x30c3bf=_0x30c3bf[_0x23f557(0x257)](/#BLU#/g,_0x23f557(0x188)),_0x30c3bf=_0x30c3bf[_0x23f557(0x257)](/#RED#/g,_0x23f557(0x13a)),_0x30c3bf=_0x30c3bf[_0x23f557(0x257)](/#YEL#/g,_0x23f557(0x201)),_0x30c3bf=_0x30c3bf[_0x23f557(0x257)](/#MAG#/g,_0x23f557(0x158)),_0x30c3bf=_0x30c3bf[_0x23f557(0x257)](/#CYA#/g,_0x23f557(0x2db)),_0x30c3bf=_0x30c3bf[_0x23f557(0x257)](/#RES#/g,'\x1b[0m'));;}return _0x30c3bf;},logger={'screen':_0x1700ae=>{console['log'](parseColor(_0x1700ae,!![]));},'simple':_0x45d948=>{const _0x138870=_0x53b0a9;console[_0x138870(0x31f)](parseColor(_0x45d948,!![])),loggerfile[_0x138870(0x300)](util[_0x138870(0x16b)](parseColor(_0x45d948,![]))+'\x0a');},'full':async _0x4b10b7=>{const _0x57eafc=_0x53b0a9,_0x14aba3=getTimeStamp()+_0x57eafc(0x284)+_0x4b10b7;console[_0x57eafc(0x31f)](parseColor(_0x14aba3,!![])),loggerfile['write'](util[_0x57eafc(0x16b)](parseColor(_0x14aba3,![]))+'\x0a');if(tgBot&&settings[_0x57eafc(0x196)]&&settings[_0x57eafc(0x315)]!=_0x57eafc(0x147))await sendTelegram(settings[_0x57eafc(0x196)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x4b10b7,![]));},'debug':async(_0x300dce,_0x121940='')=>{const _0x43b303=_0x53b0a9,_0x407d15=getTimeStamp()+_0x43b303(0x204)+_0x300dce;if(debugging)console['log'](parseColor(_0x407d15,!![]));loggerfile[_0x43b303(0x300)](util[_0x43b303(0x16b)](parseColor(_0x407d15,![]))+'\x0a');if(_0x121940){if(debugging)console[_0x43b303(0x31f)](_0x121940);loggerfile[_0x43b303(0x300)](util[_0x43b303(0x16b)](_0x121940)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x16d157){const _0x47f749=_0x53b0a9;_0x16d157[_0x47f749(0x198)]()[_0x47f749(0x1f2)](_0x47f749(0x271))?(logger[_0x47f749(0x1d2)](_0x47f749(0x228)+_0x16d157['port']+'#RES#'),process[_0x47f749(0x2cb)]({'terminate':!![]},_0x42a219=>{})):logger[_0x47f749(0x1d2)](_0x16d157);}),process['on']('exit',()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGTERM',()=>{const _0x19721f=_0x53b0a9;stopAllBots(),process[_0x19721f(0x139)](0x0);}),process['on']('SIGINT',()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x53b0a9(0x168))[_0x53b0a9(0x311)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x53b0a9(0x20e))['createServer'](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x53b0a9(0x1ed)](_0x53b0a9(0x1bd),async(_0x4c8fca,_0xbb9ab3)=>{const _0x4c25b2=_0x53b0a9,_0x1362ed=_0x4c8fca[_0x4c25b2(0x200)][_0x4c25b2(0x288)],_0x4381d6=getClientsWithBotID(_0x4c25b2(0x1e9)),_0x502720=_0x4c8fca[_0x4c25b2(0x17a)][_0x4c25b2(0x252)],_0x2fb2cf=timelyDecrypt(_0x502720,![]),_0x26c874=_0x4381d6[_0x4c25b2(0x141)](_0x1f25a1=>_0x1f25a1[_0x4c25b2(0x252)]==_0x2fb2cf);if(_0x26c874){const _0x1ae8f3=normalizeIP(_0x4c8fca[_0x4c25b2(0x2ce)][_0x4c25b2(0x155)])[_0x4c25b2(0x31e)],_0x3e34b4=_0x4c8fca[_0x4c25b2(0x17a)][_0x4c25b2(0x2b6)];if(validateAccess(_0x3e34b4,_0x2fb2cf,_0x1ae8f3)['allow'])_0x1362ed==_0x4c25b2(0x321)&&await backupConfigFiles(),await zipFiles(_0x1362ed),_0xbb9ab3[_0x4c25b2(0x1b9)](zippath+(_0x1362ed+'.zip'),_0x38526d=>{const _0x36f984=_0x4c25b2;_0x38526d&&(logger[_0x36f984(0x17f)](_0x36f984(0x1bb)+_0x1362ed),logger[_0x36f984(0x1d2)](_0x38526d));});else logger[_0x4c25b2(0x17f)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x1362ed+'\x20(1)');}else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x1362ed+'\x20(2)');}),app[_0x53b0a9(0x2b3)]('/upload-backup',async(_0x39ada1,_0x5a6e93)=>{const _0x4b898d=_0x53b0a9,_0x2c111e=getClientsWithBotID(_0x4b898d(0x1e9)),_0x3c4172=_0x39ada1[_0x4b898d(0x17a)][_0x4b898d(0x252)],_0x283c27=timelyDecrypt(_0x3c4172,![]),_0x45dc40=_0x2c111e[_0x4b898d(0x141)](_0x1a1dbb=>_0x1a1dbb[_0x4b898d(0x252)]==_0x283c27);logger['debug'](_0x4b898d(0x1e7));if(_0x45dc40){const _0xe40eb8=normalizeIP(_0x39ada1[_0x4b898d(0x2ce)][_0x4b898d(0x155)])[_0x4b898d(0x31e)],_0x482d11=_0x39ada1['headers']['tkn'];if(validateAccess(_0x482d11,_0x283c27,_0xe40eb8)[_0x4b898d(0x1ea)]){if(_0x39ada1[_0x4b898d(0x302)]){const _0x157443=_0x39ada1[_0x4b898d(0x302)][_0x4b898d(0x134)];await _0x157443['mv'](temppath+_0x157443[_0x4b898d(0x19e)]),_0x5a6e93[_0x4b898d(0x2cb)]({'status':!![],'message':_0x4b898d(0x18f)});const _0x21176d=getBotsWithMode();_0x21176d[_0x4b898d(0x2cc)]>0x0?confirmRestore(temppath,_0x157443[_0x4b898d(0x19e)]):unzipFile(temppath,_0x157443[_0x4b898d(0x19e)]);}}else logger['full'](_0x4b898d(0x16a));}else logger[_0x4b898d(0x17f)](_0x4b898d(0x18d));}),app[_0x53b0a9(0x197)](express[_0x53b0a9(0x152)](path['join'](__dirname,bbpath2,_0x53b0a9(0x1d4)))),app[_0x53b0a9(0x197)](express[_0x53b0a9(0x152)](path['join'](__dirname,bbpath2,_0x53b0a9(0x1b7)))),app[_0x53b0a9(0x1ed)]('/',function(_0x17dc11,_0x4c3318){const _0x40de78=_0x53b0a9;_0x4c3318[_0x40de78(0x14d)](path[_0x40de78(0x264)](__dirname,bbpath2,_0x40de78(0x1d4),_0x40de78(0x16f)));}),app[_0x53b0a9(0x1ed)](_0x53b0a9(0x330),function(_0x143d56,_0x39365f){const _0x327316=_0x53b0a9;_0x39365f['sendFile'](path[_0x327316(0x264)](__dirname,bbpath2,_0x327316(0x1b7),_0x327316(0x16f)));}),app[_0x53b0a9(0x1ed)]('/:bot/portfolio',(_0xd5195a,_0x14d779)=>{const _0x50d90f=_0x53b0a9;_0x14d779[_0x50d90f(0x14d)](path[_0x50d90f(0x264)](__dirname,bbpath2,_0x50d90f(0x1b7),_0x50d90f(0x16f)));}),app[_0x53b0a9(0x1ed)](_0x53b0a9(0x149),(_0x1eba91,_0x5207ef)=>{const _0x1af675=_0x53b0a9;_0x5207ef[_0x1af675(0x14d)](path['join'](__dirname,bbpath2,_0x1af675(0x1b7),'index.html'));}),app[_0x53b0a9(0x1ed)](_0x53b0a9(0x1c3),(_0x2febb1,_0x39dc72)=>{const _0x448eb3=_0x53b0a9;_0x39dc72[_0x448eb3(0x14d)](path[_0x448eb3(0x264)](__dirname,bbpath2,_0x448eb3(0x1b7),_0x448eb3(0x16f)));}),app[_0x53b0a9(0x1ed)](_0x53b0a9(0x124),(_0x3616ce,_0x45436c)=>{const _0x32d28e=_0x53b0a9;_0x45436c[_0x32d28e(0x14d)](path[_0x32d28e(0x264)](__dirname,bbpath2,_0x32d28e(0x1b7),_0x32d28e(0x16f)));}),app[_0x53b0a9(0x1ed)](_0x53b0a9(0x1ef),(_0x553bfe,_0x3edfb2)=>{const _0x15e85b=_0x53b0a9;_0x3edfb2['sendFile'](path[_0x15e85b(0x264)](__dirname,bbpath2,_0x15e85b(0x1b7),'index.html'));}),app['get']('/:bot/support',(_0x33999b,_0x23286d)=>{const _0x57a305=_0x53b0a9;_0x23286d['sendFile'](path[_0x57a305(0x264)](__dirname,bbpath2,_0x57a305(0x1b7),'index.html'));});if(HOST)http[_0x53b0a9(0x20a)](PORT,HOST);else http[_0x53b0a9(0x20a)](PORT);const io=require(_0x53b0a9(0x244))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x5d5cb9=_0x53b0a9;let _0x28651c=_0x5d5cb9(0x227);const _0x1cfb2f=networkInterfaces(),_0x39e5ee={};for(const _0x85eb0 of Object['keys'](_0x1cfb2f)){for(const _0x26608c of _0x1cfb2f[_0x85eb0]){if((_0x26608c[_0x5d5cb9(0x1f4)]==_0x5d5cb9(0x1af)||_0x26608c[_0x5d5cb9(0x1f4)]==0x4)&&!_0x26608c['internal']){const _0x1bf3cd=ipaddr['parse'](_0x26608c[_0x5d5cb9(0x12a)])[_0x5d5cb9(0x2bc)]();_0x1bf3cd!=_0x5d5cb9(0x290)&&(!_0x39e5ee[_0x85eb0]&&(_0x39e5ee[_0x85eb0]=[]),_0x39e5ee[_0x85eb0][_0x5d5cb9(0x13f)](_0x26608c[_0x5d5cb9(0x12a)]),_0x28651c=_0x26608c['address']);}}}return{'serverip':_0x28651c,'netinterfaces':_0x39e5ee};}async function startServer(){const _0xc40e0e=_0x53b0a9,{serverip:_0x1c57cd,netinterfaces:_0x47aead}=getServerIP();logger[_0xc40e0e(0x1d2)](''),logger['simple'](_0xc40e0e(0x2f6)),await logger['full'](_0xc40e0e(0x206)+serverversion+'#RES#\x20'+(environment==_0xc40e0e(0x14c)?_0xc40e0e(0x30d):'')+'\x0a'+(_0xc40e0e(0x1ad)+PORT+_0xc40e0e(0x299))+('=>\x20Go\x20to\x20#CYA#http://'+_0x1c57cd+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger[_0xc40e0e(0x1d2)](_0xc40e0e(0x2f6));if(config[_0xc40e0e(0x2cc)]!=0x0)for(const _0x2a2cc1 of config){const _0x507142=_0x2a2cc1[_0xc40e0e(0x2b0)]==_0xc40e0e(0x2dc)?'a':'m';if(_0x2a2cc1[_0xc40e0e(0x2ee)]=='enabled'||_0x2a2cc1[_0xc40e0e(0x2ee)]==_0xc40e0e(0x324))await logger[_0xc40e0e(0x17f)]('Starting\x20('+_0x507142+_0xc40e0e(0x20b)+_0x2a2cc1[_0xc40e0e(0x2e9)]+_0xc40e0e(0x279)+_0x2a2cc1[_0xc40e0e(0x137)]),startBot([_0x2a2cc1['botID'],userID],{'cwd':bbpath},function(_0x1dfd5a){const _0x47d556=_0xc40e0e;if(_0x1dfd5a)logger[_0x47d556(0x17f)](_0x1dfd5a);});else(_0x2a2cc1[_0xc40e0e(0x2ee)]=='disabled'||_0x2a2cc1[_0xc40e0e(0x2ee)]==_0xc40e0e(0x285))&&await logger[_0xc40e0e(0x17f)]('Idling\x20('+_0x507142+_0xc40e0e(0x22c)+_0x2a2cc1[_0xc40e0e(0x2e9)]+_0xc40e0e(0x279)+_0x2a2cc1[_0xc40e0e(0x137)]);}else!newBot&&logger['simple'](_0xc40e0e(0x2ed));if(newBot)addBot();logger[_0xc40e0e(0x1d2)]('-----------------------------------------------------------------------------------'),logger['simple'](''),await logger['debug'](_0xc40e0e(0x1c9)+nodeversion),await logger[_0xc40e0e(0x13b)](_0xc40e0e(0x165),_0x47aead);}function startSocket(){const _0x4ea33e=_0x53b0a9;io['on'](_0x4ea33e(0x2af),_0x1d7da9=>{const _0x57c0ef=_0x4ea33e;let _0x377ee8,_0x4c4f6b,_0x574042,_0x383a54,_0x52fdeb;const _0x54a09e=_0x1d7da9[_0x57c0ef(0x1ee)]['headers'][_0x57c0ef(0x219)];_0x4c4f6b=_0x54a09e['match'](/bot[0-9]{3}/);if(_0x4c4f6b)_0x574042=_0x4c4f6b[0x0][_0x57c0ef(0x213)](/[0-9]{3}/);if(_0x574042)_0x377ee8=_0x574042[0x0];else _0x377ee8=_0x57c0ef(0x1e9);const _0x427977=_0x1d7da9[_0x57c0ef(0x1ee)][_0x57c0ef(0x23e)][_0x57c0ef(0x174)];if(!_0x427977)_0x1d7da9['emit']('status',{'publicKey':secure[_0x57c0ef(0x334)]});else{_0x383a54=timelyDecrypt(_0x427977,![]);if(!_0x383a54)_0x1d7da9[_0x57c0ef(0x12e)](_0x57c0ef(0x2ee),{'publicKey':secure[_0x57c0ef(0x334)]});else{_0x52fdeb=normalizeIP(_0x1d7da9[_0x57c0ef(0x2eb)][_0x57c0ef(0x155)])[_0x57c0ef(0x31e)];if(!devices[_0x383a54])devices[_0x383a54]={'uuid':_0x383a54,'access':{'token':null}};devices[_0x383a54]['ip']=_0x52fdeb;const _0x121c67=addClient(_0x1d7da9['id'],_0x383a54,_0x377ee8);setAccess(_0x121c67),emitMessages(),_0x1d7da9['on']('login',_0x41f5a0=>{const _0x1564e7=_0x57c0ef,_0x36a49c=timelyDecrypt(_0x41f5a0[_0x1564e7(0x263)],!![],'|@|');if(_0x36a49c){_0x41f5a0={'username':_0x41f5a0[_0x1564e7(0x128)],'password':_0x36a49c},devices[_0x383a54][_0x1564e7(0x2bf)]=validateCredentials(_0x41f5a0,_0x383a54);if(devices[_0x383a54][_0x1564e7(0x2bf)][_0x1564e7(0x1ea)]==![]&&devices[_0x383a54][_0x1564e7(0x2bf)]['reason']==_0x1564e7(0x15f))_0x1d7da9[_0x1564e7(0x12e)](_0x1564e7(0x2ee),{'access':devices[_0x383a54][_0x1564e7(0x2bf)]}),loginAccess2FA(_0x383a54,_0x52fdeb);else{if(devices[_0x383a54][_0x1564e7(0x2bf)][_0x1564e7(0x1ea)]==![]&&devices[_0x383a54][_0x1564e7(0x2bf)][_0x1564e7(0x221)]==_0x1564e7(0x1a4))_0x1d7da9[_0x1564e7(0x12e)](_0x1564e7(0x2ee),{'access':devices[_0x383a54][_0x1564e7(0x2bf)]});else devices[_0x383a54][_0x1564e7(0x2bf)]['allow']&&devices[_0x383a54][_0x1564e7(0x2bf)][_0x1564e7(0x221)]==_0x1564e7(0x22a)&&(getClientsWithUuid(_0x383a54)[_0x1564e7(0x25b)](_0x43b243=>{setAccess(_0x43b243);}),logger[_0x1564e7(0x13b)]('Logged\x20in\x20user\x20...'+_0x383a54[_0x1564e7(0x140)](-0x8)),setTokenRefresh(_0x383a54),setSessionTimeout('login',_0x383a54));}}else logger[_0x1564e7(0x17f)](_0x1564e7(0x1ce));}),_0x1d7da9['on']('reset-password',()=>{resetPassword();}),_0x1d7da9['on']('disconnect',_0xa6a456=>{removeClient(_0x1d7da9['id']);}),_0x377ee8==_0x57c0ef(0x1e9)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x46975c){const _0x26f27e=_0x53b0a9;if(_0x46975c!=_0x26f27e(0x1e9)&&config[_0x26f27e(0x207)]!=''){if(pid[_0x46975c])pid[_0x46975c][_0x26f27e(0x2cb)]({'function':_0x26f27e(0x1ac),'args':null});}_0x46975c!='botmanager'&&broadcastToBots(_0x26f27e(0x172),JSON[_0x26f27e(0x21f)](config));}function reloadBotManager(){getClientsWithBotID('botmanager')['forEach'](_0x3f269c=>{const _0x406b8e=_0x1653;getSocket(_0x3f269c['id'])[_0x406b8e(0x12e)]('status',{'access':{'allow':![],'reason':_0x406b8e(0x242),'token':null}});});}function getSocket(_0x5a493f){const _0x5b7e05=_0x53b0a9,_0x4cf5fb=io[_0x5b7e05(0x2a6)][_0x5b7e05(0x1ed)]('/');return _0x4cf5fb[_0x5b7e05(0x240)][_0x5b7e05(0x1ed)](_0x5a493f);}function setAccess(_0xb278e2){const _0x3aa800=_0x53b0a9,_0x39ab54=getSocket(_0xb278e2['id']),_0x4d814e=_0xb278e2[_0x3aa800(0x252)],_0x3bdcbc=_0xb278e2['bot'];devices[_0x4d814e][_0x3aa800(0x2bf)]=validateAccess(devices[_0x4d814e][_0x3aa800(0x2bf)]['token'],_0x4d814e),logger[_0x3aa800(0x13b)]('Setting\x20access:\x20'+devices[_0x4d814e][_0x3aa800(0x2bf)][_0x3aa800(0x221)]+_0x3aa800(0x234)+_0xb278e2['id']['slice'](-0x8)+'\x20|\x20user:\x20...'+_0x4d814e['slice'](-0x8)),_0x39ab54[_0x3aa800(0x264)](_0x4d814e);if(devices[_0x4d814e][_0x3aa800(0x2bf)][_0x3aa800(0x1ea)]){_0x39ab54[_0x3aa800(0x264)](_0x3bdcbc);if(_0x3bdcbc=='botmanager')initializeSocketBotManager(_0x39ab54);else initializeSocketBot(_0x39ab54);initClient(_0x3bdcbc);}devices[_0x4d814e][_0x3aa800(0x2bf)][_0x3aa800(0x281)]&&devices[_0x4d814e]['access'][_0x3aa800(0x221)]=='temporary\x20token\x20generated'&&setSessionTimeout('2FA',_0x4d814e),devices[_0x4d814e][_0x3aa800(0x2bf)][_0x3aa800(0x281)]&&devices[_0x4d814e]['access'][_0x3aa800(0x221)]==_0x3aa800(0x1e1)&&setSessionTimeout(_0x3aa800(0x2f1),_0x4d814e),_0x39ab54['emit'](_0x3aa800(0x2ee),{'status':_0xb278e2[_0x3aa800(0x1c6)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4d814e][_0x3aa800(0x2bf)],'externalip':devices[_0x4d814e]['ip'],'publicKey':secure[_0x3aa800(0x334)],'userid':settings[_0x3aa800(0x16e)],'validInstallation':validInstallation}),devices[_0x4d814e][_0x3aa800(0x2bf)][_0x3aa800(0x1ea)]==![]&&devices[_0x4d814e][_0x3aa800(0x2bf)]['reason']==_0x3aa800(0x216)&&temporaryAccess2FA(_0x4d814e,devices[_0x4d814e]['ip']);}function setSessionTimeout(_0x220abb,_0x1a2641){const _0x5e718f=_0x53b0a9;let _0xddff4e;if(_0x220abb==_0x5e718f(0x2f1))_0xddff4e=loginExpiry*0x3c*0x3e8;else _0xddff4e=devices[_0x1a2641][_0x5e718f(0x1aa)][_0x5e718f(0x224)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x1a2641][_0x5e718f(0x1aa)][_0x5e718f(0x21e)]);if(devices[_0x1a2641]['pidExpireLogin'])clearTimeout(devices[_0x1a2641][_0x5e718f(0x194)]);devices[_0x1a2641][_0x5e718f(0x194)]=setTimeout(()=>{const _0x29fe45=_0x5e718f;if(devices[_0x1a2641][_0x29fe45(0x2e6)])clearTimeout(devices[_0x1a2641]['pidRefreshToken']);removeSocketListeners(_0x1a2641),addBlacklist(_0x1a2641),devices[_0x1a2641][_0x29fe45(0x1aa)]=null,devices[_0x1a2641][_0x29fe45(0x160)]=null,devices[_0x1a2641]['access'][_0x29fe45(0x281)]=null,logger[_0x29fe45(0x13b)](_0x29fe45(0x15c)+_0x1a2641[_0x29fe45(0x140)](-0x8)),devices[_0x1a2641]['access']=validateAccess(devices[_0x1a2641][_0x29fe45(0x2bf)][_0x29fe45(0x281)],_0x1a2641),!(devices[_0x1a2641]['access'][_0x29fe45(0x1ea)]&&devices[_0x1a2641][_0x29fe45(0x2bf)][_0x29fe45(0x221)]==_0x29fe45(0x1da))&&(_0x220abb==_0x29fe45(0x2f1)?io['to'](_0x1a2641)['emit']('status',{'access':{'allow':![],'reason':_0x29fe45(0x30e),'token':null}}):io['to'](_0x1a2641)[_0x29fe45(0x12e)](_0x29fe45(0x2ee),{'access':{'allow':![],'reason':_0x29fe45(0x2ea),'token':null}})),devices[_0x1a2641]['access'][_0x29fe45(0x281)]=null;},_0xddff4e);}function setTokenRefresh(_0x499ea1){const _0x7f51c5=_0x53b0a9;if(devices[_0x499ea1][_0x7f51c5(0x2e6)])clearTimeout(devices[_0x499ea1][_0x7f51c5(0x2e6)]);devices[_0x499ea1]['pidRefreshToken']=setTimeout(()=>{const _0x1f6841=_0x7f51c5;getClientsWithUuid(_0x499ea1)[_0x1f6841(0x2cc)]!=0x0?(devices[_0x499ea1][_0x1f6841(0x2bf)]=refreshToken(_0x499ea1),io['to'](_0x499ea1)[_0x1f6841(0x12e)]('status',{'status':_0x1f6841(0x2df),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x499ea1][_0x1f6841(0x2bf)],'externalip':devices[_0x499ea1]['ip'],'publicKey':secure[_0x1f6841(0x334)],'validInstallation':validInstallation}),setTokenRefresh(_0x499ea1)):clearTimeout(devices[_0x499ea1][_0x1f6841(0x2e6)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x67396c){const _0x489667=_0x53b0a9,_0x30f748=getClient(_0x67396c['id'])[_0x489667(0x252)];_0x67396c[_0x489667(0x12e)](_0x489667(0x172),config),_0x67396c[_0x489667(0x12e)](_0x489667(0x27a),cleanSettings()),_0x67396c['on'](_0x489667(0x2d3),_0x29f4f5=>{const _0x2fa0d2=_0x489667;if(validateAccess(_0x29f4f5,_0x30f748)[_0x2fa0d2(0x1ea)])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x67396c['on']('update-bot',(_0x277518,_0x599b8f)=>{const _0x44d6f4=_0x489667;if(validateAccess(_0x599b8f,_0x30f748)[_0x44d6f4(0x1ea)])toggleBot(_0x277518[_0x44d6f4(0x2e9)],_0x277518['status'],_0x277518[_0x44d6f4(0x30b)]);else logger[_0x44d6f4(0x17f)](_0x44d6f4(0x163));}),_0x67396c['on'](_0x489667(0x1b3),(_0x3e9a5b,_0x3ae799)=>{const _0x3a494b=_0x489667;if(validateAccess(_0x3ae799,_0x30f748)[_0x3a494b(0x1ea)])toggleBotMode(_0x3e9a5b);else logger[_0x3a494b(0x17f)](_0x3a494b(0x163));}),_0x67396c['on']('delete-bot',(_0x9a079b,_0x3aa2d4)=>{const _0xb33ad8=_0x489667;if(validateAccess(_0x3aa2d4,_0x30f748)[_0xb33ad8(0x1ea)])deleteBot(_0x9a079b);else logger[_0xb33ad8(0x17f)](_0xb33ad8(0x20c));}),_0x67396c['on'](_0x489667(0x2e8),(_0x5cf484,_0x1a03f9)=>{const _0x33e63e=_0x489667;if(validateAccess(_0x1a03f9,_0x30f748)[_0x33e63e(0x1ea)])storeSettings(_0x5cf484,!![]);else logger[_0x33e63e(0x17f)](_0x33e63e(0x304));}),_0x67396c['on'](_0x489667(0x335),_0x348638=>{const _0x9c7af=_0x489667;if(validateAccess(_0x348638,_0x30f748)[_0x9c7af(0x1ea)])updateBB(_0x9c7af(0x126));else logger[_0x9c7af(0x17f)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x67396c['on'](_0x489667(0x1fb),_0x3a0003=>{const _0x491590=_0x489667;if(validateAccess(_0x3a0003,_0x30f748)['allow'])updateBB('reinstall');else logger[_0x491590(0x17f)](_0x491590(0x2a3));}),_0x67396c['on'](_0x489667(0x199),_0x3f25ea=>{const _0x4f2157=_0x489667;if(validateAccess(_0x3f25ea,_0x30f748)[_0x4f2157(0x1ea)]){const _0x49ef0e=getClient(_0x67396c['id']);if(_0x49ef0e)getBackupFiles(_0x49ef0e['uuid']);else logger[_0x4f2157(0x17f)](_0x4f2157(0x2b4));}else logger[_0x4f2157(0x17f)](_0x4f2157(0x272));}),_0x67396c['on']('restore-backup-file',(_0x20ba89,_0x545b7a)=>{const _0x5eeb95=_0x489667;if(validateAccess(_0x545b7a,_0x30f748)['allow'])restoreBackupFile(_0x20ba89);else logger['full'](_0x5eeb95(0x17b));}),_0x67396c['on'](_0x489667(0x31b),_0x5e4166=>{const _0x334307=_0x489667;if(validateAccess(_0x5e4166,_0x30f748)[_0x334307(0x1ea)])getMessages();else logger[_0x334307(0x17f)](_0x334307(0x169));}),_0x67396c['on'](_0x489667(0x215),(_0x46c85a,_0x47bb4)=>{const _0x5c24df=_0x489667;if(validateAccess(_0x47bb4,_0x30f748)['allow'])confirmMessage(_0x46c85a);else logger['full'](_0x5c24df(0x2c7));}),_0x67396c['on'](_0x489667(0x28d),_0x1b8564=>{const _0x24a4f4=_0x489667;if(validateAccess(_0x1b8564,_0x30f748)[_0x24a4f4(0x1ea)]){if(devices[_0x30f748]['pidRefreshToken'])clearTimeout(devices[_0x30f748][_0x24a4f4(0x2e6)]);if(devices[_0x30f748][_0x24a4f4(0x194)])clearTimeout(devices[_0x30f748]['pidExpireLogin']);removeSocketListeners(getClient(_0x67396c['id'])[_0x24a4f4(0x252)]),addBlacklist(_0x30f748),devices[_0x30f748][_0x24a4f4(0x1aa)]=null,devices[_0x30f748]['telegram2FaApproval']=null,devices[_0x30f748][_0x24a4f4(0x2bf)][_0x24a4f4(0x281)]=null,logger[_0x24a4f4(0x13b)]('Logged\x20out\x20user\x20...'+_0x30f748[_0x24a4f4(0x140)](-0x8)),io['to'](getClient(_0x67396c['id'])[_0x24a4f4(0x252)])[_0x24a4f4(0x12e)](_0x24a4f4(0x2ee),{'access':{'allow':![],'reason':_0x24a4f4(0x320),'token':null}});}else logger['full'](_0x24a4f4(0x254));});}function initializeSocketBot(_0x354c54){const _0x2a62ed=_0x53b0a9,_0x4c0481=getClient(_0x354c54['id'])['bot'],_0x53f734=getClient(_0x354c54['id'])['uuid'];_0x354c54['on'](_0x2a62ed(0x262),(_0x505019,_0x4ce2fc)=>{const _0x40a637=_0x2a62ed;if(validateAccess(_0x4ce2fc,_0x53f734)[_0x40a637(0x1ea)]){if(pid[_0x4c0481])pid[_0x4c0481]['send']({'function':_0x40a637(0x2ad),'args':_0x505019});}else logger[_0x40a637(0x17f)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x354c54['on']('delete-alerts',(_0x27def6,_0x56fe59)=>{const _0x129140=_0x2a62ed;if(validateAccess(_0x56fe59,_0x53f734)[_0x129140(0x1ea)]){if(pid[_0x4c0481])pid[_0x4c0481][_0x129140(0x2cb)]({'function':'deleteHistoryAlerts','args':_0x27def6});}else logger['full'](_0x129140(0x29e));}),_0x354c54['on'](_0x2a62ed(0x2f7),(_0x41bcb8,_0x2d3e4e)=>{const _0xa8b48b=_0x2a62ed;if(validateAccess(_0x2d3e4e,_0x53f734)[_0xa8b48b(0x1ea)]){if(pid[_0x4c0481])pid[_0x4c0481][_0xa8b48b(0x2cb)]({'function':_0xa8b48b(0x22d),'args':_0x41bcb8});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x354c54['on'](_0x2a62ed(0x183),(_0x53bf89,_0x51c86f)=>{const _0xbabf5b=_0x2a62ed;if(validateAccess(_0x51c86f,_0x53f734)[_0xbabf5b(0x1ea)]){if(pid[_0x4c0481])pid[_0x4c0481]['send']({'function':_0xbabf5b(0x1c4),'args':_0x53bf89});}else logger['full'](_0xbabf5b(0x170));}),_0x354c54['on'](_0x2a62ed(0x27e),(_0x40b268,_0x2a974f)=>{const _0x5d5af9=_0x2a62ed;if(validateAccess(_0x2a974f,_0x53f734)['allow']){if(pid[_0x4c0481])pid[_0x4c0481][_0x5d5af9(0x2cb)]({'function':_0x5d5af9(0x2c5),'args':_0x40b268});}else logger[_0x5d5af9(0x17f)](_0x5d5af9(0x305));}),_0x354c54['on'](_0x2a62ed(0x17d),(_0x56c7e5,_0x29c6c2)=>{const _0x56258b=_0x2a62ed;if(validateAccess(_0x29c6c2,_0x53f734)[_0x56258b(0x1ea)]){if(pid[_0x4c0481])pid[_0x4c0481][_0x56258b(0x2cb)]({'function':_0x56258b(0x226),'args':_0x56c7e5});}else logger[_0x56258b(0x17f)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x354c54['on'](_0x2a62ed(0x245),_0x1e4453=>{const _0x14da55=_0x2a62ed;if(validateAccess(_0x1e4453,_0x53f734)['allow']){if(pid[_0x4c0481])pid[_0x4c0481][_0x14da55(0x2cb)]({'function':_0x14da55(0x329),'args':null});}else logger[_0x14da55(0x17f)](_0x14da55(0x32e));}),_0x354c54['on'](_0x2a62ed(0x307),_0x402bdb=>{const _0x287ac7=_0x2a62ed;if(validateAccess(_0x402bdb,_0x53f734)[_0x287ac7(0x1ea)]){if(pid[_0x4c0481])pid[_0x4c0481][_0x287ac7(0x2cb)]({'function':_0x287ac7(0x202),'args':null});}else logger[_0x287ac7(0x17f)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x354c54['on'](_0x2a62ed(0x191),(_0x468e7e,_0x19f9c5)=>{const _0x87ca31=_0x2a62ed;if(validateAccess(_0x19f9c5,_0x53f734)[_0x87ca31(0x1ea)]){if(pid[_0x4c0481])pid[_0x4c0481][_0x87ca31(0x2cb)]({'function':_0x87ca31(0x1f6),'args':_0x468e7e});}else logger[_0x87ca31(0x17f)](_0x87ca31(0x2da));}),_0x354c54['on']('cancel-loading',_0x55a703=>{const _0x5315d9=_0x2a62ed;if(validateAccess(_0x55a703,_0x53f734)[_0x5315d9(0x1ea)]){if(pid[_0x4c0481])pid[_0x4c0481][_0x5315d9(0x2cb)]({'function':_0x5315d9(0x225),'args':null});}else logger[_0x5315d9(0x17f)](_0x5315d9(0x1f9));}),_0x354c54['on']('show-config',_0x388b53=>{const _0x9d2cf8=_0x2a62ed;if(validateAccess(_0x388b53,_0x53f734)['allow']){if(pid[_0x4c0481])pid[_0x4c0481][_0x9d2cf8(0x2cb)]({'function':_0x9d2cf8(0x328),'args':null});}else logger[_0x9d2cf8(0x17f)](_0x9d2cf8(0x1eb));}),_0x354c54['on'](_0x2a62ed(0x335),_0x3610db=>{const _0x54f7f1=_0x2a62ed;if(validateAccess(_0x3610db,_0x53f734)[_0x54f7f1(0x1ea)])updateBB(_0x54f7f1(0x126));else logger['full'](_0x54f7f1(0x283));}),_0x354c54['on'](_0x2a62ed(0x31b),_0x37f9a4=>{const _0x3dccd0=_0x2a62ed;if(validateAccess(_0x37f9a4,_0x53f734)['allow'])getMessages();else logger[_0x3dccd0(0x17f)](_0x3dccd0(0x169));}),_0x354c54['on'](_0x2a62ed(0x215),(_0x143b0d,_0x3ef340)=>{const _0x2421fa=_0x2a62ed;if(validateAccess(_0x3ef340,_0x53f734)['allow'])confirmMessage(_0x143b0d);else logger[_0x2421fa(0x17f)](_0x2421fa(0x2c7));}),_0x354c54['on'](_0x2a62ed(0x28d),_0x37c568=>{const _0x1cb0c9=_0x2a62ed;if(validateAccess(_0x37c568,_0x53f734)[_0x1cb0c9(0x1ea)]){if(devices[_0x53f734][_0x1cb0c9(0x2e6)])clearTimeout(devices[_0x53f734][_0x1cb0c9(0x2e6)]);if(devices[_0x53f734][_0x1cb0c9(0x194)])clearTimeout(devices[_0x53f734][_0x1cb0c9(0x194)]);removeSocketListeners(getClient(_0x354c54['id'])['uuid']),addBlacklist(_0x53f734),devices[_0x53f734][_0x1cb0c9(0x1aa)]=null,devices[_0x53f734]['telegram2FaApproval']=null,devices[_0x53f734][_0x1cb0c9(0x2bf)][_0x1cb0c9(0x281)]=null,logger[_0x1cb0c9(0x13b)](_0x1cb0c9(0x2f2)+_0x53f734['slice'](-0x8)),io['to'](getClient(_0x354c54['id'])[_0x1cb0c9(0x252)])[_0x1cb0c9(0x12e)](_0x1cb0c9(0x2ee),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full'](_0x1cb0c9(0x254));});}function removeSocketListeners(_0x17121e){getClientsWithUuid(_0x17121e)['forEach'](_0x392ad5=>{const _0x3c6333=_0x1653;getSocket(_0x392ad5['id'])[_0x3c6333(0x138)]();});}function cleanSettings(){const _0x40b509=_0x53b0a9;let _0x1b64f4=settings;return settings[_0x40b509(0x31c)]&&settings['telegramToken']!=''&&(_0x1b64f4={..._0x1b64f4,'telegramToken':_0x40b509(0x247)}),settings['bbPassword']&&settings[_0x40b509(0x322)]!=''&&(_0x1b64f4={..._0x1b64f4,'bbPassword':'************'}),settings[_0x40b509(0x1bf)]&&settings[_0x40b509(0x1bf)]!=''&&(_0x1b64f4={..._0x1b64f4,'marketcapApi':_0x40b509(0x247)}),(settings[_0x40b509(0x322)]&&settings[_0x40b509(0x322)]==_0x40b509(0x171)||settings[_0x40b509(0x31c)]&&settings['telegramToken']==_0x40b509(0x171)||settings[_0x40b509(0x1bf)]&&settings[_0x40b509(0x1bf)]=='***')&&(_0x1b64f4={..._0x1b64f4,'restored':{'password':settings[_0x40b509(0x322)]==_0x40b509(0x171),'telegram':settings['telegramToken']==_0x40b509(0x171),'marketcap':settings[_0x40b509(0x1bf)]==_0x40b509(0x171)}}),_0x1b64f4;}async function updateBB(_0x2e53d4){const _0x1357f7=_0x53b0a9;await backupConfigFiles(),installingUpdate=!![],config[_0x1357f7(0x25b)](_0x30d4d3=>{restartBot(_0x30d4d3['botID']);});if(_0x2e53d4==_0x1357f7(0x126))process[_0x1357f7(0x2cb)]({'update':!![],'environment':environment},_0xdeb99e=>{});else _0x2e53d4==_0x1357f7(0x187)&&process[_0x1357f7(0x2cb)]({'reinstall':!![],'environment':environment},_0x312efe=>{});}function startBot(_0x143b05,_0x23bd3a,_0x18802e){const _0xc9a210=_0x53b0a9;if(debugging)_0x143b05[_0xc9a210(0x13f)]('-d');if(recreate)_0x143b05[_0xc9a210(0x13f)]('-r');let _0x22f99d=![];const _0x4f9f02=_0x143b05[0x0];_0x23bd3a={..._0x23bd3a,'stdio':[_0xc9a210(0x29f),'inherit',_0xc9a210(0x29f),'ipc']},pid[_0x4f9f02]=childProcess[_0xc9a210(0x18e)](botfile,_0x143b05,_0x23bd3a),pid[_0x4f9f02]['on'](_0xc9a210(0x1f0),_0x4dbc19=>{const _0x3bb21b=_0xc9a210;switch(Object[_0x3bb21b(0x20f)](_0x4dbc19)[0x0]){case _0x3bb21b(0x137):updateBotName(_0x4f9f02,_0x4dbc19[_0x3bb21b(0x137)]);break;case _0x3bb21b(0x166):updateBotManager();break;case _0x3bb21b(0x2ee):updateStatus(_0x4f9f02,_0x4dbc19['status']);break;case'live':updateLive(_0x4f9f02,_0x4dbc19[_0x3bb21b(0x30b)]);break;case _0x3bb21b(0x1a7):updateLive(_0x4f9f02,_0x4dbc19[_0x3bb21b(0x1a7)]),io['to'](_0x4f9f02)[_0x3bb21b(0x12e)]('status',{'access':{'allow':![],'reason':_0x3bb21b(0x242),'token':null}});break;case _0x3bb21b(0x136):_0x4dbc19['stop']==_0x3bb21b(0x255)&&restartBot(_0x4f9f02);_0x4dbc19['stop']=='kill'&&toggleBot(_0x4f9f02,_0x3bb21b(0x266),_0x3bb21b(0x161));break;case _0x3bb21b(0x1d7):sendTelegramBot(_0x4f9f02,_0x4dbc19[_0x3bb21b(0x1d7)]);break;case _0x3bb21b(0x238):sendTelegramMsg(_0x4dbc19['telegrammsg']);break;case'function':io['to'](_0x4f9f02)[_0x3bb21b(0x12e)](_0x4dbc19[_0x3bb21b(0x178)],_0x4dbc19['args']);break;}}),pid[_0x4f9f02]['on']('error',function(_0x368a93){if(_0x22f99d)return;_0x22f99d=!![],_0x18802e(_0x368a93);}),pid[_0x4f9f02]['on'](_0xc9a210(0x139),async function(_0x50c804){const _0x34f4ff=_0xc9a210;if(terminating)return;if(installingUpdate){io[_0x34f4ff(0x133)]();return;}if(_0x22f99d)return;_0x22f99d=!![],_0x18802e(null);const _0x16797b=dbConfig[_0x34f4ff(0x1ed)](_0x34f4ff(0x172))[_0x34f4ff(0x141)]({'botID':_0x4f9f02})['value']();_0x16797b&&(_0x16797b[_0x34f4ff(0x2ee)]==_0x34f4ff(0x337)||_0x16797b[_0x34f4ff(0x2ee)]==_0x34f4ff(0x324))&&(await sleep(0x3e8),updateLive(_0x4f9f02,'stopped'),logger[_0x34f4ff(0x17f)](_0x34f4ff(0x2ec)+_0x4f9f02),startBot([_0x4f9f02,userID],{'cwd':bbpath},function(_0x2c4772){if(_0x2c4772)logger['full'](_0x2c4772);}));});}function stopBot(_0x2dc462){const _0x1a5550=_0x53b0a9;getClientsWithBotID(_0x2dc462)[_0x1a5550(0x25b)](_0x112098=>{const _0xfbe381=_0x1a5550;getSocket(_0x112098['id'])[_0xfbe381(0x208)](!![]),removeClient(_0x112098['id']);}),pid[_0x2dc462]&&(pid[_0x2dc462][_0x1a5550(0x211)](),pid[_0x2dc462]=null);}function stopAllBots(){const _0x3a4991=_0x53b0a9;terminating=!![];const _0xa4659e=getEnabledBots();_0xa4659e[_0x3a4991(0x25b)](_0x4b2e2b=>{const _0x537e5e=_0x3a4991;stopBot(_0x4b2e2b[_0x537e5e(0x2e9)]);});}function restartBot(_0x39493f){const _0x217170=_0x53b0a9;if(pid[_0x39493f])pid[_0x39493f][_0x217170(0x211)]();}function addBot(){const _0x11546a=_0x53b0a9;let _0x5b80b2;for(let _0xd639da=0x1;_0xd639da<0x3e9;_0xd639da++){_0x5b80b2=_0xd639da['toString']()[_0x11546a(0x212)](0x3,'0');let _0x108df1=config[_0x11546a(0x141)](_0x486f47=>_0x486f47['botID']==_0x5b80b2);if(!_0x108df1)break;}if(_0x5b80b2===_0x11546a(0x12d)){logger['full'](_0x11546a(0x2d2));return;}logger[_0x11546a(0x17f)](_0x11546a(0x249)+_0x5b80b2),dbConfig[_0x11546a(0x1ed)](_0x11546a(0x172))[_0x11546a(0x13f)]({'botID':_0x5b80b2,'botname':'Bot\x20'+_0x5b80b2,'status':'new','live':''})[_0x11546a(0x300)](),startBot([_0x5b80b2,userID],{'cwd':bbpath},function(_0x169d7e){const _0x4e38e8=_0x11546a;if(_0x169d7e)logger[_0x4e38e8(0x17f)](_0x169d7e);}),config=getConfiguration(),io['to'](_0x11546a(0x1e9))[_0x11546a(0x12e)](_0x11546a(0x172),config),broadcastToBots(_0x11546a(0x172),JSON[_0x11546a(0x21f)](config));}function deleteBot(_0x24803d){const _0x213928=_0x53b0a9;getClientsWithBotID(_0x24803d)[_0x213928(0x25b)](_0x1394ad=>{const _0x5ddb07=_0x213928;getSocket(_0x1394ad['id'])[_0x5ddb07(0x208)](!![]),removeClient(_0x1394ad['id']);}),dbConfig[_0x213928(0x1ed)](_0x213928(0x172))[_0x213928(0x24f)]({'botID':_0x24803d})[_0x213928(0x300)](),logger['full']('Deleted\x20Bot\x20'+_0x24803d),stopBot(_0x24803d);try{if(fs['existsSync'](path[_0x213928(0x264)](configpath,_0x213928(0x2cf)+_0x24803d+_0x213928(0x175))))fs[_0x213928(0x282)](path[_0x213928(0x264)](configpath,'bot-'+_0x24803d+'-config.json'));if(fs[_0x213928(0x12f)](path[_0x213928(0x264)](configpath,'bot-'+_0x24803d+_0x213928(0x127))))fs['unlinkSync'](path[_0x213928(0x264)](configpath,'bot-'+_0x24803d+'-events.json'));if(fs[_0x213928(0x12f)](path['join'](configpath,_0x213928(0x2cf)+_0x24803d+_0x213928(0x24a))))fs[_0x213928(0x282)](path[_0x213928(0x264)](configpath,'bot-'+_0x24803d+'-performance.json'));if(fs[_0x213928(0x12f)](path[_0x213928(0x264)](configpath,_0x213928(0x2cf)+_0x24803d+_0x213928(0x1a5))))fs[_0x213928(0x282)](path[_0x213928(0x264)](configpath,_0x213928(0x2cf)+_0x24803d+_0x213928(0x1a5)));}catch(_0x31cb87){if(_0x31cb87)logger[_0x213928(0x17f)](_0x213928(0x181),_0x31cb87);}config=getConfiguration(),io['to'](_0x213928(0x1e9))[_0x213928(0x12e)](_0x213928(0x172),config),broadcastToBots(_0x213928(0x172),JSON['stringify'](config));}function toggleBot(_0x43979b,_0x3ce32d,_0xa849){const _0x14144f=_0x53b0a9;dbConfig[_0x14144f(0x1ed)](_0x14144f(0x172))[_0x14144f(0x141)]({'botID':_0x43979b})[_0x14144f(0x2ab)]({'status':_0x3ce32d})[_0x14144f(0x2ab)]({'live':_0xa849})[_0x14144f(0x300)]();if(_0x3ce32d=='enabled'||_0x3ce32d==_0x14144f(0x324))logger[_0x14144f(0x17f)](_0x14144f(0x2b2)+_0x43979b),startBot([_0x43979b,userID],{'cwd':bbpath},function(_0x52f945){if(_0x52f945)logger['full'](_0x52f945);});else(_0x3ce32d==_0x14144f(0x266)||_0x3ce32d==_0x14144f(0x285))&&(logger[_0x14144f(0x17f)](_0x14144f(0x167)+_0x43979b),stopBot(_0x43979b));config=getConfiguration(),io['to']('botmanager')[_0x14144f(0x12e)](_0x14144f(0x172),config),broadcastToBots('bots',JSON[_0x14144f(0x21f)](config));}function toggleStatus(_0x25ea57){const _0xf9e9ea=_0x53b0a9;let _0x29eb4c=dbConfig['get'](_0xf9e9ea(0x172))[_0xf9e9ea(0x141)]({'botID':_0x25ea57})[_0xf9e9ea(0x289)](),_0x258b70;if(_0x29eb4c[_0xf9e9ea(0x2ee)]==='enabled')_0x258b70='disabled';else{if(_0x29eb4c[_0xf9e9ea(0x2ee)]===_0xf9e9ea(0x324))_0x258b70=_0xf9e9ea(0x285);else{if(_0x29eb4c['status']===_0xf9e9ea(0x285))_0x258b70=_0xf9e9ea(0x324);else{if(_0x29eb4c['status']===_0xf9e9ea(0x266))_0x258b70=_0xf9e9ea(0x337);}}}return _0x258b70;}function updateStatus(_0x22c070,_0x3efc61){const _0x103824=_0x53b0a9;dbConfig[_0x103824(0x1ed)](_0x103824(0x172))[_0x103824(0x141)]({'botID':_0x22c070})[_0x103824(0x2ab)]({'status':_0x3efc61})[_0x103824(0x300)](),config=getConfiguration(),io['to'](_0x103824(0x1e9))['emit'](_0x103824(0x172),config),broadcastToBots('bots',JSON[_0x103824(0x21f)](config));}function updateLive(_0x4edff5,_0x316808){const _0x4c1a68=_0x53b0a9;dbConfig[_0x4c1a68(0x1ed)](_0x4c1a68(0x172))[_0x4c1a68(0x141)]({'botID':_0x4edff5})[_0x4c1a68(0x2ab)]({'live':_0x316808})[_0x4c1a68(0x300)](),config=getConfiguration(),io['to'](_0x4c1a68(0x1e9))[_0x4c1a68(0x12e)](_0x4c1a68(0x172),config),broadcastToBots(_0x4c1a68(0x172),JSON[_0x4c1a68(0x21f)](config));}function updateBotName(_0x13b489,_0x360498){const _0x282d37=_0x53b0a9;dbConfig['get'](_0x282d37(0x172))[_0x282d37(0x141)]({'botID':_0x13b489})[_0x282d37(0x2ab)]({'botname':_0x360498})[_0x282d37(0x300)](),config=getConfiguration(),io['to'](_0x282d37(0x1e9))['emit'](_0x282d37(0x172),config),broadcastToBots(_0x282d37(0x172),JSON[_0x282d37(0x21f)](config));}function updateBotManager(){const _0x49369a=_0x53b0a9;config=getConfiguration(),io['to'](_0x49369a(0x1e9))[_0x49369a(0x12e)](_0x49369a(0x172),config),broadcastToBots('bots',JSON[_0x49369a(0x21f)](config));}function toggleBotMode(_0x4d5663){const _0x1b1f00=_0x53b0a9;if(pid[_0x4d5663])pid[_0x4d5663]['send']({'function':_0x1b1f00(0x23c),'args':null});else{const _0x38b800=configpath+_0x1b1f00(0x2cf)+_0x4d5663+'-config.json',_0x501388=fs[_0x1b1f00(0x24d)](_0x38b800),_0x309909=JSON[_0x1b1f00(0x1e0)](_0x501388),_0x40a094=_0x309909[_0x1b1f00(0x250)][0x0][_0x1b1f00(0x25e)];_0x309909[_0x1b1f00(0x250)][0x0][_0x1b1f00(0x25e)]=!_0x40a094;const _0x40e651=JSON['stringify'](_0x309909,null,0x2);fs[_0x1b1f00(0x17e)](_0x38b800,_0x40e651),config=getConfiguration(),io['to']('botmanager')[_0x1b1f00(0x12e)]('bots',config),broadcastToBots(_0x1b1f00(0x172),JSON[_0x1b1f00(0x21f)](config));}}function validateTelegram(_0x230e53){const _0x3d86fe=_0x53b0a9;if(_0x230e53[_0x3d86fe(0x144)]['username']!=settings[_0x3d86fe(0x274)]&&'@'+_0x230e53['from'][_0x3d86fe(0x128)]!=settings['telegramUsername']||_0x230e53[_0x3d86fe(0x275)]['id']!=settings[_0x3d86fe(0x196)])return sendTelegram(_0x230e53[_0x3d86fe(0x275)]['id'],_0x3d86fe(0x21a),{'parse_mode':'HTML'}),![];return!![];}async function initTelegram(){const _0x4e3c25=_0x53b0a9;tgBot&&(await tgBot[_0x4e3c25(0x136)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x4e3c25(0x31c)]);let _0x49f38a=_0x4e3c25(0x1d3);_0x49f38a+='\x0a',_0x49f38a+=_0x4e3c25(0x2fa),_0x49f38a+=_0x4e3c25(0x1b2),_0x49f38a+=_0x4e3c25(0x25f),_0x49f38a+=_0x4e3c25(0x2c0),_0x49f38a+=_0x4e3c25(0x2ca),_0x49f38a+=_0x4e3c25(0x18a),_0x49f38a+=_0x4e3c25(0x28a),_0x49f38a+=_0x4e3c25(0x214),_0x49f38a+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x49f38a+=_0x4e3c25(0x28c),_0x49f38a+=_0x4e3c25(0x217),_0x49f38a+=_0x4e3c25(0x318),_0x49f38a+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0x49f38a+=_0x4e3c25(0x1be),_0x49f38a+=_0x4e3c25(0x21b),_0x49f38a+=_0x4e3c25(0x1c8);let _0x2cdea1=_0x4e3c25(0x180);_0x2cdea1+='\x0a',_0x2cdea1+=_0x49f38a,tgBot['catch']((_0x11fdca,_0x2b0c43)=>{const _0x301b1c=_0x4e3c25;logger[_0x301b1c(0x1d2)](getTimeStamp()+_0x301b1c(0x2ac)),logger[_0x301b1c(0x13b)](_0x301b1c(0x203),_0x11fdca);}),tgBot[_0x4e3c25(0x197)](async(_0x3e4415,_0x19c49a)=>{const _0x2ba8fe=_0x4e3c25;if(settings['telegramChatId']||_0x3e4415[_0x2ba8fe(0x126)][_0x2ba8fe(0x1f0)][_0x2ba8fe(0x2ae)]!=_0x2ba8fe(0x248)){if(!validateTelegram(_0x3e4415))return;}_0x19c49a();}),tgBot[_0x4e3c25(0x23f)]('start',async _0xcc1421=>{const _0x158cc9=_0x4e3c25;if(_0xcc1421['from'][_0x158cc9(0x128)]==settings[_0x158cc9(0x274)]||'@'+_0xcc1421[_0x158cc9(0x144)]['username']==settings[_0x158cc9(0x274)]){if(!settings['telegramChatId'])updateSetting(_0x158cc9(0x196),_0xcc1421[_0x158cc9(0x275)]['id']);else{if(!validateTelegram(_0xcc1421))return;}}else{if(!validateTelegram(_0xcc1421))return;}updateSetting(_0x158cc9(0x26f),!![]),await sendTelegram(_0xcc1421[_0x158cc9(0x275)]['id'],_0x2cdea1);}),tgBot[_0x4e3c25(0x23f)](_0x4e3c25(0x26a),async _0x389239=>{const _0x53d876=_0x4e3c25;updateSetting(_0x53d876(0x26f),!![]),await sendTelegram(_0x389239['chat']['id'],'Notifications\x20enabled');}),tgBot[_0x4e3c25(0x23f)](_0x4e3c25(0x1ec),async _0x30f5c7=>{const _0x43b016=_0x4e3c25;await sendTelegram(_0x30f5c7['chat']['id'],_0x43b016(0x1a9)),updateSetting('telegramEnabled',![]);}),tgBot[_0x4e3c25(0x23f)]('config',async _0x3ec40b=>{const _0xeac9ed=_0x4e3c25,_0xc7c690=Markup[_0xeac9ed(0x1b1)]([Markup[_0xeac9ed(0x1ca)]['callback']('Orders',_0xeac9ed(0x1f7)),Markup[_0xeac9ed(0x1ca)][_0xeac9ed(0x156)](_0xeac9ed(0x277),_0xeac9ed(0x2d7)),Markup['button']['callback']('All',_0xeac9ed(0x2a0))]);_0x3ec40b['reply']('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0xc7c690);}),tgBot['action'](_0x4e3c25(0x1f7),async _0xed3504=>{const _0x134f78=_0x4e3c25;_0xed3504['editMessageReplyMarkup'](),updateSetting(_0x134f78(0x315),'orders'),updateSetting(_0x134f78(0x26f),!![]),await sendTelegram(_0xed3504[_0x134f78(0x275)]['id'],_0x134f78(0x23a));}),tgBot[_0x4e3c25(0x2c3)](_0x4e3c25(0x2d7),async _0x4b3450=>{const _0x3f5b71=_0x4e3c25;_0x4b3450[_0x3f5b71(0x26b)](),updateSetting('telegramEvents',_0x3f5b71(0x193)),updateSetting(_0x3f5b71(0x26f),!![]),await sendTelegram(_0x4b3450[_0x3f5b71(0x275)]['id'],_0x3f5b71(0x256));}),tgBot['action'](_0x4e3c25(0x2a0),async _0x4b9b37=>{const _0x17c334=_0x4e3c25;_0x4b9b37['editMessageReplyMarkup'](),updateSetting(_0x17c334(0x315),_0x17c334(0x235)),updateSetting(_0x17c334(0x26f),!![]),await sendTelegram(_0x4b9b37[_0x17c334(0x275)]['id'],_0x17c334(0x323));}),tgBot[_0x4e3c25(0x23f)]('status',async _0x4f2cf4=>{const _0x1ae660=_0x4e3c25,_0x4942e4=getBotsWithMode();let _0x2342f7='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x1ae660(0x25b)](_0xa483a7=>{const _0x2dfda3=_0x1ae660,_0x13c720=_0x4942e4[_0x2dfda3(0x141)](_0x90978d=>_0x90978d[_0x2dfda3(0x2e9)]==_0xa483a7[_0x2dfda3(0x2e9)])[_0x2dfda3(0x2b0)];_0x2342f7+=_0x2dfda3(0x319)+_0xa483a7[_0x2dfda3(0x2e9)]+':\x20'+_0xa483a7['status']+_0x2dfda3(0x279)+_0x13c720+_0x2dfda3(0x279)+_0xa483a7[_0x2dfda3(0x30b)]+'\x0a';}),_0x2342f7+='\x0a',_0x2342f7+=_0x1ae660(0x1d1),_0x2342f7+=!settings[_0x1ae660(0x26f)]?_0x1ae660(0x265):_0x1ae660(0x2c6),_0x2342f7+=settings[_0x1ae660(0x26f)]?settings['telegramEvents']=='all'?_0x1ae660(0x13e):_0x1ae660(0x294)+settings[_0x1ae660(0x315)]+_0x1ae660(0x2c2):'',await sendTelegram(_0x4f2cf4[_0x1ae660(0x275)]['id'],_0x2342f7,{'parse_mode':_0x1ae660(0x1c1)});}),tgBot['command'](_0x4e3c25(0x255),async _0xb978f4=>{const _0x2697be=_0x4e3c25,_0x5414b5=getEnabledBots();if(_0x5414b5[_0x2697be(0x2cc)]==0x0)await sendTelegram(_0xb978f4[_0x2697be(0x275)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x5414b5[_0x2697be(0x2cc)]>0x1)_0x5414b5[_0x2697be(0x13f)]({'botID':_0x2697be(0x235)});let _0x4ee79d=[],_0xe276ed=[];const _0x1eb735=_0x5414b5[_0x2697be(0x2cc)]%0x4==0x0||_0x5414b5[_0x2697be(0x2cc)]%0x4==0x3||_0x5414b5[_0x2697be(0x2cc)]%0x3==0x1?0x4:0x3;let _0x6c8513=0x0;_0x5414b5[_0x2697be(0x25b)]((_0x26ea7e,_0x168fe5)=>{const _0x41d73c=_0x2697be;if(_0x168fe5%_0x1eb735==0x0)_0xe276ed=[];_0xe276ed[_0x41d73c(0x13f)](Markup[_0x41d73c(0x1ca)][_0x41d73c(0x156)](_0x26ea7e[_0x41d73c(0x2e9)]==_0x41d73c(0x235)?'All\x20bots':_0x41d73c(0x319)+_0x26ea7e[_0x41d73c(0x2e9)],'restart_'+_0x26ea7e['botID'])),_0x168fe5%_0x1eb735==0x0&&(_0x4ee79d[_0x6c8513]=_0xe276ed,_0x6c8513++);});const _0x5ff5d2=Markup[_0x2697be(0x1b1)](_0x4ee79d);_0xb978f4[_0x2697be(0x14a)](_0x2697be(0x189),_0x5ff5d2);}}),tgBot[_0x4e3c25(0x2c3)](/restart_(.+)/,async _0x4bfd93=>{const _0xa79ab1=_0x4e3c25,_0x1a6d1e=_0x4bfd93['match'][0x1];_0x4bfd93[_0xa79ab1(0x26b)](),_0x1a6d1e==_0xa79ab1(0x235)?config[_0xa79ab1(0x25b)](_0x5c945c=>{restartBot(_0x5c945c['botID']);}):restartBot(_0x1a6d1e);}),tgBot[_0x4e3c25(0x23f)]('on',async _0x49b22a=>{const _0x4704f6=_0x4e3c25,_0x5de240=getDisabledBots();if(_0x5de240[_0x4704f6(0x2cc)]==0x0)await sendTelegram(_0x49b22a['chat']['id'],_0x4704f6(0x1a2));else{if(_0x5de240[_0x4704f6(0x2cc)]>0x1)_0x5de240['push']({'botID':_0x4704f6(0x235)});let _0x37a73a=[],_0x584362=[];const _0x5e165e=_0x5de240[_0x4704f6(0x2cc)]%0x4==0x0||_0x5de240[_0x4704f6(0x2cc)]%0x4==0x3||_0x5de240[_0x4704f6(0x2cc)]%0x3==0x1?0x4:0x3;let _0x182fa1=0x0;_0x5de240[_0x4704f6(0x25b)]((_0x3d6dde,_0x5cfe9c)=>{const _0x4e31db=_0x4704f6;if(_0x5cfe9c%_0x5e165e==0x0)_0x584362=[];_0x584362[_0x4e31db(0x13f)](Markup[_0x4e31db(0x1ca)]['callback'](_0x3d6dde[_0x4e31db(0x2e9)]=='all'?_0x4e31db(0x23d):'Bot\x20'+_0x3d6dde[_0x4e31db(0x2e9)],_0x4e31db(0x19f)+_0x3d6dde[_0x4e31db(0x2e9)])),_0x5cfe9c%_0x5e165e==0x0&&(_0x37a73a[_0x182fa1]=_0x584362,_0x182fa1++);});const _0x4df37b=Markup[_0x4704f6(0x1b1)](_0x37a73a);_0x49b22a[_0x4704f6(0x14a)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x4df37b);}}),tgBot[_0x4e3c25(0x2c3)](/on_(.+)/,async _0x7738f6=>{const _0x38f00d=_0x4e3c25,_0x46d087=_0x7738f6['match'][0x1];_0x7738f6[_0x38f00d(0x26b)]();if(_0x46d087==_0x38f00d(0x235)){const _0x54a696=getDisabledBots();await sendTelegram(_0x7738f6[_0x38f00d(0x275)]['id'],_0x38f00d(0x2d1)),_0x54a696['forEach'](_0x2837ff=>{const _0x2888ce=_0x38f00d;if(_0x2837ff[_0x2888ce(0x2e9)]!=_0x2888ce(0x235))toggleBot(_0x2837ff[_0x2888ce(0x2e9)],toggleStatus(_0x2837ff[_0x2888ce(0x2e9)]),_0x2888ce(0x161));});}else await sendTelegram(_0x7738f6['chat']['id'],_0x38f00d(0x295)+_0x46d087),toggleBot(_0x46d087,toggleStatus(_0x46d087),_0x38f00d(0x161));}),tgBot[_0x4e3c25(0x23f)](_0x4e3c25(0x2c9),async _0x3f44fc=>{const _0x49bd67=_0x4e3c25,_0x1d5c67=getEnabledBots();if(_0x1d5c67[_0x49bd67(0x2cc)]==0x0)await sendTelegram(_0x3f44fc[_0x49bd67(0x275)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1d5c67[_0x49bd67(0x2cc)]>0x1)_0x1d5c67['push']({'botID':_0x49bd67(0x235)});let _0x206df5=[],_0x36805b=[];const _0xe2be3c=_0x1d5c67['length']%0x4==0x0||_0x1d5c67[_0x49bd67(0x2cc)]%0x4==0x3||_0x1d5c67[_0x49bd67(0x2cc)]%0x3==0x1?0x4:0x3;let _0x2bc036=0x0;_0x1d5c67['forEach']((_0x429b64,_0x4ed747)=>{const _0x53dc1c=_0x49bd67;if(_0x4ed747%_0xe2be3c==0x0)_0x36805b=[];_0x36805b[_0x53dc1c(0x13f)](Markup[_0x53dc1c(0x1ca)]['callback'](_0x429b64[_0x53dc1c(0x2e9)]==_0x53dc1c(0x235)?_0x53dc1c(0x23d):'Bot\x20'+_0x429b64['botID'],_0x53dc1c(0x259)+_0x429b64['botID'])),_0x4ed747%_0xe2be3c==0x0&&(_0x206df5[_0x2bc036]=_0x36805b,_0x2bc036++);});const _0x542540=Markup['inlineKeyboard'](_0x206df5);_0x3f44fc[_0x49bd67(0x14a)](_0x49bd67(0x260),_0x542540);}}),tgBot[_0x4e3c25(0x2c3)](/off_(.+)/,async _0x4c3190=>{const _0x371d86=_0x4e3c25,_0x133a0f=_0x4c3190[_0x371d86(0x213)][0x1];_0x4c3190[_0x371d86(0x26b)]();if(_0x133a0f==_0x371d86(0x235)){const _0x291e72=getEnabledBots();await sendTelegram(_0x4c3190[_0x371d86(0x275)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x291e72[_0x371d86(0x25b)](_0x5f1834=>{const _0x3556a7=_0x371d86;if(_0x5f1834[_0x3556a7(0x2e9)]!=_0x3556a7(0x235))toggleBot(_0x5f1834[_0x3556a7(0x2e9)],toggleStatus(_0x5f1834[_0x3556a7(0x2e9)]),_0x3556a7(0x161));});}else await sendTelegram(_0x4c3190[_0x371d86(0x275)]['id'],_0x371d86(0x15b)+_0x133a0f),toggleBot(_0x133a0f,toggleStatus(_0x133a0f),_0x371d86(0x161));}),tgBot['command'](_0x4e3c25(0x26e),async _0x47f38d=>{const _0x5aa795=_0x4e3c25,_0x6fb478=getEnabledBots();if(_0x6fb478['length']==0x0)await sendTelegram(_0x47f38d[_0x5aa795(0x275)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x6fb478[_0x5aa795(0x2cc)]>0x1){let _0x305055=[],_0x2ff3b9=[];const _0x14fecc=_0x6fb478[_0x5aa795(0x2cc)]%0x4==0x0||_0x6fb478['length']%0x4==0x3||_0x6fb478[_0x5aa795(0x2cc)]%0x3==0x1?0x4:0x3;let _0x542309=0x0;_0x6fb478[_0x5aa795(0x25b)]((_0x71e132,_0x2eb9e8)=>{const _0x4aff38=_0x5aa795;if(_0x2eb9e8%_0x14fecc==0x0)_0x2ff3b9=[];_0x2ff3b9[_0x4aff38(0x13f)](Markup[_0x4aff38(0x1ca)][_0x4aff38(0x156)](_0x4aff38(0x319)+_0x71e132[_0x4aff38(0x2e9)],_0x4aff38(0x1c2)+_0x71e132[_0x4aff38(0x2e9)])),_0x2eb9e8%_0x14fecc==0x0&&(_0x305055[_0x542309]=_0x2ff3b9,_0x542309++);});const _0xba42de=Markup[_0x5aa795(0x1b1)](_0x305055);_0x47f38d[_0x5aa795(0x14a)](_0x5aa795(0x15e),_0xba42de);}else{const _0x4d67c1=_0x6fb478[0x0][_0x5aa795(0x2e9)];if(pid[_0x4d67c1])pid[_0x4d67c1][_0x5aa795(0x2cb)]({'function':_0x5aa795(0x135),'args':null});}}}),tgBot[_0x4e3c25(0x2c3)](/metrics_(.+)/,async _0x501c95=>{const _0x320005=_0x4e3c25,_0xdcdd07=_0x501c95[_0x320005(0x213)][0x1];_0x501c95[_0x320005(0x26b)]();if(pid[_0xdcdd07])pid[_0xdcdd07][_0x320005(0x2cb)]({'function':_0x320005(0x135),'args':null});}),tgBot['command'](_0x4e3c25(0x12c),async _0x56ad7a=>{const _0x6de855=_0x4e3c25,_0x17b0ab=getEnabledBots();if(_0x17b0ab['length']==0x0)await sendTelegram(_0x56ad7a['chat']['id'],_0x6de855(0x1e3));else{if(_0x17b0ab[_0x6de855(0x2cc)]>0x1){let _0x2976e5=[],_0x39977f=[];const _0x59dfe7=_0x17b0ab[_0x6de855(0x2cc)]%0x4==0x0||_0x17b0ab['length']%0x4==0x3||_0x17b0ab[_0x6de855(0x2cc)]%0x3==0x1?0x4:0x3;let _0x5a87de=0x0;_0x17b0ab[_0x6de855(0x25b)]((_0x769461,_0x23bccf)=>{const _0x363e6a=_0x6de855;if(_0x23bccf%_0x59dfe7==0x0)_0x39977f=[];_0x39977f['push'](Markup['button'][_0x363e6a(0x156)](_0x363e6a(0x319)+_0x769461['botID'],_0x363e6a(0x153)+_0x769461[_0x363e6a(0x2e9)])),_0x23bccf%_0x59dfe7==0x0&&(_0x2976e5[_0x5a87de]=_0x39977f,_0x5a87de++);});const _0x5ab451=Markup[_0x6de855(0x1b1)](_0x2976e5);_0x56ad7a[_0x6de855(0x14a)](_0x6de855(0x205),_0x5ab451);}else{const _0x532036=_0x17b0ab[0x0][_0x6de855(0x2e9)];if(pid[_0x532036])pid[_0x532036][_0x6de855(0x2cb)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x4e3c25(0x2c3)](/portfolio_(.+)/,async _0x19c98c=>{const _0x39f84c=_0x4e3c25,_0x1b02f6=_0x19c98c[_0x39f84c(0x213)][0x1];_0x19c98c['editMessageReplyMarkup']();if(pid[_0x1b02f6])pid[_0x1b02f6][_0x39f84c(0x2cb)]({'function':_0x39f84c(0x29a),'args':null});}),tgBot[_0x4e3c25(0x23f)](_0x4e3c25(0x2b8),async _0x4d2a29=>{const _0x129bd0=_0x4e3c25,_0x138fdb=_0x129bd0(0x2b8);await zipFiles(_0x138fdb);const _0x233ef1=zippath+(_0x138fdb+_0x129bd0(0x2c1));_0x4d2a29[_0x129bd0(0x218)]({'source':_0x233ef1})[_0x129bd0(0x1e8)](()=>{})[_0x129bd0(0x2cd)](_0x35ad50=>logger[_0x129bd0(0x13b)]('Error\x20sending\x20'+_0x138fdb+'\x20files\x20over\x20Telegram:',_0x35ad50));}),tgBot['command'](_0x4e3c25(0x321),async _0x3045d8=>{const _0x4699f0=_0x4e3c25,_0x201417='backup';await backupConfigFiles(),await zipFiles(_0x201417);const _0x4f0dc5=zippath+(_0x201417+_0x4699f0(0x2c1));_0x3045d8[_0x4699f0(0x218)]({'source':_0x4f0dc5})['then'](()=>{})[_0x4699f0(0x2cd)](_0x4923b7=>logger[_0x4699f0(0x13b)]('Error\x20sending\x20'+_0x201417+_0x4699f0(0x123),_0x4923b7));}),tgBot[_0x4e3c25(0x23f)](_0x4e3c25(0x126),async _0x5bcae5=>{const _0x11add9=_0x4e3c25;await getMessages();if(!updateAvailable)await sendTelegram(_0x5bcae5['chat']['id'],_0x11add9(0x27c));else{if(!validInstallation)await sendTelegram(_0x5bcae5['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update');else{const _0x13b34c=Markup['inlineKeyboard']([Markup[_0x11add9(0x1ca)]['callback'](_0x11add9(0x29d),'update_yes'),Markup['button'][_0x11add9(0x156)]('No',_0x11add9(0x2a7))]);_0x5bcae5[_0x11add9(0x14a)](_0x11add9(0x222),_0x13b34c);}}}),tgBot['action'](/update_(.+)/,async _0x403a6e=>{const _0x24a539=_0x4e3c25,_0x5dfc12=_0x403a6e[_0x24a539(0x213)][0x1];_0x403a6e[_0x24a539(0x26b)](),_0x5dfc12==_0x24a539(0x270)&&(await sendTelegram(_0x403a6e[_0x24a539(0x275)]['id'],_0x24a539(0x2d0)),updateBB(_0x24a539(0x126))),_0x5dfc12=='no'&&await sendTelegram(_0x403a6e[_0x24a539(0x275)]['id'],_0x24a539(0x317));}),tgBot[_0x4e3c25(0x23f)](_0x4e3c25(0x187),async _0x310a15=>{const _0x5a9169=_0x4e3c25;if(!validInstallation)await sendTelegram(_0x310a15[_0x5a9169(0x275)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x160a7a=Markup[_0x5a9169(0x1b1)]([Markup[_0x5a9169(0x1ca)]['callback']('Yes',_0x5a9169(0x309)),Markup[_0x5a9169(0x1ca)][_0x5a9169(0x156)]('No','reinstall_no')]);_0x310a15[_0x5a9169(0x14a)](_0x5a9169(0x253),_0x160a7a);}}),tgBot['action'](/reinstall_(.+)/,async _0x32b1ef=>{const _0x60e40b=_0x4e3c25,_0x11dfa5=_0x32b1ef[_0x60e40b(0x213)][0x1];_0x32b1ef[_0x60e40b(0x26b)](),_0x11dfa5==_0x60e40b(0x270)&&(await sendTelegram(_0x32b1ef[_0x60e40b(0x275)]['id'],_0x60e40b(0x2a8)),updateBB('reinstall')),_0x11dfa5=='no'&&await sendTelegram(_0x32b1ef[_0x60e40b(0x275)]['id'],_0x60e40b(0x276));}),tgBot[_0x4e3c25(0x23f)](_0x4e3c25(0x1f3),async _0x16579e=>{const _0x1cdcb4=_0x4e3c25,_0x3de65c=getBotsWithMode();if(_0x3de65c[_0x1cdcb4(0x2cc)]==0x0)await sendTelegram(_0x16579e[_0x1cdcb4(0x275)]['id'],_0x1cdcb4(0x1e3));else{let _0xe6f9d2=[],_0x1b59eb=[];const _0x1dd5ac=0x2;let _0x39137e=0x0;_0x3de65c[_0x1cdcb4(0x25b)]((_0x53a3f5,_0x1df608)=>{const _0x31cbd8=_0x1cdcb4;if(_0x1df608%_0x1dd5ac==0x0)_0x1b59eb=[];_0x1b59eb[_0x31cbd8(0x13f)](Markup[_0x31cbd8(0x1ca)][_0x31cbd8(0x156)](_0x31cbd8(0x319)+_0x53a3f5[_0x31cbd8(0x2e9)]+'\x20('+_0x53a3f5[_0x31cbd8(0x2b0)]+')',_0x31cbd8(0x2e7)+_0x53a3f5[_0x31cbd8(0x2e9)])),_0x1df608%_0x1dd5ac==0x0&&(_0xe6f9d2[_0x39137e]=_0x1b59eb,_0x39137e++);});const _0x1c5d97=Markup['inlineKeyboard'](_0xe6f9d2);_0x16579e[_0x1cdcb4(0x14a)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x1c5d97);}}),tgBot[_0x4e3c25(0x2c3)](/toggle_(.+)/,async _0x31bdbd=>{const _0x1306a2=_0x4e3c25,_0x11b07f=_0x31bdbd[_0x1306a2(0x213)][0x1];_0x31bdbd[_0x1306a2(0x26b)]();const _0x45b42c=getBotsWithMode(),_0x204184=_0x45b42c[_0x1306a2(0x141)](_0x3a9a12=>_0x3a9a12['botID']==_0x11b07f),_0x384ca2=_0x204184[_0x1306a2(0x2b0)]==_0x1306a2(0x2dc)?_0x1306a2(0x14f):'auto';await sendTelegram(_0x31bdbd[_0x1306a2(0x275)]['id'],_0x1306a2(0x1ba)+_0x11b07f+_0x1306a2(0x1dc)+_0x384ca2+_0x1306a2(0x232)),toggleBotMode(_0x11b07f);}),tgBot[_0x4e3c25(0x23f)](_0x4e3c25(0x316),async _0x39ab3c=>{const _0x42470b=_0x4e3c25;let _0x46cc82='';config[_0x42470b(0x25b)](_0x2174f8=>{const _0x4e72e3=_0x42470b;_0x46cc82+='Bot\x20'+_0x2174f8[_0x4e72e3(0x2e9)]+':\x20'+_0x2174f8[_0x4e72e3(0x137)]+'\x0a';}),await sendTelegram(_0x39ab3c[_0x42470b(0x275)]['id'],_0x46cc82,{'parse_mode':_0x42470b(0x1c1)});}),tgBot[_0x4e3c25(0x23f)](_0x4e3c25(0x29b),async _0xbeab46=>{const _0x364147=_0x4e3c25;await sendTelegram(_0xbeab46[_0x364147(0x275)]['id'],_0x49f38a);}),process[_0x4e3c25(0x146)]('SIGINT',()=>tgBot['stop'](_0x4e3c25(0x190))),process[_0x4e3c25(0x146)]('SIGTERM',()=>tgBot[_0x4e3c25(0x136)](_0x4e3c25(0x286))),tgBot[_0x4e3c25(0x298)]();}function disableTelegram(){const _0x497a68=_0x53b0a9;tgBot&&tgBot[_0x497a68(0x136)]();}async function sendTelegram(_0x319a0a,_0x473ff5,_0xb3bd4){const _0x11142c=_0x53b0a9;_0xb3bd4={..._0xb3bd4,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0x11142c(0x301)](_0x319a0a,_0x473ff5,_0xb3bd4);}catch(_0xc08c25){logger['debug']('Telegram\x20error:',_0xc08c25);}}async function sendTelegramBot(_0x2c771b,_0x2d9842){const _0x58cd67=_0x53b0a9;if(settings['telegramEnabled']){if(settings[_0x58cd67(0x315)]==_0x58cd67(0x235)||(_0x2d9842[_0x58cd67(0x288)]==_0x58cd67(0x24e)||_0x2d9842['type']=='warning'||_0x2d9842['type']==_0x58cd67(0x2ba))&&settings[_0x58cd67(0x315)]==_0x58cd67(0x193)||_0x2d9842['type']=='order'&&settings[_0x58cd67(0x315)]==_0x58cd67(0x147)){if(tgBot&&settings[_0x58cd67(0x196)]){if(_0x2d9842[_0x58cd67(0x176)])await sendTelegram(settings[_0x58cd67(0x196)],_0x2d9842[_0x58cd67(0x137)]+_0x58cd67(0x2bb)+_0x2d9842[_0x58cd67(0x1d0)]);else await sendTelegram(settings[_0x58cd67(0x196)],_0x58cd67(0x319)+_0x2c771b+'\x20>\x20'+_0x2d9842[_0x58cd67(0x1d0)]);}}}}async function sendTelegramMsg(_0x5d8c05,_0x221152=_0x53b0a9(0x1c1)){const _0x28b462=_0x53b0a9;return settings[_0x28b462(0x26f)]&&tgBot&&settings[_0x28b462(0x196)]?(await sendTelegram(settings['telegramChatId'],_0x5d8c05,{'parse_mode':_0x221152}),!![]):![];}function getDeviceWithIp(_0x502e29){const _0xf01fc9=_0x53b0a9;return devices[_0xf01fc9(0x141)](_0x1d8724=>_0x1d8724['ip']===_0x502e29);}async function temporaryAccess2FA(_0x15d650,_0x3559da){const _0x410b0f=_0x53b0a9;let _0x2fd38d=new Date(),_0x33ff5b=![];if(lastIpApproval){if(_0x2fd38d-lastIpApproval<0x1388)_0x33ff5b=!![];}lastIpApproval=new Date();if(_0x33ff5b)return;if(tgBot&&settings[_0x410b0f(0x196)]){const _0x2bf1cd=uuidRandom();tmpStorage[_0x2bf1cd]={'uuid':_0x15d650,'externalip':_0x3559da};const _0x4c2d80=Markup[_0x410b0f(0x1b1)]([Markup[_0x410b0f(0x1ca)][_0x410b0f(0x156)](_0x410b0f(0x13d),'tempaccess_5_'+_0x2bf1cd),Markup[_0x410b0f(0x1ca)][_0x410b0f(0x156)]('15\x20min','tempaccess_15_'+_0x2bf1cd),Markup[_0x410b0f(0x1ca)][_0x410b0f(0x156)](_0x410b0f(0x2fe),'tempaccess_30_'+_0x2bf1cd),Markup[_0x410b0f(0x1ca)][_0x410b0f(0x156)](_0x410b0f(0x1cc),'tempaccess_reject_'+_0x2bf1cd)]);await sendTelegram(settings['telegramChatId'],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x3559da)['show']+'\x20?',_0x4c2d80),tgBot[_0x410b0f(0x2c3)](/tempaccess_(.+)_(.+)/,async _0x37bc8e=>{const _0xf66d85=_0x410b0f,_0x5d670a=_0x37bc8e['match'][0x1],_0x5253dd=_0x37bc8e[_0xf66d85(0x213)][0x2],{uuid:_0x4d6633,externalip:_0x7972d0}=tmpStorage[_0x5253dd];delete tmpStorage[_0x5253dd],_0x37bc8e[_0xf66d85(0x26b)](),devices[_0x4d6633]['telegramIpApproval']={'clientip':_0x7972d0,'timestamp':new Date()[_0xf66d85(0x185)](),'expiry':_0x5d670a},_0x5d670a!=_0xf66d85(0x1cc)?(await sendTelegram(_0x37bc8e[_0xf66d85(0x275)]['id'],_0xf66d85(0x1a0)+_0x5d670a+_0xf66d85(0x22e),{'parse_mode':'HTML'}),io['to'](_0x4d6633)['emit'](_0xf66d85(0x2ee),{'access':{'allow':![],'reason':_0xf66d85(0x242),'token':null}})):(await sendTelegram(_0x37bc8e[_0xf66d85(0x275)]['id'],_0xf66d85(0x2d4)),io['to'](_0x4d6633)[_0xf66d85(0x12e)]('status',{'access':{'allow':![],'reason':_0xf66d85(0x17c),'token':null}}));});}}async function loginAccess2FA(_0xa6758e,_0x4e48a9){const _0xf8894=_0x53b0a9;if(tgBot&&settings[_0xf8894(0x196)]){const _0x1ffd63=uuidRandom();tmpStorage[_0x1ffd63]={'uuid':_0xa6758e,'externalip':_0x4e48a9};const _0xffda5e=Markup['inlineKeyboard']([Markup[_0xf8894(0x1ca)]['callback']('accept',_0xf8894(0x30f)+loginExpiry+'_'+_0x1ffd63),Markup['button'][_0xf8894(0x156)]('reject','login2fa_reject_'+_0x1ffd63)]);await sendTelegram(settings[_0xf8894(0x196)],_0xf8894(0x27b)+normalizeIP(_0x4e48a9)['show']+'\x20?',_0xffda5e),tgBot[_0xf8894(0x2c3)](/login2fa_(.+)_(.+)/,async _0x3adce5=>{const _0x3e5b27=_0xf8894,_0x4221c0=_0x3adce5['match'][0x1],_0x7aa0bc=_0x3adce5['match'][0x2],{uuid:_0x5043df,externalip:_0x48b7ce}=tmpStorage[_0x7aa0bc];delete tmpStorage[_0x7aa0bc],_0x3adce5[_0x3e5b27(0x26b)](),devices[_0x5043df][_0x3e5b27(0x160)]={'clientip':_0x48b7ce,'timestamp':new Date()[_0x3e5b27(0x185)](),'expiry':_0x4221c0},_0x4221c0!=_0x3e5b27(0x1cc)?(await sendTelegram(_0x3adce5['chat']['id'],_0x3e5b27(0x32a),{'parse_mode':_0x3e5b27(0x1c1)}),io['to'](_0x5043df)[_0x3e5b27(0x12e)](_0x3e5b27(0x2ee),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x3adce5[_0x3e5b27(0x275)]['id'],'Login\x20rejected'),io['to'](_0x5043df)['emit'](_0x3e5b27(0x2ee),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x6d96ce=_0x53b0a9;return dbConfig[_0x6d96ce(0x1ed)]('bots')[_0x6d96ce(0x2e3)]('botID')[_0x6d96ce(0x2b1)]({'status':_0x6d96ce(0x337)})[_0x6d96ce(0x289)]()||[];}function getDisabledBots(){const _0x2381ef=_0x53b0a9;return dbConfig[_0x2381ef(0x1ed)](_0x2381ef(0x172))[_0x2381ef(0x2e3)](_0x2381ef(0x2e9))[_0x2381ef(0x2b1)]({'status':'disabled'})['value']()||[];}function getBotAttributes(_0x4752cf){const _0x43c68c=_0x53b0a9;let _0xa648bd={};const _0x5e2295=configpath+_0x43c68c(0x2cf)+_0x4752cf+_0x43c68c(0x175),_0x5082f8=fs[_0x43c68c(0x12f)](_0x5e2295);if(_0x5082f8){const _0x31c30e=fs[_0x43c68c(0x24d)](_0x5e2295);try{const _0x3c3dc9=JSON[_0x43c68c(0x1e0)](_0x31c30e),_0x2567a5=_0x3c3dc9?_0x3c3dc9[_0x43c68c(0x250)][0x0][_0x43c68c(0x25e)]:![];_0xa648bd[_0x43c68c(0x2b0)]=_0x2567a5?_0x43c68c(0x2dc):_0x43c68c(0x14f),_0xa648bd[_0x43c68c(0x137)]=_0x3c3dc9?_0x3c3dc9['bot'][0x0][_0x43c68c(0x137)]:'Bot\x20'+_0x4752cf;}catch(_0x16eacf){_0xa648bd[_0x43c68c(0x2b0)]=_0x43c68c(0x14f),_0xa648bd[_0x43c68c(0x137)]=_0x43c68c(0x319)+_0x4752cf;}}else _0xa648bd[_0x43c68c(0x2b0)]='manual',_0xa648bd[_0x43c68c(0x137)]=_0x43c68c(0x319)+_0x4752cf;return _0xa648bd;}function getBotsWithMode(){const _0x361a3e=_0x53b0a9,_0x275704=dbConfig[_0x361a3e(0x1ed)](_0x361a3e(0x172))['sortBy']('botID')[_0x361a3e(0x289)]()||[];return _0x275704[_0x361a3e(0x25b)](_0x2626ae=>{const _0x3c1df5=_0x361a3e;let _0x1f8b73=getBotAttributes(_0x2626ae[_0x3c1df5(0x2e9)]);_0x2626ae['mode']=_0x1f8b73[_0x3c1df5(0x2b0)];}),_0x275704;}function getBotExchanges(){const _0x5a7075=_0x53b0a9;let _0x4326a7=[];const _0x184c6c=dbConfig[_0x5a7075(0x1ed)](_0x5a7075(0x172))[_0x5a7075(0x2e3)]('botID')[_0x5a7075(0x289)]()||[];_0x184c6c[_0x5a7075(0x25b)](_0x218ec6=>{const _0x16f8b0=_0x5a7075;if(_0x218ec6['status']==_0x16f8b0(0x337)){const _0x242d2b=configpath+_0x16f8b0(0x2cf)+_0x218ec6[_0x16f8b0(0x2e9)]+_0x16f8b0(0x175),_0x197ab7=fs[_0x16f8b0(0x12f)](_0x242d2b);let _0x499970;if(_0x197ab7){const _0x4b2e18=fs[_0x16f8b0(0x24d)](_0x242d2b);try{const _0x263301=JSON[_0x16f8b0(0x1e0)](_0x4b2e18);_0x499970=_0x263301?_0x263301[_0x16f8b0(0x250)][0x0]['exchange']:null;}catch(_0x4432dd){}}if(_0x499970)_0x4326a7[_0x16f8b0(0x13f)](_0x499970);}});const _0x3cc271=[...new Set(_0x4326a7)][_0x5a7075(0x251)]();return _0x3cc271;}async function initUser(){const _0x5c25cd=_0x53b0a9;if(!settings[_0x5c25cd(0x16e)]){const _0x10c03c=uuidRandom();mixpanel[_0x5c25cd(0x25d)](_0x10c03c),updateSetting('userid',_0x10c03c);}}async function initSecure(){const _0x3b5281=_0x53b0a9;let _0x3638e6=getSecure();if(!_0x3638e6['hasOwnProperty'](_0x3b5281(0x2d5))){let _0x4cc3b4=await generateKeys();_0x3638e6[_0x3b5281(0x334)]=_0x4cc3b4[_0x3b5281(0x334)],_0x3638e6[_0x3b5281(0x258)]=_0x4cc3b4[_0x3b5281(0x258)],_0x3638e6['secret']=crypto[_0x3b5281(0x2c8)](0x20)[_0x3b5281(0x198)]('hex');;storeSecure(_0x3638e6);}}function getSettings(){const _0x44ae4c=_0x53b0a9;return dbSettings[_0x44ae4c(0x1ed)](_0x44ae4c(0x27a))[_0x44ae4c(0x289)]()||{};}function getSecure(){const _0x518e9f=_0x53b0a9;return dbSecure[_0x518e9f(0x1ed)](_0x518e9f(0x1b8))['value']()||{};}function getBlacklist(){const _0x3a4981=_0x53b0a9;return dbSecure[_0x3a4981(0x1ed)](_0x3a4981(0x2c4))['value']()||[];}function broadcastToBots(_0x401255,_0x467b50){const _0x355f82=_0x53b0a9;config[_0x355f82(0x25b)](_0x155cb8=>{const _0xafa6c1=_0x355f82;if(_0x155cb8[_0xafa6c1(0x2ee)]==_0xafa6c1(0x337)&&_0x155cb8['live']=='running'||_0x155cb8[_0xafa6c1(0x2ee)]=='new'&&_0x155cb8[_0xafa6c1(0x30b)]==_0xafa6c1(0x287)){if(pid[_0x155cb8[_0xafa6c1(0x2e9)]])pid[_0x155cb8[_0xafa6c1(0x2e9)]][_0xafa6c1(0x2cb)]({[_0x401255]:_0x467b50});}});}async function storeSettings(_0x3eda87,_0x1c167b=![]){const _0x5bc76e=_0x53b0a9;_0x3eda87={...settings,..._0x3eda87};if(_0x1c167b&&_0x3eda87[_0x5bc76e(0x322)]!=_0x5bc76e(0x247)&&_0x3eda87[_0x5bc76e(0x322)]!='***'&&_0x3eda87[_0x5bc76e(0x322)]!=''){const _0x5ae842=decryptRSA(secure['privateKey'],_0x3eda87[_0x5bc76e(0x322)])[_0x5bc76e(0x336)]('|@|')[0x0],_0x3920d9=bcrypt[_0x5bc76e(0x1df)](_0x5ae842,saltRounds);_0x3eda87={..._0x3eda87,'bbPassword':_0x3920d9};}if(_0x1c167b&&_0x3eda87[_0x5bc76e(0x31c)]!='************'&&_0x3eda87[_0x5bc76e(0x31c)]!=_0x5bc76e(0x171)&&_0x3eda87[_0x5bc76e(0x31c)]!=''){const _0x1c8989=decryptRSA(secure['privateKey'],_0x3eda87['telegramToken'])[_0x5bc76e(0x336)]('|@|')[0x0];_0x3eda87={..._0x3eda87,'telegramToken':_0x1c8989};}if(_0x1c167b&&_0x3eda87[_0x5bc76e(0x1bf)]!='************'&&_0x3eda87[_0x5bc76e(0x1bf)]!=_0x5bc76e(0x171)&&_0x3eda87['marketcapApi']!=''){const _0x2efc71=decryptRSA(secure[_0x5bc76e(0x258)],_0x3eda87[_0x5bc76e(0x1bf)])['split']('|@|')[0x0];_0x3eda87={..._0x3eda87,'marketcapApi':_0x2efc71};}const _0x46112d=_0x3eda87[_0x5bc76e(0x31c)]!=_0x5bc76e(0x247)&&_0x3eda87['telegramToken']!=settings[_0x5bc76e(0x31c)]||_0x3eda87[_0x5bc76e(0x274)]!=settings[_0x5bc76e(0x274)],_0x467d14=_0x3eda87[_0x5bc76e(0x31c)]==''||_0x3eda87['telegramUsername']=='',_0x29402a=_0x3eda87[_0x5bc76e(0x1bf)]&&_0x3eda87[_0x5bc76e(0x1bf)]!=_0x5bc76e(0x247)&&_0x3eda87[_0x5bc76e(0x1bf)]!=settings[_0x5bc76e(0x1bf)];_0x46112d&&(_0x3eda87[_0x5bc76e(0x196)]=null,_0x3eda87['telegramEvents']=_0x5bc76e(0x235));for(const [_0x245220,_0x4e6855]of Object[_0x5bc76e(0x18b)](_0x3eda87)){if(_0x245220==_0x5bc76e(0x31c)&&_0x4e6855==_0x5bc76e(0x247)){_0x3eda87['telegramToken']=settings[_0x5bc76e(0x31c)];continue;};if(_0x245220==_0x5bc76e(0x322)&&_0x4e6855==_0x5bc76e(0x247)){_0x3eda87[_0x5bc76e(0x322)]=settings[_0x5bc76e(0x322)];continue;};if(_0x245220==_0x5bc76e(0x1bf)&&_0x4e6855=='************'){_0x3eda87[_0x5bc76e(0x1bf)]=settings[_0x5bc76e(0x1bf)];continue;};dbSettings[_0x5bc76e(0x2fb)]('settings.'+_0x245220,_0x4e6855)[_0x5bc76e(0x300)]();}settings=_0x3eda87,io['to'](_0x5bc76e(0x1e9))[_0x5bc76e(0x12e)](_0x5bc76e(0x27a),cleanSettings()),broadcastToBots(_0x5bc76e(0x173),settings[_0x5bc76e(0x173)]),broadcastToBots('onepagemode',settings['onepagemode']),broadcastToBots('marketcapApi',settings[_0x5bc76e(0x1bf)]);if(_0x46112d&&!_0x467d14)initTelegram();_0x46112d&&_0x467d14&&(updateSetting(_0x5bc76e(0x196),null),disableTelegram()),getAllClients()[_0x5bc76e(0x25b)](_0x1f6e58=>{const _0x1eec46=_0x5bc76e;getSocket(_0x1f6e58['id'])[_0x1eec46(0x12e)](_0x1eec46(0x2ee),{'access':{'allow':![],'reason':_0x1eec46(0x242),'token':null}});}),_0x29402a&&(await sleep(0xbb8),testMarketcapApi(_0x3eda87[_0x5bc76e(0x1bf)]));}async function testMarketcapApi(_0x6cdc19){const _0x4bcda2=_0x53b0a9,_0xf11554=['BCT',_0x4bcda2(0x2f9)];try{await axios['get'](_0x4bcda2(0x261),{'headers':{'X-CMC_PRO_API_KEY':_0x6cdc19},'params':{'symbol':_0xf11554[_0x4bcda2(0x198)]()}});}catch(_0x3c8775){_0x3c8775[_0x4bcda2(0x198)]()[_0x4bcda2(0x1f2)]('status\x20code\x20401')?(io['to']('botmanager')['emit']('notification',_0x4bcda2(0x229)),logger['full']('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to']('botmanager')[_0x4bcda2(0x12e)](_0x4bcda2(0x1a8),'CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x4bcda2(0x17f)](_0x4bcda2(0x2ef)),logger[_0x4bcda2(0x13b)](_0x4bcda2(0x1b4),_0x3c8775[_0x4bcda2(0x198)]()+_0x4bcda2(0x2e1)+_0x3c8775['code']));return;}logger[_0x4bcda2(0x13b)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x58bcf0,_0x23fe3e){const _0x54e3c0=_0x53b0a9;dbSettings[_0x54e3c0(0x2fb)](_0x54e3c0(0x157)+_0x58bcf0,_0x23fe3e)[_0x54e3c0(0x300)](),settings=getSettings(),io['to'](_0x54e3c0(0x1e9))[_0x54e3c0(0x12e)](_0x54e3c0(0x27a),cleanSettings());}function storeSecure(_0x2dfe5a){const _0x15dc74=_0x53b0a9;dbSecure[_0x15dc74(0x1ed)](_0x15dc74(0x1b8))[_0x15dc74(0x13f)](_0x2dfe5a)[_0x15dc74(0x300)](),secure=_0x2dfe5a;}function addBlacklist(_0x3dbcc2){const _0xb43365=_0x53b0a9;cleanBlacklist();let _0x551e19;devices[_0x3dbcc2][_0xb43365(0x1aa)]?_0x551e19=Math[_0xb43365(0x209)](devices[_0x3dbcc2][_0xb43365(0x1aa)][_0xb43365(0x224)],loginExpiry):_0x551e19=loginExpiry,dbSecure[_0xb43365(0x1ed)](_0xb43365(0x2c4))['push']({'expiry':new Date()[_0xb43365(0x185)]()+_0x551e19*0x3c*0x3e8,'token':devices[_0x3dbcc2][_0xb43365(0x2bf)][_0xb43365(0x281)]})['write'](),blacklist=dbSecure['get'](_0xb43365(0x2c4))[_0xb43365(0x289)]();}function cleanBlacklist(){const _0x193157=_0x53b0a9;let _0x31b8bb=dbSecure[_0x193157(0x1ed)](_0x193157(0x2c4))[_0x193157(0x27f)]()[_0x193157(0x289)](),_0x47ddf0=new Date()[_0x193157(0x185)]();_0x31b8bb[_0x193157(0x25b)](_0x5ab751=>{const _0x23a053=_0x193157;_0x5ab751['expiry']<_0x47ddf0&&dbSecure[_0x23a053(0x1ed)](_0x23a053(0x2c4))['remove']({'expiry':_0x5ab751[_0x23a053(0x224)]})[_0x23a053(0x300)]();});}function initStates(){let _0x29a78d=getConfiguration();_0x29a78d['forEach'](_0x4ca935=>{const _0x87c81d=_0x1653;_0x4ca935['live']=_0x87c81d(0x161);}),storeConfiguration(_0x29a78d);}async function generateKeys(){const _0x2d8379=_0x53b0a9,_0x563ba8=forge[_0x2d8379(0x32f)][_0x2d8379(0x25c)][_0x2d8379(0x15a)]({'bits':0x1000,'e':0x10001}),_0x49fa14=forge[_0x2d8379(0x32f)]['privateKeyToPem'](_0x563ba8[_0x2d8379(0x258)]),_0x22f0e0=forge['pki'][_0x2d8379(0x148)](_0x563ba8[_0x2d8379(0x334)]);return{'privateKey':_0x49fa14,'publicKey':_0x22f0e0};}async function oneTimeMigration(){const _0x4e911b=_0x53b0a9;let _0x9da1fb=getSettings(),_0x2d22ed=![];!_0x9da1fb[_0x4e911b(0x2f4)]('lastmsgtelegram')&&(_0x9da1fb[_0x4e911b(0x151)]=0x0,_0x2d22ed=!![]);!_0x9da1fb[_0x4e911b(0x2f4)](_0x4e911b(0x32b))&&(_0x9da1fb[_0x4e911b(0x32b)]=0x0,_0x2d22ed=!![]);!_0x9da1fb[_0x4e911b(0x2f4)]('latestversion')&&(_0x9da1fb['latestversion']=_0x4e911b(0x162),_0x2d22ed=!![]);!_0x9da1fb[_0x4e911b(0x2f4)]('onepagemode')&&(_0x9da1fb['onepagemode']=![],_0x2d22ed=!![]);!_0x9da1fb['hasOwnProperty']('marketcapApi')&&(_0x9da1fb[_0x4e911b(0x1bf)]='',_0x2d22ed=!![]);if(_0x2d22ed)storeSettings(_0x9da1fb);try{fs[_0x4e911b(0x2dd)](configbackuppath,{'withFileTypes':!![]})[_0x4e911b(0x25b)](_0x351948=>{const _0x4f139c=_0x4e911b;if(!_0x351948[_0x4f139c(0x15d)]()){if(!_0x351948[_0x4f139c(0x19e)][_0x4f139c(0x223)](_0x4f139c(0x1fd)))fs[_0x4f139c(0x282)](configbackuppath+_0x351948[_0x4f139c(0x19e)]);}else fs[_0x4f139c(0x1fc)](configbackuppath+_0x351948['name'],{'recursive':!![]});});}catch(_0x180237){logger[_0x4e911b(0x13b)](_0x4e911b(0x2d9),_0x180237);}}function storeConfiguration(_0x75a414){const _0x51bc5b=_0x53b0a9;dbConfig[_0x51bc5b(0x1ed)](_0x51bc5b(0x172))['remove']()[_0x51bc5b(0x300)](),dbConfig[_0x51bc5b(0x1ed)]('bots')[_0x51bc5b(0x13f)](..._0x75a414)['write'](),config=_0x75a414;}async function resetPassword(){const _0x3b1f52=_0x53b0a9;if(tgBot&&settings[_0x3b1f52(0x196)]){const _0x24886e=Markup[_0x3b1f52(0x1b1)]([Markup[_0x3b1f52(0x1ca)]['callback'](_0x3b1f52(0x270),'resetpw_yes'),Markup[_0x3b1f52(0x1ca)]['callback']('no',_0x3b1f52(0x1f1))]);await sendTelegram(settings[_0x3b1f52(0x196)],_0x3b1f52(0x2fc),_0x24886e),tgBot['action'](/resetpw_(.+)/,async _0x20d2a9=>{const _0x3b3df8=_0x3b1f52,_0x1c95d9=_0x20d2a9['match'][0x1];_0x20d2a9[_0x3b3df8(0x26b)]();if(_0x1c95d9!='no'){const _0x4f45fa=0xf,_0x18b829=_0x3b3df8(0x1ab),_0x107f7a=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x4f45fa)))[_0x3b3df8(0x1db)](_0x481a9a=>_0x18b829[_0x481a9a%_0x18b829[_0x3b3df8(0x2cc)]])[_0x3b3df8(0x264)](''),_0x50eb4e=bcrypt[_0x3b3df8(0x1df)](_0x107f7a,saltRounds);storeSettings({'bbPassword':_0x50eb4e}),await sendTelegram(_0x20d2a9[_0x3b3df8(0x275)]['id'],_0x3b3df8(0x1f8)+_0x107f7a,{'parse_mode':_0x3b3df8(0x1c1)});}else await sendTelegram(_0x20d2a9[_0x3b3df8(0x275)]['id'],_0x3b3df8(0x2b7));});}}async function confirmRestore(_0x4680ad,_0x235b97){const _0x1df0a5=_0x53b0a9;io['to'](_0x1df0a5(0x1e9))[_0x1df0a5(0x12e)]('notification',_0x1df0a5(0x22f),_0x1df0a5(0x2ba));if(tgBot&&settings[_0x1df0a5(0x196)]){const _0x4a8fd1=uuidRandom();tmpStorage[_0x4a8fd1]={'path':_0x4680ad,'filename':_0x235b97};const _0x52b64f=Markup[_0x1df0a5(0x1b1)]([Markup[_0x1df0a5(0x1ca)][_0x1df0a5(0x156)](_0x1df0a5(0x270),_0x1df0a5(0x1cd)+_0x4a8fd1),Markup[_0x1df0a5(0x1ca)][_0x1df0a5(0x156)]('no',_0x1df0a5(0x273)+_0x4a8fd1)]);await sendTelegram(settings['telegramChatId'],_0x1df0a5(0x132),_0x52b64f),tgBot[_0x1df0a5(0x2c3)](/restore_(.+)_(.+)/,async _0x489481=>{const _0x308b4b=_0x1df0a5,_0xadb9a1=_0x489481['match'][0x1],_0x2fcbd3=_0x489481[_0x308b4b(0x213)][0x2],{path:_0x51fb11,filename:_0x496bc1}=tmpStorage[_0x2fcbd3];delete tmpStorage[_0x2fcbd3],_0x489481[_0x308b4b(0x26b)](),_0xadb9a1==_0x308b4b(0x270)?(logger[_0x308b4b(0x13b)](_0x308b4b(0x186)),await sendTelegram(_0x489481[_0x308b4b(0x275)]['id'],'Restoring\x20bot(s)\x20from\x20backup',{'parse_mode':'HTML'}),unzipFile(_0x51fb11,_0x496bc1)):(logger[_0x308b4b(0x13b)](_0x308b4b(0x292)),await sendTelegram(_0x489481[_0x308b4b(0x275)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x368cfc=_0x53b0a9,_0x1e9abe=new Date();return _0x1e9abe[_0x368cfc(0x1b0)]()+'/'+(_0x1e9abe[_0x368cfc(0x1c5)]()+0x1)[_0x368cfc(0x198)]()[_0x368cfc(0x212)](0x2,'0')+'/'+_0x1e9abe[_0x368cfc(0x2e4)]()[_0x368cfc(0x198)]()[_0x368cfc(0x212)](0x2,'0')+'\x20'+_0x1e9abe[_0x368cfc(0x2f5)]()[_0x368cfc(0x198)]()[_0x368cfc(0x212)](0x2,'0')+':'+_0x1e9abe['getMinutes']()[_0x368cfc(0x198)]()[_0x368cfc(0x212)](0x2,'0')+':'+_0x1e9abe[_0x368cfc(0x1e5)]()['toString']()[_0x368cfc(0x212)](0x2,'0');}function getTimeStamp(){const _0x1fa48c=_0x53b0a9,_0x1a4c00=shiftedTime();return _0x1a4c00[_0x1fa48c(0x1b0)]()+'/'+(_0x1a4c00['getMonth']()+0x1)['toString']()[_0x1fa48c(0x212)](0x2,'0')+'/'+_0x1a4c00['getDate']()[_0x1fa48c(0x198)]()[_0x1fa48c(0x212)](0x2,'0')+'\x20'+_0x1a4c00[_0x1fa48c(0x2f5)]()[_0x1fa48c(0x198)]()[_0x1fa48c(0x212)](0x2,'0')+':'+_0x1a4c00[_0x1fa48c(0x32c)]()[_0x1fa48c(0x198)]()[_0x1fa48c(0x212)](0x2,'0')+':'+_0x1a4c00[_0x1fa48c(0x1e5)]()[_0x1fa48c(0x198)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x33f084=_0x53b0a9,_0x957b8e=shiftedTime();return _0x957b8e[_0x33f084(0x1b0)]()+(_0x957b8e[_0x33f084(0x1c5)]()+0x1)['toString']()[_0x33f084(0x212)](0x2,'0')+_0x957b8e[_0x33f084(0x2e4)]()[_0x33f084(0x198)]()[_0x33f084(0x212)](0x2,'0')+'-'+_0x957b8e['getHours']()[_0x33f084(0x198)]()[_0x33f084(0x212)](0x2,'0')+_0x957b8e[_0x33f084(0x32c)]()[_0x33f084(0x198)]()[_0x33f084(0x212)](0x2,'0')+_0x957b8e['getSeconds']()[_0x33f084(0x198)]()[_0x33f084(0x212)](0x2,'0');}function shiftedTime(){const _0x21b7ee=_0x53b0a9,_0x446824=new Date();let _0x1f5907=_0x446824;if(settings[_0x21b7ee(0x173)]&&settings[_0x21b7ee(0x173)]!==0x0)_0x1f5907=fns[_0x21b7ee(0x333)](_0x446824,{'hours':settings[_0x21b7ee(0x173)]});return _0x1f5907;}async function startScheduler(){const _0x253d5a=_0x53b0a9,_0x4fa375=new Date()[_0x253d5a(0x28f)](),_0x1ad5ef=shiftedTime()[_0x253d5a(0x2f5)]();_0x1ad5ef==0x4&&backupConfigFiles(),_0x1ad5ef==0x0&&(rotateLogFiles(),logger[_0x253d5a(0x13b)](_0x253d5a(0x159)),logger[_0x253d5a(0x13b)](_0x253d5a(0x1d5)+serverversion+_0x253d5a(0x325)+(environment==_0x253d5a(0x14c)?_0x253d5a(0x30d):'')),logger[_0x253d5a(0x13b)](_0x253d5a(0x159))),_0x4fa375%0x6==0x0&&triggerAnalytics(),_0x4fa375%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x19f695){const _0x454562=_0x53b0a9;logger[_0x454562(0x13b)](_0x454562(0x220)+_0x19f695);const _0x52b4a3=getBotsWithMode();_0x52b4a3[_0x454562(0x2cc)]>0x0?confirmRestore(configbackuppath,_0x19f695):unzipFile(configbackuppath,_0x19f695);}async function getBackupFiles(_0x24a1a2=null){const _0x38fe6b=_0x53b0a9;let _0x4387de=[],_0x26b0d9=fs[_0x38fe6b(0x2dd)](configbackuppath,{'withFileTypes':!![]});_0x26b0d9[_0x38fe6b(0x251)]((_0x46b058,_0x4086df)=>_0x46b058[_0x38fe6b(0x19e)]<_0x4086df[_0x38fe6b(0x19e)]?0x1:_0x4086df[_0x38fe6b(0x19e)]<_0x46b058['name']?-0x1:0x0),_0x26b0d9['forEach'](_0xd0f3df=>{const _0x44325d=_0x38fe6b;if(!_0xd0f3df[_0x44325d(0x15d)]()&&_0xd0f3df[_0x44325d(0x19e)][_0x44325d(0x223)]('backup-full@')&&_0xd0f3df[_0x44325d(0x19e)][_0x44325d(0x1cf)](_0x44325d(0x2c1))){const _0x2d5b83=formatDate(fs['statSync'](configbackuppath+_0xd0f3df[_0x44325d(0x19e)])[_0x44325d(0x1ae)]);_0x4387de['push']({'name':_0xd0f3df[_0x44325d(0x19e)],'mtime':_0x2d5b83});}});if(_0x24a1a2)io['to'](_0x24a1a2)[_0x38fe6b(0x12e)](_0x38fe6b(0x14e),_0x4387de);else return _0x4387de;}async function backupConfigFiles(){const _0x210fd1=_0x53b0a9;await zipFiles('backup-full');const _0x1558a6=getCleanTimeStamp();fs[_0x210fd1(0x231)](zippath+_0x210fd1(0x2be),configbackuppath+(_0x210fd1(0x1fd)+_0x1558a6+_0x210fd1(0x2c1)));let _0xdd4805=fs[_0x210fd1(0x2dd)](configbackuppath,{'withFileTypes':!![]});_0xdd4805[_0x210fd1(0x251)]((_0x1794f7,_0x51669c)=>_0x1794f7['name']<_0x51669c['name']?0x1:_0x51669c[_0x210fd1(0x19e)]<_0x1794f7['name']?-0x1:0x0),_0xdd4805[_0x210fd1(0x2cc)]>maxBackups&&fs[_0x210fd1(0x282)](configbackuppath+_0xdd4805[_0xdd4805[_0x210fd1(0x2cc)]-0x1][_0x210fd1(0x19e)]);}function rotateLogFiles(){const _0x55e155=_0x53b0a9,_0x5b72c7=fs[_0x55e155(0x23b)](logspath+_0x55e155(0x29c)),_0x1877aa=_0x5b72c7[_0x55e155(0x26c)]/0x400;if(_0x1877aa>0x64){let _0x404f91=fs[_0x55e155(0x2dd)](logspath,{'withFileTypes':!![]});_0x404f91[_0x55e155(0x251)]((_0x5abe93,_0xbd7f1d)=>_0x5abe93[_0x55e155(0x19e)]<_0xbd7f1d[_0x55e155(0x19e)]?0x1:_0xbd7f1d['name']<_0x5abe93[_0x55e155(0x19e)]?-0x1:0x0),_0x404f91['forEach'](_0x25972c=>{const _0xa33f1b=_0x55e155;if(_0x25972c['name']==_0xa33f1b(0x154))fs[_0xa33f1b(0x231)](logspath+_0x25972c[_0xa33f1b(0x19e)],logspath+'output-003.log');if(_0x25972c[_0xa33f1b(0x19e)]==_0xa33f1b(0x2f8))fs[_0xa33f1b(0x231)](logspath+_0x25972c[_0xa33f1b(0x19e)],logspath+_0xa33f1b(0x154));_0x25972c[_0xa33f1b(0x19e)]==_0xa33f1b(0x29c)&&(fs[_0xa33f1b(0x231)](logspath+_0x25972c[_0xa33f1b(0x19e)],logspath+'output-001.log'),fs['writeFileSync'](logspath+_0x25972c[_0xa33f1b(0x19e)],''));});}}async function zipFiles(_0x20fb91){const _0x9535cc=_0x53b0a9;let _0x316b01;if(_0x20fb91==_0x9535cc(0x2b8))_0x316b01=logspath;if(_0x20fb91==_0x9535cc(0x321))_0x316b01=configpath;if(_0x20fb91==_0x9535cc(0x1bc))_0x316b01=configpath;let _0xb612c=fs['readdirSync'](_0x316b01,{'withFileTypes':!![]});const _0xef46b2=new JSZip();_0xb612c[_0x9535cc(0x25b)](_0xb5df64=>{const _0x4f487e=_0x9535cc;if(!_0xb5df64['isDirectory']()){let _0x422f15=fs[_0x4f487e(0x24d)](_0x316b01+_0xb5df64[_0x4f487e(0x19e)]);if(_0x20fb91==_0x4f487e(0x321)){const _0x28f7e7=/^bot-[0-9]{3}-config.json$/,_0x3e686f=_0x28f7e7[_0x4f487e(0x1a1)](_0xb5df64[_0x4f487e(0x19e)]);if(_0x3e686f){const _0x18560c=JSON[_0x4f487e(0x1e0)](_0x422f15);if(_0x18560c[_0x4f487e(0x250)][0x0]){_0x18560c[_0x4f487e(0x250)][0x0][_0x4f487e(0x207)]=_0x4f487e(0x171),_0x18560c['bot'][0x0][_0x4f487e(0x338)]=_0x4f487e(0x171);if(_0x18560c[_0x4f487e(0x250)][0x0][_0x4f487e(0x2fd)])_0x18560c[_0x4f487e(0x250)][0x0][_0x4f487e(0x2fd)]=_0x4f487e(0x171);}_0x422f15=JSON['stringify'](_0x18560c,null,0x2);}if(_0xb5df64[_0x4f487e(0x19e)]==_0x4f487e(0x303)){const _0x140be1=JSON[_0x4f487e(0x1e0)](_0x422f15);if(_0x140be1[_0x4f487e(0x27a)][_0x4f487e(0x125)])_0x140be1['settings'][_0x4f487e(0x125)]=![];if(_0x140be1['settings'][_0x4f487e(0x322)])_0x140be1[_0x4f487e(0x27a)][_0x4f487e(0x322)]=_0x4f487e(0x171);if(_0x140be1[_0x4f487e(0x27a)][_0x4f487e(0x31c)])_0x140be1[_0x4f487e(0x27a)][_0x4f487e(0x31c)]=_0x4f487e(0x171);if(_0x140be1[_0x4f487e(0x27a)][_0x4f487e(0x196)])_0x140be1[_0x4f487e(0x27a)][_0x4f487e(0x196)]=null;if(_0x140be1['settings'][_0x4f487e(0x1bf)])_0x140be1[_0x4f487e(0x27a)][_0x4f487e(0x1bf)]=_0x4f487e(0x171);_0x422f15=JSON[_0x4f487e(0x21f)](_0x140be1,null,0x2);}if(_0xb5df64[_0x4f487e(0x19e)]!=_0x4f487e(0x30a))_0xef46b2[_0x4f487e(0x310)](_0xb5df64['name'],_0x422f15);}else _0xef46b2[_0x4f487e(0x310)](_0xb5df64[_0x4f487e(0x19e)],_0x422f15);}});const _0x11d893=await _0xef46b2[_0x9535cc(0x241)]({'type':'string','base64':![],'compression':_0x9535cc(0x195)});fs['writeFileSync'](zippath+(_0x20fb91+'.zip'),_0x11d893,'binary');}async function unzipFile(_0x3af36c,_0x59cfa3){const _0x5b53d6=_0x53b0a9;fs[_0x5b53d6(0x2dd)](configpath,{'withFileTypes':!![]})['forEach'](_0x36ea55=>{const _0x20003d=_0x5b53d6;if(!_0x36ea55[_0x20003d(0x15d)]())fs['rmSync'](configpath+_0x36ea55[_0x20003d(0x19e)]);});const _0x14dddf=fs[_0x5b53d6(0x24d)](_0x3af36c+_0x59cfa3,_0x5b53d6(0x2a4)),_0x4bde5e=await JSZip[_0x5b53d6(0x164)](_0x14dddf,{'base64':![],'checkCRC32':!![]});for(const _0x2726de of Object[_0x5b53d6(0x20f)](_0x4bde5e[_0x5b53d6(0x302)])){const _0xb7e2f1=_0x4bde5e[_0x5b53d6(0x302)][_0x2726de],_0x4b469b=await _0xb7e2f1[_0x5b53d6(0x130)]('string');fs[_0x5b53d6(0x17e)](configpath+_0xb7e2f1[_0x5b53d6(0x19e)],_0x4b469b);}fs[_0x5b53d6(0x2dd)](temppath,{'withFileTypes':!![]})[_0x5b53d6(0x25b)](_0x28aa1e=>{const _0x37498c=_0x5b53d6;if(!_0x28aa1e['isDirectory']())fs[_0x37498c(0x1fc)](temppath+_0x28aa1e[_0x37498c(0x19e)]);}),logger[_0x5b53d6(0x13b)](_0x5b53d6(0x1a6)),process['send']({'restore':!![]},_0x4b9edb=>{});}async function getPublicIp(){const _0x57e6a8=_0x53b0a9;try{const _0xb8f17c=await axios['get']('https://api.ipify.org?format=json');publicip=_0xb8f17c[_0x57e6a8(0x2a9)]['ip'];}catch(_0x423a0d){}}async function triggerAnalytics(){const _0x14b5f4=_0x53b0a9;if(!publicip)await getPublicIp();const _0x534326=getBotsWithMode();let _0x332d71=0x0;_0x534326[_0x14b5f4(0x25b)](_0x146bcc=>{const _0x18d2d7=_0x14b5f4;if(_0x146bcc[_0x18d2d7(0x2ee)]===_0x18d2d7(0x337))_0x332d71++;});const _0x421063=getBotExchanges();mixpanel[_0x14b5f4(0x210)](_0x14b5f4(0x19b),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x534326['length'],'numbotsenabled':_0x332d71,'exchanges':_0x421063,'environment':environment});}async function getMessages(){const _0x57aaad=_0x53b0a9,_0x519051=_0x57aaad(0x26d),_0x5683d9=new GraphQLClient(_0x519051),_0x199296={'authorization':_0x57aaad(0x326)},_0x383f2c=serverversion[_0x57aaad(0x336)]('.'),_0x5893bf=_0x383f2c[0x0]+'.'+_0x383f2c[0x1],_0x36af0a=Math[_0x57aaad(0x24c)](settings['lastmsgtelegram'],settings[_0x57aaad(0x32b)]),_0x38bf97={'last':parseInt(_0x36af0a),'bbm':_0x5893bf},_0x4c7928=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x387b17;try{_0x387b17=await _0x5683d9['request'](_0x4c7928,_0x38bf97,_0x199296);}catch(_0x2b1ef6){}if(_0x387b17&&_0x387b17['messages']){let _0x4f7ca7=settings[_0x57aaad(0x151)],_0x33e4ed=settings[_0x57aaad(0x151)];newMessages=[];for(const _0x50c8a4 of _0x387b17[_0x57aaad(0x143)]){newMessages[_0x57aaad(0x13f)](_0x50c8a4);let _0x4de8e3=![];_0x50c8a4[_0x57aaad(0x16d)]&&(updateSetting('latestversion',_0x50c8a4[_0x57aaad(0x16d)]),_0x4de8e3=isNewerVersion(serverversion,_0x50c8a4['bbvNew'])||serverversion==_0x50c8a4[_0x57aaad(0x16d)]);if(!_0x4de8e3&&_0x50c8a4[_0x57aaad(0x25a)]>_0x4f7ca7){if(_0x50c8a4[_0x57aaad(0x1d8)]===_0x57aaad(0x1a3)||serverversion[_0x57aaad(0x223)](_0x50c8a4[_0x57aaad(0x1d8)])){let _0x1aa077=''+_0x50c8a4['title']+'\x0a\x0a'+_0x50c8a4[_0x57aaad(0x1f0)];const _0x5ce13c=await sendTelegramMsg(toTelegramMarkdown(_0x1aa077),_0x57aaad(0x2d6));_0x4f7ca7=_0x50c8a4[_0x57aaad(0x25a)];}}_0x33e4ed=_0x50c8a4['number'];}updateAvailable=isNewerVersion(settings[_0x57aaad(0x1c0)],serverversion),updateSetting('lastmsgtelegram',_0x33e4ed),emitMessages();}}function emitMessages(){const _0x2c8ebb=_0x53b0a9,_0x43b629=settings[_0x2c8ebb(0x32b)];let _0x1710f7=[];newMessages[_0x2c8ebb(0x25b)](_0x459206=>{_0x459206['number']>_0x43b629&&_0x1710f7['push'](_0x459206);}),_0x1710f7[_0x2c8ebb(0x2cc)]>0x0&&getAllClients()['forEach'](_0x33f9cb=>{const _0x5c27a2=_0x2c8ebb;getSocket(_0x33f9cb['id'])[_0x5c27a2(0x12e)](_0x5c27a2(0x1f0),_0x1710f7);});}function confirmMessage(_0x3c3696){updateSetting('lastmsgemitted',Number(_0x3c3696));}function isNewerVersion(_0x3ed941,_0x531745){const _0x59b27c=_0x53b0a9,_0x1dc5fe=_0x531745['split']('.'),_0x1e7cb9=_0x3ed941[_0x59b27c(0x336)]('.');for(var _0x101136=0x0;_0x101136<_0x1e7cb9[_0x59b27c(0x2cc)];_0x101136++){const _0xd94342=~~_0x1e7cb9[_0x101136],_0x4618be=~~_0x1dc5fe[_0x101136];if(_0xd94342>_0x4618be)return!![];if(_0xd94342<_0x4618be)return![];}return![];}function toTelegramMarkdown(_0x211c75){const _0x21083c=_0x53b0a9,_0x4c700f=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x447871=/\*{2}(.+?)\*{2}/gim;return _0x211c75=_0x211c75[_0x21083c(0x257)](_0x4c700f,_0x21083c(0x1fa))[_0x21083c(0x257)](_0x447871,_0x21083c(0x2e0)),_0x211c75;}async function validateConfigFile(){const _0x17c2e7=_0x53b0a9,_0x23d9d8=dbConfig[_0x17c2e7(0x1ed)]('bots')[_0x17c2e7(0x2e3)](_0x17c2e7(0x2e9))[_0x17c2e7(0x289)]()||[];if(_0x23d9d8[_0x17c2e7(0x2cc)]==0x0){let _0x5e61ad=0x0,_0x595ad0=[];const _0x222b76=/^bot-([0-9]{3})-config.json$/,_0x5a2990=fs['readdirSync'](configpath);_0x5a2990['forEach'](_0x3025ed=>{const _0x53a1c5=_0x17c2e7,_0xd99137=_0x222b76[_0x53a1c5(0x14b)](_0x3025ed);if(_0xd99137){const _0x16c015=_0xd99137[0x1];let _0xa70c67=getBotAttributes(_0x16c015);_0x595ad0[_0x53a1c5(0x13f)]({'botID':_0x16c015,'botname':_0xa70c67[_0x53a1c5(0x137)],'status':_0x53a1c5(0x266),'live':'stopped'}),_0x5e61ad++;}}),_0x5e61ad!=0x0&&(dbConfig[_0x17c2e7(0x1ed)](_0x17c2e7(0x172))['assign'](_0x595ad0)[_0x17c2e7(0x300)](),config=_0x595ad0,restoredConfigFile=_0x5e61ad);}}async function restoreConfigNotify(_0x48f4da){const _0x4bf871=_0x53b0a9;let _0x2bd6d0;if(restoredConfigFile==0x1)_0x2bd6d0='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x2bd6d0=_0x4bf871(0x308);if(_0x48f4da)io['to'](_0x4bf871(0x1e9))[_0x4bf871(0x12e)](_0x4bf871(0x1a8),_0x2bd6d0);else{logger[_0x4bf871(0x1d2)](_0x4bf871(0x2f6)),logger[_0x4bf871(0x1d2)](_0x2bd6d0),logger[_0x4bf871(0x1d2)](_0x4bf871(0x2f6)),logger[_0x4bf871(0x1d2)]('');if(tgBot&&settings[_0x4bf871(0x196)]&&settings[_0x4bf871(0x315)]!=_0x4bf871(0x147))await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x2bd6d0);}}function decryptRSA(_0x384216,_0x2eb62f){const _0x27d0a4=_0x53b0a9,_0x85c3d8=forge[_0x27d0a4(0x32f)]['privateKeyFromPem'](_0x384216),_0x4a4282=_0x85c3d8['decrypt'](forge[_0x27d0a4(0x2de)][_0x27d0a4(0x1de)](_0x2eb62f),_0x27d0a4(0x2f3),{'md':forge['md']['sha256'][_0x27d0a4(0x278)](),'mgf1':{'md':forge['md'][_0x27d0a4(0x1e4)][_0x27d0a4(0x278)]()}});return _0x4a4282;}function validateCredentials(_0xe08f7d,_0x28c8fa){const _0x537b4f=_0x53b0a9;if(_0xe08f7d[_0x537b4f(0x128)]==settings[_0x537b4f(0x20d)]&&bcrypt[_0x537b4f(0x237)](_0xe08f7d[_0x537b4f(0x263)],settings['bbPassword'])){if(settings[_0x537b4f(0x27d)])return{'allow':![],'reason':_0x537b4f(0x15f),'token':null};else{const _0x3c725f=generateLoginToken(_0x28c8fa);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x3c725f};}}else return{'allow':![],'reason':_0x537b4f(0x1a4),'token':null};}function refreshToken(_0x365571){const _0x4b868f=_0x53b0a9,_0x38e3e9=generateLoginToken(_0x365571);return{'allow':!![],'reason':_0x4b868f(0x22a),'token':_0x38e3e9};}function validateAccess(_0x1690b7,_0x29ea59,_0x46b4f3){const _0x4d4247=_0x53b0a9,_0x505dae=_0x46b4f3?_0x46b4f3:devices[_0x29ea59]['ip'];let _0x4fa6fa;const _0x57a01c=_0x27fee4=>{const _0x413072=_0x1653;if(settings[_0x413072(0x125)]){if(settings[_0x413072(0x27d)]){if(telegram2FaApproved(_0x29ea59)){const _0x33da6b=generateLoginToken(_0x29ea59);return{'allow':!![],'reason':_0x413072(0x1e1),'token':_0x33da6b};}else return{'allow':![],'reason':_0x413072(0x1ff),'token':null};}else return _0x4fa6fa=validToken(_0x27fee4,_0x29ea59),_0x4fa6fa['hasOwnProperty'](_0x413072(0x2ba))?{'allow':!![],'reason':_0x413072(0x142),'token':_0x27fee4}:{'allow':![],'reason':_0x413072(0x1ff),'token':null};}else return{'allow':!![],'reason':_0x413072(0x1da),'token':null};};if(settings[_0x4d4247(0x268)]){let _0x41c46e=[...settings[_0x4d4247(0x2ff)],_0x4d4247(0x13c),_0x4d4247(0x184),_0x4d4247(0x22b)];if(_0x41c46e[_0x4d4247(0x1f2)](_0x505dae))return _0x57a01c(_0x1690b7);else{_0x4fa6fa=validToken(_0x1690b7,_0x29ea59);if(_0x4fa6fa['hasOwnProperty'](_0x4d4247(0x2ba)))return _0x57a01c(_0x1690b7);else{if(telegramIpApproved(_0x29ea59)){const _0x404f51=generateToken(_0x29ea59);return _0x4fa6fa=_0x57a01c(_0x1690b7),_0x4fa6fa[_0x4d4247(0x1ea)]?{'allow':!![],'reason':_0x4d4247(0x230),'token':_0x404f51}:_0x4fa6fa;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0x4d4247(0x216),'token':null}:{'allow':![],'reason':_0x4d4247(0x2a1),'token':null};}}}else return _0x57a01c(_0x1690b7);}function _0x1653(_0x529a1e,_0x212ded){const _0x723a78=_0x273c();return _0x1653=function(_0x278818,_0x4e8d74){_0x278818=_0x278818-0x123;let _0x273cfd=_0x723a78[_0x278818];return _0x273cfd;},_0x1653(_0x529a1e,_0x212ded);}function timelyDecrypt(_0x5323bb,_0x44c168,_0x5e8f71='@'){const _0x12c95e=_0x53b0a9;if(_0x5323bb)try{const _0x111ddc=decryptRSA(secure[_0x12c95e(0x258)],_0x5323bb),_0x38be7d=_0x111ddc[_0x12c95e(0x336)](_0x5e8f71)[0x0],_0x46a534=_0x111ddc[_0x12c95e(0x336)](_0x5e8f71)[0x1],_0x27b224=new Date()[_0x12c95e(0x185)]();if(_0x44c168){if(_0x27b224-_0x46a534<maxSecretAge*0x3e8)return _0x38be7d;else return![];}else return _0x38be7d;}catch(_0x33925f){return![];}else return![];}const validToken=(_0x385710,_0x4d2838)=>{const _0x208640=_0x53b0a9,_0x5da587=devices[_0x4d2838]['ip'];if(!_0x385710)return{'error':'No\x20authentication\x20token'};for(let _0x4f74fd of blacklist){if(_0x4f74fd[_0x208640(0x281)]==_0x385710)return{'error':_0x208640(0x182)};}let _0x2d48e4;try{_0x2d48e4=jwt[_0x208640(0x1e6)](_0x385710,secure['secret']+_0x4d2838);}catch{return{'error':_0x208640(0x24b)};}if(!_0x2d48e4[_0x208640(0x2f4)](_0x208640(0x1d9))&&!_0x2d48e4[_0x208640(0x2f4)]('username')||!_0x2d48e4[_0x208640(0x2f4)](_0x208640(0x332)))return{'error':_0x208640(0x150)};if(!_0x2d48e4[_0x208640(0x2f4)](_0x208640(0x128))&&_0x2d48e4[_0x208640(0x2f4)](_0x208640(0x1d9))){const {clientip:_0x146d6c}=_0x2d48e4;return _0x5da587==_0x146d6c?{'success':_0x208640(0x12b)}:{'error':_0x208640(0x269)};}else{if(_0x2d48e4[_0x208640(0x2f4)]('username')&&_0x2d48e4[_0x208640(0x2f4)](_0x208640(0x1d9))){const {username:_0x23e49c,clientip:_0x1fb27b}=_0x2d48e4;return settings[_0x208640(0x20d)]==_0x23e49c&&_0x5da587==_0x1fb27b?{'success':_0x208640(0x12b)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x104193=>{const _0x575c91=_0x53b0a9;if(_0x104193){const _0x33ff54=devices[_0x104193]['ip'];return jwt[_0x575c91(0x1d6)]({'username':settings[_0x575c91(0x20d)],'clientip':_0x33ff54},secure[_0x575c91(0x2d5)]+_0x104193,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0xe1ad52=>{const _0x3169f7=_0x53b0a9;if(_0xe1ad52){const _0x5b1561=devices[_0xe1ad52]['ip'];return jwt[_0x3169f7(0x1d6)]({'clientip':_0x5b1561},secure[_0x3169f7(0x2d5)]+_0xe1ad52,{'expiresIn':devices[_0xe1ad52][_0x3169f7(0x1aa)][_0x3169f7(0x224)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x464333=>{const _0x5904b7=_0x53b0a9;let _0x359738=![];return devices[_0x464333][_0x5904b7(0x1aa)]&&devices[_0x464333][_0x5904b7(0x1aa)][_0x5904b7(0x224)]!=_0x5904b7(0x1cc)&&(_0x359738=devices[_0x464333][_0x5904b7(0x1aa)][_0x5904b7(0x1d9)]==devices[_0x464333]['ip']&&new Date()[_0x5904b7(0x185)]()-devices[_0x464333][_0x5904b7(0x1aa)][_0x5904b7(0x21e)]<devices[_0x464333]['telegramIpApproval'][_0x5904b7(0x224)]*0x3c*0x3e8),_0x359738;},telegram2FaApproved=_0x4ba9bc=>{const _0x39a426=_0x53b0a9;let _0x59dde1=![];return devices[_0x4ba9bc]['telegram2FaApproval']&&devices[_0x4ba9bc][_0x39a426(0x160)]['expiry']!=_0x39a426(0x1cc)&&(_0x59dde1=devices[_0x4ba9bc][_0x39a426(0x160)][_0x39a426(0x1d9)]==devices[_0x4ba9bc]['ip']&&new Date()[_0x39a426(0x185)]()-devices[_0x4ba9bc][_0x39a426(0x160)][_0x39a426(0x21e)]<devices[_0x4ba9bc]['telegram2FaApproval'][_0x39a426(0x224)]*0x3c*0x3e8),_0x59dde1;},normalizeIP=_0x445831=>{const _0x7fa101=_0x53b0a9;let _0x594ab7=null,_0x5734b4=null;if(ipaddr[_0x7fa101(0x1c7)](_0x445831)){const _0x1542fb=ipaddr[_0x7fa101(0x1e0)](_0x445831);_0x1542fb[_0x7fa101(0x2d8)]()===_0x7fa101(0x291)?(_0x1542fb[_0x7fa101(0x233)]()&&(_0x594ab7=_0x1542fb[_0x7fa101(0x280)]()[_0x7fa101(0x198)]()),_0x5734b4=_0x1542fb[_0x7fa101(0x198)]()):(_0x594ab7=_0x1542fb[_0x7fa101(0x198)](),_0x5734b4=_0x1542fb[_0x7fa101(0x21d)]()[_0x7fa101(0x198)]());}return{'show':_0x594ab7?_0x594ab7:_0x5734b4,'store':_0x5734b4};};function formatDate(_0x192bed){const _0x255cf0=_0x53b0a9;return _0x192bed[_0x255cf0(0x1b0)]()+'/'+(_0x192bed[_0x255cf0(0x1c5)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x192bed['getDate']()[_0x255cf0(0x198)]()[_0x255cf0(0x212)](0x2,'0')+'\x20'+_0x192bed['getHours']()[_0x255cf0(0x198)]()['padStart'](0x2,'0')+':'+_0x192bed['getMinutes']()[_0x255cf0(0x198)]()['padStart'](0x2,'0')+':'+_0x192bed[_0x255cf0(0x1e5)]()[_0x255cf0(0x198)]()[_0x255cf0(0x212)](0x2,'0');}function sleep(_0x30e494){return new Promise(_0x17d877=>setTimeout(_0x17d877,_0x30e494));}