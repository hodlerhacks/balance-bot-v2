const _0x27f654=_0x6c29;(function(_0x34b733,_0x19a90c){const _0x308679=_0x6c29,_0x5847af=_0x34b733();while(!![]){try{const _0x2f50a0=-parseInt(_0x308679(0x273))/0x1+-parseInt(_0x308679(0x158))/0x2+-parseInt(_0x308679(0x251))/0x3*(-parseInt(_0x308679(0xe0))/0x4)+-parseInt(_0x308679(0x1d0))/0x5+parseInt(_0x308679(0x142))/0x6+-parseInt(_0x308679(0x268))/0x7*(-parseInt(_0x308679(0xfa))/0x8)+parseInt(_0x308679(0x260))/0x9;if(_0x2f50a0===_0x19a90c)break;else _0x5847af['push'](_0x5847af['shift']());}catch(_0x2786f2){_0x5847af['push'](_0x5847af['shift']());}}}(_0x782c,0x5ab72));const _0x12f279=function(){let _0x4cd0f2=!![];return function(_0x38cf42,_0x35096b){const _0x27b901=_0x4cd0f2?function(){if(_0x35096b){const _0x3f03b8=_0x35096b['apply'](_0x38cf42,arguments);return _0x35096b=null,_0x3f03b8;}}:function(){};return _0x4cd0f2=![],_0x27b901;};}(),_0x15ed79=_0x12f279(this,function(){const _0x16861b=_0x6c29;return _0x15ed79[_0x16861b(0xcc)]()['search'](_0x16861b(0xed))['toString']()[_0x16861b(0x28f)](_0x15ed79)[_0x16861b(0xec)](_0x16861b(0xed));});_0x15ed79();'use strict';function _0x6c29(_0x56a928,_0x2ceaff){const _0x44f2b3=_0x782c();return _0x6c29=function(_0x15ed79,_0x12f279){_0x15ed79=_0x15ed79-0x73;let _0x782cba=_0x44f2b3[_0x15ed79];return _0x782cba;},_0x6c29(_0x56a928,_0x2ceaff);}process[_0x27f654(0xd5)][_0x27f654(0x1b8)]=0x1;const childProcess=require(_0x27f654(0x140)),fs=require('fs'),fns=require(_0x27f654(0x17b)),low=require('lowdb'),FileSync=require(_0x27f654(0x1ff)),path=require(_0x27f654(0xaa)),crypto=require('crypto'),forge=require('node-forge'),bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require(_0x27f654(0xa7)),yargs=require(_0x27f654(0x139)),uuidRandom=require(_0x27f654(0x224)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0x27f654(0xa9)),axios=require(_0x27f654(0x97)),{GraphQLClient,gql}=require(_0x27f654(0x105)),util=require('util'),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x27f654(0x1a8)),argv=yargs(process[_0x27f654(0x281)]['slice'](0x2))['argv'],PORT=argv[_0x27f654(0xb1)]||_0x27f654(0xdc),pattern=/^[0-9]{2,4}$/;!pattern[_0x27f654(0xc5)](PORT)&&(console[_0x27f654(0xb4)](_0x27f654(0xa3)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x27f654(0x8e)](0x1));const HOST=argv[_0x27f654(0x1b5)]||null,userID=argv['user']||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process['versions'][_0x27f654(0x1e6)];let bbpath=_0x27f654(0x130),bbpath2='';const botfile=_0x27f654(0x1f5),configfile=_0x27f654(0x167),settingsfile=_0x27f654(0x246),securefile=_0x27f654(0xe9),environment=require('./'+bbpath2+'version.json')[_0x27f654(0xd1)]||_0x27f654(0x15b),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x27f654(0xf0)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x27f654(0x209)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x27f654(0xee),configbackuppath=configpath+_0x27f654(0x1f7),logspath=userID?bbpath+_0x27f654(0x111)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x27f654(0x182)+userID+'/':bbpath+_0x27f654(0x182),loggerfile=fs[_0x27f654(0x136)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x27f654(0x197);!fs[_0x27f654(0xf0)](configpath)&&fs[_0x27f654(0x1cb)](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x27f654(0xf0)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x27f654(0xf0)](zippath)&&fs[_0x27f654(0x1cb)](zippath);!fs[_0x27f654(0xf0)](temppath)&&fs[_0x27f654(0x1cb)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x27f654(0x1f1)]({'bots':[]})[_0x27f654(0x14d)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':'0.0.0','onepagemode':![],'marketcapApi':''}})[_0x27f654(0x14d)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x27f654(0x1f1)]({'secure':{},'blacklist':[]})[_0x27f654(0x14d)]();const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x27f654(0x1cd),{'host':_0x27f654(0x11e)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x27f654(0xad)]&&(settings['telegramToken']!=''&&settings[_0x27f654(0xad)]!=_0x27f654(0x261))&&settings[_0x27f654(0xf8)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x14f9ef,_0x78fa6f)=>{const _0x2fa6b1=_0x27f654,_0x2c215b=/#[A-Z]{3}#/g;if(typeof _0x14f9ef==_0x2fa6b1(0x1fa)){!_0x78fa6f?_0x14f9ef=_0x14f9ef[_0x2fa6b1(0x20b)](_0x2c215b,''):(_0x14f9ef=_0x14f9ef[_0x2fa6b1(0x20b)](/#BLU#/g,_0x2fa6b1(0x18b)),_0x14f9ef=_0x14f9ef['replace'](/#RED#/g,'\x1b[31m'),_0x14f9ef=_0x14f9ef[_0x2fa6b1(0x20b)](/#YEL#/g,_0x2fa6b1(0x12f)),_0x14f9ef=_0x14f9ef[_0x2fa6b1(0x20b)](/#MAG#/g,'\x1b[35m'),_0x14f9ef=_0x14f9ef['replace'](/#CYA#/g,'\x1b[36m'),_0x14f9ef=_0x14f9ef[_0x2fa6b1(0x20b)](/#RES#/g,_0x2fa6b1(0x23f)));;}return _0x14f9ef;},logger={'screen':_0x4af131=>{const _0x211259=_0x27f654;console[_0x211259(0xb4)](parseColor(_0x4af131,!![]));},'simple':_0x5c7494=>{const _0x15446e=_0x27f654;console[_0x15446e(0xb4)](parseColor(_0x5c7494,!![])),loggerfile['write'](util[_0x15446e(0x169)](parseColor(_0x5c7494,![]))+'\x0a');},'full':async _0x3af5fd=>{const _0x90718c=_0x27f654,_0x953fb0=getTimeStamp()+_0x90718c(0x10a)+_0x3af5fd;console['log'](parseColor(_0x953fb0,!![])),loggerfile[_0x90718c(0x14d)](util[_0x90718c(0x169)](parseColor(_0x953fb0,![]))+'\x0a');if(tgBot&&settings[_0x90718c(0x175)]&&settings[_0x90718c(0x92)]!=_0x90718c(0xf1))await sendTelegram(settings[_0x90718c(0x175)],_0x90718c(0x1db)+parseColor(_0x3af5fd,![]));},'debug':async(_0x26420e,_0x37e669='')=>{const _0x2826ac=_0x27f654,_0x1e72de=getTimeStamp()+_0x2826ac(0x254)+_0x26420e;if(debugging)console['log'](parseColor(_0x1e72de,!![]));loggerfile[_0x2826ac(0x14d)](util[_0x2826ac(0x169)](parseColor(_0x1e72de,![]))+'\x0a');if(_0x37e669){if(debugging)console[_0x2826ac(0xb4)](_0x37e669);loggerfile[_0x2826ac(0x14d)](util[_0x2826ac(0x169)](_0x37e669)+'\x0a');}}};let terminating=![];process['on'](_0x27f654(0x1f8),function(_0x365bfc){const _0x59c52b=_0x27f654;_0x365bfc[_0x59c52b(0xcc)]()[_0x59c52b(0xcb)](_0x59c52b(0xfe))?(logger[_0x59c52b(0x271)](_0x59c52b(0x269)+_0x365bfc[_0x59c52b(0xb1)]+_0x59c52b(0xe8)),process[_0x59c52b(0x9f)]({'terminate':!![]},_0x4fc42c=>{})):logger[_0x59c52b(0x271)](_0x365bfc);}),process['on'](_0x27f654(0x8e),()=>{const _0x57e0a9=_0x27f654;stopAllBots(),process[_0x57e0a9(0x8e)](0x0);}),process['on'](_0x27f654(0x288),()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGINT',()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x27f654(0x1f3)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x27f654(0x25d))[_0x27f654(0x22e)](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get'](_0x27f654(0x1b3),async(_0x42b69b,_0x2dcecc)=>{const _0x23e7ec=_0x27f654,_0x30cde7=_0x42b69b[_0x23e7ec(0x174)]['type'],_0x3a5930=getClientsWithBotID(_0x23e7ec(0x9b)),_0x4a1d09=_0x42b69b[_0x23e7ec(0x1ae)]['uuid'],_0x17867a=timelyDecrypt(_0x4a1d09,![]),_0xdd4804=_0x3a5930[_0x23e7ec(0x181)](_0x218677=>_0x218677[_0x23e7ec(0x16b)]==_0x17867a);if(_0xdd4804){const _0x4ef6b2=normalizeIP(_0x42b69b['socket'][_0x23e7ec(0x96)])[_0x23e7ec(0x1fb)],_0x16f07b=_0x42b69b['headers'][_0x23e7ec(0x233)];if(validateAccess(_0x16f07b,_0x17867a,_0x4ef6b2)[_0x23e7ec(0xe3)])_0x30cde7==_0x23e7ec(0x1de)&&await backupConfigFiles(),await zipFiles(_0x30cde7),_0x2dcecc['download'](zippath+(_0x30cde7+_0x23e7ec(0x107)),_0x36dbb2=>{const _0x1b9c12=_0x23e7ec;_0x36dbb2&&(logger[_0x1b9c12(0xfc)](_0x1b9c12(0x89)+_0x30cde7),logger['simple'](_0x36dbb2));});else logger[_0x23e7ec(0xfc)](_0x23e7ec(0x1c6)+_0x30cde7+'\x20(1)');}else logger[_0x23e7ec(0xfc)](_0x23e7ec(0x1c6)+_0x30cde7+_0x23e7ec(0x25b));}),app[_0x27f654(0x86)]('/upload-backup',async(_0x514019,_0x4d81f4)=>{const _0x26fba5=_0x27f654,_0x5467a5=getClientsWithBotID(_0x26fba5(0x9b)),_0x1da762=_0x514019['headers'][_0x26fba5(0x16b)],_0x1133b8=timelyDecrypt(_0x1da762,![]),_0x147375=_0x5467a5[_0x26fba5(0x181)](_0x195796=>_0x195796[_0x26fba5(0x16b)]==_0x1133b8);logger[_0x26fba5(0xda)](_0x26fba5(0xf4));if(_0x147375){const _0x591f31=normalizeIP(_0x514019[_0x26fba5(0x262)][_0x26fba5(0x96)])[_0x26fba5(0x1fb)],_0x57b15e=_0x514019['headers']['tkn'];if(validateAccess(_0x57b15e,_0x1133b8,_0x591f31)[_0x26fba5(0xe3)]){if(_0x514019[_0x26fba5(0x7b)]){const _0x4d8866=_0x514019[_0x26fba5(0x7b)][_0x26fba5(0x154)];await _0x4d8866['mv'](temppath+_0x4d8866['name']),_0x4d81f4['send']({'status':!![],'message':_0x26fba5(0xde)});const _0x578c97=getBotsWithMode();_0x578c97['length']>0x0?confirmRestore(temppath,_0x4d8866[_0x26fba5(0x12e)]):unzipFile(temppath,_0x4d8866[_0x26fba5(0x12e)]);}}else logger[_0x26fba5(0xfc)](_0x26fba5(0x24a));}else logger[_0x26fba5(0xfc)](_0x26fba5(0x196));}),app['use'](express[_0x27f654(0x1dc)](path[_0x27f654(0x27c)](__dirname,bbpath2,_0x27f654(0x7f)))),app[_0x27f654(0x1ab)](express[_0x27f654(0x1dc)](path[_0x27f654(0x27c)](__dirname,bbpath2,_0x27f654(0x258)))),app[_0x27f654(0x190)]('/',function(_0x373b84,_0x1f86e5){const _0x3f958a=_0x27f654;_0x1f86e5[_0x3f958a(0x14c)](path[_0x3f958a(0x27c)](__dirname,bbpath2,'build2',_0x3f958a(0x87)));}),app[_0x27f654(0x190)]('/:bot',function(_0x587ace,_0x4b0bd3){const _0x512f97=_0x27f654;_0x4b0bd3[_0x512f97(0x14c)](path[_0x512f97(0x27c)](__dirname,bbpath2,'build',_0x512f97(0x87)));}),app[_0x27f654(0x190)](_0x27f654(0x135),(_0x14f3de,_0x24b292)=>{const _0x123a0d=_0x27f654;_0x24b292[_0x123a0d(0x14c)](path[_0x123a0d(0x27c)](__dirname,bbpath2,_0x123a0d(0x258),_0x123a0d(0x87)));}),app['get']('/:bot/performance',(_0x20cf17,_0x38c460)=>{const _0x1e0e92=_0x27f654;_0x38c460[_0x1e0e92(0x14c)](path[_0x1e0e92(0x27c)](__dirname,bbpath2,_0x1e0e92(0x258),_0x1e0e92(0x87)));}),app['get'](_0x27f654(0x287),(_0x13e23f,_0x2ee1f1)=>{const _0x26d228=_0x27f654;_0x2ee1f1[_0x26d228(0x14c)](path[_0x26d228(0x27c)](__dirname,bbpath2,_0x26d228(0x258),_0x26d228(0x87)));}),app[_0x27f654(0x190)]('/:bot/history',(_0xbc53ee,_0x1b7442)=>{const _0x15e321=_0x27f654;_0x1b7442[_0x15e321(0x14c)](path[_0x15e321(0x27c)](__dirname,bbpath2,_0x15e321(0x258),_0x15e321(0x87)));}),app['get'](_0x27f654(0x1a0),(_0x56e380,_0x1af5c1)=>{const _0x110fd3=_0x27f654;_0x1af5c1['sendFile'](path[_0x110fd3(0x27c)](__dirname,bbpath2,'build','index.html'));}),app[_0x27f654(0x190)](_0x27f654(0x1c0),(_0x3cdaf5,_0x51b3cd)=>{const _0x3bd3ab=_0x27f654;_0x51b3cd[_0x3bd3ab(0x14c)](path[_0x3bd3ab(0x27c)](__dirname,bbpath2,'build',_0x3bd3ab(0x87)));});if(HOST)http[_0x27f654(0xb0)](PORT,HOST);else http[_0x27f654(0xb0)](PORT);const io=require(_0x27f654(0x270))(http,{});openBrowser&&(async()=>{const _0xcb42e8=_0x27f654,{default:_0x597bfb}=await import(_0xcb42e8(0x168));await _0x597bfb('http://localhost:'+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x1fd266=_0x27f654;let _0x46260=_0x1fd266(0x28d);const _0x267c25=networkInterfaces(),_0x2c8e3c={};for(const _0x19e9bb of Object[_0x1fd266(0x1af)](_0x267c25)){for(const _0x508220 of _0x267c25[_0x19e9bb]){if((_0x508220[_0x1fd266(0x1b7)]=='IPv4'||_0x508220[_0x1fd266(0x1b7)]==0x4)&&!_0x508220[_0x1fd266(0x18f)]){const _0x5e9901=ipaddr[_0x1fd266(0x274)](_0x508220['address'])[_0x1fd266(0x120)]();_0x5e9901!=_0x1fd266(0x11d)&&(!_0x2c8e3c[_0x19e9bb]&&(_0x2c8e3c[_0x19e9bb]=[]),_0x2c8e3c[_0x19e9bb][_0x1fd266(0x150)](_0x508220[_0x1fd266(0x1c3)]),_0x46260=_0x508220[_0x1fd266(0x1c3)]);}}}return{'serverip':_0x46260,'netinterfaces':_0x2c8e3c};}async function startServer(){const _0x72443b=_0x27f654,{serverip:_0x54a25b,netinterfaces:_0x1fd446}=getServerIP();logger['simple'](''),logger[_0x72443b(0x271)](_0x72443b(0x8c)),await logger[_0x72443b(0xfc)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x72443b(0x176)+(environment==_0x72443b(0x253)?_0x72443b(0xc9):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x72443b(0x1c2))+(_0x72443b(0x1a9)+_0x54a25b+':'+PORT+_0x72443b(0x170))),logger['simple']('-----------------------------------------------------------------------------------');if(config[_0x72443b(0x17e)]!=0x0)for(const _0x1b1acb of config){const _0x3028e8=_0x1b1acb[_0x72443b(0x1dd)]==_0x72443b(0x282)?'a':'m';if(_0x1b1acb[_0x72443b(0x141)]==_0x72443b(0x247)||_0x1b1acb[_0x72443b(0x141)]==_0x72443b(0x1ac))await logger['full'](_0x72443b(0x208)+_0x3028e8+_0x72443b(0x28a)+_0x1b1acb['botID']+_0x72443b(0x14a)+_0x1b1acb[_0x72443b(0x88)]),startBot([_0x1b1acb[_0x72443b(0x1e2)],userID],{'cwd':bbpath},function(_0x16db5b){if(_0x16db5b)logger['full'](_0x16db5b);});else(_0x1b1acb[_0x72443b(0x141)]==_0x72443b(0x267)||_0x1b1acb[_0x72443b(0x141)]=='new-disabled')&&await logger[_0x72443b(0xfc)](_0x72443b(0x217)+_0x3028e8+_0x72443b(0x9e)+_0x1b1acb[_0x72443b(0x1e2)]+_0x72443b(0x14a)+_0x1b1acb[_0x72443b(0x88)]);}else!newBot&&logger[_0x72443b(0x271)](_0x72443b(0x85));if(newBot)addBot();logger['simple'](_0x72443b(0x8c)),logger[_0x72443b(0x271)](''),await logger[_0x72443b(0xda)]('Node.js\x20v'+nodeversion),await logger[_0x72443b(0xda)](_0x72443b(0x26f),_0x1fd446);}function startSocket(){const _0x1cf982=_0x27f654;io['on'](_0x1cf982(0x21e),_0x2a7d8a=>{const _0x45d3a3=_0x1cf982;let _0x5ec2be,_0x2db51a,_0x42eee3,_0x1bcd4b,_0x2f1bc8;const _0x3b6513=_0x2a7d8a[_0x45d3a3(0x1ee)][_0x45d3a3(0x1ae)]['referer'];_0x2db51a=_0x3b6513['match'](/bot[0-9]{3}/);if(_0x2db51a)_0x42eee3=_0x2db51a[0x0][_0x45d3a3(0xc8)](/[0-9]{3}/);if(_0x42eee3)_0x5ec2be=_0x42eee3[0x0];else _0x5ec2be='botmanager';const _0x203371=_0x2a7d8a['handshake'][_0x45d3a3(0x276)][_0x45d3a3(0x23a)];if(!_0x203371)_0x2a7d8a['emit']('status',{'publicKey':secure[_0x45d3a3(0x157)]});else{_0x1bcd4b=timelyDecrypt(_0x203371,![]);if(!_0x1bcd4b)_0x2a7d8a[_0x45d3a3(0xa0)](_0x45d3a3(0x141),{'publicKey':secure[_0x45d3a3(0x157)]});else{_0x2f1bc8=normalizeIP(_0x2a7d8a[_0x45d3a3(0xa8)]['remoteAddress'])[_0x45d3a3(0x1fb)];if(!devices[_0x1bcd4b])devices[_0x1bcd4b]={'uuid':_0x1bcd4b,'access':{'token':null}};devices[_0x1bcd4b]['ip']=_0x2f1bc8;const _0x3e7467=addClient(_0x2a7d8a['id'],_0x1bcd4b,_0x5ec2be);setAccess(_0x3e7467),emitMessages(),_0x2a7d8a['on'](_0x45d3a3(0x177),_0x36f387=>{const _0x12c107=_0x45d3a3,_0x1d181e=timelyDecrypt(_0x36f387[_0x12c107(0x94)],!![],_0x12c107(0xac));if(_0x1d181e){_0x36f387={'username':_0x36f387[_0x12c107(0xc6)],'password':_0x1d181e},devices[_0x1bcd4b][_0x12c107(0x210)]=validateCredentials(_0x36f387,_0x1bcd4b);if(devices[_0x1bcd4b][_0x12c107(0x210)][_0x12c107(0xe3)]==![]&&devices[_0x1bcd4b]['access']['reason']==_0x12c107(0x198))_0x2a7d8a[_0x12c107(0xa0)]('status',{'access':devices[_0x1bcd4b][_0x12c107(0x210)]}),loginAccess2FA(_0x1bcd4b,_0x2f1bc8);else{if(devices[_0x1bcd4b][_0x12c107(0x210)][_0x12c107(0xe3)]==![]&&devices[_0x1bcd4b][_0x12c107(0x210)][_0x12c107(0x90)]==_0x12c107(0x183))_0x2a7d8a['emit'](_0x12c107(0x141),{'access':devices[_0x1bcd4b][_0x12c107(0x210)]});else devices[_0x1bcd4b][_0x12c107(0x210)][_0x12c107(0xe3)]&&devices[_0x1bcd4b][_0x12c107(0x210)][_0x12c107(0x90)]==_0x12c107(0xeb)&&(getClientsWithUuid(_0x1bcd4b)[_0x12c107(0xf6)](_0x5b9e36=>{setAccess(_0x5b9e36);}),logger['debug'](_0x12c107(0xc7)+_0x1bcd4b[_0x12c107(0x218)](-0x8)),setTokenRefresh(_0x1bcd4b),setSessionTimeout(_0x12c107(0x177),_0x1bcd4b));}}else logger[_0x12c107(0xfc)](_0x12c107(0xcf));}),_0x2a7d8a['on'](_0x45d3a3(0x241),()=>{resetPassword();}),_0x2a7d8a['on']('disconnect',_0x145d99=>{removeClient(_0x2a7d8a['id']);}),_0x5ec2be==_0x45d3a3(0x9b)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x286a56){const _0x70ccf9=_0x27f654;if(_0x286a56!=_0x70ccf9(0x9b)&&config[_0x70ccf9(0x151)]!=''){if(pid[_0x286a56])pid[_0x286a56][_0x70ccf9(0x9f)]({'function':'initclient','args':null});}_0x286a56!=_0x70ccf9(0x9b)&&broadcastToBots('bots',JSON['stringify'](config));}function reloadBotManager(){const _0x1c553a=_0x27f654;getClientsWithBotID(_0x1c553a(0x9b))[_0x1c553a(0xf6)](_0x4b6c19=>{const _0x3ccb1c=_0x1c553a;getSocket(_0x4b6c19['id'])[_0x3ccb1c(0xa0)](_0x3ccb1c(0x141),{'access':{'allow':![],'reason':_0x3ccb1c(0x228),'token':null}});});}function getSocket(_0xc7fa6b){const _0x317d47=_0x27f654,_0x2cb4e1=io['_nsps']['get']('/');return _0x2cb4e1[_0x317d47(0xa4)]['get'](_0xc7fa6b);}function setAccess(_0x2bfb0c){const _0x2885b0=_0x27f654,_0x513dfc=getSocket(_0x2bfb0c['id']),_0x562fba=_0x2bfb0c['uuid'],_0xe624f0=_0x2bfb0c[_0x2885b0(0x77)];devices[_0x562fba][_0x2885b0(0x210)]=validateAccess(devices[_0x562fba][_0x2885b0(0x210)][_0x2885b0(0x249)],_0x562fba),logger[_0x2885b0(0xda)]('Setting\x20access:\x20'+devices[_0x562fba][_0x2885b0(0x210)][_0x2885b0(0x90)]+_0x2885b0(0x98)+_0x2bfb0c['id'][_0x2885b0(0x218)](-0x8)+_0x2885b0(0x242)+_0x562fba[_0x2885b0(0x218)](-0x8)),_0x513dfc['join'](_0x562fba);if(devices[_0x562fba][_0x2885b0(0x210)][_0x2885b0(0xe3)]){_0x513dfc[_0x2885b0(0x27c)](_0xe624f0);if(_0xe624f0==_0x2885b0(0x9b))initializeSocketBotManager(_0x513dfc);else initializeSocketBot(_0x513dfc);initClient(_0xe624f0);}devices[_0x562fba][_0x2885b0(0x210)]['token']&&devices[_0x562fba][_0x2885b0(0x210)][_0x2885b0(0x90)]==_0x2885b0(0x27f)&&setSessionTimeout(_0x2885b0(0x8a),_0x562fba),devices[_0x562fba][_0x2885b0(0x210)]['token']&&devices[_0x562fba][_0x2885b0(0x210)]['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x2885b0(0x177),_0x562fba),_0x513dfc[_0x2885b0(0xa0)](_0x2885b0(0x141),{'status':_0x2bfb0c['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x562fba][_0x2885b0(0x210)],'externalip':devices[_0x562fba]['ip'],'publicKey':secure[_0x2885b0(0x157)],'userid':settings[_0x2885b0(0x211)],'validInstallation':validInstallation}),devices[_0x562fba][_0x2885b0(0x210)][_0x2885b0(0xe3)]==![]&&devices[_0x562fba][_0x2885b0(0x210)][_0x2885b0(0x90)]==_0x2885b0(0x277)&&temporaryAccess2FA(_0x562fba,devices[_0x562fba]['ip']);}function setSessionTimeout(_0x55983a,_0x7d5fc7){const _0x40f3a9=_0x27f654;let _0x17d3fa;if(_0x55983a=='login')_0x17d3fa=loginExpiry*0x3c*0x3e8;else _0x17d3fa=devices[_0x7d5fc7][_0x40f3a9(0x22c)][_0x40f3a9(0x16d)]*0x3c*0x3e8-(new Date()[_0x40f3a9(0xce)]()-devices[_0x7d5fc7][_0x40f3a9(0x22c)][_0x40f3a9(0x25a)]);if(devices[_0x7d5fc7][_0x40f3a9(0xe7)])clearTimeout(devices[_0x7d5fc7]['pidExpireLogin']);devices[_0x7d5fc7][_0x40f3a9(0xe7)]=setTimeout(()=>{const _0x1d1462=_0x40f3a9;if(devices[_0x7d5fc7]['pidRefreshToken'])clearTimeout(devices[_0x7d5fc7][_0x1d1462(0x194)]);removeSocketListeners(_0x7d5fc7),addBlacklist(_0x7d5fc7),devices[_0x7d5fc7][_0x1d1462(0x22c)]=null,devices[_0x7d5fc7][_0x1d1462(0xe6)]=null,devices[_0x7d5fc7][_0x1d1462(0x210)]['token']=null,logger[_0x1d1462(0xda)](_0x1d1462(0x1da)+_0x7d5fc7[_0x1d1462(0x218)](-0x8)),devices[_0x7d5fc7][_0x1d1462(0x210)]=validateAccess(devices[_0x7d5fc7][_0x1d1462(0x210)]['token'],_0x7d5fc7),!(devices[_0x7d5fc7][_0x1d1462(0x210)][_0x1d1462(0xe3)]&&devices[_0x7d5fc7][_0x1d1462(0x210)][_0x1d1462(0x90)]==_0x1d1462(0x81))&&(_0x55983a==_0x1d1462(0x177)?io['to'](_0x7d5fc7)[_0x1d1462(0xa0)](_0x1d1462(0x141),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x7d5fc7)[_0x1d1462(0xa0)](_0x1d1462(0x141),{'access':{'allow':![],'reason':_0x1d1462(0x250),'token':null}})),devices[_0x7d5fc7]['access'][_0x1d1462(0x249)]=null;},_0x17d3fa);}function setTokenRefresh(_0x30592a){const _0x6b2a1b=_0x27f654;if(devices[_0x30592a][_0x6b2a1b(0x194)])clearTimeout(devices[_0x30592a][_0x6b2a1b(0x194)]);devices[_0x30592a][_0x6b2a1b(0x194)]=setTimeout(()=>{const _0x5b6062=_0x6b2a1b;getClientsWithUuid(_0x30592a)['length']!=0x0?(devices[_0x30592a][_0x5b6062(0x210)]=refreshToken(_0x30592a),io['to'](_0x30592a)['emit'](_0x5b6062(0x141),{'status':_0x5b6062(0x20f),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x30592a][_0x5b6062(0x210)],'externalip':devices[_0x30592a]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x30592a)):clearTimeout(devices[_0x30592a]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1a6e40){const _0x4f0a08=_0x27f654,_0x3c60da=getClient(_0x1a6e40['id'])[_0x4f0a08(0x16b)];_0x1a6e40[_0x4f0a08(0xa0)](_0x4f0a08(0x1c1),config),_0x1a6e40[_0x4f0a08(0xa0)](_0x4f0a08(0x23c),cleanSettings()),_0x1a6e40['on'](_0x4f0a08(0x127),_0x47e951=>{const _0x7dcd83=_0x4f0a08;if(validateAccess(_0x47e951,_0x3c60da)[_0x7dcd83(0xe3)])addBot();else logger['full'](_0x7dcd83(0xcd));}),_0x1a6e40['on'](_0x4f0a08(0x79),(_0x334a05,_0x440e6d)=>{const _0x1d10e0=_0x4f0a08;if(validateAccess(_0x440e6d,_0x3c60da)['allow'])toggleBot(_0x334a05['botID'],_0x334a05['status'],_0x334a05[_0x1d10e0(0x20e)]);else logger['full'](_0x1d10e0(0x106));}),_0x1a6e40['on']('toggle-bot-mode',(_0x4c2f46,_0x1d3000)=>{const _0x20f06d=_0x4f0a08;if(validateAccess(_0x1d3000,_0x3c60da)[_0x20f06d(0xe3)])toggleBotMode(_0x4c2f46);else logger[_0x20f06d(0xfc)](_0x20f06d(0x106));}),_0x1a6e40['on']('delete-bot',(_0x31fd7d,_0x51cecd)=>{const _0x19eabe=_0x4f0a08;if(validateAccess(_0x51cecd,_0x3c60da)['allow'])deleteBot(_0x31fd7d);else logger['full'](_0x19eabe(0x103));}),_0x1a6e40['on'](_0x4f0a08(0x1b4),(_0x347fc8,_0x332031)=>{const _0x13db5f=_0x4f0a08;if(validateAccess(_0x332031,_0x3c60da)['allow'])storeSettings(_0x347fc8,!![]);else logger[_0x13db5f(0xfc)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x1a6e40['on'](_0x4f0a08(0xab),_0x4a360d=>{const _0x144e73=_0x4f0a08;if(validateAccess(_0x4a360d,_0x3c60da)[_0x144e73(0xe3)])updateBB(_0x144e73(0x19b));else logger['full'](_0x144e73(0x240));}),_0x1a6e40['on'](_0x4f0a08(0xdd),_0x7d3119=>{const _0x5a9c15=_0x4f0a08;if(validateAccess(_0x7d3119,_0x3c60da)[_0x5a9c15(0xe3)])updateBB(_0x5a9c15(0xe2));else logger[_0x5a9c15(0xfc)](_0x5a9c15(0x264));}),_0x1a6e40['on'](_0x4f0a08(0x192),_0x316fbe=>{const _0x4fee22=_0x4f0a08;if(validateAccess(_0x316fbe,_0x3c60da)['allow']){const _0x552b35=getClient(_0x1a6e40['id']);if(_0x552b35)getBackupFiles(_0x552b35[_0x4fee22(0x16b)]);else logger[_0x4fee22(0xfc)](_0x4fee22(0x113));}else logger['full'](_0x4fee22(0x222));}),_0x1a6e40['on'](_0x4f0a08(0x263),(_0x24a6d7,_0x223d63)=>{const _0x264369=_0x4f0a08;if(validateAccess(_0x223d63,_0x3c60da)[_0x264369(0xe3)])restoreBackupFile(_0x24a6d7);else logger['full'](_0x264369(0x134));}),_0x1a6e40['on'](_0x4f0a08(0x203),_0x2c49c7=>{const _0x5ef7dd=_0x4f0a08;if(validateAccess(_0x2c49c7,_0x3c60da)['allow'])getMessages();else logger[_0x5ef7dd(0xfc)](_0x5ef7dd(0x109));}),_0x1a6e40['on'](_0x4f0a08(0x21c),(_0xb0546f,_0x15830b)=>{const _0x3486f9=_0x4f0a08;if(validateAccess(_0x15830b,_0x3c60da)[_0x3486f9(0xe3)])confirmMessage(_0xb0546f);else logger[_0x3486f9(0xfc)](_0x3486f9(0x102));}),_0x1a6e40['on'](_0x4f0a08(0x22b),_0x2ec6ba=>{const _0x4afb1d=_0x4f0a08;if(validateAccess(_0x2ec6ba,_0x3c60da)[_0x4afb1d(0xe3)]){if(devices[_0x3c60da][_0x4afb1d(0x194)])clearTimeout(devices[_0x3c60da][_0x4afb1d(0x194)]);if(devices[_0x3c60da]['pidExpireLogin'])clearTimeout(devices[_0x3c60da]['pidExpireLogin']);removeSocketListeners(getClient(_0x1a6e40['id'])[_0x4afb1d(0x16b)]),addBlacklist(_0x3c60da),devices[_0x3c60da][_0x4afb1d(0x22c)]=null,devices[_0x3c60da]['telegram2FaApproval']=null,devices[_0x3c60da][_0x4afb1d(0x210)][_0x4afb1d(0x249)]=null,logger[_0x4afb1d(0xda)]('Logged\x20out\x20user\x20...'+_0x3c60da[_0x4afb1d(0x218)](-0x8)),io['to'](getClient(_0x1a6e40['id'])[_0x4afb1d(0x16b)])[_0x4afb1d(0xa0)]('status',{'access':{'allow':![],'reason':_0x4afb1d(0x164),'token':null}});}else logger[_0x4afb1d(0xfc)](_0x4afb1d(0x16a));});}function initializeSocketBot(_0x4689ba){const _0x518f1b=_0x27f654,_0x242487=getClient(_0x4689ba['id'])['bot'],_0x18b950=getClient(_0x4689ba['id'])['uuid'];_0x4689ba['on'](_0x518f1b(0x213),(_0x368d03,_0x3422fb)=>{const _0x5d8be7=_0x518f1b;if(validateAccess(_0x3422fb,_0x18b950)[_0x5d8be7(0xe3)]){if(pid[_0x242487])pid[_0x242487][_0x5d8be7(0x9f)]({'function':_0x5d8be7(0x259),'args':_0x368d03});}else logger['full'](_0x5d8be7(0x243));}),_0x4689ba['on']('delete-alerts',(_0xd3c63c,_0x3043aa)=>{const _0x1ac102=_0x518f1b;if(validateAccess(_0x3043aa,_0x18b950)[_0x1ac102(0xe3)]){if(pid[_0x242487])pid[_0x242487][_0x1ac102(0x9f)]({'function':_0x1ac102(0x20a),'args':_0xd3c63c});}else logger[_0x1ac102(0xfc)](_0x1ac102(0x10e));}),_0x4689ba['on'](_0x518f1b(0x1c7),(_0x38c7cd,_0x1def43)=>{const _0x3d696c=_0x518f1b;if(validateAccess(_0x1def43,_0x18b950)[_0x3d696c(0xe3)]){if(pid[_0x242487])pid[_0x242487][_0x3d696c(0x9f)]({'function':'getPortfolio','args':_0x38c7cd});}else logger['full'](_0x3d696c(0x1e8));}),_0x4689ba['on'](_0x518f1b(0x1eb),(_0x32f466,_0x4de157)=>{const _0xd69dfd=_0x518f1b;if(validateAccess(_0x4de157,_0x18b950)[_0xd69dfd(0xe3)]){if(pid[_0x242487])pid[_0x242487][_0xd69dfd(0x9f)]({'function':_0xd69dfd(0xf3),'args':_0x32f466});}else logger[_0xd69dfd(0xfc)](_0xd69dfd(0xb2));}),_0x4689ba['on'](_0x518f1b(0x189),(_0x3b55c7,_0x1e6472)=>{const _0x231470=_0x518f1b;if(validateAccess(_0x1e6472,_0x18b950)[_0x231470(0xe3)]){if(pid[_0x242487])pid[_0x242487][_0x231470(0x9f)]({'function':_0x231470(0x185),'args':_0x3b55c7});}else logger[_0x231470(0xfc)](_0x231470(0x226));}),_0x4689ba['on'](_0x518f1b(0x28c),(_0xf330dc,_0x3e3889)=>{const _0x5a1c7f=_0x518f1b;if(validateAccess(_0x3e3889,_0x18b950)[_0x5a1c7f(0xe3)]){if(pid[_0x242487])pid[_0x242487][_0x5a1c7f(0x9f)]({'function':'storeFiat','args':_0xf330dc});}else logger[_0x5a1c7f(0xfc)]('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0x4689ba['on'](_0x518f1b(0x161),_0x4ffe35=>{const _0x21bd9d=_0x518f1b;if(validateAccess(_0x4ffe35,_0x18b950)['allow']){if(pid[_0x242487])pid[_0x242487][_0x21bd9d(0x9f)]({'function':_0x21bd9d(0x160),'args':null});}else logger['full'](_0x21bd9d(0x91));}),_0x4689ba['on'](_0x518f1b(0x195),_0x19b630=>{const _0x55ccc9=_0x518f1b;if(validateAccess(_0x19b630,_0x18b950)[_0x55ccc9(0xe3)]){if(pid[_0x242487])pid[_0x242487][_0x55ccc9(0x9f)]({'function':'getStartingBalances','args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x4689ba['on'](_0x518f1b(0x227),(_0x4dc164,_0x58c1cf)=>{const _0x1a6bc6=_0x518f1b;if(validateAccess(_0x58c1cf,_0x18b950)[_0x1a6bc6(0xe3)]){if(pid[_0x242487])pid[_0x242487][_0x1a6bc6(0x9f)]({'function':_0x1a6bc6(0x119),'args':_0x4dc164});}else logger[_0x1a6bc6(0xfc)](_0x1a6bc6(0x292));}),_0x4689ba['on'](_0x518f1b(0x152),_0x151cd3=>{const _0x42272f=_0x518f1b;if(validateAccess(_0x151cd3,_0x18b950)['allow']){if(pid[_0x242487])pid[_0x242487][_0x42272f(0x9f)]({'function':_0x42272f(0xbd),'args':null});}else logger['full'](_0x42272f(0x28b));}),_0x4689ba['on'](_0x518f1b(0x1f6),_0xa88be9=>{const _0x21a59e=_0x518f1b;if(validateAccess(_0xa88be9,_0x18b950)[_0x21a59e(0xe3)]){if(pid[_0x242487])pid[_0x242487][_0x21a59e(0x9f)]({'function':_0x21a59e(0x82),'args':null});}else logger['full'](_0x21a59e(0x108));}),_0x4689ba['on'](_0x518f1b(0xab),_0x3d00c9=>{const _0x4591ee=_0x518f1b;if(validateAccess(_0x3d00c9,_0x18b950)['allow'])updateBB(_0x4591ee(0x19b));else logger[_0x4591ee(0xfc)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x4689ba['on']('get-messages',_0x4c1310=>{const _0x4a4d4e=_0x518f1b;if(validateAccess(_0x4c1310,_0x18b950)[_0x4a4d4e(0xe3)])getMessages();else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x4689ba['on']('confirm-message',(_0x280864,_0xe6f581)=>{const _0x197c54=_0x518f1b;if(validateAccess(_0xe6f581,_0x18b950)[_0x197c54(0xe3)])confirmMessage(_0x280864);else logger[_0x197c54(0xfc)](_0x197c54(0x102));}),_0x4689ba['on'](_0x518f1b(0x22b),_0x501a9f=>{const _0x1d1ee9=_0x518f1b;if(validateAccess(_0x501a9f,_0x18b950)[_0x1d1ee9(0xe3)]){if(devices[_0x18b950][_0x1d1ee9(0x194)])clearTimeout(devices[_0x18b950][_0x1d1ee9(0x194)]);if(devices[_0x18b950][_0x1d1ee9(0xe7)])clearTimeout(devices[_0x18b950][_0x1d1ee9(0xe7)]);removeSocketListeners(getClient(_0x4689ba['id'])[_0x1d1ee9(0x16b)]),addBlacklist(_0x18b950),devices[_0x18b950][_0x1d1ee9(0x22c)]=null,devices[_0x18b950]['telegram2FaApproval']=null,devices[_0x18b950]['access'][_0x1d1ee9(0x249)]=null,logger[_0x1d1ee9(0xda)](_0x1d1ee9(0x1d8)+_0x18b950[_0x1d1ee9(0x218)](-0x8)),io['to'](getClient(_0x4689ba['id'])[_0x1d1ee9(0x16b)])[_0x1d1ee9(0xa0)]('status',{'access':{'allow':![],'reason':_0x1d1ee9(0x164),'token':null}});}else logger['full'](_0x1d1ee9(0x16a));});}function removeSocketListeners(_0x100ef4){const _0x17cfd9=_0x27f654;getClientsWithUuid(_0x100ef4)[_0x17cfd9(0xf6)](_0x473fdb=>{const _0x478311=_0x17cfd9;getSocket(_0x473fdb['id'])[_0x478311(0xd4)]();});}function cleanSettings(){const _0x4dee9f=_0x27f654;let _0xd2b749=settings;return settings[_0x4dee9f(0xad)]&&settings['telegramToken']!=''&&(_0xd2b749={..._0xd2b749,'telegramToken':'************'}),settings[_0x4dee9f(0x200)]&&settings[_0x4dee9f(0x200)]!=''&&(_0xd2b749={..._0xd2b749,'bbPassword':_0x4dee9f(0x1cf)}),settings[_0x4dee9f(0x115)]&&settings[_0x4dee9f(0x115)]!=''&&(_0xd2b749={..._0xd2b749,'marketcapApi':_0x4dee9f(0x1cf)}),(settings[_0x4dee9f(0x200)]&&settings['bbPassword']==_0x4dee9f(0x261)||settings[_0x4dee9f(0xad)]&&settings[_0x4dee9f(0xad)]==_0x4dee9f(0x261)||settings[_0x4dee9f(0x115)]&&settings[_0x4dee9f(0x115)]==_0x4dee9f(0x261))&&(_0xd2b749={..._0xd2b749,'restored':{'password':settings[_0x4dee9f(0x200)]==_0x4dee9f(0x261),'telegram':settings[_0x4dee9f(0xad)]==_0x4dee9f(0x261),'marketcap':settings[_0x4dee9f(0x115)]=='***'}}),_0xd2b749;}async function updateBB(_0x42db6a){const _0x40a424=_0x27f654;await backupConfigFiles(),installingUpdate=!![],config[_0x40a424(0xf6)](_0x4e4535=>{const _0x5a2b53=_0x40a424;restartBot(_0x4e4535[_0x5a2b53(0x1e2)]);});if(_0x42db6a==_0x40a424(0x19b))process['send']({'update':!![],'environment':environment},_0x2ec963=>{});else _0x42db6a==_0x40a424(0xe2)&&process[_0x40a424(0x9f)]({'reinstall':!![],'environment':environment},_0x4b2ef3=>{});}function startBot(_0x4bb56e,_0x4ff8e4,_0x30e231){const _0x3331d2=_0x27f654;if(debugging)_0x4bb56e[_0x3331d2(0x150)]('-d');if(recreate)_0x4bb56e[_0x3331d2(0x150)]('-r');let _0xf38838=![];const _0xbbee85=_0x4bb56e[0x0];_0x4ff8e4={..._0x4ff8e4,'stdio':[_0x3331d2(0x1a3),'inherit',_0x3331d2(0x1a3),'ipc']},pid[_0xbbee85]=childProcess[_0x3331d2(0x256)](botfile,_0x4bb56e,_0x4ff8e4),pid[_0xbbee85]['on'](_0x3331d2(0xa2),_0x42506c=>{const _0x2ec064=_0x3331d2;switch(Object[_0x2ec064(0x1af)](_0x42506c)[0x0]){case _0x2ec064(0x88):updateBotName(_0xbbee85,_0x42506c[_0x2ec064(0x88)]);break;case _0x2ec064(0x166):updateBotManager();break;case _0x2ec064(0x141):updateStatus(_0xbbee85,_0x42506c[_0x2ec064(0x141)]);break;case'live':updateLive(_0xbbee85,_0x42506c[_0x2ec064(0x20e)]);break;case'started':updateLive(_0xbbee85,_0x42506c[_0x2ec064(0x206)]),io['to'](_0xbbee85)['emit'](_0x2ec064(0x141),{'access':{'allow':![],'reason':_0x2ec064(0x228),'token':null}});break;case _0x2ec064(0x19f):_0x42506c['stop']=='restart'&&restartBot(_0xbbee85);_0x42506c[_0x2ec064(0x19f)]==_0x2ec064(0x275)&&toggleBot(_0xbbee85,_0x2ec064(0x267),'stopped');break;case'telegram':sendTelegramBot(_0xbbee85,_0x42506c[_0x2ec064(0x7c)]);break;case _0x2ec064(0x83):sendTelegramMsg(_0x42506c[_0x2ec064(0x83)]);break;case _0x2ec064(0x229):io['to'](_0xbbee85)[_0x2ec064(0xa0)](_0x42506c[_0x2ec064(0x229)],_0x42506c['args']);break;}}),pid[_0xbbee85]['on']('error',function(_0xaf73ea){if(_0xf38838)return;_0xf38838=!![],_0x30e231(_0xaf73ea);}),pid[_0xbbee85]['on']('exit',async function(_0x89a636){const _0x44de28=_0x3331d2;if(terminating)return;if(installingUpdate){io[_0x44de28(0x118)]();return;}if(_0xf38838)return;_0xf38838=!![],_0x30e231(null);const _0x2661a2=dbConfig['get'](_0x44de28(0x1c1))[_0x44de28(0x181)]({'botID':_0xbbee85})[_0x44de28(0x179)]();_0x2661a2&&(_0x2661a2[_0x44de28(0x141)]==_0x44de28(0x247)||_0x2661a2['status']==_0x44de28(0x1ac))&&(await sleep(0x3e8),updateLive(_0xbbee85,_0x44de28(0x101)),logger[_0x44de28(0xfc)](_0x44de28(0x223)+botRef(_0xbbee85)),startBot([_0xbbee85,userID],{'cwd':bbpath},function(_0x312b86){const _0x35cc5d=_0x44de28;if(_0x312b86)logger[_0x35cc5d(0xfc)](_0x312b86);}));});}function stopBot(_0x6846e7){const _0x924112=_0x27f654;getClientsWithBotID(_0x6846e7)[_0x924112(0xf6)](_0x4d42b4=>{const _0x52810f=_0x924112;getSocket(_0x4d42b4['id'])[_0x52810f(0x12d)](!![]),removeClient(_0x4d42b4['id']);}),pid[_0x6846e7]&&(pid[_0x6846e7]['kill'](),pid[_0x6846e7]=null);}function stopAllBots(){const _0x2592b4=_0x27f654;terminating=!![];const _0x45126e=getEnabledBots();_0x45126e[_0x2592b4(0xf6)](_0x6ef9f2=>{const _0x1b05bf=_0x2592b4;stopBot(_0x6ef9f2[_0x1b05bf(0x1e2)]);});}function restartBot(_0x40b85d){if(pid[_0x40b85d])pid[_0x40b85d]['kill']();}function addBot(){const _0x43c83f=_0x27f654;let _0x20e386;for(let _0x55cf06=0x1;_0x55cf06<0x3e9;_0x55cf06++){_0x20e386=_0x55cf06[_0x43c83f(0xcc)]()[_0x43c83f(0x1b1)](0x3,'0');let _0x38ca68=config[_0x43c83f(0x181)](_0x268ef8=>_0x268ef8[_0x43c83f(0x1e2)]==_0x20e386);if(!_0x38ca68)break;}if(_0x20e386===_0x43c83f(0x149)){logger[_0x43c83f(0xfc)](_0x43c83f(0x133));return;}logger[_0x43c83f(0xfc)](_0x43c83f(0x1a6)+_0x20e386),dbConfig['get']('bots')[_0x43c83f(0x150)]({'botID':_0x20e386,'botname':_0x43c83f(0x1bf)+_0x20e386,'status':_0x43c83f(0x1ac),'live':''})[_0x43c83f(0x14d)](),startBot([_0x20e386,userID],{'cwd':bbpath},function(_0x1cf6ac){const _0x2ed90b=_0x43c83f;if(_0x1cf6ac)logger[_0x2ed90b(0xfc)](_0x1cf6ac);}),config=getConfiguration(),io['to'](_0x43c83f(0x9b))[_0x43c83f(0xa0)](_0x43c83f(0x1c1),config),broadcastToBots(_0x43c83f(0x1c1),JSON['stringify'](config));}function deleteBot(_0x5774b1){const _0x3d9f27=_0x27f654;getClientsWithBotID(_0x5774b1)['forEach'](_0x477591=>{const _0x57e2aa=_0x6c29;getSocket(_0x477591['id'])[_0x57e2aa(0x12d)](!![]),removeClient(_0x477591['id']);}),dbConfig[_0x3d9f27(0x190)](_0x3d9f27(0x1c1))[_0x3d9f27(0x1a1)]({'botID':_0x5774b1})[_0x3d9f27(0x14d)](),logger[_0x3d9f27(0xfc)]('Deleted\x20Bot\x20'+_0x5774b1),stopBot(_0x5774b1);try{if(fs[_0x3d9f27(0xf0)](path[_0x3d9f27(0x27c)](configpath,_0x3d9f27(0x8d)+_0x5774b1+_0x3d9f27(0x16c))))fs[_0x3d9f27(0x1be)](path[_0x3d9f27(0x27c)](configpath,_0x3d9f27(0x8d)+_0x5774b1+_0x3d9f27(0x16c)));if(fs[_0x3d9f27(0xf0)](path[_0x3d9f27(0x27c)](configpath,_0x3d9f27(0x8d)+_0x5774b1+_0x3d9f27(0x25f))))fs[_0x3d9f27(0x1be)](path[_0x3d9f27(0x27c)](configpath,'bot-'+_0x5774b1+'-events.json'));if(fs[_0x3d9f27(0xf0)](path['join'](configpath,_0x3d9f27(0x8d)+_0x5774b1+_0x3d9f27(0x266))))fs['unlinkSync'](path[_0x3d9f27(0x27c)](configpath,_0x3d9f27(0x8d)+_0x5774b1+_0x3d9f27(0x266)));if(fs[_0x3d9f27(0xf0)](path[_0x3d9f27(0x27c)](configpath,_0x3d9f27(0x8d)+_0x5774b1+'-results.json')))fs[_0x3d9f27(0x1be)](path[_0x3d9f27(0x27c)](configpath,_0x3d9f27(0x8d)+_0x5774b1+_0x3d9f27(0x15d)));}catch(_0x51e3d1){if(_0x51e3d1)logger[_0x3d9f27(0xfc)](_0x3d9f27(0x1f4),_0x51e3d1);}config=getConfiguration(),io['to'](_0x3d9f27(0x9b))[_0x3d9f27(0xa0)]('bots',config),broadcastToBots(_0x3d9f27(0x1c1),JSON['stringify'](config));}function toggleBot(_0x300341,_0x54e7d5,_0x44c60b){const _0x36eef8=_0x27f654;dbConfig[_0x36eef8(0x190)](_0x36eef8(0x1c1))[_0x36eef8(0x181)]({'botID':_0x300341})[_0x36eef8(0xca)]({'status':_0x54e7d5})[_0x36eef8(0xca)]({'live':_0x44c60b})[_0x36eef8(0x14d)]();const _0x6ced65=botRef(_0x300341);if(_0x54e7d5=='enabled'||_0x54e7d5==_0x36eef8(0x1ac))logger[_0x36eef8(0xfc)]('Enabled\x20'+_0x6ced65),startBot([_0x300341,userID],{'cwd':bbpath},function(_0x3b788b){if(_0x3b788b)logger['full'](_0x3b788b);});else(_0x54e7d5==_0x36eef8(0x267)||_0x54e7d5==_0x36eef8(0x1f2))&&(logger[_0x36eef8(0xfc)](_0x36eef8(0x165)+_0x6ced65),stopBot(_0x300341));config=getConfiguration(),io['to'](_0x36eef8(0x9b))[_0x36eef8(0xa0)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function toggleStatus(_0x3b8d65){const _0x557d39=_0x27f654;let _0x8a2368=dbConfig[_0x557d39(0x190)](_0x557d39(0x1c1))['find']({'botID':_0x3b8d65})['value'](),_0x4afc80;if(_0x8a2368['status']===_0x557d39(0x247))_0x4afc80='disabled';else{if(_0x8a2368[_0x557d39(0x141)]===_0x557d39(0x1ac))_0x4afc80='new-disabled';else{if(_0x8a2368[_0x557d39(0x141)]===_0x557d39(0x1f2))_0x4afc80=_0x557d39(0x1ac);else{if(_0x8a2368[_0x557d39(0x141)]===_0x557d39(0x267))_0x4afc80=_0x557d39(0x247);}}}return _0x4afc80;}function updateStatus(_0x339455,_0x562fee){const _0x1037fd=_0x27f654;dbConfig['get'](_0x1037fd(0x1c1))[_0x1037fd(0x181)]({'botID':_0x339455})[_0x1037fd(0xca)]({'status':_0x562fee})[_0x1037fd(0x14d)](),config=getConfiguration(),io['to'](_0x1037fd(0x9b))[_0x1037fd(0xa0)](_0x1037fd(0x1c1),config),broadcastToBots(_0x1037fd(0x1c1),JSON[_0x1037fd(0x18a)](config));}function updateLive(_0x475025,_0xd59b28){const _0x1ef6e6=_0x27f654;dbConfig[_0x1ef6e6(0x190)](_0x1ef6e6(0x1c1))[_0x1ef6e6(0x181)]({'botID':_0x475025})[_0x1ef6e6(0xca)]({'live':_0xd59b28})[_0x1ef6e6(0x14d)](),config=getConfiguration(),io['to'](_0x1ef6e6(0x9b))['emit']('bots',config),broadcastToBots(_0x1ef6e6(0x1c1),JSON[_0x1ef6e6(0x18a)](config));}function updateBotName(_0x165714,_0x4c1800){const _0x3d3bf6=_0x27f654;dbConfig[_0x3d3bf6(0x190)](_0x3d3bf6(0x1c1))[_0x3d3bf6(0x181)]({'botID':_0x165714})[_0x3d3bf6(0xca)]({'botname':_0x4c1800})[_0x3d3bf6(0x14d)](),config=getConfiguration(),io['to'](_0x3d3bf6(0x9b))['emit'](_0x3d3bf6(0x1c1),config),broadcastToBots(_0x3d3bf6(0x1c1),JSON['stringify'](config));}function updateBotManager(){const _0x1aa6cd=_0x27f654;config=getConfiguration(),io['to']('botmanager')[_0x1aa6cd(0xa0)](_0x1aa6cd(0x1c1),config),broadcastToBots('bots',JSON[_0x1aa6cd(0x18a)](config));}function toggleBotMode(_0x550043){const _0x31cdaa=_0x27f654;if(pid[_0x550043])pid[_0x550043][_0x31cdaa(0x9f)]({'function':_0x31cdaa(0x19d),'args':null});else{const _0x3053b4=configpath+_0x31cdaa(0x8d)+_0x550043+_0x31cdaa(0x16c),_0x564228=fs['readFileSync'](_0x3053b4),_0x4623db=JSON['parse'](_0x564228),_0x2d7b9d=_0x4623db['bot'][0x0][_0x31cdaa(0x248)];_0x4623db['bot'][0x0][_0x31cdaa(0x248)]=!_0x2d7b9d;const _0x4320d1=JSON[_0x31cdaa(0x18a)](_0x4623db,null,0x2);fs[_0x31cdaa(0x17c)](_0x3053b4,_0x4320d1),config=getConfiguration(),io['to']('botmanager')['emit'](_0x31cdaa(0x1c1),config),broadcastToBots(_0x31cdaa(0x1c1),JSON[_0x31cdaa(0x18a)](config));}}function validateTelegram(_0x1a2031){const _0x5e4cab=_0x27f654;if(_0x1a2031['from']['username']!=settings[_0x5e4cab(0xf8)]&&'@'+_0x1a2031[_0x5e4cab(0x146)][_0x5e4cab(0xc6)]!=settings['telegramUsername']||_0x1a2031[_0x5e4cab(0x122)]['id']!=settings[_0x5e4cab(0x175)])return sendTelegram(_0x1a2031[_0x5e4cab(0x122)]['id'],_0x5e4cab(0x232),{'parse_mode':_0x5e4cab(0x11b)}),![];return!![];}function botRef(_0x3f142e){const _0x46599b=_0x27f654,_0x587d46=getBotAttributes(_0x3f142e),_0xbaf4e1=_0x587d46[_0x46599b(0x116)]?_0x587d46[_0x46599b(0x88)]:_0x46599b(0x1bf)+_0x3f142e;return _0xbaf4e1;}async function initTelegram(){const _0x1e4ebc=_0x27f654;tgBot&&(await tgBot[_0x1e4ebc(0x19f)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x1e4ebc(0xad)]);let _0x52ef24=_0x1e4ebc(0xba);_0x52ef24+='\x0a',_0x52ef24+=_0x1e4ebc(0x1fd),_0x52ef24+='/disable\x20-\x20disable\x20notifications\x0a',_0x52ef24+=_0x1e4ebc(0x26e),_0x52ef24+=_0x1e4ebc(0x14e),_0x52ef24+=_0x1e4ebc(0x153),_0x52ef24+=_0x1e4ebc(0x7d),_0x52ef24+=_0x1e4ebc(0x1c5),_0x52ef24+='/names\x20-\x20show\x20bot\x20names\x0a',_0x52ef24+=_0x1e4ebc(0x9c),_0x52ef24+=_0x1e4ebc(0x252),_0x52ef24+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x52ef24+=_0x1e4ebc(0x1d1),_0x52ef24+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0x52ef24+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x52ef24+=_0x1e4ebc(0x1c9),_0x52ef24+=_0x1e4ebc(0x216);let _0x113fc9='Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a';_0x113fc9+='\x0a',_0x113fc9+=_0x52ef24,tgBot[_0x1e4ebc(0x1ca)]((_0x296717,_0x3b2e25)=>{const _0x28992f=_0x1e4ebc;logger[_0x28992f(0x271)](getTimeStamp()+_0x28992f(0x21d)),logger[_0x28992f(0xda)]('Telegraf\x20error:',_0x296717);}),tgBot[_0x1e4ebc(0x1ab)](async(_0x1f9600,_0x59347f)=>{const _0x2ca939=_0x1e4ebc;if(settings[_0x2ca939(0x175)]||_0x1f9600[_0x2ca939(0x19b)]['message'][_0x2ca939(0x1c4)]!=_0x2ca939(0x1d2)){if(!validateTelegram(_0x1f9600))return;}_0x59347f();}),tgBot['command'](_0x1e4ebc(0x187),async _0x49f6d4=>{const _0x319f82=_0x1e4ebc;if(_0x49f6d4[_0x319f82(0x146)][_0x319f82(0xc6)]==settings[_0x319f82(0xf8)]||'@'+_0x49f6d4[_0x319f82(0x146)][_0x319f82(0xc6)]==settings[_0x319f82(0xf8)]){if(!settings[_0x319f82(0x175)])updateSetting('telegramChatId',_0x49f6d4[_0x319f82(0x122)]['id']);else{if(!validateTelegram(_0x49f6d4))return;}}else{if(!validateTelegram(_0x49f6d4))return;}updateSetting('telegramEnabled',!![]),await sendTelegram(_0x49f6d4['chat']['id'],_0x113fc9);}),tgBot[_0x1e4ebc(0x1e5)](_0x1e4ebc(0x1ce),async _0x1fef0f=>{const _0x388877=_0x1e4ebc;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1fef0f[_0x388877(0x122)]['id'],_0x388877(0x1c8));}),tgBot[_0x1e4ebc(0x1e5)](_0x1e4ebc(0xf7),async _0x32ae60=>{const _0x387c15=_0x1e4ebc;await sendTelegram(_0x32ae60[_0x387c15(0x122)]['id'],'Notifications\x20disabled'),updateSetting('telegramEnabled',![]);}),tgBot['command'](_0x1e4ebc(0x290),async _0x4d0379=>{const _0x1b90aa=_0x1e4ebc,_0x610a55=Markup['inlineKeyboard']([Markup[_0x1b90aa(0x163)][_0x1b90aa(0x1d3)](_0x1b90aa(0x10d),_0x1b90aa(0x12a)),Markup['button'][_0x1b90aa(0x1d3)](_0x1b90aa(0xd8),_0x1b90aa(0x13c)),Markup[_0x1b90aa(0x163)]['callback']('All',_0x1b90aa(0x125))]);_0x4d0379[_0x1b90aa(0x1bc)](_0x1b90aa(0x1d4),_0x610a55);}),tgBot[_0x1e4ebc(0x201)](_0x1e4ebc(0x12a),async _0x2cd773=>{const _0x5cccd7=_0x1e4ebc;_0x2cd773[_0x5cccd7(0x123)](),updateSetting(_0x5cccd7(0x92),_0x5cccd7(0xf1)),updateSetting(_0x5cccd7(0x10b),!![]),await sendTelegram(_0x2cd773['chat']['id'],_0x5cccd7(0x22d));}),tgBot[_0x1e4ebc(0x201)](_0x1e4ebc(0x13c),async _0xdacd5e=>{const _0xc4193a=_0x1e4ebc;_0xdacd5e[_0xc4193a(0x123)](),updateSetting(_0xc4193a(0x92),_0xc4193a(0x220)),updateSetting(_0xc4193a(0x10b),!![]),await sendTelegram(_0xdacd5e[_0xc4193a(0x122)]['id'],_0xc4193a(0x114));}),tgBot[_0x1e4ebc(0x201)](_0x1e4ebc(0x125),async _0xa15cc5=>{const _0x6b33ce=_0x1e4ebc;_0xa15cc5[_0x6b33ce(0x123)](),updateSetting(_0x6b33ce(0x92),'all'),updateSetting(_0x6b33ce(0x10b),!![]),await sendTelegram(_0xa15cc5[_0x6b33ce(0x122)]['id'],_0x6b33ce(0x155));}),tgBot[_0x1e4ebc(0x1e5)](_0x1e4ebc(0x141),async _0x2370ef=>{const _0x29dd7e=_0x1e4ebc,_0x4fa4ce=getBotsWithMode();let _0x2e0350=_0x29dd7e(0x24b);config['forEach'](_0x19d5dd=>{const _0x44daac=_0x29dd7e,_0x574eb2=_0x4fa4ce[_0x44daac(0x181)](_0x4b2758=>_0x4b2758[_0x44daac(0x1e2)]==_0x19d5dd[_0x44daac(0x1e2)])[_0x44daac(0x1dd)];_0x2e0350+=_0x44daac(0x1bf)+_0x19d5dd[_0x44daac(0x1e2)]+':\x20'+_0x19d5dd[_0x44daac(0x141)]+_0x44daac(0x14a)+_0x574eb2+_0x44daac(0x14a)+_0x19d5dd[_0x44daac(0x20e)]+'\x0a';}),_0x2e0350+='\x0a',_0x2e0350+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x2e0350+=!settings[_0x29dd7e(0x10b)]?_0x29dd7e(0x27e):_0x29dd7e(0x84),_0x2e0350+=settings[_0x29dd7e(0x10b)]?settings[_0x29dd7e(0x92)]==_0x29dd7e(0x291)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':_0x29dd7e(0x137)+settings['telegramEvents']+_0x29dd7e(0x18e):'',await sendTelegram(_0x2370ef[_0x29dd7e(0x122)]['id'],_0x2e0350,{'parse_mode':_0x29dd7e(0x11b)});}),tgBot[_0x1e4ebc(0x1e5)](_0x1e4ebc(0x27b),async _0x5c59c3=>{const _0xac4018=_0x1e4ebc,_0xc1feda=getEnabledBots();if(_0xc1feda['length']==0x0)await sendTelegram(_0x5c59c3[_0xac4018(0x122)]['id'],_0xac4018(0x234));else{if(_0xc1feda[_0xac4018(0x17e)]>0x1)_0xc1feda[_0xac4018(0x150)]({'botID':_0xac4018(0x291)});let _0x56308d=[],_0x22e37b=[];const _0x3c8c4a=_0xc1feda['length']%0x4==0x0||_0xc1feda[_0xac4018(0x17e)]%0x4==0x3||_0xc1feda[_0xac4018(0x17e)]%0x3==0x1?0x4:0x3;let _0x5554f8=0x0;_0xc1feda[_0xac4018(0xf6)]((_0x1098f6,_0x42c9ab)=>{const _0x50713b=_0xac4018;if(_0x42c9ab%_0x3c8c4a==0x0)_0x22e37b=[];_0x22e37b[_0x50713b(0x150)](Markup[_0x50713b(0x163)]['callback'](_0x1098f6['botID']==_0x50713b(0x291)?_0x50713b(0x26b):botRef(_0x1098f6['botID']),_0x50713b(0x162)+_0x1098f6[_0x50713b(0x1e2)])),_0x42c9ab%_0x3c8c4a==0x0&&(_0x56308d[_0x5554f8]=_0x22e37b,_0x5554f8++);});const _0x40e9e7=Markup[_0xac4018(0x188)](_0x56308d);_0x5c59c3[_0xac4018(0x1bc)](_0xac4018(0x110),_0x40e9e7);}}),tgBot['action'](/restart_(.+)/,async _0x2febb6=>{const _0x4c7d2c=_0x1e4ebc,_0x204a69=_0x2febb6['match'][0x1];_0x2febb6['editMessageReplyMarkup'](),_0x204a69==_0x4c7d2c(0x291)?config[_0x4c7d2c(0xf6)](_0x8a588c=>{restartBot(_0x8a588c['botID']);}):restartBot(_0x204a69);}),tgBot[_0x1e4ebc(0x1e5)]('on',async _0x538f28=>{const _0x4a9d2c=_0x1e4ebc,_0x16e111=getDisabledBots();if(_0x16e111['length']==0x0)await sendTelegram(_0x538f28[_0x4a9d2c(0x122)]['id'],_0x4a9d2c(0x21b));else{if(_0x16e111[_0x4a9d2c(0x17e)]>0x1)_0x16e111[_0x4a9d2c(0x150)]({'botID':_0x4a9d2c(0x291)});let _0x5bd909=[],_0x2ce59a=[];const _0x40bad5=_0x16e111[_0x4a9d2c(0x17e)]%0x4==0x0||_0x16e111[_0x4a9d2c(0x17e)]%0x4==0x3||_0x16e111[_0x4a9d2c(0x17e)]%0x3==0x1?0x4:0x3;let _0x33e544=0x0;_0x16e111[_0x4a9d2c(0xf6)]((_0x4bf841,_0x228790)=>{const _0xa51cb1=_0x4a9d2c;if(_0x228790%_0x40bad5==0x0)_0x2ce59a=[];_0x2ce59a[_0xa51cb1(0x150)](Markup['button'][_0xa51cb1(0x1d3)](_0x4bf841['botID']==_0xa51cb1(0x291)?'All\x20bots':botRef(_0x4bf841[_0xa51cb1(0x1e2)]),'on_'+_0x4bf841['botID'])),_0x228790%_0x40bad5==0x0&&(_0x5bd909[_0x33e544]=_0x2ce59a,_0x33e544++);});const _0x6e4e3f=Markup[_0x4a9d2c(0x188)](_0x5bd909);_0x538f28[_0x4a9d2c(0x1bc)](_0x4a9d2c(0x257),_0x6e4e3f);}}),tgBot[_0x1e4ebc(0x201)](/on_(.+)/,async _0x4245be=>{const _0x328794=_0x1e4ebc,_0x5455ce=_0x4245be[_0x328794(0xc8)][0x1];_0x4245be[_0x328794(0x123)]();if(_0x5455ce==_0x328794(0x291)){const _0x1992ec=getDisabledBots();await sendTelegram(_0x4245be[_0x328794(0x122)]['id'],_0x328794(0x199)),_0x1992ec[_0x328794(0xf6)](_0x681257=>{const _0x2cd062=_0x328794;if(_0x681257[_0x2cd062(0x1e2)]!=_0x2cd062(0x291))toggleBot(_0x681257[_0x2cd062(0x1e2)],toggleStatus(_0x681257['botID']),'stopped');});}else await sendTelegram(_0x4245be[_0x328794(0x122)]['id'],'Bot\x20Mgr\x20>\x20Starting\x20'+botRef(_0x5455ce)),toggleBot(_0x5455ce,toggleStatus(_0x5455ce),'stopped');}),tgBot['command'](_0x1e4ebc(0x15a),async _0x3f26cf=>{const _0xa0e7b0=_0x1e4ebc,_0x4f5052=getEnabledBots();if(_0x4f5052[_0xa0e7b0(0x17e)]==0x0)await sendTelegram(_0x3f26cf[_0xa0e7b0(0x122)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x4f5052['length']>0x1)_0x4f5052['push']({'botID':'all'});let _0x49bdc5=[],_0x12bc6e=[];const _0x552553=_0x4f5052['length']%0x4==0x0||_0x4f5052[_0xa0e7b0(0x17e)]%0x4==0x3||_0x4f5052['length']%0x3==0x1?0x4:0x3;let _0x367665=0x0;_0x4f5052[_0xa0e7b0(0xf6)]((_0x1ef4d6,_0x3735d2)=>{const _0x1d0792=_0xa0e7b0;if(_0x3735d2%_0x552553==0x0)_0x12bc6e=[];_0x12bc6e[_0x1d0792(0x150)](Markup['button'][_0x1d0792(0x1d3)](_0x1ef4d6[_0x1d0792(0x1e2)]==_0x1d0792(0x291)?_0x1d0792(0x26b):botRef(_0x1ef4d6[_0x1d0792(0x1e2)]),_0x1d0792(0x245)+_0x1ef4d6[_0x1d0792(0x1e2)])),_0x3735d2%_0x552553==0x0&&(_0x49bdc5[_0x367665]=_0x12bc6e,_0x367665++);});const _0x225760=Markup['inlineKeyboard'](_0x49bdc5);_0x3f26cf['reply'](_0xa0e7b0(0x28e),_0x225760);}}),tgBot[_0x1e4ebc(0x201)](/off_(.+)/,async _0x1d1a5b=>{const _0xedbcb2=_0x1e4ebc,_0xd81bf0=_0x1d1a5b[_0xedbcb2(0xc8)][0x1];_0x1d1a5b[_0xedbcb2(0x123)]();if(_0xd81bf0==_0xedbcb2(0x291)){const _0x5edb06=getEnabledBots();await sendTelegram(_0x1d1a5b['chat']['id'],_0xedbcb2(0x173)),_0x5edb06[_0xedbcb2(0xf6)](_0x2feb0d=>{const _0x2ab5f1=_0xedbcb2;if(_0x2feb0d[_0x2ab5f1(0x1e2)]!=_0x2ab5f1(0x291))toggleBot(_0x2feb0d[_0x2ab5f1(0x1e2)],toggleStatus(_0x2feb0d[_0x2ab5f1(0x1e2)]),_0x2ab5f1(0x101));});}else await sendTelegram(_0x1d1a5b['chat']['id'],_0xedbcb2(0x128)+botRef(_0xd81bf0)),toggleBot(_0xd81bf0,toggleStatus(_0xd81bf0),_0xedbcb2(0x101));}),tgBot[_0x1e4ebc(0x1e5)]('metrics',async _0x137776=>{const _0x3189e7=_0x1e4ebc,_0x1c4146=getEnabledBots();if(_0x1c4146[_0x3189e7(0x17e)]==0x0)await sendTelegram(_0x137776[_0x3189e7(0x122)]['id'],_0x3189e7(0x234));else{if(_0x1c4146[_0x3189e7(0x17e)]>0x1){let _0x392396=[],_0x7fa4=[];const _0x54c326=_0x1c4146[_0x3189e7(0x17e)]%0x4==0x0||_0x1c4146[_0x3189e7(0x17e)]%0x4==0x3||_0x1c4146[_0x3189e7(0x17e)]%0x3==0x1?0x4:0x3;let _0x5d84cc=0x0;_0x1c4146[_0x3189e7(0xf6)]((_0x1e4a9c,_0x3c5831)=>{const _0x4e1ac7=_0x3189e7;if(_0x3c5831%_0x54c326==0x0)_0x7fa4=[];_0x7fa4['push'](Markup[_0x4e1ac7(0x163)][_0x4e1ac7(0x1d3)](botRef(_0x1e4a9c[_0x4e1ac7(0x1e2)]),'metrics_'+_0x1e4a9c[_0x4e1ac7(0x1e2)])),_0x3c5831%_0x54c326==0x0&&(_0x392396[_0x5d84cc]=_0x7fa4,_0x5d84cc++);});const _0x213028=Markup[_0x3189e7(0x188)](_0x392396);_0x137776[_0x3189e7(0x1bc)](_0x3189e7(0x124),_0x213028);}else{const _0x1a146c=_0x1c4146[0x0][_0x3189e7(0x1e2)];if(pid[_0x1a146c])pid[_0x1a146c][_0x3189e7(0x9f)]({'function':_0x3189e7(0x93),'args':null});}}}),tgBot[_0x1e4ebc(0x201)](/metrics_(.+)/,async _0x4e37a8=>{const _0x2c9735=_0x1e4ebc,_0x5ebacc=_0x4e37a8['match'][0x1];_0x4e37a8['editMessageReplyMarkup']();if(pid[_0x5ebacc])pid[_0x5ebacc][_0x2c9735(0x9f)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x1e4ebc(0x1e5)]('portfolio',async _0xec299f=>{const _0x61ed55=_0x1e4ebc,_0x357b16=getEnabledBots();if(_0x357b16['length']==0x0)await sendTelegram(_0xec299f[_0x61ed55(0x122)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x357b16[_0x61ed55(0x17e)]>0x1){let _0x705db5=[],_0x1bce8d=[];const _0x1ac935=_0x357b16[_0x61ed55(0x17e)]%0x4==0x0||_0x357b16[_0x61ed55(0x17e)]%0x4==0x3||_0x357b16[_0x61ed55(0x17e)]%0x3==0x1?0x4:0x3;let _0x3505d3=0x0;_0x357b16[_0x61ed55(0xf6)]((_0x42046a,_0x300962)=>{const _0x49acf0=_0x61ed55;if(_0x300962%_0x1ac935==0x0)_0x1bce8d=[];_0x1bce8d[_0x49acf0(0x150)](Markup[_0x49acf0(0x163)][_0x49acf0(0x1d3)](botRef(_0x42046a[_0x49acf0(0x1e2)]),'portfolio_'+_0x42046a[_0x49acf0(0x1e2)])),_0x300962%_0x1ac935==0x0&&(_0x705db5[_0x3505d3]=_0x1bce8d,_0x3505d3++);});const _0x488956=Markup[_0x61ed55(0x188)](_0x705db5);_0xec299f['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x488956);}else{const _0x345674=_0x357b16[0x0][_0x61ed55(0x1e2)];if(pid[_0x345674])pid[_0x345674][_0x61ed55(0x9f)]({'function':_0x61ed55(0x13a),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x115ecb=>{const _0x36de52=_0x1e4ebc,_0x529dc3=_0x115ecb[_0x36de52(0xc8)][0x1];_0x115ecb[_0x36de52(0x123)]();if(pid[_0x529dc3])pid[_0x529dc3][_0x36de52(0x9f)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x1e4ebc(0x1e5)](_0x1e4ebc(0x17a),async _0x2f5804=>{const _0x349d47=_0x1e4ebc,_0x3d8baa=_0x349d47(0x17a);await zipFiles(_0x3d8baa);const _0x25fc57=zippath+(_0x3d8baa+_0x349d47(0x107));_0x2f5804['replyWithDocument']({'source':_0x25fc57})['then'](()=>{})[_0x349d47(0x1ca)](_0x2f6bb4=>logger[_0x349d47(0xda)](_0x349d47(0x143)+_0x3d8baa+_0x349d47(0x1fc),_0x2f6bb4));}),tgBot[_0x1e4ebc(0x1e5)]('backup',async _0xe0ca5a=>{const _0x774b79=_0x1e4ebc,_0x2aa0b7=_0x774b79(0x1de);await backupConfigFiles(),await zipFiles(_0x2aa0b7);const _0x5988e7=zippath+(_0x2aa0b7+'.zip');_0xe0ca5a[_0x774b79(0x279)]({'source':_0x5988e7})[_0x774b79(0x231)](()=>{})['catch'](_0x4fc5ac=>logger[_0x774b79(0xda)](_0x774b79(0x143)+_0x2aa0b7+_0x774b79(0x1fc),_0x4fc5ac));}),tgBot[_0x1e4ebc(0x1e5)]('update',async _0x461b2f=>{const _0x52e497=_0x1e4ebc;await getMessages();if(!updateAvailable)await sendTelegram(_0x461b2f[_0x52e497(0x122)]['id'],_0x52e497(0x26d));else{if(!validInstallation)await sendTelegram(_0x461b2f[_0x52e497(0x122)]['id'],_0x52e497(0xaf));else{const _0x51ce9a=Markup[_0x52e497(0x188)]([Markup[_0x52e497(0x163)][_0x52e497(0x1d3)]('Yes',_0x52e497(0x236)),Markup[_0x52e497(0x163)][_0x52e497(0x1d3)]('No',_0x52e497(0xbc))]);_0x461b2f[_0x52e497(0x1bc)](_0x52e497(0x21f),_0x51ce9a);}}}),tgBot[_0x1e4ebc(0x201)](/update_(.+)/,async _0x3aa4a6=>{const _0x20521e=_0x1e4ebc,_0x2496f6=_0x3aa4a6[_0x20521e(0xc8)][0x1];_0x3aa4a6['editMessageReplyMarkup'](),_0x2496f6==_0x20521e(0xc0)&&(await sendTelegram(_0x3aa4a6[_0x20521e(0x122)]['id'],_0x20521e(0xf5)),updateBB(_0x20521e(0x19b))),_0x2496f6=='no'&&await sendTelegram(_0x3aa4a6['chat']['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x1e4ebc(0x1e5)](_0x1e4ebc(0xe2),async _0x2f117b=>{const _0x4eb27a=_0x1e4ebc;if(!validInstallation)await sendTelegram(_0x2f117b['chat']['id'],_0x4eb27a(0x1ec));else{const _0x7c92d7=Markup[_0x4eb27a(0x188)]([Markup[_0x4eb27a(0x163)][_0x4eb27a(0x1d3)](_0x4eb27a(0x12c),_0x4eb27a(0x132)),Markup['button']['callback']('No',_0x4eb27a(0x75))]);_0x2f117b[_0x4eb27a(0x1bc)](_0x4eb27a(0xa1),_0x7c92d7);}}),tgBot[_0x1e4ebc(0x201)](/reinstall_(.+)/,async _0x36f5a6=>{const _0x1e8cb6=_0x1e4ebc,_0x2b89cd=_0x36f5a6[_0x1e8cb6(0xc8)][0x1];_0x36f5a6[_0x1e8cb6(0x123)](),_0x2b89cd=='yes'&&(await sendTelegram(_0x36f5a6[_0x1e8cb6(0x122)]['id'],_0x1e8cb6(0xef)),updateBB(_0x1e8cb6(0xe2))),_0x2b89cd=='no'&&await sendTelegram(_0x36f5a6[_0x1e8cb6(0x122)]['id'],_0x1e8cb6(0xf9));}),tgBot[_0x1e4ebc(0x1e5)](_0x1e4ebc(0x76),async _0x76c0ea=>{const _0x1c0a6d=_0x1e4ebc,_0xbdd6ab=getBotsWithMode();if(_0xbdd6ab['length']==0x0)await sendTelegram(_0x76c0ea[_0x1c0a6d(0x122)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x91529d=[],_0x5178ef=[];const _0x58f66b=0x2;let _0x53b098=0x0;_0xbdd6ab[_0x1c0a6d(0xf6)]((_0x28bc2b,_0x248a64)=>{const _0x244ad0=_0x1c0a6d;if(_0x248a64%_0x58f66b==0x0)_0x5178ef=[];_0x5178ef[_0x244ad0(0x150)](Markup[_0x244ad0(0x163)]['callback'](botRef(_0x28bc2b[_0x244ad0(0x1e2)])+'\x20('+_0x28bc2b[_0x244ad0(0x1dd)]+')',_0x244ad0(0x117)+_0x28bc2b['botID'])),_0x248a64%_0x58f66b==0x0&&(_0x91529d[_0x53b098]=_0x5178ef,_0x53b098++);});const _0xfba901=Markup['inlineKeyboard'](_0x91529d);_0x76c0ea[_0x1c0a6d(0x1bc)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0xfba901);}}),tgBot['action'](/toggle_(.+)/,async _0x3f5af5=>{const _0x57d805=_0x1e4ebc,_0x45766d=_0x3f5af5['match'][0x1];_0x3f5af5['editMessageReplyMarkup']();const _0x50ee4f=getBotsWithMode(),_0x1c15fc=_0x50ee4f[_0x57d805(0x181)](_0x7749b9=>_0x7749b9['botID']==_0x45766d),_0x5131b0=_0x1c15fc[_0x57d805(0x1dd)]=='auto'?_0x57d805(0x215):_0x57d805(0x282);await sendTelegram(_0x3f5af5[_0x57d805(0x122)]['id'],_0x57d805(0x172)+botRef(_0x1c15fc[_0x57d805(0x1e2)])+_0x57d805(0x171)+_0x5131b0+_0x57d805(0xff)),toggleBotMode(_0x45766d);}),tgBot[_0x1e4ebc(0x1e5)]('names',async _0x4e6bf2=>{const _0x415d29=_0x1e4ebc;let _0x35d0cf='';config['forEach'](_0x499106=>{const _0x5e9f87=_0x6c29;_0x35d0cf+=_0x5e9f87(0x1bf)+_0x499106[_0x5e9f87(0x1e2)]+':\x20'+_0x499106['botname']+'\x0a';}),await sendTelegram(_0x4e6bf2[_0x415d29(0x122)]['id'],_0x35d0cf,{'parse_mode':'HTML'});}),tgBot[_0x1e4ebc(0x1e5)](_0x1e4ebc(0xbf),async _0x507e61=>{const _0x30b540=_0x1e4ebc;await sendTelegram(_0x507e61[_0x30b540(0x122)]['id'],_0x52ef24);}),process['once'](_0x1e4ebc(0xb3),()=>tgBot[_0x1e4ebc(0x19f)](_0x1e4ebc(0xb3))),process[_0x1e4ebc(0x202)](_0x1e4ebc(0x288),()=>tgBot[_0x1e4ebc(0x19f)](_0x1e4ebc(0x288))),tgBot[_0x1e4ebc(0x104)]();}function disableTelegram(){const _0x26bdf0=_0x27f654;tgBot&&tgBot[_0x26bdf0(0x19f)]();}async function sendTelegram(_0x17fd60,_0xd1a41,_0x1a6973){const _0x5c8848=_0x27f654;_0x1a6973={..._0x1a6973,'disable_web_page_preview':!![]};try{await tgBot[_0x5c8848(0x7c)]['sendMessage'](_0x17fd60,_0xd1a41,_0x1a6973);}catch(_0xbc832c){logger[_0x5c8848(0xda)](_0x5c8848(0x16f),_0xbc832c);}}async function sendTelegramBot(_0x328f42,_0x3fc1f8){const _0x2cfa65=_0x27f654;if(settings[_0x2cfa65(0x10b)]){if(settings[_0x2cfa65(0x92)]==_0x2cfa65(0x291)||(_0x3fc1f8[_0x2cfa65(0x74)]=='error'||_0x3fc1f8['type']==_0x2cfa65(0x144)||_0x3fc1f8[_0x2cfa65(0x74)]=='success')&&settings['telegramEvents']==_0x2cfa65(0x220)||_0x3fc1f8['type']==_0x2cfa65(0x1ba)&&settings[_0x2cfa65(0x92)]==_0x2cfa65(0xf1)){if(tgBot&&settings[_0x2cfa65(0x175)]){if(_0x3fc1f8[_0x2cfa65(0x116)])await sendTelegram(settings['telegramChatId'],_0x3fc1f8[_0x2cfa65(0x88)]+_0x2cfa65(0xc1)+_0x3fc1f8[_0x2cfa65(0xfb)]);else await sendTelegram(settings[_0x2cfa65(0x175)],_0x2cfa65(0x1bf)+_0x328f42+'\x20>\x20'+_0x3fc1f8[_0x2cfa65(0xfb)]);}}}}async function sendTelegramMsg(_0x1fecb1,_0x658fe9='HTML'){const _0x41469b=_0x27f654;return tgBot&&settings[_0x41469b(0x175)]?(await sendTelegram(settings[_0x41469b(0x175)],_0x1fecb1,{'parse_mode':_0x658fe9}),!![]):![];}function getDeviceWithIp(_0x20c99a){return devices['find'](_0x3d9c3a=>_0x3d9c3a['ip']===_0x20c99a);}async function temporaryAccess2FA(_0x5dcf77,_0x2c4bb5){const _0x55252c=_0x27f654;let _0x5e488b=new Date(),_0x4fb24=![];if(lastIpApproval){if(_0x5e488b-lastIpApproval<0x1388)_0x4fb24=!![];}lastIpApproval=new Date();if(_0x4fb24)return;if(tgBot&&settings[_0x55252c(0x175)]){const _0x287082=uuidRandom();tmpStorage[_0x287082]={'uuid':_0x5dcf77,'externalip':_0x2c4bb5};const _0xa66596=Markup[_0x55252c(0x188)]([Markup[_0x55252c(0x163)][_0x55252c(0x1d3)](_0x55252c(0x10f),_0x55252c(0x244)+_0x287082),Markup[_0x55252c(0x163)][_0x55252c(0x1d3)]('15\x20min',_0x55252c(0x22f)+_0x287082),Markup['button'][_0x55252c(0x1d3)](_0x55252c(0x148),_0x55252c(0x100)+_0x287082),Markup[_0x55252c(0x163)][_0x55252c(0x1d3)](_0x55252c(0x13b),_0x55252c(0x184)+_0x287082)]);await sendTelegram(settings['telegramChatId'],_0x55252c(0x13f)+normalizeIP(_0x2c4bb5)['show']+'\x20?',_0xa66596),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0x234258=>{const _0x28be2=_0x55252c,_0x4b589f=_0x234258[_0x28be2(0xc8)][0x1],_0x2b8823=_0x234258[_0x28be2(0xc8)][0x2],{uuid:_0x58ceec,externalip:_0x535cac}=tmpStorage[_0x2b8823];delete tmpStorage[_0x2b8823],_0x234258[_0x28be2(0x123)](),devices[_0x58ceec][_0x28be2(0x22c)]={'clientip':_0x535cac,'timestamp':new Date()[_0x28be2(0xce)](),'expiry':_0x4b589f},_0x4b589f!=_0x28be2(0x13b)?(await sendTelegram(_0x234258[_0x28be2(0x122)]['id'],'Access\x20enabled\x20for\x20'+_0x4b589f+_0x28be2(0x26c),{'parse_mode':_0x28be2(0x11b)}),io['to'](_0x58ceec)['emit']('status',{'access':{'allow':![],'reason':_0x28be2(0x228),'token':null}})):(await sendTelegram(_0x234258[_0x28be2(0x122)]['id'],_0x28be2(0x11f)),io['to'](_0x58ceec)['emit'](_0x28be2(0x141),{'access':{'allow':![],'reason':_0x28be2(0x20c),'token':null}}));});}}async function loginAccess2FA(_0x10f7ea,_0x2ef30a){const _0x43f0cb=_0x27f654;if(tgBot&&settings[_0x43f0cb(0x175)]){const _0x25e833=uuidRandom();tmpStorage[_0x25e833]={'uuid':_0x10f7ea,'externalip':_0x2ef30a};const _0x3e2e76=Markup[_0x43f0cb(0x188)]([Markup[_0x43f0cb(0x163)][_0x43f0cb(0x1d3)](_0x43f0cb(0xe1),'login2fa_'+loginExpiry+'_'+_0x25e833),Markup[_0x43f0cb(0x163)][_0x43f0cb(0x1d3)](_0x43f0cb(0x13b),_0x43f0cb(0x17f)+_0x25e833)]);await sendTelegram(settings[_0x43f0cb(0x175)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x2ef30a)[_0x43f0cb(0xbe)]+'\x20?',_0x3e2e76),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x47571a=>{const _0x5d93ec=_0x43f0cb,_0x12dae2=_0x47571a['match'][0x1],_0x4d9b77=_0x47571a[_0x5d93ec(0xc8)][0x2],{uuid:_0x51035e,externalip:_0x18ea36}=tmpStorage[_0x4d9b77];delete tmpStorage[_0x4d9b77],_0x47571a[_0x5d93ec(0x123)](),devices[_0x51035e][_0x5d93ec(0xe6)]={'clientip':_0x18ea36,'timestamp':new Date()[_0x5d93ec(0xce)](),'expiry':_0x12dae2},_0x12dae2!=_0x5d93ec(0x13b)?(await sendTelegram(_0x47571a['chat']['id'],_0x5d93ec(0xfd),{'parse_mode':_0x5d93ec(0x11b)}),io['to'](_0x51035e)[_0x5d93ec(0xa0)](_0x5d93ec(0x141),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x47571a[_0x5d93ec(0x122)]['id'],_0x5d93ec(0x1b9)),io['to'](_0x51035e)['emit'](_0x5d93ec(0x141),{'access':{'allow':![],'reason':_0x5d93ec(0x193),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2c8da9=_0x27f654;return dbConfig[_0x2c8da9(0x190)](_0x2c8da9(0x1c1))[_0x2c8da9(0x16e)](_0x2c8da9(0x1e2))[_0x2c8da9(0x9d)]({'status':_0x2c8da9(0x247)})['value']()||[];}function getDisabledBots(){const _0x559bef=_0x27f654;return dbConfig[_0x559bef(0x190)](_0x559bef(0x1c1))[_0x559bef(0x16e)](_0x559bef(0x1e2))[_0x559bef(0x9d)]({'status':_0x559bef(0x267)})[_0x559bef(0x179)]()||[];}function getBotAttributes(_0x513ee3){const _0xe810e9=_0x27f654;let _0x5202cf={};const _0x595cd2=configpath+_0xe810e9(0x8d)+_0x513ee3+'-config.json',_0x4e87dd=fs[_0xe810e9(0xf0)](_0x595cd2);if(_0x4e87dd){const _0x32cd72=fs[_0xe810e9(0x13e)](_0x595cd2);try{const _0x22bf36=JSON['parse'](_0x32cd72),_0x14ba17=_0x22bf36?_0x22bf36['bot'][0x0][_0xe810e9(0x248)]:![];_0x5202cf[_0xe810e9(0x1dd)]=_0x14ba17?'auto':_0xe810e9(0x215),_0x5202cf[_0xe810e9(0x88)]=_0x22bf36?_0x22bf36[_0xe810e9(0x77)][0x0]['botname']:'Bot\x20'+_0x513ee3,_0x5202cf[_0xe810e9(0x116)]=_0x22bf36?_0x22bf36['bot'][0x0][_0xe810e9(0x116)]:![];}catch(_0x580fef){_0x5202cf[_0xe810e9(0x1dd)]=_0xe810e9(0x215),_0x5202cf[_0xe810e9(0x88)]=_0xe810e9(0x1bf)+_0x513ee3,_0x5202cf['showname']=![];}}else _0x5202cf['mode']=_0xe810e9(0x215),_0x5202cf[_0xe810e9(0x88)]=_0xe810e9(0x1bf)+_0x513ee3,_0x5202cf['showname']=![];return _0x5202cf;}function getBotsWithMode(){const _0x20ccd6=_0x27f654,_0x29b1cc=dbConfig[_0x20ccd6(0x190)](_0x20ccd6(0x1c1))[_0x20ccd6(0x16e)](_0x20ccd6(0x1e2))[_0x20ccd6(0x179)]()||[];return _0x29b1cc[_0x20ccd6(0xf6)](_0x109dc8=>{const _0x3b38ea=_0x20ccd6;let _0xa39bf=getBotAttributes(_0x109dc8['botID']);_0x109dc8[_0x3b38ea(0x1dd)]=_0xa39bf[_0x3b38ea(0x1dd)];}),_0x29b1cc;}function getBotExchanges(){const _0xa97c76=_0x27f654;let _0x44e6ab=[];const _0x105e0a=dbConfig['get']('bots')['sortBy'](_0xa97c76(0x1e2))[_0xa97c76(0x179)]()||[];_0x105e0a['forEach'](_0x4bb39a=>{const _0x2f25c3=_0xa97c76;if(_0x4bb39a[_0x2f25c3(0x141)]==_0x2f25c3(0x247)){const _0x319d0b=configpath+'bot-'+_0x4bb39a[_0x2f25c3(0x1e2)]+_0x2f25c3(0x16c),_0x4260e8=fs[_0x2f25c3(0xf0)](_0x319d0b);let _0x2566f3;if(_0x4260e8){const _0x9ba7e6=fs['readFileSync'](_0x319d0b);try{const _0x22155d=JSON[_0x2f25c3(0x274)](_0x9ba7e6);_0x2566f3=_0x22155d?_0x22155d[_0x2f25c3(0x77)][0x0][_0x2f25c3(0x1bd)]:null;}catch(_0x43a8f1){}}if(_0x2566f3)_0x44e6ab[_0x2f25c3(0x150)](_0x2566f3);}});const _0x121ede=[...new Set(_0x44e6ab)][_0xa97c76(0x23e)]();return _0x121ede;}function _0x782c(){const _0x9ea170=['/download/:type','store-settings','host','sign','family','NTBA_FIX_319','Login\x20rejected','order','util','reply','exchange','unlinkSync','Bot\x20','/:bot/support','bots','#RES#\x20if\x20running\x20locally\x0a','address','text','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','Unauthorized\x20attempt\x20to\x20download\x20','get-portfolio','Notifications\x20enabled','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','catch','mkdirSync','verify','6b67f3d61ee94b8f5c80b4affef4c4d9','enable','************','2571300OaEsDV','/logs\x20-\x20receive\x20log\x20files\x0a','/start','callback','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','ipv6','settings.','secret','Logged\x20out\x20user\x20...','startsWith','Session\x20expired\x20for\x20user\x20...','Bot\x20Mgr\x20>\x20','static','mode','backup','Invalid\x20username\x20or\x20IP\x20address','temporary\x20access\x20not\x20allowed','isValid','botID','Server','pki','command','node','0.0.0','Unauthorized\x20attempt\x20to\x20get\x20portfolio','backup-full@','binary','store-configuration','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','rmSync','handshake','privateKey','generateAsync','defaults','new-disabled','version','Error\x20while\x20deleting\x20config\x20files:\x20','bot.js','show-config','backup/','uncaughtException','output-001.log','string','store','\x20files\x20over\x20Telegram:','/enable\x20-\x20enable\x20notifications\x0a','generateKeyPair','lowdb/adapters/FileSync','bbPassword','action','once','get-messages','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Backup\x20file\x20unzipped\x20and\x20stored','started','track','Starting\x20(','clients','deleteHistoryAlerts','replace','temporary\x20access\x20rejected','exp','live','connected','access','userid','::1','get-logs','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','manual','/help\x20-\x20show\x20available\x20commands\x0a','Idling\x20(','slice','onepagemode','max','All\x20bots\x20running\x20right\x20now','confirm-message',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','connection','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','alerts','success','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Restarting\x20','uuid-random','loginRequired','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','place-order','reload','function','No\x20authentication\x20token','logout','telegramIpApproval','Ok,\x20will\x20send\x20order\x20notifications\x20only','createServer','tempaccess_15_','ETH','then','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','tkn','No\x20bots\x20running\x20right\x20now','privateKeyToPem','update_yes','temporaryAccessAllowed','getFullYear','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','encryptedUuid','Restore\x20process\x20confirmed','settings','running','sort','\x1b[0m','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','reset-password','\x20|\x20user:\x20...','Unauthorized\x20attempt\x20to\x20get\x20events','tempaccess_5_','off_','bb-settings.json','enabled','headless','token','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','<b>Balance\x20Bot\x20Status:</b>\x0a','map','split','decrypt','output-003.log','temporary\x20access\x20timeout','6NCKyWD','/metrics\x20-\x20show\x20bot\x20performance\x0a','staging',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','*$1*','fork','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','build','emitHistory','timestamp','\x20(2)','login\x20required','http','getDate','-events.json','6602517ewLlnT','***','socket','restore-backup-file','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','latestversion','-performance.json','disabled','259QgTCRn','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','size','All\x20bots','\x20minutes','Your\x20installation\x20is\x20already\x20up\x20to\x20date','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Network\x20Interfaces:','socket.io','simple','restore_yes_','211749IPHRSp','parse','kill','auth','2FA\x20required','cloneDeep','replyWithDocument','privateKeyFromPem','restart','join','sha256','Notifications\x20disabled\x0a','temporary\x20token\x20generated','timeshift','argv','auto','decode64','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','lastmsgemitted','User\x20has\x20been\x20validated','/:bot/coins','SIGTERM','add',')\x20|\x20Bot\x20','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','store-fiat','[ip-address]','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','constructor','config','all','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','async','Error\x20details:','type','reinstall_no','toggle','bot','BCT','update-bot','toIPv4Address','files','telegram','/off\x20-\x20stop\x20bot(s)\x0a','backup-files','build2','Token\x20blacklisted','login\x20not\x20required','showConfig','telegrammsg','Notifications\x20enabled\x0a','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','post','index.html','botname','Failed\x20to\x20download\x20','2FA','isDirectory','-----------------------------------------------------------------------------------','bot-','exit','RSA-OAEP','reason','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','telegramEvents','sendMetricsTelegram','password','::ffff:7f00:1','remoteAddress','axios','\x20|\x20client:\x20...','number','output-000.log','botmanager','/status\x20-\x20show\x20bot(s)\x20status\x0a','filter',')\x20\x20\x20|\x20Bot\x20','send','emit','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','message','Error:\x20Invalid\x20argument\x20','sockets','min','Invalid\x20authentication\x20token\x20(1)','ipaddr.js','conn','mixpanel','path','update-bb','|@|','telegramToken','request','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','listen','port','Unauthorized\x20attempt\x20to\x20store\x20configuration','SIGINT','log','bbvReceive','f2aRequired','127.0.0.1','DEFLATE','create','You\x20can\x20use\x20the\x20following\x20commands:\x0a','exec','update_no','cancelLoading','show','help','yes','\x20>\x20','title','file','copyFileSync','test','username','Logged\x20in\x20user\x20...','match','(staging)','assign','includes','toString','Unauthorized\x20attempt\x20to\x20add\x20bot','getTime','Unauthorized\x20login\x20attempt\x20(timeout)','apiPassword','environment','status\x20code\x20401','whitelistEnabled','removeAllListeners','env','output-002.log','hashSync','Alerts','Invalid\x20IP\x20address','debug','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','3000','reinstall-bb','File\x20uploaded','rsa','373696WTDUoD','accept','reinstall','allow','backup-full','bbvNew','telegram2FaApproval','pidExpireLogin','#RES#','bb-secure.json','\x20-\x20','login\x20token\x20generated','search','(((.+)+)+)+$','config/','Starting\x20Balance\x20Bot\x20reinstallation','existsSync','orders','readdirSync','storeConfiguration','Backup\x20file\x20uploaded','Starting\x20Balance\x20Bot\x20update','forEach','disable','telegramUsername','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','134968fKKtYd','event','full','Login\x20accepted','address\x20already\x20in\x20use','\x20mode','tempaccess_30_','stopped','Unauthorized\x20attempt\x20to\x20confirm\x20message','Unauthorized\x20attempt\x20to\x20delete\x20bot','launch','graphql-request','Unauthorized\x20attempt\x20to\x20update\x20bot','.zip','Unauthorized\x20attempt\x20to\x20show\x20configuration','Unauthorized\x20attempt\x20to\x20get\x20messages',':\x20Bot\x20Mgr\x20>\x20','telegramEnabled','CoinMarketCap\x20API\x20key\x20validated','Orders','Unauthorized\x20attempt\x20to\x20delete\x20alerts','5\x20min','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','logs/','getSeconds','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Ok,\x20will\x20send\x20alert\x20notifications\x20only','marketcapApi','showname','toggle_','close','placeOrder','login\x20token\x20valid','HTML','getHours','private','api-eu.mixpanel.com','Temporary\x20access\x20rejected','range','restore_no_','chat','editMessageReplyMarkup','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','config_all','notification','add-bot','Bot\x20Mgr\x20>\x20Stopping\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','config_orders','endsWith','Yes','disconnect','name','\x1b[33m','bb/','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','reinstall_yes','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','/:bot/portfolio','createWriteStream','Notifications\x20types:\x20','secure','yargs','sendPortfolioTelegram','reject','config_alerts','getMinutes','readFileSync','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','child_process','status','1135572cVkQPM','Error\x20sending\x20','warning','resetpw_no','from','blacklist','30\x20min','1000','\x20|\x20','lastmsgtelegram','sendFile','write','/restart\x20-\x20restart\x20bot(s)\x0a','code','push','apiKey','cancel-loading','/on\x20-\x20start\x20bot(s)\x0a','backupfile','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','randomFillSync','publicKey','1272742gzDTJW','any','off','production','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','-results.json','bbUsername','2FA\x20login\x20token\x20generated','resetHistory','reset-history','restart_','button','logged\x20out','Disabled\x20','updatebotmanager','bb-config.json','open','format','Unauthorized\x20attempt\x20to\x20log\x20out','uuid','-config.json','expiry','sortBy','Telegram\x20error:','#RES#\x20if\x20running\x20on\x20server','\x20to\x20','Bot\x20Mgr\x20>\x20Toggling\x20','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','params','telegramChatId','#RES#\x20','login','set','value','logs','date-fns','writeFileSync','https://api.ipify.org?format=json','length','login2fa_reject_','getMonth','find','zip/','invalid\x20credentials','tempaccess_reject_','storeHeadless','statSync','start','inlineKeyboard','store-headless','stringify','\x1b[34m','Password\x20reset\x20rejected','Error\x20removing\x20old\x20backup\x20files:','\x20only\x0a','internal','get','hasOwnProperty','get-backup-files','2FA\x20login\x20rejected','pidRefreshToken','get-starting-balances','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','temp/','2FA\x20login\x20required','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','messages','update','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','toggleBotMode','Restoring\x20bot(s)\x20from\x20backup','stop','/:bot/configuration','remove','Restore\x20process\x20aborted','inherit','entries','alias','Starting\x20new\x20bot\x20|\x20Bot\x20','clientip','jszip','=>\x20Go\x20to\x20#CYA#http://','Password\x20has\x20been\x20reset\x20to:\x20','use','new','apiSecret','headers','keys','randomBytes','padStart','isIPv4MappedAddress'];_0x782c=function(){return _0x9ea170;};return _0x782c();}async function initUser(){const _0x3cfd42=_0x27f654;if(!settings[_0x3cfd42(0x211)]){const _0x3fe948=uuidRandom();mixpanel[_0x3cfd42(0x1a5)](_0x3fe948),updateSetting(_0x3cfd42(0x211),_0x3fe948);}}async function initSecure(){const _0x25ddf3=_0x27f654;let _0x40c54c=getSecure();if(!_0x40c54c[_0x25ddf3(0x191)]('secret')){let _0x2d5753=await generateKeys();_0x40c54c[_0x25ddf3(0x157)]=_0x2d5753[_0x25ddf3(0x157)],_0x40c54c[_0x25ddf3(0x1ef)]=_0x2d5753[_0x25ddf3(0x1ef)],_0x40c54c[_0x25ddf3(0x1d7)]=crypto[_0x25ddf3(0x1b0)](0x20)[_0x25ddf3(0xcc)]('hex');;storeSecure(_0x40c54c);}}function getSettings(){const _0x17264e=_0x27f654;return dbSettings[_0x17264e(0x190)]('settings')['value']()||{};}function getSecure(){const _0x3c4545=_0x27f654;return dbSecure[_0x3c4545(0x190)](_0x3c4545(0x138))[_0x3c4545(0x179)]()||{};}function getBlacklist(){const _0x52e687=_0x27f654;return dbSecure['get'](_0x52e687(0x147))[_0x52e687(0x179)]()||[];}function broadcastToBots(_0x22d4da,_0xb2af54){config['forEach'](_0x2a605e=>{const _0x2d476e=_0x6c29;if(_0x2a605e['status']==_0x2d476e(0x247)&&_0x2a605e[_0x2d476e(0x20e)]==_0x2d476e(0x23d)||_0x2a605e[_0x2d476e(0x141)]==_0x2d476e(0x1ac)&&_0x2a605e[_0x2d476e(0x20e)]==_0x2d476e(0x23d)){if(pid[_0x2a605e[_0x2d476e(0x1e2)]])pid[_0x2a605e[_0x2d476e(0x1e2)]]['send']({[_0x22d4da]:_0xb2af54});}});}async function storeSettings(_0x5915b8,_0x56051c=![]){const _0x1f4cbd=_0x27f654;_0x5915b8={...settings,..._0x5915b8};if(_0x56051c&&_0x5915b8['bbPassword']!=_0x1f4cbd(0x1cf)&&_0x5915b8[_0x1f4cbd(0x200)]!='***'&&_0x5915b8[_0x1f4cbd(0x200)]!=''){const _0x570e09=decryptRSA(secure[_0x1f4cbd(0x1ef)],_0x5915b8[_0x1f4cbd(0x200)])[_0x1f4cbd(0x24d)](_0x1f4cbd(0xac))[0x0],_0x5918e6=bcrypt[_0x1f4cbd(0xd7)](_0x570e09,saltRounds);_0x5915b8={..._0x5915b8,'bbPassword':_0x5918e6};}if(_0x56051c&&_0x5915b8['telegramToken']!='************'&&_0x5915b8[_0x1f4cbd(0xad)]!='***'&&_0x5915b8[_0x1f4cbd(0xad)]!=''){const _0x4f3d1c=decryptRSA(secure['privateKey'],_0x5915b8[_0x1f4cbd(0xad)])['split'](_0x1f4cbd(0xac))[0x0];_0x5915b8={..._0x5915b8,'telegramToken':_0x4f3d1c};}if(_0x56051c&&_0x5915b8[_0x1f4cbd(0x115)]!=_0x1f4cbd(0x1cf)&&_0x5915b8[_0x1f4cbd(0x115)]!=_0x1f4cbd(0x261)&&_0x5915b8[_0x1f4cbd(0x115)]!=''){const _0x2799a2=decryptRSA(secure[_0x1f4cbd(0x1ef)],_0x5915b8[_0x1f4cbd(0x115)])[_0x1f4cbd(0x24d)](_0x1f4cbd(0xac))[0x0];_0x5915b8={..._0x5915b8,'marketcapApi':_0x2799a2};}const _0x4ff878=_0x5915b8[_0x1f4cbd(0xad)]!=_0x1f4cbd(0x1cf)&&_0x5915b8['telegramToken']!=settings[_0x1f4cbd(0xad)]||_0x5915b8[_0x1f4cbd(0xf8)]!=settings[_0x1f4cbd(0xf8)],_0x41fbf0=_0x5915b8['telegramToken']==''||_0x5915b8[_0x1f4cbd(0xf8)]=='',_0x5a5e6f=_0x5915b8['marketcapApi']&&_0x5915b8[_0x1f4cbd(0x115)]!=_0x1f4cbd(0x1cf)&&_0x5915b8['marketcapApi']!=settings[_0x1f4cbd(0x115)];_0x4ff878&&(_0x5915b8[_0x1f4cbd(0x175)]=null,_0x5915b8[_0x1f4cbd(0x92)]=_0x1f4cbd(0x291));for(const [_0x4bc68e,_0x4cb4dc]of Object[_0x1f4cbd(0x1a4)](_0x5915b8)){if(_0x4bc68e=='telegramToken'&&_0x4cb4dc=='************'){_0x5915b8[_0x1f4cbd(0xad)]=settings[_0x1f4cbd(0xad)];continue;};if(_0x4bc68e=='bbPassword'&&_0x4cb4dc=='************'){_0x5915b8[_0x1f4cbd(0x200)]=settings[_0x1f4cbd(0x200)];continue;};if(_0x4bc68e=='marketcapApi'&&_0x4cb4dc==_0x1f4cbd(0x1cf)){_0x5915b8['marketcapApi']=settings['marketcapApi'];continue;};dbSettings['set'](_0x1f4cbd(0x1d6)+_0x4bc68e,_0x4cb4dc)[_0x1f4cbd(0x14d)]();}settings=_0x5915b8,io['to'](_0x1f4cbd(0x9b))[_0x1f4cbd(0xa0)](_0x1f4cbd(0x23c),cleanSettings()),broadcastToBots(_0x1f4cbd(0x280),settings['timeshift']),broadcastToBots(_0x1f4cbd(0x219),settings[_0x1f4cbd(0x219)]),broadcastToBots(_0x1f4cbd(0x115),settings[_0x1f4cbd(0x115)]);if(_0x4ff878&&!_0x41fbf0)initTelegram();_0x4ff878&&_0x41fbf0&&(updateSetting(_0x1f4cbd(0x175),null),disableTelegram()),getAllClients()[_0x1f4cbd(0xf6)](_0x5ec232=>{const _0xc4df1e=_0x1f4cbd;getSocket(_0x5ec232['id'])[_0xc4df1e(0xa0)](_0xc4df1e(0x141),{'access':{'allow':![],'reason':_0xc4df1e(0x228),'token':null}});}),_0x5a5e6f&&(await sleep(0xbb8),testMarketcapApi(_0x5915b8[_0x1f4cbd(0x115)]));}async function testMarketcapApi(_0x5af1c0){const _0x1a0cff=_0x27f654,_0x527f7b=[_0x1a0cff(0x78),_0x1a0cff(0x230)];try{await axios['get'](_0x1a0cff(0x239),{'headers':{'X-CMC_PRO_API_KEY':_0x5af1c0},'params':{'symbol':_0x527f7b['toString']()}});}catch(_0x521dfe){_0x521dfe[_0x1a0cff(0xcc)]()[_0x1a0cff(0xcb)](_0x1a0cff(0xd2))?(io['to'](_0x1a0cff(0x9b))[_0x1a0cff(0xa0)](_0x1a0cff(0x126),_0x1a0cff(0x19c)),logger['full'](_0x1a0cff(0x19c))):(io['to'](_0x1a0cff(0x9b))['emit'](_0x1a0cff(0x126),_0x1a0cff(0x284)),logger[_0x1a0cff(0xfc)](_0x1a0cff(0x284)),logger[_0x1a0cff(0xda)](_0x1a0cff(0x73),_0x521dfe[_0x1a0cff(0xcc)]()+_0x1a0cff(0xea)+_0x521dfe[_0x1a0cff(0x14f)]));return;}logger['debug'](_0x1a0cff(0x10c));}function updateSetting(_0xd5436d,_0x59dc66){const _0x1fc54d=_0x27f654;dbSettings[_0x1fc54d(0x178)](_0x1fc54d(0x1d6)+_0xd5436d,_0x59dc66)[_0x1fc54d(0x14d)](),settings=getSettings(),io['to'](_0x1fc54d(0x9b))[_0x1fc54d(0xa0)]('settings',cleanSettings());}function storeSecure(_0x628afc){const _0x75ff3e=_0x27f654;dbSecure[_0x75ff3e(0x190)](_0x75ff3e(0x138))[_0x75ff3e(0x150)](_0x628afc)[_0x75ff3e(0x14d)](),secure=_0x628afc;}function addBlacklist(_0x9def1d){const _0x3c546a=_0x27f654;cleanBlacklist();let _0x3668c0;devices[_0x9def1d][_0x3c546a(0x22c)]?_0x3668c0=Math[_0x3c546a(0x21a)](devices[_0x9def1d]['telegramIpApproval'][_0x3c546a(0x16d)],loginExpiry):_0x3668c0=loginExpiry,dbSecure[_0x3c546a(0x190)](_0x3c546a(0x147))[_0x3c546a(0x150)]({'expiry':new Date()[_0x3c546a(0xce)]()+_0x3668c0*0x3c*0x3e8,'token':devices[_0x9def1d][_0x3c546a(0x210)][_0x3c546a(0x249)]})[_0x3c546a(0x14d)](),blacklist=dbSecure['get'](_0x3c546a(0x147))[_0x3c546a(0x179)]();}function cleanBlacklist(){const _0x35cd6c=_0x27f654;let _0xbef817=dbSecure[_0x35cd6c(0x190)](_0x35cd6c(0x147))[_0x35cd6c(0x278)]()[_0x35cd6c(0x179)](),_0x4a6138=new Date()[_0x35cd6c(0xce)]();_0xbef817[_0x35cd6c(0xf6)](_0x23febd=>{const _0x58473c=_0x35cd6c;_0x23febd[_0x58473c(0x16d)]<_0x4a6138&&dbSecure[_0x58473c(0x190)](_0x58473c(0x147))['remove']({'expiry':_0x23febd['expiry']})[_0x58473c(0x14d)]();});}function initStates(){const _0x327bd5=_0x27f654;let _0x5a6e2c=getConfiguration();_0x5a6e2c[_0x327bd5(0xf6)](_0x1c1e62=>{const _0xaf67be=_0x327bd5;_0x1c1e62['live']=_0xaf67be(0x101);}),storeConfiguration(_0x5a6e2c);}async function generateKeys(){const _0x4f4ce2=_0x27f654,_0x4fe117=forge[_0x4f4ce2(0x1e4)][_0x4f4ce2(0xdf)][_0x4f4ce2(0x1fe)]({'bits':0x1000,'e':0x10001}),_0x3648d5=forge[_0x4f4ce2(0x1e4)][_0x4f4ce2(0x235)](_0x4fe117[_0x4f4ce2(0x1ef)]),_0x5206e1=forge['pki']['publicKeyToPem'](_0x4fe117[_0x4f4ce2(0x157)]);return{'privateKey':_0x3648d5,'publicKey':_0x5206e1};}async function oneTimeMigration(){const _0x2c7648=_0x27f654;let _0x44617a=getSettings(),_0x3e53ed=![];!_0x44617a[_0x2c7648(0x191)](_0x2c7648(0x14b))&&(_0x44617a[_0x2c7648(0x14b)]=0x0,_0x3e53ed=!![]);!_0x44617a[_0x2c7648(0x191)](_0x2c7648(0x285))&&(_0x44617a[_0x2c7648(0x285)]=0x0,_0x3e53ed=!![]);!_0x44617a[_0x2c7648(0x191)](_0x2c7648(0x265))&&(_0x44617a[_0x2c7648(0x265)]=_0x2c7648(0x1e7),_0x3e53ed=!![]);!_0x44617a[_0x2c7648(0x191)](_0x2c7648(0x219))&&(_0x44617a[_0x2c7648(0x219)]=![],_0x3e53ed=!![]);!_0x44617a[_0x2c7648(0x191)](_0x2c7648(0x115))&&(_0x44617a['marketcapApi']='',_0x3e53ed=!![]);if(_0x3e53ed)storeSettings(_0x44617a);try{fs[_0x2c7648(0xf2)](configbackuppath,{'withFileTypes':!![]})[_0x2c7648(0xf6)](_0xdc81f5=>{const _0x3dd9b7=_0x2c7648;if(!_0xdc81f5[_0x3dd9b7(0x8b)]()){if(!_0xdc81f5['name'][_0x3dd9b7(0x1d9)](_0x3dd9b7(0x1e9)))fs['unlinkSync'](configbackuppath+_0xdc81f5['name']);}else fs[_0x3dd9b7(0x1ed)](configbackuppath+_0xdc81f5[_0x3dd9b7(0x12e)],{'recursive':!![]});});}catch(_0x5a11ff){logger[_0x2c7648(0xda)](_0x2c7648(0x18d),_0x5a11ff);}}function storeConfiguration(_0x14f0bc){const _0x36c658=_0x27f654;dbConfig[_0x36c658(0x190)]('bots')[_0x36c658(0x1a1)]()[_0x36c658(0x14d)](),dbConfig['get']('bots')[_0x36c658(0x150)](..._0x14f0bc)[_0x36c658(0x14d)](),config=_0x14f0bc;}async function resetPassword(){const _0x33523f=_0x27f654;if(tgBot&&settings[_0x33523f(0x175)]){const _0x28c795=Markup[_0x33523f(0x188)]([Markup[_0x33523f(0x163)][_0x33523f(0x1d3)]('yes','resetpw_yes'),Markup[_0x33523f(0x163)][_0x33523f(0x1d3)]('no',_0x33523f(0x145))]);await sendTelegram(settings['telegramChatId'],_0x33523f(0x214),_0x28c795),tgBot[_0x33523f(0x201)](/resetpw_(.+)/,async _0x7a7c59=>{const _0x3b2835=_0x33523f,_0x262206=_0x7a7c59[_0x3b2835(0xc8)][0x1];_0x7a7c59[_0x3b2835(0x123)]();if(_0x262206!='no'){const _0x534753=0xf,_0x566252=_0x3b2835(0x129),_0x36951d=Array[_0x3b2835(0x146)](crypto[_0x3b2835(0x156)](new Uint32Array(_0x534753)))[_0x3b2835(0x24c)](_0x475813=>_0x566252[_0x475813%_0x566252[_0x3b2835(0x17e)]])['join'](''),_0x3dc202=bcrypt[_0x3b2835(0xd7)](_0x36951d,saltRounds);storeSettings({'bbPassword':_0x3dc202}),await sendTelegram(_0x7a7c59['chat']['id'],_0x3b2835(0x1aa)+_0x36951d,{'parse_mode':'HTML'});}else await sendTelegram(_0x7a7c59[_0x3b2835(0x122)]['id'],_0x3b2835(0x18c));});}}async function confirmRestore(_0xcc07e7,_0x39f875){const _0x6e9ff6=_0x27f654;io['to']('botmanager')[_0x6e9ff6(0xa0)](_0x6e9ff6(0x126),_0x6e9ff6(0xdb),'success');if(tgBot&&settings['telegramChatId']){const _0x350470=uuidRandom();tmpStorage[_0x350470]={'path':_0xcc07e7,'filename':_0x39f875};const _0x1d629a=Markup[_0x6e9ff6(0x188)]([Markup[_0x6e9ff6(0x163)][_0x6e9ff6(0x1d3)](_0x6e9ff6(0xc0),_0x6e9ff6(0x272)+_0x350470),Markup[_0x6e9ff6(0x163)]['callback']('no',_0x6e9ff6(0x121)+_0x350470)]);await sendTelegram(settings[_0x6e9ff6(0x175)],'Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)',_0x1d629a),tgBot[_0x6e9ff6(0x201)](/restore_(.+)_(.+)/,async _0x59187d=>{const _0x5aea2b=_0x6e9ff6,_0x116cb5=_0x59187d['match'][0x1],_0x49c12a=_0x59187d['match'][0x2],{path:_0x54ceed,filename:_0x531ba5}=tmpStorage[_0x49c12a];delete tmpStorage[_0x49c12a],_0x59187d['editMessageReplyMarkup'](),_0x116cb5==_0x5aea2b(0xc0)?(logger[_0x5aea2b(0xda)](_0x5aea2b(0x23b)),await sendTelegram(_0x59187d[_0x5aea2b(0x122)]['id'],_0x5aea2b(0x19e),{'parse_mode':_0x5aea2b(0x11b)}),unzipFile(_0x54ceed,_0x531ba5)):(logger['debug'](_0x5aea2b(0x1a2)),await sendTelegram(_0x59187d[_0x5aea2b(0x122)]['id'],'Restore\x20process\x20aborted'));});}}function getServerTime(){const _0x3f9229=_0x27f654,_0x309435=new Date();return _0x309435[_0x3f9229(0x238)]()+'/'+(_0x309435[_0x3f9229(0x180)]()+0x1)['toString']()[_0x3f9229(0x1b1)](0x2,'0')+'/'+_0x309435[_0x3f9229(0x25e)]()[_0x3f9229(0xcc)]()[_0x3f9229(0x1b1)](0x2,'0')+'\x20'+_0x309435[_0x3f9229(0x11c)]()['toString']()[_0x3f9229(0x1b1)](0x2,'0')+':'+_0x309435[_0x3f9229(0x13d)]()['toString']()[_0x3f9229(0x1b1)](0x2,'0')+':'+_0x309435[_0x3f9229(0x112)]()[_0x3f9229(0xcc)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x227aae=_0x27f654,_0x5d7508=shiftedTime();return _0x5d7508[_0x227aae(0x238)]()+'/'+(_0x5d7508['getMonth']()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x5d7508['getDate']()[_0x227aae(0xcc)]()[_0x227aae(0x1b1)](0x2,'0')+'\x20'+_0x5d7508[_0x227aae(0x11c)]()['toString']()[_0x227aae(0x1b1)](0x2,'0')+':'+_0x5d7508[_0x227aae(0x13d)]()[_0x227aae(0xcc)]()[_0x227aae(0x1b1)](0x2,'0')+':'+_0x5d7508[_0x227aae(0x112)]()[_0x227aae(0xcc)]()[_0x227aae(0x1b1)](0x2,'0');}function getCleanTimeStamp(){const _0x59d77b=_0x27f654,_0x2cbdf5=shiftedTime();return _0x2cbdf5[_0x59d77b(0x238)]()+(_0x2cbdf5[_0x59d77b(0x180)]()+0x1)[_0x59d77b(0xcc)]()['padStart'](0x2,'0')+_0x2cbdf5[_0x59d77b(0x25e)]()['toString']()['padStart'](0x2,'0')+'-'+_0x2cbdf5['getHours']()[_0x59d77b(0xcc)]()[_0x59d77b(0x1b1)](0x2,'0')+_0x2cbdf5['getMinutes']()[_0x59d77b(0xcc)]()[_0x59d77b(0x1b1)](0x2,'0')+_0x2cbdf5[_0x59d77b(0x112)]()['toString']()[_0x59d77b(0x1b1)](0x2,'0');}function shiftedTime(){const _0xaf2d52=_0x27f654,_0x399499=new Date();let _0x1c314c=_0x399499;if(settings[_0xaf2d52(0x280)]&&settings['timeshift']!==0x0)_0x1c314c=fns[_0xaf2d52(0x289)](_0x399499,{'hours':settings[_0xaf2d52(0x280)]});return _0x1c314c;}async function startScheduler(){const _0x403aa7=_0x27f654,_0x143023=new Date()['getUTCHours'](),_0x23a878=shiftedTime()['getHours']();_0x23a878==0x4&&backupConfigFiles(),_0x23a878==0x0&&(rotateLogFiles(),logger[_0x403aa7(0xda)]('--------------------------------------'),logger['debug']('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x403aa7(0x176)+(environment=='staging'?_0x403aa7(0xc9):'')),logger['debug']('--------------------------------------')),_0x143023%0x6==0x0&&triggerAnalytics(),_0x143023%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x432c5b){const _0x4553ae=_0x27f654;logger[_0x4553ae(0xda)]('Restore\x20backup\x20file\x20'+_0x432c5b);const _0x4019f4=getBotsWithMode();_0x4019f4[_0x4553ae(0x17e)]>0x0?confirmRestore(configbackuppath,_0x432c5b):unzipFile(configbackuppath,_0x432c5b);}async function getBackupFiles(_0x5251dd=null){const _0xc35856=_0x27f654;let _0x243e0e=[],_0x273ac4=fs[_0xc35856(0xf2)](configbackuppath,{'withFileTypes':!![]});_0x273ac4[_0xc35856(0x23e)]((_0xe1db25,_0x458639)=>_0xe1db25[_0xc35856(0x12e)]<_0x458639[_0xc35856(0x12e)]?0x1:_0x458639['name']<_0xe1db25['name']?-0x1:0x0),_0x273ac4['forEach'](_0x133722=>{const _0x5e9490=_0xc35856;if(!_0x133722[_0x5e9490(0x8b)]()&&_0x133722[_0x5e9490(0x12e)][_0x5e9490(0x1d9)]('backup-full@')&&_0x133722[_0x5e9490(0x12e)][_0x5e9490(0x12b)](_0x5e9490(0x107))){const _0x5b40a9=formatDate(fs[_0x5e9490(0x186)](configbackuppath+_0x133722[_0x5e9490(0x12e)])['mtime']);_0x243e0e['push']({'name':_0x133722[_0x5e9490(0x12e)],'mtime':_0x5b40a9});}});if(_0x5251dd)io['to'](_0x5251dd)[_0xc35856(0xa0)](_0xc35856(0x7e),_0x243e0e);else return _0x243e0e;}async function backupConfigFiles(){const _0x59bbc6=_0x27f654;await zipFiles(_0x59bbc6(0xe4));const _0x363ab6=getCleanTimeStamp();fs[_0x59bbc6(0xc4)](zippath+'backup-full.zip',configbackuppath+(_0x59bbc6(0x1e9)+_0x363ab6+_0x59bbc6(0x107)));let _0x1b4b5d=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x1b4b5d[_0x59bbc6(0x23e)]((_0x23568c,_0x2a3a57)=>_0x23568c[_0x59bbc6(0x12e)]<_0x2a3a57[_0x59bbc6(0x12e)]?0x1:_0x2a3a57[_0x59bbc6(0x12e)]<_0x23568c[_0x59bbc6(0x12e)]?-0x1:0x0),_0x1b4b5d[_0x59bbc6(0x17e)]>maxBackups&&fs[_0x59bbc6(0x1be)](configbackuppath+_0x1b4b5d[_0x1b4b5d[_0x59bbc6(0x17e)]-0x1][_0x59bbc6(0x12e)]);}function rotateLogFiles(){const _0xafbdcb=_0x27f654,_0x6d1acf=fs[_0xafbdcb(0x186)](logspath+_0xafbdcb(0x9a)),_0x3dc972=_0x6d1acf[_0xafbdcb(0x26a)]/0x400;if(_0x3dc972>0x64){let _0x450baf=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x450baf[_0xafbdcb(0x23e)]((_0x2e9178,_0x24a0c6)=>_0x2e9178['name']<_0x24a0c6['name']?0x1:_0x24a0c6[_0xafbdcb(0x12e)]<_0x2e9178[_0xafbdcb(0x12e)]?-0x1:0x0),_0x450baf['forEach'](_0x145ed8=>{const _0x1f33e3=_0xafbdcb;if(_0x145ed8[_0x1f33e3(0x12e)]=='output-002.log')fs[_0x1f33e3(0xc4)](logspath+_0x145ed8[_0x1f33e3(0x12e)],logspath+_0x1f33e3(0x24f));if(_0x145ed8['name']=='output-001.log')fs[_0x1f33e3(0xc4)](logspath+_0x145ed8['name'],logspath+_0x1f33e3(0xd6));_0x145ed8['name']==_0x1f33e3(0x9a)&&(fs[_0x1f33e3(0xc4)](logspath+_0x145ed8['name'],logspath+_0x1f33e3(0x1f9)),fs['writeFileSync'](logspath+_0x145ed8[_0x1f33e3(0x12e)],''));});}}async function zipFiles(_0x2418ed){const _0x1fb1ae=_0x27f654;let _0x9a1370;if(_0x2418ed==_0x1fb1ae(0x17a))_0x9a1370=logspath;if(_0x2418ed==_0x1fb1ae(0x1de))_0x9a1370=configpath;if(_0x2418ed=='backup-full')_0x9a1370=configpath;let _0x4f3015=fs['readdirSync'](_0x9a1370,{'withFileTypes':!![]});const _0x2fe18e=new JSZip();_0x4f3015[_0x1fb1ae(0xf6)](_0x2b9fcb=>{const _0x1fb17c=_0x1fb1ae;if(!_0x2b9fcb['isDirectory']()){let _0x322e0e=fs['readFileSync'](_0x9a1370+_0x2b9fcb[_0x1fb17c(0x12e)]);if(_0x2418ed==_0x1fb17c(0x1de)){const _0x3c3738=/^bot-[0-9]{3}-config.json$/,_0x56164d=_0x3c3738[_0x1fb17c(0xc5)](_0x2b9fcb[_0x1fb17c(0x12e)]);if(_0x56164d){const _0x42b455=JSON['parse'](_0x322e0e);if(_0x42b455['bot'][0x0]){_0x42b455['bot'][0x0]['apiKey']=_0x1fb17c(0x261),_0x42b455[_0x1fb17c(0x77)][0x0][_0x1fb17c(0x1ad)]=_0x1fb17c(0x261);if(_0x42b455[_0x1fb17c(0x77)][0x0][_0x1fb17c(0xd0)])_0x42b455[_0x1fb17c(0x77)][0x0]['apiPassword']=_0x1fb17c(0x261);}_0x322e0e=JSON[_0x1fb17c(0x18a)](_0x42b455,null,0x2);}if(_0x2b9fcb[_0x1fb17c(0x12e)]==_0x1fb17c(0x246)){const _0x58b9bc=JSON[_0x1fb17c(0x274)](_0x322e0e);if(_0x58b9bc[_0x1fb17c(0x23c)][_0x1fb17c(0x225)])_0x58b9bc['settings']['loginRequired']=![];if(_0x58b9bc[_0x1fb17c(0x23c)][_0x1fb17c(0x200)])_0x58b9bc[_0x1fb17c(0x23c)]['bbPassword']='***';if(_0x58b9bc['settings'][_0x1fb17c(0xad)])_0x58b9bc[_0x1fb17c(0x23c)]['telegramToken']=_0x1fb17c(0x261);if(_0x58b9bc[_0x1fb17c(0x23c)][_0x1fb17c(0x175)])_0x58b9bc[_0x1fb17c(0x23c)][_0x1fb17c(0x175)]=null;if(_0x58b9bc[_0x1fb17c(0x23c)]['marketcapApi'])_0x58b9bc[_0x1fb17c(0x23c)]['marketcapApi']=_0x1fb17c(0x261);_0x322e0e=JSON[_0x1fb17c(0x18a)](_0x58b9bc,null,0x2);}if(_0x2b9fcb[_0x1fb17c(0x12e)]!=_0x1fb17c(0xe9))_0x2fe18e[_0x1fb17c(0xc3)](_0x2b9fcb['name'],_0x322e0e);}else _0x2fe18e[_0x1fb17c(0xc3)](_0x2b9fcb['name'],_0x322e0e);}});const _0x28d5ac=await _0x2fe18e[_0x1fb1ae(0x1f0)]({'type':_0x1fb1ae(0x1fa),'base64':![],'compression':_0x1fb1ae(0xb8)});fs['writeFileSync'](zippath+(_0x2418ed+_0x1fb1ae(0x107)),_0x28d5ac,_0x1fb1ae(0x1ea));}async function unzipFile(_0x43fd8b,_0x33f3d9){const _0x1e9b97=_0x27f654;fs[_0x1e9b97(0xf2)](configpath,{'withFileTypes':!![]})[_0x1e9b97(0xf6)](_0x3627ba=>{const _0x4b717d=_0x1e9b97;if(!_0x3627ba[_0x4b717d(0x8b)]())fs[_0x4b717d(0x1ed)](configpath+_0x3627ba['name']);});const _0x457898=fs[_0x1e9b97(0x13e)](_0x43fd8b+_0x33f3d9,_0x1e9b97(0x1ea)),_0x2550bc=await JSZip['loadAsync'](_0x457898,{'base64':![],'checkCRC32':!![]});for(const _0x21d659 of Object[_0x1e9b97(0x1af)](_0x2550bc['files'])){const _0x22ea6d=_0x2550bc[_0x1e9b97(0x7b)][_0x21d659],_0x5035f0=await _0x22ea6d[_0x1e9b97(0x293)](_0x1e9b97(0x1fa));fs['writeFileSync'](configpath+_0x22ea6d['name'],_0x5035f0);}fs[_0x1e9b97(0xf2)](temppath,{'withFileTypes':!![]})['forEach'](_0x546071=>{const _0x2a0901=_0x1e9b97;if(!_0x546071[_0x2a0901(0x8b)]())fs[_0x2a0901(0x1ed)](temppath+_0x546071[_0x2a0901(0x12e)]);}),logger[_0x1e9b97(0xda)](_0x1e9b97(0x205)),process[_0x1e9b97(0x9f)]({'restore':!![]},_0xa494ec=>{});}async function getPublicIp(){const _0x3cd399=_0x27f654;try{const _0x4713ff=await axios[_0x3cd399(0x190)](_0x3cd399(0x17d));publicip=_0x4713ff['data']['ip'];}catch(_0x27a801){}}async function triggerAnalytics(){const _0x495faa=_0x27f654;if(!publicip)await getPublicIp();const _0x2103a1=getBotsWithMode();let _0x12c32b=0x0;_0x2103a1['forEach'](_0x27bd33=>{const _0x5d9de8=_0x6c29;if(_0x27bd33['status']===_0x5d9de8(0x247))_0x12c32b++;});const _0x245f62=getBotExchanges();mixpanel[_0x495faa(0x207)](_0x495faa(0x1e3),{'distinct_id':settings[_0x495faa(0x211)],'ip':publicip,'version':serverversion,'numbots':_0x2103a1[_0x495faa(0x17e)],'numbotsenabled':_0x12c32b,'exchanges':_0x245f62,'environment':environment});}async function getMessages(){const _0x3b9b08=_0x27f654,_0x29328a='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x2c7903=new GraphQLClient(_0x29328a),_0x3e27a7={'authorization':_0x3b9b08(0x204)},_0x5ecde4=serverversion[_0x3b9b08(0x24d)]('.'),_0x54191f=_0x5ecde4[0x0]+'.'+_0x5ecde4[0x1],_0x237d7e=Math[_0x3b9b08(0xa5)](settings[_0x3b9b08(0x14b)],settings[_0x3b9b08(0x285)]),_0x65c56={'last':parseInt(_0x237d7e),'bbm':_0x54191f},_0x4d3c97=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2dcb5a;try{_0x2dcb5a=await _0x2c7903[_0x3b9b08(0xae)](_0x4d3c97,_0x65c56,_0x3e27a7);}catch(_0x53bc96){}if(_0x2dcb5a&&_0x2dcb5a[_0x3b9b08(0x19a)]){let _0x3f3d02=settings['lastmsgtelegram'],_0x4c8ff7=settings[_0x3b9b08(0x14b)];newMessages=[];for(const _0xe4347d of _0x2dcb5a['messages']){newMessages[_0x3b9b08(0x150)](_0xe4347d);let _0x33aabd=![];_0xe4347d['bbvNew']&&(updateSetting('latestversion',_0xe4347d[_0x3b9b08(0xe5)]),_0x33aabd=isNewerVersion(serverversion,_0xe4347d[_0x3b9b08(0xe5)])||serverversion==_0xe4347d['bbvNew']);if(!_0x33aabd&&_0xe4347d[_0x3b9b08(0x99)]>_0x3f3d02){if(_0xe4347d[_0x3b9b08(0xb5)]===_0x3b9b08(0x159)||serverversion['startsWith'](_0xe4347d[_0x3b9b08(0xb5)])){let _0x2c091d=''+_0xe4347d[_0x3b9b08(0xc2)]+'\x0a\x0a'+_0xe4347d[_0x3b9b08(0xa2)];const _0x167bdc=await sendTelegramMsg(toTelegramMarkdown(_0x2c091d),'Markdown');_0x3f3d02=_0xe4347d[_0x3b9b08(0x99)];}}_0x4c8ff7=_0xe4347d[_0x3b9b08(0x99)];}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x4c8ff7),emitMessages();}}function emitMessages(){const _0x7f53be=_0x27f654,_0x217a07=settings[_0x7f53be(0x285)];let _0x39ae96=[];newMessages[_0x7f53be(0xf6)](_0x51021d=>{const _0x549ea6=_0x7f53be;_0x51021d[_0x549ea6(0x99)]>_0x217a07&&_0x39ae96['push'](_0x51021d);}),_0x39ae96[_0x7f53be(0x17e)]>0x0&&getAllClients()['forEach'](_0x9de111=>{const _0x5e6d87=_0x7f53be;getSocket(_0x9de111['id'])[_0x5e6d87(0xa0)](_0x5e6d87(0xa2),_0x39ae96);});}function confirmMessage(_0xefd25d){updateSetting('lastmsgemitted',Number(_0xefd25d));}function isNewerVersion(_0xe24f3e,_0x36b046){const _0x449b11=_0x27f654,_0x2812cb=_0x36b046[_0x449b11(0x24d)]('.'),_0x1c6c98=_0xe24f3e['split']('.');for(var _0x3efb73=0x0;_0x3efb73<_0x1c6c98[_0x449b11(0x17e)];_0x3efb73++){const _0xdd14ff=~~_0x1c6c98[_0x3efb73],_0x19c240=~~_0x2812cb[_0x3efb73];if(_0xdd14ff>_0x19c240)return!![];if(_0xdd14ff<_0x19c240)return![];}return![];}function toTelegramMarkdown(_0x45121d){const _0xe33f68=_0x27f654,_0x48a540=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x13d16c=/\*{2}(.+?)\*{2}/gim;return _0x45121d=_0x45121d[_0xe33f68(0x20b)](_0x48a540,'$1_$2_$3')['replace'](_0x13d16c,_0xe33f68(0x255)),_0x45121d;}async function validateConfigFile(){const _0x160703=_0x27f654,_0x31a87d=dbConfig[_0x160703(0x190)](_0x160703(0x1c1))[_0x160703(0x16e)](_0x160703(0x1e2))[_0x160703(0x179)]()||[];if(_0x31a87d[_0x160703(0x17e)]==0x0){let _0x47238c=0x0,_0x34bace=[];const _0x4d4657=/^bot-([0-9]{3})-config.json$/,_0x3a089d=fs[_0x160703(0xf2)](configpath);_0x3a089d[_0x160703(0xf6)](_0x8929c2=>{const _0x59f210=_0x160703,_0xfb00e4=_0x4d4657[_0x59f210(0xbb)](_0x8929c2);if(_0xfb00e4){const _0x5824f0=_0xfb00e4[0x1];let _0xf30677=getBotAttributes(_0x5824f0);_0x34bace['push']({'botID':_0x5824f0,'botname':_0xf30677[_0x59f210(0x88)],'status':'disabled','live':_0x59f210(0x101)}),_0x47238c++;}}),_0x47238c!=0x0&&(dbConfig['get'](_0x160703(0x1c1))[_0x160703(0xca)](_0x34bace)[_0x160703(0x14d)](),config=_0x34bace,restoredConfigFile=_0x47238c);}}async function restoreConfigNotify(_0x353d24){const _0x8a1f3c=_0x27f654;let _0x5b67c3;if(restoredConfigFile==0x1)_0x5b67c3=_0x8a1f3c(0x131);else _0x5b67c3=_0x8a1f3c(0x15c);if(_0x353d24)io['to'](_0x8a1f3c(0x9b))[_0x8a1f3c(0xa0)](_0x8a1f3c(0x126),_0x5b67c3);else{logger[_0x8a1f3c(0x271)](_0x8a1f3c(0x8c)),logger[_0x8a1f3c(0x271)](_0x5b67c3),logger[_0x8a1f3c(0x271)](_0x8a1f3c(0x8c)),logger[_0x8a1f3c(0x271)]('');if(tgBot&&settings[_0x8a1f3c(0x175)]&&settings[_0x8a1f3c(0x92)]!=_0x8a1f3c(0xf1))await sendTelegram(settings[_0x8a1f3c(0x175)],'Bot\x20Mgr\x20>\x20'+_0x5b67c3);}}function decryptRSA(_0x1259e7,_0x532fe0){const _0x3a7007=_0x27f654,_0x104c6f=forge[_0x3a7007(0x1e4)][_0x3a7007(0x27a)](_0x1259e7),_0x47f082=_0x104c6f[_0x3a7007(0x24e)](forge[_0x3a7007(0x1bb)][_0x3a7007(0x283)](_0x532fe0),_0x3a7007(0x8f),{'md':forge['md'][_0x3a7007(0x27d)]['create'](),'mgf1':{'md':forge['md'][_0x3a7007(0x27d)][_0x3a7007(0xb9)]()}});return _0x47f082;}function validateCredentials(_0x5463fd,_0x51faf3){const _0x2839e9=_0x27f654;if(_0x5463fd['username']==settings['bbUsername']&&bcrypt['compareSync'](_0x5463fd[_0x2839e9(0x94)],settings[_0x2839e9(0x200)])){if(settings[_0x2839e9(0xb6)])return{'allow':![],'reason':_0x2839e9(0x198),'token':null};else{const _0x2796ba=generateLoginToken(_0x51faf3);return{'allow':!![],'reason':_0x2839e9(0xeb),'token':_0x2796ba};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x33ad65){const _0x338b56=_0x27f654,_0x48483b=generateLoginToken(_0x33ad65);return{'allow':!![],'reason':_0x338b56(0xeb),'token':_0x48483b};}function validateAccess(_0x24f9fa,_0x45a767,_0x28dbc0){const _0x295ef4=_0x27f654,_0x381494=_0x28dbc0?_0x28dbc0:devices[_0x45a767]['ip'];let _0x4b47fc;const _0x5713b2=_0x777ce3=>{const _0x18461f=_0x6c29;if(settings['loginRequired']){if(settings[_0x18461f(0xb6)]){if(telegram2FaApproved(_0x45a767)){const _0x821c2b=generateLoginToken(_0x45a767);return{'allow':!![],'reason':_0x18461f(0x15f),'token':_0x821c2b};}else return{'allow':![],'reason':_0x18461f(0x25c),'token':null};}else return _0x4b47fc=validToken(_0x777ce3,_0x45a767),_0x4b47fc[_0x18461f(0x191)](_0x18461f(0x221))?{'allow':!![],'reason':_0x18461f(0x11a),'token':_0x777ce3}:{'allow':![],'reason':_0x18461f(0x25c),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x295ef4(0xd3)]){let _0x4ea101=[...settings['whitelist'],_0x295ef4(0x212),'::ffff:127.0.0.1',_0x295ef4(0xb7),_0x295ef4(0x95)];if(_0x4ea101[_0x295ef4(0xcb)](_0x381494))return _0x5713b2(_0x24f9fa);else{_0x4b47fc=validToken(_0x24f9fa,_0x45a767);if(_0x4b47fc['hasOwnProperty'](_0x295ef4(0x221)))return _0x5713b2(_0x24f9fa);else{if(telegramIpApproved(_0x45a767)){const _0xc0e0a2=generateToken(_0x45a767);return _0x4b47fc=_0x5713b2(_0x24f9fa),_0x4b47fc[_0x295ef4(0xe3)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0xc0e0a2}:_0x4b47fc;}else return settings[_0x295ef4(0x237)]?{'allow':![],'reason':_0x295ef4(0x277),'token':null}:{'allow':![],'reason':_0x295ef4(0x1e0),'token':null};}}}else return _0x5713b2(_0x24f9fa);}function timelyDecrypt(_0x15f9af,_0x536c3c,_0xda74fc='@'){const _0x2ebb81=_0x27f654;if(_0x15f9af)try{const _0x5c2d12=decryptRSA(secure['privateKey'],_0x15f9af),_0x1d9a5f=_0x5c2d12[_0x2ebb81(0x24d)](_0xda74fc)[0x0],_0x47210f=_0x5c2d12[_0x2ebb81(0x24d)](_0xda74fc)[0x1],_0x193d1c=new Date()[_0x2ebb81(0xce)]();if(_0x536c3c){if(_0x193d1c-_0x47210f<maxSecretAge*0x3e8)return _0x1d9a5f;else return![];}else return _0x1d9a5f;}catch(_0xbde647){return![];}else return![];}const validToken=(_0x41bd0b,_0x4d2a01)=>{const _0x6f263c=_0x27f654,_0x1998bb=devices[_0x4d2a01]['ip'];if(!_0x41bd0b)return{'error':_0x6f263c(0x22a)};for(let _0x474e0f of blacklist){if(_0x474e0f[_0x6f263c(0x249)]==_0x41bd0b)return{'error':_0x6f263c(0x80)};}let _0xf16522;try{_0xf16522=jwt[_0x6f263c(0x1cc)](_0x41bd0b,secure['secret']+_0x4d2a01);}catch{return{'error':_0x6f263c(0xa6)};}if(!_0xf16522[_0x6f263c(0x191)](_0x6f263c(0x1a7))&&!_0xf16522[_0x6f263c(0x191)]('username')||!_0xf16522[_0x6f263c(0x191)](_0x6f263c(0x20d)))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0xf16522[_0x6f263c(0x191)](_0x6f263c(0xc6))&&_0xf16522[_0x6f263c(0x191)](_0x6f263c(0x1a7))){const {clientip:_0x364c72}=_0xf16522;return _0x1998bb==_0x364c72?{'success':_0x6f263c(0x286)}:{'error':_0x6f263c(0xd9)};}else{if(_0xf16522[_0x6f263c(0x191)](_0x6f263c(0xc6))&&_0xf16522[_0x6f263c(0x191)](_0x6f263c(0x1a7))){const {username:_0x5cedde,clientip:_0x135673}=_0xf16522;return settings[_0x6f263c(0x15e)]==_0x5cedde&&_0x1998bb==_0x135673?{'success':_0x6f263c(0x286)}:{'error':_0x6f263c(0x1df)};}}},generateLoginToken=_0x2b2cee=>{const _0x3ac6db=_0x27f654;if(_0x2b2cee){const _0x5b28fd=devices[_0x2b2cee]['ip'];return jwt[_0x3ac6db(0x1b6)]({'username':settings['bbUsername'],'clientip':_0x5b28fd},secure['secret']+_0x2b2cee,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x27e3e8=>{const _0x811245=_0x27f654;if(_0x27e3e8){const _0x145596=devices[_0x27e3e8]['ip'];return jwt[_0x811245(0x1b6)]({'clientip':_0x145596},secure[_0x811245(0x1d7)]+_0x27e3e8,{'expiresIn':devices[_0x27e3e8]['telegramIpApproval'][_0x811245(0x16d)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x49d157=>{const _0x5db6be=_0x27f654;let _0x2832dd=![];return devices[_0x49d157]['telegramIpApproval']&&devices[_0x49d157][_0x5db6be(0x22c)]['expiry']!=_0x5db6be(0x13b)&&(_0x2832dd=devices[_0x49d157][_0x5db6be(0x22c)]['clientip']==devices[_0x49d157]['ip']&&new Date()[_0x5db6be(0xce)]()-devices[_0x49d157][_0x5db6be(0x22c)][_0x5db6be(0x25a)]<devices[_0x49d157]['telegramIpApproval'][_0x5db6be(0x16d)]*0x3c*0x3e8),_0x2832dd;},telegram2FaApproved=_0x27f84e=>{const _0x910d0e=_0x27f654;let _0x5432fd=![];return devices[_0x27f84e][_0x910d0e(0xe6)]&&devices[_0x27f84e]['telegram2FaApproval'][_0x910d0e(0x16d)]!=_0x910d0e(0x13b)&&(_0x5432fd=devices[_0x27f84e][_0x910d0e(0xe6)][_0x910d0e(0x1a7)]==devices[_0x27f84e]['ip']&&new Date()[_0x910d0e(0xce)]()-devices[_0x27f84e][_0x910d0e(0xe6)][_0x910d0e(0x25a)]<devices[_0x27f84e]['telegram2FaApproval']['expiry']*0x3c*0x3e8),_0x5432fd;},normalizeIP=_0x40c3f9=>{const _0x56016e=_0x27f654;let _0x36b90a=null,_0x5c01a6=null;if(ipaddr[_0x56016e(0x1e1)](_0x40c3f9)){const _0x590c9e=ipaddr[_0x56016e(0x274)](_0x40c3f9);_0x590c9e['kind']()===_0x56016e(0x1d5)?(_0x590c9e[_0x56016e(0x1b2)]()&&(_0x36b90a=_0x590c9e[_0x56016e(0x7a)]()[_0x56016e(0xcc)]()),_0x5c01a6=_0x590c9e[_0x56016e(0xcc)]()):(_0x36b90a=_0x590c9e['toString'](),_0x5c01a6=_0x590c9e['toIPv4MappedAddress']()['toString']());}return{'show':_0x36b90a?_0x36b90a:_0x5c01a6,'store':_0x5c01a6};};function formatDate(_0x2334c2){const _0x10312b=_0x27f654;return _0x2334c2[_0x10312b(0x238)]()+'/'+(_0x2334c2[_0x10312b(0x180)]()+0x1)[_0x10312b(0xcc)]()[_0x10312b(0x1b1)](0x2,'0')+'/'+_0x2334c2[_0x10312b(0x25e)]()['toString']()[_0x10312b(0x1b1)](0x2,'0')+'\x20'+_0x2334c2[_0x10312b(0x11c)]()[_0x10312b(0xcc)]()[_0x10312b(0x1b1)](0x2,'0')+':'+_0x2334c2[_0x10312b(0x13d)]()[_0x10312b(0xcc)]()[_0x10312b(0x1b1)](0x2,'0')+':'+_0x2334c2[_0x10312b(0x112)]()[_0x10312b(0xcc)]()[_0x10312b(0x1b1)](0x2,'0');}function sleep(_0x195149){return new Promise(_0x1dd9da=>setTimeout(_0x1dd9da,_0x195149));}