const _0xcd5cf4=_0x404e;(function(_0x364ce0,_0x149289){const _0x4f086e=_0x404e,_0x352247=_0x364ce0();while(!![]){try{const _0x13ddaa=-parseInt(_0x4f086e(0x1d8))/0x1+-parseInt(_0x4f086e(0x1f1))/0x2*(parseInt(_0x4f086e(0x231))/0x3)+-parseInt(_0x4f086e(0xac))/0x4+parseInt(_0x4f086e(0x281))/0x5+-parseInt(_0x4f086e(0x13b))/0x6+-parseInt(_0x4f086e(0x1ac))/0x7+-parseInt(_0x4f086e(0x168))/0x8*(-parseInt(_0x4f086e(0xd6))/0x9);if(_0x13ddaa===_0x149289)break;else _0x352247['push'](_0x352247['shift']());}catch(_0x536073){_0x352247['push'](_0x352247['shift']());}}}(_0x3fea,0xa5cdc));const _0x22f037=function(){let _0x52b67f=!![];return function(_0x4e4978,_0x64b7cb){const _0x7cb940=_0x52b67f?function(){const _0x4acd72=_0x404e;if(_0x64b7cb){const _0xa07efa=_0x64b7cb[_0x4acd72(0x199)](_0x4e4978,arguments);return _0x64b7cb=null,_0xa07efa;}}:function(){};return _0x52b67f=![],_0x7cb940;};}(),_0x58644c=_0x22f037(this,function(){const _0x3cca27=_0x404e;return _0x58644c[_0x3cca27(0x17d)]()[_0x3cca27(0x291)](_0x3cca27(0x17a))[_0x3cca27(0x17d)]()[_0x3cca27(0x26a)](_0x58644c)[_0x3cca27(0x291)](_0x3cca27(0x17a));});_0x58644c();'use strict';process[_0xcd5cf4(0x1ef)][_0xcd5cf4(0xcc)]=0x1;const childProcess=require(_0xcd5cf4(0x229)),fs=require('fs'),fns=require(_0xcd5cf4(0x10d)),low=require(_0xcd5cf4(0x1ee)),FileSync=require(_0xcd5cf4(0xc9)),path=require('path'),crypto=require('crypto'),forge=require(_0xcd5cf4(0x13e)),bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require(_0xcd5cf4(0x163)),argv=require(_0xcd5cf4(0x120))(process[_0xcd5cf4(0xb3)][_0xcd5cf4(0x165)](0x2))['argv'],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0xcd5cf4(0x296)),axios=require(_0xcd5cf4(0x241)),{GraphQLClient,gql}=require(_0xcd5cf4(0x282)),util=require(_0xcd5cf4(0xc5)),fileUpload=require(_0xcd5cf4(0x250)),{networkInterfaces}=require('os'),JSZip=require(_0xcd5cf4(0x1ff)),PORT=argv[_0xcd5cf4(0xb8)]||_0xcd5cf4(0x267),pattern=/^[0-9]{2,4}$/;!pattern[_0xcd5cf4(0x25f)](PORT)&&(console[_0xcd5cf4(0x1cc)](_0xcd5cf4(0x277)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0xcd5cf4(0xdc)](0x1));const HOST=argv['host']||null,userID=argv['user']||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process['versions']['node'];let bbpath='bb/',bbpath2='';const botfile=_0xcd5cf4(0x118),configfile=_0xcd5cf4(0xbe),settingsfile=_0xcd5cf4(0x136),securefile=_0xcd5cf4(0x182),environment=require('./'+bbpath2+_0xcd5cf4(0x13a))['environment']||_0xcd5cf4(0xa6),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs['existsSync'](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0xcd5cf4(0x19c)+userID+'/':bbpath+_0xcd5cf4(0x19c),configbackuppath=configpath+_0xcd5cf4(0x1d9),logspath=userID?bbpath+_0xcd5cf4(0x98)+userID+'/':bbpath+_0xcd5cf4(0x98),zippath=userID?bbpath+_0xcd5cf4(0x88)+userID+'/':bbpath+'zip/',loggerfile=fs[_0xcd5cf4(0x1ea)](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+_0xcd5cf4(0x19d)+userID+'/':bbpath+_0xcd5cf4(0x19d);!fs[_0xcd5cf4(0x112)](configpath)&&fs[_0xcd5cf4(0x245)](configpath);!fs['existsSync'](configbackuppath)&&fs[_0xcd5cf4(0x245)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0xcd5cf4(0x245)](logspath);!fs['existsSync'](zippath)&&fs['mkdirSync'](zippath);!fs[_0xcd5cf4(0x112)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0xcd5cf4(0x1a9)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0xcd5cf4(0x24e)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0xcd5cf4(0x204),'onepagemode':![],'marketcapApi':''}})[_0xcd5cf4(0x1a9)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0xcd5cf4(0x1a9)]();const saltRounds=0xa,mixpanel=Mixpanel[_0xcd5cf4(0x253)](_0xcd5cf4(0x220),{'host':_0xcd5cf4(0x150)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0xcd5cf4(0x1cd)]&&(settings[_0xcd5cf4(0x1cd)]!=''&&settings[_0xcd5cf4(0x1cd)]!=_0xcd5cf4(0x208))&&settings[_0xcd5cf4(0x166)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x369f6a,_0x404b9d)=>{const _0x41cf0f=_0xcd5cf4,_0x41d5f8=/#[A-Z]{3}#/g;if(typeof _0x369f6a==_0x41cf0f(0xf1)){!_0x404b9d?_0x369f6a=_0x369f6a[_0x41cf0f(0x226)](_0x41d5f8,''):(_0x369f6a=_0x369f6a[_0x41cf0f(0x226)](/#BLU#/g,_0x41cf0f(0x20c)),_0x369f6a=_0x369f6a[_0x41cf0f(0x226)](/#RED#/g,'\x1b[31m'),_0x369f6a=_0x369f6a[_0x41cf0f(0x226)](/#YEL#/g,_0x41cf0f(0x23f)),_0x369f6a=_0x369f6a['replace'](/#MAG#/g,_0x41cf0f(0x122)),_0x369f6a=_0x369f6a[_0x41cf0f(0x226)](/#CYA#/g,_0x41cf0f(0x9a)),_0x369f6a=_0x369f6a[_0x41cf0f(0x226)](/#RES#/g,_0x41cf0f(0x1b4)));;}return _0x369f6a;},logger={'screen':_0x80416f=>{console['log'](parseColor(_0x80416f,!![]));},'simple':_0x3a52a1=>{const _0x46f679=_0xcd5cf4;console[_0x46f679(0x1cc)](parseColor(_0x3a52a1,!![])),loggerfile['write'](util[_0x46f679(0x1a1)](parseColor(_0x3a52a1,![]))+'\x0a');},'full':async _0x4f37e0=>{const _0xcd289=_0xcd5cf4,_0x1f23d2=getTimeStamp()+_0xcd289(0x256)+_0x4f37e0;console['log'](parseColor(_0x1f23d2,!![])),loggerfile['write'](util[_0xcd289(0x1a1)](parseColor(_0x1f23d2,![]))+'\x0a');if(tgBot&&settings[_0xcd289(0xf4)]&&settings[_0xcd289(0x175)]!=_0xcd289(0x14b))await sendTelegram(settings[_0xcd289(0xf4)],_0xcd289(0x135)+parseColor(_0x4f37e0,![]));},'debug':async(_0x2379a7,_0x528199='')=>{const _0x1c7bff=_0xcd5cf4,_0x1a710a=getTimeStamp()+_0x1c7bff(0x297)+_0x2379a7;if(debugging)console[_0x1c7bff(0x1cc)](parseColor(_0x1a710a,!![]));loggerfile['write'](util[_0x1c7bff(0x1a1)](parseColor(_0x1a710a,![]))+'\x0a');if(_0x528199){if(debugging)console[_0x1c7bff(0x1cc)](_0x528199);loggerfile[_0x1c7bff(0x1a9)](util[_0x1c7bff(0x1a1)](_0x528199)+'\x0a');}}};let terminating=![];process['on'](_0xcd5cf4(0x174),function(_0x3c5db5){const _0x3fa76c=_0xcd5cf4;_0x3c5db5[_0x3fa76c(0x17d)]()['includes'](_0x3fa76c(0x18e))?(logger[_0x3fa76c(0x216)](_0x3fa76c(0x11a)+_0x3c5db5[_0x3fa76c(0xb8)]+_0x3fa76c(0x1fb)),process['send']({'terminate':!![]},_0xf08052=>{})):logger[_0x3fa76c(0x216)](_0x3c5db5);}),process['on'](_0xcd5cf4(0xdc),()=>{const _0x3efb0c=_0xcd5cf4;stopAllBots(),process[_0x3efb0c(0xdc)](0x0);}),process['on'](_0xcd5cf4(0x257),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0xcd5cf4(0x9f),()=>{const _0x33029f=_0xcd5cf4;stopAllBots(),process[_0x33029f(0xdc)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0xcd5cf4(0x13a))[_0xcd5cf4(0xc7)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')[_0xcd5cf4(0x227)](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x178cc,_0x4bcf5c)=>{const _0x4e32cc=_0xcd5cf4,_0x4b84a2=_0x178cc[_0x4e32cc(0x1fd)][_0x4e32cc(0x11d)],_0x4d3940=getClientsWithBotID(_0x4e32cc(0x288)),_0x5d65fc=_0x178cc[_0x4e32cc(0x164)][_0x4e32cc(0x14f)],_0x219b14=timelyDecrypt(_0x5d65fc,![]),_0x29243c=_0x4d3940[_0x4e32cc(0x234)](_0x2f8c8b=>_0x2f8c8b[_0x4e32cc(0x14f)]==_0x219b14);if(_0x29243c){const _0x4ab2d5=normalizeIP(_0x178cc[_0x4e32cc(0x12b)][_0x4e32cc(0x1e8)])[_0x4e32cc(0xde)],_0x3ad5a2=_0x178cc['headers'][_0x4e32cc(0x162)];if(validateAccess(_0x3ad5a2,_0x219b14,_0x4ab2d5)['allow'])_0x4b84a2=='backup'&&await backupConfigFiles(),await zipFiles(_0x4b84a2),_0x4bcf5c[_0x4e32cc(0x13c)](zippath+(_0x4b84a2+_0x4e32cc(0xbf)),_0x1b1387=>{const _0x343a18=_0x4e32cc;_0x1b1387&&(logger[_0x343a18(0x1d0)]('Failed\x20to\x20download\x20'+_0x4b84a2),logger[_0x343a18(0x216)](_0x1b1387));});else logger[_0x4e32cc(0x1d0)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x4b84a2+_0x4e32cc(0x8e));}else logger[_0x4e32cc(0x1d0)](_0x4e32cc(0x221)+_0x4b84a2+_0x4e32cc(0x228));}),app[_0xcd5cf4(0x107)](_0xcd5cf4(0xaa),async(_0x9ab963,_0x11dc4d)=>{const _0x39e171=_0xcd5cf4,_0x16640c=getClientsWithBotID(_0x39e171(0x288)),_0x3c82d8=_0x9ab963[_0x39e171(0x164)]['uuid'],_0xb57949=timelyDecrypt(_0x3c82d8,![]),_0x38236a=_0x16640c[_0x39e171(0x234)](_0x4fa6a5=>_0x4fa6a5[_0x39e171(0x14f)]==_0xb57949);logger['debug'](_0x39e171(0xf3));if(_0x38236a){const _0x3c9e96=normalizeIP(_0x9ab963['socket'][_0x39e171(0x1e8)])['store'],_0x68e0a=_0x9ab963[_0x39e171(0x164)][_0x39e171(0x162)];if(validateAccess(_0x68e0a,_0xb57949,_0x3c9e96)[_0x39e171(0x23a)]){if(_0x9ab963['files']){const _0x2562c3=_0x9ab963[_0x39e171(0x251)][_0x39e171(0x1b5)];await _0x2562c3['mv'](temppath+_0x2562c3[_0x39e171(0x1bf)]),_0x11dc4d[_0x39e171(0x190)]({'status':!![],'message':_0x39e171(0x1bc)});const _0x18583e=getBotsWithMode();_0x18583e['length']>0x0?confirmRestore(temppath,_0x2562c3[_0x39e171(0x1bf)]):unzipFile(temppath,_0x2562c3[_0x39e171(0x1bf)]);}}else logger[_0x39e171(0x1d0)](_0x39e171(0x271));}else logger[_0x39e171(0x1d0)](_0x39e171(0x28b));}),app[_0xcd5cf4(0x147)](express[_0xcd5cf4(0x25c)](path[_0xcd5cf4(0x1a3)](__dirname,bbpath2,'build2'))),app[_0xcd5cf4(0x147)](express['static'](path[_0xcd5cf4(0x1a3)](__dirname,bbpath2,'build'))),app['get']('/',function(_0x445f32,_0xb28c92){const _0x20e75c=_0xcd5cf4;_0xb28c92[_0x20e75c(0x264)](path['join'](__dirname,bbpath2,'build2',_0x20e75c(0x1ae)));}),app[_0xcd5cf4(0x172)](_0xcd5cf4(0x16c),function(_0x33f92c,_0x5ae8dd){const _0x3dbfca=_0xcd5cf4;_0x5ae8dd[_0x3dbfca(0x264)](path[_0x3dbfca(0x1a3)](__dirname,bbpath2,'build',_0x3dbfca(0x1ae)));}),app[_0xcd5cf4(0x172)](_0xcd5cf4(0x261),(_0x3d3eae,_0x5389ce)=>{const _0x15d739=_0xcd5cf4;_0x5389ce[_0x15d739(0x264)](path[_0x15d739(0x1a3)](__dirname,bbpath2,_0x15d739(0x27d),_0x15d739(0x1ae)));}),app[_0xcd5cf4(0x172)](_0xcd5cf4(0x17f),(_0x38ddae,_0x54cbd1)=>{const _0x42431f=_0xcd5cf4;_0x54cbd1['sendFile'](path[_0x42431f(0x1a3)](__dirname,bbpath2,_0x42431f(0x27d),_0x42431f(0x1ae)));}),app[_0xcd5cf4(0x172)](_0xcd5cf4(0x260),(_0x2187c6,_0x49089a)=>{const _0x1e4c74=_0xcd5cf4;_0x49089a[_0x1e4c74(0x264)](path[_0x1e4c74(0x1a3)](__dirname,bbpath2,_0x1e4c74(0x27d),'index.html'));}),app['get']('/:bot/history',(_0x4eb9b8,_0x20795b)=>{const _0x5e81d3=_0xcd5cf4;_0x20795b['sendFile'](path[_0x5e81d3(0x1a3)](__dirname,bbpath2,_0x5e81d3(0x27d),_0x5e81d3(0x1ae)));}),app[_0xcd5cf4(0x172)](_0xcd5cf4(0xa2),(_0x1b3750,_0x68aa9c)=>{const _0x46665c=_0xcd5cf4;_0x68aa9c[_0x46665c(0x264)](path[_0x46665c(0x1a3)](__dirname,bbpath2,'build',_0x46665c(0x1ae)));}),app[_0xcd5cf4(0x172)](_0xcd5cf4(0xc8),(_0x2c362f,_0x23b517)=>{const _0x1633c4=_0xcd5cf4;_0x23b517[_0x1633c4(0x264)](path['join'](__dirname,bbpath2,_0x1633c4(0x27d),_0x1633c4(0x1ae)));});if(HOST)http[_0xcd5cf4(0x19e)](PORT,HOST);else http[_0xcd5cf4(0x19e)](PORT);const io=require(_0xcd5cf4(0x143))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x26caaa=_0xcd5cf4;let _0x48aac5=_0x26caaa(0x259);const _0x52b954=networkInterfaces(),_0x12a234={};for(const _0x561d10 of Object[_0x26caaa(0x161)](_0x52b954)){for(const _0x2c7e12 of _0x52b954[_0x561d10]){if((_0x2c7e12['family']==_0x26caaa(0x186)||_0x2c7e12[_0x26caaa(0x141)]==0x4)&&!_0x2c7e12[_0x26caaa(0x22e)]){const _0x1450d7=ipaddr[_0x26caaa(0x90)](_0x2c7e12['address'])[_0x26caaa(0x1ab)]();_0x1450d7!=_0x26caaa(0x103)&&(!_0x12a234[_0x561d10]&&(_0x12a234[_0x561d10]=[]),_0x12a234[_0x561d10][_0x26caaa(0xd5)](_0x2c7e12[_0x26caaa(0x270)]),_0x48aac5=_0x2c7e12[_0x26caaa(0x270)]);}}}return{'serverip':_0x48aac5,'netinterfaces':_0x12a234};}async function startServer(){const _0x46f5cf=_0xcd5cf4,{serverip:_0x26db0e,netinterfaces:_0x30361a}=getServerIP();logger[_0x46f5cf(0x216)](''),logger[_0x46f5cf(0x216)](_0x46f5cf(0x1e7)),await logger[_0x46f5cf(0x1d0)](_0x46f5cf(0x146)+serverversion+_0x46f5cf(0x258)+(environment==_0x46f5cf(0x160)?_0x46f5cf(0x145):'')+'\x0a'+(_0x46f5cf(0x25a)+PORT+_0x46f5cf(0xfe))+(_0x46f5cf(0x206)+_0x26db0e+':'+PORT+_0x46f5cf(0x1bd))),logger[_0x46f5cf(0x216)]('-----------------------------------------------------------------------------------');if(config[_0x46f5cf(0x193)]!=0x0)for(const _0x30be6c of config){const _0x73d37f=_0x30be6c[_0x46f5cf(0x249)]=='auto'?'a':'m';if(_0x30be6c[_0x46f5cf(0x148)]=='enabled'||_0x30be6c[_0x46f5cf(0x148)]==_0x46f5cf(0x1f8))await logger['full'](_0x46f5cf(0x26c)+_0x73d37f+')\x20|\x20Bot\x20'+_0x30be6c[_0x46f5cf(0xed)]+'\x20|\x20'+_0x30be6c[_0x46f5cf(0x19f)]),startBot([_0x30be6c[_0x46f5cf(0xed)],userID],{'cwd':bbpath},function(_0x25549f){const _0x20fc59=_0x46f5cf;if(_0x25549f)logger[_0x20fc59(0x1d0)](_0x25549f);});else(_0x30be6c['status']==_0x46f5cf(0x96)||_0x30be6c[_0x46f5cf(0x148)]==_0x46f5cf(0x189))&&await logger[_0x46f5cf(0x1d0)](_0x46f5cf(0xe2)+_0x73d37f+_0x46f5cf(0x86)+_0x30be6c[_0x46f5cf(0xed)]+_0x46f5cf(0x207)+_0x30be6c[_0x46f5cf(0x19f)]);}else!newBot&&logger[_0x46f5cf(0x216)](_0x46f5cf(0x15a));if(newBot)addBot();logger['simple'](_0x46f5cf(0x1e7)),logger[_0x46f5cf(0x216)](''),await logger['debug'](_0x46f5cf(0x1ba)+nodeversion),await logger[_0x46f5cf(0x1b1)](_0x46f5cf(0x294),_0x30361a);}function startSocket(){const _0x596f63=_0xcd5cf4;io['on'](_0x596f63(0x1d7),_0x2be3a6=>{const _0x2321ae=_0x596f63;let _0x4e40ed,_0x2bc677,_0x19d3fa,_0x320b30,_0x49538c;const _0x5721b2=_0x2be3a6[_0x2321ae(0x205)][_0x2321ae(0x164)][_0x2321ae(0x170)];_0x2bc677=_0x5721b2['match'](/bot[0-9]{3}/);if(_0x2bc677)_0x19d3fa=_0x2bc677[0x0][_0x2321ae(0x285)](/[0-9]{3}/);if(_0x19d3fa)_0x4e40ed=_0x19d3fa[0x0];else _0x4e40ed='botmanager';const _0x282072=_0x2be3a6[_0x2321ae(0x205)][_0x2321ae(0x1f7)]['encryptedUuid'];if(!_0x282072)_0x2be3a6['emit']('status',{'publicKey':secure[_0x2321ae(0x15d)]});else{_0x320b30=timelyDecrypt(_0x282072,![]);if(!_0x320b30)_0x2be3a6[_0x2321ae(0xfc)](_0x2321ae(0x148),{'publicKey':secure[_0x2321ae(0x15d)]});else{_0x49538c=normalizeIP(_0x2be3a6['conn']['remoteAddress'])[_0x2321ae(0xde)];if(!devices[_0x320b30])devices[_0x320b30]={'uuid':_0x320b30,'access':{'token':null}};devices[_0x320b30]['ip']=_0x49538c;const _0x1dff2c=addClient(_0x2be3a6['id'],_0x320b30,_0x4e40ed);setAccess(_0x1dff2c),emitMessages(),_0x2be3a6['on']('login',_0x48972d=>{const _0x2f563b=_0x2321ae,_0x3cb542=timelyDecrypt(_0x48972d['password'],!![],_0x2f563b(0x192));if(_0x3cb542){_0x48972d={'username':_0x48972d[_0x2f563b(0x224)],'password':_0x3cb542},devices[_0x320b30][_0x2f563b(0x113)]=validateCredentials(_0x48972d,_0x320b30);if(devices[_0x320b30][_0x2f563b(0x113)][_0x2f563b(0x23a)]==![]&&devices[_0x320b30][_0x2f563b(0x113)][_0x2f563b(0x1c8)]==_0x2f563b(0x298))_0x2be3a6['emit']('status',{'access':devices[_0x320b30][_0x2f563b(0x113)]}),loginAccess2FA(_0x320b30,_0x49538c);else{if(devices[_0x320b30][_0x2f563b(0x113)][_0x2f563b(0x23a)]==![]&&devices[_0x320b30][_0x2f563b(0x113)][_0x2f563b(0x1c8)]=='invalid\x20credentials')_0x2be3a6[_0x2f563b(0xfc)](_0x2f563b(0x148),{'access':devices[_0x320b30][_0x2f563b(0x113)]});else devices[_0x320b30][_0x2f563b(0x113)][_0x2f563b(0x23a)]&&devices[_0x320b30][_0x2f563b(0x113)][_0x2f563b(0x1c8)]==_0x2f563b(0xbc)&&(getClientsWithUuid(_0x320b30)[_0x2f563b(0x26e)](_0x7e832c=>{setAccess(_0x7e832c);}),logger[_0x2f563b(0x1b1)](_0x2f563b(0x1dc)+_0x320b30[_0x2f563b(0x165)](-0x8)),setTokenRefresh(_0x320b30),setSessionTimeout(_0x2f563b(0x25d),_0x320b30));}}else logger[_0x2f563b(0x1d0)](_0x2f563b(0x154));}),_0x2be3a6['on'](_0x2321ae(0x28a),()=>{resetPassword();}),_0x2be3a6['on'](_0x2321ae(0xf6),_0x5776b1=>{removeClient(_0x2be3a6['id']);}),_0x4e40ed==_0x2321ae(0x288)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x38a212){const _0x321c70=_0xcd5cf4;if(_0x38a212!='botmanager'&&config[_0x321c70(0x23b)]!=''){if(pid[_0x38a212])pid[_0x38a212]['send']({'function':'initclient','args':null});}_0x38a212!=_0x321c70(0x288)&&broadcastToBots(_0x321c70(0x21a),JSON[_0x321c70(0x20a)](config));}function reloadBotManager(){const _0x4fc97e=_0xcd5cf4;getClientsWithBotID('botmanager')[_0x4fc97e(0x26e)](_0x13063c=>{const _0x137029=_0x4fc97e;getSocket(_0x13063c['id'])[_0x137029(0xfc)](_0x137029(0x148),{'access':{'allow':![],'reason':_0x137029(0x21f),'token':null}});});}function getSocket(_0x1f9fc1){const _0x323197=_0xcd5cf4,_0x52b840=io[_0x323197(0x240)][_0x323197(0x172)]('/');return _0x52b840[_0x323197(0x11f)][_0x323197(0x172)](_0x1f9fc1);}function setAccess(_0x745b82){const _0x493d48=_0xcd5cf4,_0x17b0be=getSocket(_0x745b82['id']),_0x1c3a4a=_0x745b82[_0x493d48(0x14f)],_0x2f61f1=_0x745b82[_0x493d48(0xd1)];devices[_0x1c3a4a][_0x493d48(0x113)]=validateAccess(devices[_0x1c3a4a]['access'][_0x493d48(0x233)],_0x1c3a4a),logger[_0x493d48(0x1b1)]('Setting\x20access:\x20'+devices[_0x1c3a4a][_0x493d48(0x113)][_0x493d48(0x1c8)]+_0x493d48(0xbd)+_0x745b82['id']['slice'](-0x8)+_0x493d48(0x14a)+_0x1c3a4a[_0x493d48(0x165)](-0x8)),_0x17b0be[_0x493d48(0x1a3)](_0x1c3a4a);if(devices[_0x1c3a4a][_0x493d48(0x113)][_0x493d48(0x23a)]){_0x17b0be[_0x493d48(0x1a3)](_0x2f61f1);if(_0x2f61f1==_0x493d48(0x288))initializeSocketBotManager(_0x17b0be);else initializeSocketBot(_0x17b0be);initClient(_0x2f61f1);}devices[_0x1c3a4a][_0x493d48(0x113)][_0x493d48(0x233)]&&devices[_0x1c3a4a][_0x493d48(0x113)]['reason']==_0x493d48(0xc1)&&setSessionTimeout(_0x493d48(0x23c),_0x1c3a4a),devices[_0x1c3a4a][_0x493d48(0x113)][_0x493d48(0x233)]&&devices[_0x1c3a4a][_0x493d48(0x113)][_0x493d48(0x1c8)]==_0x493d48(0x11b)&&setSessionTimeout(_0x493d48(0x25d),_0x1c3a4a),_0x17b0be[_0x493d48(0xfc)](_0x493d48(0x148),{'status':_0x745b82[_0x493d48(0xc3)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1c3a4a][_0x493d48(0x113)],'externalip':devices[_0x1c3a4a]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x493d48(0xd9)],'validInstallation':validInstallation}),devices[_0x1c3a4a]['access'][_0x493d48(0x23a)]==![]&&devices[_0x1c3a4a][_0x493d48(0x113)][_0x493d48(0x1c8)]==_0x493d48(0x262)&&temporaryAccess2FA(_0x1c3a4a,devices[_0x1c3a4a]['ip']);}function setSessionTimeout(_0x1552e9,_0x275199){const _0x19b74b=_0xcd5cf4;let _0x260d32;if(_0x1552e9=='login')_0x260d32=loginExpiry*0x3c*0x3e8;else _0x260d32=devices[_0x275199]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()[_0x19b74b(0x292)]()-devices[_0x275199]['telegramIpApproval'][_0x19b74b(0x242)]);if(devices[_0x275199][_0x19b74b(0xe3)])clearTimeout(devices[_0x275199][_0x19b74b(0xe3)]);devices[_0x275199][_0x19b74b(0xe3)]=setTimeout(()=>{const _0x364590=_0x19b74b;if(devices[_0x275199][_0x364590(0x111)])clearTimeout(devices[_0x275199][_0x364590(0x111)]);removeSocketListeners(_0x275199),addBlacklist(_0x275199),devices[_0x275199][_0x364590(0x158)]=null,devices[_0x275199]['telegram2FaApproval']=null,devices[_0x275199][_0x364590(0x113)][_0x364590(0x233)]=null,logger[_0x364590(0x1b1)]('Session\x20expired\x20for\x20user\x20...'+_0x275199[_0x364590(0x165)](-0x8)),devices[_0x275199][_0x364590(0x113)]=validateAccess(devices[_0x275199][_0x364590(0x113)][_0x364590(0x233)],_0x275199),!(devices[_0x275199][_0x364590(0x113)]['allow']&&devices[_0x275199][_0x364590(0x113)][_0x364590(0x1c8)]==_0x364590(0x286))&&(_0x1552e9==_0x364590(0x25d)?io['to'](_0x275199)[_0x364590(0xfc)](_0x364590(0x148),{'access':{'allow':![],'reason':_0x364590(0x12f),'token':null}}):io['to'](_0x275199)['emit'](_0x364590(0x148),{'access':{'allow':![],'reason':_0x364590(0x230),'token':null}})),devices[_0x275199][_0x364590(0x113)][_0x364590(0x233)]=null;},_0x260d32);}function setTokenRefresh(_0x1a0439){const _0x2c3978=_0xcd5cf4;if(devices[_0x1a0439]['pidRefreshToken'])clearTimeout(devices[_0x1a0439]['pidRefreshToken']);devices[_0x1a0439][_0x2c3978(0x111)]=setTimeout(()=>{const _0x2e95f0=_0x2c3978;getClientsWithUuid(_0x1a0439)[_0x2e95f0(0x193)]!=0x0?(devices[_0x1a0439][_0x2e95f0(0x113)]=refreshToken(_0x1a0439),io['to'](_0x1a0439)[_0x2e95f0(0xfc)](_0x2e95f0(0x148),{'status':_0x2e95f0(0x1f3),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1a0439]['access'],'externalip':devices[_0x1a0439]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x1a0439)):clearTimeout(devices[_0x1a0439][_0x2e95f0(0x111)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4dca1d){const _0x34fd12=_0xcd5cf4,_0x2660db=getClient(_0x4dca1d['id'])[_0x34fd12(0x14f)];_0x4dca1d[_0x34fd12(0xfc)](_0x34fd12(0x21a),config),_0x4dca1d['emit'](_0x34fd12(0x104),cleanSettings()),_0x4dca1d['on'](_0x34fd12(0x27a),_0x2c0ce0=>{const _0x3cda7a=_0x34fd12;if(validateAccess(_0x2c0ce0,_0x2660db)[_0x3cda7a(0x23a)])addBot();else logger[_0x3cda7a(0x1d0)](_0x3cda7a(0xc6));}),_0x4dca1d['on'](_0x34fd12(0x247),(_0x119787,_0x3be753)=>{const _0x1353ec=_0x34fd12;if(validateAccess(_0x3be753,_0x2660db)[_0x1353ec(0x23a)])toggleBot(_0x119787[_0x1353ec(0xed)],_0x119787[_0x1353ec(0x148)],_0x119787[_0x1353ec(0x1ed)]);else logger[_0x1353ec(0x1d0)](_0x1353ec(0x212));}),_0x4dca1d['on'](_0x34fd12(0xb0),(_0x5a2f68,_0x449fe8)=>{const _0x4a21f9=_0x34fd12;if(validateAccess(_0x449fe8,_0x2660db)[_0x4a21f9(0x23a)])toggleBotMode(_0x5a2f68);else logger[_0x4a21f9(0x1d0)](_0x4a21f9(0x212));}),_0x4dca1d['on'](_0x34fd12(0xec),(_0x3101ca,_0x4fad31)=>{const _0x2d31cc=_0x34fd12;if(validateAccess(_0x4fad31,_0x2660db)['allow'])deleteBot(_0x3101ca);else logger[_0x2d31cc(0x1d0)](_0x2d31cc(0x1a2));}),_0x4dca1d['on']('store-settings',(_0x2fa4ec,_0x47d3c7)=>{const _0x455e50=_0x34fd12;if(validateAccess(_0x47d3c7,_0x2660db)['allow'])storeSettings(_0x2fa4ec,!![]);else logger['full'](_0x455e50(0xcd));}),_0x4dca1d['on']('update-bb',_0x23b592=>{const _0x3487d2=_0x34fd12;if(validateAccess(_0x23b592,_0x2660db)[_0x3487d2(0x23a)])updateBB(_0x3487d2(0x19a));else logger[_0x3487d2(0x1d0)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x4dca1d['on'](_0x34fd12(0x243),_0x3e1450=>{const _0x21a636=_0x34fd12;if(validateAccess(_0x3e1450,_0x2660db)[_0x21a636(0x23a)])updateBB(_0x21a636(0x1c4));else logger['full']('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x4dca1d['on'](_0x34fd12(0x198),_0x5d00ef=>{const _0x469729=_0x34fd12;if(validateAccess(_0x5d00ef,_0x2660db)[_0x469729(0x23a)]){const _0x3759c6=getClient(_0x4dca1d['id']);if(_0x3759c6)getBackupFiles(_0x3759c6[_0x469729(0x14f)]);else logger[_0x469729(0x1d0)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x469729(0x1d0)](_0x469729(0x219));}),_0x4dca1d['on'](_0x34fd12(0x248),(_0x54b36c,_0x29f89a)=>{const _0x339abc=_0x34fd12;if(validateAccess(_0x29f89a,_0x2660db)[_0x339abc(0x23a)])restoreBackupFile(_0x54b36c);else logger['full'](_0x339abc(0xff));}),_0x4dca1d['on'](_0x34fd12(0x21d),_0x33b4de=>{const _0x32598e=_0x34fd12;if(validateAccess(_0x33b4de,_0x2660db)[_0x32598e(0x23a)])getMessages();else logger[_0x32598e(0x1d0)](_0x32598e(0x1fa));}),_0x4dca1d['on'](_0x34fd12(0xad),(_0x1967a3,_0x498676)=>{const _0x5caa80=_0x34fd12;if(validateAccess(_0x498676,_0x2660db)[_0x5caa80(0x23a)])confirmMessage(_0x1967a3);else logger[_0x5caa80(0x1d0)](_0x5caa80(0x1e0));}),_0x4dca1d['on']('logout',_0xe0c0e1=>{const _0x29fbb7=_0x34fd12;if(validateAccess(_0xe0c0e1,_0x2660db)[_0x29fbb7(0x23a)]){if(devices[_0x2660db][_0x29fbb7(0x111)])clearTimeout(devices[_0x2660db][_0x29fbb7(0x111)]);if(devices[_0x2660db]['pidExpireLogin'])clearTimeout(devices[_0x2660db][_0x29fbb7(0xe3)]);removeSocketListeners(getClient(_0x4dca1d['id'])[_0x29fbb7(0x14f)]),addBlacklist(_0x2660db),devices[_0x2660db][_0x29fbb7(0x158)]=null,devices[_0x2660db][_0x29fbb7(0x8b)]=null,devices[_0x2660db][_0x29fbb7(0x113)][_0x29fbb7(0x233)]=null,logger[_0x29fbb7(0x1b1)]('Logged\x20out\x20user\x20...'+_0x2660db[_0x29fbb7(0x165)](-0x8)),io['to'](getClient(_0x4dca1d['id'])['uuid'])[_0x29fbb7(0xfc)]('status',{'access':{'allow':![],'reason':_0x29fbb7(0x273),'token':null}});}else logger[_0x29fbb7(0x1d0)](_0x29fbb7(0x10b));});}function initializeSocketBot(_0xf733ed){const _0x5a8e32=_0xcd5cf4,_0x5b5b26=getClient(_0xf733ed['id'])['bot'],_0x1fdbe2=getClient(_0xf733ed['id'])[_0x5a8e32(0x14f)];_0xf733ed['on'](_0x5a8e32(0x20d),(_0x27ba0c,_0xc1e8ad)=>{const _0x5b459a=_0x5a8e32;if(validateAccess(_0xc1e8ad,_0x1fdbe2)[_0x5b459a(0x23a)]){if(pid[_0x5b5b26])pid[_0x5b5b26]['send']({'function':'emitHistory','args':_0x27ba0c});}else logger['full'](_0x5b459a(0xf5));}),_0xf733ed['on']('delete-alerts',(_0x58f883,_0x3417a6)=>{const _0x227706=_0x5a8e32;if(validateAccess(_0x3417a6,_0x1fdbe2)[_0x227706(0x23a)]){if(pid[_0x5b5b26])pid[_0x5b5b26][_0x227706(0x190)]({'function':_0x227706(0x21e),'args':_0x58f883});}else logger['full'](_0x227706(0x11e));}),_0xf733ed['on']('get-portfolio',(_0x3d9e8a,_0x2d82ee)=>{const _0x15166e=_0x5a8e32;if(validateAccess(_0x2d82ee,_0x1fdbe2)[_0x15166e(0x23a)]){if(pid[_0x5b5b26])pid[_0x5b5b26][_0x15166e(0x190)]({'function':_0x15166e(0x156),'args':_0x3d9e8a});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0xf733ed['on'](_0x5a8e32(0x26f),(_0x487efb,_0x3db0cb)=>{const _0x22e212=_0x5a8e32;if(validateAccess(_0x3db0cb,_0x1fdbe2)[_0x22e212(0x23a)]){if(pid[_0x5b5b26])pid[_0x5b5b26]['send']({'function':_0x22e212(0x24c),'args':_0x487efb});}else logger['full'](_0x22e212(0x1e4));}),_0xf733ed['on']('store-headless',(_0x33132f,_0x57af55)=>{const _0x473cd9=_0x5a8e32;if(validateAccess(_0x57af55,_0x1fdbe2)[_0x473cd9(0x23a)]){if(pid[_0x5b5b26])pid[_0x5b5b26][_0x473cd9(0x190)]({'function':_0x473cd9(0x121),'args':_0x33132f});}else logger[_0x473cd9(0x1d0)](_0x473cd9(0x17b));}),_0xf733ed['on'](_0x5a8e32(0xa7),(_0x399a4b,_0x44a2c3)=>{const _0x44706f=_0x5a8e32;if(validateAccess(_0x44a2c3,_0x1fdbe2)[_0x44706f(0x23a)]){if(pid[_0x5b5b26])pid[_0x5b5b26]['send']({'function':_0x44706f(0x1c0),'args':_0x399a4b});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration');}),_0xf733ed['on'](_0x5a8e32(0xe9),_0x1857c5=>{const _0x10999b=_0x5a8e32;if(validateAccess(_0x1857c5,_0x1fdbe2)[_0x10999b(0x23a)]){if(pid[_0x5b5b26])pid[_0x5b5b26][_0x10999b(0x190)]({'function':_0x10999b(0x14c),'args':null});}else logger[_0x10999b(0x1d0)](_0x10999b(0x23d));}),_0xf733ed['on']('get-starting-balances',_0x137a23=>{const _0x1e3979=_0x5a8e32;if(validateAccess(_0x137a23,_0x1fdbe2)[_0x1e3979(0x23a)]){if(pid[_0x5b5b26])pid[_0x5b5b26][_0x1e3979(0x190)]({'function':_0x1e3979(0xb2),'args':null});}else logger[_0x1e3979(0x1d0)](_0x1e3979(0x1a8));}),_0xf733ed['on']('place-order',(_0x30fa0d,_0x24142c)=>{const _0x5a80a7=_0x5a8e32;if(validateAccess(_0x24142c,_0x1fdbe2)[_0x5a80a7(0x23a)]){if(pid[_0x5b5b26])pid[_0x5b5b26][_0x5a80a7(0x190)]({'function':_0x5a80a7(0x1f0),'args':_0x30fa0d});}else logger[_0x5a80a7(0x1d0)](_0x5a80a7(0xa3));}),_0xf733ed['on'](_0x5a8e32(0xba),_0x4dde04=>{const _0x517579=_0x5a8e32;if(validateAccess(_0x4dde04,_0x1fdbe2)['allow']){if(pid[_0x5b5b26])pid[_0x5b5b26]['send']({'function':_0x517579(0xf2),'args':null});}else logger[_0x517579(0x1d0)](_0x517579(0xe7));}),_0xf733ed['on'](_0x5a8e32(0x1f5),_0x3da251=>{const _0x26ef8b=_0x5a8e32;if(validateAccess(_0x3da251,_0x1fdbe2)[_0x26ef8b(0x23a)]){if(pid[_0x5b5b26])pid[_0x5b5b26][_0x26ef8b(0x190)]({'function':_0x26ef8b(0x105),'args':null});}else logger[_0x26ef8b(0x1d0)](_0x26ef8b(0x1cb));}),_0xf733ed['on'](_0x5a8e32(0x1d3),_0x3d2e79=>{const _0xe245e0=_0x5a8e32;if(validateAccess(_0x3d2e79,_0x1fdbe2)[_0xe245e0(0x23a)])updateBB(_0xe245e0(0x19a));else logger[_0xe245e0(0x1d0)](_0xe245e0(0x89));}),_0xf733ed['on']('get-messages',_0x1b11fa=>{const _0x56402c=_0x5a8e32;if(validateAccess(_0x1b11fa,_0x1fdbe2)[_0x56402c(0x23a)])getMessages();else logger[_0x56402c(0x1d0)](_0x56402c(0x1fa));}),_0xf733ed['on'](_0x5a8e32(0xad),(_0x403821,_0x226e9c)=>{const _0x32ea35=_0x5a8e32;if(validateAccess(_0x226e9c,_0x1fdbe2)[_0x32ea35(0x23a)])confirmMessage(_0x403821);else logger[_0x32ea35(0x1d0)](_0x32ea35(0x1e0));}),_0xf733ed['on']('logout',_0x590b2a=>{const _0x3d6b3e=_0x5a8e32;if(validateAccess(_0x590b2a,_0x1fdbe2)[_0x3d6b3e(0x23a)]){if(devices[_0x1fdbe2][_0x3d6b3e(0x111)])clearTimeout(devices[_0x1fdbe2][_0x3d6b3e(0x111)]);if(devices[_0x1fdbe2][_0x3d6b3e(0xe3)])clearTimeout(devices[_0x1fdbe2][_0x3d6b3e(0xe3)]);removeSocketListeners(getClient(_0xf733ed['id'])[_0x3d6b3e(0x14f)]),addBlacklist(_0x1fdbe2),devices[_0x1fdbe2]['telegramIpApproval']=null,devices[_0x1fdbe2][_0x3d6b3e(0x8b)]=null,devices[_0x1fdbe2][_0x3d6b3e(0x113)][_0x3d6b3e(0x233)]=null,logger[_0x3d6b3e(0x1b1)](_0x3d6b3e(0x223)+_0x1fdbe2[_0x3d6b3e(0x165)](-0x8)),io['to'](getClient(_0xf733ed['id'])[_0x3d6b3e(0x14f)])[_0x3d6b3e(0xfc)](_0x3d6b3e(0x148),{'access':{'allow':![],'reason':_0x3d6b3e(0x273),'token':null}});}else logger['full'](_0x3d6b3e(0x10b));});}function removeSocketListeners(_0x1cc455){getClientsWithUuid(_0x1cc455)['forEach'](_0x22597f=>{const _0x27f155=_0x404e;getSocket(_0x22597f['id'])[_0x27f155(0x130)]();});}function cleanSettings(){const _0x390e00=_0xcd5cf4;let _0x422ada=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x422ada={..._0x422ada,'telegramToken':_0x390e00(0x124)}),settings[_0x390e00(0xb1)]&&settings[_0x390e00(0xb1)]!=''&&(_0x422ada={..._0x422ada,'bbPassword':'************'}),settings[_0x390e00(0x21c)]&&settings[_0x390e00(0x21c)]!=''&&(_0x422ada={..._0x422ada,'marketcapApi':'************'}),(settings[_0x390e00(0xb1)]&&settings['bbPassword']==_0x390e00(0x208)||settings[_0x390e00(0x1cd)]&&settings[_0x390e00(0x1cd)]=='***'||settings[_0x390e00(0x21c)]&&settings[_0x390e00(0x21c)]=='***')&&(_0x422ada={..._0x422ada,'restored':{'password':settings['bbPassword']==_0x390e00(0x208),'telegram':settings['telegramToken']=='***','marketcap':settings[_0x390e00(0x21c)]=='***'}}),_0x422ada;}async function updateBB(_0x5f013c){const _0x3fe0a2=_0xcd5cf4;await backupConfigFiles(),installingUpdate=!![],config[_0x3fe0a2(0x26e)](_0x162cdb=>{const _0x23bd58=_0x3fe0a2;restartBot(_0x162cdb[_0x23bd58(0xed)]);});if(_0x5f013c==_0x3fe0a2(0x19a))process[_0x3fe0a2(0x190)]({'update':!![],'environment':environment},_0x413ffd=>{});else _0x5f013c=='reinstall'&&process[_0x3fe0a2(0x190)]({'reinstall':!![],'environment':environment},_0xcd74b3=>{});}function startBot(_0x51cc33,_0x57e376,_0x13eb6e){const _0x2a3703=_0xcd5cf4;if(debugging)_0x51cc33[_0x2a3703(0xd5)]('-d');if(recreate)_0x51cc33[_0x2a3703(0xd5)]('-r');let _0x413ba9=![];const _0x532db6=_0x51cc33[0x0];_0x57e376={..._0x57e376,'stdio':[_0x2a3703(0x20e),_0x2a3703(0x20e),_0x2a3703(0x20e),'ipc']},pid[_0x532db6]=childProcess[_0x2a3703(0x92)](botfile,_0x51cc33,_0x57e376),pid[_0x532db6]['on'](_0x2a3703(0x268),_0x20be7a=>{const _0x2cd7d7=_0x2a3703;switch(Object[_0x2cd7d7(0x161)](_0x20be7a)[0x0]){case _0x2cd7d7(0x19f):updateBotName(_0x532db6,_0x20be7a['botname']);break;case _0x2cd7d7(0x8f):updateBotManager();break;case _0x2cd7d7(0x148):updateStatus(_0x532db6,_0x20be7a[_0x2cd7d7(0x148)]);break;case _0x2cd7d7(0x1ed):updateLive(_0x532db6,_0x20be7a[_0x2cd7d7(0x1ed)]);break;case _0x2cd7d7(0x1b9):updateLive(_0x532db6,_0x20be7a['started']),io['to'](_0x532db6)['emit'](_0x2cd7d7(0x148),{'access':{'allow':![],'reason':_0x2cd7d7(0x21f),'token':null}});break;case _0x2cd7d7(0x203):_0x20be7a['stop']==_0x2cd7d7(0xa8)&&restartBot(_0x532db6);_0x20be7a[_0x2cd7d7(0x203)]==_0x2cd7d7(0x155)&&toggleBot(_0x532db6,_0x2cd7d7(0x96),'stopped');break;case _0x2cd7d7(0x1e9):sendTelegramBot(_0x532db6,_0x20be7a[_0x2cd7d7(0x1e9)]);break;case _0x2cd7d7(0x1e6):sendTelegramMsg(_0x20be7a[_0x2cd7d7(0x1e6)]);break;case _0x2cd7d7(0x22b):io['to'](_0x532db6)[_0x2cd7d7(0xfc)](_0x20be7a[_0x2cd7d7(0x22b)],_0x20be7a[_0x2cd7d7(0x194)]);break;}}),pid[_0x532db6]['on'](_0x2a3703(0x29a),function(_0x5a9e2e){if(_0x413ba9)return;_0x413ba9=!![],_0x13eb6e(_0x5a9e2e);}),pid[_0x532db6]['on'](_0x2a3703(0xdc),async function(_0x5109b4){const _0x3088e5=_0x2a3703;if(terminating)return;if(installingUpdate){io[_0x3088e5(0x15b)]();return;}if(_0x413ba9)return;_0x413ba9=!![],_0x13eb6e(null);const _0x137688=dbConfig[_0x3088e5(0x172)](_0x3088e5(0x21a))[_0x3088e5(0x234)]({'botID':_0x532db6})[_0x3088e5(0x27f)]();_0x137688&&(_0x137688[_0x3088e5(0x148)]=='enabled'||_0x137688[_0x3088e5(0x148)]=='new')&&(await sleep(0x3e8),updateLive(_0x532db6,_0x3088e5(0xe5)),logger['full']('Restarting\x20Bot\x20'+_0x532db6),startBot([_0x532db6,userID],{'cwd':bbpath},function(_0x24559a){const _0xafe253=_0x3088e5;if(_0x24559a)logger[_0xafe253(0x1d0)](_0x24559a);}));});}function stopBot(_0x3ab060){const _0x9c463e=_0xcd5cf4;getClientsWithBotID(_0x3ab060)['forEach'](_0x52fdcd=>{const _0x19c786=_0x404e;getSocket(_0x52fdcd['id'])[_0x19c786(0xf6)](!![]),removeClient(_0x52fdcd['id']);}),pid[_0x3ab060]&&(pid[_0x3ab060][_0x9c463e(0x155)](),pid[_0x3ab060]=null);}function stopAllBots(){const _0x27fb5e=_0xcd5cf4;terminating=!![];const _0x2caf1e=getEnabledBots();_0x2caf1e[_0x27fb5e(0x26e)](_0x251c8b=>{const _0x5e27c4=_0x27fb5e;stopBot(_0x251c8b[_0x5e27c4(0xed)]);});}function restartBot(_0x3ac1a9){const _0xa652f2=_0xcd5cf4;if(pid[_0x3ac1a9])pid[_0x3ac1a9][_0xa652f2(0x155)]();}function addBot(){const _0xa8cadd=_0xcd5cf4;let _0x49b64b;for(let _0x740c82=0x1;_0x740c82<0x3e9;_0x740c82++){_0x49b64b=_0x740c82[_0xa8cadd(0x17d)]()[_0xa8cadd(0x131)](0x3,'0');let _0x1fb9ce=config[_0xa8cadd(0x234)](_0x591bb0=>_0x591bb0['botID']==_0x49b64b);if(!_0x1fb9ce)break;}if(_0x49b64b===_0xa8cadd(0x10f)){logger[_0xa8cadd(0x1d0)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger['full']('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0x49b64b),dbConfig[_0xa8cadd(0x172)]('bots')[_0xa8cadd(0xd5)]({'botID':_0x49b64b,'botname':_0xa8cadd(0x12a)+_0x49b64b,'status':_0xa8cadd(0x1f8),'live':''})[_0xa8cadd(0x1a9)](),startBot([_0x49b64b,userID],{'cwd':bbpath},function(_0xe5eca){if(_0xe5eca)logger['full'](_0xe5eca);}),config=getConfiguration(),io['to']('botmanager')[_0xa8cadd(0xfc)](_0xa8cadd(0x21a),config),broadcastToBots(_0xa8cadd(0x21a),JSON[_0xa8cadd(0x20a)](config));}function deleteBot(_0x47d896){const _0x108871=_0xcd5cf4;getClientsWithBotID(_0x47d896)[_0x108871(0x26e)](_0x295321=>{const _0x967fc9=_0x108871;getSocket(_0x295321['id'])[_0x967fc9(0xf6)](!![]),removeClient(_0x295321['id']);}),dbConfig[_0x108871(0x172)](_0x108871(0x21a))[_0x108871(0x83)]({'botID':_0x47d896})[_0x108871(0x1a9)](),logger['full'](_0x108871(0x24f)+_0x47d896),stopBot(_0x47d896);try{if(fs['existsSync'](path[_0x108871(0x1a3)](configpath,_0x108871(0x10e)+_0x47d896+_0x108871(0x16d))))fs['unlinkSync'](path[_0x108871(0x1a3)](configpath,_0x108871(0x10e)+_0x47d896+_0x108871(0x16d)));if(fs[_0x108871(0x112)](path['join'](configpath,_0x108871(0x10e)+_0x47d896+_0x108871(0x1b7))))fs[_0x108871(0x1a4)](path[_0x108871(0x1a3)](configpath,'bot-'+_0x47d896+_0x108871(0x1b7)));if(fs['existsSync'](path['join'](configpath,_0x108871(0x10e)+_0x47d896+'-performance.json')))fs[_0x108871(0x1a4)](path[_0x108871(0x1a3)](configpath,'bot-'+_0x47d896+'-performance.json'));if(fs[_0x108871(0x112)](path[_0x108871(0x1a3)](configpath,'bot-'+_0x47d896+_0x108871(0x24b))))fs[_0x108871(0x1a4)](path[_0x108871(0x1a3)](configpath,'bot-'+_0x47d896+_0x108871(0x24b)));}catch(_0x3f4493){if(_0x3f4493)logger[_0x108871(0x1d0)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x3f4493);}config=getConfiguration(),io['to'](_0x108871(0x288))[_0x108871(0xfc)]('bots',config),broadcastToBots(_0x108871(0x21a),JSON['stringify'](config));}function toggleBot(_0x5398cb,_0x312c1c,_0x2bd424){const _0x3c1705=_0xcd5cf4;dbConfig[_0x3c1705(0x172)](_0x3c1705(0x21a))[_0x3c1705(0x234)]({'botID':_0x5398cb})[_0x3c1705(0xa9)]({'status':_0x312c1c})[_0x3c1705(0xa9)]({'live':_0x2bd424})['write']();if(_0x312c1c==_0x3c1705(0x28d)||_0x312c1c=='new')logger[_0x3c1705(0x1d0)](_0x3c1705(0xcb)+_0x5398cb),startBot([_0x5398cb,userID],{'cwd':bbpath},function(_0x3145a5){if(_0x3145a5)logger['full'](_0x3145a5);});else(_0x312c1c==_0x3c1705(0x96)||_0x312c1c==_0x3c1705(0x189))&&(logger[_0x3c1705(0x1d0)]('Disabled\x20Bot\x20'+_0x5398cb),stopBot(_0x5398cb));config=getConfiguration(),io['to'](_0x3c1705(0x288))['emit']('bots',config),broadcastToBots(_0x3c1705(0x21a),JSON['stringify'](config));}function toggleStatus(_0x3f7e98){const _0x20c8b9=_0xcd5cf4;let _0x48df79=dbConfig['get']('bots')[_0x20c8b9(0x234)]({'botID':_0x3f7e98})[_0x20c8b9(0x27f)](),_0x3a30da;if(_0x48df79[_0x20c8b9(0x148)]===_0x20c8b9(0x28d))_0x3a30da=_0x20c8b9(0x96);else{if(_0x48df79[_0x20c8b9(0x148)]===_0x20c8b9(0x1f8))_0x3a30da='new-disabled';else{if(_0x48df79[_0x20c8b9(0x148)]===_0x20c8b9(0x189))_0x3a30da=_0x20c8b9(0x1f8);else{if(_0x48df79['status']==='disabled')_0x3a30da='enabled';}}}return _0x3a30da;}function updateStatus(_0x269971,_0x5efe47){const _0x123628=_0xcd5cf4;dbConfig[_0x123628(0x172)](_0x123628(0x21a))['find']({'botID':_0x269971})[_0x123628(0xa9)]({'status':_0x5efe47})[_0x123628(0x1a9)](),config=getConfiguration(),io['to'](_0x123628(0x288))[_0x123628(0xfc)](_0x123628(0x21a),config),broadcastToBots(_0x123628(0x21a),JSON[_0x123628(0x20a)](config));}function _0x404e(_0x12292b,_0x2679f0){const _0x258af5=_0x3fea();return _0x404e=function(_0x58644c,_0x22f037){_0x58644c=_0x58644c-0x83;let _0x3fea09=_0x258af5[_0x58644c];return _0x3fea09;},_0x404e(_0x12292b,_0x2679f0);}function updateLive(_0x4b586e,_0x391f0c){const _0x40827e=_0xcd5cf4;dbConfig[_0x40827e(0x172)]('bots')[_0x40827e(0x234)]({'botID':_0x4b586e})[_0x40827e(0xa9)]({'live':_0x391f0c})[_0x40827e(0x1a9)](),config=getConfiguration(),io['to'](_0x40827e(0x288))['emit'](_0x40827e(0x21a),config),broadcastToBots(_0x40827e(0x21a),JSON['stringify'](config));}function updateBotName(_0x1d4316,_0x1122f9){const _0x2fa746=_0xcd5cf4;dbConfig['get'](_0x2fa746(0x21a))[_0x2fa746(0x234)]({'botID':_0x1d4316})[_0x2fa746(0xa9)]({'botname':_0x1122f9})[_0x2fa746(0x1a9)](),config=getConfiguration(),io['to'](_0x2fa746(0x288))['emit'](_0x2fa746(0x21a),config),broadcastToBots(_0x2fa746(0x21a),JSON[_0x2fa746(0x20a)](config));}function updateBotManager(){const _0x509d75=_0xcd5cf4;config=getConfiguration(),io['to'](_0x509d75(0x288))['emit'](_0x509d75(0x21a),config),broadcastToBots(_0x509d75(0x21a),JSON[_0x509d75(0x20a)](config));}function toggleBotMode(_0x2f8f41){const _0x2abaa5=_0xcd5cf4;if(pid[_0x2f8f41])pid[_0x2f8f41][_0x2abaa5(0x190)]({'function':_0x2abaa5(0xfb),'args':null});else{const _0x9ce8aa=configpath+_0x2abaa5(0x10e)+_0x2f8f41+_0x2abaa5(0x16d),_0xc94059=fs[_0x2abaa5(0x1c7)](_0x9ce8aa),_0x546aae=JSON[_0x2abaa5(0x90)](_0xc94059),_0x2fc1c7=_0x546aae[_0x2abaa5(0xd1)][0x0][_0x2abaa5(0xdd)];_0x546aae[_0x2abaa5(0xd1)][0x0][_0x2abaa5(0xdd)]=!_0x2fc1c7;const _0x39879a=JSON['stringify'](_0x546aae,null,0x2);fs[_0x2abaa5(0x195)](_0x9ce8aa,_0x39879a),config=getConfiguration(),io['to']('botmanager')[_0x2abaa5(0xfc)](_0x2abaa5(0x21a),config),broadcastToBots(_0x2abaa5(0x21a),JSON[_0x2abaa5(0x20a)](config));}}function validateTelegram(_0x278c78){const _0x53561a=_0xcd5cf4;if(_0x278c78[_0x53561a(0x1a0)][_0x53561a(0x224)]!=settings['telegramUsername']&&'@'+_0x278c78[_0x53561a(0x1a0)][_0x53561a(0x224)]!=settings['telegramUsername']||_0x278c78[_0x53561a(0x102)]['id']!=settings[_0x53561a(0xf4)])return sendTelegram(_0x278c78[_0x53561a(0x102)]['id'],_0x53561a(0x217),{'parse_mode':_0x53561a(0x9b)}),![];return!![];}async function initTelegram(){const _0x330378=_0xcd5cf4;tgBot&&(await tgBot[_0x330378(0x203)](),await sleep(0x7d0));tgBot=new Telegraf(settings['telegramToken']);let _0x345460=_0x330378(0x196);_0x345460+='\x0a',_0x345460+=_0x330378(0x16f),_0x345460+=_0x330378(0x215),_0x345460+=_0x330378(0x109),_0x345460+=_0x330378(0x237),_0x345460+='/on\x20-\x20start\x20bot(s)\x0a',_0x345460+=_0x330378(0x97),_0x345460+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x345460+=_0x330378(0x218),_0x345460+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x345460+=_0x330378(0x188),_0x345460+=_0x330378(0x125),_0x345460+=_0x330378(0x1ce),_0x345460+=_0x330378(0x1b6),_0x345460+=_0x330378(0x1a5),_0x345460+=_0x330378(0x106),_0x345460+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x2e1c9f=_0x330378(0xce);_0x2e1c9f+='\x0a',_0x2e1c9f+=_0x345460,tgBot['catch']((_0xeb8733,_0x269b91)=>{const _0x540121=_0x330378;logger['simple'](getTimeStamp()+_0x540121(0x236)),logger[_0x540121(0x1b1)](_0x540121(0x23e),_0xeb8733);}),tgBot[_0x330378(0x147)](async(_0x4b047a,_0x153a0d)=>{const _0x5af868=_0x330378;if(settings['telegramChatId']||_0x4b047a['update'][_0x5af868(0x268)]['text']!=_0x5af868(0x269)){if(!validateTelegram(_0x4b047a))return;}_0x153a0d();}),tgBot[_0x330378(0x19b)](_0x330378(0x178),async _0x93de1d=>{const _0x47e324=_0x330378;if(_0x93de1d[_0x47e324(0x1a0)][_0x47e324(0x224)]==settings[_0x47e324(0x166)]||'@'+_0x93de1d[_0x47e324(0x1a0)]['username']==settings[_0x47e324(0x166)]){if(!settings['telegramChatId'])updateSetting(_0x47e324(0xf4),_0x93de1d[_0x47e324(0x102)]['id']);else{if(!validateTelegram(_0x93de1d))return;}}else{if(!validateTelegram(_0x93de1d))return;}updateSetting(_0x47e324(0x210),!![]),await sendTelegram(_0x93de1d[_0x47e324(0x102)]['id'],_0x2e1c9f);}),tgBot[_0x330378(0x19b)](_0x330378(0x179),async _0x548a9a=>{const _0x26e4b0=_0x330378;updateSetting(_0x26e4b0(0x210),!![]),await sendTelegram(_0x548a9a[_0x26e4b0(0x102)]['id'],'Notifications\x20enabled');}),tgBot[_0x330378(0x19b)](_0x330378(0x27b),async _0x275ab3=>{const _0x2f2f4d=_0x330378;await sendTelegram(_0x275ab3[_0x2f2f4d(0x102)]['id'],'Notifications\x20disabled'),updateSetting('telegramEnabled',![]);}),tgBot['command'](_0x330378(0x13d),async _0x552ffb=>{const _0x191057=_0x330378,_0x43ed60=Markup[_0x191057(0x17e)]([Markup['button'][_0x191057(0x22c)](_0x191057(0xb6),_0x191057(0x153)),Markup[_0x191057(0x8a)]['callback'](_0x191057(0x100),'config_alerts'),Markup[_0x191057(0x8a)][_0x191057(0x22c)]('All',_0x191057(0x266))]);_0x552ffb[_0x191057(0x9e)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x43ed60);}),tgBot[_0x330378(0x235)](_0x330378(0x153),async _0x1351db=>{const _0xe28b5c=_0x330378;_0x1351db['editMessageReplyMarkup'](),updateSetting(_0xe28b5c(0x175),_0xe28b5c(0x14b)),updateSetting(_0xe28b5c(0x210),!![]),await sendTelegram(_0x1351db['chat']['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot['action'](_0x330378(0x127),async _0x1e1480=>{const _0x2e6329=_0x330378;_0x1e1480[_0x2e6329(0x287)](),updateSetting(_0x2e6329(0x175),_0x2e6329(0xdf)),updateSetting(_0x2e6329(0x210),!![]),await sendTelegram(_0x1e1480[_0x2e6329(0x102)]['id'],_0x2e6329(0x177));}),tgBot[_0x330378(0x235)](_0x330378(0x266),async _0x51bbbb=>{const _0x41640b=_0x330378;_0x51bbbb[_0x41640b(0x287)](),updateSetting('telegramEvents','all'),updateSetting(_0x41640b(0x210),!![]),await sendTelegram(_0x51bbbb[_0x41640b(0x102)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot['command'](_0x330378(0x148),async _0x1c7ae9=>{const _0x5f2501=_0x330378,_0x233a37=getBotsWithMode();let _0x488b3e=_0x5f2501(0x99);config[_0x5f2501(0x26e)](_0x26bf80=>{const _0x1f10b1=_0x5f2501,_0x100fae=_0x233a37[_0x1f10b1(0x234)](_0x2f85c4=>_0x2f85c4[_0x1f10b1(0xed)]==_0x26bf80[_0x1f10b1(0xed)])['mode'];_0x488b3e+='Bot\x20'+_0x26bf80[_0x1f10b1(0xed)]+':\x20'+_0x26bf80[_0x1f10b1(0x148)]+_0x1f10b1(0x207)+_0x100fae+'\x20|\x20'+_0x26bf80[_0x1f10b1(0x1ed)]+'\x0a';}),_0x488b3e+='\x0a',_0x488b3e+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x488b3e+=!settings[_0x5f2501(0x210)]?_0x5f2501(0xab):'Notifications\x20enabled\x0a',_0x488b3e+=settings[_0x5f2501(0x210)]?settings['telegramEvents']=='all'?_0x5f2501(0x239):'Notifications\x20types:\x20'+settings['telegramEvents']+_0x5f2501(0xa4):'',await sendTelegram(_0x1c7ae9[_0x5f2501(0x102)]['id'],_0x488b3e,{'parse_mode':'HTML'});}),tgBot[_0x330378(0x19b)]('restart',async _0x45c26a=>{const _0x228c03=_0x330378,_0x1f123e=getEnabledBots();if(_0x1f123e[_0x228c03(0x193)]==0x0)await sendTelegram(_0x45c26a['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1f123e['length']>0x1)_0x1f123e[_0x228c03(0xd5)]({'botID':_0x228c03(0xd8)});let _0x2e8960=[],_0x2d3456=[];const _0x997f0a=_0x1f123e[_0x228c03(0x193)]%0x4==0x0||_0x1f123e[_0x228c03(0x193)]%0x4==0x3||_0x1f123e[_0x228c03(0x193)]%0x3==0x1?0x4:0x3;let _0x5d8432=0x0;_0x1f123e[_0x228c03(0x26e)]((_0x238aad,_0x2a638b)=>{const _0x4ed5aa=_0x228c03;if(_0x2a638b%_0x997f0a==0x0)_0x2d3456=[];_0x2d3456[_0x4ed5aa(0xd5)](Markup[_0x4ed5aa(0x8a)][_0x4ed5aa(0x22c)](_0x238aad['botID']==_0x4ed5aa(0xd8)?_0x4ed5aa(0x209):_0x4ed5aa(0x12a)+_0x238aad[_0x4ed5aa(0xed)],_0x4ed5aa(0xe4)+_0x238aad[_0x4ed5aa(0xed)])),_0x2a638b%_0x997f0a==0x0&&(_0x2e8960[_0x5d8432]=_0x2d3456,_0x5d8432++);});const _0x44bb42=Markup[_0x228c03(0x17e)](_0x2e8960);_0x45c26a['reply'](_0x228c03(0x169),_0x44bb42);}}),tgBot[_0x330378(0x235)](/restart_(.+)/,async _0x26bdf0=>{const _0x1395ca=_0x330378,_0x315197=_0x26bdf0[_0x1395ca(0x285)][0x1];_0x26bdf0[_0x1395ca(0x287)](),_0x315197==_0x1395ca(0xd8)?config[_0x1395ca(0x26e)](_0x2babc1=>{const _0x388984=_0x1395ca;restartBot(_0x2babc1[_0x388984(0xed)]);}):restartBot(_0x315197);}),tgBot[_0x330378(0x19b)]('on',async _0x5c6a93=>{const _0x25fe46=_0x330378,_0x2e3c78=getDisabledBots();if(_0x2e3c78[_0x25fe46(0x193)]==0x0)await sendTelegram(_0x5c6a93['chat']['id'],_0x25fe46(0xa0));else{if(_0x2e3c78['length']>0x1)_0x2e3c78[_0x25fe46(0xd5)]({'botID':_0x25fe46(0xd8)});let _0x248282=[],_0x2ed5bf=[];const _0x12ae51=_0x2e3c78[_0x25fe46(0x193)]%0x4==0x0||_0x2e3c78[_0x25fe46(0x193)]%0x4==0x3||_0x2e3c78[_0x25fe46(0x193)]%0x3==0x1?0x4:0x3;let _0x5e1d1c=0x0;_0x2e3c78[_0x25fe46(0x26e)]((_0x43155d,_0x117b63)=>{const _0x70b385=_0x25fe46;if(_0x117b63%_0x12ae51==0x0)_0x2ed5bf=[];_0x2ed5bf['push'](Markup[_0x70b385(0x8a)]['callback'](_0x43155d[_0x70b385(0xed)]=='all'?_0x70b385(0x209):_0x70b385(0x12a)+_0x43155d[_0x70b385(0xed)],_0x70b385(0x119)+_0x43155d[_0x70b385(0xed)])),_0x117b63%_0x12ae51==0x0&&(_0x248282[_0x5e1d1c]=_0x2ed5bf,_0x5e1d1c++);});const _0xf594ff=Markup['inlineKeyboard'](_0x248282);_0x5c6a93[_0x25fe46(0x9e)](_0x25fe46(0x187),_0xf594ff);}}),tgBot[_0x330378(0x235)](/on_(.+)/,async _0x372ae9=>{const _0x2d93f5=_0x330378,_0x4c2a56=_0x372ae9[_0x2d93f5(0x285)][0x1];_0x372ae9[_0x2d93f5(0x287)]();if(_0x4c2a56==_0x2d93f5(0xd8)){const _0x4c7d43=getDisabledBots();await sendTelegram(_0x372ae9[_0x2d93f5(0x102)]['id'],_0x2d93f5(0xf8)),_0x4c7d43['forEach'](_0x1ee73d=>{const _0x3fa7b4=_0x2d93f5;if(_0x1ee73d['botID']!=_0x3fa7b4(0xd8))toggleBot(_0x1ee73d['botID'],toggleStatus(_0x1ee73d[_0x3fa7b4(0xed)]),_0x3fa7b4(0xe5));});}else await sendTelegram(_0x372ae9[_0x2d93f5(0x102)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x4c2a56),toggleBot(_0x4c2a56,toggleStatus(_0x4c2a56),'stopped');}),tgBot[_0x330378(0x19b)](_0x330378(0x299),async _0xe66bf6=>{const _0x10dda6=_0x330378,_0x5de666=getEnabledBots();if(_0x5de666['length']==0x0)await sendTelegram(_0xe66bf6[_0x10dda6(0x102)]['id'],_0x10dda6(0x202));else{if(_0x5de666[_0x10dda6(0x193)]>0x1)_0x5de666['push']({'botID':_0x10dda6(0xd8)});let _0x5db321=[],_0x246e6e=[];const _0x4e4a47=_0x5de666[_0x10dda6(0x193)]%0x4==0x0||_0x5de666[_0x10dda6(0x193)]%0x4==0x3||_0x5de666[_0x10dda6(0x193)]%0x3==0x1?0x4:0x3;let _0x1296d3=0x0;_0x5de666[_0x10dda6(0x26e)]((_0x13dd65,_0x522721)=>{const _0x3dc16e=_0x10dda6;if(_0x522721%_0x4e4a47==0x0)_0x246e6e=[];_0x246e6e[_0x3dc16e(0xd5)](Markup[_0x3dc16e(0x8a)][_0x3dc16e(0x22c)](_0x13dd65[_0x3dc16e(0xed)]==_0x3dc16e(0xd8)?'All\x20bots':'Bot\x20'+_0x13dd65[_0x3dc16e(0xed)],_0x3dc16e(0x10a)+_0x13dd65['botID'])),_0x522721%_0x4e4a47==0x0&&(_0x5db321[_0x1296d3]=_0x246e6e,_0x1296d3++);});const _0x1362fe=Markup[_0x10dda6(0x17e)](_0x5db321);_0xe66bf6[_0x10dda6(0x9e)](_0x10dda6(0x138),_0x1362fe);}}),tgBot[_0x330378(0x235)](/off_(.+)/,async _0x14608b=>{const _0x19ce6c=_0x330378,_0x20f082=_0x14608b[_0x19ce6c(0x285)][0x1];_0x14608b['editMessageReplyMarkup']();if(_0x20f082==_0x19ce6c(0xd8)){const _0x3f2319=getEnabledBots();await sendTelegram(_0x14608b[_0x19ce6c(0x102)]['id'],_0x19ce6c(0xaf)),_0x3f2319[_0x19ce6c(0x26e)](_0x1b7d7e=>{const _0x1ce010=_0x19ce6c;if(_0x1b7d7e['botID']!='all')toggleBot(_0x1b7d7e['botID'],toggleStatus(_0x1b7d7e[_0x1ce010(0xed)]),'stopped');});}else await sendTelegram(_0x14608b[_0x19ce6c(0x102)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x20f082),toggleBot(_0x20f082,toggleStatus(_0x20f082),_0x19ce6c(0xe5));}),tgBot[_0x330378(0x19b)]('metrics',async _0x480c45=>{const _0x18e02b=_0x330378,_0x4c2a40=getEnabledBots();if(_0x4c2a40[_0x18e02b(0x193)]==0x0)await sendTelegram(_0x480c45[_0x18e02b(0x102)]['id'],_0x18e02b(0x202));else{if(_0x4c2a40[_0x18e02b(0x193)]>0x1){let _0xe439cb=[],_0x45d12e=[];const _0x20a373=_0x4c2a40['length']%0x4==0x0||_0x4c2a40['length']%0x4==0x3||_0x4c2a40[_0x18e02b(0x193)]%0x3==0x1?0x4:0x3;let _0x5e7efc=0x0;_0x4c2a40[_0x18e02b(0x26e)]((_0x59de40,_0x2e0c06)=>{const _0x585d5f=_0x18e02b;if(_0x2e0c06%_0x20a373==0x0)_0x45d12e=[];_0x45d12e[_0x585d5f(0xd5)](Markup[_0x585d5f(0x8a)][_0x585d5f(0x22c)](_0x585d5f(0x12a)+_0x59de40[_0x585d5f(0xed)],_0x585d5f(0x1aa)+_0x59de40['botID'])),_0x2e0c06%_0x20a373==0x0&&(_0xe439cb[_0x5e7efc]=_0x45d12e,_0x5e7efc++);});const _0x5d81f1=Markup[_0x18e02b(0x17e)](_0xe439cb);_0x480c45[_0x18e02b(0x9e)](_0x18e02b(0xd0),_0x5d81f1);}else{const _0x440864=_0x4c2a40[0x0][_0x18e02b(0xed)];if(pid[_0x440864])pid[_0x440864][_0x18e02b(0x190)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x330378(0x235)](/metrics_(.+)/,async _0x373a43=>{const _0x3b8b04=_0x330378,_0x2a98a6=_0x373a43[_0x3b8b04(0x285)][0x1];_0x373a43[_0x3b8b04(0x287)]();if(pid[_0x2a98a6])pid[_0x2a98a6][_0x3b8b04(0x190)]({'function':_0x3b8b04(0x275),'args':null});}),tgBot[_0x330378(0x19b)](_0x330378(0x29b),async _0x42161e=>{const _0x313c18=_0x330378,_0xb273e7=getEnabledBots();if(_0xb273e7['length']==0x0)await sendTelegram(_0x42161e[_0x313c18(0x102)]['id'],_0x313c18(0x202));else{if(_0xb273e7['length']>0x1){let _0x21c420=[],_0x4b3182=[];const _0x359ddf=_0xb273e7['length']%0x4==0x0||_0xb273e7[_0x313c18(0x193)]%0x4==0x3||_0xb273e7[_0x313c18(0x193)]%0x3==0x1?0x4:0x3;let _0x23bdb3=0x0;_0xb273e7[_0x313c18(0x26e)]((_0x17700b,_0x2fa751)=>{const _0x2283b7=_0x313c18;if(_0x2fa751%_0x359ddf==0x0)_0x4b3182=[];_0x4b3182[_0x2283b7(0xd5)](Markup['button'][_0x2283b7(0x22c)](_0x2283b7(0x12a)+_0x17700b[_0x2283b7(0xed)],_0x2283b7(0x1d2)+_0x17700b[_0x2283b7(0xed)])),_0x2fa751%_0x359ddf==0x0&&(_0x21c420[_0x23bdb3]=_0x4b3182,_0x23bdb3++);});const _0x334462=Markup[_0x313c18(0x17e)](_0x21c420);_0x42161e[_0x313c18(0x9e)](_0x313c18(0xc2),_0x334462);}else{const _0x1f64c2=_0xb273e7[0x0]['botID'];if(pid[_0x1f64c2])pid[_0x1f64c2][_0x313c18(0x190)]({'function':_0x313c18(0x167),'args':null});}}}),tgBot[_0x330378(0x235)](/portfolio_(.+)/,async _0x27da79=>{const _0x510935=_0x330378,_0x1103b9=_0x27da79[_0x510935(0x285)][0x1];_0x27da79[_0x510935(0x287)]();if(pid[_0x1103b9])pid[_0x1103b9][_0x510935(0x190)]({'function':'sendPortfolioTelegram','args':null});}),tgBot['command'](_0x330378(0xda),async _0xaedd3b=>{const _0x3ed09c=_0x330378,_0x1bbaa8=_0x3ed09c(0xda);await zipFiles(_0x1bbaa8);const _0x326cce=zippath+(_0x1bbaa8+'.zip');_0xaedd3b[_0x3ed09c(0x197)]({'source':_0x326cce})[_0x3ed09c(0x293)](()=>{})[_0x3ed09c(0x140)](_0x2fabbd=>logger[_0x3ed09c(0x1b1)](_0x3ed09c(0xa5)+_0x1bbaa8+_0x3ed09c(0x225),_0x2fabbd));}),tgBot[_0x330378(0x19b)](_0x330378(0xbb),async _0x51f787=>{const _0x594e54=_0x330378,_0x3ab890=_0x594e54(0xbb);await backupConfigFiles(),await zipFiles(_0x3ab890);const _0x56f813=zippath+(_0x3ab890+_0x594e54(0xbf));_0x51f787[_0x594e54(0x197)]({'source':_0x56f813})[_0x594e54(0x293)](()=>{})[_0x594e54(0x140)](_0x1eb327=>logger[_0x594e54(0x1b1)](_0x594e54(0xa5)+_0x3ab890+_0x594e54(0x225),_0x1eb327));}),tgBot['command']('update',async _0x42ff0f=>{const _0x346b58=_0x330378;await getMessages();if(!updateAvailable)await sendTelegram(_0x42ff0f[_0x346b58(0x102)]['id'],_0x346b58(0xee));else{if(!validInstallation)await sendTelegram(_0x42ff0f['chat']['id'],_0x346b58(0x176));else{const _0xd57049=Markup[_0x346b58(0x17e)]([Markup[_0x346b58(0x8a)][_0x346b58(0x22c)](_0x346b58(0xfa),_0x346b58(0x22f)),Markup[_0x346b58(0x8a)][_0x346b58(0x22c)]('No',_0x346b58(0x149))]);_0x42ff0f['reply']('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0xd57049);}}}),tgBot[_0x330378(0x235)](/update_(.+)/,async _0x18c471=>{const _0x91a294=_0x330378,_0xe9173f=_0x18c471['match'][0x1];_0x18c471[_0x91a294(0x287)](),_0xe9173f==_0x91a294(0x144)&&(await sendTelegram(_0x18c471[_0x91a294(0x102)]['id'],_0x91a294(0x26d)),updateBB(_0x91a294(0x19a))),_0xe9173f=='no'&&await sendTelegram(_0x18c471['chat']['id'],'Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later');}),tgBot[_0x330378(0x19b)](_0x330378(0x1c4),async _0x2bd91d=>{const _0x392e9e=_0x330378;if(!validInstallation)await sendTelegram(_0x2bd91d[_0x392e9e(0x102)]['id'],_0x392e9e(0x1ad));else{const _0x2515f2=Markup[_0x392e9e(0x17e)]([Markup[_0x392e9e(0x8a)][_0x392e9e(0x22c)](_0x392e9e(0xfa),_0x392e9e(0x1da)),Markup[_0x392e9e(0x8a)]['callback']('No','reinstall_no')]);_0x2bd91d[_0x392e9e(0x9e)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x2515f2);}}),tgBot[_0x330378(0x235)](/reinstall_(.+)/,async _0x1099a4=>{const _0x419e54=_0x330378,_0x45af62=_0x1099a4[_0x419e54(0x285)][0x1];_0x1099a4[_0x419e54(0x287)](),_0x45af62==_0x419e54(0x144)&&(await sendTelegram(_0x1099a4[_0x419e54(0x102)]['id'],_0x419e54(0xb9)),updateBB(_0x419e54(0x1c4))),_0x45af62=='no'&&await sendTelegram(_0x1099a4['chat']['id'],_0x419e54(0x1c3));}),tgBot[_0x330378(0x19b)](_0x330378(0x9d),async _0x28aa07=>{const _0x1571ac=_0x330378,_0x2ad070=getBotsWithMode();if(_0x2ad070[_0x1571ac(0x193)]==0x0)await sendTelegram(_0x28aa07[_0x1571ac(0x102)]['id'],_0x1571ac(0x202));else{let _0x35533b=[],_0x51361e=[];const _0x2e460f=0x2;let _0x14e8c7=0x0;_0x2ad070[_0x1571ac(0x26e)]((_0x5f58ba,_0x3fb84c)=>{const _0x1683c5=_0x1571ac;if(_0x3fb84c%_0x2e460f==0x0)_0x51361e=[];_0x51361e[_0x1683c5(0xd5)](Markup[_0x1683c5(0x8a)][_0x1683c5(0x22c)](_0x1683c5(0x12a)+_0x5f58ba[_0x1683c5(0xed)]+'\x20('+_0x5f58ba['mode']+')',_0x1683c5(0x9c)+_0x5f58ba[_0x1683c5(0xed)])),_0x3fb84c%_0x2e460f==0x0&&(_0x35533b[_0x14e8c7]=_0x51361e,_0x14e8c7++);});const _0x324b32=Markup[_0x1571ac(0x17e)](_0x35533b);_0x28aa07[_0x1571ac(0x9e)](_0x1571ac(0xfd),_0x324b32);}}),tgBot[_0x330378(0x235)](/toggle_(.+)/,async _0x334283=>{const _0xed4ff=_0x330378,_0x276060=_0x334283[_0xed4ff(0x285)][0x1];_0x334283[_0xed4ff(0x287)]();const _0x2af197=getBotsWithMode(),_0x3b65ac=_0x2af197['find'](_0x454a98=>_0x454a98[_0xed4ff(0xed)]==_0x276060),_0x2ee923=_0x3b65ac[_0xed4ff(0x249)]==_0xed4ff(0x84)?_0xed4ff(0x1e2):_0xed4ff(0x84);await sendTelegram(_0x334283[_0xed4ff(0x102)]['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x276060+_0xed4ff(0xd2)+_0x2ee923+_0xed4ff(0xe1)),toggleBotMode(_0x276060);}),tgBot['command']('names',async _0xbf9977=>{const _0x575bf8=_0x330378;let _0x5d8bce='';config['forEach'](_0x34c455=>{const _0x45872e=_0x404e;_0x5d8bce+=_0x45872e(0x12a)+_0x34c455[_0x45872e(0xed)]+':\x20'+_0x34c455[_0x45872e(0x19f)]+'\x0a';}),await sendTelegram(_0xbf9977[_0x575bf8(0x102)]['id'],_0x5d8bce,{'parse_mode':'HTML'});}),tgBot[_0x330378(0x19b)](_0x330378(0x116),async _0x4df729=>{await sendTelegram(_0x4df729['chat']['id'],_0x345460);}),process['once']('SIGINT',()=>tgBot[_0x330378(0x203)]('SIGINT')),process['once'](_0x330378(0x257),()=>tgBot[_0x330378(0x203)](_0x330378(0x257))),tgBot[_0x330378(0xf7)]();}function disableTelegram(){const _0x130162=_0xcd5cf4;tgBot&&tgBot[_0x130162(0x203)]();}async function sendTelegram(_0x57ad8b,_0x3bc15c,_0x2a87dc){const _0x1c4d3e=_0xcd5cf4;_0x2a87dc={..._0x2a87dc,'disable_web_page_preview':!![]};try{await tgBot[_0x1c4d3e(0x1e9)]['sendMessage'](_0x57ad8b,_0x3bc15c,_0x2a87dc);}catch(_0x4b207e){logger['debug']('Telegram\x20error:',_0x4b207e);}}async function sendTelegramBot(_0x5a3704,_0x55b338){const _0x12c457=_0xcd5cf4;if(settings[_0x12c457(0x210)]){if(settings['telegramEvents']=='all'||(_0x55b338[_0x12c457(0x11d)]==_0x12c457(0x29a)||_0x55b338[_0x12c457(0x11d)]==_0x12c457(0x1c6)||_0x55b338['type']==_0x12c457(0xe6))&&settings['telegramEvents']==_0x12c457(0xdf)||_0x55b338['type']=='order'&&settings[_0x12c457(0x175)]==_0x12c457(0x14b)){if(tgBot&&settings['telegramChatId']){if(_0x55b338[_0x12c457(0xea)])await sendTelegram(settings[_0x12c457(0xf4)],_0x55b338[_0x12c457(0x19f)]+_0x12c457(0x1f9)+_0x55b338[_0x12c457(0xc0)]);else await sendTelegram(settings['telegramChatId'],'Bot\x20'+_0x5a3704+'\x20>\x20'+_0x55b338[_0x12c457(0xc0)]);}}}}async function sendTelegramMsg(_0x40b1fc,_0x2557e5=_0xcd5cf4(0x9b)){const _0x16adca=_0xcd5cf4;return settings[_0x16adca(0x210)]&&tgBot&&settings[_0x16adca(0xf4)]?(await sendTelegram(settings[_0x16adca(0xf4)],_0x40b1fc,{'parse_mode':_0x2557e5}),!![]):![];}function getDeviceWithIp(_0x91402e){const _0x2537fd=_0xcd5cf4;return devices[_0x2537fd(0x234)](_0x4744b5=>_0x4744b5['ip']===_0x91402e);}async function temporaryAccess2FA(_0x42bebf,_0x3b518){const _0x560dee=_0xcd5cf4;let _0x21e7fa=new Date(),_0x5db476=![];if(lastIpApproval){if(_0x21e7fa-lastIpApproval<0x1388)_0x5db476=!![];}lastIpApproval=new Date();if(_0x5db476)return;if(tgBot&&settings[_0x560dee(0xf4)]){const _0x434116=uuidRandom();tmpStorage[_0x434116]={'uuid':_0x42bebf,'externalip':_0x3b518};const _0x7cfb34=Markup['inlineKeyboard']([Markup[_0x560dee(0x8a)][_0x560dee(0x22c)]('5\x20min',_0x560dee(0x13f)+_0x434116),Markup[_0x560dee(0x8a)]['callback']('15\x20min',_0x560dee(0x24a)+_0x434116),Markup[_0x560dee(0x8a)]['callback'](_0x560dee(0xae),'tempaccess_30_'+_0x434116),Markup['button'][_0x560dee(0x22c)]('reject',_0x560dee(0x1df)+_0x434116)]);await sendTelegram(settings[_0x560dee(0xf4)],_0x560dee(0x157)+normalizeIP(_0x3b518)[_0x560dee(0x1d5)]+'\x20?',_0x7cfb34),tgBot[_0x560dee(0x235)](/tempaccess_(.+)_(.+)/,async _0x4125ad=>{const _0x35ca47=_0x560dee,_0x167ec2=_0x4125ad[_0x35ca47(0x285)][0x1],_0x92382a=_0x4125ad[_0x35ca47(0x285)][0x2],{uuid:_0x168067,externalip:_0x57d02c}=tmpStorage[_0x92382a];delete tmpStorage[_0x92382a],_0x4125ad[_0x35ca47(0x287)](),devices[_0x168067][_0x35ca47(0x158)]={'clientip':_0x57d02c,'timestamp':new Date()[_0x35ca47(0x292)](),'expiry':_0x167ec2},_0x167ec2!='reject'?(await sendTelegram(_0x4125ad[_0x35ca47(0x102)]['id'],'Access\x20enabled\x20for\x20'+_0x167ec2+_0x35ca47(0x12c),{'parse_mode':_0x35ca47(0x9b)}),io['to'](_0x168067)[_0x35ca47(0xfc)](_0x35ca47(0x148),{'access':{'allow':![],'reason':_0x35ca47(0x21f),'token':null}})):(await sendTelegram(_0x4125ad['chat']['id'],_0x35ca47(0x128)),io['to'](_0x168067)[_0x35ca47(0xfc)]('status',{'access':{'allow':![],'reason':_0x35ca47(0x126),'token':null}}));});}}async function loginAccess2FA(_0x1d9966,_0x11d64d){const _0x144402=_0xcd5cf4;if(tgBot&&settings['telegramChatId']){const _0x47ba3a=uuidRandom();tmpStorage[_0x47ba3a]={'uuid':_0x1d9966,'externalip':_0x11d64d};const _0x3d966d=Markup[_0x144402(0x17e)]([Markup[_0x144402(0x8a)][_0x144402(0x22c)](_0x144402(0x20f),'login2fa_'+loginExpiry+'_'+_0x47ba3a),Markup['button'][_0x144402(0x22c)](_0x144402(0xca),_0x144402(0x1fc)+_0x47ba3a)]);await sendTelegram(settings['telegramChatId'],_0x144402(0x214)+normalizeIP(_0x11d64d)['show']+'\x20?',_0x3d966d),tgBot[_0x144402(0x235)](/login2fa_(.+)_(.+)/,async _0x2e79f7=>{const _0x19ad81=_0x144402,_0x32196d=_0x2e79f7[_0x19ad81(0x285)][0x1],_0x146451=_0x2e79f7[_0x19ad81(0x285)][0x2],{uuid:_0x3e1771,externalip:_0x4258e6}=tmpStorage[_0x146451];delete tmpStorage[_0x146451],_0x2e79f7[_0x19ad81(0x287)](),devices[_0x3e1771]['telegram2FaApproval']={'clientip':_0x4258e6,'timestamp':new Date()[_0x19ad81(0x292)](),'expiry':_0x32196d},_0x32196d!='reject'?(await sendTelegram(_0x2e79f7['chat']['id'],'Login\x20accepted',{'parse_mode':_0x19ad81(0x9b)}),io['to'](_0x3e1771)[_0x19ad81(0xfc)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x2e79f7['chat']['id'],_0x19ad81(0x110)),io['to'](_0x3e1771)[_0x19ad81(0xfc)](_0x19ad81(0x148),{'access':{'allow':![],'reason':_0x19ad81(0x151),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x16b9ad=_0xcd5cf4;return dbConfig['get']('bots')[_0x16b9ad(0x200)]('botID')[_0x16b9ad(0x265)]({'status':_0x16b9ad(0x28d)})[_0x16b9ad(0x27f)]()||[];}function getDisabledBots(){const _0x129d14=_0xcd5cf4;return dbConfig[_0x129d14(0x172)](_0x129d14(0x21a))[_0x129d14(0x200)]('botID')[_0x129d14(0x265)]({'status':'disabled'})[_0x129d14(0x27f)]()||[];}function getBotAttributes(_0x40d4e2){const _0x5a17fa=_0xcd5cf4;let _0x5a52c5={};const _0x27f065=configpath+_0x5a17fa(0x10e)+_0x40d4e2+_0x5a17fa(0x16d),_0x4bce0d=fs[_0x5a17fa(0x112)](_0x27f065);if(_0x4bce0d){const _0x50a495=fs[_0x5a17fa(0x1c7)](_0x27f065);try{const _0x2d445a=JSON[_0x5a17fa(0x90)](_0x50a495),_0xf1548c=_0x2d445a?_0x2d445a[_0x5a17fa(0xd1)][0x0][_0x5a17fa(0xdd)]:![];_0x5a52c5[_0x5a17fa(0x249)]=_0xf1548c?_0x5a17fa(0x84):_0x5a17fa(0x1e2),_0x5a52c5['botname']=_0x2d445a?_0x2d445a['bot'][0x0][_0x5a17fa(0x19f)]:'Bot\x20'+_0x40d4e2;}catch(_0x23aa96){_0x5a52c5[_0x5a17fa(0x249)]=_0x5a17fa(0x1e2),_0x5a52c5[_0x5a17fa(0x19f)]=_0x5a17fa(0x12a)+_0x40d4e2;}}else _0x5a52c5['mode']='manual',_0x5a52c5[_0x5a17fa(0x19f)]=_0x5a17fa(0x12a)+_0x40d4e2;return _0x5a52c5;}function getBotsWithMode(){const _0x1b3c87=_0xcd5cf4,_0x6826e1=dbConfig[_0x1b3c87(0x172)]('bots')[_0x1b3c87(0x200)](_0x1b3c87(0xed))[_0x1b3c87(0x27f)]()||[];return _0x6826e1[_0x1b3c87(0x26e)](_0x4baaed=>{const _0x58afb2=_0x1b3c87;let _0x42b854=getBotAttributes(_0x4baaed['botID']);_0x4baaed[_0x58afb2(0x249)]=_0x42b854['mode'];}),_0x6826e1;}function getBotExchanges(){const _0x498378=_0xcd5cf4;let _0x37dee1=[];const _0x252e56=dbConfig[_0x498378(0x172)]('bots')['sortBy']('botID')[_0x498378(0x27f)]()||[];_0x252e56['forEach'](_0xa3bb20=>{const _0x20c704=_0x498378;if(_0xa3bb20[_0x20c704(0x148)]==_0x20c704(0x28d)){const _0x4456dd=configpath+_0x20c704(0x10e)+_0xa3bb20[_0x20c704(0xed)]+_0x20c704(0x16d),_0x1334bc=fs['existsSync'](_0x4456dd);let _0x504de8;if(_0x1334bc){const _0x1f1f1a=fs[_0x20c704(0x1c7)](_0x4456dd);try{const _0x588a47=JSON[_0x20c704(0x90)](_0x1f1f1a);_0x504de8=_0x588a47?_0x588a47[_0x20c704(0xd1)][0x0][_0x20c704(0xb7)]:null;}catch(_0x123a32){}}if(_0x504de8)_0x37dee1[_0x20c704(0xd5)](_0x504de8);}});const _0x1004a6=[...new Set(_0x37dee1)][_0x498378(0x117)]();return _0x1004a6;}async function initUser(){const _0xe0aab0=_0xcd5cf4;if(!settings[_0xe0aab0(0xd9)]){const _0x5a661c=uuidRandom();mixpanel[_0xe0aab0(0x1af)](_0x5a661c),updateSetting('userid',_0x5a661c);}}async function initSecure(){const _0x2fd4c5=_0xcd5cf4;let _0x4d7ee6=getSecure();if(!_0x4d7ee6['hasOwnProperty'](_0x2fd4c5(0x180))){let _0x344f22=await generateKeys();_0x4d7ee6['publicKey']=_0x344f22[_0x2fd4c5(0x15d)],_0x4d7ee6[_0x2fd4c5(0x1cf)]=_0x344f22['privateKey'],_0x4d7ee6[_0x2fd4c5(0x180)]=crypto[_0x2fd4c5(0x276)](0x20)['toString'](_0x2fd4c5(0x1b2));;storeSecure(_0x4d7ee6);}}function getSettings(){const _0xa8d1dc=_0xcd5cf4;return dbSettings[_0xa8d1dc(0x172)](_0xa8d1dc(0x104))[_0xa8d1dc(0x27f)]()||{};}function getSecure(){const _0x4376d4=_0xcd5cf4;return dbSecure[_0x4376d4(0x172)]('secure')[_0x4376d4(0x27f)]()||{};}function getBlacklist(){const _0x312d78=_0xcd5cf4;return dbSecure[_0x312d78(0x172)]('blacklist')[_0x312d78(0x27f)]()||[];}function broadcastToBots(_0x3688ca,_0x2a8cef){config['forEach'](_0x5c0b48=>{const _0x37792e=_0x404e;if(_0x5c0b48['status']==_0x37792e(0x28d)&&_0x5c0b48[_0x37792e(0x1ed)]=='running'||_0x5c0b48[_0x37792e(0x148)]==_0x37792e(0x1f8)&&_0x5c0b48[_0x37792e(0x1ed)]==_0x37792e(0xd4)){if(pid[_0x5c0b48[_0x37792e(0xed)]])pid[_0x5c0b48['botID']]['send']({[_0x3688ca]:_0x2a8cef});}});}async function storeSettings(_0x78949a,_0x50b7c1=![]){const _0x58faac=_0xcd5cf4;_0x78949a={...settings,..._0x78949a};if(_0x50b7c1&&_0x78949a[_0x58faac(0xb1)]!='************'&&_0x78949a[_0x58faac(0xb1)]!=_0x58faac(0x208)&&_0x78949a[_0x58faac(0xb1)]!=''){const _0x39b502=decryptRSA(secure['privateKey'],_0x78949a[_0x58faac(0xb1)])[_0x58faac(0x263)](_0x58faac(0x192))[0x0],_0xa3b745=bcrypt['hashSync'](_0x39b502,saltRounds);_0x78949a={..._0x78949a,'bbPassword':_0xa3b745};}if(_0x50b7c1&&_0x78949a['telegramToken']!='************'&&_0x78949a['telegramToken']!=_0x58faac(0x208)&&_0x78949a[_0x58faac(0x1cd)]!=''){const _0x28148d=decryptRSA(secure[_0x58faac(0x1cf)],_0x78949a[_0x58faac(0x1cd)])[_0x58faac(0x263)](_0x58faac(0x192))[0x0];_0x78949a={..._0x78949a,'telegramToken':_0x28148d};}if(_0x50b7c1&&_0x78949a[_0x58faac(0x21c)]!=_0x58faac(0x124)&&_0x78949a['marketcapApi']!=_0x58faac(0x208)&&_0x78949a[_0x58faac(0x21c)]!=''){const _0x88e744=decryptRSA(secure['privateKey'],_0x78949a['marketcapApi'])[_0x58faac(0x263)](_0x58faac(0x192))[0x0];_0x78949a={..._0x78949a,'marketcapApi':_0x88e744};}const _0x2a8777=_0x78949a[_0x58faac(0x1cd)]!=_0x58faac(0x124)&&_0x78949a[_0x58faac(0x1cd)]!=settings[_0x58faac(0x1cd)]||_0x78949a['telegramUsername']!=settings[_0x58faac(0x166)],_0x4ed7ee=_0x78949a['telegramToken']==''||_0x78949a[_0x58faac(0x166)]=='',_0x19c936=_0x78949a[_0x58faac(0x21c)]&&_0x78949a[_0x58faac(0x21c)]!=_0x58faac(0x124)&&_0x78949a[_0x58faac(0x21c)]!=settings[_0x58faac(0x21c)];_0x2a8777&&(_0x78949a[_0x58faac(0xf4)]=null,_0x78949a[_0x58faac(0x175)]=_0x58faac(0xd8));for(const [_0x2f5585,_0x1801f5]of Object['entries'](_0x78949a)){if(_0x2f5585==_0x58faac(0x1cd)&&_0x1801f5=='************'){_0x78949a['telegramToken']=settings[_0x58faac(0x1cd)];continue;};if(_0x2f5585==_0x58faac(0xb1)&&_0x1801f5=='************'){_0x78949a[_0x58faac(0xb1)]=settings[_0x58faac(0xb1)];continue;};if(_0x2f5585=='marketcapApi'&&_0x1801f5==_0x58faac(0x124)){_0x78949a[_0x58faac(0x21c)]=settings[_0x58faac(0x21c)];continue;};dbSettings[_0x58faac(0xd3)]('settings.'+_0x2f5585,_0x1801f5)[_0x58faac(0x1a9)]();}settings=_0x78949a,io['to'](_0x58faac(0x288))['emit'](_0x58faac(0x104),cleanSettings()),broadcastToBots(_0x58faac(0x1ca),settings['timeshift']),broadcastToBots(_0x58faac(0xf9),settings[_0x58faac(0xf9)]),broadcastToBots(_0x58faac(0x21c),settings[_0x58faac(0x21c)]);if(_0x2a8777&&!_0x4ed7ee)initTelegram();_0x2a8777&&_0x4ed7ee&&(updateSetting(_0x58faac(0xf4),null),disableTelegram()),getAllClients()[_0x58faac(0x26e)](_0x259844=>{const _0x8fc599=_0x58faac;getSocket(_0x259844['id'])[_0x8fc599(0xfc)](_0x8fc599(0x148),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x19c936&&(await sleep(0xbb8),testMarketcapApi(_0x78949a[_0x58faac(0x21c)]));}async function testMarketcapApi(_0x5a88f2){const _0x383dbc=_0xcd5cf4,_0x5534e2=[_0x383dbc(0x25b),_0x383dbc(0x1a6)];try{await axios[_0x383dbc(0x172)](_0x383dbc(0x1e3),{'headers':{'X-CMC_PRO_API_KEY':_0x5a88f2},'params':{'symbol':_0x5534e2[_0x383dbc(0x17d)]()}});}catch(_0x3b8335){_0x3b8335[_0x383dbc(0x17d)]()[_0x383dbc(0x1e5)](_0x383dbc(0xe0))?(io['to'](_0x383dbc(0x288))[_0x383dbc(0xfc)](_0x383dbc(0x1eb),_0x383dbc(0x132)),logger['full'](_0x383dbc(0x132))):(io['to'](_0x383dbc(0x288))[_0x383dbc(0xfc)](_0x383dbc(0x1eb),_0x383dbc(0x1c1)),logger['full'](_0x383dbc(0x1c1)),logger[_0x383dbc(0x1b1)](_0x383dbc(0x289),_0x3b8335[_0x383dbc(0x17d)]()+_0x383dbc(0x1f2)+_0x3b8335[_0x383dbc(0x133)]));return;}logger['debug'](_0x383dbc(0x1c5));}function updateSetting(_0x289f4d,_0x21d31c){const _0x25939d=_0xcd5cf4;dbSettings[_0x25939d(0xd3)](_0x25939d(0x18c)+_0x289f4d,_0x21d31c)['write'](),settings=getSettings(),io['to'](_0x25939d(0x288))[_0x25939d(0xfc)]('settings',cleanSettings());}function storeSecure(_0x5609b1){const _0x3c0534=_0xcd5cf4;dbSecure['get'](_0x3c0534(0x15c))[_0x3c0534(0xd5)](_0x5609b1)['write'](),secure=_0x5609b1;}function addBlacklist(_0x5cc61a){const _0x1a4d94=_0xcd5cf4;cleanBlacklist();let _0x3171d2;devices[_0x5cc61a][_0x1a4d94(0x158)]?_0x3171d2=Math[_0x1a4d94(0x1db)](devices[_0x5cc61a][_0x1a4d94(0x158)][_0x1a4d94(0x11c)],loginExpiry):_0x3171d2=loginExpiry,dbSecure[_0x1a4d94(0x172)]('blacklist')['push']({'expiry':new Date()['getTime']()+_0x3171d2*0x3c*0x3e8,'token':devices[_0x5cc61a]['access'][_0x1a4d94(0x233)]})[_0x1a4d94(0x1a9)](),blacklist=dbSecure[_0x1a4d94(0x172)](_0x1a4d94(0xc4))[_0x1a4d94(0x27f)]();}function cleanBlacklist(){const _0x205aa4=_0xcd5cf4;let _0x253922=dbSecure[_0x205aa4(0x172)](_0x205aa4(0xc4))[_0x205aa4(0x290)]()[_0x205aa4(0x27f)](),_0x423b7d=new Date()[_0x205aa4(0x292)]();_0x253922[_0x205aa4(0x26e)](_0x383989=>{const _0x5ace74=_0x205aa4;_0x383989[_0x5ace74(0x11c)]<_0x423b7d&&dbSecure[_0x5ace74(0x172)](_0x5ace74(0xc4))[_0x5ace74(0x83)]({'expiry':_0x383989['expiry']})[_0x5ace74(0x1a9)]();});}function _0x3fea(){const _0x45c4ad=['logs','create','exit','headless','store','alerts','status\x20code\x20401','\x20mode','Idling\x20(','pidExpireLogin','restart_','stopped','success','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','privateKeyFromPem','reset-history','showname','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','delete-bot','botID','Your\x20installation\x20is\x20already\x20up\x20to\x20date','isValid','copyFileSync','string','cancelLoading','Backup\x20file\x20uploaded','telegramChatId','Unauthorized\x20attempt\x20to\x20get\x20events','disconnect','launch','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','onepagemode','Yes','toggleBotMode','emit','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','#RES#\x20if\x20running\x20locally\x0a','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','Alerts','temporary\x20access\x20not\x20allowed','chat','private','settings','showConfig','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','post','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','off_','Unauthorized\x20attempt\x20to\x20log\x20out','lastmsgemitted','date-fns','bot-','1000','Login\x20rejected','pidRefreshToken','existsSync','access','getHours','Backup\x20file\x20unzipped\x20and\x20stored','help','sort','bot.js','on_','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','2FA\x20login\x20token\x20generated','expiry','type','Unauthorized\x20attempt\x20to\x20delete\x20alerts','sockets','yargs/yargs','storeHeadless','\x1b[35m','hasOwnProperty','************','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','temporary\x20access\x20rejected','config_alerts','Temporary\x20access\x20rejected','Restore\x20process\x20confirmed','Bot\x20','socket','\x20minutes','Invalid\x20authentication\x20token\x20(2)','--------------------------------------','access\x20timeout','removeAllListeners','padStart','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','code','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Bot\x20Mgr\x20>\x20','bb-settings.json','min','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','clientip','version.json','2991804HDEnKw','download','config','node-forge','tempaccess_5_','catch','family','output-002.log','socket.io','yes','(staging)','Starting\x20#RED#Balance\x20Bot\x20v','use','status','update_no','\x20|\x20user:\x20...','orders','resetHistory','toIPv4MappedAddress','apiSecret','uuid','api-eu.mixpanel.com','2FA\x20login\x20rejected','bbvNew','config_orders','Unauthorized\x20login\x20attempt\x20(timeout)','kill','getPortfolio','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','telegramIpApproval','statSync','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','close','secure','publicKey','startsWith','sign','staging','keys','tkn','ipaddr.js','headers','slice','telegramUsername','sendPortfolioTelegram','598072YrRifk','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','resetpw_yes','whitelistEnabled','/:bot','-config.json','isDirectory','/enable\x20-\x20enable\x20notifications\x0a','referer','sha256','get','async','uncaughtException','telegramEvents','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Ok,\x20will\x20send\x20alert\x20notifications\x20only','start','enable','(((.+)+)+)+$','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','f2aRequired','toString','inlineKeyboard','/:bot/performance','secret','map','bb-secure.json','lastmsgtelegram','readdirSync','$1_$2_$3','IPv4','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','/metrics\x20-\x20show\x20bot\x20performance\x0a','new-disabled','latestversion','loadAsync','settings.','No\x20authentication\x20token','address\x20already\x20in\x20use','isIPv4MappedAddress','send','Server','|@|','length','args','writeFileSync','You\x20can\x20use\x20the\x20following\x20commands:\x0a','replyWithDocument','get-backup-files','apply','update','command','config/','temp/','listen','botname','from','format','Unauthorized\x20attempt\x20to\x20delete\x20bot','join','unlinkSync','/update\x20-\x20update\x20Balance\x20Bot\x0a','ETH','generateAsync','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','write','metrics_','range','4063045RUCDsA','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','index.html','alias','rmSync','debug','hex','bbvReceive','\x1b[0m','backupfile','/backup\x20-\x20receive\x20backup\x20files\x0a','-events.json','verify','started','Node.js\x20v','RSA-OAEP','File\x20uploaded','#RES#\x20if\x20running\x20on\x20server','backup-full','name','storeFiat','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','reinstall','CoinMarketCap\x20API\x20key\x20validated','warning','readFileSync','reason','restore_no_','timeshift','Unauthorized\x20attempt\x20to\x20show\x20configuration','log','telegramToken','/logs\x20-\x20receive\x20log\x20files\x0a','privateKey','full','bbUsername','portfolio_','update-bb','decrypt','show','publicKeyToPem','connection','1327104RGldAL','backup/','reinstall_yes','max','Logged\x20in\x20user\x20...','restore_yes_','getMonth','tempaccess_reject_','Unauthorized\x20attempt\x20to\x20confirm\x20message','Invalid\x20username\x20or\x20IP\x20address','manual','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','Unauthorized\x20attempt\x20to\x20store\x20configuration','includes','telegrammsg','-----------------------------------------------------------------------------------','remoteAddress','telegram','createWriteStream','notification','mtime','live','lowdb','env','placeOrder','426292pKutJW','\x20-\x20','connected','Running\x20#RED#Balance\x20Bot\x20v','show-config','::ffff:127.0.0.1','auth','new','\x20>\x20','Unauthorized\x20attempt\x20to\x20get\x20messages','#RES#','login2fa_reject_','params','DEFLATE','jszip','sortBy','pki','No\x20bots\x20running\x20right\x20now','stop','0.0.0','handshake','=>\x20Go\x20to\x20#CYA#http://','\x20|\x20','***','All\x20bots','stringify','endsWith','\x1b[34m','get-logs','inherit','accept','telegramEnabled','https://api.ipify.org?format=json','Unauthorized\x20attempt\x20to\x20update\x20bot','Invalid\x20IP\x20address','Allow\x20login\x20from\x20IP\x20address\x20','/disable\x20-\x20disable\x20notifications\x0a','simple','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','/names\x20-\x20show\x20bot\x20names\x0a','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','bots','invalid\x20credentials','marketcapApi','get-messages','deleteHistoryAlerts','reload','6b67f3d61ee94b8f5c80b4affef4c4d9','Unauthorized\x20attempt\x20to\x20download\x20','data','Logged\x20out\x20user\x20...','username','\x20files\x20over\x20Telegram:','replace','createServer','\x20(2)','child_process','Markdown','function','callback','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','internal','update_yes','temporary\x20access\x20timeout','6HdzTcR','resetpw_no','token','find','action',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','/restart\x20-\x20restart\x20bot(s)\x0a','Restoring\x20bot(s)\x20from\x20backup','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','allow','apiKey','2FA','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','Telegraf\x20error:','\x1b[33m','_nsps','axios','timestamp','reinstall-bb','number','mkdirSync','loginRequired','update-bot','restore-backup-file','mode','tempaccess_15_','-results.json','storeConfiguration','toIPv4Address','defaults','Deleted\x20Bot\x20','express-fileupload','files','Invalid\x20authentication\x20token\x20(1)','init','messages','Restore\x20process\x20aborted',':\x20Bot\x20Mgr\x20>\x20','SIGTERM','#RES#\x20','[ip-address]','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','BCT','static','login','Password\x20reset\x20rejected','test','/:bot/coins','/:bot/portfolio','2FA\x20required','split','sendFile','filter','config_all','3000','message','/start','constructor','User\x20has\x20been\x20validated','Starting\x20(','Starting\x20Balance\x20Bot\x20update','forEach','store-configuration','address','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','getSeconds','logged\x20out','compareSync','sendMetricsTelegram','randomBytes','Error:\x20Invalid\x20argument\x20','file','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','add-bot','disable','binary','build','kind','value','ipv6','3989315AGZsuC','graphql-request','title','login\x20required','match','login\x20not\x20required','editMessageReplyMarkup','botmanager','Error\x20details:','reset-password','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','output-000.log','enabled','getDate','getFullYear','cloneDeep','search','getTime','then','Network\x20Interfaces:','temporaryAccessAllowed','mixpanel',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','2FA\x20login\x20required','off','error','portfolio','remove','auto','getMinutes',')\x20\x20\x20|\x20Bot\x20','decode64','zip/','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','button','telegram2FaApproval','backup-full@','output-001.log','\x20(1)','updatebotmanager','parse','randomFillSync','fork','backup-files','apiPassword','exp','disabled','/off\x20-\x20stop\x20bot(s)\x0a','logs/','<b>Balance\x20Bot\x20Status:</b>\x0a','\x1b[36m','HTML','toggle_','toggle','reply','SIGINT','All\x20bots\x20running\x20right\x20now','*$1*','/:bot/configuration','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','\x20only\x0a','Error\x20sending\x20','production','store-fiat','restart','assign','/upload-backup','Notifications\x20disabled\x0a','4993972rRPYlA','confirm-message','30\x20min','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','toggle-bot-mode','bbPassword','getStartingBalances','argv','backup-full.zip','size','Orders','exchange','port','Starting\x20Balance\x20Bot\x20reinstallation','cancel-loading','backup','login\x20token\x20generated','\x20|\x20client:\x20...','bb-config.json','.zip','event','temporary\x20token\x20generated','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','server','blacklist','util','Unauthorized\x20attempt\x20to\x20add\x20bot','version','/:bot/support','lowdb/adapters/FileSync','reject','Enabled\x20Bot\x20','NTBA_FIX_319','Unauthorized\x20attempt\x20to\x20update\x20settings','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','hashSync','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','bot','\x20to\x20','set','running','push','477WwJlAL','getUTCHours','all','userid'];_0x3fea=function(){return _0x45c4ad;};return _0x3fea();}function initStates(){const _0x4147d5=_0xcd5cf4;let _0x305e55=getConfiguration();_0x305e55[_0x4147d5(0x26e)](_0x1587fc=>{const _0x2dafdd=_0x4147d5;_0x1587fc[_0x2dafdd(0x1ed)]=_0x2dafdd(0xe5);}),storeConfiguration(_0x305e55);}async function generateKeys(){const _0x3935fb=_0xcd5cf4,_0xedb93d=forge[_0x3935fb(0x201)]['rsa']['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x5295c9=forge[_0x3935fb(0x201)]['privateKeyToPem'](_0xedb93d[_0x3935fb(0x1cf)]),_0x20277b=forge[_0x3935fb(0x201)][_0x3935fb(0x1d6)](_0xedb93d[_0x3935fb(0x15d)]);return{'privateKey':_0x5295c9,'publicKey':_0x20277b};}async function oneTimeMigration(){const _0x5d5268=_0xcd5cf4;let _0x3a9188=getSettings(),_0x408c07=![];!_0x3a9188['hasOwnProperty'](_0x5d5268(0x183))&&(_0x3a9188['lastmsgtelegram']=0x0,_0x408c07=!![]);!_0x3a9188[_0x5d5268(0x123)](_0x5d5268(0x10c))&&(_0x3a9188['lastmsgemitted']=0x0,_0x408c07=!![]);!_0x3a9188['hasOwnProperty'](_0x5d5268(0x18a))&&(_0x3a9188[_0x5d5268(0x18a)]=_0x5d5268(0x204),_0x408c07=!![]);!_0x3a9188[_0x5d5268(0x123)](_0x5d5268(0xf9))&&(_0x3a9188[_0x5d5268(0xf9)]=![],_0x408c07=!![]);!_0x3a9188['hasOwnProperty'](_0x5d5268(0x21c))&&(_0x3a9188[_0x5d5268(0x21c)]='',_0x408c07=!![]);if(_0x408c07)storeSettings(_0x3a9188);try{fs[_0x5d5268(0x184)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x2fdfdf=>{const _0x199e3a=_0x5d5268;if(!_0x2fdfdf[_0x199e3a(0x16e)]()){if(!_0x2fdfdf[_0x199e3a(0x1bf)][_0x199e3a(0x15e)](_0x199e3a(0x8c)))fs['unlinkSync'](configbackuppath+_0x2fdfdf['name']);}else fs[_0x199e3a(0x1b0)](configbackuppath+_0x2fdfdf[_0x199e3a(0x1bf)],{'recursive':!![]});});}catch(_0x40ce9f){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x40ce9f);}}function storeConfiguration(_0xff63d4){const _0x2cdf2d=_0xcd5cf4;dbConfig[_0x2cdf2d(0x172)](_0x2cdf2d(0x21a))['remove']()['write'](),dbConfig[_0x2cdf2d(0x172)](_0x2cdf2d(0x21a))['push'](..._0xff63d4)['write'](),config=_0xff63d4;}async function resetPassword(){const _0xf59e42=_0xcd5cf4;if(tgBot&&settings['telegramChatId']){const _0x25b0e1=Markup['inlineKeyboard']([Markup[_0xf59e42(0x8a)][_0xf59e42(0x22c)](_0xf59e42(0x144),_0xf59e42(0x16a)),Markup[_0xf59e42(0x8a)][_0xf59e42(0x22c)]('no',_0xf59e42(0x232))]);await sendTelegram(settings[_0xf59e42(0xf4)],_0xf59e42(0x279),_0x25b0e1),tgBot[_0xf59e42(0x235)](/resetpw_(.+)/,async _0x59b02f=>{const _0x4f3cd5=_0xf59e42,_0x200290=_0x59b02f[_0x4f3cd5(0x285)][0x1];_0x59b02f[_0x4f3cd5(0x287)]();if(_0x200290!='no'){const _0xa69a49=0xf,_0x4045c5='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',_0x24e1db=Array[_0x4f3cd5(0x1a0)](crypto[_0x4f3cd5(0x91)](new Uint32Array(_0xa69a49)))[_0x4f3cd5(0x181)](_0x3e88a9=>_0x4045c5[_0x3e88a9%_0x4045c5[_0x4f3cd5(0x193)]])[_0x4f3cd5(0x1a3)](''),_0x2cd713=bcrypt[_0x4f3cd5(0xcf)](_0x24e1db,saltRounds);storeSettings({'bbPassword':_0x2cd713}),await sendTelegram(_0x59b02f[_0x4f3cd5(0x102)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x24e1db,{'parse_mode':_0x4f3cd5(0x9b)});}else await sendTelegram(_0x59b02f['chat']['id'],_0x4f3cd5(0x25e));});}}async function confirmRestore(_0x35831b,_0x32018f){const _0x3a341d=_0xcd5cf4;io['to'](_0x3a341d(0x288))['emit'](_0x3a341d(0x1eb),_0x3a341d(0x22d),_0x3a341d(0xe6));if(tgBot&&settings[_0x3a341d(0xf4)]){const _0x564de4=uuidRandom();tmpStorage[_0x564de4]={'path':_0x35831b,'filename':_0x32018f};const _0x4f7a5f=Markup['inlineKeyboard']([Markup[_0x3a341d(0x8a)][_0x3a341d(0x22c)](_0x3a341d(0x144),_0x3a341d(0x1dd)+_0x564de4),Markup['button'][_0x3a341d(0x22c)]('no',_0x3a341d(0x1c9)+_0x564de4)]);await sendTelegram(settings[_0x3a341d(0xf4)],_0x3a341d(0x1c2),_0x4f7a5f),tgBot['action'](/restore_(.+)_(.+)/,async _0x17d418=>{const _0xe6084d=_0x3a341d,_0x31a618=_0x17d418['match'][0x1],_0x379ef0=_0x17d418[_0xe6084d(0x285)][0x2],{path:_0x2c23cd,filename:_0x36677c}=tmpStorage[_0x379ef0];delete tmpStorage[_0x379ef0],_0x17d418['editMessageReplyMarkup'](),_0x31a618==_0xe6084d(0x144)?(logger[_0xe6084d(0x1b1)](_0xe6084d(0x129)),await sendTelegram(_0x17d418[_0xe6084d(0x102)]['id'],_0xe6084d(0x238),{'parse_mode':_0xe6084d(0x9b)}),unzipFile(_0x2c23cd,_0x36677c)):(logger['debug'](_0xe6084d(0x255)),await sendTelegram(_0x17d418[_0xe6084d(0x102)]['id'],_0xe6084d(0x255)));});}}function getServerTime(){const _0x11b653=_0xcd5cf4,_0x3c7fdc=new Date();return _0x3c7fdc['getFullYear']()+'/'+(_0x3c7fdc['getMonth']()+0x1)[_0x11b653(0x17d)]()[_0x11b653(0x131)](0x2,'0')+'/'+_0x3c7fdc[_0x11b653(0x28e)]()[_0x11b653(0x17d)]()[_0x11b653(0x131)](0x2,'0')+'\x20'+_0x3c7fdc['getHours']()[_0x11b653(0x17d)]()[_0x11b653(0x131)](0x2,'0')+':'+_0x3c7fdc[_0x11b653(0x85)]()[_0x11b653(0x17d)]()[_0x11b653(0x131)](0x2,'0')+':'+_0x3c7fdc['getSeconds']()[_0x11b653(0x17d)]()[_0x11b653(0x131)](0x2,'0');}function getTimeStamp(){const _0x5a2cf7=_0xcd5cf4,_0x108958=shiftedTime();return _0x108958[_0x5a2cf7(0x28f)]()+'/'+(_0x108958['getMonth']()+0x1)['toString']()[_0x5a2cf7(0x131)](0x2,'0')+'/'+_0x108958['getDate']()['toString']()[_0x5a2cf7(0x131)](0x2,'0')+'\x20'+_0x108958[_0x5a2cf7(0x114)]()[_0x5a2cf7(0x17d)]()[_0x5a2cf7(0x131)](0x2,'0')+':'+_0x108958[_0x5a2cf7(0x85)]()['toString']()[_0x5a2cf7(0x131)](0x2,'0')+':'+_0x108958['getSeconds']()['toString']()[_0x5a2cf7(0x131)](0x2,'0');}function getCleanTimeStamp(){const _0x3d02e1=_0xcd5cf4,_0xb6ea87=shiftedTime();return _0xb6ea87[_0x3d02e1(0x28f)]()+(_0xb6ea87[_0x3d02e1(0x1de)]()+0x1)[_0x3d02e1(0x17d)]()['padStart'](0x2,'0')+_0xb6ea87[_0x3d02e1(0x28e)]()[_0x3d02e1(0x17d)]()[_0x3d02e1(0x131)](0x2,'0')+'-'+_0xb6ea87[_0x3d02e1(0x114)]()[_0x3d02e1(0x17d)]()[_0x3d02e1(0x131)](0x2,'0')+_0xb6ea87[_0x3d02e1(0x85)]()[_0x3d02e1(0x17d)]()[_0x3d02e1(0x131)](0x2,'0')+_0xb6ea87['getSeconds']()[_0x3d02e1(0x17d)]()[_0x3d02e1(0x131)](0x2,'0');}function shiftedTime(){const _0x57c1d6=_0xcd5cf4,_0x191dfc=new Date();let _0xd849e7=_0x191dfc;if(settings['timeshift']&&settings[_0x57c1d6(0x1ca)]!==0x0)_0xd849e7=fns['add'](_0x191dfc,{'hours':settings['timeshift']});return _0xd849e7;}async function startScheduler(){const _0x56c1af=_0xcd5cf4,_0x5c05d0=new Date()[_0x56c1af(0xd7)](),_0x100bba=shiftedTime()[_0x56c1af(0x114)]();_0x100bba==0x4&&backupConfigFiles(),_0x100bba==0x0&&(rotateLogFiles(),logger['debug'](_0x56c1af(0x12e)),logger[_0x56c1af(0x1b1)](_0x56c1af(0x1f4)+serverversion+_0x56c1af(0x258)+(environment==_0x56c1af(0x160)?_0x56c1af(0x145):'')),logger[_0x56c1af(0x1b1)](_0x56c1af(0x12e))),_0x5c05d0%0x6==0x0&&triggerAnalytics(),_0x5c05d0%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x5f1c19){const _0x349d02=_0xcd5cf4;logger[_0x349d02(0x1b1)]('Restore\x20backup\x20file\x20'+_0x5f1c19);const _0x5b4660=getBotsWithMode();_0x5b4660[_0x349d02(0x193)]>0x0?confirmRestore(configbackuppath,_0x5f1c19):unzipFile(configbackuppath,_0x5f1c19);}async function getBackupFiles(_0x2aa74d=null){const _0x55ed3a=_0xcd5cf4;let _0x4aadd9=[],_0x4ccae5=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x4ccae5[_0x55ed3a(0x117)]((_0x13d4a6,_0x565fec)=>_0x13d4a6[_0x55ed3a(0x1bf)]<_0x565fec[_0x55ed3a(0x1bf)]?0x1:_0x565fec[_0x55ed3a(0x1bf)]<_0x13d4a6[_0x55ed3a(0x1bf)]?-0x1:0x0),_0x4ccae5[_0x55ed3a(0x26e)](_0x8456d=>{const _0x557f3b=_0x55ed3a;if(!_0x8456d[_0x557f3b(0x16e)]()&&_0x8456d[_0x557f3b(0x1bf)]['startsWith'](_0x557f3b(0x8c))&&_0x8456d[_0x557f3b(0x1bf)][_0x557f3b(0x20b)](_0x557f3b(0xbf))){const _0x2eb52d=formatDate(fs['statSync'](configbackuppath+_0x8456d[_0x557f3b(0x1bf)])[_0x557f3b(0x1ec)]);_0x4aadd9[_0x557f3b(0xd5)]({'name':_0x8456d[_0x557f3b(0x1bf)],'mtime':_0x2eb52d});}});if(_0x2aa74d)io['to'](_0x2aa74d)[_0x55ed3a(0xfc)](_0x55ed3a(0x93),_0x4aadd9);else return _0x4aadd9;}async function backupConfigFiles(){const _0x10418c=_0xcd5cf4;await zipFiles('backup-full');const _0x173089=getCleanTimeStamp();fs[_0x10418c(0xf0)](zippath+_0x10418c(0xb4),configbackuppath+(_0x10418c(0x8c)+_0x173089+_0x10418c(0xbf)));let _0x355291=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x355291[_0x10418c(0x117)]((_0x3549f2,_0x50fec5)=>_0x3549f2[_0x10418c(0x1bf)]<_0x50fec5['name']?0x1:_0x50fec5[_0x10418c(0x1bf)]<_0x3549f2[_0x10418c(0x1bf)]?-0x1:0x0),_0x355291[_0x10418c(0x193)]>maxBackups&&fs[_0x10418c(0x1a4)](configbackuppath+_0x355291[_0x355291[_0x10418c(0x193)]-0x1][_0x10418c(0x1bf)]);}function rotateLogFiles(){const _0x476f59=_0xcd5cf4,_0x578c96=fs[_0x476f59(0x159)](logspath+_0x476f59(0x28c)),_0x233cc9=_0x578c96[_0x476f59(0xb5)]/0x400;if(_0x233cc9>0x64){let _0x3dc347=fs[_0x476f59(0x184)](logspath,{'withFileTypes':!![]});_0x3dc347[_0x476f59(0x117)]((_0x38a8b0,_0xbc5d3a)=>_0x38a8b0[_0x476f59(0x1bf)]<_0xbc5d3a[_0x476f59(0x1bf)]?0x1:_0xbc5d3a['name']<_0x38a8b0[_0x476f59(0x1bf)]?-0x1:0x0),_0x3dc347[_0x476f59(0x26e)](_0x330ac8=>{const _0x44afe2=_0x476f59;if(_0x330ac8[_0x44afe2(0x1bf)]=='output-002.log')fs['copyFileSync'](logspath+_0x330ac8[_0x44afe2(0x1bf)],logspath+'output-003.log');if(_0x330ac8[_0x44afe2(0x1bf)]==_0x44afe2(0x8d))fs[_0x44afe2(0xf0)](logspath+_0x330ac8['name'],logspath+_0x44afe2(0x142));_0x330ac8[_0x44afe2(0x1bf)]==_0x44afe2(0x28c)&&(fs[_0x44afe2(0xf0)](logspath+_0x330ac8[_0x44afe2(0x1bf)],logspath+'output-001.log'),fs[_0x44afe2(0x195)](logspath+_0x330ac8['name'],''));});}}async function zipFiles(_0x2ef801){const _0x36d211=_0xcd5cf4;let _0x1369a8;if(_0x2ef801==_0x36d211(0xda))_0x1369a8=logspath;if(_0x2ef801==_0x36d211(0xbb))_0x1369a8=configpath;if(_0x2ef801==_0x36d211(0x1be))_0x1369a8=configpath;let _0x143c08=fs[_0x36d211(0x184)](_0x1369a8,{'withFileTypes':!![]});const _0x4bbe08=new JSZip();_0x143c08[_0x36d211(0x26e)](_0x5c9f89=>{const _0x459750=_0x36d211;if(!_0x5c9f89[_0x459750(0x16e)]()){let _0x3a3d4f=fs[_0x459750(0x1c7)](_0x1369a8+_0x5c9f89[_0x459750(0x1bf)]);if(_0x2ef801==_0x459750(0xbb)){const _0x3ba813=/^bot-[0-9]{3}-config.json$/,_0x47a3db=_0x3ba813[_0x459750(0x25f)](_0x5c9f89[_0x459750(0x1bf)]);if(_0x47a3db){const _0x3a499b=JSON[_0x459750(0x90)](_0x3a3d4f);if(_0x3a499b[_0x459750(0xd1)][0x0]){_0x3a499b[_0x459750(0xd1)][0x0][_0x459750(0x23b)]='***',_0x3a499b[_0x459750(0xd1)][0x0][_0x459750(0x14e)]=_0x459750(0x208);if(_0x3a499b[_0x459750(0xd1)][0x0]['apiPassword'])_0x3a499b[_0x459750(0xd1)][0x0][_0x459750(0x94)]=_0x459750(0x208);}_0x3a3d4f=JSON['stringify'](_0x3a499b,null,0x2);}if(_0x5c9f89['name']==_0x459750(0x136)){const _0x4a7d6f=JSON[_0x459750(0x90)](_0x3a3d4f);if(_0x4a7d6f[_0x459750(0x104)]['loginRequired'])_0x4a7d6f['settings'][_0x459750(0x246)]=![];if(_0x4a7d6f[_0x459750(0x104)][_0x459750(0xb1)])_0x4a7d6f['settings'][_0x459750(0xb1)]=_0x459750(0x208);if(_0x4a7d6f['settings'][_0x459750(0x1cd)])_0x4a7d6f['settings'][_0x459750(0x1cd)]=_0x459750(0x208);if(_0x4a7d6f[_0x459750(0x104)][_0x459750(0xf4)])_0x4a7d6f[_0x459750(0x104)][_0x459750(0xf4)]=null;if(_0x4a7d6f[_0x459750(0x104)][_0x459750(0x21c)])_0x4a7d6f[_0x459750(0x104)][_0x459750(0x21c)]=_0x459750(0x208);_0x3a3d4f=JSON[_0x459750(0x20a)](_0x4a7d6f,null,0x2);}if(_0x5c9f89['name']!=_0x459750(0x182))_0x4bbe08[_0x459750(0x278)](_0x5c9f89['name'],_0x3a3d4f);}else _0x4bbe08['file'](_0x5c9f89[_0x459750(0x1bf)],_0x3a3d4f);}});const _0x16e776=await _0x4bbe08[_0x36d211(0x1a7)]({'type':_0x36d211(0xf1),'base64':![],'compression':_0x36d211(0x1fe)});fs[_0x36d211(0x195)](zippath+(_0x2ef801+'.zip'),_0x16e776,_0x36d211(0x27c));}async function unzipFile(_0xeb2527,_0x456d8d){const _0x202847=_0xcd5cf4;fs[_0x202847(0x184)](configpath,{'withFileTypes':!![]})[_0x202847(0x26e)](_0x41c3db=>{const _0x49368d=_0x202847;if(!_0x41c3db[_0x49368d(0x16e)]())fs[_0x49368d(0x1b0)](configpath+_0x41c3db['name']);});const _0x281e66=fs[_0x202847(0x1c7)](_0xeb2527+_0x456d8d,_0x202847(0x27c)),_0x60ceb5=await JSZip[_0x202847(0x18b)](_0x281e66,{'base64':![],'checkCRC32':!![]});for(const _0x513db8 of Object[_0x202847(0x161)](_0x60ceb5[_0x202847(0x251)])){const _0x1823e3=_0x60ceb5['files'][_0x513db8],_0x27a5d7=await _0x1823e3[_0x202847(0x173)](_0x202847(0xf1));fs[_0x202847(0x195)](configpath+_0x1823e3[_0x202847(0x1bf)],_0x27a5d7);}fs[_0x202847(0x184)](temppath,{'withFileTypes':!![]})['forEach'](_0x34dacb=>{const _0x3dccf5=_0x202847;if(!_0x34dacb['isDirectory']())fs[_0x3dccf5(0x1b0)](temppath+_0x34dacb[_0x3dccf5(0x1bf)]);}),logger['debug'](_0x202847(0x115)),process['send']({'restore':!![]},_0x4b1cba=>{});}async function getPublicIp(){const _0x279041=_0xcd5cf4;try{const _0x441ecd=await axios[_0x279041(0x172)](_0x279041(0x211));publicip=_0x441ecd[_0x279041(0x222)]['ip'];}catch(_0x12741d){}}async function triggerAnalytics(){const _0x210b58=_0xcd5cf4;if(!publicip)await getPublicIp();const _0x3e75dd=getBotsWithMode();let _0x4a904d=0x0;_0x3e75dd[_0x210b58(0x26e)](_0x30230d=>{if(_0x30230d['status']==='enabled')_0x4a904d++;});const _0x422473=getBotExchanges();mixpanel['track'](_0x210b58(0x191),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x3e75dd[_0x210b58(0x193)],'numbotsenabled':_0x4a904d,'exchanges':_0x422473,'environment':environment});}async function getMessages(){const _0x3422cd=_0xcd5cf4,_0x323694=_0x3422cd(0xeb),_0x2d518f=new GraphQLClient(_0x323694),_0x350773={'authorization':_0x3422cd(0x134)},_0x96fe9=serverversion[_0x3422cd(0x263)]('.'),_0x4bffcf=_0x96fe9[0x0]+'.'+_0x96fe9[0x1],_0x5d549e=Math[_0x3422cd(0x137)](settings['lastmsgtelegram'],settings[_0x3422cd(0x10c)]),_0x3f108a={'last':parseInt(_0x5d549e),'bbm':_0x4bffcf},_0x5ca759=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x128aa0;try{_0x128aa0=await _0x2d518f['request'](_0x5ca759,_0x3f108a,_0x350773);}catch(_0x35870e){}if(_0x128aa0&&_0x128aa0[_0x3422cd(0x254)]){let _0x1720d9=settings[_0x3422cd(0x183)],_0x542d5b=settings[_0x3422cd(0x183)];newMessages=[];for(const _0x5e47bc of _0x128aa0[_0x3422cd(0x254)]){newMessages['push'](_0x5e47bc);let _0x129477=![];_0x5e47bc[_0x3422cd(0x152)]&&(updateSetting('latestversion',_0x5e47bc['bbvNew']),_0x129477=isNewerVersion(serverversion,_0x5e47bc[_0x3422cd(0x152)])||serverversion==_0x5e47bc[_0x3422cd(0x152)]);if(!_0x129477&&_0x5e47bc[_0x3422cd(0x244)]>_0x1720d9){if(_0x5e47bc[_0x3422cd(0x1b3)]==='any'||serverversion['startsWith'](_0x5e47bc[_0x3422cd(0x1b3)])){let _0x34dc83=''+_0x5e47bc[_0x3422cd(0x283)]+'\x0a\x0a'+_0x5e47bc[_0x3422cd(0x268)];const _0x2c3d6e=await sendTelegramMsg(toTelegramMarkdown(_0x34dc83),_0x3422cd(0x22a));_0x1720d9=_0x5e47bc[_0x3422cd(0x244)];}}_0x542d5b=_0x5e47bc[_0x3422cd(0x244)];}updateAvailable=isNewerVersion(settings[_0x3422cd(0x18a)],serverversion),updateSetting(_0x3422cd(0x183),_0x542d5b),emitMessages();}}function emitMessages(){const _0x599139=_0xcd5cf4,_0x3c0e42=settings[_0x599139(0x10c)];let _0x278c96=[];newMessages[_0x599139(0x26e)](_0x2978a5=>{const _0x250fed=_0x599139;_0x2978a5['number']>_0x3c0e42&&_0x278c96[_0x250fed(0xd5)](_0x2978a5);}),_0x278c96[_0x599139(0x193)]>0x0&&getAllClients()[_0x599139(0x26e)](_0x283040=>{const _0x4bb388=_0x599139;getSocket(_0x283040['id'])[_0x4bb388(0xfc)](_0x4bb388(0x268),_0x278c96);});}function confirmMessage(_0x4f5b81){const _0x2b4782=_0xcd5cf4;updateSetting(_0x2b4782(0x10c),Number(_0x4f5b81));}function isNewerVersion(_0x339bae,_0x1593ba){const _0x1bd4f6=_0xcd5cf4,_0x1574ea=_0x1593ba[_0x1bd4f6(0x263)]('.'),_0x117273=_0x339bae['split']('.');for(var _0x1bac33=0x0;_0x1bac33<_0x117273['length'];_0x1bac33++){const _0x29f791=~~_0x117273[_0x1bac33],_0x31f76b=~~_0x1574ea[_0x1bac33];if(_0x29f791>_0x31f76b)return!![];if(_0x29f791<_0x31f76b)return![];}return![];}function toTelegramMarkdown(_0xc785f8){const _0x105410=_0xcd5cf4,_0x1e3b39=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3c4a96=/\*{2}(.+?)\*{2}/gim;return _0xc785f8=_0xc785f8[_0x105410(0x226)](_0x1e3b39,_0x105410(0x185))[_0x105410(0x226)](_0x3c4a96,_0x105410(0xa1)),_0xc785f8;}async function validateConfigFile(){const _0x4a4297=_0xcd5cf4,_0x80f747=dbConfig[_0x4a4297(0x172)]('bots')[_0x4a4297(0x200)](_0x4a4297(0xed))[_0x4a4297(0x27f)]()||[];if(_0x80f747[_0x4a4297(0x193)]==0x0){let _0x47b7f5=0x0,_0x257916=[];const _0x48ec5c=/^bot-([0-9]{3})-config.json$/,_0x1d808a=fs[_0x4a4297(0x184)](configpath);_0x1d808a[_0x4a4297(0x26e)](_0x47c7e9=>{const _0x34ac9f=_0x4a4297,_0x418a7a=_0x48ec5c['exec'](_0x47c7e9);if(_0x418a7a){const _0x55dad0=_0x418a7a[0x1];let _0x4106d0=getBotAttributes(_0x55dad0);_0x257916[_0x34ac9f(0xd5)]({'botID':_0x55dad0,'botname':_0x4106d0[_0x34ac9f(0x19f)],'status':_0x34ac9f(0x96),'live':_0x34ac9f(0xe5)}),_0x47b7f5++;}}),_0x47b7f5!=0x0&&(dbConfig[_0x4a4297(0x172)](_0x4a4297(0x21a))['assign'](_0x257916)[_0x4a4297(0x1a9)](),config=_0x257916,restoredConfigFile=_0x47b7f5);}}async function restoreConfigNotify(_0xf32181){const _0x22b9e0=_0xcd5cf4;let _0x51efa5;if(restoredConfigFile==0x1)_0x51efa5='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x51efa5=_0x22b9e0(0x108);if(_0xf32181)io['to'](_0x22b9e0(0x288))[_0x22b9e0(0xfc)](_0x22b9e0(0x1eb),_0x51efa5);else{logger['simple'](_0x22b9e0(0x1e7)),logger[_0x22b9e0(0x216)](_0x51efa5),logger[_0x22b9e0(0x216)](_0x22b9e0(0x1e7)),logger['simple']('');if(tgBot&&settings[_0x22b9e0(0xf4)]&&settings['telegramEvents']!=_0x22b9e0(0x14b))await sendTelegram(settings[_0x22b9e0(0xf4)],_0x22b9e0(0x135)+_0x51efa5);}}function decryptRSA(_0x216d31,_0x1adb9e){const _0x2fabff=_0xcd5cf4,_0x4b5cce=forge[_0x2fabff(0x201)][_0x2fabff(0xe8)](_0x216d31),_0x5354a6=_0x4b5cce[_0x2fabff(0x1d4)](forge[_0x2fabff(0xc5)][_0x2fabff(0x87)](_0x1adb9e),_0x2fabff(0x1bb),{'md':forge['md'][_0x2fabff(0x171)][_0x2fabff(0xdb)](),'mgf1':{'md':forge['md'][_0x2fabff(0x171)][_0x2fabff(0xdb)]()}});return _0x5354a6;}function validateCredentials(_0xfc3d78,_0x5ab2d0){const _0x3ed164=_0xcd5cf4;if(_0xfc3d78['username']==settings[_0x3ed164(0x1d1)]&&bcrypt[_0x3ed164(0x274)](_0xfc3d78['password'],settings[_0x3ed164(0xb1)])){if(settings['f2aRequired'])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x1fb32e=generateLoginToken(_0x5ab2d0);return{'allow':!![],'reason':_0x3ed164(0xbc),'token':_0x1fb32e};}}else return{'allow':![],'reason':_0x3ed164(0x21b),'token':null};}function refreshToken(_0x254c3f){const _0x6c93c2=_0xcd5cf4,_0x275e04=generateLoginToken(_0x254c3f);return{'allow':!![],'reason':_0x6c93c2(0xbc),'token':_0x275e04};}function validateAccess(_0x1fb607,_0x3d2844,_0x2f04b4){const _0x4a7c37=_0xcd5cf4,_0xb47296=_0x2f04b4?_0x2f04b4:devices[_0x3d2844]['ip'];let _0x426019;const _0x50ccf4=_0x5167ea=>{const _0x33321c=_0x404e;if(settings[_0x33321c(0x246)]){if(settings[_0x33321c(0x17c)]){if(telegram2FaApproved(_0x3d2844)){const _0x798140=generateLoginToken(_0x3d2844);return{'allow':!![],'reason':_0x33321c(0x11b),'token':_0x798140};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x426019=validToken(_0x5167ea,_0x3d2844),_0x426019[_0x33321c(0x123)](_0x33321c(0xe6))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x5167ea}:{'allow':![],'reason':_0x33321c(0x284),'token':null};}else return{'allow':!![],'reason':_0x33321c(0x286),'token':null};};if(settings[_0x4a7c37(0x16b)]){let _0xa1ec73=[...settings['whitelist'],'::1',_0x4a7c37(0x1f6),'127.0.0.1'];if(_0xa1ec73[_0x4a7c37(0x1e5)](_0xb47296))return _0x50ccf4(_0x1fb607);else{_0x426019=validToken(_0x1fb607,_0x3d2844);if(_0x426019[_0x4a7c37(0x123)](_0x4a7c37(0xe6)))return _0x50ccf4(_0x1fb607);else{if(telegramIpApproved(_0x3d2844)){const _0x112d7e=generateToken(_0x3d2844);return _0x426019=_0x50ccf4(_0x1fb607),_0x426019[_0x4a7c37(0x23a)]?{'allow':!![],'reason':_0x4a7c37(0xc1),'token':_0x112d7e}:_0x426019;}else return settings[_0x4a7c37(0x295)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x4a7c37(0x101),'token':null};}}}else return _0x50ccf4(_0x1fb607);}function timelyDecrypt(_0x56311d,_0x3b420c,_0x1456a0='@'){const _0x5e13bb=_0xcd5cf4;if(_0x56311d)try{const _0x59a51e=decryptRSA(secure[_0x5e13bb(0x1cf)],_0x56311d),_0x35536d=_0x59a51e[_0x5e13bb(0x263)](_0x1456a0)[0x0],_0x497ec3=_0x59a51e[_0x5e13bb(0x263)](_0x1456a0)[0x1],_0x4694b8=new Date()['getTime']();if(_0x3b420c){if(_0x4694b8-_0x497ec3<maxSecretAge*0x3e8)return _0x35536d;else return![];}else return _0x35536d;}catch(_0x574044){return![];}else return![];}const validToken=(_0x199e94,_0x2a1435)=>{const _0x4f79ed=_0xcd5cf4,_0x30caea=devices[_0x2a1435]['ip'];if(!_0x199e94)return{'error':_0x4f79ed(0x18d)};for(let _0x3bec46 of blacklist){if(_0x3bec46[_0x4f79ed(0x233)]==_0x199e94)return{'error':'Token\x20blacklisted'};}let _0x185b3b;try{_0x185b3b=jwt[_0x4f79ed(0x1b8)](_0x199e94,secure['secret']+_0x2a1435);}catch{return{'error':_0x4f79ed(0x252)};}if(!_0x185b3b[_0x4f79ed(0x123)](_0x4f79ed(0x139))&&!_0x185b3b[_0x4f79ed(0x123)](_0x4f79ed(0x224))||!_0x185b3b[_0x4f79ed(0x123)](_0x4f79ed(0x95)))return{'error':_0x4f79ed(0x12d)};if(!_0x185b3b[_0x4f79ed(0x123)](_0x4f79ed(0x224))&&_0x185b3b['hasOwnProperty'](_0x4f79ed(0x139))){const {clientip:_0x5cb39f}=_0x185b3b;return _0x30caea==_0x5cb39f?{'success':_0x4f79ed(0x26b)}:{'error':_0x4f79ed(0x213)};}else{if(_0x185b3b[_0x4f79ed(0x123)](_0x4f79ed(0x224))&&_0x185b3b['hasOwnProperty']('clientip')){const {username:_0x2a3887,clientip:_0x268d16}=_0x185b3b;return settings[_0x4f79ed(0x1d1)]==_0x2a3887&&_0x30caea==_0x268d16?{'success':_0x4f79ed(0x26b)}:{'error':_0x4f79ed(0x1e1)};}}},generateLoginToken=_0x491801=>{const _0x5ee6b4=_0xcd5cf4;if(_0x491801){const _0x2edce=devices[_0x491801]['ip'];return jwt['sign']({'username':settings[_0x5ee6b4(0x1d1)],'clientip':_0x2edce},secure[_0x5ee6b4(0x180)]+_0x491801,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x31c044=>{const _0x282d21=_0xcd5cf4;if(_0x31c044){const _0x59dcc4=devices[_0x31c044]['ip'];return jwt[_0x282d21(0x15f)]({'clientip':_0x59dcc4},secure['secret']+_0x31c044,{'expiresIn':devices[_0x31c044][_0x282d21(0x158)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x650eae=>{const _0x24ebf5=_0xcd5cf4;let _0x2b320b=![];return devices[_0x650eae][_0x24ebf5(0x158)]&&devices[_0x650eae][_0x24ebf5(0x158)][_0x24ebf5(0x11c)]!=_0x24ebf5(0xca)&&(_0x2b320b=devices[_0x650eae]['telegramIpApproval']['clientip']==devices[_0x650eae]['ip']&&new Date()[_0x24ebf5(0x292)]()-devices[_0x650eae][_0x24ebf5(0x158)]['timestamp']<devices[_0x650eae]['telegramIpApproval']['expiry']*0x3c*0x3e8),_0x2b320b;},telegram2FaApproved=_0x5036b2=>{const _0x5e9ea9=_0xcd5cf4;let _0x57624e=![];return devices[_0x5036b2][_0x5e9ea9(0x8b)]&&devices[_0x5036b2]['telegram2FaApproval']['expiry']!=_0x5e9ea9(0xca)&&(_0x57624e=devices[_0x5036b2][_0x5e9ea9(0x8b)]['clientip']==devices[_0x5036b2]['ip']&&new Date()[_0x5e9ea9(0x292)]()-devices[_0x5036b2]['telegram2FaApproval'][_0x5e9ea9(0x242)]<devices[_0x5036b2][_0x5e9ea9(0x8b)][_0x5e9ea9(0x11c)]*0x3c*0x3e8),_0x57624e;},normalizeIP=_0x5303b3=>{const _0x5331a1=_0xcd5cf4;let _0x243a59=null,_0x1ea524=null;if(ipaddr[_0x5331a1(0xef)](_0x5303b3)){const _0x1cf525=ipaddr[_0x5331a1(0x90)](_0x5303b3);_0x1cf525[_0x5331a1(0x27e)]()===_0x5331a1(0x280)?(_0x1cf525[_0x5331a1(0x18f)]()&&(_0x243a59=_0x1cf525[_0x5331a1(0x24d)]()[_0x5331a1(0x17d)]()),_0x1ea524=_0x1cf525['toString']()):(_0x243a59=_0x1cf525[_0x5331a1(0x17d)](),_0x1ea524=_0x1cf525[_0x5331a1(0x14d)]()['toString']());}return{'show':_0x243a59?_0x243a59:_0x1ea524,'store':_0x1ea524};};function formatDate(_0x507f6b){const _0x185108=_0xcd5cf4;return _0x507f6b['getFullYear']()+'/'+(_0x507f6b[_0x185108(0x1de)]()+0x1)['toString']()[_0x185108(0x131)](0x2,'0')+'/'+_0x507f6b[_0x185108(0x28e)]()[_0x185108(0x17d)]()[_0x185108(0x131)](0x2,'0')+'\x20'+_0x507f6b['getHours']()[_0x185108(0x17d)]()[_0x185108(0x131)](0x2,'0')+':'+_0x507f6b[_0x185108(0x85)]()[_0x185108(0x17d)]()[_0x185108(0x131)](0x2,'0')+':'+_0x507f6b[_0x185108(0x272)]()[_0x185108(0x17d)]()['padStart'](0x2,'0');}function sleep(_0x6df1c4){return new Promise(_0x2c6d01=>setTimeout(_0x2c6d01,_0x6df1c4));}