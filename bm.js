const _0xda629c=_0x529b;(function(_0x10083f,_0x386067){const _0x378ce9=_0x529b,_0x266d3d=_0x10083f();while(!![]){try{const _0x18de25=-parseInt(_0x378ce9(0x176))/0x1+parseInt(_0x378ce9(0x23b))/0x2*(parseInt(_0x378ce9(0x1c4))/0x3)+-parseInt(_0x378ce9(0x1ea))/0x4*(-parseInt(_0x378ce9(0x17f))/0x5)+-parseInt(_0x378ce9(0x152))/0x6+parseInt(_0x378ce9(0x164))/0x7*(parseInt(_0x378ce9(0x23d))/0x8)+-parseInt(_0x378ce9(0x307))/0x9*(-parseInt(_0x378ce9(0x351))/0xa)+parseInt(_0x378ce9(0x299))/0xb*(-parseInt(_0x378ce9(0x1bc))/0xc);if(_0x18de25===_0x386067)break;else _0x266d3d['push'](_0x266d3d['shift']());}catch(_0x1d1a8a){_0x266d3d['push'](_0x266d3d['shift']());}}}(_0x4ea8,0x8780e));const _0x268f6f=function(){let _0x162553=!![];return function(_0x237909,_0x2e0117){const _0x29db8=_0x162553?function(){const _0x4d37cc=_0x529b;if(_0x2e0117){const _0x1c9642=_0x2e0117[_0x4d37cc(0x316)](_0x237909,arguments);return _0x2e0117=null,_0x1c9642;}}:function(){};return _0x162553=![],_0x29db8;};}(),_0x189c3a=_0x268f6f(this,function(){const _0x480786=_0x529b;return _0x189c3a[_0x480786(0x345)]()[_0x480786(0x26e)](_0x480786(0x245))['toString']()['constructor'](_0x189c3a)[_0x480786(0x26e)](_0x480786(0x245));});_0x189c3a();'use strict';process[_0xda629c(0x19e)][_0xda629c(0x223)]=0x1;const childProcess=require(_0xda629c(0x201)),fs=require('fs'),fns=require(_0xda629c(0x33a)),low=require(_0xda629c(0x182)),FileSync=require(_0xda629c(0x313)),path=require(_0xda629c(0x2ef)),crypto=require(_0xda629c(0x169)),forge=require(_0xda629c(0x27c)),bcrypt=require('bcryptjs'),jwt=require(_0xda629c(0x2aa)),ipaddr=require(_0xda629c(0x132)),argv=require(_0xda629c(0x215))(process['argv'][_0xda629c(0x1bf)](0x2))['argv'],uuidRandom=require(_0xda629c(0x2fb)),{Telegraf,Markup}=require(_0xda629c(0x341)),Mixpanel=require(_0xda629c(0x1ff)),axios=require(_0xda629c(0x20d)),{GraphQLClient,gql}=require(_0xda629c(0x1ee)),util=require(_0xda629c(0x1f1)),fileUpload=require(_0xda629c(0x234)),{networkInterfaces}=require('os'),JSZip=require(_0xda629c(0x15d)),PORT=argv[_0xda629c(0x1f8)]||_0xda629c(0x16c),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0xda629c(0x2ba)]('Error:\x20Invalid\x20argument\x20'+PORT+_0xda629c(0x1b3)),process['exit'](0x1));const HOST=argv[_0xda629c(0x148)]||null,userID=argv[_0xda629c(0x2bd)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0xda629c(0x1d3)][_0xda629c(0x171)];let bbpath=_0xda629c(0x2c5),bbpath2='';const botfile=_0xda629c(0x2fa),configfile=_0xda629c(0x353),settingsfile=_0xda629c(0x16e),securefile=_0xda629c(0x25f),environment=require('./'+bbpath2+_0xda629c(0x278))[_0xda629c(0x24c)]||_0xda629c(0x2a2),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0xda629c(0x180)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0xda629c(0x323)),configpath=userID?bbpath+_0xda629c(0x221)+userID+'/':bbpath+_0xda629c(0x221),configbackuppath=configpath+_0xda629c(0x2d7),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0xda629c(0x1c7),zippath=userID?bbpath+_0xda629c(0x1d2)+userID+'/':bbpath+_0xda629c(0x1d2),loggerfile=fs[_0xda629c(0x336)](logspath+_0xda629c(0x33c),{'flags':'a'}),temppath=userID?bbpath+_0xda629c(0x2e2)+userID+'/':bbpath+_0xda629c(0x2e2);!fs[_0xda629c(0x180)](configpath)&&fs['mkdirSync'](configpath);!fs[_0xda629c(0x180)](configbackuppath)&&fs[_0xda629c(0x1f5)](configbackuppath);function _0x529b(_0x341c63,_0xd78377){const _0x47467e=_0x4ea8();return _0x529b=function(_0x189c3a,_0x268f6f){_0x189c3a=_0x189c3a-0x131;let _0x4ea837=_0x47467e[_0x189c3a];return _0x4ea837;},_0x529b(_0x341c63,_0xd78377);}!fs['existsSync'](logspath)&&fs[_0xda629c(0x1f5)](logspath);!fs[_0xda629c(0x180)](zippath)&&fs['mkdirSync'](zippath);!fs[_0xda629c(0x180)](temppath)&&fs[_0xda629c(0x1f5)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xda629c(0x136)]({'bots':[]})[_0xda629c(0x1c0)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0xda629c(0x136)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0xda629c(0x32c),'onepagemode':![],'marketcapApi':''}})[_0xda629c(0x1c0)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0xda629c(0x136)]({'secure':{},'blacklist':[]})[_0xda629c(0x1c0)]();const saltRounds=0xa,mixpanel=Mixpanel[_0xda629c(0x276)](_0xda629c(0x2bc),{'host':_0xda629c(0x2ed)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0xda629c(0x18f)]&&(settings['telegramToken']!=''&&settings[_0xda629c(0x18f)]!='***')&&settings[_0xda629c(0x26c)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x195a55,_0x449e02)=>{const _0xbbd3e6=_0xda629c,_0x29bcf9=/#[A-Z]{3}#/g;if(typeof _0x195a55==_0xbbd3e6(0x33e)){!_0x449e02?_0x195a55=_0x195a55[_0xbbd3e6(0x33b)](_0x29bcf9,''):(_0x195a55=_0x195a55[_0xbbd3e6(0x33b)](/#BLU#/g,_0xbbd3e6(0x30a)),_0x195a55=_0x195a55[_0xbbd3e6(0x33b)](/#RED#/g,'\x1b[31m'),_0x195a55=_0x195a55[_0xbbd3e6(0x33b)](/#YEL#/g,_0xbbd3e6(0x2a1)),_0x195a55=_0x195a55[_0xbbd3e6(0x33b)](/#MAG#/g,_0xbbd3e6(0x30d)),_0x195a55=_0x195a55[_0xbbd3e6(0x33b)](/#CYA#/g,'\x1b[36m'),_0x195a55=_0x195a55[_0xbbd3e6(0x33b)](/#RES#/g,_0xbbd3e6(0x271)));;}return _0x195a55;},logger={'screen':_0x68330a=>{const _0x55d445=_0xda629c;console[_0x55d445(0x2ba)](parseColor(_0x68330a,!![]));},'simple':_0x66125f=>{const _0xddc55d=_0xda629c;console[_0xddc55d(0x2ba)](parseColor(_0x66125f,!![])),loggerfile[_0xddc55d(0x1c0)](util[_0xddc55d(0x292)](parseColor(_0x66125f,![]))+'\x0a');},'full':async _0x5db19a=>{const _0x18f830=_0xda629c,_0x5241b5=getTimeStamp()+_0x18f830(0x2b3)+_0x5db19a;console[_0x18f830(0x2ba)](parseColor(_0x5241b5,!![])),loggerfile[_0x18f830(0x1c0)](util[_0x18f830(0x292)](parseColor(_0x5241b5,![]))+'\x0a');if(tgBot&&settings[_0x18f830(0x1ed)]&&settings[_0x18f830(0x31d)]!=_0x18f830(0x1bd))await sendTelegram(settings['telegramChatId'],_0x18f830(0x267)+parseColor(_0x5db19a,![]));},'debug':async(_0x1388ca,_0x5890aa='')=>{const _0x34ac66=_0xda629c,_0x326edf=getTimeStamp()+_0x34ac66(0x301)+_0x1388ca;if(debugging)console[_0x34ac66(0x2ba)](parseColor(_0x326edf,!![]));loggerfile[_0x34ac66(0x1c0)](util[_0x34ac66(0x292)](parseColor(_0x326edf,![]))+'\x0a');if(_0x5890aa){if(debugging)console[_0x34ac66(0x2ba)](_0x5890aa);loggerfile[_0x34ac66(0x1c0)](util['format'](_0x5890aa)+'\x0a');}}};let terminating=![];process['on'](_0xda629c(0x268),function(_0xdb670){const _0x3c7ada=_0xda629c;_0xdb670['toString']()[_0x3c7ada(0x2e8)](_0x3c7ada(0x321))?(logger['simple'](_0x3c7ada(0x28c)+_0xdb670['port']+_0x3c7ada(0x1de)),process[_0x3c7ada(0x254)]({'terminate':!![]},_0x35eb43=>{})):logger[_0x3c7ada(0x160)](_0xdb670);}),process['on'](_0xda629c(0x205),()=>{const _0x47e9a6=_0xda629c;stopAllBots(),process[_0x47e9a6(0x205)](0x0);}),process['on'](_0xda629c(0x1b7),()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGINT',()=>{const _0x406701=_0xda629c;stopAllBots(),process[_0x406701(0x205)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0xda629c(0x278))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0xda629c(0x309)),app=express(),http=require(_0xda629c(0x2c3))[_0xda629c(0x322)](app);app[_0xda629c(0x1f7)](fileUpload({'useTempFiles':!![]})),app['get'](_0xda629c(0x1ab),async(_0x39228e,_0x37df03)=>{const _0x21d0e8=_0xda629c,_0x156723=_0x39228e[_0x21d0e8(0x328)]['type'],_0x455d70=getClientsWithBotID(_0x21d0e8(0x29b)),_0x2e346b=_0x39228e[_0x21d0e8(0x200)][_0x21d0e8(0x28e)],_0x2cd797=timelyDecrypt(_0x2e346b,![]),_0x139ce4=_0x455d70[_0x21d0e8(0x2d1)](_0x5186ec=>_0x5186ec[_0x21d0e8(0x28e)]==_0x2cd797);if(_0x139ce4){const _0x3153f5=normalizeIP(_0x39228e[_0x21d0e8(0x19a)]['remoteAddress'])['store'],_0xdcfdb4=_0x39228e[_0x21d0e8(0x200)]['tkn'];if(validateAccess(_0xdcfdb4,_0x2cd797,_0x3153f5)[_0x21d0e8(0x29c)])_0x156723=='backup'&&await backupConfigFiles(),await zipFiles(_0x156723),_0x37df03[_0x21d0e8(0x1ba)](zippath+(_0x156723+_0x21d0e8(0x156)),_0x3c34ed=>{const _0x1c94c8=_0x21d0e8;_0x3c34ed&&(logger[_0x1c94c8(0x25e)](_0x1c94c8(0x332)+_0x156723),logger[_0x1c94c8(0x160)](_0x3c34ed));});else logger[_0x21d0e8(0x25e)](_0x21d0e8(0x2d0)+_0x156723+_0x21d0e8(0x311));}else logger[_0x21d0e8(0x25e)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x156723+_0x21d0e8(0x1c1));}),app[_0xda629c(0x2a3)](_0xda629c(0x14c),async(_0x25c120,_0xfc9764)=>{const _0x695ba9=_0xda629c,_0x44264c=getClientsWithBotID(_0x695ba9(0x29b)),_0x45b821=_0x25c120[_0x695ba9(0x200)][_0x695ba9(0x28e)],_0x28178c=timelyDecrypt(_0x45b821,![]),_0x521cda=_0x44264c['find'](_0x2eb3af=>_0x2eb3af[_0x695ba9(0x28e)]==_0x28178c);logger[_0x695ba9(0x342)](_0x695ba9(0x277));if(_0x521cda){const _0x5e480b=normalizeIP(_0x25c120[_0x695ba9(0x19a)][_0x695ba9(0x319)])[_0x695ba9(0x1e9)],_0x17a73e=_0x25c120['headers']['tkn'];if(validateAccess(_0x17a73e,_0x28178c,_0x5e480b)[_0x695ba9(0x29c)]){if(_0x25c120[_0x695ba9(0x21e)]){const _0x21a11b=_0x25c120['files'][_0x695ba9(0x1f9)];await _0x21a11b['mv'](temppath+_0x21a11b[_0x695ba9(0x2e5)]),_0xfc9764[_0x695ba9(0x254)]({'status':!![],'message':_0x695ba9(0x1f3)});const _0xd6a1db=getBotsWithMode();_0xd6a1db[_0x695ba9(0x30f)]>0x0?confirmRestore(temppath,_0x21a11b['name']):unzipFile(temppath,_0x21a11b['name']);}}else logger['full'](_0x695ba9(0x1d1));}else logger[_0x695ba9(0x25e)](_0x695ba9(0x2bb));}),app[_0xda629c(0x1f7)](express['static'](path[_0xda629c(0x252)](__dirname,bbpath2,_0xda629c(0x1d5)))),app[_0xda629c(0x1f7)](express['static'](path[_0xda629c(0x252)](__dirname,bbpath2,_0xda629c(0x1b9)))),app['get']('/',function(_0x3a96d4,_0x333867){const _0x385e35=_0xda629c;_0x333867[_0x385e35(0x20a)](path[_0x385e35(0x252)](__dirname,bbpath2,'build2',_0x385e35(0x22f)));}),app[_0xda629c(0x275)](_0xda629c(0x2df),function(_0x646412,_0x2f0dbb){const _0x572e09=_0xda629c;_0x2f0dbb[_0x572e09(0x20a)](path[_0x572e09(0x252)](__dirname,bbpath2,_0x572e09(0x1b9),_0x572e09(0x22f)));}),app[_0xda629c(0x275)](_0xda629c(0x159),(_0x43816e,_0x15f470)=>{const _0x4ed30d=_0xda629c;_0x15f470[_0x4ed30d(0x20a)](path[_0x4ed30d(0x252)](__dirname,bbpath2,'build',_0x4ed30d(0x22f)));}),app[_0xda629c(0x275)](_0xda629c(0x1d7),(_0x4aff04,_0x11cf85)=>{const _0x97b45d=_0xda629c;_0x11cf85[_0x97b45d(0x20a)](path[_0x97b45d(0x252)](__dirname,bbpath2,'build',_0x97b45d(0x22f)));}),app[_0xda629c(0x275)](_0xda629c(0x1eb),(_0x237e03,_0x668dc5)=>{const _0x3058f4=_0xda629c;_0x668dc5['sendFile'](path[_0x3058f4(0x252)](__dirname,bbpath2,_0x3058f4(0x1b9),_0x3058f4(0x22f)));}),app[_0xda629c(0x275)](_0xda629c(0x31a),(_0x1eed56,_0x279dbe)=>{const _0xa3acf6=_0xda629c;_0x279dbe[_0xa3acf6(0x20a)](path['join'](__dirname,bbpath2,_0xa3acf6(0x1b9),_0xa3acf6(0x22f)));}),app[_0xda629c(0x275)]('/:bot/configuration',(_0x3ebd7b,_0x34ac0a)=>{const _0xb59b25=_0xda629c;_0x34ac0a['sendFile'](path[_0xb59b25(0x252)](__dirname,bbpath2,'build','index.html'));}),app[_0xda629c(0x275)]('/:bot/support',(_0xa1dd63,_0x48c6a1)=>{const _0x31ec9f=_0xda629c;_0x48c6a1[_0x31ec9f(0x20a)](path[_0x31ec9f(0x252)](__dirname,bbpath2,'build',_0x31ec9f(0x22f)));});if(HOST)http[_0xda629c(0x211)](PORT,HOST);else http[_0xda629c(0x211)](PORT);const io=require(_0xda629c(0x300))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x37645a=_0xda629c;let _0x4ead64=_0x37645a(0x2b8);const _0xfb12d4=networkInterfaces(),_0x4b3971={};for(const _0x467d0e of Object[_0x37645a(0x1e2)](_0xfb12d4)){for(const _0xa8976f of _0xfb12d4[_0x467d0e]){if((_0xa8976f['family']=='IPv4'||_0xa8976f[_0x37645a(0x195)]==0x4)&&!_0xa8976f[_0x37645a(0x27a)]){const _0x129e89=ipaddr[_0x37645a(0x1a2)](_0xa8976f[_0x37645a(0x2f3)])[_0x37645a(0x218)]();_0x129e89!=_0x37645a(0x259)&&(!_0x4b3971[_0x467d0e]&&(_0x4b3971[_0x467d0e]=[]),_0x4b3971[_0x467d0e]['push'](_0xa8976f[_0x37645a(0x2f3)]),_0x4ead64=_0xa8976f['address']);}}}return{'serverip':_0x4ead64,'netinterfaces':_0x4b3971};}async function startServer(){const _0x46f3b5=_0xda629c,{serverip:_0x5a2660,netinterfaces:_0x394c64}=getServerIP();logger['simple'](''),logger[_0x46f3b5(0x160)](_0x46f3b5(0x2f4)),await logger['full'](_0x46f3b5(0x31f)+serverversion+_0x46f3b5(0x1bb)+(environment==_0x46f3b5(0x28a)?_0x46f3b5(0x220):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x46f3b5(0x2f6))+(_0x46f3b5(0x1fe)+_0x5a2660+':'+PORT+_0x46f3b5(0x1db))),logger[_0x46f3b5(0x160)](_0x46f3b5(0x2f4));if(config[_0x46f3b5(0x30f)]!=0x0)for(const _0x26f524 of config){const _0x581208=_0x26f524['mode']==_0x46f3b5(0x1b1)?'a':'m';if(_0x26f524[_0x46f3b5(0x21a)]==_0x46f3b5(0x174)||_0x26f524[_0x46f3b5(0x21a)]==_0x46f3b5(0x306))await logger[_0x46f3b5(0x25e)](_0x46f3b5(0x325)+_0x581208+_0x46f3b5(0x192)+_0x26f524[_0x46f3b5(0x222)]+_0x46f3b5(0x294)+_0x26f524['botname']),startBot([_0x26f524['botID'],userID],{'cwd':bbpath},function(_0x36b6c3){const _0x12b1fa=_0x46f3b5;if(_0x36b6c3)logger[_0x12b1fa(0x25e)](_0x36b6c3);});else(_0x26f524[_0x46f3b5(0x21a)]==_0x46f3b5(0x2ca)||_0x26f524[_0x46f3b5(0x21a)]=='new-disabled')&&await logger[_0x46f3b5(0x25e)](_0x46f3b5(0x305)+_0x581208+_0x46f3b5(0x226)+_0x26f524['botID']+_0x46f3b5(0x294)+_0x26f524[_0x46f3b5(0x302)]);}else!newBot&&logger[_0x46f3b5(0x160)](_0x46f3b5(0x1dc));if(newBot)addBot();logger[_0x46f3b5(0x160)](_0x46f3b5(0x2f4)),logger[_0x46f3b5(0x160)](''),await logger[_0x46f3b5(0x342)](_0x46f3b5(0x15f)+nodeversion),await logger['debug'](_0x46f3b5(0x334),_0x394c64);}function startSocket(){const _0x3b70d5=_0xda629c;io['on'](_0x3b70d5(0x207),_0x89d888=>{const _0x4fd1e1=_0x3b70d5;let _0x3677a2,_0x2f551c,_0x5d2efc,_0x50519c,_0x372b45;const _0x3eb0ce=_0x89d888[_0x4fd1e1(0x232)][_0x4fd1e1(0x200)][_0x4fd1e1(0x2fc)];_0x2f551c=_0x3eb0ce[_0x4fd1e1(0x1ad)](/bot[0-9]{3}/);if(_0x2f551c)_0x5d2efc=_0x2f551c[0x0][_0x4fd1e1(0x1ad)](/[0-9]{3}/);if(_0x5d2efc)_0x3677a2=_0x5d2efc[0x0];else _0x3677a2=_0x4fd1e1(0x29b);const _0x2853fc=_0x89d888[_0x4fd1e1(0x232)][_0x4fd1e1(0x256)][_0x4fd1e1(0x2a5)];if(!_0x2853fc)_0x89d888[_0x4fd1e1(0x16d)](_0x4fd1e1(0x21a),{'publicKey':secure[_0x4fd1e1(0x2a0)]});else{_0x50519c=timelyDecrypt(_0x2853fc,![]);if(!_0x50519c)_0x89d888[_0x4fd1e1(0x16d)](_0x4fd1e1(0x21a),{'publicKey':secure[_0x4fd1e1(0x2a0)]});else{_0x372b45=normalizeIP(_0x89d888[_0x4fd1e1(0x240)][_0x4fd1e1(0x319)])['store'];if(!devices[_0x50519c])devices[_0x50519c]={'uuid':_0x50519c,'access':{'token':null}};devices[_0x50519c]['ip']=_0x372b45;const _0x9bb03c=addClient(_0x89d888['id'],_0x50519c,_0x3677a2);setAccess(_0x9bb03c),emitMessages(),_0x89d888['on'](_0x4fd1e1(0x2bf),_0x3976df=>{const _0x1be424=_0x4fd1e1,_0x217e76=timelyDecrypt(_0x3976df[_0x1be424(0x168)],!![],_0x1be424(0x158));if(_0x217e76){_0x3976df={'username':_0x3976df[_0x1be424(0x352)],'password':_0x217e76},devices[_0x50519c]['access']=validateCredentials(_0x3976df,_0x50519c);if(devices[_0x50519c][_0x1be424(0x1c2)]['allow']==![]&&devices[_0x50519c][_0x1be424(0x1c2)]['reason']==_0x1be424(0x1f4))_0x89d888[_0x1be424(0x16d)]('status',{'access':devices[_0x50519c]['access']}),loginAccess2FA(_0x50519c,_0x372b45);else{if(devices[_0x50519c][_0x1be424(0x1c2)]['allow']==![]&&devices[_0x50519c][_0x1be424(0x1c2)][_0x1be424(0x291)]==_0x1be424(0x247))_0x89d888[_0x1be424(0x16d)]('status',{'access':devices[_0x50519c][_0x1be424(0x1c2)]});else devices[_0x50519c]['access'][_0x1be424(0x29c)]&&devices[_0x50519c][_0x1be424(0x1c2)]['reason']==_0x1be424(0x344)&&(getClientsWithUuid(_0x50519c)[_0x1be424(0x20c)](_0x39d865=>{setAccess(_0x39d865);}),logger['debug'](_0x1be424(0x287)+_0x50519c[_0x1be424(0x1bf)](-0x8)),setTokenRefresh(_0x50519c),setSessionTimeout(_0x1be424(0x2bf),_0x50519c));}}else logger['full'](_0x1be424(0x338));}),_0x89d888['on'](_0x4fd1e1(0x137),()=>{resetPassword();}),_0x89d888['on'](_0x4fd1e1(0x22e),_0x141a2d=>{removeClient(_0x89d888['id']);}),_0x3677a2==_0x4fd1e1(0x29b)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1beea2){const _0x256a1d=_0xda629c;if(_0x1beea2!=_0x256a1d(0x29b)&&config[_0x256a1d(0x1f0)]!=''){if(pid[_0x1beea2])pid[_0x1beea2][_0x256a1d(0x254)]({'function':'initclient','args':null});}_0x1beea2!=_0x256a1d(0x29b)&&broadcastToBots('bots',JSON['stringify'](config));}function reloadBotManager(){const _0x514e1e=_0xda629c;getClientsWithBotID('botmanager')[_0x514e1e(0x20c)](_0x59ce36=>{const _0x45efdd=_0x514e1e;getSocket(_0x59ce36['id'])[_0x45efdd(0x16d)]('status',{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x506495){const _0x43da40=_0xda629c,_0x3dc023=io[_0x43da40(0x21b)][_0x43da40(0x275)]('/');return _0x3dc023[_0x43da40(0x21f)][_0x43da40(0x275)](_0x506495);}function setAccess(_0x5c3d46){const _0x7e724e=_0xda629c,_0x341342=getSocket(_0x5c3d46['id']),_0x53466a=_0x5c3d46[_0x7e724e(0x28e)],_0x184645=_0x5c3d46[_0x7e724e(0x18d)];devices[_0x53466a][_0x7e724e(0x1c2)]=validateAccess(devices[_0x53466a]['access']['token'],_0x53466a),logger[_0x7e724e(0x342)](_0x7e724e(0x32f)+devices[_0x53466a][_0x7e724e(0x1c2)][_0x7e724e(0x291)]+_0x7e724e(0x2b9)+_0x5c3d46['id'][_0x7e724e(0x1bf)](-0x8)+'\x20|\x20user:\x20...'+_0x53466a[_0x7e724e(0x1bf)](-0x8)),_0x341342[_0x7e724e(0x252)](_0x53466a);if(devices[_0x53466a][_0x7e724e(0x1c2)]['allow']){_0x341342['join'](_0x184645);if(_0x184645==_0x7e724e(0x29b))initializeSocketBotManager(_0x341342);else initializeSocketBot(_0x341342);initClient(_0x184645);}devices[_0x53466a][_0x7e724e(0x1c2)]['token']&&devices[_0x53466a][_0x7e724e(0x1c2)][_0x7e724e(0x291)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x7e724e(0x194),_0x53466a),devices[_0x53466a][_0x7e724e(0x1c2)][_0x7e724e(0x330)]&&devices[_0x53466a][_0x7e724e(0x1c2)]['reason']=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x7e724e(0x2bf),_0x53466a),_0x341342['emit'](_0x7e724e(0x21a),{'status':_0x5c3d46['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x53466a][_0x7e724e(0x1c2)],'externalip':devices[_0x53466a]['ip'],'publicKey':secure[_0x7e724e(0x2a0)],'userid':settings[_0x7e724e(0x177)],'validInstallation':validInstallation}),devices[_0x53466a][_0x7e724e(0x1c2)][_0x7e724e(0x29c)]==![]&&devices[_0x53466a]['access'][_0x7e724e(0x291)]==_0x7e724e(0x190)&&temporaryAccess2FA(_0x53466a,devices[_0x53466a]['ip']);}function setSessionTimeout(_0x1dcd03,_0x1a4f25){const _0x2410a5=_0xda629c;let _0x306f23;if(_0x1dcd03=='login')_0x306f23=loginExpiry*0x3c*0x3e8;else _0x306f23=devices[_0x1a4f25]['telegramIpApproval']['expiry']*0x3c*0x3e8-(new Date()[_0x2410a5(0x25b)]()-devices[_0x1a4f25][_0x2410a5(0x2e4)][_0x2410a5(0x150)]);if(devices[_0x1a4f25][_0x2410a5(0x249)])clearTimeout(devices[_0x1a4f25][_0x2410a5(0x249)]);devices[_0x1a4f25][_0x2410a5(0x249)]=setTimeout(()=>{const _0x263639=_0x2410a5;if(devices[_0x1a4f25][_0x263639(0x17e)])clearTimeout(devices[_0x1a4f25][_0x263639(0x17e)]);removeSocketListeners(_0x1a4f25),addBlacklist(_0x1a4f25),devices[_0x1a4f25][_0x263639(0x2e4)]=null,devices[_0x1a4f25][_0x263639(0x173)]=null,devices[_0x1a4f25][_0x263639(0x1c2)][_0x263639(0x330)]=null,logger[_0x263639(0x342)](_0x263639(0x16a)+_0x1a4f25['slice'](-0x8)),devices[_0x1a4f25][_0x263639(0x1c2)]=validateAccess(devices[_0x1a4f25][_0x263639(0x1c2)][_0x263639(0x330)],_0x1a4f25),!(devices[_0x1a4f25][_0x263639(0x1c2)]['allow']&&devices[_0x1a4f25]['access'][_0x263639(0x291)]==_0x263639(0x241))&&(_0x1dcd03=='login'?io['to'](_0x1a4f25)[_0x263639(0x16d)]('status',{'access':{'allow':![],'reason':_0x263639(0x318),'token':null}}):io['to'](_0x1a4f25)[_0x263639(0x16d)]('status',{'access':{'allow':![],'reason':_0x263639(0x2dd),'token':null}})),devices[_0x1a4f25][_0x263639(0x1c2)][_0x263639(0x330)]=null;},_0x306f23);}function setTokenRefresh(_0x5eaa19){const _0x1766a8=_0xda629c;if(devices[_0x5eaa19][_0x1766a8(0x17e)])clearTimeout(devices[_0x5eaa19][_0x1766a8(0x17e)]);devices[_0x5eaa19][_0x1766a8(0x17e)]=setTimeout(()=>{const _0x46387c=_0x1766a8;getClientsWithUuid(_0x5eaa19)[_0x46387c(0x30f)]!=0x0?(devices[_0x5eaa19][_0x46387c(0x1c2)]=refreshToken(_0x5eaa19),io['to'](_0x5eaa19)['emit']('status',{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x5eaa19]['access'],'externalip':devices[_0x5eaa19]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x5eaa19)):clearTimeout(devices[_0x5eaa19][_0x46387c(0x17e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x531c1b){const _0x114ba4=_0xda629c,_0x3d472d=getClient(_0x531c1b['id'])[_0x114ba4(0x28e)];_0x531c1b[_0x114ba4(0x16d)](_0x114ba4(0x244),config),_0x531c1b[_0x114ba4(0x16d)](_0x114ba4(0x14e),cleanSettings()),_0x531c1b['on'](_0x114ba4(0x146),_0x8e7da6=>{const _0x156423=_0x114ba4;if(validateAccess(_0x8e7da6,_0x3d472d)[_0x156423(0x29c)])addBot();else logger[_0x156423(0x25e)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x531c1b['on']('update-bot',(_0x152d7b,_0x5c0ad0)=>{const _0x41117e=_0x114ba4;if(validateAccess(_0x5c0ad0,_0x3d472d)['allow'])toggleBot(_0x152d7b['botID'],_0x152d7b[_0x41117e(0x21a)],_0x152d7b['live']);else logger[_0x41117e(0x25e)](_0x41117e(0x1e4));}),_0x531c1b['on'](_0x114ba4(0x31e),(_0x3cd1cc,_0x596c37)=>{const _0xaa8550=_0x114ba4;if(validateAccess(_0x596c37,_0x3d472d)[_0xaa8550(0x29c)])toggleBotMode(_0x3cd1cc);else logger[_0xaa8550(0x25e)](_0xaa8550(0x1e4));}),_0x531c1b['on']('delete-bot',(_0x48d519,_0x22897f)=>{const _0x1d9d99=_0x114ba4;if(validateAccess(_0x22897f,_0x3d472d)[_0x1d9d99(0x29c)])deleteBot(_0x48d519);else logger[_0x1d9d99(0x25e)](_0x1d9d99(0x22d));}),_0x531c1b['on'](_0x114ba4(0x1e0),(_0x331487,_0x5e6deb)=>{const _0x40bc5b=_0x114ba4;if(validateAccess(_0x5e6deb,_0x3d472d)['allow'])storeSettings(_0x331487,!![]);else logger[_0x40bc5b(0x25e)](_0x40bc5b(0x2a9));}),_0x531c1b['on'](_0x114ba4(0x216),_0x68be4c=>{const _0x878de6=_0x114ba4;if(validateAccess(_0x68be4c,_0x3d472d)[_0x878de6(0x29c)])updateBB(_0x878de6(0x2b5));else logger[_0x878de6(0x25e)](_0x878de6(0x1aa));}),_0x531c1b['on'](_0x114ba4(0x17c),_0x38d1a0=>{const _0x49e425=_0x114ba4;if(validateAccess(_0x38d1a0,_0x3d472d)[_0x49e425(0x29c)])updateBB(_0x49e425(0x23e));else logger[_0x49e425(0x25e)](_0x49e425(0x281));}),_0x531c1b['on'](_0x114ba4(0x2c4),_0x3cd2ce=>{const _0x4f2935=_0x114ba4;if(validateAccess(_0x3cd2ce,_0x3d472d)[_0x4f2935(0x29c)]){const _0x56f328=getClient(_0x531c1b['id']);if(_0x56f328)getBackupFiles(_0x56f328['uuid']);else logger['full'](_0x4f2935(0x350));}else logger[_0x4f2935(0x25e)](_0x4f2935(0x22c));}),_0x531c1b['on'](_0x114ba4(0x238),(_0x4569b6,_0x751d1e)=>{const _0x4ba5dd=_0x114ba4;if(validateAccess(_0x751d1e,_0x3d472d)[_0x4ba5dd(0x29c)])restoreBackupFile(_0x4569b6);else logger[_0x4ba5dd(0x25e)]('Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file');}),_0x531c1b['on'](_0x114ba4(0x212),_0x436565=>{const _0x39b49b=_0x114ba4;if(validateAccess(_0x436565,_0x3d472d)[_0x39b49b(0x29c)])getMessages();else logger[_0x39b49b(0x25e)](_0x39b49b(0x14b));}),_0x531c1b['on'](_0x114ba4(0x2a6),(_0x2f77d7,_0x20689a)=>{const _0x3e695d=_0x114ba4;if(validateAccess(_0x20689a,_0x3d472d)['allow'])confirmMessage(_0x2f77d7);else logger[_0x3e695d(0x25e)](_0x3e695d(0x185));}),_0x531c1b['on']('logout',_0xf0d8ec=>{const _0x28b701=_0x114ba4;if(validateAccess(_0xf0d8ec,_0x3d472d)['allow']){if(devices[_0x3d472d][_0x28b701(0x17e)])clearTimeout(devices[_0x3d472d][_0x28b701(0x17e)]);if(devices[_0x3d472d][_0x28b701(0x249)])clearTimeout(devices[_0x3d472d][_0x28b701(0x249)]);removeSocketListeners(getClient(_0x531c1b['id'])['uuid']),addBlacklist(_0x3d472d),devices[_0x3d472d][_0x28b701(0x2e4)]=null,devices[_0x3d472d]['telegram2FaApproval']=null,devices[_0x3d472d][_0x28b701(0x1c2)][_0x28b701(0x330)]=null,logger['debug'](_0x28b701(0x23c)+_0x3d472d['slice'](-0x8)),io['to'](getClient(_0x531c1b['id'])[_0x28b701(0x28e)])[_0x28b701(0x16d)](_0x28b701(0x21a),{'access':{'allow':![],'reason':_0x28b701(0x2dc),'token':null}});}else logger['full'](_0x28b701(0x179));});}function initializeSocketBot(_0xe29ec){const _0x4c9d56=_0xda629c,_0x4286de=getClient(_0xe29ec['id'])[_0x4c9d56(0x18d)],_0x2fccb7=getClient(_0xe29ec['id'])[_0x4c9d56(0x28e)];_0xe29ec['on']('get-logs',(_0x305484,_0xe3b9a4)=>{const _0x566d10=_0x4c9d56;if(validateAccess(_0xe3b9a4,_0x2fccb7)[_0x566d10(0x29c)]){if(pid[_0x4286de])pid[_0x4286de][_0x566d10(0x254)]({'function':_0x566d10(0x1c9),'args':_0x305484});}else logger[_0x566d10(0x25e)](_0x566d10(0x229));}),_0xe29ec['on'](_0x4c9d56(0x2d5),(_0x4d733c,_0x490a91)=>{const _0x17c123=_0x4c9d56;if(validateAccess(_0x490a91,_0x2fccb7)['allow']){if(pid[_0x4286de])pid[_0x4286de]['send']({'function':_0x17c123(0x134),'args':_0x4d733c});}else logger[_0x17c123(0x25e)](_0x17c123(0x1d4));}),_0xe29ec['on'](_0x4c9d56(0x19d),(_0x76cbc8,_0x5f2c35)=>{const _0x377e46=_0x4c9d56;if(validateAccess(_0x5f2c35,_0x2fccb7)[_0x377e46(0x29c)]){if(pid[_0x4286de])pid[_0x4286de][_0x377e46(0x254)]({'function':_0x377e46(0x264),'args':_0x76cbc8});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0xe29ec['on'](_0x4c9d56(0x26f),(_0x1418ca,_0xbba3c7)=>{const _0x5aea07=_0x4c9d56;if(validateAccess(_0xbba3c7,_0x2fccb7)[_0x5aea07(0x29c)]){if(pid[_0x4286de])pid[_0x4286de][_0x5aea07(0x254)]({'function':_0x5aea07(0x2a7),'args':_0x1418ca});}else logger[_0x5aea07(0x25e)](_0x5aea07(0x269));}),_0xe29ec['on'](_0x4c9d56(0x2c7),(_0xba61ae,_0x102f07)=>{const _0x19e654=_0x4c9d56;if(validateAccess(_0x102f07,_0x2fccb7)['allow']){if(pid[_0x4286de])pid[_0x4286de][_0x19e654(0x254)]({'function':_0x19e654(0x31b),'args':_0xba61ae});}else logger[_0x19e654(0x25e)](_0x19e654(0x290));}),_0xe29ec['on']('store-fiat',(_0x34b495,_0x2e1dec)=>{const _0x6d96fd=_0x4c9d56;if(validateAccess(_0x2e1dec,_0x2fccb7)[_0x6d96fd(0x29c)]){if(pid[_0x4286de])pid[_0x4286de][_0x6d96fd(0x254)]({'function':_0x6d96fd(0x27d),'args':_0x34b495});}else logger[_0x6d96fd(0x25e)](_0x6d96fd(0x13b));}),_0xe29ec['on'](_0x4c9d56(0x280),_0x24326a=>{const _0x2b6bc7=_0x4c9d56;if(validateAccess(_0x24326a,_0x2fccb7)[_0x2b6bc7(0x29c)]){if(pid[_0x4286de])pid[_0x4286de][_0x2b6bc7(0x254)]({'function':'resetHistory','args':null});}else logger['full'](_0x2b6bc7(0x33d));}),_0xe29ec['on'](_0x4c9d56(0x30b),_0xe65d60=>{const _0x3bcc17=_0x4c9d56;if(validateAccess(_0xe65d60,_0x2fccb7)['allow']){if(pid[_0x4286de])pid[_0x4286de][_0x3bcc17(0x254)]({'function':'getStartingBalances','args':null});}else logger[_0x3bcc17(0x25e)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0xe29ec['on']('place-order',(_0x493c41,_0x5489f7)=>{const _0x1b0014=_0x4c9d56;if(validateAccess(_0x5489f7,_0x2fccb7)[_0x1b0014(0x29c)]){if(pid[_0x4286de])pid[_0x4286de][_0x1b0014(0x254)]({'function':'placeOrder','args':_0x493c41});}else logger['full'](_0x1b0014(0x2c1));}),_0xe29ec['on'](_0x4c9d56(0x2d8),_0x17b737=>{const _0x1c9fb9=_0x4c9d56;if(validateAccess(_0x17b737,_0x2fccb7)[_0x1c9fb9(0x29c)]){if(pid[_0x4286de])pid[_0x4286de][_0x1c9fb9(0x254)]({'function':_0x1c9fb9(0x23f),'args':null});}else logger[_0x1c9fb9(0x25e)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0xe29ec['on'](_0x4c9d56(0x31c),_0x55d822=>{const _0x10ff62=_0x4c9d56;if(validateAccess(_0x55d822,_0x2fccb7)[_0x10ff62(0x29c)]){if(pid[_0x4286de])pid[_0x4286de][_0x10ff62(0x254)]({'function':_0x10ff62(0x1f6),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0xe29ec['on']('update-bb',_0x16c7dc=>{const _0x19a61c=_0x4c9d56;if(validateAccess(_0x16c7dc,_0x2fccb7)['allow'])updateBB(_0x19a61c(0x2b5));else logger['full'](_0x19a61c(0x1aa));}),_0xe29ec['on'](_0x4c9d56(0x212),_0x58c443=>{const _0x171eb1=_0x4c9d56;if(validateAccess(_0x58c443,_0x2fccb7)[_0x171eb1(0x29c)])getMessages();else logger[_0x171eb1(0x25e)](_0x171eb1(0x14b));}),_0xe29ec['on'](_0x4c9d56(0x2a6),(_0x400bad,_0x3bb99d)=>{const _0x349d33=_0x4c9d56;if(validateAccess(_0x3bb99d,_0x2fccb7)[_0x349d33(0x29c)])confirmMessage(_0x400bad);else logger['full'](_0x349d33(0x185));}),_0xe29ec['on']('logout',_0x1d0ac5=>{const _0xb44fbe=_0x4c9d56;if(validateAccess(_0x1d0ac5,_0x2fccb7)['allow']){if(devices[_0x2fccb7][_0xb44fbe(0x17e)])clearTimeout(devices[_0x2fccb7][_0xb44fbe(0x17e)]);if(devices[_0x2fccb7][_0xb44fbe(0x249)])clearTimeout(devices[_0x2fccb7]['pidExpireLogin']);removeSocketListeners(getClient(_0xe29ec['id'])[_0xb44fbe(0x28e)]),addBlacklist(_0x2fccb7),devices[_0x2fccb7][_0xb44fbe(0x2e4)]=null,devices[_0x2fccb7][_0xb44fbe(0x173)]=null,devices[_0x2fccb7][_0xb44fbe(0x1c2)][_0xb44fbe(0x330)]=null,logger[_0xb44fbe(0x342)](_0xb44fbe(0x23c)+_0x2fccb7[_0xb44fbe(0x1bf)](-0x8)),io['to'](getClient(_0xe29ec['id'])[_0xb44fbe(0x28e)])[_0xb44fbe(0x16d)]('status',{'access':{'allow':![],'reason':_0xb44fbe(0x2dc),'token':null}});}else logger[_0xb44fbe(0x25e)](_0xb44fbe(0x179));});}function removeSocketListeners(_0x8891c0){getClientsWithUuid(_0x8891c0)['forEach'](_0xc50566=>{const _0xe3e4a3=_0x529b;getSocket(_0xc50566['id'])[_0xe3e4a3(0x303)]();});}function cleanSettings(){const _0x17141f=_0xda629c;let _0xaa671c=settings;return settings[_0x17141f(0x18f)]&&settings[_0x17141f(0x18f)]!=''&&(_0xaa671c={..._0xaa671c,'telegramToken':_0x17141f(0x253)}),settings['bbPassword']&&settings[_0x17141f(0x1a8)]!=''&&(_0xaa671c={..._0xaa671c,'bbPassword':'************'}),settings[_0x17141f(0x231)]&&settings['marketcapApi']!=''&&(_0xaa671c={..._0xaa671c,'marketcapApi':'************'}),(settings['bbPassword']&&settings['bbPassword']==_0x17141f(0x1ef)||settings['telegramToken']&&settings['telegramToken']=='***'||settings['marketcapApi']&&settings[_0x17141f(0x231)]=='***')&&(_0xaa671c={..._0xaa671c,'restored':{'password':settings[_0x17141f(0x1a8)]==_0x17141f(0x1ef),'telegram':settings[_0x17141f(0x18f)]=='***','marketcap':settings[_0x17141f(0x231)]==_0x17141f(0x1ef)}}),_0xaa671c;}async function updateBB(_0x30fab6){const _0x4bb1ac=_0xda629c;await backupConfigFiles(),installingUpdate=!![],config[_0x4bb1ac(0x20c)](_0xaf9306=>{restartBot(_0xaf9306['botID']);});if(_0x30fab6==_0x4bb1ac(0x2b5))process[_0x4bb1ac(0x254)]({'update':!![],'environment':environment},_0xed1eb1=>{});else _0x30fab6==_0x4bb1ac(0x23e)&&process[_0x4bb1ac(0x254)]({'reinstall':!![],'environment':environment},_0x3ac131=>{});}function startBot(_0x5efb88,_0x4b74d5,_0x437a1d){const _0x5c3875=_0xda629c;if(debugging)_0x5efb88['push']('-d');if(recreate)_0x5efb88[_0x5c3875(0x333)]('-r');let _0xbf39a3=![];const _0x215085=_0x5efb88[0x0];_0x4b74d5={..._0x4b74d5,'stdio':[_0x5c3875(0x2ec),_0x5c3875(0x2ec),_0x5c3875(0x2ec),_0x5c3875(0x1b5)]},pid[_0x215085]=childProcess[_0x5c3875(0x2e1)](botfile,_0x5efb88,_0x4b74d5),pid[_0x215085]['on'](_0x5c3875(0x293),_0x544026=>{const _0x54bdfa=_0x5c3875;switch(Object[_0x54bdfa(0x1e2)](_0x544026)[0x0]){case _0x54bdfa(0x302):updateBotName(_0x215085,_0x544026[_0x54bdfa(0x302)]);break;case _0x54bdfa(0x2e9):updateBotManager();break;case _0x54bdfa(0x21a):updateStatus(_0x215085,_0x544026['status']);break;case _0x54bdfa(0x15e):updateLive(_0x215085,_0x544026[_0x54bdfa(0x15e)]);break;case _0x54bdfa(0x230):updateLive(_0x215085,_0x544026[_0x54bdfa(0x230)]),io['to'](_0x215085)[_0x54bdfa(0x16d)](_0x54bdfa(0x21a),{'access':{'allow':![],'reason':_0x54bdfa(0x187),'token':null}});break;case _0x54bdfa(0x138):_0x544026['stop']==_0x54bdfa(0x337)&&restartBot(_0x215085);_0x544026[_0x54bdfa(0x138)]==_0x54bdfa(0x30c)&&toggleBot(_0x215085,'disabled','stopped');break;case _0x54bdfa(0x1fd):sendTelegramBot(_0x215085,_0x544026[_0x54bdfa(0x1fd)]);break;case'telegrammsg':sendTelegramMsg(_0x544026[_0x54bdfa(0x142)]);break;case _0x54bdfa(0x2ff):io['to'](_0x215085)[_0x54bdfa(0x16d)](_0x544026[_0x54bdfa(0x2ff)],_0x544026[_0x54bdfa(0x2f8)]);break;}}),pid[_0x215085]['on'](_0x5c3875(0x20b),function(_0x3ac3fb){if(_0xbf39a3)return;_0xbf39a3=!![],_0x437a1d(_0x3ac3fb);}),pid[_0x215085]['on'](_0x5c3875(0x205),async function(_0x26304f){const _0x1abef5=_0x5c3875;if(terminating)return;if(installingUpdate){io[_0x1abef5(0x2af)]();return;}if(_0xbf39a3)return;_0xbf39a3=!![],_0x437a1d(null);const _0x578780=dbConfig[_0x1abef5(0x275)]('bots')[_0x1abef5(0x2d1)]({'botID':_0x215085})[_0x1abef5(0x1ca)]();_0x578780&&(_0x578780[_0x1abef5(0x21a)]==_0x1abef5(0x174)||_0x578780[_0x1abef5(0x21a)]=='new')&&(await sleep(0x3e8),updateLive(_0x215085,_0x1abef5(0x2a8)),logger[_0x1abef5(0x25e)](_0x1abef5(0x283)+_0x215085),startBot([_0x215085,userID],{'cwd':bbpath},function(_0x3d3af2){if(_0x3d3af2)logger['full'](_0x3d3af2);}));});}function stopBot(_0x5b68b3){const _0x4d7280=_0xda629c;getClientsWithBotID(_0x5b68b3)[_0x4d7280(0x20c)](_0x1d514f=>{const _0x4f387c=_0x4d7280;getSocket(_0x1d514f['id'])[_0x4f387c(0x22e)](!![]),removeClient(_0x1d514f['id']);}),pid[_0x5b68b3]&&(pid[_0x5b68b3]['kill'](),pid[_0x5b68b3]=null);}function stopAllBots(){const _0x2643ba=_0xda629c;terminating=!![];const _0x182d2c=getEnabledBots();_0x182d2c[_0x2643ba(0x20c)](_0x5c2c4e=>{const _0x2c1f4c=_0x2643ba;stopBot(_0x5c2c4e[_0x2c1f4c(0x222)]);});}function restartBot(_0x3dc246){const _0x40038b=_0xda629c;if(pid[_0x3dc246])pid[_0x3dc246][_0x40038b(0x30c)]();}function addBot(){const _0x265a9a=_0xda629c;let _0x1eb302;for(let _0x52fa50=0x1;_0x52fa50<0x3e9;_0x52fa50++){_0x1eb302=_0x52fa50[_0x265a9a(0x345)]()['padStart'](0x3,'0');let _0x5aae83=config['find'](_0x146c4c=>_0x146c4c[_0x265a9a(0x222)]==_0x1eb302);if(!_0x5aae83)break;}if(_0x1eb302===_0x265a9a(0x1a9)){logger[_0x265a9a(0x25e)](_0x265a9a(0x167));return;}logger['full'](_0x265a9a(0x339)+_0x1eb302),dbConfig['get'](_0x265a9a(0x244))['push']({'botID':_0x1eb302,'botname':_0x265a9a(0x24b)+_0x1eb302,'status':'new','live':''})['write'](),startBot([_0x1eb302,userID],{'cwd':bbpath},function(_0x4eb595){const _0x2f3493=_0x265a9a;if(_0x4eb595)logger[_0x2f3493(0x25e)](_0x4eb595);}),config=getConfiguration(),io['to'](_0x265a9a(0x29b))['emit'](_0x265a9a(0x244),config),broadcastToBots(_0x265a9a(0x244),JSON['stringify'](config));}function deleteBot(_0x1e300f){const _0x435260=_0xda629c;getClientsWithBotID(_0x1e300f)[_0x435260(0x20c)](_0x4cfd2f=>{const _0x306012=_0x435260;getSocket(_0x4cfd2f['id'])[_0x306012(0x22e)](!![]),removeClient(_0x4cfd2f['id']);}),dbConfig[_0x435260(0x275)](_0x435260(0x244))[_0x435260(0x2ee)]({'botID':_0x1e300f})[_0x435260(0x1c0)](),logger[_0x435260(0x25e)]('Deleted\x20Bot\x20'+_0x1e300f),stopBot(_0x1e300f);try{if(fs['existsSync'](path[_0x435260(0x252)](configpath,_0x435260(0x2be)+_0x1e300f+_0x435260(0x1c5))))fs[_0x435260(0x239)](path['join'](configpath,_0x435260(0x2be)+_0x1e300f+_0x435260(0x1c5)));if(fs[_0x435260(0x180)](path[_0x435260(0x252)](configpath,_0x435260(0x2be)+_0x1e300f+'-events.json')))fs[_0x435260(0x239)](path[_0x435260(0x252)](configpath,_0x435260(0x2be)+_0x1e300f+_0x435260(0x263)));if(fs[_0x435260(0x180)](path[_0x435260(0x252)](configpath,_0x435260(0x2be)+_0x1e300f+'-performance.json')))fs[_0x435260(0x239)](path['join'](configpath,_0x435260(0x2be)+_0x1e300f+_0x435260(0x1be)));if(fs[_0x435260(0x180)](path[_0x435260(0x252)](configpath,_0x435260(0x2be)+_0x1e300f+_0x435260(0x15b))))fs['unlinkSync'](path[_0x435260(0x252)](configpath,_0x435260(0x2be)+_0x1e300f+_0x435260(0x15b)));}catch(_0x371581){if(_0x371581)logger[_0x435260(0x25e)](_0x435260(0x165),_0x371581);}config=getConfiguration(),io['to'](_0x435260(0x29b))[_0x435260(0x16d)](_0x435260(0x244),config),broadcastToBots(_0x435260(0x244),JSON[_0x435260(0x2c8)](config));}function toggleBot(_0x10a00e,_0x1ec13a,_0x268ff9){const _0x2112a7=_0xda629c;dbConfig[_0x2112a7(0x275)](_0x2112a7(0x244))[_0x2112a7(0x2d1)]({'botID':_0x10a00e})[_0x2112a7(0x346)]({'status':_0x1ec13a})[_0x2112a7(0x346)]({'live':_0x268ff9})[_0x2112a7(0x1c0)]();if(_0x1ec13a=='enabled'||_0x1ec13a=='new')logger[_0x2112a7(0x25e)](_0x2112a7(0x2c2)+_0x10a00e),startBot([_0x10a00e,userID],{'cwd':bbpath},function(_0x530968){if(_0x530968)logger['full'](_0x530968);});else(_0x1ec13a==_0x2112a7(0x2ca)||_0x1ec13a==_0x2112a7(0x272))&&(logger[_0x2112a7(0x25e)](_0x2112a7(0x2ac)+_0x10a00e),stopBot(_0x10a00e));config=getConfiguration(),io['to'](_0x2112a7(0x29b))[_0x2112a7(0x16d)](_0x2112a7(0x244),config),broadcastToBots(_0x2112a7(0x244),JSON[_0x2112a7(0x2c8)](config));}function toggleStatus(_0x408c11){const _0x10cb3d=_0xda629c;let _0x425167=dbConfig[_0x10cb3d(0x275)](_0x10cb3d(0x244))[_0x10cb3d(0x2d1)]({'botID':_0x408c11})[_0x10cb3d(0x1ca)](),_0x5484b1;if(_0x425167[_0x10cb3d(0x21a)]==='enabled')_0x5484b1=_0x10cb3d(0x2ca);else{if(_0x425167['status']==='new')_0x5484b1=_0x10cb3d(0x272);else{if(_0x425167[_0x10cb3d(0x21a)]===_0x10cb3d(0x272))_0x5484b1=_0x10cb3d(0x306);else{if(_0x425167[_0x10cb3d(0x21a)]===_0x10cb3d(0x2ca))_0x5484b1=_0x10cb3d(0x174);}}}return _0x5484b1;}function updateStatus(_0x550a9c,_0xa7f3f5){const _0x2259ea=_0xda629c;dbConfig['get']('bots')[_0x2259ea(0x2d1)]({'botID':_0x550a9c})[_0x2259ea(0x346)]({'status':_0xa7f3f5})[_0x2259ea(0x1c0)](),config=getConfiguration(),io['to'](_0x2259ea(0x29b))[_0x2259ea(0x16d)](_0x2259ea(0x244),config),broadcastToBots(_0x2259ea(0x244),JSON['stringify'](config));}function updateLive(_0x4b05a2,_0x1c450d){const _0x3f182f=_0xda629c;dbConfig[_0x3f182f(0x275)](_0x3f182f(0x244))[_0x3f182f(0x2d1)]({'botID':_0x4b05a2})[_0x3f182f(0x346)]({'live':_0x1c450d})[_0x3f182f(0x1c0)](),config=getConfiguration(),io['to'](_0x3f182f(0x29b))[_0x3f182f(0x16d)](_0x3f182f(0x244),config),broadcastToBots(_0x3f182f(0x244),JSON[_0x3f182f(0x2c8)](config));}function updateBotName(_0x4c82b5,_0x52a406){const _0x234c8d=_0xda629c;dbConfig[_0x234c8d(0x275)](_0x234c8d(0x244))['find']({'botID':_0x4c82b5})[_0x234c8d(0x346)]({'botname':_0x52a406})[_0x234c8d(0x1c0)](),config=getConfiguration(),io['to'](_0x234c8d(0x29b))[_0x234c8d(0x16d)](_0x234c8d(0x244),config),broadcastToBots(_0x234c8d(0x244),JSON[_0x234c8d(0x2c8)](config));}function updateBotManager(){const _0x2d2236=_0xda629c;config=getConfiguration(),io['to'](_0x2d2236(0x29b))[_0x2d2236(0x16d)](_0x2d2236(0x244),config),broadcastToBots('bots',JSON[_0x2d2236(0x2c8)](config));}function toggleBotMode(_0x559c55){const _0x58ad22=_0xda629c;if(pid[_0x559c55])pid[_0x559c55][_0x58ad22(0x254)]({'function':'toggleBotMode','args':null});else{const _0x36fe5e=configpath+_0x58ad22(0x2be)+_0x559c55+_0x58ad22(0x1c5),_0x2de8a6=fs[_0x58ad22(0x235)](_0x36fe5e),_0x440a24=JSON['parse'](_0x2de8a6),_0x43860f=_0x440a24['bot'][0x0][_0x58ad22(0x242)];_0x440a24[_0x58ad22(0x18d)][0x0]['headless']=!_0x43860f;const _0x49eb7f=JSON[_0x58ad22(0x2c8)](_0x440a24,null,0x2);fs[_0x58ad22(0x1e6)](_0x36fe5e,_0x49eb7f),config=getConfiguration(),io['to'](_0x58ad22(0x29b))[_0x58ad22(0x16d)](_0x58ad22(0x244),config),broadcastToBots(_0x58ad22(0x244),JSON[_0x58ad22(0x2c8)](config));}}function validateTelegram(_0x283dce){const _0x27e7f6=_0xda629c;if(_0x283dce[_0x27e7f6(0x30e)][_0x27e7f6(0x352)]!=settings[_0x27e7f6(0x26c)]&&'@'+_0x283dce[_0x27e7f6(0x30e)][_0x27e7f6(0x352)]!=settings[_0x27e7f6(0x26c)]||_0x283dce[_0x27e7f6(0x143)]['id']!=settings[_0x27e7f6(0x1ed)])return sendTelegram(_0x283dce['chat']['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x27e7f6(0x2f5)}),![];return!![];}async function initTelegram(){const _0x238578=_0xda629c;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x238578(0x18f)]);let _0xf7710e='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0xf7710e+='\x0a',_0xf7710e+=_0x238578(0x204),_0xf7710e+=_0x238578(0x140),_0xf7710e+=_0x238578(0x1d8),_0xf7710e+=_0x238578(0x248),_0xf7710e+='/on\x20-\x20start\x20bot(s)\x0a',_0xf7710e+=_0x238578(0x228),_0xf7710e+=_0x238578(0x27e),_0xf7710e+='/names\x20-\x20show\x20bot\x20names\x0a',_0xf7710e+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0xf7710e+=_0x238578(0x1cc),_0xf7710e+=_0x238578(0x17d),_0xf7710e+='/logs\x20-\x20receive\x20log\x20files\x0a',_0xf7710e+=_0x238578(0x1cf),_0xf7710e+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0xf7710e+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0xf7710e+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x2483e4=_0x238578(0x34e);_0x2483e4+='\x0a',_0x2483e4+=_0xf7710e,tgBot[_0x238578(0x34d)]((_0x442b13,_0x3ba2c1)=>{const _0x401acd=_0x238578;logger[_0x401acd(0x160)](getTimeStamp()+_0x401acd(0x181)),logger['debug'](_0x401acd(0x214),_0x442b13);}),tgBot[_0x238578(0x1f7)](async(_0x123287,_0x5182ca)=>{const _0x45b60d=_0x238578;if(settings['telegramChatId']||_0x123287[_0x45b60d(0x2b5)][_0x45b60d(0x293)][_0x45b60d(0x1a6)]!='/start'){if(!validateTelegram(_0x123287))return;}_0x5182ca();}),tgBot['command'](_0x238578(0x2f1),async _0x5032f6=>{const _0x9ba272=_0x238578;if(_0x5032f6[_0x9ba272(0x30e)][_0x9ba272(0x352)]==settings[_0x9ba272(0x26c)]||'@'+_0x5032f6[_0x9ba272(0x30e)][_0x9ba272(0x352)]==settings['telegramUsername']){if(!settings[_0x9ba272(0x1ed)])updateSetting('telegramChatId',_0x5032f6[_0x9ba272(0x143)]['id']);else{if(!validateTelegram(_0x5032f6))return;}}else{if(!validateTelegram(_0x5032f6))return;}updateSetting('telegramEnabled',!![]),await sendTelegram(_0x5032f6['chat']['id'],_0x2483e4);}),tgBot['command'](_0x238578(0x289),async _0x7675d5=>{const _0x166d52=_0x238578;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x7675d5[_0x166d52(0x143)]['id'],'Notifications\x20enabled');}),tgBot[_0x238578(0x145)](_0x238578(0x24a),async _0x3e3cb2=>{const _0x14aa5d=_0x238578;await sendTelegram(_0x3e3cb2['chat']['id'],_0x14aa5d(0x2a4)),updateSetting(_0x14aa5d(0x2d2),![]);}),tgBot['command'](_0x238578(0x2b1),async _0x3ed290=>{const _0x1be121=_0x238578,_0x4c552b=Markup[_0x1be121(0x162)]([Markup[_0x1be121(0x317)][_0x1be121(0x19f)](_0x1be121(0x349),_0x1be121(0x1fa)),Markup[_0x1be121(0x317)]['callback'](_0x1be121(0x2f7),'config_alerts'),Markup[_0x1be121(0x317)]['callback'](_0x1be121(0x1f2),'config_all')]);_0x3ed290[_0x1be121(0x1fb)](_0x1be121(0x251),_0x4c552b);}),tgBot[_0x238578(0x34a)](_0x238578(0x1fa),async _0x337fc1=>{const _0x3bc1e6=_0x238578;_0x337fc1['editMessageReplyMarkup'](),updateSetting(_0x3bc1e6(0x31d),_0x3bc1e6(0x1bd)),updateSetting(_0x3bc1e6(0x2d2),!![]),await sendTelegram(_0x337fc1['chat']['id'],_0x3bc1e6(0x295));}),tgBot[_0x238578(0x34a)]('config_alerts',async _0x166ddc=>{const _0x2ef5a6=_0x238578;_0x166ddc[_0x2ef5a6(0x29e)](),updateSetting('telegramEvents',_0x2ef5a6(0x20e)),updateSetting(_0x2ef5a6(0x2d2),!![]),await sendTelegram(_0x166ddc['chat']['id'],_0x2ef5a6(0x273));}),tgBot[_0x238578(0x34a)](_0x238578(0x285),async _0x4929e1=>{const _0x8c1fe4=_0x238578;_0x4929e1[_0x8c1fe4(0x29e)](),updateSetting(_0x8c1fe4(0x31d),_0x8c1fe4(0x2cc)),updateSetting(_0x8c1fe4(0x2d2),!![]),await sendTelegram(_0x4929e1['chat']['id'],_0x8c1fe4(0x26b));}),tgBot[_0x238578(0x145)](_0x238578(0x21a),async _0x34766d=>{const _0x311404=_0x238578,_0x270493=getBotsWithMode();let _0x1233bb=_0x311404(0x163);config[_0x311404(0x20c)](_0x2b0ae3=>{const _0x18aae7=_0x311404,_0x43ff10=_0x270493['find'](_0x5348cb=>_0x5348cb[_0x18aae7(0x222)]==_0x2b0ae3[_0x18aae7(0x222)])[_0x18aae7(0x32e)];_0x1233bb+='Bot\x20'+_0x2b0ae3['botID']+':\x20'+_0x2b0ae3[_0x18aae7(0x21a)]+_0x18aae7(0x294)+_0x43ff10+'\x20|\x20'+_0x2b0ae3[_0x18aae7(0x15e)]+'\x0a';}),_0x1233bb+='\x0a',_0x1233bb+=_0x311404(0x14d),_0x1233bb+=!settings['telegramEnabled']?_0x311404(0x191):_0x311404(0x233),_0x1233bb+=settings[_0x311404(0x2d2)]?settings['telegramEvents']=='all'?_0x311404(0x29a):_0x311404(0x1a1)+settings[_0x311404(0x31d)]+'\x20only\x0a':'',await sendTelegram(_0x34766d[_0x311404(0x143)]['id'],_0x1233bb,{'parse_mode':_0x311404(0x2f5)});}),tgBot[_0x238578(0x145)](_0x238578(0x337),async _0x28ea64=>{const _0xf8e268=_0x238578,_0x31ddc4=getEnabledBots();if(_0x31ddc4['length']==0x0)await sendTelegram(_0x28ea64[_0xf8e268(0x143)]['id'],_0xf8e268(0x265));else{if(_0x31ddc4[_0xf8e268(0x30f)]>0x1)_0x31ddc4[_0xf8e268(0x333)]({'botID':_0xf8e268(0x2cc)});let _0xa9a9c9=[],_0x578310=[];const _0x34987a=_0x31ddc4[_0xf8e268(0x30f)]%0x4==0x0||_0x31ddc4[_0xf8e268(0x30f)]%0x4==0x3||_0x31ddc4['length']%0x3==0x1?0x4:0x3;let _0x254f8a=0x0;_0x31ddc4[_0xf8e268(0x20c)]((_0x3870fe,_0x344e17)=>{const _0x4c5550=_0xf8e268;if(_0x344e17%_0x34987a==0x0)_0x578310=[];_0x578310[_0x4c5550(0x333)](Markup[_0x4c5550(0x317)]['callback'](_0x3870fe[_0x4c5550(0x222)]==_0x4c5550(0x2cc)?_0x4c5550(0x2db):'Bot\x20'+_0x3870fe[_0x4c5550(0x222)],_0x4c5550(0x297)+_0x3870fe[_0x4c5550(0x222)])),_0x344e17%_0x34987a==0x0&&(_0xa9a9c9[_0x254f8a]=_0x578310,_0x254f8a++);});const _0x2b3759=Markup[_0xf8e268(0x162)](_0xa9a9c9);_0x28ea64[_0xf8e268(0x1fb)](_0xf8e268(0x1e8),_0x2b3759);}}),tgBot[_0x238578(0x34a)](/restart_(.+)/,async _0x335cf3=>{const _0x2f7695=_0x238578,_0x554682=_0x335cf3[_0x2f7695(0x1ad)][0x1];_0x335cf3[_0x2f7695(0x29e)](),_0x554682=='all'?config['forEach'](_0x1038df=>{const _0x63410b=_0x2f7695;restartBot(_0x1038df[_0x63410b(0x222)]);}):restartBot(_0x554682);}),tgBot['command']('on',async _0x35eac4=>{const _0x5d0aa7=_0x238578,_0x4f9a80=getDisabledBots();if(_0x4f9a80[_0x5d0aa7(0x30f)]==0x0)await sendTelegram(_0x35eac4['chat']['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x4f9a80[_0x5d0aa7(0x30f)]>0x1)_0x4f9a80['push']({'botID':_0x5d0aa7(0x2cc)});let _0x284a03=[],_0x739d2d=[];const _0x4af932=_0x4f9a80[_0x5d0aa7(0x30f)]%0x4==0x0||_0x4f9a80['length']%0x4==0x3||_0x4f9a80[_0x5d0aa7(0x30f)]%0x3==0x1?0x4:0x3;let _0x456863=0x0;_0x4f9a80['forEach']((_0x3aacca,_0x132683)=>{const _0x2bbecd=_0x5d0aa7;if(_0x132683%_0x4af932==0x0)_0x739d2d=[];_0x739d2d[_0x2bbecd(0x333)](Markup[_0x2bbecd(0x317)]['callback'](_0x3aacca[_0x2bbecd(0x222)]==_0x2bbecd(0x2cc)?'All\x20bots':_0x2bbecd(0x24b)+_0x3aacca[_0x2bbecd(0x222)],_0x2bbecd(0x329)+_0x3aacca[_0x2bbecd(0x222)])),_0x132683%_0x4af932==0x0&&(_0x284a03[_0x456863]=_0x739d2d,_0x456863++);});const _0x5c3d70=Markup['inlineKeyboard'](_0x284a03);_0x35eac4[_0x5d0aa7(0x1fb)](_0x5d0aa7(0x210),_0x5c3d70);}}),tgBot[_0x238578(0x34a)](/on_(.+)/,async _0x14b67c=>{const _0x3a90f6=_0x238578,_0x54e069=_0x14b67c[_0x3a90f6(0x1ad)][0x1];_0x14b67c[_0x3a90f6(0x29e)]();if(_0x54e069=='all'){const _0x4506a2=getDisabledBots();await sendTelegram(_0x14b67c[_0x3a90f6(0x143)]['id'],_0x3a90f6(0x151)),_0x4506a2[_0x3a90f6(0x20c)](_0xb3f6a8=>{const _0x4a9fef=_0x3a90f6;if(_0xb3f6a8['botID']!=_0x4a9fef(0x2cc))toggleBot(_0xb3f6a8[_0x4a9fef(0x222)],toggleStatus(_0xb3f6a8[_0x4a9fef(0x222)]),_0x4a9fef(0x2a8));});}else await sendTelegram(_0x14b67c[_0x3a90f6(0x143)]['id'],_0x3a90f6(0x1a7)+_0x54e069),toggleBot(_0x54e069,toggleStatus(_0x54e069),_0x3a90f6(0x2a8));}),tgBot[_0x238578(0x145)](_0x238578(0x1cd),async _0x439293=>{const _0x43c6bc=_0x238578,_0x1d3c4b=getEnabledBots();if(_0x1d3c4b[_0x43c6bc(0x30f)]==0x0)await sendTelegram(_0x439293[_0x43c6bc(0x143)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x1d3c4b[_0x43c6bc(0x30f)]>0x1)_0x1d3c4b[_0x43c6bc(0x333)]({'botID':_0x43c6bc(0x2cc)});let _0xc0e2c7=[],_0x2e5548=[];const _0x4a37f7=_0x1d3c4b[_0x43c6bc(0x30f)]%0x4==0x0||_0x1d3c4b['length']%0x4==0x3||_0x1d3c4b[_0x43c6bc(0x30f)]%0x3==0x1?0x4:0x3;let _0x1a39d9=0x0;_0x1d3c4b[_0x43c6bc(0x20c)]((_0xcfaa0a,_0xb3d8e1)=>{const _0x51c650=_0x43c6bc;if(_0xb3d8e1%_0x4a37f7==0x0)_0x2e5548=[];_0x2e5548[_0x51c650(0x333)](Markup[_0x51c650(0x317)][_0x51c650(0x19f)](_0xcfaa0a[_0x51c650(0x222)]==_0x51c650(0x2cc)?_0x51c650(0x2db):_0x51c650(0x24b)+_0xcfaa0a['botID'],_0x51c650(0x217)+_0xcfaa0a[_0x51c650(0x222)])),_0xb3d8e1%_0x4a37f7==0x0&&(_0xc0e2c7[_0x1a39d9]=_0x2e5548,_0x1a39d9++);});const _0x30ac12=Markup[_0x43c6bc(0x162)](_0xc0e2c7);_0x439293['reply'](_0x43c6bc(0x1e7),_0x30ac12);}}),tgBot['action'](/off_(.+)/,async _0x3440f4=>{const _0xaf001b=_0x238578,_0x192d96=_0x3440f4[_0xaf001b(0x1ad)][0x1];_0x3440f4[_0xaf001b(0x29e)]();if(_0x192d96=='all'){const _0x4c1af9=getEnabledBots();await sendTelegram(_0x3440f4[_0xaf001b(0x143)]['id'],_0xaf001b(0x327)),_0x4c1af9[_0xaf001b(0x20c)](_0x29d78c=>{const _0x1f1b13=_0xaf001b;if(_0x29d78c[_0x1f1b13(0x222)]!=_0x1f1b13(0x2cc))toggleBot(_0x29d78c[_0x1f1b13(0x222)],toggleStatus(_0x29d78c['botID']),'stopped');});}else await sendTelegram(_0x3440f4[_0xaf001b(0x143)]['id'],_0xaf001b(0x24f)+_0x192d96),toggleBot(_0x192d96,toggleStatus(_0x192d96),'stopped');}),tgBot[_0x238578(0x145)](_0x238578(0x1c6),async _0x30b376=>{const _0x521396=_0x238578,_0x185631=getEnabledBots();if(_0x185631[_0x521396(0x30f)]==0x0)await sendTelegram(_0x30b376['chat']['id'],_0x521396(0x265));else{if(_0x185631['length']>0x1){let _0x1739b6=[],_0x3a429f=[];const _0x51ab00=_0x185631[_0x521396(0x30f)]%0x4==0x0||_0x185631[_0x521396(0x30f)]%0x4==0x3||_0x185631['length']%0x3==0x1?0x4:0x3;let _0x31d278=0x0;_0x185631[_0x521396(0x20c)]((_0x2bb5de,_0x47e70f)=>{const _0x4fe62c=_0x521396;if(_0x47e70f%_0x51ab00==0x0)_0x3a429f=[];_0x3a429f[_0x4fe62c(0x333)](Markup[_0x4fe62c(0x317)][_0x4fe62c(0x19f)]('Bot\x20'+_0x2bb5de[_0x4fe62c(0x222)],_0x4fe62c(0x18c)+_0x2bb5de[_0x4fe62c(0x222)])),_0x47e70f%_0x51ab00==0x0&&(_0x1739b6[_0x31d278]=_0x3a429f,_0x31d278++);});const _0x28bd34=Markup[_0x521396(0x162)](_0x1739b6);_0x30b376[_0x521396(0x1fb)](_0x521396(0x16f),_0x28bd34);}else{const _0xc08d58=_0x185631[0x0]['botID'];if(pid[_0xc08d58])pid[_0xc08d58][_0x521396(0x254)]({'function':'sendMetricsTelegram','args':null});}}}),tgBot[_0x238578(0x34a)](/metrics_(.+)/,async _0x342ba7=>{const _0x51d533=_0x238578,_0x5c34ee=_0x342ba7['match'][0x1];_0x342ba7[_0x51d533(0x29e)]();if(pid[_0x5c34ee])pid[_0x5c34ee][_0x51d533(0x254)]({'function':_0x51d533(0x1cb),'args':null});}),tgBot[_0x238578(0x145)](_0x238578(0x2c9),async _0x36a032=>{const _0x15e295=_0x238578,_0x2f3873=getEnabledBots();if(_0x2f3873[_0x15e295(0x30f)]==0x0)await sendTelegram(_0x36a032[_0x15e295(0x143)]['id'],_0x15e295(0x265));else{if(_0x2f3873[_0x15e295(0x30f)]>0x1){let _0x3397b0=[],_0x123a8e=[];const _0x4739ed=_0x2f3873[_0x15e295(0x30f)]%0x4==0x0||_0x2f3873[_0x15e295(0x30f)]%0x4==0x3||_0x2f3873[_0x15e295(0x30f)]%0x3==0x1?0x4:0x3;let _0x2d544f=0x0;_0x2f3873[_0x15e295(0x20c)]((_0x568411,_0x1fb208)=>{const _0x35bf37=_0x15e295;if(_0x1fb208%_0x4739ed==0x0)_0x123a8e=[];_0x123a8e['push'](Markup[_0x35bf37(0x317)][_0x35bf37(0x19f)](_0x35bf37(0x24b)+_0x568411['botID'],_0x35bf37(0x208)+_0x568411[_0x35bf37(0x222)])),_0x1fb208%_0x4739ed==0x0&&(_0x3397b0[_0x2d544f]=_0x123a8e,_0x2d544f++);});const _0xd93968=Markup[_0x15e295(0x162)](_0x3397b0);_0x36a032[_0x15e295(0x1fb)](_0x15e295(0x1b2),_0xd93968);}else{const _0x5c2e10=_0x2f3873[0x0][_0x15e295(0x222)];if(pid[_0x5c2e10])pid[_0x5c2e10][_0x15e295(0x254)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x238578(0x34a)](/portfolio_(.+)/,async _0x15281a=>{const _0x20f493=_0x238578,_0x4eed88=_0x15281a[_0x20f493(0x1ad)][0x1];_0x15281a[_0x20f493(0x29e)]();if(pid[_0x4eed88])pid[_0x4eed88][_0x20f493(0x254)]({'function':_0x20f493(0x161),'args':null});}),tgBot[_0x238578(0x145)]('logs',async _0x456d7c=>{const _0x393eb6=_0x238578,_0x35fdc4='logs';await zipFiles(_0x35fdc4);const _0x2e7b83=zippath+(_0x35fdc4+_0x393eb6(0x156));_0x456d7c[_0x393eb6(0x15c)]({'source':_0x2e7b83})[_0x393eb6(0x25a)](()=>{})['catch'](_0x36b40d=>logger[_0x393eb6(0x342)]('Error\x20sending\x20'+_0x35fdc4+_0x393eb6(0x24d),_0x36b40d));}),tgBot[_0x238578(0x145)](_0x238578(0x22b),async _0x32d314=>{const _0xda6f17=_0x238578,_0x55682c=_0xda6f17(0x22b);await backupConfigFiles(),await zipFiles(_0x55682c);const _0x597d15=zippath+(_0x55682c+_0xda6f17(0x156));_0x32d314[_0xda6f17(0x15c)]({'source':_0x597d15})[_0xda6f17(0x25a)](()=>{})[_0xda6f17(0x34d)](_0x9c8047=>logger[_0xda6f17(0x342)](_0xda6f17(0x2f0)+_0x55682c+'\x20files\x20over\x20Telegram:',_0x9c8047));}),tgBot[_0x238578(0x145)](_0x238578(0x2b5),async _0x5946db=>{const _0x527322=_0x238578;await getMessages();if(!updateAvailable)await sendTelegram(_0x5946db[_0x527322(0x143)]['id'],_0x527322(0x34f));else{if(!validInstallation)await sendTelegram(_0x5946db[_0x527322(0x143)]['id'],_0x527322(0x266));else{const _0x5ecf9f=Markup[_0x527322(0x162)]([Markup['button']['callback'](_0x527322(0x1af),_0x527322(0x2b0)),Markup[_0x527322(0x317)][_0x527322(0x19f)]('No',_0x527322(0x22a))]);_0x5946db[_0x527322(0x1fb)](_0x527322(0x298),_0x5ecf9f);}}}),tgBot[_0x238578(0x34a)](/update_(.+)/,async _0x1ee25d=>{const _0x1ca049=_0x238578,_0x3d6980=_0x1ee25d['match'][0x1];_0x1ee25d['editMessageReplyMarkup'](),_0x3d6980=='yes'&&(await sendTelegram(_0x1ee25d[_0x1ca049(0x143)]['id'],'Starting\x20Balance\x20Bot\x20update'),updateBB(_0x1ca049(0x2b5))),_0x3d6980=='no'&&await sendTelegram(_0x1ee25d[_0x1ca049(0x143)]['id'],_0x1ca049(0x348));}),tgBot[_0x238578(0x145)](_0x238578(0x23e),async _0x3c49bc=>{const _0x1a4a51=_0x238578;if(!validInstallation)await sendTelegram(_0x3c49bc[_0x1a4a51(0x143)]['id'],_0x1a4a51(0x2fe));else{const _0x5511d=Markup['inlineKeyboard']([Markup[_0x1a4a51(0x317)]['callback']('Yes',_0x1a4a51(0x2ce)),Markup['button']['callback']('No',_0x1a4a51(0x225))]);_0x3c49bc['reply'](_0x1a4a51(0x196),_0x5511d);}}),tgBot['action'](/reinstall_(.+)/,async _0x5c4613=>{const _0x22567c=_0x238578,_0xcdadda=_0x5c4613['match'][0x1];_0x5c4613[_0x22567c(0x29e)](),_0xcdadda=='yes'&&(await sendTelegram(_0x5c4613['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB('reinstall')),_0xcdadda=='no'&&await sendTelegram(_0x5c4613['chat']['id'],_0x22567c(0x260));}),tgBot[_0x238578(0x145)](_0x238578(0x2f2),async _0x593f18=>{const _0x531527=_0x238578,_0x319402=getBotsWithMode();if(_0x319402[_0x531527(0x30f)]==0x0)await sendTelegram(_0x593f18[_0x531527(0x143)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x1111f1=[],_0x13be47=[];const _0x597854=0x2;let _0x12d715=0x0;_0x319402[_0x531527(0x20c)]((_0x4bdca9,_0x167f56)=>{const _0x51c4f2=_0x531527;if(_0x167f56%_0x597854==0x0)_0x13be47=[];_0x13be47[_0x51c4f2(0x333)](Markup[_0x51c4f2(0x317)][_0x51c4f2(0x19f)](_0x51c4f2(0x24b)+_0x4bdca9[_0x51c4f2(0x222)]+'\x20('+_0x4bdca9[_0x51c4f2(0x32e)]+')',_0x51c4f2(0x312)+_0x4bdca9[_0x51c4f2(0x222)])),_0x167f56%_0x597854==0x0&&(_0x1111f1[_0x12d715]=_0x13be47,_0x12d715++);});const _0x24537b=Markup['inlineKeyboard'](_0x1111f1);_0x593f18[_0x531527(0x1fb)](_0x531527(0x21c),_0x24537b);}}),tgBot[_0x238578(0x34a)](/toggle_(.+)/,async _0x44e30d=>{const _0x5db615=_0x238578,_0x476fcf=_0x44e30d['match'][0x1];_0x44e30d[_0x5db615(0x29e)]();const _0x4ec442=getBotsWithMode(),_0x389109=_0x4ec442[_0x5db615(0x2d1)](_0x50616e=>_0x50616e[_0x5db615(0x222)]==_0x476fcf),_0xbe1639=_0x389109[_0x5db615(0x32e)]==_0x5db615(0x1b1)?_0x5db615(0x197):_0x5db615(0x1b1);await sendTelegram(_0x44e30d[_0x5db615(0x143)]['id'],_0x5db615(0x331)+_0x476fcf+'\x20to\x20'+_0xbe1639+_0x5db615(0x1ae)),toggleBotMode(_0x476fcf);}),tgBot[_0x238578(0x145)](_0x238578(0x32d),async _0x26947d=>{const _0x428ac5=_0x238578;let _0x53ea5b='';config[_0x428ac5(0x20c)](_0x2d24e3=>{const _0x293125=_0x428ac5;_0x53ea5b+=_0x293125(0x24b)+_0x2d24e3[_0x293125(0x222)]+':\x20'+_0x2d24e3[_0x293125(0x302)]+'\x0a';}),await sendTelegram(_0x26947d['chat']['id'],_0x53ea5b,{'parse_mode':_0x428ac5(0x2f5)});}),tgBot['command']('help',async _0x3bfe8d=>{const _0x2860aa=_0x238578;await sendTelegram(_0x3bfe8d[_0x2860aa(0x143)]['id'],_0xf7710e);}),process['once'](_0x238578(0x258),()=>tgBot['stop']('SIGINT')),process[_0x238578(0x2e0)]('SIGTERM',()=>tgBot[_0x238578(0x138)]('SIGTERM')),tgBot[_0x238578(0x25d)]();}function disableTelegram(){const _0x3f10e0=_0xda629c;tgBot&&tgBot[_0x3f10e0(0x138)]();}async function sendTelegram(_0xa9176e,_0x3b37b7,_0x34db36){const _0x28a877=_0xda629c;_0x34db36={..._0x34db36,'disable_web_page_preview':!![]};try{await tgBot[_0x28a877(0x1fd)]['sendMessage'](_0xa9176e,_0x3b37b7,_0x34db36);}catch(_0x2464f4){logger['debug']('Telegram\x20error:',_0x2464f4);}}async function sendTelegramBot(_0x4bad41,_0x20e50b){const _0x2a7f61=_0xda629c;if(settings['telegramEnabled']){if(settings[_0x2a7f61(0x31d)]==_0x2a7f61(0x2cc)||(_0x20e50b[_0x2a7f61(0x1a3)]==_0x2a7f61(0x20b)||_0x20e50b[_0x2a7f61(0x1a3)]=='warning'||_0x20e50b[_0x2a7f61(0x1a3)]=='success')&&settings[_0x2a7f61(0x31d)]=='alerts'||_0x20e50b['type']=='order'&&settings[_0x2a7f61(0x31d)]==_0x2a7f61(0x1bd)){if(tgBot&&settings['telegramChatId']){if(_0x20e50b['showname'])await sendTelegram(settings['telegramChatId'],_0x20e50b[_0x2a7f61(0x302)]+_0x2a7f61(0x1d0)+_0x20e50b[_0x2a7f61(0x170)]);else await sendTelegram(settings['telegramChatId'],_0x2a7f61(0x24b)+_0x4bad41+_0x2a7f61(0x1d0)+_0x20e50b['event']);}}}}async function sendTelegramMsg(_0x582d00,_0x2ee5e1=_0xda629c(0x2f5)){const _0xb0c6e3=_0xda629c;return settings['telegramEnabled']&&tgBot&&settings[_0xb0c6e3(0x1ed)]?(await sendTelegram(settings[_0xb0c6e3(0x1ed)],_0x582d00,{'parse_mode':_0x2ee5e1}),!![]):![];}function getDeviceWithIp(_0x1d4048){const _0x258802=_0xda629c;return devices[_0x258802(0x2d1)](_0x5cdfaf=>_0x5cdfaf['ip']===_0x1d4048);}async function temporaryAccess2FA(_0x3d5498,_0x28ce3e){const _0x535fe6=_0xda629c;let _0xac89f=new Date(),_0x10bed3=![];if(lastIpApproval){if(_0xac89f-lastIpApproval<0x1388)_0x10bed3=!![];}lastIpApproval=new Date();if(_0x10bed3)return;if(tgBot&&settings[_0x535fe6(0x1ed)]){const _0x287033=uuidRandom();tmpStorage[_0x287033]={'uuid':_0x3d5498,'externalip':_0x28ce3e};const _0x4860dd=Markup[_0x535fe6(0x162)]([Markup[_0x535fe6(0x317)][_0x535fe6(0x19f)](_0x535fe6(0x335),_0x535fe6(0x243)+_0x287033),Markup[_0x535fe6(0x317)][_0x535fe6(0x19f)](_0x535fe6(0x15a),_0x535fe6(0x188)+_0x287033),Markup[_0x535fe6(0x317)][_0x535fe6(0x19f)](_0x535fe6(0x262),_0x535fe6(0x141)+_0x287033),Markup[_0x535fe6(0x317)][_0x535fe6(0x19f)]('reject','tempaccess_reject_'+_0x287033)]);await sendTelegram(settings['telegramChatId'],_0x535fe6(0x314)+normalizeIP(_0x28ce3e)[_0x535fe6(0x2e3)]+'\x20?',_0x4860dd),tgBot[_0x535fe6(0x34a)](/tempaccess_(.+)_(.+)/,async _0x5d2fb1=>{const _0x4072dd=_0x535fe6,_0x14b1f9=_0x5d2fb1['match'][0x1],_0x3e756d=_0x5d2fb1['match'][0x2],{uuid:_0xd5f5b9,externalip:_0x1a71b4}=tmpStorage[_0x3e756d];delete tmpStorage[_0x3e756d],_0x5d2fb1['editMessageReplyMarkup'](),devices[_0xd5f5b9]['telegramIpApproval']={'clientip':_0x1a71b4,'timestamp':new Date()[_0x4072dd(0x25b)](),'expiry':_0x14b1f9},_0x14b1f9!=_0x4072dd(0x2eb)?(await sendTelegram(_0x5d2fb1[_0x4072dd(0x143)]['id'],'Access\x20enabled\x20for\x20'+_0x14b1f9+_0x4072dd(0x2e7),{'parse_mode':_0x4072dd(0x2f5)}),io['to'](_0xd5f5b9)[_0x4072dd(0x16d)]('status',{'access':{'allow':![],'reason':_0x4072dd(0x187),'token':null}})):(await sendTelegram(_0x5d2fb1[_0x4072dd(0x143)]['id'],_0x4072dd(0x14a)),io['to'](_0xd5f5b9)['emit'](_0x4072dd(0x21a),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x5cf9da,_0x2210ac){const _0x3b558a=_0xda629c;if(tgBot&&settings[_0x3b558a(0x1ed)]){const _0x1b3f3c=uuidRandom();tmpStorage[_0x1b3f3c]={'uuid':_0x5cf9da,'externalip':_0x2210ac};const _0x214cc1=Markup[_0x3b558a(0x162)]([Markup['button'][_0x3b558a(0x19f)](_0x3b558a(0x2b2),'login2fa_'+loginExpiry+'_'+_0x1b3f3c),Markup[_0x3b558a(0x317)][_0x3b558a(0x19f)](_0x3b558a(0x2eb),_0x3b558a(0x26d)+_0x1b3f3c)]);await sendTelegram(settings['telegramChatId'],_0x3b558a(0x315)+normalizeIP(_0x2210ac)[_0x3b558a(0x2e3)]+'\x20?',_0x214cc1),tgBot[_0x3b558a(0x34a)](/login2fa_(.+)_(.+)/,async _0x2592b2=>{const _0x20669c=_0x3b558a,_0x47777f=_0x2592b2['match'][0x1],_0x278dff=_0x2592b2[_0x20669c(0x1ad)][0x2],{uuid:_0x4d4a9e,externalip:_0x5af717}=tmpStorage[_0x278dff];delete tmpStorage[_0x278dff],_0x2592b2['editMessageReplyMarkup'](),devices[_0x4d4a9e][_0x20669c(0x173)]={'clientip':_0x5af717,'timestamp':new Date()[_0x20669c(0x25b)](),'expiry':_0x47777f},_0x47777f!=_0x20669c(0x2eb)?(await sendTelegram(_0x2592b2[_0x20669c(0x143)]['id'],_0x20669c(0x17a),{'parse_mode':_0x20669c(0x2f5)}),io['to'](_0x4d4a9e)[_0x20669c(0x16d)]('status',{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x2592b2[_0x20669c(0x143)]['id'],_0x20669c(0x34b)),io['to'](_0x4d4a9e)[_0x20669c(0x16d)](_0x20669c(0x21a),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x190f17=_0xda629c;return dbConfig[_0x190f17(0x275)]('bots')['sortBy'](_0x190f17(0x222))[_0x190f17(0x27b)]({'status':_0x190f17(0x174)})['value']()||[];}function getDisabledBots(){const _0x45f3fb=_0xda629c;return dbConfig[_0x45f3fb(0x275)](_0x45f3fb(0x244))['sortBy'](_0x45f3fb(0x222))[_0x45f3fb(0x27b)]({'status':_0x45f3fb(0x2ca)})[_0x45f3fb(0x1ca)]()||[];}function getBotAttributes(_0x56653c){const _0xbe9e6a=_0xda629c;let _0x373d95={};const _0x7448b2=configpath+_0xbe9e6a(0x2be)+_0x56653c+_0xbe9e6a(0x1c5),_0x354c9c=fs[_0xbe9e6a(0x180)](_0x7448b2);if(_0x354c9c){const _0x4697c7=fs[_0xbe9e6a(0x235)](_0x7448b2);try{const _0x5548fd=JSON[_0xbe9e6a(0x1a2)](_0x4697c7),_0x509e60=_0x5548fd?_0x5548fd[_0xbe9e6a(0x18d)][0x0]['headless']:![];_0x373d95[_0xbe9e6a(0x32e)]=_0x509e60?_0xbe9e6a(0x1b1):'manual',_0x373d95['botname']=_0x5548fd?_0x5548fd[_0xbe9e6a(0x18d)][0x0][_0xbe9e6a(0x302)]:_0xbe9e6a(0x24b)+_0x56653c;}catch(_0x519b3e){_0x373d95[_0xbe9e6a(0x32e)]=_0xbe9e6a(0x197),_0x373d95[_0xbe9e6a(0x302)]=_0xbe9e6a(0x24b)+_0x56653c;}}else _0x373d95[_0xbe9e6a(0x32e)]='manual',_0x373d95[_0xbe9e6a(0x302)]=_0xbe9e6a(0x24b)+_0x56653c;return _0x373d95;}function getBotsWithMode(){const _0x555cb4=_0xda629c,_0x58fa98=dbConfig['get']('bots')[_0x555cb4(0x2d6)](_0x555cb4(0x222))['value']()||[];return _0x58fa98[_0x555cb4(0x20c)](_0xacd771=>{const _0x1c936c=_0x555cb4;let _0x533ab6=getBotAttributes(_0xacd771['botID']);_0xacd771['mode']=_0x533ab6[_0x1c936c(0x32e)];}),_0x58fa98;}function getBotExchanges(){const _0x1ea65d=_0xda629c;let _0x2d5da5=[];const _0x38440f=dbConfig[_0x1ea65d(0x275)](_0x1ea65d(0x244))[_0x1ea65d(0x2d6)](_0x1ea65d(0x222))[_0x1ea65d(0x1ca)]()||[];_0x38440f[_0x1ea65d(0x20c)](_0x51e597=>{const _0xb83795=_0x1ea65d;if(_0x51e597[_0xb83795(0x21a)]=='enabled'){const _0x44e764=configpath+_0xb83795(0x2be)+_0x51e597['botID']+'-config.json',_0xea5ddb=fs['existsSync'](_0x44e764);let _0x5dc37c;if(_0xea5ddb){const _0x12ccee=fs[_0xb83795(0x235)](_0x44e764);try{const _0x3baf88=JSON['parse'](_0x12ccee);_0x5dc37c=_0x3baf88?_0x3baf88[_0xb83795(0x18d)][0x0]['exchange']:null;}catch(_0x36d864){}}if(_0x5dc37c)_0x2d5da5['push'](_0x5dc37c);}});const _0x5d9925=[...new Set(_0x2d5da5)][_0x1ea65d(0x34c)]();return _0x5d9925;}async function initUser(){const _0x4b01ae=_0xda629c;if(!settings['userid']){const _0x377080=uuidRandom();mixpanel['alias'](_0x377080),updateSetting(_0x4b01ae(0x177),_0x377080);}}async function initSecure(){const _0x2108fe=_0xda629c;let _0x41cadf=getSecure();if(!_0x41cadf['hasOwnProperty'](_0x2108fe(0x32b))){let _0x3b230b=await generateKeys();_0x41cadf[_0x2108fe(0x2a0)]=_0x3b230b[_0x2108fe(0x2a0)],_0x41cadf[_0x2108fe(0x2b4)]=_0x3b230b[_0x2108fe(0x2b4)],_0x41cadf[_0x2108fe(0x32b)]=crypto[_0x2108fe(0x175)](0x20)[_0x2108fe(0x345)]('hex');;storeSecure(_0x41cadf);}}function getSettings(){const _0x453c0e=_0xda629c;return dbSettings[_0x453c0e(0x275)]('settings')[_0x453c0e(0x1ca)]()||{};}function getSecure(){const _0x29468c=_0xda629c;return dbSecure[_0x29468c(0x275)]('secure')[_0x29468c(0x1ca)]()||{};}function getBlacklist(){const _0x2718c8=_0xda629c;return dbSecure['get'](_0x2718c8(0x2d3))[_0x2718c8(0x1ca)]()||[];}function broadcastToBots(_0x17baeb,_0x4e7d32){const _0x1af8b3=_0xda629c;config[_0x1af8b3(0x20c)](_0x15e046=>{const _0x356eac=_0x1af8b3;if(_0x15e046[_0x356eac(0x21a)]==_0x356eac(0x174)&&_0x15e046[_0x356eac(0x15e)]=='running'||_0x15e046[_0x356eac(0x21a)]==_0x356eac(0x306)&&_0x15e046[_0x356eac(0x15e)]==_0x356eac(0x1ac)){if(pid[_0x15e046['botID']])pid[_0x15e046[_0x356eac(0x222)]][_0x356eac(0x254)]({[_0x17baeb]:_0x4e7d32});}});}async function storeSettings(_0x37d9df,_0x23d800=![]){const _0x65fee4=_0xda629c;_0x37d9df={...settings,..._0x37d9df};if(_0x23d800&&_0x37d9df[_0x65fee4(0x1a8)]!=_0x65fee4(0x253)&&_0x37d9df[_0x65fee4(0x1a8)]!=_0x65fee4(0x1ef)&&_0x37d9df[_0x65fee4(0x1a8)]!=''){const _0x6c84e4=decryptRSA(secure[_0x65fee4(0x2b4)],_0x37d9df[_0x65fee4(0x1a8)])[_0x65fee4(0x340)]('|@|')[0x0],_0x26a790=bcrypt['hashSync'](_0x6c84e4,saltRounds);_0x37d9df={..._0x37d9df,'bbPassword':_0x26a790};}if(_0x23d800&&_0x37d9df[_0x65fee4(0x18f)]!='************'&&_0x37d9df['telegramToken']!=_0x65fee4(0x1ef)&&_0x37d9df['telegramToken']!=''){const _0x3f1f85=decryptRSA(secure['privateKey'],_0x37d9df[_0x65fee4(0x18f)])[_0x65fee4(0x340)]('|@|')[0x0];_0x37d9df={..._0x37d9df,'telegramToken':_0x3f1f85};}if(_0x23d800&&_0x37d9df['marketcapApi']!=_0x65fee4(0x253)&&_0x37d9df['marketcapApi']!=_0x65fee4(0x1ef)&&_0x37d9df['marketcapApi']!=''){const _0x56f83a=decryptRSA(secure[_0x65fee4(0x2b4)],_0x37d9df[_0x65fee4(0x231)])[_0x65fee4(0x340)]('|@|')[0x0];_0x37d9df={..._0x37d9df,'marketcapApi':_0x56f83a};}const _0xa33859=_0x37d9df[_0x65fee4(0x18f)]!=_0x65fee4(0x253)&&_0x37d9df['telegramToken']!=settings['telegramToken']||_0x37d9df['telegramUsername']!=settings[_0x65fee4(0x26c)],_0x80a3be=_0x37d9df[_0x65fee4(0x18f)]==''||_0x37d9df[_0x65fee4(0x26c)]=='',_0x417807=_0x37d9df[_0x65fee4(0x231)]&&_0x37d9df['marketcapApi']!=_0x65fee4(0x253)&&_0x37d9df[_0x65fee4(0x231)]!=settings[_0x65fee4(0x231)];_0xa33859&&(_0x37d9df['telegramChatId']=null,_0x37d9df[_0x65fee4(0x31d)]=_0x65fee4(0x2cc));for(const [_0x123223,_0x320575]of Object['entries'](_0x37d9df)){if(_0x123223==_0x65fee4(0x18f)&&_0x320575==_0x65fee4(0x253)){_0x37d9df[_0x65fee4(0x18f)]=settings[_0x65fee4(0x18f)];continue;};if(_0x123223==_0x65fee4(0x1a8)&&_0x320575==_0x65fee4(0x253)){_0x37d9df['bbPassword']=settings['bbPassword'];continue;};if(_0x123223==_0x65fee4(0x231)&&_0x320575==_0x65fee4(0x253)){_0x37d9df[_0x65fee4(0x231)]=settings[_0x65fee4(0x231)];continue;};dbSettings['set'](_0x65fee4(0x155)+_0x123223,_0x320575)['write']();}settings=_0x37d9df,io['to'](_0x65fee4(0x29b))['emit'](_0x65fee4(0x14e),cleanSettings()),broadcastToBots(_0x65fee4(0x203),settings[_0x65fee4(0x203)]),broadcastToBots(_0x65fee4(0x18b),settings[_0x65fee4(0x18b)]),broadcastToBots(_0x65fee4(0x231),settings[_0x65fee4(0x231)]);if(_0xa33859&&!_0x80a3be)initTelegram();_0xa33859&&_0x80a3be&&(updateSetting(_0x65fee4(0x1ed),null),disableTelegram()),getAllClients()[_0x65fee4(0x20c)](_0x2e3e47=>{const _0x1c8c81=_0x65fee4;getSocket(_0x2e3e47['id'])[_0x1c8c81(0x16d)]('status',{'access':{'allow':![],'reason':_0x1c8c81(0x187),'token':null}});}),_0x417807&&(await sleep(0xbb8),testMarketcapApi(_0x37d9df[_0x65fee4(0x231)]));}async function testMarketcapApi(_0x18a28f){const _0x3e0f3b=_0xda629c,_0xf9f5fb=[_0x3e0f3b(0x347),_0x3e0f3b(0x2ae)];try{await axios['get'](_0x3e0f3b(0x255),{'headers':{'X-CMC_PRO_API_KEY':_0x18a28f},'params':{'symbol':_0xf9f5fb[_0x3e0f3b(0x345)]()}});}catch(_0x16d25f){_0x16d25f[_0x3e0f3b(0x345)]()[_0x3e0f3b(0x2e8)](_0x3e0f3b(0x28b))?(io['to'](_0x3e0f3b(0x29b))[_0x3e0f3b(0x16d)](_0x3e0f3b(0x219),_0x3e0f3b(0x2b7)),logger[_0x3e0f3b(0x25e)](_0x3e0f3b(0x2b7))):(io['to']('botmanager')['emit'](_0x3e0f3b(0x219),_0x3e0f3b(0x227)),logger[_0x3e0f3b(0x25e)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger[_0x3e0f3b(0x342)](_0x3e0f3b(0x198),_0x16d25f[_0x3e0f3b(0x345)]()+_0x3e0f3b(0x189)+_0x16d25f['code']));return;}logger[_0x3e0f3b(0x342)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x580f7d,_0x2d4c69){const _0x3f6cb5=_0xda629c;dbSettings[_0x3f6cb5(0x308)]('settings.'+_0x580f7d,_0x2d4c69)[_0x3f6cb5(0x1c0)](),settings=getSettings(),io['to'](_0x3f6cb5(0x29b))[_0x3f6cb5(0x16d)](_0x3f6cb5(0x14e),cleanSettings());}function storeSecure(_0x5cc76e){const _0xcfda7a=_0xda629c;dbSecure[_0xcfda7a(0x275)](_0xcfda7a(0x24e))[_0xcfda7a(0x333)](_0x5cc76e)[_0xcfda7a(0x1c0)](),secure=_0x5cc76e;}function addBlacklist(_0x24cd7c){const _0x3d70c1=_0xda629c;cleanBlacklist();let _0x2406f4;devices[_0x24cd7c]['telegramIpApproval']?_0x2406f4=Math[_0x3d70c1(0x13e)](devices[_0x24cd7c][_0x3d70c1(0x2e4)][_0x3d70c1(0x1e5)],loginExpiry):_0x2406f4=loginExpiry,dbSecure[_0x3d70c1(0x275)](_0x3d70c1(0x2d3))[_0x3d70c1(0x333)]({'expiry':new Date()['getTime']()+_0x2406f4*0x3c*0x3e8,'token':devices[_0x24cd7c][_0x3d70c1(0x1c2)][_0x3d70c1(0x330)]})[_0x3d70c1(0x1c0)](),blacklist=dbSecure[_0x3d70c1(0x275)](_0x3d70c1(0x2d3))['value']();}function _0x4ea8(){const _0x325ccf=['latestversion','sendFile','error','forEach','axios','alerts','loginRequired','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','listen','get-messages','number','Telegraf\x20error:','yargs/yargs','update-bb','off_','range','notification','status','_nsps','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','cloneDeep','files','sockets','(staging)','config/','botID','NTBA_FIX_319','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','reinstall_no',')\x20\x20\x20|\x20Bot\x20','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','/off\x20-\x20stop\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20get\x20events','update_no','backup','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Unauthorized\x20attempt\x20to\x20delete\x20bot','disconnect','index.html','started','marketcapApi','handshake','Notifications\x20enabled\x0a','express-fileupload','readFileSync','bbvReceive','startsWith','restore-backup-file','unlinkSync','resetpw_yes','11658Rqikjj','Logged\x20out\x20user\x20...','16ZxUFJh','reinstall','cancelLoading','conn','login\x20not\x20required','headless','tempaccess_5_','bots','(((.+)+)+)+$','exec','invalid\x20credentials','/restart\x20-\x20restart\x20bot(s)\x0a','pidExpireLogin','disable','Bot\x20','environment','\x20files\x20over\x20Telegram:','secure','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','ipv6','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','join','************','send','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','auth','hasOwnProperty','SIGINT','private','then','getTime','add','launch','full','bb-secure.json','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','toIPv4Address','30\x20min','-events.json','getPortfolio','No\x20bots\x20running\x20right\x20now','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Bot\x20Mgr\x20>\x20','uncaughtException','Unauthorized\x20attempt\x20to\x20store\x20configuration','getUTCHours','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','telegramUsername','login2fa_reject_','search','store-configuration','getFullYear','\x1b[0m','new-disabled','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Restore\x20backup\x20file\x20','get','init','Backup\x20file\x20uploaded','version.json','async','internal','filter','node-forge','storeFiat','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','rmSync','reset-history','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','::1','Restarting\x20Bot\x20','output-002.log','config_all','Server','Logged\x20in\x20user\x20...','copyFileSync','enable','staging','status\x20code\x20401','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','temporaryAccessAllowed','uuid','backup-full@','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','reason','format','message','\x20|\x20','Ok,\x20will\x20send\x20order\x20notifications\x20only','backup-full','restart_','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','66kisdIF','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','botmanager','allow','output-001.log','editMessageReplyMarkup','endsWith','publicKey','\x1b[33m','production','post','Notifications\x20disabled','encryptedUuid','confirm-message','storeConfiguration','stopped','Unauthorized\x20attempt\x20to\x20update\x20settings','jsonwebtoken','bbvNew','Disabled\x20Bot\x20','hashSync','ETH','close','update_yes','config','accept',':\x20Bot\x20Mgr\x20>\x20','privateKey','update','statSync','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','[ip-address]','\x20|\x20client:\x20...','log','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','6b67f3d61ee94b8f5c80b4affef4c4d9','user','bot-','login','whitelistEnabled','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Enabled\x20Bot\x20','http','get-backup-files','bb/','pki','store-headless','stringify','portfolio','disabled','Markdown','all','getMinutes','reinstall_yes','::ffff:127.0.0.1','Unauthorized\x20attempt\x20to\x20download\x20','find','telegramEnabled','blacklist','lastmsgemitted','delete-alerts','sortBy','backup/','cancel-loading','yes','lastmsgtelegram','All\x20bots','logged\x20out','temporary\x20access\x20timeout','backup-files','/:bot','once','fork','temp/','show','telegramIpApproval','name','*$1*','\x20minutes','includes','updatebotmanager','map','reject','inherit','api-eu.mixpanel.com','remove','path','Error\x20sending\x20','start','toggle','address','-----------------------------------------------------------------------------------','HTML','#RES#\x20if\x20running\x20locally\x0a','Alerts','args','sign','bot.js','uuid-random','referer','file','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','function','socket.io',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','botname','removeAllListeners','decrypt','Idling\x20(','new','1656036sFatum','set','express','\x1b[34m','get-starting-balances','kill','\x1b[35m','from','length','request','\x20(1)','toggle_','lowdb/adapters/FileSync','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Allow\x20login\x20from\x20IP\x20address\x20','apply','button','access\x20timeout','remoteAddress','/:bot/history','storeHeadless','show-config','telegramEvents','toggle-bot-mode','Starting\x20#RED#Balance\x20Bot\x20v','Invalid\x20authentication\x20token\x20(1)','address\x20already\x20in\x20use','createServer','clients','getMonth','Starting\x20(','$1_$2_$3','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','params','on_','isValid','secret','0.0.0','names','mode','Setting\x20access:\x20','token','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','Failed\x20to\x20download\x20','push','Network\x20Interfaces:','5\x20min','createWriteStream','restart','Unauthorized\x20login\x20attempt\x20(timeout)','Starting\x20new\x20bot\x20|\x20Bot\x20','date-fns','replace','/output-000.log','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','string','binary','split','telegraf','debug','login\x20token\x20valid','login\x20token\x20generated','toString','assign','BCT','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Orders','action','Login\x20rejected','sort','catch','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','10qGhRAA','username','bb-config.json','padStart','Invalid\x20IP\x20address','ipaddr.js','apiSecret','deleteHistoryAlerts','messages','defaults','reset-password','stop','Password\x20reset\x20rejected','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','data','max','size','/disable\x20-\x20disable\x20notifications\x0a','tempaccess_30_','telegrammsg','chat','randomFillSync','command','add-bot','restore_no_','host','--------------------------------------','Temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20get\x20messages','/upload-backup','<b>Telegram\x20Bot\x20Status:</b>\x0a','settings','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','timestamp','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','4741944PkeaWY','decode64','logs','settings.','.zip','toIPv4MappedAddress','|@|','/:bot/portfolio','15\x20min','-results.json','replyWithDocument','jszip','live','Node.js\x20v','simple','sendPortfolioTelegram','inlineKeyboard','<b>Balance\x20Bot\x20Status:</b>\x0a','3632811eIOYla','Error\x20while\x20deleting\x20config\x20files:\x20','Restoring\x20bot(s)\x20from\x20backup','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','password','crypto','Session\x20expired\x20for\x20user\x20...','isDirectory','3000','emit','bb-settings.json','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','event','node','success','telegram2FaApproval','enabled','randomBytes','1090069GDnrRZ','userid','https://api.ipify.org?format=json','Unauthorized\x20attempt\x20to\x20log\x20out','Login\x20accepted','127.0.0.1','reinstall-bb','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','pidRefreshToken','12910GKlzjf','existsSync',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','lowdb','clientip','test','Unauthorized\x20attempt\x20to\x20confirm\x20message','title','reload','tempaccess_15_','\x20-\x20','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','onepagemode','metrics_','bot','resetpw_no','telegramToken','2FA\x20required','Notifications\x20disabled\x0a',')\x20|\x20Bot\x20','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','2FA','family','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','manual','Error\x20details:','backup-full.zip','socket','loadAsync','apiPassword','get-portfolio','env','callback','bbUsername','Notifications\x20types:\x20','parse','type','login\x20required','verify','text','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','bbPassword','1000','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','/download/:type','running','match','\x20mode','Yes','any','auto','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',',\x20must\x20be\x20a\x204\x20digit\x20number','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','ipc','getSeconds','SIGTERM','No\x20authentication\x20token','build','download','#RES#\x20','1008756FIycRB','orders','-performance.json','slice','write','\x20(2)','access','getHours','423dbbZBf','-config.json','metrics','logs/','generateKeyPair','emitHistory','value','sendMetricsTelegram','/metrics\x20-\x20show\x20bot\x20performance\x0a','off','User\x20has\x20been\x20validated','/backup\x20-\x20receive\x20backup\x20files\x0a','\x20>\x20','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','zip/','versions','Unauthorized\x20attempt\x20to\x20delete\x20alerts','build2','getDate','/:bot/performance','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','Error\x20removing\x20old\x20backup\x20files:','Restore\x20process\x20aborted','#RES#\x20if\x20running\x20on\x20server','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','restore_yes_','#RES#','sha256','store-settings','RSA-OAEP','keys','f2aRequired','Unauthorized\x20attempt\x20to\x20update\x20bot','expiry','writeFileSync','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','store','1388umQwCP','/:bot/coins','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','telegramChatId','graphql-request','***','apiKey','util','All','File\x20uploaded','2FA\x20login\x20required','mkdirSync','showConfig','use','port','backupfile','config_orders','reply','whitelist','telegram','=>\x20Go\x20to\x20#CYA#http://','mixpanel','headers','child_process','output-000.log','timeshift','/enable\x20-\x20enable\x20notifications\x0a','exit','readdirSync','connection','portfolio_'];_0x4ea8=function(){return _0x325ccf;};return _0x4ea8();}function cleanBlacklist(){const _0x5dc036=_0xda629c;let _0x1fddf3=dbSecure[_0x5dc036(0x275)](_0x5dc036(0x2d3))[_0x5dc036(0x21d)]()[_0x5dc036(0x1ca)](),_0x3263df=new Date()[_0x5dc036(0x25b)]();_0x1fddf3[_0x5dc036(0x20c)](_0x377a01=>{const _0x591065=_0x5dc036;_0x377a01[_0x591065(0x1e5)]<_0x3263df&&dbSecure['get'](_0x591065(0x2d3))[_0x591065(0x2ee)]({'expiry':_0x377a01[_0x591065(0x1e5)]})['write']();});}function initStates(){const _0x506c80=_0xda629c;let _0x2d8208=getConfiguration();_0x2d8208[_0x506c80(0x20c)](_0x15a604=>{const _0x448a0e=_0x506c80;_0x15a604[_0x448a0e(0x15e)]=_0x448a0e(0x2a8);}),storeConfiguration(_0x2d8208);}async function generateKeys(){const _0x3a97d8=_0xda629c,_0x49378b=forge['pki']['rsa'][_0x3a97d8(0x1c8)]({'bits':0x1000,'e':0x10001}),_0x3ba783=forge[_0x3a97d8(0x2c6)]['privateKeyToPem'](_0x49378b[_0x3a97d8(0x2b4)]),_0x25f662=forge['pki']['publicKeyToPem'](_0x49378b[_0x3a97d8(0x2a0)]);return{'privateKey':_0x3ba783,'publicKey':_0x25f662};}async function oneTimeMigration(){const _0x3b9dbe=_0xda629c;let _0x52e40e=getSettings(),_0x453fc9=![];!_0x52e40e[_0x3b9dbe(0x257)](_0x3b9dbe(0x2da))&&(_0x52e40e[_0x3b9dbe(0x2da)]=0x0,_0x453fc9=!![]);!_0x52e40e[_0x3b9dbe(0x257)](_0x3b9dbe(0x2d4))&&(_0x52e40e[_0x3b9dbe(0x2d4)]=0x0,_0x453fc9=!![]);!_0x52e40e[_0x3b9dbe(0x257)](_0x3b9dbe(0x209))&&(_0x52e40e[_0x3b9dbe(0x209)]='0.0.0',_0x453fc9=!![]);!_0x52e40e[_0x3b9dbe(0x257)](_0x3b9dbe(0x18b))&&(_0x52e40e[_0x3b9dbe(0x18b)]=![],_0x453fc9=!![]);!_0x52e40e['hasOwnProperty'](_0x3b9dbe(0x231))&&(_0x52e40e[_0x3b9dbe(0x231)]='',_0x453fc9=!![]);if(_0x453fc9)storeSettings(_0x52e40e);try{fs[_0x3b9dbe(0x206)](configbackuppath,{'withFileTypes':!![]})[_0x3b9dbe(0x20c)](_0x2410e9=>{const _0x12c021=_0x3b9dbe;if(!_0x2410e9[_0x12c021(0x16b)]()){if(!_0x2410e9[_0x12c021(0x2e5)]['startsWith'](_0x12c021(0x28f)))fs[_0x12c021(0x239)](configbackuppath+_0x2410e9[_0x12c021(0x2e5)]);}else fs[_0x12c021(0x27f)](configbackuppath+_0x2410e9[_0x12c021(0x2e5)],{'recursive':!![]});});}catch(_0x45d45a){logger[_0x3b9dbe(0x342)](_0x3b9dbe(0x1d9),_0x45d45a);}}function storeConfiguration(_0x2485f4){const _0x3ffb81=_0xda629c;dbConfig[_0x3ffb81(0x275)](_0x3ffb81(0x244))['remove']()[_0x3ffb81(0x1c0)](),dbConfig[_0x3ffb81(0x275)](_0x3ffb81(0x244))[_0x3ffb81(0x333)](..._0x2485f4)[_0x3ffb81(0x1c0)](),config=_0x2485f4;}async function resetPassword(){const _0x1c1a06=_0xda629c;if(tgBot&&settings[_0x1c1a06(0x1ed)]){const _0x30f27e=Markup[_0x1c1a06(0x162)]([Markup[_0x1c1a06(0x317)][_0x1c1a06(0x19f)]('yes',_0x1c1a06(0x23a)),Markup[_0x1c1a06(0x317)][_0x1c1a06(0x19f)]('no',_0x1c1a06(0x18e))]);await sendTelegram(settings[_0x1c1a06(0x1ed)],_0x1c1a06(0x18a),_0x30f27e),tgBot['action'](/resetpw_(.+)/,async _0x38704d=>{const _0xa3f89a=_0x1c1a06,_0x4b2a10=_0x38704d[_0xa3f89a(0x1ad)][0x1];_0x38704d[_0xa3f89a(0x29e)]();if(_0x4b2a10!='no'){const _0x37436f=0xf,_0x169503=_0xa3f89a(0x193),_0x4414e2=Array[_0xa3f89a(0x30e)](crypto[_0xa3f89a(0x144)](new Uint32Array(_0x37436f)))[_0xa3f89a(0x2ea)](_0x194469=>_0x169503[_0x194469%_0x169503[_0xa3f89a(0x30f)]])[_0xa3f89a(0x252)](''),_0x4c57d2=bcrypt[_0xa3f89a(0x2ad)](_0x4414e2,saltRounds);storeSettings({'bbPassword':_0x4c57d2}),await sendTelegram(_0x38704d[_0xa3f89a(0x143)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x4414e2,{'parse_mode':'HTML'});}else await sendTelegram(_0x38704d['chat']['id'],_0xa3f89a(0x139));});}}async function confirmRestore(_0xc5539f,_0x555d3f){const _0x3f46d2=_0xda629c;io['to'](_0x3f46d2(0x29b))[_0x3f46d2(0x16d)](_0x3f46d2(0x219),_0x3f46d2(0x13a),_0x3f46d2(0x172));if(tgBot&&settings['telegramChatId']){const _0x1058b4=uuidRandom();tmpStorage[_0x1058b4]={'path':_0xc5539f,'filename':_0x555d3f};const _0x26b4f0=Markup[_0x3f46d2(0x162)]([Markup[_0x3f46d2(0x317)]['callback'](_0x3f46d2(0x2d9),_0x3f46d2(0x1dd)+_0x1058b4),Markup[_0x3f46d2(0x317)]['callback']('no',_0x3f46d2(0x147)+_0x1058b4)]);await sendTelegram(settings['telegramChatId'],_0x3f46d2(0x1b4),_0x26b4f0),tgBot[_0x3f46d2(0x34a)](/restore_(.+)_(.+)/,async _0x314723=>{const _0x51ab7e=_0x3f46d2,_0x413b36=_0x314723['match'][0x1],_0x413165=_0x314723[_0x51ab7e(0x1ad)][0x2],{path:_0xf9d498,filename:_0xdd6ba1}=tmpStorage[_0x413165];delete tmpStorage[_0x413165],_0x314723['editMessageReplyMarkup'](),_0x413b36=='yes'?(logger[_0x51ab7e(0x342)]('Restore\x20process\x20confirmed'),await sendTelegram(_0x314723[_0x51ab7e(0x143)]['id'],_0x51ab7e(0x166),{'parse_mode':_0x51ab7e(0x2f5)}),unzipFile(_0xf9d498,_0xdd6ba1)):(logger['debug'](_0x51ab7e(0x1da)),await sendTelegram(_0x314723[_0x51ab7e(0x143)]['id'],_0x51ab7e(0x1da)));});}}function getServerTime(){const _0xf11f20=_0xda629c,_0x5b1fdc=new Date();return _0x5b1fdc[_0xf11f20(0x270)]()+'/'+(_0x5b1fdc[_0xf11f20(0x324)]()+0x1)[_0xf11f20(0x345)]()[_0xf11f20(0x354)](0x2,'0')+'/'+_0x5b1fdc[_0xf11f20(0x1d6)]()[_0xf11f20(0x345)]()[_0xf11f20(0x354)](0x2,'0')+'\x20'+_0x5b1fdc[_0xf11f20(0x1c3)]()[_0xf11f20(0x345)]()[_0xf11f20(0x354)](0x2,'0')+':'+_0x5b1fdc[_0xf11f20(0x2cd)]()[_0xf11f20(0x345)]()[_0xf11f20(0x354)](0x2,'0')+':'+_0x5b1fdc[_0xf11f20(0x1b6)]()[_0xf11f20(0x345)]()[_0xf11f20(0x354)](0x2,'0');}function getTimeStamp(){const _0x50409c=_0xda629c,_0x1b68e8=shiftedTime();return _0x1b68e8[_0x50409c(0x270)]()+'/'+(_0x1b68e8[_0x50409c(0x324)]()+0x1)[_0x50409c(0x345)]()['padStart'](0x2,'0')+'/'+_0x1b68e8[_0x50409c(0x1d6)]()[_0x50409c(0x345)]()[_0x50409c(0x354)](0x2,'0')+'\x20'+_0x1b68e8['getHours']()['toString']()['padStart'](0x2,'0')+':'+_0x1b68e8[_0x50409c(0x2cd)]()[_0x50409c(0x345)]()[_0x50409c(0x354)](0x2,'0')+':'+_0x1b68e8[_0x50409c(0x1b6)]()[_0x50409c(0x345)]()[_0x50409c(0x354)](0x2,'0');}function getCleanTimeStamp(){const _0x290cc4=_0xda629c,_0x390ff6=shiftedTime();return _0x390ff6[_0x290cc4(0x270)]()+(_0x390ff6['getMonth']()+0x1)[_0x290cc4(0x345)]()['padStart'](0x2,'0')+_0x390ff6[_0x290cc4(0x1d6)]()[_0x290cc4(0x345)]()[_0x290cc4(0x354)](0x2,'0')+'-'+_0x390ff6['getHours']()[_0x290cc4(0x345)]()['padStart'](0x2,'0')+_0x390ff6[_0x290cc4(0x2cd)]()[_0x290cc4(0x345)]()[_0x290cc4(0x354)](0x2,'0')+_0x390ff6[_0x290cc4(0x1b6)]()[_0x290cc4(0x345)]()[_0x290cc4(0x354)](0x2,'0');}function shiftedTime(){const _0x2fcf0c=_0xda629c,_0x5e9e42=new Date();let _0xaf5ba5=_0x5e9e42;if(settings[_0x2fcf0c(0x203)]&&settings['timeshift']!==0x0)_0xaf5ba5=fns[_0x2fcf0c(0x25c)](_0x5e9e42,{'hours':settings[_0x2fcf0c(0x203)]});return _0xaf5ba5;}async function startScheduler(){const _0x4f855d=_0xda629c,_0x33c055=new Date()[_0x4f855d(0x26a)](),_0x3e4d40=shiftedTime()[_0x4f855d(0x1c3)]();_0x3e4d40==0x4&&backupConfigFiles(),_0x3e4d40==0x0&&(rotateLogFiles(),logger[_0x4f855d(0x342)]('--------------------------------------'),logger[_0x4f855d(0x342)]('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x4f855d(0x1bb)+(environment==_0x4f855d(0x28a)?_0x4f855d(0x220):'')),logger['debug'](_0x4f855d(0x149))),_0x33c055%0x6==0x0&&triggerAnalytics(),_0x33c055%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x36fa96){const _0x2e2755=_0xda629c;logger[_0x2e2755(0x342)](_0x2e2755(0x274)+_0x36fa96);const _0x4dca8b=getBotsWithMode();_0x4dca8b[_0x2e2755(0x30f)]>0x0?confirmRestore(configbackuppath,_0x36fa96):unzipFile(configbackuppath,_0x36fa96);}async function getBackupFiles(_0x2cdb93=null){const _0x3feaab=_0xda629c;let _0x96bf09=[],_0x2dfc9f=fs[_0x3feaab(0x206)](configbackuppath,{'withFileTypes':!![]});_0x2dfc9f[_0x3feaab(0x34c)]((_0x2befa6,_0x2e859c)=>_0x2befa6['name']<_0x2e859c[_0x3feaab(0x2e5)]?0x1:_0x2e859c[_0x3feaab(0x2e5)]<_0x2befa6[_0x3feaab(0x2e5)]?-0x1:0x0),_0x2dfc9f[_0x3feaab(0x20c)](_0x50d842=>{const _0x9568c9=_0x3feaab;if(!_0x50d842[_0x9568c9(0x16b)]()&&_0x50d842[_0x9568c9(0x2e5)][_0x9568c9(0x237)](_0x9568c9(0x28f))&&_0x50d842[_0x9568c9(0x2e5)][_0x9568c9(0x29f)](_0x9568c9(0x156))){const _0xf9c888=formatDate(fs[_0x9568c9(0x2b6)](configbackuppath+_0x50d842[_0x9568c9(0x2e5)])['mtime']);_0x96bf09[_0x9568c9(0x333)]({'name':_0x50d842['name'],'mtime':_0xf9c888});}});if(_0x2cdb93)io['to'](_0x2cdb93)['emit'](_0x3feaab(0x2de),_0x96bf09);else return _0x96bf09;}async function backupConfigFiles(){const _0x55c4f0=_0xda629c;await zipFiles(_0x55c4f0(0x296));const _0x1c3ef1=getCleanTimeStamp();fs[_0x55c4f0(0x288)](zippath+_0x55c4f0(0x199),configbackuppath+(_0x55c4f0(0x28f)+_0x1c3ef1+_0x55c4f0(0x156)));let _0x4a387d=fs[_0x55c4f0(0x206)](configbackuppath,{'withFileTypes':!![]});_0x4a387d[_0x55c4f0(0x34c)]((_0x537bb4,_0x223d38)=>_0x537bb4[_0x55c4f0(0x2e5)]<_0x223d38[_0x55c4f0(0x2e5)]?0x1:_0x223d38['name']<_0x537bb4[_0x55c4f0(0x2e5)]?-0x1:0x0),_0x4a387d[_0x55c4f0(0x30f)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x4a387d[_0x4a387d[_0x55c4f0(0x30f)]-0x1]['name']);}function rotateLogFiles(){const _0x4f6d4b=_0xda629c,_0xd6c0dc=fs[_0x4f6d4b(0x2b6)](logspath+'output-000.log'),_0x5dfac8=_0xd6c0dc[_0x4f6d4b(0x13f)]/0x400;if(_0x5dfac8>0x64){let _0x1befef=fs[_0x4f6d4b(0x206)](logspath,{'withFileTypes':!![]});_0x1befef[_0x4f6d4b(0x34c)]((_0x39b7d5,_0x162996)=>_0x39b7d5['name']<_0x162996[_0x4f6d4b(0x2e5)]?0x1:_0x162996[_0x4f6d4b(0x2e5)]<_0x39b7d5[_0x4f6d4b(0x2e5)]?-0x1:0x0),_0x1befef[_0x4f6d4b(0x20c)](_0xfb0687=>{const _0x587ff8=_0x4f6d4b;if(_0xfb0687[_0x587ff8(0x2e5)]==_0x587ff8(0x284))fs['copyFileSync'](logspath+_0xfb0687[_0x587ff8(0x2e5)],logspath+'output-003.log');if(_0xfb0687[_0x587ff8(0x2e5)]==_0x587ff8(0x29d))fs[_0x587ff8(0x288)](logspath+_0xfb0687[_0x587ff8(0x2e5)],logspath+_0x587ff8(0x284));_0xfb0687[_0x587ff8(0x2e5)]==_0x587ff8(0x202)&&(fs['copyFileSync'](logspath+_0xfb0687[_0x587ff8(0x2e5)],logspath+_0x587ff8(0x29d)),fs[_0x587ff8(0x1e6)](logspath+_0xfb0687[_0x587ff8(0x2e5)],''));});}}async function zipFiles(_0x1534da){const _0x32ef5f=_0xda629c;let _0x403613;if(_0x1534da==_0x32ef5f(0x154))_0x403613=logspath;if(_0x1534da==_0x32ef5f(0x22b))_0x403613=configpath;if(_0x1534da==_0x32ef5f(0x296))_0x403613=configpath;let _0xbed6b7=fs[_0x32ef5f(0x206)](_0x403613,{'withFileTypes':!![]});const _0x5d6e96=new JSZip();_0xbed6b7[_0x32ef5f(0x20c)](_0x1224d6=>{const _0x3657e0=_0x32ef5f;if(!_0x1224d6[_0x3657e0(0x16b)]()){let _0x2f1fd2=fs[_0x3657e0(0x235)](_0x403613+_0x1224d6[_0x3657e0(0x2e5)]);if(_0x1534da==_0x3657e0(0x22b)){const _0x1cd4ff=/^bot-[0-9]{3}-config.json$/,_0x32e2af=_0x1cd4ff[_0x3657e0(0x184)](_0x1224d6[_0x3657e0(0x2e5)]);if(_0x32e2af){const _0xf6638a=JSON[_0x3657e0(0x1a2)](_0x2f1fd2);if(_0xf6638a[_0x3657e0(0x18d)][0x0]){_0xf6638a['bot'][0x0]['apiKey']='***',_0xf6638a[_0x3657e0(0x18d)][0x0][_0x3657e0(0x133)]=_0x3657e0(0x1ef);if(_0xf6638a[_0x3657e0(0x18d)][0x0][_0x3657e0(0x19c)])_0xf6638a[_0x3657e0(0x18d)][0x0][_0x3657e0(0x19c)]=_0x3657e0(0x1ef);}_0x2f1fd2=JSON[_0x3657e0(0x2c8)](_0xf6638a,null,0x2);}if(_0x1224d6[_0x3657e0(0x2e5)]==_0x3657e0(0x16e)){const _0x23e228=JSON[_0x3657e0(0x1a2)](_0x2f1fd2);if(_0x23e228[_0x3657e0(0x14e)][_0x3657e0(0x20f)])_0x23e228[_0x3657e0(0x14e)][_0x3657e0(0x20f)]=![];if(_0x23e228[_0x3657e0(0x14e)]['bbPassword'])_0x23e228[_0x3657e0(0x14e)]['bbPassword']=_0x3657e0(0x1ef);if(_0x23e228[_0x3657e0(0x14e)][_0x3657e0(0x18f)])_0x23e228[_0x3657e0(0x14e)]['telegramToken']=_0x3657e0(0x1ef);if(_0x23e228[_0x3657e0(0x14e)]['telegramChatId'])_0x23e228[_0x3657e0(0x14e)][_0x3657e0(0x1ed)]=null;if(_0x23e228[_0x3657e0(0x14e)][_0x3657e0(0x231)])_0x23e228[_0x3657e0(0x14e)][_0x3657e0(0x231)]=_0x3657e0(0x1ef);_0x2f1fd2=JSON[_0x3657e0(0x2c8)](_0x23e228,null,0x2);}if(_0x1224d6[_0x3657e0(0x2e5)]!=_0x3657e0(0x25f))_0x5d6e96['file'](_0x1224d6[_0x3657e0(0x2e5)],_0x2f1fd2);}else _0x5d6e96[_0x3657e0(0x2fd)](_0x1224d6[_0x3657e0(0x2e5)],_0x2f1fd2);}});const _0x5cab10=await _0x5d6e96['generateAsync']({'type':_0x32ef5f(0x33e),'base64':![],'compression':'DEFLATE'});fs[_0x32ef5f(0x1e6)](zippath+(_0x1534da+_0x32ef5f(0x156)),_0x5cab10,_0x32ef5f(0x33f));}async function unzipFile(_0x7f8532,_0x2e6008){const _0x2aa3c3=_0xda629c;fs[_0x2aa3c3(0x206)](configpath,{'withFileTypes':!![]})[_0x2aa3c3(0x20c)](_0x4fdb89=>{const _0x2529a0=_0x2aa3c3;if(!_0x4fdb89[_0x2529a0(0x16b)]())fs[_0x2529a0(0x27f)](configpath+_0x4fdb89['name']);});const _0x29a2ea=fs[_0x2aa3c3(0x235)](_0x7f8532+_0x2e6008,'binary'),_0xbfbe86=await JSZip[_0x2aa3c3(0x19b)](_0x29a2ea,{'base64':![],'checkCRC32':!![]});for(const _0x28c3e1 of Object[_0x2aa3c3(0x1e2)](_0xbfbe86['files'])){const _0x5a8934=_0xbfbe86['files'][_0x28c3e1],_0x59f77d=await _0x5a8934[_0x2aa3c3(0x279)](_0x2aa3c3(0x33e));fs[_0x2aa3c3(0x1e6)](configpath+_0x5a8934[_0x2aa3c3(0x2e5)],_0x59f77d);}fs[_0x2aa3c3(0x206)](temppath,{'withFileTypes':!![]})[_0x2aa3c3(0x20c)](_0x4de49a=>{const _0x38cb7c=_0x2aa3c3;if(!_0x4de49a[_0x38cb7c(0x16b)]())fs['rmSync'](temppath+_0x4de49a['name']);}),logger[_0x2aa3c3(0x342)]('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x2aa3c3(0x254)]({'restore':!![]},_0x3fa4df=>{});}async function getPublicIp(){const _0x3a4349=_0xda629c;try{const _0x568fd0=await axios[_0x3a4349(0x275)](_0x3a4349(0x178));publicip=_0x568fd0[_0x3a4349(0x13d)]['ip'];}catch(_0x4a8fe6){}}async function triggerAnalytics(){const _0x26e9a6=_0xda629c;if(!publicip)await getPublicIp();const _0x275d85=getBotsWithMode();let _0x586462=0x0;_0x275d85[_0x26e9a6(0x20c)](_0x22c7b4=>{const _0x400475=_0x26e9a6;if(_0x22c7b4[_0x400475(0x21a)]===_0x400475(0x174))_0x586462++;});const _0xfb1f7=getBotExchanges();mixpanel['track'](_0x26e9a6(0x286),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x275d85['length'],'numbotsenabled':_0x586462,'exchanges':_0xfb1f7,'environment':environment});}async function getMessages(){const _0x219138=_0xda629c,_0x503ac8=_0x219138(0x224),_0x1b5d91=new GraphQLClient(_0x503ac8),_0x131e5c={'authorization':_0x219138(0x14f)},_0x2d00e6=serverversion['split']('.'),_0x5a503f=_0x2d00e6[0x0]+'.'+_0x2d00e6[0x1],_0x47eee7=Math['min'](settings[_0x219138(0x2da)],settings['lastmsgemitted']),_0x14892e={'last':parseInt(_0x47eee7),'bbm':_0x5a503f},_0x2f9c89=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x254df3;try{_0x254df3=await _0x1b5d91[_0x219138(0x310)](_0x2f9c89,_0x14892e,_0x131e5c);}catch(_0x5eb26b){}if(_0x254df3&&_0x254df3[_0x219138(0x135)]){let _0x2fd67d=settings[_0x219138(0x2da)];newMessages=[];for(const _0x35d8f9 of _0x254df3[_0x219138(0x135)]){newMessages[_0x219138(0x333)](_0x35d8f9);let _0x473878=![];_0x35d8f9[_0x219138(0x2ab)]&&(updateSetting(_0x219138(0x209),_0x35d8f9[_0x219138(0x2ab)]),_0x473878=isNewerVersion(serverversion,_0x35d8f9['bbvNew'])||serverversion==_0x35d8f9[_0x219138(0x2ab)]);if(!_0x473878&&_0x35d8f9[_0x219138(0x213)]>_0x2fd67d){if(_0x35d8f9[_0x219138(0x236)]===_0x219138(0x1b0)||serverversion[_0x219138(0x237)](_0x35d8f9[_0x219138(0x236)])){let _0x15233c=''+_0x35d8f9[_0x219138(0x186)]+'\x0a\x0a'+_0x35d8f9[_0x219138(0x293)];const _0x9a3e67=await sendTelegramMsg(toTelegramMarkdown(_0x15233c),_0x219138(0x2cb));if(_0x9a3e67)_0x2fd67d=_0x35d8f9['number'];}}}updateAvailable=isNewerVersion(settings[_0x219138(0x209)],serverversion),updateSetting(_0x219138(0x2da),_0x2fd67d),emitMessages();}}function emitMessages(){const _0x4b3045=_0xda629c,_0x22258a=settings[_0x4b3045(0x2d4)];let _0x179e2f=[];newMessages[_0x4b3045(0x20c)](_0x3e64e7=>{const _0x36bccb=_0x4b3045;_0x3e64e7[_0x36bccb(0x213)]>_0x22258a&&_0x179e2f[_0x36bccb(0x333)](_0x3e64e7);}),_0x179e2f['length']>0x0&&getAllClients()[_0x4b3045(0x20c)](_0x3d1518=>{const _0x3fcf9e=_0x4b3045;getSocket(_0x3d1518['id'])['emit'](_0x3fcf9e(0x293),_0x179e2f);});}function confirmMessage(_0x50f072){const _0x5354a2=_0xda629c;updateSetting(_0x5354a2(0x2d4),Number(_0x50f072));}function isNewerVersion(_0x3a5b7e,_0x330193){const _0x786ecd=_0xda629c,_0x2fc2e3=_0x330193[_0x786ecd(0x340)]('.'),_0x513ba9=_0x3a5b7e[_0x786ecd(0x340)]('.');for(var _0x344ae8=0x0;_0x344ae8<_0x513ba9[_0x786ecd(0x30f)];_0x344ae8++){const _0x52d7d8=~~_0x513ba9[_0x344ae8],_0x31ebb6=~~_0x2fc2e3[_0x344ae8];if(_0x52d7d8>_0x31ebb6)return!![];if(_0x52d7d8<_0x31ebb6)return![];}return![];}function toTelegramMarkdown(_0x4b9b67){const _0x52fde3=_0xda629c,_0x57abc4=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x204f2a=/\*{2}(.+?)\*{2}/gim;return _0x4b9b67=_0x4b9b67['replace'](_0x57abc4,_0x52fde3(0x326))[_0x52fde3(0x33b)](_0x204f2a,_0x52fde3(0x2e6)),_0x4b9b67;}async function validateConfigFile(){const _0x2c28db=_0xda629c,_0x22ed35=dbConfig[_0x2c28db(0x275)](_0x2c28db(0x244))[_0x2c28db(0x2d6)](_0x2c28db(0x222))[_0x2c28db(0x1ca)]()||[];if(_0x22ed35['length']==0x0){let _0x4bf370=0x0,_0xa27c65=[];const _0x52a969=/^bot-([0-9]{3})-config.json$/,_0x156659=fs[_0x2c28db(0x206)](configpath);_0x156659[_0x2c28db(0x20c)](_0x366780=>{const _0x4291cf=_0x2c28db,_0x2b27fc=_0x52a969[_0x4291cf(0x246)](_0x366780);if(_0x2b27fc){const _0x2f24b8=_0x2b27fc[0x1];let _0x65beec=getBotAttributes(_0x2f24b8);_0xa27c65[_0x4291cf(0x333)]({'botID':_0x2f24b8,'botname':_0x65beec[_0x4291cf(0x302)],'status':'disabled','live':_0x4291cf(0x2a8)}),_0x4bf370++;}}),_0x4bf370!=0x0&&(dbConfig[_0x2c28db(0x275)](_0x2c28db(0x244))['assign'](_0xa27c65)[_0x2c28db(0x1c0)](),config=_0xa27c65,restoredConfigFile=_0x4bf370);}}async function restoreConfigNotify(_0x579476){const _0x29a9d2=_0xda629c;let _0x316582;if(restoredConfigFile==0x1)_0x316582=_0x29a9d2(0x1ec);else _0x316582=_0x29a9d2(0x13c);if(_0x579476)io['to'](_0x29a9d2(0x29b))[_0x29a9d2(0x16d)](_0x29a9d2(0x219),_0x316582);else{logger['simple'](_0x29a9d2(0x2f4)),logger['simple'](_0x316582),logger[_0x29a9d2(0x160)]('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings[_0x29a9d2(0x1ed)]&&settings['telegramEvents']!=_0x29a9d2(0x1bd))await sendTelegram(settings[_0x29a9d2(0x1ed)],'Bot\x20Mgr\x20>\x20'+_0x316582);}}function decryptRSA(_0x111cc3,_0x4aef20){const _0x567cd7=_0xda629c,_0x40d22d=forge[_0x567cd7(0x2c6)]['privateKeyFromPem'](_0x111cc3),_0x566716=_0x40d22d[_0x567cd7(0x304)](forge['util'][_0x567cd7(0x153)](_0x4aef20),_0x567cd7(0x1e1),{'md':forge['md'][_0x567cd7(0x1df)]['create'](),'mgf1':{'md':forge['md'][_0x567cd7(0x1df)]['create']()}});return _0x566716;}function validateCredentials(_0xd1302e,_0x178d63){const _0x26a5f6=_0xda629c;if(_0xd1302e[_0x26a5f6(0x352)]==settings[_0x26a5f6(0x1a0)]&&bcrypt['compareSync'](_0xd1302e[_0x26a5f6(0x168)],settings[_0x26a5f6(0x1a8)])){if(settings[_0x26a5f6(0x1e3)])return{'allow':![],'reason':_0x26a5f6(0x1f4),'token':null};else{const _0x5538d0=generateLoginToken(_0x178d63);return{'allow':!![],'reason':_0x26a5f6(0x344),'token':_0x5538d0};}}else return{'allow':![],'reason':_0x26a5f6(0x247),'token':null};}function refreshToken(_0x32adef){const _0x577785=_0xda629c,_0x13b1da=generateLoginToken(_0x32adef);return{'allow':!![],'reason':_0x577785(0x344),'token':_0x13b1da};}function validateAccess(_0xd37c28,_0x2f7d97,_0x5eeeca){const _0x482b17=_0xda629c,_0x962a6f=_0x5eeeca?_0x5eeeca:devices[_0x2f7d97]['ip'];let _0x300bcd;const _0x4f53af=_0x1a8746=>{const _0x3106da=_0x529b;if(settings[_0x3106da(0x20f)]){if(settings['f2aRequired']){if(telegram2FaApproved(_0x2f7d97)){const _0x4250bb=generateLoginToken(_0x2f7d97);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x4250bb};}else return{'allow':![],'reason':'login\x20required','token':null};}else return _0x300bcd=validToken(_0x1a8746,_0x2f7d97),_0x300bcd[_0x3106da(0x257)](_0x3106da(0x172))?{'allow':!![],'reason':_0x3106da(0x343),'token':_0x1a8746}:{'allow':![],'reason':_0x3106da(0x1a4),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x482b17(0x2c0)]){let _0x24d66e=[...settings[_0x482b17(0x1fc)],_0x482b17(0x282),_0x482b17(0x2cf),_0x482b17(0x17b)];if(_0x24d66e[_0x482b17(0x2e8)](_0x962a6f))return _0x4f53af(_0xd37c28);else{_0x300bcd=validToken(_0xd37c28,_0x2f7d97);if(_0x300bcd[_0x482b17(0x257)](_0x482b17(0x172)))return _0x4f53af(_0xd37c28);else{if(telegramIpApproved(_0x2f7d97)){const _0x12fa32=generateToken(_0x2f7d97);return _0x300bcd=_0x4f53af(_0xd37c28),_0x300bcd[_0x482b17(0x29c)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x12fa32}:_0x300bcd;}else return settings[_0x482b17(0x28d)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x4f53af(_0xd37c28);}function timelyDecrypt(_0x21c796,_0x2a72f2,_0x87deef='@'){const _0x2ba305=_0xda629c;if(_0x21c796)try{const _0x213985=decryptRSA(secure[_0x2ba305(0x2b4)],_0x21c796),_0x31474a=_0x213985[_0x2ba305(0x340)](_0x87deef)[0x0],_0xcdcbb7=_0x213985[_0x2ba305(0x340)](_0x87deef)[0x1],_0x49712b=new Date()[_0x2ba305(0x25b)]();if(_0x2a72f2){if(_0x49712b-_0xcdcbb7<maxSecretAge*0x3e8)return _0x31474a;else return![];}else return _0x31474a;}catch(_0x15ea9c){return![];}else return![];}const validToken=(_0x4f1c27,_0x1e6514)=>{const _0x5822c3=_0xda629c,_0x2c0f31=devices[_0x1e6514]['ip'];if(!_0x4f1c27)return{'error':_0x5822c3(0x1b8)};for(let _0x503903 of blacklist){if(_0x503903[_0x5822c3(0x330)]==_0x4f1c27)return{'error':'Token\x20blacklisted'};}let _0x57b2b7;try{_0x57b2b7=jwt[_0x5822c3(0x1a5)](_0x4f1c27,secure['secret']+_0x1e6514);}catch{return{'error':_0x5822c3(0x320)};}if(!_0x57b2b7[_0x5822c3(0x257)](_0x5822c3(0x183))&&!_0x57b2b7[_0x5822c3(0x257)](_0x5822c3(0x352))||!_0x57b2b7[_0x5822c3(0x257)]('exp'))return{'error':'Invalid\x20authentication\x20token\x20(2)'};if(!_0x57b2b7[_0x5822c3(0x257)](_0x5822c3(0x352))&&_0x57b2b7[_0x5822c3(0x257)](_0x5822c3(0x183))){const {clientip:_0x21e981}=_0x57b2b7;return _0x2c0f31==_0x21e981?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x5822c3(0x131)};}else{if(_0x57b2b7['hasOwnProperty'](_0x5822c3(0x352))&&_0x57b2b7[_0x5822c3(0x257)]('clientip')){const {username:_0x22ca8,clientip:_0x2b118c}=_0x57b2b7;return settings[_0x5822c3(0x1a0)]==_0x22ca8&&_0x2c0f31==_0x2b118c?{'success':_0x5822c3(0x1ce)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x3af93c=>{const _0x47f4d4=_0xda629c;if(_0x3af93c){const _0x23a7ec=devices[_0x3af93c]['ip'];return jwt[_0x47f4d4(0x2f9)]({'username':settings['bbUsername'],'clientip':_0x23a7ec},secure[_0x47f4d4(0x32b)]+_0x3af93c,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x5207cc=>{const _0xfb8475=_0xda629c;if(_0x5207cc){const _0x142fe2=devices[_0x5207cc]['ip'];return jwt[_0xfb8475(0x2f9)]({'clientip':_0x142fe2},secure['secret']+_0x5207cc,{'expiresIn':devices[_0x5207cc]['telegramIpApproval'][_0xfb8475(0x1e5)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x225b31=>{const _0x64ab7b=_0xda629c;let _0x595c01=![];return devices[_0x225b31][_0x64ab7b(0x2e4)]&&devices[_0x225b31][_0x64ab7b(0x2e4)]['expiry']!=_0x64ab7b(0x2eb)&&(_0x595c01=devices[_0x225b31][_0x64ab7b(0x2e4)][_0x64ab7b(0x183)]==devices[_0x225b31]['ip']&&new Date()[_0x64ab7b(0x25b)]()-devices[_0x225b31][_0x64ab7b(0x2e4)]['timestamp']<devices[_0x225b31]['telegramIpApproval'][_0x64ab7b(0x1e5)]*0x3c*0x3e8),_0x595c01;},telegram2FaApproved=_0x2be815=>{const _0x5aacac=_0xda629c;let _0x37971e=![];return devices[_0x2be815]['telegram2FaApproval']&&devices[_0x2be815]['telegram2FaApproval'][_0x5aacac(0x1e5)]!=_0x5aacac(0x2eb)&&(_0x37971e=devices[_0x2be815][_0x5aacac(0x173)]['clientip']==devices[_0x2be815]['ip']&&new Date()[_0x5aacac(0x25b)]()-devices[_0x2be815][_0x5aacac(0x173)][_0x5aacac(0x150)]<devices[_0x2be815]['telegram2FaApproval'][_0x5aacac(0x1e5)]*0x3c*0x3e8),_0x37971e;},normalizeIP=_0x5c1658=>{const _0x800597=_0xda629c;let _0x1911fb=null,_0x1c3eab=null;if(ipaddr[_0x800597(0x32a)](_0x5c1658)){const _0x22a5b0=ipaddr[_0x800597(0x1a2)](_0x5c1658);_0x22a5b0['kind']()===_0x800597(0x250)?(_0x22a5b0['isIPv4MappedAddress']()&&(_0x1911fb=_0x22a5b0[_0x800597(0x261)]()[_0x800597(0x345)]()),_0x1c3eab=_0x22a5b0[_0x800597(0x345)]()):(_0x1911fb=_0x22a5b0[_0x800597(0x345)](),_0x1c3eab=_0x22a5b0[_0x800597(0x157)]()[_0x800597(0x345)]());}return{'show':_0x1911fb?_0x1911fb:_0x1c3eab,'store':_0x1c3eab};};function formatDate(_0xdf5657){const _0xefab58=_0xda629c;return _0xdf5657[_0xefab58(0x270)]()+'/'+(_0xdf5657[_0xefab58(0x324)]()+0x1)['toString']()[_0xefab58(0x354)](0x2,'0')+'/'+_0xdf5657[_0xefab58(0x1d6)]()['toString']()[_0xefab58(0x354)](0x2,'0')+'\x20'+_0xdf5657[_0xefab58(0x1c3)]()[_0xefab58(0x345)]()['padStart'](0x2,'0')+':'+_0xdf5657[_0xefab58(0x2cd)]()[_0xefab58(0x345)]()[_0xefab58(0x354)](0x2,'0')+':'+_0xdf5657['getSeconds']()[_0xefab58(0x345)]()['padStart'](0x2,'0');}function sleep(_0x50cd63){return new Promise(_0x37c33b=>setTimeout(_0x37c33b,_0x50cd63));}