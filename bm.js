function _0x458b(_0x2293a3,_0xc5c030){const _0x184636=_0xffa6();return _0x458b=function(_0x5289c8,_0x5e54f6){_0x5289c8=_0x5289c8-0x1f2;let _0xffa6d4=_0x184636[_0x5289c8];return _0xffa6d4;},_0x458b(_0x2293a3,_0xc5c030);}const _0x14ce44=_0x458b;(function(_0x5580da,_0x28f49d){const _0x417e2e=_0x458b,_0x45945f=_0x5580da();while(!![]){try{const _0x3295b2=parseInt(_0x417e2e(0x289))/0x1+parseInt(_0x417e2e(0x3fd))/0x2*(parseInt(_0x417e2e(0x246))/0x3)+parseInt(_0x417e2e(0x3d2))/0x4*(parseInt(_0x417e2e(0x29b))/0x5)+parseInt(_0x417e2e(0x315))/0x6*(parseInt(_0x417e2e(0x26b))/0x7)+parseInt(_0x417e2e(0x30c))/0x8*(-parseInt(_0x417e2e(0x249))/0x9)+-parseInt(_0x417e2e(0x35a))/0xa+-parseInt(_0x417e2e(0x38c))/0xb;if(_0x3295b2===_0x28f49d)break;else _0x45945f['push'](_0x45945f['shift']());}catch(_0x3e1cc2){_0x45945f['push'](_0x45945f['shift']());}}}(_0xffa6,0x8c2c0));const _0x5e54f6=function(){let _0x4950a9=!![];return function(_0x34c335,_0x67256d){const _0x56d573=_0x4950a9?function(){const _0x1966f4=_0x458b;if(_0x67256d){const _0x24d098=_0x67256d[_0x1966f4(0x3d6)](_0x34c335,arguments);return _0x67256d=null,_0x24d098;}}:function(){};return _0x4950a9=![],_0x56d573;};}(),_0x5289c8=_0x5e54f6(this,function(){const _0xe027d5=_0x458b;return _0x5289c8[_0xe027d5(0x285)]()['search'](_0xe027d5(0x2f3))['toString']()[_0xe027d5(0x32d)](_0x5289c8)[_0xe027d5(0x355)](_0xe027d5(0x2f3));});_0x5289c8();'use strict';process['env'][_0x14ce44(0x385)]=0x1;const childProcess=require(_0x14ce44(0x3c4)),fs=require('fs'),fns=require(_0x14ce44(0x308)),low=require(_0x14ce44(0x219)),FileSync=require(_0x14ce44(0x1f5)),path=require(_0x14ce44(0x1f8)),crypto=require(_0x14ce44(0x26f)),forge=require('node-forge'),bcrypt=require(_0x14ce44(0x20f)),jwt=require(_0x14ce44(0x240)),ipaddr=require(_0x14ce44(0x209)),argv=require(_0x14ce44(0x287))(process['argv'][_0x14ce44(0x299)](0x2))[_0x14ce44(0x2ca)],uuidRandom=require(_0x14ce44(0x268)),{Telegraf,Markup}=require(_0x14ce44(0x35d)),Mixpanel=require('mixpanel'),axios=require(_0x14ce44(0x40a)),{GraphQLClient,gql}=require('graphql-request'),util=require(_0x14ce44(0x318)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv[_0x14ce44(0x3a9)]||_0x14ce44(0x32e),pattern=/^[0-9]{2,4}$/;!pattern[_0x14ce44(0x221)](PORT)&&(console[_0x14ce44(0x34a)]('Error:\x20Invalid\x20argument\x20'+PORT+_0x14ce44(0x31a)),process[_0x14ce44(0x2ce)](0x1));const HOST=argv[_0x14ce44(0x22b)]||null,userID=argv[_0x14ce44(0x402)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process['versions'][_0x14ce44(0x367)];let bbpath=_0x14ce44(0x3a8),bbpath2='';const botfile='bot.js',configfile=_0x14ce44(0x223),settingsfile=_0x14ce44(0x23b),securefile=_0x14ce44(0x33f),environment=require('./'+bbpath2+_0x14ce44(0x22d))[_0x14ce44(0x2bc)]||_0x14ce44(0x22c),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x14ce44(0x3a4)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+'clients'),configpath=userID?bbpath+_0x14ce44(0x2d0)+userID+'/':bbpath+_0x14ce44(0x2d0),configbackuppath=configpath+_0x14ce44(0x2c9),logspath=userID?bbpath+_0x14ce44(0x2d1)+userID+'/':bbpath+_0x14ce44(0x2d1),zippath=userID?bbpath+_0x14ce44(0x365)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x14ce44(0x3ff)](logspath+_0x14ce44(0x233),{'flags':'a'}),temppath=userID?bbpath+_0x14ce44(0x3d3)+userID+'/':bbpath+_0x14ce44(0x3d3);!fs['existsSync'](configpath)&&fs[_0x14ce44(0x2e4)](configpath);!fs[_0x14ce44(0x3a4)](configbackuppath)&&fs[_0x14ce44(0x2e4)](configbackuppath);!fs[_0x14ce44(0x3a4)](logspath)&&fs[_0x14ce44(0x2e4)](logspath);!fs[_0x14ce44(0x3a4)](zippath)&&fs[_0x14ce44(0x2e4)](zippath);!fs[_0x14ce44(0x3a4)](temppath)&&fs['mkdirSync'](temppath);function _0xffa6(){const _0x367374=['clientip','resetHistory','split','File\x20uploaded','SIGINT','uuid','bb-settings.json','enable','Failed\x20to\x20download\x20','staging','Invalid\x20authentication\x20token\x20(2)','jsonwebtoken','mtime','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','help','RSA-OAEP','latestversion','3EfvZif','event','Unauthorized\x20attempt\x20to\x20show\x20configuration','9cHnJoW',')\x20|\x20Bot\x20','/:bot/portfolio','api-eu.mixpanel.com','/names\x20-\x20show\x20bot\x20names\x0a','getDate','logged\x20out','sockets','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','Error\x20removing\x20old\x20backup\x20files:','portfolio_','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','Error\x20details:','set','hasOwnProperty','debug','defaults','Starting\x20Balance\x20Bot\x20reinstallation','family','any','15\x20min','telegramChatId','getStartingBalances','botname','find','start','Unauthorized\x20attempt\x20to\x20update\x20bot','sort','access\x20timeout','Restore\x20process\x20confirmed','Starting\x20(','uuid-random','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','2FA\x20login\x20required','28JzwOAP','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','binary','apiPassword','crypto','SIGTERM','statSync','readdirSync','All\x20bots\x20running\x20right\x20now','delete-alerts','reinstall_no','expiry','login','initclient','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','logout','stop','/start','keys','whitelistEnabled','verify','randomBytes','file','mode','action','orders','toString','string','yargs/yargs','yes','790772bfnPdL','telegramToken','restart','Orders','DEFLATE','/:bot/performance','/help\x20-\x20show\x20available\x20commands\x0a','bot','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','store-settings','Deleted\x20Bot\x20','allow','rmSync','copyFileSync','status\x20code\x20401','login\x20token\x20valid','slice','No\x20bots\x20running\x20right\x20now','5329105WKpYjH','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','endsWith','https://api.ipify.org?format=json','/enable\x20-\x20enable\x20notifications\x0a','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','temporary\x20access\x20rejected','privateKeyToPem','CoinMarketCap\x20API\x20key\x20validated','decode64','sendMetricsTelegram','backup-full','Bot\x20','alias','/:bot/history','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','output-002.log','Setting\x20access:\x20','deleteHistoryAlerts','telegramIpApproval','includes','login2fa_reject_','-performance.json','\x1b[31m','Token\x20blacklisted','0.0.0','tempaccess_30_','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','then','startsWith','getPortfolio','hex','pidRefreshToken','environment','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','Telegram\x20error:','update-bot','\x20(1)','\x20minutes','showConfig','createServer','Idling\x20(','/on\x20-\x20start\x20bot(s)\x0a','User\x20has\x20been\x20validated','inlineKeyboard','backup/','argv','loadAsync','*$1*','assign','exit','login\x20required','config/','logs/','sendPortfolioTelegram','Unauthorized\x20attempt\x20to\x20update\x20settings','from','static','range','/backup\x20-\x20receive\x20backup\x20files\x0a','apiKey','generateAsync','value','push','Yes','botID','showname','blacklist','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Invalid\x20authentication\x20token\x20(1)','/status\x20-\x20show\x20bot(s)\x20status\x0a','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','mkdirSync','disable','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','-----------------------------------------------------------------------------------','#RES#\x20if\x20running\x20on\x20server','reload','/disable\x20-\x20disable\x20notifications\x0a','Restore\x20process\x20aborted','Login\x20accepted','Error\x20sending\x20','socket','Logged\x20out\x20user\x20...','token','get','\x20(2)','(((.+)+)+)+$','login2fa_','restore_yes_','params','toIPv4MappedAddress','Unauthorized\x20attempt\x20to\x20get\x20messages','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','error','2FA\x20required','-results.json','Invalid\x20IP\x20address','#RES#\x20if\x20running\x20locally\x0a','127.0.0.1','launch','config_all','publicKey','userid','type','Unauthorized\x20login\x20attempt\x20(timeout)','getHours','chat','date-fns','new','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','delete-bot','5924888yhQtvD','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','reset-history','update-bb','HTML','access','No\x20authentication\x20token','sign','message','1376634acYQIn','-config.json','1000','util','init',',\x20must\x20be\x20a\x204\x20digit\x20number','apiSecret','live','#RES#\x20','messages','Access\x20enabled\x20for\x20','temporary\x20access\x20timeout','build','backupfile','getMinutes','address','storeHeadless','get-logs','isIPv4MappedAddress','toIPv4Address','catch','sortBy','full','entries','constructor','3000','logs','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','number','\x1b[34m','bbPassword','f2aRequired','/:bot/support','generateKeyPair','internal','Ok,\x20will\x20send\x20order\x20notifications\x20only','restore-backup-file','stringify','download','disconnect',':\x20Bot\x20Mgr\x20>\x20','use','bb-secure.json','padStart','restore_no_','randomFillSync','timeshift','inherit','button','reset-password','sendFile','privateKeyFromPem','.zip','log','filter','2FA\x20login\x20rejected','reply','build2','Unauthorized\x20attempt\x20to\x20store\x20configuration','format','reason','2FA','listen','IPv4','search',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','getUTCHours','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','hashSync','1572410fOxEwC','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','bbvNew','telegraf','join','***','update','Session\x20expired\x20for\x20user\x20...','started','running','reject','zip/','Bot\x20Mgr\x20>\x20','node','All\x20bots','loginRequired','bot-','temporary\x20token\x20generated','size','exchange','Running\x20#RED#Balance\x20Bot\x20v','toggle','updatebotmanager','<b>Telegram\x20Bot\x20Status:</b>\x0a','get-backup-files','Restoring\x20bot(s)\x20from\x20backup','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','/metrics\x20-\x20show\x20bot\x20performance\x0a','secure','backup-full@','exec','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','backup','privateKey','$1_$2_$3','off_','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','botmanager','editMessageReplyMarkup','publicKeyToPem','Enabled\x20Bot\x20','config_orders','headers','NTBA_FIX_319','toggle-bot-mode','\x20|\x20','lastmsgemitted','config','secret','\x20to\x20','25794890WnHTke','[ip-address]','replace','\x20-\x20','writeFileSync','confirm-message','\x20mode','cancelLoading','\x20>\x20','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','/download/:type','success','Unauthorized\x20attempt\x20to\x20get\x20portfolio','Notifications\x20disabled\x0a','Alerts','tempaccess_15_','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','unlinkSync','telegram2FaApproval','Logged\x20in\x20user\x20...','Password\x20has\x20been\x20reset\x20to:\x20','kill','write','remoteAddress','existsSync','title','Starting\x20new\x20bot\x20|\x20Bot\x20','\x1b[35m','bb/','port','Notifications\x20types:\x20','tempaccess_5_','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','\x20files\x20over\x20Telegram:','/:bot','pki','metrics','telegramEnabled','post','sendMessage','kind','Markdown','telegramUsername','files','length','telegram','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','BCT','/restart\x20-\x20restart\x20bot(s)\x0a','command','index.html','bbvReceive','(staging)','Disabled\x20Bot\x20','auto','child_process','output-000.log','getTime','disabled','Network\x20Interfaces:','restart_','encryptedUuid','tkn','storeFiat','simple','emit','Restarting\x20Bot\x20','handshake','enabled','4SrYUYw','temp/','reinstall-bb','status','apply','getFullYear','Login\x20rejected','Allow\x20login\x20from\x20IP\x20address\x20','bbUsername','bots','once','get-starting-balances','get-portfolio','names','all','update_no','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','emitHistory','\x1b[0m','\x20|\x20user:\x20...','new-disabled','Starting\x20Balance\x20Bot\x20update','remove','-events.json','config_alerts','************','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','onepagemode','6b67f3d61ee94b8f5c80b4affef4c4d9','track','Unauthorized\x20attempt\x20to\x20confirm\x20message','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','store','::1','name','reinstall_yes','Unauthorized\x20attempt\x20to\x20download\x20','\x20only\x0a','rsa','order','login\x20not\x20required','compareSync','2085274eWWUPW','settings','createWriteStream','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','user','match','send','temporaryAccessAllowed','socket.io','telegramEvents','reinstall','Notifications\x20enabled','axios','store-headless','code','notification','getSeconds','\x20|\x20client:\x20...','lowdb/adapters/FileSync','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','create','path','isDirectory','|@|','backup-full.zip','forEach','--------------------------------------','getMonth','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','Temporary\x20access\x20rejected','pidExpireLogin','store-configuration','max','place-order','output-001.log','map','ETH','parse','ipaddr.js','30\x20min','fork','uncaughtException','manual','close','bcryptjs','Server','\x1b[36m','\x1b[33m','http','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','Backup\x20file\x20unzipped\x20and\x20stored','marketcapApi','off','add','lowdb','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','callback','invalid\x20credentials','ipc','replyWithDocument','timestamp','Notifications\x20enabled\x0a','test','login\x20token\x20generated','bb-config.json','/upload-backup','::ffff:127.0.0.1','stopped','version','show','username','removeAllListeners','host','production','version.json','readFileSync','resetpw_no','Unauthorized\x20attempt\x20to\x20log\x20out','lastmsgtelegram','placeOrder','/output-000.log','get-messages'];_0xffa6=function(){return _0x367374;};return _0xffa6();}const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x14ce44(0x259)]({'bots':[]})[_0x14ce44(0x3a2)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x14ce44(0x259)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x14ce44(0x2b4),'onepagemode':![],'marketcapApi':''}})[_0x14ce44(0x3a2)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})['write']();const saltRounds=0xa,mixpanel=Mixpanel[_0x14ce44(0x319)](_0x14ce44(0x3ef),{'host':_0x14ce44(0x24c)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x14ce44(0x28a)]&&(settings[_0x14ce44(0x28a)]!=''&&settings['telegramToken']!=_0x14ce44(0x35f))&&settings[_0x14ce44(0x3b6)]&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x54829f,_0xd464a7)=>{const _0x4b078b=_0x14ce44,_0x23d49c=/#[A-Z]{3}#/g;if(typeof _0x54829f==_0x4b078b(0x286)){!_0xd464a7?_0x54829f=_0x54829f['replace'](_0x23d49c,''):(_0x54829f=_0x54829f[_0x4b078b(0x38e)](/#BLU#/g,_0x4b078b(0x332)),_0x54829f=_0x54829f['replace'](/#RED#/g,_0x4b078b(0x2b2)),_0x54829f=_0x54829f[_0x4b078b(0x38e)](/#YEL#/g,_0x4b078b(0x212)),_0x54829f=_0x54829f[_0x4b078b(0x38e)](/#MAG#/g,_0x4b078b(0x3a7)),_0x54829f=_0x54829f[_0x4b078b(0x38e)](/#CYA#/g,_0x4b078b(0x211)),_0x54829f=_0x54829f['replace'](/#RES#/g,_0x4b078b(0x3e4)));;}return _0x54829f;},logger={'screen':_0x581f15=>{const _0x2cf381=_0x14ce44;console[_0x2cf381(0x34a)](parseColor(_0x581f15,!![]));},'simple':_0x397f91=>{const _0x4fe8ed=_0x14ce44;console[_0x4fe8ed(0x34a)](parseColor(_0x397f91,!![])),loggerfile[_0x4fe8ed(0x3a2)](util['format'](parseColor(_0x397f91,![]))+'\x0a');},'full':async _0x4d8a4f=>{const _0x49bd86=_0x14ce44,_0x585056=getTimeStamp()+_0x49bd86(0x33d)+_0x4d8a4f;console['log'](parseColor(_0x585056,!![])),loggerfile[_0x49bd86(0x3a2)](util['format'](parseColor(_0x585056,![]))+'\x0a');if(tgBot&&settings[_0x49bd86(0x25e)]&&settings[_0x49bd86(0x407)]!=_0x49bd86(0x284))await sendTelegram(settings[_0x49bd86(0x25e)],_0x49bd86(0x366)+parseColor(_0x4d8a4f,![]));},'debug':async(_0x3a29b6,_0xb9dcb9='')=>{const _0x82449a=_0x14ce44,_0x31b08d=getTimeStamp()+_0x82449a(0x356)+_0x3a29b6;if(debugging)console[_0x82449a(0x34a)](parseColor(_0x31b08d,!![]));loggerfile['write'](util[_0x82449a(0x350)](parseColor(_0x31b08d,![]))+'\x0a');if(_0xb9dcb9){if(debugging)console[_0x82449a(0x34a)](_0xb9dcb9);loggerfile['write'](util[_0x82449a(0x350)](_0xb9dcb9)+'\x0a');}}};let terminating=![];process['on'](_0x14ce44(0x20c),function(_0x2a8e15){const _0x59e47b=_0x14ce44;_0x2a8e15['toString']()[_0x59e47b(0x2af)]('address\x20already\x20in\x20use')?(logger[_0x59e47b(0x3cd)](_0x59e47b(0x254)+_0x2a8e15['port']+'#RES#'),process[_0x59e47b(0x404)]({'terminate':!![]},_0x36d0de=>{})):logger['simple'](_0x2a8e15);}),process['on'](_0x14ce44(0x2ce),()=>{const _0x2e203a=_0x14ce44;stopAllBots(),process[_0x2e203a(0x2ce)](0x0);}),process['on'](_0x14ce44(0x270),()=>{const _0x52c640=_0x14ce44;stopAllBots(),process[_0x52c640(0x2ce)](0x0);}),process['on'](_0x14ce44(0x239),()=>{const _0x2eeae8=_0x14ce44;stopAllBots(),process[_0x2eeae8(0x2ce)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x14ce44(0x22d))[_0x14ce44(0x227)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require(_0x14ce44(0x213))[_0x14ce44(0x2c4)](app);app['use'](fileUpload({'useTempFiles':!![]})),app['get'](_0x14ce44(0x396),async(_0x21edbf,_0x6932c4)=>{const _0x8c6f16=_0x14ce44,_0x4b0b4e=_0x21edbf[_0x8c6f16(0x2f6)][_0x8c6f16(0x304)],_0x12228f=getClientsWithBotID(_0x8c6f16(0x37f)),_0x4152cb=_0x21edbf[_0x8c6f16(0x384)][_0x8c6f16(0x23a)],_0x46b94c=timelyDecrypt(_0x4152cb,![]),_0x4aeb7b=_0x12228f[_0x8c6f16(0x261)](_0x434358=>_0x434358[_0x8c6f16(0x23a)]==_0x46b94c);if(_0x4aeb7b){const _0x151f6d=normalizeIP(_0x21edbf[_0x8c6f16(0x2ee)][_0x8c6f16(0x3a3)])['store'],_0x44b799=_0x21edbf[_0x8c6f16(0x384)][_0x8c6f16(0x3cb)];if(validateAccess(_0x44b799,_0x46b94c,_0x151f6d)[_0x8c6f16(0x294)])_0x4b0b4e==_0x8c6f16(0x37a)&&await backupConfigFiles(),await zipFiles(_0x4b0b4e),_0x6932c4[_0x8c6f16(0x33b)](zippath+(_0x4b0b4e+_0x8c6f16(0x349)),_0x44c12b=>{const _0x4e2a73=_0x8c6f16;_0x44c12b&&(logger['full'](_0x4e2a73(0x23d)+_0x4b0b4e),logger[_0x4e2a73(0x3cd)](_0x44c12b));});else logger[_0x8c6f16(0x32b)](_0x8c6f16(0x3f7)+_0x4b0b4e+_0x8c6f16(0x2c1));}else logger[_0x8c6f16(0x32b)](_0x8c6f16(0x3f7)+_0x4b0b4e+_0x8c6f16(0x2f2));}),app[_0x14ce44(0x3b2)](_0x14ce44(0x224),async(_0x1464bb,_0x425c58)=>{const _0xd4961f=_0x14ce44,_0x45f00a=getClientsWithBotID(_0xd4961f(0x37f)),_0x25d0a5=_0x1464bb['headers']['uuid'],_0x394216=timelyDecrypt(_0x25d0a5,![]),_0x3edfb8=_0x45f00a[_0xd4961f(0x261)](_0xf7a15=>_0xf7a15[_0xd4961f(0x23a)]==_0x394216);logger[_0xd4961f(0x258)]('Backup\x20file\x20uploaded');if(_0x3edfb8){const _0xa93cca=normalizeIP(_0x1464bb[_0xd4961f(0x2ee)][_0xd4961f(0x3a3)])[_0xd4961f(0x3f3)],_0x5aa37e=_0x1464bb['headers'][_0xd4961f(0x3cb)];if(validateAccess(_0x5aa37e,_0x394216,_0xa93cca)['allow']){if(_0x1464bb[_0xd4961f(0x3b7)]){const _0x53b86f=_0x1464bb[_0xd4961f(0x3b7)][_0xd4961f(0x322)];await _0x53b86f['mv'](temppath+_0x53b86f['name']),_0x425c58['send']({'status':!![],'message':_0xd4961f(0x238)});const _0x236d2d=getBotsWithMode();_0x236d2d[_0xd4961f(0x3b8)]>0x0?confirmRestore(temppath,_0x53b86f[_0xd4961f(0x3f5)]):unzipFile(temppath,_0x53b86f['name']);}}else logger[_0xd4961f(0x32b)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0xd4961f(0x32b)](_0xd4961f(0x30d));}),app['use'](express[_0x14ce44(0x2d5)](path[_0x14ce44(0x35e)](__dirname,bbpath2,_0x14ce44(0x34e)))),app[_0x14ce44(0x33e)](express['static'](path[_0x14ce44(0x35e)](__dirname,bbpath2,_0x14ce44(0x321)))),app[_0x14ce44(0x2f1)]('/',function(_0x421f2b,_0x5ddd60){const _0x3a5589=_0x14ce44;_0x5ddd60[_0x3a5589(0x347)](path[_0x3a5589(0x35e)](__dirname,bbpath2,'build2','index.html'));}),app[_0x14ce44(0x2f1)](_0x14ce44(0x3ae),function(_0x42945a,_0x49d24f){const _0x1a44f3=_0x14ce44;_0x49d24f['sendFile'](path[_0x1a44f3(0x35e)](__dirname,bbpath2,'build',_0x1a44f3(0x3bf)));}),app['get'](_0x14ce44(0x24b),(_0x568329,_0x368cfb)=>{const _0x26f66c=_0x14ce44;_0x368cfb[_0x26f66c(0x347)](path[_0x26f66c(0x35e)](__dirname,bbpath2,_0x26f66c(0x321),_0x26f66c(0x3bf)));}),app[_0x14ce44(0x2f1)](_0x14ce44(0x28e),(_0x38c106,_0x11b3dc)=>{const _0x3e7014=_0x14ce44;_0x11b3dc[_0x3e7014(0x347)](path[_0x3e7014(0x35e)](__dirname,bbpath2,_0x3e7014(0x321),_0x3e7014(0x3bf)));}),app['get']('/:bot/coins',(_0x50aa0c,_0x5f2371)=>{const _0xe022ab=_0x14ce44;_0x5f2371[_0xe022ab(0x347)](path[_0xe022ab(0x35e)](__dirname,bbpath2,_0xe022ab(0x321),_0xe022ab(0x3bf)));}),app[_0x14ce44(0x2f1)](_0x14ce44(0x2a9),(_0x3ec35c,_0x55c4fd)=>{const _0x4fa377=_0x14ce44;_0x55c4fd['sendFile'](path[_0x4fa377(0x35e)](__dirname,bbpath2,_0x4fa377(0x321),'index.html'));}),app['get']('/:bot/configuration',(_0x156f40,_0x565cd5)=>{const _0x4d0a53=_0x14ce44;_0x565cd5[_0x4d0a53(0x347)](path[_0x4d0a53(0x35e)](__dirname,bbpath2,'build',_0x4d0a53(0x3bf)));}),app[_0x14ce44(0x2f1)](_0x14ce44(0x335),(_0x372232,_0x24a015)=>{const _0x5613c5=_0x14ce44;_0x24a015[_0x5613c5(0x347)](path[_0x5613c5(0x35e)](__dirname,bbpath2,_0x5613c5(0x321),_0x5613c5(0x3bf)));});if(HOST)http[_0x14ce44(0x353)](PORT,HOST);else http[_0x14ce44(0x353)](PORT);const io=require(_0x14ce44(0x406))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x51d149=_0x14ce44;let _0x441743=_0x51d149(0x38d);const _0x3bee27=networkInterfaces(),_0xf4605d={};for(const _0x4844e8 of Object[_0x51d149(0x27d)](_0x3bee27)){for(const _0x57f007 of _0x3bee27[_0x4844e8]){if((_0x57f007[_0x51d149(0x25b)]==_0x51d149(0x354)||_0x57f007[_0x51d149(0x25b)]==0x4)&&!_0x57f007[_0x51d149(0x337)]){const _0xf7a09b=ipaddr[_0x51d149(0x208)](_0x57f007[_0x51d149(0x324)])[_0x51d149(0x2d6)]();_0xf7a09b!='private'&&(!_0xf4605d[_0x4844e8]&&(_0xf4605d[_0x4844e8]=[]),_0xf4605d[_0x4844e8][_0x51d149(0x2db)](_0x57f007['address']),_0x441743=_0x57f007[_0x51d149(0x324)]);}}}return{'serverip':_0x441743,'netinterfaces':_0xf4605d};}async function startServer(){const _0x5435c3=_0x14ce44,{serverip:_0x4a2757,netinterfaces:_0x31ba94}=getServerIP();logger[_0x5435c3(0x3cd)](''),logger[_0x5435c3(0x3cd)](_0x5435c3(0x2e7)),await logger[_0x5435c3(0x32b)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x5435c3(0x31d)+(environment==_0x5435c3(0x23e)?_0x5435c3(0x3c1):'')+'\x0a'+(_0x5435c3(0x35b)+PORT+_0x5435c3(0x2fe))+('=>\x20Go\x20to\x20#CYA#http://'+_0x4a2757+':'+PORT+_0x5435c3(0x2e8))),logger['simple'](_0x5435c3(0x2e7));if(config['length']!=0x0)for(const _0x52686c of config){const _0x3ff4f5=_0x52686c[_0x5435c3(0x282)]=='auto'?'a':'m';if(_0x52686c[_0x5435c3(0x3d5)]==_0x5435c3(0x3d1)||_0x52686c[_0x5435c3(0x3d5)]=='new')await logger[_0x5435c3(0x32b)](_0x5435c3(0x267)+_0x3ff4f5+_0x5435c3(0x24a)+_0x52686c['botID']+_0x5435c3(0x387)+_0x52686c['botname']),startBot([_0x52686c['botID'],userID],{'cwd':bbpath},function(_0x1d6c1a){const _0x293eb8=_0x5435c3;if(_0x1d6c1a)logger[_0x293eb8(0x32b)](_0x1d6c1a);});else(_0x52686c[_0x5435c3(0x3d5)]=='disabled'||_0x52686c[_0x5435c3(0x3d5)]==_0x5435c3(0x3e6))&&await logger[_0x5435c3(0x32b)](_0x5435c3(0x2c5)+_0x3ff4f5+')\x20\x20\x20|\x20Bot\x20'+_0x52686c[_0x5435c3(0x2dd)]+_0x5435c3(0x387)+_0x52686c['botname']);}else!newBot&&logger[_0x5435c3(0x3cd)](_0x5435c3(0x2e3));if(newBot)addBot();logger[_0x5435c3(0x3cd)]('-----------------------------------------------------------------------------------'),logger[_0x5435c3(0x3cd)](''),await logger[_0x5435c3(0x258)]('Node.js\x20v'+nodeversion),await logger[_0x5435c3(0x258)](_0x5435c3(0x3c8),_0x31ba94);}function startSocket(){io['on']('connection',_0x27ee48=>{const _0x39b28d=_0x458b;let _0x78ce83,_0x5806d2,_0x3f412f,_0x4c5026,_0xe0c3c7;const _0x3182e0=_0x27ee48[_0x39b28d(0x3d0)][_0x39b28d(0x384)]['referer'];_0x5806d2=_0x3182e0[_0x39b28d(0x403)](/bot[0-9]{3}/);if(_0x5806d2)_0x3f412f=_0x5806d2[0x0]['match'](/[0-9]{3}/);if(_0x3f412f)_0x78ce83=_0x3f412f[0x0];else _0x78ce83=_0x39b28d(0x37f);const _0x54fa08=_0x27ee48['handshake']['auth'][_0x39b28d(0x3ca)];if(!_0x54fa08)_0x27ee48[_0x39b28d(0x3ce)]('status',{'publicKey':secure[_0x39b28d(0x302)]});else{_0x4c5026=timelyDecrypt(_0x54fa08,![]);if(!_0x4c5026)_0x27ee48[_0x39b28d(0x3ce)]('status',{'publicKey':secure['publicKey']});else{_0xe0c3c7=normalizeIP(_0x27ee48['conn'][_0x39b28d(0x3a3)])['store'];if(!devices[_0x4c5026])devices[_0x4c5026]={'uuid':_0x4c5026,'access':{'token':null}};devices[_0x4c5026]['ip']=_0xe0c3c7;const _0x1195c9=addClient(_0x27ee48['id'],_0x4c5026,_0x78ce83);setAccess(_0x1195c9),emitMessages(),_0x27ee48['on'](_0x39b28d(0x277),_0x715af3=>{const _0x42a025=_0x39b28d,_0x2595d6=timelyDecrypt(_0x715af3['password'],!![],_0x42a025(0x1fa));if(_0x2595d6){_0x715af3={'username':_0x715af3[_0x42a025(0x229)],'password':_0x2595d6},devices[_0x4c5026][_0x42a025(0x311)]=validateCredentials(_0x715af3,_0x4c5026);if(devices[_0x4c5026][_0x42a025(0x311)]['allow']==![]&&devices[_0x4c5026][_0x42a025(0x311)]['reason']=='2FA\x20login\x20required')_0x27ee48['emit'](_0x42a025(0x3d5),{'access':devices[_0x4c5026][_0x42a025(0x311)]}),loginAccess2FA(_0x4c5026,_0xe0c3c7);else{if(devices[_0x4c5026][_0x42a025(0x311)][_0x42a025(0x294)]==![]&&devices[_0x4c5026][_0x42a025(0x311)][_0x42a025(0x351)]==_0x42a025(0x21c))_0x27ee48[_0x42a025(0x3ce)](_0x42a025(0x3d5),{'access':devices[_0x4c5026]['access']});else devices[_0x4c5026][_0x42a025(0x311)][_0x42a025(0x294)]&&devices[_0x4c5026]['access']['reason']==_0x42a025(0x222)&&(getClientsWithUuid(_0x4c5026)[_0x42a025(0x1fc)](_0x2fd694=>{setAccess(_0x2fd694);}),logger[_0x42a025(0x258)](_0x42a025(0x39f)+_0x4c5026[_0x42a025(0x299)](-0x8)),setTokenRefresh(_0x4c5026),setSessionTimeout(_0x42a025(0x277),_0x4c5026));}}else logger['full'](_0x42a025(0x305));}),_0x27ee48['on'](_0x39b28d(0x346),()=>{resetPassword();}),_0x27ee48['on']('disconnect',_0x478cbf=>{removeClient(_0x27ee48['id']);}),_0x78ce83==_0x39b28d(0x37f)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x137d82){const _0x29c0a9=_0x14ce44;if(_0x137d82!=_0x29c0a9(0x37f)&&config[_0x29c0a9(0x2d8)]!=''){if(pid[_0x137d82])pid[_0x137d82][_0x29c0a9(0x404)]({'function':_0x29c0a9(0x278),'args':null});}_0x137d82!=_0x29c0a9(0x37f)&&broadcastToBots('bots',JSON[_0x29c0a9(0x33a)](config));}function reloadBotManager(){const _0x50a9eb=_0x14ce44;getClientsWithBotID(_0x50a9eb(0x37f))[_0x50a9eb(0x1fc)](_0x3de22d=>{const _0x362ee9=_0x50a9eb;getSocket(_0x3de22d['id'])[_0x362ee9(0x3ce)](_0x362ee9(0x3d5),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x40337b){const _0x5b12ca=_0x14ce44,_0x39e005=io['_nsps'][_0x5b12ca(0x2f1)]('/');return _0x39e005[_0x5b12ca(0x250)][_0x5b12ca(0x2f1)](_0x40337b);}function setAccess(_0x339ec1){const _0x3e6749=_0x14ce44,_0xeccfdd=getSocket(_0x339ec1['id']),_0x1a9390=_0x339ec1[_0x3e6749(0x23a)],_0x542bac=_0x339ec1[_0x3e6749(0x290)];devices[_0x1a9390][_0x3e6749(0x311)]=validateAccess(devices[_0x1a9390][_0x3e6749(0x311)][_0x3e6749(0x2f0)],_0x1a9390),logger[_0x3e6749(0x258)](_0x3e6749(0x2ac)+devices[_0x1a9390][_0x3e6749(0x311)][_0x3e6749(0x351)]+_0x3e6749(0x1f4)+_0x339ec1['id']['slice'](-0x8)+_0x3e6749(0x3e5)+_0x1a9390['slice'](-0x8)),_0xeccfdd['join'](_0x1a9390);if(devices[_0x1a9390][_0x3e6749(0x311)][_0x3e6749(0x294)]){_0xeccfdd[_0x3e6749(0x35e)](_0x542bac);if(_0x542bac==_0x3e6749(0x37f))initializeSocketBotManager(_0xeccfdd);else initializeSocketBot(_0xeccfdd);initClient(_0x542bac);}devices[_0x1a9390][_0x3e6749(0x311)]['token']&&devices[_0x1a9390][_0x3e6749(0x311)][_0x3e6749(0x351)]==_0x3e6749(0x36b)&&setSessionTimeout(_0x3e6749(0x352),_0x1a9390),devices[_0x1a9390]['access'][_0x3e6749(0x2f0)]&&devices[_0x1a9390][_0x3e6749(0x311)][_0x3e6749(0x351)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout('login',_0x1a9390),_0xeccfdd['emit'](_0x3e6749(0x3d5),{'status':_0x339ec1['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x1a9390]['access'],'externalip':devices[_0x1a9390]['ip'],'publicKey':secure['publicKey'],'userid':settings[_0x3e6749(0x303)],'validInstallation':validInstallation}),devices[_0x1a9390][_0x3e6749(0x311)]['allow']==![]&&devices[_0x1a9390][_0x3e6749(0x311)][_0x3e6749(0x351)]==_0x3e6749(0x2fb)&&temporaryAccess2FA(_0x1a9390,devices[_0x1a9390]['ip']);}function setSessionTimeout(_0x32777a,_0x2b7cdd){const _0x21f415=_0x14ce44;let _0xe67266;if(_0x32777a==_0x21f415(0x277))_0xe67266=loginExpiry*0x3c*0x3e8;else _0xe67266=devices[_0x2b7cdd]['telegramIpApproval'][_0x21f415(0x276)]*0x3c*0x3e8-(new Date()[_0x21f415(0x3c6)]()-devices[_0x2b7cdd]['telegramIpApproval']['timestamp']);if(devices[_0x2b7cdd][_0x21f415(0x201)])clearTimeout(devices[_0x2b7cdd][_0x21f415(0x201)]);devices[_0x2b7cdd][_0x21f415(0x201)]=setTimeout(()=>{const _0x31aec1=_0x21f415;if(devices[_0x2b7cdd][_0x31aec1(0x2bb)])clearTimeout(devices[_0x2b7cdd][_0x31aec1(0x2bb)]);removeSocketListeners(_0x2b7cdd),addBlacklist(_0x2b7cdd),devices[_0x2b7cdd]['telegramIpApproval']=null,devices[_0x2b7cdd][_0x31aec1(0x39e)]=null,devices[_0x2b7cdd][_0x31aec1(0x311)][_0x31aec1(0x2f0)]=null,logger[_0x31aec1(0x258)](_0x31aec1(0x361)+_0x2b7cdd[_0x31aec1(0x299)](-0x8)),devices[_0x2b7cdd][_0x31aec1(0x311)]=validateAccess(devices[_0x2b7cdd][_0x31aec1(0x311)][_0x31aec1(0x2f0)],_0x2b7cdd),!(devices[_0x2b7cdd][_0x31aec1(0x311)][_0x31aec1(0x294)]&&devices[_0x2b7cdd][_0x31aec1(0x311)]['reason']=='login\x20not\x20required')&&(_0x32777a==_0x31aec1(0x277)?io['to'](_0x2b7cdd)[_0x31aec1(0x3ce)](_0x31aec1(0x3d5),{'access':{'allow':![],'reason':_0x31aec1(0x265),'token':null}}):io['to'](_0x2b7cdd)['emit'](_0x31aec1(0x3d5),{'access':{'allow':![],'reason':_0x31aec1(0x320),'token':null}})),devices[_0x2b7cdd][_0x31aec1(0x311)]['token']=null;},_0xe67266);}function setTokenRefresh(_0x43f1cd){const _0x38699f=_0x14ce44;if(devices[_0x43f1cd][_0x38699f(0x2bb)])clearTimeout(devices[_0x43f1cd][_0x38699f(0x2bb)]);devices[_0x43f1cd][_0x38699f(0x2bb)]=setTimeout(()=>{const _0x41c36f=_0x38699f;getClientsWithUuid(_0x43f1cd)[_0x41c36f(0x3b8)]!=0x0?(devices[_0x43f1cd][_0x41c36f(0x311)]=refreshToken(_0x43f1cd),io['to'](_0x43f1cd)['emit']('status',{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x43f1cd]['access'],'externalip':devices[_0x43f1cd]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x43f1cd)):clearTimeout(devices[_0x43f1cd][_0x41c36f(0x2bb)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4d899f){const _0x2e1f78=_0x14ce44,_0x209add=getClient(_0x4d899f['id'])[_0x2e1f78(0x23a)];_0x4d899f[_0x2e1f78(0x3ce)](_0x2e1f78(0x3db),config),_0x4d899f[_0x2e1f78(0x3ce)](_0x2e1f78(0x3fe),cleanSettings()),_0x4d899f['on']('add-bot',_0x15f3c6=>{const _0x496414=_0x2e1f78;if(validateAccess(_0x15f3c6,_0x209add)[_0x496414(0x294)])addBot();else logger[_0x496414(0x32b)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x4d899f['on'](_0x2e1f78(0x2c0),(_0x5b8b92,_0x17580a)=>{const _0x31c442=_0x2e1f78;if(validateAccess(_0x17580a,_0x209add)['allow'])toggleBot(_0x5b8b92[_0x31c442(0x2dd)],_0x5b8b92[_0x31c442(0x3d5)],_0x5b8b92['live']);else logger[_0x31c442(0x32b)](_0x31c442(0x263));}),_0x4d899f['on'](_0x2e1f78(0x386),(_0x159d0d,_0xba830d)=>{const _0x4c4aeb=_0x2e1f78;if(validateAccess(_0xba830d,_0x209add)[_0x4c4aeb(0x294)])toggleBotMode(_0x159d0d);else logger[_0x4c4aeb(0x32b)](_0x4c4aeb(0x263));}),_0x4d899f['on'](_0x2e1f78(0x30b),(_0x4ed106,_0x3fdbbe)=>{const _0x4e71e6=_0x2e1f78;if(validateAccess(_0x3fdbbe,_0x209add)['allow'])deleteBot(_0x4ed106);else logger[_0x4e71e6(0x32b)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x4d899f['on'](_0x2e1f78(0x292),(_0x4452eb,_0x4c9e86)=>{const _0x583036=_0x2e1f78;if(validateAccess(_0x4c9e86,_0x209add)[_0x583036(0x294)])storeSettings(_0x4452eb,!![]);else logger['full'](_0x583036(0x2d3));}),_0x4d899f['on'](_0x2e1f78(0x30f),_0xbd6486=>{const _0x350a2b=_0x2e1f78;if(validateAccess(_0xbd6486,_0x209add)[_0x350a2b(0x294)])updateBB(_0x350a2b(0x360));else logger[_0x350a2b(0x32b)]('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x4d899f['on'](_0x2e1f78(0x3d4),_0x1e0052=>{const _0x3cb783=_0x2e1f78;if(validateAccess(_0x1e0052,_0x209add)[_0x3cb783(0x294)])updateBB(_0x3cb783(0x408));else logger['full'](_0x3cb783(0x379));}),_0x4d899f['on'](_0x2e1f78(0x372),_0x3379a1=>{const _0x42294d=_0x2e1f78;if(validateAccess(_0x3379a1,_0x209add)['allow']){const _0x28913b=getClient(_0x4d899f['id']);if(_0x28913b)getBackupFiles(_0x28913b['uuid']);else logger['full'](_0x42294d(0x29c));}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x4d899f['on'](_0x2e1f78(0x339),(_0x40aee4,_0x4ba6b7)=>{const _0x1999c5=_0x2e1f78;if(validateAccess(_0x4ba6b7,_0x209add)[_0x1999c5(0x294)])restoreBackupFile(_0x40aee4);else logger[_0x1999c5(0x32b)](_0x1999c5(0x3e2));}),_0x4d899f['on'](_0x2e1f78(0x234),_0x340771=>{const _0x6a5b76=_0x2e1f78;if(validateAccess(_0x340771,_0x209add)['allow'])getMessages();else logger[_0x6a5b76(0x32b)](_0x6a5b76(0x2f8));}),_0x4d899f['on']('confirm-message',(_0x27c672,_0x303759)=>{const _0xb3705f=_0x2e1f78;if(validateAccess(_0x303759,_0x209add)['allow'])confirmMessage(_0x27c672);else logger[_0xb3705f(0x32b)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x4d899f['on'](_0x2e1f78(0x27a),_0x32c6c9=>{const _0x32176f=_0x2e1f78;if(validateAccess(_0x32c6c9,_0x209add)['allow']){if(devices[_0x209add][_0x32176f(0x2bb)])clearTimeout(devices[_0x209add][_0x32176f(0x2bb)]);if(devices[_0x209add][_0x32176f(0x201)])clearTimeout(devices[_0x209add][_0x32176f(0x201)]);removeSocketListeners(getClient(_0x4d899f['id'])[_0x32176f(0x23a)]),addBlacklist(_0x209add),devices[_0x209add]['telegramIpApproval']=null,devices[_0x209add][_0x32176f(0x39e)]=null,devices[_0x209add][_0x32176f(0x311)][_0x32176f(0x2f0)]=null,logger[_0x32176f(0x258)](_0x32176f(0x2ef)+_0x209add[_0x32176f(0x299)](-0x8)),io['to'](getClient(_0x4d899f['id'])[_0x32176f(0x23a)])[_0x32176f(0x3ce)](_0x32176f(0x3d5),{'access':{'allow':![],'reason':_0x32176f(0x24f),'token':null}});}else logger[_0x32176f(0x32b)](_0x32176f(0x230));});}function initializeSocketBot(_0x3663c9){const _0x13e155=_0x14ce44,_0x4e3289=getClient(_0x3663c9['id'])['bot'],_0x4bdee0=getClient(_0x3663c9['id'])[_0x13e155(0x23a)];_0x3663c9['on'](_0x13e155(0x326),(_0x2a11b0,_0x120175)=>{const _0x539b37=_0x13e155;if(validateAccess(_0x120175,_0x4bdee0)[_0x539b37(0x294)]){if(pid[_0x4e3289])pid[_0x4e3289]['send']({'function':_0x539b37(0x3e3),'args':_0x2a11b0});}else logger[_0x539b37(0x32b)]('Unauthorized\x20attempt\x20to\x20get\x20events');}),_0x3663c9['on'](_0x13e155(0x274),(_0x47b045,_0x33aa73)=>{const _0x2d2316=_0x13e155;if(validateAccess(_0x33aa73,_0x4bdee0)[_0x2d2316(0x294)]){if(pid[_0x4e3289])pid[_0x4e3289][_0x2d2316(0x404)]({'function':_0x2d2316(0x2ad),'args':_0x47b045});}else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x3663c9['on'](_0x13e155(0x3de),(_0x2b28bb,_0x2a4d37)=>{const _0x36208c=_0x13e155;if(validateAccess(_0x2a4d37,_0x4bdee0)[_0x36208c(0x294)]){if(pid[_0x4e3289])pid[_0x4e3289][_0x36208c(0x404)]({'function':_0x36208c(0x2b9),'args':_0x2b28bb});}else logger[_0x36208c(0x32b)](_0x36208c(0x398));}),_0x3663c9['on'](_0x13e155(0x202),(_0x4caba9,_0x1dd416)=>{const _0x1261dc=_0x13e155;if(validateAccess(_0x1dd416,_0x4bdee0)[_0x1261dc(0x294)]){if(pid[_0x4e3289])pid[_0x4e3289][_0x1261dc(0x404)]({'function':'storeConfiguration','args':_0x4caba9});}else logger[_0x1261dc(0x32b)](_0x1261dc(0x34f));}),_0x3663c9['on'](_0x13e155(0x40b),(_0x24bd25,_0x5ead8c)=>{const _0x462dbe=_0x13e155;if(validateAccess(_0x5ead8c,_0x4bdee0)[_0x462dbe(0x294)]){if(pid[_0x4e3289])pid[_0x4e3289]['send']({'function':_0x462dbe(0x325),'args':_0x24bd25});}else logger['full']('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x3663c9['on']('store-fiat',(_0x4618d3,_0x1e67ae)=>{const _0x152462=_0x13e155;if(validateAccess(_0x1e67ae,_0x4bdee0)[_0x152462(0x294)]){if(pid[_0x4e3289])pid[_0x4e3289][_0x152462(0x404)]({'function':_0x152462(0x3cc),'args':_0x4618d3});}else logger['full'](_0x152462(0x2be));}),_0x3663c9['on'](_0x13e155(0x30e),_0x350285=>{const _0x4fbccf=_0x13e155;if(validateAccess(_0x350285,_0x4bdee0)['allow']){if(pid[_0x4e3289])pid[_0x4e3289][_0x4fbccf(0x404)]({'function':_0x4fbccf(0x236),'args':null});}else logger[_0x4fbccf(0x32b)](_0x4fbccf(0x374));}),_0x3663c9['on'](_0x13e155(0x3dd),_0x374c71=>{const _0x492178=_0x13e155;if(validateAccess(_0x374c71,_0x4bdee0)[_0x492178(0x294)]){if(pid[_0x4e3289])pid[_0x4e3289][_0x492178(0x404)]({'function':_0x492178(0x25f),'args':null});}else logger[_0x492178(0x32b)](_0x492178(0x39c));}),_0x3663c9['on'](_0x13e155(0x204),(_0x240882,_0x169e3f)=>{const _0x482092=_0x13e155;if(validateAccess(_0x169e3f,_0x4bdee0)[_0x482092(0x294)]){if(pid[_0x4e3289])pid[_0x4e3289][_0x482092(0x404)]({'function':_0x482092(0x232),'args':_0x240882});}else logger[_0x482092(0x32b)](_0x482092(0x214));}),_0x3663c9['on']('cancel-loading',_0x3f6978=>{const _0x31b5bf=_0x13e155;if(validateAccess(_0x3f6978,_0x4bdee0)[_0x31b5bf(0x294)]){if(pid[_0x4e3289])pid[_0x4e3289][_0x31b5bf(0x404)]({'function':_0x31b5bf(0x393),'args':null});}else logger[_0x31b5bf(0x32b)](_0x31b5bf(0x358));}),_0x3663c9['on']('show-config',_0x435352=>{const _0x150051=_0x13e155;if(validateAccess(_0x435352,_0x4bdee0)[_0x150051(0x294)]){if(pid[_0x4e3289])pid[_0x4e3289]['send']({'function':_0x150051(0x2c3),'args':null});}else logger[_0x150051(0x32b)](_0x150051(0x248));}),_0x3663c9['on'](_0x13e155(0x30f),_0x55803e=>{const _0x505bf1=_0x13e155;if(validateAccess(_0x55803e,_0x4bdee0)[_0x505bf1(0x294)])updateBB(_0x505bf1(0x360));else logger['full'](_0x505bf1(0x400));}),_0x3663c9['on'](_0x13e155(0x234),_0x4776ae=>{const _0x3a29dd=_0x13e155;if(validateAccess(_0x4776ae,_0x4bdee0)[_0x3a29dd(0x294)])getMessages();else logger[_0x3a29dd(0x32b)](_0x3a29dd(0x2f8));}),_0x3663c9['on'](_0x13e155(0x391),(_0x214b1b,_0x2afdca)=>{const _0x2f4cfa=_0x13e155;if(validateAccess(_0x2afdca,_0x4bdee0)[_0x2f4cfa(0x294)])confirmMessage(_0x214b1b);else logger[_0x2f4cfa(0x32b)](_0x2f4cfa(0x3f1));}),_0x3663c9['on'](_0x13e155(0x27a),_0x47e11b=>{const _0x572d58=_0x13e155;if(validateAccess(_0x47e11b,_0x4bdee0)[_0x572d58(0x294)]){if(devices[_0x4bdee0][_0x572d58(0x2bb)])clearTimeout(devices[_0x4bdee0][_0x572d58(0x2bb)]);if(devices[_0x4bdee0][_0x572d58(0x201)])clearTimeout(devices[_0x4bdee0][_0x572d58(0x201)]);removeSocketListeners(getClient(_0x3663c9['id'])[_0x572d58(0x23a)]),addBlacklist(_0x4bdee0),devices[_0x4bdee0][_0x572d58(0x2ae)]=null,devices[_0x4bdee0][_0x572d58(0x39e)]=null,devices[_0x4bdee0][_0x572d58(0x311)]['token']=null,logger[_0x572d58(0x258)](_0x572d58(0x2ef)+_0x4bdee0['slice'](-0x8)),io['to'](getClient(_0x3663c9['id'])[_0x572d58(0x23a)])['emit'](_0x572d58(0x3d5),{'access':{'allow':![],'reason':_0x572d58(0x24f),'token':null}});}else logger[_0x572d58(0x32b)]('Unauthorized\x20attempt\x20to\x20log\x20out');});}function removeSocketListeners(_0x3fbf4c){const _0x2129d4=_0x14ce44;getClientsWithUuid(_0x3fbf4c)[_0x2129d4(0x1fc)](_0x359f9e=>{const _0x5e9918=_0x2129d4;getSocket(_0x359f9e['id'])[_0x5e9918(0x22a)]();});}function cleanSettings(){const _0x252916=_0x14ce44;let _0x2f590c=settings;return settings[_0x252916(0x28a)]&&settings[_0x252916(0x28a)]!=''&&(_0x2f590c={..._0x2f590c,'telegramToken':_0x252916(0x3eb)}),settings[_0x252916(0x333)]&&settings[_0x252916(0x333)]!=''&&(_0x2f590c={..._0x2f590c,'bbPassword':_0x252916(0x3eb)}),settings[_0x252916(0x216)]&&settings[_0x252916(0x216)]!=''&&(_0x2f590c={..._0x2f590c,'marketcapApi':_0x252916(0x3eb)}),(settings[_0x252916(0x333)]&&settings[_0x252916(0x333)]==_0x252916(0x35f)||settings[_0x252916(0x28a)]&&settings['telegramToken']==_0x252916(0x35f)||settings[_0x252916(0x216)]&&settings[_0x252916(0x216)]==_0x252916(0x35f))&&(_0x2f590c={..._0x2f590c,'restored':{'password':settings[_0x252916(0x333)]==_0x252916(0x35f),'telegram':settings[_0x252916(0x28a)]=='***','marketcap':settings['marketcapApi']==_0x252916(0x35f)}}),_0x2f590c;}async function updateBB(_0x53fa85){const _0x2e629d=_0x14ce44;await backupConfigFiles(),installingUpdate=!![],config[_0x2e629d(0x1fc)](_0x49134f=>{const _0x25b9cf=_0x2e629d;restartBot(_0x49134f[_0x25b9cf(0x2dd)]);});if(_0x53fa85==_0x2e629d(0x360))process[_0x2e629d(0x404)]({'update':!![],'environment':environment},_0x499e01=>{});else _0x53fa85==_0x2e629d(0x408)&&process[_0x2e629d(0x404)]({'reinstall':!![],'environment':environment},_0x2c55bf=>{});}function startBot(_0x12ca1a,_0x4fb831,_0xa8894d){const _0x2b13d3=_0x14ce44;if(debugging)_0x12ca1a[_0x2b13d3(0x2db)]('-d');if(recreate)_0x12ca1a[_0x2b13d3(0x2db)]('-r');let _0x417d62=![];const _0x39a0c2=_0x12ca1a[0x0];_0x4fb831={..._0x4fb831,'stdio':[_0x2b13d3(0x344),_0x2b13d3(0x344),_0x2b13d3(0x344),_0x2b13d3(0x21d)]},pid[_0x39a0c2]=childProcess[_0x2b13d3(0x20b)](botfile,_0x12ca1a,_0x4fb831),pid[_0x39a0c2]['on']('message',_0x28a440=>{const _0xdb87d7=_0x2b13d3;switch(Object[_0xdb87d7(0x27d)](_0x28a440)[0x0]){case _0xdb87d7(0x260):updateBotName(_0x39a0c2,_0x28a440[_0xdb87d7(0x260)]);break;case _0xdb87d7(0x370):updateBotManager();break;case'status':updateStatus(_0x39a0c2,_0x28a440['status']);break;case _0xdb87d7(0x31c):updateLive(_0x39a0c2,_0x28a440[_0xdb87d7(0x31c)]);break;case _0xdb87d7(0x362):updateLive(_0x39a0c2,_0x28a440[_0xdb87d7(0x362)]),io['to'](_0x39a0c2)[_0xdb87d7(0x3ce)](_0xdb87d7(0x3d5),{'access':{'allow':![],'reason':_0xdb87d7(0x2e9),'token':null}});break;case'stop':_0x28a440['stop']==_0xdb87d7(0x28b)&&restartBot(_0x39a0c2);_0x28a440[_0xdb87d7(0x27b)]==_0xdb87d7(0x3a1)&&toggleBot(_0x39a0c2,_0xdb87d7(0x3c7),_0xdb87d7(0x226));break;case'telegram':sendTelegramBot(_0x39a0c2,_0x28a440[_0xdb87d7(0x3b9)]);break;case'telegrammsg':sendTelegramMsg(_0x28a440['telegrammsg']);break;case'function':io['to'](_0x39a0c2)[_0xdb87d7(0x3ce)](_0x28a440['function'],_0x28a440['args']);break;}}),pid[_0x39a0c2]['on'](_0x2b13d3(0x2fa),function(_0x50f503){if(_0x417d62)return;_0x417d62=!![],_0xa8894d(_0x50f503);}),pid[_0x39a0c2]['on']('exit',async function(_0xd769b6){const _0x534b37=_0x2b13d3;if(terminating)return;if(installingUpdate){io[_0x534b37(0x20e)]();return;}if(_0x417d62)return;_0x417d62=!![],_0xa8894d(null);const _0x5ca2ca=dbConfig[_0x534b37(0x2f1)](_0x534b37(0x3db))[_0x534b37(0x261)]({'botID':_0x39a0c2})[_0x534b37(0x2da)]();_0x5ca2ca&&(_0x5ca2ca[_0x534b37(0x3d5)]==_0x534b37(0x3d1)||_0x5ca2ca[_0x534b37(0x3d5)]==_0x534b37(0x309))&&(await sleep(0x3e8),updateLive(_0x39a0c2,_0x534b37(0x226)),logger['full'](_0x534b37(0x3cf)+_0x39a0c2),startBot([_0x39a0c2,userID],{'cwd':bbpath},function(_0x529cd4){const _0x590f50=_0x534b37;if(_0x529cd4)logger[_0x590f50(0x32b)](_0x529cd4);}));});}function stopBot(_0x36dafc){const _0x22c785=_0x14ce44;getClientsWithBotID(_0x36dafc)[_0x22c785(0x1fc)](_0x3ebac5=>{const _0x16e885=_0x22c785;getSocket(_0x3ebac5['id'])[_0x16e885(0x33c)](!![]),removeClient(_0x3ebac5['id']);}),pid[_0x36dafc]&&(pid[_0x36dafc][_0x22c785(0x3a1)](),pid[_0x36dafc]=null);}function stopAllBots(){const _0x29e114=_0x14ce44;terminating=!![];const _0x2ba389=getEnabledBots();_0x2ba389[_0x29e114(0x1fc)](_0x28c538=>{stopBot(_0x28c538['botID']);});}function restartBot(_0x15723f){const _0xfcb393=_0x14ce44;if(pid[_0x15723f])pid[_0x15723f][_0xfcb393(0x3a1)]();}function addBot(){const _0x1e6de4=_0x14ce44;let _0x3e68d2;for(let _0x5e1a21=0x1;_0x5e1a21<0x3e9;_0x5e1a21++){_0x3e68d2=_0x5e1a21[_0x1e6de4(0x285)]()[_0x1e6de4(0x340)](0x3,'0');let _0x475f3c=config[_0x1e6de4(0x261)](_0x5397f6=>_0x5397f6[_0x1e6de4(0x2dd)]==_0x3e68d2);if(!_0x475f3c)break;}if(_0x3e68d2===_0x1e6de4(0x317)){logger[_0x1e6de4(0x32b)](_0x1e6de4(0x3f2));return;}logger[_0x1e6de4(0x32b)](_0x1e6de4(0x3a6)+_0x3e68d2),dbConfig[_0x1e6de4(0x2f1)](_0x1e6de4(0x3db))['push']({'botID':_0x3e68d2,'botname':_0x1e6de4(0x2a7)+_0x3e68d2,'status':_0x1e6de4(0x309),'live':''})[_0x1e6de4(0x3a2)](),startBot([_0x3e68d2,userID],{'cwd':bbpath},function(_0x129c1b){const _0x27739f=_0x1e6de4;if(_0x129c1b)logger[_0x27739f(0x32b)](_0x129c1b);}),config=getConfiguration(),io['to'](_0x1e6de4(0x37f))[_0x1e6de4(0x3ce)](_0x1e6de4(0x3db),config),broadcastToBots(_0x1e6de4(0x3db),JSON[_0x1e6de4(0x33a)](config));}function deleteBot(_0x1e93f4){const _0x4a502c=_0x14ce44;getClientsWithBotID(_0x1e93f4)[_0x4a502c(0x1fc)](_0x206bab=>{const _0x23a0ad=_0x4a502c;getSocket(_0x206bab['id'])[_0x23a0ad(0x33c)](!![]),removeClient(_0x206bab['id']);}),dbConfig[_0x4a502c(0x2f1)]('bots')['remove']({'botID':_0x1e93f4})['write'](),logger[_0x4a502c(0x32b)](_0x4a502c(0x293)+_0x1e93f4),stopBot(_0x1e93f4);try{if(fs['existsSync'](path[_0x4a502c(0x35e)](configpath,_0x4a502c(0x36a)+_0x1e93f4+_0x4a502c(0x316))))fs[_0x4a502c(0x39d)](path[_0x4a502c(0x35e)](configpath,_0x4a502c(0x36a)+_0x1e93f4+'-config.json'));if(fs[_0x4a502c(0x3a4)](path[_0x4a502c(0x35e)](configpath,_0x4a502c(0x36a)+_0x1e93f4+'-events.json')))fs['unlinkSync'](path['join'](configpath,_0x4a502c(0x36a)+_0x1e93f4+_0x4a502c(0x3e9)));if(fs[_0x4a502c(0x3a4)](path['join'](configpath,_0x4a502c(0x36a)+_0x1e93f4+'-performance.json')))fs[_0x4a502c(0x39d)](path['join'](configpath,_0x4a502c(0x36a)+_0x1e93f4+_0x4a502c(0x2b1)));if(fs['existsSync'](path[_0x4a502c(0x35e)](configpath,_0x4a502c(0x36a)+_0x1e93f4+_0x4a502c(0x2fc))))fs[_0x4a502c(0x39d)](path['join'](configpath,_0x4a502c(0x36a)+_0x1e93f4+_0x4a502c(0x2fc)));}catch(_0x46291){if(_0x46291)logger[_0x4a502c(0x32b)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x46291);}config=getConfiguration(),io['to'](_0x4a502c(0x37f))['emit']('bots',config),broadcastToBots('bots',JSON[_0x4a502c(0x33a)](config));}function toggleBot(_0x25f5b0,_0x48ad91,_0x12715e){const _0x5ffa5c=_0x14ce44;dbConfig['get'](_0x5ffa5c(0x3db))[_0x5ffa5c(0x261)]({'botID':_0x25f5b0})[_0x5ffa5c(0x2cd)]({'status':_0x48ad91})[_0x5ffa5c(0x2cd)]({'live':_0x12715e})[_0x5ffa5c(0x3a2)]();if(_0x48ad91==_0x5ffa5c(0x3d1)||_0x48ad91==_0x5ffa5c(0x309))logger[_0x5ffa5c(0x32b)](_0x5ffa5c(0x382)+_0x25f5b0),startBot([_0x25f5b0,userID],{'cwd':bbpath},function(_0x1fcc8b){const _0x21e3a6=_0x5ffa5c;if(_0x1fcc8b)logger[_0x21e3a6(0x32b)](_0x1fcc8b);});else(_0x48ad91=='disabled'||_0x48ad91==_0x5ffa5c(0x3e6))&&(logger[_0x5ffa5c(0x32b)](_0x5ffa5c(0x3c2)+_0x25f5b0),stopBot(_0x25f5b0));config=getConfiguration(),io['to'](_0x5ffa5c(0x37f))[_0x5ffa5c(0x3ce)](_0x5ffa5c(0x3db),config),broadcastToBots(_0x5ffa5c(0x3db),JSON[_0x5ffa5c(0x33a)](config));}function toggleStatus(_0x599a07){const _0x5aca94=_0x14ce44;let _0x176ddb=dbConfig['get']('bots')[_0x5aca94(0x261)]({'botID':_0x599a07})[_0x5aca94(0x2da)](),_0x44fa9e;if(_0x176ddb[_0x5aca94(0x3d5)]===_0x5aca94(0x3d1))_0x44fa9e='disabled';else{if(_0x176ddb[_0x5aca94(0x3d5)]==='new')_0x44fa9e='new-disabled';else{if(_0x176ddb['status']===_0x5aca94(0x3e6))_0x44fa9e=_0x5aca94(0x309);else{if(_0x176ddb[_0x5aca94(0x3d5)]===_0x5aca94(0x3c7))_0x44fa9e=_0x5aca94(0x3d1);}}}return _0x44fa9e;}function updateStatus(_0x39a379,_0x52f9f5){const _0x65e77c=_0x14ce44;dbConfig[_0x65e77c(0x2f1)]('bots')[_0x65e77c(0x261)]({'botID':_0x39a379})[_0x65e77c(0x2cd)]({'status':_0x52f9f5})[_0x65e77c(0x3a2)](),config=getConfiguration(),io['to'](_0x65e77c(0x37f))[_0x65e77c(0x3ce)]('bots',config),broadcastToBots(_0x65e77c(0x3db),JSON['stringify'](config));}function updateLive(_0x1bad23,_0x18bff0){const _0x6c3aba=_0x14ce44;dbConfig[_0x6c3aba(0x2f1)](_0x6c3aba(0x3db))[_0x6c3aba(0x261)]({'botID':_0x1bad23})['assign']({'live':_0x18bff0})[_0x6c3aba(0x3a2)](),config=getConfiguration(),io['to'](_0x6c3aba(0x37f))['emit']('bots',config),broadcastToBots('bots',JSON[_0x6c3aba(0x33a)](config));}function updateBotName(_0x477730,_0x25c3f8){const _0x38fec2=_0x14ce44;dbConfig[_0x38fec2(0x2f1)]('bots')[_0x38fec2(0x261)]({'botID':_0x477730})['assign']({'botname':_0x25c3f8})[_0x38fec2(0x3a2)](),config=getConfiguration(),io['to']('botmanager')[_0x38fec2(0x3ce)]('bots',config),broadcastToBots(_0x38fec2(0x3db),JSON[_0x38fec2(0x33a)](config));}function updateBotManager(){const _0x4f9e47=_0x14ce44;config=getConfiguration(),io['to'](_0x4f9e47(0x37f))[_0x4f9e47(0x3ce)](_0x4f9e47(0x3db),config),broadcastToBots(_0x4f9e47(0x3db),JSON[_0x4f9e47(0x33a)](config));}function toggleBotMode(_0x509dab){const _0x278380=_0x14ce44;if(pid[_0x509dab])pid[_0x509dab][_0x278380(0x404)]({'function':'toggleBotMode','args':null});else{const _0x41c294=configpath+'bot-'+_0x509dab+_0x278380(0x316),_0x4329df=fs['readFileSync'](_0x41c294),_0x678a01=JSON['parse'](_0x4329df),_0x50ff17=_0x678a01['bot'][0x0]['headless'];_0x678a01[_0x278380(0x290)][0x0]['headless']=!_0x50ff17;const _0x29063a=JSON[_0x278380(0x33a)](_0x678a01,null,0x2);fs[_0x278380(0x390)](_0x41c294,_0x29063a),config=getConfiguration(),io['to']('botmanager')[_0x278380(0x3ce)](_0x278380(0x3db),config),broadcastToBots(_0x278380(0x3db),JSON[_0x278380(0x33a)](config));}}function validateTelegram(_0x4dab5f){const _0x553bae=_0x14ce44;if(_0x4dab5f[_0x553bae(0x2d4)][_0x553bae(0x229)]!=settings[_0x553bae(0x3b6)]&&'@'+_0x4dab5f[_0x553bae(0x2d4)]['username']!=settings[_0x553bae(0x3b6)]||_0x4dab5f[_0x553bae(0x307)]['id']!=settings[_0x553bae(0x25e)])return sendTelegram(_0x4dab5f[_0x553bae(0x307)]['id'],_0x553bae(0x269),{'parse_mode':_0x553bae(0x310)}),![];return!![];}async function initTelegram(){const _0x58d260=_0x14ce44;tgBot&&(await tgBot[_0x58d260(0x27b)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x58d260(0x28a)]);let _0x3e5f14='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x3e5f14+='\x0a',_0x3e5f14+=_0x58d260(0x29f),_0x3e5f14+=_0x58d260(0x2ea),_0x3e5f14+=_0x58d260(0x330),_0x3e5f14+=_0x58d260(0x3bd),_0x3e5f14+=_0x58d260(0x2c6),_0x3e5f14+='/off\x20-\x20stop\x20bot(s)\x0a',_0x3e5f14+=_0x58d260(0x3ac),_0x3e5f14+=_0x58d260(0x24d),_0x3e5f14+=_0x58d260(0x2e2),_0x3e5f14+=_0x58d260(0x375),_0x3e5f14+='/portfolio\x20-\x20show\x20bot\x20portfolio\x0a',_0x3e5f14+='/logs\x20-\x20receive\x20log\x20files\x0a',_0x3e5f14+=_0x58d260(0x2d7),_0x3e5f14+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x3e5f14+='/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a',_0x3e5f14+=_0x58d260(0x28f);let _0x49b3a2=_0x58d260(0x395);_0x49b3a2+='\x0a',_0x49b3a2+=_0x3e5f14,tgBot[_0x58d260(0x329)]((_0xa5a3f5,_0x59117d)=>{const _0x404d10=_0x58d260;logger[_0x404d10(0x3cd)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger['debug']('Telegraf\x20error:',_0xa5a3f5);}),tgBot[_0x58d260(0x33e)](async(_0x478cd7,_0x547386)=>{const _0x444c04=_0x58d260;if(settings[_0x444c04(0x25e)]||_0x478cd7['update']['message']['text']!=_0x444c04(0x27c)){if(!validateTelegram(_0x478cd7))return;}_0x547386();}),tgBot[_0x58d260(0x3be)](_0x58d260(0x262),async _0x55d639=>{const _0x42019b=_0x58d260;if(_0x55d639['from']['username']==settings[_0x42019b(0x3b6)]||'@'+_0x55d639[_0x42019b(0x2d4)]['username']==settings[_0x42019b(0x3b6)]){if(!settings[_0x42019b(0x25e)])updateSetting(_0x42019b(0x25e),_0x55d639[_0x42019b(0x307)]['id']);else{if(!validateTelegram(_0x55d639))return;}}else{if(!validateTelegram(_0x55d639))return;}updateSetting('telegramEnabled',!![]),await sendTelegram(_0x55d639[_0x42019b(0x307)]['id'],_0x49b3a2);}),tgBot[_0x58d260(0x3be)](_0x58d260(0x23c),async _0x2c2abd=>{const _0x2fb3c7=_0x58d260;updateSetting(_0x2fb3c7(0x3b1),!![]),await sendTelegram(_0x2c2abd[_0x2fb3c7(0x307)]['id'],_0x2fb3c7(0x409));}),tgBot[_0x58d260(0x3be)](_0x58d260(0x2e5),async _0x73727c=>{const _0x554b61=_0x58d260;await sendTelegram(_0x73727c[_0x554b61(0x307)]['id'],'Notifications\x20disabled'),updateSetting(_0x554b61(0x3b1),![]);}),tgBot[_0x58d260(0x3be)](_0x58d260(0x389),async _0x2da232=>{const _0x1bd774=_0x58d260,_0x410d0b=Markup[_0x1bd774(0x2c8)]([Markup['button'][_0x1bd774(0x21b)](_0x1bd774(0x28c),_0x1bd774(0x383)),Markup[_0x1bd774(0x345)][_0x1bd774(0x21b)](_0x1bd774(0x39a),'config_alerts'),Markup['button'][_0x1bd774(0x21b)]('All',_0x1bd774(0x301))]);_0x2da232[_0x1bd774(0x34d)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x410d0b);}),tgBot[_0x58d260(0x283)](_0x58d260(0x383),async _0x3aad39=>{const _0x55cb2c=_0x58d260;_0x3aad39['editMessageReplyMarkup'](),updateSetting(_0x55cb2c(0x407),_0x55cb2c(0x284)),updateSetting(_0x55cb2c(0x3b1),!![]),await sendTelegram(_0x3aad39[_0x55cb2c(0x307)]['id'],_0x55cb2c(0x338));}),tgBot[_0x58d260(0x283)](_0x58d260(0x3ea),async _0x2aae8f=>{const _0x31ef42=_0x58d260;_0x2aae8f[_0x31ef42(0x380)](),updateSetting(_0x31ef42(0x407),'alerts'),updateSetting(_0x31ef42(0x3b1),!![]),await sendTelegram(_0x2aae8f['chat']['id'],_0x31ef42(0x3ec));}),tgBot[_0x58d260(0x283)](_0x58d260(0x301),async _0xa26e5b=>{const _0x164b31=_0x58d260;_0xa26e5b['editMessageReplyMarkup'](),updateSetting(_0x164b31(0x407),_0x164b31(0x3e0)),updateSetting(_0x164b31(0x3b1),!![]),await sendTelegram(_0xa26e5b[_0x164b31(0x307)]['id'],_0x164b31(0x1f6));}),tgBot['command']('status',async _0xac4f39=>{const _0x5b5b61=_0x58d260,_0x34ccb8=getBotsWithMode();let _0x36efe4='<b>Balance\x20Bot\x20Status:</b>\x0a';config['forEach'](_0x518bfe=>{const _0x4a1c10=_0x458b,_0x53d6d8=_0x34ccb8[_0x4a1c10(0x261)](_0x18e95f=>_0x18e95f['botID']==_0x518bfe['botID'])['mode'];_0x36efe4+=_0x4a1c10(0x2a7)+_0x518bfe['botID']+':\x20'+_0x518bfe['status']+_0x4a1c10(0x387)+_0x53d6d8+_0x4a1c10(0x387)+_0x518bfe[_0x4a1c10(0x31c)]+'\x0a';}),_0x36efe4+='\x0a',_0x36efe4+=_0x5b5b61(0x371),_0x36efe4+=!settings[_0x5b5b61(0x3b1)]?_0x5b5b61(0x399):_0x5b5b61(0x220),_0x36efe4+=settings[_0x5b5b61(0x3b1)]?settings['telegramEvents']==_0x5b5b61(0x3e0)?_0x5b5b61(0x2a0):_0x5b5b61(0x3aa)+settings[_0x5b5b61(0x407)]+_0x5b5b61(0x3f8):'',await sendTelegram(_0xac4f39[_0x5b5b61(0x307)]['id'],_0x36efe4,{'parse_mode':_0x5b5b61(0x310)});}),tgBot[_0x58d260(0x3be)](_0x58d260(0x28b),async _0x1fd875=>{const _0x79bd80=_0x58d260,_0x8c4111=getEnabledBots();if(_0x8c4111['length']==0x0)await sendTelegram(_0x1fd875[_0x79bd80(0x307)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x8c4111[_0x79bd80(0x3b8)]>0x1)_0x8c4111[_0x79bd80(0x2db)]({'botID':_0x79bd80(0x3e0)});let _0x524e11=[],_0x5da5a0=[];const _0x1341fb=_0x8c4111[_0x79bd80(0x3b8)]%0x4==0x0||_0x8c4111[_0x79bd80(0x3b8)]%0x4==0x3||_0x8c4111[_0x79bd80(0x3b8)]%0x3==0x1?0x4:0x3;let _0x4aadba=0x0;_0x8c4111['forEach']((_0xb4adb9,_0x41b1a9)=>{const _0x36ed55=_0x79bd80;if(_0x41b1a9%_0x1341fb==0x0)_0x5da5a0=[];_0x5da5a0[_0x36ed55(0x2db)](Markup['button'][_0x36ed55(0x21b)](_0xb4adb9[_0x36ed55(0x2dd)]==_0x36ed55(0x3e0)?_0x36ed55(0x368):_0x36ed55(0x2a7)+_0xb4adb9[_0x36ed55(0x2dd)],_0x36ed55(0x3c9)+_0xb4adb9[_0x36ed55(0x2dd)])),_0x41b1a9%_0x1341fb==0x0&&(_0x524e11[_0x4aadba]=_0x5da5a0,_0x4aadba++);});const _0x4a32c4=Markup[_0x79bd80(0x2c8)](_0x524e11);_0x1fd875[_0x79bd80(0x34d)](_0x79bd80(0x2e6),_0x4a32c4);}}),tgBot[_0x58d260(0x283)](/restart_(.+)/,async _0xf1abb0=>{const _0x33d62f=_0x58d260,_0x2c2c7d=_0xf1abb0['match'][0x1];_0xf1abb0['editMessageReplyMarkup'](),_0x2c2c7d==_0x33d62f(0x3e0)?config[_0x33d62f(0x1fc)](_0xc32a64=>{const _0x230fd3=_0x33d62f;restartBot(_0xc32a64[_0x230fd3(0x2dd)]);}):restartBot(_0x2c2c7d);}),tgBot[_0x58d260(0x3be)]('on',async _0x2c02bf=>{const _0x37a513=_0x58d260,_0x27f92f=getDisabledBots();if(_0x27f92f['length']==0x0)await sendTelegram(_0x2c02bf['chat']['id'],_0x37a513(0x273));else{if(_0x27f92f[_0x37a513(0x3b8)]>0x1)_0x27f92f[_0x37a513(0x2db)]({'botID':'all'});let _0x317457=[],_0x2c5328=[];const _0x4f522e=_0x27f92f[_0x37a513(0x3b8)]%0x4==0x0||_0x27f92f['length']%0x4==0x3||_0x27f92f[_0x37a513(0x3b8)]%0x3==0x1?0x4:0x3;let _0x53ab81=0x0;_0x27f92f[_0x37a513(0x1fc)]((_0x1e18a2,_0x411229)=>{const _0x45ad6c=_0x37a513;if(_0x411229%_0x4f522e==0x0)_0x2c5328=[];_0x2c5328[_0x45ad6c(0x2db)](Markup[_0x45ad6c(0x345)][_0x45ad6c(0x21b)](_0x1e18a2[_0x45ad6c(0x2dd)]==_0x45ad6c(0x3e0)?_0x45ad6c(0x368):_0x45ad6c(0x2a7)+_0x1e18a2[_0x45ad6c(0x2dd)],'on_'+_0x1e18a2[_0x45ad6c(0x2dd)])),_0x411229%_0x4f522e==0x0&&(_0x317457[_0x53ab81]=_0x2c5328,_0x53ab81++);});const _0x2e0f3c=Markup[_0x37a513(0x2c8)](_0x317457);_0x2c02bf['reply'](_0x37a513(0x401),_0x2e0f3c);}}),tgBot[_0x58d260(0x283)](/on_(.+)/,async _0x14088f=>{const _0x17bd78=_0x58d260,_0x14c71a=_0x14088f['match'][0x1];_0x14088f[_0x17bd78(0x380)]();if(_0x14c71a==_0x17bd78(0x3e0)){const _0x123b4b=getDisabledBots();await sendTelegram(_0x14088f[_0x17bd78(0x307)]['id'],_0x17bd78(0x2b6)),_0x123b4b[_0x17bd78(0x1fc)](_0x340692=>{const _0x4b449c=_0x17bd78;if(_0x340692[_0x4b449c(0x2dd)]!='all')toggleBot(_0x340692[_0x4b449c(0x2dd)],toggleStatus(_0x340692[_0x4b449c(0x2dd)]),_0x4b449c(0x226));});}else await sendTelegram(_0x14088f[_0x17bd78(0x307)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x14c71a),toggleBot(_0x14c71a,toggleStatus(_0x14c71a),_0x17bd78(0x226));}),tgBot['command'](_0x58d260(0x217),async _0x3cc23d=>{const _0x8f3f52=_0x58d260,_0x5097fa=getEnabledBots();if(_0x5097fa[_0x8f3f52(0x3b8)]==0x0)await sendTelegram(_0x3cc23d[_0x8f3f52(0x307)]['id'],_0x8f3f52(0x29a));else{if(_0x5097fa['length']>0x1)_0x5097fa[_0x8f3f52(0x2db)]({'botID':'all'});let _0x48695f=[],_0x228d31=[];const _0xa4c643=_0x5097fa[_0x8f3f52(0x3b8)]%0x4==0x0||_0x5097fa[_0x8f3f52(0x3b8)]%0x4==0x3||_0x5097fa['length']%0x3==0x1?0x4:0x3;let _0x15f7e7=0x0;_0x5097fa['forEach']((_0x264687,_0x26cd8a)=>{const _0xc0803f=_0x8f3f52;if(_0x26cd8a%_0xa4c643==0x0)_0x228d31=[];_0x228d31[_0xc0803f(0x2db)](Markup['button'][_0xc0803f(0x21b)](_0x264687[_0xc0803f(0x2dd)]=='all'?_0xc0803f(0x368):_0xc0803f(0x2a7)+_0x264687[_0xc0803f(0x2dd)],_0xc0803f(0x37d)+_0x264687[_0xc0803f(0x2dd)])),_0x26cd8a%_0xa4c643==0x0&&(_0x48695f[_0x15f7e7]=_0x228d31,_0x15f7e7++);});const _0x1383b4=Markup[_0x8f3f52(0x2c8)](_0x48695f);_0x3cc23d[_0x8f3f52(0x34d)](_0x8f3f52(0x26c),_0x1383b4);}}),tgBot[_0x58d260(0x283)](/off_(.+)/,async _0x220889=>{const _0x2b991f=_0x58d260,_0x291a40=_0x220889[_0x2b991f(0x403)][0x1];_0x220889[_0x2b991f(0x380)]();if(_0x291a40==_0x2b991f(0x3e0)){const _0x3ab6a3=getEnabledBots();await sendTelegram(_0x220889[_0x2b991f(0x307)]['id'],_0x2b991f(0x2bd)),_0x3ab6a3[_0x2b991f(0x1fc)](_0x6566=>{const _0x37bf15=_0x2b991f;if(_0x6566[_0x37bf15(0x2dd)]!='all')toggleBot(_0x6566[_0x37bf15(0x2dd)],toggleStatus(_0x6566['botID']),'stopped');});}else await sendTelegram(_0x220889['chat']['id'],_0x2b991f(0x291)+_0x291a40),toggleBot(_0x291a40,toggleStatus(_0x291a40),_0x2b991f(0x226));}),tgBot[_0x58d260(0x3be)](_0x58d260(0x3b0),async _0x542a9a=>{const _0x5d9d69=_0x58d260,_0x42d480=getEnabledBots();if(_0x42d480[_0x5d9d69(0x3b8)]==0x0)await sendTelegram(_0x542a9a['chat']['id'],_0x5d9d69(0x29a));else{if(_0x42d480['length']>0x1){let _0x248c11=[],_0x349d36=[];const _0x5c763c=_0x42d480[_0x5d9d69(0x3b8)]%0x4==0x0||_0x42d480['length']%0x4==0x3||_0x42d480[_0x5d9d69(0x3b8)]%0x3==0x1?0x4:0x3;let _0x4c5456=0x0;_0x42d480[_0x5d9d69(0x1fc)]((_0x1f4805,_0x30b826)=>{const _0x56d855=_0x5d9d69;if(_0x30b826%_0x5c763c==0x0)_0x349d36=[];_0x349d36[_0x56d855(0x2db)](Markup[_0x56d855(0x345)][_0x56d855(0x21b)](_0x56d855(0x2a7)+_0x1f4805[_0x56d855(0x2dd)],'metrics_'+_0x1f4805[_0x56d855(0x2dd)])),_0x30b826%_0x5c763c==0x0&&(_0x248c11[_0x4c5456]=_0x349d36,_0x4c5456++);});const _0x277507=Markup[_0x5d9d69(0x2c8)](_0x248c11);_0x542a9a[_0x5d9d69(0x34d)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x277507);}else{const _0x32d079=_0x42d480[0x0]['botID'];if(pid[_0x32d079])pid[_0x32d079]['send']({'function':_0x5d9d69(0x2a5),'args':null});}}}),tgBot[_0x58d260(0x283)](/metrics_(.+)/,async _0x350b89=>{const _0x164d73=_0x58d260,_0x33ebe9=_0x350b89['match'][0x1];_0x350b89[_0x164d73(0x380)]();if(pid[_0x33ebe9])pid[_0x33ebe9]['send']({'function':_0x164d73(0x2a5),'args':null});}),tgBot[_0x58d260(0x3be)]('portfolio',async _0x19eb11=>{const _0x35dc3a=_0x58d260,_0x5ebefe=getEnabledBots();if(_0x5ebefe[_0x35dc3a(0x3b8)]==0x0)await sendTelegram(_0x19eb11[_0x35dc3a(0x307)]['id'],_0x35dc3a(0x29a));else{if(_0x5ebefe[_0x35dc3a(0x3b8)]>0x1){let _0x56065a=[],_0x5393fe=[];const _0x35629f=_0x5ebefe[_0x35dc3a(0x3b8)]%0x4==0x0||_0x5ebefe['length']%0x4==0x3||_0x5ebefe[_0x35dc3a(0x3b8)]%0x3==0x1?0x4:0x3;let _0x302360=0x0;_0x5ebefe['forEach']((_0x443ed9,_0x56a5fd)=>{const _0x589215=_0x35dc3a;if(_0x56a5fd%_0x35629f==0x0)_0x5393fe=[];_0x5393fe['push'](Markup['button'][_0x589215(0x21b)](_0x589215(0x2a7)+_0x443ed9[_0x589215(0x2dd)],_0x589215(0x253)+_0x443ed9[_0x589215(0x2dd)])),_0x56a5fd%_0x35629f==0x0&&(_0x56065a[_0x302360]=_0x5393fe,_0x302360++);});const _0x3da23e=Markup['inlineKeyboard'](_0x56065a);_0x19eb11[_0x35dc3a(0x34d)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x3da23e);}else{const _0x4d8e18=_0x5ebefe[0x0][_0x35dc3a(0x2dd)];if(pid[_0x4d8e18])pid[_0x4d8e18][_0x35dc3a(0x404)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x58d260(0x283)](/portfolio_(.+)/,async _0x370f52=>{const _0x5ce14f=_0x58d260,_0x190e0e=_0x370f52[_0x5ce14f(0x403)][0x1];_0x370f52[_0x5ce14f(0x380)]();if(pid[_0x190e0e])pid[_0x190e0e][_0x5ce14f(0x404)]({'function':_0x5ce14f(0x2d2),'args':null});}),tgBot['command'](_0x58d260(0x32f),async _0x468689=>{const _0x4c29c2=_0x58d260,_0x6f5480=_0x4c29c2(0x32f);await zipFiles(_0x6f5480);const _0x30e6b3=zippath+(_0x6f5480+'.zip');_0x468689[_0x4c29c2(0x21e)]({'source':_0x30e6b3})[_0x4c29c2(0x2b7)](()=>{})[_0x4c29c2(0x329)](_0x552a=>logger[_0x4c29c2(0x258)](_0x4c29c2(0x2ed)+_0x6f5480+_0x4c29c2(0x3ad),_0x552a));}),tgBot['command'](_0x58d260(0x37a),async _0x46ec15=>{const _0x47aec7=_0x58d260,_0x3a5401=_0x47aec7(0x37a);await backupConfigFiles(),await zipFiles(_0x3a5401);const _0xd1a7ea=zippath+(_0x3a5401+_0x47aec7(0x349));_0x46ec15[_0x47aec7(0x21e)]({'source':_0xd1a7ea})[_0x47aec7(0x2b7)](()=>{})[_0x47aec7(0x329)](_0x340bae=>logger['debug'](_0x47aec7(0x2ed)+_0x3a5401+_0x47aec7(0x3ad),_0x340bae));}),tgBot[_0x58d260(0x3be)](_0x58d260(0x360),async _0x1a013d=>{const _0x22bb65=_0x58d260;await getMessages();if(!updateAvailable)await sendTelegram(_0x1a013d[_0x22bb65(0x307)]['id'],'Your\x20installation\x20is\x20already\x20up\x20to\x20date');else{if(!validInstallation)await sendTelegram(_0x1a013d[_0x22bb65(0x307)]['id'],_0x22bb65(0x37e));else{const _0x45a4d9=Markup[_0x22bb65(0x2c8)]([Markup['button'][_0x22bb65(0x21b)]('Yes','update_yes'),Markup[_0x22bb65(0x345)][_0x22bb65(0x21b)]('No',_0x22bb65(0x3e1))]);_0x1a013d['reply'](_0x22bb65(0x2aa),_0x45a4d9);}}}),tgBot[_0x58d260(0x283)](/update_(.+)/,async _0x37f161=>{const _0x105643=_0x58d260,_0x1ab33c=_0x37f161[_0x105643(0x403)][0x1];_0x37f161['editMessageReplyMarkup'](),_0x1ab33c==_0x105643(0x288)&&(await sendTelegram(_0x37f161[_0x105643(0x307)]['id'],_0x105643(0x3e7)),updateBB(_0x105643(0x360))),_0x1ab33c=='no'&&await sendTelegram(_0x37f161[_0x105643(0x307)]['id'],_0x105643(0x2e0));}),tgBot['command']('reinstall',async _0x32c7d5=>{const _0x42f8c9=_0x58d260;if(!validInstallation)await sendTelegram(_0x32c7d5['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x4cf2d1=Markup[_0x42f8c9(0x2c8)]([Markup[_0x42f8c9(0x345)][_0x42f8c9(0x21b)](_0x42f8c9(0x2dc),_0x42f8c9(0x3f6)),Markup['button'][_0x42f8c9(0x21b)]('No',_0x42f8c9(0x275))]);_0x32c7d5['reply'](_0x42f8c9(0x279),_0x4cf2d1);}}),tgBot['action'](/reinstall_(.+)/,async _0x177a06=>{const _0x31a34b=_0x58d260,_0x25a600=_0x177a06[_0x31a34b(0x403)][0x1];_0x177a06[_0x31a34b(0x380)](),_0x25a600==_0x31a34b(0x288)&&(await sendTelegram(_0x177a06[_0x31a34b(0x307)]['id'],_0x31a34b(0x25a)),updateBB('reinstall')),_0x25a600=='no'&&await sendTelegram(_0x177a06['chat']['id'],_0x31a34b(0x21a));}),tgBot[_0x58d260(0x3be)](_0x58d260(0x36f),async _0x173673=>{const _0x264787=_0x58d260,_0xb69a73=getBotsWithMode();if(_0xb69a73[_0x264787(0x3b8)]==0x0)await sendTelegram(_0x173673[_0x264787(0x307)]['id'],_0x264787(0x29a));else{let _0x209da2=[],_0x140b3a=[];const _0x4733c1=0x2;let _0x993395=0x0;_0xb69a73[_0x264787(0x1fc)]((_0x2449e1,_0x1f5b6c)=>{const _0x431751=_0x264787;if(_0x1f5b6c%_0x4733c1==0x0)_0x140b3a=[];_0x140b3a['push'](Markup[_0x431751(0x345)][_0x431751(0x21b)](_0x431751(0x2a7)+_0x2449e1[_0x431751(0x2dd)]+'\x20('+_0x2449e1[_0x431751(0x282)]+')','toggle_'+_0x2449e1[_0x431751(0x2dd)])),_0x1f5b6c%_0x4733c1==0x0&&(_0x209da2[_0x993395]=_0x140b3a,_0x993395++);});const _0x4b8ed3=Markup[_0x264787(0x2c8)](_0x209da2);_0x173673['reply'](_0x264787(0x3ba),_0x4b8ed3);}}),tgBot[_0x58d260(0x283)](/toggle_(.+)/,async _0x4e43ac=>{const _0x2bfce2=_0x58d260,_0x1a066f=_0x4e43ac[_0x2bfce2(0x403)][0x1];_0x4e43ac['editMessageReplyMarkup']();const _0x5ed54b=getBotsWithMode(),_0x9dd00d=_0x5ed54b[_0x2bfce2(0x261)](_0x578710=>_0x578710[_0x2bfce2(0x2dd)]==_0x1a066f),_0x413cf2=_0x9dd00d[_0x2bfce2(0x282)]==_0x2bfce2(0x3c3)?_0x2bfce2(0x20d):_0x2bfce2(0x3c3);await sendTelegram(_0x4e43ac['chat']['id'],'Bot\x20Mgr\x20>\x20toggling\x20Bot\x20'+_0x1a066f+_0x2bfce2(0x38b)+_0x413cf2+_0x2bfce2(0x392)),toggleBotMode(_0x1a066f);}),tgBot['command'](_0x58d260(0x3df),async _0x40a12f=>{const _0x1783c2=_0x58d260;let _0x27e3a1='';config['forEach'](_0x7f8f10=>{const _0x576e10=_0x458b;_0x27e3a1+=_0x576e10(0x2a7)+_0x7f8f10[_0x576e10(0x2dd)]+':\x20'+_0x7f8f10[_0x576e10(0x260)]+'\x0a';}),await sendTelegram(_0x40a12f[_0x1783c2(0x307)]['id'],_0x27e3a1,{'parse_mode':_0x1783c2(0x310)});}),tgBot[_0x58d260(0x3be)](_0x58d260(0x243),async _0x4e507a=>{const _0x523993=_0x58d260;await sendTelegram(_0x4e507a[_0x523993(0x307)]['id'],_0x3e5f14);}),process[_0x58d260(0x3dc)](_0x58d260(0x239),()=>tgBot['stop'](_0x58d260(0x239))),process[_0x58d260(0x3dc)](_0x58d260(0x270),()=>tgBot[_0x58d260(0x27b)](_0x58d260(0x270))),tgBot[_0x58d260(0x300)]();}function disableTelegram(){const _0x123e61=_0x14ce44;tgBot&&tgBot[_0x123e61(0x27b)]();}async function sendTelegram(_0x1f7ef0,_0x5f4a76,_0x165d4f){const _0x47d9e5=_0x14ce44;_0x165d4f={..._0x165d4f,'disable_web_page_preview':!![]};try{await tgBot[_0x47d9e5(0x3b9)][_0x47d9e5(0x3b3)](_0x1f7ef0,_0x5f4a76,_0x165d4f);}catch(_0x38e842){logger['debug'](_0x47d9e5(0x2bf),_0x38e842);}}async function sendTelegramBot(_0x19b28c,_0x4375c3){const _0x21b949=_0x14ce44;if(settings[_0x21b949(0x3b1)]){if(settings['telegramEvents']==_0x21b949(0x3e0)||(_0x4375c3[_0x21b949(0x304)]==_0x21b949(0x2fa)||_0x4375c3[_0x21b949(0x304)]=='warning'||_0x4375c3[_0x21b949(0x304)]=='success')&&settings[_0x21b949(0x407)]=='alerts'||_0x4375c3[_0x21b949(0x304)]==_0x21b949(0x3fa)&&settings[_0x21b949(0x407)]==_0x21b949(0x284)){if(tgBot&&settings[_0x21b949(0x25e)]){if(_0x4375c3[_0x21b949(0x2de)])await sendTelegram(settings['telegramChatId'],_0x4375c3[_0x21b949(0x260)]+_0x21b949(0x394)+_0x4375c3['event']);else await sendTelegram(settings[_0x21b949(0x25e)],_0x21b949(0x2a7)+_0x19b28c+'\x20>\x20'+_0x4375c3[_0x21b949(0x247)]);}}}}async function sendTelegramMsg(_0x38efa4,_0x46adcf='HTML'){return settings['telegramEnabled']&&tgBot&&settings['telegramChatId']?(await sendTelegram(settings['telegramChatId'],_0x38efa4,{'parse_mode':_0x46adcf}),!![]):![];}function getDeviceWithIp(_0x4b3995){const _0x9d729c=_0x14ce44;return devices[_0x9d729c(0x261)](_0x857a1=>_0x857a1['ip']===_0x4b3995);}async function temporaryAccess2FA(_0x24fe6a,_0x2be899){const _0x78e26=_0x14ce44;let _0x3fcb46=new Date(),_0x2e9e25=![];if(lastIpApproval){if(_0x3fcb46-lastIpApproval<0x1388)_0x2e9e25=!![];}lastIpApproval=new Date();if(_0x2e9e25)return;if(tgBot&&settings[_0x78e26(0x25e)]){const _0x39f74b=uuidRandom();tmpStorage[_0x39f74b]={'uuid':_0x24fe6a,'externalip':_0x2be899};const _0x2e4747=Markup[_0x78e26(0x2c8)]([Markup['button']['callback']('5\x20min',_0x78e26(0x3ab)+_0x39f74b),Markup[_0x78e26(0x345)][_0x78e26(0x21b)](_0x78e26(0x25d),_0x78e26(0x39b)+_0x39f74b),Markup[_0x78e26(0x345)][_0x78e26(0x21b)](_0x78e26(0x20a),_0x78e26(0x2b5)+_0x39f74b),Markup[_0x78e26(0x345)][_0x78e26(0x21b)](_0x78e26(0x364),'tempaccess_reject_'+_0x39f74b)]);await sendTelegram(settings[_0x78e26(0x25e)],_0x78e26(0x3bb)+normalizeIP(_0x2be899)[_0x78e26(0x228)]+'\x20?',_0x2e4747),tgBot[_0x78e26(0x283)](/tempaccess_(.+)_(.+)/,async _0x444e9c=>{const _0x3e2926=_0x78e26,_0x1fbb24=_0x444e9c[_0x3e2926(0x403)][0x1],_0x4ef94b=_0x444e9c[_0x3e2926(0x403)][0x2],{uuid:_0x4f1191,externalip:_0x12d970}=tmpStorage[_0x4ef94b];delete tmpStorage[_0x4ef94b],_0x444e9c[_0x3e2926(0x380)](),devices[_0x4f1191][_0x3e2926(0x2ae)]={'clientip':_0x12d970,'timestamp':new Date()[_0x3e2926(0x3c6)](),'expiry':_0x1fbb24},_0x1fbb24!=_0x3e2926(0x364)?(await sendTelegram(_0x444e9c[_0x3e2926(0x307)]['id'],_0x3e2926(0x31f)+_0x1fbb24+_0x3e2926(0x2c2),{'parse_mode':_0x3e2926(0x310)}),io['to'](_0x4f1191)[_0x3e2926(0x3ce)](_0x3e2926(0x3d5),{'access':{'allow':![],'reason':_0x3e2926(0x2e9),'token':null}})):(await sendTelegram(_0x444e9c[_0x3e2926(0x307)]['id'],_0x3e2926(0x200)),io['to'](_0x4f1191)['emit'](_0x3e2926(0x3d5),{'access':{'allow':![],'reason':_0x3e2926(0x2a1),'token':null}}));});}}async function loginAccess2FA(_0x548009,_0x411dfd){const _0x2af7cf=_0x14ce44;if(tgBot&&settings[_0x2af7cf(0x25e)]){const _0x1bd29e=uuidRandom();tmpStorage[_0x1bd29e]={'uuid':_0x548009,'externalip':_0x411dfd};const _0x23728b=Markup[_0x2af7cf(0x2c8)]([Markup[_0x2af7cf(0x345)][_0x2af7cf(0x21b)]('accept',_0x2af7cf(0x2f4)+loginExpiry+'_'+_0x1bd29e),Markup[_0x2af7cf(0x345)][_0x2af7cf(0x21b)]('reject',_0x2af7cf(0x2b0)+_0x1bd29e)]);await sendTelegram(settings[_0x2af7cf(0x25e)],_0x2af7cf(0x3d9)+normalizeIP(_0x411dfd)['show']+'\x20?',_0x23728b),tgBot[_0x2af7cf(0x283)](/login2fa_(.+)_(.+)/,async _0x4f4987=>{const _0x4873de=_0x2af7cf,_0x230849=_0x4f4987[_0x4873de(0x403)][0x1],_0x51858c=_0x4f4987[_0x4873de(0x403)][0x2],{uuid:_0xf8bef,externalip:_0x2e771f}=tmpStorage[_0x51858c];delete tmpStorage[_0x51858c],_0x4f4987[_0x4873de(0x380)](),devices[_0xf8bef][_0x4873de(0x39e)]={'clientip':_0x2e771f,'timestamp':new Date()[_0x4873de(0x3c6)](),'expiry':_0x230849},_0x230849!=_0x4873de(0x364)?(await sendTelegram(_0x4f4987[_0x4873de(0x307)]['id'],_0x4873de(0x2ec),{'parse_mode':_0x4873de(0x310)}),io['to'](_0xf8bef)[_0x4873de(0x3ce)](_0x4873de(0x3d5),{'access':{'allow':![],'reason':_0x4873de(0x2e9),'token':null}})):(await sendTelegram(_0x4f4987[_0x4873de(0x307)]['id'],_0x4873de(0x3d8)),io['to'](_0xf8bef)[_0x4873de(0x3ce)](_0x4873de(0x3d5),{'access':{'allow':![],'reason':_0x4873de(0x34c),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x135d25=_0x14ce44;return dbConfig[_0x135d25(0x2f1)](_0x135d25(0x3db))['sortBy']('botID')[_0x135d25(0x34b)]({'status':_0x135d25(0x3d1)})[_0x135d25(0x2da)]()||[];}function getDisabledBots(){const _0x28a43b=_0x14ce44;return dbConfig[_0x28a43b(0x2f1)](_0x28a43b(0x3db))['sortBy'](_0x28a43b(0x2dd))[_0x28a43b(0x34b)]({'status':_0x28a43b(0x3c7)})['value']()||[];}function getBotAttributes(_0x3bbdb0){const _0x4becc0=_0x14ce44;let _0x345de8={};const _0x3a6cb8=configpath+'bot-'+_0x3bbdb0+_0x4becc0(0x316),_0x538bac=fs[_0x4becc0(0x3a4)](_0x3a6cb8);if(_0x538bac){const _0x599437=fs['readFileSync'](_0x3a6cb8);try{const _0x3f18e6=JSON['parse'](_0x599437),_0x25ac5b=_0x3f18e6?_0x3f18e6[_0x4becc0(0x290)][0x0]['headless']:![];_0x345de8[_0x4becc0(0x282)]=_0x25ac5b?_0x4becc0(0x3c3):_0x4becc0(0x20d),_0x345de8[_0x4becc0(0x260)]=_0x3f18e6?_0x3f18e6[_0x4becc0(0x290)][0x0]['botname']:_0x4becc0(0x2a7)+_0x3bbdb0;}catch(_0x2ebb97){_0x345de8[_0x4becc0(0x282)]=_0x4becc0(0x20d),_0x345de8[_0x4becc0(0x260)]=_0x4becc0(0x2a7)+_0x3bbdb0;}}else _0x345de8[_0x4becc0(0x282)]='manual',_0x345de8[_0x4becc0(0x260)]='Bot\x20'+_0x3bbdb0;return _0x345de8;}function getBotsWithMode(){const _0x1d2d2b=_0x14ce44,_0x27ccbb=dbConfig[_0x1d2d2b(0x2f1)](_0x1d2d2b(0x3db))['sortBy'](_0x1d2d2b(0x2dd))[_0x1d2d2b(0x2da)]()||[];return _0x27ccbb[_0x1d2d2b(0x1fc)](_0x2f9600=>{let _0x34e71f=getBotAttributes(_0x2f9600['botID']);_0x2f9600['mode']=_0x34e71f['mode'];}),_0x27ccbb;}function getBotExchanges(){const _0x32e40b=_0x14ce44;let _0x3fb03d=[];const _0x124ca9=dbConfig[_0x32e40b(0x2f1)]('bots')['sortBy'](_0x32e40b(0x2dd))[_0x32e40b(0x2da)]()||[];_0x124ca9[_0x32e40b(0x1fc)](_0x23a0de=>{const _0x5c3136=_0x32e40b;if(_0x23a0de[_0x5c3136(0x3d5)]=='enabled'){const _0x448b13=configpath+_0x5c3136(0x36a)+_0x23a0de[_0x5c3136(0x2dd)]+_0x5c3136(0x316),_0x2cc6f4=fs[_0x5c3136(0x3a4)](_0x448b13);let _0x4224f1;if(_0x2cc6f4){const _0x163653=fs[_0x5c3136(0x22e)](_0x448b13);try{const _0x1e6c62=JSON[_0x5c3136(0x208)](_0x163653);_0x4224f1=_0x1e6c62?_0x1e6c62['bot'][0x0][_0x5c3136(0x36d)]:null;}catch(_0x359a86){}}if(_0x4224f1)_0x3fb03d[_0x5c3136(0x2db)](_0x4224f1);}});const _0x8ef7f4=[...new Set(_0x3fb03d)][_0x32e40b(0x264)]();return _0x8ef7f4;}async function initUser(){const _0x51ebfb=_0x14ce44;if(!settings['userid']){const _0x50ec9b=uuidRandom();mixpanel[_0x51ebfb(0x2a8)](_0x50ec9b),updateSetting('userid',_0x50ec9b);}}async function initSecure(){const _0x1b2e5b=_0x14ce44;let _0x2ab202=getSecure();if(!_0x2ab202[_0x1b2e5b(0x257)](_0x1b2e5b(0x38a))){let _0x192841=await generateKeys();_0x2ab202[_0x1b2e5b(0x302)]=_0x192841[_0x1b2e5b(0x302)],_0x2ab202[_0x1b2e5b(0x37b)]=_0x192841[_0x1b2e5b(0x37b)],_0x2ab202[_0x1b2e5b(0x38a)]=crypto[_0x1b2e5b(0x280)](0x20)[_0x1b2e5b(0x285)](_0x1b2e5b(0x2ba));;storeSecure(_0x2ab202);}}function getSettings(){const _0x22e53e=_0x14ce44;return dbSettings[_0x22e53e(0x2f1)](_0x22e53e(0x3fe))[_0x22e53e(0x2da)]()||{};}function getSecure(){const _0x58c418=_0x14ce44;return dbSecure[_0x58c418(0x2f1)](_0x58c418(0x376))[_0x58c418(0x2da)]()||{};}function getBlacklist(){const _0x31af00=_0x14ce44;return dbSecure[_0x31af00(0x2f1)](_0x31af00(0x2df))['value']()||[];}function broadcastToBots(_0x14669e,_0xc4e0fc){const _0x446548=_0x14ce44;config[_0x446548(0x1fc)](_0x26b978=>{const _0x5ebb44=_0x446548;if(_0x26b978[_0x5ebb44(0x3d5)]==_0x5ebb44(0x3d1)&&_0x26b978['live']==_0x5ebb44(0x363)||_0x26b978[_0x5ebb44(0x3d5)]=='new'&&_0x26b978[_0x5ebb44(0x31c)]==_0x5ebb44(0x363)){if(pid[_0x26b978[_0x5ebb44(0x2dd)]])pid[_0x26b978['botID']]['send']({[_0x14669e]:_0xc4e0fc});}});}async function storeSettings(_0xa86191,_0x4dffc9=![]){const _0x315fd3=_0x14ce44;_0xa86191={...settings,..._0xa86191};if(_0x4dffc9&&_0xa86191['bbPassword']!='************'&&_0xa86191[_0x315fd3(0x333)]!=_0x315fd3(0x35f)&&_0xa86191['bbPassword']!=''){const _0x3c15a5=decryptRSA(secure[_0x315fd3(0x37b)],_0xa86191[_0x315fd3(0x333)])[_0x315fd3(0x237)]('|@|')[0x0],_0x2a102d=bcrypt[_0x315fd3(0x359)](_0x3c15a5,saltRounds);_0xa86191={..._0xa86191,'bbPassword':_0x2a102d};}if(_0x4dffc9&&_0xa86191[_0x315fd3(0x28a)]!='************'&&_0xa86191[_0x315fd3(0x28a)]!='***'&&_0xa86191['telegramToken']!=''){const _0x3fbd90=decryptRSA(secure[_0x315fd3(0x37b)],_0xa86191[_0x315fd3(0x28a)])[_0x315fd3(0x237)](_0x315fd3(0x1fa))[0x0];_0xa86191={..._0xa86191,'telegramToken':_0x3fbd90};}if(_0x4dffc9&&_0xa86191['marketcapApi']!='************'&&_0xa86191['marketcapApi']!=_0x315fd3(0x35f)&&_0xa86191[_0x315fd3(0x216)]!=''){const _0xb14fcf=decryptRSA(secure['privateKey'],_0xa86191['marketcapApi'])[_0x315fd3(0x237)](_0x315fd3(0x1fa))[0x0];_0xa86191={..._0xa86191,'marketcapApi':_0xb14fcf};}const _0x3826a1=_0xa86191[_0x315fd3(0x28a)]!=_0x315fd3(0x3eb)&&_0xa86191[_0x315fd3(0x28a)]!=settings[_0x315fd3(0x28a)]||_0xa86191[_0x315fd3(0x3b6)]!=settings[_0x315fd3(0x3b6)],_0x3c6038=_0xa86191[_0x315fd3(0x28a)]==''||_0xa86191[_0x315fd3(0x3b6)]=='',_0x179709=_0xa86191['marketcapApi']&&_0xa86191[_0x315fd3(0x216)]!='************'&&_0xa86191[_0x315fd3(0x216)]!=settings[_0x315fd3(0x216)];_0x3826a1&&(_0xa86191['telegramChatId']=null,_0xa86191[_0x315fd3(0x407)]='all');for(const [_0x427557,_0x281add]of Object[_0x315fd3(0x32c)](_0xa86191)){if(_0x427557=='telegramToken'&&_0x281add==_0x315fd3(0x3eb)){_0xa86191[_0x315fd3(0x28a)]=settings[_0x315fd3(0x28a)];continue;};if(_0x427557==_0x315fd3(0x333)&&_0x281add==_0x315fd3(0x3eb)){_0xa86191[_0x315fd3(0x333)]=settings[_0x315fd3(0x333)];continue;};if(_0x427557==_0x315fd3(0x216)&&_0x281add==_0x315fd3(0x3eb)){_0xa86191[_0x315fd3(0x216)]=settings[_0x315fd3(0x216)];continue;};dbSettings['set']('settings.'+_0x427557,_0x281add)[_0x315fd3(0x3a2)]();}settings=_0xa86191,io['to']('botmanager')[_0x315fd3(0x3ce)](_0x315fd3(0x3fe),cleanSettings()),broadcastToBots(_0x315fd3(0x343),settings[_0x315fd3(0x343)]),broadcastToBots(_0x315fd3(0x3ee),settings[_0x315fd3(0x3ee)]),broadcastToBots(_0x315fd3(0x216),settings[_0x315fd3(0x216)]);if(_0x3826a1&&!_0x3c6038)initTelegram();_0x3826a1&&_0x3c6038&&(updateSetting(_0x315fd3(0x25e),null),disableTelegram()),getAllClients()[_0x315fd3(0x1fc)](_0xa18288=>{const _0x47bb9d=_0x315fd3;getSocket(_0xa18288['id'])[_0x47bb9d(0x3ce)](_0x47bb9d(0x3d5),{'access':{'allow':![],'reason':_0x47bb9d(0x2e9),'token':null}});}),_0x179709&&(await sleep(0xbb8),testMarketcapApi(_0xa86191[_0x315fd3(0x216)]));}async function testMarketcapApi(_0x64f7e6){const _0xcae327=_0x14ce44,_0x26bc4e=[_0xcae327(0x3bc),_0xcae327(0x207)];try{await axios[_0xcae327(0x2f1)]('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x64f7e6},'params':{'symbol':_0x26bc4e[_0xcae327(0x285)]()}});}catch(_0x1db6db){_0x1db6db[_0xcae327(0x285)]()[_0xcae327(0x2af)](_0xcae327(0x297))?(io['to'](_0xcae327(0x37f))['emit'](_0xcae327(0x1f2),_0xcae327(0x242)),logger[_0xcae327(0x32b)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0xcae327(0x37f))[_0xcae327(0x3ce)](_0xcae327(0x1f2),_0xcae327(0x251)),logger[_0xcae327(0x32b)]('CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger['debug'](_0xcae327(0x255),_0x1db6db[_0xcae327(0x285)]()+_0xcae327(0x38f)+_0x1db6db[_0xcae327(0x40c)]));return;}logger[_0xcae327(0x258)](_0xcae327(0x2a3));}function updateSetting(_0x5a3ab0,_0x372d6f){const _0x2c7244=_0x14ce44;dbSettings[_0x2c7244(0x256)]('settings.'+_0x5a3ab0,_0x372d6f)[_0x2c7244(0x3a2)](),settings=getSettings(),io['to'](_0x2c7244(0x37f))[_0x2c7244(0x3ce)](_0x2c7244(0x3fe),cleanSettings());}function storeSecure(_0x5867fc){const _0x22b60b=_0x14ce44;dbSecure[_0x22b60b(0x2f1)](_0x22b60b(0x376))[_0x22b60b(0x2db)](_0x5867fc)[_0x22b60b(0x3a2)](),secure=_0x5867fc;}function addBlacklist(_0xa8f494){const _0x420dd8=_0x14ce44;cleanBlacklist();let _0x622099;devices[_0xa8f494][_0x420dd8(0x2ae)]?_0x622099=Math[_0x420dd8(0x203)](devices[_0xa8f494][_0x420dd8(0x2ae)][_0x420dd8(0x276)],loginExpiry):_0x622099=loginExpiry,dbSecure['get'](_0x420dd8(0x2df))['push']({'expiry':new Date()[_0x420dd8(0x3c6)]()+_0x622099*0x3c*0x3e8,'token':devices[_0xa8f494]['access'][_0x420dd8(0x2f0)]})[_0x420dd8(0x3a2)](),blacklist=dbSecure[_0x420dd8(0x2f1)](_0x420dd8(0x2df))[_0x420dd8(0x2da)]();}function cleanBlacklist(){const _0x3e8cbf=_0x14ce44;let _0x46b457=dbSecure['get'](_0x3e8cbf(0x2df))['cloneDeep']()[_0x3e8cbf(0x2da)](),_0x4e41ff=new Date()[_0x3e8cbf(0x3c6)]();_0x46b457[_0x3e8cbf(0x1fc)](_0x3a6436=>{const _0x2d671a=_0x3e8cbf;_0x3a6436['expiry']<_0x4e41ff&&dbSecure[_0x2d671a(0x2f1)]('blacklist')[_0x2d671a(0x3e8)]({'expiry':_0x3a6436['expiry']})[_0x2d671a(0x3a2)]();});}function initStates(){const _0x52e6af=_0x14ce44;let _0xc117b9=getConfiguration();_0xc117b9[_0x52e6af(0x1fc)](_0x56b7b6=>{const _0x24b802=_0x52e6af;_0x56b7b6[_0x24b802(0x31c)]=_0x24b802(0x226);}),storeConfiguration(_0xc117b9);}async function generateKeys(){const _0x3396f5=_0x14ce44,_0x3bdfad=forge['pki'][_0x3396f5(0x3f9)][_0x3396f5(0x336)]({'bits':0x1000,'e':0x10001}),_0x59bf97=forge[_0x3396f5(0x3af)][_0x3396f5(0x2a2)](_0x3bdfad[_0x3396f5(0x37b)]),_0x560be0=forge[_0x3396f5(0x3af)][_0x3396f5(0x381)](_0x3bdfad[_0x3396f5(0x302)]);return{'privateKey':_0x59bf97,'publicKey':_0x560be0};}async function oneTimeMigration(){const _0x387b54=_0x14ce44;let _0x52605e=getSettings(),_0x13b74f=![];!_0x52605e[_0x387b54(0x257)]('lastmsgtelegram')&&(_0x52605e[_0x387b54(0x231)]=0x0,_0x13b74f=!![]);!_0x52605e[_0x387b54(0x257)](_0x387b54(0x388))&&(_0x52605e[_0x387b54(0x388)]=0x0,_0x13b74f=!![]);!_0x52605e['hasOwnProperty']('latestversion')&&(_0x52605e[_0x387b54(0x245)]=_0x387b54(0x2b4),_0x13b74f=!![]);!_0x52605e['hasOwnProperty'](_0x387b54(0x3ee))&&(_0x52605e[_0x387b54(0x3ee)]=![],_0x13b74f=!![]);!_0x52605e[_0x387b54(0x257)](_0x387b54(0x216))&&(_0x52605e[_0x387b54(0x216)]='',_0x13b74f=!![]);if(_0x13b74f)storeSettings(_0x52605e);try{fs[_0x387b54(0x272)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x1312d6=>{const _0x58488d=_0x387b54;if(!_0x1312d6['isDirectory']()){if(!_0x1312d6[_0x58488d(0x3f5)][_0x58488d(0x2b8)](_0x58488d(0x377)))fs[_0x58488d(0x39d)](configbackuppath+_0x1312d6[_0x58488d(0x3f5)]);}else fs['rmSync'](configbackuppath+_0x1312d6['name'],{'recursive':!![]});});}catch(_0xb416ff){logger[_0x387b54(0x258)](_0x387b54(0x252),_0xb416ff);}}function storeConfiguration(_0x14d17d){const _0x1444ed=_0x14ce44;dbConfig[_0x1444ed(0x2f1)](_0x1444ed(0x3db))[_0x1444ed(0x3e8)]()[_0x1444ed(0x3a2)](),dbConfig[_0x1444ed(0x2f1)](_0x1444ed(0x3db))[_0x1444ed(0x2db)](..._0x14d17d)[_0x1444ed(0x3a2)](),config=_0x14d17d;}async function resetPassword(){const _0x2c2f20=_0x14ce44;if(tgBot&&settings['telegramChatId']){const _0x1de427=Markup[_0x2c2f20(0x2c8)]([Markup[_0x2c2f20(0x345)][_0x2c2f20(0x21b)](_0x2c2f20(0x288),'resetpw_yes'),Markup[_0x2c2f20(0x345)][_0x2c2f20(0x21b)]('no',_0x2c2f20(0x22f))]);await sendTelegram(settings[_0x2c2f20(0x25e)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x1de427),tgBot[_0x2c2f20(0x283)](/resetpw_(.+)/,async _0x15cfe1=>{const _0x2e749d=_0x2c2f20,_0x2601e0=_0x15cfe1['match'][0x1];_0x15cfe1[_0x2e749d(0x380)]();if(_0x2601e0!='no'){const _0xa3856a=0xf,_0x5c4fe7=_0x2e749d(0x2f9),_0x3b58d2=Array[_0x2e749d(0x2d4)](crypto[_0x2e749d(0x342)](new Uint32Array(_0xa3856a)))[_0x2e749d(0x206)](_0xba35a8=>_0x5c4fe7[_0xba35a8%_0x5c4fe7[_0x2e749d(0x3b8)]])[_0x2e749d(0x35e)](''),_0x1f690d=bcrypt[_0x2e749d(0x359)](_0x3b58d2,saltRounds);storeSettings({'bbPassword':_0x1f690d}),await sendTelegram(_0x15cfe1['chat']['id'],_0x2e749d(0x3a0)+_0x3b58d2,{'parse_mode':_0x2e749d(0x310)});}else await sendTelegram(_0x15cfe1['chat']['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x5ab05b,_0x1b4364){const _0x525d05=_0x14ce44;io['to']('botmanager')[_0x525d05(0x3ce)]('notification',_0x525d05(0x3ed),_0x525d05(0x397));if(tgBot&&settings[_0x525d05(0x25e)]){const _0x26e283=uuidRandom();tmpStorage[_0x26e283]={'path':_0x5ab05b,'filename':_0x1b4364};const _0x4bc150=Markup[_0x525d05(0x2c8)]([Markup[_0x525d05(0x345)][_0x525d05(0x21b)](_0x525d05(0x288),_0x525d05(0x2f5)+_0x26e283),Markup[_0x525d05(0x345)][_0x525d05(0x21b)]('no',_0x525d05(0x341)+_0x26e283)]);await sendTelegram(settings[_0x525d05(0x25e)],_0x525d05(0x30a),_0x4bc150),tgBot['action'](/restore_(.+)_(.+)/,async _0x21865b=>{const _0xed1ac6=_0x525d05,_0x3b4d52=_0x21865b[_0xed1ac6(0x403)][0x1],_0x58751e=_0x21865b[_0xed1ac6(0x403)][0x2],{path:_0x487c01,filename:_0x76c837}=tmpStorage[_0x58751e];delete tmpStorage[_0x58751e],_0x21865b[_0xed1ac6(0x380)](),_0x3b4d52==_0xed1ac6(0x288)?(logger[_0xed1ac6(0x258)](_0xed1ac6(0x266)),await sendTelegram(_0x21865b[_0xed1ac6(0x307)]['id'],_0xed1ac6(0x373),{'parse_mode':_0xed1ac6(0x310)}),unzipFile(_0x487c01,_0x76c837)):(logger[_0xed1ac6(0x258)](_0xed1ac6(0x2eb)),await sendTelegram(_0x21865b['chat']['id'],_0xed1ac6(0x2eb)));});}}function getServerTime(){const _0x4f80ee=_0x14ce44,_0x5788fc=new Date();return _0x5788fc[_0x4f80ee(0x3d7)]()+'/'+(_0x5788fc['getMonth']()+0x1)[_0x4f80ee(0x285)]()[_0x4f80ee(0x340)](0x2,'0')+'/'+_0x5788fc[_0x4f80ee(0x24e)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x5788fc[_0x4f80ee(0x306)]()['toString']()[_0x4f80ee(0x340)](0x2,'0')+':'+_0x5788fc[_0x4f80ee(0x323)]()['toString']()[_0x4f80ee(0x340)](0x2,'0')+':'+_0x5788fc[_0x4f80ee(0x1f3)]()[_0x4f80ee(0x285)]()[_0x4f80ee(0x340)](0x2,'0');}function getTimeStamp(){const _0x5e491b=_0x14ce44,_0x488611=shiftedTime();return _0x488611[_0x5e491b(0x3d7)]()+'/'+(_0x488611[_0x5e491b(0x1fe)]()+0x1)['toString']()[_0x5e491b(0x340)](0x2,'0')+'/'+_0x488611['getDate']()[_0x5e491b(0x285)]()[_0x5e491b(0x340)](0x2,'0')+'\x20'+_0x488611[_0x5e491b(0x306)]()[_0x5e491b(0x285)]()[_0x5e491b(0x340)](0x2,'0')+':'+_0x488611[_0x5e491b(0x323)]()['toString']()[_0x5e491b(0x340)](0x2,'0')+':'+_0x488611[_0x5e491b(0x1f3)]()[_0x5e491b(0x285)]()[_0x5e491b(0x340)](0x2,'0');}function getCleanTimeStamp(){const _0x33b799=_0x14ce44,_0x34f96b=shiftedTime();return _0x34f96b[_0x33b799(0x3d7)]()+(_0x34f96b[_0x33b799(0x1fe)]()+0x1)['toString']()[_0x33b799(0x340)](0x2,'0')+_0x34f96b[_0x33b799(0x24e)]()[_0x33b799(0x285)]()[_0x33b799(0x340)](0x2,'0')+'-'+_0x34f96b['getHours']()[_0x33b799(0x285)]()[_0x33b799(0x340)](0x2,'0')+_0x34f96b[_0x33b799(0x323)]()[_0x33b799(0x285)]()['padStart'](0x2,'0')+_0x34f96b[_0x33b799(0x1f3)]()[_0x33b799(0x285)]()['padStart'](0x2,'0');}function shiftedTime(){const _0xd76f7a=_0x14ce44,_0x53f13e=new Date();let _0x27158d=_0x53f13e;if(settings[_0xd76f7a(0x343)]&&settings[_0xd76f7a(0x343)]!==0x0)_0x27158d=fns[_0xd76f7a(0x218)](_0x53f13e,{'hours':settings[_0xd76f7a(0x343)]});return _0x27158d;}async function startScheduler(){const _0x1e7358=_0x14ce44,_0x31b662=new Date()[_0x1e7358(0x357)](),_0x45d463=shiftedTime()[_0x1e7358(0x306)]();_0x45d463==0x4&&backupConfigFiles(),_0x45d463==0x0&&(rotateLogFiles(),logger['debug'](_0x1e7358(0x1fd)),logger[_0x1e7358(0x258)](_0x1e7358(0x36e)+serverversion+_0x1e7358(0x31d)+(environment=='staging'?_0x1e7358(0x3c1):'')),logger[_0x1e7358(0x258)](_0x1e7358(0x1fd))),_0x31b662%0x6==0x0&&triggerAnalytics(),_0x31b662%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x117186){const _0x3eb72f=_0x14ce44;logger[_0x3eb72f(0x258)]('Restore\x20backup\x20file\x20'+_0x117186);const _0x47795f=getBotsWithMode();_0x47795f[_0x3eb72f(0x3b8)]>0x0?confirmRestore(configbackuppath,_0x117186):unzipFile(configbackuppath,_0x117186);}async function getBackupFiles(_0x4a68df=null){const _0x5d6e22=_0x14ce44;let _0x4e9526=[],_0x3a8e78=fs[_0x5d6e22(0x272)](configbackuppath,{'withFileTypes':!![]});_0x3a8e78[_0x5d6e22(0x264)]((_0x4c78f4,_0x484263)=>_0x4c78f4[_0x5d6e22(0x3f5)]<_0x484263[_0x5d6e22(0x3f5)]?0x1:_0x484263[_0x5d6e22(0x3f5)]<_0x4c78f4['name']?-0x1:0x0),_0x3a8e78[_0x5d6e22(0x1fc)](_0x585427=>{const _0x44f5ad=_0x5d6e22;if(!_0x585427[_0x44f5ad(0x1f9)]()&&_0x585427[_0x44f5ad(0x3f5)][_0x44f5ad(0x2b8)](_0x44f5ad(0x377))&&_0x585427[_0x44f5ad(0x3f5)][_0x44f5ad(0x29d)](_0x44f5ad(0x349))){const _0x28a5af=formatDate(fs[_0x44f5ad(0x271)](configbackuppath+_0x585427['name'])[_0x44f5ad(0x241)]);_0x4e9526[_0x44f5ad(0x2db)]({'name':_0x585427[_0x44f5ad(0x3f5)],'mtime':_0x28a5af});}});if(_0x4a68df)io['to'](_0x4a68df)[_0x5d6e22(0x3ce)]('backup-files',_0x4e9526);else return _0x4e9526;}async function backupConfigFiles(){const _0x155bab=_0x14ce44;await zipFiles(_0x155bab(0x2a6));const _0x3094b1=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x155bab(0x1fb),configbackuppath+(_0x155bab(0x377)+_0x3094b1+_0x155bab(0x349)));let _0x56b878=fs[_0x155bab(0x272)](configbackuppath,{'withFileTypes':!![]});_0x56b878[_0x155bab(0x264)]((_0x5320fc,_0x39cbf8)=>_0x5320fc[_0x155bab(0x3f5)]<_0x39cbf8[_0x155bab(0x3f5)]?0x1:_0x39cbf8['name']<_0x5320fc['name']?-0x1:0x0),_0x56b878[_0x155bab(0x3b8)]>maxBackups&&fs[_0x155bab(0x39d)](configbackuppath+_0x56b878[_0x56b878['length']-0x1]['name']);}function rotateLogFiles(){const _0x13f025=_0x14ce44,_0x1b7fc5=fs[_0x13f025(0x271)](logspath+_0x13f025(0x3c5)),_0xcd9f32=_0x1b7fc5[_0x13f025(0x36c)]/0x400;if(_0xcd9f32>0x64){let _0x5927b8=fs[_0x13f025(0x272)](logspath,{'withFileTypes':!![]});_0x5927b8[_0x13f025(0x264)]((_0x1d1725,_0x195278)=>_0x1d1725[_0x13f025(0x3f5)]<_0x195278[_0x13f025(0x3f5)]?0x1:_0x195278['name']<_0x1d1725[_0x13f025(0x3f5)]?-0x1:0x0),_0x5927b8[_0x13f025(0x1fc)](_0x42ebd1=>{const _0x20adc9=_0x13f025;if(_0x42ebd1['name']==_0x20adc9(0x2ab))fs['copyFileSync'](logspath+_0x42ebd1[_0x20adc9(0x3f5)],logspath+'output-003.log');if(_0x42ebd1[_0x20adc9(0x3f5)]=='output-001.log')fs['copyFileSync'](logspath+_0x42ebd1[_0x20adc9(0x3f5)],logspath+_0x20adc9(0x2ab));_0x42ebd1[_0x20adc9(0x3f5)]==_0x20adc9(0x3c5)&&(fs[_0x20adc9(0x296)](logspath+_0x42ebd1[_0x20adc9(0x3f5)],logspath+_0x20adc9(0x205)),fs[_0x20adc9(0x390)](logspath+_0x42ebd1['name'],''));});}}async function zipFiles(_0x497cb6){const _0x34e3f0=_0x14ce44;let _0x4d73ee;if(_0x497cb6==_0x34e3f0(0x32f))_0x4d73ee=logspath;if(_0x497cb6==_0x34e3f0(0x37a))_0x4d73ee=configpath;if(_0x497cb6==_0x34e3f0(0x2a6))_0x4d73ee=configpath;let _0x6634c2=fs[_0x34e3f0(0x272)](_0x4d73ee,{'withFileTypes':!![]});const _0x17d51f=new JSZip();_0x6634c2[_0x34e3f0(0x1fc)](_0x7fd33d=>{const _0x54ab21=_0x34e3f0;if(!_0x7fd33d[_0x54ab21(0x1f9)]()){let _0x5ed071=fs[_0x54ab21(0x22e)](_0x4d73ee+_0x7fd33d['name']);if(_0x497cb6==_0x54ab21(0x37a)){const _0x31c8cf=/^bot-[0-9]{3}-config.json$/,_0x22c6f8=_0x31c8cf['test'](_0x7fd33d[_0x54ab21(0x3f5)]);if(_0x22c6f8){const _0xd3bde6=JSON[_0x54ab21(0x208)](_0x5ed071);if(_0xd3bde6[_0x54ab21(0x290)][0x0]){_0xd3bde6[_0x54ab21(0x290)][0x0][_0x54ab21(0x2d8)]=_0x54ab21(0x35f),_0xd3bde6['bot'][0x0][_0x54ab21(0x31b)]='***';if(_0xd3bde6[_0x54ab21(0x290)][0x0][_0x54ab21(0x26e)])_0xd3bde6[_0x54ab21(0x290)][0x0]['apiPassword']=_0x54ab21(0x35f);}_0x5ed071=JSON[_0x54ab21(0x33a)](_0xd3bde6,null,0x2);}if(_0x7fd33d[_0x54ab21(0x3f5)]==_0x54ab21(0x23b)){const _0x1f0ee1=JSON[_0x54ab21(0x208)](_0x5ed071);if(_0x1f0ee1[_0x54ab21(0x3fe)][_0x54ab21(0x369)])_0x1f0ee1['settings'][_0x54ab21(0x369)]=![];if(_0x1f0ee1[_0x54ab21(0x3fe)][_0x54ab21(0x333)])_0x1f0ee1['settings']['bbPassword']=_0x54ab21(0x35f);if(_0x1f0ee1[_0x54ab21(0x3fe)][_0x54ab21(0x28a)])_0x1f0ee1[_0x54ab21(0x3fe)]['telegramToken']='***';if(_0x1f0ee1[_0x54ab21(0x3fe)][_0x54ab21(0x25e)])_0x1f0ee1[_0x54ab21(0x3fe)][_0x54ab21(0x25e)]=null;if(_0x1f0ee1[_0x54ab21(0x3fe)][_0x54ab21(0x216)])_0x1f0ee1['settings'][_0x54ab21(0x216)]='***';_0x5ed071=JSON['stringify'](_0x1f0ee1,null,0x2);}if(_0x7fd33d[_0x54ab21(0x3f5)]!=_0x54ab21(0x33f))_0x17d51f['file'](_0x7fd33d[_0x54ab21(0x3f5)],_0x5ed071);}else _0x17d51f[_0x54ab21(0x281)](_0x7fd33d[_0x54ab21(0x3f5)],_0x5ed071);}});const _0x245544=await _0x17d51f[_0x34e3f0(0x2d9)]({'type':'string','base64':![],'compression':_0x34e3f0(0x28d)});fs[_0x34e3f0(0x390)](zippath+(_0x497cb6+_0x34e3f0(0x349)),_0x245544,_0x34e3f0(0x26d));}async function unzipFile(_0x123fdb,_0x5b6f6e){const _0x2bbf6d=_0x14ce44;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x2bbf6d(0x1fc)](_0x544485=>{const _0xe4af43=_0x2bbf6d;if(!_0x544485['isDirectory']())fs[_0xe4af43(0x295)](configpath+_0x544485['name']);});const _0x722d3f=fs['readFileSync'](_0x123fdb+_0x5b6f6e,_0x2bbf6d(0x26d)),_0x33f5c1=await JSZip[_0x2bbf6d(0x2cb)](_0x722d3f,{'base64':![],'checkCRC32':!![]});for(const _0x359d6e of Object[_0x2bbf6d(0x27d)](_0x33f5c1['files'])){const _0x53a29b=_0x33f5c1[_0x2bbf6d(0x3b7)][_0x359d6e],_0x997c2d=await _0x53a29b['async']('string');fs[_0x2bbf6d(0x390)](configpath+_0x53a29b[_0x2bbf6d(0x3f5)],_0x997c2d);}fs[_0x2bbf6d(0x272)](temppath,{'withFileTypes':!![]})[_0x2bbf6d(0x1fc)](_0x48fcb9=>{const _0x360f31=_0x2bbf6d;if(!_0x48fcb9[_0x360f31(0x1f9)]())fs['rmSync'](temppath+_0x48fcb9[_0x360f31(0x3f5)]);}),logger[_0x2bbf6d(0x258)](_0x2bbf6d(0x215)),process[_0x2bbf6d(0x404)]({'restore':!![]},_0x433799=>{});}async function getPublicIp(){const _0x23e3b5=_0x14ce44;try{const _0x584b0b=await axios[_0x23e3b5(0x2f1)](_0x23e3b5(0x29e));publicip=_0x584b0b['data']['ip'];}catch(_0x4b0bc4){}}async function triggerAnalytics(){const _0x1b7968=_0x14ce44;if(!publicip)await getPublicIp();const _0x21a600=getBotsWithMode();let _0x4bab8e=0x0;_0x21a600[_0x1b7968(0x1fc)](_0x3cb7db=>{const _0x16f0a5=_0x1b7968;if(_0x3cb7db[_0x16f0a5(0x3d5)]===_0x16f0a5(0x3d1))_0x4bab8e++;});const _0x4e5b40=getBotExchanges();mixpanel[_0x1b7968(0x3f0)](_0x1b7968(0x210),{'distinct_id':settings[_0x1b7968(0x303)],'ip':publicip,'version':serverversion,'numbots':_0x21a600[_0x1b7968(0x3b8)],'numbotsenabled':_0x4bab8e,'exchanges':_0x4e5b40,'environment':environment});}async function getMessages(){const _0x3917fd=_0x14ce44,_0x2addc1=_0x3917fd(0x1ff),_0x4841eb=new GraphQLClient(_0x2addc1),_0x2b6052={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x36ee45=serverversion[_0x3917fd(0x237)]('.'),_0x2610be=_0x36ee45[0x0]+'.'+_0x36ee45[0x1],_0xcfb1b8=Math['min'](settings['lastmsgtelegram'],settings[_0x3917fd(0x388)]),_0x593a36={'last':parseInt(_0xcfb1b8),'bbm':_0x2610be},_0x30cddc=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x4a0fe4;try{_0x4a0fe4=await _0x4841eb['request'](_0x30cddc,_0x593a36,_0x2b6052);}catch(_0x1c6bdf){}if(_0x4a0fe4&&_0x4a0fe4[_0x3917fd(0x31e)]){let _0x14992b=settings['lastmsgtelegram'];newMessages=[];for(const _0x36c8f1 of _0x4a0fe4[_0x3917fd(0x31e)]){newMessages[_0x3917fd(0x2db)](_0x36c8f1);let _0x55e763=![];_0x36c8f1[_0x3917fd(0x35c)]&&(updateSetting(_0x3917fd(0x245),_0x36c8f1[_0x3917fd(0x35c)]),_0x55e763=isNewerVersion(serverversion,_0x36c8f1[_0x3917fd(0x35c)])||serverversion==_0x36c8f1[_0x3917fd(0x35c)]);if(!_0x55e763&&_0x36c8f1[_0x3917fd(0x331)]>_0x14992b){if(_0x36c8f1[_0x3917fd(0x3c0)]===_0x3917fd(0x25c)||serverversion[_0x3917fd(0x2b8)](_0x36c8f1[_0x3917fd(0x3c0)])){let _0x24eec2=''+_0x36c8f1[_0x3917fd(0x3a5)]+'\x0a\x0a'+_0x36c8f1['message'];const _0x413f70=await sendTelegramMsg(toTelegramMarkdown(_0x24eec2),_0x3917fd(0x3b5));if(_0x413f70)_0x14992b=_0x36c8f1['number'];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting('lastmsgtelegram',_0x14992b),emitMessages();}}function emitMessages(){const _0x552760=_0x14ce44,_0x37befd=settings[_0x552760(0x388)];let _0x3482d4=[];newMessages[_0x552760(0x1fc)](_0x30aa5f=>{const _0x11f996=_0x552760;_0x30aa5f[_0x11f996(0x331)]>_0x37befd&&_0x3482d4[_0x11f996(0x2db)](_0x30aa5f);}),_0x3482d4[_0x552760(0x3b8)]>0x0&&getAllClients()[_0x552760(0x1fc)](_0x52bb96=>{const _0x1e6a25=_0x552760;getSocket(_0x52bb96['id'])['emit'](_0x1e6a25(0x314),_0x3482d4);});}function confirmMessage(_0x145473){const _0x5184e9=_0x14ce44;updateSetting(_0x5184e9(0x388),Number(_0x145473));}function isNewerVersion(_0x47d5ce,_0x5a6f25){const _0x1be796=_0x14ce44,_0x1cabeb=_0x5a6f25[_0x1be796(0x237)]('.'),_0xc27f4f=_0x47d5ce[_0x1be796(0x237)]('.');for(var _0x16e0e9=0x0;_0x16e0e9<_0xc27f4f['length'];_0x16e0e9++){const _0x154b80=~~_0xc27f4f[_0x16e0e9],_0x2f9ae1=~~_0x1cabeb[_0x16e0e9];if(_0x154b80>_0x2f9ae1)return!![];if(_0x154b80<_0x2f9ae1)return![];}return![];}function toTelegramMarkdown(_0x4649b5){const _0x18f65a=_0x14ce44,_0x239c10=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x5a019f=/\*{2}(.+?)\*{2}/gim;return _0x4649b5=_0x4649b5[_0x18f65a(0x38e)](_0x239c10,_0x18f65a(0x37c))[_0x18f65a(0x38e)](_0x5a019f,_0x18f65a(0x2cc)),_0x4649b5;}async function validateConfigFile(){const _0xfa2305=_0x14ce44,_0x40cf40=dbConfig[_0xfa2305(0x2f1)]('bots')[_0xfa2305(0x32a)](_0xfa2305(0x2dd))[_0xfa2305(0x2da)]()||[];if(_0x40cf40[_0xfa2305(0x3b8)]==0x0){let _0x2888fd=0x0,_0xe47e86=[];const _0x3c9831=/^bot-([0-9]{3})-config.json$/,_0x136ae2=fs[_0xfa2305(0x272)](configpath);_0x136ae2[_0xfa2305(0x1fc)](_0x153f9b=>{const _0x2241a1=_0xfa2305,_0x1ace80=_0x3c9831[_0x2241a1(0x378)](_0x153f9b);if(_0x1ace80){const _0x2f7f39=_0x1ace80[0x1];let _0x4dbff5=getBotAttributes(_0x2f7f39);_0xe47e86['push']({'botID':_0x2f7f39,'botname':_0x4dbff5[_0x2241a1(0x260)],'status':_0x2241a1(0x3c7),'live':_0x2241a1(0x226)}),_0x2888fd++;}}),_0x2888fd!=0x0&&(dbConfig[_0xfa2305(0x2f1)]('bots')[_0xfa2305(0x2cd)](_0xe47e86)[_0xfa2305(0x3a2)](),config=_0xe47e86,restoredConfigFile=_0x2888fd);}}async function restoreConfigNotify(_0x36bc14){const _0x31983d=_0x14ce44;let _0x4c9495;if(restoredConfigFile==0x1)_0x4c9495='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x4c9495='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x36bc14)io['to'](_0x31983d(0x37f))['emit']('notification',_0x4c9495);else{logger['simple'](_0x31983d(0x2e7)),logger[_0x31983d(0x3cd)](_0x4c9495),logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x31983d(0x3cd)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x31983d(0x407)]!=_0x31983d(0x284))await sendTelegram(settings[_0x31983d(0x25e)],_0x31983d(0x366)+_0x4c9495);}}function decryptRSA(_0x160212,_0x26347d){const _0x26a7af=_0x14ce44,_0x559da0=forge[_0x26a7af(0x3af)][_0x26a7af(0x348)](_0x160212),_0x1cf789=_0x559da0['decrypt'](forge[_0x26a7af(0x318)][_0x26a7af(0x2a4)](_0x26347d),_0x26a7af(0x244),{'md':forge['md']['sha256'][_0x26a7af(0x1f7)](),'mgf1':{'md':forge['md']['sha256'][_0x26a7af(0x1f7)]()}});return _0x1cf789;}function validateCredentials(_0x3911b1,_0x50966e){const _0x59ec73=_0x14ce44;if(_0x3911b1[_0x59ec73(0x229)]==settings[_0x59ec73(0x3da)]&&bcrypt[_0x59ec73(0x3fc)](_0x3911b1['password'],settings[_0x59ec73(0x333)])){if(settings[_0x59ec73(0x334)])return{'allow':![],'reason':_0x59ec73(0x26a),'token':null};else{const _0xc2a58e=generateLoginToken(_0x50966e);return{'allow':!![],'reason':_0x59ec73(0x222),'token':_0xc2a58e};}}else return{'allow':![],'reason':_0x59ec73(0x21c),'token':null};}function refreshToken(_0x39db13){const _0x223f54=_0x14ce44,_0x1f9260=generateLoginToken(_0x39db13);return{'allow':!![],'reason':_0x223f54(0x222),'token':_0x1f9260};}function validateAccess(_0x42953d,_0x16ff51,_0x5b42ba){const _0x2533bf=_0x14ce44,_0x42a9c7=_0x5b42ba?_0x5b42ba:devices[_0x16ff51]['ip'];let _0x2f985a;const _0x52e74f=_0x1cd1f1=>{const _0x4895f8=_0x458b;if(settings[_0x4895f8(0x369)]){if(settings[_0x4895f8(0x334)]){if(telegram2FaApproved(_0x16ff51)){const _0x2e0052=generateLoginToken(_0x16ff51);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x2e0052};}else return{'allow':![],'reason':_0x4895f8(0x2cf),'token':null};}else return _0x2f985a=validToken(_0x1cd1f1,_0x16ff51),_0x2f985a['hasOwnProperty'](_0x4895f8(0x397))?{'allow':!![],'reason':_0x4895f8(0x298),'token':_0x1cd1f1}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':_0x4895f8(0x3fb),'token':null};};if(settings[_0x2533bf(0x27e)]){let _0x1032d8=[...settings['whitelist'],_0x2533bf(0x3f4),_0x2533bf(0x225),_0x2533bf(0x2ff)];if(_0x1032d8['includes'](_0x42a9c7))return _0x52e74f(_0x42953d);else{_0x2f985a=validToken(_0x42953d,_0x16ff51);if(_0x2f985a[_0x2533bf(0x257)]('success'))return _0x52e74f(_0x42953d);else{if(telegramIpApproved(_0x16ff51)){const _0x3fcf23=generateToken(_0x16ff51);return _0x2f985a=_0x52e74f(_0x42953d),_0x2f985a[_0x2533bf(0x294)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x3fcf23}:_0x2f985a;}else return settings[_0x2533bf(0x405)]?{'allow':![],'reason':_0x2533bf(0x2fb),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x52e74f(_0x42953d);}function timelyDecrypt(_0x3bbb50,_0x341f29,_0x5caf4e='@'){const _0x2068da=_0x14ce44;if(_0x3bbb50)try{const _0x15b5db=decryptRSA(secure[_0x2068da(0x37b)],_0x3bbb50),_0x5a2c9f=_0x15b5db[_0x2068da(0x237)](_0x5caf4e)[0x0],_0x20783f=_0x15b5db[_0x2068da(0x237)](_0x5caf4e)[0x1],_0x1ac787=new Date()[_0x2068da(0x3c6)]();if(_0x341f29){if(_0x1ac787-_0x20783f<maxSecretAge*0x3e8)return _0x5a2c9f;else return![];}else return _0x5a2c9f;}catch(_0x5e8e52){return![];}else return![];}const validToken=(_0x4413cd,_0x52abfe)=>{const _0x2f73bf=_0x14ce44,_0x36a143=devices[_0x52abfe]['ip'];if(!_0x4413cd)return{'error':_0x2f73bf(0x312)};for(let _0x519954 of blacklist){if(_0x519954[_0x2f73bf(0x2f0)]==_0x4413cd)return{'error':_0x2f73bf(0x2b3)};}let _0x516933;try{_0x516933=jwt[_0x2f73bf(0x27f)](_0x4413cd,secure[_0x2f73bf(0x38a)]+_0x52abfe);}catch{return{'error':_0x2f73bf(0x2e1)};}if(!_0x516933[_0x2f73bf(0x257)]('clientip')&&!_0x516933[_0x2f73bf(0x257)](_0x2f73bf(0x229))||!_0x516933[_0x2f73bf(0x257)]('exp'))return{'error':_0x2f73bf(0x23f)};if(!_0x516933[_0x2f73bf(0x257)](_0x2f73bf(0x229))&&_0x516933[_0x2f73bf(0x257)](_0x2f73bf(0x235))){const {clientip:_0x49168c}=_0x516933;return _0x36a143==_0x49168c?{'success':_0x2f73bf(0x2c7)}:{'error':_0x2f73bf(0x2fd)};}else{if(_0x516933[_0x2f73bf(0x257)](_0x2f73bf(0x229))&&_0x516933[_0x2f73bf(0x257)]('clientip')){const {username:_0x291ff9,clientip:_0x153486}=_0x516933;return settings[_0x2f73bf(0x3da)]==_0x291ff9&&_0x36a143==_0x153486?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x249031=>{const _0x270846=_0x14ce44;if(_0x249031){const _0x12b997=devices[_0x249031]['ip'];return jwt[_0x270846(0x313)]({'username':settings[_0x270846(0x3da)],'clientip':_0x12b997},secure[_0x270846(0x38a)]+_0x249031,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x51c7e5=>{const _0x554b86=_0x14ce44;if(_0x51c7e5){const _0x1a7485=devices[_0x51c7e5]['ip'];return jwt[_0x554b86(0x313)]({'clientip':_0x1a7485},secure['secret']+_0x51c7e5,{'expiresIn':devices[_0x51c7e5][_0x554b86(0x2ae)][_0x554b86(0x276)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x5e782d=>{const _0x99f743=_0x14ce44;let _0x1b57d4=![];return devices[_0x5e782d]['telegramIpApproval']&&devices[_0x5e782d][_0x99f743(0x2ae)]['expiry']!=_0x99f743(0x364)&&(_0x1b57d4=devices[_0x5e782d]['telegramIpApproval'][_0x99f743(0x235)]==devices[_0x5e782d]['ip']&&new Date()['getTime']()-devices[_0x5e782d]['telegramIpApproval']['timestamp']<devices[_0x5e782d][_0x99f743(0x2ae)][_0x99f743(0x276)]*0x3c*0x3e8),_0x1b57d4;},telegram2FaApproved=_0x21a5ae=>{const _0x507d41=_0x14ce44;let _0x17a68e=![];return devices[_0x21a5ae][_0x507d41(0x39e)]&&devices[_0x21a5ae][_0x507d41(0x39e)][_0x507d41(0x276)]!='reject'&&(_0x17a68e=devices[_0x21a5ae][_0x507d41(0x39e)][_0x507d41(0x235)]==devices[_0x21a5ae]['ip']&&new Date()['getTime']()-devices[_0x21a5ae][_0x507d41(0x39e)][_0x507d41(0x21f)]<devices[_0x21a5ae][_0x507d41(0x39e)]['expiry']*0x3c*0x3e8),_0x17a68e;},normalizeIP=_0x434dbc=>{const _0x1a1b9f=_0x14ce44;let _0x3f2372=null,_0x39b103=null;if(ipaddr['isValid'](_0x434dbc)){const _0x33f322=ipaddr[_0x1a1b9f(0x208)](_0x434dbc);_0x33f322[_0x1a1b9f(0x3b4)]()==='ipv6'?(_0x33f322[_0x1a1b9f(0x327)]()&&(_0x3f2372=_0x33f322[_0x1a1b9f(0x328)]()[_0x1a1b9f(0x285)]()),_0x39b103=_0x33f322[_0x1a1b9f(0x285)]()):(_0x3f2372=_0x33f322['toString'](),_0x39b103=_0x33f322[_0x1a1b9f(0x2f7)]()['toString']());}return{'show':_0x3f2372?_0x3f2372:_0x39b103,'store':_0x39b103};};function formatDate(_0x39732c){const _0x45c7ab=_0x14ce44;return _0x39732c['getFullYear']()+'/'+(_0x39732c[_0x45c7ab(0x1fe)]()+0x1)['toString']()[_0x45c7ab(0x340)](0x2,'0')+'/'+_0x39732c[_0x45c7ab(0x24e)]()[_0x45c7ab(0x285)]()[_0x45c7ab(0x340)](0x2,'0')+'\x20'+_0x39732c[_0x45c7ab(0x306)]()[_0x45c7ab(0x285)]()['padStart'](0x2,'0')+':'+_0x39732c[_0x45c7ab(0x323)]()[_0x45c7ab(0x285)]()[_0x45c7ab(0x340)](0x2,'0')+':'+_0x39732c['getSeconds']()[_0x45c7ab(0x285)]()[_0x45c7ab(0x340)](0x2,'0');}function sleep(_0x247eec){return new Promise(_0x43a52d=>setTimeout(_0x43a52d,_0x247eec));}