const _0x4614f5=_0x3000;(function(_0x563f58,_0x3dc4b8){const _0x209d5a=_0x3000,_0x40eeb6=_0x563f58();while(!![]){try{const _0x18f4a9=parseInt(_0x209d5a(0x238))/0x1*(parseInt(_0x209d5a(0x250))/0x2)+parseInt(_0x209d5a(0x19c))/0x3+parseInt(_0x209d5a(0x19d))/0x4+parseInt(_0x209d5a(0x264))/0x5+-parseInt(_0x209d5a(0x321))/0x6+parseInt(_0x209d5a(0x1bb))/0x7+-parseInt(_0x209d5a(0x30e))/0x8;if(_0x18f4a9===_0x3dc4b8)break;else _0x40eeb6['push'](_0x40eeb6['shift']());}catch(_0x3cb36c){_0x40eeb6['push'](_0x40eeb6['shift']());}}}(_0x160c,0xb704f));const _0x3f1dec=function(){let _0x7a6806=!![];return function(_0x31dda8,_0x2425f0){const _0x32310e=_0x7a6806?function(){const _0x4722cf=_0x3000;if(_0x2425f0){const _0x1a4ad2=_0x2425f0[_0x4722cf(0x187)](_0x31dda8,arguments);return _0x2425f0=null,_0x1a4ad2;}}:function(){};return _0x7a6806=![],_0x32310e;};}(),_0x2e0285=_0x3f1dec(this,function(){const _0x59069f=_0x3000;return _0x2e0285[_0x59069f(0x21c)]()[_0x59069f(0x348)](_0x59069f(0x206))[_0x59069f(0x21c)]()[_0x59069f(0x1d6)](_0x2e0285)[_0x59069f(0x348)](_0x59069f(0x206));});_0x2e0285();'use strict';process[_0x4614f5(0x1ab)][_0x4614f5(0x199)]=0x1;const childProcess=require(_0x4614f5(0x29a)),fs=require('fs'),fns=require(_0x4614f5(0x296)),low=require('lowdb'),FileSync=require('lowdb/adapters/FileSync'),path=require('path'),crypto=require('crypto'),forge=require('node-forge'),bcrypt=require(_0x4614f5(0x16e)),jwt=require('jsonwebtoken'),ipaddr=require(_0x4614f5(0x284)),argv=require('yargs/yargs')(process['argv'][_0x4614f5(0x24c)](0x2))[_0x4614f5(0x15a)],uuidRandom=require(_0x4614f5(0x349)),{Telegraf,Markup}=require(_0x4614f5(0x317)),Mixpanel=require(_0x4614f5(0x241)),axios=require(_0x4614f5(0x240)),{GraphQLClient,gql}=require(_0x4614f5(0x32c)),util=require(_0x4614f5(0x283)),fileUpload=require(_0x4614f5(0x202)),{networkInterfaces}=require('os'),JSZip=require(_0x4614f5(0x21f)),PORT=argv[_0x4614f5(0x249)]||_0x4614f5(0x2ad),pattern=/^[0-9]{2,4}$/;!pattern[_0x4614f5(0x21b)](PORT)&&(console[_0x4614f5(0x1fb)](_0x4614f5(0x1f1)+PORT+_0x4614f5(0x329)),process[_0x4614f5(0x1b2)](0x1));const HOST=argv['host']||null,userID=argv[_0x4614f5(0x239)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x4614f5(0x23e)]['node'];let bbpath=_0x4614f5(0x2d9),bbpath2='';const botfile='bot.js',configfile=_0x4614f5(0x153),settingsfile=_0x4614f5(0x2cf),securefile=_0x4614f5(0x2ab),environment=require('./'+bbpath2+_0x4614f5(0x1b7))[_0x4614f5(0x1d2)]||'production',maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x4614f5(0x28d)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x4614f5(0x234)),configpath=userID?bbpath+_0x4614f5(0x2c1)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x4614f5(0x18f),logspath=userID?bbpath+_0x4614f5(0x326)+userID+'/':bbpath+'logs/',zippath=userID?bbpath+_0x4614f5(0x342)+userID+'/':bbpath+_0x4614f5(0x342),loggerfile=fs['createWriteStream'](logspath+'/output-000.log',{'flags':'a'}),temppath=userID?bbpath+'temp/'+userID+'/':bbpath+_0x4614f5(0x18d);!fs[_0x4614f5(0x28d)](configpath)&&fs['mkdirSync'](configpath);function _0x3000(_0x36ab00,_0x53a2b1){const _0x28327e=_0x160c();return _0x3000=function(_0x2e0285,_0x3f1dec){_0x2e0285=_0x2e0285-0x141;let _0x160cad=_0x28327e[_0x2e0285];return _0x160cad;},_0x3000(_0x36ab00,_0x53a2b1);}!fs['existsSync'](configbackuppath)&&fs[_0x4614f5(0x21d)](configbackuppath);!fs[_0x4614f5(0x28d)](logspath)&&fs[_0x4614f5(0x21d)](logspath);!fs[_0x4614f5(0x28d)](zippath)&&fs['mkdirSync'](zippath);!fs[_0x4614f5(0x28d)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x4614f5(0x18c)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x4614f5(0x331),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x4614f5(0x22b)]({'secure':{},'blacklist':[]})[_0x4614f5(0x18c)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x4614f5(0x1bf)](_0x4614f5(0x347),{'host':_0x4614f5(0x24d)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings['telegramToken']&&(settings[_0x4614f5(0x291)]!=''&&settings[_0x4614f5(0x291)]!='***')&&settings[_0x4614f5(0x322)]&&settings[_0x4614f5(0x322)]!='')initTelegram();const parseColor=(_0x4faa5b,_0xb0fed)=>{const _0x3a9d8e=_0x4614f5,_0x491a9e=/#[A-Z]{3}#/g;if(typeof _0x4faa5b==_0x3a9d8e(0x279)){!_0xb0fed?_0x4faa5b=_0x4faa5b[_0x3a9d8e(0x2f4)](_0x491a9e,''):(_0x4faa5b=_0x4faa5b['replace'](/#BLU#/g,_0x3a9d8e(0x1e6)),_0x4faa5b=_0x4faa5b[_0x3a9d8e(0x2f4)](/#RED#/g,_0x3a9d8e(0x183)),_0x4faa5b=_0x4faa5b[_0x3a9d8e(0x2f4)](/#YEL#/g,_0x3a9d8e(0x293)),_0x4faa5b=_0x4faa5b[_0x3a9d8e(0x2f4)](/#MAG#/g,'\x1b[35m'),_0x4faa5b=_0x4faa5b[_0x3a9d8e(0x2f4)](/#CYA#/g,_0x3a9d8e(0x29c)),_0x4faa5b=_0x4faa5b[_0x3a9d8e(0x2f4)](/#RES#/g,_0x3a9d8e(0x221)));;}return _0x4faa5b;},logger={'screen':_0x9b5184=>{const _0x3fad91=_0x4614f5;console[_0x3fad91(0x1fb)](parseColor(_0x9b5184,!![]));},'simple':_0x559f0b=>{const _0xaf2b22=_0x4614f5;console[_0xaf2b22(0x1fb)](parseColor(_0x559f0b,!![])),loggerfile[_0xaf2b22(0x18c)](util[_0xaf2b22(0x213)](parseColor(_0x559f0b,![]))+'\x0a');},'full':async _0x2e2510=>{const _0x1bd02b=_0x4614f5,_0x3b56a9=getTimeStamp()+_0x1bd02b(0x144)+_0x2e2510;console[_0x1bd02b(0x1fb)](parseColor(_0x3b56a9,!![])),loggerfile[_0x1bd02b(0x18c)](util[_0x1bd02b(0x213)](parseColor(_0x3b56a9,![]))+'\x0a');if(tgBot&&settings[_0x1bd02b(0x259)]&&settings[_0x1bd02b(0x258)]!=_0x1bd02b(0x28e))await sendTelegram(settings['telegramChatId'],_0x1bd02b(0x2cb)+parseColor(_0x2e2510,![]));},'debug':async(_0x26fc3a,_0x312500='')=>{const _0xb99cda=_0x4614f5,_0x1215ca=getTimeStamp()+_0xb99cda(0x27f)+_0x26fc3a;if(debugging)console['log'](parseColor(_0x1215ca,!![]));loggerfile['write'](util[_0xb99cda(0x213)](parseColor(_0x1215ca,![]))+'\x0a');if(_0x312500){if(debugging)console[_0xb99cda(0x1fb)](_0x312500);loggerfile[_0xb99cda(0x18c)](util['format'](_0x312500)+'\x0a');}}};let terminating=![];process['on'](_0x4614f5(0x34a),function(_0x574fe7){const _0x7092f0=_0x4614f5;_0x574fe7['toString']()[_0x7092f0(0x24e)](_0x7092f0(0x2f3))?(logger[_0x7092f0(0x17d)]('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x574fe7[_0x7092f0(0x249)]+_0x7092f0(0x1a8)),process[_0x7092f0(0x1ae)]({'terminate':!![]},_0x413881=>{})):logger[_0x7092f0(0x17d)](_0x574fe7);}),process['on'](_0x4614f5(0x1b2),()=>{const _0x3ef998=_0x4614f5;stopAllBots(),process[_0x3ef998(0x1b2)](0x0);}),process['on'](_0x4614f5(0x179),()=>{const _0x251636=_0x4614f5;stopAllBots(),process[_0x251636(0x1b2)](0x0);}),process['on'](_0x4614f5(0x339),()=>{stopAllBots(),process['exit'](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x4614f5(0x1b7))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x4614f5(0x2ca)),app=express(),http=require(_0x4614f5(0x345))[_0x4614f5(0x14d)](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x4614f5(0x203)](_0x4614f5(0x2cd),async(_0x190769,_0x193963)=>{const _0x35e66=_0x4614f5,_0x5811a5=_0x190769['params']['type'],_0x2f65f3=getClientsWithBotID(_0x35e66(0x304)),_0x5e11f6=_0x190769['headers'][_0x35e66(0x2d3)],_0x1e1d97=timelyDecrypt(_0x5e11f6,![]),_0xfcc885=_0x2f65f3[_0x35e66(0x233)](_0x54a86b=>_0x54a86b[_0x35e66(0x2d3)]==_0x1e1d97);if(_0xfcc885){const _0x1084f9=normalizeIP(_0x190769[_0x35e66(0x2e8)][_0x35e66(0x190)])[_0x35e66(0x16b)],_0x1ef36e=_0x190769[_0x35e66(0x34d)][_0x35e66(0x26f)];if(validateAccess(_0x1ef36e,_0x1e1d97,_0x1084f9)['allow'])_0x5811a5=='backup'&&await backupConfigFiles(),await zipFiles(_0x5811a5),_0x193963[_0x35e66(0x2c0)](zippath+(_0x5811a5+_0x35e66(0x1d7)),_0x225bbd=>{const _0x384252=_0x35e66;_0x225bbd&&(logger[_0x384252(0x21e)](_0x384252(0x2ec)+_0x5811a5),logger['simple'](_0x225bbd));});else logger[_0x35e66(0x21e)](_0x35e66(0x271)+_0x5811a5+_0x35e66(0x23f));}else logger[_0x35e66(0x21e)](_0x35e66(0x271)+_0x5811a5+_0x35e66(0x230));}),app[_0x4614f5(0x31e)](_0x4614f5(0x32f),async(_0x27ac09,_0x434ad6)=>{const _0x3a74d6=_0x4614f5,_0x3c097a=getClientsWithBotID(_0x3a74d6(0x304)),_0xa61ecf=_0x27ac09[_0x3a74d6(0x34d)]['uuid'],_0x2a679f=timelyDecrypt(_0xa61ecf,![]),_0x5425f0=_0x3c097a['find'](_0x3465d5=>_0x3465d5[_0x3a74d6(0x2d3)]==_0x2a679f);logger['debug']('Backup\x20file\x20uploaded');if(_0x5425f0){const _0x44b589=normalizeIP(_0x27ac09[_0x3a74d6(0x2e8)]['remoteAddress'])['store'],_0x2080a3=_0x27ac09[_0x3a74d6(0x34d)][_0x3a74d6(0x26f)];if(validateAccess(_0x2080a3,_0x2a679f,_0x44b589)['allow']){if(_0x27ac09[_0x3a74d6(0x31d)]){const _0x42e4ed=_0x27ac09[_0x3a74d6(0x31d)][_0x3a74d6(0x194)];await _0x42e4ed['mv'](temppath+_0x42e4ed[_0x3a74d6(0x142)]),_0x434ad6[_0x3a74d6(0x1ae)]({'status':!![],'message':_0x3a74d6(0x141)});const _0x358e74=getBotsWithMode();_0x358e74[_0x3a74d6(0x2d8)]>0x0?confirmRestore(temppath,_0x42e4ed[_0x3a74d6(0x142)]):unzipFile(temppath,_0x42e4ed[_0x3a74d6(0x142)]);}}else logger[_0x3a74d6(0x21e)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)');}else logger[_0x3a74d6(0x21e)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x4614f5(0x1e4)](express[_0x4614f5(0x215)](path[_0x4614f5(0x1ad)](__dirname,bbpath2,_0x4614f5(0x1da)))),app[_0x4614f5(0x1e4)](express[_0x4614f5(0x215)](path[_0x4614f5(0x1ad)](__dirname,bbpath2,'build'))),app[_0x4614f5(0x203)]('/',function(_0x1538e1,_0x492775){const _0x394fa0=_0x4614f5;_0x492775[_0x394fa0(0x2c4)](path[_0x394fa0(0x1ad)](__dirname,bbpath2,_0x394fa0(0x1da),_0x394fa0(0x29f)));}),app[_0x4614f5(0x203)]('/:bot',function(_0x3e69a8,_0x577cff){const _0x5b44a1=_0x4614f5;_0x577cff[_0x5b44a1(0x2c4)](path[_0x5b44a1(0x1ad)](__dirname,bbpath2,_0x5b44a1(0x2eb),_0x5b44a1(0x29f)));}),app['get'](_0x4614f5(0x146),(_0x500b89,_0x3ec90d)=>{const _0x4347b4=_0x4614f5;_0x3ec90d['sendFile'](path[_0x4347b4(0x1ad)](__dirname,bbpath2,'build',_0x4347b4(0x29f)));}),app[_0x4614f5(0x203)](_0x4614f5(0x2d2),(_0x2ca7cc,_0x2437af)=>{const _0x4a32fd=_0x4614f5;_0x2437af[_0x4a32fd(0x2c4)](path[_0x4a32fd(0x1ad)](__dirname,bbpath2,_0x4a32fd(0x2eb),_0x4a32fd(0x29f)));}),app['get'](_0x4614f5(0x33d),(_0x8edb33,_0x57bee6)=>{const _0x321eb5=_0x4614f5;_0x57bee6[_0x321eb5(0x2c4)](path[_0x321eb5(0x1ad)](__dirname,bbpath2,_0x321eb5(0x2eb),_0x321eb5(0x29f)));}),app['get']('/:bot/history',(_0x1acc17,_0x36320e)=>{const _0x2803ff=_0x4614f5;_0x36320e[_0x2803ff(0x2c4)](path[_0x2803ff(0x1ad)](__dirname,bbpath2,_0x2803ff(0x2eb),_0x2803ff(0x29f)));}),app[_0x4614f5(0x203)](_0x4614f5(0x2ae),(_0x4a4712,_0x2d966d)=>{const _0x1e064e=_0x4614f5;_0x2d966d[_0x1e064e(0x2c4)](path[_0x1e064e(0x1ad)](__dirname,bbpath2,_0x1e064e(0x2eb),_0x1e064e(0x29f)));}),app[_0x4614f5(0x203)](_0x4614f5(0x161),(_0x26426b,_0x3ab313)=>{const _0x4c8538=_0x4614f5;_0x3ab313['sendFile'](path[_0x4c8538(0x1ad)](__dirname,bbpath2,'build',_0x4c8538(0x29f)));});if(HOST)http[_0x4614f5(0x175)](PORT,HOST);else http[_0x4614f5(0x175)](PORT);function _0x160c(){const _0x3fb51d=['Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Idling\x20(','running','bot','match','string','login\x20not\x20required','toIPv4Address','store-configuration','-----------------------------------------------------------------------------------','Telegraf\x20error:',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','new-disabled','getFullYear','cloneDeep','util','ipaddr.js','Unauthorized\x20attempt\x20to\x20store\x20configuration','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','off_','hasOwnProperty','replyWithDocument','\x20only\x0a','Bot\x20Mgr\x20>\x20Toggling\x20','Unauthorized\x20attempt\x20to\x20log\x20out','existsSync','orders','2FA\x20login\x20token\x20generated','debug','telegramToken','started','\x1b[33m','padStart','place-order','date-fns','delete-alerts','Ok,\x20will\x20send\x20alert\x20notifications\x20only','isDirectory','child_process','store-settings','\x1b[36m','isValid','Unauthorized\x20attempt\x20to\x20update\x20bot','index.html','portfolio','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','login2fa_reject_','staging','login\x20token\x20valid','config_alerts','set','show','<b>Balance\x20Bot\x20Status:</b>\x0a','event','login\x20token\x20generated','bb-secure.json','sort','3000','/:bot/configuration','apiKey','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','privateKeyToPem','\x20|\x20user:\x20...','showname','f2aRequired','bbvReceive','marketcapApi','unlinkSync','Enabled\x20','/logs\x20-\x20receive\x20log\x20files\x0a','secret','Logged\x20out\x20user\x20...','async','reason','HTML','showConfig','download','config/','readFileSync','onepagemode','sendFile','[ip-address]','error','reject','getStartingBalances','function','express','Bot\x20Mgr\x20>\x20','then','/download/:type','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','bb-settings.json','\x20|\x20client:\x20...','publicKeyToPem','/:bot/performance','uuid','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','userid','Starting\x20new\x20bot\x20|\x20Bot\x20','updatebotmanager','length','bb/','close','pki','\x20files\x20over\x20Telegram:','loginRequired','emitHistory','generateKeyPair','5\x20min','readdirSync','-config.json','restore_yes_','resetpw_yes','=>\x20Go\x20to\x20#CYA#http://','private','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','socket','Backup\x20file\x20unzipped\x20and\x20stored','toggle','build','Failed\x20to\x20download\x20','binary','Notifications\x20types:\x20','token','Disabled\x20','telegram','Login\x20accepted','address\x20already\x20in\x20use','replace','update','All','restart','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','warning','secure','access','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','type','2FA\x20required','isIPv4MappedAddress','get-logs','getDate','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','data','botmanager','compareSync','Markdown','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','2FA\x20login\x20rejected','#RES#\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','bbvNew','callback','parse','16448864UKSbZD','Telegram\x20error:','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','User\x20has\x20been\x20validated','button','get-portfolio','backup-full','inlineKeyboard','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','telegraf','/enable\x20-\x20enable\x20notifications\x0a','telegramIpApproval','-results.json','/restart\x20-\x20restart\x20bot(s)\x0a','logged\x20out','files','post','push','Invalid\x20authentication\x20token\x20(1)','5573100MmieiK','telegramUsername','storeFiat','decode64','status','logs/','No\x20bots\x20running\x20right\x20now','Error\x20while\x20deleting\x20config\x20files:\x20',',\x20must\x20be\x20a\x204\x20digit\x20number','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','/help\x20-\x20show\x20available\x20commands\x0a','graphql-request','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','kind','/upload-backup','all','0.0.0','Starting\x20Balance\x20Bot\x20reinstallation','Bot\x20Mgr\x20>\x20Stopping\x20','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','disable','#RES#\x20if\x20running\x20locally\x0a','writeFileSync','size','SIGINT','Login\x20rejected','mode','expiry','/:bot/coins','Notifications\x20disabled\x0a','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','any','on_','zip/','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Ok,\x20will\x20send\x20order\x20notifications\x20only','http','Notifications\x20enabled','6b67f3d61ee94b8f5c80b4affef4c4d9','search','uuid-random','uncaughtException','stopped','max','headers','File\x20uploaded','name','cancelLoading',':\x20Bot\x20Mgr\x20>\x20','removeAllListeners','/:bot/portfolio','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','statSync','pidExpireLogin','privateKey','lastmsgemitted','settings.','createServer','accept','Your\x20installation\x20is\x20already\x20up\x20to\x20date',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','Notifications\x20enabled\x0a','message','bb-config.json','Unauthorized\x20attempt\x20to\x20show\x20configuration','once','enabled','botID','Restore\x20process\x20aborted','blacklist','argv','output-000.log','deleteHistoryAlerts','stringify','help','1000','Unauthorized\x20attempt\x20to\x20confirm\x20message','/:bot/support','create','/status\x20-\x20show\x20bot(s)\x20status\x0a','reinstall_yes','bbUsername','username','Deleted\x20Bot\x20','getTime','auto','Restoring\x20bot(s)\x20from\x20backup','store','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','success','bcryptjs','launch','Temporary\x20access\x20rejected','Node.js\x20v','show-config','range','#RES#\x20if\x20running\x20on\x20server','listen','login2fa_','-performance.json','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','SIGTERM','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','temporary\x20access\x20not\x20allowed','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','simple','pidRefreshToken','::ffff:127.0.0.1','sha256','IPv4','All\x20bots','\x1b[31m','Error\x20removing\x20old\x20backup\x20files:','temporary\x20access\x20rejected','from','apply','getSeconds','command','clientip','headless','write','temp/','getUTCHours','backup/','remoteAddress','toggleBotMode','reload','loadAsync','backupfile','telegramEnabled','************','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','disabled','NTBA_FIX_319','Yes','conn','944445ymPhlM','3147704YyxxPq','filter','botname','messages','update_no','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','exchange','reinstall','Bot\x20','logs','config','#RES#','latestversion','startsWith','env','address','join','send','temporary\x20token\x20generated','settings','sortBy','exit','$1_$2_$3','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','bbPassword','version.json','backup','output-002.log','apiSecret','9042950NfScmT','emit','Starting\x20Balance\x20Bot\x20update','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','init','config_all','timestamp','live','enable',')\x20|\x20Bot\x20','editMessageReplyMarkup','update_yes','15\x20min','confirm-message','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','add','file','publicKey','exec','restart_','*$1*','(staging)','Unauthorized\x20attempt\x20to\x20get\x20events','environment','whitelistEnabled','reset-history','Invalid\x20username\x20or\x20IP\x20address','constructor','.zip','127.0.0.1','RSA-OAEP','build2','alerts','tempaccess_15_','inherit','Network\x20Interfaces:','randomFillSync','-events.json','password','Restore\x20backup\x20file\x20','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','use','new','\x1b[34m','\x20minutes','assign','text','restore_no_','reinstall_no','\x20|\x20','forEach','status\x20code\x20401','update-bb','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','Error:\x20Invalid\x20argument\x20','/start','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','output-001.log','keys','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','tempaccess_reject_','telegram2FaApproval','reinstall-bb','code','log','hex','telegrammsg','Unauthorized\x20attempt\x20to\x20get\x20messages','value','Invalid\x20IP\x20address','initclient','express-fileupload','get','logout','referer','(((.+)+)+)+$','\x20-\x20','update-bot','sendPortfolioTelegram','notification','temporaryAccessAllowed','get-messages','hashSync','kill','action','***','\x20>\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','format','allow','static','toggle_','Error\x20sending\x20','getHours','sendMetricsTelegram','BCT','test','toString','mkdirSync','full','jszip','getMonth','\x1b[0m','mtime','invalid\x20credentials','auth','sockets','metrics_','ipv6','family','_nsps','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','defaults','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','manual','remove','split','\x20(2)','Orders','delete-bot','find','clients','ETH','|@|','apiPassword','155hgUroh','user','min','output-003.log','login','endsWith','versions','\x20(1)','axios','mixpanel','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','resetHistory','Notifications\x20disabled','copyFileSync','number','sign','chat','port','randomBytes','backup-files','slice','api-eu.mixpanel.com','includes','reply','15546mFobNz','timeshift','connected','access\x20timeout','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','placeOrder','Password\x20reset\x20rejected','Running\x20#RED#Balance\x20Bot\x20v','telegramEvents','telegramChatId','config_orders','--------------------------------------','lastmsgtelegram','Restore\x20process\x20confirmed','getMinutes','backup-full.zip','storeHeadless','ipc','bot-','Bot\x20Mgr\x20>\x20Starting\x20','680995ZtFXsJ','login\x20required','yes','metrics','Session\x20expired\x20for\x20user\x20...','bots','backup-full@','stop','disconnect','rmSync','resetpw_no','tkn','Invalid\x20authentication\x20token\x20(2)','Unauthorized\x20attempt\x20to\x20download\x20','title'];_0x160c=function(){return _0x3fb51d;};return _0x160c();}const io=require('socket.io')(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x11afc9=_0x4614f5;let _0x173e67=_0x11afc9(0x2c5);const _0x4e33f3=networkInterfaces(),_0x320b17={};for(const _0x432f85 of Object[_0x11afc9(0x1f5)](_0x4e33f3)){for(const _0x486bec of _0x4e33f3[_0x432f85]){if((_0x486bec['family']==_0x11afc9(0x181)||_0x486bec[_0x11afc9(0x228)]==0x4)&&!_0x486bec['internal']){const _0xbb68a5=ipaddr[_0x11afc9(0x30d)](_0x486bec[_0x11afc9(0x1ac)])[_0x11afc9(0x173)]();_0xbb68a5!=_0x11afc9(0x2e6)&&(!_0x320b17[_0x432f85]&&(_0x320b17[_0x432f85]=[]),_0x320b17[_0x432f85][_0x11afc9(0x31f)](_0x486bec[_0x11afc9(0x1ac)]),_0x173e67=_0x486bec[_0x11afc9(0x1ac)]);}}}return{'serverip':_0x173e67,'netinterfaces':_0x320b17};}async function startServer(){const _0x50fafe=_0x4614f5,{serverip:_0x1df440,netinterfaces:_0x3116bb}=getServerIP();logger[_0x50fafe(0x17d)](''),logger['simple'](_0x50fafe(0x27d)),await logger[_0x50fafe(0x21e)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x50fafe(0x309)+(environment==_0x50fafe(0x2a3)?_0x50fafe(0x1d0):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+_0x50fafe(0x336))+(_0x50fafe(0x2e5)+_0x1df440+':'+PORT+_0x50fafe(0x174))),logger[_0x50fafe(0x17d)](_0x50fafe(0x27d));if(config['length']!=0x0)for(const _0x58688d of config){const _0x16cecc=_0x58688d[_0x50fafe(0x33b)]==_0x50fafe(0x169)?'a':'m';if(_0x58688d[_0x50fafe(0x325)]==_0x50fafe(0x156)||_0x58688d['status']==_0x50fafe(0x1e5))await logger['full']('Starting\x20('+_0x16cecc+_0x50fafe(0x1c4)+_0x58688d[_0x50fafe(0x157)]+_0x50fafe(0x1ec)+_0x58688d[_0x50fafe(0x19f)]),startBot([_0x58688d[_0x50fafe(0x157)],userID],{'cwd':bbpath},function(_0x5e0d7c){if(_0x5e0d7c)logger['full'](_0x5e0d7c);});else(_0x58688d['status']==_0x50fafe(0x198)||_0x58688d[_0x50fafe(0x325)]=='new-disabled')&&await logger[_0x50fafe(0x21e)](_0x50fafe(0x275)+_0x16cecc+')\x20\x20\x20|\x20Bot\x20'+_0x58688d['botID']+_0x50fafe(0x1ec)+_0x58688d[_0x50fafe(0x19f)]);}else!newBot&&logger[_0x50fafe(0x17d)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger[_0x50fafe(0x17d)](_0x50fafe(0x27d)),logger['simple'](''),await logger[_0x50fafe(0x290)](_0x50fafe(0x171)+nodeversion),await logger[_0x50fafe(0x290)](_0x50fafe(0x1de),_0x3116bb);}function startSocket(){io['on']('connection',_0x3245c4=>{const _0x32a5cf=_0x3000;let _0x2e5e43,_0x5aa0f9,_0x3dd031,_0x40d5eb,_0x52f8ce;const _0x760559=_0x3245c4['handshake'][_0x32a5cf(0x34d)][_0x32a5cf(0x205)];_0x5aa0f9=_0x760559[_0x32a5cf(0x278)](/bot[0-9]{3}/);if(_0x5aa0f9)_0x3dd031=_0x5aa0f9[0x0][_0x32a5cf(0x278)](/[0-9]{3}/);if(_0x3dd031)_0x2e5e43=_0x3dd031[0x0];else _0x2e5e43=_0x32a5cf(0x304);const _0x44dbcb=_0x3245c4['handshake'][_0x32a5cf(0x224)]['encryptedUuid'];if(!_0x44dbcb)_0x3245c4[_0x32a5cf(0x1bc)]('status',{'publicKey':secure[_0x32a5cf(0x1cc)]});else{_0x40d5eb=timelyDecrypt(_0x44dbcb,![]);if(!_0x40d5eb)_0x3245c4[_0x32a5cf(0x1bc)](_0x32a5cf(0x325),{'publicKey':secure[_0x32a5cf(0x1cc)]});else{_0x52f8ce=normalizeIP(_0x3245c4[_0x32a5cf(0x19b)]['remoteAddress'])[_0x32a5cf(0x16b)];if(!devices[_0x40d5eb])devices[_0x40d5eb]={'uuid':_0x40d5eb,'access':{'token':null}};devices[_0x40d5eb]['ip']=_0x52f8ce;const _0x43a361=addClient(_0x3245c4['id'],_0x40d5eb,_0x2e5e43);setAccess(_0x43a361),emitMessages(),_0x3245c4['on']('login',_0x3ca82f=>{const _0x5ee603=_0x32a5cf,_0x513dbb=timelyDecrypt(_0x3ca82f[_0x5ee603(0x1e1)],!![],_0x5ee603(0x236));if(_0x513dbb){_0x3ca82f={'username':_0x3ca82f['username'],'password':_0x513dbb},devices[_0x40d5eb]['access']=validateCredentials(_0x3ca82f,_0x40d5eb);if(devices[_0x40d5eb][_0x5ee603(0x2fb)][_0x5ee603(0x214)]==![]&&devices[_0x40d5eb][_0x5ee603(0x2fb)]['reason']=='2FA\x20login\x20required')_0x3245c4[_0x5ee603(0x1bc)](_0x5ee603(0x325),{'access':devices[_0x40d5eb]['access']}),loginAccess2FA(_0x40d5eb,_0x52f8ce);else{if(devices[_0x40d5eb]['access'][_0x5ee603(0x214)]==![]&&devices[_0x40d5eb]['access'][_0x5ee603(0x2bd)]==_0x5ee603(0x223))_0x3245c4[_0x5ee603(0x1bc)](_0x5ee603(0x325),{'access':devices[_0x40d5eb][_0x5ee603(0x2fb)]});else devices[_0x40d5eb]['access']['allow']&&devices[_0x40d5eb][_0x5ee603(0x2fb)][_0x5ee603(0x2bd)]==_0x5ee603(0x2aa)&&(getClientsWithUuid(_0x40d5eb)[_0x5ee603(0x1ed)](_0x2b22ea=>{setAccess(_0x2b22ea);}),logger[_0x5ee603(0x290)]('Logged\x20in\x20user\x20...'+_0x40d5eb[_0x5ee603(0x24c)](-0x8)),setTokenRefresh(_0x40d5eb),setSessionTimeout('login',_0x40d5eb));}}else logger[_0x5ee603(0x21e)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x3245c4['on']('reset-password',()=>{resetPassword();}),_0x3245c4['on'](_0x32a5cf(0x26c),_0x3fa177=>{removeClient(_0x3245c4['id']);}),_0x2e5e43=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x5ea71e){const _0x5d833b=_0x4614f5;if(_0x5ea71e!=_0x5d833b(0x304)&&config[_0x5d833b(0x2af)]!=''){if(pid[_0x5ea71e])pid[_0x5ea71e][_0x5d833b(0x1ae)]({'function':_0x5d833b(0x201),'args':null});}_0x5ea71e!=_0x5d833b(0x304)&&broadcastToBots(_0x5d833b(0x269),JSON[_0x5d833b(0x15d)](config));}function reloadBotManager(){const _0x5d19c8=_0x4614f5;getClientsWithBotID(_0x5d19c8(0x304))[_0x5d19c8(0x1ed)](_0x40a57a=>{const _0x5896ba=_0x5d19c8;getSocket(_0x40a57a['id'])[_0x5896ba(0x1bc)](_0x5896ba(0x325),{'access':{'allow':![],'reason':_0x5896ba(0x192),'token':null}});});}function getSocket(_0x2909c9){const _0x117963=_0x4614f5,_0x47b21c=io[_0x117963(0x229)]['get']('/');return _0x47b21c[_0x117963(0x225)][_0x117963(0x203)](_0x2909c9);}function setAccess(_0x4a4c63){const _0x47333a=_0x4614f5,_0x2ed71a=getSocket(_0x4a4c63['id']),_0x798647=_0x4a4c63[_0x47333a(0x2d3)],_0x37df34=_0x4a4c63[_0x47333a(0x277)];devices[_0x798647][_0x47333a(0x2fb)]=validateAccess(devices[_0x798647]['access'][_0x47333a(0x2ef)],_0x798647),logger[_0x47333a(0x290)]('Setting\x20access:\x20'+devices[_0x798647][_0x47333a(0x2fb)]['reason']+_0x47333a(0x2d0)+_0x4a4c63['id']['slice'](-0x8)+_0x47333a(0x2b2)+_0x798647[_0x47333a(0x24c)](-0x8)),_0x2ed71a[_0x47333a(0x1ad)](_0x798647);if(devices[_0x798647][_0x47333a(0x2fb)][_0x47333a(0x214)]){_0x2ed71a[_0x47333a(0x1ad)](_0x37df34);if(_0x37df34==_0x47333a(0x304))initializeSocketBotManager(_0x2ed71a);else initializeSocketBot(_0x2ed71a);initClient(_0x37df34);}devices[_0x798647][_0x47333a(0x2fb)]['token']&&devices[_0x798647]['access']['reason']==_0x47333a(0x1af)&&setSessionTimeout('2FA',_0x798647),devices[_0x798647]['access'][_0x47333a(0x2ef)]&&devices[_0x798647][_0x47333a(0x2fb)]['reason']==_0x47333a(0x28f)&&setSessionTimeout(_0x47333a(0x23c),_0x798647),_0x2ed71a['emit']('status',{'status':_0x4a4c63['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x798647]['access'],'externalip':devices[_0x798647]['ip'],'publicKey':secure[_0x47333a(0x1cc)],'userid':settings[_0x47333a(0x2d5)],'validInstallation':validInstallation}),devices[_0x798647][_0x47333a(0x2fb)][_0x47333a(0x214)]==![]&&devices[_0x798647][_0x47333a(0x2fb)][_0x47333a(0x2bd)]==_0x47333a(0x2fe)&&temporaryAccess2FA(_0x798647,devices[_0x798647]['ip']);}function setSessionTimeout(_0x50c437,_0x516382){const _0x1aa3f2=_0x4614f5;let _0x5cb8d6;if(_0x50c437==_0x1aa3f2(0x23c))_0x5cb8d6=loginExpiry*0x3c*0x3e8;else _0x5cb8d6=devices[_0x516382][_0x1aa3f2(0x319)]['expiry']*0x3c*0x3e8-(new Date()[_0x1aa3f2(0x168)]()-devices[_0x516382][_0x1aa3f2(0x319)]['timestamp']);if(devices[_0x516382]['pidExpireLogin'])clearTimeout(devices[_0x516382]['pidExpireLogin']);devices[_0x516382][_0x1aa3f2(0x149)]=setTimeout(()=>{const _0x2e373b=_0x1aa3f2;if(devices[_0x516382][_0x2e373b(0x17e)])clearTimeout(devices[_0x516382][_0x2e373b(0x17e)]);removeSocketListeners(_0x516382),addBlacklist(_0x516382),devices[_0x516382][_0x2e373b(0x319)]=null,devices[_0x516382][_0x2e373b(0x1f8)]=null,devices[_0x516382][_0x2e373b(0x2fb)][_0x2e373b(0x2ef)]=null,logger['debug'](_0x2e373b(0x268)+_0x516382[_0x2e373b(0x24c)](-0x8)),devices[_0x516382][_0x2e373b(0x2fb)]=validateAccess(devices[_0x516382][_0x2e373b(0x2fb)][_0x2e373b(0x2ef)],_0x516382),!(devices[_0x516382][_0x2e373b(0x2fb)][_0x2e373b(0x214)]&&devices[_0x516382][_0x2e373b(0x2fb)][_0x2e373b(0x2bd)]==_0x2e373b(0x27a))&&(_0x50c437=='login'?io['to'](_0x516382)[_0x2e373b(0x1bc)](_0x2e373b(0x325),{'access':{'allow':![],'reason':_0x2e373b(0x253),'token':null}}):io['to'](_0x516382)[_0x2e373b(0x1bc)](_0x2e373b(0x325),{'access':{'allow':![],'reason':'temporary\x20access\x20timeout','token':null}})),devices[_0x516382][_0x2e373b(0x2fb)]['token']=null;},_0x5cb8d6);}function setTokenRefresh(_0xc2d1ce){const _0x3ffb6c=_0x4614f5;if(devices[_0xc2d1ce][_0x3ffb6c(0x17e)])clearTimeout(devices[_0xc2d1ce]['pidRefreshToken']);devices[_0xc2d1ce][_0x3ffb6c(0x17e)]=setTimeout(()=>{const _0x33fbc7=_0x3ffb6c;getClientsWithUuid(_0xc2d1ce)['length']!=0x0?(devices[_0xc2d1ce][_0x33fbc7(0x2fb)]=refreshToken(_0xc2d1ce),io['to'](_0xc2d1ce)[_0x33fbc7(0x1bc)]('status',{'status':_0x33fbc7(0x252),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xc2d1ce]['access'],'externalip':devices[_0xc2d1ce]['ip'],'publicKey':secure[_0x33fbc7(0x1cc)],'validInstallation':validInstallation}),setTokenRefresh(_0xc2d1ce)):clearTimeout(devices[_0xc2d1ce][_0x33fbc7(0x17e)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x331f31){const _0xfa62e7=_0x4614f5,_0x11e2a0=getClient(_0x331f31['id'])['uuid'];_0x331f31[_0xfa62e7(0x1bc)](_0xfa62e7(0x269),config),_0x331f31[_0xfa62e7(0x1bc)](_0xfa62e7(0x1b0),cleanSettings()),_0x331f31['on']('add-bot',_0x38e187=>{if(validateAccess(_0x38e187,_0x11e2a0)['allow'])addBot();else logger['full']('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x331f31['on'](_0xfa62e7(0x208),(_0x3e6b85,_0x544563)=>{const _0x150159=_0xfa62e7;if(validateAccess(_0x544563,_0x11e2a0)['allow'])toggleBot(_0x3e6b85[_0x150159(0x157)],_0x3e6b85[_0x150159(0x325)],_0x3e6b85[_0x150159(0x1c2)]);else logger[_0x150159(0x21e)](_0x150159(0x29e));}),_0x331f31['on']('toggle-bot-mode',(_0xb6e950,_0x443324)=>{const _0x3fd0c4=_0xfa62e7;if(validateAccess(_0x443324,_0x11e2a0)[_0x3fd0c4(0x214)])toggleBotMode(_0xb6e950);else logger['full'](_0x3fd0c4(0x29e));}),_0x331f31['on'](_0xfa62e7(0x232),(_0x368b0d,_0xc8cf8)=>{const _0xf2ea8a=_0xfa62e7;if(validateAccess(_0xc8cf8,_0x11e2a0)[_0xf2ea8a(0x214)])deleteBot(_0x368b0d);else logger[_0xf2ea8a(0x21e)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x331f31['on'](_0xfa62e7(0x29b),(_0x53cd9e,_0x50c879)=>{const _0x35c556=_0xfa62e7;if(validateAccess(_0x50c879,_0x11e2a0)[_0x35c556(0x214)])storeSettings(_0x53cd9e,!![]);else logger[_0x35c556(0x21e)]('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x331f31['on'](_0xfa62e7(0x1ef),_0x49e89a=>{const _0x37ece4=_0xfa62e7;if(validateAccess(_0x49e89a,_0x11e2a0)[_0x37ece4(0x214)])updateBB(_0x37ece4(0x2f5));else logger[_0x37ece4(0x21e)](_0x37ece4(0x17c));}),_0x331f31['on'](_0xfa62e7(0x1f9),_0xd5d76f=>{const _0xe57223=_0xfa62e7;if(validateAccess(_0xd5d76f,_0x11e2a0)[_0xe57223(0x214)])updateBB('reinstall');else logger[_0xe57223(0x21e)](_0xe57223(0x286));}),_0x331f31['on']('get-backup-files',_0x5ed5c1=>{const _0x3713ab=_0xfa62e7;if(validateAccess(_0x5ed5c1,_0x11e2a0)[_0x3713ab(0x214)]){const _0x272ef7=getClient(_0x331f31['id']);if(_0x272ef7)getBackupFiles(_0x272ef7[_0x3713ab(0x2d3)]);else logger[_0x3713ab(0x21e)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger['full'](_0x3713ab(0x1be));}),_0x331f31['on']('restore-backup-file',(_0x215617,_0x4f2507)=>{const _0x2fcd80=_0xfa62e7;if(validateAccess(_0x4f2507,_0x11e2a0)[_0x2fcd80(0x214)])restoreBackupFile(_0x215617);else logger[_0x2fcd80(0x21e)](_0x2fcd80(0x334));}),_0x331f31['on'](_0xfa62e7(0x20c),_0x4f0e41=>{const _0x2c7a11=_0xfa62e7;if(validateAccess(_0x4f0e41,_0x11e2a0)[_0x2c7a11(0x214)])getMessages();else logger['full'](_0x2c7a11(0x1fe));}),_0x331f31['on'](_0xfa62e7(0x1c8),(_0x1e2130,_0x13bd87)=>{const _0x33ec31=_0xfa62e7;if(validateAccess(_0x13bd87,_0x11e2a0)[_0x33ec31(0x214)])confirmMessage(_0x1e2130);else logger[_0x33ec31(0x21e)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x331f31['on']('logout',_0x5cce6d=>{const _0x218cf8=_0xfa62e7;if(validateAccess(_0x5cce6d,_0x11e2a0)[_0x218cf8(0x214)]){if(devices[_0x11e2a0][_0x218cf8(0x17e)])clearTimeout(devices[_0x11e2a0]['pidRefreshToken']);if(devices[_0x11e2a0][_0x218cf8(0x149)])clearTimeout(devices[_0x11e2a0]['pidExpireLogin']);removeSocketListeners(getClient(_0x331f31['id'])['uuid']),addBlacklist(_0x11e2a0),devices[_0x11e2a0][_0x218cf8(0x319)]=null,devices[_0x11e2a0][_0x218cf8(0x1f8)]=null,devices[_0x11e2a0][_0x218cf8(0x2fb)][_0x218cf8(0x2ef)]=null,logger['debug'](_0x218cf8(0x2bb)+_0x11e2a0[_0x218cf8(0x24c)](-0x8)),io['to'](getClient(_0x331f31['id'])[_0x218cf8(0x2d3)])[_0x218cf8(0x1bc)]('status',{'access':{'allow':![],'reason':_0x218cf8(0x31c),'token':null}});}else logger[_0x218cf8(0x21e)](_0x218cf8(0x28c));});}function initializeSocketBot(_0x49586f){const _0x23c111=_0x4614f5,_0xaad1d5=getClient(_0x49586f['id'])[_0x23c111(0x277)],_0x462cda=getClient(_0x49586f['id'])[_0x23c111(0x2d3)];_0x49586f['on'](_0x23c111(0x300),(_0x445026,_0x3517dc)=>{const _0x1344da=_0x23c111;if(validateAccess(_0x3517dc,_0x462cda)[_0x1344da(0x214)]){if(pid[_0xaad1d5])pid[_0xaad1d5]['send']({'function':_0x1344da(0x2de),'args':_0x445026});}else logger[_0x1344da(0x21e)](_0x1344da(0x1d1));}),_0x49586f['on'](_0x23c111(0x297),(_0x27a772,_0xa29b57)=>{const _0x1ced10=_0x23c111;if(validateAccess(_0xa29b57,_0x462cda)[_0x1ced10(0x214)]){if(pid[_0xaad1d5])pid[_0xaad1d5][_0x1ced10(0x1ae)]({'function':_0x1ced10(0x15c),'args':_0x27a772});}else logger[_0x1ced10(0x21e)](_0x1ced10(0x274));}),_0x49586f['on'](_0x23c111(0x313),(_0x50e0ff,_0x5a2ca6)=>{const _0x4f369e=_0x23c111;if(validateAccess(_0x5a2ca6,_0x462cda)['allow']){if(pid[_0xaad1d5])pid[_0xaad1d5]['send']({'function':'getPortfolio','args':_0x50e0ff});}else logger[_0x4f369e(0x21e)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x49586f['on'](_0x23c111(0x27c),(_0xc7a38a,_0x14ec15)=>{const _0x26a0a0=_0x23c111;if(validateAccess(_0x14ec15,_0x462cda)[_0x26a0a0(0x214)]){if(pid[_0xaad1d5])pid[_0xaad1d5][_0x26a0a0(0x1ae)]({'function':'storeConfiguration','args':_0xc7a38a});}else logger['full'](_0x26a0a0(0x285));}),_0x49586f['on']('store-headless',(_0x2e1a62,_0x34305b)=>{const _0x324b30=_0x23c111;if(validateAccess(_0x34305b,_0x462cda)[_0x324b30(0x214)]){if(pid[_0xaad1d5])pid[_0xaad1d5][_0x324b30(0x1ae)]({'function':_0x324b30(0x260),'args':_0x2e1a62});}else logger[_0x324b30(0x21e)](_0x324b30(0x16c));}),_0x49586f['on']('store-fiat',(_0x497961,_0x4f2168)=>{const _0x1f3b5d=_0x23c111;if(validateAccess(_0x4f2168,_0x462cda)[_0x1f3b5d(0x214)]){if(pid[_0xaad1d5])pid[_0xaad1d5][_0x1f3b5d(0x1ae)]({'function':_0x1f3b5d(0x323),'args':_0x497961});}else logger[_0x1f3b5d(0x21e)](_0x1f3b5d(0x307));}),_0x49586f['on'](_0x23c111(0x1d4),_0x4c0198=>{const _0x1cd02e=_0x23c111;if(validateAccess(_0x4c0198,_0x462cda)['allow']){if(pid[_0xaad1d5])pid[_0xaad1d5]['send']({'function':_0x1cd02e(0x243),'args':null});}else logger['full'](_0x1cd02e(0x197));}),_0x49586f['on']('get-starting-balances',_0x38467a=>{const _0x295cf0=_0x23c111;if(validateAccess(_0x38467a,_0x462cda)[_0x295cf0(0x214)]){if(pid[_0xaad1d5])pid[_0xaad1d5]['send']({'function':_0x295cf0(0x2c8),'args':null});}else logger[_0x295cf0(0x21e)](_0x295cf0(0x343));}),_0x49586f['on'](_0x23c111(0x295),(_0x48c7e8,_0x35ca26)=>{const _0x273451=_0x23c111;if(validateAccess(_0x35ca26,_0x462cda)[_0x273451(0x214)]){if(pid[_0xaad1d5])pid[_0xaad1d5][_0x273451(0x1ae)]({'function':_0x273451(0x255),'args':_0x48c7e8});}else logger['full'](_0x273451(0x1f3));}),_0x49586f['on']('cancel-loading',_0x471036=>{const _0x52d396=_0x23c111;if(validateAccess(_0x471036,_0x462cda)['allow']){if(pid[_0xaad1d5])pid[_0xaad1d5]['send']({'function':_0x52d396(0x143),'args':null});}else logger[_0x52d396(0x21e)](_0x52d396(0x32a));}),_0x49586f['on'](_0x23c111(0x172),_0x295afb=>{const _0x4c5a2f=_0x23c111;if(validateAccess(_0x295afb,_0x462cda)[_0x4c5a2f(0x214)]){if(pid[_0xaad1d5])pid[_0xaad1d5][_0x4c5a2f(0x1ae)]({'function':_0x4c5a2f(0x2bf),'args':null});}else logger[_0x4c5a2f(0x21e)](_0x4c5a2f(0x154));}),_0x49586f['on']('update-bb',_0x4bd5fb=>{const _0xce79d0=_0x23c111;if(validateAccess(_0x4bd5fb,_0x462cda)[_0xce79d0(0x214)])updateBB(_0xce79d0(0x2f5));else logger[_0xce79d0(0x21e)](_0xce79d0(0x17c));}),_0x49586f['on'](_0x23c111(0x20c),_0x483b10=>{const _0x525d68=_0x23c111;if(validateAccess(_0x483b10,_0x462cda)[_0x525d68(0x214)])getMessages();else logger[_0x525d68(0x21e)](_0x525d68(0x1fe));}),_0x49586f['on']('confirm-message',(_0x15214a,_0xe2c88f)=>{const _0x5a80e9=_0x23c111;if(validateAccess(_0xe2c88f,_0x462cda)[_0x5a80e9(0x214)])confirmMessage(_0x15214a);else logger[_0x5a80e9(0x21e)](_0x5a80e9(0x160));}),_0x49586f['on'](_0x23c111(0x204),_0x2ea909=>{const _0x43bb31=_0x23c111;if(validateAccess(_0x2ea909,_0x462cda)['allow']){if(devices[_0x462cda][_0x43bb31(0x17e)])clearTimeout(devices[_0x462cda][_0x43bb31(0x17e)]);if(devices[_0x462cda]['pidExpireLogin'])clearTimeout(devices[_0x462cda][_0x43bb31(0x149)]);removeSocketListeners(getClient(_0x49586f['id'])[_0x43bb31(0x2d3)]),addBlacklist(_0x462cda),devices[_0x462cda]['telegramIpApproval']=null,devices[_0x462cda][_0x43bb31(0x1f8)]=null,devices[_0x462cda][_0x43bb31(0x2fb)][_0x43bb31(0x2ef)]=null,logger[_0x43bb31(0x290)](_0x43bb31(0x2bb)+_0x462cda[_0x43bb31(0x24c)](-0x8)),io['to'](getClient(_0x49586f['id'])[_0x43bb31(0x2d3)])[_0x43bb31(0x1bc)](_0x43bb31(0x325),{'access':{'allow':![],'reason':_0x43bb31(0x31c),'token':null}});}else logger[_0x43bb31(0x21e)](_0x43bb31(0x28c));});}function removeSocketListeners(_0x165efa){const _0x5b5be5=_0x4614f5;getClientsWithUuid(_0x165efa)[_0x5b5be5(0x1ed)](_0x32796c=>{const _0x36e500=_0x5b5be5;getSocket(_0x32796c['id'])[_0x36e500(0x145)]();});}function cleanSettings(){const _0x37e1b8=_0x4614f5;let _0xd771b0=settings;return settings[_0x37e1b8(0x291)]&&settings[_0x37e1b8(0x291)]!=''&&(_0xd771b0={..._0xd771b0,'telegramToken':'************'}),settings[_0x37e1b8(0x1b6)]&&settings[_0x37e1b8(0x1b6)]!=''&&(_0xd771b0={..._0xd771b0,'bbPassword':_0x37e1b8(0x196)}),settings[_0x37e1b8(0x2b6)]&&settings[_0x37e1b8(0x2b6)]!=''&&(_0xd771b0={..._0xd771b0,'marketcapApi':'************'}),(settings[_0x37e1b8(0x1b6)]&&settings['bbPassword']==_0x37e1b8(0x210)||settings[_0x37e1b8(0x291)]&&settings['telegramToken']==_0x37e1b8(0x210)||settings[_0x37e1b8(0x2b6)]&&settings[_0x37e1b8(0x2b6)]==_0x37e1b8(0x210))&&(_0xd771b0={..._0xd771b0,'restored':{'password':settings[_0x37e1b8(0x1b6)]=='***','telegram':settings[_0x37e1b8(0x291)]==_0x37e1b8(0x210),'marketcap':settings['marketcapApi']=='***'}}),_0xd771b0;}async function updateBB(_0x50e67c){const _0x13f476=_0x4614f5;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x3f30f5=>{const _0x33e120=_0x3000;restartBot(_0x3f30f5[_0x33e120(0x157)]);});if(_0x50e67c==_0x13f476(0x2f5))process[_0x13f476(0x1ae)]({'update':!![],'environment':environment},_0x5ab5e8=>{});else _0x50e67c==_0x13f476(0x1a4)&&process[_0x13f476(0x1ae)]({'reinstall':!![],'environment':environment},_0x37171f=>{});}function startBot(_0x37b0b6,_0x102d2f,_0x44e89a){const _0x470302=_0x4614f5;if(debugging)_0x37b0b6[_0x470302(0x31f)]('-d');if(recreate)_0x37b0b6[_0x470302(0x31f)]('-r');let _0x265922=![];const _0x5774de=_0x37b0b6[0x0];_0x102d2f={..._0x102d2f,'stdio':[_0x470302(0x1dd),'inherit','inherit',_0x470302(0x261)]},pid[_0x5774de]=childProcess['fork'](botfile,_0x37b0b6,_0x102d2f),pid[_0x5774de]['on'](_0x470302(0x152),_0x17ca67=>{const _0x468df6=_0x470302;switch(Object[_0x468df6(0x1f5)](_0x17ca67)[0x0]){case _0x468df6(0x19f):updateBotName(_0x5774de,_0x17ca67[_0x468df6(0x19f)]);break;case _0x468df6(0x2d7):updateBotManager();break;case _0x468df6(0x325):updateStatus(_0x5774de,_0x17ca67[_0x468df6(0x325)]);break;case'live':updateLive(_0x5774de,_0x17ca67[_0x468df6(0x1c2)]);break;case _0x468df6(0x292):updateLive(_0x5774de,_0x17ca67[_0x468df6(0x292)]),io['to'](_0x5774de)[_0x468df6(0x1bc)](_0x468df6(0x325),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x468df6(0x26b):_0x17ca67[_0x468df6(0x26b)]==_0x468df6(0x2f7)&&restartBot(_0x5774de);_0x17ca67[_0x468df6(0x26b)]==_0x468df6(0x20e)&&toggleBot(_0x5774de,_0x468df6(0x198),'stopped');break;case _0x468df6(0x2f1):sendTelegramBot(_0x5774de,_0x17ca67['telegram']);break;case _0x468df6(0x1fd):sendTelegramMsg(_0x17ca67[_0x468df6(0x1fd)]);break;case'function':io['to'](_0x5774de)['emit'](_0x17ca67[_0x468df6(0x2c9)],_0x17ca67['args']);break;}}),pid[_0x5774de]['on'](_0x470302(0x2c6),function(_0x588b16){if(_0x265922)return;_0x265922=!![],_0x44e89a(_0x588b16);}),pid[_0x5774de]['on'](_0x470302(0x1b2),async function(_0x15ad0b){const _0x2ba8c5=_0x470302;if(terminating)return;if(installingUpdate){io[_0x2ba8c5(0x2da)]();return;}if(_0x265922)return;_0x265922=!![],_0x44e89a(null);const _0x370328=dbConfig[_0x2ba8c5(0x203)]('bots')[_0x2ba8c5(0x233)]({'botID':_0x5774de})[_0x2ba8c5(0x1ff)]();_0x370328&&(_0x370328[_0x2ba8c5(0x325)]==_0x2ba8c5(0x156)||_0x370328[_0x2ba8c5(0x325)]==_0x2ba8c5(0x1e5))&&(await sleep(0x3e8),updateLive(_0x5774de,'stopped'),logger[_0x2ba8c5(0x21e)]('Restarting\x20'+botRef(_0x5774de)),startBot([_0x5774de,userID],{'cwd':bbpath},function(_0x5191d6){if(_0x5191d6)logger['full'](_0x5191d6);}));});}function stopBot(_0x2f493b){const _0x1e3a89=_0x4614f5;getClientsWithBotID(_0x2f493b)[_0x1e3a89(0x1ed)](_0x5af155=>{const _0x3a1b68=_0x1e3a89;getSocket(_0x5af155['id'])[_0x3a1b68(0x26c)](!![]),removeClient(_0x5af155['id']);}),pid[_0x2f493b]&&(pid[_0x2f493b][_0x1e3a89(0x20e)](),pid[_0x2f493b]=null);}function stopAllBots(){const _0x888c15=_0x4614f5;terminating=!![];const _0x49f11c=getEnabledBots();_0x49f11c[_0x888c15(0x1ed)](_0x11883c=>{stopBot(_0x11883c['botID']);});}function restartBot(_0x4e2788){const _0x28cb42=_0x4614f5;if(pid[_0x4e2788])pid[_0x4e2788][_0x28cb42(0x20e)]();}function addBot(){const _0x36050f=_0x4614f5;let _0x6ccf6e;for(let _0x2a040b=0x1;_0x2a040b<0x3e9;_0x2a040b++){_0x6ccf6e=_0x2a040b[_0x36050f(0x21c)]()[_0x36050f(0x294)](0x3,'0');let _0x289609=config[_0x36050f(0x233)](_0x20db94=>_0x20db94['botID']==_0x6ccf6e);if(!_0x289609)break;}if(_0x6ccf6e===_0x36050f(0x15f)){logger[_0x36050f(0x21e)](_0x36050f(0x32d));return;}logger[_0x36050f(0x21e)](_0x36050f(0x2d6)+_0x6ccf6e),dbConfig[_0x36050f(0x203)]('bots')['push']({'botID':_0x6ccf6e,'botname':_0x36050f(0x1a5)+_0x6ccf6e,'status':_0x36050f(0x1e5),'live':''})[_0x36050f(0x18c)](),startBot([_0x6ccf6e,userID],{'cwd':bbpath},function(_0x2257fe){const _0x222ebf=_0x36050f;if(_0x2257fe)logger[_0x222ebf(0x21e)](_0x2257fe);}),config=getConfiguration(),io['to'](_0x36050f(0x304))[_0x36050f(0x1bc)]('bots',config),broadcastToBots(_0x36050f(0x269),JSON[_0x36050f(0x15d)](config));}function deleteBot(_0x57b1cd){const _0x375fef=_0x4614f5;getClientsWithBotID(_0x57b1cd)[_0x375fef(0x1ed)](_0x3985f0=>{const _0x74b1c4=_0x375fef;getSocket(_0x3985f0['id'])[_0x74b1c4(0x26c)](!![]),removeClient(_0x3985f0['id']);}),dbConfig[_0x375fef(0x203)](_0x375fef(0x269))[_0x375fef(0x22e)]({'botID':_0x57b1cd})[_0x375fef(0x18c)](),logger['full'](_0x375fef(0x167)+_0x57b1cd),stopBot(_0x57b1cd);try{if(fs[_0x375fef(0x28d)](path[_0x375fef(0x1ad)](configpath,_0x375fef(0x262)+_0x57b1cd+_0x375fef(0x2e2))))fs['unlinkSync'](path[_0x375fef(0x1ad)](configpath,_0x375fef(0x262)+_0x57b1cd+'-config.json'));if(fs[_0x375fef(0x28d)](path[_0x375fef(0x1ad)](configpath,'bot-'+_0x57b1cd+_0x375fef(0x1e0))))fs[_0x375fef(0x2b7)](path[_0x375fef(0x1ad)](configpath,_0x375fef(0x262)+_0x57b1cd+_0x375fef(0x1e0)));if(fs['existsSync'](path['join'](configpath,_0x375fef(0x262)+_0x57b1cd+_0x375fef(0x177))))fs[_0x375fef(0x2b7)](path[_0x375fef(0x1ad)](configpath,'bot-'+_0x57b1cd+_0x375fef(0x177)));if(fs['existsSync'](path[_0x375fef(0x1ad)](configpath,_0x375fef(0x262)+_0x57b1cd+'-results.json')))fs['unlinkSync'](path[_0x375fef(0x1ad)](configpath,_0x375fef(0x262)+_0x57b1cd+_0x375fef(0x31a)));}catch(_0x29e7b0){if(_0x29e7b0)logger[_0x375fef(0x21e)](_0x375fef(0x328),_0x29e7b0);}config=getConfiguration(),io['to'](_0x375fef(0x304))[_0x375fef(0x1bc)](_0x375fef(0x269),config),broadcastToBots(_0x375fef(0x269),JSON[_0x375fef(0x15d)](config));}function toggleBot(_0xcb4a3b,_0x520378,_0x1ae898){const _0x49b2f8=_0x4614f5;dbConfig[_0x49b2f8(0x203)]('bots')[_0x49b2f8(0x233)]({'botID':_0xcb4a3b})[_0x49b2f8(0x1e8)]({'status':_0x520378})[_0x49b2f8(0x1e8)]({'live':_0x1ae898})['write']();const _0x18cbef=botRef(_0xcb4a3b);if(_0x520378==_0x49b2f8(0x156)||_0x520378==_0x49b2f8(0x1e5))logger[_0x49b2f8(0x21e)](_0x49b2f8(0x2b8)+_0x18cbef),startBot([_0xcb4a3b,userID],{'cwd':bbpath},function(_0x5f5dea){const _0x112b5e=_0x49b2f8;if(_0x5f5dea)logger[_0x112b5e(0x21e)](_0x5f5dea);});else(_0x520378=='disabled'||_0x520378==_0x49b2f8(0x280))&&(logger[_0x49b2f8(0x21e)](_0x49b2f8(0x2f0)+_0x18cbef),stopBot(_0xcb4a3b));config=getConfiguration(),io['to'](_0x49b2f8(0x304))[_0x49b2f8(0x1bc)](_0x49b2f8(0x269),config),broadcastToBots(_0x49b2f8(0x269),JSON[_0x49b2f8(0x15d)](config));}function toggleStatus(_0x2d6195){const _0x9d6d57=_0x4614f5;let _0x2a6d8c=dbConfig['get'](_0x9d6d57(0x269))[_0x9d6d57(0x233)]({'botID':_0x2d6195})[_0x9d6d57(0x1ff)](),_0x6290b9;if(_0x2a6d8c[_0x9d6d57(0x325)]===_0x9d6d57(0x156))_0x6290b9='disabled';else{if(_0x2a6d8c[_0x9d6d57(0x325)]===_0x9d6d57(0x1e5))_0x6290b9=_0x9d6d57(0x280);else{if(_0x2a6d8c[_0x9d6d57(0x325)]===_0x9d6d57(0x280))_0x6290b9=_0x9d6d57(0x1e5);else{if(_0x2a6d8c[_0x9d6d57(0x325)]===_0x9d6d57(0x198))_0x6290b9=_0x9d6d57(0x156);}}}return _0x6290b9;}function updateStatus(_0x567255,_0x25e70e){const _0x176e4e=_0x4614f5;dbConfig[_0x176e4e(0x203)](_0x176e4e(0x269))['find']({'botID':_0x567255})['assign']({'status':_0x25e70e})[_0x176e4e(0x18c)](),config=getConfiguration(),io['to'](_0x176e4e(0x304))[_0x176e4e(0x1bc)]('bots',config),broadcastToBots(_0x176e4e(0x269),JSON[_0x176e4e(0x15d)](config));}function updateLive(_0x49ba19,_0x278851){const _0x34e01f=_0x4614f5;dbConfig[_0x34e01f(0x203)](_0x34e01f(0x269))[_0x34e01f(0x233)]({'botID':_0x49ba19})[_0x34e01f(0x1e8)]({'live':_0x278851})[_0x34e01f(0x18c)](),config=getConfiguration(),io['to'](_0x34e01f(0x304))[_0x34e01f(0x1bc)](_0x34e01f(0x269),config),broadcastToBots('bots',JSON[_0x34e01f(0x15d)](config));}function updateBotName(_0x3f9f0b,_0x1dd88c){const _0x2c01d2=_0x4614f5;dbConfig[_0x2c01d2(0x203)](_0x2c01d2(0x269))[_0x2c01d2(0x233)]({'botID':_0x3f9f0b})[_0x2c01d2(0x1e8)]({'botname':_0x1dd88c})[_0x2c01d2(0x18c)](),config=getConfiguration(),io['to']('botmanager')[_0x2c01d2(0x1bc)](_0x2c01d2(0x269),config),broadcastToBots(_0x2c01d2(0x269),JSON[_0x2c01d2(0x15d)](config));}function updateBotManager(){const _0x460741=_0x4614f5;config=getConfiguration(),io['to'](_0x460741(0x304))[_0x460741(0x1bc)](_0x460741(0x269),config),broadcastToBots(_0x460741(0x269),JSON[_0x460741(0x15d)](config));}function toggleBotMode(_0x452892){const _0xe08813=_0x4614f5;if(pid[_0x452892])pid[_0x452892][_0xe08813(0x1ae)]({'function':_0xe08813(0x191),'args':null});else{const _0x54a23e=configpath+_0xe08813(0x262)+_0x452892+_0xe08813(0x2e2),_0x6accbd=fs[_0xe08813(0x2c2)](_0x54a23e),_0x7ca965=JSON[_0xe08813(0x30d)](_0x6accbd),_0x4c40e8=_0x7ca965['bot'][0x0][_0xe08813(0x18b)];_0x7ca965[_0xe08813(0x277)][0x0][_0xe08813(0x18b)]=!_0x4c40e8;const _0x5ce4ba=JSON[_0xe08813(0x15d)](_0x7ca965,null,0x2);fs[_0xe08813(0x337)](_0x54a23e,_0x5ce4ba),config=getConfiguration(),io['to']('botmanager')['emit'](_0xe08813(0x269),config),broadcastToBots(_0xe08813(0x269),JSON['stringify'](config));}}function validateTelegram(_0x1b98f9){const _0x1d06f3=_0x4614f5;if(_0x1b98f9[_0x1d06f3(0x186)]['username']!=settings[_0x1d06f3(0x322)]&&'@'+_0x1b98f9[_0x1d06f3(0x186)]['username']!=settings['telegramUsername']||_0x1b98f9[_0x1d06f3(0x248)]['id']!=settings[_0x1d06f3(0x259)])return sendTelegram(_0x1b98f9[_0x1d06f3(0x248)]['id'],_0x1d06f3(0x273),{'parse_mode':_0x1d06f3(0x2be)}),![];return!![];}function botRef(_0x2e97b3){const _0x223b8c=_0x4614f5,_0x23a5ac=getBotAttributes(_0x2e97b3),_0x37fc0b=_0x23a5ac[_0x223b8c(0x2b3)]?_0x23a5ac[_0x223b8c(0x19f)]:_0x223b8c(0x1a5)+_0x2e97b3;return _0x37fc0b;}async function initTelegram(){const _0x581686=_0x4614f5;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x581686(0x291)]);let _0x332960='You\x20can\x20use\x20the\x20following\x20commands:\x0a';_0x332960+='\x0a',_0x332960+=_0x581686(0x318),_0x332960+='/disable\x20-\x20disable\x20notifications\x0a',_0x332960+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x332960+=_0x581686(0x31b),_0x332960+='/on\x20-\x20start\x20bot(s)\x0a',_0x332960+='/off\x20-\x20stop\x20bot(s)\x0a',_0x332960+=_0x581686(0x2b0),_0x332960+='/names\x20-\x20show\x20bot\x20names\x0a',_0x332960+=_0x581686(0x163),_0x332960+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x332960+=_0x581686(0x2f8),_0x332960+=_0x581686(0x2b9),_0x332960+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0x332960+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x332960+=_0x581686(0x242),_0x332960+=_0x581686(0x32b);let _0x2d18e5=_0x581686(0x22a);_0x2d18e5+='\x0a',_0x2d18e5+=_0x332960,tgBot['catch']((_0x3dfaac,_0x2954dd)=>{const _0x2e72af=_0x581686;logger[_0x2e72af(0x17d)](getTimeStamp()+_0x2e72af(0x150)),logger['debug'](_0x2e72af(0x27e),_0x3dfaac);}),tgBot['use'](async(_0x43ac01,_0x16a22d)=>{const _0x1b4ac7=_0x581686;if(settings[_0x1b4ac7(0x259)]||_0x43ac01[_0x1b4ac7(0x2f5)][_0x1b4ac7(0x152)][_0x1b4ac7(0x1e9)]!=_0x1b4ac7(0x1f2)){if(!validateTelegram(_0x43ac01))return;}_0x16a22d();}),tgBot[_0x581686(0x189)]('start',async _0x56cf0b=>{const _0x1439df=_0x581686;if(_0x56cf0b[_0x1439df(0x186)][_0x1439df(0x166)]==settings['telegramUsername']||'@'+_0x56cf0b[_0x1439df(0x186)]['username']==settings['telegramUsername']){if(!settings['telegramChatId'])updateSetting('telegramChatId',_0x56cf0b['chat']['id']);else{if(!validateTelegram(_0x56cf0b))return;}}else{if(!validateTelegram(_0x56cf0b))return;}updateSetting(_0x1439df(0x195),!![]),await sendTelegram(_0x56cf0b[_0x1439df(0x248)]['id'],_0x2d18e5);}),tgBot[_0x581686(0x189)](_0x581686(0x1c3),async _0x582120=>{const _0x14a4c7=_0x581686;updateSetting(_0x14a4c7(0x195),!![]),await sendTelegram(_0x582120['chat']['id'],_0x14a4c7(0x346));}),tgBot[_0x581686(0x189)](_0x581686(0x335),async _0x210175=>{const _0x2171c7=_0x581686;await sendTelegram(_0x210175[_0x2171c7(0x248)]['id'],_0x2171c7(0x244)),updateSetting('telegramEnabled',![]);}),tgBot[_0x581686(0x189)](_0x581686(0x1a7),async _0x51650f=>{const _0x431f85=_0x581686,_0x5df2b0=Markup[_0x431f85(0x315)]([Markup[_0x431f85(0x312)][_0x431f85(0x30c)](_0x431f85(0x231),_0x431f85(0x25a)),Markup[_0x431f85(0x312)][_0x431f85(0x30c)]('Alerts',_0x431f85(0x2a5)),Markup['button']['callback'](_0x431f85(0x2f6),_0x431f85(0x1c0))]);_0x51650f[_0x431f85(0x24f)](_0x431f85(0x316),_0x5df2b0);}),tgBot['action'](_0x581686(0x25a),async _0x2b3c11=>{const _0x215407=_0x581686;_0x2b3c11[_0x215407(0x1c5)](),updateSetting(_0x215407(0x258),_0x215407(0x28e)),updateSetting(_0x215407(0x195),!![]),await sendTelegram(_0x2b3c11[_0x215407(0x248)]['id'],_0x215407(0x344));}),tgBot[_0x581686(0x20f)](_0x581686(0x2a5),async _0x4ec46f=>{const _0x4bdb3b=_0x581686;_0x4ec46f[_0x4bdb3b(0x1c5)](),updateSetting('telegramEvents',_0x4bdb3b(0x1db)),updateSetting(_0x4bdb3b(0x195),!![]),await sendTelegram(_0x4ec46f[_0x4bdb3b(0x248)]['id'],_0x4bdb3b(0x298));}),tgBot['action'](_0x581686(0x1c0),async _0x376595=>{const _0x2c8fac=_0x581686;_0x376595[_0x2c8fac(0x1c5)](),updateSetting(_0x2c8fac(0x258),_0x2c8fac(0x330)),updateSetting(_0x2c8fac(0x195),!![]),await sendTelegram(_0x376595[_0x2c8fac(0x248)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot[_0x581686(0x189)]('status',async _0x2721e0=>{const _0x16371b=_0x581686,_0x3cd194=getBotsWithMode();let _0x372810=_0x16371b(0x2a8);config[_0x16371b(0x1ed)](_0x1a900a=>{const _0xded3b6=_0x16371b,_0x2e7e84=_0x3cd194[_0xded3b6(0x233)](_0x28197a=>_0x28197a[_0xded3b6(0x157)]==_0x1a900a['botID'])['mode'];_0x372810+=_0xded3b6(0x1a5)+_0x1a900a[_0xded3b6(0x157)]+':\x20'+_0x1a900a[_0xded3b6(0x325)]+'\x20|\x20'+_0x2e7e84+_0xded3b6(0x1ec)+_0x1a900a[_0xded3b6(0x1c2)]+'\x0a';}),_0x372810+='\x0a',_0x372810+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x372810+=!settings[_0x16371b(0x195)]?_0x16371b(0x33e):_0x16371b(0x151),_0x372810+=settings['telegramEnabled']?settings[_0x16371b(0x258)]==_0x16371b(0x330)?_0x16371b(0x147):_0x16371b(0x2ee)+settings['telegramEvents']+_0x16371b(0x28a):'',await sendTelegram(_0x2721e0['chat']['id'],_0x372810,{'parse_mode':_0x16371b(0x2be)});}),tgBot[_0x581686(0x189)](_0x581686(0x2f7),async _0x4d370f=>{const _0x18adca=_0x581686,_0xf880f5=getEnabledBots();if(_0xf880f5['length']==0x0)await sendTelegram(_0x4d370f[_0x18adca(0x248)]['id'],_0x18adca(0x327));else{if(_0xf880f5[_0x18adca(0x2d8)]>0x1)_0xf880f5[_0x18adca(0x31f)]({'botID':'all'});let _0x2348a1=[],_0x546344=[];const _0x5b3a48=_0xf880f5[_0x18adca(0x2d8)]%0x4==0x0||_0xf880f5[_0x18adca(0x2d8)]%0x4==0x3||_0xf880f5[_0x18adca(0x2d8)]%0x3==0x1?0x4:0x3;let _0xc51568=0x0;_0xf880f5['forEach']((_0x4672e6,_0x4746c3)=>{const _0x3791df=_0x18adca;if(_0x4746c3%_0x5b3a48==0x0)_0x546344=[];_0x546344[_0x3791df(0x31f)](Markup[_0x3791df(0x312)][_0x3791df(0x30c)](_0x4672e6[_0x3791df(0x157)]==_0x3791df(0x330)?_0x3791df(0x182):botRef(_0x4672e6['botID']),_0x3791df(0x1ce)+_0x4672e6[_0x3791df(0x157)])),_0x4746c3%_0x5b3a48==0x0&&(_0x2348a1[_0xc51568]=_0x546344,_0xc51568++);});const _0x2ec866=Markup[_0x18adca(0x315)](_0x2348a1);_0x4d370f[_0x18adca(0x24f)](_0x18adca(0x212),_0x2ec866);}}),tgBot[_0x581686(0x20f)](/restart_(.+)/,async _0x88534f=>{const _0x4f921d=_0x581686,_0x3f9567=_0x88534f[_0x4f921d(0x278)][0x1];_0x88534f[_0x4f921d(0x1c5)](),_0x3f9567==_0x4f921d(0x330)?config[_0x4f921d(0x1ed)](_0x3bdce2=>{restartBot(_0x3bdce2['botID']);}):restartBot(_0x3f9567);}),tgBot[_0x581686(0x189)]('on',async _0x4215e0=>{const _0x2c9729=_0x581686,_0x2337fc=getDisabledBots();if(_0x2337fc[_0x2c9729(0x2d8)]==0x0)await sendTelegram(_0x4215e0['chat']['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x2337fc[_0x2c9729(0x2d8)]>0x1)_0x2337fc[_0x2c9729(0x31f)]({'botID':_0x2c9729(0x330)});let _0xf3ce3b=[],_0x12af5b=[];const _0x487610=_0x2337fc['length']%0x4==0x0||_0x2337fc['length']%0x4==0x3||_0x2337fc[_0x2c9729(0x2d8)]%0x3==0x1?0x4:0x3;let _0x4d251e=0x0;_0x2337fc[_0x2c9729(0x1ed)]((_0x475783,_0x45ea3b)=>{const _0x451d45=_0x2c9729;if(_0x45ea3b%_0x487610==0x0)_0x12af5b=[];_0x12af5b[_0x451d45(0x31f)](Markup[_0x451d45(0x312)][_0x451d45(0x30c)](_0x475783['botID']=='all'?_0x451d45(0x182):botRef(_0x475783['botID']),_0x451d45(0x341)+_0x475783[_0x451d45(0x157)])),_0x45ea3b%_0x487610==0x0&&(_0xf3ce3b[_0x4d251e]=_0x12af5b,_0x4d251e++);});const _0x1bf140=Markup['inlineKeyboard'](_0xf3ce3b);_0x4215e0[_0x2c9729(0x24f)](_0x2c9729(0x2d4),_0x1bf140);}}),tgBot[_0x581686(0x20f)](/on_(.+)/,async _0x1914c8=>{const _0x849369=_0x581686,_0x4cbbc6=_0x1914c8['match'][0x1];_0x1914c8[_0x849369(0x1c5)]();if(_0x4cbbc6=='all'){const _0x48269c=getDisabledBots();await sendTelegram(_0x1914c8[_0x849369(0x248)]['id'],'Bot\x20Mgr\x20>\x20Starting\x20all\x20bots'),_0x48269c[_0x849369(0x1ed)](_0x45d138=>{const _0x84e67a=_0x849369;if(_0x45d138[_0x84e67a(0x157)]!=_0x84e67a(0x330))toggleBot(_0x45d138[_0x84e67a(0x157)],toggleStatus(_0x45d138[_0x84e67a(0x157)]),_0x84e67a(0x34b));});}else await sendTelegram(_0x1914c8[_0x849369(0x248)]['id'],_0x849369(0x263)+botRef(_0x4cbbc6)),toggleBot(_0x4cbbc6,toggleStatus(_0x4cbbc6),_0x849369(0x34b));}),tgBot[_0x581686(0x189)]('off',async _0x4b39d7=>{const _0x4db582=_0x581686,_0x2a00d9=getEnabledBots();if(_0x2a00d9[_0x4db582(0x2d8)]==0x0)await sendTelegram(_0x4b39d7['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x2a00d9[_0x4db582(0x2d8)]>0x1)_0x2a00d9[_0x4db582(0x31f)]({'botID':_0x4db582(0x330)});let _0x2e6dcb=[],_0x5a32c1=[];const _0x1e3269=_0x2a00d9[_0x4db582(0x2d8)]%0x4==0x0||_0x2a00d9[_0x4db582(0x2d8)]%0x4==0x3||_0x2a00d9[_0x4db582(0x2d8)]%0x3==0x1?0x4:0x3;let _0x12c783=0x0;_0x2a00d9['forEach']((_0x357146,_0x3a080f)=>{const _0x427681=_0x4db582;if(_0x3a080f%_0x1e3269==0x0)_0x5a32c1=[];_0x5a32c1[_0x427681(0x31f)](Markup[_0x427681(0x312)][_0x427681(0x30c)](_0x357146['botID']==_0x427681(0x330)?'All\x20bots':botRef(_0x357146[_0x427681(0x157)]),_0x427681(0x287)+_0x357146[_0x427681(0x157)])),_0x3a080f%_0x1e3269==0x0&&(_0x2e6dcb[_0x12c783]=_0x5a32c1,_0x12c783++);});const _0x25d5ce=Markup[_0x4db582(0x315)](_0x2e6dcb);_0x4b39d7[_0x4db582(0x24f)]('Which\x20bot\x20do\x20you\x20want\x20to\x20stop?',_0x25d5ce);}}),tgBot[_0x581686(0x20f)](/off_(.+)/,async _0x57b54c=>{const _0x3156ba=_0x581686,_0x2af885=_0x57b54c[_0x3156ba(0x278)][0x1];_0x57b54c[_0x3156ba(0x1c5)]();if(_0x2af885=='all'){const _0x3490dd=getEnabledBots();await sendTelegram(_0x57b54c['chat']['id'],_0x3156ba(0x1b4)),_0x3490dd[_0x3156ba(0x1ed)](_0x127af8=>{const _0x56b2da=_0x3156ba;if(_0x127af8[_0x56b2da(0x157)]!=_0x56b2da(0x330))toggleBot(_0x127af8[_0x56b2da(0x157)],toggleStatus(_0x127af8[_0x56b2da(0x157)]),'stopped');});}else await sendTelegram(_0x57b54c[_0x3156ba(0x248)]['id'],_0x3156ba(0x333)+botRef(_0x2af885)),toggleBot(_0x2af885,toggleStatus(_0x2af885),_0x3156ba(0x34b));}),tgBot[_0x581686(0x189)](_0x581686(0x267),async _0x3ecf4c=>{const _0x1d81da=_0x581686,_0x562195=getEnabledBots();if(_0x562195[_0x1d81da(0x2d8)]==0x0)await sendTelegram(_0x3ecf4c['chat']['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x562195[_0x1d81da(0x2d8)]>0x1){let _0x20e598=[],_0x3a2eb5=[];const _0xf495bc=_0x562195[_0x1d81da(0x2d8)]%0x4==0x0||_0x562195[_0x1d81da(0x2d8)]%0x4==0x3||_0x562195[_0x1d81da(0x2d8)]%0x3==0x1?0x4:0x3;let _0x17f640=0x0;_0x562195[_0x1d81da(0x1ed)]((_0x1d3896,_0x38701d)=>{const _0x2d794c=_0x1d81da;if(_0x38701d%_0xf495bc==0x0)_0x3a2eb5=[];_0x3a2eb5[_0x2d794c(0x31f)](Markup[_0x2d794c(0x312)][_0x2d794c(0x30c)](botRef(_0x1d3896['botID']),_0x2d794c(0x226)+_0x1d3896[_0x2d794c(0x157)])),_0x38701d%_0xf495bc==0x0&&(_0x20e598[_0x17f640]=_0x3a2eb5,_0x17f640++);});const _0x2ec13a=Markup[_0x1d81da(0x315)](_0x20e598);_0x3ecf4c[_0x1d81da(0x24f)](_0x1d81da(0x1b5),_0x2ec13a);}else{const _0x5af4d6=_0x562195[0x0][_0x1d81da(0x157)];if(pid[_0x5af4d6])pid[_0x5af4d6][_0x1d81da(0x1ae)]({'function':_0x1d81da(0x219),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x2302bc=>{const _0x4997b2=_0x581686,_0x3d6ced=_0x2302bc[_0x4997b2(0x278)][0x1];_0x2302bc[_0x4997b2(0x1c5)]();if(pid[_0x3d6ced])pid[_0x3d6ced][_0x4997b2(0x1ae)]({'function':_0x4997b2(0x219),'args':null});}),tgBot[_0x581686(0x189)](_0x581686(0x2a0),async _0x38be1c=>{const _0x1b9197=_0x581686,_0x403865=getEnabledBots();if(_0x403865['length']==0x0)await sendTelegram(_0x38be1c[_0x1b9197(0x248)]['id'],_0x1b9197(0x327));else{if(_0x403865[_0x1b9197(0x2d8)]>0x1){let _0x142977=[],_0x5f381a=[];const _0x527aff=_0x403865[_0x1b9197(0x2d8)]%0x4==0x0||_0x403865[_0x1b9197(0x2d8)]%0x4==0x3||_0x403865[_0x1b9197(0x2d8)]%0x3==0x1?0x4:0x3;let _0x2d48e3=0x0;_0x403865[_0x1b9197(0x1ed)]((_0x11e8e7,_0x3c8627)=>{const _0x5f1cb1=_0x1b9197;if(_0x3c8627%_0x527aff==0x0)_0x5f381a=[];_0x5f381a['push'](Markup[_0x5f1cb1(0x312)]['callback'](botRef(_0x11e8e7['botID']),'portfolio_'+_0x11e8e7['botID'])),_0x3c8627%_0x527aff==0x0&&(_0x142977[_0x2d48e3]=_0x5f381a,_0x2d48e3++);});const _0x53dc63=Markup[_0x1b9197(0x315)](_0x142977);_0x38be1c[_0x1b9197(0x24f)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x53dc63);}else{const _0x3f6167=_0x403865[0x0][_0x1b9197(0x157)];if(pid[_0x3f6167])pid[_0x3f6167][_0x1b9197(0x1ae)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x5ab06e=>{const _0x59f8d3=_0x581686,_0x5b8878=_0x5ab06e['match'][0x1];_0x5ab06e[_0x59f8d3(0x1c5)]();if(pid[_0x5b8878])pid[_0x5b8878][_0x59f8d3(0x1ae)]({'function':_0x59f8d3(0x209),'args':null});}),tgBot[_0x581686(0x189)](_0x581686(0x1a6),async _0x29a1bb=>{const _0x9cc3e5=_0x581686,_0x14aabf=_0x9cc3e5(0x1a6);await zipFiles(_0x14aabf);const _0x54dbca=zippath+(_0x14aabf+_0x9cc3e5(0x1d7));_0x29a1bb[_0x9cc3e5(0x289)]({'source':_0x54dbca})[_0x9cc3e5(0x2cc)](()=>{})['catch'](_0x434a05=>logger[_0x9cc3e5(0x290)](_0x9cc3e5(0x217)+_0x14aabf+_0x9cc3e5(0x2dc),_0x434a05));}),tgBot[_0x581686(0x189)](_0x581686(0x1b8),async _0x417781=>{const _0x56e0a2=_0x581686,_0x410fe7='backup';await backupConfigFiles(),await zipFiles(_0x410fe7);const _0x232834=zippath+(_0x410fe7+_0x56e0a2(0x1d7));_0x417781[_0x56e0a2(0x289)]({'source':_0x232834})[_0x56e0a2(0x2cc)](()=>{})['catch'](_0x2162dc=>logger[_0x56e0a2(0x290)]('Error\x20sending\x20'+_0x410fe7+'\x20files\x20over\x20Telegram:',_0x2162dc));}),tgBot[_0x581686(0x189)]('update',async _0x56cd34=>{const _0x46b8ac=_0x581686;await getMessages();if(!updateAvailable)await sendTelegram(_0x56cd34[_0x46b8ac(0x248)]['id'],_0x46b8ac(0x14f));else{if(!validInstallation)await sendTelegram(_0x56cd34[_0x46b8ac(0x248)]['id'],_0x46b8ac(0x2ce));else{const _0x10985c=Markup[_0x46b8ac(0x315)]([Markup[_0x46b8ac(0x312)]['callback']('Yes',_0x46b8ac(0x1c6)),Markup[_0x46b8ac(0x312)][_0x46b8ac(0x30c)]('No',_0x46b8ac(0x1a1))]);_0x56cd34[_0x46b8ac(0x24f)](_0x46b8ac(0x33f),_0x10985c);}}}),tgBot[_0x581686(0x20f)](/update_(.+)/,async _0x374f99=>{const _0x166741=_0x581686,_0x16e8a9=_0x374f99['match'][0x1];_0x374f99[_0x166741(0x1c5)](),_0x16e8a9==_0x166741(0x266)&&(await sendTelegram(_0x374f99['chat']['id'],_0x166741(0x1bd)),updateBB(_0x166741(0x2f5))),_0x16e8a9=='no'&&await sendTelegram(_0x374f99[_0x166741(0x248)]['id'],_0x166741(0x1f6));}),tgBot[_0x581686(0x189)]('reinstall',async _0x324a24=>{const _0xbecbfe=_0x581686;if(!validInstallation)await sendTelegram(_0x324a24['chat']['id'],_0xbecbfe(0x310));else{const _0x2f2742=Markup[_0xbecbfe(0x315)]([Markup['button'][_0xbecbfe(0x30c)](_0xbecbfe(0x19a),_0xbecbfe(0x164)),Markup[_0xbecbfe(0x312)]['callback']('No',_0xbecbfe(0x1eb))]);_0x324a24['reply'](_0xbecbfe(0x302),_0x2f2742);}}),tgBot[_0x581686(0x20f)](/reinstall_(.+)/,async _0x1e97b9=>{const _0x3e07e9=_0x581686,_0x2f673d=_0x1e97b9[_0x3e07e9(0x278)][0x1];_0x1e97b9[_0x3e07e9(0x1c5)](),_0x2f673d=='yes'&&(await sendTelegram(_0x1e97b9[_0x3e07e9(0x248)]['id'],_0x3e07e9(0x332)),updateBB(_0x3e07e9(0x1a4))),_0x2f673d=='no'&&await sendTelegram(_0x1e97b9['chat']['id'],_0x3e07e9(0x2a1));}),tgBot[_0x581686(0x189)](_0x581686(0x2ea),async _0x3e26fc=>{const _0x3cfcdd=_0x581686,_0x238ac3=getBotsWithMode();if(_0x238ac3[_0x3cfcdd(0x2d8)]==0x0)await sendTelegram(_0x3e26fc[_0x3cfcdd(0x248)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x233649=[],_0x23858f=[];const _0x359fcf=0x2;let _0x4cf238=0x0;_0x238ac3['forEach']((_0x482bb4,_0x25daba)=>{const _0x5e71a4=_0x3cfcdd;if(_0x25daba%_0x359fcf==0x0)_0x23858f=[];_0x23858f['push'](Markup[_0x5e71a4(0x312)]['callback'](botRef(_0x482bb4['botID'])+'\x20('+_0x482bb4[_0x5e71a4(0x33b)]+')',_0x5e71a4(0x216)+_0x482bb4['botID'])),_0x25daba%_0x359fcf==0x0&&(_0x233649[_0x4cf238]=_0x23858f,_0x4cf238++);});const _0x402278=Markup[_0x3cfcdd(0x315)](_0x233649);_0x3e26fc[_0x3cfcdd(0x24f)](_0x3cfcdd(0x30a),_0x402278);}}),tgBot['action'](/toggle_(.+)/,async _0x317692=>{const _0x2a2279=_0x581686,_0xfbadb5=_0x317692['match'][0x1];_0x317692[_0x2a2279(0x1c5)]();const _0x598ed1=getBotsWithMode(),_0x3e3365=_0x598ed1[_0x2a2279(0x233)](_0x1a50d0=>_0x1a50d0[_0x2a2279(0x157)]==_0xfbadb5),_0x329baa=_0x3e3365[_0x2a2279(0x33b)]=='auto'?_0x2a2279(0x22d):_0x2a2279(0x169);await sendTelegram(_0x317692[_0x2a2279(0x248)]['id'],_0x2a2279(0x28b)+botRef(_0x3e3365[_0x2a2279(0x157)])+'\x20to\x20'+_0x329baa+'\x20mode'),toggleBotMode(_0xfbadb5);}),tgBot[_0x581686(0x189)]('names',async _0x1967e6=>{const _0x270bea=_0x581686;let _0x2ff80e='';config[_0x270bea(0x1ed)](_0x3d61f4=>{const _0xe25893=_0x270bea;_0x2ff80e+=_0xe25893(0x1a5)+_0x3d61f4[_0xe25893(0x157)]+':\x20'+_0x3d61f4[_0xe25893(0x19f)]+'\x0a';}),await sendTelegram(_0x1967e6['chat']['id'],_0x2ff80e,{'parse_mode':_0x270bea(0x2be)});}),tgBot['command'](_0x581686(0x15e),async _0x258470=>{await sendTelegram(_0x258470['chat']['id'],_0x332960);}),process[_0x581686(0x155)]('SIGINT',()=>tgBot['stop'](_0x581686(0x339))),process['once']('SIGTERM',()=>tgBot[_0x581686(0x26b)](_0x581686(0x179))),tgBot[_0x581686(0x16f)]();}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x18d7ba,_0x3d8533,_0x267c83){const _0x561bce=_0x4614f5;_0x267c83={..._0x267c83,'disable_web_page_preview':!![]};try{await tgBot[_0x561bce(0x2f1)]['sendMessage'](_0x18d7ba,_0x3d8533,_0x267c83);}catch(_0x173530){logger['debug'](_0x561bce(0x30f),_0x173530);}}async function sendTelegramBot(_0x8519d8,_0x1ffdca){const _0x3c6796=_0x4614f5;if(settings[_0x3c6796(0x195)]){if(settings[_0x3c6796(0x258)]==_0x3c6796(0x330)||(_0x1ffdca['type']==_0x3c6796(0x2c6)||_0x1ffdca['type']==_0x3c6796(0x2f9)||_0x1ffdca[_0x3c6796(0x2fd)]==_0x3c6796(0x16d))&&settings[_0x3c6796(0x258)]=='alerts'||_0x1ffdca[_0x3c6796(0x2fd)]=='order'&&settings[_0x3c6796(0x258)]=='orders'){if(tgBot&&settings[_0x3c6796(0x259)]){if(_0x1ffdca[_0x3c6796(0x2b3)])await sendTelegram(settings[_0x3c6796(0x259)],_0x1ffdca['botname']+_0x3c6796(0x211)+_0x1ffdca[_0x3c6796(0x2a9)]);else await sendTelegram(settings[_0x3c6796(0x259)],_0x3c6796(0x1a5)+_0x8519d8+'\x20>\x20'+_0x1ffdca[_0x3c6796(0x2a9)]);}}}}async function sendTelegramMsg(_0x542f9f,_0x24f26a=_0x4614f5(0x2be)){const _0x434957=_0x4614f5;return tgBot&&settings[_0x434957(0x259)]?(await sendTelegram(settings[_0x434957(0x259)],_0x542f9f,{'parse_mode':_0x24f26a}),!![]):![];}function getDeviceWithIp(_0x339128){const _0x2f07ba=_0x4614f5;return devices[_0x2f07ba(0x233)](_0x3a095f=>_0x3a095f['ip']===_0x339128);}async function temporaryAccess2FA(_0x247ed7,_0x4a09e2){const _0x4a88df=_0x4614f5;let _0x35b844=new Date(),_0x30bd0c=![];if(lastIpApproval){if(_0x35b844-lastIpApproval<0x1388)_0x30bd0c=!![];}lastIpApproval=new Date();if(_0x30bd0c)return;if(tgBot&&settings[_0x4a88df(0x259)]){const _0x514a70=uuidRandom();tmpStorage[_0x514a70]={'uuid':_0x247ed7,'externalip':_0x4a09e2};const _0x59b5cf=Markup[_0x4a88df(0x315)]([Markup[_0x4a88df(0x312)][_0x4a88df(0x30c)](_0x4a88df(0x2e0),'tempaccess_5_'+_0x514a70),Markup[_0x4a88df(0x312)][_0x4a88df(0x30c)](_0x4a88df(0x1c7),_0x4a88df(0x1dc)+_0x514a70),Markup[_0x4a88df(0x312)][_0x4a88df(0x30c)]('30\x20min','tempaccess_30_'+_0x514a70),Markup[_0x4a88df(0x312)][_0x4a88df(0x30c)]('reject',_0x4a88df(0x1f7)+_0x514a70)]);await sendTelegram(settings[_0x4a88df(0x259)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x4a09e2)[_0x4a88df(0x2a7)]+'\x20?',_0x59b5cf),tgBot[_0x4a88df(0x20f)](/tempaccess_(.+)_(.+)/,async _0x1cb083=>{const _0xa46169=_0x4a88df,_0x30e2f6=_0x1cb083[_0xa46169(0x278)][0x1],_0x260125=_0x1cb083[_0xa46169(0x278)][0x2],{uuid:_0x368ab2,externalip:_0x37a405}=tmpStorage[_0x260125];delete tmpStorage[_0x260125],_0x1cb083[_0xa46169(0x1c5)](),devices[_0x368ab2]['telegramIpApproval']={'clientip':_0x37a405,'timestamp':new Date()[_0xa46169(0x168)](),'expiry':_0x30e2f6},_0x30e2f6!=_0xa46169(0x2c7)?(await sendTelegram(_0x1cb083['chat']['id'],'Access\x20enabled\x20for\x20'+_0x30e2f6+_0xa46169(0x1e7),{'parse_mode':_0xa46169(0x2be)}),io['to'](_0x368ab2)['emit'](_0xa46169(0x325),{'access':{'allow':![],'reason':_0xa46169(0x192),'token':null}})):(await sendTelegram(_0x1cb083[_0xa46169(0x248)]['id'],_0xa46169(0x170)),io['to'](_0x368ab2)[_0xa46169(0x1bc)]('status',{'access':{'allow':![],'reason':_0xa46169(0x185),'token':null}}));});}}async function loginAccess2FA(_0x4ec048,_0x37f157){const _0x6e0fa=_0x4614f5;if(tgBot&&settings['telegramChatId']){const _0x4425fa=uuidRandom();tmpStorage[_0x4425fa]={'uuid':_0x4ec048,'externalip':_0x37f157};const _0x359971=Markup[_0x6e0fa(0x315)]([Markup['button'][_0x6e0fa(0x30c)](_0x6e0fa(0x14e),_0x6e0fa(0x176)+loginExpiry+'_'+_0x4425fa),Markup[_0x6e0fa(0x312)][_0x6e0fa(0x30c)](_0x6e0fa(0x2c7),_0x6e0fa(0x2a2)+_0x4425fa)]);await sendTelegram(settings[_0x6e0fa(0x259)],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x37f157)[_0x6e0fa(0x2a7)]+'\x20?',_0x359971),tgBot[_0x6e0fa(0x20f)](/login2fa_(.+)_(.+)/,async _0x105592=>{const _0x2b51ed=_0x6e0fa,_0x5bb122=_0x105592[_0x2b51ed(0x278)][0x1],_0x2ff6f5=_0x105592[_0x2b51ed(0x278)][0x2],{uuid:_0x281ad3,externalip:_0x5074af}=tmpStorage[_0x2ff6f5];delete tmpStorage[_0x2ff6f5],_0x105592[_0x2b51ed(0x1c5)](),devices[_0x281ad3][_0x2b51ed(0x1f8)]={'clientip':_0x5074af,'timestamp':new Date()['getTime'](),'expiry':_0x5bb122},_0x5bb122!='reject'?(await sendTelegram(_0x105592[_0x2b51ed(0x248)]['id'],_0x2b51ed(0x2f2),{'parse_mode':_0x2b51ed(0x2be)}),io['to'](_0x281ad3)[_0x2b51ed(0x1bc)]('status',{'access':{'allow':![],'reason':_0x2b51ed(0x192),'token':null}})):(await sendTelegram(_0x105592[_0x2b51ed(0x248)]['id'],_0x2b51ed(0x33a)),io['to'](_0x281ad3)[_0x2b51ed(0x1bc)](_0x2b51ed(0x325),{'access':{'allow':![],'reason':_0x2b51ed(0x308),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x5594fe=_0x4614f5;return dbConfig[_0x5594fe(0x203)](_0x5594fe(0x269))['sortBy']('botID')[_0x5594fe(0x19e)]({'status':_0x5594fe(0x156)})[_0x5594fe(0x1ff)]()||[];}function getDisabledBots(){const _0x2df9e2=_0x4614f5;return dbConfig['get'](_0x2df9e2(0x269))[_0x2df9e2(0x1b1)](_0x2df9e2(0x157))['filter']({'status':_0x2df9e2(0x198)})[_0x2df9e2(0x1ff)]()||[];}function getBotAttributes(_0x1b1559){const _0x1127ee=_0x4614f5;let _0xc91e7d={};const _0x532a2a=configpath+'bot-'+_0x1b1559+_0x1127ee(0x2e2),_0x1b5f3d=fs['existsSync'](_0x532a2a);if(_0x1b5f3d){const _0x4b501d=fs[_0x1127ee(0x2c2)](_0x532a2a);try{const _0x6f3c07=JSON[_0x1127ee(0x30d)](_0x4b501d),_0x57d7d1=_0x6f3c07?_0x6f3c07[_0x1127ee(0x277)][0x0]['headless']:![];_0xc91e7d[_0x1127ee(0x33b)]=_0x57d7d1?_0x1127ee(0x169):_0x1127ee(0x22d),_0xc91e7d[_0x1127ee(0x19f)]=_0x6f3c07?_0x6f3c07[_0x1127ee(0x277)][0x0][_0x1127ee(0x19f)]:'Bot\x20'+_0x1b1559,_0xc91e7d[_0x1127ee(0x2b3)]=_0x6f3c07?_0x6f3c07['bot'][0x0][_0x1127ee(0x2b3)]:![];}catch(_0x3d8904){_0xc91e7d[_0x1127ee(0x33b)]='manual',_0xc91e7d[_0x1127ee(0x19f)]='Bot\x20'+_0x1b1559,_0xc91e7d[_0x1127ee(0x2b3)]=![];}}else _0xc91e7d[_0x1127ee(0x33b)]='manual',_0xc91e7d[_0x1127ee(0x19f)]=_0x1127ee(0x1a5)+_0x1b1559,_0xc91e7d['showname']=![];return _0xc91e7d;}function getBotsWithMode(){const _0x215ac9=_0x4614f5,_0x55ea54=dbConfig[_0x215ac9(0x203)](_0x215ac9(0x269))['sortBy'](_0x215ac9(0x157))[_0x215ac9(0x1ff)]()||[];return _0x55ea54[_0x215ac9(0x1ed)](_0x3e25f4=>{const _0x382464=_0x215ac9;let _0x2d6073=getBotAttributes(_0x3e25f4[_0x382464(0x157)]);_0x3e25f4[_0x382464(0x33b)]=_0x2d6073[_0x382464(0x33b)];}),_0x55ea54;}function getBotExchanges(){const _0x114d0d=_0x4614f5;let _0xddc042=[];const _0x3d5fcb=dbConfig[_0x114d0d(0x203)](_0x114d0d(0x269))[_0x114d0d(0x1b1)](_0x114d0d(0x157))[_0x114d0d(0x1ff)]()||[];_0x3d5fcb[_0x114d0d(0x1ed)](_0x24572a=>{const _0x4903f6=_0x114d0d;if(_0x24572a[_0x4903f6(0x325)]==_0x4903f6(0x156)){const _0x4c7d22=configpath+_0x4903f6(0x262)+_0x24572a[_0x4903f6(0x157)]+_0x4903f6(0x2e2),_0xe205c6=fs[_0x4903f6(0x28d)](_0x4c7d22);let _0x29a179;if(_0xe205c6){const _0x5f32a7=fs[_0x4903f6(0x2c2)](_0x4c7d22);try{const _0x474983=JSON[_0x4903f6(0x30d)](_0x5f32a7);_0x29a179=_0x474983?_0x474983[_0x4903f6(0x277)][0x0][_0x4903f6(0x1a3)]:null;}catch(_0x438c22){}}if(_0x29a179)_0xddc042[_0x4903f6(0x31f)](_0x29a179);}});const _0x2bd3b5=[...new Set(_0xddc042)]['sort']();return _0x2bd3b5;}async function initUser(){const _0x5770eb=_0x4614f5;if(!settings[_0x5770eb(0x2d5)]){const _0x259255=uuidRandom();mixpanel['alias'](_0x259255),updateSetting(_0x5770eb(0x2d5),_0x259255);}}async function initSecure(){const _0x17de9c=_0x4614f5;let _0x51fec8=getSecure();if(!_0x51fec8[_0x17de9c(0x288)](_0x17de9c(0x2ba))){let _0x309c8d=await generateKeys();_0x51fec8[_0x17de9c(0x1cc)]=_0x309c8d[_0x17de9c(0x1cc)],_0x51fec8[_0x17de9c(0x14a)]=_0x309c8d['privateKey'],_0x51fec8[_0x17de9c(0x2ba)]=crypto[_0x17de9c(0x24a)](0x20)[_0x17de9c(0x21c)](_0x17de9c(0x1fc));;storeSecure(_0x51fec8);}}function getSettings(){const _0x583113=_0x4614f5;return dbSettings['get'](_0x583113(0x1b0))['value']()||{};}function getSecure(){const _0x44d12d=_0x4614f5;return dbSecure[_0x44d12d(0x203)](_0x44d12d(0x2fa))[_0x44d12d(0x1ff)]()||{};}function getBlacklist(){const _0x2805ee=_0x4614f5;return dbSecure[_0x2805ee(0x203)](_0x2805ee(0x159))[_0x2805ee(0x1ff)]()||[];}function broadcastToBots(_0x4468f1,_0x1cc97e){config['forEach'](_0x462542=>{const _0x1891a8=_0x3000;if(_0x462542[_0x1891a8(0x325)]==_0x1891a8(0x156)&&_0x462542[_0x1891a8(0x1c2)]==_0x1891a8(0x276)||_0x462542[_0x1891a8(0x325)]==_0x1891a8(0x1e5)&&_0x462542[_0x1891a8(0x1c2)]==_0x1891a8(0x276)){if(pid[_0x462542['botID']])pid[_0x462542[_0x1891a8(0x157)]][_0x1891a8(0x1ae)]({[_0x4468f1]:_0x1cc97e});}});}async function storeSettings(_0x3aac5a,_0x7bce28=![]){const _0x1eaf52=_0x4614f5;_0x3aac5a={...settings,..._0x3aac5a};if(_0x7bce28&&_0x3aac5a[_0x1eaf52(0x1b6)]!=_0x1eaf52(0x196)&&_0x3aac5a[_0x1eaf52(0x1b6)]!='***'&&_0x3aac5a[_0x1eaf52(0x1b6)]!=''){const _0x117c92=decryptRSA(secure[_0x1eaf52(0x14a)],_0x3aac5a['bbPassword'])[_0x1eaf52(0x22f)](_0x1eaf52(0x236))[0x0],_0x58b82f=bcrypt[_0x1eaf52(0x20d)](_0x117c92,saltRounds);_0x3aac5a={..._0x3aac5a,'bbPassword':_0x58b82f};}if(_0x7bce28&&_0x3aac5a[_0x1eaf52(0x291)]!=_0x1eaf52(0x196)&&_0x3aac5a[_0x1eaf52(0x291)]!=_0x1eaf52(0x210)&&_0x3aac5a['telegramToken']!=''){const _0x5f030f=decryptRSA(secure['privateKey'],_0x3aac5a[_0x1eaf52(0x291)])[_0x1eaf52(0x22f)]('|@|')[0x0];_0x3aac5a={..._0x3aac5a,'telegramToken':_0x5f030f};}if(_0x7bce28&&_0x3aac5a[_0x1eaf52(0x2b6)]!='************'&&_0x3aac5a['marketcapApi']!=_0x1eaf52(0x210)&&_0x3aac5a[_0x1eaf52(0x2b6)]!=''){const _0x5d5f2d=decryptRSA(secure[_0x1eaf52(0x14a)],_0x3aac5a[_0x1eaf52(0x2b6)])[_0x1eaf52(0x22f)](_0x1eaf52(0x236))[0x0];_0x3aac5a={..._0x3aac5a,'marketcapApi':_0x5d5f2d};}const _0x20a997=_0x3aac5a[_0x1eaf52(0x291)]!=_0x1eaf52(0x196)&&_0x3aac5a[_0x1eaf52(0x291)]!=settings[_0x1eaf52(0x291)]||_0x3aac5a[_0x1eaf52(0x322)]!=settings['telegramUsername'],_0x15bcb0=_0x3aac5a[_0x1eaf52(0x291)]==''||_0x3aac5a[_0x1eaf52(0x322)]=='',_0x5396c6=_0x3aac5a[_0x1eaf52(0x2b6)]&&_0x3aac5a[_0x1eaf52(0x2b6)]!=_0x1eaf52(0x196)&&_0x3aac5a['marketcapApi']!=settings['marketcapApi'];_0x20a997&&(_0x3aac5a[_0x1eaf52(0x259)]=null,_0x3aac5a[_0x1eaf52(0x258)]=_0x1eaf52(0x330));for(const [_0x225812,_0x56e935]of Object['entries'](_0x3aac5a)){if(_0x225812=='telegramToken'&&_0x56e935==_0x1eaf52(0x196)){_0x3aac5a[_0x1eaf52(0x291)]=settings[_0x1eaf52(0x291)];continue;};if(_0x225812==_0x1eaf52(0x1b6)&&_0x56e935==_0x1eaf52(0x196)){_0x3aac5a[_0x1eaf52(0x1b6)]=settings[_0x1eaf52(0x1b6)];continue;};if(_0x225812==_0x1eaf52(0x2b6)&&_0x56e935==_0x1eaf52(0x196)){_0x3aac5a[_0x1eaf52(0x2b6)]=settings[_0x1eaf52(0x2b6)];continue;};dbSettings[_0x1eaf52(0x2a6)]('settings.'+_0x225812,_0x56e935)[_0x1eaf52(0x18c)]();}settings=_0x3aac5a,io['to'](_0x1eaf52(0x304))[_0x1eaf52(0x1bc)](_0x1eaf52(0x1b0),cleanSettings()),broadcastToBots(_0x1eaf52(0x251),settings['timeshift']),broadcastToBots(_0x1eaf52(0x2c3),settings[_0x1eaf52(0x2c3)]),broadcastToBots(_0x1eaf52(0x2b6),settings[_0x1eaf52(0x2b6)]);if(_0x20a997&&!_0x15bcb0)initTelegram();_0x20a997&&_0x15bcb0&&(updateSetting(_0x1eaf52(0x259),null),disableTelegram()),getAllClients()['forEach'](_0x3cc2cd=>{const _0x203f42=_0x1eaf52;getSocket(_0x3cc2cd['id'])[_0x203f42(0x1bc)](_0x203f42(0x325),{'access':{'allow':![],'reason':_0x203f42(0x192),'token':null}});}),_0x5396c6&&(await sleep(0xbb8),testMarketcapApi(_0x3aac5a[_0x1eaf52(0x2b6)]));}async function testMarketcapApi(_0x33e51a){const _0x5a4fb1=_0x4614f5,_0x176763=[_0x5a4fb1(0x21a),_0x5a4fb1(0x235)];try{await axios[_0x5a4fb1(0x203)](_0x5a4fb1(0x17a),{'headers':{'X-CMC_PRO_API_KEY':_0x33e51a},'params':{'symbol':_0x176763[_0x5a4fb1(0x21c)]()}});}catch(_0x338352){_0x338352['toString']()[_0x5a4fb1(0x24e)](_0x5a4fb1(0x1ee))?(io['to'](_0x5a4fb1(0x304))['emit'](_0x5a4fb1(0x20a),_0x5a4fb1(0x254)),logger[_0x5a4fb1(0x21e)](_0x5a4fb1(0x254))):(io['to'](_0x5a4fb1(0x304))[_0x5a4fb1(0x1bc)]('notification',_0x5a4fb1(0x1f0)),logger[_0x5a4fb1(0x21e)](_0x5a4fb1(0x1f0)),logger['debug']('Error\x20details:',_0x338352[_0x5a4fb1(0x21c)]()+_0x5a4fb1(0x207)+_0x338352[_0x5a4fb1(0x1fa)]));return;}logger[_0x5a4fb1(0x290)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x23d748,_0x119cc2){const _0x2c5234=_0x4614f5;dbSettings['set'](_0x2c5234(0x14c)+_0x23d748,_0x119cc2)[_0x2c5234(0x18c)](),settings=getSettings(),io['to'](_0x2c5234(0x304))[_0x2c5234(0x1bc)](_0x2c5234(0x1b0),cleanSettings());}function storeSecure(_0x2e4ff7){const _0x3b5e11=_0x4614f5;dbSecure[_0x3b5e11(0x203)]('secure')[_0x3b5e11(0x31f)](_0x2e4ff7)[_0x3b5e11(0x18c)](),secure=_0x2e4ff7;}function addBlacklist(_0xe5eba8){const _0x1d0940=_0x4614f5;cleanBlacklist();let _0x3313f6;devices[_0xe5eba8][_0x1d0940(0x319)]?_0x3313f6=Math[_0x1d0940(0x34c)](devices[_0xe5eba8][_0x1d0940(0x319)][_0x1d0940(0x33c)],loginExpiry):_0x3313f6=loginExpiry,dbSecure[_0x1d0940(0x203)]('blacklist')[_0x1d0940(0x31f)]({'expiry':new Date()['getTime']()+_0x3313f6*0x3c*0x3e8,'token':devices[_0xe5eba8][_0x1d0940(0x2fb)][_0x1d0940(0x2ef)]})[_0x1d0940(0x18c)](),blacklist=dbSecure[_0x1d0940(0x203)](_0x1d0940(0x159))[_0x1d0940(0x1ff)]();}function cleanBlacklist(){const _0x12acfd=_0x4614f5;let _0x369c4e=dbSecure['get']('blacklist')[_0x12acfd(0x282)]()['value'](),_0x42967a=new Date()[_0x12acfd(0x168)]();_0x369c4e[_0x12acfd(0x1ed)](_0x31a659=>{const _0x1ef11a=_0x12acfd;_0x31a659[_0x1ef11a(0x33c)]<_0x42967a&&dbSecure['get']('blacklist')['remove']({'expiry':_0x31a659[_0x1ef11a(0x33c)]})[_0x1ef11a(0x18c)]();});}function initStates(){const _0x298af1=_0x4614f5;let _0x677314=getConfiguration();_0x677314[_0x298af1(0x1ed)](_0x276c8c=>{const _0x2a766c=_0x298af1;_0x276c8c['live']=_0x2a766c(0x34b);}),storeConfiguration(_0x677314);}async function generateKeys(){const _0x7ac4e3=_0x4614f5,_0x1fdb1d=forge[_0x7ac4e3(0x2db)]['rsa'][_0x7ac4e3(0x2df)]({'bits':0x1000,'e':0x10001}),_0x429e46=forge[_0x7ac4e3(0x2db)][_0x7ac4e3(0x2b1)](_0x1fdb1d['privateKey']),_0x37d2ae=forge['pki'][_0x7ac4e3(0x2d1)](_0x1fdb1d[_0x7ac4e3(0x1cc)]);return{'privateKey':_0x429e46,'publicKey':_0x37d2ae};}async function oneTimeMigration(){const _0x1d1106=_0x4614f5;let _0x548cd4=getSettings(),_0x1f7f5f=![];!_0x548cd4[_0x1d1106(0x288)](_0x1d1106(0x25c))&&(_0x548cd4[_0x1d1106(0x25c)]=0x0,_0x1f7f5f=!![]);!_0x548cd4[_0x1d1106(0x288)](_0x1d1106(0x14b))&&(_0x548cd4[_0x1d1106(0x14b)]=0x0,_0x1f7f5f=!![]);!_0x548cd4[_0x1d1106(0x288)](_0x1d1106(0x1a9))&&(_0x548cd4[_0x1d1106(0x1a9)]='0.0.0',_0x1f7f5f=!![]);!_0x548cd4[_0x1d1106(0x288)]('onepagemode')&&(_0x548cd4[_0x1d1106(0x2c3)]=![],_0x1f7f5f=!![]);!_0x548cd4[_0x1d1106(0x288)]('marketcapApi')&&(_0x548cd4['marketcapApi']='',_0x1f7f5f=!![]);if(_0x1f7f5f)storeSettings(_0x548cd4);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x1d1106(0x1ed)](_0x5b98a5=>{const _0x1b0713=_0x1d1106;if(!_0x5b98a5[_0x1b0713(0x299)]()){if(!_0x5b98a5['name'][_0x1b0713(0x1aa)](_0x1b0713(0x26a)))fs[_0x1b0713(0x2b7)](configbackuppath+_0x5b98a5[_0x1b0713(0x142)]);}else fs['rmSync'](configbackuppath+_0x5b98a5[_0x1b0713(0x142)],{'recursive':!![]});});}catch(_0x4d33a1){logger[_0x1d1106(0x290)](_0x1d1106(0x184),_0x4d33a1);}}function storeConfiguration(_0x35c4cf){const _0x41f307=_0x4614f5;dbConfig['get'](_0x41f307(0x269))[_0x41f307(0x22e)]()[_0x41f307(0x18c)](),dbConfig[_0x41f307(0x203)](_0x41f307(0x269))[_0x41f307(0x31f)](..._0x35c4cf)[_0x41f307(0x18c)](),config=_0x35c4cf;}async function resetPassword(){const _0x2dad51=_0x4614f5;if(tgBot&&settings[_0x2dad51(0x259)]){const _0x4c7013=Markup[_0x2dad51(0x315)]([Markup[_0x2dad51(0x312)][_0x2dad51(0x30c)](_0x2dad51(0x266),_0x2dad51(0x2e4)),Markup[_0x2dad51(0x312)][_0x2dad51(0x30c)]('no',_0x2dad51(0x26e))]);await sendTelegram(settings['telegramChatId'],_0x2dad51(0x22c),_0x4c7013),tgBot[_0x2dad51(0x20f)](/resetpw_(.+)/,async _0x1cd549=>{const _0x11579f=_0x2dad51,_0x5a34d4=_0x1cd549[_0x11579f(0x278)][0x1];_0x1cd549['editMessageReplyMarkup']();if(_0x5a34d4!='no'){const _0x51faa9=0xf,_0x49a9f2=_0x11579f(0x1a2),_0x183977=Array[_0x11579f(0x186)](crypto[_0x11579f(0x1df)](new Uint32Array(_0x51faa9)))['map'](_0x3145c9=>_0x49a9f2[_0x3145c9%_0x49a9f2[_0x11579f(0x2d8)]])[_0x11579f(0x1ad)](''),_0x3e0731=bcrypt['hashSync'](_0x183977,saltRounds);storeSettings({'bbPassword':_0x3e0731}),await sendTelegram(_0x1cd549[_0x11579f(0x248)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x183977,{'parse_mode':_0x11579f(0x2be)});}else await sendTelegram(_0x1cd549[_0x11579f(0x248)]['id'],_0x11579f(0x256));});}}async function confirmRestore(_0x3c18cd,_0x331d1f){const _0x23894f=_0x4614f5;io['to'](_0x23894f(0x304))[_0x23894f(0x1bc)]('notification',_0x23894f(0x2fc),'success');if(tgBot&&settings[_0x23894f(0x259)]){const _0x193e05=uuidRandom();tmpStorage[_0x193e05]={'path':_0x3c18cd,'filename':_0x331d1f};const _0x21fc21=Markup[_0x23894f(0x315)]([Markup['button'][_0x23894f(0x30c)](_0x23894f(0x266),_0x23894f(0x2e3)+_0x193e05),Markup[_0x23894f(0x312)]['callback']('no',_0x23894f(0x1ea)+_0x193e05)]);await sendTelegram(settings[_0x23894f(0x259)],_0x23894f(0x1c9),_0x21fc21),tgBot[_0x23894f(0x20f)](/restore_(.+)_(.+)/,async _0x1c3259=>{const _0x2dbd41=_0x23894f,_0x7c1d27=_0x1c3259[_0x2dbd41(0x278)][0x1],_0x22c211=_0x1c3259[_0x2dbd41(0x278)][0x2],{path:_0x61bece,filename:_0x599182}=tmpStorage[_0x22c211];delete tmpStorage[_0x22c211],_0x1c3259[_0x2dbd41(0x1c5)](),_0x7c1d27==_0x2dbd41(0x266)?(logger['debug'](_0x2dbd41(0x25d)),await sendTelegram(_0x1c3259['chat']['id'],_0x2dbd41(0x16a),{'parse_mode':_0x2dbd41(0x2be)}),unzipFile(_0x61bece,_0x599182)):(logger['debug'](_0x2dbd41(0x158)),await sendTelegram(_0x1c3259['chat']['id'],_0x2dbd41(0x158)));});}}function getServerTime(){const _0x14fadd=_0x4614f5,_0x1fed8f=new Date();return _0x1fed8f[_0x14fadd(0x281)]()+'/'+(_0x1fed8f[_0x14fadd(0x220)]()+0x1)[_0x14fadd(0x21c)]()[_0x14fadd(0x294)](0x2,'0')+'/'+_0x1fed8f[_0x14fadd(0x301)]()[_0x14fadd(0x21c)]()[_0x14fadd(0x294)](0x2,'0')+'\x20'+_0x1fed8f[_0x14fadd(0x218)]()[_0x14fadd(0x21c)]()[_0x14fadd(0x294)](0x2,'0')+':'+_0x1fed8f[_0x14fadd(0x25e)]()[_0x14fadd(0x21c)]()[_0x14fadd(0x294)](0x2,'0')+':'+_0x1fed8f[_0x14fadd(0x188)]()[_0x14fadd(0x21c)]()['padStart'](0x2,'0');}function getTimeStamp(){const _0x536c66=_0x4614f5,_0x15da26=shiftedTime();return _0x15da26[_0x536c66(0x281)]()+'/'+(_0x15da26[_0x536c66(0x220)]()+0x1)[_0x536c66(0x21c)]()['padStart'](0x2,'0')+'/'+_0x15da26[_0x536c66(0x301)]()[_0x536c66(0x21c)]()['padStart'](0x2,'0')+'\x20'+_0x15da26[_0x536c66(0x218)]()[_0x536c66(0x21c)]()[_0x536c66(0x294)](0x2,'0')+':'+_0x15da26[_0x536c66(0x25e)]()['toString']()[_0x536c66(0x294)](0x2,'0')+':'+_0x15da26[_0x536c66(0x188)]()[_0x536c66(0x21c)]()[_0x536c66(0x294)](0x2,'0');}function getCleanTimeStamp(){const _0xa316c3=_0x4614f5,_0x1d73a9=shiftedTime();return _0x1d73a9['getFullYear']()+(_0x1d73a9[_0xa316c3(0x220)]()+0x1)[_0xa316c3(0x21c)]()['padStart'](0x2,'0')+_0x1d73a9[_0xa316c3(0x301)]()[_0xa316c3(0x21c)]()[_0xa316c3(0x294)](0x2,'0')+'-'+_0x1d73a9['getHours']()['toString']()[_0xa316c3(0x294)](0x2,'0')+_0x1d73a9[_0xa316c3(0x25e)]()[_0xa316c3(0x21c)]()[_0xa316c3(0x294)](0x2,'0')+_0x1d73a9['getSeconds']()[_0xa316c3(0x21c)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x2271e0=_0x4614f5,_0x132605=new Date();let _0x55b73c=_0x132605;if(settings[_0x2271e0(0x251)]&&settings[_0x2271e0(0x251)]!==0x0)_0x55b73c=fns[_0x2271e0(0x1ca)](_0x132605,{'hours':settings[_0x2271e0(0x251)]});return _0x55b73c;}async function startScheduler(){const _0xb9e047=_0x4614f5,_0x1b3dc5=new Date()[_0xb9e047(0x18e)](),_0x5ac8e5=shiftedTime()[_0xb9e047(0x218)]();_0x5ac8e5==0x4&&backupConfigFiles(),_0x5ac8e5==0x0&&(rotateLogFiles(),logger[_0xb9e047(0x290)]('--------------------------------------'),logger[_0xb9e047(0x290)](_0xb9e047(0x257)+serverversion+_0xb9e047(0x309)+(environment==_0xb9e047(0x2a3)?'(staging)':'')),logger['debug'](_0xb9e047(0x25b))),_0x1b3dc5%0x6==0x0&&triggerAnalytics(),_0x1b3dc5%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x4f5fd3){const _0x16a850=_0x4614f5;logger[_0x16a850(0x290)](_0x16a850(0x1e2)+_0x4f5fd3);const _0x3b07aa=getBotsWithMode();_0x3b07aa[_0x16a850(0x2d8)]>0x0?confirmRestore(configbackuppath,_0x4f5fd3):unzipFile(configbackuppath,_0x4f5fd3);}async function getBackupFiles(_0x21b8c3=null){const _0x40a5ee=_0x4614f5;let _0x2c66ce=[],_0x13d7b2=fs[_0x40a5ee(0x2e1)](configbackuppath,{'withFileTypes':!![]});_0x13d7b2[_0x40a5ee(0x2ac)]((_0x29146f,_0x134bea)=>_0x29146f[_0x40a5ee(0x142)]<_0x134bea[_0x40a5ee(0x142)]?0x1:_0x134bea[_0x40a5ee(0x142)]<_0x29146f[_0x40a5ee(0x142)]?-0x1:0x0),_0x13d7b2['forEach'](_0xc3cbd=>{const _0x210b0a=_0x40a5ee;if(!_0xc3cbd[_0x210b0a(0x299)]()&&_0xc3cbd[_0x210b0a(0x142)][_0x210b0a(0x1aa)]('backup-full@')&&_0xc3cbd[_0x210b0a(0x142)][_0x210b0a(0x23d)](_0x210b0a(0x1d7))){const _0x2fbc1d=formatDate(fs['statSync'](configbackuppath+_0xc3cbd['name'])[_0x210b0a(0x222)]);_0x2c66ce[_0x210b0a(0x31f)]({'name':_0xc3cbd[_0x210b0a(0x142)],'mtime':_0x2fbc1d});}});if(_0x21b8c3)io['to'](_0x21b8c3)[_0x40a5ee(0x1bc)](_0x40a5ee(0x24b),_0x2c66ce);else return _0x2c66ce;}async function backupConfigFiles(){const _0x5683f7=_0x4614f5;await zipFiles(_0x5683f7(0x314));const _0x1832f9=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x5683f7(0x25f),configbackuppath+(_0x5683f7(0x26a)+_0x1832f9+_0x5683f7(0x1d7)));let _0x57ea02=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x57ea02[_0x5683f7(0x2ac)]((_0x375b95,_0xc7b541)=>_0x375b95['name']<_0xc7b541['name']?0x1:_0xc7b541[_0x5683f7(0x142)]<_0x375b95[_0x5683f7(0x142)]?-0x1:0x0),_0x57ea02[_0x5683f7(0x2d8)]>maxBackups&&fs[_0x5683f7(0x2b7)](configbackuppath+_0x57ea02[_0x57ea02[_0x5683f7(0x2d8)]-0x1][_0x5683f7(0x142)]);}function rotateLogFiles(){const _0x59d73f=_0x4614f5,_0xdf118c=fs[_0x59d73f(0x148)](logspath+_0x59d73f(0x15b)),_0x121ac8=_0xdf118c[_0x59d73f(0x338)]/0x400;if(_0x121ac8>0x64){let _0x57bb46=fs[_0x59d73f(0x2e1)](logspath,{'withFileTypes':!![]});_0x57bb46[_0x59d73f(0x2ac)]((_0x432929,_0x112bac)=>_0x432929[_0x59d73f(0x142)]<_0x112bac['name']?0x1:_0x112bac[_0x59d73f(0x142)]<_0x432929[_0x59d73f(0x142)]?-0x1:0x0),_0x57bb46[_0x59d73f(0x1ed)](_0x13f636=>{const _0x16d2b2=_0x59d73f;if(_0x13f636[_0x16d2b2(0x142)]==_0x16d2b2(0x1b9))fs[_0x16d2b2(0x245)](logspath+_0x13f636[_0x16d2b2(0x142)],logspath+_0x16d2b2(0x23b));if(_0x13f636['name']=='output-001.log')fs['copyFileSync'](logspath+_0x13f636['name'],logspath+_0x16d2b2(0x1b9));_0x13f636[_0x16d2b2(0x142)]=='output-000.log'&&(fs[_0x16d2b2(0x245)](logspath+_0x13f636[_0x16d2b2(0x142)],logspath+_0x16d2b2(0x1f4)),fs[_0x16d2b2(0x337)](logspath+_0x13f636[_0x16d2b2(0x142)],''));});}}async function zipFiles(_0x5ae6e0){const _0x152901=_0x4614f5;let _0x560317;if(_0x5ae6e0==_0x152901(0x1a6))_0x560317=logspath;if(_0x5ae6e0==_0x152901(0x1b8))_0x560317=configpath;if(_0x5ae6e0==_0x152901(0x314))_0x560317=configpath;let _0x28eeed=fs[_0x152901(0x2e1)](_0x560317,{'withFileTypes':!![]});const _0x482d07=new JSZip();_0x28eeed[_0x152901(0x1ed)](_0x4208ea=>{const _0x1d129e=_0x152901;if(!_0x4208ea[_0x1d129e(0x299)]()){let _0x31afce=fs['readFileSync'](_0x560317+_0x4208ea[_0x1d129e(0x142)]);if(_0x5ae6e0==_0x1d129e(0x1b8)){const _0x48e7aa=/^bot-[0-9]{3}-config.json$/,_0x55af67=_0x48e7aa[_0x1d129e(0x21b)](_0x4208ea[_0x1d129e(0x142)]);if(_0x55af67){const _0x152684=JSON[_0x1d129e(0x30d)](_0x31afce);if(_0x152684[_0x1d129e(0x277)][0x0]){_0x152684['bot'][0x0][_0x1d129e(0x2af)]=_0x1d129e(0x210),_0x152684[_0x1d129e(0x277)][0x0][_0x1d129e(0x1ba)]=_0x1d129e(0x210);if(_0x152684[_0x1d129e(0x277)][0x0][_0x1d129e(0x237)])_0x152684[_0x1d129e(0x277)][0x0][_0x1d129e(0x237)]='***';}_0x31afce=JSON[_0x1d129e(0x15d)](_0x152684,null,0x2);}if(_0x4208ea['name']=='bb-settings.json'){const _0x318ee3=JSON[_0x1d129e(0x30d)](_0x31afce);if(_0x318ee3['settings'][_0x1d129e(0x2dd)])_0x318ee3[_0x1d129e(0x1b0)][_0x1d129e(0x2dd)]=![];if(_0x318ee3[_0x1d129e(0x1b0)][_0x1d129e(0x1b6)])_0x318ee3[_0x1d129e(0x1b0)]['bbPassword']=_0x1d129e(0x210);if(_0x318ee3[_0x1d129e(0x1b0)]['telegramToken'])_0x318ee3[_0x1d129e(0x1b0)][_0x1d129e(0x291)]=_0x1d129e(0x210);if(_0x318ee3[_0x1d129e(0x1b0)][_0x1d129e(0x259)])_0x318ee3[_0x1d129e(0x1b0)][_0x1d129e(0x259)]=null;if(_0x318ee3['settings'][_0x1d129e(0x2b6)])_0x318ee3['settings'][_0x1d129e(0x2b6)]=_0x1d129e(0x210);_0x31afce=JSON[_0x1d129e(0x15d)](_0x318ee3,null,0x2);}if(_0x4208ea[_0x1d129e(0x142)]!=_0x1d129e(0x2ab))_0x482d07[_0x1d129e(0x1cb)](_0x4208ea[_0x1d129e(0x142)],_0x31afce);}else _0x482d07['file'](_0x4208ea[_0x1d129e(0x142)],_0x31afce);}});const _0x421918=await _0x482d07['generateAsync']({'type':'string','base64':![],'compression':'DEFLATE'});fs[_0x152901(0x337)](zippath+(_0x5ae6e0+_0x152901(0x1d7)),_0x421918,'binary');}async function unzipFile(_0x3c223c,_0x55fa69){const _0xa68020=_0x4614f5;fs[_0xa68020(0x2e1)](configpath,{'withFileTypes':!![]})['forEach'](_0x13b277=>{const _0x1057b1=_0xa68020;if(!_0x13b277[_0x1057b1(0x299)]())fs['rmSync'](configpath+_0x13b277[_0x1057b1(0x142)]);});const _0x5aad95=fs[_0xa68020(0x2c2)](_0x3c223c+_0x55fa69,_0xa68020(0x2ed)),_0x3d9076=await JSZip[_0xa68020(0x193)](_0x5aad95,{'base64':![],'checkCRC32':!![]});for(const _0x6668f8 of Object['keys'](_0x3d9076[_0xa68020(0x31d)])){const _0x1a8d3a=_0x3d9076['files'][_0x6668f8],_0x490bce=await _0x1a8d3a[_0xa68020(0x2bc)]('string');fs['writeFileSync'](configpath+_0x1a8d3a['name'],_0x490bce);}fs[_0xa68020(0x2e1)](temppath,{'withFileTypes':!![]})[_0xa68020(0x1ed)](_0x28e9b9=>{const _0x1eb03a=_0xa68020;if(!_0x28e9b9[_0x1eb03a(0x299)]())fs[_0x1eb03a(0x26d)](temppath+_0x28e9b9[_0x1eb03a(0x142)]);}),logger[_0xa68020(0x290)](_0xa68020(0x2e9)),process[_0xa68020(0x1ae)]({'restore':!![]},_0x1c2248=>{});}async function getPublicIp(){const _0x542cd0=_0x4614f5;try{const _0x151066=await axios[_0x542cd0(0x203)]('https://api.ipify.org?format=json');publicip=_0x151066[_0x542cd0(0x303)]['ip'];}catch(_0x50d57a){}}async function triggerAnalytics(){const _0x533b01=_0x4614f5;if(!publicip)await getPublicIp();const _0x42468f=getBotsWithMode();let _0x16e435=0x0;_0x42468f['forEach'](_0x10be04=>{const _0x30b371=_0x3000;if(_0x10be04[_0x30b371(0x325)]===_0x30b371(0x156))_0x16e435++;});const _0x2bf9a0=getBotExchanges();mixpanel['track']('Server',{'distinct_id':settings[_0x533b01(0x2d5)],'ip':publicip,'version':serverversion,'numbots':_0x42468f[_0x533b01(0x2d8)],'numbotsenabled':_0x16e435,'exchanges':_0x2bf9a0,'environment':environment});}async function getMessages(){const _0x796ca6=_0x4614f5,_0x4acd57=_0x796ca6(0x2e7),_0x53d04d=new GraphQLClient(_0x4acd57),_0x21e514={'authorization':_0x796ca6(0x1e3)},_0x23df12=serverversion['split']('.'),_0x49485e=_0x23df12[0x0]+'.'+_0x23df12[0x1],_0x130884=Math[_0x796ca6(0x23a)](settings[_0x796ca6(0x25c)],settings[_0x796ca6(0x14b)]),_0x19909e={'last':parseInt(_0x130884),'bbm':_0x49485e},_0xcbb64b=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1dcddd;try{_0x1dcddd=await _0x53d04d['request'](_0xcbb64b,_0x19909e,_0x21e514);}catch(_0x103acc){}if(_0x1dcddd&&_0x1dcddd[_0x796ca6(0x1a0)]){let _0x3a75d1=settings[_0x796ca6(0x25c)],_0x3f68e8=settings[_0x796ca6(0x25c)];newMessages=[];for(const _0x3c850e of _0x1dcddd[_0x796ca6(0x1a0)]){newMessages['push'](_0x3c850e);let _0x397843=![];_0x3c850e['bbvNew']&&(updateSetting(_0x796ca6(0x1a9),_0x3c850e[_0x796ca6(0x30b)]),_0x397843=isNewerVersion(serverversion,_0x3c850e[_0x796ca6(0x30b)])||serverversion==_0x3c850e[_0x796ca6(0x30b)]);if(!_0x397843&&_0x3c850e[_0x796ca6(0x246)]>_0x3a75d1){if(_0x3c850e[_0x796ca6(0x2b5)]===_0x796ca6(0x340)||serverversion[_0x796ca6(0x1aa)](_0x3c850e[_0x796ca6(0x2b5)])){let _0x5b12aa=''+_0x3c850e[_0x796ca6(0x272)]+'\x0a\x0a'+_0x3c850e['message'];const _0x17abc7=await sendTelegramMsg(toTelegramMarkdown(_0x5b12aa),_0x796ca6(0x306));_0x3a75d1=_0x3c850e[_0x796ca6(0x246)];}}_0x3f68e8=_0x3c850e[_0x796ca6(0x246)];}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x796ca6(0x25c),_0x3f68e8),emitMessages();}}function emitMessages(){const _0x5785ed=_0x4614f5,_0x380d3a=settings[_0x5785ed(0x14b)];let _0x45fe50=[];newMessages[_0x5785ed(0x1ed)](_0xc561b4=>{const _0xae72c3=_0x5785ed;_0xc561b4[_0xae72c3(0x246)]>_0x380d3a&&_0x45fe50[_0xae72c3(0x31f)](_0xc561b4);}),_0x45fe50[_0x5785ed(0x2d8)]>0x0&&getAllClients()['forEach'](_0x51eeeb=>{const _0x34f8c4=_0x5785ed;getSocket(_0x51eeeb['id'])[_0x34f8c4(0x1bc)](_0x34f8c4(0x152),_0x45fe50);});}function confirmMessage(_0x30902a){const _0x1133e7=_0x4614f5;updateSetting(_0x1133e7(0x14b),Number(_0x30902a));}function isNewerVersion(_0x84e599,_0x1a11c9){const _0x35951a=_0x4614f5,_0x5df314=_0x1a11c9[_0x35951a(0x22f)]('.'),_0x26b6f9=_0x84e599[_0x35951a(0x22f)]('.');for(var _0x409379=0x0;_0x409379<_0x26b6f9[_0x35951a(0x2d8)];_0x409379++){const _0x307167=~~_0x26b6f9[_0x409379],_0x3021db=~~_0x5df314[_0x409379];if(_0x307167>_0x3021db)return!![];if(_0x307167<_0x3021db)return![];}return![];}function toTelegramMarkdown(_0x5a2a9d){const _0x2571c5=_0x4614f5,_0x4dd1e5=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x338be7=/\*{2}(.+?)\*{2}/gim;return _0x5a2a9d=_0x5a2a9d[_0x2571c5(0x2f4)](_0x4dd1e5,_0x2571c5(0x1b3))[_0x2571c5(0x2f4)](_0x338be7,_0x2571c5(0x1cf)),_0x5a2a9d;}async function validateConfigFile(){const _0x554328=_0x4614f5,_0x24bd5e=dbConfig[_0x554328(0x203)](_0x554328(0x269))[_0x554328(0x1b1)](_0x554328(0x157))[_0x554328(0x1ff)]()||[];if(_0x24bd5e[_0x554328(0x2d8)]==0x0){let _0x423d56=0x0,_0x1c799a=[];const _0x3b4d1=/^bot-([0-9]{3})-config.json$/,_0x41e69a=fs[_0x554328(0x2e1)](configpath);_0x41e69a[_0x554328(0x1ed)](_0x1e3656=>{const _0x177fac=_0x554328,_0x444098=_0x3b4d1[_0x177fac(0x1cd)](_0x1e3656);if(_0x444098){const _0x399c9d=_0x444098[0x1];let _0x525203=getBotAttributes(_0x399c9d);_0x1c799a[_0x177fac(0x31f)]({'botID':_0x399c9d,'botname':_0x525203[_0x177fac(0x19f)],'status':_0x177fac(0x198),'live':_0x177fac(0x34b)}),_0x423d56++;}}),_0x423d56!=0x0&&(dbConfig[_0x554328(0x203)](_0x554328(0x269))[_0x554328(0x1e8)](_0x1c799a)[_0x554328(0x18c)](),config=_0x1c799a,restoredConfigFile=_0x423d56);}}async function restoreConfigNotify(_0x46d129){const _0x1d35cf=_0x4614f5;let _0x10030a;if(restoredConfigFile==0x1)_0x10030a='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x10030a=_0x1d35cf(0x178);if(_0x46d129)io['to']('botmanager')[_0x1d35cf(0x1bc)](_0x1d35cf(0x20a),_0x10030a);else{logger[_0x1d35cf(0x17d)]('-----------------------------------------------------------------------------------'),logger['simple'](_0x10030a),logger[_0x1d35cf(0x17d)](_0x1d35cf(0x27d)),logger[_0x1d35cf(0x17d)]('');if(tgBot&&settings[_0x1d35cf(0x259)]&&settings[_0x1d35cf(0x258)]!=_0x1d35cf(0x28e))await sendTelegram(settings[_0x1d35cf(0x259)],_0x1d35cf(0x2cb)+_0x10030a);}}function decryptRSA(_0x1754aa,_0x239812){const _0x2ea5a1=_0x4614f5,_0x137121=forge[_0x2ea5a1(0x2db)]['privateKeyFromPem'](_0x1754aa),_0x5480d1=_0x137121['decrypt'](forge[_0x2ea5a1(0x283)][_0x2ea5a1(0x324)](_0x239812),_0x2ea5a1(0x1d9),{'md':forge['md'][_0x2ea5a1(0x180)][_0x2ea5a1(0x162)](),'mgf1':{'md':forge['md']['sha256']['create']()}});return _0x5480d1;}function validateCredentials(_0x317654,_0xac5df3){const _0x41472e=_0x4614f5;if(_0x317654[_0x41472e(0x166)]==settings[_0x41472e(0x165)]&&bcrypt[_0x41472e(0x305)](_0x317654['password'],settings[_0x41472e(0x1b6)])){if(settings[_0x41472e(0x2b4)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x2e12f6=generateLoginToken(_0xac5df3);return{'allow':!![],'reason':_0x41472e(0x2aa),'token':_0x2e12f6};}}else return{'allow':![],'reason':_0x41472e(0x223),'token':null};}function refreshToken(_0x602b5c){const _0x41e9b8=_0x4614f5,_0x349a2e=generateLoginToken(_0x602b5c);return{'allow':!![],'reason':_0x41e9b8(0x2aa),'token':_0x349a2e};}function validateAccess(_0x359e94,_0x434a3b,_0xe12207){const _0x5c34de=_0x4614f5,_0x4469fa=_0xe12207?_0xe12207:devices[_0x434a3b]['ip'];let _0x33143f;const _0x58f6d4=_0x236dcd=>{const _0xace66f=_0x3000;if(settings[_0xace66f(0x2dd)]){if(settings[_0xace66f(0x2b4)]){if(telegram2FaApproved(_0x434a3b)){const _0x470978=generateLoginToken(_0x434a3b);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x470978};}else return{'allow':![],'reason':_0xace66f(0x265),'token':null};}else return _0x33143f=validToken(_0x236dcd,_0x434a3b),_0x33143f[_0xace66f(0x288)](_0xace66f(0x16d))?{'allow':!![],'reason':_0xace66f(0x2a4),'token':_0x236dcd}:{'allow':![],'reason':_0xace66f(0x265),'token':null};}else return{'allow':!![],'reason':_0xace66f(0x27a),'token':null};};if(settings[_0x5c34de(0x1d3)]){let _0x3cfc60=[...settings['whitelist'],'::1',_0x5c34de(0x17f),_0x5c34de(0x1d8)];if(_0x3cfc60[_0x5c34de(0x24e)](_0x4469fa))return _0x58f6d4(_0x359e94);else{_0x33143f=validToken(_0x359e94,_0x434a3b);if(_0x33143f[_0x5c34de(0x288)](_0x5c34de(0x16d)))return _0x58f6d4(_0x359e94);else{if(telegramIpApproved(_0x434a3b)){const _0x25574b=generateToken(_0x434a3b);return _0x33143f=_0x58f6d4(_0x359e94),_0x33143f['allow']?{'allow':!![],'reason':_0x5c34de(0x1af),'token':_0x25574b}:_0x33143f;}else return settings[_0x5c34de(0x20b)]?{'allow':![],'reason':_0x5c34de(0x2fe),'token':null}:{'allow':![],'reason':_0x5c34de(0x17b),'token':null};}}}else return _0x58f6d4(_0x359e94);}function timelyDecrypt(_0x3f8e87,_0x29d428,_0x5e6841='@'){const _0x3621a2=_0x4614f5;if(_0x3f8e87)try{const _0x4db5c1=decryptRSA(secure[_0x3621a2(0x14a)],_0x3f8e87),_0x24f6b5=_0x4db5c1[_0x3621a2(0x22f)](_0x5e6841)[0x0],_0x27645f=_0x4db5c1[_0x3621a2(0x22f)](_0x5e6841)[0x1],_0x515c7c=new Date()['getTime']();if(_0x29d428){if(_0x515c7c-_0x27645f<maxSecretAge*0x3e8)return _0x24f6b5;else return![];}else return _0x24f6b5;}catch(_0x2ac116){return![];}else return![];}const validToken=(_0x2eebae,_0xde8869)=>{const _0x1510e7=_0x4614f5,_0x426a11=devices[_0xde8869]['ip'];if(!_0x2eebae)return{'error':'No\x20authentication\x20token'};for(let _0xd29354 of blacklist){if(_0xd29354[_0x1510e7(0x2ef)]==_0x2eebae)return{'error':'Token\x20blacklisted'};}let _0x27ae55;try{_0x27ae55=jwt['verify'](_0x2eebae,secure[_0x1510e7(0x2ba)]+_0xde8869);}catch{return{'error':_0x1510e7(0x320)};}if(!_0x27ae55['hasOwnProperty'](_0x1510e7(0x18a))&&!_0x27ae55['hasOwnProperty'](_0x1510e7(0x166))||!_0x27ae55['hasOwnProperty']('exp'))return{'error':_0x1510e7(0x270)};if(!_0x27ae55[_0x1510e7(0x288)](_0x1510e7(0x166))&&_0x27ae55[_0x1510e7(0x288)]('clientip')){const {clientip:_0x2372e7}=_0x27ae55;return _0x426a11==_0x2372e7?{'success':_0x1510e7(0x311)}:{'error':_0x1510e7(0x200)};}else{if(_0x27ae55[_0x1510e7(0x288)](_0x1510e7(0x166))&&_0x27ae55[_0x1510e7(0x288)](_0x1510e7(0x18a))){const {username:_0x358c48,clientip:_0x5b6f4f}=_0x27ae55;return settings[_0x1510e7(0x165)]==_0x358c48&&_0x426a11==_0x5b6f4f?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x1510e7(0x1d5)};}}},generateLoginToken=_0x48c2fe=>{const _0x2991b1=_0x4614f5;if(_0x48c2fe){const _0x2f4b2b=devices[_0x48c2fe]['ip'];return jwt[_0x2991b1(0x247)]({'username':settings[_0x2991b1(0x165)],'clientip':_0x2f4b2b},secure['secret']+_0x48c2fe,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x52bcf4=>{const _0x191239=_0x4614f5;if(_0x52bcf4){const _0x40fb49=devices[_0x52bcf4]['ip'];return jwt[_0x191239(0x247)]({'clientip':_0x40fb49},secure['secret']+_0x52bcf4,{'expiresIn':devices[_0x52bcf4][_0x191239(0x319)][_0x191239(0x33c)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0xdb509=>{const _0x3c9c14=_0x4614f5;let _0x5d9428=![];return devices[_0xdb509][_0x3c9c14(0x319)]&&devices[_0xdb509][_0x3c9c14(0x319)][_0x3c9c14(0x33c)]!=_0x3c9c14(0x2c7)&&(_0x5d9428=devices[_0xdb509]['telegramIpApproval'][_0x3c9c14(0x18a)]==devices[_0xdb509]['ip']&&new Date()[_0x3c9c14(0x168)]()-devices[_0xdb509]['telegramIpApproval'][_0x3c9c14(0x1c1)]<devices[_0xdb509][_0x3c9c14(0x319)][_0x3c9c14(0x33c)]*0x3c*0x3e8),_0x5d9428;},telegram2FaApproved=_0x134c36=>{const _0x6d0524=_0x4614f5;let _0x1fae0e=![];return devices[_0x134c36][_0x6d0524(0x1f8)]&&devices[_0x134c36][_0x6d0524(0x1f8)][_0x6d0524(0x33c)]!=_0x6d0524(0x2c7)&&(_0x1fae0e=devices[_0x134c36][_0x6d0524(0x1f8)]['clientip']==devices[_0x134c36]['ip']&&new Date()[_0x6d0524(0x168)]()-devices[_0x134c36][_0x6d0524(0x1f8)]['timestamp']<devices[_0x134c36]['telegram2FaApproval'][_0x6d0524(0x33c)]*0x3c*0x3e8),_0x1fae0e;},normalizeIP=_0xd24efe=>{const _0x16c66=_0x4614f5;let _0x24d810=null,_0x1db366=null;if(ipaddr[_0x16c66(0x29d)](_0xd24efe)){const _0x32cd58=ipaddr[_0x16c66(0x30d)](_0xd24efe);_0x32cd58[_0x16c66(0x32e)]()===_0x16c66(0x227)?(_0x32cd58[_0x16c66(0x2ff)]()&&(_0x24d810=_0x32cd58[_0x16c66(0x27b)]()['toString']()),_0x1db366=_0x32cd58[_0x16c66(0x21c)]()):(_0x24d810=_0x32cd58['toString'](),_0x1db366=_0x32cd58['toIPv4MappedAddress']()[_0x16c66(0x21c)]());}return{'show':_0x24d810?_0x24d810:_0x1db366,'store':_0x1db366};};function formatDate(_0x202a3d){const _0x49676e=_0x4614f5;return _0x202a3d['getFullYear']()+'/'+(_0x202a3d[_0x49676e(0x220)]()+0x1)[_0x49676e(0x21c)]()['padStart'](0x2,'0')+'/'+_0x202a3d[_0x49676e(0x301)]()[_0x49676e(0x21c)]()['padStart'](0x2,'0')+'\x20'+_0x202a3d[_0x49676e(0x218)]()['toString']()['padStart'](0x2,'0')+':'+_0x202a3d[_0x49676e(0x25e)]()['toString']()[_0x49676e(0x294)](0x2,'0')+':'+_0x202a3d['getSeconds']()[_0x49676e(0x21c)]()[_0x49676e(0x294)](0x2,'0');}function sleep(_0x3d8555){return new Promise(_0x34b4f4=>setTimeout(_0x34b4f4,_0x3d8555));}