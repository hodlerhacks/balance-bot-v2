const _0x595298=_0xb372;(function(_0x4bc83c,_0x55fa90){const _0x2686c4=_0xb372,_0x166ce0=_0x4bc83c();while(!![]){try{const _0x2669d4=parseInt(_0x2686c4(0x340))/0x1+-parseInt(_0x2686c4(0x2d1))/0x2+parseInt(_0x2686c4(0x15c))/0x3+-parseInt(_0x2686c4(0x2d9))/0x4+-parseInt(_0x2686c4(0x16d))/0x5*(parseInt(_0x2686c4(0x2f1))/0x6)+-parseInt(_0x2686c4(0x23e))/0x7+parseInt(_0x2686c4(0x2a8))/0x8;if(_0x2669d4===_0x55fa90)break;else _0x166ce0['push'](_0x166ce0['shift']());}catch(_0x479ae8){_0x166ce0['push'](_0x166ce0['shift']());}}}(_0x1346,0xcd142));const _0x2fbcaa=function(){let _0x2826d5=!![];return function(_0x5058b6,_0x3c50c7){const _0x426db9=_0x2826d5?function(){const _0x4b13f9=_0xb372;if(_0x3c50c7){const _0x59b366=_0x3c50c7[_0x4b13f9(0x315)](_0x5058b6,arguments);return _0x3c50c7=null,_0x59b366;}}:function(){};return _0x2826d5=![],_0x426db9;};}(),_0x5ee228=_0x2fbcaa(this,function(){const _0x222811=_0xb372;return _0x5ee228[_0x222811(0x31d)]()[_0x222811(0x266)](_0x222811(0x310))['toString']()[_0x222811(0x168)](_0x5ee228)[_0x222811(0x266)]('(((.+)+)+)+$');});_0x5ee228();'use strict';process[_0x595298(0x20d)][_0x595298(0x17d)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x595298(0x1c5)),low=require(_0x595298(0x24c)),FileSync=require(_0x595298(0x279)),path=require(_0x595298(0x2e3)),crypto=require(_0x595298(0x25c)),forge=require(_0x595298(0x31c)),bcrypt=require('bcryptjs'),jwt=require(_0x595298(0x2bc)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process['argv'][_0x595298(0x1ff)](0x2))[_0x595298(0x16c)],uuidRandom=require('uuid-random'),{Telegraf,Markup}=require(_0x595298(0x26a)),Mixpanel=require('mixpanel'),axios=require('axios'),{GraphQLClient,gql}=require(_0x595298(0x27c)),util=require(_0x595298(0x268)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require(_0x595298(0x1c4)),PORT=argv[_0x595298(0x28e)]||_0x595298(0x20c),pattern=/^[0-9]{2,4}$/;!pattern[_0x595298(0x2cf)](PORT)&&(console[_0x595298(0x323)](_0x595298(0x1da)+PORT+_0x595298(0x291)),process[_0x595298(0x30c)](0x1));const HOST=argv[_0x595298(0x281)]||null,userID=argv[_0x595298(0x333)]||'',debugging=argv['d']||![],nodeversion=process[_0x595298(0x2b9)][_0x595298(0x32c)];let bbpath=_0x595298(0x170),bbpath2='';const botfile=_0x595298(0x26d),configfile=_0x595298(0x301),settingsfile='bb-settings.json',securefile=_0x595298(0x197),environment=require('./'+bbpath2+_0x595298(0x164))['environment']||_0x595298(0x1f7),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x595298(0x18b)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x595298(0x209)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x595298(0x324),configbackuppath=configpath+_0x595298(0x299),logspath=userID?bbpath+_0x595298(0x2ec)+userID+'/':bbpath+_0x595298(0x2ec),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+_0x595298(0x1aa),loggerfile=fs[_0x595298(0x28a)](logspath+_0x595298(0x2ca),{'flags':'a'}),temppath=userID?bbpath+_0x595298(0x1bc)+userID+'/':bbpath+_0x595298(0x1bc);!fs[_0x595298(0x18b)](configpath)&&fs[_0x595298(0x169)](configpath);!fs[_0x595298(0x18b)](configbackuppath)&&fs[_0x595298(0x169)](configbackuppath);!fs[_0x595298(0x18b)](logspath)&&fs['mkdirSync'](logspath);!fs['existsSync'](zippath)&&fs['mkdirSync'](zippath);!fs['existsSync'](temppath)&&fs[_0x595298(0x169)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x595298(0x259)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x595298(0x259)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x595298(0x1fd),'onepagemode':![],'marketcapApi':''}})[_0x595298(0x19f)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x595298(0x259)]({'secure':{},'blacklist':[]})[_0x595298(0x19f)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x595298(0x1d3)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x595298(0x346)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x595298(0x25d)]&&(settings[_0x595298(0x25d)]!=''&&settings[_0x595298(0x25d)]!=_0x595298(0x1e7))&&settings[_0x595298(0x141)]&&settings[_0x595298(0x141)]!='')initTelegram();const parseColor=(_0x1d2688,_0x10884c)=>{const _0x3f43d3=_0x595298,_0x4ad681=/#[A-Z]{3}#/g;if(typeof _0x1d2688==_0x3f43d3(0x2ef)){!_0x10884c?_0x1d2688=_0x1d2688['replace'](_0x4ad681,''):(_0x1d2688=_0x1d2688[_0x3f43d3(0x229)](/#BLU#/g,'\x1b[34m'),_0x1d2688=_0x1d2688[_0x3f43d3(0x229)](/#RED#/g,'\x1b[31m'),_0x1d2688=_0x1d2688[_0x3f43d3(0x229)](/#YEL#/g,_0x3f43d3(0x2bb)),_0x1d2688=_0x1d2688[_0x3f43d3(0x229)](/#MAG#/g,_0x3f43d3(0x212)),_0x1d2688=_0x1d2688['replace'](/#CYA#/g,_0x3f43d3(0x151)),_0x1d2688=_0x1d2688[_0x3f43d3(0x229)](/#RES#/g,_0x3f43d3(0x15f)));;}return _0x1d2688;},logger={'screen':_0x60cd02=>{const _0xb313a0=_0x595298;console[_0xb313a0(0x323)](parseColor(_0x60cd02,!![]));},'simple':_0x3db72b=>{const _0x495453=_0x595298;console[_0x495453(0x323)](parseColor(_0x3db72b,!![])),loggerfile[_0x495453(0x19f)](util['format'](parseColor(_0x3db72b,![]))+'\x0a');},'full':async _0x267d22=>{const _0x4a1dc0=_0x595298,_0x588eb7=getTimeStamp()+_0x4a1dc0(0x306)+_0x267d22;console[_0x4a1dc0(0x323)](parseColor(_0x588eb7,!![])),loggerfile[_0x4a1dc0(0x19f)](util[_0x4a1dc0(0x1c1)](parseColor(_0x588eb7,![]))+'\x0a');if(tgBot&&settings[_0x4a1dc0(0x23c)]&&settings['telegramEvents']!=_0x4a1dc0(0x27d))await sendTelegram(settings[_0x4a1dc0(0x23c)],_0x4a1dc0(0x1db)+parseColor(_0x267d22,![]));},'debug':async(_0xad9951,_0x4a0ddd='')=>{const _0xbe5c23=_0x595298,_0x25bb07=getTimeStamp()+_0xbe5c23(0x348)+_0xad9951;if(debugging)console[_0xbe5c23(0x323)](parseColor(_0x25bb07,!![]));loggerfile[_0xbe5c23(0x19f)](util['format'](parseColor(_0x25bb07,![]))+'\x0a');if(_0x4a0ddd){if(debugging)console[_0xbe5c23(0x323)](_0x4a0ddd);loggerfile[_0xbe5c23(0x19f)](util['format'](_0x4a0ddd)+'\x0a');}}};let terminating=![];process['on'](_0x595298(0x1f1),function(_0x9947fd){const _0x292d16=_0x595298;_0x9947fd[_0x292d16(0x31d)]()[_0x292d16(0x34e)](_0x292d16(0x1d6))?(logger[_0x292d16(0x14e)](_0x292d16(0x274)+_0x9947fd[_0x292d16(0x28e)]+_0x292d16(0x2c6)),process['send']({'terminate':!![]},_0x3d1a17=>{})):logger['simple'](_0x9947fd);}),process['on'](_0x595298(0x30c),()=>{stopAllBots(),process['exit'](0x0);}),process['on']('SIGTERM',()=>{const _0x3f528a=_0x595298;stopAllBots(),process[_0x3f528a(0x30c)](0x0);}),process['on'](_0x595298(0x292),()=>{const _0x23d790=_0x595298;stopAllBots(),process[_0x23d790(0x30c)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x595298(0x164))[_0x595298(0x354)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x595298(0x1d5)),app=express(),http=require(_0x595298(0x288))[_0x595298(0x32a)](app);app[_0x595298(0x1d2)](fileUpload({'useTempFiles':!![]})),app['get'](_0x595298(0x2c4),async(_0x5962c1,_0x32711a)=>{const _0x4bcb25=_0x595298,_0x4c5fc4=_0x5962c1[_0x4bcb25(0x181)][_0x4bcb25(0x22f)],_0x557133=getClientsWithBotID(_0x4bcb25(0x235)),_0x37e436=_0x5962c1[_0x4bcb25(0x13b)][_0x4bcb25(0x232)],_0x274dc8=timelyDecrypt(_0x37e436,![]),_0x44d3a5=_0x557133[_0x4bcb25(0x2ed)](_0x300048=>_0x300048[_0x4bcb25(0x232)]==_0x274dc8);if(_0x44d3a5){const _0x247c8d=normalizeIP(_0x5962c1[_0x4bcb25(0x1b1)][_0x4bcb25(0x15e)])[_0x4bcb25(0x2fe)],_0x19feca=_0x5962c1['headers'][_0x4bcb25(0x1fa)];if(validateAccess(_0x19feca,_0x274dc8,_0x247c8d)['allow'])_0x4c5fc4==_0x4bcb25(0x167)&&await backupConfigFiles(),await zipFiles(_0x4c5fc4),_0x32711a[_0x4bcb25(0x189)](zippath+(_0x4c5fc4+_0x4bcb25(0x280)),_0x52ef2f=>{const _0x31e18f=_0x4bcb25;_0x52ef2f&&(logger['full'](_0x31e18f(0x130)+_0x4c5fc4),logger[_0x31e18f(0x14e)](_0x52ef2f));});else logger[_0x4bcb25(0x2d7)](_0x4bcb25(0x179)+_0x4c5fc4+_0x4bcb25(0x336));}else logger[_0x4bcb25(0x2d7)](_0x4bcb25(0x179)+_0x4c5fc4+'\x20(2)');}),app[_0x595298(0x271)](_0x595298(0x308),async(_0x14a086,_0x43c95b)=>{const _0xe0e16d=_0x595298,_0x548316=getClientsWithBotID(_0xe0e16d(0x235)),_0x245cf3=_0x14a086[_0xe0e16d(0x13b)]['uuid'],_0x12e01a=timelyDecrypt(_0x245cf3,![]),_0x5420cf=_0x548316[_0xe0e16d(0x2ed)](_0x47c8c5=>_0x47c8c5[_0xe0e16d(0x232)]==_0x12e01a);logger[_0xe0e16d(0x14f)]('Backup\x20file\x20uploaded');if(_0x5420cf){const _0x12b049=normalizeIP(_0x14a086[_0xe0e16d(0x1b1)][_0xe0e16d(0x15e)])[_0xe0e16d(0x2fe)],_0x221153=_0x14a086[_0xe0e16d(0x13b)]['tkn'];if(validateAccess(_0x221153,_0x12e01a,_0x12b049)[_0xe0e16d(0x1eb)]){if(_0x14a086[_0xe0e16d(0x2bf)]){const _0xd6780c=_0x14a086[_0xe0e16d(0x2bf)]['backupfile'];await _0xd6780c['mv'](temppath+_0xd6780c['name']),_0x43c95b['send']({'status':!![],'message':_0xe0e16d(0x22a)});const _0x30fd1e=getBotsWithMode();_0x30fd1e[_0xe0e16d(0x1a4)]>0x0?confirmRestore(temppath,_0xd6780c['name']):unzipFile(temppath,_0xd6780c['name']);}}else logger[_0xe0e16d(0x2d7)](_0xe0e16d(0x2d6));}else logger[_0xe0e16d(0x2d7)](_0xe0e16d(0x14d));}),app[_0x595298(0x1d2)](express[_0x595298(0x19d)](path[_0x595298(0x309)](__dirname,bbpath2,'build2'))),app['use'](express[_0x595298(0x19d)](path[_0x595298(0x309)](__dirname,bbpath2,_0x595298(0x134)))),app[_0x595298(0x1b9)]('/',function(_0x40158d,_0x26be4a){const _0x221fb2=_0x595298;_0x26be4a[_0x221fb2(0x1dd)](path['join'](__dirname,bbpath2,_0x221fb2(0x263),_0x221fb2(0x140)));}),app[_0x595298(0x1b9)](_0x595298(0x1e6),function(_0x26177e,_0x2ab101){const _0x35bc87=_0x595298;_0x2ab101[_0x35bc87(0x1dd)](path['join'](__dirname,bbpath2,_0x35bc87(0x134),_0x35bc87(0x140)));}),app[_0x595298(0x1b9)](_0x595298(0x2e9),(_0x3984e4,_0x3ccaee)=>{const _0x268c69=_0x595298;_0x3ccaee[_0x268c69(0x1dd)](path[_0x268c69(0x309)](__dirname,bbpath2,'build','index.html'));}),app['get']('/:bot/performance',(_0x2696ce,_0x260728)=>{const _0x5aaf65=_0x595298;_0x260728[_0x5aaf65(0x1dd)](path[_0x5aaf65(0x309)](__dirname,bbpath2,_0x5aaf65(0x134),_0x5aaf65(0x140)));}),app['get'](_0x595298(0x33e),(_0x4b87a6,_0x58e9eb)=>{const _0x14ca71=_0x595298;_0x58e9eb[_0x14ca71(0x1dd)](path[_0x14ca71(0x309)](__dirname,bbpath2,_0x14ca71(0x134),_0x14ca71(0x140)));}),app[_0x595298(0x1b9)](_0x595298(0x2b1),(_0x4e1aae,_0x20c966)=>{const _0x103aa0=_0x595298;_0x20c966['sendFile'](path[_0x103aa0(0x309)](__dirname,bbpath2,_0x103aa0(0x134),_0x103aa0(0x140)));}),app[_0x595298(0x1b9)](_0x595298(0x1a5),(_0x4af8d1,_0x6cd307)=>{const _0xe64ab7=_0x595298;_0x6cd307[_0xe64ab7(0x1dd)](path[_0xe64ab7(0x309)](__dirname,bbpath2,_0xe64ab7(0x134),_0xe64ab7(0x140)));}),app['get']('/:bot/support',(_0x39b4e0,_0x2fc179)=>{const _0x53ac48=_0x595298;_0x2fc179[_0x53ac48(0x1dd)](path[_0x53ac48(0x309)](__dirname,bbpath2,_0x53ac48(0x134),'index.html'));});if(HOST)http['listen'](PORT,HOST);else http[_0x595298(0x262)](PORT);const io=require(_0x595298(0x24b))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0xbeb971=_0x595298;let _0x37a12d=_0xbeb971(0x160);const _0x5e09c8=networkInterfaces(),_0x131d57={};for(const _0x25b622 of Object['keys'](_0x5e09c8)){for(const _0x3de8a0 of _0x5e09c8[_0x25b622]){if((_0x3de8a0[_0xbeb971(0x2a4)]=='IPv4'||_0x3de8a0['family']==0x4)&&!_0x3de8a0[_0xbeb971(0x1f4)]){const _0x1c8b6b=ipaddr[_0xbeb971(0x352)](_0x3de8a0['address'])[_0xbeb971(0x185)]();_0x1c8b6b!='private'&&(!_0x131d57[_0x25b622]&&(_0x131d57[_0x25b622]=[]),_0x131d57[_0x25b622][_0xbeb971(0x32e)](_0x3de8a0[_0xbeb971(0x2f3)]),_0x37a12d=_0x3de8a0['address']);}}}return{'serverip':_0x37a12d,'netinterfaces':_0x131d57};}async function startServer(){const _0x2b4793=_0x595298,{serverip:_0x2e31c6,netinterfaces:_0x178a67}=getServerIP();logger[_0x2b4793(0x14e)](''),logger[_0x2b4793(0x14e)](_0x2b4793(0x175)),await logger[_0x2b4793(0x2d7)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x2b4793(0x30d)+(environment==_0x2b4793(0x25f)?'(staging)':'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x2b4793(0x2ac)+_0x2e31c6+':'+PORT+_0x2b4793(0x32b))),logger['simple'](_0x2b4793(0x175));if(config[_0x2b4793(0x1a4)]!=0x0)for(const _0x518a6a of config){const _0x4bbdac=_0x518a6a[_0x2b4793(0x22c)]==_0x2b4793(0x30a)?'a':'m';if(_0x518a6a[_0x2b4793(0x258)]=='enabled'||_0x518a6a[_0x2b4793(0x258)]==_0x2b4793(0x26f))await logger[_0x2b4793(0x2d7)]('Starting\x20('+_0x4bbdac+_0x2b4793(0x1d0)+_0x518a6a[_0x2b4793(0x247)]+'\x20|\x20'+_0x518a6a['botname']),startBot([_0x518a6a[_0x2b4793(0x247)],userID],{'cwd':bbpath},function(_0x4cc2b9){const _0x1b7808=_0x2b4793;if(_0x4cc2b9)logger[_0x1b7808(0x2d7)](_0x4cc2b9);});else(_0x518a6a[_0x2b4793(0x258)]==_0x2b4793(0x350)||_0x518a6a[_0x2b4793(0x258)]=='new-disabled')&&await logger[_0x2b4793(0x2d7)](_0x2b4793(0x261)+_0x4bbdac+')\x20\x20\x20|\x20Bot\x20'+_0x518a6a[_0x2b4793(0x247)]+'\x20|\x20'+_0x518a6a['botname']);}else!newBot&&logger[_0x2b4793(0x14e)](_0x2b4793(0x13a));if(newBot)addBot();logger['simple'](_0x2b4793(0x175)),logger['simple'](''),await logger[_0x2b4793(0x14f)](_0x2b4793(0x2da)+nodeversion),await logger[_0x2b4793(0x14f)](_0x2b4793(0x2c8),_0x178a67);}function startSocket(){const _0x33c939=_0x595298;io['on'](_0x33c939(0x154),_0x100aa5=>{const _0xfebb73=_0x33c939;let _0x494f4c,_0x251f82,_0x564757,_0x1ee1a8,_0x87979c;const _0x3b278d=_0x100aa5['handshake'][_0xfebb73(0x13b)][_0xfebb73(0x285)];_0x251f82=_0x3b278d['match'](/bot[0-9]{3}/);if(_0x251f82)_0x564757=_0x251f82[0x0][_0xfebb73(0x272)](/[0-9]{3}/);if(_0x564757)_0x494f4c=_0x564757[0x0];else _0x494f4c=_0xfebb73(0x235);const _0x3ee85c=_0x100aa5[_0xfebb73(0x244)]['auth'][_0xfebb73(0x302)];if(!_0x3ee85c)_0x100aa5[_0xfebb73(0x223)](_0xfebb73(0x258),{'publicKey':secure['publicKey']});else{_0x1ee1a8=timelyDecrypt(_0x3ee85c,![]);if(!_0x1ee1a8)_0x100aa5[_0xfebb73(0x223)](_0xfebb73(0x258),{'publicKey':secure[_0xfebb73(0x286)]});else{_0x87979c=normalizeIP(_0x100aa5['conn'][_0xfebb73(0x15e)])[_0xfebb73(0x2fe)];if(!devices[_0x1ee1a8])devices[_0x1ee1a8]={'uuid':_0x1ee1a8,'access':{'token':null}};devices[_0x1ee1a8]['ip']=_0x87979c;const _0x591935=addClient(_0x100aa5['id'],_0x1ee1a8,_0x494f4c);setAccess(_0x591935),emitMessages(),_0x100aa5['on'](_0xfebb73(0x192),_0x1226cc=>{const _0x5641b9=_0xfebb73,_0x4c94ff=timelyDecrypt(_0x1226cc[_0x5641b9(0x30b)],!![],'|@|');if(_0x4c94ff){_0x1226cc={'username':_0x1226cc[_0x5641b9(0x1b6)],'password':_0x4c94ff},devices[_0x1ee1a8][_0x5641b9(0x337)]=validateCredentials(_0x1226cc,_0x1ee1a8);if(devices[_0x1ee1a8]['access'][_0x5641b9(0x1eb)]==![]&&devices[_0x1ee1a8][_0x5641b9(0x337)][_0x5641b9(0x332)]=='2FA\x20login\x20required')_0x100aa5[_0x5641b9(0x223)]('status',{'access':devices[_0x1ee1a8][_0x5641b9(0x337)]}),loginAccess2FA(_0x1ee1a8,_0x87979c);else{if(devices[_0x1ee1a8]['access'][_0x5641b9(0x1eb)]==![]&&devices[_0x1ee1a8][_0x5641b9(0x337)][_0x5641b9(0x332)]==_0x5641b9(0x2b3))_0x100aa5[_0x5641b9(0x223)](_0x5641b9(0x258),{'access':devices[_0x1ee1a8][_0x5641b9(0x337)]});else devices[_0x1ee1a8][_0x5641b9(0x337)][_0x5641b9(0x1eb)]&&devices[_0x1ee1a8][_0x5641b9(0x337)]['reason']==_0x5641b9(0x34f)&&(getClientsWithUuid(_0x1ee1a8)[_0x5641b9(0x297)](_0xfdacb7=>{setAccess(_0xfdacb7);}),logger[_0x5641b9(0x14f)](_0x5641b9(0x14b)+_0x1ee1a8[_0x5641b9(0x1ff)](-0x8)),setTokenRefresh(_0x1ee1a8),setSessionTimeout(_0x5641b9(0x192),_0x1ee1a8));}}else logger[_0x5641b9(0x2d7)](_0x5641b9(0x135));}),_0x100aa5['on']('reset-password',()=>{resetPassword();}),_0x100aa5['on']('disconnect',_0x3a418d=>{removeClient(_0x100aa5['id']);}),_0x494f4c==_0xfebb73(0x235)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x292967){const _0x520453=_0x595298;if(_0x292967!='botmanager'&&config[_0x520453(0x18e)]!=''){if(pid[_0x292967])pid[_0x292967][_0x520453(0x2d2)]({'function':'initclient','args':null});}_0x292967!=_0x520453(0x235)&&broadcastToBots(_0x520453(0x287),JSON[_0x520453(0x1a1)](config));}function reloadBotManager(){const _0x16b3fe=_0x595298;getClientsWithBotID('botmanager')[_0x16b3fe(0x297)](_0x1fc1df=>{const _0x426d9f=_0x16b3fe;getSocket(_0x1fc1df['id'])[_0x426d9f(0x223)](_0x426d9f(0x258),{'access':{'allow':![],'reason':'reload','token':null}});});}function getSocket(_0x16e7ae){const _0x170b6b=_0x595298,_0x336b7c=io['_nsps']['get']('/');return _0x336b7c['sockets'][_0x170b6b(0x1b9)](_0x16e7ae);}function setAccess(_0xd7189){const _0x2109ab=_0x595298,_0x3706ea=getSocket(_0xd7189['id']),_0x17316b=_0xd7189['uuid'],_0x5e636e=_0xd7189['bot'];devices[_0x17316b][_0x2109ab(0x337)]=validateAccess(devices[_0x17316b][_0x2109ab(0x337)][_0x2109ab(0x2de)],_0x17316b),logger[_0x2109ab(0x14f)](_0x2109ab(0x2c5)+devices[_0x17316b][_0x2109ab(0x337)]['reason']+_0x2109ab(0x13d)+_0xd7189['id'][_0x2109ab(0x1ff)](-0x8)+'\x20|\x20user:\x20...'+_0x17316b['slice'](-0x8)),_0x3706ea[_0x2109ab(0x309)](_0x17316b);if(devices[_0x17316b]['access'][_0x2109ab(0x1eb)]){_0x3706ea[_0x2109ab(0x309)](_0x5e636e);if(_0x5e636e=='botmanager')initializeSocketBotManager(_0x3706ea);else initializeSocketBot(_0x3706ea);initClient(_0x5e636e);}devices[_0x17316b][_0x2109ab(0x337)][_0x2109ab(0x2de)]&&devices[_0x17316b][_0x2109ab(0x337)][_0x2109ab(0x332)]=='temporary\x20token\x20generated'&&setSessionTimeout(_0x2109ab(0x267),_0x17316b),devices[_0x17316b][_0x2109ab(0x337)][_0x2109ab(0x2de)]&&devices[_0x17316b]['access'][_0x2109ab(0x332)]==_0x2109ab(0x273)&&setSessionTimeout(_0x2109ab(0x192),_0x17316b),_0x3706ea[_0x2109ab(0x223)](_0x2109ab(0x258),{'status':_0xd7189[_0x2109ab(0x18a)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x17316b][_0x2109ab(0x337)],'externalip':devices[_0x17316b]['ip'],'publicKey':secure[_0x2109ab(0x286)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x17316b][_0x2109ab(0x337)][_0x2109ab(0x1eb)]==![]&&devices[_0x17316b][_0x2109ab(0x337)][_0x2109ab(0x332)]==_0x2109ab(0x1bd)&&temporaryAccess2FA(_0x17316b,devices[_0x17316b]['ip']);}function setSessionTimeout(_0x39e863,_0x40ae02){const _0x2187c4=_0x595298;let _0x32a45d;if(_0x39e863==_0x2187c4(0x192))_0x32a45d=loginExpiry*0x3c*0x3e8;else _0x32a45d=devices[_0x40ae02][_0x2187c4(0x29a)][_0x2187c4(0x234)]*0x3c*0x3e8-(new Date()[_0x2187c4(0x2ea)]()-devices[_0x40ae02][_0x2187c4(0x29a)][_0x2187c4(0x21d)]);if(devices[_0x40ae02][_0x2187c4(0x2b8)])clearTimeout(devices[_0x40ae02][_0x2187c4(0x2b8)]);devices[_0x40ae02][_0x2187c4(0x2b8)]=setTimeout(()=>{const _0x42ff44=_0x2187c4;if(devices[_0x40ae02][_0x42ff44(0x1b2)])clearTimeout(devices[_0x40ae02]['pidRefreshToken']);removeSocketListeners(_0x40ae02),addBlacklist(_0x40ae02),devices[_0x40ae02][_0x42ff44(0x29a)]=null,devices[_0x40ae02]['telegram2FaApproval']=null,devices[_0x40ae02][_0x42ff44(0x337)][_0x42ff44(0x2de)]=null,logger[_0x42ff44(0x14f)](_0x42ff44(0x2cd)+_0x40ae02[_0x42ff44(0x1ff)](-0x8)),devices[_0x40ae02][_0x42ff44(0x337)]=validateAccess(devices[_0x40ae02][_0x42ff44(0x337)][_0x42ff44(0x2de)],_0x40ae02),!(devices[_0x40ae02][_0x42ff44(0x337)][_0x42ff44(0x1eb)]&&devices[_0x40ae02][_0x42ff44(0x337)][_0x42ff44(0x332)]=='login\x20not\x20required')&&(_0x39e863==_0x42ff44(0x192)?io['to'](_0x40ae02)[_0x42ff44(0x223)](_0x42ff44(0x258),{'access':{'allow':![],'reason':_0x42ff44(0x2fc),'token':null}}):io['to'](_0x40ae02)[_0x42ff44(0x223)](_0x42ff44(0x258),{'access':{'allow':![],'reason':_0x42ff44(0x311),'token':null}})),devices[_0x40ae02][_0x42ff44(0x337)][_0x42ff44(0x2de)]=null;},_0x32a45d);}function setTokenRefresh(_0x42827c){const _0x33088f=_0x595298;if(devices[_0x42827c][_0x33088f(0x1b2)])clearTimeout(devices[_0x42827c][_0x33088f(0x1b2)]);devices[_0x42827c][_0x33088f(0x1b2)]=setTimeout(()=>{const _0x3d26fe=_0x33088f;getClientsWithUuid(_0x42827c)['length']!=0x0?(devices[_0x42827c]['access']=refreshToken(_0x42827c),io['to'](_0x42827c)[_0x3d26fe(0x223)](_0x3d26fe(0x258),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x42827c][_0x3d26fe(0x337)],'externalip':devices[_0x42827c]['ip'],'publicKey':secure['publicKey'],'validInstallation':validInstallation}),setTokenRefresh(_0x42827c)):clearTimeout(devices[_0x42827c][_0x3d26fe(0x1b2)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x12bfd6){const _0x11ad73=_0x595298,_0x183273=getClient(_0x12bfd6['id'])[_0x11ad73(0x232)];_0x12bfd6[_0x11ad73(0x223)]('bots',config),_0x12bfd6[_0x11ad73(0x223)](_0x11ad73(0x2f6),cleanSettings()),_0x12bfd6['on'](_0x11ad73(0x178),_0x4d8b7c=>{const _0x1a6ce3=_0x11ad73;if(validateAccess(_0x4d8b7c,_0x183273)[_0x1a6ce3(0x1eb)])addBot();else logger['full'](_0x1a6ce3(0x16f));}),_0x12bfd6['on'](_0x11ad73(0x18c),(_0x23bc92,_0x3265a6)=>{const _0x19775c=_0x11ad73;if(validateAccess(_0x3265a6,_0x183273)[_0x19775c(0x1eb)])toggleBot(_0x23bc92[_0x19775c(0x247)],_0x23bc92[_0x19775c(0x258)],_0x23bc92[_0x19775c(0x2e1)]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x12bfd6['on']('toggle-bot-mode',(_0x101387,_0x588842)=>{const _0x19daa4=_0x11ad73;if(validateAccess(_0x588842,_0x183273)[_0x19daa4(0x1eb)])toggleBotMode(_0x101387);else logger[_0x19daa4(0x2d7)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x12bfd6['on']('delete-bot',(_0x1f2957,_0x352954)=>{const _0x39a56f=_0x11ad73;if(validateAccess(_0x352954,_0x183273)[_0x39a56f(0x1eb)])deleteBot(_0x1f2957);else logger[_0x39a56f(0x2d7)](_0x39a56f(0x316));}),_0x12bfd6['on']('store-settings',(_0x5e9fc6,_0x50bcd6)=>{const _0x2627a5=_0x11ad73;if(validateAccess(_0x50bcd6,_0x183273)['allow'])storeSettings(_0x5e9fc6,!![]);else logger[_0x2627a5(0x2d7)](_0x2627a5(0x20f));}),_0x12bfd6['on'](_0x11ad73(0x305),_0x1f3d73=>{const _0x5d74e1=_0x11ad73;if(validateAccess(_0x1f3d73,_0x183273)['allow'])updateBB(_0x5d74e1(0x239));else logger['full'](_0x5d74e1(0x304));}),_0x12bfd6['on'](_0x11ad73(0x1e0),_0x3a7203=>{const _0x4d8053=_0x11ad73;if(validateAccess(_0x3a7203,_0x183273)[_0x4d8053(0x1eb)])updateBB(_0x4d8053(0x213));else logger[_0x4d8053(0x2d7)](_0x4d8053(0x148));}),_0x12bfd6['on'](_0x11ad73(0x2a1),_0x4b863e=>{const _0x1161b8=_0x11ad73;if(validateAccess(_0x4b863e,_0x183273)['allow']){const _0x4958c8=getClient(_0x12bfd6['id']);if(_0x4958c8)getBackupFiles(_0x4958c8[_0x1161b8(0x232)]);else logger[_0x1161b8(0x2d7)](_0x1161b8(0x2a0));}else logger['full']('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x12bfd6['on'](_0x11ad73(0x17f),(_0x4e4b41,_0x1beea2)=>{const _0x1a102d=_0x11ad73;if(validateAccess(_0x1beea2,_0x183273)[_0x1a102d(0x1eb)])restoreBackupFile(_0x4e4b41);else logger['full'](_0x1a102d(0x255));}),_0x12bfd6['on'](_0x11ad73(0x225),_0xab9dd6=>{const _0x4a39e3=_0x11ad73;if(validateAccess(_0xab9dd6,_0x183273)[_0x4a39e3(0x1eb)])getMessages();else logger[_0x4a39e3(0x2d7)](_0x4a39e3(0x17a));}),_0x12bfd6['on'](_0x11ad73(0x34c),(_0x44f58d,_0x379d9d)=>{const _0x230048=_0x11ad73;if(validateAccess(_0x379d9d,_0x183273)['allow'])confirmMessage(_0x44f58d);else logger[_0x230048(0x2d7)](_0x230048(0x24f));}),_0x12bfd6['on'](_0x11ad73(0x202),_0x283e6f=>{const _0x22c2fe=_0x11ad73;if(validateAccess(_0x283e6f,_0x183273)[_0x22c2fe(0x1eb)]){if(devices[_0x183273]['pidRefreshToken'])clearTimeout(devices[_0x183273][_0x22c2fe(0x1b2)]);if(devices[_0x183273][_0x22c2fe(0x2b8)])clearTimeout(devices[_0x183273][_0x22c2fe(0x2b8)]);removeSocketListeners(getClient(_0x12bfd6['id'])[_0x22c2fe(0x232)]),addBlacklist(_0x183273),devices[_0x183273][_0x22c2fe(0x29a)]=null,devices[_0x183273][_0x22c2fe(0x133)]=null,devices[_0x183273][_0x22c2fe(0x337)][_0x22c2fe(0x2de)]=null,logger[_0x22c2fe(0x14f)](_0x22c2fe(0x278)+_0x183273['slice'](-0x8)),io['to'](getClient(_0x12bfd6['id'])[_0x22c2fe(0x232)])[_0x22c2fe(0x223)](_0x22c2fe(0x258),{'access':{'allow':![],'reason':_0x22c2fe(0x334),'token':null}});}else logger['full'](_0x22c2fe(0x248));});}function initializeSocketBot(_0x588da7){const _0x847475=_0x595298,_0x453fe1=getClient(_0x588da7['id'])[_0x847475(0x137)],_0x382139=getClient(_0x588da7['id'])[_0x847475(0x232)];_0x588da7['on'](_0x847475(0x1ce),(_0x5e6f12,_0x5f1b50)=>{const _0x377eb5=_0x847475;if(validateAccess(_0x5f1b50,_0x382139)['allow']){if(pid[_0x453fe1])pid[_0x453fe1][_0x377eb5(0x2d2)]({'function':_0x377eb5(0x26c),'args':_0x5e6f12});}else logger[_0x377eb5(0x2d7)](_0x377eb5(0x344));}),_0x588da7['on'](_0x847475(0x1a9),(_0x1b71d3,_0x33be07)=>{const _0x4b701a=_0x847475;if(validateAccess(_0x33be07,_0x382139)[_0x4b701a(0x1eb)]){if(pid[_0x453fe1])pid[_0x453fe1][_0x4b701a(0x2d2)]({'function':_0x4b701a(0x270),'args':_0x1b71d3});}else logger['full'](_0x4b701a(0x290));}),_0x588da7['on'](_0x847475(0x34b),(_0x17d137,_0x45ed8a)=>{const _0x4a000f=_0x847475;if(validateAccess(_0x45ed8a,_0x382139)[_0x4a000f(0x1eb)]){if(pid[_0x453fe1])pid[_0x453fe1]['send']({'function':_0x4a000f(0x351),'args':_0x17d137});}else logger[_0x4a000f(0x2d7)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x588da7['on'](_0x847475(0x1cf),(_0x28532f,_0x472a30)=>{const _0x55e070=_0x847475;if(validateAccess(_0x472a30,_0x382139)['allow']){if(pid[_0x453fe1])pid[_0x453fe1][_0x55e070(0x2d2)]({'function':_0x55e070(0x22b),'args':_0x28532f});}else logger[_0x55e070(0x2d7)](_0x55e070(0x1c0));}),_0x588da7['on']('store-headless',(_0x124abb,_0x33749b)=>{const _0x3dd9a1=_0x847475;if(validateAccess(_0x33749b,_0x382139)[_0x3dd9a1(0x1eb)]){if(pid[_0x453fe1])pid[_0x453fe1][_0x3dd9a1(0x2d2)]({'function':_0x3dd9a1(0x331),'args':_0x124abb});}else logger['full'](_0x3dd9a1(0x2fd));}),_0x588da7['on'](_0x847475(0x159),(_0x8dcf1,_0x54aa22)=>{const _0xd2921c=_0x847475;if(validateAccess(_0x54aa22,_0x382139)[_0xd2921c(0x1eb)]){if(pid[_0x453fe1])pid[_0x453fe1][_0xd2921c(0x2d2)]({'function':_0xd2921c(0x23f),'args':_0x8dcf1});}else logger[_0xd2921c(0x2d7)](_0xd2921c(0x252));}),_0x588da7['on']('reset-history',_0x1ac5be=>{const _0x5947ce=_0x847475;if(validateAccess(_0x1ac5be,_0x382139)[_0x5947ce(0x1eb)]){if(pid[_0x453fe1])pid[_0x453fe1]['send']({'function':_0x5947ce(0x2ff),'args':null});}else logger[_0x5947ce(0x2d7)](_0x5947ce(0x1ee));}),_0x588da7['on'](_0x847475(0x28c),_0xcbad33=>{const _0x4968e0=_0x847475;if(validateAccess(_0xcbad33,_0x382139)[_0x4968e0(0x1eb)]){if(pid[_0x453fe1])pid[_0x453fe1][_0x4968e0(0x2d2)]({'function':'getStartingBalances','args':null});}else logger[_0x4968e0(0x2d7)](_0x4968e0(0x275));}),_0x588da7['on']('place-order',(_0x1c132f,_0x499021)=>{const _0x1915ec=_0x847475;if(validateAccess(_0x499021,_0x382139)[_0x1915ec(0x1eb)]){if(pid[_0x453fe1])pid[_0x453fe1][_0x1915ec(0x2d2)]({'function':_0x1915ec(0x1b5),'args':_0x1c132f});}else logger[_0x1915ec(0x2d7)](_0x1915ec(0x282));}),_0x588da7['on'](_0x847475(0x312),_0x4b16a5=>{const _0x2481d0=_0x847475;if(validateAccess(_0x4b16a5,_0x382139)[_0x2481d0(0x1eb)]){if(pid[_0x453fe1])pid[_0x453fe1][_0x2481d0(0x2d2)]({'function':_0x2481d0(0x2b6),'args':null});}else logger[_0x2481d0(0x2d7)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x588da7['on'](_0x847475(0x29f),_0x1a2683=>{const _0x5103a4=_0x847475;if(validateAccess(_0x1a2683,_0x382139)[_0x5103a4(0x1eb)]){if(pid[_0x453fe1])pid[_0x453fe1][_0x5103a4(0x2d2)]({'function':_0x5103a4(0x27f),'args':null});}else logger[_0x5103a4(0x2d7)](_0x5103a4(0x156));}),_0x588da7['on'](_0x847475(0x305),_0x5afb6b=>{const _0xb0894d=_0x847475;if(validateAccess(_0x5afb6b,_0x382139)['allow'])updateBB(_0xb0894d(0x239));else logger[_0xb0894d(0x2d7)](_0xb0894d(0x304));}),_0x588da7['on']('get-messages',_0x799e3d=>{const _0x5f1ce2=_0x847475;if(validateAccess(_0x799e3d,_0x382139)[_0x5f1ce2(0x1eb)])getMessages();else logger['full'](_0x5f1ce2(0x17a));}),_0x588da7['on'](_0x847475(0x34c),(_0x394f32,_0xb99f6a)=>{const _0x1f72bb=_0x847475;if(validateAccess(_0xb99f6a,_0x382139)[_0x1f72bb(0x1eb)])confirmMessage(_0x394f32);else logger[_0x1f72bb(0x2d7)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x588da7['on']('logout',_0x18f700=>{const _0x61a12d=_0x847475;if(validateAccess(_0x18f700,_0x382139)['allow']){if(devices[_0x382139][_0x61a12d(0x1b2)])clearTimeout(devices[_0x382139][_0x61a12d(0x1b2)]);if(devices[_0x382139][_0x61a12d(0x2b8)])clearTimeout(devices[_0x382139][_0x61a12d(0x2b8)]);removeSocketListeners(getClient(_0x588da7['id'])[_0x61a12d(0x232)]),addBlacklist(_0x382139),devices[_0x382139][_0x61a12d(0x29a)]=null,devices[_0x382139][_0x61a12d(0x133)]=null,devices[_0x382139][_0x61a12d(0x337)][_0x61a12d(0x2de)]=null,logger[_0x61a12d(0x14f)](_0x61a12d(0x278)+_0x382139[_0x61a12d(0x1ff)](-0x8)),io['to'](getClient(_0x588da7['id'])['uuid'])[_0x61a12d(0x223)](_0x61a12d(0x258),{'access':{'allow':![],'reason':_0x61a12d(0x334),'token':null}});}else logger[_0x61a12d(0x2d7)](_0x61a12d(0x248));});}function removeSocketListeners(_0x14268f){const _0xdc2b40=_0x595298;getClientsWithUuid(_0x14268f)[_0xdc2b40(0x297)](_0x58acd2=>{getSocket(_0x58acd2['id'])['removeAllListeners']();});}function cleanSettings(){const _0x1b2261=_0x595298;let _0x1f9170=settings;return settings['telegramToken']&&settings[_0x1b2261(0x25d)]!=''&&(_0x1f9170={..._0x1f9170,'telegramToken':_0x1b2261(0x2fa)}),settings[_0x1b2261(0x256)]&&settings[_0x1b2261(0x256)]!=''&&(_0x1f9170={..._0x1f9170,'bbPassword':_0x1b2261(0x2fa)}),settings['marketcapApi']&&settings[_0x1b2261(0x180)]!=''&&(_0x1f9170={..._0x1f9170,'marketcapApi':_0x1b2261(0x2fa)}),(settings[_0x1b2261(0x256)]&&settings[_0x1b2261(0x256)]==_0x1b2261(0x1e7)||settings[_0x1b2261(0x25d)]&&settings[_0x1b2261(0x25d)]==_0x1b2261(0x1e7)||settings[_0x1b2261(0x180)]&&settings['marketcapApi']==_0x1b2261(0x1e7))&&(_0x1f9170={..._0x1f9170,'restored':{'password':settings['bbPassword']==_0x1b2261(0x1e7),'telegram':settings[_0x1b2261(0x25d)]==_0x1b2261(0x1e7),'marketcap':settings[_0x1b2261(0x180)]==_0x1b2261(0x1e7)}}),_0x1f9170;}async function updateBB(_0x2c14b5){const _0x19bad0=_0x595298;await backupConfigFiles(),installingUpdate=!![],config[_0x19bad0(0x297)](_0x386c02=>{restartBot(_0x386c02['botID']);});if(_0x2c14b5==_0x19bad0(0x239))process[_0x19bad0(0x2d2)]({'update':!![],'environment':environment},_0x19ccea=>{});else _0x2c14b5=='reinstall'&&process[_0x19bad0(0x2d2)]({'reinstall':!![],'environment':environment},_0x321731=>{});}function startBot(_0x385961,_0x282db9,_0x10da72){const _0x5e09e5=_0x595298;if(debugging)_0x385961[_0x5e09e5(0x32e)]('-d');let _0x37eb26=![];const _0x161316=_0x385961[0x0];_0x282db9={..._0x282db9,'stdio':[_0x5e09e5(0x2ba),_0x5e09e5(0x2ba),_0x5e09e5(0x2ba),'ipc']},pid[_0x161316]=childProcess[_0x5e09e5(0x1af)](botfile,_0x385961,_0x282db9),pid[_0x161316]['on'](_0x5e09e5(0x172),_0x24f84d=>{const _0x39b57c=_0x5e09e5;switch(Object['keys'](_0x24f84d)[0x0]){case _0x39b57c(0x233):updateBotName(_0x161316,_0x24f84d[_0x39b57c(0x233)]);break;case _0x39b57c(0x2cc):updateBotManager();break;case _0x39b57c(0x258):updateStatus(_0x161316,_0x24f84d[_0x39b57c(0x258)]);break;case _0x39b57c(0x2e1):updateLive(_0x161316,_0x24f84d[_0x39b57c(0x2e1)]);break;case _0x39b57c(0x155):updateLive(_0x161316,_0x24f84d[_0x39b57c(0x155)]),io['to'](_0x161316)[_0x39b57c(0x223)]('status',{'access':{'allow':![],'reason':_0x39b57c(0x1a7),'token':null}});break;case _0x39b57c(0x186):_0x24f84d[_0x39b57c(0x186)]=='restart'&&restartBot(_0x161316);_0x24f84d[_0x39b57c(0x186)]==_0x39b57c(0x2a2)&&toggleBot(_0x161316,'disabled',_0x39b57c(0x173));break;case _0x39b57c(0x1cc):sendTelegramBot(_0x161316,_0x24f84d['telegram']);break;case _0x39b57c(0x246):sendTelegramMsg(_0x24f84d[_0x39b57c(0x246)]);break;case _0x39b57c(0x1ae):io['to'](_0x161316)[_0x39b57c(0x223)](_0x24f84d[_0x39b57c(0x1ae)],_0x24f84d['args']);break;}}),pid[_0x161316]['on']('error',function(_0x42c8e0){if(_0x37eb26)return;_0x37eb26=!![],_0x10da72(_0x42c8e0);}),pid[_0x161316]['on'](_0x5e09e5(0x30c),async function(_0x2bb151){const _0x4cb231=_0x5e09e5;if(terminating)return;if(installingUpdate){io[_0x4cb231(0x2a6)]();return;}if(_0x37eb26)return;_0x37eb26=!![],_0x10da72(null);const _0x122002=dbConfig[_0x4cb231(0x1b9)](_0x4cb231(0x287))[_0x4cb231(0x2ed)]({'botID':_0x161316})[_0x4cb231(0x2f0)]();_0x122002&&(_0x122002[_0x4cb231(0x258)]=='enabled'||_0x122002[_0x4cb231(0x258)]=='new')&&(await sleep(0x3e8),updateLive(_0x161316,_0x4cb231(0x173)),logger[_0x4cb231(0x2d7)]('Restarting\x20Bot\x20'+_0x161316),startBot([_0x161316,userID],{'cwd':bbpath},function(_0x4b78ab){const _0x4f685a=_0x4cb231;if(_0x4b78ab)logger[_0x4f685a(0x2d7)](_0x4b78ab);}));});}function stopBot(_0x380847){const _0x5eae4f=_0x595298;getClientsWithBotID(_0x380847)[_0x5eae4f(0x297)](_0x3bcdb8=>{const _0x52e015=_0x5eae4f;getSocket(_0x3bcdb8['id'])[_0x52e015(0x1a8)](!![]),removeClient(_0x3bcdb8['id']);}),pid[_0x380847]&&(pid[_0x380847][_0x5eae4f(0x2a2)](),pid[_0x380847]=null);}function stopAllBots(){terminating=!![];const _0x494a58=getEnabledBots();_0x494a58['forEach'](_0x26aa6e=>{const _0x7e491b=_0xb372;stopBot(_0x26aa6e[_0x7e491b(0x247)]);});}function restartBot(_0x4b3c0c){if(pid[_0x4b3c0c])pid[_0x4b3c0c]['kill']();}function addBot(){const _0x6c686d=_0x595298;let _0x5539df;for(let _0x5ce29b=0x1;_0x5ce29b<0x3e9;_0x5ce29b++){_0x5539df=_0x5ce29b[_0x6c686d(0x31d)]()[_0x6c686d(0x144)](0x3,'0');let _0x50e8de=config[_0x6c686d(0x2ed)](_0x2ae69f=>_0x2ae69f[_0x6c686d(0x247)]==_0x5539df);if(!_0x50e8de)break;}if(_0x5539df===_0x6c686d(0x19b)){logger[_0x6c686d(0x2d7)](_0x6c686d(0x1b7));return;}logger[_0x6c686d(0x2d7)](_0x6c686d(0x21c)+_0x5539df),dbConfig['get'](_0x6c686d(0x287))['push']({'botID':_0x5539df,'botname':_0x6c686d(0x2f7)+_0x5539df,'status':_0x6c686d(0x26f),'live':''})[_0x6c686d(0x19f)](),startBot([_0x5539df,userID],{'cwd':bbpath},function(_0x190eec){const _0x1c249a=_0x6c686d;if(_0x190eec)logger[_0x1c249a(0x2d7)](_0x190eec);}),config=getConfiguration(),io['to']('botmanager')[_0x6c686d(0x223)](_0x6c686d(0x287),config),broadcastToBots(_0x6c686d(0x287),JSON[_0x6c686d(0x1a1)](config));}function deleteBot(_0x2c748c){const _0x4a8397=_0x595298;getClientsWithBotID(_0x2c748c)[_0x4a8397(0x297)](_0x2577b6=>{getSocket(_0x2577b6['id'])['disconnect'](!![]),removeClient(_0x2577b6['id']);}),dbConfig[_0x4a8397(0x1b9)](_0x4a8397(0x287))[_0x4a8397(0x2af)]({'botID':_0x2c748c})[_0x4a8397(0x19f)](),logger[_0x4a8397(0x2d7)](_0x4a8397(0x17e)+_0x2c748c),stopBot(_0x2c748c);try{if(fs['existsSync'](path[_0x4a8397(0x309)](configpath,'bot-'+_0x2c748c+_0x4a8397(0x298))))fs[_0x4a8397(0x16a)](path[_0x4a8397(0x309)](configpath,'bot-'+_0x2c748c+_0x4a8397(0x298)));if(fs[_0x4a8397(0x18b)](path['join'](configpath,_0x4a8397(0x221)+_0x2c748c+_0x4a8397(0x183))))fs['unlinkSync'](path[_0x4a8397(0x309)](configpath,_0x4a8397(0x221)+_0x2c748c+_0x4a8397(0x183)));if(fs[_0x4a8397(0x18b)](path[_0x4a8397(0x309)](configpath,_0x4a8397(0x221)+_0x2c748c+'-performance.json')))fs[_0x4a8397(0x16a)](path['join'](configpath,'bot-'+_0x2c748c+'-performance.json'));if(fs[_0x4a8397(0x18b)](path['join'](configpath,_0x4a8397(0x221)+_0x2c748c+_0x4a8397(0x29e))))fs[_0x4a8397(0x16a)](path[_0x4a8397(0x309)](configpath,_0x4a8397(0x221)+_0x2c748c+_0x4a8397(0x29e)));}catch(_0x4a2b84){if(_0x4a2b84)logger[_0x4a8397(0x2d7)](_0x4a8397(0x21f),_0x4a2b84);}config=getConfiguration(),io['to'](_0x4a8397(0x235))[_0x4a8397(0x223)](_0x4a8397(0x287),config),broadcastToBots(_0x4a8397(0x287),JSON['stringify'](config));}function toggleBot(_0x2dec88,_0xe97b70,_0x3710f0){const _0x6c2d63=_0x595298;dbConfig['get'](_0x6c2d63(0x287))[_0x6c2d63(0x2ed)]({'botID':_0x2dec88})[_0x6c2d63(0x227)]({'status':_0xe97b70})[_0x6c2d63(0x227)]({'live':_0x3710f0})['write']();if(_0xe97b70==_0x6c2d63(0x176)||_0xe97b70==_0x6c2d63(0x26f))logger['full'](_0x6c2d63(0x284)+_0x2dec88),startBot([_0x2dec88,userID],{'cwd':bbpath},function(_0x151873){if(_0x151873)logger['full'](_0x151873);});else(_0xe97b70==_0x6c2d63(0x350)||_0xe97b70==_0x6c2d63(0x146))&&(logger['full'](_0x6c2d63(0x326)+_0x2dec88),stopBot(_0x2dec88));config=getConfiguration(),io['to'](_0x6c2d63(0x235))[_0x6c2d63(0x223)](_0x6c2d63(0x287),config),broadcastToBots(_0x6c2d63(0x287),JSON[_0x6c2d63(0x1a1)](config));}function toggleStatus(_0x4d889a){const _0x158627=_0x595298;let _0x2a5376=dbConfig[_0x158627(0x1b9)](_0x158627(0x287))[_0x158627(0x2ed)]({'botID':_0x4d889a})[_0x158627(0x2f0)](),_0x2b889c;if(_0x2a5376[_0x158627(0x258)]===_0x158627(0x176))_0x2b889c=_0x158627(0x350);else{if(_0x2a5376['status']===_0x158627(0x26f))_0x2b889c=_0x158627(0x146);else{if(_0x2a5376[_0x158627(0x258)]===_0x158627(0x146))_0x2b889c=_0x158627(0x26f);else{if(_0x2a5376['status']===_0x158627(0x350))_0x2b889c=_0x158627(0x176);}}}return _0x2b889c;}function updateStatus(_0x1914c1,_0x30b0c5){const _0x2c623d=_0x595298;dbConfig[_0x2c623d(0x1b9)]('bots')[_0x2c623d(0x2ed)]({'botID':_0x1914c1})['assign']({'status':_0x30b0c5})[_0x2c623d(0x19f)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x2c623d(0x287),config),broadcastToBots(_0x2c623d(0x287),JSON['stringify'](config));}function updateLive(_0x266ed9,_0x16bd29){const _0x1d6e73=_0x595298;dbConfig[_0x1d6e73(0x1b9)](_0x1d6e73(0x287))[_0x1d6e73(0x2ed)]({'botID':_0x266ed9})[_0x1d6e73(0x227)]({'live':_0x16bd29})[_0x1d6e73(0x19f)](),config=getConfiguration(),io['to'](_0x1d6e73(0x235))[_0x1d6e73(0x223)](_0x1d6e73(0x287),config),broadcastToBots('bots',JSON[_0x1d6e73(0x1a1)](config));}function updateBotName(_0x20feae,_0x2447f9){const _0x5e4106=_0x595298;dbConfig[_0x5e4106(0x1b9)](_0x5e4106(0x287))[_0x5e4106(0x2ed)]({'botID':_0x20feae})[_0x5e4106(0x227)]({'botname':_0x2447f9})[_0x5e4106(0x19f)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x5e4106(0x287),config),broadcastToBots(_0x5e4106(0x287),JSON['stringify'](config));}function updateBotManager(){const _0xa22ade=_0x595298;config=getConfiguration(),io['to'](_0xa22ade(0x235))[_0xa22ade(0x223)](_0xa22ade(0x287),config),broadcastToBots('bots',JSON[_0xa22ade(0x1a1)](config));}function toggleBotMode(_0x62394f){const _0x58573b=_0x595298;if(pid[_0x62394f])pid[_0x62394f][_0x58573b(0x2d2)]({'function':'toggleBotMode','args':null});else{const _0x2f6d83=configpath+'bot-'+_0x62394f+_0x58573b(0x298),_0x400dcd=fs[_0x58573b(0x1d8)](_0x2f6d83),_0x144193=JSON['parse'](_0x400dcd),_0x3f2031=_0x144193[_0x58573b(0x137)][0x0][_0x58573b(0x194)];_0x144193[_0x58573b(0x137)][0x0][_0x58573b(0x194)]=!_0x3f2031;const _0x3b2cdb=JSON[_0x58573b(0x1a1)](_0x144193,null,0x2);fs[_0x58573b(0x2d4)](_0x2f6d83,_0x3b2cdb),config=getConfiguration(),io['to'](_0x58573b(0x235))['emit'](_0x58573b(0x287),config),broadcastToBots(_0x58573b(0x287),JSON[_0x58573b(0x1a1)](config));}}function validateTelegram(_0x54c450){const _0xd23707=_0x595298;if(_0x54c450[_0xd23707(0x327)][_0xd23707(0x1b6)]!=settings[_0xd23707(0x141)]&&'@'+_0x54c450['from'][_0xd23707(0x1b6)]!=settings['telegramUsername']||_0x54c450[_0xd23707(0x24a)]['id']!=settings['telegramChatId'])return sendTelegram(_0x54c450[_0xd23707(0x24a)]['id'],_0xd23707(0x31e),{'parse_mode':_0xd23707(0x314)}),![];return!![];}async function initTelegram(){const _0x212265=_0x595298;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x212265(0x25d)]);let _0x394650=_0x212265(0x2e2);_0x394650+='\x0a',_0x394650+=_0x212265(0x22e),_0x394650+=_0x212265(0x264),_0x394650+=_0x212265(0x1e9),_0x394650+=_0x212265(0x191),_0x394650+=_0x212265(0x188),_0x394650+=_0x212265(0x251),_0x394650+=_0x212265(0x142),_0x394650+=_0x212265(0x33c),_0x394650+=_0x212265(0x228),_0x394650+=_0x212265(0x29d),_0x394650+=_0x212265(0x28b),_0x394650+=_0x212265(0x238),_0x394650+=_0x212265(0x1a2),_0x394650+='/update\x20-\x20update\x20Balance\x20Bot\x0a',_0x394650+=_0x212265(0x2be),_0x394650+=_0x212265(0x1e1);let _0x1cc1cb=_0x212265(0x1de);_0x1cc1cb+='\x0a',_0x1cc1cb+=_0x394650,tgBot[_0x212265(0x2b0)]((_0x16a395,_0x4f3709)=>{const _0x3417f0=_0x212265;logger['simple'](getTimeStamp()+_0x3417f0(0x1f5)),logger[_0x3417f0(0x14f)](_0x3417f0(0x2a7),_0x16a395);}),tgBot['use'](async(_0x2cf672,_0xbd5603)=>{const _0x37b967=_0x212265;if(!(!settings[_0x37b967(0x23c)]&&_0x2cf672['update'][_0x37b967(0x172)][_0x37b967(0x23a)]=='/start')){if(!validateTelegram(_0x2cf672))return;}_0xbd5603();}),tgBot[_0x212265(0x219)](_0x212265(0x313),async _0x349a59=>{const _0x4459db=_0x212265;if(_0x349a59[_0x4459db(0x327)][_0x4459db(0x1b6)]==settings[_0x4459db(0x141)]||'@'+_0x349a59[_0x4459db(0x327)]['username']==settings[_0x4459db(0x141)]){if(!settings[_0x4459db(0x23c)])updateSetting(_0x4459db(0x23c),_0x349a59['chat']['id']);}if(!validateTelegram(_0x349a59))return;updateSetting(_0x4459db(0x162),!![]),await sendTelegram(_0x349a59[_0x4459db(0x24a)]['id'],_0x1cc1cb);}),tgBot[_0x212265(0x219)](_0x212265(0x18d),async _0x2f8229=>{const _0x751adc=_0x212265;updateSetting(_0x751adc(0x162),!![]),await sendTelegram(_0x2f8229['chat']['id'],_0x751adc(0x201));}),tgBot['command'](_0x212265(0x1ed),async _0x2a5f85=>{const _0x3a32d6=_0x212265;await sendTelegram(_0x2a5f85[_0x3a32d6(0x24a)]['id'],_0x3a32d6(0x2dd)),updateSetting(_0x3a32d6(0x162),![]);}),tgBot['command'](_0x212265(0x1f0),async _0x1bbcf5=>{const _0x440920=_0x212265,_0x1560f8=Markup[_0x440920(0x245)]([Markup[_0x440920(0x318)][_0x440920(0x249)](_0x440920(0x131),_0x440920(0x16b)),Markup[_0x440920(0x318)][_0x440920(0x249)]('Alerts','config_alerts'),Markup[_0x440920(0x318)]['callback'](_0x440920(0x207),_0x440920(0x257))]);_0x1bbcf5[_0x440920(0x1f6)](_0x440920(0x220),_0x1560f8);}),tgBot[_0x212265(0x32d)](_0x212265(0x16b),async _0x1d604d=>{const _0x1e67b1=_0x212265;_0x1d604d[_0x1e67b1(0x1be)](),updateSetting(_0x1e67b1(0x28f),_0x1e67b1(0x27d)),updateSetting(_0x1e67b1(0x162),!![]),await sendTelegram(_0x1d604d[_0x1e67b1(0x24a)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x212265(0x32d)](_0x212265(0x231),async _0x66396e=>{const _0x13eef1=_0x212265;_0x66396e[_0x13eef1(0x1be)](),updateSetting(_0x13eef1(0x28f),'alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x66396e['chat']['id'],_0x13eef1(0x1c3));}),tgBot['action'](_0x212265(0x257),async _0x241ba8=>{const _0x5f4572=_0x212265;_0x241ba8['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x5f4572(0x2c2)),updateSetting(_0x5f4572(0x162),!![]),await sendTelegram(_0x241ba8[_0x5f4572(0x24a)]['id'],'Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications');}),tgBot['command'](_0x212265(0x258),async _0x2dceef=>{const _0x551f89=_0x212265,_0x5e6999=getBotsWithMode();let _0x17e1a2=_0x551f89(0x293);config[_0x551f89(0x297)](_0x30ec9b=>{const _0x204d36=_0x551f89,_0x48b73c=_0x5e6999[_0x204d36(0x2ed)](_0x22190c=>_0x22190c[_0x204d36(0x247)]==_0x30ec9b[_0x204d36(0x247)])[_0x204d36(0x22c)];_0x17e1a2+=_0x204d36(0x2f7)+_0x30ec9b[_0x204d36(0x247)]+':\x20'+_0x30ec9b[_0x204d36(0x258)]+_0x204d36(0x2d5)+_0x48b73c+'\x20|\x20'+_0x30ec9b[_0x204d36(0x2e1)]+'\x0a';}),_0x17e1a2+='\x0a',_0x17e1a2+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x17e1a2+=!settings[_0x551f89(0x162)]?_0x551f89(0x307):_0x551f89(0x277),_0x17e1a2+=settings[_0x551f89(0x162)]?settings[_0x551f89(0x28f)]==_0x551f89(0x2c2)?_0x551f89(0x330):_0x551f89(0x2cb)+settings[_0x551f89(0x28f)]+_0x551f89(0x2df):'',await sendTelegram(_0x2dceef[_0x551f89(0x24a)]['id'],_0x17e1a2,{'parse_mode':_0x551f89(0x314)});}),tgBot[_0x212265(0x219)](_0x212265(0x2ab),async _0x3a435d=>{const _0x10432d=_0x212265,_0x4785c8=getEnabledBots();if(_0x4785c8['length']==0x0)await sendTelegram(_0x3a435d[_0x10432d(0x24a)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x4785c8[_0x10432d(0x1a4)]>0x1)_0x4785c8['push']({'botID':_0x10432d(0x2c2)});let _0x2df015=[],_0x4458f3=[];const _0x8a65e5=_0x4785c8[_0x10432d(0x1a4)]%0x4==0x0||_0x4785c8[_0x10432d(0x1a4)]%0x4==0x3||_0x4785c8['length']%0x3==0x1?0x4:0x3;let _0x18b020=0x0;_0x4785c8[_0x10432d(0x297)]((_0x56d72e,_0x2d8dfc)=>{const _0x5bb5c8=_0x10432d;if(_0x2d8dfc%_0x8a65e5==0x0)_0x4458f3=[];_0x4458f3[_0x5bb5c8(0x32e)](Markup[_0x5bb5c8(0x318)]['callback'](_0x56d72e['botID']=='all'?_0x5bb5c8(0x196):_0x5bb5c8(0x2f7)+_0x56d72e['botID'],_0x5bb5c8(0x2b5)+_0x56d72e[_0x5bb5c8(0x247)])),_0x2d8dfc%_0x8a65e5==0x0&&(_0x2df015[_0x18b020]=_0x4458f3,_0x18b020++);});const _0x4d1981=Markup[_0x10432d(0x245)](_0x2df015);_0x3a435d[_0x10432d(0x1f6)](_0x10432d(0x184),_0x4d1981);}}),tgBot[_0x212265(0x32d)](/restart_(.+)/,async _0x161c3b=>{const _0x286400=_0x212265,_0x1cc754=_0x161c3b[_0x286400(0x272)][0x1];_0x161c3b[_0x286400(0x1be)](),_0x1cc754==_0x286400(0x2c2)?config[_0x286400(0x297)](_0x14d3b6=>{restartBot(_0x14d3b6['botID']);}):restartBot(_0x1cc754);}),tgBot[_0x212265(0x219)]('on',async _0xb5a5db=>{const _0x35154a=_0x212265,_0x288d41=getDisabledBots();if(_0x288d41[_0x35154a(0x1a4)]==0x0)await sendTelegram(_0xb5a5db['chat']['id'],_0x35154a(0x2c7));else{if(_0x288d41[_0x35154a(0x1a4)]>0x1)_0x288d41[_0x35154a(0x32e)]({'botID':'all'});let _0x5af8be=[],_0xcfca6e=[];const _0x2efecf=_0x288d41[_0x35154a(0x1a4)]%0x4==0x0||_0x288d41[_0x35154a(0x1a4)]%0x4==0x3||_0x288d41[_0x35154a(0x1a4)]%0x3==0x1?0x4:0x3;let _0x5ad63a=0x0;_0x288d41[_0x35154a(0x297)]((_0x4f943f,_0x1571a9)=>{const _0x2b1150=_0x35154a;if(_0x1571a9%_0x2efecf==0x0)_0xcfca6e=[];_0xcfca6e['push'](Markup[_0x2b1150(0x318)][_0x2b1150(0x249)](_0x4f943f[_0x2b1150(0x247)]==_0x2b1150(0x2c2)?'All\x20bots':_0x2b1150(0x2f7)+_0x4f943f['botID'],_0x2b1150(0x283)+_0x4f943f[_0x2b1150(0x247)])),_0x1571a9%_0x2efecf==0x0&&(_0x5af8be[_0x5ad63a]=_0xcfca6e,_0x5ad63a++);});const _0x4d8761=Markup[_0x35154a(0x245)](_0x5af8be);_0xb5a5db['reply'](_0x35154a(0x14a),_0x4d8761);}}),tgBot[_0x212265(0x32d)](/on_(.+)/,async _0xf5b482=>{const _0x428af0=_0x212265,_0x4a0855=_0xf5b482[_0x428af0(0x272)][0x1];_0xf5b482[_0x428af0(0x1be)]();if(_0x4a0855==_0x428af0(0x2c2)){const _0x189736=getDisabledBots();await sendTelegram(_0xf5b482[_0x428af0(0x24a)]['id'],_0x428af0(0x150)),_0x189736[_0x428af0(0x297)](_0x4f651=>{const _0x5afed1=_0x428af0;if(_0x4f651[_0x5afed1(0x247)]!=_0x5afed1(0x2c2))toggleBot(_0x4f651['botID'],toggleStatus(_0x4f651['botID']),_0x5afed1(0x173));});}else await sendTelegram(_0xf5b482[_0x428af0(0x24a)]['id'],_0x428af0(0x157)+_0x4a0855),toggleBot(_0x4a0855,toggleStatus(_0x4a0855),_0x428af0(0x173));}),tgBot['command'](_0x212265(0x28d),async _0x53720d=>{const _0x328595=_0x212265,_0x5909e9=getEnabledBots();if(_0x5909e9['length']==0x0)await sendTelegram(_0x53720d[_0x328595(0x24a)]['id'],_0x328595(0x1cb));else{if(_0x5909e9['length']>0x1)_0x5909e9[_0x328595(0x32e)]({'botID':'all'});let _0x15b05a=[],_0x37c1c=[];const _0xb518e2=_0x5909e9[_0x328595(0x1a4)]%0x4==0x0||_0x5909e9['length']%0x4==0x3||_0x5909e9[_0x328595(0x1a4)]%0x3==0x1?0x4:0x3;let _0x3013ab=0x0;_0x5909e9[_0x328595(0x297)]((_0x5e28a2,_0x566a3d)=>{const _0x4e3a08=_0x328595;if(_0x566a3d%_0xb518e2==0x0)_0x37c1c=[];_0x37c1c[_0x4e3a08(0x32e)](Markup[_0x4e3a08(0x318)][_0x4e3a08(0x249)](_0x5e28a2[_0x4e3a08(0x247)]=='all'?_0x4e3a08(0x196):_0x4e3a08(0x2f7)+_0x5e28a2[_0x4e3a08(0x247)],_0x4e3a08(0x171)+_0x5e28a2[_0x4e3a08(0x247)])),_0x566a3d%_0xb518e2==0x0&&(_0x15b05a[_0x3013ab]=_0x37c1c,_0x3013ab++);});const _0x5e1dfe=Markup[_0x328595(0x245)](_0x15b05a);_0x53720d[_0x328595(0x1f6)](_0x328595(0x199),_0x5e1dfe);}}),tgBot[_0x212265(0x32d)](/off_(.+)/,async _0xdded20=>{const _0x9be53d=_0x212265,_0x55dae7=_0xdded20[_0x9be53d(0x272)][0x1];_0xdded20[_0x9be53d(0x1be)]();if(_0x55dae7==_0x9be53d(0x2c2)){const _0x116014=getEnabledBots();await sendTelegram(_0xdded20[_0x9be53d(0x24a)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20all\x20bots'),_0x116014[_0x9be53d(0x297)](_0x4f4cc8=>{const _0x336c44=_0x9be53d;if(_0x4f4cc8['botID']!=_0x336c44(0x2c2))toggleBot(_0x4f4cc8[_0x336c44(0x247)],toggleStatus(_0x4f4cc8[_0x336c44(0x247)]),_0x336c44(0x173));});}else await sendTelegram(_0xdded20[_0x9be53d(0x24a)]['id'],_0x9be53d(0x18f)+_0x55dae7),toggleBot(_0x55dae7,toggleStatus(_0x55dae7),_0x9be53d(0x173));}),tgBot[_0x212265(0x219)](_0x212265(0x319),async _0x1b4ce1=>{const _0x4d8e49=_0x212265,_0x191e17=getEnabledBots();if(_0x191e17[_0x4d8e49(0x1a4)]==0x0)await sendTelegram(_0x1b4ce1[_0x4d8e49(0x24a)]['id'],_0x4d8e49(0x1cb));else{if(_0x191e17[_0x4d8e49(0x1a4)]>0x1){let _0x3a1169=[],_0x2a76eb=[];const _0x59b68a=_0x191e17[_0x4d8e49(0x1a4)]%0x4==0x0||_0x191e17[_0x4d8e49(0x1a4)]%0x4==0x3||_0x191e17['length']%0x3==0x1?0x4:0x3;let _0x234824=0x0;_0x191e17[_0x4d8e49(0x297)]((_0x34e44d,_0x1c8917)=>{const _0x2b50e1=_0x4d8e49;if(_0x1c8917%_0x59b68a==0x0)_0x2a76eb=[];_0x2a76eb[_0x2b50e1(0x32e)](Markup[_0x2b50e1(0x318)][_0x2b50e1(0x249)](_0x2b50e1(0x2f7)+_0x34e44d[_0x2b50e1(0x247)],_0x2b50e1(0x15b)+_0x34e44d[_0x2b50e1(0x247)])),_0x1c8917%_0x59b68a==0x0&&(_0x3a1169[_0x234824]=_0x2a76eb,_0x234824++);});const _0x465885=Markup[_0x4d8e49(0x245)](_0x3a1169);_0x1b4ce1['reply'](_0x4d8e49(0x158),_0x465885);}else{const _0x579c9c=_0x191e17[0x0][_0x4d8e49(0x247)];if(pid[_0x579c9c])pid[_0x579c9c][_0x4d8e49(0x2d2)]({'function':_0x4d8e49(0x253),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x1bb626=>{const _0x2da149=_0x212265,_0x54858c=_0x1bb626[_0x2da149(0x272)][0x1];_0x1bb626[_0x2da149(0x1be)]();if(pid[_0x54858c])pid[_0x54858c][_0x2da149(0x2d2)]({'function':_0x2da149(0x253),'args':null});}),tgBot['command'](_0x212265(0x296),async _0x3341ae=>{const _0x3a6bc4=_0x212265,_0x3bd245=getEnabledBots();if(_0x3bd245[_0x3a6bc4(0x1a4)]==0x0)await sendTelegram(_0x3341ae[_0x3a6bc4(0x24a)]['id'],_0x3a6bc4(0x1cb));else{if(_0x3bd245[_0x3a6bc4(0x1a4)]>0x1){let _0x5bf1fc=[],_0x43851f=[];const _0x46680d=_0x3bd245[_0x3a6bc4(0x1a4)]%0x4==0x0||_0x3bd245[_0x3a6bc4(0x1a4)]%0x4==0x3||_0x3bd245[_0x3a6bc4(0x1a4)]%0x3==0x1?0x4:0x3;let _0x6e9331=0x0;_0x3bd245[_0x3a6bc4(0x297)]((_0x42aa3b,_0x26ae5e)=>{const _0x415da3=_0x3a6bc4;if(_0x26ae5e%_0x46680d==0x0)_0x43851f=[];_0x43851f[_0x415da3(0x32e)](Markup[_0x415da3(0x318)][_0x415da3(0x249)]('Bot\x20'+_0x42aa3b['botID'],_0x415da3(0x325)+_0x42aa3b[_0x415da3(0x247)])),_0x26ae5e%_0x46680d==0x0&&(_0x5bf1fc[_0x6e9331]=_0x43851f,_0x6e9331++);});const _0x3bf053=Markup[_0x3a6bc4(0x245)](_0x5bf1fc);_0x3341ae[_0x3a6bc4(0x1f6)](_0x3a6bc4(0x29b),_0x3bf053);}else{const _0x909e77=_0x3bd245[0x0][_0x3a6bc4(0x247)];if(pid[_0x909e77])pid[_0x909e77][_0x3a6bc4(0x2d2)]({'function':_0x3a6bc4(0x303),'args':null});}}}),tgBot[_0x212265(0x32d)](/portfolio_(.+)/,async _0xc6167=>{const _0x168f29=_0x212265,_0x1a9ce8=_0xc6167[_0x168f29(0x272)][0x1];_0xc6167[_0x168f29(0x1be)]();if(pid[_0x1a9ce8])pid[_0x1a9ce8]['send']({'function':_0x168f29(0x303),'args':null});}),tgBot[_0x212265(0x219)](_0x212265(0x2db),async _0x5b7ec5=>{const _0x3bd2f5=_0x212265,_0x1bd6e9=_0x3bd2f5(0x2db);await zipFiles(_0x1bd6e9);const _0xf9bbe9=zippath+(_0x1bd6e9+_0x3bd2f5(0x280));_0x5b7ec5[_0x3bd2f5(0x243)]({'source':_0xf9bbe9})[_0x3bd2f5(0x2f2)](()=>{})[_0x3bd2f5(0x2b0)](_0x574168=>logger['debug'](_0x3bd2f5(0x1bf)+_0x1bd6e9+_0x3bd2f5(0x2d0),_0x574168));}),tgBot['command']('backup',async _0x838531=>{const _0xf966b2=_0x212265,_0x235ed6=_0xf966b2(0x167);await backupConfigFiles(),await zipFiles(_0x235ed6);const _0x2eeb71=zippath+(_0x235ed6+_0xf966b2(0x280));_0x838531['replyWithDocument']({'source':_0x2eeb71})[_0xf966b2(0x2f2)](()=>{})[_0xf966b2(0x2b0)](_0x1d1e2c=>logger['debug'](_0xf966b2(0x1bf)+_0x235ed6+_0xf966b2(0x2d0),_0x1d1e2c));}),tgBot[_0x212265(0x219)](_0x212265(0x239),async _0xc986e=>{const _0x3e159b=_0x212265;await getMessages();if(!updateAvailable)await sendTelegram(_0xc986e[_0x3e159b(0x24a)]['id'],_0x3e159b(0x24d));else{if(!validInstallation)await sendTelegram(_0xc986e[_0x3e159b(0x24a)]['id'],_0x3e159b(0x1ab));else{const _0x95f0a6=Markup[_0x3e159b(0x245)]([Markup[_0x3e159b(0x318)][_0x3e159b(0x249)]('Yes',_0x3e159b(0x241)),Markup[_0x3e159b(0x318)]['callback']('No',_0x3e159b(0x152))]);_0xc986e[_0x3e159b(0x1f6)](_0x3e159b(0x25a),_0x95f0a6);}}}),tgBot['action'](/update_(.+)/,async _0x36e76e=>{const _0x7b69e4=_0x212265,_0x59fda8=_0x36e76e[_0x7b69e4(0x272)][0x1];_0x36e76e[_0x7b69e4(0x1be)](),_0x59fda8==_0x7b69e4(0x33a)&&(await sendTelegram(_0x36e76e[_0x7b69e4(0x24a)]['id'],_0x7b69e4(0x32f)),updateBB(_0x7b69e4(0x239))),_0x59fda8=='no'&&await sendTelegram(_0x36e76e['chat']['id'],_0x7b69e4(0x138));}),tgBot[_0x212265(0x219)](_0x212265(0x213),async _0x49811b=>{const _0x3fbec2=_0x212265;if(!validInstallation)await sendTelegram(_0x49811b[_0x3fbec2(0x24a)]['id'],_0x3fbec2(0x295));else{const _0x15507f=Markup[_0x3fbec2(0x245)]([Markup[_0x3fbec2(0x318)][_0x3fbec2(0x249)]('Yes',_0x3fbec2(0x24e)),Markup[_0x3fbec2(0x318)][_0x3fbec2(0x249)]('No',_0x3fbec2(0x13c))]);_0x49811b[_0x3fbec2(0x1f6)](_0x3fbec2(0x1fe),_0x15507f);}}),tgBot[_0x212265(0x32d)](/reinstall_(.+)/,async _0x270222=>{const _0x590e66=_0x212265,_0x5691f0=_0x270222[_0x590e66(0x272)][0x1];_0x270222[_0x590e66(0x1be)](),_0x5691f0=='yes'&&(await sendTelegram(_0x270222['chat']['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB(_0x590e66(0x213))),_0x5691f0=='no'&&await sendTelegram(_0x270222[_0x590e66(0x24a)]['id'],_0x590e66(0x200));}),tgBot[_0x212265(0x219)](_0x212265(0x2d8),async _0x25a66e=>{const _0x36388e=_0x212265,_0x49073a=getBotsWithMode();if(_0x49073a[_0x36388e(0x1a4)]==0x0)await sendTelegram(_0x25a66e[_0x36388e(0x24a)]['id'],_0x36388e(0x1cb));else{let _0x25e87b=[],_0x2bb1ba=[];const _0x3c22a7=0x2;let _0x1e2c9e=0x0;_0x49073a[_0x36388e(0x297)]((_0xe0335d,_0x26eab6)=>{const _0x57ea4f=_0x36388e;if(_0x26eab6%_0x3c22a7==0x0)_0x2bb1ba=[];_0x2bb1ba['push'](Markup['button'][_0x57ea4f(0x249)]('Bot\x20'+_0xe0335d[_0x57ea4f(0x247)]+'\x20('+_0xe0335d[_0x57ea4f(0x22c)]+')',_0x57ea4f(0x25e)+_0xe0335d[_0x57ea4f(0x247)])),_0x26eab6%_0x3c22a7==0x0&&(_0x25e87b[_0x1e2c9e]=_0x2bb1ba,_0x1e2c9e++);});const _0x42db3d=Markup[_0x36388e(0x245)](_0x25e87b);_0x25a66e[_0x36388e(0x1f6)](_0x36388e(0x349),_0x42db3d);}}),tgBot[_0x212265(0x32d)](/toggle_(.+)/,async _0x4d3d27=>{const _0x2295f7=_0x212265,_0x5c9153=_0x4d3d27[_0x2295f7(0x272)][0x1];_0x4d3d27[_0x2295f7(0x1be)]();const _0x214591=getBotsWithMode(),_0x365539=_0x214591[_0x2295f7(0x2ed)](_0x19437f=>_0x19437f[_0x2295f7(0x247)]==_0x5c9153),_0xe35dba=_0x365539[_0x2295f7(0x22c)]==_0x2295f7(0x30a)?_0x2295f7(0x250):_0x2295f7(0x30a);await sendTelegram(_0x4d3d27[_0x2295f7(0x24a)]['id'],_0x2295f7(0x13e)+_0x5c9153+_0x2295f7(0x1c9)+_0xe35dba+_0x2295f7(0x17b)),toggleBotMode(_0x5c9153);}),tgBot[_0x212265(0x219)]('names',async _0x33df1d=>{const _0x303532=_0x212265;let _0x4bf75f='';config[_0x303532(0x297)](_0x444a74=>{const _0x34f883=_0x303532;_0x4bf75f+='Bot\x20'+_0x444a74['botID']+':\x20'+_0x444a74[_0x34f883(0x233)]+'\x0a';}),await sendTelegram(_0x33df1d[_0x303532(0x24a)]['id'],_0x4bf75f,{'parse_mode':'HTML'});}),tgBot[_0x212265(0x219)](_0x212265(0x1c7),async _0x556e76=>{const _0x5eb8e8=_0x212265;await sendTelegram(_0x556e76[_0x5eb8e8(0x24a)]['id'],_0x394650);}),process['once'](_0x212265(0x292),()=>tgBot[_0x212265(0x186)]('SIGINT')),process[_0x212265(0x339)](_0x212265(0x1fc),()=>tgBot[_0x212265(0x186)](_0x212265(0x1fc))),tgBot[_0x212265(0x33b)]();}function disableTelegram(){const _0x2e9084=_0x595298;tgBot&&tgBot[_0x2e9084(0x186)]();}async function sendTelegram(_0x1613ca,_0x56212e,_0x3d9049){const _0xa9edb3=_0x595298;_0x3d9049={..._0x3d9049,'disable_web_page_preview':!![]};try{await tgBot[_0xa9edb3(0x1cc)][_0xa9edb3(0x16e)](_0x1613ca,_0x56212e,_0x3d9049);}catch(_0xff514e){logger['debug'](_0xa9edb3(0x215),_0xff514e);}}async function sendTelegramBot(_0x2b0602,_0x1c20fa){const _0x4c5fcd=_0x595298;if(settings[_0x4c5fcd(0x162)]){if(settings['telegramEvents']==_0x4c5fcd(0x2c2)||(_0x1c20fa[_0x4c5fcd(0x22f)]==_0x4c5fcd(0x139)||_0x1c20fa[_0x4c5fcd(0x22f)]==_0x4c5fcd(0x1f8)||_0x1c20fa[_0x4c5fcd(0x22f)]==_0x4c5fcd(0x2a5))&&settings[_0x4c5fcd(0x28f)]==_0x4c5fcd(0x1ea)||_0x1c20fa[_0x4c5fcd(0x22f)]==_0x4c5fcd(0x1a0)&&settings[_0x4c5fcd(0x28f)]==_0x4c5fcd(0x27d)){if(tgBot&&settings['telegramChatId']){if(_0x1c20fa[_0x4c5fcd(0x2e4)])await sendTelegram(settings[_0x4c5fcd(0x23c)],_0x1c20fa[_0x4c5fcd(0x233)]+_0x4c5fcd(0x15d)+_0x1c20fa[_0x4c5fcd(0x174)]);else await sendTelegram(settings[_0x4c5fcd(0x23c)],_0x4c5fcd(0x2f7)+_0x2b0602+_0x4c5fcd(0x15d)+_0x1c20fa[_0x4c5fcd(0x174)]);}}}}async function sendTelegramMsg(_0xb1483e,_0x44398f=_0x595298(0x314)){const _0x1eef23=_0x595298;return settings[_0x1eef23(0x162)]&&tgBot&&settings[_0x1eef23(0x23c)]?(await sendTelegram(settings[_0x1eef23(0x23c)],_0xb1483e,{'parse_mode':_0x44398f}),!![]):![];}function getDeviceWithIp(_0x197e7a){const _0x4b48dd=_0x595298;return devices[_0x4b48dd(0x2ed)](_0x6b5646=>_0x6b5646['ip']===_0x197e7a);}async function temporaryAccess2FA(_0x72cef,_0x422368){const _0x5b3a59=_0x595298;let _0x1f2722=new Date(),_0x12cde9=![];if(lastIpApproval){if(_0x1f2722-lastIpApproval<0x1388)_0x12cde9=!![];}lastIpApproval=new Date();if(_0x12cde9)return;if(tgBot&&settings['telegramChatId']){const _0x523cfc=uuidRandom();tmpStorage[_0x523cfc]={'uuid':_0x72cef,'externalip':_0x422368};const _0x1595f7=Markup[_0x5b3a59(0x245)]([Markup['button'][_0x5b3a59(0x249)](_0x5b3a59(0x20a),_0x5b3a59(0x1f3)+_0x523cfc),Markup[_0x5b3a59(0x318)][_0x5b3a59(0x249)]('15\x20min','tempaccess_15_'+_0x523cfc),Markup[_0x5b3a59(0x318)][_0x5b3a59(0x249)](_0x5b3a59(0x2f4),'tempaccess_30_'+_0x523cfc),Markup[_0x5b3a59(0x318)][_0x5b3a59(0x249)]('reject',_0x5b3a59(0x27a)+_0x523cfc)]);await sendTelegram(settings[_0x5b3a59(0x23c)],'Allow\x20temporary\x20access\x20from\x20IP\x20address\x20'+normalizeIP(_0x422368)[_0x5b3a59(0x1e3)]+'\x20?',_0x1595f7),tgBot[_0x5b3a59(0x32d)](/tempaccess_(.+)_(.+)/,async _0x1f4565=>{const _0x30484e=_0x5b3a59,_0x347d25=_0x1f4565['match'][0x1],_0x3eaef4=_0x1f4565[_0x30484e(0x272)][0x2],{uuid:_0x369e62,externalip:_0x3af5d4}=tmpStorage[_0x3eaef4];delete tmpStorage[_0x3eaef4],_0x1f4565[_0x30484e(0x1be)](),devices[_0x369e62][_0x30484e(0x29a)]={'clientip':_0x3af5d4,'timestamp':new Date()[_0x30484e(0x2ea)](),'expiry':_0x347d25},_0x347d25!='reject'?(await sendTelegram(_0x1f4565[_0x30484e(0x24a)]['id'],_0x30484e(0x145)+_0x347d25+_0x30484e(0x34d),{'parse_mode':'HTML'}),io['to'](_0x369e62)[_0x30484e(0x223)](_0x30484e(0x258),{'access':{'allow':![],'reason':_0x30484e(0x1a7),'token':null}})):(await sendTelegram(_0x1f4565[_0x30484e(0x24a)]['id'],'Temporary\x20access\x20rejected'),io['to'](_0x369e62)[_0x30484e(0x223)]('status',{'access':{'allow':![],'reason':_0x30484e(0x211),'token':null}}));});}}function _0xb372(_0x155395,_0x3aeb6e){const _0x387d1f=_0x1346();return _0xb372=function(_0x5ee228,_0x2fbcaa){_0x5ee228=_0x5ee228-0x130;let _0x134614=_0x387d1f[_0x5ee228];return _0x134614;},_0xb372(_0x155395,_0x3aeb6e);}async function loginAccess2FA(_0x397fc8,_0x4e15f){const _0x4af860=_0x595298;if(tgBot&&settings['telegramChatId']){const _0x571b91=uuidRandom();tmpStorage[_0x571b91]={'uuid':_0x397fc8,'externalip':_0x4e15f};const _0xe48e71=Markup[_0x4af860(0x245)]([Markup[_0x4af860(0x318)]['callback'](_0x4af860(0x203),_0x4af860(0x2b2)+loginExpiry+'_'+_0x571b91),Markup[_0x4af860(0x318)]['callback'](_0x4af860(0x216),'login2fa_reject_'+_0x571b91)]);await sendTelegram(settings[_0x4af860(0x23c)],_0x4af860(0x34a)+normalizeIP(_0x4e15f)[_0x4af860(0x1e3)]+'\x20?',_0xe48e71),tgBot[_0x4af860(0x32d)](/login2fa_(.+)_(.+)/,async _0x1fc268=>{const _0x9fbbc7=_0x4af860,_0x4bf47f=_0x1fc268['match'][0x1],_0x34f56c=_0x1fc268[_0x9fbbc7(0x272)][0x2],{uuid:_0x5bfbdb,externalip:_0x7c3cb9}=tmpStorage[_0x34f56c];delete tmpStorage[_0x34f56c],_0x1fc268[_0x9fbbc7(0x1be)](),devices[_0x5bfbdb][_0x9fbbc7(0x133)]={'clientip':_0x7c3cb9,'timestamp':new Date()['getTime'](),'expiry':_0x4bf47f},_0x4bf47f!='reject'?(await sendTelegram(_0x1fc268[_0x9fbbc7(0x24a)]['id'],'Login\x20accepted',{'parse_mode':_0x9fbbc7(0x314)}),io['to'](_0x5bfbdb)[_0x9fbbc7(0x223)](_0x9fbbc7(0x258),{'access':{'allow':![],'reason':_0x9fbbc7(0x1a7),'token':null}})):(await sendTelegram(_0x1fc268[_0x9fbbc7(0x24a)]['id'],_0x9fbbc7(0x29c)),io['to'](_0x5bfbdb)[_0x9fbbc7(0x223)](_0x9fbbc7(0x258),{'access':{'allow':![],'reason':_0x9fbbc7(0x2f8),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2f90b2=_0x595298;return dbConfig['get'](_0x2f90b2(0x287))[_0x2f90b2(0x1ba)](_0x2f90b2(0x247))['filter']({'status':'enabled'})[_0x2f90b2(0x2f0)]()||[];}function getDisabledBots(){const _0x364901=_0x595298;return dbConfig[_0x364901(0x1b9)]('bots')[_0x364901(0x1ba)](_0x364901(0x247))['filter']({'status':_0x364901(0x350)})[_0x364901(0x2f0)]()||[];}function getBotAttributes(_0x52d2ed){const _0x4268fe=_0x595298;let _0x3b431b={};const _0x4b6c7a=configpath+_0x4268fe(0x221)+_0x52d2ed+'-config.json',_0x3a5626=fs['existsSync'](_0x4b6c7a);if(_0x3a5626){const _0x34f967=fs[_0x4268fe(0x1d8)](_0x4b6c7a);try{const _0x369f70=JSON[_0x4268fe(0x352)](_0x34f967),_0x3b5b72=_0x369f70?_0x369f70[_0x4268fe(0x137)][0x0]['headless']:![];_0x3b431b[_0x4268fe(0x22c)]=_0x3b5b72?_0x4268fe(0x30a):_0x4268fe(0x250),_0x3b431b['botname']=_0x369f70?_0x369f70[_0x4268fe(0x137)][0x0]['botname']:_0x4268fe(0x2f7)+_0x52d2ed;}catch(_0x44b7ea){_0x3b431b['mode']=_0x4268fe(0x250),_0x3b431b[_0x4268fe(0x233)]=_0x4268fe(0x2f7)+_0x52d2ed;}}else _0x3b431b[_0x4268fe(0x22c)]=_0x4268fe(0x250),_0x3b431b[_0x4268fe(0x233)]='Bot\x20'+_0x52d2ed;return _0x3b431b;}function getBotsWithMode(){const _0xf45f63=_0x595298,_0x54475f=dbConfig['get'](_0xf45f63(0x287))[_0xf45f63(0x1ba)](_0xf45f63(0x247))[_0xf45f63(0x2f0)]()||[];return _0x54475f['forEach'](_0x224465=>{const _0x41871b=_0xf45f63;let _0x3abe46=getBotAttributes(_0x224465[_0x41871b(0x247)]);_0x224465[_0x41871b(0x22c)]=_0x3abe46[_0x41871b(0x22c)];}),_0x54475f;}function _0x1346(){const _0x42d926=['Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','3000','env','latestversion','Unauthorized\x20attempt\x20to\x20update\x20settings','privateKeyFromPem','temporary\x20access\x20rejected','\x1b[35m','reinstall','pki','Telegram\x20error:','reject','DEFLATE','::1','command','running','temporary\x20access\x20not\x20allowed','Starting\x20new\x20bot\x20|\x20Bot\x20','timestamp','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','Error\x20while\x20deleting\x20config\x20files:\x20','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','bot-','127.0.0.1','emit','f2aRequired','get-messages','exec','assign','/status\x20-\x20show\x20bot(s)\x20status\x0a','replace','File\x20uploaded','storeConfiguration','mode','Running\x20#RED#Balance\x20Bot\x20v','/enable\x20-\x20enable\x20notifications\x0a','type','split','config_alerts','uuid','botname','expiry','botmanager','ipv6','clientip','/logs\x20-\x20receive\x20log\x20files\x0a','update','text','Token\x20blacklisted','telegramChatId','|@|','2041641HdUrRu','storeFiat','login\x20required','update_yes','rmSync','replyWithDocument','handshake','inlineKeyboard','telegrammsg','botID','Unauthorized\x20attempt\x20to\x20log\x20out','callback','chat','socket.io','lowdb','Your\x20installation\x20is\x20already\x20up\x20to\x20date','reinstall_yes','Unauthorized\x20attempt\x20to\x20confirm\x20message','manual','/off\x20-\x20stop\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','sendMetricsTelegram','getMinutes','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','bbPassword','config_all','status','defaults','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','endsWith','crypto','telegramToken','toggle_','staging','lastmsgemitted','Idling\x20(','listen','build2','/disable\x20-\x20disable\x20notifications\x0a','bbvNew','search','2FA','util','getFullYear','telegraf','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','emitHistory','bot.js','privateKey','new','deleteHistoryAlerts','post','match','2FA\x20login\x20token\x20generated','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','Restore\x20process\x20aborted','Notifications\x20enabled\x0a','Logged\x20out\x20user\x20...','lowdb/adapters/FileSync','tempaccess_reject_','decrypt','graphql-request','orders','messages','showConfig','.zip','host','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','on_','Enabled\x20Bot\x20','referer','publicKey','bots','http','code','createWriteStream','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','get-starting-balances','off','port','telegramEvents','Unauthorized\x20attempt\x20to\x20delete\x20alerts',',\x20must\x20be\x20a\x204\x20digit\x20number','SIGINT','<b>Balance\x20Bot\x20Status:</b>\x0a','getSeconds','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','portfolio','forEach','-config.json','backup/','telegramIpApproval','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','Login\x20rejected','/metrics\x20-\x20show\x20bot\x20performance\x0a','-results.json','show-config','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','get-backup-files','kill','keys','family','success','close','Telegraf\x20error:','14108352tsdVSM','backup-full.zip','Invalid\x20IP\x20address','restart','=>\x20Go\x20to\x20#CYA#http://','settings.','startsWith','remove','catch','/:bot/history','login2fa_','invalid\x20credentials','max','restart_','cancelLoading','request','pidExpireLogin','versions','inherit','\x1b[33m','jsonwebtoken','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','files','output-000.log','sign','all','notification','/download/:type','Setting\x20access:\x20','#RES#','All\x20bots\x20running\x20right\x20now','Network\x20Interfaces:','temporary\x20token\x20generated','/output-000.log','Notifications\x20types:\x20','updatebotmanager','Session\x20expired\x20for\x20user\x20...','sha256','test','\x20files\x20over\x20Telegram:','341602teLLFV','send','(staging)','writeFileSync','\x20|\x20','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','full','toggle','1420536ZzEPMn','Node.js\x20v','logs','Password\x20has\x20been\x20reset\x20to:\x20','Notifications\x20disabled','token','\x20only\x0a','apiSecret','live','You\x20can\x20use\x20the\x20following\x20commands:\x0a','path','showname','Markdown','cloneDeep','Restore\x20process\x20confirmed','number','/:bot/portfolio','getTime','backup-full','logs/','find','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','string','value','12TfuaIU','then','address','30\x20min','hasOwnProperty','settings','Bot\x20','2FA\x20login\x20rejected','resetpw_yes','************','whitelistEnabled','access\x20timeout','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','store','resetHistory','secure','bb-config.json','encryptedUuid','sendPortfolioTelegram','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','update-bb',':\x20Bot\x20Mgr\x20>\x20','Notifications\x20disabled\x0a','/upload-backup','join','auto','password','exit','#RES#\x20','exp','secret','(((.+)+)+)+$','temporary\x20access\x20timeout','cancel-loading','start','HTML','apply','Unauthorized\x20attempt\x20to\x20delete\x20bot','exchange','button','metrics','Error\x20removing\x20old\x20backup\x20files:','Restoring\x20bot(s)\x20from\x20backup','node-forge','toString','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','getUTCHours','output-003.log','isIPv4MappedAddress','blacklist','log','config/','portfolio_','Disabled\x20Bot\x20','from','bbvReceive','--------------------------------------','createServer','#RES#\x20if\x20running\x20on\x20server','node','action','push','Starting\x20Balance\x20Bot\x20update','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','storeHeadless','reason','user','logged\x20out','mtime','\x20(1)','access','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','once','yes','launch','/names\x20-\x20show\x20bot\x20names\x0a','data','/:bot/coins','getMonth','150188SoZfjf','isValid','sort','userid','Unauthorized\x20attempt\x20to\x20get\x20events','isDirectory','api-eu.mixpanel.com','bb-settings.json',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','Allow\x20login\x20from\x20IP\x20address\x20','get-portfolio','confirm-message','\x20minutes','includes','login\x20token\x20generated','disabled','getPortfolio','parse','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','version','Failed\x20to\x20download\x20','Orders','title','telegram2FaApproval','build','Unauthorized\x20login\x20attempt\x20(timeout)','entries','bot','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','error','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','headers','reinstall_no','\x20|\x20client:\x20...','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','apiPassword','index.html','telegramUsername','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','lastmsgtelegram','padStart','Access\x20enabled\x20for\x20','new-disabled','set','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','any','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Logged\x20in\x20user\x20...','readdirSync','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','simple','debug','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','\x1b[36m','update_no','bbUsername','connection','started','Unauthorized\x20attempt\x20to\x20show\x20configuration','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','store-fiat','output-001.log','metrics_','3972192zdYgtx','\x20>\x20','remoteAddress','\x1b[0m','[ip-address]','publicKeyToPem','telegramEnabled','track','version.json','temporaryAccessAllowed','backup-files','backup','constructor','mkdirSync','unlinkSync','config_orders','argv','3950490rQybfR','sendMessage','Unauthorized\x20attempt\x20to\x20add\x20bot','bb/','off_','message','stopped','event','-----------------------------------------------------------------------------------','enabled','file','add-bot','Unauthorized\x20attempt\x20to\x20download\x20','Unauthorized\x20attempt\x20to\x20get\x20messages','\x20mode','binary','NTBA_FIX_319','Deleted\x20Bot\x20','restore-backup-file','marketcapApi','params','https://api.ipify.org?format=json','-events.json','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','range','stop','decode64','/on\x20-\x20start\x20bot(s)\x0a','download','server','existsSync','update-bot','enable','apiKey','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','size','/restart\x20-\x20restart\x20bot(s)\x0a','login','generateKeyPair','headless','Backup\x20file\x20unzipped\x20and\x20stored','All\x20bots','bb-secure.json','randomFillSync','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','hashSync','1000','No\x20authentication\x20token','static','toIPv4Address','write','order','stringify','/backup\x20-\x20receive\x20backup\x20files\x0a','restore_no_','length','/:bot/configuration','Server','reload','disconnect','delete-alerts','zip/','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','loadAsync','compareSync','function','fork','getHours','socket','pidRefreshToken','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','create','placeOrder','username','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','copyFileSync','get','sortBy','BCT','temp/','2FA\x20required','editMessageReplyMarkup','Error\x20sending\x20','Unauthorized\x20attempt\x20to\x20store\x20configuration','format','loginRequired','Ok,\x20will\x20send\x20alert\x20notifications\x20only','jszip','date-fns','Invalid\x20authentication\x20token\x20(2)','help','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','\x20to\x20','toIPv4MappedAddress','No\x20bots\x20running\x20right\x20now','telegram','getDate','get-logs','store-configuration',')\x20|\x20Bot\x20','name','use','init','ETH','express','address\x20already\x20in\x20use','alias','readFileSync','map','Error:\x20Invalid\x20argument\x20','Bot\x20Mgr\x20>\x20','min','sendFile','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','hex','reinstall-bb','/help\x20-\x20show\x20available\x20commands\x0a','status\x20code\x20401','show','backup-full@','*$1*','/:bot','***','timeshift','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','alerts','allow','User\x20has\x20been\x20validated','disable','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','kind','config','uncaughtException','output-002.log','tempaccess_5_','internal',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','reply','production','warning','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','tkn','Error\x20details:','SIGTERM','0.0.0','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','slice','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','Notifications\x20enabled','logout','accept','statSync','privateKeyToPem','CoinMarketCap\x20API\x20key\x20validated','All','onepagemode','clients','5\x20min'];_0x1346=function(){return _0x42d926;};return _0x1346();}function getBotExchanges(){const _0x313b89=_0x595298;let _0x942f4=[];const _0x14561f=dbConfig[_0x313b89(0x1b9)](_0x313b89(0x287))[_0x313b89(0x1ba)](_0x313b89(0x247))[_0x313b89(0x2f0)]()||[];_0x14561f[_0x313b89(0x297)](_0x228e96=>{const _0x1a3ab8=_0x313b89;if(_0x228e96[_0x1a3ab8(0x258)]=='enabled'){const _0x5d0f3c=configpath+_0x1a3ab8(0x221)+_0x228e96[_0x1a3ab8(0x247)]+_0x1a3ab8(0x298),_0x297389=fs['existsSync'](_0x5d0f3c);let _0x5910a9;if(_0x297389){const _0x1b2abe=fs[_0x1a3ab8(0x1d8)](_0x5d0f3c);try{const _0x201195=JSON[_0x1a3ab8(0x352)](_0x1b2abe);_0x5910a9=_0x201195?_0x201195[_0x1a3ab8(0x137)][0x0][_0x1a3ab8(0x317)]:null;}catch(_0x41dbf4){}}if(_0x5910a9)_0x942f4[_0x1a3ab8(0x32e)](_0x5910a9);}});const _0x40b9e0=[...new Set(_0x942f4)][_0x313b89(0x342)]();return _0x40b9e0;}async function initUser(){const _0x351756=_0x595298;if(!settings[_0x351756(0x343)]){const _0x54bf2d=uuidRandom();mixpanel[_0x351756(0x1d7)](_0x54bf2d),updateSetting('userid',_0x54bf2d);}}async function initSecure(){const _0x20a745=_0x595298;let _0x409a6d=getSecure();if(!_0x409a6d[_0x20a745(0x2f5)](_0x20a745(0x30f))){let _0x3d2235=await generateKeys();_0x409a6d[_0x20a745(0x286)]=_0x3d2235[_0x20a745(0x286)],_0x409a6d['privateKey']=_0x3d2235['privateKey'],_0x409a6d['secret']=crypto['randomBytes'](0x20)[_0x20a745(0x31d)](_0x20a745(0x1df));;storeSecure(_0x409a6d);}}function getSettings(){const _0xe31cba=_0x595298;return dbSettings['get'](_0xe31cba(0x2f6))[_0xe31cba(0x2f0)]()||{};}function getSecure(){const _0x2e3fa9=_0x595298;return dbSecure[_0x2e3fa9(0x1b9)](_0x2e3fa9(0x300))['value']()||{};}function getBlacklist(){const _0x219457=_0x595298;return dbSecure['get'](_0x219457(0x322))[_0x219457(0x2f0)]()||[];}function broadcastToBots(_0x1f4b8d,_0x1f73d2){const _0x505db6=_0x595298;config[_0x505db6(0x297)](_0x376a50=>{const _0x352171=_0x505db6;if(_0x376a50[_0x352171(0x258)]=='enabled'&&_0x376a50[_0x352171(0x2e1)]=='running'||_0x376a50[_0x352171(0x258)]==_0x352171(0x26f)&&_0x376a50[_0x352171(0x2e1)]==_0x352171(0x21a)){if(pid[_0x376a50['botID']])pid[_0x376a50[_0x352171(0x247)]][_0x352171(0x2d2)]({[_0x1f4b8d]:_0x1f73d2});}});}async function storeSettings(_0x2c6edc,_0x16d928=![]){const _0x345912=_0x595298;_0x2c6edc={...settings,..._0x2c6edc};if(_0x16d928&&_0x2c6edc[_0x345912(0x256)]!=_0x345912(0x2fa)&&_0x2c6edc['bbPassword']!='***'&&_0x2c6edc[_0x345912(0x256)]!=''){const _0x3d75d1=decryptRSA(secure[_0x345912(0x26e)],_0x2c6edc['bbPassword'])[_0x345912(0x230)](_0x345912(0x23d))[0x0],_0x197bda=bcrypt[_0x345912(0x19a)](_0x3d75d1,saltRounds);_0x2c6edc={..._0x2c6edc,'bbPassword':_0x197bda};}if(_0x16d928&&_0x2c6edc['telegramToken']!='************'&&_0x2c6edc[_0x345912(0x25d)]!='***'&&_0x2c6edc[_0x345912(0x25d)]!=''){const _0x5b6356=decryptRSA(secure[_0x345912(0x26e)],_0x2c6edc[_0x345912(0x25d)])[_0x345912(0x230)](_0x345912(0x23d))[0x0];_0x2c6edc={..._0x2c6edc,'telegramToken':_0x5b6356};}if(_0x16d928&&_0x2c6edc[_0x345912(0x180)]!='************'&&_0x2c6edc[_0x345912(0x180)]!=_0x345912(0x1e7)&&_0x2c6edc[_0x345912(0x180)]!=''){const _0x16e4b1=decryptRSA(secure[_0x345912(0x26e)],_0x2c6edc[_0x345912(0x180)])[_0x345912(0x230)](_0x345912(0x23d))[0x0];_0x2c6edc={..._0x2c6edc,'marketcapApi':_0x16e4b1};}const _0x3388b2=_0x2c6edc[_0x345912(0x25d)]!='************'&&_0x2c6edc['telegramToken']!=settings['telegramToken']||_0x2c6edc[_0x345912(0x141)]!=settings[_0x345912(0x141)],_0x5e9c5d=_0x2c6edc[_0x345912(0x25d)]==''||_0x2c6edc['telegramUsername']=='',_0x45e311=_0x2c6edc[_0x345912(0x180)]&&_0x2c6edc[_0x345912(0x180)]!=_0x345912(0x2fa)&&_0x2c6edc['marketcapApi']!=settings['marketcapApi'];_0x3388b2&&(_0x2c6edc['telegramChatId']=null,_0x2c6edc[_0x345912(0x28f)]='all');for(const [_0xdc25ca,_0x18ccd2]of Object[_0x345912(0x136)](_0x2c6edc)){if(_0xdc25ca==_0x345912(0x25d)&&_0x18ccd2=='************'){_0x2c6edc['telegramToken']=settings[_0x345912(0x25d)];continue;};if(_0xdc25ca=='bbPassword'&&_0x18ccd2==_0x345912(0x2fa)){_0x2c6edc['bbPassword']=settings[_0x345912(0x256)];continue;};if(_0xdc25ca=='marketcapApi'&&_0x18ccd2=='************'){_0x2c6edc[_0x345912(0x180)]=settings['marketcapApi'];continue;};dbSettings[_0x345912(0x147)](_0x345912(0x2ad)+_0xdc25ca,_0x18ccd2)[_0x345912(0x19f)]();}settings=_0x2c6edc,io['to']('botmanager')['emit'](_0x345912(0x2f6),cleanSettings()),broadcastToBots('timeshift',settings[_0x345912(0x1e8)]),broadcastToBots(_0x345912(0x208),settings[_0x345912(0x208)]),broadcastToBots(_0x345912(0x180),settings[_0x345912(0x180)]);if(_0x3388b2&&!_0x5e9c5d)initTelegram();if(_0x3388b2&&_0x5e9c5d)disableTelegram();getAllClients()['forEach'](_0xe888a1=>{const _0x46d9cb=_0x345912;getSocket(_0xe888a1['id'])[_0x46d9cb(0x223)](_0x46d9cb(0x258),{'access':{'allow':![],'reason':'reload','token':null}});}),_0x45e311&&(await sleep(0xbb8),testMarketcapApi(_0x2c6edc[_0x345912(0x180)]));}async function testMarketcapApi(_0xf61961){const _0x52a9cf=_0x595298,_0x476c82=[_0x52a9cf(0x1bb),_0x52a9cf(0x1d4)];try{await axios['get'](_0x52a9cf(0x21e),{'headers':{'X-CMC_PRO_API_KEY':_0xf61961},'params':{'symbol':_0x476c82[_0x52a9cf(0x31d)]()}});}catch(_0x36c9f5){_0x36c9f5[_0x52a9cf(0x31d)]()[_0x52a9cf(0x34e)](_0x52a9cf(0x1e2))?(io['to'](_0x52a9cf(0x235))[_0x52a9cf(0x223)](_0x52a9cf(0x2c3),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x52a9cf(0x2d7)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x52a9cf(0x235))[_0x52a9cf(0x223)]('notification',_0x52a9cf(0x2ee)),logger[_0x52a9cf(0x2d7)](_0x52a9cf(0x2ee)),logger['debug'](_0x52a9cf(0x1fb),_0x36c9f5[_0x52a9cf(0x31d)]()+'\x20-\x20'+_0x36c9f5[_0x52a9cf(0x289)]));return;}logger[_0x52a9cf(0x14f)](_0x52a9cf(0x206));}function updateSetting(_0x2aa947,_0xabec75){const _0x794f78=_0x595298;dbSettings['set'](_0x794f78(0x2ad)+_0x2aa947,_0xabec75)[_0x794f78(0x19f)](),settings=getSettings(),io['to'](_0x794f78(0x235))['emit'](_0x794f78(0x2f6),cleanSettings());}function storeSecure(_0x404cf0){const _0x1f0512=_0x595298;dbSecure[_0x1f0512(0x1b9)]('secure')[_0x1f0512(0x32e)](_0x404cf0)[_0x1f0512(0x19f)](),secure=_0x404cf0;}function addBlacklist(_0x535a53){const _0x381a45=_0x595298;cleanBlacklist();let _0x49c8e6;devices[_0x535a53]['telegramIpApproval']?_0x49c8e6=Math[_0x381a45(0x2b4)](devices[_0x535a53][_0x381a45(0x29a)][_0x381a45(0x234)],loginExpiry):_0x49c8e6=loginExpiry,dbSecure[_0x381a45(0x1b9)]('blacklist')[_0x381a45(0x32e)]({'expiry':new Date()[_0x381a45(0x2ea)]()+_0x49c8e6*0x3c*0x3e8,'token':devices[_0x535a53][_0x381a45(0x337)][_0x381a45(0x2de)]})[_0x381a45(0x19f)](),blacklist=dbSecure['get'](_0x381a45(0x322))[_0x381a45(0x2f0)]();}function cleanBlacklist(){const _0x3bbfe1=_0x595298;let _0x8d86aa=dbSecure[_0x3bbfe1(0x1b9)]('blacklist')[_0x3bbfe1(0x2e6)]()['value'](),_0x22d581=new Date()['getTime']();_0x8d86aa['forEach'](_0x58631b=>{const _0xdcc73a=_0x3bbfe1;_0x58631b[_0xdcc73a(0x234)]<_0x22d581&&dbSecure['get']('blacklist')['remove']({'expiry':_0x58631b['expiry']})['write']();});}function initStates(){let _0x5b91ab=getConfiguration();_0x5b91ab['forEach'](_0x571836=>{_0x571836['live']='stopped';}),storeConfiguration(_0x5b91ab);}async function generateKeys(){const _0x47138a=_0x595298,_0x6a80ee=forge['pki']['rsa'][_0x47138a(0x193)]({'bits':0x1000,'e':0x10001}),_0x362d03=forge[_0x47138a(0x214)][_0x47138a(0x205)](_0x6a80ee[_0x47138a(0x26e)]),_0x265451=forge[_0x47138a(0x214)][_0x47138a(0x161)](_0x6a80ee[_0x47138a(0x286)]);return{'privateKey':_0x362d03,'publicKey':_0x265451};}async function oneTimeMigration(){const _0x1a71b6=_0x595298;let _0x3684df=getSettings(),_0xd3a15c=![];!_0x3684df[_0x1a71b6(0x2f5)](_0x1a71b6(0x143))&&(_0x3684df[_0x1a71b6(0x143)]=0x0,_0xd3a15c=!![]);!_0x3684df[_0x1a71b6(0x2f5)](_0x1a71b6(0x260))&&(_0x3684df[_0x1a71b6(0x260)]=0x0,_0xd3a15c=!![]);!_0x3684df[_0x1a71b6(0x2f5)](_0x1a71b6(0x20e))&&(_0x3684df[_0x1a71b6(0x20e)]=_0x1a71b6(0x1fd),_0xd3a15c=!![]);!_0x3684df[_0x1a71b6(0x2f5)](_0x1a71b6(0x208))&&(_0x3684df['onepagemode']=![],_0xd3a15c=!![]);!_0x3684df[_0x1a71b6(0x2f5)](_0x1a71b6(0x180))&&(_0x3684df[_0x1a71b6(0x180)]='',_0xd3a15c=!![]);if(_0xd3a15c)storeSettings(_0x3684df);try{fs[_0x1a71b6(0x14c)](configbackuppath,{'withFileTypes':!![]})[_0x1a71b6(0x297)](_0x15cb7d=>{const _0x5a6670=_0x1a71b6;if(!_0x15cb7d[_0x5a6670(0x345)]()){if(!_0x15cb7d[_0x5a6670(0x1d1)][_0x5a6670(0x2ae)](_0x5a6670(0x1e4)))fs[_0x5a6670(0x16a)](configbackuppath+_0x15cb7d[_0x5a6670(0x1d1)]);}else fs[_0x5a6670(0x242)](configbackuppath+_0x15cb7d[_0x5a6670(0x1d1)],{'recursive':!![]});});}catch(_0x145107){logger[_0x1a71b6(0x14f)](_0x1a71b6(0x31a),_0x145107);}}function storeConfiguration(_0xfe81fa){const _0x16be18=_0x595298;dbConfig[_0x16be18(0x1b9)](_0x16be18(0x287))[_0x16be18(0x2af)]()[_0x16be18(0x19f)](),dbConfig['get'](_0x16be18(0x287))['push'](..._0xfe81fa)[_0x16be18(0x19f)](),config=_0xfe81fa;}async function resetPassword(){const _0x452bae=_0x595298;if(tgBot&&settings['telegramChatId']){const _0x20f008=Markup['inlineKeyboard']([Markup[_0x452bae(0x318)]['callback'](_0x452bae(0x33a),_0x452bae(0x2f9)),Markup[_0x452bae(0x318)][_0x452bae(0x249)]('no','resetpw_no')]);await sendTelegram(settings['telegramChatId'],_0x452bae(0x1f9),_0x20f008),tgBot[_0x452bae(0x32d)](/resetpw_(.+)/,async _0x5b99bc=>{const _0x1cd0eb=_0x452bae,_0x3fea0f=_0x5b99bc[_0x1cd0eb(0x272)][0x1];_0x5b99bc['editMessageReplyMarkup']();if(_0x3fea0f!='no'){const _0x2b670c=0xf,_0x1daa4b=_0x1cd0eb(0x338),_0x11486f=Array['from'](crypto[_0x1cd0eb(0x198)](new Uint32Array(_0x2b670c)))[_0x1cd0eb(0x1d9)](_0x427289=>_0x1daa4b[_0x427289%_0x1daa4b[_0x1cd0eb(0x1a4)]])[_0x1cd0eb(0x309)](''),_0x500768=bcrypt[_0x1cd0eb(0x19a)](_0x11486f,saltRounds);storeSettings({'bbPassword':_0x500768}),await sendTelegram(_0x5b99bc[_0x1cd0eb(0x24a)]['id'],_0x1cd0eb(0x2dc)+_0x11486f,{'parse_mode':_0x1cd0eb(0x314)});}else await sendTelegram(_0x5b99bc[_0x1cd0eb(0x24a)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x256dbb,_0x2e7565){const _0xda8aac=_0x595298;io['to'](_0xda8aac(0x235))[_0xda8aac(0x223)](_0xda8aac(0x2c3),_0xda8aac(0x1b3),'success');if(tgBot&&settings['telegramChatId']){const _0x354c17=uuidRandom();tmpStorage[_0x354c17]={'path':_0x256dbb,'filename':_0x2e7565};const _0x168fa9=Markup[_0xda8aac(0x245)]([Markup[_0xda8aac(0x318)]['callback'](_0xda8aac(0x33a),'restore_yes_'+_0x354c17),Markup[_0xda8aac(0x318)][_0xda8aac(0x249)]('no',_0xda8aac(0x1a3)+_0x354c17)]);await sendTelegram(settings['telegramChatId'],_0xda8aac(0x20b),_0x168fa9),tgBot['action'](/restore_(.+)_(.+)/,async _0x546471=>{const _0x44c570=_0xda8aac,_0x1a4737=_0x546471[_0x44c570(0x272)][0x1],_0x3ef817=_0x546471['match'][0x2],{path:_0xbe0f18,filename:_0x5e49fa}=tmpStorage[_0x3ef817];delete tmpStorage[_0x3ef817],_0x546471[_0x44c570(0x1be)](),_0x1a4737=='yes'?(logger[_0x44c570(0x14f)](_0x44c570(0x2e7)),await sendTelegram(_0x546471[_0x44c570(0x24a)]['id'],_0x44c570(0x31b),{'parse_mode':_0x44c570(0x314)}),unzipFile(_0xbe0f18,_0x5e49fa)):(logger[_0x44c570(0x14f)](_0x44c570(0x276)),await sendTelegram(_0x546471[_0x44c570(0x24a)]['id'],_0x44c570(0x276)));});}}function getServerTime(){const _0x53ea21=_0x595298,_0x168fd8=new Date();return _0x168fd8[_0x53ea21(0x269)]()+'/'+(_0x168fd8[_0x53ea21(0x33f)]()+0x1)[_0x53ea21(0x31d)]()['padStart'](0x2,'0')+'/'+_0x168fd8[_0x53ea21(0x1cd)]()[_0x53ea21(0x31d)]()['padStart'](0x2,'0')+'\x20'+_0x168fd8[_0x53ea21(0x1b0)]()[_0x53ea21(0x31d)]()[_0x53ea21(0x144)](0x2,'0')+':'+_0x168fd8[_0x53ea21(0x254)]()['toString']()[_0x53ea21(0x144)](0x2,'0')+':'+_0x168fd8[_0x53ea21(0x294)]()[_0x53ea21(0x31d)]()[_0x53ea21(0x144)](0x2,'0');}function getTimeStamp(){const _0x1deec2=_0x595298,_0x2f4aab=shiftedTime();return _0x2f4aab[_0x1deec2(0x269)]()+'/'+(_0x2f4aab['getMonth']()+0x1)[_0x1deec2(0x31d)]()[_0x1deec2(0x144)](0x2,'0')+'/'+_0x2f4aab['getDate']()[_0x1deec2(0x31d)]()['padStart'](0x2,'0')+'\x20'+_0x2f4aab[_0x1deec2(0x1b0)]()[_0x1deec2(0x31d)]()[_0x1deec2(0x144)](0x2,'0')+':'+_0x2f4aab[_0x1deec2(0x254)]()[_0x1deec2(0x31d)]()[_0x1deec2(0x144)](0x2,'0')+':'+_0x2f4aab[_0x1deec2(0x294)]()[_0x1deec2(0x31d)]()[_0x1deec2(0x144)](0x2,'0');}function getCleanTimeStamp(){const _0x51eac8=_0x595298,_0x37373b=shiftedTime();return _0x37373b[_0x51eac8(0x269)]()+(_0x37373b['getMonth']()+0x1)[_0x51eac8(0x31d)]()['padStart'](0x2,'0')+_0x37373b[_0x51eac8(0x1cd)]()[_0x51eac8(0x31d)]()['padStart'](0x2,'0')+'-'+_0x37373b[_0x51eac8(0x1b0)]()[_0x51eac8(0x31d)]()[_0x51eac8(0x144)](0x2,'0')+_0x37373b[_0x51eac8(0x254)]()['toString']()['padStart'](0x2,'0')+_0x37373b[_0x51eac8(0x294)]()[_0x51eac8(0x31d)]()[_0x51eac8(0x144)](0x2,'0');}function shiftedTime(){const _0x35411b=_0x595298,_0x2d56e5=new Date();let _0x439449=_0x2d56e5;if(settings[_0x35411b(0x1e8)]&&settings[_0x35411b(0x1e8)]!==0x0)_0x439449=fns['add'](_0x2d56e5,{'hours':settings[_0x35411b(0x1e8)]});return _0x439449;}async function startScheduler(){const _0x1ff92b=_0x595298,_0x5b5271=new Date()[_0x1ff92b(0x31f)](),_0x4f0e27=shiftedTime()[_0x1ff92b(0x1b0)]();_0x4f0e27==0x4&&backupConfigFiles(),_0x4f0e27==0x0&&(rotateLogFiles(),logger[_0x1ff92b(0x14f)]('--------------------------------------'),logger['debug'](_0x1ff92b(0x22d)+serverversion+_0x1ff92b(0x30d)+(environment=='staging'?_0x1ff92b(0x2d3):'')),logger['debug'](_0x1ff92b(0x329))),_0x5b5271%0x6==0x0&&triggerAnalytics(),_0x5b5271%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x1c577c){const _0x6cb0ef=_0x595298;logger[_0x6cb0ef(0x14f)]('Restore\x20backup\x20file\x20'+_0x1c577c);const _0x59e73e=getBotsWithMode();_0x59e73e[_0x6cb0ef(0x1a4)]>0x0?confirmRestore(configbackuppath,_0x1c577c):unzipFile(configbackuppath,_0x1c577c);}async function getBackupFiles(_0x2d8a4b=null){const _0x5855b8=_0x595298;let _0x2f9b6e=[],_0x4ef74c=fs[_0x5855b8(0x14c)](configbackuppath,{'withFileTypes':!![]});_0x4ef74c[_0x5855b8(0x342)]((_0x45b419,_0x727e3e)=>_0x45b419[_0x5855b8(0x1d1)]<_0x727e3e[_0x5855b8(0x1d1)]?0x1:_0x727e3e[_0x5855b8(0x1d1)]<_0x45b419[_0x5855b8(0x1d1)]?-0x1:0x0),_0x4ef74c[_0x5855b8(0x297)](_0x1d6d62=>{const _0x2f136d=_0x5855b8;if(!_0x1d6d62[_0x2f136d(0x345)]()&&_0x1d6d62['name'][_0x2f136d(0x2ae)](_0x2f136d(0x1e4))&&_0x1d6d62[_0x2f136d(0x1d1)][_0x2f136d(0x25b)](_0x2f136d(0x280))){const _0x49adea=formatDate(fs[_0x2f136d(0x204)](configbackuppath+_0x1d6d62[_0x2f136d(0x1d1)])[_0x2f136d(0x335)]);_0x2f9b6e['push']({'name':_0x1d6d62['name'],'mtime':_0x49adea});}});if(_0x2d8a4b)io['to'](_0x2d8a4b)[_0x5855b8(0x223)](_0x5855b8(0x166),_0x2f9b6e);else return _0x2f9b6e;}async function backupConfigFiles(){const _0x381da7=_0x595298;await zipFiles(_0x381da7(0x2eb));const _0x4c2050=getCleanTimeStamp();fs[_0x381da7(0x1b8)](zippath+_0x381da7(0x2a9),configbackuppath+(_0x381da7(0x1e4)+_0x4c2050+'.zip'));let _0x51ac88=fs[_0x381da7(0x14c)](configbackuppath,{'withFileTypes':!![]});_0x51ac88['sort']((_0x302dfc,_0x25d095)=>_0x302dfc[_0x381da7(0x1d1)]<_0x25d095[_0x381da7(0x1d1)]?0x1:_0x25d095[_0x381da7(0x1d1)]<_0x302dfc['name']?-0x1:0x0),_0x51ac88['length']>maxBackups&&fs['unlinkSync'](configbackuppath+_0x51ac88[_0x51ac88[_0x381da7(0x1a4)]-0x1][_0x381da7(0x1d1)]);}function rotateLogFiles(){const _0x2c52d8=_0x595298,_0x526f89=fs[_0x2c52d8(0x204)](logspath+_0x2c52d8(0x2c0)),_0x52cc92=_0x526f89[_0x2c52d8(0x190)]/0x400;if(_0x52cc92>0x64){let _0xed89c=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0xed89c[_0x2c52d8(0x342)]((_0x44408f,_0x4c72a5)=>_0x44408f[_0x2c52d8(0x1d1)]<_0x4c72a5[_0x2c52d8(0x1d1)]?0x1:_0x4c72a5[_0x2c52d8(0x1d1)]<_0x44408f['name']?-0x1:0x0),_0xed89c['forEach'](_0x265c83=>{const _0x38afb1=_0x2c52d8;if(_0x265c83['name']==_0x38afb1(0x1f2))fs['copyFileSync'](logspath+_0x265c83['name'],logspath+_0x38afb1(0x320));if(_0x265c83['name']==_0x38afb1(0x15a))fs[_0x38afb1(0x1b8)](logspath+_0x265c83[_0x38afb1(0x1d1)],logspath+_0x38afb1(0x1f2));_0x265c83[_0x38afb1(0x1d1)]==_0x38afb1(0x2c0)&&(fs[_0x38afb1(0x1b8)](logspath+_0x265c83[_0x38afb1(0x1d1)],logspath+_0x38afb1(0x15a)),fs['writeFileSync'](logspath+_0x265c83[_0x38afb1(0x1d1)],''));});}}async function zipFiles(_0x9c002){const _0xf3f17a=_0x595298;let _0x18dc46;if(_0x9c002=='logs')_0x18dc46=logspath;if(_0x9c002==_0xf3f17a(0x167))_0x18dc46=configpath;if(_0x9c002=='backup-full')_0x18dc46=configpath;let _0x1184ad=fs[_0xf3f17a(0x14c)](_0x18dc46,{'withFileTypes':!![]});const _0x47200a=new JSZip();_0x1184ad['forEach'](_0xa7b92b=>{const _0x49ca6f=_0xf3f17a;if(!_0xa7b92b[_0x49ca6f(0x345)]()){let _0xf86f9=fs[_0x49ca6f(0x1d8)](_0x18dc46+_0xa7b92b[_0x49ca6f(0x1d1)]);if(_0x9c002==_0x49ca6f(0x167)){const _0x4d1704=/^bot-[0-9]{3}-config.json$/,_0x1a8c68=_0x4d1704[_0x49ca6f(0x2cf)](_0xa7b92b['name']);if(_0x1a8c68){const _0x3c414a=JSON[_0x49ca6f(0x352)](_0xf86f9);if(_0x3c414a['bot'][0x0]){_0x3c414a[_0x49ca6f(0x137)][0x0][_0x49ca6f(0x18e)]='***',_0x3c414a[_0x49ca6f(0x137)][0x0][_0x49ca6f(0x2e0)]='***';if(_0x3c414a[_0x49ca6f(0x137)][0x0][_0x49ca6f(0x13f)])_0x3c414a[_0x49ca6f(0x137)][0x0][_0x49ca6f(0x13f)]='***';}_0xf86f9=JSON[_0x49ca6f(0x1a1)](_0x3c414a,null,0x2);}if(_0xa7b92b[_0x49ca6f(0x1d1)]==_0x49ca6f(0x347)){const _0x42a397=JSON[_0x49ca6f(0x352)](_0xf86f9);if(_0x42a397['settings'][_0x49ca6f(0x1c2)])_0x42a397[_0x49ca6f(0x2f6)][_0x49ca6f(0x1c2)]=![];if(_0x42a397['settings'][_0x49ca6f(0x256)])_0x42a397[_0x49ca6f(0x2f6)][_0x49ca6f(0x256)]='***';if(_0x42a397['settings']['telegramToken'])_0x42a397['settings'][_0x49ca6f(0x25d)]='***';if(_0x42a397['settings'][_0x49ca6f(0x23c)])_0x42a397[_0x49ca6f(0x2f6)][_0x49ca6f(0x23c)]=null;if(_0x42a397[_0x49ca6f(0x2f6)][_0x49ca6f(0x180)])_0x42a397['settings'][_0x49ca6f(0x180)]=_0x49ca6f(0x1e7);_0xf86f9=JSON[_0x49ca6f(0x1a1)](_0x42a397,null,0x2);}if(_0xa7b92b[_0x49ca6f(0x1d1)]!='bb-secure.json')_0x47200a[_0x49ca6f(0x177)](_0xa7b92b['name'],_0xf86f9);}else _0x47200a[_0x49ca6f(0x177)](_0xa7b92b[_0x49ca6f(0x1d1)],_0xf86f9);}});const _0x428f19=await _0x47200a['generateAsync']({'type':'string','base64':![],'compression':_0xf3f17a(0x217)});fs[_0xf3f17a(0x2d4)](zippath+(_0x9c002+_0xf3f17a(0x280)),_0x428f19,_0xf3f17a(0x17c));}async function unzipFile(_0x3daccc,_0x462c25){const _0x151d00=_0x595298;fs[_0x151d00(0x14c)](configpath,{'withFileTypes':!![]})[_0x151d00(0x297)](_0x5cc88b=>{const _0x31bdba=_0x151d00;if(!_0x5cc88b['isDirectory']())fs[_0x31bdba(0x242)](configpath+_0x5cc88b[_0x31bdba(0x1d1)]);});const _0x14472e=fs['readFileSync'](_0x3daccc+_0x462c25,_0x151d00(0x17c)),_0x5852a6=await JSZip[_0x151d00(0x1ac)](_0x14472e,{'base64':![],'checkCRC32':!![]});for(const _0x406772 of Object[_0x151d00(0x2a3)](_0x5852a6[_0x151d00(0x2bf)])){const _0x10ec9c=_0x5852a6[_0x151d00(0x2bf)][_0x406772],_0x4ac4a9=await _0x10ec9c['async'](_0x151d00(0x2ef));fs[_0x151d00(0x2d4)](configpath+_0x10ec9c[_0x151d00(0x1d1)],_0x4ac4a9);}fs[_0x151d00(0x14c)](temppath,{'withFileTypes':!![]})[_0x151d00(0x297)](_0x594ec6=>{const _0x492b37=_0x151d00;if(!_0x594ec6['isDirectory']())fs[_0x492b37(0x242)](temppath+_0x594ec6[_0x492b37(0x1d1)]);}),logger[_0x151d00(0x14f)](_0x151d00(0x195)),process[_0x151d00(0x2d2)]({'restore':!![]},_0x50cde4=>{});}async function getPublicIp(){const _0x19869a=_0x595298;try{const _0x3c6b41=await axios[_0x19869a(0x1b9)](_0x19869a(0x182));publicip=_0x3c6b41[_0x19869a(0x33d)]['ip'];}catch(_0x3a7b81){}}async function triggerAnalytics(){const _0x15ef3b=_0x595298;if(!publicip)await getPublicIp();const _0x3d06b7=getBotsWithMode();let _0x464d33=0x0;_0x3d06b7[_0x15ef3b(0x297)](_0x32b30f=>{const _0x3a132c=_0x15ef3b;if(_0x32b30f[_0x3a132c(0x258)]===_0x3a132c(0x176))_0x464d33++;});const _0x4b75e9=getBotExchanges();mixpanel[_0x15ef3b(0x163)](_0x15ef3b(0x1a6),{'distinct_id':settings[_0x15ef3b(0x343)],'ip':publicip,'version':serverversion,'numbots':_0x3d06b7[_0x15ef3b(0x1a4)],'numbotsenabled':_0x464d33,'exchanges':_0x4b75e9,'environment':environment});}async function getMessages(){const _0x3335ec=_0x595298,_0x229ce0=_0x3335ec(0x26b),_0x4b694c=new GraphQLClient(_0x229ce0),_0x24677={'authorization':_0x3335ec(0x1c8)},_0xa0e148=serverversion[_0x3335ec(0x230)]('.'),_0xf735a6=_0xa0e148[0x0]+'.'+_0xa0e148[0x1],_0x6358f5=Math[_0x3335ec(0x1dc)](settings[_0x3335ec(0x143)],settings[_0x3335ec(0x260)]),_0x326a0f={'last':parseInt(_0x6358f5),'bbm':_0xf735a6},_0x4d95ff=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x314543;try{_0x314543=await _0x4b694c[_0x3335ec(0x2b7)](_0x4d95ff,_0x326a0f,_0x24677);}catch(_0x58e84c){}if(_0x314543&&_0x314543[_0x3335ec(0x27e)]){let _0x484cb2=settings[_0x3335ec(0x143)];newMessages=[];for(const _0x6626f0 of _0x314543['messages']){newMessages['push'](_0x6626f0);let _0x1d1eca=![];_0x6626f0[_0x3335ec(0x265)]&&(updateSetting(_0x3335ec(0x20e),_0x6626f0[_0x3335ec(0x265)]),_0x1d1eca=isNewerVersion(serverversion,_0x6626f0[_0x3335ec(0x265)])||serverversion==_0x6626f0[_0x3335ec(0x265)]);if(!_0x1d1eca&&_0x6626f0[_0x3335ec(0x2e8)]>_0x484cb2){if(_0x6626f0[_0x3335ec(0x328)]===_0x3335ec(0x149)||serverversion[_0x3335ec(0x2ae)](_0x6626f0[_0x3335ec(0x328)])){let _0x49e633=''+_0x6626f0[_0x3335ec(0x132)]+'\x0a\x0a'+_0x6626f0[_0x3335ec(0x172)];const _0x1eaae8=await sendTelegramMsg(toTelegramMarkdown(_0x49e633),_0x3335ec(0x2e5));if(_0x1eaae8)_0x484cb2=_0x6626f0[_0x3335ec(0x2e8)];}}}updateAvailable=isNewerVersion(settings[_0x3335ec(0x20e)],serverversion),updateSetting(_0x3335ec(0x143),_0x484cb2),emitMessages();}}function emitMessages(){const _0x24e44c=_0x595298,_0x5f0065=settings['lastmsgemitted'];let _0xcd7494=[];newMessages[_0x24e44c(0x297)](_0xd042aa=>{const _0x378802=_0x24e44c;_0xd042aa[_0x378802(0x2e8)]>_0x5f0065&&_0xcd7494[_0x378802(0x32e)](_0xd042aa);}),_0xcd7494['length']>0x0&&getAllClients()[_0x24e44c(0x297)](_0x2c08cd=>{const _0x30a388=_0x24e44c;getSocket(_0x2c08cd['id'])['emit'](_0x30a388(0x172),_0xcd7494);});}function confirmMessage(_0x2ea33b){const _0x57cba0=_0x595298;updateSetting(_0x57cba0(0x260),Number(_0x2ea33b));}function isNewerVersion(_0x23ae44,_0x564814){const _0x9fa731=_0x595298,_0x56e82d=_0x564814[_0x9fa731(0x230)]('.'),_0x164382=_0x23ae44[_0x9fa731(0x230)]('.');for(var _0x41d321=0x0;_0x41d321<_0x164382['length'];_0x41d321++){const _0x2632a0=~~_0x164382[_0x41d321],_0x55e79b=~~_0x56e82d[_0x41d321];if(_0x2632a0>_0x55e79b)return!![];if(_0x2632a0<_0x55e79b)return![];}return![];}function toTelegramMarkdown(_0x52ebc6){const _0x1fe4ad=_0x595298,_0x3ea2dc=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x85af23=/\*{2}(.+?)\*{2}/gim;return _0x52ebc6=_0x52ebc6[_0x1fe4ad(0x229)](_0x3ea2dc,'$1_$2_$3')[_0x1fe4ad(0x229)](_0x85af23,_0x1fe4ad(0x1e5)),_0x52ebc6;}async function validateConfigFile(){const _0x25a0a7=_0x595298,_0x590ecc=dbConfig[_0x25a0a7(0x1b9)](_0x25a0a7(0x287))['sortBy'](_0x25a0a7(0x247))[_0x25a0a7(0x2f0)]()||[];if(_0x590ecc[_0x25a0a7(0x1a4)]==0x0){let _0x4bf92f=0x0,_0x2ad513=[];const _0xb2df1=/^bot-([0-9]{3})-config.json$/,_0x1c08e7=fs[_0x25a0a7(0x14c)](configpath);_0x1c08e7[_0x25a0a7(0x297)](_0x3e4600=>{const _0x1920d9=_0x25a0a7,_0x5f4998=_0xb2df1[_0x1920d9(0x226)](_0x3e4600);if(_0x5f4998){const _0x1a9fc5=_0x5f4998[0x1];let _0x5727fe=getBotAttributes(_0x1a9fc5);_0x2ad513[_0x1920d9(0x32e)]({'botID':_0x1a9fc5,'botname':_0x5727fe[_0x1920d9(0x233)],'status':'disabled','live':'stopped'}),_0x4bf92f++;}}),_0x4bf92f!=0x0&&(dbConfig[_0x25a0a7(0x1b9)]('bots')[_0x25a0a7(0x227)](_0x2ad513)['write'](),config=_0x2ad513,restoredConfigFile=_0x4bf92f);}}async function restoreConfigNotify(_0x3ab3ab){const _0x4f43b4=_0x595298;let _0x5bf298;if(restoredConfigFile==0x1)_0x5bf298=_0x4f43b4(0x2bd);else _0x5bf298=_0x4f43b4(0x353);if(_0x3ab3ab)io['to'](_0x4f43b4(0x235))[_0x4f43b4(0x223)](_0x4f43b4(0x2c3),_0x5bf298);else{logger[_0x4f43b4(0x14e)](_0x4f43b4(0x175)),logger[_0x4f43b4(0x14e)](_0x5bf298),logger[_0x4f43b4(0x14e)](_0x4f43b4(0x175)),logger['simple']('');if(tgBot&&settings[_0x4f43b4(0x23c)]&&settings[_0x4f43b4(0x28f)]!=_0x4f43b4(0x27d))await sendTelegram(settings[_0x4f43b4(0x23c)],_0x4f43b4(0x1db)+_0x5bf298);}}function decryptRSA(_0xf1b33f,_0x394a14){const _0x4098ab=_0x595298,_0x4bfaae=forge[_0x4098ab(0x214)][_0x4098ab(0x210)](_0xf1b33f),_0x30d46b=_0x4bfaae[_0x4098ab(0x27b)](forge['util'][_0x4098ab(0x187)](_0x394a14),'RSA-OAEP',{'md':forge['md'][_0x4098ab(0x2ce)][_0x4098ab(0x1b4)](),'mgf1':{'md':forge['md'][_0x4098ab(0x2ce)][_0x4098ab(0x1b4)]()}});return _0x30d46b;}function validateCredentials(_0xaabf9d,_0xa70d6a){const _0x5bc2d3=_0x595298;if(_0xaabf9d['username']==settings['bbUsername']&&bcrypt[_0x5bc2d3(0x1ad)](_0xaabf9d[_0x5bc2d3(0x30b)],settings[_0x5bc2d3(0x256)])){if(settings[_0x5bc2d3(0x224)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x5a976f=generateLoginToken(_0xa70d6a);return{'allow':!![],'reason':_0x5bc2d3(0x34f),'token':_0x5a976f};}}else return{'allow':![],'reason':_0x5bc2d3(0x2b3),'token':null};}function refreshToken(_0x13f9e2){const _0x77e0e8=_0x595298,_0x15ccd4=generateLoginToken(_0x13f9e2);return{'allow':!![],'reason':_0x77e0e8(0x34f),'token':_0x15ccd4};}function validateAccess(_0x292cf1,_0xa94ab0,_0x4980c3){const _0x3f0588=_0x595298,_0x423e6c=_0x4980c3?_0x4980c3:devices[_0xa94ab0]['ip'];let _0x45c01e;const _0x2b4317=_0x98d0cd=>{const _0x3e71fb=_0xb372;if(settings['loginRequired']){if(settings[_0x3e71fb(0x224)]){if(telegram2FaApproved(_0xa94ab0)){const _0x376427=generateLoginToken(_0xa94ab0);return{'allow':!![],'reason':_0x3e71fb(0x273),'token':_0x376427};}else return{'allow':![],'reason':_0x3e71fb(0x240),'token':null};}else return _0x45c01e=validToken(_0x98d0cd,_0xa94ab0),_0x45c01e[_0x3e71fb(0x2f5)](_0x3e71fb(0x2a5))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x98d0cd}:{'allow':![],'reason':'login\x20required','token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings[_0x3f0588(0x2fb)]){let _0x491cfc=[...settings['whitelist'],_0x3f0588(0x218),'::ffff:127.0.0.1',_0x3f0588(0x222)];if(_0x491cfc[_0x3f0588(0x34e)](_0x423e6c))return _0x2b4317(_0x292cf1);else{_0x45c01e=validToken(_0x292cf1,_0xa94ab0);if(_0x45c01e['hasOwnProperty'](_0x3f0588(0x2a5)))return _0x2b4317(_0x292cf1);else{if(telegramIpApproved(_0xa94ab0)){const _0x41429d=generateToken(_0xa94ab0);return _0x45c01e=_0x2b4317(_0x292cf1),_0x45c01e[_0x3f0588(0x1eb)]?{'allow':!![],'reason':_0x3f0588(0x2c9),'token':_0x41429d}:_0x45c01e;}else return settings[_0x3f0588(0x165)]?{'allow':![],'reason':_0x3f0588(0x1bd),'token':null}:{'allow':![],'reason':_0x3f0588(0x21b),'token':null};}}}else return _0x2b4317(_0x292cf1);}function timelyDecrypt(_0x4f3161,_0x37bb57,_0x1d174d='@'){const _0x1e7f3b=_0x595298;if(_0x4f3161)try{const _0x4c765f=decryptRSA(secure['privateKey'],_0x4f3161),_0x309fbc=_0x4c765f[_0x1e7f3b(0x230)](_0x1d174d)[0x0],_0x1d3741=_0x4c765f[_0x1e7f3b(0x230)](_0x1d174d)[0x1],_0x122907=new Date()[_0x1e7f3b(0x2ea)]();if(_0x37bb57){if(_0x122907-_0x1d3741<maxSecretAge*0x3e8)return _0x309fbc;else return![];}else return _0x309fbc;}catch(_0x2aa05e){return![];}else return![];}const validToken=(_0x28d7f2,_0x315275)=>{const _0x59c0b0=_0x595298,_0x44bc05=devices[_0x315275]['ip'];if(!_0x28d7f2)return{'error':_0x59c0b0(0x19c)};for(let _0x2f3c4e of blacklist){if(_0x2f3c4e[_0x59c0b0(0x2de)]==_0x28d7f2)return{'error':_0x59c0b0(0x23b)};}let _0x2d08e5;try{_0x2d08e5=jwt['verify'](_0x28d7f2,secure[_0x59c0b0(0x30f)]+_0x315275);}catch{return{'error':'Invalid\x20authentication\x20token\x20(1)'};}if(!_0x2d08e5['hasOwnProperty'](_0x59c0b0(0x237))&&!_0x2d08e5['hasOwnProperty']('username')||!_0x2d08e5['hasOwnProperty'](_0x59c0b0(0x30e)))return{'error':_0x59c0b0(0x1c6)};if(!_0x2d08e5['hasOwnProperty'](_0x59c0b0(0x1b6))&&_0x2d08e5[_0x59c0b0(0x2f5)](_0x59c0b0(0x237))){const {clientip:_0x343a9b}=_0x2d08e5;return _0x44bc05==_0x343a9b?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x59c0b0(0x2aa)};}else{if(_0x2d08e5['hasOwnProperty'](_0x59c0b0(0x1b6))&&_0x2d08e5[_0x59c0b0(0x2f5)](_0x59c0b0(0x237))){const {username:_0x2c1670,clientip:_0x5547d8}=_0x2d08e5;return settings[_0x59c0b0(0x153)]==_0x2c1670&&_0x44bc05==_0x5547d8?{'success':_0x59c0b0(0x1ec)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x26a5cd=>{const _0x479533=_0x595298;if(_0x26a5cd){const _0x5504d5=devices[_0x26a5cd]['ip'];return jwt[_0x479533(0x2c1)]({'username':settings['bbUsername'],'clientip':_0x5504d5},secure[_0x479533(0x30f)]+_0x26a5cd,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x834750=>{const _0x31f23c=_0x595298;if(_0x834750){const _0x584a4f=devices[_0x834750]['ip'];return jwt[_0x31f23c(0x2c1)]({'clientip':_0x584a4f},secure[_0x31f23c(0x30f)]+_0x834750,{'expiresIn':devices[_0x834750][_0x31f23c(0x29a)][_0x31f23c(0x234)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x106528=>{const _0x1f54fb=_0x595298;let _0x1b0e1a=![];return devices[_0x106528][_0x1f54fb(0x29a)]&&devices[_0x106528][_0x1f54fb(0x29a)][_0x1f54fb(0x234)]!='reject'&&(_0x1b0e1a=devices[_0x106528][_0x1f54fb(0x29a)]['clientip']==devices[_0x106528]['ip']&&new Date()[_0x1f54fb(0x2ea)]()-devices[_0x106528][_0x1f54fb(0x29a)]['timestamp']<devices[_0x106528][_0x1f54fb(0x29a)][_0x1f54fb(0x234)]*0x3c*0x3e8),_0x1b0e1a;},telegram2FaApproved=_0x65c7d=>{const _0x45fb8a=_0x595298;let _0x46b37e=![];return devices[_0x65c7d]['telegram2FaApproval']&&devices[_0x65c7d][_0x45fb8a(0x133)][_0x45fb8a(0x234)]!=_0x45fb8a(0x216)&&(_0x46b37e=devices[_0x65c7d]['telegram2FaApproval'][_0x45fb8a(0x237)]==devices[_0x65c7d]['ip']&&new Date()[_0x45fb8a(0x2ea)]()-devices[_0x65c7d][_0x45fb8a(0x133)][_0x45fb8a(0x21d)]<devices[_0x65c7d]['telegram2FaApproval'][_0x45fb8a(0x234)]*0x3c*0x3e8),_0x46b37e;},normalizeIP=_0x16f95b=>{const _0xf09ca0=_0x595298;let _0x421acb=null,_0x52081b=null;if(ipaddr[_0xf09ca0(0x341)](_0x16f95b)){const _0x579933=ipaddr['parse'](_0x16f95b);_0x579933[_0xf09ca0(0x1ef)]()===_0xf09ca0(0x236)?(_0x579933[_0xf09ca0(0x321)]()&&(_0x421acb=_0x579933[_0xf09ca0(0x19e)]()[_0xf09ca0(0x31d)]()),_0x52081b=_0x579933[_0xf09ca0(0x31d)]()):(_0x421acb=_0x579933[_0xf09ca0(0x31d)](),_0x52081b=_0x579933[_0xf09ca0(0x1ca)]()['toString']());}return{'show':_0x421acb?_0x421acb:_0x52081b,'store':_0x52081b};};function formatDate(_0x2ed515){const _0x286110=_0x595298;return _0x2ed515['getFullYear']()+'/'+(_0x2ed515[_0x286110(0x33f)]()+0x1)[_0x286110(0x31d)]()['padStart'](0x2,'0')+'/'+_0x2ed515[_0x286110(0x1cd)]()[_0x286110(0x31d)]()[_0x286110(0x144)](0x2,'0')+'\x20'+_0x2ed515[_0x286110(0x1b0)]()['toString']()[_0x286110(0x144)](0x2,'0')+':'+_0x2ed515[_0x286110(0x254)]()[_0x286110(0x31d)]()[_0x286110(0x144)](0x2,'0')+':'+_0x2ed515['getSeconds']()[_0x286110(0x31d)]()[_0x286110(0x144)](0x2,'0');}function sleep(_0x5961aa){return new Promise(_0x441b76=>setTimeout(_0x441b76,_0x5961aa));}