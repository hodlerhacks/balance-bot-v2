const _0x394128=_0x3606;(function(_0x42b05f,_0x3b5733){const _0xdd4d9a=_0x3606,_0x4c60cd=_0x42b05f();while(!![]){try{const _0x25eb0f=parseInt(_0xdd4d9a(0xc7))/0x1+parseInt(_0xdd4d9a(0x210))/0x2*(-parseInt(_0xdd4d9a(0x163))/0x3)+-parseInt(_0xdd4d9a(0x192))/0x4*(parseInt(_0xdd4d9a(0x1f3))/0x5)+parseInt(_0xdd4d9a(0xb9))/0x6*(parseInt(_0xdd4d9a(0x226))/0x7)+-parseInt(_0xdd4d9a(0xbc))/0x8+parseInt(_0xdd4d9a(0x1e1))/0x9*(parseInt(_0xdd4d9a(0x1b3))/0xa)+parseInt(_0xdd4d9a(0x25e))/0xb*(-parseInt(_0xdd4d9a(0x29a))/0xc);if(_0x25eb0f===_0x3b5733)break;else _0x4c60cd['push'](_0x4c60cd['shift']());}catch(_0x48af02){_0x4c60cd['push'](_0x4c60cd['shift']());}}}(_0x2b11,0x5b869));const _0x22a87e=function(){let _0x19df40=!![];return function(_0x51c7f8,_0x1eac4e){const _0x1c3c0e=_0x19df40?function(){const _0x26ce6e=_0x3606;if(_0x1eac4e){const _0x2c38bf=_0x1eac4e[_0x26ce6e(0x1d1)](_0x51c7f8,arguments);return _0x1eac4e=null,_0x2c38bf;}}:function(){};return _0x19df40=![],_0x1c3c0e;};}(),_0x2163e4=_0x22a87e(this,function(){const _0xed4af=_0x3606;return _0x2163e4[_0xed4af(0x1ee)]()[_0xed4af(0x286)](_0xed4af(0x1a3))[_0xed4af(0x1ee)]()[_0xed4af(0x252)](_0x2163e4)['search'](_0xed4af(0x1a3));});_0x2163e4();'use strict';process[_0x394128(0x127)]['NTBA_FIX_319']=0x1;const childProcess=require(_0x394128(0x1b7)),fs=require('fs'),fns=require('date-fns'),low=require('lowdb'),FileSync=require(_0x394128(0x1be)),path=require(_0x394128(0xf3)),crypto=require('crypto'),forge=require(_0x394128(0x182)),bcrypt=require(_0x394128(0x236)),jwt=require(_0x394128(0x242)),ipaddr=require('ipaddr.js'),argv=require('yargs/yargs')(process[_0x394128(0x167)][_0x394128(0x120)](0x2))[_0x394128(0x167)],uuidRandom=require(_0x394128(0x260)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require('mixpanel'),axios=require(_0x394128(0x2a5)),{GraphQLClient,gql}=require(_0x394128(0x164)),util=require(_0x394128(0x9a)),fileUpload=require('express-fileupload'),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv['port']||_0x394128(0x159),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x394128(0x1cb)](_0x394128(0x18c)+PORT+_0x394128(0x144)),process['exit'](0x1));const HOST=argv[_0x394128(0x132)]||null,userID=argv['user']||'',debugging=argv['d']||![],nodeversion=process[_0x394128(0x25b)][_0x394128(0xeb)];let bbpath=_0x394128(0x165),bbpath2='';const botfile=_0x394128(0x1f2),configfile=_0x394128(0x248),settingsfile=_0x394128(0x23e),securefile=_0x394128(0x13c),environment=require('./'+bbpath2+_0x394128(0x1a5))[_0x394128(0x229)]||_0x394128(0x1a6),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x394128(0x119)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x394128(0x197)),configpath=userID?bbpath+_0x394128(0x10e)+userID+'/':bbpath+_0x394128(0x10e),configbackuppath=configpath+_0x394128(0x1b0),logspath=userID?bbpath+_0x394128(0x202)+userID+'/':bbpath+_0x394128(0x202),zippath=userID?bbpath+'zip/'+userID+'/':bbpath+'zip/',loggerfile=fs[_0x394128(0xef)](logspath+_0x394128(0xa1),{'flags':'a'}),temppath=userID?bbpath+_0x394128(0x14a)+userID+'/':bbpath+_0x394128(0x14a);!fs[_0x394128(0x119)](configpath)&&fs[_0x394128(0x2aa)](configpath);!fs[_0x394128(0x119)](configbackuppath)&&fs[_0x394128(0x2aa)](configbackuppath);!fs[_0x394128(0x119)](logspath)&&fs[_0x394128(0x2aa)](logspath);!fs[_0x394128(0x119)](zippath)&&fs[_0x394128(0x2aa)](zippath);!fs[_0x394128(0x119)](temppath)&&fs[_0x394128(0x2aa)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x394128(0x128)]({'bots':[]})[_0x394128(0xd0)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x394128(0x128)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x394128(0xae),'onepagemode':![],'marketcapApi':''}})[_0x394128(0xd0)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x394128(0x128)]({'secure':{},'blacklist':[]})['write']();const saltRounds=0xa,mixpanel=Mixpanel['init'](_0x394128(0x209),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x394128(0x169)]&&(settings[_0x394128(0x169)]!=''&&settings[_0x394128(0x169)]!=_0x394128(0x1c0))&&settings[_0x394128(0x21f)]&&settings[_0x394128(0x21f)]!='')initTelegram();const parseColor=(_0x16f2b5,_0x250195)=>{const _0x5b27fd=_0x394128,_0x5b71dd=/#[A-Z]{3}#/g;if(typeof _0x16f2b5==_0x5b27fd(0x9f)){!_0x250195?_0x16f2b5=_0x16f2b5['replace'](_0x5b71dd,''):(_0x16f2b5=_0x16f2b5['replace'](/#BLU#/g,_0x5b27fd(0xfa)),_0x16f2b5=_0x16f2b5[_0x5b27fd(0xe6)](/#RED#/g,_0x5b27fd(0x2a7)),_0x16f2b5=_0x16f2b5[_0x5b27fd(0xe6)](/#YEL#/g,_0x5b27fd(0x170)),_0x16f2b5=_0x16f2b5[_0x5b27fd(0xe6)](/#MAG#/g,_0x5b27fd(0x14c)),_0x16f2b5=_0x16f2b5[_0x5b27fd(0xe6)](/#CYA#/g,'\x1b[36m'),_0x16f2b5=_0x16f2b5[_0x5b27fd(0xe6)](/#RES#/g,_0x5b27fd(0x19c)));;}return _0x16f2b5;},logger={'screen':_0x2a8969=>{const _0x279738=_0x394128;console[_0x279738(0x1cb)](parseColor(_0x2a8969,!![]));},'simple':_0x39e3d8=>{const _0x2a7e2e=_0x394128;console[_0x2a7e2e(0x1cb)](parseColor(_0x39e3d8,!![])),loggerfile[_0x2a7e2e(0xd0)](util[_0x2a7e2e(0x179)](parseColor(_0x39e3d8,![]))+'\x0a');},'full':async _0x1e3a0f=>{const _0x1180be=_0x394128,_0x5b38eb=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x1e3a0f;console['log'](parseColor(_0x5b38eb,!![])),loggerfile['write'](util[_0x1180be(0x179)](parseColor(_0x5b38eb,![]))+'\x0a');if(tgBot&&settings[_0x1180be(0x27c)]&&settings[_0x1180be(0x14e)]!=_0x1180be(0x2a1))await sendTelegram(settings[_0x1180be(0x27c)],'Bot\x20Mgr\x20>\x20'+parseColor(_0x1e3a0f,![]));},'debug':async(_0x522598,_0x3a8f41='')=>{const _0x5ee64e=_0x394128,_0x4008d8=getTimeStamp()+_0x5ee64e(0x277)+_0x522598;if(debugging)console[_0x5ee64e(0x1cb)](parseColor(_0x4008d8,!![]));loggerfile['write'](util[_0x5ee64e(0x179)](parseColor(_0x4008d8,![]))+'\x0a');if(_0x3a8f41){if(debugging)console[_0x5ee64e(0x1cb)](_0x3a8f41);loggerfile[_0x5ee64e(0xd0)](util[_0x5ee64e(0x179)](_0x3a8f41)+'\x0a');}}};let terminating=![];process['on'](_0x394128(0x156),function(_0x223d23){const _0x417738=_0x394128;_0x223d23[_0x417738(0x1ee)]()[_0x417738(0x1d5)](_0x417738(0x231))?(logger[_0x417738(0x1a0)](_0x417738(0x28a)+_0x223d23[_0x417738(0x15a)]+_0x417738(0xd1)),process[_0x417738(0x24e)]({'terminate':!![]},_0x2abbe0=>{})):logger[_0x417738(0x1a0)](_0x223d23);}),process['on'](_0x394128(0x293),()=>{const _0x114ff4=_0x394128;stopAllBots(),process[_0x114ff4(0x293)](0x0);}),process['on'](_0x394128(0x24b),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x394128(0xc1),()=>{const _0x2db620=_0x394128;stopAllBots(),process[_0x2db620(0x293)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x394128(0x1a5))[_0x394128(0xe4)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x394128(0xdc)),app=express(),http=require('http')['createServer'](app);app[_0x394128(0x24f)](fileUpload({'useTempFiles':!![]})),app[_0x394128(0xce)](_0x394128(0x256),async(_0x16d6b7,_0x5a6039)=>{const _0x5a298a=_0x394128,_0x58c7be=_0x16d6b7[_0x5a298a(0x191)][_0x5a298a(0x121)],_0x31ed90=getClientsWithBotID(_0x5a298a(0xa7)),_0x178749=_0x16d6b7[_0x5a298a(0x1fc)]['uuid'],_0x40be97=timelyDecrypt(_0x178749,![]),_0x34405b=_0x31ed90[_0x5a298a(0x221)](_0x4ab304=>_0x4ab304[_0x5a298a(0x17b)]==_0x40be97);if(_0x34405b){const _0x913ca0=normalizeIP(_0x16d6b7[_0x5a298a(0x237)][_0x5a298a(0x2a0)])[_0x5a298a(0x1c3)],_0x4ab996=_0x16d6b7[_0x5a298a(0x1fc)][_0x5a298a(0xd7)];if(validateAccess(_0x4ab996,_0x40be97,_0x913ca0)[_0x5a298a(0x26b)])_0x58c7be=='backup'&&await backupConfigFiles(),await zipFiles(_0x58c7be),_0x5a6039[_0x5a298a(0xb6)](zippath+(_0x58c7be+_0x5a298a(0x296)),_0x54d702=>{_0x54d702&&(logger['full']('Failed\x20to\x20download\x20'+_0x58c7be),logger['simple'](_0x54d702));});else logger[_0x5a298a(0xda)](_0x5a298a(0x1d4)+_0x58c7be+'\x20(1)');}else logger[_0x5a298a(0xda)](_0x5a298a(0x1d4)+_0x58c7be+_0x5a298a(0x24a));}),app[_0x394128(0x10a)]('/upload-backup',async(_0x27c325,_0x134a87)=>{const _0x150dd8=_0x394128,_0x4c7cd1=getClientsWithBotID(_0x150dd8(0xa7)),_0x4fd182=_0x27c325[_0x150dd8(0x1fc)][_0x150dd8(0x17b)],_0x37f190=timelyDecrypt(_0x4fd182,![]),_0x4ac648=_0x4c7cd1[_0x150dd8(0x221)](_0x4d2c45=>_0x4d2c45[_0x150dd8(0x17b)]==_0x37f190);logger[_0x150dd8(0x23c)](_0x150dd8(0xc0));if(_0x4ac648){const _0x26b7d9=normalizeIP(_0x27c325[_0x150dd8(0x237)]['remoteAddress'])[_0x150dd8(0x1c3)],_0x1322b8=_0x27c325[_0x150dd8(0x1fc)][_0x150dd8(0xd7)];if(validateAccess(_0x1322b8,_0x37f190,_0x26b7d9)['allow']){if(_0x27c325['files']){const _0x3ae633=_0x27c325[_0x150dd8(0x15c)][_0x150dd8(0xe7)];await _0x3ae633['mv'](temppath+_0x3ae633[_0x150dd8(0x99)]),_0x134a87[_0x150dd8(0x24e)]({'status':!![],'message':_0x150dd8(0x124)});const _0x1878ef=getBotsWithMode();_0x1878ef[_0x150dd8(0x97)]>0x0?confirmRestore(temppath,_0x3ae633[_0x150dd8(0x99)]):unzipFile(temppath,_0x3ae633[_0x150dd8(0x99)]);}}else logger[_0x150dd8(0xda)](_0x150dd8(0x153));}else logger[_0x150dd8(0xda)]('Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)');}),app[_0x394128(0x24f)](express['static'](path['join'](__dirname,bbpath2,'build2'))),app[_0x394128(0x24f)](express[_0x394128(0x96)](path[_0x394128(0x295)](__dirname,bbpath2,_0x394128(0xee)))),app[_0x394128(0xce)]('/',function(_0x5cfba1,_0x2587ca){const _0x46e76a=_0x394128;_0x2587ca[_0x46e76a(0x173)](path['join'](__dirname,bbpath2,_0x46e76a(0x1d8),_0x46e76a(0x1a1)));}),app[_0x394128(0xce)](_0x394128(0x271),function(_0x385da0,_0x3bbe4a){const _0x94a9bb=_0x394128;_0x3bbe4a[_0x94a9bb(0x173)](path[_0x94a9bb(0x295)](__dirname,bbpath2,'build','index.html'));}),app['get'](_0x394128(0x246),(_0x5c35f5,_0x3b980c)=>{const _0x3c2416=_0x394128;_0x3b980c[_0x3c2416(0x173)](path[_0x3c2416(0x295)](__dirname,bbpath2,_0x3c2416(0xee),'index.html'));}),app[_0x394128(0xce)](_0x394128(0x184),(_0x37dfd9,_0x5023a9)=>{const _0x2d6901=_0x394128;_0x5023a9[_0x2d6901(0x173)](path[_0x2d6901(0x295)](__dirname,bbpath2,'build','index.html'));}),app[_0x394128(0xce)](_0x394128(0x27b),(_0x5ceb7d,_0x2a680f)=>{const _0x243d7e=_0x394128;_0x2a680f[_0x243d7e(0x173)](path['join'](__dirname,bbpath2,_0x243d7e(0xee),_0x243d7e(0x1a1)));}),app[_0x394128(0xce)](_0x394128(0x265),(_0xbf7c4b,_0x102b7b)=>{const _0x4c0896=_0x394128;_0x102b7b['sendFile'](path[_0x4c0896(0x295)](__dirname,bbpath2,'build',_0x4c0896(0x1a1)));}),app['get'](_0x394128(0x1a4),(_0x105f86,_0x5684e6)=>{const _0x134025=_0x394128;_0x5684e6['sendFile'](path[_0x134025(0x295)](__dirname,bbpath2,_0x134025(0xee),'index.html'));}),app['get']('/:bot/support',(_0x20d593,_0x1290b8)=>{const _0xf491ea=_0x394128;_0x1290b8['sendFile'](path[_0xf491ea(0x295)](__dirname,bbpath2,_0xf491ea(0xee),_0xf491ea(0x1a1)));});if(HOST)http[_0x394128(0xc3)](PORT,HOST);else http['listen'](PORT);const io=require(_0x394128(0x283))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x26da5b=_0x394128;let _0x562696='[ip-address]';const _0xeb88fc=networkInterfaces(),_0x2b8eee={};for(const _0xed6d82 of Object[_0x26da5b(0x278)](_0xeb88fc)){for(const _0x19cd27 of _0xeb88fc[_0xed6d82]){if((_0x19cd27[_0x26da5b(0x215)]==_0x26da5b(0x1c1)||_0x19cd27['family']==0x4)&&!_0x19cd27[_0x26da5b(0x253)]){const _0x21f0b5=ipaddr[_0x26da5b(0x16e)](_0x19cd27[_0x26da5b(0x1d9)])[_0x26da5b(0x9b)]();_0x21f0b5!=_0x26da5b(0x250)&&(!_0x2b8eee[_0xed6d82]&&(_0x2b8eee[_0xed6d82]=[]),_0x2b8eee[_0xed6d82][_0x26da5b(0x101)](_0x19cd27[_0x26da5b(0x1d9)]),_0x562696=_0x19cd27[_0x26da5b(0x1d9)]);}}}return{'serverip':_0x562696,'netinterfaces':_0x2b8eee};}async function startServer(){const _0x2b5876=_0x394128,{serverip:_0x3b4c27,netinterfaces:_0x417d91}=getServerIP();logger[_0x2b5876(0x1a0)](''),logger[_0x2b5876(0x1a0)](_0x2b5876(0x104)),await logger[_0x2b5876(0xda)]('Starting\x20#RED#Balance\x20Bot\x20v'+serverversion+_0x2b5876(0x137)+(environment==_0x2b5876(0x2a6)?_0x2b5876(0x1ed):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x2b5876(0x1c4)+_0x3b4c27+':'+PORT+'#RES#\x20if\x20running\x20on\x20server')),logger['simple'](_0x2b5876(0x104));if(config[_0x2b5876(0x97)]!=0x0)for(const _0x5b4082 of config){const _0xca978a=_0x5b4082[_0x2b5876(0xc9)]==_0x2b5876(0x29d)?'a':'m';if(_0x5b4082[_0x2b5876(0x15e)]=='enabled'||_0x5b4082[_0x2b5876(0x15e)]==_0x2b5876(0x22f))await logger[_0x2b5876(0xda)](_0x2b5876(0x1bf)+_0xca978a+_0x2b5876(0x17f)+_0x5b4082[_0x2b5876(0x189)]+'\x20|\x20'+_0x5b4082[_0x2b5876(0x146)]),startBot([_0x5b4082[_0x2b5876(0x189)],userID],{'cwd':bbpath},function(_0x4c0324){const _0x519ee3=_0x2b5876;if(_0x4c0324)logger[_0x519ee3(0xda)](_0x4c0324);});else(_0x5b4082[_0x2b5876(0x15e)]=='disabled'||_0x5b4082[_0x2b5876(0x15e)]==_0x2b5876(0xa3))&&await logger[_0x2b5876(0xda)](_0x2b5876(0x1c2)+_0xca978a+')\x20\x20\x20|\x20Bot\x20'+_0x5b4082[_0x2b5876(0x189)]+_0x2b5876(0x16f)+_0x5b4082[_0x2b5876(0x146)]);}else!newBot&&logger[_0x2b5876(0x1a0)](_0x2b5876(0xbb));if(newBot)addBot();logger[_0x2b5876(0x1a0)](_0x2b5876(0x104)),logger[_0x2b5876(0x1a0)](''),await logger['debug'](_0x2b5876(0x245)+nodeversion),await logger['debug'](_0x2b5876(0xcc),_0x417d91);}function startSocket(){const _0x2476ee=_0x394128;io['on'](_0x2476ee(0xc2),_0x45c25d=>{const _0x12b0f2=_0x2476ee;let _0x1ee840,_0x2890f8,_0x260264,_0x187bc1,_0x108cf9;const _0x4e9c17=_0x45c25d[_0x12b0f2(0xa0)][_0x12b0f2(0x1fc)][_0x12b0f2(0x1d2)];_0x2890f8=_0x4e9c17[_0x12b0f2(0x28e)](/bot[0-9]{3}/);if(_0x2890f8)_0x260264=_0x2890f8[0x0][_0x12b0f2(0x28e)](/[0-9]{3}/);if(_0x260264)_0x1ee840=_0x260264[0x0];else _0x1ee840='botmanager';const _0x1dbbc0=_0x45c25d[_0x12b0f2(0xa0)][_0x12b0f2(0x1dc)][_0x12b0f2(0x178)];if(!_0x1dbbc0)_0x45c25d[_0x12b0f2(0x212)](_0x12b0f2(0x15e),{'publicKey':secure[_0x12b0f2(0x208)]});else{_0x187bc1=timelyDecrypt(_0x1dbbc0,![]);if(!_0x187bc1)_0x45c25d[_0x12b0f2(0x212)](_0x12b0f2(0x15e),{'publicKey':secure[_0x12b0f2(0x208)]});else{_0x108cf9=normalizeIP(_0x45c25d[_0x12b0f2(0x262)][_0x12b0f2(0x2a0)])['store'];if(!devices[_0x187bc1])devices[_0x187bc1]={'uuid':_0x187bc1,'access':{'token':null}};devices[_0x187bc1]['ip']=_0x108cf9;const _0x47d74c=addClient(_0x45c25d['id'],_0x187bc1,_0x1ee840);setAccess(_0x47d74c),emitMessages(),_0x45c25d['on']('login',_0x4b1767=>{const _0xff52a1=_0x12b0f2,_0x1f6808=timelyDecrypt(_0x4b1767['password'],!![],_0xff52a1(0x275));if(_0x1f6808){_0x4b1767={'username':_0x4b1767[_0xff52a1(0x20b)],'password':_0x1f6808},devices[_0x187bc1]['access']=validateCredentials(_0x4b1767,_0x187bc1);if(devices[_0x187bc1][_0xff52a1(0x162)]['allow']==![]&&devices[_0x187bc1]['access']['reason']==_0xff52a1(0x28c))_0x45c25d[_0xff52a1(0x212)](_0xff52a1(0x15e),{'access':devices[_0x187bc1]['access']}),loginAccess2FA(_0x187bc1,_0x108cf9);else{if(devices[_0x187bc1]['access']['allow']==![]&&devices[_0x187bc1][_0xff52a1(0x162)]['reason']==_0xff52a1(0x160))_0x45c25d[_0xff52a1(0x212)]('status',{'access':devices[_0x187bc1][_0xff52a1(0x162)]});else devices[_0x187bc1]['access'][_0xff52a1(0x26b)]&&devices[_0x187bc1][_0xff52a1(0x162)][_0xff52a1(0x1b5)]==_0xff52a1(0x1e6)&&(getClientsWithUuid(_0x187bc1)[_0xff52a1(0x126)](_0x547e97=>{setAccess(_0x547e97);}),logger[_0xff52a1(0x23c)](_0xff52a1(0x1f4)+_0x187bc1[_0xff52a1(0x120)](-0x8)),setTokenRefresh(_0x187bc1),setSessionTimeout('login',_0x187bc1));}}else logger['full']('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x45c25d['on'](_0x12b0f2(0x134),()=>{resetPassword();}),_0x45c25d['on'](_0x12b0f2(0x1aa),_0x4ea8f3=>{removeClient(_0x45c25d['id']);}),_0x1ee840==_0x12b0f2(0xa7)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x45280c){const _0x28131b=_0x394128;if(_0x45280c!=_0x28131b(0xa7)&&config[_0x28131b(0x147)]!=''){if(pid[_0x45280c])pid[_0x45280c][_0x28131b(0x24e)]({'function':_0x28131b(0xbe),'args':null});}_0x45280c!=_0x28131b(0xa7)&&broadcastToBots(_0x28131b(0xdd),JSON['stringify'](config));}function reloadBotManager(){const _0x2cb89f=_0x394128;getClientsWithBotID(_0x2cb89f(0xa7))[_0x2cb89f(0x126)](_0x52717d=>{const _0xc0a0a7=_0x2cb89f;getSocket(_0x52717d['id'])[_0xc0a0a7(0x212)](_0xc0a0a7(0x15e),{'access':{'allow':![],'reason':_0xc0a0a7(0x129),'token':null}});});}function getSocket(_0x1d78af){const _0x40912b=_0x394128,_0x62fc4d=io[_0x40912b(0x186)][_0x40912b(0xce)]('/');return _0x62fc4d[_0x40912b(0x1cc)][_0x40912b(0xce)](_0x1d78af);}function setAccess(_0x5350b9){const _0x32f172=_0x394128,_0xabb1b0=getSocket(_0x5350b9['id']),_0x2bb517=_0x5350b9['uuid'],_0x95d226=_0x5350b9[_0x32f172(0x22c)];devices[_0x2bb517]['access']=validateAccess(devices[_0x2bb517][_0x32f172(0x162)][_0x32f172(0x1c6)],_0x2bb517),logger[_0x32f172(0x23c)](_0x32f172(0xf2)+devices[_0x2bb517][_0x32f172(0x162)]['reason']+_0x32f172(0x239)+_0x5350b9['id'][_0x32f172(0x120)](-0x8)+_0x32f172(0x125)+_0x2bb517[_0x32f172(0x120)](-0x8)),_0xabb1b0['join'](_0x2bb517);if(devices[_0x2bb517][_0x32f172(0x162)][_0x32f172(0x26b)]){_0xabb1b0[_0x32f172(0x295)](_0x95d226);if(_0x95d226==_0x32f172(0xa7))initializeSocketBotManager(_0xabb1b0);else initializeSocketBot(_0xabb1b0);initClient(_0x95d226);}devices[_0x2bb517][_0x32f172(0x162)][_0x32f172(0x1c6)]&&devices[_0x2bb517][_0x32f172(0x162)]['reason']==_0x32f172(0x1a7)&&setSessionTimeout(_0x32f172(0x1bc),_0x2bb517),devices[_0x2bb517][_0x32f172(0x162)][_0x32f172(0x1c6)]&&devices[_0x2bb517][_0x32f172(0x162)][_0x32f172(0x1b5)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x32f172(0x10d),_0x2bb517),_0xabb1b0['emit'](_0x32f172(0x15e),{'status':_0x5350b9[_0x32f172(0x21b)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x2bb517][_0x32f172(0x162)],'externalip':devices[_0x2bb517]['ip'],'publicKey':secure[_0x32f172(0x208)],'userid':settings[_0x32f172(0x29b)],'validInstallation':validInstallation}),devices[_0x2bb517]['access'][_0x32f172(0x26b)]==![]&&devices[_0x2bb517][_0x32f172(0x162)][_0x32f172(0x1b5)]==_0x32f172(0x174)&&temporaryAccess2FA(_0x2bb517,devices[_0x2bb517]['ip']);}function setSessionTimeout(_0x4924dc,_0x38df58){const _0x4f3921=_0x394128;let _0x167bd1;if(_0x4924dc==_0x4f3921(0x10d))_0x167bd1=loginExpiry*0x3c*0x3e8;else _0x167bd1=devices[_0x38df58][_0x4f3921(0xfc)][_0x4f3921(0x26a)]*0x3c*0x3e8-(new Date()[_0x4f3921(0x247)]()-devices[_0x38df58]['telegramIpApproval']['timestamp']);if(devices[_0x38df58]['pidExpireLogin'])clearTimeout(devices[_0x38df58][_0x4f3921(0x266)]);devices[_0x38df58]['pidExpireLogin']=setTimeout(()=>{const _0x100946=_0x4f3921;if(devices[_0x38df58][_0x100946(0xe3)])clearTimeout(devices[_0x38df58][_0x100946(0xe3)]);removeSocketListeners(_0x38df58),addBlacklist(_0x38df58),devices[_0x38df58][_0x100946(0xfc)]=null,devices[_0x38df58][_0x100946(0x1db)]=null,devices[_0x38df58][_0x100946(0x162)][_0x100946(0x1c6)]=null,logger[_0x100946(0x23c)](_0x100946(0x188)+_0x38df58[_0x100946(0x120)](-0x8)),devices[_0x38df58][_0x100946(0x162)]=validateAccess(devices[_0x38df58][_0x100946(0x162)][_0x100946(0x1c6)],_0x38df58),!(devices[_0x38df58]['access']['allow']&&devices[_0x38df58]['access'][_0x100946(0x1b5)]==_0x100946(0x106))&&(_0x4924dc==_0x100946(0x10d)?io['to'](_0x38df58)[_0x100946(0x212)]('status',{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x38df58)[_0x100946(0x212)](_0x100946(0x15e),{'access':{'allow':![],'reason':_0x100946(0x225),'token':null}})),devices[_0x38df58][_0x100946(0x162)][_0x100946(0x1c6)]=null;},_0x167bd1);}function setTokenRefresh(_0x335cdd){const _0x13ce0c=_0x394128;if(devices[_0x335cdd][_0x13ce0c(0xe3)])clearTimeout(devices[_0x335cdd][_0x13ce0c(0xe3)]);devices[_0x335cdd][_0x13ce0c(0xe3)]=setTimeout(()=>{const _0x2991f3=_0x13ce0c;getClientsWithUuid(_0x335cdd)[_0x2991f3(0x97)]!=0x0?(devices[_0x335cdd][_0x2991f3(0x162)]=refreshToken(_0x335cdd),io['to'](_0x335cdd)[_0x2991f3(0x212)](_0x2991f3(0x15e),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x335cdd][_0x2991f3(0x162)],'externalip':devices[_0x335cdd]['ip'],'publicKey':secure[_0x2991f3(0x208)],'validInstallation':validInstallation}),setTokenRefresh(_0x335cdd)):clearTimeout(devices[_0x335cdd][_0x2991f3(0xe3)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x4430ac){const _0x4f21f1=_0x394128,_0x561c02=getClient(_0x4430ac['id'])['uuid'];_0x4430ac[_0x4f21f1(0x212)](_0x4f21f1(0xdd),config),_0x4430ac[_0x4f21f1(0x212)](_0x4f21f1(0x123),cleanSettings()),_0x4430ac['on'](_0x4f21f1(0x1fb),_0x251f7e=>{const _0x3a770e=_0x4f21f1;if(validateAccess(_0x251f7e,_0x561c02)[_0x3a770e(0x26b)])addBot();else logger[_0x3a770e(0xda)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x4430ac['on'](_0x4f21f1(0x28d),(_0x14702e,_0x4971cd)=>{const _0x1b7712=_0x4f21f1;if(validateAccess(_0x4971cd,_0x561c02)[_0x1b7712(0x26b)])toggleBot(_0x14702e[_0x1b7712(0x189)],_0x14702e[_0x1b7712(0x15e)],_0x14702e['live']);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4430ac['on'](_0x4f21f1(0x220),(_0x3497c7,_0x3fe3d4)=>{const _0xbb6dc=_0x4f21f1;if(validateAccess(_0x3fe3d4,_0x561c02)[_0xbb6dc(0x26b)])toggleBotMode(_0x3497c7);else logger[_0xbb6dc(0xda)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x4430ac['on']('delete-bot',(_0x5ae754,_0x41b101)=>{const _0x5d59c6=_0x4f21f1;if(validateAccess(_0x41b101,_0x561c02)[_0x5d59c6(0x26b)])deleteBot(_0x5ae754);else logger[_0x5d59c6(0xda)](_0x5d59c6(0x135));}),_0x4430ac['on'](_0x4f21f1(0x1ac),(_0x3718be,_0x17af91)=>{const _0x51c111=_0x4f21f1;if(validateAccess(_0x17af91,_0x561c02)[_0x51c111(0x26b)])storeSettings(_0x3718be,!![]);else logger[_0x51c111(0xda)](_0x51c111(0x232));}),_0x4430ac['on']('update-bb',_0x2bdaf7=>{const _0x3f6d30=_0x4f21f1;if(validateAccess(_0x2bdaf7,_0x561c02)[_0x3f6d30(0x26b)])updateBB(_0x3f6d30(0x203));else logger['full'](_0x3f6d30(0x143));}),_0x4430ac['on']('reinstall-bb',_0x5fd5db=>{const _0x4ef2ef=_0x4f21f1;if(validateAccess(_0x5fd5db,_0x561c02)[_0x4ef2ef(0x26b)])updateBB(_0x4ef2ef(0x16a));else logger[_0x4ef2ef(0xda)](_0x4ef2ef(0x230));}),_0x4430ac['on'](_0x4f21f1(0x27a),_0x3d55f1=>{const _0x1548f7=_0x4f21f1;if(validateAccess(_0x3d55f1,_0x561c02)[_0x1548f7(0x26b)]){const _0x501b6c=getClient(_0x4430ac['id']);if(_0x501b6c)getBackupFiles(_0x501b6c['uuid']);else logger[_0x1548f7(0xda)]('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger['full'](_0x1548f7(0x26c));}),_0x4430ac['on']('restore-backup-file',(_0x4cfa95,_0x13d75f)=>{const _0x220e48=_0x4f21f1;if(validateAccess(_0x13d75f,_0x561c02)['allow'])restoreBackupFile(_0x4cfa95);else logger[_0x220e48(0xda)](_0x220e48(0xf5));}),_0x4430ac['on'](_0x4f21f1(0xaa),_0x4bd86f=>{const _0x2c105d=_0x4f21f1;if(validateAccess(_0x4bd86f,_0x561c02)[_0x2c105d(0x26b)])getMessages();else logger[_0x2c105d(0xda)](_0x2c105d(0x219));}),_0x4430ac['on'](_0x4f21f1(0x114),(_0x1ed27b,_0x463a4e)=>{const _0x4a2f89=_0x4f21f1;if(validateAccess(_0x463a4e,_0x561c02)[_0x4a2f89(0x26b)])confirmMessage(_0x1ed27b);else logger[_0x4a2f89(0xda)](_0x4a2f89(0x108));}),_0x4430ac['on'](_0x4f21f1(0x2a2),_0x31318e=>{const _0x28a831=_0x4f21f1;if(validateAccess(_0x31318e,_0x561c02)[_0x28a831(0x26b)]){if(devices[_0x561c02][_0x28a831(0xe3)])clearTimeout(devices[_0x561c02][_0x28a831(0xe3)]);if(devices[_0x561c02]['pidExpireLogin'])clearTimeout(devices[_0x561c02]['pidExpireLogin']);removeSocketListeners(getClient(_0x4430ac['id'])[_0x28a831(0x17b)]),addBlacklist(_0x561c02),devices[_0x561c02][_0x28a831(0xfc)]=null,devices[_0x561c02][_0x28a831(0x1db)]=null,devices[_0x561c02][_0x28a831(0x162)][_0x28a831(0x1c6)]=null,logger[_0x28a831(0x23c)](_0x28a831(0x224)+_0x561c02['slice'](-0x8)),io['to'](getClient(_0x4430ac['id'])[_0x28a831(0x17b)])[_0x28a831(0x212)](_0x28a831(0x15e),{'access':{'allow':![],'reason':_0x28a831(0x151),'token':null}});}else logger[_0x28a831(0xda)](_0x28a831(0xb3));});}function initializeSocketBot(_0x5e2d58){const _0x578f28=_0x394128,_0x2db166=getClient(_0x5e2d58['id'])[_0x578f28(0x22c)],_0x5e5490=getClient(_0x5e2d58['id'])['uuid'];_0x5e2d58['on'](_0x578f28(0xfe),(_0x2ffa6c,_0x5ba383)=>{const _0x4c138f=_0x578f28;if(validateAccess(_0x5ba383,_0x5e5490)[_0x4c138f(0x26b)]){if(pid[_0x2db166])pid[_0x2db166][_0x4c138f(0x24e)]({'function':_0x4c138f(0x17c),'args':_0x2ffa6c});}else logger[_0x4c138f(0xda)](_0x4c138f(0x1b2));}),_0x5e2d58['on'](_0x578f28(0xe8),(_0x8addfb,_0x4abc57)=>{const _0x3c531d=_0x578f28;if(validateAccess(_0x4abc57,_0x5e5490)[_0x3c531d(0x26b)]){if(pid[_0x2db166])pid[_0x2db166][_0x3c531d(0x24e)]({'function':_0x3c531d(0x204),'args':_0x8addfb});}else logger[_0x3c531d(0xda)](_0x3c531d(0x1c5));}),_0x5e2d58['on']('get-portfolio',(_0x20c33b,_0xd1f6cd)=>{const _0x5366dc=_0x578f28;if(validateAccess(_0xd1f6cd,_0x5e5490)[_0x5366dc(0x26b)]){if(pid[_0x2db166])pid[_0x2db166][_0x5366dc(0x24e)]({'function':'getPortfolio','args':_0x20c33b});}else logger[_0x5366dc(0xda)](_0x5366dc(0x195));}),_0x5e2d58['on']('store-configuration',(_0x3a7042,_0xe26723)=>{const _0x22c8bf=_0x578f28;if(validateAccess(_0xe26723,_0x5e5490)[_0x22c8bf(0x26b)]){if(pid[_0x2db166])pid[_0x2db166][_0x22c8bf(0x24e)]({'function':_0x22c8bf(0x214),'args':_0x3a7042});}else logger[_0x22c8bf(0xda)](_0x22c8bf(0xd4));}),_0x5e2d58['on'](_0x578f28(0xcd),(_0x212b3e,_0x241392)=>{const _0x2039d9=_0x578f28;if(validateAccess(_0x241392,_0x5e5490)['allow']){if(pid[_0x2db166])pid[_0x2db166][_0x2039d9(0x24e)]({'function':'storeHeadless','args':_0x212b3e});}else logger[_0x2039d9(0xda)]('Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration');}),_0x5e2d58['on'](_0x578f28(0x19b),(_0x2aba69,_0x432354)=>{const _0x3d50a6=_0x578f28;if(validateAccess(_0x432354,_0x5e5490)[_0x3d50a6(0x26b)]){if(pid[_0x2db166])pid[_0x2db166]['send']({'function':_0x3d50a6(0x158),'args':_0x2aba69});}else logger[_0x3d50a6(0xda)](_0x3d50a6(0x234));}),_0x5e2d58['on'](_0x578f28(0x259),_0x173964=>{const _0x4dbcbc=_0x578f28;if(validateAccess(_0x173964,_0x5e5490)[_0x4dbcbc(0x26b)]){if(pid[_0x2db166])pid[_0x2db166][_0x4dbcbc(0x24e)]({'function':_0x4dbcbc(0x157),'args':null});}else logger['full'](_0x4dbcbc(0x1ad));}),_0x5e2d58['on']('get-starting-balances',_0x5e0190=>{const _0x59f7e3=_0x578f28;if(validateAccess(_0x5e0190,_0x5e5490)[_0x59f7e3(0x26b)]){if(pid[_0x2db166])pid[_0x2db166][_0x59f7e3(0x24e)]({'function':_0x59f7e3(0xac),'args':null});}else logger[_0x59f7e3(0xda)](_0x59f7e3(0x1b8));}),_0x5e2d58['on'](_0x578f28(0x15f),(_0x342042,_0x531b98)=>{const _0x21e34c=_0x578f28;if(validateAccess(_0x531b98,_0x5e5490)[_0x21e34c(0x26b)]){if(pid[_0x2db166])pid[_0x2db166][_0x21e34c(0x24e)]({'function':_0x21e34c(0x25c),'args':_0x342042});}else logger[_0x21e34c(0xda)]('Unauthorized\x20attempt\x20to\x20place\x20market\x20order');}),_0x5e2d58['on'](_0x578f28(0x1f7),_0x42ed65=>{const _0x30347f=_0x578f28;if(validateAccess(_0x42ed65,_0x5e5490)[_0x30347f(0x26b)]){if(pid[_0x2db166])pid[_0x2db166][_0x30347f(0x24e)]({'function':'cancelLoading','args':null});}else logger['full'](_0x30347f(0x25a));}),_0x5e2d58['on'](_0x578f28(0x105),_0xce18b=>{const _0x45a1dc=_0x578f28;if(validateAccess(_0xce18b,_0x5e5490)['allow']){if(pid[_0x2db166])pid[_0x2db166][_0x45a1dc(0x24e)]({'function':_0x45a1dc(0x297),'args':null});}else logger[_0x45a1dc(0xda)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x5e2d58['on'](_0x578f28(0x196),_0x5e01a6=>{const _0xc63eb1=_0x578f28;if(validateAccess(_0x5e01a6,_0x5e5490)[_0xc63eb1(0x26b)])updateBB(_0xc63eb1(0x203));else logger[_0xc63eb1(0xda)](_0xc63eb1(0x143));}),_0x5e2d58['on'](_0x578f28(0xaa),_0x34d3b1=>{const _0x2581c0=_0x578f28;if(validateAccess(_0x34d3b1,_0x5e5490)[_0x2581c0(0x26b)])getMessages();else logger[_0x2581c0(0xda)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x5e2d58['on'](_0x578f28(0x114),(_0x42c0c9,_0x2ff1df)=>{const _0x2465eb=_0x578f28;if(validateAccess(_0x2ff1df,_0x5e5490)[_0x2465eb(0x26b)])confirmMessage(_0x42c0c9);else logger['full'](_0x2465eb(0x108));}),_0x5e2d58['on'](_0x578f28(0x2a2),_0x5e90f5=>{const _0x1e07d4=_0x578f28;if(validateAccess(_0x5e90f5,_0x5e5490)[_0x1e07d4(0x26b)]){if(devices[_0x5e5490]['pidRefreshToken'])clearTimeout(devices[_0x5e5490]['pidRefreshToken']);if(devices[_0x5e5490][_0x1e07d4(0x266)])clearTimeout(devices[_0x5e5490][_0x1e07d4(0x266)]);removeSocketListeners(getClient(_0x5e2d58['id'])['uuid']),addBlacklist(_0x5e5490),devices[_0x5e5490][_0x1e07d4(0xfc)]=null,devices[_0x5e5490][_0x1e07d4(0x1db)]=null,devices[_0x5e5490][_0x1e07d4(0x162)][_0x1e07d4(0x1c6)]=null,logger[_0x1e07d4(0x23c)]('Logged\x20out\x20user\x20...'+_0x5e5490[_0x1e07d4(0x120)](-0x8)),io['to'](getClient(_0x5e2d58['id'])[_0x1e07d4(0x17b)])[_0x1e07d4(0x212)](_0x1e07d4(0x15e),{'access':{'allow':![],'reason':_0x1e07d4(0x151),'token':null}});}else logger['full'](_0x1e07d4(0xb3));});}function removeSocketListeners(_0x51be45){const _0x5e749b=_0x394128;getClientsWithUuid(_0x51be45)[_0x5e749b(0x126)](_0x3f1777=>{const _0x2eca0e=_0x5e749b;getSocket(_0x3f1777['id'])[_0x2eca0e(0x100)]();});}function cleanSettings(){const _0x248486=_0x394128;let _0x4041b7=settings;return settings['telegramToken']&&settings['telegramToken']!=''&&(_0x4041b7={..._0x4041b7,'telegramToken':_0x248486(0x2a3)}),settings[_0x248486(0xa9)]&&settings[_0x248486(0xa9)]!=''&&(_0x4041b7={..._0x4041b7,'bbPassword':'************'}),settings[_0x248486(0x16d)]&&settings[_0x248486(0x16d)]!=''&&(_0x4041b7={..._0x4041b7,'marketcapApi':_0x248486(0x2a3)}),(settings['bbPassword']&&settings[_0x248486(0xa9)]=='***'||settings['telegramToken']&&settings[_0x248486(0x169)]==_0x248486(0x1c0)||settings['marketcapApi']&&settings[_0x248486(0x16d)]==_0x248486(0x1c0))&&(_0x4041b7={..._0x4041b7,'restored':{'password':settings[_0x248486(0xa9)]=='***','telegram':settings[_0x248486(0x169)]=='***','marketcap':settings['marketcapApi']==_0x248486(0x1c0)}}),_0x4041b7;}async function updateBB(_0x21541a){const _0x28ea79=_0x394128;await backupConfigFiles(),installingUpdate=!![],config[_0x28ea79(0x126)](_0x256a5f=>{const _0x4e3841=_0x28ea79;restartBot(_0x256a5f[_0x4e3841(0x189)]);});if(_0x21541a==_0x28ea79(0x203))process['send']({'update':!![],'environment':environment},_0x4c84bc=>{});else _0x21541a==_0x28ea79(0x16a)&&process[_0x28ea79(0x24e)]({'reinstall':!![],'environment':environment},_0x387c87=>{});}function startBot(_0x36beba,_0xf5c161,_0x164318){const _0x1cdf9e=_0x394128;if(debugging)_0x36beba[_0x1cdf9e(0x101)]('-d');let _0x382caa=![];const _0x4dffd1=_0x36beba[0x0];_0xf5c161={..._0xf5c161,'stdio':[_0x1cdf9e(0x150),'inherit','inherit','ipc']},pid[_0x4dffd1]=childProcess[_0x1cdf9e(0xf8)](botfile,_0x36beba,_0xf5c161),pid[_0x4dffd1]['on']('message',_0x320b2e=>{const _0x1c6010=_0x1cdf9e;switch(Object[_0x1c6010(0x278)](_0x320b2e)[0x0]){case _0x1c6010(0x146):updateBotName(_0x4dffd1,_0x320b2e[_0x1c6010(0x146)]);break;case _0x1c6010(0x1fa):updateBotManager();break;case'status':updateStatus(_0x4dffd1,_0x320b2e[_0x1c6010(0x15e)]);break;case _0x1c6010(0x255):updateLive(_0x4dffd1,_0x320b2e[_0x1c6010(0x255)]);break;case'started':updateLive(_0x4dffd1,_0x320b2e[_0x1c6010(0x10f)]),io['to'](_0x4dffd1)['emit'](_0x1c6010(0x15e),{'access':{'allow':![],'reason':'reload','token':null}});break;case _0x1c6010(0x15b):_0x320b2e[_0x1c6010(0x15b)]=='restart'&&restartBot(_0x4dffd1);_0x320b2e[_0x1c6010(0x15b)]=='kill'&&toggleBot(_0x4dffd1,_0x1c6010(0x94),'stopped');break;case'telegram':sendTelegramBot(_0x4dffd1,_0x320b2e[_0x1c6010(0x223)]);break;case _0x1c6010(0x1de):sendTelegramMsg(_0x320b2e[_0x1c6010(0x1de)]);break;case'function':io['to'](_0x4dffd1)['emit'](_0x320b2e[_0x1c6010(0x21d)],_0x320b2e[_0x1c6010(0xb1)]);break;}}),pid[_0x4dffd1]['on']('error',function(_0x3dae32){if(_0x382caa)return;_0x382caa=!![],_0x164318(_0x3dae32);}),pid[_0x4dffd1]['on']('exit',async function(_0x31236f){const _0x293c6b=_0x1cdf9e;if(terminating)return;if(installingUpdate){io['close']();return;}if(_0x382caa)return;_0x382caa=!![],_0x164318(null);const _0x3ffd19=dbConfig['get'](_0x293c6b(0xdd))[_0x293c6b(0x221)]({'botID':_0x4dffd1})[_0x293c6b(0x198)]();_0x3ffd19&&(_0x3ffd19[_0x293c6b(0x15e)]==_0x293c6b(0x1f9)||_0x3ffd19['status']==_0x293c6b(0x22f))&&(await sleep(0x3e8),updateLive(_0x4dffd1,_0x293c6b(0x1f5)),logger['full']('Restarting\x20Bot\x20'+_0x4dffd1),startBot([_0x4dffd1,userID],{'cwd':bbpath},function(_0x3fcf49){const _0x1cce11=_0x293c6b;if(_0x3fcf49)logger[_0x1cce11(0xda)](_0x3fcf49);}));});}function stopBot(_0x158b50){const _0x1ab4b1=_0x394128;getClientsWithBotID(_0x158b50)['forEach'](_0x22465d=>{getSocket(_0x22465d['id'])['disconnect'](!![]),removeClient(_0x22465d['id']);}),pid[_0x158b50]&&(pid[_0x158b50][_0x1ab4b1(0x14f)](),pid[_0x158b50]=null);}function stopAllBots(){terminating=!![];const _0x30f82d=getEnabledBots();_0x30f82d['forEach'](_0x3d046a=>{stopBot(_0x3d046a['botID']);});}function restartBot(_0x49fa89){const _0x3a1bf7=_0x394128;if(pid[_0x49fa89])pid[_0x49fa89][_0x3a1bf7(0x14f)]();}function addBot(){const _0x53b708=_0x394128;let _0x55b2d3;for(let _0x144a1c=0x1;_0x144a1c<0x3e9;_0x144a1c++){_0x55b2d3=_0x144a1c[_0x53b708(0x1ee)]()[_0x53b708(0xab)](0x3,'0');let _0x333a36=config['find'](_0x5b992b=>_0x5b992b[_0x53b708(0x189)]==_0x55b2d3);if(!_0x333a36)break;}if(_0x55b2d3===_0x53b708(0x282)){logger['full']('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x53b708(0xda)](_0x53b708(0x1d7)+_0x55b2d3),dbConfig['get'](_0x53b708(0xdd))[_0x53b708(0x101)]({'botID':_0x55b2d3,'botname':'Bot\x20'+_0x55b2d3,'status':_0x53b708(0x22f),'live':''})['write'](),startBot([_0x55b2d3,userID],{'cwd':bbpath},function(_0x2ab23f){const _0x2ef34c=_0x53b708;if(_0x2ab23f)logger[_0x2ef34c(0xda)](_0x2ab23f);}),config=getConfiguration(),io['to'](_0x53b708(0xa7))[_0x53b708(0x212)]('bots',config),broadcastToBots(_0x53b708(0xdd),JSON[_0x53b708(0x139)](config));}function deleteBot(_0x537a2c){const _0x5d82e5=_0x394128;getClientsWithBotID(_0x537a2c)[_0x5d82e5(0x126)](_0x444cf3=>{getSocket(_0x444cf3['id'])['disconnect'](!![]),removeClient(_0x444cf3['id']);}),dbConfig['get'](_0x5d82e5(0xdd))[_0x5d82e5(0x21e)]({'botID':_0x537a2c})[_0x5d82e5(0xd0)](),logger[_0x5d82e5(0xda)](_0x5d82e5(0x22b)+_0x537a2c),stopBot(_0x537a2c);try{if(fs[_0x5d82e5(0x119)](path[_0x5d82e5(0x295)](configpath,_0x5d82e5(0x28f)+_0x537a2c+_0x5d82e5(0xd5))))fs[_0x5d82e5(0x25f)](path[_0x5d82e5(0x295)](configpath,_0x5d82e5(0x28f)+_0x537a2c+_0x5d82e5(0xd5)));if(fs['existsSync'](path[_0x5d82e5(0x295)](configpath,'bot-'+_0x537a2c+_0x5d82e5(0x16c))))fs[_0x5d82e5(0x25f)](path[_0x5d82e5(0x295)](configpath,_0x5d82e5(0x28f)+_0x537a2c+_0x5d82e5(0x16c)));if(fs['existsSync'](path[_0x5d82e5(0x295)](configpath,_0x5d82e5(0x28f)+_0x537a2c+_0x5d82e5(0x288))))fs[_0x5d82e5(0x25f)](path['join'](configpath,_0x5d82e5(0x28f)+_0x537a2c+_0x5d82e5(0x288)));if(fs[_0x5d82e5(0x119)](path[_0x5d82e5(0x295)](configpath,_0x5d82e5(0x28f)+_0x537a2c+_0x5d82e5(0xdb))))fs[_0x5d82e5(0x25f)](path['join'](configpath,_0x5d82e5(0x28f)+_0x537a2c+_0x5d82e5(0xdb)));}catch(_0x1de24e){if(_0x1de24e)logger[_0x5d82e5(0xda)]('Error\x20while\x20deleting\x20config\x20files:\x20',_0x1de24e);}config=getConfiguration(),io['to'](_0x5d82e5(0xa7))[_0x5d82e5(0x212)](_0x5d82e5(0xdd),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBot(_0x55fc48,_0x1735dc,_0x555f02){const _0x200f9c=_0x394128;dbConfig[_0x200f9c(0xce)](_0x200f9c(0xdd))[_0x200f9c(0x221)]({'botID':_0x55fc48})[_0x200f9c(0x13d)]({'status':_0x1735dc})[_0x200f9c(0x13d)]({'live':_0x555f02})[_0x200f9c(0xd0)]();if(_0x1735dc=='enabled'||_0x1735dc==_0x200f9c(0x22f))logger['full'](_0x200f9c(0x1ba)+_0x55fc48),startBot([_0x55fc48,userID],{'cwd':bbpath},function(_0x39abde){const _0xc1ecd=_0x200f9c;if(_0x39abde)logger[_0xc1ecd(0xda)](_0x39abde);});else(_0x1735dc=='disabled'||_0x1735dc=='new-disabled')&&(logger['full'](_0x200f9c(0x1e3)+_0x55fc48),stopBot(_0x55fc48));config=getConfiguration(),io['to'](_0x200f9c(0xa7))[_0x200f9c(0x212)](_0x200f9c(0xdd),config),broadcastToBots(_0x200f9c(0xdd),JSON[_0x200f9c(0x139)](config));}function toggleStatus(_0x268bbd){const _0x4876cd=_0x394128;let _0xd851cc=dbConfig[_0x4876cd(0xce)](_0x4876cd(0xdd))['find']({'botID':_0x268bbd})[_0x4876cd(0x198)](),_0x2c5787;if(_0xd851cc[_0x4876cd(0x15e)]===_0x4876cd(0x1f9))_0x2c5787='disabled';else{if(_0xd851cc[_0x4876cd(0x15e)]===_0x4876cd(0x22f))_0x2c5787=_0x4876cd(0xa3);else{if(_0xd851cc[_0x4876cd(0x15e)]===_0x4876cd(0xa3))_0x2c5787='new';else{if(_0xd851cc[_0x4876cd(0x15e)]===_0x4876cd(0x94))_0x2c5787=_0x4876cd(0x1f9);}}}return _0x2c5787;}function updateStatus(_0x2ebe71,_0x1fcfcf){const _0x15d711=_0x394128;dbConfig[_0x15d711(0xce)](_0x15d711(0xdd))[_0x15d711(0x221)]({'botID':_0x2ebe71})[_0x15d711(0x13d)]({'status':_0x1fcfcf})['write'](),config=getConfiguration(),io['to'](_0x15d711(0xa7))[_0x15d711(0x212)](_0x15d711(0xdd),config),broadcastToBots('bots',JSON[_0x15d711(0x139)](config));}function updateLive(_0x199859,_0x1bbb00){const _0x39c2a8=_0x394128;dbConfig[_0x39c2a8(0xce)](_0x39c2a8(0xdd))[_0x39c2a8(0x221)]({'botID':_0x199859})[_0x39c2a8(0x13d)]({'live':_0x1bbb00})['write'](),config=getConfiguration(),io['to']('botmanager')[_0x39c2a8(0x212)](_0x39c2a8(0xdd),config),broadcastToBots('bots',JSON[_0x39c2a8(0x139)](config));}function updateBotName(_0x56c68e,_0x4cc557){const _0x3dcca5=_0x394128;dbConfig[_0x3dcca5(0xce)]('bots')[_0x3dcca5(0x221)]({'botID':_0x56c68e})['assign']({'botname':_0x4cc557})[_0x3dcca5(0xd0)](),config=getConfiguration(),io['to'](_0x3dcca5(0xa7))['emit']('bots',config),broadcastToBots(_0x3dcca5(0xdd),JSON[_0x3dcca5(0x139)](config));}function updateBotManager(){const _0x2dfa4c=_0x394128;config=getConfiguration(),io['to']('botmanager')['emit'](_0x2dfa4c(0xdd),config),broadcastToBots(_0x2dfa4c(0xdd),JSON[_0x2dfa4c(0x139)](config));}function toggleBotMode(_0x28f836){const _0x2dd55c=_0x394128;if(pid[_0x28f836])pid[_0x28f836][_0x2dd55c(0x24e)]({'function':_0x2dd55c(0x21a),'args':null});else{const _0x111f02=configpath+'bot-'+_0x28f836+_0x2dd55c(0xd5),_0x4d1d36=fs['readFileSync'](_0x111f02),_0x16a48b=JSON[_0x2dd55c(0x16e)](_0x4d1d36),_0x3052a7=_0x16a48b[_0x2dd55c(0x22c)][0x0][_0x2dd55c(0xcf)];_0x16a48b[_0x2dd55c(0x22c)][0x0][_0x2dd55c(0xcf)]=!_0x3052a7;const _0xe08af7=JSON[_0x2dd55c(0x139)](_0x16a48b,null,0x2);fs[_0x2dd55c(0xc6)](_0x111f02,_0xe08af7),config=getConfiguration(),io['to'](_0x2dd55c(0xa7))[_0x2dd55c(0x212)](_0x2dd55c(0xdd),config),broadcastToBots(_0x2dd55c(0xdd),JSON[_0x2dd55c(0x139)](config));}}function validateTelegram(_0xb5a5eb){const _0x58e7da=_0x394128;if(_0xb5a5eb[_0x58e7da(0x1ce)][_0x58e7da(0x20b)]!=settings['telegramUsername']&&'@'+_0xb5a5eb[_0x58e7da(0x1ce)][_0x58e7da(0x20b)]!=settings[_0x58e7da(0x21f)]||_0xb5a5eb['chat']['id']!=settings[_0x58e7da(0x27c)])return sendTelegram(_0xb5a5eb[_0x58e7da(0x1e0)]['id'],'Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings',{'parse_mode':_0x58e7da(0x238)}),![];return!![];}async function initTelegram(){const _0x371b15=_0x394128;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x371b15(0x169)]);let _0x279c09=_0x371b15(0x171);_0x279c09+='\x0a',_0x279c09+=_0x371b15(0x1ae),_0x279c09+=_0x371b15(0x235),_0x279c09+=_0x371b15(0x298),_0x279c09+=_0x371b15(0x25d),_0x279c09+=_0x371b15(0xd3),_0x279c09+=_0x371b15(0x190),_0x279c09+='/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a',_0x279c09+='/names\x20-\x20show\x20bot\x20names\x0a',_0x279c09+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x279c09+=_0x371b15(0x1bd),_0x279c09+=_0x371b15(0x11d),_0x279c09+=_0x371b15(0x172),_0x279c09+=_0x371b15(0x2a4),_0x279c09+=_0x371b15(0x187),_0x279c09+=_0x371b15(0x166),_0x279c09+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x27b8c5=_0x371b15(0x131);_0x27b8c5+='\x0a',_0x27b8c5+=_0x279c09,tgBot[_0x371b15(0x148)]((_0xbda3a7,_0x271f11)=>{const _0x7eb135=_0x371b15;logger[_0x7eb135(0x1a0)](getTimeStamp()+_0x7eb135(0x1e8)),logger[_0x7eb135(0x23c)]('Telegraf\x20error:',_0xbda3a7);}),tgBot[_0x371b15(0x24f)](async(_0x5c7100,_0x16a07e)=>{const _0x4f319d=_0x371b15;if(!(!settings['telegramChatId']&&_0x5c7100[_0x4f319d(0x203)][_0x4f319d(0x199)][_0x4f319d(0x21c)]==_0x4f319d(0x18d))){if(!validateTelegram(_0x5c7100))return;}_0x16a07e();}),tgBot[_0x371b15(0x29f)]('start',async _0x52043d=>{const _0x57fb3d=_0x371b15;if(_0x52043d[_0x57fb3d(0x1ce)][_0x57fb3d(0x20b)]==settings[_0x57fb3d(0x21f)]||'@'+_0x52043d[_0x57fb3d(0x1ce)][_0x57fb3d(0x20b)]==settings[_0x57fb3d(0x21f)]){if(!settings[_0x57fb3d(0x27c)])updateSetting(_0x57fb3d(0x27c),_0x52043d[_0x57fb3d(0x1e0)]['id']);}if(!validateTelegram(_0x52043d))return;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x52043d['chat']['id'],_0x27b8c5);}),tgBot[_0x371b15(0x29f)](_0x371b15(0x18b),async _0x36e61c=>{const _0x27a168=_0x371b15;updateSetting('telegramEnabled',!![]),await sendTelegram(_0x36e61c[_0x27a168(0x1e0)]['id'],_0x27a168(0x258));}),tgBot[_0x371b15(0x29f)]('disable',async _0x5a05a4=>{const _0x50a1cb=_0x371b15;await sendTelegram(_0x5a05a4[_0x50a1cb(0x1e0)]['id'],'Notifications\x20disabled'),updateSetting(_0x50a1cb(0xa5),![]);}),tgBot['command'](_0x371b15(0xb4),async _0x3c1373=>{const _0x29666c=_0x371b15,_0x864b9c=Markup[_0x29666c(0x15d)]([Markup[_0x29666c(0x23b)][_0x29666c(0x289)](_0x29666c(0x194),_0x29666c(0x20d)),Markup[_0x29666c(0x23b)][_0x29666c(0x289)](_0x29666c(0xc8),_0x29666c(0x175)),Markup[_0x29666c(0x23b)][_0x29666c(0x289)]('All',_0x29666c(0xf1))]);_0x3c1373[_0x29666c(0x14b)](_0x29666c(0x2a8),_0x864b9c);}),tgBot['action'](_0x371b15(0x20d),async _0xcaaf11=>{const _0x592559=_0x371b15;_0xcaaf11[_0x592559(0xad)](),updateSetting(_0x592559(0x14e),_0x592559(0x2a1)),updateSetting(_0x592559(0xa5),!![]),await sendTelegram(_0xcaaf11[_0x592559(0x1e0)]['id'],_0x592559(0x107));}),tgBot[_0x371b15(0x20f)](_0x371b15(0x175),async _0x4a38da=>{const _0x432961=_0x371b15;_0x4a38da[_0x432961(0xad)](),updateSetting(_0x432961(0x14e),_0x432961(0x1c8)),updateSetting(_0x432961(0xa5),!![]),await sendTelegram(_0x4a38da['chat']['id'],_0x432961(0x13f));}),tgBot[_0x371b15(0x20f)](_0x371b15(0xf1),async _0x6d0cab=>{const _0x96eb9=_0x371b15;_0x6d0cab[_0x96eb9(0xad)](),updateSetting(_0x96eb9(0x14e),_0x96eb9(0x130)),updateSetting(_0x96eb9(0xa5),!![]),await sendTelegram(_0x6d0cab['chat']['id'],_0x96eb9(0x218));}),tgBot[_0x371b15(0x29f)](_0x371b15(0x15e),async _0x5d261f=>{const _0x297e58=_0x371b15,_0x360e37=getBotsWithMode();let _0x4faab1='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x297e58(0x126)](_0x10ae04=>{const _0x116453=_0x297e58,_0x1bcd70=_0x360e37[_0x116453(0x221)](_0xa4eee0=>_0xa4eee0['botID']==_0x10ae04[_0x116453(0x189)])['mode'];_0x4faab1+=_0x116453(0x14d)+_0x10ae04[_0x116453(0x189)]+':\x20'+_0x10ae04['status']+'\x20|\x20'+_0x1bcd70+_0x116453(0x16f)+_0x10ae04[_0x116453(0x255)]+'\x0a';}),_0x4faab1+='\x0a',_0x4faab1+=_0x297e58(0xa2),_0x4faab1+=!settings['telegramEnabled']?_0x297e58(0x1d0):_0x297e58(0xea),_0x4faab1+=settings[_0x297e58(0xa5)]?settings['telegramEvents']==_0x297e58(0x130)?_0x297e58(0xd6):_0x297e58(0xf9)+settings['telegramEvents']+_0x297e58(0x116):'',await sendTelegram(_0x5d261f[_0x297e58(0x1e0)]['id'],_0x4faab1,{'parse_mode':_0x297e58(0x238)});}),tgBot[_0x371b15(0x29f)](_0x371b15(0x11c),async _0x52195b=>{const _0x2c3cc8=_0x371b15,_0x2da02a=getEnabledBots();if(_0x2da02a[_0x2c3cc8(0x97)]==0x0)await sendTelegram(_0x52195b[_0x2c3cc8(0x1e0)]['id'],_0x2c3cc8(0x1af));else{if(_0x2da02a[_0x2c3cc8(0x97)]>0x1)_0x2da02a[_0x2c3cc8(0x101)]({'botID':'all'});let _0x196ea0=[],_0x54cc8e=[];const _0x1250e8=_0x2da02a[_0x2c3cc8(0x97)]%0x4==0x0||_0x2da02a[_0x2c3cc8(0x97)]%0x4==0x3||_0x2da02a[_0x2c3cc8(0x97)]%0x3==0x1?0x4:0x3;let _0x56b7bb=0x0;_0x2da02a[_0x2c3cc8(0x126)]((_0x13615b,_0x2133fd)=>{const _0x45ad17=_0x2c3cc8;if(_0x2133fd%_0x1250e8==0x0)_0x54cc8e=[];_0x54cc8e[_0x45ad17(0x101)](Markup[_0x45ad17(0x23b)][_0x45ad17(0x289)](_0x13615b[_0x45ad17(0x189)]==_0x45ad17(0x130)?_0x45ad17(0x22a):_0x45ad17(0x14d)+_0x13615b[_0x45ad17(0x189)],'restart_'+_0x13615b['botID'])),_0x2133fd%_0x1250e8==0x0&&(_0x196ea0[_0x56b7bb]=_0x54cc8e,_0x56b7bb++);});const _0x5f427c=Markup[_0x2c3cc8(0x15d)](_0x196ea0);_0x52195b['reply'](_0x2c3cc8(0x19e),_0x5f427c);}}),tgBot[_0x371b15(0x20f)](/restart_(.+)/,async _0x2acb21=>{const _0x4a8b3e=_0x371b15,_0x573f73=_0x2acb21[_0x4a8b3e(0x28e)][0x1];_0x2acb21[_0x4a8b3e(0xad)](),_0x573f73=='all'?config[_0x4a8b3e(0x126)](_0x1b930b=>{const _0x100b60=_0x4a8b3e;restartBot(_0x1b930b[_0x100b60(0x189)]);}):restartBot(_0x573f73);}),tgBot['command']('on',async _0x5603b7=>{const _0x15f8a8=_0x371b15,_0xbb931b=getDisabledBots();if(_0xbb931b[_0x15f8a8(0x97)]==0x0)await sendTelegram(_0x5603b7[_0x15f8a8(0x1e0)]['id'],_0x15f8a8(0xc5));else{if(_0xbb931b['length']>0x1)_0xbb931b['push']({'botID':_0x15f8a8(0x130)});let _0xae398a=[],_0x3e6834=[];const _0x3ecd98=_0xbb931b['length']%0x4==0x0||_0xbb931b[_0x15f8a8(0x97)]%0x4==0x3||_0xbb931b['length']%0x3==0x1?0x4:0x3;let _0x17a9e1=0x0;_0xbb931b[_0x15f8a8(0x126)]((_0x478ed0,_0x36a8a2)=>{const _0x30c951=_0x15f8a8;if(_0x36a8a2%_0x3ecd98==0x0)_0x3e6834=[];_0x3e6834[_0x30c951(0x101)](Markup[_0x30c951(0x23b)][_0x30c951(0x289)](_0x478ed0[_0x30c951(0x189)]==_0x30c951(0x130)?_0x30c951(0x22a):_0x30c951(0x14d)+_0x478ed0[_0x30c951(0x189)],_0x30c951(0x1e4)+_0x478ed0[_0x30c951(0x189)])),_0x36a8a2%_0x3ecd98==0x0&&(_0xae398a[_0x17a9e1]=_0x3e6834,_0x17a9e1++);});const _0x15dbaa=Markup[_0x15f8a8(0x15d)](_0xae398a);_0x5603b7[_0x15f8a8(0x14b)](_0x15f8a8(0x279),_0x15dbaa);}}),tgBot[_0x371b15(0x20f)](/on_(.+)/,async _0x7518ce=>{const _0x94fed5=_0x371b15,_0xddb6b4=_0x7518ce[_0x94fed5(0x28e)][0x1];_0x7518ce['editMessageReplyMarkup']();if(_0xddb6b4==_0x94fed5(0x130)){const _0x55bb8b=getDisabledBots();await sendTelegram(_0x7518ce[_0x94fed5(0x1e0)]['id'],_0x94fed5(0x1cf)),_0x55bb8b[_0x94fed5(0x126)](_0x3767d7=>{const _0x4b7d9f=_0x94fed5;if(_0x3767d7[_0x4b7d9f(0x189)]!='all')toggleBot(_0x3767d7[_0x4b7d9f(0x189)],toggleStatus(_0x3767d7['botID']),'stopped');});}else await sendTelegram(_0x7518ce[_0x94fed5(0x1e0)]['id'],_0x94fed5(0x1d3)+_0xddb6b4),toggleBot(_0xddb6b4,toggleStatus(_0xddb6b4),_0x94fed5(0x1f5));}),tgBot[_0x371b15(0x29f)](_0x371b15(0x102),async _0xe204a1=>{const _0x539164=_0x371b15,_0x12e37f=getEnabledBots();if(_0x12e37f[_0x539164(0x97)]==0x0)await sendTelegram(_0xe204a1[_0x539164(0x1e0)]['id'],_0x539164(0x1af));else{if(_0x12e37f[_0x539164(0x97)]>0x1)_0x12e37f[_0x539164(0x101)]({'botID':_0x539164(0x130)});let _0x48fe33=[],_0x79a95a=[];const _0x249753=_0x12e37f[_0x539164(0x97)]%0x4==0x0||_0x12e37f[_0x539164(0x97)]%0x4==0x3||_0x12e37f['length']%0x3==0x1?0x4:0x3;let _0x347640=0x0;_0x12e37f['forEach']((_0x1e0d8e,_0x18fd05)=>{const _0x553131=_0x539164;if(_0x18fd05%_0x249753==0x0)_0x79a95a=[];_0x79a95a[_0x553131(0x101)](Markup[_0x553131(0x23b)][_0x553131(0x289)](_0x1e0d8e[_0x553131(0x189)]=='all'?_0x553131(0x22a):_0x553131(0x14d)+_0x1e0d8e[_0x553131(0x189)],_0x553131(0x1b4)+_0x1e0d8e[_0x553131(0x189)])),_0x18fd05%_0x249753==0x0&&(_0x48fe33[_0x347640]=_0x79a95a,_0x347640++);});const _0x48489b=Markup[_0x539164(0x15d)](_0x48fe33);_0xe204a1['reply'](_0x539164(0x112),_0x48489b);}}),tgBot[_0x371b15(0x20f)](/off_(.+)/,async _0x390a23=>{const _0x5d0b0a=_0x371b15,_0x2e44cf=_0x390a23[_0x5d0b0a(0x28e)][0x1];_0x390a23['editMessageReplyMarkup']();if(_0x2e44cf==_0x5d0b0a(0x130)){const _0x4d4ed5=getEnabledBots();await sendTelegram(_0x390a23[_0x5d0b0a(0x1e0)]['id'],_0x5d0b0a(0x13a)),_0x4d4ed5['forEach'](_0x2aaa12=>{const _0x585705=_0x5d0b0a;if(_0x2aaa12[_0x585705(0x189)]!=_0x585705(0x130))toggleBot(_0x2aaa12[_0x585705(0x189)],toggleStatus(_0x2aaa12[_0x585705(0x189)]),_0x585705(0x1f5));});}else await sendTelegram(_0x390a23[_0x5d0b0a(0x1e0)]['id'],_0x5d0b0a(0x270)+_0x2e44cf),toggleBot(_0x2e44cf,toggleStatus(_0x2e44cf),_0x5d0b0a(0x1f5));}),tgBot[_0x371b15(0x29f)](_0x371b15(0x1ec),async _0x5761e5=>{const _0x4954a9=_0x371b15,_0x329507=getEnabledBots();if(_0x329507[_0x4954a9(0x97)]==0x0)await sendTelegram(_0x5761e5[_0x4954a9(0x1e0)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x329507[_0x4954a9(0x97)]>0x1){let _0x6b6ab3=[],_0x20ddc3=[];const _0x2eb87c=_0x329507[_0x4954a9(0x97)]%0x4==0x0||_0x329507[_0x4954a9(0x97)]%0x4==0x3||_0x329507[_0x4954a9(0x97)]%0x3==0x1?0x4:0x3;let _0x507c55=0x0;_0x329507['forEach']((_0x532c68,_0xc855e8)=>{const _0x3993e4=_0x4954a9;if(_0xc855e8%_0x2eb87c==0x0)_0x20ddc3=[];_0x20ddc3['push'](Markup['button'][_0x3993e4(0x289)]('Bot\x20'+_0x532c68['botID'],_0x3993e4(0x22e)+_0x532c68[_0x3993e4(0x189)])),_0xc855e8%_0x2eb87c==0x0&&(_0x6b6ab3[_0x507c55]=_0x20ddc3,_0x507c55++);});const _0x3bdc85=Markup[_0x4954a9(0x15d)](_0x6b6ab3);_0x5761e5['reply'](_0x4954a9(0x10c),_0x3bdc85);}else{const _0x3b8dc3=_0x329507[0x0]['botID'];if(pid[_0x3b8dc3])pid[_0x3b8dc3][_0x4954a9(0x24e)]({'function':_0x4954a9(0x291),'args':null});}}}),tgBot[_0x371b15(0x20f)](/metrics_(.+)/,async _0x158e8c=>{const _0x22012d=_0x371b15,_0x9d7c0d=_0x158e8c[_0x22012d(0x28e)][0x1];_0x158e8c[_0x22012d(0xad)]();if(pid[_0x9d7c0d])pid[_0x9d7c0d][_0x22012d(0x24e)]({'function':_0x22012d(0x291),'args':null});}),tgBot[_0x371b15(0x29f)](_0x371b15(0x1f6),async _0x34dd80=>{const _0x2923d3=_0x371b15,_0xe66fdd=getEnabledBots();if(_0xe66fdd['length']==0x0)await sendTelegram(_0x34dd80[_0x2923d3(0x1e0)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0xe66fdd[_0x2923d3(0x97)]>0x1){let _0x4ffa04=[],_0x77b040=[];const _0x157f2e=_0xe66fdd[_0x2923d3(0x97)]%0x4==0x0||_0xe66fdd[_0x2923d3(0x97)]%0x4==0x3||_0xe66fdd[_0x2923d3(0x97)]%0x3==0x1?0x4:0x3;let _0x59e3cf=0x0;_0xe66fdd[_0x2923d3(0x126)]((_0x2cc7ea,_0x3c274e)=>{const _0x360db1=_0x2923d3;if(_0x3c274e%_0x157f2e==0x0)_0x77b040=[];_0x77b040[_0x360db1(0x101)](Markup['button']['callback'](_0x360db1(0x14d)+_0x2cc7ea[_0x360db1(0x189)],_0x360db1(0x11a)+_0x2cc7ea[_0x360db1(0x189)])),_0x3c274e%_0x157f2e==0x0&&(_0x4ffa04[_0x59e3cf]=_0x77b040,_0x59e3cf++);});const _0x35a388=Markup['inlineKeyboard'](_0x4ffa04);_0x34dd80['reply'](_0x2923d3(0x9c),_0x35a388);}else{const _0xfdfa21=_0xe66fdd[0x0][_0x2923d3(0x189)];if(pid[_0xfdfa21])pid[_0xfdfa21][_0x2923d3(0x24e)]({'function':'sendPortfolioTelegram','args':null});}}}),tgBot[_0x371b15(0x20f)](/portfolio_(.+)/,async _0x3dc218=>{const _0x1d1801=_0x371b15,_0x20ad9d=_0x3dc218[_0x1d1801(0x28e)][0x1];_0x3dc218[_0x1d1801(0xad)]();if(pid[_0x20ad9d])pid[_0x20ad9d][_0x1d1801(0x24e)]({'function':_0x1d1801(0x1da),'args':null});}),tgBot[_0x371b15(0x29f)](_0x371b15(0x254),async _0x8c6b18=>{const _0x30f6ef=_0x371b15,_0x1f4c8c=_0x30f6ef(0x254);await zipFiles(_0x1f4c8c);const _0x17808d=zippath+(_0x1f4c8c+_0x30f6ef(0x296));_0x8c6b18[_0x30f6ef(0x109)]({'source':_0x17808d})['then'](()=>{})['catch'](_0x3b8882=>logger[_0x30f6ef(0x23c)]('Error\x20sending\x20'+_0x1f4c8c+_0x30f6ef(0x268),_0x3b8882));}),tgBot[_0x371b15(0x29f)](_0x371b15(0x276),async _0x19177d=>{const _0x24fbff=_0x371b15,_0x139069=_0x24fbff(0x276);await backupConfigFiles(),await zipFiles(_0x139069);const _0x7e7611=zippath+(_0x139069+'.zip');_0x19177d[_0x24fbff(0x109)]({'source':_0x7e7611})[_0x24fbff(0xcb)](()=>{})['catch'](_0x5d60ec=>logger[_0x24fbff(0x23c)](_0x24fbff(0x133)+_0x139069+_0x24fbff(0x268),_0x5d60ec));}),tgBot[_0x371b15(0x29f)](_0x371b15(0x203),async _0x50cfb9=>{const _0x4a8b3d=_0x371b15;await getMessages();if(!updateAvailable)await sendTelegram(_0x50cfb9[_0x4a8b3d(0x1e0)]['id'],_0x4a8b3d(0x12e));else{if(!validInstallation)await sendTelegram(_0x50cfb9[_0x4a8b3d(0x1e0)]['id'],_0x4a8b3d(0x233));else{const _0x2b19ff=Markup[_0x4a8b3d(0x15d)]([Markup[_0x4a8b3d(0x23b)]['callback'](_0x4a8b3d(0x168),_0x4a8b3d(0x292)),Markup[_0x4a8b3d(0x23b)][_0x4a8b3d(0x289)]('No',_0x4a8b3d(0x155))]);_0x50cfb9['reply'](_0x4a8b3d(0x136),_0x2b19ff);}}}),tgBot[_0x371b15(0x20f)](/update_(.+)/,async _0x575153=>{const _0x1ff267=_0x371b15,_0x29cda0=_0x575153[_0x1ff267(0x28e)][0x1];_0x575153[_0x1ff267(0xad)](),_0x29cda0=='yes'&&(await sendTelegram(_0x575153['chat']['id'],_0x1ff267(0x183)),updateBB(_0x1ff267(0x203))),_0x29cda0=='no'&&await sendTelegram(_0x575153[_0x1ff267(0x1e0)]['id'],_0x1ff267(0x1e2));}),tgBot['command'](_0x371b15(0x16a),async _0xcf7fdd=>{const _0x1437c3=_0x371b15;if(!validInstallation)await sendTelegram(_0xcf7fdd[_0x1437c3(0x1e0)]['id'],_0x1437c3(0x26d));else{const _0x21749d=Markup[_0x1437c3(0x15d)]([Markup[_0x1437c3(0x23b)][_0x1437c3(0x289)](_0x1437c3(0x168),'reinstall_yes'),Markup[_0x1437c3(0x23b)][_0x1437c3(0x289)]('No',_0x1437c3(0x263))]);_0xcf7fdd[_0x1437c3(0x14b)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x21749d);}}),tgBot[_0x371b15(0x20f)](/reinstall_(.+)/,async _0x5a99f4=>{const _0x40e819=_0x371b15,_0x1d2959=_0x5a99f4[_0x40e819(0x28e)][0x1];_0x5a99f4[_0x40e819(0xad)](),_0x1d2959==_0x40e819(0x18a)&&(await sendTelegram(_0x5a99f4[_0x40e819(0x1e0)]['id'],_0x40e819(0x222)),updateBB(_0x40e819(0x16a))),_0x1d2959=='no'&&await sendTelegram(_0x5a99f4['chat']['id'],_0x40e819(0x1b6));}),tgBot[_0x371b15(0x29f)](_0x371b15(0x1fe),async _0x5ca23b=>{const _0x50963d=_0x371b15,_0x49d053=getBotsWithMode();if(_0x49d053[_0x50963d(0x97)]==0x0)await sendTelegram(_0x5ca23b[_0x50963d(0x1e0)]['id'],_0x50963d(0x1af));else{let _0x1c2ab5=[],_0x92a7ac=[];const _0x44d153=0x2;let _0x12f81a=0x0;_0x49d053['forEach']((_0x538b5c,_0x53accf)=>{const _0x311ac8=_0x50963d;if(_0x53accf%_0x44d153==0x0)_0x92a7ac=[];_0x92a7ac['push'](Markup[_0x311ac8(0x23b)][_0x311ac8(0x289)](_0x311ac8(0x14d)+_0x538b5c['botID']+'\x20('+_0x538b5c['mode']+')',_0x311ac8(0x2ab)+_0x538b5c[_0x311ac8(0x189)])),_0x53accf%_0x44d153==0x0&&(_0x1c2ab5[_0x12f81a]=_0x92a7ac,_0x12f81a++);});const _0xc1fdc3=Markup[_0x50963d(0x15d)](_0x1c2ab5);_0x5ca23b[_0x50963d(0x14b)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0xc1fdc3);}}),tgBot[_0x371b15(0x20f)](/toggle_(.+)/,async _0x3dbf0c=>{const _0x1abf04=_0x371b15,_0x236f9e=_0x3dbf0c['match'][0x1];_0x3dbf0c[_0x1abf04(0xad)]();const _0x3c6904=getBotsWithMode(),_0x8fc7e2=_0x3c6904[_0x1abf04(0x221)](_0xc70aee=>_0xc70aee[_0x1abf04(0x189)]==_0x236f9e),_0x58e88b=_0x8fc7e2['mode']==_0x1abf04(0x29d)?_0x1abf04(0xb7):_0x1abf04(0x29d);await sendTelegram(_0x3dbf0c[_0x1abf04(0x1e0)]['id'],_0x1abf04(0x285)+_0x236f9e+_0x1abf04(0xba)+_0x58e88b+'\x20mode'),toggleBotMode(_0x236f9e);}),tgBot[_0x371b15(0x29f)](_0x371b15(0x27d),async _0x5695ee=>{const _0x27480b=_0x371b15;let _0x1b8be5='';config[_0x27480b(0x126)](_0x4ed65d=>{const _0x86e88f=_0x27480b;_0x1b8be5+=_0x86e88f(0x14d)+_0x4ed65d[_0x86e88f(0x189)]+':\x20'+_0x4ed65d[_0x86e88f(0x146)]+'\x0a';}),await sendTelegram(_0x5695ee['chat']['id'],_0x1b8be5,{'parse_mode':'HTML'});}),tgBot['command'](_0x371b15(0x11e),async _0xdc93f4=>{const _0x2b2c5c=_0x371b15;await sendTelegram(_0xdc93f4[_0x2b2c5c(0x1e0)]['id'],_0x279c09);}),process[_0x371b15(0xed)]('SIGINT',()=>tgBot['stop'](_0x371b15(0xc1))),process[_0x371b15(0xed)](_0x371b15(0x24b),()=>tgBot[_0x371b15(0x15b)](_0x371b15(0x24b))),tgBot[_0x371b15(0x149)]();}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x300028,_0x4c3b2e,_0x3e1782){const _0x3ba24b=_0x394128;_0x3e1782={..._0x3e1782,'disable_web_page_preview':!![]};try{await tgBot[_0x3ba24b(0x223)][_0x3ba24b(0x264)](_0x300028,_0x4c3b2e,_0x3e1782);}catch(_0x79bab8){logger[_0x3ba24b(0x23c)](_0x3ba24b(0xff),_0x79bab8);}}async function sendTelegramBot(_0x158322,_0x35c898){const _0xc16652=_0x394128;if(settings[_0xc16652(0xa5)]){if(settings[_0xc16652(0x14e)]=='all'||(_0x35c898['type']=='error'||_0x35c898[_0xc16652(0x121)]==_0xc16652(0x1d6)||_0x35c898[_0xc16652(0x121)]==_0xc16652(0x103))&&settings[_0xc16652(0x14e)]=='alerts'||_0x35c898['type']==_0xc16652(0x18f)&&settings[_0xc16652(0x14e)]=='orders'){if(tgBot&&settings[_0xc16652(0x27c)]){if(_0x35c898[_0xc16652(0x1bb)])await sendTelegram(settings[_0xc16652(0x27c)],_0x35c898['botname']+_0xc16652(0x93)+_0x35c898[_0xc16652(0x98)]);else await sendTelegram(settings[_0xc16652(0x27c)],_0xc16652(0x14d)+_0x158322+_0xc16652(0x93)+_0x35c898[_0xc16652(0x98)]);}}}}async function sendTelegramMsg(_0x4c1da2,_0x1fb233=_0x394128(0x238)){const _0x4f1b6f=_0x394128;return settings['telegramEnabled']&&tgBot&&settings[_0x4f1b6f(0x27c)]?(await sendTelegram(settings[_0x4f1b6f(0x27c)],_0x4c1da2,{'parse_mode':_0x1fb233}),!![]):![];}function getDeviceWithIp(_0x12e793){const _0x4786f5=_0x394128;return devices[_0x4786f5(0x221)](_0x368b4e=>_0x368b4e['ip']===_0x12e793);}async function temporaryAccess2FA(_0x553ed3,_0x13bb55){const _0x17b94d=_0x394128;let _0x1beb06=new Date(),_0x4a462c=![];if(lastIpApproval){if(_0x1beb06-lastIpApproval<0x1388)_0x4a462c=!![];}lastIpApproval=new Date();if(_0x4a462c)return;if(tgBot&&settings[_0x17b94d(0x27c)]){const _0x5b2710=uuidRandom();tmpStorage[_0x5b2710]={'uuid':_0x553ed3,'externalip':_0x13bb55};const _0x50afd1=Markup[_0x17b94d(0x15d)]([Markup[_0x17b94d(0x23b)][_0x17b94d(0x289)](_0x17b94d(0x244),_0x17b94d(0x213)+_0x5b2710),Markup[_0x17b94d(0x23b)][_0x17b94d(0x289)]('15\x20min',_0x17b94d(0x23a)+_0x5b2710),Markup['button'][_0x17b94d(0x289)](_0x17b94d(0x299),_0x17b94d(0x29c)+_0x5b2710),Markup[_0x17b94d(0x23b)]['callback']('reject',_0x17b94d(0x19d)+_0x5b2710)]);await sendTelegram(settings[_0x17b94d(0x27c)],_0x17b94d(0x201)+normalizeIP(_0x13bb55)[_0x17b94d(0x294)]+'\x20?',_0x50afd1),tgBot[_0x17b94d(0x20f)](/tempaccess_(.+)_(.+)/,async _0x366236=>{const _0x1d7586=_0x17b94d,_0x317c17=_0x366236[_0x1d7586(0x28e)][0x1],_0x387915=_0x366236[_0x1d7586(0x28e)][0x2],{uuid:_0x3892c7,externalip:_0x225969}=tmpStorage[_0x387915];delete tmpStorage[_0x387915],_0x366236[_0x1d7586(0xad)](),devices[_0x3892c7][_0x1d7586(0xfc)]={'clientip':_0x225969,'timestamp':new Date()[_0x1d7586(0x247)](),'expiry':_0x317c17},_0x317c17!=_0x1d7586(0x261)?(await sendTelegram(_0x366236[_0x1d7586(0x1e0)]['id'],_0x1d7586(0x1e7)+_0x317c17+_0x1d7586(0x111),{'parse_mode':_0x1d7586(0x238)}),io['to'](_0x3892c7)[_0x1d7586(0x212)](_0x1d7586(0x15e),{'access':{'allow':![],'reason':_0x1d7586(0x129),'token':null}})):(await sendTelegram(_0x366236[_0x1d7586(0x1e0)]['id'],_0x1d7586(0x1e5)),io['to'](_0x3892c7)[_0x1d7586(0x212)](_0x1d7586(0x15e),{'access':{'allow':![],'reason':_0x1d7586(0x176),'token':null}}));});}}async function loginAccess2FA(_0x43b6e9,_0x2fdc29){const _0x43830a=_0x394128;if(tgBot&&settings[_0x43830a(0x27c)]){const _0x85eb87=uuidRandom();tmpStorage[_0x85eb87]={'uuid':_0x43b6e9,'externalip':_0x2fdc29};const _0x2af518=Markup['inlineKeyboard']([Markup[_0x43830a(0x23b)][_0x43830a(0x289)]('accept',_0x43830a(0x141)+loginExpiry+'_'+_0x85eb87),Markup['button'][_0x43830a(0x289)](_0x43830a(0x261),_0x43830a(0x10b)+_0x85eb87)]);await sendTelegram(settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x2fdc29)[_0x43830a(0x294)]+'\x20?',_0x2af518),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x426b60=>{const _0x342f73=_0x43830a,_0x5a7c4d=_0x426b60[_0x342f73(0x28e)][0x1],_0x2be649=_0x426b60[_0x342f73(0x28e)][0x2],{uuid:_0x4b86cc,externalip:_0x5ee155}=tmpStorage[_0x2be649];delete tmpStorage[_0x2be649],_0x426b60[_0x342f73(0xad)](),devices[_0x4b86cc]['telegram2FaApproval']={'clientip':_0x5ee155,'timestamp':new Date()[_0x342f73(0x247)](),'expiry':_0x5a7c4d},_0x5a7c4d!='reject'?(await sendTelegram(_0x426b60[_0x342f73(0x1e0)]['id'],'Login\x20accepted',{'parse_mode':_0x342f73(0x238)}),io['to'](_0x4b86cc)[_0x342f73(0x212)](_0x342f73(0x15e),{'access':{'allow':![],'reason':_0x342f73(0x129),'token':null}})):(await sendTelegram(_0x426b60[_0x342f73(0x1e0)]['id'],_0x342f73(0x1f0)),io['to'](_0x4b86cc)[_0x342f73(0x212)](_0x342f73(0x15e),{'access':{'allow':![],'reason':_0x342f73(0x2ac),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x4f0f03=_0x394128;return dbConfig[_0x4f0f03(0xce)](_0x4f0f03(0xdd))[_0x4f0f03(0x1a9)](_0x4f0f03(0x189))[_0x4f0f03(0x273)]({'status':_0x4f0f03(0x1f9)})[_0x4f0f03(0x198)]()||[];}function getDisabledBots(){const _0x459604=_0x394128;return dbConfig[_0x459604(0xce)]('bots')[_0x459604(0x1a9)]('botID')[_0x459604(0x273)]({'status':'disabled'})[_0x459604(0x198)]()||[];}function getBotAttributes(_0x5d0ad1){const _0x454df9=_0x394128;let _0x5abfcd={};const _0x56d62d=configpath+'bot-'+_0x5d0ad1+_0x454df9(0xd5),_0x320b08=fs['existsSync'](_0x56d62d);if(_0x320b08){const _0x508701=fs['readFileSync'](_0x56d62d);try{const _0x1ab45f=JSON[_0x454df9(0x16e)](_0x508701),_0x484730=_0x1ab45f?_0x1ab45f[_0x454df9(0x22c)][0x0][_0x454df9(0xcf)]:![];_0x5abfcd['mode']=_0x484730?'auto':_0x454df9(0xb7),_0x5abfcd['botname']=_0x1ab45f?_0x1ab45f[_0x454df9(0x22c)][0x0]['botname']:'Bot\x20'+_0x5d0ad1;}catch(_0x1bd61d){_0x5abfcd['mode']=_0x454df9(0xb7),_0x5abfcd[_0x454df9(0x146)]=_0x454df9(0x14d)+_0x5d0ad1;}}else _0x5abfcd[_0x454df9(0xc9)]=_0x454df9(0xb7),_0x5abfcd[_0x454df9(0x146)]=_0x454df9(0x14d)+_0x5d0ad1;return _0x5abfcd;}function getBotsWithMode(){const _0x45e7b0=_0x394128,_0x5b11d6=dbConfig[_0x45e7b0(0xce)](_0x45e7b0(0xdd))[_0x45e7b0(0x1a9)](_0x45e7b0(0x189))[_0x45e7b0(0x198)]()||[];return _0x5b11d6['forEach'](_0x37191c=>{const _0x44dc2a=_0x45e7b0;let _0x4a9203=getBotAttributes(_0x37191c[_0x44dc2a(0x189)]);_0x37191c[_0x44dc2a(0xc9)]=_0x4a9203[_0x44dc2a(0xc9)];}),_0x5b11d6;}function getBotExchanges(){const _0x46ae4d=_0x394128;let _0x4d2d4d=[];const _0x1ca4fa=dbConfig['get'](_0x46ae4d(0xdd))[_0x46ae4d(0x1a9)]('botID')[_0x46ae4d(0x198)]()||[];_0x1ca4fa[_0x46ae4d(0x126)](_0x1b4621=>{const _0x521f3a=_0x46ae4d;if(_0x1b4621[_0x521f3a(0x15e)]==_0x521f3a(0x1f9)){const _0x22dc51=configpath+_0x521f3a(0x28f)+_0x1b4621['botID']+_0x521f3a(0xd5),_0x4ae227=fs['existsSync'](_0x22dc51);let _0xe44923;if(_0x4ae227){const _0x3257bd=fs['readFileSync'](_0x22dc51);try{const _0x55054b=JSON['parse'](_0x3257bd);_0xe44923=_0x55054b?_0x55054b['bot'][0x0][_0x521f3a(0x9e)]:null;}catch(_0x3e0909){}}if(_0xe44923)_0x4d2d4d[_0x521f3a(0x101)](_0xe44923);}});const _0x232081=[...new Set(_0x4d2d4d)][_0x46ae4d(0x284)]();return _0x232081;}async function initUser(){const _0x41aad9=_0x394128;if(!settings['userid']){const _0x3216c1=uuidRandom();mixpanel[_0x41aad9(0x11f)](_0x3216c1),updateSetting('userid',_0x3216c1);}}async function initSecure(){const _0x2c7408=_0x394128;let _0x123343=getSecure();if(!_0x123343[_0x2c7408(0x181)](_0x2c7408(0x27f))){let _0x47aeac=await generateKeys();_0x123343[_0x2c7408(0x208)]=_0x47aeac[_0x2c7408(0x208)],_0x123343[_0x2c7408(0x1ff)]=_0x47aeac[_0x2c7408(0x1ff)],_0x123343[_0x2c7408(0x27f)]=crypto['randomBytes'](0x20)[_0x2c7408(0x1ee)]('hex');;storeSecure(_0x123343);}}function getSettings(){const _0x5a7ca8=_0x394128;return dbSettings[_0x5a7ca8(0xce)]('settings')[_0x5a7ca8(0x198)]()||{};}function getSecure(){const _0x228614=_0x394128;return dbSecure['get'](_0x228614(0x11b))[_0x228614(0x198)]()||{};}function getBlacklist(){const _0x583482=_0x394128;return dbSecure[_0x583482(0xce)](_0x583482(0x18e))[_0x583482(0x198)]()||[];}function broadcastToBots(_0x5ad51f,_0x4099da){const _0x133359=_0x394128;config[_0x133359(0x126)](_0x40fd2d=>{const _0x1f43e6=_0x133359;if(_0x40fd2d['status']==_0x1f43e6(0x1f9)&&_0x40fd2d['live']==_0x1f43e6(0xbd)||_0x40fd2d[_0x1f43e6(0x15e)]==_0x1f43e6(0x22f)&&_0x40fd2d[_0x1f43e6(0x255)]==_0x1f43e6(0xbd)){if(pid[_0x40fd2d[_0x1f43e6(0x189)]])pid[_0x40fd2d[_0x1f43e6(0x189)]][_0x1f43e6(0x24e)]({[_0x5ad51f]:_0x4099da});}});}async function storeSettings(_0x576928,_0x5ed313=![]){const _0x5fd271=_0x394128;_0x576928={...settings,..._0x576928};if(_0x5ed313&&_0x576928['bbPassword']!=_0x5fd271(0x2a3)&&_0x576928[_0x5fd271(0xa9)]!=_0x5fd271(0x1c0)&&_0x576928[_0x5fd271(0xa9)]!=''){const _0x1c8cb2=decryptRSA(secure['privateKey'],_0x576928[_0x5fd271(0xa9)])['split'](_0x5fd271(0x275))[0x0],_0xbd7542=bcrypt['hashSync'](_0x1c8cb2,saltRounds);_0x576928={..._0x576928,'bbPassword':_0xbd7542};}if(_0x5ed313&&_0x576928[_0x5fd271(0x169)]!=_0x5fd271(0x2a3)&&_0x576928['telegramToken']!='***'&&_0x576928[_0x5fd271(0x169)]!=''){const _0x12bc9c=decryptRSA(secure[_0x5fd271(0x1ff)],_0x576928['telegramToken'])[_0x5fd271(0xa8)]('|@|')[0x0];_0x576928={..._0x576928,'telegramToken':_0x12bc9c};}if(_0x5ed313&&_0x576928[_0x5fd271(0x16d)]!=_0x5fd271(0x2a3)&&_0x576928[_0x5fd271(0x16d)]!=_0x5fd271(0x1c0)&&_0x576928[_0x5fd271(0x16d)]!=''){const _0x40e040=decryptRSA(secure['privateKey'],_0x576928[_0x5fd271(0x16d)])[_0x5fd271(0xa8)](_0x5fd271(0x275))[0x0];_0x576928={..._0x576928,'marketcapApi':_0x40e040};}const _0x2575f6=_0x576928['telegramToken']!=_0x5fd271(0x2a3)&&_0x576928['telegramToken']!=settings['telegramToken']||_0x576928[_0x5fd271(0x21f)]!=settings[_0x5fd271(0x21f)],_0x1a2863=_0x576928[_0x5fd271(0x169)]==''||_0x576928[_0x5fd271(0x21f)]=='',_0x4bb003=_0x576928['marketcapApi']&&_0x576928['marketcapApi']!=_0x5fd271(0x2a3)&&_0x576928[_0x5fd271(0x16d)]!=settings[_0x5fd271(0x169)];_0x2575f6&&(_0x576928[_0x5fd271(0x27c)]=null,_0x576928[_0x5fd271(0x14e)]='all');for(const [_0xf61e30,_0x47b751]of Object['entries'](_0x576928)){if(_0xf61e30==_0x5fd271(0x169)&&_0x47b751=='************'){_0x576928[_0x5fd271(0x169)]=settings[_0x5fd271(0x169)];continue;};if(_0xf61e30==_0x5fd271(0xa9)&&_0x47b751==_0x5fd271(0x2a3)){_0x576928[_0x5fd271(0xa9)]=settings['bbPassword'];continue;};if(_0xf61e30==_0x5fd271(0x16d)&&_0x47b751=='************'){_0x576928[_0x5fd271(0x16d)]=settings['marketcapApi'];continue;};dbSettings[_0x5fd271(0xbf)]('settings.'+_0xf61e30,_0x47b751)[_0x5fd271(0xd0)]();}settings=_0x576928,io['to'](_0x5fd271(0xa7))[_0x5fd271(0x212)](_0x5fd271(0x123),cleanSettings()),broadcastToBots(_0x5fd271(0x20c),settings['timeshift']),broadcastToBots(_0x5fd271(0x95),settings[_0x5fd271(0x95)]),broadcastToBots(_0x5fd271(0x16d),settings[_0x5fd271(0x16d)]);if(_0x2575f6&&!_0x1a2863)initTelegram();if(_0x2575f6&&_0x1a2863)disableTelegram();getAllClients()[_0x5fd271(0x126)](_0x46b477=>{const _0x4e4456=_0x5fd271;getSocket(_0x46b477['id'])[_0x4e4456(0x212)](_0x4e4456(0x15e),{'access':{'allow':![],'reason':_0x4e4456(0x129),'token':null}});}),_0x4bb003&&(await sleep(0xbb8),testMarketcapApi(_0x576928['marketcapApi']));}async function testMarketcapApi(_0x4fb377){const _0x52b641=_0x394128,_0x1b7ca1=[_0x52b641(0x241),_0x52b641(0xf0)];try{await axios[_0x52b641(0xce)](_0x52b641(0x24c),{'headers':{'X-CMC_PRO_API_KEY':_0x4fb377},'params':{'symbol':_0x1b7ca1['toString']()}});}catch(_0x3418ca){_0x3418ca[_0x52b641(0x1ee)]()[_0x52b641(0x1d5)]('status\x20code\x20401')?(io['to']('botmanager')[_0x52b641(0x212)](_0x52b641(0x281),_0x52b641(0x251)),logger[_0x52b641(0xda)](_0x52b641(0x251))):(io['to'](_0x52b641(0xa7))[_0x52b641(0x212)](_0x52b641(0x281),_0x52b641(0x19a)),logger[_0x52b641(0xda)](_0x52b641(0x19a)),logger[_0x52b641(0x23c)]('Error\x20details:',_0x3418ca['toString']()+_0x52b641(0x272)+_0x3418ca[_0x52b641(0x206)]));return;}logger[_0x52b641(0x23c)](_0x52b641(0x9d));}function updateSetting(_0x571b8d,_0x1d240b){const _0x3d7d65=_0x394128;dbSettings[_0x3d7d65(0xbf)](_0x3d7d65(0x115)+_0x571b8d,_0x1d240b)[_0x3d7d65(0xd0)](),settings=getSettings(),io['to'](_0x3d7d65(0xa7))[_0x3d7d65(0x212)]('settings',cleanSettings());}function _0x3606(_0x10cf56,_0xbc4142){const _0x274c80=_0x2b11();return _0x3606=function(_0x2163e4,_0x22a87e){_0x2163e4=_0x2163e4-0x93;let _0x2b1158=_0x274c80[_0x2163e4];return _0x2b1158;},_0x3606(_0x10cf56,_0xbc4142);}function storeSecure(_0x400faa){const _0x4d9d54=_0x394128;dbSecure['get'](_0x4d9d54(0x11b))[_0x4d9d54(0x101)](_0x400faa)[_0x4d9d54(0xd0)](),secure=_0x400faa;}function addBlacklist(_0x5a188d){const _0x4ea8d2=_0x394128;cleanBlacklist();let _0x4e9ce3;devices[_0x5a188d][_0x4ea8d2(0xfc)]?_0x4e9ce3=Math[_0x4ea8d2(0x1cd)](devices[_0x5a188d][_0x4ea8d2(0xfc)]['expiry'],loginExpiry):_0x4e9ce3=loginExpiry,dbSecure['get'](_0x4ea8d2(0x18e))[_0x4ea8d2(0x101)]({'expiry':new Date()[_0x4ea8d2(0x247)]()+_0x4e9ce3*0x3c*0x3e8,'token':devices[_0x5a188d][_0x4ea8d2(0x162)][_0x4ea8d2(0x1c6)]})[_0x4ea8d2(0xd0)](),blacklist=dbSecure[_0x4ea8d2(0xce)](_0x4ea8d2(0x18e))[_0x4ea8d2(0x198)]();}function cleanBlacklist(){const _0x3950e2=_0x394128;let _0x37513d=dbSecure[_0x3950e2(0xce)]('blacklist')[_0x3950e2(0x1ea)]()[_0x3950e2(0x198)](),_0x573258=new Date()[_0x3950e2(0x247)]();_0x37513d[_0x3950e2(0x126)](_0x5252f2=>{const _0x3d6526=_0x3950e2;_0x5252f2['expiry']<_0x573258&&dbSecure['get'](_0x3d6526(0x18e))[_0x3d6526(0x21e)]({'expiry':_0x5252f2[_0x3d6526(0x26a)]})[_0x3d6526(0xd0)]();});}function initStates(){let _0x5eed23=getConfiguration();_0x5eed23['forEach'](_0x59aebf=>{const _0x4426eb=_0x3606;_0x59aebf[_0x4426eb(0x255)]=_0x4426eb(0x1f5);}),storeConfiguration(_0x5eed23);}async function generateKeys(){const _0x1c6a11=_0x394128,_0x3cc218=forge[_0x1c6a11(0x1a2)][_0x1c6a11(0x12b)][_0x1c6a11(0xc4)]({'bits':0x1000,'e':0x10001}),_0x2beefb=forge[_0x1c6a11(0x1a2)]['privateKeyToPem'](_0x3cc218['privateKey']),_0x43cf2f=forge['pki']['publicKeyToPem'](_0x3cc218[_0x1c6a11(0x208)]);return{'privateKey':_0x2beefb,'publicKey':_0x43cf2f};}async function oneTimeMigration(){const _0x1927e5=_0x394128;let _0x48958f=getSettings(),_0x22c922=![];!_0x48958f['hasOwnProperty']('lastmsgtelegram')&&(_0x48958f[_0x1927e5(0x17d)]=0x0,_0x22c922=!![]);!_0x48958f[_0x1927e5(0x181)](_0x1927e5(0x1a8))&&(_0x48958f[_0x1927e5(0x1a8)]=0x0,_0x22c922=!![]);!_0x48958f['hasOwnProperty'](_0x1927e5(0x13b))&&(_0x48958f['latestversion']=_0x1927e5(0xae),_0x22c922=!![]);!_0x48958f[_0x1927e5(0x181)]('onepagemode')&&(_0x48958f['onepagemode']=![],_0x22c922=!![]);!_0x48958f[_0x1927e5(0x181)](_0x1927e5(0x16d))&&(_0x48958f['marketcapApi']='',_0x22c922=!![]);if(_0x22c922)storeSettings(_0x48958f);try{fs[_0x1927e5(0x1e9)](configbackuppath,{'withFileTypes':!![]})[_0x1927e5(0x126)](_0xbcd5bc=>{const _0x4d60ae=_0x1927e5;if(!_0xbcd5bc[_0x4d60ae(0x269)]()){if(!_0xbcd5bc[_0x4d60ae(0x99)][_0x4d60ae(0x12a)](_0x4d60ae(0x110)))fs[_0x4d60ae(0x25f)](configbackuppath+_0xbcd5bc[_0x4d60ae(0x99)]);}else fs[_0x4d60ae(0xe0)](configbackuppath+_0xbcd5bc[_0x4d60ae(0x99)],{'recursive':!![]});});}catch(_0x313054){logger[_0x1927e5(0x23c)]('Error\x20removing\x20old\x20backup\x20files:',_0x313054);}}function storeConfiguration(_0x51f102){const _0x3f859e=_0x394128;dbConfig[_0x3f859e(0xce)](_0x3f859e(0xdd))['remove']()['write'](),dbConfig[_0x3f859e(0xce)]('bots')[_0x3f859e(0x101)](..._0x51f102)[_0x3f859e(0xd0)](),config=_0x51f102;}async function resetPassword(){const _0x41e7a0=_0x394128;if(tgBot&&settings['telegramChatId']){const _0x178931=Markup[_0x41e7a0(0x15d)]([Markup['button'][_0x41e7a0(0x289)](_0x41e7a0(0x18a),_0x41e7a0(0x26e)),Markup['button'][_0x41e7a0(0x289)]('no',_0x41e7a0(0x216))]);await sendTelegram(settings[_0x41e7a0(0x27c)],_0x41e7a0(0x152),_0x178931),tgBot[_0x41e7a0(0x20f)](/resetpw_(.+)/,async _0x4c1a88=>{const _0x34257b=_0x41e7a0,_0xec49f5=_0x4c1a88[_0x34257b(0x28e)][0x1];_0x4c1a88[_0x34257b(0xad)]();if(_0xec49f5!='no'){const _0x22306b=0xf,_0x3c882a=_0x34257b(0x1b9),_0x3c78ae=Array['from'](crypto[_0x34257b(0x205)](new Uint32Array(_0x22306b)))[_0x34257b(0x200)](_0x5c4f9b=>_0x3c882a[_0x5c4f9b%_0x3c882a[_0x34257b(0x97)]])[_0x34257b(0x295)](''),_0x1d0464=bcrypt[_0x34257b(0x12d)](_0x3c78ae,saltRounds);storeSettings({'bbPassword':_0x1d0464}),await sendTelegram(_0x4c1a88['chat']['id'],_0x34257b(0x217)+_0x3c78ae,{'parse_mode':_0x34257b(0x238)});}else await sendTelegram(_0x4c1a88[_0x34257b(0x1e0)]['id'],_0x34257b(0x23d));});}}async function confirmRestore(_0x1bdf0e,_0x3867bb){const _0x29d275=_0x394128;io['to'](_0x29d275(0xa7))[_0x29d275(0x212)](_0x29d275(0x281),_0x29d275(0x228),_0x29d275(0x103));if(tgBot&&settings['telegramChatId']){const _0x76e08d=uuidRandom();tmpStorage[_0x76e08d]={'path':_0x1bdf0e,'filename':_0x3867bb};const _0x37791e=Markup[_0x29d275(0x15d)]([Markup[_0x29d275(0x23b)]['callback'](_0x29d275(0x18a),_0x29d275(0x180)+_0x76e08d),Markup[_0x29d275(0x23b)][_0x29d275(0x289)]('no',_0x29d275(0x113)+_0x76e08d)]);await sendTelegram(settings[_0x29d275(0x27c)],_0x29d275(0x1ab),_0x37791e),tgBot[_0x29d275(0x20f)](/restore_(.+)_(.+)/,async _0x465643=>{const _0x261c83=_0x29d275,_0x16d5c3=_0x465643[_0x261c83(0x28e)][0x1],_0x2f47ad=_0x465643[_0x261c83(0x28e)][0x2],{path:_0x17287c,filename:_0x585e21}=tmpStorage[_0x2f47ad];delete tmpStorage[_0x2f47ad],_0x465643[_0x261c83(0xad)](),_0x16d5c3==_0x261c83(0x18a)?(logger[_0x261c83(0x23c)](_0x261c83(0x240)),await sendTelegram(_0x465643[_0x261c83(0x1e0)]['id'],_0x261c83(0x12f),{'parse_mode':_0x261c83(0x238)}),unzipFile(_0x17287c,_0x585e21)):(logger[_0x261c83(0x23c)](_0x261c83(0x1f8)),await sendTelegram(_0x465643[_0x261c83(0x1e0)]['id'],_0x261c83(0x1f8)));});}}function getServerTime(){const _0x314acc=_0x394128,_0x566195=new Date();return _0x566195[_0x314acc(0xb0)]()+'/'+(_0x566195[_0x314acc(0x1ef)]()+0x1)[_0x314acc(0x1ee)]()[_0x314acc(0xab)](0x2,'0')+'/'+_0x566195[_0x314acc(0x1c9)]()[_0x314acc(0x1ee)]()[_0x314acc(0xab)](0x2,'0')+'\x20'+_0x566195['getHours']()['toString']()[_0x314acc(0xab)](0x2,'0')+':'+_0x566195[_0x314acc(0x243)]()[_0x314acc(0x1ee)]()[_0x314acc(0xab)](0x2,'0')+':'+_0x566195[_0x314acc(0x122)]()['toString']()[_0x314acc(0xab)](0x2,'0');}function getTimeStamp(){const _0x5140ab=_0x394128,_0x466c7b=shiftedTime();return _0x466c7b[_0x5140ab(0xb0)]()+'/'+(_0x466c7b['getMonth']()+0x1)[_0x5140ab(0x1ee)]()[_0x5140ab(0xab)](0x2,'0')+'/'+_0x466c7b[_0x5140ab(0x1c9)]()['toString']()['padStart'](0x2,'0')+'\x20'+_0x466c7b[_0x5140ab(0xca)]()[_0x5140ab(0x1ee)]()['padStart'](0x2,'0')+':'+_0x466c7b[_0x5140ab(0x243)]()['toString']()[_0x5140ab(0xab)](0x2,'0')+':'+_0x466c7b['getSeconds']()['toString']()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x2fd77b=_0x394128,_0x38ce37=shiftedTime();return _0x38ce37['getFullYear']()+(_0x38ce37[_0x2fd77b(0x1ef)]()+0x1)[_0x2fd77b(0x1ee)]()[_0x2fd77b(0xab)](0x2,'0')+_0x38ce37['getDate']()['toString']()[_0x2fd77b(0xab)](0x2,'0')+'-'+_0x38ce37[_0x2fd77b(0xca)]()[_0x2fd77b(0x1ee)]()[_0x2fd77b(0xab)](0x2,'0')+_0x38ce37['getMinutes']()[_0x2fd77b(0x1ee)]()[_0x2fd77b(0xab)](0x2,'0')+_0x38ce37['getSeconds']()[_0x2fd77b(0x1ee)]()['padStart'](0x2,'0');}function shiftedTime(){const _0x302a5e=_0x394128,_0x476719=new Date();let _0x348401=_0x476719;if(settings['timeshift']&&settings['timeshift']!==0x0)_0x348401=fns[_0x302a5e(0x2a9)](_0x476719,{'hours':settings[_0x302a5e(0x20c)]});return _0x348401;}async function startScheduler(){const _0x4eb86f=_0x394128,_0x2b9675=new Date()[_0x4eb86f(0x185)](),_0x5cf5f2=shiftedTime()[_0x4eb86f(0xca)]();_0x5cf5f2==0x4&&backupConfigFiles(),_0x5cf5f2==0x0&&(rotateLogFiles(),logger[_0x4eb86f(0x23c)]('--------------------------------------'),logger[_0x4eb86f(0x23c)](_0x4eb86f(0x287)+serverversion+_0x4eb86f(0x137)+(environment==_0x4eb86f(0x2a6)?_0x4eb86f(0x1ed):'')),logger[_0x4eb86f(0x23c)]('--------------------------------------')),_0x2b9675%0x6==0x0&&triggerAnalytics(),_0x2b9675%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}function _0x2b11(){const _0x58cd07=['status','place-order','invalid\x20credentials','any','access','12gmdJxd','graphql-request','bb/','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','argv','Yes','telegramToken','reinstall','temporary\x20access\x20not\x20allowed','-events.json','marketcapApi','parse','\x20|\x20','\x1b[33m','You\x20can\x20use\x20the\x20following\x20commands:\x0a','/logs\x20-\x20receive\x20log\x20files\x0a','sendFile','2FA\x20required','config_alerts','temporary\x20access\x20rejected','sha256','encryptedUuid','format','loadAsync','uuid','emitHistory','lastmsgtelegram','decrypt',')\x20|\x20Bot\x20','restore_yes_','hasOwnProperty','node-forge','Starting\x20Balance\x20Bot\x20update','/:bot/performance','getUTCHours','_nsps','/update\x20-\x20update\x20Balance\x20Bot\x0a','Session\x20expired\x20for\x20user\x20...','botID','yes','enable','Error:\x20Invalid\x20argument\x20','/start','blacklist','order','/off\x20-\x20stop\x20bot(s)\x0a','params','1532rZPnth','whitelistEnabled','Orders','Unauthorized\x20attempt\x20to\x20get\x20portfolio','update-bb','clients','value','message','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','store-fiat','\x1b[0m','tempaccess_reject_','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','exec','simple','index.html','pki','(((.+)+)+)+$','/:bot/configuration','version.json','production','temporary\x20token\x20generated','lastmsgemitted','sortBy','disconnect','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','store-settings','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','/enable\x20-\x20enable\x20notifications\x0a','No\x20bots\x20running\x20right\x20now','backup/','decode64','Unauthorized\x20attempt\x20to\x20get\x20events','191110iYYBQo','off_','reason','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','child_process','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Enabled\x20Bot\x20','showname','2FA','/metrics\x20-\x20show\x20bot\x20performance\x0a','lowdb/adapters/FileSync','Starting\x20(','***','IPv4','Idling\x20(','store','=>\x20Go\x20to\x20#CYA#http://','Unauthorized\x20attempt\x20to\x20delete\x20alerts','token','bbvNew','alerts','getDate','Backup\x20file\x20unzipped\x20and\x20stored','log','sockets','max','from','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','Notifications\x20disabled\x0a','apply','referer','Bot\x20Mgr\x20>\x20starting\x20Bot\x20','Unauthorized\x20attempt\x20to\x20download\x20','includes','warning','Starting\x20new\x20bot\x20|\x20Bot\x20','build2','address','sendPortfolioTelegram','telegram2FaApproval','auth','User\x20has\x20been\x20validated','telegrammsg','sign','chat','54ofcvWR','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Disabled\x20Bot\x20','on_','Temporary\x20access\x20rejected','login\x20token\x20generated','Access\x20enabled\x20for\x20',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','readdirSync','cloneDeep','Server','metrics','(staging)','toString','getMonth','Login\x20rejected','No\x20authentication\x20token','bot.js','1310koNyVO','Logged\x20in\x20user\x20...','stopped','portfolio','cancel-loading','Restore\x20process\x20aborted','enabled','updatebotmanager','add-bot','headers','$1_$2_$3','toggle','privateKey','map','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','logs/','update','deleteHistoryAlerts','randomFillSync','code','output-001.log','publicKey','6b67f3d61ee94b8f5c80b4affef4c4d9','clientip','username','timeshift','config_orders','Invalid\x20authentication\x20token\x20(1)','action','49582RBgByy','endsWith','emit','tempaccess_5_','storeConfiguration','family','resetpw_no','Password\x20has\x20been\x20reset\x20to:\x20','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','Unauthorized\x20attempt\x20to\x20get\x20messages','toggleBotMode','server','text','function','remove','telegramUsername','toggle-bot-mode','find','Starting\x20Balance\x20Bot\x20reinstallation','telegram','Logged\x20out\x20user\x20...','temporary\x20access\x20timeout','1162gBlWDj','size','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','environment','All\x20bots','Deleted\x20Bot\x20','bot','title','metrics_','new','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','address\x20already\x20in\x20use','Unauthorized\x20attempt\x20to\x20update\x20settings','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','/disable\x20-\x20disable\x20notifications\x0a','bcryptjs','socket','HTML','\x20|\x20client:\x20...','tempaccess_15_','button','debug','Password\x20reset\x20rejected','bb-settings.json','2FA\x20login\x20token\x20generated','Restore\x20process\x20confirmed','BCT','jsonwebtoken','getMinutes','5\x20min','Node.js\x20v','/:bot/portfolio','getTime','bb-config.json','output-000.log','\x20(2)','SIGTERM','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','https://api.ipify.org?format=json','send','use','private','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','constructor','internal','logs','live','/download/:type','Invalid\x20authentication\x20token\x20(2)','Notifications\x20enabled','reset-history','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','versions','placeOrder','/restart\x20-\x20restart\x20bot(s)\x0a','120362BQCHzE','unlinkSync','uuid-random','reject','conn','reinstall_no','sendMessage','/:bot/history','pidExpireLogin','copyFileSync','\x20files\x20over\x20Telegram:','isDirectory','expiry','allow','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','resetpw_yes','f2aRequired','Bot\x20Mgr\x20>\x20stopping\x20Bot\x20','/:bot','\x20-\x20','filter','whitelist','|@|','backup',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','keys','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','get-backup-files','/:bot/coins','telegramChatId','names','password','secret','verify','notification','1000','socket.io','sort','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','search','Running\x20#RED#Balance\x20Bot\x20v','-performance.json','callback','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','bbvReceive','2FA\x20login\x20required','update-bot','match','bot-','temporaryAccessAllowed','sendMetricsTelegram','update_yes','exit','show','join','.zip','showConfig','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','30\x20min','60ZrFrUY','userid','tempaccess_30_','auto','loginRequired','command','remoteAddress','orders','logout','************','/backup\x20-\x20receive\x20backup\x20files\x0a','axios','staging','\x1b[31m','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','add','mkdirSync','toggle_','2FA\x20login\x20rejected','\x20>\x20','disabled','onepagemode','static','length','event','name','util','range','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','CoinMarketCap\x20API\x20key\x20validated','exchange','string','handshake','/output-000.log','<b>Telegram\x20Bot\x20Status:</b>\x0a','new-disabled','output-002.log','telegramEnabled','Markdown','botmanager','split','bbPassword','get-messages','padStart','getStartingBalances','editMessageReplyMarkup','0.0.0','Restore\x20backup\x20file\x20','getFullYear','args','backup-full','Unauthorized\x20attempt\x20to\x20log\x20out','config','login\x20required','download','manual','binary','15348tvcHTX','\x20to\x20','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','263376uAlTmy','running','initclient','set','Backup\x20file\x20uploaded','SIGINT','connection','listen','generateKeyPair','All\x20bots\x20running\x20right\x20now','writeFileSync','122737CCwGtl','Alerts','mode','getHours','then','Network\x20Interfaces:','store-headless','get','headless','write','#RES#','min','/on\x20-\x20start\x20bot(s)\x0a','Unauthorized\x20attempt\x20to\x20store\x20configuration','-config.json','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','tkn','number','127.0.0.1','full','-results.json','express','bots','Invalid\x20username\x20or\x20IP\x20address','::1','rmSync','toIPv4MappedAddress','create','pidRefreshToken','version','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','replace','backupfile','delete-alerts','timestamp','Notifications\x20enabled\x0a','node','file','once','build','createWriteStream','ETH','config_all','Setting\x20access:\x20','path','apiSecret','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','apiPassword','bbUsername','fork','Notifications\x20types:\x20','\x1b[34m','statSync','telegramIpApproval','data','get-logs','Telegram\x20error:','removeAllListeners','push','off','success','-----------------------------------------------------------------------------------','show-config','login\x20not\x20required','Ok,\x20will\x20send\x20order\x20notifications\x20only','Unauthorized\x20attempt\x20to\x20confirm\x20message','replyWithDocument','post','login2fa_reject_','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','login','config/','started','backup-full@','\x20minutes','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','restore_no_','confirm-message','settings.','\x20only\x0a','*$1*','mtime','existsSync','portfolio_','secure','restart','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','help','alias','slice','type','getSeconds','settings','File\x20uploaded','\x20|\x20user:\x20...','forEach','env','defaults','reload','startsWith','rsa','toIPv4Address','hashSync','Your\x20installation\x20is\x20already\x20up\x20to\x20date','Restoring\x20bot(s)\x20from\x20backup','all','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','host','Error\x20sending\x20','reset-password','Unauthorized\x20attempt\x20to\x20delete\x20bot','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','#RES#\x20','messages','stringify','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','latestversion','bb-secure.json','assign','privateKeyFromPem','Ok,\x20will\x20send\x20alert\x20notifications\x20only','output-003.log','login2fa_','track','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot',',\x20must\x20be\x20a\x204\x20digit\x20number','async','botname','apiKey','catch','launch','temp/','reply','\x1b[35m','Bot\x20','telegramEvents','kill','inherit','logged\x20out','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','exp','update_no','uncaughtException','resetHistory','storeFiat','3000','port','stop','files','inlineKeyboard'];_0x2b11=function(){return _0x58cd07;};return _0x2b11();}async function restoreBackupFile(_0x3f4e3f){const _0x44f550=_0x394128;logger[_0x44f550(0x23c)](_0x44f550(0xaf)+_0x3f4e3f);const _0x511d69=getBotsWithMode();_0x511d69['length']>0x0?confirmRestore(configbackuppath,_0x3f4e3f):unzipFile(configbackuppath,_0x3f4e3f);}async function getBackupFiles(_0x3732d8=null){const _0x5ab839=_0x394128;let _0x21da51=[],_0x315f22=fs['readdirSync'](configbackuppath,{'withFileTypes':!![]});_0x315f22[_0x5ab839(0x284)]((_0x1a926f,_0x5676c9)=>_0x1a926f[_0x5ab839(0x99)]<_0x5676c9[_0x5ab839(0x99)]?0x1:_0x5676c9['name']<_0x1a926f[_0x5ab839(0x99)]?-0x1:0x0),_0x315f22['forEach'](_0x4973a6=>{const _0x215895=_0x5ab839;if(!_0x4973a6[_0x215895(0x269)]()&&_0x4973a6[_0x215895(0x99)][_0x215895(0x12a)](_0x215895(0x110))&&_0x4973a6[_0x215895(0x99)][_0x215895(0x211)]('.zip')){const _0x482818=formatDate(fs[_0x215895(0xfb)](configbackuppath+_0x4973a6[_0x215895(0x99)])[_0x215895(0x118)]);_0x21da51[_0x215895(0x101)]({'name':_0x4973a6[_0x215895(0x99)],'mtime':_0x482818});}});if(_0x3732d8)io['to'](_0x3732d8)['emit']('backup-files',_0x21da51);else return _0x21da51;}async function backupConfigFiles(){const _0x2e4210=_0x394128;await zipFiles(_0x2e4210(0xb2));const _0x4b3a95=getCleanTimeStamp();fs[_0x2e4210(0x267)](zippath+'backup-full.zip',configbackuppath+(_0x2e4210(0x110)+_0x4b3a95+_0x2e4210(0x296)));let _0x3157aa=fs[_0x2e4210(0x1e9)](configbackuppath,{'withFileTypes':!![]});_0x3157aa['sort']((_0x40a398,_0x2ca475)=>_0x40a398[_0x2e4210(0x99)]<_0x2ca475[_0x2e4210(0x99)]?0x1:_0x2ca475[_0x2e4210(0x99)]<_0x40a398[_0x2e4210(0x99)]?-0x1:0x0),_0x3157aa[_0x2e4210(0x97)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x3157aa[_0x3157aa[_0x2e4210(0x97)]-0x1][_0x2e4210(0x99)]);}function rotateLogFiles(){const _0x565e72=_0x394128,_0x53a8f0=fs['statSync'](logspath+_0x565e72(0x249)),_0x3ca8b3=_0x53a8f0[_0x565e72(0x227)]/0x400;if(_0x3ca8b3>0x64){let _0x484679=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x484679[_0x565e72(0x284)]((_0x1f8dd4,_0x300d82)=>_0x1f8dd4['name']<_0x300d82[_0x565e72(0x99)]?0x1:_0x300d82['name']<_0x1f8dd4[_0x565e72(0x99)]?-0x1:0x0),_0x484679[_0x565e72(0x126)](_0x4777fb=>{const _0x2ae6c0=_0x565e72;if(_0x4777fb['name']==_0x2ae6c0(0xa4))fs['copyFileSync'](logspath+_0x4777fb[_0x2ae6c0(0x99)],logspath+_0x2ae6c0(0x140));if(_0x4777fb[_0x2ae6c0(0x99)]==_0x2ae6c0(0x207))fs[_0x2ae6c0(0x267)](logspath+_0x4777fb['name'],logspath+'output-002.log');_0x4777fb['name']==_0x2ae6c0(0x249)&&(fs[_0x2ae6c0(0x267)](logspath+_0x4777fb[_0x2ae6c0(0x99)],logspath+_0x2ae6c0(0x207)),fs[_0x2ae6c0(0xc6)](logspath+_0x4777fb['name'],''));});}}async function zipFiles(_0x2d760c){const _0x1d2f9d=_0x394128;let _0x417a56;if(_0x2d760c=='logs')_0x417a56=logspath;if(_0x2d760c==_0x1d2f9d(0x276))_0x417a56=configpath;if(_0x2d760c==_0x1d2f9d(0xb2))_0x417a56=configpath;let _0x1dfe5e=fs[_0x1d2f9d(0x1e9)](_0x417a56,{'withFileTypes':!![]});const _0x2f9306=new JSZip();_0x1dfe5e[_0x1d2f9d(0x126)](_0x491ec0=>{const _0x1611eb=_0x1d2f9d;if(!_0x491ec0[_0x1611eb(0x269)]()){let _0x51b6c0=fs['readFileSync'](_0x417a56+_0x491ec0[_0x1611eb(0x99)]);if(_0x2d760c=='backup'){const _0x209859=/^bot-[0-9]{3}-config.json$/,_0x4d9765=_0x209859['test'](_0x491ec0[_0x1611eb(0x99)]);if(_0x4d9765){const _0x445f83=JSON['parse'](_0x51b6c0);if(_0x445f83[_0x1611eb(0x22c)][0x0]){_0x445f83['bot'][0x0][_0x1611eb(0x147)]=_0x1611eb(0x1c0),_0x445f83['bot'][0x0][_0x1611eb(0xf4)]=_0x1611eb(0x1c0);if(_0x445f83[_0x1611eb(0x22c)][0x0][_0x1611eb(0xf6)])_0x445f83[_0x1611eb(0x22c)][0x0][_0x1611eb(0xf6)]=_0x1611eb(0x1c0);}_0x51b6c0=JSON[_0x1611eb(0x139)](_0x445f83,null,0x2);}if(_0x491ec0[_0x1611eb(0x99)]==_0x1611eb(0x23e)){const _0x40a996=JSON[_0x1611eb(0x16e)](_0x51b6c0);if(_0x40a996[_0x1611eb(0x123)][_0x1611eb(0x29e)])_0x40a996[_0x1611eb(0x123)][_0x1611eb(0x29e)]=![];if(_0x40a996[_0x1611eb(0x123)]['bbPassword'])_0x40a996['settings']['bbPassword']='***';if(_0x40a996[_0x1611eb(0x123)][_0x1611eb(0x169)])_0x40a996[_0x1611eb(0x123)][_0x1611eb(0x169)]=_0x1611eb(0x1c0);if(_0x40a996[_0x1611eb(0x123)][_0x1611eb(0x27c)])_0x40a996['settings'][_0x1611eb(0x27c)]=null;if(_0x40a996[_0x1611eb(0x123)][_0x1611eb(0x16d)])_0x40a996[_0x1611eb(0x123)][_0x1611eb(0x16d)]='***';_0x51b6c0=JSON[_0x1611eb(0x139)](_0x40a996,null,0x2);}if(_0x491ec0[_0x1611eb(0x99)]!=_0x1611eb(0x13c))_0x2f9306[_0x1611eb(0xec)](_0x491ec0[_0x1611eb(0x99)],_0x51b6c0);}else _0x2f9306['file'](_0x491ec0[_0x1611eb(0x99)],_0x51b6c0);}});const _0x1c8606=await _0x2f9306['generateAsync']({'type':_0x1d2f9d(0x9f),'base64':![],'compression':'DEFLATE'});fs[_0x1d2f9d(0xc6)](zippath+(_0x2d760c+_0x1d2f9d(0x296)),_0x1c8606,_0x1d2f9d(0xb8));}async function unzipFile(_0x4f156b,_0x21cb5d){const _0x2678ea=_0x394128;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x2678ea(0x126)](_0x471f90=>{const _0x2674ca=_0x2678ea;if(!_0x471f90[_0x2674ca(0x269)]())fs[_0x2674ca(0xe0)](configpath+_0x471f90['name']);});const _0x3e357e=fs['readFileSync'](_0x4f156b+_0x21cb5d,_0x2678ea(0xb8)),_0x5719ae=await JSZip[_0x2678ea(0x17a)](_0x3e357e,{'base64':![],'checkCRC32':!![]});for(const _0x5a2e8c of Object[_0x2678ea(0x278)](_0x5719ae[_0x2678ea(0x15c)])){const _0x480383=_0x5719ae[_0x2678ea(0x15c)][_0x5a2e8c],_0x2f1525=await _0x480383[_0x2678ea(0x145)](_0x2678ea(0x9f));fs[_0x2678ea(0xc6)](configpath+_0x480383[_0x2678ea(0x99)],_0x2f1525);}fs[_0x2678ea(0x1e9)](temppath,{'withFileTypes':!![]})['forEach'](_0x4a2781=>{const _0x2d632f=_0x2678ea;if(!_0x4a2781[_0x2d632f(0x269)]())fs[_0x2d632f(0xe0)](temppath+_0x4a2781['name']);}),logger[_0x2678ea(0x23c)](_0x2678ea(0x1ca)),process[_0x2678ea(0x24e)]({'restore':!![]},_0xb1d366=>{});}async function getPublicIp(){const _0x49a4cb=_0x394128;try{const _0x17c46e=await axios[_0x49a4cb(0xce)](_0x49a4cb(0x24d));publicip=_0x17c46e[_0x49a4cb(0xfd)]['ip'];}catch(_0x2abd01){}}async function triggerAnalytics(){const _0x5dcc9d=_0x394128;if(!publicip)await getPublicIp();const _0x44e4f1=getBotsWithMode();let _0xad0791=0x0;_0x44e4f1[_0x5dcc9d(0x126)](_0x42382c=>{const _0x572282=_0x5dcc9d;if(_0x42382c[_0x572282(0x15e)]===_0x572282(0x1f9))_0xad0791++;});const _0x189969=getBotExchanges();mixpanel[_0x5dcc9d(0x142)](_0x5dcc9d(0x1eb),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x44e4f1[_0x5dcc9d(0x97)],'numbotsenabled':_0xad0791,'exchanges':_0x189969,'environment':environment});}async function getMessages(){const _0x1e1e3f=_0x394128,_0x4419d8='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x189f7d=new GraphQLClient(_0x4419d8),_0x251a3e={'authorization':_0x1e1e3f(0xe5)},_0x39511d=serverversion[_0x1e1e3f(0xa8)]('.'),_0x1e47dc=_0x39511d[0x0]+'.'+_0x39511d[0x1],_0x1d5500=Math[_0x1e1e3f(0xd2)](settings[_0x1e1e3f(0x17d)],settings[_0x1e1e3f(0x1a8)]),_0x4e56dc={'last':parseInt(_0x1d5500),'bbm':_0x1e47dc},_0x5730b2=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x385e8d;try{_0x385e8d=await _0x189f7d['request'](_0x5730b2,_0x4e56dc,_0x251a3e);}catch(_0x3bc284){}if(_0x385e8d&&_0x385e8d[_0x1e1e3f(0x138)]){let _0x1397fe=settings[_0x1e1e3f(0x17d)];newMessages=[];for(const _0x508fdd of _0x385e8d[_0x1e1e3f(0x138)]){newMessages[_0x1e1e3f(0x101)](_0x508fdd);let _0x304e07=![];_0x508fdd[_0x1e1e3f(0x1c7)]&&(updateSetting(_0x1e1e3f(0x13b),_0x508fdd[_0x1e1e3f(0x1c7)]),_0x304e07=isNewerVersion(serverversion,_0x508fdd['bbvNew'])||serverversion==_0x508fdd[_0x1e1e3f(0x1c7)]);if(!_0x304e07&&_0x508fdd['number']>_0x1397fe){if(_0x508fdd[_0x1e1e3f(0x28b)]===_0x1e1e3f(0x161)||serverversion['startsWith'](_0x508fdd[_0x1e1e3f(0x28b)])){let _0x4aae72=''+_0x508fdd[_0x1e1e3f(0x22d)]+'\x0a\x0a'+_0x508fdd[_0x1e1e3f(0x199)];const _0x3aaff6=await sendTelegramMsg(toTelegramMarkdown(_0x4aae72),_0x1e1e3f(0xa6));if(_0x3aaff6)_0x1397fe=_0x508fdd[_0x1e1e3f(0xd8)];}}}updateAvailable=isNewerVersion(settings['latestversion'],serverversion),updateSetting(_0x1e1e3f(0x17d),_0x1397fe),emitMessages();}}function emitMessages(){const _0x94ae45=_0x394128,_0x3dd196=settings[_0x94ae45(0x1a8)];let _0x211fe3=[];newMessages[_0x94ae45(0x126)](_0x5699ee=>{const _0x987bf6=_0x94ae45;_0x5699ee[_0x987bf6(0xd8)]>_0x3dd196&&_0x211fe3[_0x987bf6(0x101)](_0x5699ee);}),_0x211fe3[_0x94ae45(0x97)]>0x0&&getAllClients()['forEach'](_0x1c2cfd=>{const _0x52ef1a=_0x94ae45;getSocket(_0x1c2cfd['id'])[_0x52ef1a(0x212)](_0x52ef1a(0x199),_0x211fe3);});}function confirmMessage(_0xba80f1){const _0x5226c1=_0x394128;updateSetting(_0x5226c1(0x1a8),Number(_0xba80f1));}function isNewerVersion(_0x54395d,_0x2d3f1c){const _0xd07969=_0x394128,_0x28e0e0=_0x2d3f1c['split']('.'),_0x1c9b7a=_0x54395d['split']('.');for(var _0x248491=0x0;_0x248491<_0x1c9b7a[_0xd07969(0x97)];_0x248491++){const _0x558c1c=~~_0x1c9b7a[_0x248491],_0x118bb8=~~_0x28e0e0[_0x248491];if(_0x558c1c>_0x118bb8)return!![];if(_0x558c1c<_0x118bb8)return![];}return![];}function toTelegramMarkdown(_0x493916){const _0x3df1fd=_0x394128,_0x4f9acd=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x89d1f=/\*{2}(.+?)\*{2}/gim;return _0x493916=_0x493916[_0x3df1fd(0xe6)](_0x4f9acd,_0x3df1fd(0x1fd))[_0x3df1fd(0xe6)](_0x89d1f,_0x3df1fd(0x117)),_0x493916;}async function validateConfigFile(){const _0x124234=_0x394128,_0x341ea9=dbConfig[_0x124234(0xce)](_0x124234(0xdd))[_0x124234(0x1a9)](_0x124234(0x189))['value']()||[];if(_0x341ea9['length']==0x0){let _0x131993=0x0,_0x56d812=[];const _0x510247=/^bot-([0-9]{3})-config.json$/,_0x30c257=fs[_0x124234(0x1e9)](configpath);_0x30c257['forEach'](_0x441b07=>{const _0x34c529=_0x124234,_0x1d80d3=_0x510247[_0x34c529(0x19f)](_0x441b07);if(_0x1d80d3){const _0x349e1c=_0x1d80d3[0x1];let _0x5a777c=getBotAttributes(_0x349e1c);_0x56d812[_0x34c529(0x101)]({'botID':_0x349e1c,'botname':_0x5a777c['botname'],'status':_0x34c529(0x94),'live':_0x34c529(0x1f5)}),_0x131993++;}}),_0x131993!=0x0&&(dbConfig['get'](_0x124234(0xdd))[_0x124234(0x13d)](_0x56d812)['write'](),config=_0x56d812,restoredConfigFile=_0x131993);}}async function restoreConfigNotify(_0x337232){const _0x79871b=_0x394128;let _0x1e370b;if(restoredConfigFile==0x1)_0x1e370b='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x1e370b='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x337232)io['to'](_0x79871b(0xa7))[_0x79871b(0x212)](_0x79871b(0x281),_0x1e370b);else{logger[_0x79871b(0x1a0)]('-----------------------------------------------------------------------------------'),logger['simple'](_0x1e370b),logger[_0x79871b(0x1a0)]('-----------------------------------------------------------------------------------'),logger[_0x79871b(0x1a0)]('');if(tgBot&&settings['telegramChatId']&&settings[_0x79871b(0x14e)]!=_0x79871b(0x2a1))await sendTelegram(settings[_0x79871b(0x27c)],'Bot\x20Mgr\x20>\x20'+_0x1e370b);}}function decryptRSA(_0x403745,_0x132250){const _0x47de9e=_0x394128,_0x23e877=forge[_0x47de9e(0x1a2)][_0x47de9e(0x13e)](_0x403745),_0x1a2458=_0x23e877[_0x47de9e(0x17e)](forge[_0x47de9e(0x9a)][_0x47de9e(0x1b1)](_0x132250),'RSA-OAEP',{'md':forge['md'][_0x47de9e(0x177)]['create'](),'mgf1':{'md':forge['md'][_0x47de9e(0x177)][_0x47de9e(0xe2)]()}});return _0x1a2458;}function validateCredentials(_0x10b25b,_0x3a9a06){const _0x31b4db=_0x394128;if(_0x10b25b['username']==settings[_0x31b4db(0xf7)]&&bcrypt['compareSync'](_0x10b25b[_0x31b4db(0x27e)],settings[_0x31b4db(0xa9)])){if(settings[_0x31b4db(0x26f)])return{'allow':![],'reason':_0x31b4db(0x28c),'token':null};else{const _0x24ef39=generateLoginToken(_0x3a9a06);return{'allow':!![],'reason':_0x31b4db(0x1e6),'token':_0x24ef39};}}else return{'allow':![],'reason':_0x31b4db(0x160),'token':null};}function refreshToken(_0x162da5){const _0x157a02=_0x394128,_0x4c84e2=generateLoginToken(_0x162da5);return{'allow':!![],'reason':_0x157a02(0x1e6),'token':_0x4c84e2};}function validateAccess(_0x27fbc2,_0x4a9ca2,_0x356c42){const _0x2d31ab=_0x394128,_0x1eb7c3=_0x356c42?_0x356c42:devices[_0x4a9ca2]['ip'];let _0x4095e2;const _0x2031f7=_0x10efcf=>{const _0x192354=_0x3606;if(settings[_0x192354(0x29e)]){if(settings[_0x192354(0x26f)]){if(telegram2FaApproved(_0x4a9ca2)){const _0x305092=generateLoginToken(_0x4a9ca2);return{'allow':!![],'reason':_0x192354(0x23f),'token':_0x305092};}else return{'allow':![],'reason':_0x192354(0xb5),'token':null};}else return _0x4095e2=validToken(_0x10efcf,_0x4a9ca2),_0x4095e2[_0x192354(0x181)]('success')?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x10efcf}:{'allow':![],'reason':_0x192354(0xb5),'token':null};}else return{'allow':!![],'reason':_0x192354(0x106),'token':null};};if(settings[_0x2d31ab(0x193)]){let _0x3dc17d=[...settings[_0x2d31ab(0x274)],_0x2d31ab(0xdf),'::ffff:127.0.0.1',_0x2d31ab(0xd9)];if(_0x3dc17d[_0x2d31ab(0x1d5)](_0x1eb7c3))return _0x2031f7(_0x27fbc2);else{_0x4095e2=validToken(_0x27fbc2,_0x4a9ca2);if(_0x4095e2[_0x2d31ab(0x181)](_0x2d31ab(0x103)))return _0x2031f7(_0x27fbc2);else{if(telegramIpApproved(_0x4a9ca2)){const _0x3ab819=generateToken(_0x4a9ca2);return _0x4095e2=_0x2031f7(_0x27fbc2),_0x4095e2['allow']?{'allow':!![],'reason':_0x2d31ab(0x1a7),'token':_0x3ab819}:_0x4095e2;}else return settings[_0x2d31ab(0x290)]?{'allow':![],'reason':_0x2d31ab(0x174),'token':null}:{'allow':![],'reason':_0x2d31ab(0x16b),'token':null};}}}else return _0x2031f7(_0x27fbc2);}function timelyDecrypt(_0x3ea508,_0xcab137,_0x27c133='@'){const _0x22f453=_0x394128;if(_0x3ea508)try{const _0x3bc2ab=decryptRSA(secure[_0x22f453(0x1ff)],_0x3ea508),_0x2993bc=_0x3bc2ab['split'](_0x27c133)[0x0],_0x4f7d26=_0x3bc2ab['split'](_0x27c133)[0x1],_0x439759=new Date()[_0x22f453(0x247)]();if(_0xcab137){if(_0x439759-_0x4f7d26<maxSecretAge*0x3e8)return _0x2993bc;else return![];}else return _0x2993bc;}catch(_0x1491f8){return![];}else return![];}const validToken=(_0x1d4e22,_0x49a845)=>{const _0x1713f4=_0x394128,_0x555c71=devices[_0x49a845]['ip'];if(!_0x1d4e22)return{'error':_0x1713f4(0x1f1)};for(let _0x32efbf of blacklist){if(_0x32efbf['token']==_0x1d4e22)return{'error':'Token\x20blacklisted'};}let _0x26156b;try{_0x26156b=jwt[_0x1713f4(0x280)](_0x1d4e22,secure[_0x1713f4(0x27f)]+_0x49a845);}catch{return{'error':_0x1713f4(0x20e)};}if(!_0x26156b['hasOwnProperty'](_0x1713f4(0x20a))&&!_0x26156b[_0x1713f4(0x181)]('username')||!_0x26156b[_0x1713f4(0x181)](_0x1713f4(0x154)))return{'error':_0x1713f4(0x257)};if(!_0x26156b[_0x1713f4(0x181)](_0x1713f4(0x20b))&&_0x26156b[_0x1713f4(0x181)](_0x1713f4(0x20a))){const {clientip:_0x21679e}=_0x26156b;return _0x555c71==_0x21679e?{'success':_0x1713f4(0x1dd)}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x26156b[_0x1713f4(0x181)]('username')&&_0x26156b[_0x1713f4(0x181)](_0x1713f4(0x20a))){const {username:_0x4bc58d,clientip:_0x3fb567}=_0x26156b;return settings[_0x1713f4(0xf7)]==_0x4bc58d&&_0x555c71==_0x3fb567?{'success':_0x1713f4(0x1dd)}:{'error':_0x1713f4(0xde)};}}},generateLoginToken=_0x1cc35e=>{const _0x23e1a7=_0x394128;if(_0x1cc35e){const _0x2a1eb4=devices[_0x1cc35e]['ip'];return jwt[_0x23e1a7(0x1df)]({'username':settings[_0x23e1a7(0xf7)],'clientip':_0x2a1eb4},secure[_0x23e1a7(0x27f)]+_0x1cc35e,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x12de88=>{const _0x4bfec0=_0x394128;if(_0x12de88){const _0x58f172=devices[_0x12de88]['ip'];return jwt[_0x4bfec0(0x1df)]({'clientip':_0x58f172},secure[_0x4bfec0(0x27f)]+_0x12de88,{'expiresIn':devices[_0x12de88]['telegramIpApproval'][_0x4bfec0(0x26a)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x323c7b=>{const _0x2ecbdf=_0x394128;let _0x1e80ab=![];return devices[_0x323c7b][_0x2ecbdf(0xfc)]&&devices[_0x323c7b][_0x2ecbdf(0xfc)][_0x2ecbdf(0x26a)]!=_0x2ecbdf(0x261)&&(_0x1e80ab=devices[_0x323c7b][_0x2ecbdf(0xfc)][_0x2ecbdf(0x20a)]==devices[_0x323c7b]['ip']&&new Date()[_0x2ecbdf(0x247)]()-devices[_0x323c7b][_0x2ecbdf(0xfc)][_0x2ecbdf(0xe9)]<devices[_0x323c7b][_0x2ecbdf(0xfc)][_0x2ecbdf(0x26a)]*0x3c*0x3e8),_0x1e80ab;},telegram2FaApproved=_0x22a96e=>{const _0x5beec8=_0x394128;let _0x5a848e=![];return devices[_0x22a96e]['telegram2FaApproval']&&devices[_0x22a96e][_0x5beec8(0x1db)][_0x5beec8(0x26a)]!='reject'&&(_0x5a848e=devices[_0x22a96e][_0x5beec8(0x1db)][_0x5beec8(0x20a)]==devices[_0x22a96e]['ip']&&new Date()[_0x5beec8(0x247)]()-devices[_0x22a96e][_0x5beec8(0x1db)][_0x5beec8(0xe9)]<devices[_0x22a96e][_0x5beec8(0x1db)][_0x5beec8(0x26a)]*0x3c*0x3e8),_0x5a848e;},normalizeIP=_0x5bb9ee=>{const _0x23ef5d=_0x394128;let _0x485a7d=null,_0x47fcc9=null;if(ipaddr['isValid'](_0x5bb9ee)){const _0x3de788=ipaddr[_0x23ef5d(0x16e)](_0x5bb9ee);_0x3de788['kind']()==='ipv6'?(_0x3de788['isIPv4MappedAddress']()&&(_0x485a7d=_0x3de788[_0x23ef5d(0x12c)]()[_0x23ef5d(0x1ee)]()),_0x47fcc9=_0x3de788[_0x23ef5d(0x1ee)]()):(_0x485a7d=_0x3de788[_0x23ef5d(0x1ee)](),_0x47fcc9=_0x3de788[_0x23ef5d(0xe1)]()[_0x23ef5d(0x1ee)]());}return{'show':_0x485a7d?_0x485a7d:_0x47fcc9,'store':_0x47fcc9};};function formatDate(_0x36b882){const _0x4d1314=_0x394128;return _0x36b882[_0x4d1314(0xb0)]()+'/'+(_0x36b882[_0x4d1314(0x1ef)]()+0x1)['toString']()[_0x4d1314(0xab)](0x2,'0')+'/'+_0x36b882[_0x4d1314(0x1c9)]()[_0x4d1314(0x1ee)]()[_0x4d1314(0xab)](0x2,'0')+'\x20'+_0x36b882['getHours']()[_0x4d1314(0x1ee)]()[_0x4d1314(0xab)](0x2,'0')+':'+_0x36b882[_0x4d1314(0x243)]()[_0x4d1314(0x1ee)]()[_0x4d1314(0xab)](0x2,'0')+':'+_0x36b882[_0x4d1314(0x122)]()[_0x4d1314(0x1ee)]()['padStart'](0x2,'0');}function sleep(_0xd2f8a4){return new Promise(_0x108a61=>setTimeout(_0x108a61,_0xd2f8a4));}