const _0x169721=_0x825d;(function(_0x16da04,_0x5e612b){const _0x21a261=_0x825d,_0xcf97df=_0x16da04();while(!![]){try{const _0x32a83f=-parseInt(_0x21a261(0x2df))/0x1*(-parseInt(_0x21a261(0x2c5))/0x2)+parseInt(_0x21a261(0x2b3))/0x3*(parseInt(_0x21a261(0x1bd))/0x4)+-parseInt(_0x21a261(0x1db))/0x5+-parseInt(_0x21a261(0x2d3))/0x6*(parseInt(_0x21a261(0x25c))/0x7)+parseInt(_0x21a261(0x20e))/0x8+-parseInt(_0x21a261(0x31c))/0x9+-parseInt(_0x21a261(0x21d))/0xa*(-parseInt(_0x21a261(0x1b5))/0xb);if(_0x32a83f===_0x5e612b)break;else _0xcf97df['push'](_0xcf97df['shift']());}catch(_0x40d717){_0xcf97df['push'](_0xcf97df['shift']());}}}(_0x23d4,0xd2ac7));const _0x232494=function(){let _0x39cebc=!![];return function(_0x458157,_0x4d3ec3){const _0x98d204=_0x39cebc?function(){const _0x26be17=_0x825d;if(_0x4d3ec3){const _0x54a8b9=_0x4d3ec3[_0x26be17(0x27f)](_0x458157,arguments);return _0x4d3ec3=null,_0x54a8b9;}}:function(){};return _0x39cebc=![],_0x98d204;};}(),_0x34996f=_0x232494(this,function(){const _0x136c96=_0x825d;return _0x34996f[_0x136c96(0x2ef)]()['search'](_0x136c96(0x2b1))[_0x136c96(0x2ef)]()[_0x136c96(0x314)](_0x34996f)['search'](_0x136c96(0x2b1));});_0x34996f();'use strict';process[_0x169721(0x1ba)][_0x169721(0x13c)]=0x1;const childProcess=require('child_process'),fs=require('fs'),fns=require(_0x169721(0x1bf)),low=require(_0x169721(0x205)),FileSync=require(_0x169721(0x278)),path=require('path'),crypto=require(_0x169721(0x25f)),forge=require('node-forge'),bcrypt=require(_0x169721(0x2c2)),jwt=require(_0x169721(0x122)),ipaddr=require(_0x169721(0x189)),argv=require('yargs/yargs')(process[_0x169721(0x26b)][_0x169721(0x171)](0x2))[_0x169721(0x26b)],uuidRandom=require(_0x169721(0x27b)),{Telegraf,Markup}=require(_0x169721(0x323)),Mixpanel=require(_0x169721(0x1f3)),axios=require(_0x169721(0x218)),{GraphQLClient,gql}=require(_0x169721(0x286)),util=require(_0x169721(0x239)),fileUpload=require(_0x169721(0x19a)),{networkInterfaces}=require('os'),JSZip=require('jszip'),PORT=argv[_0x169721(0x187)]||_0x169721(0x1b7),pattern=/^[0-9]{2,4}$/;!pattern[_0x169721(0x211)](PORT)&&(console[_0x169721(0x216)]('Error:\x20Invalid\x20argument\x20'+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process['exit'](0x1));const HOST=argv[_0x169721(0x158)]||null,userID=argv[_0x169721(0x16e)]||'',debugging=argv['d']||![],recreate=argv['r']||![],nodeversion=process[_0x169721(0x127)][_0x169721(0x2d5)];let bbpath=_0x169721(0x23c),bbpath2='';function _0x23d4(){const _0xc798a6=['editMessageReplyMarkup','NTBA_FIX_319','async','args',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','No\x20bots\x20running\x20right\x20now','\x1b[0m','2FA','#RES#\x20if\x20running\x20locally\x0a','logout','<b>Balance\x20Bot\x20Status:</b>\x0a','placeOrder','store-configuration','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','exec','running','backup-full@','command','telegram2FaApproval','hashSync','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','logs/','request','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','/disable\x20-\x20disable\x20notifications\x0a','connected','hasOwnProperty','telegramEnabled','Idling\x20(','host','all','loadAsync','api-eu.mixpanel.com','Unauthorized\x20attempt\x20to\x20log\x20out','clients','Session\x20expired\x20for\x20user\x20...','split','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','sign','build','handshake','temporary\x20access\x20timeout','username','backup-full.zip','sendMessage','bot.js','Unauthorized\x20attempt\x20to\x20update\x20bot','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','off_','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','hex','user','expiry','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','slice','telegramToken','token','yes','/start','accept','*$1*','listen','bots','inherit','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','decode64','mtime','button','start','stop','.zip','messages','backup-files','restart','getDate','telegramChatId','port','from','ipaddr.js','title','backup-full','store-fiat','output-002.log','Notifications\x20disabled\x0a','event','telegramIpApproval','login\x20token\x20generated','emit','kind','apiSecret','bb-secure.json','getMonth','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','/upload-backup','/download/:type','express-fileupload','stringify','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','apiKey','config/','Error\x20details:','All','isIPv4MappedAddress','version.json','init','range','includes','Unauthorized\x20attempt\x20to\x20get\x20messages','connection','restore_yes_','Error\x20removing\x20old\x20backup\x20files:','create','get-starting-balances','new-disabled','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','success','/status\x20-\x20show\x20bot(s)\x20status\x0a','settings.','/:bot/history','Ok,\x20will\x20send\x20alert\x20notifications\x20only','/output-000.log','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','11bOyWvj','auth','3000','login','callback','env','Unauthorized\x20attempt\x20to\x20confirm\x20message','Backup\x20file\x20uploaded','52028mvhfEb','toIPv4MappedAddress','date-fns','getStartingBalances','stopped','Disabled\x20Bot\x20','getHours','toggleBotMode','Notifications\x20enabled\x0a','\x20only\x0a','resetpw_no','Invalid\x20IP\x20address','0.0.0','/backup\x20-\x20receive\x20backup\x20files\x0a','temporary\x20access\x20rejected','whitelist','bbPassword','set','_nsps','pidExpireLogin','storeConfiguration','cancel-loading','get-portfolio','Restarting\x20Bot\x20','sha256','2FA\x20required','exchange','/:bot/coins','get','\x1b[34m','6897665XlwRMn','Unauthorized\x20attempt\x20to\x20store\x20configuration','statSync','portfolio_','Enabled\x20Bot\x20','generateKeyPair','manual','padStart','2FA\x20login\x20required','Starting\x20#RED#Balance\x20Bot\x20v','\x20>\x20','params','status','************','emitHistory','sort','\x20|\x20','auto','\x20-\x20','botID','Running\x20#RED#Balance\x20Bot\x20v','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','|@|','botmanager','mixpanel','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','Invalid\x20authentication\x20token\x20(2)',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','clientip','remoteAddress','tempaccess_5_','once','127.0.0.1','lastmsgtelegram','Bot\x20Mgr\x20>\x20','order','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','kill','/:bot','Server','\x20|\x20client:\x20...','generateAsync','lowdb','Markdown','toggle_','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','/update\x20-\x20update\x20Balance\x20Bot\x0a','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','getSeconds','Unauthorized\x20attempt\x20to\x20update\x20settings','File\x20uploaded','8815616hMQLve','Password\x20reset\x20rejected','bbUsername','test','update_yes','files','showConfig','restore_no_','log','Telegram\x20error:','axios','secure','Restore\x20process\x20confirmed','-config.json','reason','867410JsDiWi','pidRefreshToken','entries','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','rsa','format','decrypt','/logs\x20-\x20receive\x20log\x20files\x0a','store','temp/','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','Alerts','Notifications\x20enabled','Unauthorized\x20login\x20attempt\x20(timeout)','new','store-settings','metrics','enabled','isDirectory','bot-','sockets','sendPortfolioTelegram','Starting\x20Balance\x20Bot\x20update','write','reinstall','Failed\x20to\x20download\x20','startsWith','exit','util','privateKeyToPem','\x20to\x20','bb/','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','#RES#\x20','function','\x20minutes','readFileSync','Password\x20has\x20been\x20reset\x20to:\x20','value','apiPassword','Error\x20while\x20deleting\x20config\x20files:\x20','https://api.ipify.org?format=json','then','config_all','Deleted\x20Bot\x20','Bot\x20','headers','tkn','::ffff:127.0.0.1','HTML','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','cancelLoading','Logged\x20out\x20user\x20...','#RES#\x20if\x20running\x20on\x20server','/:bot/support','getPortfolio','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','No\x20authentication\x20token','lastmsgemitted','live','Unauthorized\x20attempt\x20to\x20download\x20','\x20|\x20user:\x20...','49jLmERX','privateKey','reload','crypto','telegram','(staging)','post','Restoring\x20bot(s)\x20from\x20backup','latestversion','help','timeshift','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','update-bb','marketcapApi','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','argv','Invalid\x20authentication\x20token\x20(1)','User\x20has\x20been\x20validated','toggle','uncaughtException','headless','BCT','Restore\x20process\x20aborted','action','build2','show','config_orders','get-backup-files','lowdb/adapters/FileSync','Bot\x20Mgr\x20>\x20toggling\x20Bot\x20','status\x20code\x20401','uuid-random','unlinkSync','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','botname','apply','\x20mode','SIGTERM','DEFLATE','warning','mkdirSync','inlineKeyboard','graphql-request','createWriteStream','Bot\x20Mgr\x20>\x20stopping\x20all\x20bots','settings','\x1b[35m','All\x20bots','bbvNew','code','find','string','\x20files\x20over\x20Telegram:','close','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','output-000.log','keys','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','mode','-results.json','$1_$2_$3','conn','Your\x20installation\x20is\x20already\x20up\x20to\x20date','loginRequired','staging','publicKey','Login\x20accepted','sendFile','::1','invalid\x20credentials','2FA\x20login\x20token\x20generated','-----------------------------------------------------------------------------------','fork','getFullYear','notification','server','Unauthorized\x20attempt\x20to\x20delete\x20alerts','Restore\x20backup\x20file\x20','defaults','text','userid','backup','-performance.json','telegramUsername','off','(((.+)+)+)+$','secret','57wfyURB','referer','Token\x20blacklisted','debug','reinstall_no','alias','assign','/:bot/performance','***','replace','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','Unauthorized\x20attempt\x20to\x20get\x20events','push','encryptedUuid','socket.io','bcryptjs','socket','Notifications\x20disabled','16gKmKyW','readdirSync','number','toggle-bot-mode','remove','cloneDeep','match','error','Starting\x20Balance\x20Bot\x20reinstallation','/off\x20-\x20stop\x20bot(s)\x0a','resetHistory','=>\x20Go\x20to\x20#CYA#http://','name','add','310650VKqRUn','backupfile','node','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','\x20(2)','full','allow','copyFileSync','rmSync','ipv6','logs','bot','186642wgLMSY','SIGINT','family','tempaccess_30_','join','catch','parse','30\x20min','[ip-address]','address\x20already\x20in\x20use','ETH','Login\x20rejected','f2aRequired','<b>Telegram\x20Bot\x20Status:</b>\x0a','sortBy','binary','toString','sendMetricsTelegram','backup/','getUTCHours','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','update_no','password','Setting\x20access:\x20','onepagemode','#RES#','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','-events.json','reply','login\x20token\x20valid','temporary\x20token\x20generated','confirm-message','filter','replyWithDocument','storeHeadless','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','get-logs','timestamp','index.html','Error\x20sending\x20','on_','chat','simple','You\x20can\x20use\x20the\x20following\x20commands:\x0a','names','getMinutes','existsSync','privateKeyFromPem','ipc','disconnect','writeFileSync','reinstall_yes','min','constructor','getTime','output-001.log','zip/','randomFillSync','login2fa_reject_','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation','login\x20required','2916765LASDgF','15\x20min','type','reinstall-bb','config_alerts','isValid','/names\x20-\x20show\x20bot\x20names\x0a','telegraf','access','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','disabled','static','Node.js\x20v','Starting\x20new\x20bot\x20|\x20Bot\x20','pki','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','update','delete-alerts','tempaccess_reject_','get-messages','restore-backup-file','/restart\x20-\x20restart\x20bot(s)\x0a','uuid','/metrics\x20-\x20show\x20bot\x20performance\x0a','message','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','length','send','jsonwebtoken','data','Yes','show-config','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','versions',')\x20\x20\x20|\x20Bot\x20','login\x20not\x20required','/enable\x20-\x20enable\x20notifications\x0a','blacklist','Bot\x20Mgr\x20>\x20starting\x20all\x20bots','track','storeFiat','production','config','logged\x20out','reject','forEach','use','orders','file','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','telegramEvents','started','launch'];_0x23d4=function(){return _0xc798a6;};return _0x23d4();}const botfile=_0x169721(0x168),configfile='bb-config.json',settingsfile='bb-settings.json',securefile=_0x169721(0x195),environment=require('./'+bbpath2+_0x169721(0x1a2))['environment']||_0x169721(0x12f),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x169721(0x30d)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x169721(0x15d)),configpath=userID?bbpath+_0x169721(0x19e)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0x169721(0x2f1),logspath=userID?bbpath+'logs/'+userID+'/':bbpath+_0x169721(0x150),zippath=userID?bbpath+_0x169721(0x317)+userID+'/':bbpath+'zip/',loggerfile=fs[_0x169721(0x287)](logspath+_0x169721(0x1b3),{'flags':'a'}),temppath=userID?bbpath+_0x169721(0x226)+userID+'/':bbpath+'temp/';!fs[_0x169721(0x30d)](configpath)&&fs[_0x169721(0x284)](configpath);!fs[_0x169721(0x30d)](configbackuppath)&&fs[_0x169721(0x284)](configbackuppath);!fs[_0x169721(0x30d)](logspath)&&fs[_0x169721(0x284)](logspath);!fs[_0x169721(0x30d)](zippath)&&fs[_0x169721(0x284)](zippath);function _0x825d(_0x28e9f7,_0x7eb9d2){const _0x3b1f5d=_0x23d4();return _0x825d=function(_0x34996f,_0x232494){_0x34996f=_0x34996f-0x10d;let _0x23d41c=_0x3b1f5d[_0x34996f];return _0x23d41c;},_0x825d(_0x28e9f7,_0x7eb9d2);}!fs[_0x169721(0x30d)](temppath)&&fs[_0x169721(0x284)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x169721(0x2aa)]({'bots':[]})['write']();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x169721(0x2aa)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x169721(0x1c9),'onepagemode':![],'marketcapApi':''}})[_0x169721(0x234)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x169721(0x2aa)]({'secure':{},'blacklist':[]})[_0x169721(0x234)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x169721(0x1a3)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x169721(0x15b)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x169721(0x172)]&&(settings[_0x169721(0x172)]!=''&&settings['telegramToken']!='***')&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x334770,_0x201706)=>{const _0x378a12=_0x169721,_0x368167=/#[A-Z]{3}#/g;if(typeof _0x334770==_0x378a12(0x28f)){!_0x201706?_0x334770=_0x334770['replace'](_0x368167,''):(_0x334770=_0x334770[_0x378a12(0x2bc)](/#BLU#/g,_0x378a12(0x1da)),_0x334770=_0x334770[_0x378a12(0x2bc)](/#RED#/g,'\x1b[31m'),_0x334770=_0x334770['replace'](/#YEL#/g,'\x1b[33m'),_0x334770=_0x334770['replace'](/#MAG#/g,_0x378a12(0x28a)),_0x334770=_0x334770[_0x378a12(0x2bc)](/#CYA#/g,'\x1b[36m'),_0x334770=_0x334770['replace'](/#RES#/g,_0x378a12(0x141)));;}return _0x334770;},logger={'screen':_0x2c4ea9=>{const _0x8636c=_0x169721;console[_0x8636c(0x216)](parseColor(_0x2c4ea9,!![]));},'simple':_0x23e046=>{const _0x12efa4=_0x169721;console[_0x12efa4(0x216)](parseColor(_0x23e046,!![])),loggerfile['write'](util[_0x12efa4(0x222)](parseColor(_0x23e046,![]))+'\x0a');},'full':async _0x5ee062=>{const _0x2a0d69=_0x169721,_0x43a407=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x5ee062;console[_0x2a0d69(0x216)](parseColor(_0x43a407,!![])),loggerfile[_0x2a0d69(0x234)](util[_0x2a0d69(0x222)](parseColor(_0x43a407,![]))+'\x0a');if(tgBot&&settings[_0x2a0d69(0x186)]&&settings[_0x2a0d69(0x138)]!=_0x2a0d69(0x135))await sendTelegram(settings[_0x2a0d69(0x186)],_0x2a0d69(0x1fd)+parseColor(_0x5ee062,![]));},'debug':async(_0xcfc767,_0x7ec5ef='')=>{const _0x178802=_0x169721,_0x3f0ae2=getTimeStamp()+_0x178802(0x1f6)+_0xcfc767;if(debugging)console[_0x178802(0x216)](parseColor(_0x3f0ae2,!![]));loggerfile['write'](util[_0x178802(0x222)](parseColor(_0x3f0ae2,![]))+'\x0a');if(_0x7ec5ef){if(debugging)console['log'](_0x7ec5ef);loggerfile[_0x178802(0x234)](util[_0x178802(0x222)](_0x7ec5ef)+'\x0a');}}};let terminating=![];process['on'](_0x169721(0x26f),function(_0x46c514){const _0x5785e0=_0x169721;_0x46c514[_0x5785e0(0x2ef)]()[_0x5785e0(0x1a5)](_0x5785e0(0x2e8))?(logger[_0x5785e0(0x309)]('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x46c514['port']+_0x5785e0(0x2f8)),process[_0x5785e0(0x121)]({'terminate':!![]},_0x3a9349=>{})):logger['simple'](_0x46c514);}),process['on'](_0x169721(0x238),()=>{const _0x3383a1=_0x169721;stopAllBots(),process[_0x3383a1(0x238)](0x0);}),process['on']('SIGTERM',()=>{const _0x30f6b7=_0x169721;stopAllBots(),process[_0x30f6b7(0x238)](0x0);}),process['on'](_0x169721(0x2e0),()=>{const _0x1f918f=_0x169721;stopAllBots(),process[_0x1f918f(0x238)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x169721(0x1a2))['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')['createServer'](app);app['use'](fileUpload({'useTempFiles':!![]})),app[_0x169721(0x1d9)](_0x169721(0x199),async(_0x470978,_0x51b368)=>{const _0x7976da=_0x169721,_0x21be27=_0x470978[_0x7976da(0x1e6)]['type'],_0x190733=getClientsWithBotID(_0x7976da(0x1f2)),_0x46c038=_0x470978[_0x7976da(0x24b)][_0x7976da(0x11c)],_0x49b102=timelyDecrypt(_0x46c038,![]),_0x521037=_0x190733[_0x7976da(0x28e)](_0x43139b=>_0x43139b[_0x7976da(0x11c)]==_0x49b102);if(_0x521037){const _0x38be3b=normalizeIP(_0x470978[_0x7976da(0x2c3)]['remoteAddress'])[_0x7976da(0x225)],_0x4386ec=_0x470978[_0x7976da(0x24b)]['tkn'];if(validateAccess(_0x4386ec,_0x49b102,_0x38be3b)[_0x7976da(0x2d9)])_0x21be27==_0x7976da(0x2ad)&&await backupConfigFiles(),await zipFiles(_0x21be27),_0x51b368['download'](zippath+(_0x21be27+_0x7976da(0x181)),_0x52fc5c=>{const _0x27530f=_0x7976da;_0x52fc5c&&(logger[_0x27530f(0x2d8)](_0x27530f(0x236)+_0x21be27),logger[_0x27530f(0x309)](_0x52fc5c));});else logger['full']('Unauthorized\x20attempt\x20to\x20download\x20'+_0x21be27+'\x20(1)');}else logger['full'](_0x7976da(0x25a)+_0x21be27+_0x7976da(0x2d7));}),app[_0x169721(0x262)](_0x169721(0x198),async(_0x2be4c7,_0x1bcc1a)=>{const _0x342f16=_0x169721,_0x32f57f=getClientsWithBotID(_0x342f16(0x1f2)),_0x786c1a=_0x2be4c7[_0x342f16(0x24b)]['uuid'],_0x33790f=timelyDecrypt(_0x786c1a,![]),_0x907851=_0x32f57f[_0x342f16(0x28e)](_0xf58110=>_0xf58110[_0x342f16(0x11c)]==_0x33790f);logger['debug'](_0x342f16(0x1bc));if(_0x907851){const _0x3fbff3=normalizeIP(_0x2be4c7[_0x342f16(0x2c3)][_0x342f16(0x1f8)])['store'],_0x36bbe5=_0x2be4c7[_0x342f16(0x24b)][_0x342f16(0x24c)];if(validateAccess(_0x36bbe5,_0x33790f,_0x3fbff3)[_0x342f16(0x2d9)]){if(_0x2be4c7['files']){const _0x4c0bdd=_0x2be4c7['files'][_0x342f16(0x2d4)];await _0x4c0bdd['mv'](temppath+_0x4c0bdd[_0x342f16(0x2d1)]),_0x1bcc1a[_0x342f16(0x121)]({'status':!![],'message':_0x342f16(0x20d)});const _0x3e1d5e=getBotsWithMode();_0x3e1d5e[_0x342f16(0x120)]>0x0?confirmRestore(temppath,_0x4c0bdd[_0x342f16(0x2d1)]):unzipFile(temppath,_0x4c0bdd[_0x342f16(0x2d1)]);}}else logger['full'](_0x342f16(0x267));}else logger[_0x342f16(0x2d8)](_0x342f16(0x1f4));}),app[_0x169721(0x134)](express[_0x169721(0x110)](path['join'](__dirname,bbpath2,_0x169721(0x274)))),app[_0x169721(0x134)](express['static'](path[_0x169721(0x2e3)](__dirname,bbpath2,_0x169721(0x162)))),app[_0x169721(0x1d9)]('/',function(_0x168896,_0x56c745){const _0xd7d0e1=_0x169721;_0x56c745[_0xd7d0e1(0x29f)](path['join'](__dirname,bbpath2,_0xd7d0e1(0x274),'index.html'));}),app[_0x169721(0x1d9)](_0x169721(0x201),function(_0x34809a,_0x8f38e3){const _0x1dd298=_0x169721;_0x8f38e3[_0x1dd298(0x29f)](path[_0x1dd298(0x2e3)](__dirname,bbpath2,_0x1dd298(0x162),_0x1dd298(0x305)));}),app['get']('/:bot/portfolio',(_0x53d9c9,_0x71b916)=>{const _0x4d316d=_0x169721;_0x71b916['sendFile'](path[_0x4d316d(0x2e3)](__dirname,bbpath2,_0x4d316d(0x162),_0x4d316d(0x305)));}),app[_0x169721(0x1d9)](_0x169721(0x2ba),(_0x5bc90c,_0x3de9a5)=>{const _0x19f920=_0x169721;_0x3de9a5[_0x19f920(0x29f)](path[_0x19f920(0x2e3)](__dirname,bbpath2,_0x19f920(0x162),_0x19f920(0x305)));}),app[_0x169721(0x1d9)](_0x169721(0x1d8),(_0x1bd714,_0x149e06)=>{const _0x217de5=_0x169721;_0x149e06[_0x217de5(0x29f)](path[_0x217de5(0x2e3)](__dirname,bbpath2,'build','index.html'));}),app[_0x169721(0x1d9)](_0x169721(0x1b1),(_0x569ea2,_0x30df86)=>{const _0x1736cd=_0x169721;_0x30df86['sendFile'](path[_0x1736cd(0x2e3)](__dirname,bbpath2,_0x1736cd(0x162),'index.html'));}),app[_0x169721(0x1d9)]('/:bot/configuration',(_0x51892b,_0x3c76a2)=>{const _0x22f952=_0x169721;_0x3c76a2[_0x22f952(0x29f)](path[_0x22f952(0x2e3)](__dirname,bbpath2,_0x22f952(0x162),_0x22f952(0x305)));}),app[_0x169721(0x1d9)](_0x169721(0x254),(_0x2de6e3,_0x54632a)=>{const _0x4f0b35=_0x169721;_0x54632a[_0x4f0b35(0x29f)](path[_0x4f0b35(0x2e3)](__dirname,bbpath2,_0x4f0b35(0x162),_0x4f0b35(0x305)));});if(HOST)http[_0x169721(0x178)](PORT,HOST);else http[_0x169721(0x178)](PORT);const io=require(_0x169721(0x2c1))(http,{});init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x37ebda=_0x169721;let _0x2d2530=_0x37ebda(0x2e7);const _0x32dc67=networkInterfaces(),_0x2ee35b={};for(const _0x30d4fd of Object['keys'](_0x32dc67)){for(const _0x111883 of _0x32dc67[_0x30d4fd]){if((_0x111883[_0x37ebda(0x2e1)]=='IPv4'||_0x111883[_0x37ebda(0x2e1)]==0x4)&&!_0x111883['internal']){const _0x5930a5=ipaddr[_0x37ebda(0x2e5)](_0x111883['address'])[_0x37ebda(0x1a4)]();_0x5930a5!='private'&&(!_0x2ee35b[_0x30d4fd]&&(_0x2ee35b[_0x30d4fd]=[]),_0x2ee35b[_0x30d4fd][_0x37ebda(0x2bf)](_0x111883['address']),_0x2d2530=_0x111883['address']);}}}return{'serverip':_0x2d2530,'netinterfaces':_0x2ee35b};}async function startServer(){const _0x4b723a=_0x169721,{serverip:_0x18f516,netinterfaces:_0x8c7bc9}=getServerIP();logger[_0x4b723a(0x309)](''),logger[_0x4b723a(0x309)](_0x4b723a(0x2a3)),await logger['full'](_0x4b723a(0x1e4)+serverversion+_0x4b723a(0x23e)+(environment==_0x4b723a(0x29c)?_0x4b723a(0x261):'')+'\x0a'+(_0x4b723a(0x14f)+PORT+_0x4b723a(0x143))+(_0x4b723a(0x2d0)+_0x18f516+':'+PORT+_0x4b723a(0x253))),logger[_0x4b723a(0x309)](_0x4b723a(0x2a3));if(config[_0x4b723a(0x120)]!=0x0)for(const _0x5010f6 of config){const _0x539ca2=_0x5010f6[_0x4b723a(0x296)]==_0x4b723a(0x1ec)?'a':'m';if(_0x5010f6[_0x4b723a(0x1e7)]=='enabled'||_0x5010f6[_0x4b723a(0x1e7)]=='new')await logger[_0x4b723a(0x2d8)]('Starting\x20('+_0x539ca2+')\x20|\x20Bot\x20'+_0x5010f6[_0x4b723a(0x1ee)]+_0x4b723a(0x1eb)+_0x5010f6[_0x4b723a(0x27e)]),startBot([_0x5010f6[_0x4b723a(0x1ee)],userID],{'cwd':bbpath},function(_0x3cde09){const _0x2451c8=_0x4b723a;if(_0x3cde09)logger[_0x2451c8(0x2d8)](_0x3cde09);});else(_0x5010f6[_0x4b723a(0x1e7)]==_0x4b723a(0x10f)||_0x5010f6[_0x4b723a(0x1e7)]==_0x4b723a(0x1ac))&&await logger[_0x4b723a(0x2d8)](_0x4b723a(0x157)+_0x539ca2+_0x4b723a(0x128)+_0x5010f6['botID']+_0x4b723a(0x1eb)+_0x5010f6['botname']);}else!newBot&&logger[_0x4b723a(0x309)](_0x4b723a(0x19c));if(newBot)addBot();logger[_0x4b723a(0x309)]('-----------------------------------------------------------------------------------'),logger[_0x4b723a(0x309)](''),await logger[_0x4b723a(0x2b6)](_0x4b723a(0x111)+nodeversion),await logger['debug']('Network\x20Interfaces:',_0x8c7bc9);}function startSocket(){const _0x2fbe81=_0x169721;io['on'](_0x2fbe81(0x1a7),_0x305046=>{const _0x55ca2d=_0x2fbe81;let _0x3a1be8,_0x5cf954,_0x3f7ac8,_0x21ac13,_0x421574;const _0x5c27e2=_0x305046[_0x55ca2d(0x163)][_0x55ca2d(0x24b)][_0x55ca2d(0x2b4)];_0x5cf954=_0x5c27e2[_0x55ca2d(0x2cb)](/bot[0-9]{3}/);if(_0x5cf954)_0x3f7ac8=_0x5cf954[0x0][_0x55ca2d(0x2cb)](/[0-9]{3}/);if(_0x3f7ac8)_0x3a1be8=_0x3f7ac8[0x0];else _0x3a1be8='botmanager';const _0x4b3be1=_0x305046[_0x55ca2d(0x163)][_0x55ca2d(0x1b6)][_0x55ca2d(0x2c0)];if(!_0x4b3be1)_0x305046[_0x55ca2d(0x192)]('status',{'publicKey':secure[_0x55ca2d(0x29d)]});else{_0x21ac13=timelyDecrypt(_0x4b3be1,![]);if(!_0x21ac13)_0x305046[_0x55ca2d(0x192)]('status',{'publicKey':secure[_0x55ca2d(0x29d)]});else{_0x421574=normalizeIP(_0x305046[_0x55ca2d(0x299)][_0x55ca2d(0x1f8)])['store'];if(!devices[_0x21ac13])devices[_0x21ac13]={'uuid':_0x21ac13,'access':{'token':null}};devices[_0x21ac13]['ip']=_0x421574;const _0x7a15f1=addClient(_0x305046['id'],_0x21ac13,_0x3a1be8);setAccess(_0x7a15f1),emitMessages(),_0x305046['on'](_0x55ca2d(0x1b8),_0x17f4fa=>{const _0x2ae58b=_0x55ca2d,_0x4922ea=timelyDecrypt(_0x17f4fa[_0x2ae58b(0x2f5)],!![],_0x2ae58b(0x1f1));if(_0x4922ea){_0x17f4fa={'username':_0x17f4fa[_0x2ae58b(0x165)],'password':_0x4922ea},devices[_0x21ac13][_0x2ae58b(0x10d)]=validateCredentials(_0x17f4fa,_0x21ac13);if(devices[_0x21ac13][_0x2ae58b(0x10d)][_0x2ae58b(0x2d9)]==![]&&devices[_0x21ac13]['access'][_0x2ae58b(0x21c)]==_0x2ae58b(0x1e3))_0x305046[_0x2ae58b(0x192)]('status',{'access':devices[_0x21ac13][_0x2ae58b(0x10d)]}),loginAccess2FA(_0x21ac13,_0x421574);else{if(devices[_0x21ac13][_0x2ae58b(0x10d)][_0x2ae58b(0x2d9)]==![]&&devices[_0x21ac13]['access'][_0x2ae58b(0x21c)]=='invalid\x20credentials')_0x305046[_0x2ae58b(0x192)](_0x2ae58b(0x1e7),{'access':devices[_0x21ac13]['access']});else devices[_0x21ac13]['access'][_0x2ae58b(0x2d9)]&&devices[_0x21ac13]['access'][_0x2ae58b(0x21c)]=='login\x20token\x20generated'&&(getClientsWithUuid(_0x21ac13)[_0x2ae58b(0x133)](_0x366903=>{setAccess(_0x366903);}),logger[_0x2ae58b(0x2b6)]('Logged\x20in\x20user\x20...'+_0x21ac13[_0x2ae58b(0x171)](-0x8)),setTokenRefresh(_0x21ac13),setSessionTimeout(_0x2ae58b(0x1b8),_0x21ac13));}}else logger['full'](_0x2ae58b(0x22a));}),_0x305046['on']('reset-password',()=>{resetPassword();}),_0x305046['on'](_0x55ca2d(0x310),_0x4b3b68=>{removeClient(_0x305046['id']);}),_0x3a1be8==_0x55ca2d(0x1f2)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x48f0e5){const _0x364239=_0x169721;if(_0x48f0e5!=_0x364239(0x1f2)&&config['apiKey']!=''){if(pid[_0x48f0e5])pid[_0x48f0e5][_0x364239(0x121)]({'function':'initclient','args':null});}_0x48f0e5!=_0x364239(0x1f2)&&broadcastToBots(_0x364239(0x179),JSON[_0x364239(0x19b)](config));}function reloadBotManager(){const _0x1efb76=_0x169721;getClientsWithBotID(_0x1efb76(0x1f2))[_0x1efb76(0x133)](_0x552f30=>{const _0x27124b=_0x1efb76;getSocket(_0x552f30['id'])[_0x27124b(0x192)](_0x27124b(0x1e7),{'access':{'allow':![],'reason':_0x27124b(0x25e),'token':null}});});}function getSocket(_0x2fc3a4){const _0x23cec7=_0x169721,_0x50e252=io[_0x23cec7(0x1cf)][_0x23cec7(0x1d9)]('/');return _0x50e252[_0x23cec7(0x231)]['get'](_0x2fc3a4);}function setAccess(_0x4097cb){const _0x32523f=_0x169721,_0x5b8453=getSocket(_0x4097cb['id']),_0x16528b=_0x4097cb[_0x32523f(0x11c)],_0x19f926=_0x4097cb[_0x32523f(0x2de)];devices[_0x16528b][_0x32523f(0x10d)]=validateAccess(devices[_0x16528b][_0x32523f(0x10d)][_0x32523f(0x173)],_0x16528b),logger['debug'](_0x32523f(0x2f6)+devices[_0x16528b]['access']['reason']+_0x32523f(0x203)+_0x4097cb['id'][_0x32523f(0x171)](-0x8)+_0x32523f(0x25b)+_0x16528b[_0x32523f(0x171)](-0x8)),_0x5b8453['join'](_0x16528b);if(devices[_0x16528b]['access'][_0x32523f(0x2d9)]){_0x5b8453[_0x32523f(0x2e3)](_0x19f926);if(_0x19f926==_0x32523f(0x1f2))initializeSocketBotManager(_0x5b8453);else initializeSocketBot(_0x5b8453);initClient(_0x19f926);}devices[_0x16528b][_0x32523f(0x10d)]['token']&&devices[_0x16528b][_0x32523f(0x10d)]['reason']==_0x32523f(0x2fd)&&setSessionTimeout(_0x32523f(0x142),_0x16528b),devices[_0x16528b]['access'][_0x32523f(0x173)]&&devices[_0x16528b]['access'][_0x32523f(0x21c)]==_0x32523f(0x2a2)&&setSessionTimeout(_0x32523f(0x1b8),_0x16528b),_0x5b8453['emit'](_0x32523f(0x1e7),{'status':_0x4097cb[_0x32523f(0x2a7)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x16528b]['access'],'externalip':devices[_0x16528b]['ip'],'publicKey':secure[_0x32523f(0x29d)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x16528b][_0x32523f(0x10d)][_0x32523f(0x2d9)]==![]&&devices[_0x16528b][_0x32523f(0x10d)]['reason']==_0x32523f(0x1d6)&&temporaryAccess2FA(_0x16528b,devices[_0x16528b]['ip']);}function setSessionTimeout(_0x49d5f7,_0x651b0){const _0x14c972=_0x169721;let _0x1a1a07;if(_0x49d5f7==_0x14c972(0x1b8))_0x1a1a07=loginExpiry*0x3c*0x3e8;else _0x1a1a07=devices[_0x651b0][_0x14c972(0x190)][_0x14c972(0x16f)]*0x3c*0x3e8-(new Date()[_0x14c972(0x315)]()-devices[_0x651b0][_0x14c972(0x190)][_0x14c972(0x304)]);if(devices[_0x651b0]['pidExpireLogin'])clearTimeout(devices[_0x651b0][_0x14c972(0x1d0)]);devices[_0x651b0][_0x14c972(0x1d0)]=setTimeout(()=>{const _0x257acb=_0x14c972;if(devices[_0x651b0]['pidRefreshToken'])clearTimeout(devices[_0x651b0][_0x257acb(0x21e)]);removeSocketListeners(_0x651b0),addBlacklist(_0x651b0),devices[_0x651b0][_0x257acb(0x190)]=null,devices[_0x651b0][_0x257acb(0x14d)]=null,devices[_0x651b0][_0x257acb(0x10d)][_0x257acb(0x173)]=null,logger[_0x257acb(0x2b6)](_0x257acb(0x15e)+_0x651b0[_0x257acb(0x171)](-0x8)),devices[_0x651b0][_0x257acb(0x10d)]=validateAccess(devices[_0x651b0][_0x257acb(0x10d)][_0x257acb(0x173)],_0x651b0),!(devices[_0x651b0][_0x257acb(0x10d)]['allow']&&devices[_0x651b0][_0x257acb(0x10d)][_0x257acb(0x21c)]==_0x257acb(0x129))&&(_0x49d5f7==_0x257acb(0x1b8)?io['to'](_0x651b0)['emit'](_0x257acb(0x1e7),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x651b0)[_0x257acb(0x192)](_0x257acb(0x1e7),{'access':{'allow':![],'reason':_0x257acb(0x164),'token':null}})),devices[_0x651b0]['access'][_0x257acb(0x173)]=null;},_0x1a1a07);}function setTokenRefresh(_0xac9d79){const _0x4fb2cc=_0x169721;if(devices[_0xac9d79]['pidRefreshToken'])clearTimeout(devices[_0xac9d79][_0x4fb2cc(0x21e)]);devices[_0xac9d79][_0x4fb2cc(0x21e)]=setTimeout(()=>{const _0x195c8b=_0x4fb2cc;getClientsWithUuid(_0xac9d79)[_0x195c8b(0x120)]!=0x0?(devices[_0xac9d79][_0x195c8b(0x10d)]=refreshToken(_0xac9d79),io['to'](_0xac9d79)[_0x195c8b(0x192)](_0x195c8b(0x1e7),{'status':_0x195c8b(0x154),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xac9d79][_0x195c8b(0x10d)],'externalip':devices[_0xac9d79]['ip'],'publicKey':secure[_0x195c8b(0x29d)],'validInstallation':validInstallation}),setTokenRefresh(_0xac9d79)):clearTimeout(devices[_0xac9d79]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x1e9bc6){const _0x3abee1=_0x169721,_0x7f536c=getClient(_0x1e9bc6['id'])[_0x3abee1(0x11c)];_0x1e9bc6[_0x3abee1(0x192)]('bots',config),_0x1e9bc6[_0x3abee1(0x192)](_0x3abee1(0x289),cleanSettings()),_0x1e9bc6['on']('add-bot',_0x54672a=>{const _0x27f80a=_0x3abee1;if(validateAccess(_0x54672a,_0x7f536c)['allow'])addBot();else logger[_0x27f80a(0x2d8)]('Unauthorized\x20attempt\x20to\x20add\x20bot');}),_0x1e9bc6['on']('update-bot',(_0x99baca,_0x12f1c0)=>{const _0x3ce7e9=_0x3abee1;if(validateAccess(_0x12f1c0,_0x7f536c)['allow'])toggleBot(_0x99baca[_0x3ce7e9(0x1ee)],_0x99baca[_0x3ce7e9(0x1e7)],_0x99baca[_0x3ce7e9(0x259)]);else logger[_0x3ce7e9(0x2d8)]('Unauthorized\x20attempt\x20to\x20update\x20bot');}),_0x1e9bc6['on'](_0x3abee1(0x2c8),(_0x3ec9df,_0x4d856f)=>{const _0x2f6209=_0x3abee1;if(validateAccess(_0x4d856f,_0x7f536c)['allow'])toggleBotMode(_0x3ec9df);else logger[_0x2f6209(0x2d8)](_0x2f6209(0x169));}),_0x1e9bc6['on']('delete-bot',(_0x41f525,_0x1095cf)=>{const _0xb34737=_0x3abee1;if(validateAccess(_0x1095cf,_0x7f536c)[_0xb34737(0x2d9)])deleteBot(_0x41f525);else logger['full']('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x1e9bc6['on'](_0x3abee1(0x22c),(_0x597e60,_0x16f7ea)=>{const _0xd4e0d8=_0x3abee1;if(validateAccess(_0x16f7ea,_0x7f536c)['allow'])storeSettings(_0x597e60,!![]);else logger[_0xd4e0d8(0x2d8)](_0xd4e0d8(0x20c));}),_0x1e9bc6['on']('update-bb',_0x2d9ad7=>{const _0x1b4715=_0x3abee1;if(validateAccess(_0x2d9ad7,_0x7f536c)[_0x1b4715(0x2d9)])updateBB(_0x1b4715(0x116));else logger[_0x1b4715(0x2d8)](_0x1b4715(0x20a));}),_0x1e9bc6['on'](_0x3abee1(0x31f),_0x4c3e21=>{const _0x3ab456=_0x3abee1;if(validateAccess(_0x4c3e21,_0x7f536c)[_0x3ab456(0x2d9)])updateBB(_0x3ab456(0x235));else logger['full'](_0x3ab456(0x208));}),_0x1e9bc6['on'](_0x3abee1(0x277),_0x3445b9=>{const _0x348b0f=_0x3abee1;if(validateAccess(_0x3445b9,_0x7f536c)['allow']){const _0x4eeaf5=getClient(_0x1e9bc6['id']);if(_0x4eeaf5)getBackupFiles(_0x4eeaf5[_0x348b0f(0x11c)]);else logger['full']('Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}else logger[_0x348b0f(0x2d8)](_0x348b0f(0x256));}),_0x1e9bc6['on'](_0x3abee1(0x11a),(_0x126aa1,_0x2f435b)=>{const _0x116a3d=_0x3abee1;if(validateAccess(_0x2f435b,_0x7f536c)[_0x116a3d(0x2d9)])restoreBackupFile(_0x126aa1);else logger[_0x116a3d(0x2d8)](_0x116a3d(0x197));}),_0x1e9bc6['on'](_0x3abee1(0x119),_0x22cd55=>{const _0x42b531=_0x3abee1;if(validateAccess(_0x22cd55,_0x7f536c)[_0x42b531(0x2d9)])getMessages();else logger[_0x42b531(0x2d8)](_0x42b531(0x1a6));}),_0x1e9bc6['on'](_0x3abee1(0x2fe),(_0x366afd,_0x1c959b)=>{const _0x3dfdc1=_0x3abee1;if(validateAccess(_0x1c959b,_0x7f536c)[_0x3dfdc1(0x2d9)])confirmMessage(_0x366afd);else logger['full'](_0x3dfdc1(0x1bb));}),_0x1e9bc6['on'](_0x3abee1(0x144),_0x487080=>{const _0x5e2fe4=_0x3abee1;if(validateAccess(_0x487080,_0x7f536c)['allow']){if(devices[_0x7f536c]['pidRefreshToken'])clearTimeout(devices[_0x7f536c]['pidRefreshToken']);if(devices[_0x7f536c]['pidExpireLogin'])clearTimeout(devices[_0x7f536c][_0x5e2fe4(0x1d0)]);removeSocketListeners(getClient(_0x1e9bc6['id'])[_0x5e2fe4(0x11c)]),addBlacklist(_0x7f536c),devices[_0x7f536c][_0x5e2fe4(0x190)]=null,devices[_0x7f536c][_0x5e2fe4(0x14d)]=null,devices[_0x7f536c]['access'][_0x5e2fe4(0x173)]=null,logger[_0x5e2fe4(0x2b6)]('Logged\x20out\x20user\x20...'+_0x7f536c[_0x5e2fe4(0x171)](-0x8)),io['to'](getClient(_0x1e9bc6['id'])[_0x5e2fe4(0x11c)])[_0x5e2fe4(0x192)](_0x5e2fe4(0x1e7),{'access':{'allow':![],'reason':_0x5e2fe4(0x131),'token':null}});}else logger[_0x5e2fe4(0x2d8)](_0x5e2fe4(0x15c));});}function initializeSocketBot(_0x1cd63e){const _0x2ff3eb=_0x169721,_0x46bb5c=getClient(_0x1cd63e['id'])[_0x2ff3eb(0x2de)],_0x34816a=getClient(_0x1cd63e['id'])['uuid'];_0x1cd63e['on'](_0x2ff3eb(0x303),(_0x3d9aa2,_0x386fd2)=>{const _0x3f1006=_0x2ff3eb;if(validateAccess(_0x386fd2,_0x34816a)['allow']){if(pid[_0x46bb5c])pid[_0x46bb5c]['send']({'function':_0x3f1006(0x1e9),'args':_0x3d9aa2});}else logger[_0x3f1006(0x2d8)](_0x3f1006(0x2be));}),_0x1cd63e['on'](_0x2ff3eb(0x117),(_0xf65aa1,_0x57c23a)=>{const _0x718a67=_0x2ff3eb;if(validateAccess(_0x57c23a,_0x34816a)[_0x718a67(0x2d9)]){if(pid[_0x46bb5c])pid[_0x46bb5c][_0x718a67(0x121)]({'function':'deleteHistoryAlerts','args':_0xf65aa1});}else logger[_0x718a67(0x2d8)](_0x718a67(0x2a8));}),_0x1cd63e['on'](_0x2ff3eb(0x1d3),(_0x1404f0,_0x10b59d)=>{const _0x47d464=_0x2ff3eb;if(validateAccess(_0x10b59d,_0x34816a)[_0x47d464(0x2d9)]){if(pid[_0x46bb5c])pid[_0x46bb5c][_0x47d464(0x121)]({'function':_0x47d464(0x255),'args':_0x1404f0});}else logger['full']('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x1cd63e['on'](_0x2ff3eb(0x147),(_0x564b5d,_0x1947cd)=>{const _0x5d15fa=_0x2ff3eb;if(validateAccess(_0x1947cd,_0x34816a)[_0x5d15fa(0x2d9)]){if(pid[_0x46bb5c])pid[_0x46bb5c][_0x5d15fa(0x121)]({'function':_0x5d15fa(0x1d1),'args':_0x564b5d});}else logger[_0x5d15fa(0x2d8)](_0x5d15fa(0x1dc));}),_0x1cd63e['on']('store-headless',(_0x49b721,_0x49dc50)=>{const _0x180ee4=_0x2ff3eb;if(validateAccess(_0x49dc50,_0x34816a)['allow']){if(pid[_0x46bb5c])pid[_0x46bb5c][_0x180ee4(0x121)]({'function':_0x180ee4(0x301),'args':_0x49b721});}else logger[_0x180ee4(0x2d8)](_0x180ee4(0x2f9));}),_0x1cd63e['on'](_0x2ff3eb(0x18c),(_0x452953,_0x8b6ed3)=>{const _0x35ce6f=_0x2ff3eb;if(validateAccess(_0x8b6ed3,_0x34816a)['allow']){if(pid[_0x46bb5c])pid[_0x46bb5c][_0x35ce6f(0x121)]({'function':_0x35ce6f(0x12e),'args':_0x452953});}else logger[_0x35ce6f(0x2d8)](_0x35ce6f(0x26a));}),_0x1cd63e['on']('reset-history',_0x3530aa=>{const _0x1777cf=_0x2ff3eb;if(validateAccess(_0x3530aa,_0x34816a)[_0x1777cf(0x2d9)]){if(pid[_0x46bb5c])pid[_0x46bb5c]['send']({'function':_0x1777cf(0x2cf),'args':null});}else logger[_0x1777cf(0x2d8)]('Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history');}),_0x1cd63e['on'](_0x2ff3eb(0x1ab),_0x1c68f1=>{const _0x1d2cc7=_0x2ff3eb;if(validateAccess(_0x1c68f1,_0x34816a)['allow']){if(pid[_0x46bb5c])pid[_0x46bb5c][_0x1d2cc7(0x121)]({'function':_0x1d2cc7(0x1c0),'args':null});}else logger[_0x1d2cc7(0x2d8)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0x1cd63e['on']('place-order',(_0x3e481f,_0x2e5bf5)=>{const _0x4aad2f=_0x2ff3eb;if(validateAccess(_0x2e5bf5,_0x34816a)['allow']){if(pid[_0x46bb5c])pid[_0x46bb5c][_0x4aad2f(0x121)]({'function':_0x4aad2f(0x146),'args':_0x3e481f});}else logger[_0x4aad2f(0x2d8)](_0x4aad2f(0x16a));}),_0x1cd63e['on'](_0x2ff3eb(0x1d2),_0x1adc11=>{const _0x258a31=_0x2ff3eb;if(validateAccess(_0x1adc11,_0x34816a)[_0x258a31(0x2d9)]){if(pid[_0x46bb5c])pid[_0x46bb5c][_0x258a31(0x121)]({'function':_0x258a31(0x251),'args':null});}else logger[_0x258a31(0x2d8)](_0x258a31(0x152));}),_0x1cd63e['on'](_0x2ff3eb(0x125),_0x7297f6=>{const _0xcf6d0d=_0x2ff3eb;if(validateAccess(_0x7297f6,_0x34816a)[_0xcf6d0d(0x2d9)]){if(pid[_0x46bb5c])pid[_0x46bb5c][_0xcf6d0d(0x121)]({'function':_0xcf6d0d(0x214),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x1cd63e['on'](_0x2ff3eb(0x268),_0x41e97c=>{const _0x161300=_0x2ff3eb;if(validateAccess(_0x41e97c,_0x34816a)['allow'])updateBB(_0x161300(0x116));else logger[_0x161300(0x2d8)](_0x161300(0x20a));}),_0x1cd63e['on'](_0x2ff3eb(0x119),_0x199303=>{const _0x3c373f=_0x2ff3eb;if(validateAccess(_0x199303,_0x34816a)[_0x3c373f(0x2d9)])getMessages();else logger[_0x3c373f(0x2d8)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x1cd63e['on'](_0x2ff3eb(0x2fe),(_0xb4db13,_0x568668)=>{const _0x3f7508=_0x2ff3eb;if(validateAccess(_0x568668,_0x34816a)[_0x3f7508(0x2d9)])confirmMessage(_0xb4db13);else logger[_0x3f7508(0x2d8)](_0x3f7508(0x1bb));}),_0x1cd63e['on']('logout',_0x4c334f=>{const _0x23453a=_0x2ff3eb;if(validateAccess(_0x4c334f,_0x34816a)[_0x23453a(0x2d9)]){if(devices[_0x34816a][_0x23453a(0x21e)])clearTimeout(devices[_0x34816a][_0x23453a(0x21e)]);if(devices[_0x34816a][_0x23453a(0x1d0)])clearTimeout(devices[_0x34816a][_0x23453a(0x1d0)]);removeSocketListeners(getClient(_0x1cd63e['id'])[_0x23453a(0x11c)]),addBlacklist(_0x34816a),devices[_0x34816a][_0x23453a(0x190)]=null,devices[_0x34816a]['telegram2FaApproval']=null,devices[_0x34816a][_0x23453a(0x10d)][_0x23453a(0x173)]=null,logger[_0x23453a(0x2b6)](_0x23453a(0x252)+_0x34816a[_0x23453a(0x171)](-0x8)),io['to'](getClient(_0x1cd63e['id'])['uuid'])[_0x23453a(0x192)](_0x23453a(0x1e7),{'access':{'allow':![],'reason':_0x23453a(0x131),'token':null}});}else logger[_0x23453a(0x2d8)](_0x23453a(0x15c));});}function removeSocketListeners(_0x3d633d){const _0x26846a=_0x169721;getClientsWithUuid(_0x3d633d)[_0x26846a(0x133)](_0x249f4c=>{getSocket(_0x249f4c['id'])['removeAllListeners']();});}function cleanSettings(){const _0x3196d1=_0x169721;let _0x38da4d=settings;return settings[_0x3196d1(0x172)]&&settings[_0x3196d1(0x172)]!=''&&(_0x38da4d={..._0x38da4d,'telegramToken':_0x3196d1(0x1e8)}),settings[_0x3196d1(0x1cd)]&&settings[_0x3196d1(0x1cd)]!=''&&(_0x38da4d={..._0x38da4d,'bbPassword':'************'}),settings[_0x3196d1(0x269)]&&settings[_0x3196d1(0x269)]!=''&&(_0x38da4d={..._0x38da4d,'marketcapApi':_0x3196d1(0x1e8)}),(settings[_0x3196d1(0x1cd)]&&settings[_0x3196d1(0x1cd)]==_0x3196d1(0x2bb)||settings[_0x3196d1(0x172)]&&settings[_0x3196d1(0x172)]==_0x3196d1(0x2bb)||settings[_0x3196d1(0x269)]&&settings[_0x3196d1(0x269)]==_0x3196d1(0x2bb))&&(_0x38da4d={..._0x38da4d,'restored':{'password':settings[_0x3196d1(0x1cd)]==_0x3196d1(0x2bb),'telegram':settings[_0x3196d1(0x172)]==_0x3196d1(0x2bb),'marketcap':settings[_0x3196d1(0x269)]==_0x3196d1(0x2bb)}}),_0x38da4d;}async function updateBB(_0xea3cea){const _0x124edf=_0x169721;await backupConfigFiles(),installingUpdate=!![],config['forEach'](_0x389f45=>{const _0x32dd65=_0x825d;restartBot(_0x389f45[_0x32dd65(0x1ee)]);});if(_0xea3cea==_0x124edf(0x116))process['send']({'update':!![],'environment':environment},_0x5f45b5=>{});else _0xea3cea==_0x124edf(0x235)&&process['send']({'reinstall':!![],'environment':environment},_0x1421f8=>{});}function startBot(_0x3444b8,_0x591019,_0x309c5d){const _0x479b34=_0x169721;if(debugging)_0x3444b8['push']('-d');if(recreate)_0x3444b8[_0x479b34(0x2bf)]('-r');let _0xda4776=![];const _0x1f42e3=_0x3444b8[0x0];_0x591019={..._0x591019,'stdio':[_0x479b34(0x17a),_0x479b34(0x17a),_0x479b34(0x17a),_0x479b34(0x30f)]},pid[_0x1f42e3]=childProcess[_0x479b34(0x2a4)](botfile,_0x3444b8,_0x591019),pid[_0x1f42e3]['on'](_0x479b34(0x11e),_0x7d6f8c=>{const _0x74c813=_0x479b34;switch(Object[_0x74c813(0x294)](_0x7d6f8c)[0x0]){case _0x74c813(0x27e):updateBotName(_0x1f42e3,_0x7d6f8c[_0x74c813(0x27e)]);break;case'updatebotmanager':updateBotManager();break;case'status':updateStatus(_0x1f42e3,_0x7d6f8c[_0x74c813(0x1e7)]);break;case'live':updateLive(_0x1f42e3,_0x7d6f8c['live']);break;case'started':updateLive(_0x1f42e3,_0x7d6f8c[_0x74c813(0x139)]),io['to'](_0x1f42e3)[_0x74c813(0x192)](_0x74c813(0x1e7),{'access':{'allow':![],'reason':_0x74c813(0x25e),'token':null}});break;case'stop':_0x7d6f8c[_0x74c813(0x180)]==_0x74c813(0x184)&&restartBot(_0x1f42e3);_0x7d6f8c[_0x74c813(0x180)]=='kill'&&toggleBot(_0x1f42e3,_0x74c813(0x10f),_0x74c813(0x1c1));break;case _0x74c813(0x260):sendTelegramBot(_0x1f42e3,_0x7d6f8c[_0x74c813(0x260)]);break;case'telegrammsg':sendTelegramMsg(_0x7d6f8c['telegrammsg']);break;case _0x74c813(0x23f):io['to'](_0x1f42e3)[_0x74c813(0x192)](_0x7d6f8c[_0x74c813(0x23f)],_0x7d6f8c[_0x74c813(0x13e)]);break;}}),pid[_0x1f42e3]['on'](_0x479b34(0x2cc),function(_0x22d13f){if(_0xda4776)return;_0xda4776=!![],_0x309c5d(_0x22d13f);}),pid[_0x1f42e3]['on'](_0x479b34(0x238),async function(_0x563d40){const _0x8f2da6=_0x479b34;if(terminating)return;if(installingUpdate){io[_0x8f2da6(0x291)]();return;}if(_0xda4776)return;_0xda4776=!![],_0x309c5d(null);const _0x535402=dbConfig[_0x8f2da6(0x1d9)](_0x8f2da6(0x179))[_0x8f2da6(0x28e)]({'botID':_0x1f42e3})[_0x8f2da6(0x243)]();_0x535402&&(_0x535402[_0x8f2da6(0x1e7)]=='enabled'||_0x535402[_0x8f2da6(0x1e7)]==_0x8f2da6(0x22b))&&(await sleep(0x3e8),updateLive(_0x1f42e3,_0x8f2da6(0x1c1)),logger[_0x8f2da6(0x2d8)](_0x8f2da6(0x1d4)+_0x1f42e3),startBot([_0x1f42e3,userID],{'cwd':bbpath},function(_0x3bee65){const _0x2c5534=_0x8f2da6;if(_0x3bee65)logger[_0x2c5534(0x2d8)](_0x3bee65);}));});}function stopBot(_0x49a05a){const _0x614f8b=_0x169721;getClientsWithBotID(_0x49a05a)[_0x614f8b(0x133)](_0x45dd2e=>{const _0x2aa043=_0x614f8b;getSocket(_0x45dd2e['id'])[_0x2aa043(0x310)](!![]),removeClient(_0x45dd2e['id']);}),pid[_0x49a05a]&&(pid[_0x49a05a][_0x614f8b(0x200)](),pid[_0x49a05a]=null);}function stopAllBots(){const _0x5c7d96=_0x169721;terminating=!![];const _0x2c4fb3=getEnabledBots();_0x2c4fb3[_0x5c7d96(0x133)](_0x4cb0d2=>{const _0x1535d2=_0x5c7d96;stopBot(_0x4cb0d2[_0x1535d2(0x1ee)]);});}function restartBot(_0xc9b8b0){if(pid[_0xc9b8b0])pid[_0xc9b8b0]['kill']();}function addBot(){const _0x15047b=_0x169721;let _0x3ce1c9;for(let _0x4e9813=0x1;_0x4e9813<0x3e9;_0x4e9813++){_0x3ce1c9=_0x4e9813[_0x15047b(0x2ef)]()[_0x15047b(0x1e2)](0x3,'0');let _0x51d6f6=config['find'](_0x1d7625=>_0x1d7625[_0x15047b(0x1ee)]==_0x3ce1c9);if(!_0x51d6f6)break;}if(_0x3ce1c9==='1000'){logger[_0x15047b(0x2d8)](_0x15047b(0x160));return;}logger['full'](_0x15047b(0x112)+_0x3ce1c9),dbConfig['get'](_0x15047b(0x179))['push']({'botID':_0x3ce1c9,'botname':_0x15047b(0x24a)+_0x3ce1c9,'status':_0x15047b(0x22b),'live':''})[_0x15047b(0x234)](),startBot([_0x3ce1c9,userID],{'cwd':bbpath},function(_0xe974){if(_0xe974)logger['full'](_0xe974);}),config=getConfiguration(),io['to']('botmanager')[_0x15047b(0x192)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}function deleteBot(_0x5e3f2d){const _0x393592=_0x169721;getClientsWithBotID(_0x5e3f2d)[_0x393592(0x133)](_0x40d29c=>{getSocket(_0x40d29c['id'])['disconnect'](!![]),removeClient(_0x40d29c['id']);}),dbConfig[_0x393592(0x1d9)](_0x393592(0x179))[_0x393592(0x2c9)]({'botID':_0x5e3f2d})[_0x393592(0x234)](),logger[_0x393592(0x2d8)](_0x393592(0x249)+_0x5e3f2d),stopBot(_0x5e3f2d);try{if(fs[_0x393592(0x30d)](path['join'](configpath,_0x393592(0x230)+_0x5e3f2d+_0x393592(0x21b))))fs[_0x393592(0x27c)](path[_0x393592(0x2e3)](configpath,_0x393592(0x230)+_0x5e3f2d+_0x393592(0x21b)));if(fs[_0x393592(0x30d)](path[_0x393592(0x2e3)](configpath,_0x393592(0x230)+_0x5e3f2d+_0x393592(0x2fa))))fs[_0x393592(0x27c)](path[_0x393592(0x2e3)](configpath,_0x393592(0x230)+_0x5e3f2d+'-events.json'));if(fs[_0x393592(0x30d)](path['join'](configpath,'bot-'+_0x5e3f2d+_0x393592(0x2ae))))fs[_0x393592(0x27c)](path[_0x393592(0x2e3)](configpath,_0x393592(0x230)+_0x5e3f2d+_0x393592(0x2ae)));if(fs['existsSync'](path[_0x393592(0x2e3)](configpath,_0x393592(0x230)+_0x5e3f2d+'-results.json')))fs['unlinkSync'](path[_0x393592(0x2e3)](configpath,_0x393592(0x230)+_0x5e3f2d+_0x393592(0x297)));}catch(_0x4660e8){if(_0x4660e8)logger['full'](_0x393592(0x245),_0x4660e8);}config=getConfiguration(),io['to']('botmanager')[_0x393592(0x192)](_0x393592(0x179),config),broadcastToBots(_0x393592(0x179),JSON['stringify'](config));}function toggleBot(_0xdf6b47,_0x5c678d,_0x54e1b6){const _0x1fd163=_0x169721;dbConfig[_0x1fd163(0x1d9)](_0x1fd163(0x179))['find']({'botID':_0xdf6b47})[_0x1fd163(0x2b9)]({'status':_0x5c678d})[_0x1fd163(0x2b9)]({'live':_0x54e1b6})[_0x1fd163(0x234)]();if(_0x5c678d==_0x1fd163(0x22e)||_0x5c678d==_0x1fd163(0x22b))logger[_0x1fd163(0x2d8)](_0x1fd163(0x1df)+_0xdf6b47),startBot([_0xdf6b47,userID],{'cwd':bbpath},function(_0x5b268c){if(_0x5b268c)logger['full'](_0x5b268c);});else(_0x5c678d==_0x1fd163(0x10f)||_0x5c678d=='new-disabled')&&(logger['full'](_0x1fd163(0x1c2)+_0xdf6b47),stopBot(_0xdf6b47));config=getConfiguration(),io['to'](_0x1fd163(0x1f2))[_0x1fd163(0x192)]('bots',config),broadcastToBots(_0x1fd163(0x179),JSON[_0x1fd163(0x19b)](config));}function toggleStatus(_0x4a4df4){const _0x3fe870=_0x169721;let _0x122c45=dbConfig[_0x3fe870(0x1d9)](_0x3fe870(0x179))[_0x3fe870(0x28e)]({'botID':_0x4a4df4})['value'](),_0x5db66c;if(_0x122c45[_0x3fe870(0x1e7)]===_0x3fe870(0x22e))_0x5db66c='disabled';else{if(_0x122c45[_0x3fe870(0x1e7)]===_0x3fe870(0x22b))_0x5db66c='new-disabled';else{if(_0x122c45['status']==='new-disabled')_0x5db66c=_0x3fe870(0x22b);else{if(_0x122c45[_0x3fe870(0x1e7)]===_0x3fe870(0x10f))_0x5db66c=_0x3fe870(0x22e);}}}return _0x5db66c;}function updateStatus(_0xfb3e2e,_0x38bf65){const _0x5af65a=_0x169721;dbConfig['get'](_0x5af65a(0x179))['find']({'botID':_0xfb3e2e})[_0x5af65a(0x2b9)]({'status':_0x38bf65})[_0x5af65a(0x234)](),config=getConfiguration(),io['to'](_0x5af65a(0x1f2))[_0x5af65a(0x192)](_0x5af65a(0x179),config),broadcastToBots('bots',JSON[_0x5af65a(0x19b)](config));}function updateLive(_0x1c8209,_0x412f19){const _0x26ca29=_0x169721;dbConfig[_0x26ca29(0x1d9)](_0x26ca29(0x179))[_0x26ca29(0x28e)]({'botID':_0x1c8209})[_0x26ca29(0x2b9)]({'live':_0x412f19})[_0x26ca29(0x234)](),config=getConfiguration(),io['to'](_0x26ca29(0x1f2))[_0x26ca29(0x192)](_0x26ca29(0x179),config),broadcastToBots(_0x26ca29(0x179),JSON[_0x26ca29(0x19b)](config));}function updateBotName(_0x54cfd6,_0x2b9c7b){const _0x584c1=_0x169721;dbConfig['get'](_0x584c1(0x179))[_0x584c1(0x28e)]({'botID':_0x54cfd6})[_0x584c1(0x2b9)]({'botname':_0x2b9c7b})['write'](),config=getConfiguration(),io['to'](_0x584c1(0x1f2))[_0x584c1(0x192)](_0x584c1(0x179),config),broadcastToBots(_0x584c1(0x179),JSON[_0x584c1(0x19b)](config));}function updateBotManager(){const _0x25f040=_0x169721;config=getConfiguration(),io['to']('botmanager')[_0x25f040(0x192)](_0x25f040(0x179),config),broadcastToBots('bots',JSON[_0x25f040(0x19b)](config));}function toggleBotMode(_0x49e07e){const _0x133b77=_0x169721;if(pid[_0x49e07e])pid[_0x49e07e]['send']({'function':_0x133b77(0x1c4),'args':null});else{const _0x19128d=configpath+_0x133b77(0x230)+_0x49e07e+_0x133b77(0x21b),_0xa172b5=fs[_0x133b77(0x241)](_0x19128d),_0x454af7=JSON['parse'](_0xa172b5),_0x1abe1b=_0x454af7[_0x133b77(0x2de)][0x0][_0x133b77(0x270)];_0x454af7[_0x133b77(0x2de)][0x0]['headless']=!_0x1abe1b;const _0x177979=JSON[_0x133b77(0x19b)](_0x454af7,null,0x2);fs[_0x133b77(0x311)](_0x19128d,_0x177979),config=getConfiguration(),io['to']('botmanager')[_0x133b77(0x192)]('bots',config),broadcastToBots('bots',JSON[_0x133b77(0x19b)](config));}}function validateTelegram(_0x4d98ab){const _0x596fda=_0x169721;if(_0x4d98ab[_0x596fda(0x188)][_0x596fda(0x165)]!=settings['telegramUsername']&&'@'+_0x4d98ab[_0x596fda(0x188)]['username']!=settings[_0x596fda(0x2af)]||_0x4d98ab[_0x596fda(0x308)]['id']!=settings['telegramChatId'])return sendTelegram(_0x4d98ab[_0x596fda(0x308)]['id'],_0x596fda(0x295),{'parse_mode':_0x596fda(0x24e)}),![];return!![];}async function initTelegram(){const _0x3ee949=_0x169721;tgBot&&(await tgBot['stop'](),await sleep(0x7d0));tgBot=new Telegraf(settings['telegramToken']);let _0x45106d=_0x3ee949(0x30a);_0x45106d+='\x0a',_0x45106d+=_0x3ee949(0x12a),_0x45106d+=_0x3ee949(0x153),_0x45106d+=_0x3ee949(0x115),_0x45106d+=_0x3ee949(0x11b),_0x45106d+='/on\x20-\x20start\x20bot(s)\x0a',_0x45106d+=_0x3ee949(0x2ce),_0x45106d+=_0x3ee949(0x302),_0x45106d+=_0x3ee949(0x322),_0x45106d+=_0x3ee949(0x1af),_0x45106d+=_0x3ee949(0x11d),_0x45106d+=_0x3ee949(0x27d),_0x45106d+=_0x3ee949(0x224),_0x45106d+=_0x3ee949(0x1ca),_0x45106d+=_0x3ee949(0x209),_0x45106d+=_0x3ee949(0x1f0),_0x45106d+='/help\x20-\x20show\x20available\x20commands\x0a';let _0x502402=_0x3ee949(0x16c);_0x502402+='\x0a',_0x502402+=_0x45106d,tgBot[_0x3ee949(0x2e4)]((_0x187a2a,_0x43a20a)=>{const _0x1355e0=_0x3ee949;logger['simple'](getTimeStamp()+_0x1355e0(0x13f)),logger['debug']('Telegraf\x20error:',_0x187a2a);}),tgBot[_0x3ee949(0x134)](async(_0x316971,_0x4eabc0)=>{const _0x43a01e=_0x3ee949;if(settings['telegramChatId']||_0x316971['update'][_0x43a01e(0x11e)][_0x43a01e(0x2ab)]!=_0x43a01e(0x175)){if(!validateTelegram(_0x316971))return;}_0x4eabc0();}),tgBot['command'](_0x3ee949(0x17f),async _0x1b9734=>{const _0x399f8a=_0x3ee949;if(_0x1b9734['from']['username']==settings[_0x399f8a(0x2af)]||'@'+_0x1b9734['from']['username']==settings[_0x399f8a(0x2af)]){if(!settings['telegramChatId'])updateSetting('telegramChatId',_0x1b9734[_0x399f8a(0x308)]['id']);else{if(!validateTelegram(_0x1b9734))return;}}else{if(!validateTelegram(_0x1b9734))return;}updateSetting(_0x399f8a(0x156),!![]),await sendTelegram(_0x1b9734['chat']['id'],_0x502402);}),tgBot[_0x3ee949(0x14c)]('enable',async _0x256e9d=>{const _0x15ab23=_0x3ee949;updateSetting(_0x15ab23(0x156),!![]),await sendTelegram(_0x256e9d['chat']['id'],_0x15ab23(0x229));}),tgBot[_0x3ee949(0x14c)]('disable',async _0x18ad8b=>{const _0x4ee3e3=_0x3ee949;await sendTelegram(_0x18ad8b[_0x4ee3e3(0x308)]['id'],_0x4ee3e3(0x2c4)),updateSetting('telegramEnabled',![]);}),tgBot[_0x3ee949(0x14c)](_0x3ee949(0x130),async _0x4f854f=>{const _0x2735f2=_0x3ee949,_0x223af4=Markup[_0x2735f2(0x285)]([Markup[_0x2735f2(0x17e)][_0x2735f2(0x1b9)]('Orders',_0x2735f2(0x276)),Markup[_0x2735f2(0x17e)][_0x2735f2(0x1b9)](_0x2735f2(0x228),_0x2735f2(0x320)),Markup[_0x2735f2(0x17e)][_0x2735f2(0x1b9)](_0x2735f2(0x1a0),'config_all')]);_0x4f854f[_0x2735f2(0x2fb)](_0x2735f2(0x292),_0x223af4);}),tgBot['action'](_0x3ee949(0x276),async _0xff7623=>{const _0xf34983=_0x3ee949;_0xff7623[_0xf34983(0x13b)](),updateSetting(_0xf34983(0x138),'orders'),updateSetting(_0xf34983(0x156),!![]),await sendTelegram(_0xff7623[_0xf34983(0x308)]['id'],'Ok,\x20will\x20send\x20order\x20notifications\x20only');}),tgBot[_0x3ee949(0x273)](_0x3ee949(0x320),async _0x46fcfe=>{const _0x5afb9b=_0x3ee949;_0x46fcfe['editMessageReplyMarkup'](),updateSetting(_0x5afb9b(0x138),'alerts'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x46fcfe['chat']['id'],_0x5afb9b(0x1b2));}),tgBot[_0x3ee949(0x273)](_0x3ee949(0x248),async _0x5bd815=>{const _0x5530ac=_0x3ee949;_0x5bd815['editMessageReplyMarkup'](),updateSetting(_0x5530ac(0x138),_0x5530ac(0x159)),updateSetting(_0x5530ac(0x156),!![]),await sendTelegram(_0x5bd815[_0x5530ac(0x308)]['id'],_0x5530ac(0x126));}),tgBot[_0x3ee949(0x14c)](_0x3ee949(0x1e7),async _0x3fcade=>{const _0x16c198=_0x3ee949,_0x50d51a=getBotsWithMode();let _0x2f7f4c=_0x16c198(0x145);config[_0x16c198(0x133)](_0x1f5489=>{const _0x4fec37=_0x16c198,_0x3270f7=_0x50d51a[_0x4fec37(0x28e)](_0x3f9498=>_0x3f9498[_0x4fec37(0x1ee)]==_0x1f5489[_0x4fec37(0x1ee)])['mode'];_0x2f7f4c+=_0x4fec37(0x24a)+_0x1f5489[_0x4fec37(0x1ee)]+':\x20'+_0x1f5489['status']+'\x20|\x20'+_0x3270f7+'\x20|\x20'+_0x1f5489[_0x4fec37(0x259)]+'\x0a';}),_0x2f7f4c+='\x0a',_0x2f7f4c+=_0x16c198(0x2ec),_0x2f7f4c+=!settings[_0x16c198(0x156)]?_0x16c198(0x18e):_0x16c198(0x1c5),_0x2f7f4c+=settings['telegramEnabled']?settings[_0x16c198(0x138)]==_0x16c198(0x159)?'Notifications\x20types:\x20orders\x20and\x20alerts\x0a':'Notifications\x20types:\x20'+settings[_0x16c198(0x138)]+_0x16c198(0x1c6):'',await sendTelegram(_0x3fcade['chat']['id'],_0x2f7f4c,{'parse_mode':_0x16c198(0x24e)});}),tgBot[_0x3ee949(0x14c)]('restart',async _0x4e2734=>{const _0x26ce08=_0x3ee949,_0x4946a1=getEnabledBots();if(_0x4946a1[_0x26ce08(0x120)]==0x0)await sendTelegram(_0x4e2734[_0x26ce08(0x308)]['id'],_0x26ce08(0x140));else{if(_0x4946a1[_0x26ce08(0x120)]>0x1)_0x4946a1[_0x26ce08(0x2bf)]({'botID':_0x26ce08(0x159)});let _0x34298b=[],_0x1005cb=[];const _0x2b49f1=_0x4946a1[_0x26ce08(0x120)]%0x4==0x0||_0x4946a1[_0x26ce08(0x120)]%0x4==0x3||_0x4946a1[_0x26ce08(0x120)]%0x3==0x1?0x4:0x3;let _0x1da58e=0x0;_0x4946a1['forEach']((_0x367c03,_0x1ebf7f)=>{const _0x4ea991=_0x26ce08;if(_0x1ebf7f%_0x2b49f1==0x0)_0x1005cb=[];_0x1005cb[_0x4ea991(0x2bf)](Markup[_0x4ea991(0x17e)][_0x4ea991(0x1b9)](_0x367c03[_0x4ea991(0x1ee)]==_0x4ea991(0x159)?_0x4ea991(0x28b):'Bot\x20'+_0x367c03[_0x4ea991(0x1ee)],'restart_'+_0x367c03[_0x4ea991(0x1ee)])),_0x1ebf7f%_0x2b49f1==0x0&&(_0x34298b[_0x1da58e]=_0x1005cb,_0x1da58e++);});const _0xcb8564=Markup[_0x26ce08(0x285)](_0x34298b);_0x4e2734[_0x26ce08(0x2fb)](_0x26ce08(0x170),_0xcb8564);}}),tgBot['action'](/restart_(.+)/,async _0x3a55e5=>{const _0x322eda=_0x3ee949,_0x465163=_0x3a55e5[_0x322eda(0x2cb)][0x1];_0x3a55e5[_0x322eda(0x13b)](),_0x465163==_0x322eda(0x159)?config['forEach'](_0x518616=>{const _0xd572ca=_0x322eda;restartBot(_0x518616[_0xd572ca(0x1ee)]);}):restartBot(_0x465163);}),tgBot['command']('on',async _0x5dcc7b=>{const _0x364cb9=_0x3ee949,_0x542a9d=getDisabledBots();if(_0x542a9d[_0x364cb9(0x120)]==0x0)await sendTelegram(_0x5dcc7b['chat']['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x542a9d[_0x364cb9(0x120)]>0x1)_0x542a9d[_0x364cb9(0x2bf)]({'botID':_0x364cb9(0x159)});let _0x48bd95=[],_0x17a8be=[];const _0x5d297b=_0x542a9d[_0x364cb9(0x120)]%0x4==0x0||_0x542a9d[_0x364cb9(0x120)]%0x4==0x3||_0x542a9d[_0x364cb9(0x120)]%0x3==0x1?0x4:0x3;let _0x7bb4fa=0x0;_0x542a9d[_0x364cb9(0x133)]((_0x3b1e75,_0x5bf7e9)=>{const _0x539082=_0x364cb9;if(_0x5bf7e9%_0x5d297b==0x0)_0x17a8be=[];_0x17a8be['push'](Markup[_0x539082(0x17e)][_0x539082(0x1b9)](_0x3b1e75['botID']=='all'?_0x539082(0x28b):'Bot\x20'+_0x3b1e75[_0x539082(0x1ee)],_0x539082(0x307)+_0x3b1e75[_0x539082(0x1ee)])),_0x5bf7e9%_0x5d297b==0x0&&(_0x48bd95[_0x7bb4fa]=_0x17a8be,_0x7bb4fa++);});const _0x99862d=Markup[_0x364cb9(0x285)](_0x48bd95);_0x5dcc7b['reply'](_0x364cb9(0x2f3),_0x99862d);}}),tgBot[_0x3ee949(0x273)](/on_(.+)/,async _0x2b83e9=>{const _0x5c4903=_0x3ee949,_0x5a69c5=_0x2b83e9[_0x5c4903(0x2cb)][0x1];_0x2b83e9['editMessageReplyMarkup']();if(_0x5a69c5=='all'){const _0x30ef0f=getDisabledBots();await sendTelegram(_0x2b83e9[_0x5c4903(0x308)]['id'],_0x5c4903(0x12c)),_0x30ef0f['forEach'](_0x587c46=>{const _0x385b17=_0x5c4903;if(_0x587c46[_0x385b17(0x1ee)]!='all')toggleBot(_0x587c46[_0x385b17(0x1ee)],toggleStatus(_0x587c46[_0x385b17(0x1ee)]),_0x385b17(0x1c1));});}else await sendTelegram(_0x2b83e9[_0x5c4903(0x308)]['id'],'Bot\x20Mgr\x20>\x20starting\x20Bot\x20'+_0x5a69c5),toggleBot(_0x5a69c5,toggleStatus(_0x5a69c5),_0x5c4903(0x1c1));}),tgBot['command'](_0x3ee949(0x2b0),async _0x48e0de=>{const _0x5db664=_0x3ee949,_0x4b1424=getEnabledBots();if(_0x4b1424['length']==0x0)await sendTelegram(_0x48e0de['chat']['id'],_0x5db664(0x140));else{if(_0x4b1424[_0x5db664(0x120)]>0x1)_0x4b1424[_0x5db664(0x2bf)]({'botID':_0x5db664(0x159)});let _0x35af4c=[],_0x3a2127=[];const _0x5e5a73=_0x4b1424[_0x5db664(0x120)]%0x4==0x0||_0x4b1424[_0x5db664(0x120)]%0x4==0x3||_0x4b1424['length']%0x3==0x1?0x4:0x3;let _0x121795=0x0;_0x4b1424[_0x5db664(0x133)]((_0x2d3328,_0x204b32)=>{const _0x194dd2=_0x5db664;if(_0x204b32%_0x5e5a73==0x0)_0x3a2127=[];_0x3a2127['push'](Markup[_0x194dd2(0x17e)][_0x194dd2(0x1b9)](_0x2d3328[_0x194dd2(0x1ee)]==_0x194dd2(0x159)?_0x194dd2(0x28b):'Bot\x20'+_0x2d3328[_0x194dd2(0x1ee)],_0x194dd2(0x16b)+_0x2d3328[_0x194dd2(0x1ee)])),_0x204b32%_0x5e5a73==0x0&&(_0x35af4c[_0x121795]=_0x3a2127,_0x121795++);});const _0x2c161f=Markup[_0x5db664(0x285)](_0x35af4c);_0x48e0de[_0x5db664(0x2fb)](_0x5db664(0x1ad),_0x2c161f);}}),tgBot[_0x3ee949(0x273)](/off_(.+)/,async _0x8bf8ea=>{const _0x26f45c=_0x3ee949,_0x5940a7=_0x8bf8ea['match'][0x1];_0x8bf8ea[_0x26f45c(0x13b)]();if(_0x5940a7==_0x26f45c(0x159)){const _0x118395=getEnabledBots();await sendTelegram(_0x8bf8ea['chat']['id'],_0x26f45c(0x288)),_0x118395[_0x26f45c(0x133)](_0x3b663f=>{const _0x138efd=_0x26f45c;if(_0x3b663f[_0x138efd(0x1ee)]!=_0x138efd(0x159))toggleBot(_0x3b663f[_0x138efd(0x1ee)],toggleStatus(_0x3b663f[_0x138efd(0x1ee)]),_0x138efd(0x1c1));});}else await sendTelegram(_0x8bf8ea[_0x26f45c(0x308)]['id'],'Bot\x20Mgr\x20>\x20stopping\x20Bot\x20'+_0x5940a7),toggleBot(_0x5940a7,toggleStatus(_0x5940a7),_0x26f45c(0x1c1));}),tgBot['command'](_0x3ee949(0x22d),async _0x1f71f4=>{const _0xa2b849=_0x3ee949,_0x2aadbf=getEnabledBots();if(_0x2aadbf[_0xa2b849(0x120)]==0x0)await sendTelegram(_0x1f71f4[_0xa2b849(0x308)]['id'],_0xa2b849(0x140));else{if(_0x2aadbf[_0xa2b849(0x120)]>0x1){let _0x4b93bf=[],_0x1fbc93=[];const _0x4d250b=_0x2aadbf[_0xa2b849(0x120)]%0x4==0x0||_0x2aadbf[_0xa2b849(0x120)]%0x4==0x3||_0x2aadbf[_0xa2b849(0x120)]%0x3==0x1?0x4:0x3;let _0x3af39f=0x0;_0x2aadbf[_0xa2b849(0x133)]((_0x1beb91,_0x2d5b1e)=>{const _0x2506ad=_0xa2b849;if(_0x2d5b1e%_0x4d250b==0x0)_0x1fbc93=[];_0x1fbc93[_0x2506ad(0x2bf)](Markup[_0x2506ad(0x17e)][_0x2506ad(0x1b9)](_0x2506ad(0x24a)+_0x1beb91[_0x2506ad(0x1ee)],'metrics_'+_0x1beb91[_0x2506ad(0x1ee)])),_0x2d5b1e%_0x4d250b==0x0&&(_0x4b93bf[_0x3af39f]=_0x1fbc93,_0x3af39f++);});const _0x1142a7=Markup[_0xa2b849(0x285)](_0x4b93bf);_0x1f71f4[_0xa2b849(0x2fb)](_0xa2b849(0x148),_0x1142a7);}else{const _0x3a7d2c=_0x2aadbf[0x0][_0xa2b849(0x1ee)];if(pid[_0x3a7d2c])pid[_0x3a7d2c]['send']({'function':_0xa2b849(0x2f0),'args':null});}}}),tgBot[_0x3ee949(0x273)](/metrics_(.+)/,async _0x3b9937=>{const _0x12f31a=_0x3ee949,_0x3fe50e=_0x3b9937['match'][0x1];_0x3b9937['editMessageReplyMarkup']();if(pid[_0x3fe50e])pid[_0x3fe50e][_0x12f31a(0x121)]({'function':_0x12f31a(0x2f0),'args':null});}),tgBot['command']('portfolio',async _0x5030bb=>{const _0x36b123=_0x3ee949,_0x5cc6a6=getEnabledBots();if(_0x5cc6a6['length']==0x0)await sendTelegram(_0x5030bb[_0x36b123(0x308)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x5cc6a6[_0x36b123(0x120)]>0x1){let _0x86380f=[],_0x276b26=[];const _0x3f8230=_0x5cc6a6['length']%0x4==0x0||_0x5cc6a6[_0x36b123(0x120)]%0x4==0x3||_0x5cc6a6[_0x36b123(0x120)]%0x3==0x1?0x4:0x3;let _0x548dc9=0x0;_0x5cc6a6[_0x36b123(0x133)]((_0x48ccc4,_0x2a4501)=>{const _0x212ede=_0x36b123;if(_0x2a4501%_0x3f8230==0x0)_0x276b26=[];_0x276b26[_0x212ede(0x2bf)](Markup[_0x212ede(0x17e)][_0x212ede(0x1b9)](_0x212ede(0x24a)+_0x48ccc4[_0x212ede(0x1ee)],_0x212ede(0x1de)+_0x48ccc4['botID'])),_0x2a4501%_0x3f8230==0x0&&(_0x86380f[_0x548dc9]=_0x276b26,_0x548dc9++);});const _0x3f4cdb=Markup['inlineKeyboard'](_0x86380f);_0x5030bb[_0x36b123(0x2fb)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x3f4cdb);}else{const _0x15febf=_0x5cc6a6[0x0]['botID'];if(pid[_0x15febf])pid[_0x15febf][_0x36b123(0x121)]({'function':_0x36b123(0x232),'args':null});}}}),tgBot[_0x3ee949(0x273)](/portfolio_(.+)/,async _0xb8c725=>{const _0xf8b054=_0x3ee949,_0x59324b=_0xb8c725[_0xf8b054(0x2cb)][0x1];_0xb8c725[_0xf8b054(0x13b)]();if(pid[_0x59324b])pid[_0x59324b]['send']({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x3ee949(0x14c)]('logs',async _0x11fa47=>{const _0x2aa070=_0x3ee949,_0x1450fb=_0x2aa070(0x2dd);await zipFiles(_0x1450fb);const _0x3225c4=zippath+(_0x1450fb+'.zip');_0x11fa47[_0x2aa070(0x300)]({'source':_0x3225c4})[_0x2aa070(0x247)](()=>{})['catch'](_0x165e56=>logger[_0x2aa070(0x2b6)](_0x2aa070(0x306)+_0x1450fb+_0x2aa070(0x290),_0x165e56));}),tgBot[_0x3ee949(0x14c)](_0x3ee949(0x2ad),async _0xa88a94=>{const _0x387f2a=_0x3ee949,_0x40ab23=_0x387f2a(0x2ad);await backupConfigFiles(),await zipFiles(_0x40ab23);const _0x467a7d=zippath+(_0x40ab23+_0x387f2a(0x181));_0xa88a94[_0x387f2a(0x300)]({'source':_0x467a7d})[_0x387f2a(0x247)](()=>{})[_0x387f2a(0x2e4)](_0x4ea80e=>logger[_0x387f2a(0x2b6)](_0x387f2a(0x306)+_0x40ab23+'\x20files\x20over\x20Telegram:',_0x4ea80e));}),tgBot['command'](_0x3ee949(0x116),async _0x24984e=>{const _0x1d87e7=_0x3ee949;await getMessages();if(!updateAvailable)await sendTelegram(_0x24984e[_0x1d87e7(0x308)]['id'],_0x1d87e7(0x29a));else{if(!validInstallation)await sendTelegram(_0x24984e[_0x1d87e7(0x308)]['id'],_0x1d87e7(0x11f));else{const _0x5ecfd6=Markup[_0x1d87e7(0x285)]([Markup[_0x1d87e7(0x17e)]['callback'](_0x1d87e7(0x124),_0x1d87e7(0x212)),Markup[_0x1d87e7(0x17e)][_0x1d87e7(0x1b9)]('No',_0x1d87e7(0x2f4))]);_0x24984e[_0x1d87e7(0x2fb)](_0x1d87e7(0x10e),_0x5ecfd6);}}}),tgBot[_0x3ee949(0x273)](/update_(.+)/,async _0x4f8bcb=>{const _0x5112fc=_0x3ee949,_0x51922b=_0x4f8bcb[_0x5112fc(0x2cb)][0x1];_0x4f8bcb[_0x5112fc(0x13b)](),_0x51922b=='yes'&&(await sendTelegram(_0x4f8bcb[_0x5112fc(0x308)]['id'],_0x5112fc(0x233)),updateBB(_0x5112fc(0x116))),_0x51922b=='no'&&await sendTelegram(_0x4f8bcb[_0x5112fc(0x308)]['id'],_0x5112fc(0x137));}),tgBot['command'](_0x3ee949(0x235),async _0x35c16b=>{const _0x45fb0e=_0x3ee949;if(!validInstallation)await sendTelegram(_0x35c16b['chat']['id'],_0x45fb0e(0x31a));else{const _0x1e8a9d=Markup['inlineKeyboard']([Markup[_0x45fb0e(0x17e)][_0x45fb0e(0x1b9)](_0x45fb0e(0x124),_0x45fb0e(0x312)),Markup['button']['callback']('No',_0x45fb0e(0x2b7))]);_0x35c16b[_0x45fb0e(0x2fb)](_0x45fb0e(0x250),_0x1e8a9d);}}),tgBot['action'](/reinstall_(.+)/,async _0x412e13=>{const _0x2f95a3=_0x3ee949,_0x562aeb=_0x412e13['match'][0x1];_0x412e13[_0x2f95a3(0x13b)](),_0x562aeb==_0x2f95a3(0x174)&&(await sendTelegram(_0x412e13['chat']['id'],_0x2f95a3(0x2cd)),updateBB(_0x2f95a3(0x235))),_0x562aeb=='no'&&await sendTelegram(_0x412e13['chat']['id'],'Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled');}),tgBot['command'](_0x3ee949(0x26e),async _0x20a8cf=>{const _0xe5ecb8=_0x3ee949,_0x2413cd=getBotsWithMode();if(_0x2413cd['length']==0x0)await sendTelegram(_0x20a8cf[_0xe5ecb8(0x308)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0x1a317e=[],_0x29696a=[];const _0x556ba0=0x2;let _0x1ba40d=0x0;_0x2413cd[_0xe5ecb8(0x133)]((_0x3acd55,_0x367210)=>{const _0x3c7fb1=_0xe5ecb8;if(_0x367210%_0x556ba0==0x0)_0x29696a=[];_0x29696a[_0x3c7fb1(0x2bf)](Markup['button'][_0x3c7fb1(0x1b9)](_0x3c7fb1(0x24a)+_0x3acd55[_0x3c7fb1(0x1ee)]+'\x20('+_0x3acd55[_0x3c7fb1(0x296)]+')',_0x3c7fb1(0x207)+_0x3acd55[_0x3c7fb1(0x1ee)])),_0x367210%_0x556ba0==0x0&&(_0x1a317e[_0x1ba40d]=_0x29696a,_0x1ba40d++);});const _0xdb2632=Markup[_0xe5ecb8(0x285)](_0x1a317e);_0x20a8cf[_0xe5ecb8(0x2fb)](_0xe5ecb8(0x1ff),_0xdb2632);}}),tgBot[_0x3ee949(0x273)](/toggle_(.+)/,async _0x117d3f=>{const _0x1defb2=_0x3ee949,_0x2023b0=_0x117d3f[_0x1defb2(0x2cb)][0x1];_0x117d3f['editMessageReplyMarkup']();const _0x4fd359=getBotsWithMode(),_0x292a77=_0x4fd359[_0x1defb2(0x28e)](_0x514fff=>_0x514fff['botID']==_0x2023b0),_0x2340e9=_0x292a77[_0x1defb2(0x296)]==_0x1defb2(0x1ec)?_0x1defb2(0x1e1):_0x1defb2(0x1ec);await sendTelegram(_0x117d3f[_0x1defb2(0x308)]['id'],_0x1defb2(0x279)+_0x2023b0+_0x1defb2(0x23b)+_0x2340e9+_0x1defb2(0x280)),toggleBotMode(_0x2023b0);}),tgBot[_0x3ee949(0x14c)](_0x3ee949(0x30b),async _0x53cd24=>{const _0x550160=_0x3ee949;let _0x5ef6d2='';config[_0x550160(0x133)](_0x3dc19f=>{const _0x17e77f=_0x550160;_0x5ef6d2+='Bot\x20'+_0x3dc19f[_0x17e77f(0x1ee)]+':\x20'+_0x3dc19f[_0x17e77f(0x27e)]+'\x0a';}),await sendTelegram(_0x53cd24[_0x550160(0x308)]['id'],_0x5ef6d2,{'parse_mode':_0x550160(0x24e)});}),tgBot[_0x3ee949(0x14c)](_0x3ee949(0x265),async _0x556b38=>{const _0x4101c3=_0x3ee949;await sendTelegram(_0x556b38[_0x4101c3(0x308)]['id'],_0x45106d);}),process['once'](_0x3ee949(0x2e0),()=>tgBot[_0x3ee949(0x180)](_0x3ee949(0x2e0))),process[_0x3ee949(0x1fa)](_0x3ee949(0x281),()=>tgBot[_0x3ee949(0x180)](_0x3ee949(0x281))),tgBot[_0x3ee949(0x13a)]();}function disableTelegram(){tgBot&&tgBot['stop']();}async function sendTelegram(_0x4b382a,_0x26545a,_0x32c234){const _0x486a2d=_0x169721;_0x32c234={..._0x32c234,'disable_web_page_preview':!![]};try{await tgBot[_0x486a2d(0x260)][_0x486a2d(0x167)](_0x4b382a,_0x26545a,_0x32c234);}catch(_0x2a549c){logger[_0x486a2d(0x2b6)](_0x486a2d(0x217),_0x2a549c);}}async function sendTelegramBot(_0x39d52e,_0x1a6be7){const _0x5a4295=_0x169721;if(settings['telegramEnabled']){if(settings[_0x5a4295(0x138)]==_0x5a4295(0x159)||(_0x1a6be7[_0x5a4295(0x31e)]==_0x5a4295(0x2cc)||_0x1a6be7[_0x5a4295(0x31e)]==_0x5a4295(0x283)||_0x1a6be7[_0x5a4295(0x31e)]=='success')&&settings['telegramEvents']=='alerts'||_0x1a6be7['type']==_0x5a4295(0x1fe)&&settings[_0x5a4295(0x138)]==_0x5a4295(0x135)){if(tgBot&&settings['telegramChatId']){if(_0x1a6be7['showname'])await sendTelegram(settings[_0x5a4295(0x186)],_0x1a6be7[_0x5a4295(0x27e)]+_0x5a4295(0x1e5)+_0x1a6be7[_0x5a4295(0x18f)]);else await sendTelegram(settings['telegramChatId'],_0x5a4295(0x24a)+_0x39d52e+'\x20>\x20'+_0x1a6be7[_0x5a4295(0x18f)]);}}}}async function sendTelegramMsg(_0x448c14,_0x45968d=_0x169721(0x24e)){return tgBot&&settings['telegramChatId']?(await sendTelegram(settings['telegramChatId'],_0x448c14,{'parse_mode':_0x45968d}),!![]):![];}function getDeviceWithIp(_0x2d91a5){const _0x4dab44=_0x169721;return devices[_0x4dab44(0x28e)](_0x25bed7=>_0x25bed7['ip']===_0x2d91a5);}async function temporaryAccess2FA(_0x5b9675,_0x25d026){const _0x4fe9aa=_0x169721;let _0x4472fe=new Date(),_0x8a2a33=![];if(lastIpApproval){if(_0x4472fe-lastIpApproval<0x1388)_0x8a2a33=!![];}lastIpApproval=new Date();if(_0x8a2a33)return;if(tgBot&&settings[_0x4fe9aa(0x186)]){const _0xac10d=uuidRandom();tmpStorage[_0xac10d]={'uuid':_0x5b9675,'externalip':_0x25d026};const _0x97121=Markup['inlineKeyboard']([Markup[_0x4fe9aa(0x17e)][_0x4fe9aa(0x1b9)]('5\x20min',_0x4fe9aa(0x1f9)+_0xac10d),Markup[_0x4fe9aa(0x17e)][_0x4fe9aa(0x1b9)](_0x4fe9aa(0x31d),'tempaccess_15_'+_0xac10d),Markup['button'][_0x4fe9aa(0x1b9)](_0x4fe9aa(0x2e6),_0x4fe9aa(0x2e2)+_0xac10d),Markup[_0x4fe9aa(0x17e)][_0x4fe9aa(0x1b9)]('reject',_0x4fe9aa(0x118)+_0xac10d)]);await sendTelegram(settings[_0x4fe9aa(0x186)],_0x4fe9aa(0x227)+normalizeIP(_0x25d026)[_0x4fe9aa(0x275)]+'\x20?',_0x97121),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0xd5779c=>{const _0x2cfc64=_0x4fe9aa,_0x31bb79=_0xd5779c['match'][0x1],_0x7ae6d3=_0xd5779c[_0x2cfc64(0x2cb)][0x2],{uuid:_0x2fa69e,externalip:_0x30341f}=tmpStorage[_0x7ae6d3];delete tmpStorage[_0x7ae6d3],_0xd5779c[_0x2cfc64(0x13b)](),devices[_0x2fa69e][_0x2cfc64(0x190)]={'clientip':_0x30341f,'timestamp':new Date()[_0x2cfc64(0x315)](),'expiry':_0x31bb79},_0x31bb79!='reject'?(await sendTelegram(_0xd5779c[_0x2cfc64(0x308)]['id'],'Access\x20enabled\x20for\x20'+_0x31bb79+_0x2cfc64(0x240),{'parse_mode':_0x2cfc64(0x24e)}),io['to'](_0x2fa69e)[_0x2cfc64(0x192)](_0x2cfc64(0x1e7),{'access':{'allow':![],'reason':_0x2cfc64(0x25e),'token':null}})):(await sendTelegram(_0xd5779c['chat']['id'],'Temporary\x20access\x20rejected'),io['to'](_0x2fa69e)[_0x2cfc64(0x192)](_0x2cfc64(0x1e7),{'access':{'allow':![],'reason':_0x2cfc64(0x1cb),'token':null}}));});}}async function loginAccess2FA(_0x58c87e,_0x12e939){const _0x195fc8=_0x169721;if(tgBot&&settings[_0x195fc8(0x186)]){const _0x1fdb70=uuidRandom();tmpStorage[_0x1fdb70]={'uuid':_0x58c87e,'externalip':_0x12e939};const _0x29ca1f=Markup[_0x195fc8(0x285)]([Markup[_0x195fc8(0x17e)][_0x195fc8(0x1b9)](_0x195fc8(0x176),'login2fa_'+loginExpiry+'_'+_0x1fdb70),Markup[_0x195fc8(0x17e)][_0x195fc8(0x1b9)](_0x195fc8(0x132),_0x195fc8(0x319)+_0x1fdb70)]);await sendTelegram(settings['telegramChatId'],'Allow\x20login\x20from\x20IP\x20address\x20'+normalizeIP(_0x12e939)[_0x195fc8(0x275)]+'\x20?',_0x29ca1f),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x17239b=>{const _0xdd3204=_0x195fc8,_0x589065=_0x17239b['match'][0x1],_0x33d77a=_0x17239b[_0xdd3204(0x2cb)][0x2],{uuid:_0x4a1eae,externalip:_0x41d05b}=tmpStorage[_0x33d77a];delete tmpStorage[_0x33d77a],_0x17239b[_0xdd3204(0x13b)](),devices[_0x4a1eae][_0xdd3204(0x14d)]={'clientip':_0x41d05b,'timestamp':new Date()['getTime'](),'expiry':_0x589065},_0x589065!=_0xdd3204(0x132)?(await sendTelegram(_0x17239b[_0xdd3204(0x308)]['id'],_0xdd3204(0x29e),{'parse_mode':_0xdd3204(0x24e)}),io['to'](_0x4a1eae)[_0xdd3204(0x192)](_0xdd3204(0x1e7),{'access':{'allow':![],'reason':'reload','token':null}})):(await sendTelegram(_0x17239b[_0xdd3204(0x308)]['id'],_0xdd3204(0x2ea)),io['to'](_0x4a1eae)[_0xdd3204(0x192)]('status',{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x1f0c98=_0x169721;return dbConfig[_0x1f0c98(0x1d9)]('bots')[_0x1f0c98(0x2ed)](_0x1f0c98(0x1ee))[_0x1f0c98(0x2ff)]({'status':_0x1f0c98(0x22e)})[_0x1f0c98(0x243)]()||[];}function getDisabledBots(){const _0x28fcf4=_0x169721;return dbConfig[_0x28fcf4(0x1d9)](_0x28fcf4(0x179))[_0x28fcf4(0x2ed)]('botID')['filter']({'status':'disabled'})['value']()||[];}function getBotAttributes(_0x56d5a7){const _0x3513e3=_0x169721;let _0x242747={};const _0x321bba=configpath+_0x3513e3(0x230)+_0x56d5a7+_0x3513e3(0x21b),_0x454d71=fs[_0x3513e3(0x30d)](_0x321bba);if(_0x454d71){const _0x2d781d=fs[_0x3513e3(0x241)](_0x321bba);try{const _0x354b61=JSON[_0x3513e3(0x2e5)](_0x2d781d),_0x241bea=_0x354b61?_0x354b61[_0x3513e3(0x2de)][0x0][_0x3513e3(0x270)]:![];_0x242747[_0x3513e3(0x296)]=_0x241bea?_0x3513e3(0x1ec):_0x3513e3(0x1e1),_0x242747[_0x3513e3(0x27e)]=_0x354b61?_0x354b61[_0x3513e3(0x2de)][0x0][_0x3513e3(0x27e)]:'Bot\x20'+_0x56d5a7;}catch(_0xba37b7){_0x242747['mode']=_0x3513e3(0x1e1),_0x242747[_0x3513e3(0x27e)]=_0x3513e3(0x24a)+_0x56d5a7;}}else _0x242747['mode']='manual',_0x242747[_0x3513e3(0x27e)]=_0x3513e3(0x24a)+_0x56d5a7;return _0x242747;}function getBotsWithMode(){const _0xd02215=_0x169721,_0xabb5ab=dbConfig[_0xd02215(0x1d9)](_0xd02215(0x179))[_0xd02215(0x2ed)](_0xd02215(0x1ee))[_0xd02215(0x243)]()||[];return _0xabb5ab['forEach'](_0x3365f7=>{const _0x50de27=_0xd02215;let _0x546343=getBotAttributes(_0x3365f7[_0x50de27(0x1ee)]);_0x3365f7['mode']=_0x546343['mode'];}),_0xabb5ab;}function getBotExchanges(){const _0x38eb2f=_0x169721;let _0x12615b=[];const _0x2548dd=dbConfig[_0x38eb2f(0x1d9)](_0x38eb2f(0x179))[_0x38eb2f(0x2ed)](_0x38eb2f(0x1ee))[_0x38eb2f(0x243)]()||[];_0x2548dd[_0x38eb2f(0x133)](_0x40e12e=>{const _0x816c34=_0x38eb2f;if(_0x40e12e['status']=='enabled'){const _0x1b7f53=configpath+'bot-'+_0x40e12e[_0x816c34(0x1ee)]+_0x816c34(0x21b),_0x50fe03=fs['existsSync'](_0x1b7f53);let _0x1c3426;if(_0x50fe03){const _0x19beee=fs[_0x816c34(0x241)](_0x1b7f53);try{const _0x2fa5bd=JSON['parse'](_0x19beee);_0x1c3426=_0x2fa5bd?_0x2fa5bd[_0x816c34(0x2de)][0x0][_0x816c34(0x1d7)]:null;}catch(_0x577ba8){}}if(_0x1c3426)_0x12615b['push'](_0x1c3426);}});const _0x3aee01=[...new Set(_0x12615b)][_0x38eb2f(0x1ea)]();return _0x3aee01;}async function initUser(){const _0xc6685b=_0x169721;if(!settings[_0xc6685b(0x2ac)]){const _0x399e5b=uuidRandom();mixpanel[_0xc6685b(0x2b8)](_0x399e5b),updateSetting(_0xc6685b(0x2ac),_0x399e5b);}}async function initSecure(){const _0x39cc7e=_0x169721;let _0x597a21=getSecure();if(!_0x597a21[_0x39cc7e(0x155)](_0x39cc7e(0x2b2))){let _0x40f34b=await generateKeys();_0x597a21[_0x39cc7e(0x29d)]=_0x40f34b[_0x39cc7e(0x29d)],_0x597a21['privateKey']=_0x40f34b['privateKey'],_0x597a21[_0x39cc7e(0x2b2)]=crypto['randomBytes'](0x20)[_0x39cc7e(0x2ef)](_0x39cc7e(0x16d));;storeSecure(_0x597a21);}}function getSettings(){const _0x55a341=_0x169721;return dbSettings[_0x55a341(0x1d9)](_0x55a341(0x289))['value']()||{};}function getSecure(){const _0x4860c7=_0x169721;return dbSecure['get'](_0x4860c7(0x219))['value']()||{};}function getBlacklist(){const _0x3966e7=_0x169721;return dbSecure[_0x3966e7(0x1d9)]('blacklist')[_0x3966e7(0x243)]()||[];}function broadcastToBots(_0x3a8333,_0x1729d0){config['forEach'](_0x5635bd=>{const _0x41c312=_0x825d;if(_0x5635bd[_0x41c312(0x1e7)]==_0x41c312(0x22e)&&_0x5635bd['live']==_0x41c312(0x14a)||_0x5635bd[_0x41c312(0x1e7)]=='new'&&_0x5635bd['live']==_0x41c312(0x14a)){if(pid[_0x5635bd['botID']])pid[_0x5635bd['botID']][_0x41c312(0x121)]({[_0x3a8333]:_0x1729d0});}});}async function storeSettings(_0x5f5a2f,_0x3ee907=![]){const _0x133497=_0x169721;_0x5f5a2f={...settings,..._0x5f5a2f};if(_0x3ee907&&_0x5f5a2f[_0x133497(0x1cd)]!=_0x133497(0x1e8)&&_0x5f5a2f[_0x133497(0x1cd)]!='***'&&_0x5f5a2f[_0x133497(0x1cd)]!=''){const _0x27bedd=decryptRSA(secure['privateKey'],_0x5f5a2f[_0x133497(0x1cd)])[_0x133497(0x15f)](_0x133497(0x1f1))[0x0],_0x5a4290=bcrypt[_0x133497(0x14e)](_0x27bedd,saltRounds);_0x5f5a2f={..._0x5f5a2f,'bbPassword':_0x5a4290};}if(_0x3ee907&&_0x5f5a2f[_0x133497(0x172)]!=_0x133497(0x1e8)&&_0x5f5a2f[_0x133497(0x172)]!=_0x133497(0x2bb)&&_0x5f5a2f['telegramToken']!=''){const _0x166bd1=decryptRSA(secure[_0x133497(0x25d)],_0x5f5a2f[_0x133497(0x172)])[_0x133497(0x15f)](_0x133497(0x1f1))[0x0];_0x5f5a2f={..._0x5f5a2f,'telegramToken':_0x166bd1};}if(_0x3ee907&&_0x5f5a2f[_0x133497(0x269)]!=_0x133497(0x1e8)&&_0x5f5a2f['marketcapApi']!=_0x133497(0x2bb)&&_0x5f5a2f['marketcapApi']!=''){const _0x122022=decryptRSA(secure[_0x133497(0x25d)],_0x5f5a2f['marketcapApi'])['split']('|@|')[0x0];_0x5f5a2f={..._0x5f5a2f,'marketcapApi':_0x122022};}const _0x336962=_0x5f5a2f[_0x133497(0x172)]!='************'&&_0x5f5a2f['telegramToken']!=settings[_0x133497(0x172)]||_0x5f5a2f['telegramUsername']!=settings[_0x133497(0x2af)],_0x2e0591=_0x5f5a2f[_0x133497(0x172)]==''||_0x5f5a2f[_0x133497(0x2af)]=='',_0x4b931a=_0x5f5a2f[_0x133497(0x269)]&&_0x5f5a2f[_0x133497(0x269)]!=_0x133497(0x1e8)&&_0x5f5a2f[_0x133497(0x269)]!=settings[_0x133497(0x269)];_0x336962&&(_0x5f5a2f[_0x133497(0x186)]=null,_0x5f5a2f[_0x133497(0x138)]=_0x133497(0x159));for(const [_0x57d984,_0x3603a3]of Object[_0x133497(0x21f)](_0x5f5a2f)){if(_0x57d984==_0x133497(0x172)&&_0x3603a3==_0x133497(0x1e8)){_0x5f5a2f[_0x133497(0x172)]=settings[_0x133497(0x172)];continue;};if(_0x57d984==_0x133497(0x1cd)&&_0x3603a3==_0x133497(0x1e8)){_0x5f5a2f[_0x133497(0x1cd)]=settings[_0x133497(0x1cd)];continue;};if(_0x57d984=='marketcapApi'&&_0x3603a3==_0x133497(0x1e8)){_0x5f5a2f[_0x133497(0x269)]=settings[_0x133497(0x269)];continue;};dbSettings[_0x133497(0x1ce)](_0x133497(0x1b0)+_0x57d984,_0x3603a3)[_0x133497(0x234)]();}settings=_0x5f5a2f,io['to'](_0x133497(0x1f2))['emit'](_0x133497(0x289),cleanSettings()),broadcastToBots('timeshift',settings[_0x133497(0x266)]),broadcastToBots(_0x133497(0x2f7),settings[_0x133497(0x2f7)]),broadcastToBots('marketcapApi',settings[_0x133497(0x269)]);if(_0x336962&&!_0x2e0591)initTelegram();_0x336962&&_0x2e0591&&(updateSetting(_0x133497(0x186),null),disableTelegram()),getAllClients()['forEach'](_0x261a4e=>{const _0x4aa705=_0x133497;getSocket(_0x261a4e['id'])['emit']('status',{'access':{'allow':![],'reason':_0x4aa705(0x25e),'token':null}});}),_0x4b931a&&(await sleep(0xbb8),testMarketcapApi(_0x5f5a2f[_0x133497(0x269)]));}async function testMarketcapApi(_0x273406){const _0x1a9ff1=_0x169721,_0x580920=[_0x1a9ff1(0x271),_0x1a9ff1(0x2e9)];try{await axios[_0x1a9ff1(0x1d9)](_0x1a9ff1(0x17b),{'headers':{'X-CMC_PRO_API_KEY':_0x273406},'params':{'symbol':_0x580920[_0x1a9ff1(0x2ef)]()}});}catch(_0x24091a){_0x24091a[_0x1a9ff1(0x2ef)]()[_0x1a9ff1(0x1a5)](_0x1a9ff1(0x27a))?(io['to'](_0x1a9ff1(0x1f2))['emit'](_0x1a9ff1(0x2a6),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x1a9ff1(0x2d8)](_0x1a9ff1(0x2bd))):(io['to'](_0x1a9ff1(0x1f2))['emit'](_0x1a9ff1(0x2a6),_0x1a9ff1(0x220)),logger[_0x1a9ff1(0x2d8)](_0x1a9ff1(0x220)),logger['debug'](_0x1a9ff1(0x19f),_0x24091a[_0x1a9ff1(0x2ef)]()+_0x1a9ff1(0x1ed)+_0x24091a[_0x1a9ff1(0x28d)]));return;}logger['debug']('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0xe53f40,_0xce3902){const _0x571012=_0x169721;dbSettings[_0x571012(0x1ce)](_0x571012(0x1b0)+_0xe53f40,_0xce3902)[_0x571012(0x234)](),settings=getSettings(),io['to'](_0x571012(0x1f2))[_0x571012(0x192)]('settings',cleanSettings());}function storeSecure(_0x29cba3){const _0x5c83e4=_0x169721;dbSecure[_0x5c83e4(0x1d9)](_0x5c83e4(0x219))['push'](_0x29cba3)[_0x5c83e4(0x234)](),secure=_0x29cba3;}function addBlacklist(_0x328083){const _0x5b56bc=_0x169721;cleanBlacklist();let _0x5e11a4;devices[_0x328083][_0x5b56bc(0x190)]?_0x5e11a4=Math['max'](devices[_0x328083][_0x5b56bc(0x190)][_0x5b56bc(0x16f)],loginExpiry):_0x5e11a4=loginExpiry,dbSecure[_0x5b56bc(0x1d9)](_0x5b56bc(0x12b))[_0x5b56bc(0x2bf)]({'expiry':new Date()[_0x5b56bc(0x315)]()+_0x5e11a4*0x3c*0x3e8,'token':devices[_0x328083][_0x5b56bc(0x10d)]['token']})[_0x5b56bc(0x234)](),blacklist=dbSecure[_0x5b56bc(0x1d9)](_0x5b56bc(0x12b))[_0x5b56bc(0x243)]();}function cleanBlacklist(){const _0x4f3645=_0x169721;let _0x13400d=dbSecure['get'](_0x4f3645(0x12b))[_0x4f3645(0x2ca)]()[_0x4f3645(0x243)](),_0x14d872=new Date()[_0x4f3645(0x315)]();_0x13400d[_0x4f3645(0x133)](_0x25fd07=>{const _0x328483=_0x4f3645;_0x25fd07[_0x328483(0x16f)]<_0x14d872&&dbSecure['get'](_0x328483(0x12b))[_0x328483(0x2c9)]({'expiry':_0x25fd07[_0x328483(0x16f)]})[_0x328483(0x234)]();});}function initStates(){const _0x4323d0=_0x169721;let _0x41d096=getConfiguration();_0x41d096[_0x4323d0(0x133)](_0x31d8c9=>{const _0x405e80=_0x4323d0;_0x31d8c9[_0x405e80(0x259)]=_0x405e80(0x1c1);}),storeConfiguration(_0x41d096);}async function generateKeys(){const _0x3f5e4c=_0x169721,_0x21e600=forge['pki'][_0x3f5e4c(0x221)][_0x3f5e4c(0x1e0)]({'bits':0x1000,'e':0x10001}),_0x4cb5c9=forge[_0x3f5e4c(0x113)][_0x3f5e4c(0x23a)](_0x21e600[_0x3f5e4c(0x25d)]),_0x3af6e3=forge[_0x3f5e4c(0x113)]['publicKeyToPem'](_0x21e600[_0x3f5e4c(0x29d)]);return{'privateKey':_0x4cb5c9,'publicKey':_0x3af6e3};}async function oneTimeMigration(){const _0x38be29=_0x169721;let _0x16f953=getSettings(),_0x128351=![];!_0x16f953[_0x38be29(0x155)]('lastmsgtelegram')&&(_0x16f953[_0x38be29(0x1fc)]=0x0,_0x128351=!![]);!_0x16f953[_0x38be29(0x155)](_0x38be29(0x258))&&(_0x16f953[_0x38be29(0x258)]=0x0,_0x128351=!![]);!_0x16f953['hasOwnProperty']('latestversion')&&(_0x16f953[_0x38be29(0x264)]='0.0.0',_0x128351=!![]);!_0x16f953[_0x38be29(0x155)](_0x38be29(0x2f7))&&(_0x16f953[_0x38be29(0x2f7)]=![],_0x128351=!![]);!_0x16f953[_0x38be29(0x155)](_0x38be29(0x269))&&(_0x16f953[_0x38be29(0x269)]='',_0x128351=!![]);if(_0x128351)storeSettings(_0x16f953);try{fs[_0x38be29(0x2c6)](configbackuppath,{'withFileTypes':!![]})['forEach'](_0x2c4495=>{const _0x45304a=_0x38be29;if(!_0x2c4495[_0x45304a(0x22f)]()){if(!_0x2c4495['name']['startsWith'](_0x45304a(0x14b)))fs['unlinkSync'](configbackuppath+_0x2c4495[_0x45304a(0x2d1)]);}else fs[_0x45304a(0x2db)](configbackuppath+_0x2c4495[_0x45304a(0x2d1)],{'recursive':!![]});});}catch(_0x45976a){logger['debug'](_0x38be29(0x1a9),_0x45976a);}}function storeConfiguration(_0x374414){const _0x17095c=_0x169721;dbConfig['get'](_0x17095c(0x179))[_0x17095c(0x2c9)]()[_0x17095c(0x234)](),dbConfig[_0x17095c(0x1d9)]('bots')[_0x17095c(0x2bf)](..._0x374414)[_0x17095c(0x234)](),config=_0x374414;}async function resetPassword(){const _0x1843e1=_0x169721;if(tgBot&&settings['telegramChatId']){const _0xd92de2=Markup['inlineKeyboard']([Markup['button'][_0x1843e1(0x1b9)](_0x1843e1(0x174),'resetpw_yes'),Markup['button'][_0x1843e1(0x1b9)]('no',_0x1843e1(0x1c7))]);await sendTelegram(settings[_0x1843e1(0x186)],_0x1843e1(0x114),_0xd92de2),tgBot['action'](/resetpw_(.+)/,async _0x4ac531=>{const _0x501383=_0x1843e1,_0x170445=_0x4ac531[_0x501383(0x2cb)][0x1];_0x4ac531[_0x501383(0x13b)]();if(_0x170445!='no'){const _0x3f7ccc=0xf,_0x251dbe=_0x501383(0x2d6),_0x361fad=Array[_0x501383(0x188)](crypto[_0x501383(0x318)](new Uint32Array(_0x3f7ccc)))['map'](_0x5cb1ad=>_0x251dbe[_0x5cb1ad%_0x251dbe[_0x501383(0x120)]])['join'](''),_0x1b3904=bcrypt[_0x501383(0x14e)](_0x361fad,saltRounds);storeSettings({'bbPassword':_0x1b3904}),await sendTelegram(_0x4ac531['chat']['id'],_0x501383(0x242)+_0x361fad,{'parse_mode':_0x501383(0x24e)});}else await sendTelegram(_0x4ac531[_0x501383(0x308)]['id'],_0x501383(0x20f));});}}async function confirmRestore(_0x2753d3,_0xc2d5aa){const _0xed0c77=_0x169721;io['to'](_0xed0c77(0x1f2))['emit']('notification',_0xed0c77(0x23d),_0xed0c77(0x1ae));if(tgBot&&settings[_0xed0c77(0x186)]){const _0x5a5a5b=uuidRandom();tmpStorage[_0x5a5a5b]={'path':_0x2753d3,'filename':_0xc2d5aa};const _0x4edc03=Markup['inlineKeyboard']([Markup[_0xed0c77(0x17e)][_0xed0c77(0x1b9)](_0xed0c77(0x174),_0xed0c77(0x1a8)+_0x5a5a5b),Markup[_0xed0c77(0x17e)][_0xed0c77(0x1b9)]('no',_0xed0c77(0x215)+_0x5a5a5b)]);await sendTelegram(settings[_0xed0c77(0x186)],_0xed0c77(0x24f),_0x4edc03),tgBot[_0xed0c77(0x273)](/restore_(.+)_(.+)/,async _0x47b9c9=>{const _0x4b1dbe=_0xed0c77,_0x5aa714=_0x47b9c9[_0x4b1dbe(0x2cb)][0x1],_0x59c237=_0x47b9c9['match'][0x2],{path:_0x28a4f2,filename:_0x19457c}=tmpStorage[_0x59c237];delete tmpStorage[_0x59c237],_0x47b9c9['editMessageReplyMarkup'](),_0x5aa714==_0x4b1dbe(0x174)?(logger[_0x4b1dbe(0x2b6)](_0x4b1dbe(0x21a)),await sendTelegram(_0x47b9c9[_0x4b1dbe(0x308)]['id'],_0x4b1dbe(0x263),{'parse_mode':_0x4b1dbe(0x24e)}),unzipFile(_0x28a4f2,_0x19457c)):(logger['debug'](_0x4b1dbe(0x272)),await sendTelegram(_0x47b9c9[_0x4b1dbe(0x308)]['id'],_0x4b1dbe(0x272)));});}}function getServerTime(){const _0x546d87=_0x169721,_0xfe6913=new Date();return _0xfe6913[_0x546d87(0x2a5)]()+'/'+(_0xfe6913['getMonth']()+0x1)['toString']()[_0x546d87(0x1e2)](0x2,'0')+'/'+_0xfe6913['getDate']()[_0x546d87(0x2ef)]()['padStart'](0x2,'0')+'\x20'+_0xfe6913[_0x546d87(0x1c3)]()[_0x546d87(0x2ef)]()[_0x546d87(0x1e2)](0x2,'0')+':'+_0xfe6913[_0x546d87(0x30c)]()[_0x546d87(0x2ef)]()[_0x546d87(0x1e2)](0x2,'0')+':'+_0xfe6913['getSeconds']()[_0x546d87(0x2ef)]()[_0x546d87(0x1e2)](0x2,'0');}function getTimeStamp(){const _0x4abed5=_0x169721,_0x21c1fb=shiftedTime();return _0x21c1fb['getFullYear']()+'/'+(_0x21c1fb[_0x4abed5(0x196)]()+0x1)['toString']()[_0x4abed5(0x1e2)](0x2,'0')+'/'+_0x21c1fb[_0x4abed5(0x185)]()['toString']()[_0x4abed5(0x1e2)](0x2,'0')+'\x20'+_0x21c1fb[_0x4abed5(0x1c3)]()[_0x4abed5(0x2ef)]()[_0x4abed5(0x1e2)](0x2,'0')+':'+_0x21c1fb[_0x4abed5(0x30c)]()['toString']()[_0x4abed5(0x1e2)](0x2,'0')+':'+_0x21c1fb[_0x4abed5(0x20b)]()['toString']()[_0x4abed5(0x1e2)](0x2,'0');}function getCleanTimeStamp(){const _0x24e936=_0x169721,_0x232c81=shiftedTime();return _0x232c81[_0x24e936(0x2a5)]()+(_0x232c81[_0x24e936(0x196)]()+0x1)['toString']()[_0x24e936(0x1e2)](0x2,'0')+_0x232c81['getDate']()[_0x24e936(0x2ef)]()[_0x24e936(0x1e2)](0x2,'0')+'-'+_0x232c81[_0x24e936(0x1c3)]()[_0x24e936(0x2ef)]()['padStart'](0x2,'0')+_0x232c81['getMinutes']()[_0x24e936(0x2ef)]()[_0x24e936(0x1e2)](0x2,'0')+_0x232c81['getSeconds']()['toString']()[_0x24e936(0x1e2)](0x2,'0');}function shiftedTime(){const _0x21b9ce=_0x169721,_0xa6b9a3=new Date();let _0x49255a=_0xa6b9a3;if(settings[_0x21b9ce(0x266)]&&settings[_0x21b9ce(0x266)]!==0x0)_0x49255a=fns[_0x21b9ce(0x2d2)](_0xa6b9a3,{'hours':settings[_0x21b9ce(0x266)]});return _0x49255a;}async function startScheduler(){const _0x378f47=_0x169721,_0x35b51c=new Date()[_0x378f47(0x2f2)](),_0xda94a4=shiftedTime()[_0x378f47(0x1c3)]();_0xda94a4==0x4&&backupConfigFiles(),_0xda94a4==0x0&&(rotateLogFiles(),logger[_0x378f47(0x2b6)]('--------------------------------------'),logger['debug'](_0x378f47(0x1ef)+serverversion+_0x378f47(0x23e)+(environment=='staging'?_0x378f47(0x261):'')),logger[_0x378f47(0x2b6)]('--------------------------------------')),_0x35b51c%0x6==0x0&&triggerAnalytics(),_0x35b51c%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x419170){const _0x158d1f=_0x169721;logger[_0x158d1f(0x2b6)](_0x158d1f(0x2a9)+_0x419170);const _0x4533f7=getBotsWithMode();_0x4533f7[_0x158d1f(0x120)]>0x0?confirmRestore(configbackuppath,_0x419170):unzipFile(configbackuppath,_0x419170);}async function getBackupFiles(_0x42feb1=null){const _0x44b8b4=_0x169721;let _0x83fa44=[],_0x439ad2=fs[_0x44b8b4(0x2c6)](configbackuppath,{'withFileTypes':!![]});_0x439ad2['sort']((_0x49851a,_0x3d9bc5)=>_0x49851a[_0x44b8b4(0x2d1)]<_0x3d9bc5[_0x44b8b4(0x2d1)]?0x1:_0x3d9bc5['name']<_0x49851a[_0x44b8b4(0x2d1)]?-0x1:0x0),_0x439ad2[_0x44b8b4(0x133)](_0x43c5e2=>{const _0x2a2349=_0x44b8b4;if(!_0x43c5e2[_0x2a2349(0x22f)]()&&_0x43c5e2[_0x2a2349(0x2d1)]['startsWith'](_0x2a2349(0x14b))&&_0x43c5e2[_0x2a2349(0x2d1)]['endsWith'](_0x2a2349(0x181))){const _0x5876d0=formatDate(fs['statSync'](configbackuppath+_0x43c5e2[_0x2a2349(0x2d1)])[_0x2a2349(0x17d)]);_0x83fa44[_0x2a2349(0x2bf)]({'name':_0x43c5e2[_0x2a2349(0x2d1)],'mtime':_0x5876d0});}});if(_0x42feb1)io['to'](_0x42feb1)[_0x44b8b4(0x192)](_0x44b8b4(0x183),_0x83fa44);else return _0x83fa44;}async function backupConfigFiles(){const _0x459a78=_0x169721;await zipFiles('backup-full');const _0x23ea74=getCleanTimeStamp();fs[_0x459a78(0x2da)](zippath+_0x459a78(0x166),configbackuppath+(_0x459a78(0x14b)+_0x23ea74+_0x459a78(0x181)));let _0x2014be=fs[_0x459a78(0x2c6)](configbackuppath,{'withFileTypes':!![]});_0x2014be[_0x459a78(0x1ea)]((_0x3ba22e,_0x23bc36)=>_0x3ba22e[_0x459a78(0x2d1)]<_0x23bc36[_0x459a78(0x2d1)]?0x1:_0x23bc36[_0x459a78(0x2d1)]<_0x3ba22e['name']?-0x1:0x0),_0x2014be[_0x459a78(0x120)]>maxBackups&&fs[_0x459a78(0x27c)](configbackuppath+_0x2014be[_0x2014be['length']-0x1][_0x459a78(0x2d1)]);}function rotateLogFiles(){const _0x37e371=_0x169721,_0x2c0e82=fs[_0x37e371(0x1dd)](logspath+_0x37e371(0x293)),_0x4b6593=_0x2c0e82['size']/0x400;if(_0x4b6593>0x64){let _0x546683=fs[_0x37e371(0x2c6)](logspath,{'withFileTypes':!![]});_0x546683[_0x37e371(0x1ea)]((_0x25b747,_0x10ae33)=>_0x25b747[_0x37e371(0x2d1)]<_0x10ae33[_0x37e371(0x2d1)]?0x1:_0x10ae33[_0x37e371(0x2d1)]<_0x25b747[_0x37e371(0x2d1)]?-0x1:0x0),_0x546683[_0x37e371(0x133)](_0x400dda=>{const _0xa7484c=_0x37e371;if(_0x400dda['name']==_0xa7484c(0x18d))fs[_0xa7484c(0x2da)](logspath+_0x400dda['name'],logspath+'output-003.log');if(_0x400dda[_0xa7484c(0x2d1)]==_0xa7484c(0x316))fs['copyFileSync'](logspath+_0x400dda[_0xa7484c(0x2d1)],logspath+_0xa7484c(0x18d));_0x400dda[_0xa7484c(0x2d1)]==_0xa7484c(0x293)&&(fs[_0xa7484c(0x2da)](logspath+_0x400dda['name'],logspath+_0xa7484c(0x316)),fs[_0xa7484c(0x311)](logspath+_0x400dda['name'],''));});}}async function zipFiles(_0x2db95f){const _0xf83384=_0x169721;let _0x37a938;if(_0x2db95f==_0xf83384(0x2dd))_0x37a938=logspath;if(_0x2db95f==_0xf83384(0x2ad))_0x37a938=configpath;if(_0x2db95f==_0xf83384(0x18b))_0x37a938=configpath;let _0x5f0cfc=fs['readdirSync'](_0x37a938,{'withFileTypes':!![]});const _0x291c13=new JSZip();_0x5f0cfc[_0xf83384(0x133)](_0x1257b6=>{const _0x282b71=_0xf83384;if(!_0x1257b6[_0x282b71(0x22f)]()){let _0x277f2d=fs['readFileSync'](_0x37a938+_0x1257b6[_0x282b71(0x2d1)]);if(_0x2db95f==_0x282b71(0x2ad)){const _0x4294ea=/^bot-[0-9]{3}-config.json$/,_0x5a6968=_0x4294ea[_0x282b71(0x211)](_0x1257b6[_0x282b71(0x2d1)]);if(_0x5a6968){const _0x3eab7f=JSON[_0x282b71(0x2e5)](_0x277f2d);if(_0x3eab7f[_0x282b71(0x2de)][0x0]){_0x3eab7f[_0x282b71(0x2de)][0x0][_0x282b71(0x19d)]='***',_0x3eab7f[_0x282b71(0x2de)][0x0][_0x282b71(0x194)]=_0x282b71(0x2bb);if(_0x3eab7f[_0x282b71(0x2de)][0x0]['apiPassword'])_0x3eab7f['bot'][0x0][_0x282b71(0x244)]=_0x282b71(0x2bb);}_0x277f2d=JSON[_0x282b71(0x19b)](_0x3eab7f,null,0x2);}if(_0x1257b6[_0x282b71(0x2d1)]=='bb-settings.json'){const _0x4d593b=JSON[_0x282b71(0x2e5)](_0x277f2d);if(_0x4d593b[_0x282b71(0x289)]['loginRequired'])_0x4d593b[_0x282b71(0x289)]['loginRequired']=![];if(_0x4d593b['settings'][_0x282b71(0x1cd)])_0x4d593b['settings'][_0x282b71(0x1cd)]=_0x282b71(0x2bb);if(_0x4d593b[_0x282b71(0x289)][_0x282b71(0x172)])_0x4d593b['settings'][_0x282b71(0x172)]='***';if(_0x4d593b[_0x282b71(0x289)][_0x282b71(0x186)])_0x4d593b[_0x282b71(0x289)][_0x282b71(0x186)]=null;if(_0x4d593b['settings'][_0x282b71(0x269)])_0x4d593b[_0x282b71(0x289)][_0x282b71(0x269)]=_0x282b71(0x2bb);_0x277f2d=JSON[_0x282b71(0x19b)](_0x4d593b,null,0x2);}if(_0x1257b6[_0x282b71(0x2d1)]!=_0x282b71(0x195))_0x291c13['file'](_0x1257b6[_0x282b71(0x2d1)],_0x277f2d);}else _0x291c13[_0x282b71(0x136)](_0x1257b6[_0x282b71(0x2d1)],_0x277f2d);}});const _0xcc3258=await _0x291c13[_0xf83384(0x204)]({'type':'string','base64':![],'compression':_0xf83384(0x282)});fs['writeFileSync'](zippath+(_0x2db95f+_0xf83384(0x181)),_0xcc3258,_0xf83384(0x2ee));}async function unzipFile(_0x5d8480,_0x2fbcbd){const _0x2b56b9=_0x169721;fs[_0x2b56b9(0x2c6)](configpath,{'withFileTypes':!![]})[_0x2b56b9(0x133)](_0x42f1c6=>{const _0x23698f=_0x2b56b9;if(!_0x42f1c6[_0x23698f(0x22f)]())fs['rmSync'](configpath+_0x42f1c6[_0x23698f(0x2d1)]);});const _0x23e6aa=fs[_0x2b56b9(0x241)](_0x5d8480+_0x2fbcbd,'binary'),_0x209752=await JSZip[_0x2b56b9(0x15a)](_0x23e6aa,{'base64':![],'checkCRC32':!![]});for(const _0x48fa7d of Object[_0x2b56b9(0x294)](_0x209752[_0x2b56b9(0x213)])){const _0x357152=_0x209752[_0x2b56b9(0x213)][_0x48fa7d],_0x3b44e3=await _0x357152[_0x2b56b9(0x13d)](_0x2b56b9(0x28f));fs[_0x2b56b9(0x311)](configpath+_0x357152[_0x2b56b9(0x2d1)],_0x3b44e3);}fs[_0x2b56b9(0x2c6)](temppath,{'withFileTypes':!![]})[_0x2b56b9(0x133)](_0x51e486=>{if(!_0x51e486['isDirectory']())fs['rmSync'](temppath+_0x51e486['name']);}),logger['debug']('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x2b56b9(0x121)]({'restore':!![]},_0x294a88=>{});}async function getPublicIp(){const _0xe3eac7=_0x169721;try{const _0x4f45d4=await axios[_0xe3eac7(0x1d9)](_0xe3eac7(0x246));publicip=_0x4f45d4[_0xe3eac7(0x123)]['ip'];}catch(_0x22971b){}}async function triggerAnalytics(){const _0x3354f7=_0x169721;if(!publicip)await getPublicIp();const _0x2d9487=getBotsWithMode();let _0x1a668a=0x0;_0x2d9487[_0x3354f7(0x133)](_0x5243f3=>{const _0x4c0caf=_0x3354f7;if(_0x5243f3[_0x4c0caf(0x1e7)]==='enabled')_0x1a668a++;});const _0x4e1850=getBotExchanges();mixpanel[_0x3354f7(0x12d)](_0x3354f7(0x202),{'distinct_id':settings[_0x3354f7(0x2ac)],'ip':publicip,'version':serverversion,'numbots':_0x2d9487[_0x3354f7(0x120)],'numbotsenabled':_0x1a668a,'exchanges':_0x4e1850,'environment':environment});}async function getMessages(){const _0x4dcc0b=_0x169721,_0x2ad0e4='https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master',_0x19dc17=new GraphQLClient(_0x2ad0e4),_0xc980ee={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x363474=serverversion[_0x4dcc0b(0x15f)]('.'),_0x59647f=_0x363474[0x0]+'.'+_0x363474[0x1],_0x3e9fdc=Math[_0x4dcc0b(0x313)](settings[_0x4dcc0b(0x1fc)],settings[_0x4dcc0b(0x258)]),_0x650b19={'last':parseInt(_0x3e9fdc),'bbm':_0x59647f},_0x540a7e=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x1e80f4;try{_0x1e80f4=await _0x19dc17[_0x4dcc0b(0x151)](_0x540a7e,_0x650b19,_0xc980ee);}catch(_0x222254){}if(_0x1e80f4&&_0x1e80f4[_0x4dcc0b(0x182)]){let _0x10caa4=settings[_0x4dcc0b(0x1fc)],_0x201735=settings[_0x4dcc0b(0x1fc)];newMessages=[];for(const _0x12de74 of _0x1e80f4[_0x4dcc0b(0x182)]){newMessages[_0x4dcc0b(0x2bf)](_0x12de74);let _0x2678c9=![];_0x12de74[_0x4dcc0b(0x28c)]&&(updateSetting(_0x4dcc0b(0x264),_0x12de74[_0x4dcc0b(0x28c)]),_0x2678c9=isNewerVersion(serverversion,_0x12de74[_0x4dcc0b(0x28c)])||serverversion==_0x12de74[_0x4dcc0b(0x28c)]);if(!_0x2678c9&&_0x12de74[_0x4dcc0b(0x2c7)]>_0x10caa4){if(_0x12de74['bbvReceive']==='any'||serverversion[_0x4dcc0b(0x237)](_0x12de74['bbvReceive'])){let _0x39d980=''+_0x12de74[_0x4dcc0b(0x18a)]+'\x0a\x0a'+_0x12de74['message'];const _0x3640b2=await sendTelegramMsg(toTelegramMarkdown(_0x39d980),_0x4dcc0b(0x206));_0x10caa4=_0x12de74[_0x4dcc0b(0x2c7)];}}_0x201735=_0x12de74['number'];}updateAvailable=isNewerVersion(settings[_0x4dcc0b(0x264)],serverversion),updateSetting('lastmsgtelegram',_0x201735),emitMessages();}}function emitMessages(){const _0x1bb587=_0x169721,_0x21b5d2=settings[_0x1bb587(0x258)];let _0xe4d595=[];newMessages[_0x1bb587(0x133)](_0x1f1ecc=>{_0x1f1ecc['number']>_0x21b5d2&&_0xe4d595['push'](_0x1f1ecc);}),_0xe4d595[_0x1bb587(0x120)]>0x0&&getAllClients()['forEach'](_0xc1dad1=>{const _0x79c69f=_0x1bb587;getSocket(_0xc1dad1['id'])[_0x79c69f(0x192)](_0x79c69f(0x11e),_0xe4d595);});}function confirmMessage(_0xb9ff64){const _0x3a9402=_0x169721;updateSetting(_0x3a9402(0x258),Number(_0xb9ff64));}function isNewerVersion(_0x4234c3,_0x5f1cf5){const _0x5f1c8c=_0x169721,_0x559f9b=_0x5f1cf5[_0x5f1c8c(0x15f)]('.'),_0x24233d=_0x4234c3['split']('.');for(var _0x44a334=0x0;_0x44a334<_0x24233d[_0x5f1c8c(0x120)];_0x44a334++){const _0xb76b79=~~_0x24233d[_0x44a334],_0x1afbf7=~~_0x559f9b[_0x44a334];if(_0xb76b79>_0x1afbf7)return!![];if(_0xb76b79<_0x1afbf7)return![];}return![];}function toTelegramMarkdown(_0x339a8c){const _0x2cdb0a=_0x169721,_0x48a09d=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x4b9f67=/\*{2}(.+?)\*{2}/gim;return _0x339a8c=_0x339a8c[_0x2cdb0a(0x2bc)](_0x48a09d,_0x2cdb0a(0x298))[_0x2cdb0a(0x2bc)](_0x4b9f67,_0x2cdb0a(0x177)),_0x339a8c;}async function validateConfigFile(){const _0x484a9f=_0x169721,_0x482e2e=dbConfig[_0x484a9f(0x1d9)](_0x484a9f(0x179))[_0x484a9f(0x2ed)](_0x484a9f(0x1ee))['value']()||[];if(_0x482e2e[_0x484a9f(0x120)]==0x0){let _0x348ccb=0x0,_0x268d29=[];const _0x341612=/^bot-([0-9]{3})-config.json$/,_0x225316=fs[_0x484a9f(0x2c6)](configpath);_0x225316[_0x484a9f(0x133)](_0x4ff62b=>{const _0x14f546=_0x484a9f,_0x2e0e3e=_0x341612[_0x14f546(0x149)](_0x4ff62b);if(_0x2e0e3e){const _0x55488f=_0x2e0e3e[0x1];let _0x1d5a35=getBotAttributes(_0x55488f);_0x268d29[_0x14f546(0x2bf)]({'botID':_0x55488f,'botname':_0x1d5a35['botname'],'status':_0x14f546(0x10f),'live':'stopped'}),_0x348ccb++;}}),_0x348ccb!=0x0&&(dbConfig['get']('bots')[_0x484a9f(0x2b9)](_0x268d29)[_0x484a9f(0x234)](),config=_0x268d29,restoredConfigFile=_0x348ccb);}}async function restoreConfigNotify(_0x524b85){const _0x45c264=_0x169721;let _0x7092c6;if(restoredConfigFile==0x1)_0x7092c6='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x7092c6=_0x45c264(0x1b4);if(_0x524b85)io['to'](_0x45c264(0x1f2))['emit'](_0x45c264(0x2a6),_0x7092c6);else{logger[_0x45c264(0x309)]('-----------------------------------------------------------------------------------'),logger[_0x45c264(0x309)](_0x7092c6),logger[_0x45c264(0x309)]('-----------------------------------------------------------------------------------'),logger[_0x45c264(0x309)]('');if(tgBot&&settings[_0x45c264(0x186)]&&settings[_0x45c264(0x138)]!='orders')await sendTelegram(settings[_0x45c264(0x186)],_0x45c264(0x1fd)+_0x7092c6);}}function decryptRSA(_0x322c7f,_0x2c0e0b){const _0x18731c=_0x169721,_0x5e5e19=forge[_0x18731c(0x113)][_0x18731c(0x30e)](_0x322c7f),_0x2f384d=_0x5e5e19[_0x18731c(0x223)](forge[_0x18731c(0x239)][_0x18731c(0x17c)](_0x2c0e0b),'RSA-OAEP',{'md':forge['md']['sha256']['create'](),'mgf1':{'md':forge['md'][_0x18731c(0x1d5)][_0x18731c(0x1aa)]()}});return _0x2f384d;}function validateCredentials(_0x25c5bb,_0x6aa43d){const _0x21601c=_0x169721;if(_0x25c5bb[_0x21601c(0x165)]==settings[_0x21601c(0x210)]&&bcrypt['compareSync'](_0x25c5bb['password'],settings['bbPassword'])){if(settings[_0x21601c(0x2eb)])return{'allow':![],'reason':'2FA\x20login\x20required','token':null};else{const _0x222f4f=generateLoginToken(_0x6aa43d);return{'allow':!![],'reason':_0x21601c(0x191),'token':_0x222f4f};}}else return{'allow':![],'reason':_0x21601c(0x2a1),'token':null};}function refreshToken(_0x137c4f){const _0x472084=_0x169721,_0x558598=generateLoginToken(_0x137c4f);return{'allow':!![],'reason':_0x472084(0x191),'token':_0x558598};}function validateAccess(_0x29d34c,_0x5896a5,_0x5e2856){const _0xd2b8a2=_0x169721,_0x93ef69=_0x5e2856?_0x5e2856:devices[_0x5896a5]['ip'];let _0x3b7369;const _0x55150a=_0xcf3000=>{const _0x559405=_0x825d;if(settings[_0x559405(0x29b)]){if(settings[_0x559405(0x2eb)]){if(telegram2FaApproved(_0x5896a5)){const _0x191754=generateLoginToken(_0x5896a5);return{'allow':!![],'reason':_0x559405(0x2a2),'token':_0x191754};}else return{'allow':![],'reason':_0x559405(0x31b),'token':null};}else return _0x3b7369=validToken(_0xcf3000,_0x5896a5),_0x3b7369[_0x559405(0x155)](_0x559405(0x1ae))?{'allow':!![],'reason':_0x559405(0x2fc),'token':_0xcf3000}:{'allow':![],'reason':_0x559405(0x31b),'token':null};}else return{'allow':!![],'reason':_0x559405(0x129),'token':null};};if(settings['whitelistEnabled']){let _0x55041d=[...settings[_0xd2b8a2(0x1cc)],_0xd2b8a2(0x2a0),_0xd2b8a2(0x24d),_0xd2b8a2(0x1fb)];if(_0x55041d[_0xd2b8a2(0x1a5)](_0x93ef69))return _0x55150a(_0x29d34c);else{_0x3b7369=validToken(_0x29d34c,_0x5896a5);if(_0x3b7369[_0xd2b8a2(0x155)](_0xd2b8a2(0x1ae)))return _0x55150a(_0x29d34c);else{if(telegramIpApproved(_0x5896a5)){const _0x39c73e=generateToken(_0x5896a5);return _0x3b7369=_0x55150a(_0x29d34c),_0x3b7369['allow']?{'allow':!![],'reason':_0xd2b8a2(0x2fd),'token':_0x39c73e}:_0x3b7369;}else return settings['temporaryAccessAllowed']?{'allow':![],'reason':_0xd2b8a2(0x1d6),'token':null}:{'allow':![],'reason':'temporary\x20access\x20not\x20allowed','token':null};}}}else return _0x55150a(_0x29d34c);}function timelyDecrypt(_0x114d12,_0x562600,_0x20a817='@'){const _0x41405f=_0x169721;if(_0x114d12)try{const _0x204c1e=decryptRSA(secure['privateKey'],_0x114d12),_0xcf53ea=_0x204c1e['split'](_0x20a817)[0x0],_0x34d3ed=_0x204c1e[_0x41405f(0x15f)](_0x20a817)[0x1],_0x2f2b78=new Date()[_0x41405f(0x315)]();if(_0x562600){if(_0x2f2b78-_0x34d3ed<maxSecretAge*0x3e8)return _0xcf53ea;else return![];}else return _0xcf53ea;}catch(_0x470bc0){return![];}else return![];}const validToken=(_0x4e932e,_0x3f11fa)=>{const _0x9c2b7f=_0x169721,_0x1ac3e6=devices[_0x3f11fa]['ip'];if(!_0x4e932e)return{'error':_0x9c2b7f(0x257)};for(let _0x786150 of blacklist){if(_0x786150['token']==_0x4e932e)return{'error':_0x9c2b7f(0x2b5)};}let _0x4215e6;try{_0x4215e6=jwt['verify'](_0x4e932e,secure[_0x9c2b7f(0x2b2)]+_0x3f11fa);}catch{return{'error':_0x9c2b7f(0x26c)};}if(!_0x4215e6[_0x9c2b7f(0x155)](_0x9c2b7f(0x1f7))&&!_0x4215e6['hasOwnProperty'](_0x9c2b7f(0x165))||!_0x4215e6[_0x9c2b7f(0x155)]('exp'))return{'error':_0x9c2b7f(0x1f5)};if(!_0x4215e6['hasOwnProperty'](_0x9c2b7f(0x165))&&_0x4215e6[_0x9c2b7f(0x155)](_0x9c2b7f(0x1f7))){const {clientip:_0x363231}=_0x4215e6;return _0x1ac3e6==_0x363231?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x9c2b7f(0x1c8)};}else{if(_0x4215e6['hasOwnProperty'](_0x9c2b7f(0x165))&&_0x4215e6[_0x9c2b7f(0x155)](_0x9c2b7f(0x1f7))){const {username:_0x20f8e0,clientip:_0x152a8b}=_0x4215e6;return settings[_0x9c2b7f(0x210)]==_0x20f8e0&&_0x1ac3e6==_0x152a8b?{'success':_0x9c2b7f(0x26d)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x49f251=>{const _0x599733=_0x169721;if(_0x49f251){const _0x3107e3=devices[_0x49f251]['ip'];return jwt[_0x599733(0x161)]({'username':settings['bbUsername'],'clientip':_0x3107e3},secure[_0x599733(0x2b2)]+_0x49f251,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x588ca8=>{const _0x4a4734=_0x169721;if(_0x588ca8){const _0x4c59c=devices[_0x588ca8]['ip'];return jwt[_0x4a4734(0x161)]({'clientip':_0x4c59c},secure['secret']+_0x588ca8,{'expiresIn':devices[_0x588ca8][_0x4a4734(0x190)]['expiry']*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x568050=>{const _0x15a691=_0x169721;let _0x2b0a01=![];return devices[_0x568050][_0x15a691(0x190)]&&devices[_0x568050][_0x15a691(0x190)][_0x15a691(0x16f)]!=_0x15a691(0x132)&&(_0x2b0a01=devices[_0x568050]['telegramIpApproval'][_0x15a691(0x1f7)]==devices[_0x568050]['ip']&&new Date()[_0x15a691(0x315)]()-devices[_0x568050][_0x15a691(0x190)][_0x15a691(0x304)]<devices[_0x568050][_0x15a691(0x190)][_0x15a691(0x16f)]*0x3c*0x3e8),_0x2b0a01;},telegram2FaApproved=_0x13bec2=>{const _0x425425=_0x169721;let _0xfb22a5=![];return devices[_0x13bec2][_0x425425(0x14d)]&&devices[_0x13bec2][_0x425425(0x14d)][_0x425425(0x16f)]!='reject'&&(_0xfb22a5=devices[_0x13bec2]['telegram2FaApproval'][_0x425425(0x1f7)]==devices[_0x13bec2]['ip']&&new Date()['getTime']()-devices[_0x13bec2][_0x425425(0x14d)][_0x425425(0x304)]<devices[_0x13bec2][_0x425425(0x14d)][_0x425425(0x16f)]*0x3c*0x3e8),_0xfb22a5;},normalizeIP=_0x4297e5=>{const _0x38b74f=_0x169721;let _0x341cb5=null,_0x3e28fa=null;if(ipaddr[_0x38b74f(0x321)](_0x4297e5)){const _0x2c750a=ipaddr[_0x38b74f(0x2e5)](_0x4297e5);_0x2c750a[_0x38b74f(0x193)]()===_0x38b74f(0x2dc)?(_0x2c750a[_0x38b74f(0x1a1)]()&&(_0x341cb5=_0x2c750a['toIPv4Address']()[_0x38b74f(0x2ef)]()),_0x3e28fa=_0x2c750a['toString']()):(_0x341cb5=_0x2c750a['toString'](),_0x3e28fa=_0x2c750a[_0x38b74f(0x1be)]()['toString']());}return{'show':_0x341cb5?_0x341cb5:_0x3e28fa,'store':_0x3e28fa};};function formatDate(_0x4c3c6c){const _0x587348=_0x169721;return _0x4c3c6c['getFullYear']()+'/'+(_0x4c3c6c[_0x587348(0x196)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x4c3c6c[_0x587348(0x185)]()[_0x587348(0x2ef)]()[_0x587348(0x1e2)](0x2,'0')+'\x20'+_0x4c3c6c['getHours']()[_0x587348(0x2ef)]()[_0x587348(0x1e2)](0x2,'0')+':'+_0x4c3c6c[_0x587348(0x30c)]()[_0x587348(0x2ef)]()[_0x587348(0x1e2)](0x2,'0')+':'+_0x4c3c6c[_0x587348(0x20b)]()[_0x587348(0x2ef)]()[_0x587348(0x1e2)](0x2,'0');}function sleep(_0x40886c){return new Promise(_0x4f85d9=>setTimeout(_0x4f85d9,_0x40886c));}